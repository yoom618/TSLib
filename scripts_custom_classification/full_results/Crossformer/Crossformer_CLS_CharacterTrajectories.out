Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.749354839324951
Epoch: 1, Steps: 89 | Train Loss: 1.696 Vali Loss: 0.520 Vali Acc: 0.866 Test Loss: 0.520 Test Acc: 0.866
Validation loss decreased (inf --> -0.866290).  Saving model ...
Epoch: 2 cost time: 7.2686240673065186
Epoch: 2, Steps: 89 | Train Loss: 0.383 Vali Loss: 0.294 Vali Acc: 0.916 Test Loss: 0.294 Test Acc: 0.916
Validation loss decreased (-0.866290 --> -0.916432).  Saving model ...
Epoch: 3 cost time: 7.079807996749878
Epoch: 3, Steps: 89 | Train Loss: 0.271 Vali Loss: 0.263 Vali Acc: 0.914 Test Loss: 0.263 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.763176918029785
Epoch: 4, Steps: 89 | Train Loss: 0.228 Vali Loss: 0.284 Vali Acc: 0.909 Test Loss: 0.284 Test Acc: 0.909
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.289113521575928
Epoch: 5, Steps: 89 | Train Loss: 0.192 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.916432 --> -0.943591).  Saving model ...
Epoch: 6 cost time: 7.307809114456177
Epoch: 6, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.255 Vali Acc: 0.914 Test Loss: 0.255 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.075250148773193
Epoch: 7, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.197 Vali Acc: 0.939 Test Loss: 0.197 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.974595785140991
Epoch: 8, Steps: 89 | Train Loss: 0.186 Vali Loss: 0.235 Vali Acc: 0.930 Test Loss: 0.235 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.212709903717041
Epoch: 9, Steps: 89 | Train Loss: 0.206 Vali Loss: 0.211 Vali Acc: 0.935 Test Loss: 0.211 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 7.005162477493286
Epoch: 10, Steps: 89 | Train Loss: 0.235 Vali Loss: 0.264 Vali Acc: 0.930 Test Loss: 0.264 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 7.433902740478516
Epoch: 11, Steps: 89 | Train Loss: 0.413 Vali Loss: 0.825 Vali Acc: 0.771 Test Loss: 0.825 Test Acc: 0.771
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 7.885753154754639
Epoch: 12, Steps: 89 | Train Loss: 0.690 Vali Loss: 0.627 Vali Acc: 0.789 Test Loss: 0.627 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 8.296680212020874
Epoch: 13, Steps: 89 | Train Loss: 1.355 Vali Loss: 1.105 Vali Acc: 0.661 Test Loss: 1.105 Test Acc: 0.661
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 7.834181308746338
Epoch: 14, Steps: 89 | Train Loss: 1.567 Vali Loss: 2.126 Vali Acc: 0.373 Test Loss: 2.126 Test Acc: 0.373
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 7.698805093765259
Epoch: 15, Steps: 89 | Train Loss: 3.368 Vali Loss: 3.284 Vali Acc: 0.047 Test Loss: 3.284 Test Acc: 0.047
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9435933147632312
model parameter : 14325072
model size : 59.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.429786443710327
Epoch: 1, Steps: 89 | Train Loss: 1.724 Vali Loss: 0.518 Vali Acc: 0.881 Test Loss: 0.518 Test Acc: 0.881
Validation loss decreased (inf --> -0.880914).  Saving model ...
Epoch: 2 cost time: 8.684067726135254
Epoch: 2, Steps: 89 | Train Loss: 0.398 Vali Loss: 0.302 Vali Acc: 0.912 Test Loss: 0.302 Test Acc: 0.912
Validation loss decreased (-0.880914 --> -0.912253).  Saving model ...
Epoch: 3 cost time: 8.455224752426147
Epoch: 3, Steps: 89 | Train Loss: 0.256 Vali Loss: 0.300 Vali Acc: 0.891 Test Loss: 0.300 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.039409160614014
Epoch: 4, Steps: 89 | Train Loss: 0.238 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
Validation loss decreased (-0.912253 --> -0.950555).  Saving model ...
Epoch: 5 cost time: 8.818877696990967
Epoch: 5, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
Validation loss decreased (-0.950555 --> -0.958912).  Saving model ...
Epoch: 6 cost time: 8.794222354888916
Epoch: 6, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.287 Vali Acc: 0.925 Test Loss: 0.287 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.646535158157349
Epoch: 7, Steps: 89 | Train Loss: 0.213 Vali Loss: 0.171 Vali Acc: 0.951 Test Loss: 0.171 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.34484338760376
Epoch: 8, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.215 Vali Acc: 0.939 Test Loss: 0.215 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.84231448173523
Epoch: 9, Steps: 89 | Train Loss: 0.255 Vali Loss: 0.292 Vali Acc: 0.896 Test Loss: 0.292 Test Acc: 0.896
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 8.882789134979248
Epoch: 10, Steps: 89 | Train Loss: 0.319 Vali Loss: 0.291 Vali Acc: 0.909 Test Loss: 0.291 Test Acc: 0.909
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 9.454637050628662
Epoch: 11, Steps: 89 | Train Loss: 0.587 Vali Loss: 1.078 Vali Acc: 0.726 Test Loss: 1.078 Test Acc: 0.726
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 10.946076393127441
Epoch: 12, Steps: 89 | Train Loss: 1.829 Vali Loss: 1.429 Vali Acc: 0.550 Test Loss: 1.429 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 10.635315179824829
Epoch: 13, Steps: 89 | Train Loss: 2.781 Vali Loss: 3.555 Vali Acc: 0.054 Test Loss: 3.555 Test Acc: 0.054
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 9.869093656539917
Epoch: 14, Steps: 89 | Train Loss: 3.381 Vali Loss: 3.205 Vali Acc: 0.060 Test Loss: 3.205 Test Acc: 0.060
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 10.240835428237915
Epoch: 15, Steps: 89 | Train Loss: 3.263 Vali Loss: 3.101 Vali Acc: 0.060 Test Loss: 3.101 Test Acc: 0.060
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9589136490250696
model parameter : 14317392
model size : 59.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 12.312915802001953
Epoch: 1, Steps: 89 | Train Loss: 1.783 Vali Loss: 0.703 Vali Acc: 0.769 Test Loss: 0.703 Test Acc: 0.769
Validation loss decreased (inf --> -0.769492).  Saving model ...
Epoch: 2 cost time: 10.596224784851074
Epoch: 2, Steps: 89 | Train Loss: 0.451 Vali Loss: 0.275 Vali Acc: 0.925 Test Loss: 0.275 Test Acc: 0.925
Validation loss decreased (-0.769492 --> -0.924788).  Saving model ...
Epoch: 3 cost time: 10.627286434173584
Epoch: 3, Steps: 89 | Train Loss: 0.242 Vali Loss: 0.216 Vali Acc: 0.939 Test Loss: 0.216 Test Acc: 0.939
Validation loss decreased (-0.924788 --> -0.939413).  Saving model ...
Epoch: 4 cost time: 10.256049394607544
Epoch: 4, Steps: 89 | Train Loss: 0.216 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
Validation loss decreased (-0.939413 --> -0.958216).  Saving model ...
Epoch: 5 cost time: 9.674813508987427
Epoch: 5, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.132 Vali Acc: 0.961 Test Loss: 0.132 Test Acc: 0.961
Validation loss decreased (-0.958216 --> -0.961001).  Saving model ...
Epoch: 6 cost time: 9.920399904251099
Epoch: 6, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.197 Vali Acc: 0.935 Test Loss: 0.197 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.230255603790283
Epoch: 7, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.179 Vali Acc: 0.943 Test Loss: 0.179 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.418348789215088
Epoch: 8, Steps: 89 | Train Loss: 0.219 Vali Loss: 0.187 Vali Acc: 0.940 Test Loss: 0.187 Test Acc: 0.940
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.065258026123047
Epoch: 9, Steps: 89 | Train Loss: 0.273 Vali Loss: 0.436 Vali Acc: 0.863 Test Loss: 0.436 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.286116123199463
Epoch: 10, Steps: 89 | Train Loss: 0.362 Vali Loss: 0.365 Vali Acc: 0.886 Test Loss: 0.365 Test Acc: 0.886
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 10.112723112106323
Epoch: 11, Steps: 89 | Train Loss: 0.613 Vali Loss: 0.443 Vali Acc: 0.875 Test Loss: 0.443 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 10.170830249786377
Epoch: 12, Steps: 89 | Train Loss: 0.750 Vali Loss: 0.882 Vali Acc: 0.756 Test Loss: 0.882 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 10.70015811920166
Epoch: 13, Steps: 89 | Train Loss: 1.207 Vali Loss: 0.800 Vali Acc: 0.752 Test Loss: 0.800 Test Acc: 0.752
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 10.408981561660767
Epoch: 14, Steps: 89 | Train Loss: 1.780 Vali Loss: 2.127 Vali Acc: 0.418 Test Loss: 2.127 Test Acc: 0.418
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 9.919507026672363
Epoch: 15, Steps: 89 | Train Loss: 3.332 Vali Loss: 3.508 Vali Acc: 0.045 Test Loss: 3.508 Test Acc: 0.045
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9610027855153204
model parameter : 14309712
model size : 59.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 12.122617244720459
Epoch: 1, Steps: 89 | Train Loss: 1.821 Vali Loss: 0.580 Vali Acc: 0.838 Test Loss: 0.580 Test Acc: 0.838
Validation loss decreased (inf --> -0.838434).  Saving model ...
Epoch: 2 cost time: 10.087021112442017
Epoch: 2, Steps: 89 | Train Loss: 0.389 Vali Loss: 0.404 Vali Acc: 0.885 Test Loss: 0.404 Test Acc: 0.885
Validation loss decreased (-0.838434 --> -0.885093).  Saving model ...
Epoch: 3 cost time: 11.321003198623657
Epoch: 3, Steps: 89 | Train Loss: 0.270 Vali Loss: 0.150 Vali Acc: 0.966 Test Loss: 0.150 Test Acc: 0.966
Validation loss decreased (-0.885093 --> -0.965876).  Saving model ...
Epoch: 4 cost time: 12.396362543106079
Epoch: 4, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.208 Vali Acc: 0.938 Test Loss: 0.208 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.425346612930298
Epoch: 5, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.184 Vali Acc: 0.937 Test Loss: 0.184 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.733617067337036
Epoch: 6, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.287 Vali Acc: 0.907 Test Loss: 0.287 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.623893976211548
Epoch: 7, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.152 Vali Acc: 0.960 Test Loss: 0.152 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 11.081691026687622
Epoch: 8, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.230 Vali Acc: 0.924 Test Loss: 0.230 Test Acc: 0.924
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 10.211318492889404
Epoch: 9, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.299 Vali Acc: 0.905 Test Loss: 0.299 Test Acc: 0.905
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 10.976299047470093
Epoch: 10, Steps: 89 | Train Loss: 0.328 Vali Loss: 0.434 Vali Acc: 0.877 Test Loss: 0.434 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 10.98987078666687
Epoch: 11, Steps: 89 | Train Loss: 0.429 Vali Loss: 0.846 Vali Acc: 0.760 Test Loss: 0.846 Test Acc: 0.760
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 10.924677610397339
Epoch: 12, Steps: 89 | Train Loss: 1.520 Vali Loss: 3.409 Vali Acc: 0.123 Test Loss: 3.409 Test Acc: 0.123
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 11.09975266456604
Epoch: 13, Steps: 89 | Train Loss: 2.762 Vali Loss: 2.871 Vali Acc: 0.216 Test Loss: 2.871 Test Acc: 0.216
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9658774373259053
model parameter : 14302032
model size : 59.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 12.610615730285645
Epoch: 1, Steps: 89 | Train Loss: 1.763 Vali Loss: 0.578 Vali Acc: 0.836 Test Loss: 0.578 Test Acc: 0.836
Validation loss decreased (inf --> -0.836345).  Saving model ...
Epoch: 2 cost time: 11.028144359588623
Epoch: 2, Steps: 89 | Train Loss: 0.385 Vali Loss: 0.326 Vali Acc: 0.912 Test Loss: 0.326 Test Acc: 0.912
Validation loss decreased (-0.836345 --> -0.911557).  Saving model ...
Epoch: 3 cost time: 11.080090761184692
Epoch: 3, Steps: 89 | Train Loss: 0.257 Vali Loss: 0.214 Vali Acc: 0.932 Test Loss: 0.214 Test Acc: 0.932
Validation loss decreased (-0.911557 --> -0.931753).  Saving model ...
Epoch: 4 cost time: 11.372448682785034
Epoch: 4, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.190 Vali Acc: 0.939 Test Loss: 0.190 Test Acc: 0.939
Validation loss decreased (-0.931753 --> -0.939413).  Saving model ...
Epoch: 5 cost time: 10.412340641021729
Epoch: 5, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.198 Vali Acc: 0.946 Test Loss: 0.198 Test Acc: 0.946
Validation loss decreased (-0.939413 --> -0.945680).  Saving model ...
Epoch: 6 cost time: 10.770845413208008
Epoch: 6, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
Validation loss decreased (-0.945680 --> -0.962394).  Saving model ...
Epoch: 7 cost time: 10.506961822509766
Epoch: 7, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.207 Vali Acc: 0.935 Test Loss: 0.207 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.035313844680786
Epoch: 8, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.218 Vali Acc: 0.930 Test Loss: 0.218 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 10.691970109939575
Epoch: 9, Steps: 89 | Train Loss: 0.239 Vali Loss: 0.282 Vali Acc: 0.914 Test Loss: 0.282 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.852166891098022
Epoch: 10, Steps: 89 | Train Loss: 0.272 Vali Loss: 0.486 Vali Acc: 0.858 Test Loss: 0.486 Test Acc: 0.858
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 10.297915697097778
Epoch: 11, Steps: 89 | Train Loss: 0.420 Vali Loss: 0.869 Vali Acc: 0.767 Test Loss: 0.869 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 11.073991060256958
Epoch: 12, Steps: 89 | Train Loss: 0.906 Vali Loss: 2.758 Vali Acc: 0.206 Test Loss: 2.758 Test Acc: 0.206
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 11.448959827423096
Epoch: 13, Steps: 89 | Train Loss: 3.082 Vali Loss: 2.873 Vali Acc: 0.133 Test Loss: 2.873 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 10.814669609069824
Epoch: 14, Steps: 89 | Train Loss: 2.992 Vali Loss: 4.440 Vali Acc: 0.085 Test Loss: 4.440 Test Acc: 0.085
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 10.418138027191162
Epoch: 15, Steps: 89 | Train Loss: 3.487 Vali Loss: 3.148 Vali Acc: 0.060 Test Loss: 3.148 Test Acc: 0.060
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 10.079761981964111
Epoch: 16, Steps: 89 | Train Loss: 3.248 Vali Loss: 3.116 Vali Acc: 0.048 Test Loss: 3.116 Test Acc: 0.048
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9623955431754875
model parameter : 11961168
model size : 50.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 11.910006999969482
Epoch: 1, Steps: 89 | Train Loss: 1.752 Vali Loss: 0.514 Vali Acc: 0.854 Test Loss: 0.514 Test Acc: 0.854
Validation loss decreased (inf --> -0.854452).  Saving model ...
Epoch: 2 cost time: 9.601300477981567
Epoch: 2, Steps: 89 | Train Loss: 0.418 Vali Loss: 0.291 Vali Acc: 0.895 Test Loss: 0.291 Test Acc: 0.895
Validation loss decreased (-0.854452 --> -0.894844).  Saving model ...
Epoch: 3 cost time: 11.316545724868774
Epoch: 3, Steps: 89 | Train Loss: 0.217 Vali Loss: 0.192 Vali Acc: 0.942 Test Loss: 0.192 Test Acc: 0.942
Validation loss decreased (-0.894844 --> -0.942199).  Saving model ...
Epoch: 4 cost time: 11.241746187210083
Epoch: 4, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.255 Vali Acc: 0.915 Test Loss: 0.255 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.569815635681152
Epoch: 5, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.280894041061401
Epoch: 6, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.260 Vali Acc: 0.921 Test Loss: 0.260 Test Acc: 0.921
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.468544721603394
Epoch: 7, Steps: 89 | Train Loss: 0.197 Vali Loss: 0.277 Vali Acc: 0.912 Test Loss: 0.277 Test Acc: 0.912
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 10.928292512893677
Epoch: 8, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.175 Vali Acc: 0.952 Test Loss: 0.175 Test Acc: 0.952
Validation loss decreased (-0.942199 --> -0.951948).  Saving model ...
Epoch: 9 cost time: 10.06532335281372
Epoch: 9, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.269 Vali Acc: 0.905 Test Loss: 0.269 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.135314226150513
Epoch: 10, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.389 Vali Acc: 0.879 Test Loss: 0.389 Test Acc: 0.879
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 10.955679178237915
Epoch: 11, Steps: 89 | Train Loss: 0.381 Vali Loss: 0.547 Vali Acc: 0.818 Test Loss: 0.547 Test Acc: 0.818
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 10.265218496322632
Epoch: 12, Steps: 89 | Train Loss: 0.811 Vali Loss: 1.987 Vali Acc: 0.517 Test Loss: 1.987 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 10.743141174316406
Epoch: 13, Steps: 89 | Train Loss: 1.240 Vali Loss: 2.165 Vali Acc: 0.432 Test Loss: 2.165 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 10.666364908218384
Epoch: 14, Steps: 89 | Train Loss: 1.324 Vali Loss: 0.797 Vali Acc: 0.756 Test Loss: 0.797 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 10.162469625473022
Epoch: 15, Steps: 89 | Train Loss: 1.610 Vali Loss: 1.712 Vali Acc: 0.473 Test Loss: 1.712 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 9.966424226760864
Epoch: 16, Steps: 89 | Train Loss: 1.732 Vali Loss: 1.127 Vali Acc: 0.652 Test Loss: 1.127 Test Acc: 0.652
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 10.69859790802002
Epoch: 17, Steps: 89 | Train Loss: 1.721 Vali Loss: 1.553 Vali Acc: 0.542 Test Loss: 1.553 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 10.313032388687134
Epoch: 18, Steps: 89 | Train Loss: 1.767 Vali Loss: 1.286 Vali Acc: 0.568 Test Loss: 1.286 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9519498607242339
model parameter : 11953488
model size : 50.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 14.531577110290527
Epoch: 1, Steps: 89 | Train Loss: 1.758 Vali Loss: 0.537 Vali Acc: 0.865 Test Loss: 0.537 Test Acc: 0.865
Validation loss decreased (inf --> -0.864897).  Saving model ...
Epoch: 2 cost time: 11.41846513748169
Epoch: 2, Steps: 89 | Train Loss: 0.440 Vali Loss: 0.279 Vali Acc: 0.920 Test Loss: 0.279 Test Acc: 0.920
Validation loss decreased (-0.864897 --> -0.919914).  Saving model ...
Epoch: 3 cost time: 11.29086971282959
Epoch: 3, Steps: 89 | Train Loss: 0.260 Vali Loss: 0.312 Vali Acc: 0.904 Test Loss: 0.312 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.745981693267822
Epoch: 4, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.154 Vali Acc: 0.953 Test Loss: 0.154 Test Acc: 0.953
Validation loss decreased (-0.919914 --> -0.953341).  Saving model ...
Epoch: 5 cost time: 10.29078483581543
Epoch: 5, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.182 Vali Acc: 0.943 Test Loss: 0.182 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.017573118209839
Epoch: 6, Steps: 89 | Train Loss: 0.182 Vali Loss: 0.346 Vali Acc: 0.897 Test Loss: 0.346 Test Acc: 0.897
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 11.983454465866089
Epoch: 7, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 11.12638545036316
Epoch: 8, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.181 Vali Acc: 0.946 Test Loss: 0.181 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 10.700366973876953
Epoch: 9, Steps: 89 | Train Loss: 0.206 Vali Loss: 0.321 Vali Acc: 0.903 Test Loss: 0.321 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 11.110774278640747
Epoch: 10, Steps: 89 | Train Loss: 0.306 Vali Loss: 0.350 Vali Acc: 0.873 Test Loss: 0.350 Test Acc: 0.873
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 10.755491733551025
Epoch: 11, Steps: 89 | Train Loss: 0.324 Vali Loss: 0.342 Vali Acc: 0.896 Test Loss: 0.342 Test Acc: 0.896
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 10.887186765670776
Epoch: 12, Steps: 89 | Train Loss: 0.483 Vali Loss: 0.745 Vali Acc: 0.780 Test Loss: 0.745 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 11.311143636703491
Epoch: 13, Steps: 89 | Train Loss: 0.998 Vali Loss: 0.951 Vali Acc: 0.716 Test Loss: 0.951 Test Acc: 0.716
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 11.47441840171814
Epoch: 14, Steps: 89 | Train Loss: 0.986 Vali Loss: 1.089 Vali Acc: 0.698 Test Loss: 1.089 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9533426183844012
model parameter : 11945808
model size : 50.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.016538619995117
Epoch: 1, Steps: 89 | Train Loss: 1.772 Vali Loss: 0.666 Vali Acc: 0.813 Test Loss: 0.666 Test Acc: 0.813
Validation loss decreased (inf --> -0.812667).  Saving model ...
Epoch: 2 cost time: 11.24826169013977
Epoch: 2, Steps: 89 | Train Loss: 0.366 Vali Loss: 0.292 Vali Acc: 0.912 Test Loss: 0.292 Test Acc: 0.912
Validation loss decreased (-0.812667 --> -0.912253).  Saving model ...
Epoch: 3 cost time: 10.831542491912842
Epoch: 3, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.912253 --> -0.931056).  Saving model ...
Epoch: 4 cost time: 10.86679458618164
Epoch: 4, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
Validation loss decreased (-0.931056 --> -0.967965).  Saving model ...
Epoch: 5 cost time: 12.058491468429565
Epoch: 5, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.178 Vali Acc: 0.948 Test Loss: 0.178 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.626952886581421
Epoch: 6, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 11.336565732955933
Epoch: 7, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.253 Vali Acc: 0.918 Test Loss: 0.253 Test Acc: 0.918
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 11.727867126464844
Epoch: 8, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.211 Vali Acc: 0.925 Test Loss: 0.211 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 10.338590621948242
Epoch: 9, Steps: 89 | Train Loss: 0.228 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 10.398647546768188
Epoch: 10, Steps: 89 | Train Loss: 0.229 Vali Loss: 0.170 Vali Acc: 0.947 Test Loss: 0.170 Test Acc: 0.947
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 11.420326232910156
Epoch: 11, Steps: 89 | Train Loss: 0.228 Vali Loss: 0.377 Vali Acc: 0.878 Test Loss: 0.377 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 11.789367914199829
Epoch: 12, Steps: 89 | Train Loss: 0.579 Vali Loss: 0.483 Vali Acc: 0.841 Test Loss: 0.483 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 12.286780834197998
Epoch: 13, Steps: 89 | Train Loss: 0.794 Vali Loss: 1.816 Vali Acc: 0.483 Test Loss: 1.816 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 11.619029521942139
Epoch: 14, Steps: 89 | Train Loss: 3.193 Vali Loss: 3.609 Vali Acc: 0.060 Test Loss: 3.609 Test Acc: 0.060
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.967966573816156
model parameter : 11938128
model size : 50.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.711317539215088
Epoch: 1, Steps: 89 | Train Loss: 1.780 Vali Loss: 0.596 Vali Acc: 0.819 Test Loss: 0.596 Test Acc: 0.819
Validation loss decreased (inf --> -0.818936).  Saving model ...
Epoch: 2 cost time: 11.118375062942505
Epoch: 2, Steps: 89 | Train Loss: 0.398 Vali Loss: 0.309 Vali Acc: 0.912 Test Loss: 0.309 Test Acc: 0.912
Validation loss decreased (-0.818936 --> -0.911557).  Saving model ...
Epoch: 3 cost time: 11.580370664596558
Epoch: 3, Steps: 89 | Train Loss: 0.238 Vali Loss: 0.183 Vali Acc: 0.949 Test Loss: 0.183 Test Acc: 0.949
Validation loss decreased (-0.911557 --> -0.949163).  Saving model ...
Epoch: 4 cost time: 10.776907444000244
Epoch: 4, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.223 Vali Acc: 0.939 Test Loss: 0.223 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.763885974884033
Epoch: 5, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.146 Vali Acc: 0.948 Test Loss: 0.146 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.274121284484863
Epoch: 6, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
Validation loss decreased (-0.949163 --> -0.968662).  Saving model ...
Epoch: 7 cost time: 11.354506254196167
Epoch: 7, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.209 Vali Acc: 0.937 Test Loss: 0.209 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.228824853897095
Epoch: 8, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.252 Vali Acc: 0.920 Test Loss: 0.252 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 11.828730583190918
Epoch: 9, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.175 Vali Acc: 0.951 Test Loss: 0.175 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 11.556216955184937
Epoch: 10, Steps: 89 | Train Loss: 0.216 Vali Loss: 0.191 Vali Acc: 0.943 Test Loss: 0.191 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 11.67636227607727
Epoch: 11, Steps: 89 | Train Loss: 0.254 Vali Loss: 0.219 Vali Acc: 0.932 Test Loss: 0.219 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 12.282158374786377
Epoch: 12, Steps: 89 | Train Loss: 0.409 Vali Loss: 0.368 Vali Acc: 0.886 Test Loss: 0.368 Test Acc: 0.886
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 12.026597023010254
Epoch: 13, Steps: 89 | Train Loss: 0.786 Vali Loss: 0.842 Vali Acc: 0.748 Test Loss: 0.842 Test Acc: 0.748
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 12.254746198654175
Epoch: 14, Steps: 89 | Train Loss: 1.287 Vali Loss: 1.376 Vali Acc: 0.563 Test Loss: 1.376 Test Acc: 0.563
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 11.34052324295044
Epoch: 15, Steps: 89 | Train Loss: 1.343 Vali Loss: 1.648 Vali Acc: 0.538 Test Loss: 1.648 Test Acc: 0.538
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 11.32153034210205
Epoch: 16, Steps: 89 | Train Loss: 1.825 Vali Loss: 2.344 Vali Acc: 0.413 Test Loss: 2.344 Test Acc: 0.413
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9686629526462396
model parameter : 10779216
model size : 46.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 14.817258834838867
Epoch: 1, Steps: 89 | Train Loss: 1.851 Vali Loss: 0.634 Vali Acc: 0.798 Test Loss: 0.634 Test Acc: 0.798
Validation loss decreased (inf --> -0.798044).  Saving model ...
Epoch: 2 cost time: 11.958005905151367
Epoch: 2, Steps: 89 | Train Loss: 0.403 Vali Loss: 0.238 Vali Acc: 0.942 Test Loss: 0.238 Test Acc: 0.942
Validation loss decreased (-0.798044 --> -0.942198).  Saving model ...
Epoch: 3 cost time: 11.924561738967896
Epoch: 3, Steps: 89 | Train Loss: 0.220 Vali Loss: 0.172 Vali Acc: 0.943 Test Loss: 0.172 Test Acc: 0.943
Validation loss decreased (-0.942198 --> -0.942895).  Saving model ...
Epoch: 4 cost time: 11.24708342552185
Epoch: 4, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.269 Vali Acc: 0.912 Test Loss: 0.269 Test Acc: 0.912
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.526820659637451
Epoch: 5, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
Validation loss decreased (-0.942895 --> -0.949163).  Saving model ...
Epoch: 6 cost time: 11.386438369750977
Epoch: 6, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.169 Vali Acc: 0.953 Test Loss: 0.169 Test Acc: 0.953
Validation loss decreased (-0.949163 --> -0.952645).  Saving model ...
Epoch: 7 cost time: 10.577992916107178
Epoch: 7, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.221 Vali Acc: 0.943 Test Loss: 0.221 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.424775838851929
Epoch: 8, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 10.889147520065308
Epoch: 9, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.180 Vali Acc: 0.948 Test Loss: 0.180 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 10.321753025054932
Epoch: 10, Steps: 89 | Train Loss: 0.229 Vali Loss: 0.338 Vali Acc: 0.905 Test Loss: 0.338 Test Acc: 0.905
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 11.09411358833313
Epoch: 11, Steps: 89 | Train Loss: 0.299 Vali Loss: 0.898 Vali Acc: 0.770 Test Loss: 0.898 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 10.7722647190094
Epoch: 12, Steps: 89 | Train Loss: 0.753 Vali Loss: 0.518 Vali Acc: 0.848 Test Loss: 0.518 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 11.153605461120605
Epoch: 13, Steps: 89 | Train Loss: 0.820 Vali Loss: 1.275 Vali Acc: 0.636 Test Loss: 1.275 Test Acc: 0.636
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 11.666460752487183
Epoch: 14, Steps: 89 | Train Loss: 1.268 Vali Loss: 1.276 Vali Acc: 0.653 Test Loss: 1.276 Test Acc: 0.653
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 10.730512619018555
Epoch: 15, Steps: 89 | Train Loss: 1.389 Vali Loss: 1.200 Vali Acc: 0.635 Test Loss: 1.200 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 10.971613645553589
Epoch: 16, Steps: 89 | Train Loss: 1.449 Vali Loss: 1.346 Vali Acc: 0.611 Test Loss: 1.346 Test Acc: 0.611
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9526462395543176
model parameter : 10771536
model size : 46.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 12.82025146484375
Epoch: 1, Steps: 89 | Train Loss: 1.849 Vali Loss: 0.550 Vali Acc: 0.858 Test Loss: 0.550 Test Acc: 0.858
Validation loss decreased (inf --> -0.857933).  Saving model ...
Epoch: 2 cost time: 10.202851057052612
Epoch: 2, Steps: 89 | Train Loss: 0.374 Vali Loss: 0.227 Vali Acc: 0.928 Test Loss: 0.227 Test Acc: 0.928
Validation loss decreased (-0.857933 --> -0.927574).  Saving model ...
Epoch: 3 cost time: 11.359561920166016
Epoch: 3, Steps: 89 | Train Loss: 0.253 Vali Loss: 0.259 Vali Acc: 0.912 Test Loss: 0.259 Test Acc: 0.912
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.603778600692749
Epoch: 4, Steps: 89 | Train Loss: 0.197 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
Validation loss decreased (-0.927574 --> -0.961698).  Saving model ...
Epoch: 5 cost time: 10.81027340888977
Epoch: 5, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.215 Vali Acc: 0.942 Test Loss: 0.215 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.027573823928833
Epoch: 6, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.187 Vali Acc: 0.940 Test Loss: 0.187 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 11.833810329437256
Epoch: 7, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.294 Vali Acc: 0.918 Test Loss: 0.294 Test Acc: 0.918
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 11.046878337860107
Epoch: 8, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.173 Vali Acc: 0.956 Test Loss: 0.173 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 11.128790855407715
Epoch: 9, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.185 Vali Acc: 0.945 Test Loss: 0.185 Test Acc: 0.945
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 11.911683559417725
Epoch: 10, Steps: 89 | Train Loss: 0.212 Vali Loss: 0.293 Vali Acc: 0.909 Test Loss: 0.293 Test Acc: 0.909
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 11.506125450134277
Epoch: 11, Steps: 89 | Train Loss: 0.266 Vali Loss: 0.231 Vali Acc: 0.932 Test Loss: 0.231 Test Acc: 0.932
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 12.567319869995117
Epoch: 12, Steps: 89 | Train Loss: 0.343 Vali Loss: 0.355 Vali Acc: 0.896 Test Loss: 0.355 Test Acc: 0.896
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 11.23863410949707
Epoch: 13, Steps: 89 | Train Loss: 0.612 Vali Loss: 0.659 Vali Acc: 0.813 Test Loss: 0.659 Test Acc: 0.813
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 10.62276315689087
Epoch: 14, Steps: 89 | Train Loss: 0.699 Vali Loss: 0.490 Vali Acc: 0.853 Test Loss: 0.490 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9616991643454039
model parameter : 10763856
model size : 46.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 15.049940347671509
Epoch: 1, Steps: 89 | Train Loss: 1.905 Vali Loss: 0.606 Vali Acc: 0.845 Test Loss: 0.606 Test Acc: 0.845
Validation loss decreased (inf --> -0.845398).  Saving model ...
Epoch: 2 cost time: 12.069506406784058
Epoch: 2, Steps: 89 | Train Loss: 0.456 Vali Loss: 0.319 Vali Acc: 0.914 Test Loss: 0.319 Test Acc: 0.914
Validation loss decreased (-0.845398 --> -0.914342).  Saving model ...
Epoch: 3 cost time: 10.965656518936157
Epoch: 3, Steps: 89 | Train Loss: 0.244 Vali Loss: 0.302 Vali Acc: 0.887 Test Loss: 0.302 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.273885726928711
Epoch: 4, Steps: 89 | Train Loss: 0.192 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.914342 --> -0.943591).  Saving model ...
Epoch: 5 cost time: 11.748509407043457
Epoch: 5, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.206 Vali Acc: 0.941 Test Loss: 0.206 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.728143453598022
Epoch: 6, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.118 Vali Acc: 0.960 Test Loss: 0.118 Test Acc: 0.960
Validation loss decreased (-0.943591 --> -0.960305).  Saving model ...
Epoch: 7 cost time: 12.208686828613281
Epoch: 7, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.205 Vali Acc: 0.936 Test Loss: 0.205 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 12.05391526222229
Epoch: 8, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.223 Vali Acc: 0.928 Test Loss: 0.223 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 13.042606353759766
Epoch: 9, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.220 Vali Acc: 0.935 Test Loss: 0.220 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 11.634822845458984
Epoch: 10, Steps: 89 | Train Loss: 0.256 Vali Loss: 0.214 Vali Acc: 0.936 Test Loss: 0.214 Test Acc: 0.936
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 10.22483229637146
Epoch: 11, Steps: 89 | Train Loss: 0.323 Vali Loss: 0.371 Vali Acc: 0.892 Test Loss: 0.371 Test Acc: 0.892
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 10.780487537384033
Epoch: 12, Steps: 89 | Train Loss: 0.606 Vali Loss: 0.649 Vali Acc: 0.802 Test Loss: 0.649 Test Acc: 0.802
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 11.519857168197632
Epoch: 13, Steps: 89 | Train Loss: 0.673 Vali Loss: 0.374 Vali Acc: 0.881 Test Loss: 0.374 Test Acc: 0.881
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 10.904216051101685
Epoch: 14, Steps: 89 | Train Loss: 0.696 Vali Loss: 0.735 Vali Acc: 0.779 Test Loss: 0.735 Test Acc: 0.779
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 10.798453569412231
Epoch: 15, Steps: 89 | Train Loss: 0.681 Vali Loss: 0.610 Vali Acc: 0.805 Test Loss: 0.610 Test Acc: 0.805
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 10.591578722000122
Epoch: 16, Steps: 89 | Train Loss: 2.018 Vali Loss: 2.313 Vali Acc: 0.285 Test Loss: 2.313 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9603064066852368
model parameter : 10756176
model size : 46.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.657551050186157
Epoch: 1, Steps: 89 | Train Loss: 1.893 Vali Loss: 0.689 Vali Acc: 0.812 Test Loss: 0.689 Test Acc: 0.812
Validation loss decreased (inf --> -0.811971).  Saving model ...
Epoch: 2 cost time: 11.739198207855225
Epoch: 2, Steps: 89 | Train Loss: 0.422 Vali Loss: 0.309 Vali Acc: 0.916 Test Loss: 0.309 Test Acc: 0.916
Validation loss decreased (-0.811971 --> -0.915735).  Saving model ...
Epoch: 3 cost time: 11.830779552459717
Epoch: 3, Steps: 89 | Train Loss: 0.238 Vali Loss: 0.308 Vali Acc: 0.902 Test Loss: 0.308 Test Acc: 0.902
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.256054878234863
Epoch: 4, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.190 Vali Acc: 0.934 Test Loss: 0.190 Test Acc: 0.934
Validation loss decreased (-0.915735 --> -0.933842).  Saving model ...
Epoch: 5 cost time: 11.515617847442627
Epoch: 5, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.249 Vali Acc: 0.930 Test Loss: 0.249 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.81728720664978
Epoch: 6, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.208 Vali Acc: 0.934 Test Loss: 0.208 Test Acc: 0.934
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 11.18614649772644
Epoch: 7, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
Validation loss decreased (-0.933842 --> -0.949163).  Saving model ...
Epoch: 8 cost time: 11.282580375671387
Epoch: 8, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.632408380508423
Epoch: 9, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.171 Vali Acc: 0.946 Test Loss: 0.171 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.42573881149292
Epoch: 10, Steps: 89 | Train Loss: 0.211 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 12.256727457046509
Epoch: 11, Steps: 89 | Train Loss: 0.342 Vali Loss: 0.348 Vali Acc: 0.878 Test Loss: 0.348 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 12.596187829971313
Epoch: 12, Steps: 89 | Train Loss: 0.385 Vali Loss: 0.542 Vali Acc: 0.830 Test Loss: 0.542 Test Acc: 0.830
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 11.10723876953125
Epoch: 13, Steps: 89 | Train Loss: 0.760 Vali Loss: 0.903 Vali Acc: 0.714 Test Loss: 0.903 Test Acc: 0.714
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 11.314226388931274
Epoch: 14, Steps: 89 | Train Loss: 0.880 Vali Loss: 4.689 Vali Acc: 0.102 Test Loss: 4.689 Test Acc: 0.102
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 11.910011768341064
Epoch: 15, Steps: 89 | Train Loss: 1.259 Vali Loss: 1.255 Vali Acc: 0.623 Test Loss: 1.255 Test Acc: 0.623
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 11.351550579071045
Epoch: 16, Steps: 89 | Train Loss: 1.462 Vali Loss: 1.298 Vali Acc: 0.601 Test Loss: 1.298 Test Acc: 0.601
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 11.839612245559692
Epoch: 17, Steps: 89 | Train Loss: 1.661 Vali Loss: 1.989 Vali Acc: 0.396 Test Loss: 1.989 Test Acc: 0.396
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9491643454038997
model parameter : 10188240
model size : 43.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 15.593703985214233
Epoch: 1, Steps: 89 | Train Loss: 1.913 Vali Loss: 0.665 Vali Acc: 0.827 Test Loss: 0.665 Test Acc: 0.827
Validation loss decreased (inf --> -0.827291).  Saving model ...
Epoch: 2 cost time: 12.823087930679321
Epoch: 2, Steps: 89 | Train Loss: 0.432 Vali Loss: 0.372 Vali Acc: 0.871 Test Loss: 0.372 Test Acc: 0.871
Validation loss decreased (-0.827291 --> -0.871166).  Saving model ...
Epoch: 3 cost time: 12.02713131904602
Epoch: 3, Steps: 89 | Train Loss: 0.219 Vali Loss: 0.191 Vali Acc: 0.942 Test Loss: 0.191 Test Acc: 0.942
Validation loss decreased (-0.871166 --> -0.942199).  Saving model ...
Epoch: 4 cost time: 11.06484317779541
Epoch: 4, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.152 Vali Acc: 0.948 Test Loss: 0.152 Test Acc: 0.948
Validation loss decreased (-0.942199 --> -0.947770).  Saving model ...
Epoch: 5 cost time: 12.48142671585083
Epoch: 5, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.157 Vali Acc: 0.948 Test Loss: 0.157 Test Acc: 0.948
Validation loss decreased (-0.947770 --> -0.948466).  Saving model ...
Epoch: 6 cost time: 11.777954578399658
Epoch: 6, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.151 Vali Acc: 0.960 Test Loss: 0.151 Test Acc: 0.960
Validation loss decreased (-0.948466 --> -0.959609).  Saving model ...
Epoch: 7 cost time: 11.518874406814575
Epoch: 7, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
Validation loss decreased (-0.959609 --> -0.969358).  Saving model ...
Epoch: 8 cost time: 12.69051480293274
Epoch: 8, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.158 Vali Acc: 0.953 Test Loss: 0.158 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.682368993759155
Epoch: 9, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.196 Vali Acc: 0.946 Test Loss: 0.196 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 11.285756349563599
Epoch: 10, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.267 Vali Acc: 0.911 Test Loss: 0.267 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 11.470522403717041
Epoch: 11, Steps: 89 | Train Loss: 0.260 Vali Loss: 0.472 Vali Acc: 0.861 Test Loss: 0.472 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 11.464982748031616
Epoch: 12, Steps: 89 | Train Loss: 0.374 Vali Loss: 0.374 Vali Acc: 0.890 Test Loss: 0.374 Test Acc: 0.890
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 12.648457288742065
Epoch: 13, Steps: 89 | Train Loss: 0.879 Vali Loss: 1.048 Vali Acc: 0.712 Test Loss: 1.048 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 11.591217994689941
Epoch: 14, Steps: 89 | Train Loss: 1.079 Vali Loss: 1.471 Vali Acc: 0.540 Test Loss: 1.471 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 11.888243675231934
Epoch: 15, Steps: 89 | Train Loss: 1.737 Vali Loss: 1.329 Vali Acc: 0.581 Test Loss: 1.329 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 13.329659700393677
Epoch: 16, Steps: 89 | Train Loss: 2.076 Vali Loss: 2.034 Vali Acc: 0.463 Test Loss: 2.034 Test Acc: 0.463
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 12.218053817749023
Epoch: 17, Steps: 89 | Train Loss: 1.602 Vali Loss: 1.307 Vali Acc: 0.588 Test Loss: 1.307 Test Acc: 0.588
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9693593314763231
model parameter : 10180560
model size : 43.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 16.473238229751587
Epoch: 1, Steps: 89 | Train Loss: 1.865 Vali Loss: 0.555 Vali Acc: 0.864 Test Loss: 0.555 Test Acc: 0.864
Validation loss decreased (inf --> -0.864201).  Saving model ...
Epoch: 2 cost time: 13.636396169662476
Epoch: 2, Steps: 89 | Train Loss: 0.411 Vali Loss: 0.273 Vali Acc: 0.935 Test Loss: 0.273 Test Acc: 0.935
Validation loss decreased (-0.864201 --> -0.935234).  Saving model ...
Epoch: 3 cost time: 15.171563863754272
Epoch: 3, Steps: 89 | Train Loss: 0.243 Vali Loss: 0.217 Vali Acc: 0.932 Test Loss: 0.217 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.857606172561646
Epoch: 4, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.166 Vali Acc: 0.941 Test Loss: 0.166 Test Acc: 0.941
Validation loss decreased (-0.935234 --> -0.940806).  Saving model ...
Epoch: 5 cost time: 13.860700368881226
Epoch: 5, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.229 Vali Acc: 0.921 Test Loss: 0.229 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 14.166654109954834
Epoch: 6, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.146 Vali Acc: 0.953 Test Loss: 0.146 Test Acc: 0.953
Validation loss decreased (-0.940806 --> -0.952645).  Saving model ...
Epoch: 7 cost time: 15.013116359710693
Epoch: 7, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
Validation loss decreased (-0.952645 --> -0.965180).  Saving model ...
Epoch: 8 cost time: 13.882878303527832
Epoch: 8, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.167 Vali Acc: 0.952 Test Loss: 0.167 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.990890502929688
Epoch: 9, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.192 Vali Acc: 0.940 Test Loss: 0.192 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 13.553456544876099
Epoch: 10, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.384 Vali Acc: 0.916 Test Loss: 0.384 Test Acc: 0.916
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 13.549338102340698
Epoch: 11, Steps: 89 | Train Loss: 0.283 Vali Loss: 0.228 Vali Acc: 0.932 Test Loss: 0.228 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 12.496952056884766
Epoch: 12, Steps: 89 | Train Loss: 0.370 Vali Loss: 0.452 Vali Acc: 0.861 Test Loss: 0.452 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 12.435715913772583
Epoch: 13, Steps: 89 | Train Loss: 1.055 Vali Loss: 1.717 Vali Acc: 0.529 Test Loss: 1.717 Test Acc: 0.529
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 12.75770354270935
Epoch: 14, Steps: 89 | Train Loss: 2.317 Vali Loss: 2.161 Vali Acc: 0.358 Test Loss: 2.161 Test Acc: 0.358
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 13.310720443725586
Epoch: 15, Steps: 89 | Train Loss: 2.369 Vali Loss: 1.951 Vali Acc: 0.402 Test Loss: 1.951 Test Acc: 0.402
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 13.65234899520874
Epoch: 16, Steps: 89 | Train Loss: 1.985 Vali Loss: 1.658 Vali Acc: 0.494 Test Loss: 1.658 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 12.455469608306885
Epoch: 17, Steps: 89 | Train Loss: 1.415 Vali Loss: 1.048 Vali Acc: 0.644 Test Loss: 1.048 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9651810584958217
model parameter : 10172880
model size : 43.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.89295244216919
Epoch: 1, Steps: 89 | Train Loss: 1.857 Vali Loss: 0.660 Vali Acc: 0.788 Test Loss: 0.660 Test Acc: 0.788
Validation loss decreased (inf --> -0.788294).  Saving model ...
Epoch: 2 cost time: 13.086089134216309
Epoch: 2, Steps: 89 | Train Loss: 0.426 Vali Loss: 0.320 Vali Acc: 0.909 Test Loss: 0.320 Test Acc: 0.909
Validation loss decreased (-0.788294 --> -0.908771).  Saving model ...
Epoch: 3 cost time: 12.725621461868286
Epoch: 3, Steps: 89 | Train Loss: 0.215 Vali Loss: 0.237 Vali Acc: 0.938 Test Loss: 0.237 Test Acc: 0.938
Validation loss decreased (-0.908771 --> -0.938020).  Saving model ...
Epoch: 4 cost time: 12.576377630233765
Epoch: 4, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.144 Vali Acc: 0.951 Test Loss: 0.144 Test Acc: 0.951
Validation loss decreased (-0.938020 --> -0.950556).  Saving model ...
Epoch: 5 cost time: 13.3448166847229
Epoch: 5, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.220 Vali Acc: 0.926 Test Loss: 0.220 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.81717038154602
Epoch: 6, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.223 Vali Acc: 0.933 Test Loss: 0.223 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 13.524935245513916
Epoch: 7, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
Validation loss decreased (-0.950556 --> -0.956823).  Saving model ...
Epoch: 8 cost time: 12.633092641830444
Epoch: 8, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
Validation loss decreased (-0.956823 --> -0.965180).  Saving model ...
Epoch: 9 cost time: 12.037180185317993
Epoch: 9, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.166 Vali Acc: 0.950 Test Loss: 0.166 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.881898880004883
Epoch: 10, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 13.456244707107544
Epoch: 11, Steps: 89 | Train Loss: 0.292 Vali Loss: 0.233 Vali Acc: 0.930 Test Loss: 0.233 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 13.758681774139404
Epoch: 12, Steps: 89 | Train Loss: 0.387 Vali Loss: 0.484 Vali Acc: 0.842 Test Loss: 0.484 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 13.414013624191284
Epoch: 13, Steps: 89 | Train Loss: 0.488 Vali Loss: 0.421 Vali Acc: 0.868 Test Loss: 0.421 Test Acc: 0.868
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 12.651438474655151
Epoch: 14, Steps: 89 | Train Loss: 0.800 Vali Loss: 0.632 Vali Acc: 0.817 Test Loss: 0.632 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 12.436363697052002
Epoch: 15, Steps: 89 | Train Loss: 1.421 Vali Loss: 0.825 Vali Acc: 0.725 Test Loss: 0.825 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 12.561837911605835
Epoch: 16, Steps: 89 | Train Loss: 1.180 Vali Loss: 0.641 Vali Acc: 0.806 Test Loss: 0.641 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 11.945241451263428
Epoch: 17, Steps: 89 | Train Loss: 1.547 Vali Loss: 3.587 Vali Acc: 0.228 Test Loss: 3.587 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 11.843246459960938
Epoch: 18, Steps: 89 | Train Loss: 2.967 Vali Loss: 3.243 Vali Acc: 0.047 Test Loss: 3.243 Test Acc: 0.047
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9651810584958217
model parameter : 10165200
model size : 43.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 17.11254119873047
Epoch: 1, Steps: 89 | Train Loss: 2.113 Vali Loss: 0.815 Vali Acc: 0.802 Test Loss: 0.815 Test Acc: 0.802
Validation loss decreased (inf --> -0.801524).  Saving model ...
Epoch: 2 cost time: 12.879836559295654
Epoch: 2, Steps: 89 | Train Loss: 0.556 Vali Loss: 0.388 Vali Acc: 0.900 Test Loss: 0.388 Test Acc: 0.900
Validation loss decreased (-0.801524 --> -0.899718).  Saving model ...
Epoch: 3 cost time: 13.424233436584473
Epoch: 3, Steps: 89 | Train Loss: 0.313 Vali Loss: 0.187 Vali Acc: 0.951 Test Loss: 0.187 Test Acc: 0.951
Validation loss decreased (-0.899718 --> -0.951252).  Saving model ...
Epoch: 4 cost time: 15.489238023757935
Epoch: 4, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
Validation loss decreased (-0.951252 --> -0.951252).  Saving model ...
Epoch: 5 cost time: 14.758480548858643
Epoch: 5, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
Validation loss decreased (-0.951252 --> -0.951252).  Saving model ...
Epoch: 6 cost time: 15.283578157424927
Epoch: 6, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
Validation loss decreased (-0.951252 --> -0.967965).  Saving model ...
Epoch: 7 cost time: 12.077769994735718
Epoch: 7, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.149 Vali Acc: 0.960 Test Loss: 0.149 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 13.84552788734436
Epoch: 8, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
Validation loss decreased (-0.967965 --> -0.970055).  Saving model ...
Epoch: 9 cost time: 13.746224164962769
Epoch: 9, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.125 Vali Acc: 0.964 Test Loss: 0.125 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 12.678519010543823
Epoch: 10, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
Validation loss decreased (-0.970055 --> -0.980501).  Saving model ...
Epoch: 11 cost time: 13.182212114334106
Epoch: 11, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.208 Vali Acc: 0.932 Test Loss: 0.208 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 13.460062503814697
Epoch: 12, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.205 Vali Acc: 0.952 Test Loss: 0.205 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 13.192529201507568
Epoch: 13, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 12.759050846099854
Epoch: 14, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 13.287058591842651
Epoch: 15, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.195 Vali Acc: 0.947 Test Loss: 0.195 Test Acc: 0.947
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 14.716349601745605
Epoch: 16, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.295 Vali Acc: 0.928 Test Loss: 0.295 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 15.371982097625732
Epoch: 17, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.333 Vali Acc: 0.900 Test Loss: 0.333 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 13.498236179351807
Epoch: 18, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.242 Vali Acc: 0.924 Test Loss: 0.242 Test Acc: 0.924
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 15.294721126556396
Epoch: 19, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 12.823393821716309
Epoch: 20, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.211 Vali Acc: 0.939 Test Loss: 0.211 Test Acc: 0.939
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 4807888
model size : 20.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 15.875752210617065
Epoch: 1, Steps: 89 | Train Loss: 2.105 Vali Loss: 0.849 Vali Acc: 0.797 Test Loss: 0.849 Test Acc: 0.797
Validation loss decreased (inf --> -0.796649).  Saving model ...
Epoch: 2 cost time: 13.494791507720947
Epoch: 2, Steps: 89 | Train Loss: 0.579 Vali Loss: 0.355 Vali Acc: 0.916 Test Loss: 0.355 Test Acc: 0.916
Validation loss decreased (-0.796649 --> -0.915735).  Saving model ...
Epoch: 3 cost time: 14.175189018249512
Epoch: 3, Steps: 89 | Train Loss: 0.306 Vali Loss: 0.243 Vali Acc: 0.928 Test Loss: 0.243 Test Acc: 0.928
Validation loss decreased (-0.915735 --> -0.927574).  Saving model ...
Epoch: 4 cost time: 12.045464754104614
Epoch: 4, Steps: 89 | Train Loss: 0.186 Vali Loss: 0.278 Vali Acc: 0.912 Test Loss: 0.278 Test Acc: 0.912
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.910458326339722
Epoch: 5, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.146 Vali Acc: 0.958 Test Loss: 0.146 Test Acc: 0.958
Validation loss decreased (-0.927574 --> -0.957519).  Saving model ...
Epoch: 6 cost time: 13.292937278747559
Epoch: 6, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.141 Vali Acc: 0.956 Test Loss: 0.141 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 13.905345916748047
Epoch: 7, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 13.03012752532959
Epoch: 8, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.183 Vali Acc: 0.947 Test Loss: 0.183 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 12.348000288009644
Epoch: 9, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.164 Vali Acc: 0.957 Test Loss: 0.164 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 12.702651977539062
Epoch: 10, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
Validation loss decreased (-0.957519 --> -0.975626).  Saving model ...
Epoch: 11 cost time: 12.468489408493042
Epoch: 11, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.107 Vali Acc: 0.966 Test Loss: 0.107 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 14.397388696670532
Epoch: 12, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.299 Vali Acc: 0.912 Test Loss: 0.299 Test Acc: 0.912
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 13.162572622299194
Epoch: 13, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.155 Vali Acc: 0.946 Test Loss: 0.155 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 13.413297176361084
Epoch: 14, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.086 Vali Acc: 0.974 Test Loss: 0.086 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 13.651186466217041
Epoch: 15, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.138 Vali Acc: 0.956 Test Loss: 0.138 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 13.886813640594482
Epoch: 16, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.136 Vali Acc: 0.963 Test Loss: 0.136 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 13.908691644668579
Epoch: 17, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.193 Vali Acc: 0.937 Test Loss: 0.193 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 12.766026973724365
Epoch: 18, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.159 Vali Acc: 0.953 Test Loss: 0.159 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 12.710535764694214
Epoch: 19, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 13.171559810638428
Epoch: 20, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 4804048
model size : 20.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.71814775466919
Epoch: 1, Steps: 89 | Train Loss: 2.105 Vali Loss: 0.895 Vali Acc: 0.734 Test Loss: 0.895 Test Acc: 0.734
Validation loss decreased (inf --> -0.733974).  Saving model ...
Epoch: 2 cost time: 12.144708633422852
Epoch: 2, Steps: 89 | Train Loss: 0.538 Vali Loss: 0.466 Vali Acc: 0.865 Test Loss: 0.466 Test Acc: 0.865
Validation loss decreased (-0.733974 --> -0.864898).  Saving model ...
Epoch: 3 cost time: 13.168827295303345
Epoch: 3, Steps: 89 | Train Loss: 0.303 Vali Loss: 0.273 Vali Acc: 0.923 Test Loss: 0.273 Test Acc: 0.923
Validation loss decreased (-0.864898 --> -0.922699).  Saving model ...
Epoch: 4 cost time: 13.439638614654541
Epoch: 4, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.184 Vali Acc: 0.939 Test Loss: 0.184 Test Acc: 0.939
Validation loss decreased (-0.922699 --> -0.938717).  Saving model ...
Epoch: 5 cost time: 12.49921727180481
Epoch: 5, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.209 Vali Acc: 0.932 Test Loss: 0.209 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.708796501159668
Epoch: 6, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.144 Vali Acc: 0.947 Test Loss: 0.144 Test Acc: 0.947
Validation loss decreased (-0.938717 --> -0.947074).  Saving model ...
Epoch: 7 cost time: 13.975074052810669
Epoch: 7, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
Validation loss decreased (-0.947074 --> -0.957519).  Saving model ...
Epoch: 8 cost time: 13.546194791793823
Epoch: 8, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.111 Vali Acc: 0.967 Test Loss: 0.111 Test Acc: 0.967
Validation loss decreased (-0.957519 --> -0.966573).  Saving model ...
Epoch: 9 cost time: 14.293517351150513
Epoch: 9, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.966573 --> -0.972840).  Saving model ...
Epoch: 10 cost time: 13.34796667098999
Epoch: 10, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.119 Vali Acc: 0.963 Test Loss: 0.119 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 13.238914012908936
Epoch: 11, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.144 Vali Acc: 0.951 Test Loss: 0.144 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 11.845532655715942
Epoch: 12, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 13.223117589950562
Epoch: 13, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.144 Vali Acc: 0.953 Test Loss: 0.144 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 13.635948657989502
Epoch: 14, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.142 Vali Acc: 0.954 Test Loss: 0.142 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 13.145950317382812
Epoch: 15, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.107 Vali Acc: 0.961 Test Loss: 0.107 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 13.6897451877594
Epoch: 16, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 12.702481269836426
Epoch: 17, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.255 Vali Acc: 0.926 Test Loss: 0.255 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 12.450995922088623
Epoch: 18, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.156 Vali Acc: 0.960 Test Loss: 0.156 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 13.290671348571777
Epoch: 19, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.327 Vali Acc: 0.903 Test Loss: 0.327 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9728412256267409
model parameter : 4800208
model size : 20.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 14.665088653564453
Epoch: 1, Steps: 89 | Train Loss: 2.117 Vali Loss: 0.896 Vali Acc: 0.724 Test Loss: 0.896 Test Acc: 0.724
Validation loss decreased (inf --> -0.723529).  Saving model ...
Epoch: 2 cost time: 11.870435237884521
Epoch: 2, Steps: 89 | Train Loss: 0.590 Vali Loss: 0.406 Vali Acc: 0.880 Test Loss: 0.406 Test Acc: 0.880
Validation loss decreased (-0.723529 --> -0.880219).  Saving model ...
Epoch: 3 cost time: 13.565200090408325
Epoch: 3, Steps: 89 | Train Loss: 0.292 Vali Loss: 0.201 Vali Acc: 0.946 Test Loss: 0.201 Test Acc: 0.946
Validation loss decreased (-0.880219 --> -0.945680).  Saving model ...
Epoch: 4 cost time: 14.363301515579224
Epoch: 4, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.199 Vali Acc: 0.939 Test Loss: 0.199 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.58646821975708
Epoch: 5, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
Validation loss decreased (-0.945680 --> -0.968662).  Saving model ...
Epoch: 6 cost time: 14.43652868270874
Epoch: 6, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.163 Vali Acc: 0.953 Test Loss: 0.163 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.334879159927368
Epoch: 7, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.176 Vali Acc: 0.946 Test Loss: 0.176 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 14.612182140350342
Epoch: 8, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.152 Vali Acc: 0.946 Test Loss: 0.152 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 12.641257047653198
Epoch: 9, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.170 Vali Acc: 0.941 Test Loss: 0.170 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 12.89549446105957
Epoch: 10, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.125 Vali Acc: 0.961 Test Loss: 0.125 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 12.65347695350647
Epoch: 11, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.968662 --> -0.972840).  Saving model ...
Epoch: 12 cost time: 12.229482173919678
Epoch: 12, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 13.916701078414917
Epoch: 13, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 13.693753719329834
Epoch: 14, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.182 Vali Acc: 0.946 Test Loss: 0.182 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 14.978647232055664
Epoch: 15, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 12.778531789779663
Epoch: 16, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 11.562391996383667
Epoch: 17, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 12.275206327438354
Epoch: 18, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.126 Vali Acc: 0.964 Test Loss: 0.126 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 13.010827541351318
Epoch: 19, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.129 Vali Acc: 0.958 Test Loss: 0.129 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 13.347676753997803
Epoch: 20, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.096 Vali Acc: 0.972 Test Loss: 0.096 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 13.750062704086304
Epoch: 21, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9728412256267409
model parameter : 4796368
model size : 20.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 14.876934051513672
Epoch: 1, Steps: 89 | Train Loss: 2.230 Vali Loss: 0.875 Vali Acc: 0.801 Test Loss: 0.875 Test Acc: 0.801
Validation loss decreased (inf --> -0.800827).  Saving model ...
Epoch: 2 cost time: 14.264668703079224
Epoch: 2, Steps: 89 | Train Loss: 0.593 Vali Loss: 0.393 Vali Acc: 0.916 Test Loss: 0.393 Test Acc: 0.916
Validation loss decreased (-0.800827 --> -0.916431).  Saving model ...
Epoch: 3 cost time: 14.657444953918457
Epoch: 3, Steps: 89 | Train Loss: 0.294 Vali Loss: 0.227 Vali Acc: 0.937 Test Loss: 0.227 Test Acc: 0.937
Validation loss decreased (-0.916431 --> -0.937324).  Saving model ...
Epoch: 4 cost time: 12.69724416732788
Epoch: 4, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.433400630950928
Epoch: 5, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
Validation loss decreased (-0.937324 --> -0.958912).  Saving model ...
Epoch: 6 cost time: 12.4426589012146
Epoch: 6, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.175 Vali Acc: 0.948 Test Loss: 0.175 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 13.448016881942749
Epoch: 7, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.136 Vali Acc: 0.960 Test Loss: 0.136 Test Acc: 0.960
Validation loss decreased (-0.958912 --> -0.959609).  Saving model ...
Epoch: 8 cost time: 13.74313235282898
Epoch: 8, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.142 Vali Acc: 0.960 Test Loss: 0.142 Test Acc: 0.960
Validation loss decreased (-0.959609 --> -0.960305).  Saving model ...
Epoch: 9 cost time: 15.603812217712402
Epoch: 9, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.183 Vali Acc: 0.941 Test Loss: 0.183 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 14.163878679275513
Epoch: 10, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.112 Vali Acc: 0.967 Test Loss: 0.112 Test Acc: 0.967
Validation loss decreased (-0.960305 --> -0.967269).  Saving model ...
Epoch: 11 cost time: 13.145690202713013
Epoch: 11, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.164 Vali Acc: 0.953 Test Loss: 0.164 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 11.503486394882202
Epoch: 12, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.125 Vali Acc: 0.969 Test Loss: 0.125 Test Acc: 0.969
Validation loss decreased (-0.967269 --> -0.968662).  Saving model ...
Epoch: 13 cost time: 11.759190559387207
Epoch: 13, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.229 Vali Acc: 0.930 Test Loss: 0.229 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 12.269748210906982
Epoch: 14, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.104 Vali Acc: 0.967 Test Loss: 0.104 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 14.005129337310791
Epoch: 15, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.128 Vali Acc: 0.964 Test Loss: 0.128 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 12.282504796981812
Epoch: 16, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.150 Vali Acc: 0.944 Test Loss: 0.150 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 11.9376962184906
Epoch: 17, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.123 Vali Acc: 0.960 Test Loss: 0.123 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 11.802347183227539
Epoch: 18, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.182 Vali Acc: 0.940 Test Loss: 0.182 Test Acc: 0.940
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 12.121745824813843
Epoch: 19, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.131 Vali Acc: 0.960 Test Loss: 0.131 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 11.943949460983276
Epoch: 20, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.127 Vali Acc: 0.960 Test Loss: 0.127 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 11.735715627670288
Epoch: 21, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 11.632138729095459
Epoch: 22, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.116 Vali Acc: 0.958 Test Loss: 0.116 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9686629526462396
model parameter : 3623632
model size : 16.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.883776664733887
Epoch: 1, Steps: 89 | Train Loss: 2.236 Vali Loss: 0.939 Vali Acc: 0.763 Test Loss: 0.939 Test Acc: 0.763
Validation loss decreased (inf --> -0.763222).  Saving model ...
Epoch: 2 cost time: 12.225866079330444
Epoch: 2, Steps: 89 | Train Loss: 0.619 Vali Loss: 0.528 Vali Acc: 0.843 Test Loss: 0.528 Test Acc: 0.843
Validation loss decreased (-0.763222 --> -0.842613).  Saving model ...
Epoch: 3 cost time: 12.172127485275269
Epoch: 3, Steps: 89 | Train Loss: 0.305 Vali Loss: 0.258 Vali Acc: 0.916 Test Loss: 0.258 Test Acc: 0.916
Validation loss decreased (-0.842613 --> -0.916432).  Saving model ...
Epoch: 4 cost time: 13.640256404876709
Epoch: 4, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.194 Vali Acc: 0.940 Test Loss: 0.194 Test Acc: 0.940
Validation loss decreased (-0.916432 --> -0.940109).  Saving model ...
Epoch: 5 cost time: 11.146382093429565
Epoch: 5, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.137 Vali Acc: 0.960 Test Loss: 0.137 Test Acc: 0.960
Validation loss decreased (-0.940109 --> -0.959609).  Saving model ...
Epoch: 6 cost time: 12.570180416107178
Epoch: 6, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.134 Vali Acc: 0.966 Test Loss: 0.134 Test Acc: 0.966
Validation loss decreased (-0.959609 --> -0.965876).  Saving model ...
Epoch: 7 cost time: 12.759160041809082
Epoch: 7, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.094 Vali Acc: 0.972 Test Loss: 0.094 Test Acc: 0.972
Validation loss decreased (-0.965876 --> -0.972144).  Saving model ...
Epoch: 8 cost time: 12.502821445465088
Epoch: 8, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.124 Vali Acc: 0.963 Test Loss: 0.124 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 13.258708238601685
Epoch: 9, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.105 Vali Acc: 0.967 Test Loss: 0.105 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.05259370803833
Epoch: 10, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 13.44058632850647
Epoch: 11, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.132 Vali Acc: 0.963 Test Loss: 0.132 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 14.547958374023438
Epoch: 12, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 13.132999420166016
Epoch: 13, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
Validation loss decreased (-0.972144 --> -0.976322).  Saving model ...
Epoch: 14 cost time: 14.772869110107422
Epoch: 14, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.146 Vali Acc: 0.959 Test Loss: 0.146 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 13.10562777519226
Epoch: 15, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.160 Vali Acc: 0.944 Test Loss: 0.160 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 12.378944635391235
Epoch: 16, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.136 Vali Acc: 0.960 Test Loss: 0.136 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 12.460515975952148
Epoch: 17, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.147 Vali Acc: 0.958 Test Loss: 0.147 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 12.1015145778656
Epoch: 18, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.111 Vali Acc: 0.964 Test Loss: 0.111 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 12.688647747039795
Epoch: 19, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 12.028378248214722
Epoch: 20, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.347 Vali Acc: 0.920 Test Loss: 0.347 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 13.179647207260132
Epoch: 21, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.191 Vali Acc: 0.951 Test Loss: 0.191 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 12.34985899925232
Epoch: 22, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.155 Vali Acc: 0.958 Test Loss: 0.155 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 12.366467714309692
Epoch: 23, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 3619792
model size : 16.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 15.266593217849731
Epoch: 1, Steps: 89 | Train Loss: 2.258 Vali Loss: 0.956 Vali Acc: 0.796 Test Loss: 0.956 Test Acc: 0.796
Validation loss decreased (inf --> -0.795951).  Saving model ...
Epoch: 2 cost time: 12.435801267623901
Epoch: 2, Steps: 89 | Train Loss: 0.635 Vali Loss: 0.401 Vali Acc: 0.896 Test Loss: 0.401 Test Acc: 0.896
Validation loss decreased (-0.795951 --> -0.896236).  Saving model ...
Epoch: 3 cost time: 13.241929769515991
Epoch: 3, Steps: 89 | Train Loss: 0.316 Vali Loss: 0.213 Vali Acc: 0.948 Test Loss: 0.213 Test Acc: 0.948
Validation loss decreased (-0.896236 --> -0.947769).  Saving model ...
Epoch: 4 cost time: 11.334250688552856
Epoch: 4, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.195 Vali Acc: 0.942 Test Loss: 0.195 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.591683387756348
Epoch: 5, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
Validation loss decreased (-0.947769 --> -0.958912).  Saving model ...
Epoch: 6 cost time: 11.369408369064331
Epoch: 6, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.130 Vali Acc: 0.958 Test Loss: 0.130 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.428983926773071
Epoch: 7, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
Validation loss decreased (-0.958912 --> -0.965180).  Saving model ...
Epoch: 8 cost time: 13.38253664970398
Epoch: 8, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.488794326782227
Epoch: 9, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.146361827850342
Epoch: 10, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
Validation loss decreased (-0.965180 --> -0.970055).  Saving model ...
Epoch: 11 cost time: 12.322765111923218
Epoch: 11, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.107 Vali Acc: 0.967 Test Loss: 0.107 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 11.396839380264282
Epoch: 12, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.156 Vali Acc: 0.944 Test Loss: 0.156 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.985021352767944
Epoch: 13, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 11.101240158081055
Epoch: 14, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.115 Vali Acc: 0.966 Test Loss: 0.115 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 11.823419570922852
Epoch: 15, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 11.987532138824463
Epoch: 16, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.100 Vali Acc: 0.972 Test Loss: 0.100 Test Acc: 0.972
Validation loss decreased (-0.970055 --> -0.972144).  Saving model ...
Epoch: 17 cost time: 10.832218885421753
Epoch: 17, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.125 Vali Acc: 0.960 Test Loss: 0.125 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 10.76398229598999
Epoch: 18, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.134 Vali Acc: 0.960 Test Loss: 0.134 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 10.725401163101196
Epoch: 19, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.110 Vali Acc: 0.972 Test Loss: 0.110 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 10.856508731842041
Epoch: 20, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.131 Vali Acc: 0.960 Test Loss: 0.131 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 12.124876260757446
Epoch: 21, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.129 Vali Acc: 0.960 Test Loss: 0.129 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 11.521571159362793
Epoch: 22, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.303 Vali Acc: 0.924 Test Loss: 0.303 Test Acc: 0.924
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 11.719361305236816
Epoch: 23, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.144 Vali Acc: 0.952 Test Loss: 0.144 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 11.345618486404419
Epoch: 24, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.224 Vali Acc: 0.936 Test Loss: 0.224 Test Acc: 0.936
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 12.19698166847229
Epoch: 25, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 12.089779376983643
Epoch: 26, Steps: 89 | Train Loss: 0.251 Vali Loss: 0.224 Vali Acc: 0.936 Test Loss: 0.224 Test Acc: 0.936
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9721448467966574
model parameter : 3615952
model size : 16.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.003058433532715
Epoch: 1, Steps: 89 | Train Loss: 2.337 Vali Loss: 1.019 Vali Acc: 0.726 Test Loss: 1.019 Test Acc: 0.726
Validation loss decreased (inf --> -0.725617).  Saving model ...
Epoch: 2 cost time: 12.416054487228394
Epoch: 2, Steps: 89 | Train Loss: 0.633 Vali Loss: 0.367 Vali Acc: 0.901 Test Loss: 0.367 Test Acc: 0.901
Validation loss decreased (-0.725617 --> -0.901111).  Saving model ...
Epoch: 3 cost time: 11.570306062698364
Epoch: 3, Steps: 89 | Train Loss: 0.287 Vali Loss: 0.222 Vali Acc: 0.939 Test Loss: 0.222 Test Acc: 0.939
Validation loss decreased (-0.901111 --> -0.938716).  Saving model ...
Epoch: 4 cost time: 12.7409508228302
Epoch: 4, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.167 Vali Acc: 0.954 Test Loss: 0.167 Test Acc: 0.954
Validation loss decreased (-0.938716 --> -0.954037).  Saving model ...
Epoch: 5 cost time: 12.650124073028564
Epoch: 5, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.250 Vali Acc: 0.933 Test Loss: 0.250 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.60265064239502
Epoch: 6, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.149 Vali Acc: 0.949 Test Loss: 0.149 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.381134986877441
Epoch: 7, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.131 Vali Acc: 0.960 Test Loss: 0.131 Test Acc: 0.960
Validation loss decreased (-0.954037 --> -0.960305).  Saving model ...
Epoch: 8 cost time: 11.413668394088745
Epoch: 8, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
Validation loss decreased (-0.960305 --> -0.967965).  Saving model ...
Epoch: 9 cost time: 11.315227031707764
Epoch: 9, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.967965 --> -0.972840).  Saving model ...
Epoch: 10 cost time: 12.603926658630371
Epoch: 10, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.105 Vali Acc: 0.972 Test Loss: 0.105 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 12.514230012893677
Epoch: 11, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 11.173429250717163
Epoch: 12, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.203 Vali Acc: 0.937 Test Loss: 0.203 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 11.35181188583374
Epoch: 13, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.273 Vali Acc: 0.912 Test Loss: 0.273 Test Acc: 0.912
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 11.614940166473389
Epoch: 14, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 10.600312948226929
Epoch: 15, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.974233).  Saving model ...
Epoch: 16 cost time: 10.896785497665405
Epoch: 16, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.120 Vali Acc: 0.959 Test Loss: 0.120 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 10.995590209960938
Epoch: 17, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.113 Vali Acc: 0.966 Test Loss: 0.113 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 10.927828788757324
Epoch: 18, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.081 Vali Acc: 0.975 Test Loss: 0.081 Test Acc: 0.975
Validation loss decreased (-0.974233 --> -0.974930).  Saving model ...
Epoch: 19 cost time: 11.711534023284912
Epoch: 19, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.159 Vali Acc: 0.948 Test Loss: 0.159 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 11.118227005004883
Epoch: 20, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.172 Vali Acc: 0.947 Test Loss: 0.172 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 12.456187725067139
Epoch: 21, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.184 Vali Acc: 0.945 Test Loss: 0.184 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 10.660919427871704
Epoch: 22, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.122 Vali Acc: 0.967 Test Loss: 0.122 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 10.657076120376587
Epoch: 23, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 11.856181383132935
Epoch: 24, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.225 Vali Acc: 0.928 Test Loss: 0.225 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 11.186476707458496
Epoch: 25, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.144 Vali Acc: 0.956 Test Loss: 0.144 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 12.95784616470337
Epoch: 26, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.179 Vali Acc: 0.946 Test Loss: 0.179 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 11.690611600875854
Epoch: 27, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.237 Vali Acc: 0.932 Test Loss: 0.237 Test Acc: 0.932
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 10.72428822517395
Epoch: 28, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.351 Vali Acc: 0.897 Test Loss: 0.351 Test Acc: 0.897
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9749303621169917
model parameter : 3612112
model size : 16.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 15.843772411346436
Epoch: 1, Steps: 89 | Train Loss: 2.375 Vali Loss: 1.072 Vali Acc: 0.722 Test Loss: 1.072 Test Acc: 0.722
Validation loss decreased (inf --> -0.722134).  Saving model ...
Epoch: 2 cost time: 15.237828969955444
Epoch: 2, Steps: 89 | Train Loss: 0.659 Vali Loss: 0.380 Vali Acc: 0.909 Test Loss: 0.380 Test Acc: 0.909
Validation loss decreased (-0.722134 --> -0.909467).  Saving model ...
Epoch: 3 cost time: 13.932733535766602
Epoch: 3, Steps: 89 | Train Loss: 0.332 Vali Loss: 0.228 Vali Acc: 0.937 Test Loss: 0.228 Test Acc: 0.937
Validation loss decreased (-0.909467 --> -0.936627).  Saving model ...
Epoch: 4 cost time: 14.241110563278198
Epoch: 4, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.189 Vali Acc: 0.942 Test Loss: 0.189 Test Acc: 0.942
Validation loss decreased (-0.936627 --> -0.941502).  Saving model ...
Epoch: 5 cost time: 13.389199018478394
Epoch: 5, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
Validation loss decreased (-0.941502 --> -0.943592).  Saving model ...
Epoch: 6 cost time: 13.558232069015503
Epoch: 6, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.167 Vali Acc: 0.943 Test Loss: 0.167 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 13.569139957427979
Epoch: 7, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.178 Vali Acc: 0.948 Test Loss: 0.178 Test Acc: 0.948
Validation loss decreased (-0.943592 --> -0.947770).  Saving model ...
Epoch: 8 cost time: 13.989476919174194
Epoch: 8, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.143 Vali Acc: 0.952 Test Loss: 0.143 Test Acc: 0.952
Validation loss decreased (-0.947770 --> -0.951948).  Saving model ...
Epoch: 9 cost time: 12.888860702514648
Epoch: 9, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.161 Vali Acc: 0.948 Test Loss: 0.161 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 12.000942468643188
Epoch: 10, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.214 Vali Acc: 0.939 Test Loss: 0.214 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 12.281131744384766
Epoch: 11, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
Validation loss decreased (-0.951948 --> -0.965180).  Saving model ...
Epoch: 12 cost time: 13.105793952941895
Epoch: 12, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.098 Vali Acc: 0.967 Test Loss: 0.098 Test Acc: 0.967
Validation loss decreased (-0.965180 --> -0.966573).  Saving model ...
Epoch: 13 cost time: 12.463534116744995
Epoch: 13, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
Validation loss decreased (-0.966573 --> -0.967966).  Saving model ...
Epoch: 14 cost time: 12.322413682937622
Epoch: 14, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.091 Vali Acc: 0.974 Test Loss: 0.091 Test Acc: 0.974
Validation loss decreased (-0.967966 --> -0.973537).  Saving model ...
Epoch: 15 cost time: 12.447707176208496
Epoch: 15, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.125 Vali Acc: 0.963 Test Loss: 0.125 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 12.618892908096313
Epoch: 16, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.243 Vali Acc: 0.919 Test Loss: 0.243 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 12.938416481018066
Epoch: 17, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.105 Vali Acc: 0.971 Test Loss: 0.105 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 12.873462677001953
Epoch: 18, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.135 Vali Acc: 0.958 Test Loss: 0.135 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 15.317945718765259
Epoch: 19, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.137 Vali Acc: 0.958 Test Loss: 0.137 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 12.717620134353638
Epoch: 20, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 10.869981050491333
Epoch: 21, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.122 Vali Acc: 0.966 Test Loss: 0.122 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 12.502157926559448
Epoch: 22, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 12.825645208358765
Epoch: 23, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.196 Vali Acc: 0.945 Test Loss: 0.196 Test Acc: 0.945
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 13.55441951751709
Epoch: 24, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.113 Vali Acc: 0.967 Test Loss: 0.113 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9735376044568245
model parameter : 3031504
model size : 14.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 15.80288028717041
Epoch: 1, Steps: 89 | Train Loss: 2.273 Vali Loss: 1.007 Vali Acc: 0.733 Test Loss: 1.007 Test Acc: 0.733
Validation loss decreased (inf --> -0.733277).  Saving model ...
Epoch: 2 cost time: 12.719092607498169
Epoch: 2, Steps: 89 | Train Loss: 0.604 Vali Loss: 0.381 Vali Acc: 0.896 Test Loss: 0.381 Test Acc: 0.896
Validation loss decreased (-0.733277 --> -0.896236).  Saving model ...
Epoch: 3 cost time: 10.913813352584839
Epoch: 3, Steps: 89 | Train Loss: 0.286 Vali Loss: 0.213 Vali Acc: 0.935 Test Loss: 0.213 Test Acc: 0.935
Validation loss decreased (-0.896236 --> -0.935235).  Saving model ...
Epoch: 4 cost time: 13.315563201904297
Epoch: 4, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.158 Vali Acc: 0.960 Test Loss: 0.158 Test Acc: 0.960
Validation loss decreased (-0.935235 --> -0.959608).  Saving model ...
Epoch: 5 cost time: 12.080270051956177
Epoch: 5, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.178 Vali Acc: 0.939 Test Loss: 0.178 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.194571733474731
Epoch: 6, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.131 Vali Acc: 0.960 Test Loss: 0.131 Test Acc: 0.960
Validation loss decreased (-0.959608 --> -0.959609).  Saving model ...
Epoch: 7 cost time: 12.761662244796753
Epoch: 7, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.165 Vali Acc: 0.944 Test Loss: 0.165 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 12.238805532455444
Epoch: 8, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 12.796293497085571
Epoch: 9, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.122 Vali Acc: 0.964 Test Loss: 0.122 Test Acc: 0.964
Validation loss decreased (-0.959609 --> -0.963787).  Saving model ...
Epoch: 10 cost time: 12.609010457992554
Epoch: 10, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
Validation loss decreased (-0.963787 --> -0.967965).  Saving model ...
Epoch: 11 cost time: 12.245028018951416
Epoch: 11, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.112 Vali Acc: 0.969 Test Loss: 0.112 Test Acc: 0.969
Validation loss decreased (-0.967965 --> -0.969358).  Saving model ...
Epoch: 12 cost time: 11.183971405029297
Epoch: 12, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.155 Vali Acc: 0.950 Test Loss: 0.155 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 11.443725347518921
Epoch: 13, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 12.335492610931396
Epoch: 14, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 14.356254577636719
Epoch: 15, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.113 Vali Acc: 0.967 Test Loss: 0.113 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 12.286129474639893
Epoch: 16, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.170 Vali Acc: 0.953 Test Loss: 0.170 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 13.61862587928772
Epoch: 17, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.112 Vali Acc: 0.969 Test Loss: 0.112 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 13.426523923873901
Epoch: 18, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.969358 --> -0.972840).  Saving model ...
Epoch: 19 cost time: 11.56949234008789
Epoch: 19, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 12.31810998916626
Epoch: 20, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 12.084922075271606
Epoch: 21, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.166 Vali Acc: 0.952 Test Loss: 0.166 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 13.0738046169281
Epoch: 22, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.163 Vali Acc: 0.954 Test Loss: 0.163 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 14.083778619766235
Epoch: 23, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 12.341817140579224
Epoch: 24, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.206 Vali Acc: 0.946 Test Loss: 0.206 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 12.22242283821106
Epoch: 25, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.152 Vali Acc: 0.952 Test Loss: 0.152 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 12.74984097480774
Epoch: 26, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.136 Vali Acc: 0.961 Test Loss: 0.136 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 13.711368322372437
Epoch: 27, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.179 Vali Acc: 0.948 Test Loss: 0.179 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 12.73532772064209
Epoch: 28, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9728412256267409
model parameter : 3027664
model size : 14.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 12.99158763885498
Epoch: 1, Steps: 89 | Train Loss: 2.385 Vali Loss: 1.057 Vali Acc: 0.784 Test Loss: 1.057 Test Acc: 0.784
Validation loss decreased (inf --> -0.784112).  Saving model ...
Epoch: 2 cost time: 10.665290117263794
Epoch: 2, Steps: 89 | Train Loss: 0.651 Vali Loss: 0.424 Vali Acc: 0.886 Test Loss: 0.424 Test Acc: 0.886
Validation loss decreased (-0.784112 --> -0.885790).  Saving model ...
Epoch: 3 cost time: 11.644471883773804
Epoch: 3, Steps: 89 | Train Loss: 0.344 Vali Loss: 0.288 Vali Acc: 0.915 Test Loss: 0.288 Test Acc: 0.915
Validation loss decreased (-0.885790 --> -0.915039).  Saving model ...
Epoch: 4 cost time: 12.067117691040039
Epoch: 4, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
Validation loss decreased (-0.915039 --> -0.949163).  Saving model ...
Epoch: 5 cost time: 11.433534145355225
Epoch: 5, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.123 Vali Acc: 0.963 Test Loss: 0.123 Test Acc: 0.963
Validation loss decreased (-0.949163 --> -0.963091).  Saving model ...
Epoch: 6 cost time: 12.53494381904602
Epoch: 6, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.138 Vali Acc: 0.960 Test Loss: 0.138 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.51265811920166
Epoch: 7, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
Validation loss decreased (-0.963091 --> -0.968662).  Saving model ...
Epoch: 8 cost time: 12.11427640914917
Epoch: 8, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.132 Vali Acc: 0.960 Test Loss: 0.132 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 13.40207552909851
Epoch: 9, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.155 Vali Acc: 0.960 Test Loss: 0.155 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.83827257156372
Epoch: 10, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.202 Vali Acc: 0.941 Test Loss: 0.202 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 12.574974536895752
Epoch: 11, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.084 Vali Acc: 0.974 Test Loss: 0.084 Test Acc: 0.974
Validation loss decreased (-0.968662 --> -0.973537).  Saving model ...
Epoch: 12 cost time: 12.127853870391846
Epoch: 12, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 11.788414478302002
Epoch: 13, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.082 Vali Acc: 0.974 Test Loss: 0.082 Test Acc: 0.974
Validation loss decreased (-0.973537 --> -0.973537).  Saving model ...
Epoch: 14 cost time: 11.317272901535034
Epoch: 14, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.088 Vali Acc: 0.974 Test Loss: 0.088 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 11.458435773849487
Epoch: 15, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.130 Vali Acc: 0.961 Test Loss: 0.130 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 11.53310751914978
Epoch: 16, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.112 Vali Acc: 0.966 Test Loss: 0.112 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 11.905916213989258
Epoch: 17, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.112 Vali Acc: 0.966 Test Loss: 0.112 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 10.881839752197266
Epoch: 18, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.193 Vali Acc: 0.951 Test Loss: 0.193 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 13.149811506271362
Epoch: 19, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 13.045158386230469
Epoch: 20, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
Validation loss decreased (-0.973537 --> -0.974233).  Saving model ...
Epoch: 21 cost time: 11.960118532180786
Epoch: 21, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.150 Vali Acc: 0.952 Test Loss: 0.150 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 11.864229440689087
Epoch: 22, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.152 Vali Acc: 0.953 Test Loss: 0.152 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 11.313320636749268
Epoch: 23, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.139 Vali Acc: 0.957 Test Loss: 0.139 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 11.605909824371338
Epoch: 24, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.152 Vali Acc: 0.962 Test Loss: 0.152 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 11.545562505722046
Epoch: 25, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 11.412043809890747
Epoch: 26, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.299 Vali Acc: 0.912 Test Loss: 0.299 Test Acc: 0.912
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 11.520775556564331
Epoch: 27, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.193 Vali Acc: 0.938 Test Loss: 0.193 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 10.269030570983887
Epoch: 28, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.161 Vali Acc: 0.963 Test Loss: 0.161 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 11.528489112854004
Epoch: 29, Steps: 89 | Train Loss: 0.197 Vali Loss: 0.190 Vali Acc: 0.936 Test Loss: 0.190 Test Acc: 0.936
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 12.260981559753418
Epoch: 30, Steps: 89 | Train Loss: 0.228 Vali Loss: 0.152 Vali Acc: 0.953 Test Loss: 0.152 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.974233983286908
model parameter : 3023824
model size : 14.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.018583536148071
Epoch: 1, Steps: 89 | Train Loss: 2.220 Vali Loss: 0.941 Vali Acc: 0.779 Test Loss: 0.941 Test Acc: 0.779
Validation loss decreased (inf --> -0.779239).  Saving model ...
Epoch: 2 cost time: 12.654345750808716
Epoch: 2, Steps: 89 | Train Loss: 0.628 Vali Loss: 0.439 Vali Acc: 0.864 Test Loss: 0.439 Test Acc: 0.864
Validation loss decreased (-0.779239 --> -0.864202).  Saving model ...
Epoch: 3 cost time: 11.000280380249023
Epoch: 3, Steps: 89 | Train Loss: 0.304 Vali Loss: 0.215 Vali Acc: 0.942 Test Loss: 0.215 Test Acc: 0.942
Validation loss decreased (-0.864202 --> -0.941502).  Saving model ...
Epoch: 4 cost time: 12.05925965309143
Epoch: 4, Steps: 89 | Train Loss: 0.216 Vali Loss: 0.137 Vali Acc: 0.965 Test Loss: 0.137 Test Acc: 0.965
Validation loss decreased (-0.941502 --> -0.965180).  Saving model ...
Epoch: 5 cost time: 10.75420069694519
Epoch: 5, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.139 Vali Acc: 0.963 Test Loss: 0.139 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.909427165985107
Epoch: 6, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.43738341331482
Epoch: 7, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 11.16408658027649
Epoch: 8, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.130 Vali Acc: 0.953 Test Loss: 0.130 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 12.710797309875488
Epoch: 9, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.193 Vali Acc: 0.952 Test Loss: 0.193 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 11.26983380317688
Epoch: 10, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.108 Vali Acc: 0.967 Test Loss: 0.108 Test Acc: 0.967
Validation loss decreased (-0.965180 --> -0.967269).  Saving model ...
Epoch: 11 cost time: 11.609618186950684
Epoch: 11, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.102 Vali Acc: 0.969 Test Loss: 0.102 Test Acc: 0.969
Validation loss decreased (-0.967269 --> -0.968662).  Saving model ...
Epoch: 12 cost time: 11.14508843421936
Epoch: 12, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.131 Vali Acc: 0.963 Test Loss: 0.131 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 10.842854261398315
Epoch: 13, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
Validation loss decreased (-0.968662 --> -0.969358).  Saving model ...
Epoch: 14 cost time: 11.846363544464111
Epoch: 14, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.971447).  Saving model ...
Epoch: 15 cost time: 11.722825765609741
Epoch: 15, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.186 Vali Acc: 0.942 Test Loss: 0.186 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 12.805486679077148
Epoch: 16, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.177 Vali Acc: 0.939 Test Loss: 0.177 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 11.328068733215332
Epoch: 17, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.973537).  Saving model ...
Epoch: 18 cost time: 11.648624181747437
Epoch: 18, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 11.984065294265747
Epoch: 19, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.092 Vali Acc: 0.971 Test Loss: 0.092 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 12.663340330123901
Epoch: 20, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.164 Vali Acc: 0.954 Test Loss: 0.164 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 12.041765213012695
Epoch: 21, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.179 Vali Acc: 0.950 Test Loss: 0.179 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 10.788689136505127
Epoch: 22, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.136 Vali Acc: 0.964 Test Loss: 0.136 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 13.665619373321533
Epoch: 23, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 13.446739435195923
Epoch: 24, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.209 Vali Acc: 0.940 Test Loss: 0.209 Test Acc: 0.940
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 13.979141473770142
Epoch: 25, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.191 Vali Acc: 0.938 Test Loss: 0.191 Test Acc: 0.938
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 13.418039321899414
Epoch: 26, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 13.722985744476318
Epoch: 27, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.198 Vali Acc: 0.948 Test Loss: 0.198 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9735376044568245
model parameter : 3019984
model size : 14.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.746137380599976
Epoch: 1, Steps: 89 | Train Loss: 2.342 Vali Loss: 0.973 Vali Acc: 0.788 Test Loss: 0.973 Test Acc: 0.788
Validation loss decreased (inf --> -0.787595).  Saving model ...
Epoch: 2 cost time: 11.794275760650635
Epoch: 2, Steps: 89 | Train Loss: 0.630 Vali Loss: 0.423 Vali Acc: 0.880 Test Loss: 0.423 Test Acc: 0.880
Validation loss decreased (-0.787595 --> -0.879522).  Saving model ...
Epoch: 3 cost time: 11.430531740188599
Epoch: 3, Steps: 89 | Train Loss: 0.327 Vali Loss: 0.288 Vali Acc: 0.919 Test Loss: 0.288 Test Acc: 0.919
Validation loss decreased (-0.879522 --> -0.919217).  Saving model ...
Epoch: 4 cost time: 12.191666841506958
Epoch: 4, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.919217 --> -0.958216).  Saving model ...
Epoch: 5 cost time: 12.60432243347168
Epoch: 5, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.173 Vali Acc: 0.946 Test Loss: 0.173 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.112714529037476
Epoch: 6, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.108 Vali Acc: 0.969 Test Loss: 0.108 Test Acc: 0.969
Validation loss decreased (-0.958216 --> -0.969358).  Saving model ...
Epoch: 7 cost time: 11.755854368209839
Epoch: 7, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.971447).  Saving model ...
Epoch: 8 cost time: 12.643489122390747
Epoch: 8, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.105 Vali Acc: 0.966 Test Loss: 0.105 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.744832515716553
Epoch: 9, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.126 Vali Acc: 0.960 Test Loss: 0.126 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.358128309249878
Epoch: 10, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
Validation loss decreased (-0.971447 --> -0.976322).  Saving model ...
Epoch: 11 cost time: 11.300693273544312
Epoch: 11, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.122 Vali Acc: 0.967 Test Loss: 0.122 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 11.208682775497437
Epoch: 12, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 11.68710470199585
Epoch: 13, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.119 Vali Acc: 0.960 Test Loss: 0.119 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 11.617366313934326
Epoch: 14, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.145 Vali Acc: 0.961 Test Loss: 0.145 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 12.023471117019653
Epoch: 15, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.118 Vali Acc: 0.964 Test Loss: 0.118 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 11.98433780670166
Epoch: 16, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.105 Vali Acc: 0.971 Test Loss: 0.105 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 12.534249782562256
Epoch: 17, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 12.65847897529602
Epoch: 18, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 12.183831214904785
Epoch: 19, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.099 Vali Acc: 0.966 Test Loss: 0.099 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 10.948697566986084
Epoch: 20, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.167 Vali Acc: 0.954 Test Loss: 0.167 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 2735440
model size : 13.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 14.426680564880371
Epoch: 1, Steps: 89 | Train Loss: 2.443 Vali Loss: 1.192 Vali Acc: 0.683 Test Loss: 1.192 Test Acc: 0.683
Validation loss decreased (inf --> -0.683136).  Saving model ...
Epoch: 2 cost time: 12.96593427658081
Epoch: 2, Steps: 89 | Train Loss: 0.696 Vali Loss: 0.431 Vali Acc: 0.874 Test Loss: 0.431 Test Acc: 0.874
Validation loss decreased (-0.683136 --> -0.873951).  Saving model ...
Epoch: 3 cost time: 11.277270555496216
Epoch: 3, Steps: 89 | Train Loss: 0.305 Vali Loss: 0.239 Vali Acc: 0.928 Test Loss: 0.239 Test Acc: 0.928
Validation loss decreased (-0.873951 --> -0.927574).  Saving model ...
Epoch: 4 cost time: 12.0152428150177
Epoch: 4, Steps: 89 | Train Loss: 0.206 Vali Loss: 0.212 Vali Acc: 0.935 Test Loss: 0.212 Test Acc: 0.935
Validation loss decreased (-0.927574 --> -0.934538).  Saving model ...
Epoch: 5 cost time: 11.467026948928833
Epoch: 5, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.119 Vali Acc: 0.972 Test Loss: 0.119 Test Acc: 0.972
Validation loss decreased (-0.934538 --> -0.972144).  Saving model ...
Epoch: 6 cost time: 11.69894552230835
Epoch: 6, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.151034832000732
Epoch: 7, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.972144 --> -0.972840).  Saving model ...
Epoch: 8 cost time: 12.61097502708435
Epoch: 8, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.964192628860474
Epoch: 9, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.115 Vali Acc: 0.964 Test Loss: 0.115 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 11.587019920349121
Epoch: 10, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 11.835608720779419
Epoch: 11, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 11.32382082939148
Epoch: 12, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
Validation loss decreased (-0.972840 --> -0.974929).  Saving model ...
Epoch: 13 cost time: 12.363703966140747
Epoch: 13, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.097 Vali Acc: 0.969 Test Loss: 0.097 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 12.194472551345825
Epoch: 14, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.111 Vali Acc: 0.967 Test Loss: 0.111 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 12.939708709716797
Epoch: 15, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.082 Vali Acc: 0.975 Test Loss: 0.082 Test Acc: 0.975
Validation loss decreased (-0.974929 --> -0.974930).  Saving model ...
Epoch: 16 cost time: 12.908090114593506
Epoch: 16, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.135 Vali Acc: 0.966 Test Loss: 0.135 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 11.713665246963501
Epoch: 17, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.127 Vali Acc: 0.964 Test Loss: 0.127 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 12.754499435424805
Epoch: 18, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.123 Vali Acc: 0.960 Test Loss: 0.123 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 11.539409160614014
Epoch: 19, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.095 Vali Acc: 0.972 Test Loss: 0.095 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 11.32218050956726
Epoch: 20, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 11.77264142036438
Epoch: 21, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 11.409143686294556
Epoch: 22, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.348 Vali Acc: 0.916 Test Loss: 0.348 Test Acc: 0.916
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 11.962891101837158
Epoch: 23, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 11.509642601013184
Epoch: 24, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.148 Vali Acc: 0.961 Test Loss: 0.148 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 12.126649379730225
Epoch: 25, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.135 Vali Acc: 0.960 Test Loss: 0.135 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9749303621169917
model parameter : 2731600
model size : 13.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.358739852905273
Epoch: 1, Steps: 89 | Train Loss: 2.434 Vali Loss: 1.203 Vali Acc: 0.705 Test Loss: 1.203 Test Acc: 0.705
Validation loss decreased (inf --> -0.704723).  Saving model ...
Epoch: 2 cost time: 10.847270250320435
Epoch: 2, Steps: 89 | Train Loss: 0.716 Vali Loss: 0.407 Vali Acc: 0.894 Test Loss: 0.407 Test Acc: 0.894
Validation loss decreased (-0.704723 --> -0.894146).  Saving model ...
Epoch: 3 cost time: 12.224910020828247
Epoch: 3, Steps: 89 | Train Loss: 0.334 Vali Loss: 0.314 Vali Acc: 0.909 Test Loss: 0.314 Test Acc: 0.909
Validation loss decreased (-0.894146 --> -0.909468).  Saving model ...
Epoch: 4 cost time: 12.29630446434021
Epoch: 4, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.256 Vali Acc: 0.923 Test Loss: 0.256 Test Acc: 0.923
Validation loss decreased (-0.909468 --> -0.922699).  Saving model ...
Epoch: 5 cost time: 11.813631296157837
Epoch: 5, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
Validation loss decreased (-0.922699 --> -0.950556).  Saving model ...
Epoch: 6 cost time: 12.147895574569702
Epoch: 6, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
Validation loss decreased (-0.950556 --> -0.966573).  Saving model ...
Epoch: 7 cost time: 13.009448766708374
Epoch: 7, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
Validation loss decreased (-0.966573 --> -0.971447).  Saving model ...
Epoch: 8 cost time: 12.413352727890015
Epoch: 8, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.19938588142395
Epoch: 9, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
Validation loss decreased (-0.971447 --> -0.974929).  Saving model ...
Epoch: 10 cost time: 10.714805126190186
Epoch: 10, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 11.763628244400024
Epoch: 11, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.183 Vali Acc: 0.942 Test Loss: 0.183 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 12.022834539413452
Epoch: 12, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
Validation loss decreased (-0.974929 --> -0.980501).  Saving model ...
Epoch: 13 cost time: 11.489766120910645
Epoch: 13, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.169 Vali Acc: 0.955 Test Loss: 0.169 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 11.75167441368103
Epoch: 14, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.235 Vali Acc: 0.923 Test Loss: 0.235 Test Acc: 0.923
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 12.710848331451416
Epoch: 15, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.088 Vali Acc: 0.972 Test Loss: 0.088 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 10.63847827911377
Epoch: 16, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.132 Vali Acc: 0.960 Test Loss: 0.132 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 10.843858480453491
Epoch: 17, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 11.788835525512695
Epoch: 18, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 12.031338214874268
Epoch: 19, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.135 Vali Acc: 0.963 Test Loss: 0.135 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 12.112937688827515
Epoch: 20, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.150 Vali Acc: 0.955 Test Loss: 0.150 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 12.153552532196045
Epoch: 21, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.112 Vali Acc: 0.969 Test Loss: 0.112 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 12.214052438735962
Epoch: 22, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 2727760
model size : 13.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 12.737934589385986
Epoch: 1, Steps: 89 | Train Loss: 2.385 Vali Loss: 1.047 Vali Acc: 0.766 Test Loss: 1.047 Test Acc: 0.766
Validation loss decreased (inf --> -0.766006).  Saving model ...
Epoch: 2 cost time: 10.354997873306274
Epoch: 2, Steps: 89 | Train Loss: 0.662 Vali Loss: 0.386 Vali Acc: 0.896 Test Loss: 0.386 Test Acc: 0.896
Validation loss decreased (-0.766006 --> -0.896236).  Saving model ...
Epoch: 3 cost time: 11.910906076431274
Epoch: 3, Steps: 89 | Train Loss: 0.327 Vali Loss: 0.212 Vali Acc: 0.949 Test Loss: 0.212 Test Acc: 0.949
Validation loss decreased (-0.896236 --> -0.949162).  Saving model ...
Epoch: 4 cost time: 11.548330068588257
Epoch: 4, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.193 Vali Acc: 0.939 Test Loss: 0.193 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.502842426300049
Epoch: 5, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.195 Vali Acc: 0.938 Test Loss: 0.195 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.92560076713562
Epoch: 6, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.118 Vali Acc: 0.966 Test Loss: 0.118 Test Acc: 0.966
Validation loss decreased (-0.949162 --> -0.965876).  Saving model ...
Epoch: 7 cost time: 10.90256929397583
Epoch: 7, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
Validation loss decreased (-0.965876 --> -0.966573).  Saving model ...
Epoch: 8 cost time: 10.435237169265747
Epoch: 8, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
Validation loss decreased (-0.966573 --> -0.970055).  Saving model ...
Epoch: 9 cost time: 10.911751985549927
Epoch: 9, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.101 Vali Acc: 0.967 Test Loss: 0.101 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 11.654185771942139
Epoch: 10, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.110 Vali Acc: 0.969 Test Loss: 0.110 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 11.34034276008606
Epoch: 11, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
Validation loss decreased (-0.970055 --> -0.970055).  Saving model ...
Epoch: 12 cost time: 11.212852954864502
Epoch: 12, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.157 Vali Acc: 0.947 Test Loss: 0.157 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 11.623891115188599
Epoch: 13, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.110 Vali Acc: 0.967 Test Loss: 0.110 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 10.322952032089233
Epoch: 14, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.180 Vali Acc: 0.948 Test Loss: 0.180 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 9.945330381393433
Epoch: 15, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.121 Vali Acc: 0.963 Test Loss: 0.121 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 11.11498498916626
Epoch: 16, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 10.793060302734375
Epoch: 17, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.137 Vali Acc: 0.953 Test Loss: 0.137 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 10.928019762039185
Epoch: 18, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 11.26432204246521
Epoch: 19, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.094 Vali Acc: 0.971 Test Loss: 0.094 Test Acc: 0.971
Validation loss decreased (-0.970055 --> -0.971448).  Saving model ...
Epoch: 20 cost time: 10.729554653167725
Epoch: 20, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.102 Vali Acc: 0.969 Test Loss: 0.102 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 11.353228092193604
Epoch: 21, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.147 Vali Acc: 0.958 Test Loss: 0.147 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 11.174812078475952
Epoch: 22, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.301 Vali Acc: 0.909 Test Loss: 0.301 Test Acc: 0.909
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 10.598148584365845
Epoch: 23, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 11.69900918006897
Epoch: 24, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 13.467627763748169
Epoch: 25, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.189 Vali Acc: 0.941 Test Loss: 0.189 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 12.097037076950073
Epoch: 26, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.126 Vali Acc: 0.956 Test Loss: 0.126 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 11.686247110366821
Epoch: 27, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.198 Vali Acc: 0.952 Test Loss: 0.198 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 11.6011323928833
Epoch: 28, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.155 Vali Acc: 0.960 Test Loss: 0.155 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 11.457287073135376
Epoch: 29, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.130 Vali Acc: 0.958 Test Loss: 0.130 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9714484679665738
model parameter : 2723920
model size : 13.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 14.85438323020935
Epoch: 1, Steps: 89 | Train Loss: 2.455 Vali Loss: 1.345 Vali Acc: 0.680 Test Loss: 1.345 Test Acc: 0.680
Validation loss decreased (inf --> -0.679652).  Saving model ...
Epoch: 2 cost time: 13.168868780136108
Epoch: 2, Steps: 89 | Train Loss: 0.877 Vali Loss: 0.538 Vali Acc: 0.871 Test Loss: 0.538 Test Acc: 0.871
Validation loss decreased (-0.679652 --> -0.871165).  Saving model ...
Epoch: 3 cost time: 12.044221639633179
Epoch: 3, Steps: 89 | Train Loss: 0.440 Vali Loss: 0.336 Vali Acc: 0.930 Test Loss: 0.336 Test Acc: 0.930
Validation loss decreased (-0.871165 --> -0.930359).  Saving model ...
Epoch: 4 cost time: 13.527918577194214
Epoch: 4, Steps: 89 | Train Loss: 0.295 Vali Loss: 0.214 Vali Acc: 0.952 Test Loss: 0.214 Test Acc: 0.952
Validation loss decreased (-0.930359 --> -0.951948).  Saving model ...
Epoch: 5 cost time: 12.522871732711792
Epoch: 5, Steps: 89 | Train Loss: 0.228 Vali Loss: 0.206 Vali Acc: 0.937 Test Loss: 0.206 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.521183013916016
Epoch: 6, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.147 Vali Acc: 0.965 Test Loss: 0.147 Test Acc: 0.965
Validation loss decreased (-0.951948 --> -0.965180).  Saving model ...
Epoch: 7 cost time: 12.269808769226074
Epoch: 7, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 13.509964942932129
Epoch: 8, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.162 Vali Acc: 0.948 Test Loss: 0.162 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 14.580654621124268
Epoch: 9, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
Validation loss decreased (-0.965180 --> -0.971447).  Saving model ...
Epoch: 10 cost time: 12.245901346206665
Epoch: 10, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.174 Vali Acc: 0.951 Test Loss: 0.174 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 13.214619636535645
Epoch: 11, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.093 Vali Acc: 0.969 Test Loss: 0.093 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 13.100897073745728
Epoch: 12, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.139 Vali Acc: 0.955 Test Loss: 0.139 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 12.30044412612915
Epoch: 13, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.115 Vali Acc: 0.966 Test Loss: 0.115 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 12.180284023284912
Epoch: 14, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.088 Vali Acc: 0.971 Test Loss: 0.088 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 13.03092885017395
Epoch: 15, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.141 Vali Acc: 0.953 Test Loss: 0.141 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 13.251269340515137
Epoch: 16, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
Validation loss decreased (-0.971447 --> -0.972840).  Saving model ...
Epoch: 17 cost time: 11.77333688735962
Epoch: 17, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
Validation loss decreased (-0.972840 --> -0.981197).  Saving model ...
Epoch: 18 cost time: 12.059114456176758
Epoch: 18, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.221 Vali Acc: 0.948 Test Loss: 0.221 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 12.134537935256958
Epoch: 19, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.137 Vali Acc: 0.963 Test Loss: 0.137 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 12.072573900222778
Epoch: 20, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.122 Vali Acc: 0.963 Test Loss: 0.122 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 12.096623659133911
Epoch: 21, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.101 Vali Acc: 0.969 Test Loss: 0.101 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 13.069701910018921
Epoch: 22, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.080 Vali Acc: 0.974 Test Loss: 0.080 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 12.345679998397827
Epoch: 23, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 13.10847282409668
Epoch: 24, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.152 Vali Acc: 0.967 Test Loss: 0.152 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 13.05075979232788
Epoch: 25, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 11.97563099861145
Epoch: 26, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 11.41163682937622
Epoch: 27, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 1818768
model size : 8.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 14.064682722091675
Epoch: 1, Steps: 89 | Train Loss: 2.474 Vali Loss: 1.348 Vali Acc: 0.714 Test Loss: 1.348 Test Acc: 0.714
Validation loss decreased (inf --> -0.714471).  Saving model ...
Epoch: 2 cost time: 11.858741283416748
Epoch: 2, Steps: 89 | Train Loss: 0.912 Vali Loss: 0.544 Vali Acc: 0.880 Test Loss: 0.544 Test Acc: 0.880
Validation loss decreased (-0.714471 --> -0.880217).  Saving model ...
Epoch: 3 cost time: 11.969147682189941
Epoch: 3, Steps: 89 | Train Loss: 0.441 Vali Loss: 0.336 Vali Acc: 0.930 Test Loss: 0.336 Test Acc: 0.930
Validation loss decreased (-0.880217 --> -0.930359).  Saving model ...
Epoch: 4 cost time: 11.447189092636108
Epoch: 4, Steps: 89 | Train Loss: 0.276 Vali Loss: 0.220 Vali Acc: 0.940 Test Loss: 0.220 Test Acc: 0.940
Validation loss decreased (-0.930359 --> -0.940109).  Saving model ...
Epoch: 5 cost time: 11.744131326675415
Epoch: 5, Steps: 89 | Train Loss: 0.197 Vali Loss: 0.147 Vali Acc: 0.960 Test Loss: 0.147 Test Acc: 0.960
Validation loss decreased (-0.940109 --> -0.959609).  Saving model ...
Epoch: 6 cost time: 11.90720534324646
Epoch: 6, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
Validation loss decreased (-0.959609 --> -0.967965).  Saving model ...
Epoch: 7 cost time: 12.398802518844604
Epoch: 7, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.149 Vali Acc: 0.958 Test Loss: 0.149 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 13.596130132675171
Epoch: 8, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.109 Vali Acc: 0.964 Test Loss: 0.109 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 11.846073865890503
Epoch: 9, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.126 Vali Acc: 0.966 Test Loss: 0.126 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 13.122676849365234
Epoch: 10, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.130 Vali Acc: 0.964 Test Loss: 0.130 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 11.982751369476318
Epoch: 11, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.176 Vali Acc: 0.943 Test Loss: 0.176 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 11.915237188339233
Epoch: 12, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.967965 --> -0.972840).  Saving model ...
Epoch: 13 cost time: 11.898854970932007
Epoch: 13, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.135 Vali Acc: 0.955 Test Loss: 0.135 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 11.457946062088013
Epoch: 14, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
Validation loss decreased (-0.972840 --> -0.977715).  Saving model ...
Epoch: 15 cost time: 12.233249187469482
Epoch: 15, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.977715).  Saving model ...
Epoch: 16 cost time: 11.80030369758606
Epoch: 16, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 12.63419795036316
Epoch: 17, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 11.902671098709106
Epoch: 18, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.099 Vali Acc: 0.969 Test Loss: 0.099 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 12.247162103652954
Epoch: 19, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 13.214497566223145
Epoch: 20, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 11.659192562103271
Epoch: 21, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 12.095734596252441
Epoch: 22, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.977715).  Saving model ...
Epoch: 23 cost time: 12.5383780002594
Epoch: 23, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.142 Vali Acc: 0.957 Test Loss: 0.142 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 11.660491943359375
Epoch: 24, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 12.371197700500488
Epoch: 25, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.238 Vali Acc: 0.929 Test Loss: 0.238 Test Acc: 0.929
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 12.34278678894043
Epoch: 26, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 12.154621124267578
Epoch: 27, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.180 Vali Acc: 0.959 Test Loss: 0.180 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 12.593047857284546
Epoch: 28, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 13.724678039550781
Epoch: 29, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.099 Vali Acc: 0.969 Test Loss: 0.099 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 12.432047605514526
Epoch: 30, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.092 Vali Acc: 0.971 Test Loss: 0.092 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 12.440246105194092
Epoch: 31, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.144 Vali Acc: 0.964 Test Loss: 0.144 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 11.233871936798096
Epoch: 32, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.148 Vali Acc: 0.962 Test Loss: 0.148 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 1816848
model size : 8.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 14.175931692123413
Epoch: 1, Steps: 89 | Train Loss: 2.534 Vali Loss: 1.498 Vali Acc: 0.682 Test Loss: 1.498 Test Acc: 0.682
Validation loss decreased (inf --> -0.681740).  Saving model ...
Epoch: 2 cost time: 11.675146579742432
Epoch: 2, Steps: 89 | Train Loss: 0.953 Vali Loss: 0.587 Vali Acc: 0.847 Test Loss: 0.587 Test Acc: 0.847
Validation loss decreased (-0.681740 --> -0.847487).  Saving model ...
Epoch: 3 cost time: 10.737178564071655
Epoch: 3, Steps: 89 | Train Loss: 0.467 Vali Loss: 0.369 Vali Acc: 0.907 Test Loss: 0.369 Test Acc: 0.907
Validation loss decreased (-0.847487 --> -0.906682).  Saving model ...
Epoch: 4 cost time: 11.570540428161621
Epoch: 4, Steps: 89 | Train Loss: 0.283 Vali Loss: 0.224 Vali Acc: 0.951 Test Loss: 0.224 Test Acc: 0.951
Validation loss decreased (-0.906682 --> -0.950555).  Saving model ...
Epoch: 5 cost time: 11.131163358688354
Epoch: 5, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.287 Vali Acc: 0.914 Test Loss: 0.287 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.558049440383911
Epoch: 6, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.175 Vali Acc: 0.947 Test Loss: 0.175 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.952901363372803
Epoch: 7, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.175 Vali Acc: 0.949 Test Loss: 0.175 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 12.790812730789185
Epoch: 8, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.151 Vali Acc: 0.955 Test Loss: 0.151 Test Acc: 0.955
Validation loss decreased (-0.950555 --> -0.954734).  Saving model ...
Epoch: 9 cost time: 13.656565427780151
Epoch: 9, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.090 Vali Acc: 0.974 Test Loss: 0.090 Test Acc: 0.974
Validation loss decreased (-0.954734 --> -0.974233).  Saving model ...
Epoch: 10 cost time: 12.173851728439331
Epoch: 10, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 11.388870239257812
Epoch: 11, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.974233 --> -0.977019).  Saving model ...
Epoch: 12 cost time: 12.078548192977905
Epoch: 12, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.148 Vali Acc: 0.953 Test Loss: 0.148 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 12.396557569503784
Epoch: 13, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 12.812047243118286
Epoch: 14, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.166 Vali Acc: 0.948 Test Loss: 0.166 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 12.048777341842651
Epoch: 15, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 11.900466442108154
Epoch: 16, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.146 Vali Acc: 0.958 Test Loss: 0.146 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 12.337325811386108
Epoch: 17, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.120 Vali Acc: 0.964 Test Loss: 0.120 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 11.50255298614502
Epoch: 18, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.141 Vali Acc: 0.965 Test Loss: 0.141 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 12.790409564971924
Epoch: 19, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.148 Vali Acc: 0.952 Test Loss: 0.148 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 11.495591878890991
Epoch: 20, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.148 Vali Acc: 0.939 Test Loss: 0.148 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 12.315971612930298
Epoch: 21, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 1814928
model size : 8.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.229743480682373
Epoch: 1, Steps: 89 | Train Loss: 2.460 Vali Loss: 1.439 Vali Acc: 0.691 Test Loss: 1.439 Test Acc: 0.691
Validation loss decreased (inf --> -0.690793).  Saving model ...
Epoch: 2 cost time: 10.34996223449707
Epoch: 2, Steps: 89 | Train Loss: 0.962 Vali Loss: 0.548 Vali Acc: 0.892 Test Loss: 0.548 Test Acc: 0.892
Validation loss decreased (-0.690793 --> -0.892056).  Saving model ...
Epoch: 3 cost time: 11.594773530960083
Epoch: 3, Steps: 89 | Train Loss: 0.458 Vali Loss: 0.359 Vali Acc: 0.916 Test Loss: 0.359 Test Acc: 0.916
Validation loss decreased (-0.892056 --> -0.916431).  Saving model ...
Epoch: 4 cost time: 11.375034809112549
Epoch: 4, Steps: 89 | Train Loss: 0.280 Vali Loss: 0.228 Vali Acc: 0.938 Test Loss: 0.228 Test Acc: 0.938
Validation loss decreased (-0.916431 --> -0.938020).  Saving model ...
Epoch: 5 cost time: 10.564969301223755
Epoch: 5, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.151 Vali Acc: 0.961 Test Loss: 0.151 Test Acc: 0.961
Validation loss decreased (-0.938020 --> -0.961001).  Saving model ...
Epoch: 6 cost time: 10.272684574127197
Epoch: 6, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.142 Vali Acc: 0.960 Test Loss: 0.142 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.301720142364502
Epoch: 7, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
Validation loss decreased (-0.961001 --> -0.973537).  Saving model ...
Epoch: 8 cost time: 10.640333652496338
Epoch: 8, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.134 Vali Acc: 0.960 Test Loss: 0.134 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.451786518096924
Epoch: 9, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 11.523988008499146
Epoch: 10, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
Validation loss decreased (-0.973537 --> -0.977715).  Saving model ...
Epoch: 11 cost time: 11.589241981506348
Epoch: 11, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.096 Vali Acc: 0.966 Test Loss: 0.096 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 11.796736240386963
Epoch: 12, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 11.32782769203186
Epoch: 13, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.139 Vali Acc: 0.955 Test Loss: 0.139 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 10.436274766921997
Epoch: 14, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 11.584543466567993
Epoch: 15, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 10.304505109786987
Epoch: 16, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.153 Vali Acc: 0.952 Test Loss: 0.153 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 11.393536806106567
Epoch: 17, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.143 Vali Acc: 0.955 Test Loss: 0.143 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 12.035221099853516
Epoch: 18, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 11.728236675262451
Epoch: 19, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 11.751535177230835
Epoch: 20, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 1813008
model size : 8.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.875770807266235
Epoch: 1, Steps: 89 | Train Loss: 2.675 Vali Loss: 1.648 Vali Acc: 0.608 Test Loss: 1.648 Test Acc: 0.608
Validation loss decreased (inf --> -0.607922).  Saving model ...
Epoch: 2 cost time: 12.606414794921875
Epoch: 2, Steps: 89 | Train Loss: 1.072 Vali Loss: 0.650 Vali Acc: 0.868 Test Loss: 0.650 Test Acc: 0.868
Validation loss decreased (-0.607922 --> -0.868378).  Saving model ...
Epoch: 3 cost time: 12.4803466796875
Epoch: 3, Steps: 89 | Train Loss: 0.503 Vali Loss: 0.369 Vali Acc: 0.893 Test Loss: 0.369 Test Acc: 0.893
Validation loss decreased (-0.868378 --> -0.892754).  Saving model ...
Epoch: 4 cost time: 11.83696436882019
Epoch: 4, Steps: 89 | Train Loss: 0.313 Vali Loss: 0.211 Vali Acc: 0.950 Test Loss: 0.211 Test Acc: 0.950
Validation loss decreased (-0.892754 --> -0.949859).  Saving model ...
Epoch: 5 cost time: 11.121756315231323
Epoch: 5, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.193 Vali Acc: 0.948 Test Loss: 0.193 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.83820366859436
Epoch: 6, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.157 Vali Acc: 0.955 Test Loss: 0.157 Test Acc: 0.955
Validation loss decreased (-0.949859 --> -0.955430).  Saving model ...
Epoch: 7 cost time: 12.240960121154785
Epoch: 7, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
Validation loss decreased (-0.955430 --> -0.961698).  Saving model ...
Epoch: 8 cost time: 12.829893350601196
Epoch: 8, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
Validation loss decreased (-0.961698 --> -0.961698).  Saving model ...
Epoch: 9 cost time: 11.831195592880249
Epoch: 9, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
Validation loss decreased (-0.961698 --> -0.970055).  Saving model ...
Epoch: 10 cost time: 11.491520166397095
Epoch: 10, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.120 Vali Acc: 0.966 Test Loss: 0.120 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 12.419443607330322
Epoch: 11, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
Validation loss decreased (-0.970055 --> -0.974233).  Saving model ...
Epoch: 12 cost time: 10.593819618225098
Epoch: 12, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 12.596803188323975
Epoch: 13, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
Validation loss decreased (-0.974233 --> -0.980501).  Saving model ...
Epoch: 14 cost time: 11.754101514816284
Epoch: 14, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 11.258049488067627
Epoch: 15, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.128 Vali Acc: 0.963 Test Loss: 0.128 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 11.847792863845825
Epoch: 16, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.140 Vali Acc: 0.958 Test Loss: 0.140 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 11.435569047927856
Epoch: 17, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 12.70441484451294
Epoch: 18, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.072 Vali Acc: 0.979 Test Loss: 0.072 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 12.334971189498901
Epoch: 19, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 11.939249515533447
Epoch: 20, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.102 Vali Acc: 0.969 Test Loss: 0.102 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 12.322957277297974
Epoch: 21, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 11.753209352493286
Epoch: 22, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.116 Vali Acc: 0.964 Test Loss: 0.116 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 11.602878332138062
Epoch: 23, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.104 Vali Acc: 0.962 Test Loss: 0.104 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 1224336
model size : 6.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 14.590661525726318
Epoch: 1, Steps: 89 | Train Loss: 2.692 Vali Loss: 1.730 Vali Acc: 0.627 Test Loss: 1.730 Test Acc: 0.627
Validation loss decreased (inf --> -0.627420).  Saving model ...
Epoch: 2 cost time: 11.52622103691101
Epoch: 2, Steps: 89 | Train Loss: 1.129 Vali Loss: 0.665 Vali Acc: 0.841 Test Loss: 0.665 Test Acc: 0.841
Validation loss decreased (-0.627420 --> -0.841219).  Saving model ...
Epoch: 3 cost time: 11.755226612091064
Epoch: 3, Steps: 89 | Train Loss: 0.538 Vali Loss: 0.427 Vali Acc: 0.893 Test Loss: 0.427 Test Acc: 0.893
Validation loss decreased (-0.841219 --> -0.892753).  Saving model ...
Epoch: 4 cost time: 12.585712194442749
Epoch: 4, Steps: 89 | Train Loss: 0.320 Vali Loss: 0.349 Vali Acc: 0.905 Test Loss: 0.349 Test Acc: 0.905
Validation loss decreased (-0.892753 --> -0.905289).  Saving model ...
Epoch: 5 cost time: 11.19999384880066
Epoch: 5, Steps: 89 | Train Loss: 0.234 Vali Loss: 0.214 Vali Acc: 0.935 Test Loss: 0.214 Test Acc: 0.935
Validation loss decreased (-0.905289 --> -0.934538).  Saving model ...
Epoch: 6 cost time: 12.162801265716553
Epoch: 6, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.172 Vali Acc: 0.953 Test Loss: 0.172 Test Acc: 0.953
Validation loss decreased (-0.934538 --> -0.953341).  Saving model ...
Epoch: 7 cost time: 11.743027210235596
Epoch: 7, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.319157600402832
Epoch: 8, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
Validation loss decreased (-0.953341 --> -0.967965).  Saving model ...
Epoch: 9 cost time: 11.826395034790039
Epoch: 9, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.168 Vali Acc: 0.946 Test Loss: 0.168 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 11.25227403640747
Epoch: 10, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.128 Vali Acc: 0.963 Test Loss: 0.128 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 11.640289068222046
Epoch: 11, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
Validation loss decreased (-0.967965 --> -0.970055).  Saving model ...
Epoch: 12 cost time: 12.262944221496582
Epoch: 12, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
Validation loss decreased (-0.970055 --> -0.970751).  Saving model ...
Epoch: 13 cost time: 12.027185916900635
Epoch: 13, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 11.812737941741943
Epoch: 14, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.115 Vali Acc: 0.966 Test Loss: 0.115 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 11.324130058288574
Epoch: 15, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 11.724059581756592
Epoch: 16, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.154 Vali Acc: 0.955 Test Loss: 0.154 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 11.148864984512329
Epoch: 17, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.098 Vali Acc: 0.967 Test Loss: 0.098 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 10.782591581344604
Epoch: 18, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.970751 --> -0.972840).  Saving model ...
Epoch: 19 cost time: 11.483949899673462
Epoch: 19, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.121 Vali Acc: 0.971 Test Loss: 0.121 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 10.841346979141235
Epoch: 20, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.174 Vali Acc: 0.954 Test Loss: 0.174 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 11.514209747314453
Epoch: 21, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.974233).  Saving model ...
Epoch: 22 cost time: 11.680721998214722
Epoch: 22, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.082 Vali Acc: 0.972 Test Loss: 0.082 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 11.702998161315918
Epoch: 23, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.128 Vali Acc: 0.969 Test Loss: 0.128 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 11.228358268737793
Epoch: 24, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.075 Vali Acc: 0.974 Test Loss: 0.075 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 11.113457918167114
Epoch: 25, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.087 Vali Acc: 0.974 Test Loss: 0.087 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 11.7796311378479
Epoch: 26, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
Validation loss decreased (-0.974233 --> -0.974929).  Saving model ...
Epoch: 27 cost time: 11.736183166503906
Epoch: 27, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
Validation loss decreased (-0.974929 --> -0.980501).  Saving model ...
Epoch: 28 cost time: 10.856256484985352
Epoch: 28, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.072 Vali Acc: 0.984 Test Loss: 0.072 Test Acc: 0.984
Validation loss decreased (-0.980501 --> -0.983983).  Saving model ...
Epoch: 29 cost time: 10.640474796295166
Epoch: 29, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 10.94766116142273
Epoch: 30, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 11.990044116973877
Epoch: 31, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.104 Vali Acc: 0.969 Test Loss: 0.104 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 11.665742635726929
Epoch: 32, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.131 Vali Acc: 0.964 Test Loss: 0.131 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 11.313235998153687
Epoch: 33, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.077 Vali Acc: 0.982 Test Loss: 0.077 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 10.899354219436646
Epoch: 34, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 10.664164066314697
Epoch: 35, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 11.03531002998352
Epoch: 36, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.136 Vali Acc: 0.958 Test Loss: 0.136 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 11.502254247665405
Epoch: 37, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.173 Vali Acc: 0.955 Test Loss: 0.173 Test Acc: 0.955
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 10.380698204040527
Epoch: 38, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.151 Vali Acc: 0.953 Test Loss: 0.151 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 1222416
model size : 6.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.457701206207275
Epoch: 1, Steps: 89 | Train Loss: 2.640 Vali Loss: 1.728 Vali Acc: 0.572 Test Loss: 1.728 Test Acc: 0.572
Validation loss decreased (inf --> -0.571710).  Saving model ...
Epoch: 2 cost time: 11.709643602371216
Epoch: 2, Steps: 89 | Train Loss: 1.058 Vali Loss: 0.609 Vali Acc: 0.877 Test Loss: 0.609 Test Acc: 0.877
Validation loss decreased (-0.571710 --> -0.876735).  Saving model ...
Epoch: 3 cost time: 11.50551152229309
Epoch: 3, Steps: 89 | Train Loss: 0.477 Vali Loss: 0.360 Vali Acc: 0.904 Test Loss: 0.360 Test Acc: 0.904
Validation loss decreased (-0.876735 --> -0.903896).  Saving model ...
Epoch: 4 cost time: 12.286110877990723
Epoch: 4, Steps: 89 | Train Loss: 0.298 Vali Loss: 0.260 Vali Acc: 0.930 Test Loss: 0.260 Test Acc: 0.930
Validation loss decreased (-0.903896 --> -0.930360).  Saving model ...
Epoch: 5 cost time: 12.049890041351318
Epoch: 5, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.165 Vali Acc: 0.964 Test Loss: 0.165 Test Acc: 0.964
Validation loss decreased (-0.930360 --> -0.963787).  Saving model ...
Epoch: 6 cost time: 11.222562313079834
Epoch: 6, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.141 Vali Acc: 0.958 Test Loss: 0.141 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.401382684707642
Epoch: 7, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.162 Vali Acc: 0.948 Test Loss: 0.162 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.887187719345093
Epoch: 8, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
Validation loss decreased (-0.963787 --> -0.974929).  Saving model ...
Epoch: 9 cost time: 11.537470579147339
Epoch: 9, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
Validation loss decreased (-0.974929 --> -0.977715).  Saving model ...
Epoch: 10 cost time: 11.102887868881226
Epoch: 10, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.145 Vali Acc: 0.955 Test Loss: 0.145 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 11.063631057739258
Epoch: 11, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 11.818368911743164
Epoch: 12, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.099 Vali Acc: 0.969 Test Loss: 0.099 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 11.493290901184082
Epoch: 13, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.120 Vali Acc: 0.966 Test Loss: 0.120 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 12.061952352523804
Epoch: 14, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 12.352340936660767
Epoch: 15, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 10.718350410461426
Epoch: 16, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 11.42760705947876
Epoch: 17, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.112 Vali Acc: 0.966 Test Loss: 0.112 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 12.690966606140137
Epoch: 18, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 11.588327884674072
Epoch: 19, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 1220496
model size : 6.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.454362392425537
Epoch: 1, Steps: 89 | Train Loss: 2.549 Vali Loss: 1.456 Vali Acc: 0.675 Test Loss: 1.456 Test Acc: 0.675
Validation loss decreased (inf --> -0.674777).  Saving model ...
Epoch: 2 cost time: 12.174947500228882
Epoch: 2, Steps: 89 | Train Loss: 0.994 Vali Loss: 0.577 Vali Acc: 0.869 Test Loss: 0.577 Test Acc: 0.869
Validation loss decreased (-0.674777 --> -0.869075).  Saving model ...
Epoch: 3 cost time: 13.340373039245605
Epoch: 3, Steps: 89 | Train Loss: 0.465 Vali Loss: 0.362 Vali Acc: 0.909 Test Loss: 0.362 Test Acc: 0.909
Validation loss decreased (-0.869075 --> -0.909467).  Saving model ...
Epoch: 4 cost time: 13.215962171554565
Epoch: 4, Steps: 89 | Train Loss: 0.296 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.909467 --> -0.944288).  Saving model ...
Epoch: 5 cost time: 11.590721368789673
Epoch: 5, Steps: 89 | Train Loss: 0.197 Vali Loss: 0.180 Vali Acc: 0.952 Test Loss: 0.180 Test Acc: 0.952
Validation loss decreased (-0.944288 --> -0.951948).  Saving model ...
Epoch: 6 cost time: 10.95899772644043
Epoch: 6, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
Validation loss decreased (-0.951948 --> -0.961698).  Saving model ...
Epoch: 7 cost time: 11.590151309967041
Epoch: 7, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
Validation loss decreased (-0.961698 --> -0.967269).  Saving model ...
Epoch: 8 cost time: 11.166961431503296
Epoch: 8, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.097 Vali Acc: 0.971 Test Loss: 0.097 Test Acc: 0.971
Validation loss decreased (-0.967269 --> -0.971447).  Saving model ...
Epoch: 9 cost time: 10.507011890411377
Epoch: 9, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
Validation loss decreased (-0.971447 --> -0.976322).  Saving model ...
Epoch: 10 cost time: 12.327715873718262
Epoch: 10, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.085 Vali Acc: 0.974 Test Loss: 0.085 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 11.07110595703125
Epoch: 11, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.109 Vali Acc: 0.967 Test Loss: 0.109 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 11.128986835479736
Epoch: 12, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.112 Vali Acc: 0.969 Test Loss: 0.112 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 11.55920672416687
Epoch: 13, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 10.308131694793701
Epoch: 14, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.110 Vali Acc: 0.969 Test Loss: 0.110 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 11.756824016571045
Epoch: 15, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.175 Vali Acc: 0.948 Test Loss: 0.175 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 13.0297691822052
Epoch: 16, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.106 Vali Acc: 0.969 Test Loss: 0.106 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 11.785720825195312
Epoch: 17, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.978411).  Saving model ...
Epoch: 18 cost time: 11.140013456344604
Epoch: 18, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.144 Vali Acc: 0.963 Test Loss: 0.144 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 10.211848974227905
Epoch: 19, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.978411 --> -0.979804).  Saving model ...
Epoch: 20 cost time: 10.957666635513306
Epoch: 20, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.151 Vali Acc: 0.960 Test Loss: 0.151 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 10.391456127166748
Epoch: 21, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 10.856639862060547
Epoch: 22, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.116 Vali Acc: 0.967 Test Loss: 0.116 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 12.362163305282593
Epoch: 23, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 12.039634466171265
Epoch: 24, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 11.512202262878418
Epoch: 25, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 11.293410062789917
Epoch: 26, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.104 Vali Acc: 0.966 Test Loss: 0.104 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 12.007760286331177
Epoch: 27, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.981197).  Saving model ...
Epoch: 28 cost time: 11.567641735076904
Epoch: 28, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.090 Vali Acc: 0.972 Test Loss: 0.090 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 11.673459768295288
Epoch: 29, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 12.255114078521729
Epoch: 30, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.193 Vali Acc: 0.955 Test Loss: 0.193 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 11.284842729568481
Epoch: 31, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.103 Vali Acc: 0.964 Test Loss: 0.103 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 11.4366614818573
Epoch: 32, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.133 Vali Acc: 0.964 Test Loss: 0.133 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 11.56187915802002
Epoch: 33, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.105 Vali Acc: 0.969 Test Loss: 0.105 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 10.983988523483276
Epoch: 34, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.145 Vali Acc: 0.960 Test Loss: 0.145 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 11.32791805267334
Epoch: 35, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.109 Vali Acc: 0.967 Test Loss: 0.109 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 11.818150758743286
Epoch: 36, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.086 Vali Acc: 0.974 Test Loss: 0.086 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 10.959219455718994
Epoch: 37, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 1218576
model size : 6.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.174455881118774
Epoch: 1, Steps: 89 | Train Loss: 2.710 Vali Loss: 1.778 Vali Acc: 0.652 Test Loss: 1.778 Test Acc: 0.652
Validation loss decreased (inf --> -0.651793).  Saving model ...
Epoch: 2 cost time: 11.81545376777649
Epoch: 2, Steps: 89 | Train Loss: 1.146 Vali Loss: 0.659 Vali Acc: 0.847 Test Loss: 0.659 Test Acc: 0.847
Validation loss decreased (-0.651793 --> -0.846790).  Saving model ...
Epoch: 3 cost time: 11.167861700057983
Epoch: 3, Steps: 89 | Train Loss: 0.545 Vali Loss: 0.374 Vali Acc: 0.916 Test Loss: 0.374 Test Acc: 0.916
Validation loss decreased (-0.846790 --> -0.915734).  Saving model ...
Epoch: 4 cost time: 10.33812689781189
Epoch: 4, Steps: 89 | Train Loss: 0.369 Vali Loss: 0.268 Vali Acc: 0.939 Test Loss: 0.268 Test Acc: 0.939
Validation loss decreased (-0.915734 --> -0.939412).  Saving model ...
Epoch: 5 cost time: 10.444639205932617
Epoch: 5, Steps: 89 | Train Loss: 0.240 Vali Loss: 0.201 Vali Acc: 0.942 Test Loss: 0.201 Test Acc: 0.942
Validation loss decreased (-0.939412 --> -0.942199).  Saving model ...
Epoch: 6 cost time: 11.536166667938232
Epoch: 6, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.132 Vali Acc: 0.967 Test Loss: 0.132 Test Acc: 0.967
Validation loss decreased (-0.942199 --> -0.967269).  Saving model ...
Epoch: 7 cost time: 11.083636999130249
Epoch: 7, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.110 Vali Acc: 0.971 Test Loss: 0.110 Test Acc: 0.971
Validation loss decreased (-0.967269 --> -0.971447).  Saving model ...
Epoch: 8 cost time: 10.390849590301514
Epoch: 8, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
Validation loss decreased (-0.971447 --> -0.979108).  Saving model ...
Epoch: 9 cost time: 12.929861307144165
Epoch: 9, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.126 Vali Acc: 0.960 Test Loss: 0.126 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 11.999720573425293
Epoch: 10, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.064 Vali Acc: 0.985 Test Loss: 0.064 Test Acc: 0.985
Validation loss decreased (-0.979108 --> -0.985375).  Saving model ...
Epoch: 11 cost time: 11.939000129699707
Epoch: 11, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.105 Vali Acc: 0.971 Test Loss: 0.105 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 11.995537757873535
Epoch: 12, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 11.321319341659546
Epoch: 13, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.102 Vali Acc: 0.969 Test Loss: 0.102 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 11.033199310302734
Epoch: 14, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.097 Vali Acc: 0.972 Test Loss: 0.097 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 10.849125146865845
Epoch: 15, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 11.334418773651123
Epoch: 16, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.139 Vali Acc: 0.956 Test Loss: 0.139 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 11.39633321762085
Epoch: 17, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 10.441228151321411
Epoch: 18, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.066 Vali Acc: 0.981 Test Loss: 0.066 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 11.27243947982788
Epoch: 19, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.068 Vali Acc: 0.979 Test Loss: 0.068 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 10.61177659034729
Epoch: 20, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 927120
model size : 4.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 12.540388822555542
Epoch: 1, Steps: 89 | Train Loss: 2.785 Vali Loss: 1.914 Vali Acc: 0.585 Test Loss: 1.914 Test Acc: 0.585
Validation loss decreased (inf --> -0.584939).  Saving model ...
Epoch: 2 cost time: 10.589030504226685
Epoch: 2, Steps: 89 | Train Loss: 1.226 Vali Loss: 0.692 Vali Acc: 0.838 Test Loss: 0.692 Test Acc: 0.838
Validation loss decreased (-0.584939 --> -0.838433).  Saving model ...
Epoch: 3 cost time: 11.549905776977539
Epoch: 3, Steps: 89 | Train Loss: 0.553 Vali Loss: 0.422 Vali Acc: 0.884 Test Loss: 0.422 Test Acc: 0.884
Validation loss decreased (-0.838433 --> -0.883701).  Saving model ...
Epoch: 4 cost time: 11.539874792098999
Epoch: 4, Steps: 89 | Train Loss: 0.324 Vali Loss: 0.234 Vali Acc: 0.941 Test Loss: 0.234 Test Acc: 0.941
Validation loss decreased (-0.883701 --> -0.940805).  Saving model ...
Epoch: 5 cost time: 11.584145545959473
Epoch: 5, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.189 Vali Acc: 0.948 Test Loss: 0.189 Test Acc: 0.948
Validation loss decreased (-0.940805 --> -0.948466).  Saving model ...
Epoch: 6 cost time: 11.28996229171753
Epoch: 6, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.131 Vali Acc: 0.960 Test Loss: 0.131 Test Acc: 0.960
Validation loss decreased (-0.948466 --> -0.959609).  Saving model ...
Epoch: 7 cost time: 10.981455087661743
Epoch: 7, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.134 Vali Acc: 0.963 Test Loss: 0.134 Test Acc: 0.963
Validation loss decreased (-0.959609 --> -0.963091).  Saving model ...
Epoch: 8 cost time: 10.859112024307251
Epoch: 8, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.865799188613892
Epoch: 9, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.963091 --> -0.982590).  Saving model ...
Epoch: 10 cost time: 10.73253059387207
Epoch: 10, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.092 Vali Acc: 0.971 Test Loss: 0.092 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 11.581396579742432
Epoch: 11, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.106 Vali Acc: 0.969 Test Loss: 0.106 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 11.505690813064575
Epoch: 12, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.128 Vali Acc: 0.960 Test Loss: 0.128 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 11.574517250061035
Epoch: 13, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.086 Vali Acc: 0.971 Test Loss: 0.086 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 10.931894779205322
Epoch: 14, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.089 Vali Acc: 0.974 Test Loss: 0.089 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 10.992170095443726
Epoch: 15, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 10.174521446228027
Epoch: 16, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 10.681861400604248
Epoch: 17, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.082 Vali Acc: 0.971 Test Loss: 0.082 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 10.79292631149292
Epoch: 18, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 10.604512214660645
Epoch: 19, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.982590 --> -0.982590).  Saving model ...
Epoch: 20 cost time: 10.956427574157715
Epoch: 20, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 10.998988628387451
Epoch: 21, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 10.990386009216309
Epoch: 22, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.134 Vali Acc: 0.972 Test Loss: 0.134 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 11.520287036895752
Epoch: 23, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.116 Vali Acc: 0.967 Test Loss: 0.116 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 10.89822268486023
Epoch: 24, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 11.700798749923706
Epoch: 25, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.114 Vali Acc: 0.964 Test Loss: 0.114 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 10.855494022369385
Epoch: 26, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 10.797669649124146
Epoch: 27, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.060 Vali Acc: 0.985 Test Loss: 0.060 Test Acc: 0.985
Validation loss decreased (-0.982590 --> -0.985375).  Saving model ...
Epoch: 28 cost time: 10.22398567199707
Epoch: 28, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 10.780839681625366
Epoch: 29, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.080 Vali Acc: 0.972 Test Loss: 0.080 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 12.176076173782349
Epoch: 30, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 11.07511830329895
Epoch: 31, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.114 Vali Acc: 0.967 Test Loss: 0.114 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 11.758102178573608
Epoch: 32, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.123 Vali Acc: 0.969 Test Loss: 0.123 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 11.5678231716156
Epoch: 33, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.112 Vali Acc: 0.967 Test Loss: 0.112 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 11.581242799758911
Epoch: 34, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.112 Vali Acc: 0.966 Test Loss: 0.112 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 9.966586112976074
Epoch: 35, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.072 Vali Acc: 0.979 Test Loss: 0.072 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 10.48788046836853
Epoch: 36, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 11.655917167663574
Epoch: 37, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.109 Vali Acc: 0.967 Test Loss: 0.109 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 925200
model size : 4.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 12.042794466018677
Epoch: 1, Steps: 89 | Train Loss: 2.659 Vali Loss: 1.740 Vali Acc: 0.502 Test Loss: 1.740 Test Acc: 0.502
Validation loss decreased (inf --> -0.502072).  Saving model ...
Epoch: 2 cost time: 11.37668490409851
Epoch: 2, Steps: 89 | Train Loss: 1.174 Vali Loss: 0.699 Vali Acc: 0.822 Test Loss: 0.699 Test Acc: 0.822
Validation loss decreased (-0.502072 --> -0.822416).  Saving model ...
Epoch: 3 cost time: 11.560374021530151
Epoch: 3, Steps: 89 | Train Loss: 0.539 Vali Loss: 0.395 Vali Acc: 0.908 Test Loss: 0.395 Test Acc: 0.908
Validation loss decreased (-0.822416 --> -0.908074).  Saving model ...
Epoch: 4 cost time: 11.949022054672241
Epoch: 4, Steps: 89 | Train Loss: 0.335 Vali Loss: 0.326 Vali Acc: 0.903 Test Loss: 0.326 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.319588899612427
Epoch: 5, Steps: 89 | Train Loss: 0.244 Vali Loss: 0.175 Vali Acc: 0.954 Test Loss: 0.175 Test Acc: 0.954
Validation loss decreased (-0.908074 --> -0.954037).  Saving model ...
Epoch: 6 cost time: 10.4184410572052
Epoch: 6, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.180 Vali Acc: 0.962 Test Loss: 0.180 Test Acc: 0.962
Validation loss decreased (-0.954037 --> -0.962394).  Saving model ...
Epoch: 7 cost time: 10.179216384887695
Epoch: 7, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.784224271774292
Epoch: 8, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.173 Vali Acc: 0.946 Test Loss: 0.173 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 11.321638822555542
Epoch: 9, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.132 Vali Acc: 0.964 Test Loss: 0.132 Test Acc: 0.964
Validation loss decreased (-0.962394 --> -0.964483).  Saving model ...
Epoch: 10 cost time: 12.11092233657837
Epoch: 10, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.094 Vali Acc: 0.974 Test Loss: 0.094 Test Acc: 0.974
Validation loss decreased (-0.964483 --> -0.974233).  Saving model ...
Epoch: 11 cost time: 12.680622339248657
Epoch: 11, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.076 Vali Acc: 0.974 Test Loss: 0.076 Test Acc: 0.974
Validation loss decreased (-0.974233 --> -0.974233).  Saving model ...
Epoch: 12 cost time: 12.639126300811768
Epoch: 12, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.974233 --> -0.977019).  Saving model ...
Epoch: 13 cost time: 11.534112691879272
Epoch: 13, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 10.049668312072754
Epoch: 14, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.977019 --> -0.979804).  Saving model ...
Epoch: 15 cost time: 11.62402606010437
Epoch: 15, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.083 Vali Acc: 0.975 Test Loss: 0.083 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 11.206018686294556
Epoch: 16, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.077 Vali Acc: 0.974 Test Loss: 0.077 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 14.125007152557373
Epoch: 17, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 12.030805826187134
Epoch: 18, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 12.435856580734253
Epoch: 19, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 12.019208908081055
Epoch: 20, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.981197).  Saving model ...
Epoch: 21 cost time: 11.740404605865479
Epoch: 21, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.058 Vali Acc: 0.982 Test Loss: 0.058 Test Acc: 0.982
Validation loss decreased (-0.981197 --> -0.981894).  Saving model ...
Epoch: 22 cost time: 11.291309356689453
Epoch: 22, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 12.265794277191162
Epoch: 23, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 12.563910007476807
Epoch: 24, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 12.895933389663696
Epoch: 25, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.128 Vali Acc: 0.963 Test Loss: 0.128 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 12.76309609413147
Epoch: 26, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 11.924091815948486
Epoch: 27, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.124 Vali Acc: 0.966 Test Loss: 0.124 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 11.740325689315796
Epoch: 28, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.211 Vali Acc: 0.940 Test Loss: 0.211 Test Acc: 0.940
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 12.798235177993774
Epoch: 29, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 12.733641147613525
Epoch: 30, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.981894 --> -0.983286).  Saving model ...
Epoch: 31 cost time: 11.144764184951782
Epoch: 31, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 11.814235925674438
Epoch: 32, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.054 Vali Acc: 0.983 Test Loss: 0.054 Test Acc: 0.983
Validation loss decreased (-0.983286 --> -0.983286).  Saving model ...
Epoch: 33 cost time: 11.268088340759277
Epoch: 33, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 11.474745988845825
Epoch: 34, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.086 Vali Acc: 0.975 Test Loss: 0.086 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 11.872958421707153
Epoch: 35, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 11.166340112686157
Epoch: 36, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 11.413493394851685
Epoch: 37, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 11.317721605300903
Epoch: 38, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 10.804978609085083
Epoch: 39, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 11.59418773651123
Epoch: 40, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.086 Vali Acc: 0.972 Test Loss: 0.086 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 12.255674362182617
Epoch: 41, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 11.564242839813232
Epoch: 42, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 923280
model size : 4.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 14.055160999298096
Epoch: 1, Steps: 89 | Train Loss: 2.824 Vali Loss: 2.011 Vali Acc: 0.510 Test Loss: 2.011 Test Acc: 0.510
Validation loss decreased (inf --> -0.509729).  Saving model ...
Epoch: 2 cost time: 12.118648290634155
Epoch: 2, Steps: 89 | Train Loss: 1.240 Vali Loss: 0.679 Vali Acc: 0.854 Test Loss: 0.679 Test Acc: 0.854
Validation loss decreased (-0.509729 --> -0.853754).  Saving model ...
Epoch: 3 cost time: 10.93177843093872
Epoch: 3, Steps: 89 | Train Loss: 0.520 Vali Loss: 0.388 Vali Acc: 0.898 Test Loss: 0.388 Test Acc: 0.898
Validation loss decreased (-0.853754 --> -0.898325).  Saving model ...
Epoch: 4 cost time: 11.349742412567139
Epoch: 4, Steps: 89 | Train Loss: 0.310 Vali Loss: 0.224 Vali Acc: 0.947 Test Loss: 0.224 Test Acc: 0.947
Validation loss decreased (-0.898325 --> -0.947073).  Saving model ...
Epoch: 5 cost time: 11.442100048065186
Epoch: 5, Steps: 89 | Train Loss: 0.227 Vali Loss: 0.193 Vali Acc: 0.948 Test Loss: 0.193 Test Acc: 0.948
Validation loss decreased (-0.947073 --> -0.948466).  Saving model ...
Epoch: 6 cost time: 10.592651844024658
Epoch: 6, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.131 Vali Acc: 0.969 Test Loss: 0.131 Test Acc: 0.969
Validation loss decreased (-0.948466 --> -0.969358).  Saving model ...
Epoch: 7 cost time: 12.434027433395386
Epoch: 7, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.139 Vali Acc: 0.960 Test Loss: 0.139 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.323869466781616
Epoch: 8, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.143 Vali Acc: 0.958 Test Loss: 0.143 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 11.40096664428711
Epoch: 9, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.146 Vali Acc: 0.958 Test Loss: 0.146 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 12.10465955734253
Epoch: 10, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.970751).  Saving model ...
Epoch: 11 cost time: 11.957866668701172
Epoch: 11, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.091 Vali Acc: 0.972 Test Loss: 0.091 Test Acc: 0.972
Validation loss decreased (-0.970751 --> -0.972144).  Saving model ...
Epoch: 12 cost time: 12.347477674484253
Epoch: 12, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (-0.972144 --> -0.975626).  Saving model ...
Epoch: 13 cost time: 10.716431856155396
Epoch: 13, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 12.77442741394043
Epoch: 14, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 12.240545749664307
Epoch: 15, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
Validation loss decreased (-0.975626 --> -0.977715).  Saving model ...
Epoch: 16 cost time: 12.159651756286621
Epoch: 16, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.074 Vali Acc: 0.979 Test Loss: 0.074 Test Acc: 0.979
Validation loss decreased (-0.977715 --> -0.979108).  Saving model ...
Epoch: 17 cost time: 12.572930812835693
Epoch: 17, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 11.409176349639893
Epoch: 18, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.140 Vali Acc: 0.958 Test Loss: 0.140 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 10.299980163574219
Epoch: 19, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.144 Vali Acc: 0.952 Test Loss: 0.144 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 11.225146293640137
Epoch: 20, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.099 Vali Acc: 0.969 Test Loss: 0.099 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 11.18221116065979
Epoch: 21, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.134 Vali Acc: 0.960 Test Loss: 0.134 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 11.331269025802612
Epoch: 22, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.066 Vali Acc: 0.977 Test Loss: 0.066 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 11.6334969997406
Epoch: 23, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 11.207671642303467
Epoch: 24, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.087 Vali Acc: 0.971 Test Loss: 0.087 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 11.187116861343384
Epoch: 25, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.094 Vali Acc: 0.971 Test Loss: 0.094 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 10.893438577651978
Epoch: 26, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 921360
model size : 4.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 14.398409605026245
Epoch: 1, Steps: 89 | Train Loss: 2.815 Vali Loss: 2.133 Vali Acc: 0.444 Test Loss: 2.133 Test Acc: 0.444
Validation loss decreased (inf --> -0.443572).  Saving model ...
Epoch: 2 cost time: 11.829206228256226
Epoch: 2, Steps: 89 | Train Loss: 1.375 Vali Loss: 0.778 Vali Acc: 0.815 Test Loss: 0.778 Test Acc: 0.815
Validation loss decreased (-0.443572 --> -0.814755).  Saving model ...
Epoch: 3 cost time: 10.986402750015259
Epoch: 3, Steps: 89 | Train Loss: 0.579 Vali Loss: 0.430 Vali Acc: 0.895 Test Loss: 0.430 Test Acc: 0.895
Validation loss decreased (-0.814755 --> -0.894842).  Saving model ...
Epoch: 4 cost time: 11.699856758117676
Epoch: 4, Steps: 89 | Train Loss: 0.342 Vali Loss: 0.279 Vali Acc: 0.935 Test Loss: 0.279 Test Acc: 0.935
Validation loss decreased (-0.894842 --> -0.934538).  Saving model ...
Epoch: 5 cost time: 11.707048892974854
Epoch: 5, Steps: 89 | Train Loss: 0.238 Vali Loss: 0.202 Vali Acc: 0.951 Test Loss: 0.202 Test Acc: 0.951
Validation loss decreased (-0.934538 --> -0.951251).  Saving model ...
Epoch: 6 cost time: 11.076965093612671
Epoch: 6, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
Validation loss decreased (-0.951251 --> -0.966572).  Saving model ...
Epoch: 7 cost time: 10.33234977722168
Epoch: 7, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.163 Vali Acc: 0.956 Test Loss: 0.163 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.525626182556152
Epoch: 8, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.104 Vali Acc: 0.969 Test Loss: 0.104 Test Acc: 0.969
Validation loss decreased (-0.966572 --> -0.969358).  Saving model ...
Epoch: 9 cost time: 11.203738451004028
Epoch: 9, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
Validation loss decreased (-0.969358 --> -0.975626).  Saving model ...
Epoch: 10 cost time: 11.191982507705688
Epoch: 10, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 11.100842952728271
Epoch: 11, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 11.438693761825562
Epoch: 12, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.087 Vali Acc: 0.974 Test Loss: 0.087 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 10.779552459716797
Epoch: 13, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
Validation loss decreased (-0.975626 --> -0.978411).  Saving model ...
Epoch: 14 cost time: 10.670595169067383
Epoch: 14, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.159 Vali Acc: 0.953 Test Loss: 0.159 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 10.697003602981567
Epoch: 15, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 10.87492561340332
Epoch: 16, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 10.10109567642212
Epoch: 17, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
Validation loss decreased (-0.978411 --> -0.980501).  Saving model ...
Epoch: 18 cost time: 10.849231958389282
Epoch: 18, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.088 Vali Acc: 0.974 Test Loss: 0.088 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 11.540025472640991
Epoch: 19, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.108 Vali Acc: 0.969 Test Loss: 0.108 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 11.296547174453735
Epoch: 20, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 10.928175449371338
Epoch: 21, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.980501 --> -0.983286).  Saving model ...
Epoch: 22 cost time: 10.704628229141235
Epoch: 22, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.054 Vali Acc: 0.986 Test Loss: 0.054 Test Acc: 0.986
Validation loss decreased (-0.983286 --> -0.986072).  Saving model ...
Epoch: 23 cost time: 11.634979963302612
Epoch: 23, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.211 Vali Acc: 0.949 Test Loss: 0.211 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 13.317453384399414
Epoch: 24, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 12.539064884185791
Epoch: 25, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 12.932745695114136
Epoch: 26, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.066 Vali Acc: 0.977 Test Loss: 0.066 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 12.479610443115234
Epoch: 27, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 12.319398403167725
Epoch: 28, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 12.581905126571655
Epoch: 29, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 12.953038454055786
Epoch: 30, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 11.548068761825562
Epoch: 31, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.129 Vali Acc: 0.964 Test Loss: 0.129 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 11.640668153762817
Epoch: 32, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 778512
model size : 4.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 12.644383430480957
Epoch: 1, Steps: 89 | Train Loss: 2.835 Vali Loss: 2.077 Vali Acc: 0.476 Test Loss: 2.077 Test Acc: 0.476
Validation loss decreased (inf --> -0.475606).  Saving model ...
Epoch: 2 cost time: 10.807362794876099
Epoch: 2, Steps: 89 | Train Loss: 1.343 Vali Loss: 0.750 Vali Acc: 0.843 Test Loss: 0.750 Test Acc: 0.843
Validation loss decreased (-0.475606 --> -0.842611).  Saving model ...
Epoch: 3 cost time: 10.18566083908081
Epoch: 3, Steps: 89 | Train Loss: 0.574 Vali Loss: 0.394 Vali Acc: 0.916 Test Loss: 0.394 Test Acc: 0.916
Validation loss decreased (-0.842611 --> -0.916431).  Saving model ...
Epoch: 4 cost time: 10.599387407302856
Epoch: 4, Steps: 89 | Train Loss: 0.330 Vali Loss: 0.244 Vali Acc: 0.938 Test Loss: 0.244 Test Acc: 0.938
Validation loss decreased (-0.916431 --> -0.938020).  Saving model ...
Epoch: 5 cost time: 10.919313669204712
Epoch: 5, Steps: 89 | Train Loss: 0.208 Vali Loss: 0.209 Vali Acc: 0.938 Test Loss: 0.209 Test Acc: 0.938
Validation loss decreased (-0.938020 --> -0.938020).  Saving model ...
Epoch: 6 cost time: 11.777985095977783
Epoch: 6, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.144 Vali Acc: 0.965 Test Loss: 0.144 Test Acc: 0.965
Validation loss decreased (-0.938020 --> -0.965180).  Saving model ...
Epoch: 7 cost time: 11.29660677909851
Epoch: 7, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
Validation loss decreased (-0.965180 --> -0.967965).  Saving model ...
Epoch: 8 cost time: 9.883126974105835
Epoch: 8, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.967965 --> -0.977019).  Saving model ...
Epoch: 9 cost time: 9.793224096298218
Epoch: 9, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.094 Vali Acc: 0.974 Test Loss: 0.094 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.41684603691101
Epoch: 10, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.143 Vali Acc: 0.955 Test Loss: 0.143 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 10.986908197402954
Epoch: 11, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.122 Vali Acc: 0.966 Test Loss: 0.122 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 11.560603857040405
Epoch: 12, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.108 Vali Acc: 0.969 Test Loss: 0.108 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 12.01640272140503
Epoch: 13, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 10.89746880531311
Epoch: 14, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.123 Vali Acc: 0.969 Test Loss: 0.123 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 11.088665008544922
Epoch: 15, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.071 Vali Acc: 0.979 Test Loss: 0.071 Test Acc: 0.979
Validation loss decreased (-0.977019 --> -0.979108).  Saving model ...
Epoch: 16 cost time: 10.336206436157227
Epoch: 16, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 10.974977970123291
Epoch: 17, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 11.845206022262573
Epoch: 18, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 12.36611557006836
Epoch: 19, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.106 Vali Acc: 0.967 Test Loss: 0.106 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 11.787955522537231
Epoch: 20, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
Validation loss decreased (-0.979108 --> -0.980501).  Saving model ...
Epoch: 21 cost time: 13.049567461013794
Epoch: 21, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.086 Vali Acc: 0.974 Test Loss: 0.086 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 11.902205467224121
Epoch: 22, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 11.5965256690979
Epoch: 23, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 11.503724336624146
Epoch: 24, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 11.169991493225098
Epoch: 25, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.067 Vali Acc: 0.986 Test Loss: 0.067 Test Acc: 0.986
Validation loss decreased (-0.980501 --> -0.986072).  Saving model ...
Epoch: 26 cost time: 12.060863018035889
Epoch: 26, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.083 Vali Acc: 0.979 Test Loss: 0.083 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 11.16754961013794
Epoch: 27, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 12.401073694229126
Epoch: 28, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 11.320145845413208
Epoch: 29, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.159 Vali Acc: 0.956 Test Loss: 0.159 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 11.34992265701294
Epoch: 30, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 11.394167423248291
Epoch: 31, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 10.601858139038086
Epoch: 32, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 12.790263175964355
Epoch: 33, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 13.191248655319214
Epoch: 34, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.219 Vali Acc: 0.955 Test Loss: 0.219 Test Acc: 0.955
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 13.371576070785522
Epoch: 35, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 776592
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 14.090287685394287
Epoch: 1, Steps: 89 | Train Loss: 2.849 Vali Loss: 2.160 Vali Acc: 0.370 Test Loss: 2.160 Test Acc: 0.370
Validation loss decreased (inf --> -0.370452).  Saving model ...
Epoch: 2 cost time: 11.196659564971924
Epoch: 2, Steps: 89 | Train Loss: 1.395 Vali Loss: 0.805 Vali Acc: 0.797 Test Loss: 0.805 Test Acc: 0.797
Validation loss decreased (-0.370452 --> -0.797346).  Saving model ...
Epoch: 3 cost time: 11.512357473373413
Epoch: 3, Steps: 89 | Train Loss: 0.618 Vali Loss: 0.429 Vali Acc: 0.908 Test Loss: 0.429 Test Acc: 0.908
Validation loss decreased (-0.797346 --> -0.908074).  Saving model ...
Epoch: 4 cost time: 10.597807168960571
Epoch: 4, Steps: 89 | Train Loss: 0.358 Vali Loss: 0.298 Vali Acc: 0.928 Test Loss: 0.298 Test Acc: 0.928
Validation loss decreased (-0.908074 --> -0.927574).  Saving model ...
Epoch: 5 cost time: 10.994406938552856
Epoch: 5, Steps: 89 | Train Loss: 0.250 Vali Loss: 0.202 Vali Acc: 0.948 Test Loss: 0.202 Test Acc: 0.948
Validation loss decreased (-0.927574 --> -0.947770).  Saving model ...
Epoch: 6 cost time: 11.303507328033447
Epoch: 6, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
Validation loss decreased (-0.947770 --> -0.947770).  Saving model ...
Epoch: 7 cost time: 10.857768058776855
Epoch: 7, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.152 Vali Acc: 0.960 Test Loss: 0.152 Test Acc: 0.960
Validation loss decreased (-0.947770 --> -0.959609).  Saving model ...
Epoch: 8 cost time: 11.918039560317993
Epoch: 8, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.120 Vali Acc: 0.966 Test Loss: 0.120 Test Acc: 0.966
Validation loss decreased (-0.959609 --> -0.965876).  Saving model ...
Epoch: 9 cost time: 10.622453927993774
Epoch: 9, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
Validation loss decreased (-0.965876 --> -0.967966).  Saving model ...
Epoch: 10 cost time: 9.755409717559814
Epoch: 10, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
Validation loss decreased (-0.967966 --> -0.977715).  Saving model ...
Epoch: 11 cost time: 11.051079034805298
Epoch: 11, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.977715 --> -0.979804).  Saving model ...
Epoch: 12 cost time: 11.061450242996216
Epoch: 12, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 10.178951025009155
Epoch: 13, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.115 Vali Acc: 0.963 Test Loss: 0.115 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 10.66110348701477
Epoch: 14, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 10.691672801971436
Epoch: 15, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.092 Vali Acc: 0.971 Test Loss: 0.092 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 10.830554246902466
Epoch: 16, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 10.31529426574707
Epoch: 17, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.087 Vali Acc: 0.967 Test Loss: 0.087 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 10.579648494720459
Epoch: 18, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.097 Vali Acc: 0.971 Test Loss: 0.097 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 10.66456389427185
Epoch: 19, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 9.787597417831421
Epoch: 20, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 10.622895240783691
Epoch: 21, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 774672
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.00036907196045
Epoch: 1, Steps: 89 | Train Loss: 2.762 Vali Loss: 1.980 Vali Acc: 0.548 Test Loss: 1.980 Test Acc: 0.548
Validation loss decreased (inf --> -0.548030).  Saving model ...
Epoch: 2 cost time: 12.243778944015503
Epoch: 2, Steps: 89 | Train Loss: 1.306 Vali Loss: 0.694 Vali Acc: 0.840 Test Loss: 0.694 Test Acc: 0.840
Validation loss decreased (-0.548030 --> -0.839826).  Saving model ...
Epoch: 3 cost time: 11.211039304733276
Epoch: 3, Steps: 89 | Train Loss: 0.562 Vali Loss: 0.388 Vali Acc: 0.919 Test Loss: 0.388 Test Acc: 0.919
Validation loss decreased (-0.839826 --> -0.918520).  Saving model ...
Epoch: 4 cost time: 11.28370189666748
Epoch: 4, Steps: 89 | Train Loss: 0.326 Vali Loss: 0.300 Vali Acc: 0.919 Test Loss: 0.300 Test Acc: 0.919
Validation loss decreased (-0.918520 --> -0.919217).  Saving model ...
Epoch: 5 cost time: 12.339467525482178
Epoch: 5, Steps: 89 | Train Loss: 0.226 Vali Loss: 0.179 Vali Acc: 0.955 Test Loss: 0.179 Test Acc: 0.955
Validation loss decreased (-0.919217 --> -0.954734).  Saving model ...
Epoch: 6 cost time: 11.877893686294556
Epoch: 6, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.151 Vali Acc: 0.963 Test Loss: 0.151 Test Acc: 0.963
Validation loss decreased (-0.954734 --> -0.963090).  Saving model ...
Epoch: 7 cost time: 11.636388540267944
Epoch: 7, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 12.381210803985596
Epoch: 8, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.963090 --> -0.977018).  Saving model ...
Epoch: 9 cost time: 13.207393169403076
Epoch: 9, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.153 Vali Acc: 0.948 Test Loss: 0.153 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 12.016053676605225
Epoch: 10, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 10.428251266479492
Epoch: 11, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 12.159920692443848
Epoch: 12, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.207 Vali Acc: 0.942 Test Loss: 0.207 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 10.453104972839355
Epoch: 13, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.140 Vali Acc: 0.955 Test Loss: 0.140 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 11.886120557785034
Epoch: 14, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 11.93764066696167
Epoch: 15, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.114 Vali Acc: 0.966 Test Loss: 0.114 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 11.781306982040405
Epoch: 16, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 10.906864881515503
Epoch: 17, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.127 Vali Acc: 0.964 Test Loss: 0.127 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 12.218618631362915
Epoch: 18, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.097 Vali Acc: 0.969 Test Loss: 0.097 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 772752
model size : 4.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.354178190231323
Epoch: 1, Steps: 89 | Train Loss: 2.762 Vali Loss: 2.037 Vali Acc: 0.526 Test Loss: 2.037 Test Acc: 0.526
Validation loss decreased (inf --> -0.525746).  Saving model ...
Epoch: 2 cost time: 11.090808629989624
Epoch: 2, Steps: 89 | Train Loss: 1.535 Vali Loss: 1.035 Vali Acc: 0.781 Test Loss: 1.035 Test Acc: 0.781
Validation loss decreased (-0.525746 --> -0.781327).  Saving model ...
Epoch: 3 cost time: 10.507580518722534
Epoch: 3, Steps: 89 | Train Loss: 0.875 Vali Loss: 0.608 Vali Acc: 0.864 Test Loss: 0.608 Test Acc: 0.864
Validation loss decreased (-0.781327 --> -0.863504).  Saving model ...
Epoch: 4 cost time: 9.987999200820923
Epoch: 4, Steps: 89 | Train Loss: 0.552 Vali Loss: 0.426 Vali Acc: 0.908 Test Loss: 0.426 Test Acc: 0.908
Validation loss decreased (-0.863504 --> -0.908074).  Saving model ...
Epoch: 5 cost time: 10.48368763923645
Epoch: 5, Steps: 89 | Train Loss: 0.373 Vali Loss: 0.285 Vali Acc: 0.925 Test Loss: 0.285 Test Acc: 0.925
Validation loss decreased (-0.908074 --> -0.924788).  Saving model ...
Epoch: 6 cost time: 10.993059635162354
Epoch: 6, Steps: 89 | Train Loss: 0.282 Vali Loss: 0.214 Vali Acc: 0.953 Test Loss: 0.214 Test Acc: 0.953
Validation loss decreased (-0.924788 --> -0.953340).  Saving model ...
Epoch: 7 cost time: 11.121655941009521
Epoch: 7, Steps: 89 | Train Loss: 0.209 Vali Loss: 0.170 Vali Acc: 0.961 Test Loss: 0.170 Test Acc: 0.961
Validation loss decreased (-0.953340 --> -0.961001).  Saving model ...
Epoch: 8 cost time: 11.086499214172363
Epoch: 8, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.190 Vali Acc: 0.946 Test Loss: 0.190 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.501473903656006
Epoch: 9, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.871923208236694
Epoch: 10, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.126 Vali Acc: 0.966 Test Loss: 0.126 Test Acc: 0.966
Validation loss decreased (-0.961001 --> -0.965876).  Saving model ...
Epoch: 11 cost time: 11.454601287841797
Epoch: 11, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.154 Vali Acc: 0.956 Test Loss: 0.154 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 11.756006002426147
Epoch: 12, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
Validation loss decreased (-0.965876 --> -0.977715).  Saving model ...
Epoch: 13 cost time: 11.505319356918335
Epoch: 13, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.183 Vali Acc: 0.938 Test Loss: 0.183 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 11.030545473098755
Epoch: 14, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 10.544049501419067
Epoch: 15, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 10.345356941223145
Epoch: 16, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 10.6613450050354
Epoch: 17, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 10.66107439994812
Epoch: 18, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 10.777610063552856
Epoch: 19, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.209 Vali Acc: 0.935 Test Loss: 0.209 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 10.847135066986084
Epoch: 20, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.087 Vali Acc: 0.972 Test Loss: 0.087 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 10.55255389213562
Epoch: 21, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.977715).  Saving model ...
Epoch: 22 cost time: 10.249059915542603
Epoch: 22, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
Validation loss decreased (-0.977715 --> -0.979108).  Saving model ...
Epoch: 23 cost time: 10.466824293136597
Epoch: 23, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
Validation loss decreased (-0.979108 --> -0.981197).  Saving model ...
Epoch: 24 cost time: 10.726415634155273
Epoch: 24, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 11.311909914016724
Epoch: 25, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 10.477157592773438
Epoch: 26, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.108 Vali Acc: 0.972 Test Loss: 0.108 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 11.27813458442688
Epoch: 27, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 11.331555604934692
Epoch: 28, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 10.612971067428589
Epoch: 29, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.119 Vali Acc: 0.967 Test Loss: 0.119 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 10.980597734451294
Epoch: 30, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.135 Vali Acc: 0.961 Test Loss: 0.135 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 11.60749864578247
Epoch: 31, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.136 Vali Acc: 0.958 Test Loss: 0.136 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 11.479071617126465
Epoch: 32, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 11.709252119064331
Epoch: 33, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 766576
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 14.952796697616577
Epoch: 1, Steps: 89 | Train Loss: 2.847 Vali Loss: 2.206 Vali Acc: 0.474 Test Loss: 2.206 Test Acc: 0.474
Validation loss decreased (inf --> -0.474212).  Saving model ...
Epoch: 2 cost time: 12.386499166488647
Epoch: 2, Steps: 89 | Train Loss: 1.677 Vali Loss: 1.116 Vali Acc: 0.763 Test Loss: 1.116 Test Acc: 0.763
Validation loss decreased (-0.474212 --> -0.763220).  Saving model ...
Epoch: 3 cost time: 12.793923139572144
Epoch: 3, Steps: 89 | Train Loss: 0.932 Vali Loss: 0.679 Vali Acc: 0.851 Test Loss: 0.679 Test Acc: 0.851
Validation loss decreased (-0.763220 --> -0.850968).  Saving model ...
Epoch: 4 cost time: 11.766647815704346
Epoch: 4, Steps: 89 | Train Loss: 0.595 Vali Loss: 0.518 Vali Acc: 0.886 Test Loss: 0.518 Test Acc: 0.886
Validation loss decreased (-0.850968 --> -0.885789).  Saving model ...
Epoch: 5 cost time: 14.649933815002441
Epoch: 5, Steps: 89 | Train Loss: 0.426 Vali Loss: 0.306 Vali Acc: 0.939 Test Loss: 0.306 Test Acc: 0.939
Validation loss decreased (-0.885789 --> -0.939412).  Saving model ...
Epoch: 6 cost time: 14.6285400390625
Epoch: 6, Steps: 89 | Train Loss: 0.289 Vali Loss: 0.248 Vali Acc: 0.936 Test Loss: 0.248 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 14.235202550888062
Epoch: 7, Steps: 89 | Train Loss: 0.229 Vali Loss: 0.193 Vali Acc: 0.950 Test Loss: 0.193 Test Acc: 0.950
Validation loss decreased (-0.939412 --> -0.949859).  Saving model ...
Epoch: 8 cost time: 13.312813520431519
Epoch: 8, Steps: 89 | Train Loss: 0.182 Vali Loss: 0.162 Vali Acc: 0.961 Test Loss: 0.162 Test Acc: 0.961
Validation loss decreased (-0.949859 --> -0.961001).  Saving model ...
Epoch: 9 cost time: 14.102996587753296
Epoch: 9, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.151 Vali Acc: 0.961 Test Loss: 0.151 Test Acc: 0.961
Validation loss decreased (-0.961001 --> -0.961001).  Saving model ...
Epoch: 10 cost time: 13.519922256469727
Epoch: 10, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.119 Vali Acc: 0.967 Test Loss: 0.119 Test Acc: 0.967
Validation loss decreased (-0.961001 --> -0.967269).  Saving model ...
Epoch: 11 cost time: 14.070723533630371
Epoch: 11, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 13.412111520767212
Epoch: 12, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
Validation loss decreased (-0.967269 --> -0.968662).  Saving model ...
Epoch: 13 cost time: 13.062849283218384
Epoch: 13, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.117 Vali Acc: 0.958 Test Loss: 0.117 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 13.862571239471436
Epoch: 14, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.109 Vali Acc: 0.969 Test Loss: 0.109 Test Acc: 0.969
Validation loss decreased (-0.968662 --> -0.969358).  Saving model ...
Epoch: 15 cost time: 11.74562406539917
Epoch: 15, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 11.793389320373535
Epoch: 16, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.078 Vali Acc: 0.979 Test Loss: 0.078 Test Acc: 0.979
Validation loss decreased (-0.969358 --> -0.979108).  Saving model ...
Epoch: 17 cost time: 11.754780769348145
Epoch: 17, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.143 Vali Acc: 0.955 Test Loss: 0.143 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 10.515355587005615
Epoch: 18, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 11.923949241638184
Epoch: 19, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.098 Vali Acc: 0.967 Test Loss: 0.098 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 12.041612148284912
Epoch: 20, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.106 Vali Acc: 0.963 Test Loss: 0.106 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 11.537465810775757
Epoch: 21, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.073 Vali Acc: 0.974 Test Loss: 0.073 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 11.404449939727783
Epoch: 22, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.087 Vali Acc: 0.969 Test Loss: 0.087 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 11.934624195098877
Epoch: 23, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 12.378187894821167
Epoch: 24, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 11.06314754486084
Epoch: 25, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 11.470966339111328
Epoch: 26, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.090 Vali Acc: 0.967 Test Loss: 0.090 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 765616
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.6158926486969
Epoch: 1, Steps: 89 | Train Loss: 2.856 Vali Loss: 2.105 Vali Acc: 0.588 Test Loss: 2.105 Test Acc: 0.588
Validation loss decreased (inf --> -0.587723).  Saving model ...
Epoch: 2 cost time: 11.323763132095337
Epoch: 2, Steps: 89 | Train Loss: 1.598 Vali Loss: 1.086 Vali Acc: 0.737 Test Loss: 1.086 Test Acc: 0.737
Validation loss decreased (-0.587723 --> -0.737454).  Saving model ...
Epoch: 3 cost time: 10.616077661514282
Epoch: 3, Steps: 89 | Train Loss: 0.895 Vali Loss: 0.645 Vali Acc: 0.863 Test Loss: 0.645 Test Acc: 0.863
Validation loss decreased (-0.737454 --> -0.862807).  Saving model ...
Epoch: 4 cost time: 11.161090612411499
Epoch: 4, Steps: 89 | Train Loss: 0.560 Vali Loss: 0.429 Vali Acc: 0.905 Test Loss: 0.429 Test Acc: 0.905
Validation loss decreased (-0.862807 --> -0.905288).  Saving model ...
Epoch: 5 cost time: 11.50458312034607
Epoch: 5, Steps: 89 | Train Loss: 0.389 Vali Loss: 0.306 Vali Acc: 0.921 Test Loss: 0.306 Test Acc: 0.921
Validation loss decreased (-0.905288 --> -0.920610).  Saving model ...
Epoch: 6 cost time: 9.487489223480225
Epoch: 6, Steps: 89 | Train Loss: 0.265 Vali Loss: 0.197 Vali Acc: 0.955 Test Loss: 0.197 Test Acc: 0.955
Validation loss decreased (-0.920610 --> -0.955430).  Saving model ...
Epoch: 7 cost time: 9.757422924041748
Epoch: 7, Steps: 89 | Train Loss: 0.195 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.807485580444336
Epoch: 8, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.137 Vali Acc: 0.964 Test Loss: 0.137 Test Acc: 0.964
Validation loss decreased (-0.955430 --> -0.963787).  Saving model ...
Epoch: 9 cost time: 10.049288511276245
Epoch: 9, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.149 Vali Acc: 0.964 Test Loss: 0.149 Test Acc: 0.964
Validation loss decreased (-0.963787 --> -0.964483).  Saving model ...
Epoch: 10 cost time: 9.492330312728882
Epoch: 10, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.118 Vali Acc: 0.964 Test Loss: 0.118 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 10.586176872253418
Epoch: 11, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
Validation loss decreased (-0.964483 --> -0.970751).  Saving model ...
Epoch: 12 cost time: 11.047293424606323
Epoch: 12, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 11.686193704605103
Epoch: 13, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.086 Vali Acc: 0.974 Test Loss: 0.086 Test Acc: 0.974
Validation loss decreased (-0.970751 --> -0.973537).  Saving model ...
Epoch: 14 cost time: 11.1217200756073
Epoch: 14, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
Validation loss decreased (-0.973537 --> -0.979108).  Saving model ...
Epoch: 15 cost time: 10.421905755996704
Epoch: 15, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 9.991797685623169
Epoch: 16, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 10.378111839294434
Epoch: 17, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 10.921656847000122
Epoch: 18, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 10.096618175506592
Epoch: 19, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 10.650817632675171
Epoch: 20, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.082 Vali Acc: 0.975 Test Loss: 0.082 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 10.288105010986328
Epoch: 21, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 10.613481521606445
Epoch: 22, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.087 Vali Acc: 0.971 Test Loss: 0.087 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 11.35071349143982
Epoch: 23, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.059 Vali Acc: 0.982 Test Loss: 0.059 Test Acc: 0.982
Validation loss decreased (-0.979108 --> -0.981894).  Saving model ...
Epoch: 24 cost time: 11.33833360671997
Epoch: 24, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.089 Vali Acc: 0.974 Test Loss: 0.089 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 10.912152290344238
Epoch: 25, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.094 Vali Acc: 0.969 Test Loss: 0.094 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 11.65436315536499
Epoch: 26, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.069 Vali Acc: 0.978 Test Loss: 0.069 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 11.391980409622192
Epoch: 27, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 11.750699758529663
Epoch: 28, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.050 Vali Acc: 0.981 Test Loss: 0.050 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 12.297341346740723
Epoch: 29, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.084 Vali Acc: 0.974 Test Loss: 0.084 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 11.27864408493042
Epoch: 30, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.115 Vali Acc: 0.964 Test Loss: 0.115 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 11.12308406829834
Epoch: 31, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.144 Vali Acc: 0.956 Test Loss: 0.144 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 10.497226238250732
Epoch: 32, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.073 Vali Acc: 0.979 Test Loss: 0.073 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 10.44875955581665
Epoch: 33, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.113 Vali Acc: 0.963 Test Loss: 0.113 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 764656
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 12.436191082000732
Epoch: 1, Steps: 89 | Train Loss: 2.709 Vali Loss: 1.981 Vali Acc: 0.538 Test Loss: 1.981 Test Acc: 0.538
Validation loss decreased (inf --> -0.537585).  Saving model ...
Epoch: 2 cost time: 10.6727454662323
Epoch: 2, Steps: 89 | Train Loss: 1.514 Vali Loss: 1.046 Vali Acc: 0.744 Test Loss: 1.046 Test Acc: 0.744
Validation loss decreased (-0.537585 --> -0.744419).  Saving model ...
Epoch: 3 cost time: 11.373538494110107
Epoch: 3, Steps: 89 | Train Loss: 0.836 Vali Loss: 0.621 Vali Acc: 0.861 Test Loss: 0.621 Test Acc: 0.861
Validation loss decreased (-0.744419 --> -0.861414).  Saving model ...
Epoch: 4 cost time: 10.139394760131836
Epoch: 4, Steps: 89 | Train Loss: 0.535 Vali Loss: 0.391 Vali Acc: 0.909 Test Loss: 0.391 Test Acc: 0.909
Validation loss decreased (-0.861414 --> -0.908770).  Saving model ...
Epoch: 5 cost time: 11.066710233688354
Epoch: 5, Steps: 89 | Train Loss: 0.355 Vali Loss: 0.272 Vali Acc: 0.935 Test Loss: 0.272 Test Acc: 0.935
Validation loss decreased (-0.908770 --> -0.934538).  Saving model ...
Epoch: 6 cost time: 10.627442121505737
Epoch: 6, Steps: 89 | Train Loss: 0.257 Vali Loss: 0.244 Vali Acc: 0.937 Test Loss: 0.244 Test Acc: 0.937
Validation loss decreased (-0.934538 --> -0.936627).  Saving model ...
Epoch: 7 cost time: 11.266037225723267
Epoch: 7, Steps: 89 | Train Loss: 0.217 Vali Loss: 0.178 Vali Acc: 0.953 Test Loss: 0.178 Test Acc: 0.953
Validation loss decreased (-0.936627 --> -0.952644).  Saving model ...
Epoch: 8 cost time: 11.079467296600342
Epoch: 8, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
Validation loss decreased (-0.952644 --> -0.956823).  Saving model ...
Epoch: 9 cost time: 11.057003259658813
Epoch: 9, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.135 Vali Acc: 0.963 Test Loss: 0.135 Test Acc: 0.963
Validation loss decreased (-0.956823 --> -0.963091).  Saving model ...
Epoch: 10 cost time: 10.71504282951355
Epoch: 10, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.113 Vali Acc: 0.967 Test Loss: 0.113 Test Acc: 0.967
Validation loss decreased (-0.963091 --> -0.966573).  Saving model ...
Epoch: 11 cost time: 11.08709979057312
Epoch: 11, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
Validation loss decreased (-0.966573 --> -0.967269).  Saving model ...
Epoch: 12 cost time: 10.857784986495972
Epoch: 12, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 11.78917145729065
Epoch: 13, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.096 Vali Acc: 0.972 Test Loss: 0.096 Test Acc: 0.972
Validation loss decreased (-0.967269 --> -0.972144).  Saving model ...
Epoch: 14 cost time: 11.438140630722046
Epoch: 14, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.122 Vali Acc: 0.960 Test Loss: 0.122 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 11.31649661064148
Epoch: 15, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.096 Vali Acc: 0.972 Test Loss: 0.096 Test Acc: 0.972
Validation loss decreased (-0.972144 --> -0.972144).  Saving model ...
Epoch: 16 cost time: 11.087262630462646
Epoch: 16, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.141 Vali Acc: 0.959 Test Loss: 0.141 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 11.625866889953613
Epoch: 17, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 11.347034931182861
Epoch: 18, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.088 Vali Acc: 0.974 Test Loss: 0.088 Test Acc: 0.974
Validation loss decreased (-0.972144 --> -0.973537).  Saving model ...
Epoch: 19 cost time: 11.08878469467163
Epoch: 19, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.087 Vali Acc: 0.972 Test Loss: 0.087 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 11.857486009597778
Epoch: 20, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.169 Vali Acc: 0.950 Test Loss: 0.169 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 11.704469203948975
Epoch: 21, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 11.855762004852295
Epoch: 22, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 11.601155519485474
Epoch: 23, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 10.999289274215698
Epoch: 24, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 11.785014152526855
Epoch: 25, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 11.918567180633545
Epoch: 26, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 9.974602937698364
Epoch: 27, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 10.764368057250977
Epoch: 28, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.973537 --> -0.979804).  Saving model ...
Epoch: 29 cost time: 10.37089729309082
Epoch: 29, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 10.564549446105957
Epoch: 30, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 10.77444338798523
Epoch: 31, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 10.316978454589844
Epoch: 32, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 11.472137928009033
Epoch: 33, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.060 Vali Acc: 0.981 Test Loss: 0.060 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980501).  Saving model ...
Epoch: 34 cost time: 10.31143307685852
Epoch: 34, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.154 Vali Acc: 0.963 Test Loss: 0.154 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 10.808054685592651
Epoch: 35, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 11.140816926956177
Epoch: 36, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.108 Vali Acc: 0.972 Test Loss: 0.108 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 10.85482144355774
Epoch: 37, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 10.605665445327759
Epoch: 38, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.075 Vali Acc: 0.974 Test Loss: 0.075 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 10.242983341217041
Epoch: 39, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 10.994378328323364
Epoch: 40, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.104 Vali Acc: 0.969 Test Loss: 0.104 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 11.08334755897522
Epoch: 41, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 11.047422647476196
Epoch: 42, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 11.174701690673828
Epoch: 43, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.066 Vali Acc: 0.985 Test Loss: 0.066 Test Acc: 0.985
Validation loss decreased (-0.980501 --> -0.984679).  Saving model ...
Epoch: 44 cost time: 11.180795431137085
Epoch: 44, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.131 Vali Acc: 0.963 Test Loss: 0.131 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 11.387948989868164
Epoch: 45, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.164 Vali Acc: 0.954 Test Loss: 0.164 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 11.071078062057495
Epoch: 46, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 10.454652786254883
Epoch: 47, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.105 Vali Acc: 0.969 Test Loss: 0.105 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 11.862733125686646
Epoch: 48, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.103 Vali Acc: 0.969 Test Loss: 0.103 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 10.679298639297485
Epoch: 49, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 11.078982830047607
Epoch: 50, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.079 Vali Acc: 0.975 Test Loss: 0.079 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 10.767285823822021
Epoch: 51, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 11.163018703460693
Epoch: 52, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 11.984621524810791
Epoch: 53, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 763696
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 12.341523170471191
Epoch: 1, Steps: 89 | Train Loss: 2.875 Vali Loss: 2.345 Vali Acc: 0.398 Test Loss: 2.345 Test Acc: 0.398
Validation loss decreased (inf --> -0.397609).  Saving model ...
Epoch: 2 cost time: 10.933128595352173
Epoch: 2, Steps: 89 | Train Loss: 1.824 Vali Loss: 1.197 Vali Acc: 0.748 Test Loss: 1.197 Test Acc: 0.748
Validation loss decreased (-0.397609 --> -0.747899).  Saving model ...
Epoch: 3 cost time: 11.0612211227417
Epoch: 3, Steps: 89 | Train Loss: 0.983 Vali Loss: 0.685 Vali Acc: 0.847 Test Loss: 0.685 Test Acc: 0.847
Validation loss decreased (-0.747899 --> -0.847486).  Saving model ...
Epoch: 4 cost time: 10.3710196018219
Epoch: 4, Steps: 89 | Train Loss: 0.593 Vali Loss: 0.457 Vali Acc: 0.894 Test Loss: 0.457 Test Acc: 0.894
Validation loss decreased (-0.847486 --> -0.894146).  Saving model ...
Epoch: 5 cost time: 10.927234888076782
Epoch: 5, Steps: 89 | Train Loss: 0.403 Vali Loss: 0.300 Vali Acc: 0.935 Test Loss: 0.300 Test Acc: 0.935
Validation loss decreased (-0.894146 --> -0.935234).  Saving model ...
Epoch: 6 cost time: 10.36215853691101
Epoch: 6, Steps: 89 | Train Loss: 0.299 Vali Loss: 0.234 Vali Acc: 0.938 Test Loss: 0.234 Test Acc: 0.938
Validation loss decreased (-0.935234 --> -0.938020).  Saving model ...
Epoch: 7 cost time: 10.861238956451416
Epoch: 7, Steps: 89 | Train Loss: 0.227 Vali Loss: 0.216 Vali Acc: 0.942 Test Loss: 0.216 Test Acc: 0.942
Validation loss decreased (-0.938020 --> -0.942198).  Saving model ...
Epoch: 8 cost time: 9.990671634674072
Epoch: 8, Steps: 89 | Train Loss: 0.214 Vali Loss: 0.153 Vali Acc: 0.960 Test Loss: 0.153 Test Acc: 0.960
Validation loss decreased (-0.942198 --> -0.960305).  Saving model ...
Epoch: 9 cost time: 10.46059274673462
Epoch: 9, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.151 Vali Acc: 0.952 Test Loss: 0.151 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.928386926651001
Epoch: 10, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.129 Vali Acc: 0.964 Test Loss: 0.129 Test Acc: 0.964
Validation loss decreased (-0.960305 --> -0.964483).  Saving model ...
Epoch: 11 cost time: 10.119016170501709
Epoch: 11, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.131 Vali Acc: 0.960 Test Loss: 0.131 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 10.900511264801025
Epoch: 12, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 11.125734329223633
Epoch: 13, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.116 Vali Acc: 0.967 Test Loss: 0.116 Test Acc: 0.967
Validation loss decreased (-0.964483 --> -0.966573).  Saving model ...
Epoch: 14 cost time: 10.581517696380615
Epoch: 14, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.234 Vali Acc: 0.925 Test Loss: 0.234 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 10.631548166275024
Epoch: 15, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.111 Vali Acc: 0.964 Test Loss: 0.111 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 10.47014045715332
Epoch: 16, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
Validation loss decreased (-0.966573 --> -0.974233).  Saving model ...
Epoch: 17 cost time: 10.260017395019531
Epoch: 17, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
Validation loss decreased (-0.974233 --> -0.977715).  Saving model ...
Epoch: 18 cost time: 10.53454041481018
Epoch: 18, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 10.745331287384033
Epoch: 19, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.097 Vali Acc: 0.971 Test Loss: 0.097 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 11.148169994354248
Epoch: 20, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.089 Vali Acc: 0.971 Test Loss: 0.089 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 11.438368082046509
Epoch: 21, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.114 Vali Acc: 0.967 Test Loss: 0.114 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 11.65989375114441
Epoch: 22, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 11.794489860534668
Epoch: 23, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 11.135286808013916
Epoch: 24, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.128 Vali Acc: 0.958 Test Loss: 0.128 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 11.79212498664856
Epoch: 25, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.066 Vali Acc: 0.978 Test Loss: 0.066 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.978412).  Saving model ...
Epoch: 26 cost time: 10.688904047012329
Epoch: 26, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.149 Vali Acc: 0.958 Test Loss: 0.149 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 12.164318561553955
Epoch: 27, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.071 Vali Acc: 0.979 Test Loss: 0.071 Test Acc: 0.979
Validation loss decreased (-0.978412 --> -0.979108).  Saving model ...
Epoch: 28 cost time: 11.988112688064575
Epoch: 28, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.091 Vali Acc: 0.972 Test Loss: 0.091 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 10.83053207397461
Epoch: 29, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
Validation loss decreased (-0.979108 --> -0.980501).  Saving model ...
Epoch: 30 cost time: 10.906646966934204
Epoch: 30, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 9.945736408233643
Epoch: 31, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 10.03071141242981
Epoch: 32, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.144 Vali Acc: 0.958 Test Loss: 0.144 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 11.142691373825073
Epoch: 33, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.095 Vali Acc: 0.971 Test Loss: 0.095 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 10.289836406707764
Epoch: 34, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.126 Vali Acc: 0.963 Test Loss: 0.126 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 10.86040449142456
Epoch: 35, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.141 Vali Acc: 0.958 Test Loss: 0.141 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 10.344417333602905
Epoch: 36, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 11.309730768203735
Epoch: 37, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.084 Vali Acc: 0.975 Test Loss: 0.084 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 11.06962776184082
Epoch: 38, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.110 Vali Acc: 0.969 Test Loss: 0.110 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 10.776745080947876
Epoch: 39, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 467056
model size : 2.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.072433948516846
Epoch: 1, Steps: 89 | Train Loss: 2.811 Vali Loss: 2.227 Vali Acc: 0.474 Test Loss: 2.227 Test Acc: 0.474
Validation loss decreased (inf --> -0.473515).  Saving model ...
Epoch: 2 cost time: 11.48646855354309
Epoch: 2, Steps: 89 | Train Loss: 1.693 Vali Loss: 1.111 Vali Acc: 0.773 Test Loss: 1.111 Test Acc: 0.773
Validation loss decreased (-0.473515 --> -0.772969).  Saving model ...
Epoch: 3 cost time: 10.233577013015747
Epoch: 3, Steps: 89 | Train Loss: 0.915 Vali Loss: 0.695 Vali Acc: 0.856 Test Loss: 0.695 Test Acc: 0.856
Validation loss decreased (-0.772969 --> -0.855843).  Saving model ...
Epoch: 4 cost time: 10.589667081832886
Epoch: 4, Steps: 89 | Train Loss: 0.576 Vali Loss: 0.435 Vali Acc: 0.911 Test Loss: 0.435 Test Acc: 0.911
Validation loss decreased (-0.855843 --> -0.910859).  Saving model ...
Epoch: 5 cost time: 10.805307626724243
Epoch: 5, Steps: 89 | Train Loss: 0.401 Vali Loss: 0.330 Vali Acc: 0.928 Test Loss: 0.330 Test Acc: 0.928
Validation loss decreased (-0.910859 --> -0.927573).  Saving model ...
Epoch: 6 cost time: 10.59316372871399
Epoch: 6, Steps: 89 | Train Loss: 0.290 Vali Loss: 0.217 Vali Acc: 0.957 Test Loss: 0.217 Test Acc: 0.957
Validation loss decreased (-0.927573 --> -0.956822).  Saving model ...
Epoch: 7 cost time: 10.727129459381104
Epoch: 7, Steps: 89 | Train Loss: 0.226 Vali Loss: 0.206 Vali Acc: 0.942 Test Loss: 0.206 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.103867053985596
Epoch: 8, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.179 Vali Acc: 0.957 Test Loss: 0.179 Test Acc: 0.957
Validation loss decreased (-0.956822 --> -0.956823).  Saving model ...
Epoch: 9 cost time: 11.423993825912476
Epoch: 9, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.158 Vali Acc: 0.960 Test Loss: 0.158 Test Acc: 0.960
Validation loss decreased (-0.956823 --> -0.960305).  Saving model ...
Epoch: 10 cost time: 11.875102281570435
Epoch: 10, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.135 Vali Acc: 0.958 Test Loss: 0.135 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 11.664984464645386
Epoch: 11, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.183 Vali Acc: 0.951 Test Loss: 0.183 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 11.310826778411865
Epoch: 12, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
Validation loss decreased (-0.960305 --> -0.971447).  Saving model ...
Epoch: 13 cost time: 11.063465595245361
Epoch: 13, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.092 Vali Acc: 0.971 Test Loss: 0.092 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 10.463900327682495
Epoch: 14, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.189 Vali Acc: 0.938 Test Loss: 0.189 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 11.05515718460083
Epoch: 15, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.155 Vali Acc: 0.955 Test Loss: 0.155 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 11.588387489318848
Epoch: 16, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.106 Vali Acc: 0.972 Test Loss: 0.106 Test Acc: 0.972
Validation loss decreased (-0.971447 --> -0.972144).  Saving model ...
Epoch: 17 cost time: 10.98134469985962
Epoch: 17, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 10.540623903274536
Epoch: 18, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.072 Vali Acc: 0.979 Test Loss: 0.072 Test Acc: 0.979
Validation loss decreased (-0.972144 --> -0.979108).  Saving model ...
Epoch: 19 cost time: 11.08971905708313
Epoch: 19, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 10.520552158355713
Epoch: 20, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
Validation loss decreased (-0.979108 --> -0.980501).  Saving model ...
Epoch: 21 cost time: 11.517751932144165
Epoch: 21, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 11.271660089492798
Epoch: 22, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.091 Vali Acc: 0.974 Test Loss: 0.091 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 10.660844564437866
Epoch: 23, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.119 Vali Acc: 0.961 Test Loss: 0.119 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 12.435107946395874
Epoch: 24, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 10.837401628494263
Epoch: 25, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 11.459643363952637
Epoch: 26, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 12.12981367111206
Epoch: 27, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.084 Vali Acc: 0.974 Test Loss: 0.084 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 10.429623365402222
Epoch: 28, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.086 Vali Acc: 0.975 Test Loss: 0.086 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 11.24425721168518
Epoch: 29, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.093 Vali Acc: 0.969 Test Loss: 0.093 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 10.328513145446777
Epoch: 30, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 466096
model size : 2.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.000655174255371
Epoch: 1, Steps: 89 | Train Loss: 2.874 Vali Loss: 2.207 Vali Acc: 0.474 Test Loss: 2.207 Test Acc: 0.474
Validation loss decreased (inf --> -0.473516).  Saving model ...
Epoch: 2 cost time: 9.831681251525879
Epoch: 2, Steps: 89 | Train Loss: 1.631 Vali Loss: 1.026 Vali Acc: 0.806 Test Loss: 1.026 Test Acc: 0.806
Validation loss decreased (-0.473516 --> -0.805700).  Saving model ...
Epoch: 3 cost time: 11.512825965881348
Epoch: 3, Steps: 89 | Train Loss: 0.904 Vali Loss: 0.623 Vali Acc: 0.863 Test Loss: 0.623 Test Acc: 0.863
Validation loss decreased (-0.805700 --> -0.862807).  Saving model ...
Epoch: 4 cost time: 11.538957595825195
Epoch: 4, Steps: 89 | Train Loss: 0.562 Vali Loss: 0.419 Vali Acc: 0.912 Test Loss: 0.419 Test Acc: 0.912
Validation loss decreased (-0.862807 --> -0.912252).  Saving model ...
Epoch: 5 cost time: 11.940899848937988
Epoch: 5, Steps: 89 | Train Loss: 0.387 Vali Loss: 0.315 Vali Acc: 0.916 Test Loss: 0.315 Test Acc: 0.916
Validation loss decreased (-0.912252 --> -0.915735).  Saving model ...
Epoch: 6 cost time: 12.508174896240234
Epoch: 6, Steps: 89 | Train Loss: 0.285 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.915735 --> -0.943591).  Saving model ...
Epoch: 7 cost time: 11.169673919677734
Epoch: 7, Steps: 89 | Train Loss: 0.242 Vali Loss: 0.204 Vali Acc: 0.948 Test Loss: 0.204 Test Acc: 0.948
Validation loss decreased (-0.943591 --> -0.947770).  Saving model ...
Epoch: 8 cost time: 11.430291652679443
Epoch: 8, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.837299346923828
Epoch: 9, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.203 Vali Acc: 0.943 Test Loss: 0.203 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 11.052088975906372
Epoch: 10, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.138 Vali Acc: 0.958 Test Loss: 0.138 Test Acc: 0.958
Validation loss decreased (-0.947770 --> -0.958216).  Saving model ...
Epoch: 11 cost time: 11.807883977890015
Epoch: 11, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
Validation loss decreased (-0.958216 --> -0.968662).  Saving model ...
Epoch: 12 cost time: 10.99292802810669
Epoch: 12, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.147 Vali Acc: 0.958 Test Loss: 0.147 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 11.30936884880066
Epoch: 13, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.125 Vali Acc: 0.969 Test Loss: 0.125 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 11.267197608947754
Epoch: 14, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.114 Vali Acc: 0.967 Test Loss: 0.114 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 11.847863912582397
Epoch: 15, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
Validation loss decreased (-0.968662 --> -0.970751).  Saving model ...
Epoch: 16 cost time: 10.045607089996338
Epoch: 16, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 10.726258277893066
Epoch: 17, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.105 Vali Acc: 0.966 Test Loss: 0.105 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 11.0243558883667
Epoch: 18, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.118 Vali Acc: 0.964 Test Loss: 0.118 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 10.994453430175781
Epoch: 19, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.087 Vali Acc: 0.974 Test Loss: 0.087 Test Acc: 0.974
Validation loss decreased (-0.970751 --> -0.974233).  Saving model ...
Epoch: 20 cost time: 11.241341590881348
Epoch: 20, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.161 Vali Acc: 0.950 Test Loss: 0.161 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 11.477769136428833
Epoch: 21, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.975626).  Saving model ...
Epoch: 22 cost time: 13.068165063858032
Epoch: 22, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 14.1410493850708
Epoch: 23, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 13.043777465820312
Epoch: 24, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.148 Vali Acc: 0.956 Test Loss: 0.148 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 13.525390863418579
Epoch: 25, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 14.115757703781128
Epoch: 26, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.127 Vali Acc: 0.963 Test Loss: 0.127 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 13.291955947875977
Epoch: 27, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 13.01528286933899
Epoch: 28, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.105 Vali Acc: 0.969 Test Loss: 0.105 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 11.670474290847778
Epoch: 29, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 11.050693988800049
Epoch: 30, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.103 Vali Acc: 0.967 Test Loss: 0.103 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 12.852463006973267
Epoch: 31, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 465136
model size : 2.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 12.04025149345398
Epoch: 1, Steps: 89 | Train Loss: 2.963 Vali Loss: 2.469 Vali Acc: 0.439 Test Loss: 2.469 Test Acc: 0.439
Validation loss decreased (inf --> -0.439390).  Saving model ...
Epoch: 2 cost time: 10.040080547332764
Epoch: 2, Steps: 89 | Train Loss: 1.882 Vali Loss: 1.214 Vali Acc: 0.732 Test Loss: 1.214 Test Acc: 0.732
Validation loss decreased (-0.439390 --> -0.731882).  Saving model ...
Epoch: 3 cost time: 10.252651453018188
Epoch: 3, Steps: 89 | Train Loss: 0.992 Vali Loss: 0.698 Vali Acc: 0.851 Test Loss: 0.698 Test Acc: 0.851
Validation loss decreased (-0.731882 --> -0.850968).  Saving model ...
Epoch: 4 cost time: 10.388100147247314
Epoch: 4, Steps: 89 | Train Loss: 0.604 Vali Loss: 0.462 Vali Acc: 0.899 Test Loss: 0.462 Test Acc: 0.899
Validation loss decreased (-0.850968 --> -0.899020).  Saving model ...
Epoch: 5 cost time: 10.597743511199951
Epoch: 5, Steps: 89 | Train Loss: 0.415 Vali Loss: 0.299 Vali Acc: 0.938 Test Loss: 0.299 Test Acc: 0.938
Validation loss decreased (-0.899020 --> -0.938019).  Saving model ...
Epoch: 6 cost time: 10.864691257476807
Epoch: 6, Steps: 89 | Train Loss: 0.307 Vali Loss: 0.260 Vali Acc: 0.934 Test Loss: 0.260 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.746017932891846
Epoch: 7, Steps: 89 | Train Loss: 0.222 Vali Loss: 0.177 Vali Acc: 0.955 Test Loss: 0.177 Test Acc: 0.955
Validation loss decreased (-0.938019 --> -0.955430).  Saving model ...
Epoch: 8 cost time: 10.249475717544556
Epoch: 8, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
Validation loss decreased (-0.955430 --> -0.957519).  Saving model ...
Epoch: 9 cost time: 10.704189777374268
Epoch: 9, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.139 Vali Acc: 0.964 Test Loss: 0.139 Test Acc: 0.964
Validation loss decreased (-0.957519 --> -0.963787).  Saving model ...
Epoch: 10 cost time: 9.68387746810913
Epoch: 10, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.246 Vali Acc: 0.937 Test Loss: 0.246 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 10.298399686813354
Epoch: 11, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 10.965380907058716
Epoch: 12, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.122 Vali Acc: 0.964 Test Loss: 0.122 Test Acc: 0.964
Validation loss decreased (-0.963787 --> -0.963787).  Saving model ...
Epoch: 13 cost time: 11.170235395431519
Epoch: 13, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
Validation loss decreased (-0.963787 --> -0.969358).  Saving model ...
Epoch: 14 cost time: 10.66329550743103
Epoch: 14, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.075 Vali Acc: 0.979 Test Loss: 0.075 Test Acc: 0.979
Validation loss decreased (-0.969358 --> -0.979108).  Saving model ...
Epoch: 15 cost time: 10.373411893844604
Epoch: 15, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.158 Vali Acc: 0.955 Test Loss: 0.158 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 11.6105477809906
Epoch: 16, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.127 Vali Acc: 0.964 Test Loss: 0.127 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 11.556933164596558
Epoch: 17, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 10.371720314025879
Epoch: 18, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.084 Vali Acc: 0.974 Test Loss: 0.084 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 10.903364658355713
Epoch: 19, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.077 Vali Acc: 0.979 Test Loss: 0.077 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 9.982328176498413
Epoch: 20, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.073 Vali Acc: 0.979 Test Loss: 0.073 Test Acc: 0.979
Validation loss decreased (-0.979108 --> -0.979108).  Saving model ...
Epoch: 21 cost time: 10.709195613861084
Epoch: 21, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.979108 --> -0.982590).  Saving model ...
Epoch: 22 cost time: 10.480907678604126
Epoch: 22, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 9.641806602478027
Epoch: 23, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.126 Vali Acc: 0.958 Test Loss: 0.126 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 11.468929290771484
Epoch: 24, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.089 Vali Acc: 0.974 Test Loss: 0.089 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 10.576897382736206
Epoch: 25, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 10.597583532333374
Epoch: 26, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.072 Vali Acc: 0.975 Test Loss: 0.072 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 10.41916012763977
Epoch: 27, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.056 Vali Acc: 0.983 Test Loss: 0.056 Test Acc: 0.983
Validation loss decreased (-0.982590 --> -0.983286).  Saving model ...
Epoch: 28 cost time: 10.082855939865112
Epoch: 28, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 10.376079082489014
Epoch: 29, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.059 Vali Acc: 0.982 Test Loss: 0.059 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 10.004569292068481
Epoch: 30, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.055 Vali Acc: 0.985 Test Loss: 0.055 Test Acc: 0.985
Validation loss decreased (-0.983286 --> -0.985375).  Saving model ...
Epoch: 31 cost time: 9.985826253890991
Epoch: 31, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.056 Vali Acc: 0.980 Test Loss: 0.056 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 10.474294424057007
Epoch: 32, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.060 Vali Acc: 0.984 Test Loss: 0.060 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 10.789122104644775
Epoch: 33, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 10.270071983337402
Epoch: 34, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.097 Vali Acc: 0.969 Test Loss: 0.097 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 10.45859432220459
Epoch: 35, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.105 Vali Acc: 0.969 Test Loss: 0.105 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 11.084764003753662
Epoch: 36, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.068 Vali Acc: 0.985 Test Loss: 0.068 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 11.311270475387573
Epoch: 37, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.131 Vali Acc: 0.966 Test Loss: 0.131 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 11.172211408615112
Epoch: 38, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.091 Vali Acc: 0.974 Test Loss: 0.091 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 10.925611972808838
Epoch: 39, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.132 Vali Acc: 0.969 Test Loss: 0.132 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 11.05523681640625
Epoch: 40, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 464176
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 12.477912187576294
Epoch: 1, Steps: 89 | Train Loss: 2.852 Vali Loss: 2.320 Vali Acc: 0.506 Test Loss: 2.320 Test Acc: 0.506
Validation loss decreased (inf --> -0.506244).  Saving model ...
Epoch: 2 cost time: 10.478389024734497
Epoch: 2, Steps: 89 | Train Loss: 1.793 Vali Loss: 1.203 Vali Acc: 0.799 Test Loss: 1.203 Test Acc: 0.799
Validation loss decreased (-0.506244 --> -0.798734).  Saving model ...
Epoch: 3 cost time: 9.926190614700317
Epoch: 3, Steps: 89 | Train Loss: 0.986 Vali Loss: 0.705 Vali Acc: 0.870 Test Loss: 0.705 Test Acc: 0.870
Validation loss decreased (-0.798734 --> -0.870466).  Saving model ...
Epoch: 4 cost time: 10.49774694442749
Epoch: 4, Steps: 89 | Train Loss: 0.629 Vali Loss: 0.475 Vali Acc: 0.896 Test Loss: 0.475 Test Acc: 0.896
Validation loss decreased (-0.870466 --> -0.895538).  Saving model ...
Epoch: 5 cost time: 11.121221542358398
Epoch: 5, Steps: 89 | Train Loss: 0.448 Vali Loss: 0.356 Vali Acc: 0.907 Test Loss: 0.356 Test Acc: 0.907
Validation loss decreased (-0.895538 --> -0.907378).  Saving model ...
Epoch: 6 cost time: 10.260902166366577
Epoch: 6, Steps: 89 | Train Loss: 0.315 Vali Loss: 0.253 Vali Acc: 0.937 Test Loss: 0.253 Test Acc: 0.937
Validation loss decreased (-0.907378 --> -0.936627).  Saving model ...
Epoch: 7 cost time: 10.245884418487549
Epoch: 7, Steps: 89 | Train Loss: 0.245 Vali Loss: 0.198 Vali Acc: 0.947 Test Loss: 0.198 Test Acc: 0.947
Validation loss decreased (-0.936627 --> -0.947073).  Saving model ...
Epoch: 8 cost time: 10.654190301895142
Epoch: 8, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.981501340866089
Epoch: 9, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.152 Vali Acc: 0.963 Test Loss: 0.152 Test Acc: 0.963
Validation loss decreased (-0.947073 --> -0.963090).  Saving model ...
Epoch: 10 cost time: 10.45313310623169
Epoch: 10, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.122 Vali Acc: 0.964 Test Loss: 0.122 Test Acc: 0.964
Validation loss decreased (-0.963090 --> -0.963787).  Saving model ...
Epoch: 11 cost time: 10.587769985198975
Epoch: 11, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.125 Vali Acc: 0.961 Test Loss: 0.125 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 10.381002426147461
Epoch: 12, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.121 Vali Acc: 0.961 Test Loss: 0.121 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.434391260147095
Epoch: 13, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
Validation loss decreased (-0.963787 --> -0.975626).  Saving model ...
Epoch: 14 cost time: 10.847726821899414
Epoch: 14, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 11.381500244140625
Epoch: 15, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 10.692468166351318
Epoch: 16, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.139 Vali Acc: 0.964 Test Loss: 0.139 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 10.115329504013062
Epoch: 17, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.101 Vali Acc: 0.969 Test Loss: 0.101 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 10.103130340576172
Epoch: 18, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 9.560553073883057
Epoch: 19, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.106 Vali Acc: 0.969 Test Loss: 0.106 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 9.92775821685791
Epoch: 20, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
Validation loss decreased (-0.975626 --> -0.977715).  Saving model ...
Epoch: 21 cost time: 9.96651816368103
Epoch: 21, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.133 Vali Acc: 0.961 Test Loss: 0.133 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 10.471347093582153
Epoch: 22, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.076 Vali Acc: 0.975 Test Loss: 0.076 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 10.594071626663208
Epoch: 23, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.076 Vali Acc: 0.971 Test Loss: 0.076 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 10.477974891662598
Epoch: 24, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.977715 --> -0.979804).  Saving model ...
Epoch: 25 cost time: 10.098506927490234
Epoch: 25, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.087 Vali Acc: 0.974 Test Loss: 0.087 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 10.462508916854858
Epoch: 26, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 9.598971366882324
Epoch: 27, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 9.909760236740112
Epoch: 28, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 9.78721284866333
Epoch: 29, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 9.91599416732788
Epoch: 30, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.981197).  Saving model ...
Epoch: 31 cost time: 10.704928636550903
Epoch: 31, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 9.733796119689941
Epoch: 32, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 10.411803007125854
Epoch: 33, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 10.588440418243408
Epoch: 34, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.089 Vali Acc: 0.974 Test Loss: 0.089 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 10.292712450027466
Epoch: 35, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.091 Vali Acc: 0.971 Test Loss: 0.091 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 10.763290882110596
Epoch: 36, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.090 Vali Acc: 0.974 Test Loss: 0.090 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 10.9839186668396
Epoch: 37, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 11.130680084228516
Epoch: 38, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.134 Vali Acc: 0.961 Test Loss: 0.134 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 10.205684423446655
Epoch: 39, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 11.018251895904541
Epoch: 40, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 317296
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.300538063049316
Epoch: 1, Steps: 89 | Train Loss: 2.871 Vali Loss: 2.384 Vali Acc: 0.416 Test Loss: 2.384 Test Acc: 0.416
Validation loss decreased (inf --> -0.415714).  Saving model ...
Epoch: 2 cost time: 11.2128005027771
Epoch: 2, Steps: 89 | Train Loss: 1.957 Vali Loss: 1.327 Vali Acc: 0.744 Test Loss: 1.327 Test Acc: 0.744
Validation loss decreased (-0.415714 --> -0.744416).  Saving model ...
Epoch: 3 cost time: 12.28235650062561
Epoch: 3, Steps: 89 | Train Loss: 1.061 Vali Loss: 0.718 Vali Acc: 0.855 Test Loss: 0.718 Test Acc: 0.855
Validation loss decreased (-0.744416 --> -0.855146).  Saving model ...
Epoch: 4 cost time: 12.134197473526001
Epoch: 4, Steps: 89 | Train Loss: 0.621 Vali Loss: 0.459 Vali Acc: 0.898 Test Loss: 0.459 Test Acc: 0.898
Validation loss decreased (-0.855146 --> -0.898324).  Saving model ...
Epoch: 5 cost time: 13.301722288131714
Epoch: 5, Steps: 89 | Train Loss: 0.417 Vali Loss: 0.327 Vali Acc: 0.930 Test Loss: 0.327 Test Acc: 0.930
Validation loss decreased (-0.898324 --> -0.929662).  Saving model ...
Epoch: 6 cost time: 11.575005769729614
Epoch: 6, Steps: 89 | Train Loss: 0.301 Vali Loss: 0.254 Vali Acc: 0.939 Test Loss: 0.254 Test Acc: 0.939
Validation loss decreased (-0.929662 --> -0.938716).  Saving model ...
Epoch: 7 cost time: 10.95940089225769
Epoch: 7, Steps: 89 | Train Loss: 0.236 Vali Loss: 0.202 Vali Acc: 0.946 Test Loss: 0.202 Test Acc: 0.946
Validation loss decreased (-0.938716 --> -0.946377).  Saving model ...
Epoch: 8 cost time: 12.638652563095093
Epoch: 8, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.168 Vali Acc: 0.961 Test Loss: 0.168 Test Acc: 0.961
Validation loss decreased (-0.946377 --> -0.961001).  Saving model ...
Epoch: 9 cost time: 11.801692247390747
Epoch: 9, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.147 Vali Acc: 0.962 Test Loss: 0.147 Test Acc: 0.962
Validation loss decreased (-0.961001 --> -0.961698).  Saving model ...
Epoch: 10 cost time: 12.409899711608887
Epoch: 10, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
Validation loss decreased (-0.961698 --> -0.967965).  Saving model ...
Epoch: 11 cost time: 12.385106801986694
Epoch: 11, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.967965 --> -0.970055).  Saving model ...
Epoch: 12 cost time: 11.710729122161865
Epoch: 12, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 11.78473424911499
Epoch: 13, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.101 Vali Acc: 0.969 Test Loss: 0.101 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 11.147208213806152
Epoch: 14, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 12.487895250320435
Epoch: 15, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (-0.970055 --> -0.976322).  Saving model ...
Epoch: 16 cost time: 11.449582815170288
Epoch: 16, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.977715).  Saving model ...
Epoch: 17 cost time: 12.101415157318115
Epoch: 17, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.089 Vali Acc: 0.971 Test Loss: 0.089 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 12.754236936569214
Epoch: 18, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.977715 --> -0.979804).  Saving model ...
Epoch: 19 cost time: 10.545932054519653
Epoch: 19, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.103 Vali Acc: 0.967 Test Loss: 0.103 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 11.035533905029297
Epoch: 20, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 11.970394611358643
Epoch: 21, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.082 Vali Acc: 0.971 Test Loss: 0.082 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 13.132242679595947
Epoch: 22, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 12.26642370223999
Epoch: 23, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 12.07933783531189
Epoch: 24, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 12.392647981643677
Epoch: 25, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 10.878744840621948
Epoch: 26, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.127 Vali Acc: 0.964 Test Loss: 0.127 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 11.436388731002808
Epoch: 27, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 11.883605480194092
Epoch: 28, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.981197).  Saving model ...
Epoch: 29 cost time: 9.824455499649048
Epoch: 29, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.144 Vali Acc: 0.958 Test Loss: 0.144 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 10.295815467834473
Epoch: 30, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 10.948443174362183
Epoch: 31, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.119 Vali Acc: 0.964 Test Loss: 0.119 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 12.47887110710144
Epoch: 32, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.125 Vali Acc: 0.971 Test Loss: 0.125 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 11.690916776657104
Epoch: 33, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 12.92469596862793
Epoch: 34, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.064 Vali Acc: 0.985 Test Loss: 0.064 Test Acc: 0.985
Validation loss decreased (-0.981197 --> -0.984679).  Saving model ...
Epoch: 35 cost time: 10.810128688812256
Epoch: 35, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 10.812687635421753
Epoch: 36, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 10.844936847686768
Epoch: 37, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 11.194025754928589
Epoch: 38, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.082 Vali Acc: 0.979 Test Loss: 0.082 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 11.763211727142334
Epoch: 39, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 11.905275344848633
Epoch: 40, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 11.434982776641846
Epoch: 41, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.088 Vali Acc: 0.975 Test Loss: 0.088 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 12.410983562469482
Epoch: 42, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.119 Vali Acc: 0.961 Test Loss: 0.119 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 11.289372205734253
Epoch: 43, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 11.421797513961792
Epoch: 44, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 316336
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.279115200042725
Epoch: 1, Steps: 89 | Train Loss: 2.933 Vali Loss: 2.482 Vali Acc: 0.341 Test Loss: 2.482 Test Acc: 0.341
Validation loss decreased (inf --> -0.341201).  Saving model ...
Epoch: 2 cost time: 10.827754735946655
Epoch: 2, Steps: 89 | Train Loss: 1.955 Vali Loss: 1.296 Vali Acc: 0.701 Test Loss: 1.296 Test Acc: 0.701
Validation loss decreased (-0.341201 --> -0.701241).  Saving model ...
Epoch: 3 cost time: 10.156596422195435
Epoch: 3, Steps: 89 | Train Loss: 1.106 Vali Loss: 0.774 Vali Acc: 0.840 Test Loss: 0.774 Test Acc: 0.840
Validation loss decreased (-0.701241 --> -0.839825).  Saving model ...
Epoch: 4 cost time: 10.348097324371338
Epoch: 4, Steps: 89 | Train Loss: 0.680 Vali Loss: 0.492 Vali Acc: 0.903 Test Loss: 0.492 Test Acc: 0.903
Validation loss decreased (-0.839825 --> -0.902502).  Saving model ...
Epoch: 5 cost time: 11.242095947265625
Epoch: 5, Steps: 89 | Train Loss: 0.446 Vali Loss: 0.357 Vali Acc: 0.919 Test Loss: 0.357 Test Acc: 0.919
Validation loss decreased (-0.902502 --> -0.918520).  Saving model ...
Epoch: 6 cost time: 10.808408260345459
Epoch: 6, Steps: 89 | Train Loss: 0.325 Vali Loss: 0.284 Vali Acc: 0.932 Test Loss: 0.284 Test Acc: 0.932
Validation loss decreased (-0.918520 --> -0.931752).  Saving model ...
Epoch: 7 cost time: 10.302897930145264
Epoch: 7, Steps: 89 | Train Loss: 0.242 Vali Loss: 0.204 Vali Acc: 0.951 Test Loss: 0.204 Test Acc: 0.951
Validation loss decreased (-0.931752 --> -0.950555).  Saving model ...
Epoch: 8 cost time: 10.243454933166504
Epoch: 8, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.185 Vali Acc: 0.953 Test Loss: 0.185 Test Acc: 0.953
Validation loss decreased (-0.950555 --> -0.952644).  Saving model ...
Epoch: 9 cost time: 9.868866682052612
Epoch: 9, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.124 Vali Acc: 0.971 Test Loss: 0.124 Test Acc: 0.971
Validation loss decreased (-0.952644 --> -0.970751).  Saving model ...
Epoch: 10 cost time: 10.889039039611816
Epoch: 10, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.132 Vali Acc: 0.969 Test Loss: 0.132 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 10.141907453536987
Epoch: 11, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 10.423185586929321
Epoch: 12, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.125 Vali Acc: 0.966 Test Loss: 0.125 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 10.575451612472534
Epoch: 13, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
Validation loss decreased (-0.970751 --> -0.974233).  Saving model ...
Epoch: 14 cost time: 10.769360542297363
Epoch: 14, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 11.232945680618286
Epoch: 15, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 9.937926530838013
Epoch: 16, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.079 Vali Acc: 0.979 Test Loss: 0.079 Test Acc: 0.979
Validation loss decreased (-0.974233 --> -0.979108).  Saving model ...
Epoch: 17 cost time: 10.235841274261475
Epoch: 17, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
Validation loss decreased (-0.979108 --> -0.980501).  Saving model ...
Epoch: 18 cost time: 10.774483442306519
Epoch: 18, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 11.329991102218628
Epoch: 19, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 11.388192415237427
Epoch: 20, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 10.874283790588379
Epoch: 21, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 11.14557147026062
Epoch: 22, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.072 Vali Acc: 0.984 Test Loss: 0.072 Test Acc: 0.984
Validation loss decreased (-0.980501 --> -0.983983).  Saving model ...
Epoch: 23 cost time: 10.959595441818237
Epoch: 23, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.060 Vali Acc: 0.986 Test Loss: 0.060 Test Acc: 0.986
Validation loss decreased (-0.983983 --> -0.986072).  Saving model ...
Epoch: 24 cost time: 11.084558486938477
Epoch: 24, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.061 Vali Acc: 0.978 Test Loss: 0.061 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 10.691668033599854
Epoch: 25, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 11.196354389190674
Epoch: 26, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.091 Vali Acc: 0.974 Test Loss: 0.091 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 10.5995774269104
Epoch: 27, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 10.121490478515625
Epoch: 28, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.069 Vali Acc: 0.979 Test Loss: 0.069 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 10.67352032661438
Epoch: 29, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 10.03868842124939
Epoch: 30, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 10.110458612442017
Epoch: 31, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 9.749929189682007
Epoch: 32, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 10.805663585662842
Epoch: 33, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 315376
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 14.55294680595398
Epoch: 1, Steps: 89 | Train Loss: 2.976 Vali Loss: 2.556 Vali Acc: 0.314 Test Loss: 2.556 Test Acc: 0.314
Validation loss decreased (inf --> -0.314041).  Saving model ...
Epoch: 2 cost time: 10.790940284729004
Epoch: 2, Steps: 89 | Train Loss: 1.937 Vali Loss: 1.258 Vali Acc: 0.753 Test Loss: 1.258 Test Acc: 0.753
Validation loss decreased (-0.314041 --> -0.753469).  Saving model ...
Epoch: 3 cost time: 10.777851343154907
Epoch: 3, Steps: 89 | Train Loss: 1.005 Vali Loss: 0.753 Vali Acc: 0.811 Test Loss: 0.753 Test Acc: 0.811
Validation loss decreased (-0.753469 --> -0.811274).  Saving model ...
Epoch: 4 cost time: 11.949630498886108
Epoch: 4, Steps: 89 | Train Loss: 0.622 Vali Loss: 0.468 Vali Acc: 0.889 Test Loss: 0.468 Test Acc: 0.889
Validation loss decreased (-0.811274 --> -0.889271).  Saving model ...
Epoch: 5 cost time: 10.722125768661499
Epoch: 5, Steps: 89 | Train Loss: 0.443 Vali Loss: 0.325 Vali Acc: 0.932 Test Loss: 0.325 Test Acc: 0.932
Validation loss decreased (-0.889271 --> -0.931752).  Saving model ...
Epoch: 6 cost time: 10.72461724281311
Epoch: 6, Steps: 89 | Train Loss: 0.342 Vali Loss: 0.262 Vali Acc: 0.942 Test Loss: 0.262 Test Acc: 0.942
Validation loss decreased (-0.931752 --> -0.942198).  Saving model ...
Epoch: 7 cost time: 10.915337800979614
Epoch: 7, Steps: 89 | Train Loss: 0.252 Vali Loss: 0.208 Vali Acc: 0.946 Test Loss: 0.208 Test Acc: 0.946
Validation loss decreased (-0.942198 --> -0.946377).  Saving model ...
Epoch: 8 cost time: 14.34312105178833
Epoch: 8, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.181 Vali Acc: 0.954 Test Loss: 0.181 Test Acc: 0.954
Validation loss decreased (-0.946377 --> -0.954037).  Saving model ...
Epoch: 9 cost time: 11.624613285064697
Epoch: 9, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
Validation loss decreased (-0.954037 --> -0.958216).  Saving model ...
Epoch: 10 cost time: 11.228008508682251
Epoch: 10, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
Validation loss decreased (-0.958216 --> -0.966573).  Saving model ...
Epoch: 11 cost time: 11.751055479049683
Epoch: 11, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.141 Vali Acc: 0.961 Test Loss: 0.141 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 11.704527854919434
Epoch: 12, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
Validation loss decreased (-0.966573 --> -0.974233).  Saving model ...
Epoch: 13 cost time: 10.90688180923462
Epoch: 13, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.128 Vali Acc: 0.958 Test Loss: 0.128 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 10.445172309875488
Epoch: 14, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.133 Vali Acc: 0.960 Test Loss: 0.133 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 11.77881407737732
Epoch: 15, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
Validation loss decreased (-0.974233 --> -0.977715).  Saving model ...
Epoch: 16 cost time: 10.711336851119995
Epoch: 16, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 11.316739320755005
Epoch: 17, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 13.067978620529175
Epoch: 18, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.115 Vali Acc: 0.960 Test Loss: 0.115 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 11.35467791557312
Epoch: 19, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.084 Vali Acc: 0.975 Test Loss: 0.084 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 10.985369682312012
Epoch: 20, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.977715).  Saving model ...
Epoch: 21 cost time: 11.768903493881226
Epoch: 21, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.080 Vali Acc: 0.975 Test Loss: 0.080 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 12.238565921783447
Epoch: 22, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.078 Vali Acc: 0.975 Test Loss: 0.078 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 10.915106058120728
Epoch: 23, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 10.499983549118042
Epoch: 24, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 11.031845808029175
Epoch: 25, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.096 Vali Acc: 0.972 Test Loss: 0.096 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 12.419438362121582
Epoch: 26, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.077 Vali Acc: 0.975 Test Loss: 0.077 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 12.886315107345581
Epoch: 27, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 13.025373697280884
Epoch: 28, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 12.641716957092285
Epoch: 29, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.135 Vali Acc: 0.964 Test Loss: 0.135 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 11.875031232833862
Epoch: 30, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.978411).  Saving model ...
Epoch: 31 cost time: 11.469510078430176
Epoch: 31, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.978411 --> -0.979804).  Saving model ...
Epoch: 32 cost time: 12.246335506439209
Epoch: 32, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.119 Vali Acc: 0.967 Test Loss: 0.119 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 11.829590559005737
Epoch: 33, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.073 Vali Acc: 0.979 Test Loss: 0.073 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 13.073854684829712
Epoch: 34, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.089 Vali Acc: 0.974 Test Loss: 0.089 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 12.102479934692383
Epoch: 35, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 11.829243659973145
Epoch: 36, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 10.326833963394165
Epoch: 37, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 12.232072114944458
Epoch: 38, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.094 Vali Acc: 0.974 Test Loss: 0.094 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 12.91065263748169
Epoch: 39, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 12.95590615272522
Epoch: 40, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.981197).  Saving model ...
Epoch: 41 cost time: 12.981978178024292
Epoch: 41, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.074 Vali Acc: 0.982 Test Loss: 0.074 Test Acc: 0.982
Validation loss decreased (-0.981197 --> -0.981893).  Saving model ...
Epoch: 42 cost time: 12.417624473571777
Epoch: 42, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 12.507686614990234
Epoch: 43, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 11.756598472595215
Epoch: 44, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.982590).  Saving model ...
Epoch: 45 cost time: 10.198326587677002
Epoch: 45, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 11.450764179229736
Epoch: 46, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.982590 --> -0.983286).  Saving model ...
Epoch: 47 cost time: 12.854592323303223
Epoch: 47, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 11.685497283935547
Epoch: 48, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.170 Vali Acc: 0.959 Test Loss: 0.170 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 12.512274742126465
Epoch: 49, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 12.935410737991333
Epoch: 50, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 10.123989820480347
Epoch: 51, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 11.874943971633911
Epoch: 52, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.060 Vali Acc: 0.989 Test Loss: 0.060 Test Acc: 0.989
Validation loss decreased (-0.983286 --> -0.988857).  Saving model ...
Epoch: 53 cost time: 11.417949438095093
Epoch: 53, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 11.546175241470337
Epoch: 54, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.130 Vali Acc: 0.969 Test Loss: 0.130 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 11.90710997581482
Epoch: 55, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 10.509696960449219
Epoch: 56, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 12.335146188735962
Epoch: 57, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 11.133156299591064
Epoch: 58, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 11.066195726394653
Epoch: 59, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 12.93958568572998
Epoch: 60, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 10.847110271453857
Epoch: 61, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.060 Vali Acc: 0.984 Test Loss: 0.060 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 13.278812170028687
Epoch: 62, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9888579387186629
model parameter : 314416
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 12.584049224853516
Epoch: 1, Steps: 89 | Train Loss: 2.888 Vali Loss: 2.461 Vali Acc: 0.329 Test Loss: 2.461 Test Acc: 0.329
Validation loss decreased (inf --> -0.328666).  Saving model ...
Epoch: 2 cost time: 10.978955268859863
Epoch: 2, Steps: 89 | Train Loss: 2.003 Vali Loss: 1.359 Vali Acc: 0.707 Test Loss: 1.359 Test Acc: 0.707
Validation loss decreased (-0.328666 --> -0.706811).  Saving model ...
Epoch: 3 cost time: 11.241310834884644
Epoch: 3, Steps: 89 | Train Loss: 1.102 Vali Loss: 0.767 Vali Acc: 0.834 Test Loss: 0.767 Test Acc: 0.834
Validation loss decreased (-0.706811 --> -0.834254).  Saving model ...
Epoch: 4 cost time: 12.22860336303711
Epoch: 4, Steps: 89 | Train Loss: 0.676 Vali Loss: 0.546 Vali Acc: 0.874 Test Loss: 0.546 Test Acc: 0.874
Validation loss decreased (-0.834254 --> -0.873950).  Saving model ...
Epoch: 5 cost time: 12.162567377090454
Epoch: 5, Steps: 89 | Train Loss: 0.478 Vali Loss: 0.353 Vali Acc: 0.933 Test Loss: 0.353 Test Acc: 0.933
Validation loss decreased (-0.873950 --> -0.933144).  Saving model ...
Epoch: 6 cost time: 12.993836164474487
Epoch: 6, Steps: 89 | Train Loss: 0.335 Vali Loss: 0.280 Vali Acc: 0.938 Test Loss: 0.280 Test Acc: 0.938
Validation loss decreased (-0.933144 --> -0.938019).  Saving model ...
Epoch: 7 cost time: 11.524646043777466
Epoch: 7, Steps: 89 | Train Loss: 0.261 Vali Loss: 0.243 Vali Acc: 0.934 Test Loss: 0.243 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.76905083656311
Epoch: 8, Steps: 89 | Train Loss: 0.208 Vali Loss: 0.181 Vali Acc: 0.947 Test Loss: 0.181 Test Acc: 0.947
Validation loss decreased (-0.938019 --> -0.947073).  Saving model ...
Epoch: 9 cost time: 10.738759756088257
Epoch: 9, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.170 Vali Acc: 0.960 Test Loss: 0.170 Test Acc: 0.960
Validation loss decreased (-0.947073 --> -0.959608).  Saving model ...
Epoch: 10 cost time: 10.895260095596313
Epoch: 10, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 13.023430824279785
Epoch: 11, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 11.555489778518677
Epoch: 12, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.112 Vali Acc: 0.969 Test Loss: 0.112 Test Acc: 0.969
Validation loss decreased (-0.959608 --> -0.969358).  Saving model ...
Epoch: 13 cost time: 12.054433584213257
Epoch: 13, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 13.128434419631958
Epoch: 14, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.104 Vali Acc: 0.967 Test Loss: 0.104 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 13.532130479812622
Epoch: 15, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
Validation loss decreased (-0.969358 --> -0.973537).  Saving model ...
Epoch: 16 cost time: 11.783388614654541
Epoch: 16, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 12.021976232528687
Epoch: 17, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.110 Vali Acc: 0.971 Test Loss: 0.110 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 12.689971446990967
Epoch: 18, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.093 Vali Acc: 0.971 Test Loss: 0.093 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 12.536405801773071
Epoch: 19, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.096 Vali Acc: 0.972 Test Loss: 0.096 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 13.053271293640137
Epoch: 20, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 12.040503978729248
Epoch: 21, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 12.780542850494385
Epoch: 22, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 12.273233413696289
Epoch: 23, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.178 Vali Acc: 0.951 Test Loss: 0.178 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 12.500343084335327
Epoch: 24, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 11.62841272354126
Epoch: 25, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9735376044568245
model parameter : 242416
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.901123762130737
Epoch: 1, Steps: 89 | Train Loss: 3.031 Vali Loss: 2.801 Vali Acc: 0.269 Test Loss: 2.801 Test Acc: 0.269
Validation loss decreased (inf --> -0.268774).  Saving model ...
Epoch: 2 cost time: 11.954021692276001
Epoch: 2, Steps: 89 | Train Loss: 2.270 Vali Loss: 1.586 Vali Acc: 0.625 Test Loss: 1.586 Test Acc: 0.625
Validation loss decreased (-0.268774 --> -0.624636).  Saving model ...
Epoch: 3 cost time: 10.801827669143677
Epoch: 3, Steps: 89 | Train Loss: 1.252 Vali Loss: 0.886 Vali Acc: 0.815 Test Loss: 0.886 Test Acc: 0.815
Validation loss decreased (-0.624636 --> -0.814754).  Saving model ...
Epoch: 4 cost time: 10.334593772888184
Epoch: 4, Steps: 89 | Train Loss: 0.752 Vali Loss: 0.555 Vali Acc: 0.891 Test Loss: 0.555 Test Acc: 0.891
Validation loss decreased (-0.814754 --> -0.890663).  Saving model ...
Epoch: 5 cost time: 10.546248435974121
Epoch: 5, Steps: 89 | Train Loss: 0.495 Vali Loss: 0.395 Vali Acc: 0.923 Test Loss: 0.395 Test Acc: 0.923
Validation loss decreased (-0.890663 --> -0.923394).  Saving model ...
Epoch: 6 cost time: 10.842700242996216
Epoch: 6, Steps: 89 | Train Loss: 0.354 Vali Loss: 0.287 Vali Acc: 0.931 Test Loss: 0.287 Test Acc: 0.931
Validation loss decreased (-0.923394 --> -0.931056).  Saving model ...
Epoch: 7 cost time: 11.49185824394226
Epoch: 7, Steps: 89 | Train Loss: 0.254 Vali Loss: 0.206 Vali Acc: 0.951 Test Loss: 0.206 Test Acc: 0.951
Validation loss decreased (-0.931056 --> -0.951251).  Saving model ...
Epoch: 8 cost time: 11.123191833496094
Epoch: 8, Steps: 89 | Train Loss: 0.212 Vali Loss: 0.172 Vali Acc: 0.959 Test Loss: 0.172 Test Acc: 0.959
Validation loss decreased (-0.951251 --> -0.958912).  Saving model ...
Epoch: 9 cost time: 11.51043152809143
Epoch: 9, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.160 Vali Acc: 0.955 Test Loss: 0.160 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.423974752426147
Epoch: 10, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
Validation loss decreased (-0.958912 --> -0.970054).  Saving model ...
Epoch: 11 cost time: 10.58425259590149
Epoch: 11, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
Validation loss decreased (-0.970054 --> -0.971447).  Saving model ...
Epoch: 12 cost time: 10.959358215332031
Epoch: 12, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.971447 --> -0.972840).  Saving model ...
Epoch: 13 cost time: 10.793591499328613
Epoch: 13, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.976322).  Saving model ...
Epoch: 14 cost time: 10.060284852981567
Epoch: 14, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 10.939847946166992
Epoch: 15, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 11.49069881439209
Epoch: 16, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.081 Vali Acc: 0.974 Test Loss: 0.081 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 11.968684673309326
Epoch: 17, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
Validation loss decreased (-0.976322 --> -0.976322).  Saving model ...
Epoch: 18 cost time: 10.5900559425354
Epoch: 18, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976322 --> -0.977019).  Saving model ...
Epoch: 19 cost time: 10.796528577804565
Epoch: 19, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.099 Vali Acc: 0.979 Test Loss: 0.099 Test Acc: 0.979
Validation loss decreased (-0.977019 --> -0.979108).  Saving model ...
Epoch: 20 cost time: 10.957707405090332
Epoch: 20, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.089 Vali Acc: 0.974 Test Loss: 0.089 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 10.655927419662476
Epoch: 21, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
Validation loss decreased (-0.979108 --> -0.981197).  Saving model ...
Epoch: 22 cost time: 10.907538175582886
Epoch: 22, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.098 Vali Acc: 0.969 Test Loss: 0.098 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 10.988553285598755
Epoch: 23, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.094 Vali Acc: 0.974 Test Loss: 0.094 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 10.50483250617981
Epoch: 24, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.106 Vali Acc: 0.972 Test Loss: 0.106 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 10.362540006637573
Epoch: 25, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.079 Vali Acc: 0.974 Test Loss: 0.079 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 11.193925380706787
Epoch: 26, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.069 Vali Acc: 0.978 Test Loss: 0.069 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 10.843140602111816
Epoch: 27, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.065 Vali Acc: 0.981 Test Loss: 0.065 Test Acc: 0.981
Validation loss decreased (-0.981197 --> -0.981197).  Saving model ...
Epoch: 28 cost time: 11.252547979354858
Epoch: 28, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.053 Vali Acc: 0.985 Test Loss: 0.053 Test Acc: 0.985
Validation loss decreased (-0.981197 --> -0.984679).  Saving model ...
Epoch: 29 cost time: 9.290720462799072
Epoch: 29, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.156 Vali Acc: 0.953 Test Loss: 0.156 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 10.364875555038452
Epoch: 30, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.103 Vali Acc: 0.967 Test Loss: 0.103 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 10.864023685455322
Epoch: 31, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.056 Vali Acc: 0.984 Test Loss: 0.056 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 10.510399341583252
Epoch: 32, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 9.87657618522644
Epoch: 33, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 10.574456214904785
Epoch: 34, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 10.840562105178833
Epoch: 35, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.058 Vali Acc: 0.983 Test Loss: 0.058 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 9.810306310653687
Epoch: 36, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 10.057268857955933
Epoch: 37, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.068 Vali Acc: 0.981 Test Loss: 0.068 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 10.859055757522583
Epoch: 38, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 241456
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 14.010903358459473
Epoch: 1, Steps: 89 | Train Loss: 2.895 Vali Loss: 2.391 Vali Acc: 0.406 Test Loss: 2.391 Test Acc: 0.406
Validation loss decreased (inf --> -0.405965).  Saving model ...
Epoch: 2 cost time: 11.11885404586792
Epoch: 2, Steps: 89 | Train Loss: 1.961 Vali Loss: 1.337 Vali Acc: 0.726 Test Loss: 1.337 Test Acc: 0.726
Validation loss decreased (-0.405965 --> -0.725613).  Saving model ...
Epoch: 3 cost time: 11.140618562698364
Epoch: 3, Steps: 89 | Train Loss: 1.073 Vali Loss: 0.740 Vali Acc: 0.859 Test Loss: 0.740 Test Acc: 0.859
Validation loss decreased (-0.725613 --> -0.858628).  Saving model ...
Epoch: 4 cost time: 10.662896156311035
Epoch: 4, Steps: 89 | Train Loss: 0.647 Vali Loss: 0.471 Vali Acc: 0.900 Test Loss: 0.471 Test Acc: 0.900
Validation loss decreased (-0.858628 --> -0.899717).  Saving model ...
Epoch: 5 cost time: 10.57659649848938
Epoch: 5, Steps: 89 | Train Loss: 0.454 Vali Loss: 0.342 Vali Acc: 0.923 Test Loss: 0.342 Test Acc: 0.923
Validation loss decreased (-0.899717 --> -0.922699).  Saving model ...
Epoch: 6 cost time: 10.325177669525146
Epoch: 6, Steps: 89 | Train Loss: 0.320 Vali Loss: 0.246 Vali Acc: 0.948 Test Loss: 0.246 Test Acc: 0.948
Validation loss decreased (-0.922699 --> -0.947769).  Saving model ...
Epoch: 7 cost time: 10.205979824066162
Epoch: 7, Steps: 89 | Train Loss: 0.251 Vali Loss: 0.215 Vali Acc: 0.948 Test Loss: 0.215 Test Acc: 0.948
Validation loss decreased (-0.947769 --> -0.948466).  Saving model ...
Epoch: 8 cost time: 9.987144470214844
Epoch: 8, Steps: 89 | Train Loss: 0.212 Vali Loss: 0.190 Vali Acc: 0.953 Test Loss: 0.190 Test Acc: 0.953
Validation loss decreased (-0.948466 --> -0.953341).  Saving model ...
Epoch: 9 cost time: 9.944464921951294
Epoch: 9, Steps: 89 | Train Loss: 0.165 Vali Loss: 0.174 Vali Acc: 0.946 Test Loss: 0.174 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.85505747795105
Epoch: 10, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
Validation loss decreased (-0.953341 --> -0.965180).  Saving model ...
Epoch: 11 cost time: 10.398446083068848
Epoch: 11, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 10.521514177322388
Epoch: 12, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.119 Vali Acc: 0.972 Test Loss: 0.119 Test Acc: 0.972
Validation loss decreased (-0.965180 --> -0.972144).  Saving model ...
Epoch: 13 cost time: 10.533584833145142
Epoch: 13, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.604597330093384
Epoch: 14, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.113 Vali Acc: 0.972 Test Loss: 0.113 Test Acc: 0.972
Validation loss decreased (-0.972144 --> -0.972144).  Saving model ...
Epoch: 15 cost time: 10.287602424621582
Epoch: 15, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.972144 --> -0.979804).  Saving model ...
Epoch: 16 cost time: 11.217857599258423
Epoch: 16, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.092 Vali Acc: 0.972 Test Loss: 0.092 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 10.50923204421997
Epoch: 17, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 11.145878791809082
Epoch: 18, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.066 Vali Acc: 0.985 Test Loss: 0.066 Test Acc: 0.985
Validation loss decreased (-0.979804 --> -0.984679).  Saving model ...
Epoch: 19 cost time: 9.627745628356934
Epoch: 19, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 10.488745927810669
Epoch: 20, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 11.788843870162964
Epoch: 21, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 10.372711420059204
Epoch: 22, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 10.546749353408813
Epoch: 23, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 11.072795629501343
Epoch: 24, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 10.418003559112549
Epoch: 25, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 11.222665548324585
Epoch: 26, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 10.343631267547607
Epoch: 27, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 9.975926160812378
Epoch: 28, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 240496
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 14.19771122932434
Epoch: 1, Steps: 89 | Train Loss: 2.979 Vali Loss: 2.653 Vali Acc: 0.272 Test Loss: 2.653 Test Acc: 0.272
Validation loss decreased (inf --> -0.271561).  Saving model ...
Epoch: 2 cost time: 10.1823410987854
Epoch: 2, Steps: 89 | Train Loss: 2.082 Vali Loss: 1.400 Vali Acc: 0.720 Test Loss: 1.400 Test Acc: 0.720
Validation loss decreased (-0.271561 --> -0.720042).  Saving model ...
Epoch: 3 cost time: 10.227384567260742
Epoch: 3, Steps: 89 | Train Loss: 1.127 Vali Loss: 0.802 Vali Acc: 0.811 Test Loss: 0.802 Test Acc: 0.811
Validation loss decreased (-0.720042 --> -0.811273).  Saving model ...
Epoch: 4 cost time: 10.876203775405884
Epoch: 4, Steps: 89 | Train Loss: 0.682 Vali Loss: 0.529 Vali Acc: 0.880 Test Loss: 0.529 Test Acc: 0.880
Validation loss decreased (-0.811273 --> -0.880218).  Saving model ...
Epoch: 5 cost time: 11.14476728439331
Epoch: 5, Steps: 89 | Train Loss: 0.462 Vali Loss: 0.358 Vali Acc: 0.907 Test Loss: 0.358 Test Acc: 0.907
Validation loss decreased (-0.880218 --> -0.906682).  Saving model ...
Epoch: 6 cost time: 11.688430786132812
Epoch: 6, Steps: 89 | Train Loss: 0.336 Vali Loss: 0.269 Vali Acc: 0.936 Test Loss: 0.269 Test Acc: 0.936
Validation loss decreased (-0.906682 --> -0.935930).  Saving model ...
Epoch: 7 cost time: 11.6806480884552
Epoch: 7, Steps: 89 | Train Loss: 0.272 Vali Loss: 0.225 Vali Acc: 0.950 Test Loss: 0.225 Test Acc: 0.950
Validation loss decreased (-0.935930 --> -0.949858).  Saving model ...
Epoch: 8 cost time: 12.703731298446655
Epoch: 8, Steps: 89 | Train Loss: 0.202 Vali Loss: 0.198 Vali Acc: 0.956 Test Loss: 0.198 Test Acc: 0.956
Validation loss decreased (-0.949858 --> -0.956126).  Saving model ...
Epoch: 9 cost time: 11.448993444442749
Epoch: 9, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.172 Vali Acc: 0.948 Test Loss: 0.172 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.500386953353882
Epoch: 10, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.149 Vali Acc: 0.960 Test Loss: 0.149 Test Acc: 0.960
Validation loss decreased (-0.956126 --> -0.960305).  Saving model ...
Epoch: 11 cost time: 11.720126390457153
Epoch: 11, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.138 Vali Acc: 0.957 Test Loss: 0.138 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 10.954842567443848
Epoch: 12, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
Validation loss decreased (-0.960305 --> -0.966573).  Saving model ...
Epoch: 13 cost time: 10.932836055755615
Epoch: 13, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
Validation loss decreased (-0.966573 --> -0.967965).  Saving model ...
Epoch: 14 cost time: 10.868006706237793
Epoch: 14, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.158 Vali Acc: 0.955 Test Loss: 0.158 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 11.494639873504639
Epoch: 15, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
Validation loss decreased (-0.967965 --> -0.974929).  Saving model ...
Epoch: 16 cost time: 11.668579578399658
Epoch: 16, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 11.866045713424683
Epoch: 17, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.145 Vali Acc: 0.953 Test Loss: 0.145 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 12.326932191848755
Epoch: 18, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.070 Vali Acc: 0.979 Test Loss: 0.070 Test Acc: 0.979
Validation loss decreased (-0.974929 --> -0.979108).  Saving model ...
Epoch: 19 cost time: 12.595413208007812
Epoch: 19, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.075 Vali Acc: 0.982 Test Loss: 0.075 Test Acc: 0.982
Validation loss decreased (-0.979108 --> -0.981893).  Saving model ...
Epoch: 20 cost time: 12.988044738769531
Epoch: 20, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 13.170450925827026
Epoch: 21, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 12.374863147735596
Epoch: 22, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.063 Vali Acc: 0.984 Test Loss: 0.063 Test Acc: 0.984
Validation loss decreased (-0.981893 --> -0.983983).  Saving model ...
Epoch: 23 cost time: 11.172277688980103
Epoch: 23, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 10.301161527633667
Epoch: 24, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 10.62020468711853
Epoch: 25, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.079 Vali Acc: 0.975 Test Loss: 0.079 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 11.09190583229065
Epoch: 26, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 11.365992784500122
Epoch: 27, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 11.002101182937622
Epoch: 28, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.079 Vali Acc: 0.979 Test Loss: 0.079 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 11.527255296707153
Epoch: 29, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.062 Vali Acc: 0.981 Test Loss: 0.062 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 11.266576290130615
Epoch: 30, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 10.559841871261597
Epoch: 31, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 10.561815977096558
Epoch: 32, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 239536
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.561430215835571
Epoch: 1, Steps: 89 | Train Loss: 1.784 Vali Loss: 0.633 Vali Acc: 0.822 Test Loss: 0.633 Test Acc: 0.822
Validation loss decreased (inf --> -0.821721).  Saving model ...
Epoch: 2 cost time: 9.511540412902832
Epoch: 2, Steps: 89 | Train Loss: 0.389 Vali Loss: 0.381 Vali Acc: 0.893 Test Loss: 0.381 Test Acc: 0.893
Validation loss decreased (-0.821721 --> -0.893450).  Saving model ...
Epoch: 3 cost time: 9.203304529190063
Epoch: 3, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.210 Vali Acc: 0.934 Test Loss: 0.210 Test Acc: 0.934
Validation loss decreased (-0.893450 --> -0.933842).  Saving model ...
Epoch: 4 cost time: 9.417557954788208
Epoch: 4, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.231 Vali Acc: 0.935 Test Loss: 0.231 Test Acc: 0.935
Validation loss decreased (-0.933842 --> -0.934538).  Saving model ...
Epoch: 5 cost time: 8.655209302902222
Epoch: 5, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.210 Vali Acc: 0.937 Test Loss: 0.210 Test Acc: 0.937
Validation loss decreased (-0.934538 --> -0.937324).  Saving model ...
Epoch: 6 cost time: 8.905327320098877
Epoch: 6, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.449 Vali Acc: 0.883 Test Loss: 0.449 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.144387483596802
Epoch: 7, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
Validation loss decreased (-0.937324 --> -0.965180).  Saving model ...
Epoch: 8 cost time: 9.221100091934204
Epoch: 8, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.192 Vali Acc: 0.946 Test Loss: 0.192 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.104909896850586
Epoch: 9, Steps: 89 | Train Loss: 0.197 Vali Loss: 0.330 Vali Acc: 0.898 Test Loss: 0.330 Test Acc: 0.898
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 8.535323858261108
Epoch: 10, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.233 Vali Acc: 0.932 Test Loss: 0.233 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 8.958217144012451
Epoch: 11, Steps: 89 | Train Loss: 0.329 Vali Loss: 0.816 Vali Acc: 0.792 Test Loss: 0.816 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 7.988380432128906
Epoch: 12, Steps: 89 | Train Loss: 0.732 Vali Loss: 0.557 Vali Acc: 0.823 Test Loss: 0.557 Test Acc: 0.823
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 9.670214653015137
Epoch: 13, Steps: 89 | Train Loss: 0.911 Vali Loss: 1.196 Vali Acc: 0.634 Test Loss: 1.196 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 9.36037278175354
Epoch: 14, Steps: 89 | Train Loss: 1.813 Vali Loss: 5.513 Vali Acc: 0.072 Test Loss: 5.513 Test Acc: 0.072
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 8.642002582550049
Epoch: 15, Steps: 89 | Train Loss: 3.663 Vali Loss: 3.602 Vali Acc: 0.060 Test Loss: 3.602 Test Acc: 0.060
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 8.346372365951538
Epoch: 16, Steps: 89 | Train Loss: 3.380 Vali Loss: 3.246 Vali Acc: 0.060 Test Loss: 3.246 Test Acc: 0.060
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 9.097664594650269
Epoch: 17, Steps: 89 | Train Loss: 3.217 Vali Loss: 3.155 Vali Acc: 0.046 Test Loss: 3.155 Test Acc: 0.046
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9651810584958217
model parameter : 11187780
model size : 47.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.60942554473877
Epoch: 1, Steps: 89 | Train Loss: 1.809 Vali Loss: 0.621 Vali Acc: 0.825 Test Loss: 0.621 Test Acc: 0.825
Validation loss decreased (inf --> -0.824506).  Saving model ...
Epoch: 2 cost time: 8.802776336669922
Epoch: 2, Steps: 89 | Train Loss: 0.433 Vali Loss: 0.221 Vali Acc: 0.938 Test Loss: 0.221 Test Acc: 0.938
Validation loss decreased (-0.824506 --> -0.938020).  Saving model ...
Epoch: 3 cost time: 8.228233814239502
Epoch: 3, Steps: 89 | Train Loss: 0.227 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.289119482040405
Epoch: 4, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.283 Vali Acc: 0.925 Test Loss: 0.283 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.105255126953125
Epoch: 5, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.194 Vali Acc: 0.940 Test Loss: 0.194 Test Acc: 0.940
Validation loss decreased (-0.938020 --> -0.940109).  Saving model ...
Epoch: 6 cost time: 8.372239828109741
Epoch: 6, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.228 Vali Acc: 0.933 Test Loss: 0.228 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.359597444534302
Epoch: 7, Steps: 89 | Train Loss: 0.220 Vali Loss: 0.289 Vali Acc: 0.914 Test Loss: 0.289 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.594372034072876
Epoch: 8, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.213 Vali Acc: 0.935 Test Loss: 0.213 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.052733421325684
Epoch: 9, Steps: 89 | Train Loss: 0.197 Vali Loss: 0.222 Vali Acc: 0.940 Test Loss: 0.222 Test Acc: 0.940
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 7.908262014389038
Epoch: 10, Steps: 89 | Train Loss: 0.337 Vali Loss: 0.360 Vali Acc: 0.881 Test Loss: 0.360 Test Acc: 0.881
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 8.10607361793518
Epoch: 11, Steps: 89 | Train Loss: 0.576 Vali Loss: 1.027 Vali Acc: 0.671 Test Loss: 1.027 Test Acc: 0.671
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 9.29887080192566
Epoch: 12, Steps: 89 | Train Loss: 2.392 Vali Loss: 3.559 Vali Acc: 0.054 Test Loss: 3.559 Test Acc: 0.054
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 8.402588605880737
Epoch: 13, Steps: 89 | Train Loss: 3.612 Vali Loss: 3.334 Vali Acc: 0.060 Test Loss: 3.334 Test Acc: 0.060
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 8.748584270477295
Epoch: 14, Steps: 89 | Train Loss: 3.269 Vali Loss: 3.129 Vali Acc: 0.060 Test Loss: 3.129 Test Acc: 0.060
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 8.503243446350098
Epoch: 15, Steps: 89 | Train Loss: 3.157 Vali Loss: 3.161 Vali Acc: 0.060 Test Loss: 3.161 Test Acc: 0.060
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9401114206128134
model parameter : 11180612
model size : 47.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 11.544246673583984
Epoch: 1, Steps: 89 | Train Loss: 1.818 Vali Loss: 0.692 Vali Acc: 0.797 Test Loss: 0.692 Test Acc: 0.797
Validation loss decreased (inf --> -0.797347).  Saving model ...
Epoch: 2 cost time: 9.274497270584106
Epoch: 2, Steps: 89 | Train Loss: 0.391 Vali Loss: 0.393 Vali Acc: 0.912 Test Loss: 0.393 Test Acc: 0.912
Validation loss decreased (-0.797347 --> -0.912252).  Saving model ...
Epoch: 3 cost time: 10.229240417480469
Epoch: 3, Steps: 89 | Train Loss: 0.257 Vali Loss: 0.205 Vali Acc: 0.935 Test Loss: 0.205 Test Acc: 0.935
Validation loss decreased (-0.912252 --> -0.934538).  Saving model ...
Epoch: 4 cost time: 9.973317861557007
Epoch: 4, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.277 Vali Acc: 0.909 Test Loss: 0.277 Test Acc: 0.909
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.163534164428711
Epoch: 5, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.316 Vali Acc: 0.893 Test Loss: 0.316 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.68083381652832
Epoch: 6, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.216 Vali Acc: 0.932 Test Loss: 0.216 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 8.656867980957031
Epoch: 7, Steps: 89 | Train Loss: 0.165 Vali Loss: 0.191 Vali Acc: 0.937 Test Loss: 0.191 Test Acc: 0.937
Validation loss decreased (-0.934538 --> -0.937324).  Saving model ...
Epoch: 8 cost time: 9.542638778686523
Epoch: 8, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
Validation loss decreased (-0.937324 --> -0.948466).  Saving model ...
Epoch: 9 cost time: 10.33103609085083
Epoch: 9, Steps: 89 | Train Loss: 0.232 Vali Loss: 0.235 Vali Acc: 0.932 Test Loss: 0.235 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.282894134521484
Epoch: 10, Steps: 89 | Train Loss: 0.268 Vali Loss: 0.674 Vali Acc: 0.831 Test Loss: 0.674 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.732663869857788
Epoch: 11, Steps: 89 | Train Loss: 0.338 Vali Loss: 0.518 Vali Acc: 0.833 Test Loss: 0.518 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 9.853142499923706
Epoch: 12, Steps: 89 | Train Loss: 0.916 Vali Loss: 0.514 Vali Acc: 0.852 Test Loss: 0.514 Test Acc: 0.852
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 9.04879379272461
Epoch: 13, Steps: 89 | Train Loss: 1.376 Vali Loss: 1.227 Vali Acc: 0.655 Test Loss: 1.227 Test Acc: 0.655
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 8.50322961807251
Epoch: 14, Steps: 89 | Train Loss: 1.797 Vali Loss: 1.223 Vali Acc: 0.612 Test Loss: 1.223 Test Acc: 0.612
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 9.341049432754517
Epoch: 15, Steps: 89 | Train Loss: 1.695 Vali Loss: 3.698 Vali Acc: 0.095 Test Loss: 3.698 Test Acc: 0.095
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 10.099980592727661
Epoch: 16, Steps: 89 | Train Loss: 3.579 Vali Loss: 3.115 Vali Acc: 0.088 Test Loss: 3.115 Test Acc: 0.088
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 9.701831817626953
Epoch: 17, Steps: 89 | Train Loss: 3.194 Vali Loss: 3.082 Vali Acc: 0.125 Test Loss: 3.082 Test Acc: 0.125
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 11.7575101852417
Epoch: 18, Steps: 89 | Train Loss: 2.969 Vali Loss: 2.886 Vali Acc: 0.095 Test Loss: 2.886 Test Acc: 0.095
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9484679665738162
model parameter : 11173444
model size : 47.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.527035474777222
Epoch: 1, Steps: 89 | Train Loss: 1.821 Vali Loss: 0.542 Vali Acc: 0.850 Test Loss: 0.542 Test Acc: 0.850
Validation loss decreased (inf --> -0.849577).  Saving model ...
Epoch: 2 cost time: 9.204424619674683
Epoch: 2, Steps: 89 | Train Loss: 0.372 Vali Loss: 0.326 Vali Acc: 0.909 Test Loss: 0.326 Test Acc: 0.909
Validation loss decreased (-0.849577 --> -0.908771).  Saving model ...
Epoch: 3 cost time: 8.621033906936646
Epoch: 3, Steps: 89 | Train Loss: 0.247 Vali Loss: 0.213 Vali Acc: 0.940 Test Loss: 0.213 Test Acc: 0.940
Validation loss decreased (-0.908771 --> -0.940109).  Saving model ...
Epoch: 4 cost time: 8.964643955230713
Epoch: 4, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.172 Vali Acc: 0.952 Test Loss: 0.172 Test Acc: 0.952
Validation loss decreased (-0.940109 --> -0.951948).  Saving model ...
Epoch: 5 cost time: 8.557754039764404
Epoch: 5, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.352 Vali Acc: 0.923 Test Loss: 0.352 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.660362720489502
Epoch: 6, Steps: 89 | Train Loss: 0.192 Vali Loss: 0.277 Vali Acc: 0.919 Test Loss: 0.277 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.032790660858154
Epoch: 7, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.236 Vali Acc: 0.938 Test Loss: 0.236 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.993348598480225
Epoch: 8, Steps: 89 | Train Loss: 0.227 Vali Loss: 0.172 Vali Acc: 0.948 Test Loss: 0.172 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 9.392800092697144
Epoch: 9, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.387 Vali Acc: 0.891 Test Loss: 0.387 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.463152647018433
Epoch: 10, Steps: 89 | Train Loss: 0.357 Vali Loss: 0.325 Vali Acc: 0.890 Test Loss: 0.325 Test Acc: 0.890
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 7.9300148487091064
Epoch: 11, Steps: 89 | Train Loss: 0.395 Vali Loss: 0.308 Vali Acc: 0.909 Test Loss: 0.308 Test Acc: 0.909
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 8.754656076431274
Epoch: 12, Steps: 89 | Train Loss: 0.714 Vali Loss: 0.434 Vali Acc: 0.880 Test Loss: 0.434 Test Acc: 0.880
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 8.556254148483276
Epoch: 13, Steps: 89 | Train Loss: 0.646 Vali Loss: 0.662 Vali Acc: 0.769 Test Loss: 0.662 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 8.944148540496826
Epoch: 14, Steps: 89 | Train Loss: 3.320 Vali Loss: 3.039 Vali Acc: 0.182 Test Loss: 3.039 Test Acc: 0.182
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9519498607242339
model parameter : 11166276
model size : 47.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.266125440597534
Epoch: 1, Steps: 89 | Train Loss: 1.833 Vali Loss: 0.641 Vali Acc: 0.805 Test Loss: 0.641 Test Acc: 0.805
Validation loss decreased (inf --> -0.805008).  Saving model ...
Epoch: 2 cost time: 9.817268133163452
Epoch: 2, Steps: 89 | Train Loss: 0.406 Vali Loss: 0.300 Vali Acc: 0.899 Test Loss: 0.300 Test Acc: 0.899
Validation loss decreased (-0.805008 --> -0.899022).  Saving model ...
Epoch: 3 cost time: 8.770452737808228
Epoch: 3, Steps: 89 | Train Loss: 0.255 Vali Loss: 0.322 Vali Acc: 0.916 Test Loss: 0.322 Test Acc: 0.916
Validation loss decreased (-0.899022 --> -0.915735).  Saving model ...
Epoch: 4 cost time: 8.482917070388794
Epoch: 4, Steps: 89 | Train Loss: 0.205 Vali Loss: 0.243 Vali Acc: 0.932 Test Loss: 0.243 Test Acc: 0.932
Validation loss decreased (-0.915735 --> -0.932449).  Saving model ...
Epoch: 5 cost time: 8.479668617248535
Epoch: 5, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
Validation loss decreased (-0.932449 --> -0.968662).  Saving model ...
Epoch: 6 cost time: 8.798420190811157
Epoch: 6, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.281 Vali Acc: 0.923 Test Loss: 0.281 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.523104906082153
Epoch: 7, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.260 Vali Acc: 0.926 Test Loss: 0.260 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.716694355010986
Epoch: 8, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.237 Vali Acc: 0.939 Test Loss: 0.237 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.449877738952637
Epoch: 9, Steps: 89 | Train Loss: 0.208 Vali Loss: 0.400 Vali Acc: 0.880 Test Loss: 0.400 Test Acc: 0.880
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.190567255020142
Epoch: 10, Steps: 89 | Train Loss: 0.248 Vali Loss: 0.449 Vali Acc: 0.854 Test Loss: 0.449 Test Acc: 0.854
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 8.548523902893066
Epoch: 11, Steps: 89 | Train Loss: 0.316 Vali Loss: 0.753 Vali Acc: 0.782 Test Loss: 0.753 Test Acc: 0.782
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 8.462412357330322
Epoch: 12, Steps: 89 | Train Loss: 0.512 Vali Loss: 0.459 Vali Acc: 0.863 Test Loss: 0.459 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 8.340510368347168
Epoch: 13, Steps: 89 | Train Loss: 1.647 Vali Loss: 1.334 Vali Acc: 0.633 Test Loss: 1.334 Test Acc: 0.633
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 9.424662590026855
Epoch: 14, Steps: 89 | Train Loss: 1.987 Vali Loss: 1.307 Vali Acc: 0.662 Test Loss: 1.307 Test Acc: 0.662
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 9.997539043426514
Epoch: 15, Steps: 89 | Train Loss: 1.458 Vali Loss: 1.342 Vali Acc: 0.576 Test Loss: 1.342 Test Acc: 0.576
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9686629526462396
model parameter : 9349188
model size : 40.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 12.647007465362549
Epoch: 1, Steps: 89 | Train Loss: 1.895 Vali Loss: 0.571 Vali Acc: 0.832 Test Loss: 0.571 Test Acc: 0.832
Validation loss decreased (inf --> -0.832167).  Saving model ...
Epoch: 2 cost time: 10.470535516738892
Epoch: 2, Steps: 89 | Train Loss: 0.392 Vali Loss: 0.311 Vali Acc: 0.912 Test Loss: 0.311 Test Acc: 0.912
Validation loss decreased (-0.832167 --> -0.912253).  Saving model ...
Epoch: 3 cost time: 9.756697654724121
Epoch: 3, Steps: 89 | Train Loss: 0.265 Vali Loss: 0.243 Vali Acc: 0.919 Test Loss: 0.243 Test Acc: 0.919
Validation loss decreased (-0.912253 --> -0.918521).  Saving model ...
Epoch: 4 cost time: 9.403615474700928
Epoch: 4, Steps: 89 | Train Loss: 0.220 Vali Loss: 0.214 Vali Acc: 0.932 Test Loss: 0.214 Test Acc: 0.932
Validation loss decreased (-0.918521 --> -0.931753).  Saving model ...
Epoch: 5 cost time: 8.872320413589478
Epoch: 5, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.161 Vali Acc: 0.953 Test Loss: 0.161 Test Acc: 0.953
Validation loss decreased (-0.931753 --> -0.953341).  Saving model ...
Epoch: 6 cost time: 9.912798404693604
Epoch: 6, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.194 Vali Acc: 0.942 Test Loss: 0.194 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.978569030761719
Epoch: 7, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.239 Vali Acc: 0.934 Test Loss: 0.239 Test Acc: 0.934
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.19027853012085
Epoch: 8, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.175 Vali Acc: 0.951 Test Loss: 0.175 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.601069211959839
Epoch: 9, Steps: 89 | Train Loss: 0.195 Vali Loss: 0.190 Vali Acc: 0.943 Test Loss: 0.190 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.313310384750366
Epoch: 10, Steps: 89 | Train Loss: 0.197 Vali Loss: 0.315 Vali Acc: 0.900 Test Loss: 0.315 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 9.807107925415039
Epoch: 11, Steps: 89 | Train Loss: 0.380 Vali Loss: 0.400 Vali Acc: 0.894 Test Loss: 0.400 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 10.050821542739868
Epoch: 12, Steps: 89 | Train Loss: 0.730 Vali Loss: 0.590 Vali Acc: 0.827 Test Loss: 0.590 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 8.52303957939148
Epoch: 13, Steps: 89 | Train Loss: 1.536 Vali Loss: 0.869 Vali Acc: 0.758 Test Loss: 0.869 Test Acc: 0.758
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 9.159069776535034
Epoch: 14, Steps: 89 | Train Loss: 2.488 Vali Loss: 3.281 Vali Acc: 0.244 Test Loss: 3.281 Test Acc: 0.244
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 9.158305406570435
Epoch: 15, Steps: 89 | Train Loss: 3.575 Vali Loss: 2.390 Vali Acc: 0.325 Test Loss: 2.390 Test Acc: 0.325
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9533426183844012
model parameter : 9342020
model size : 40.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 11.265013694763184
Epoch: 1, Steps: 89 | Train Loss: 1.873 Vali Loss: 0.635 Vali Acc: 0.799 Test Loss: 0.635 Test Acc: 0.799
Validation loss decreased (inf --> -0.799437).  Saving model ...
Epoch: 2 cost time: 9.059711456298828
Epoch: 2, Steps: 89 | Train Loss: 0.446 Vali Loss: 0.346 Vali Acc: 0.893 Test Loss: 0.346 Test Acc: 0.893
Validation loss decreased (-0.799437 --> -0.892754).  Saving model ...
Epoch: 3 cost time: 9.453539371490479
Epoch: 3, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.243 Vali Acc: 0.934 Test Loss: 0.243 Test Acc: 0.934
Validation loss decreased (-0.892754 --> -0.933842).  Saving model ...
Epoch: 4 cost time: 8.409623146057129
Epoch: 4, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.167 Vali Acc: 0.948 Test Loss: 0.167 Test Acc: 0.948
Validation loss decreased (-0.933842 --> -0.947770).  Saving model ...
Epoch: 5 cost time: 8.738084554672241
Epoch: 5, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.123 Vali Acc: 0.963 Test Loss: 0.123 Test Acc: 0.963
Validation loss decreased (-0.947770 --> -0.963091).  Saving model ...
Epoch: 6 cost time: 8.190045595169067
Epoch: 6, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.305 Vali Acc: 0.925 Test Loss: 0.305 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.68793249130249
Epoch: 7, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.169 Vali Acc: 0.955 Test Loss: 0.169 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.949026107788086
Epoch: 8, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.180 Vali Acc: 0.948 Test Loss: 0.180 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.162935018539429
Epoch: 9, Steps: 89 | Train Loss: 0.228 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 7.847537994384766
Epoch: 10, Steps: 89 | Train Loss: 0.280 Vali Loss: 0.296 Vali Acc: 0.921 Test Loss: 0.296 Test Acc: 0.921
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 8.90021014213562
Epoch: 11, Steps: 89 | Train Loss: 0.332 Vali Loss: 0.483 Vali Acc: 0.859 Test Loss: 0.483 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 8.398862600326538
Epoch: 12, Steps: 89 | Train Loss: 0.428 Vali Loss: 0.658 Vali Acc: 0.809 Test Loss: 0.658 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 9.033007383346558
Epoch: 13, Steps: 89 | Train Loss: 0.606 Vali Loss: 0.549 Vali Acc: 0.868 Test Loss: 0.549 Test Acc: 0.868
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 9.63588833808899
Epoch: 14, Steps: 89 | Train Loss: 0.748 Vali Loss: 0.827 Vali Acc: 0.782 Test Loss: 0.827 Test Acc: 0.782
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 8.442872047424316
Epoch: 15, Steps: 89 | Train Loss: 0.824 Vali Loss: 0.605 Vali Acc: 0.837 Test Loss: 0.605 Test Acc: 0.837
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.963091922005571
model parameter : 9334852
model size : 40.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 12.710131883621216
Epoch: 1, Steps: 89 | Train Loss: 1.804 Vali Loss: 0.549 Vali Acc: 0.834 Test Loss: 0.549 Test Acc: 0.834
Validation loss decreased (inf --> -0.834256).  Saving model ...
Epoch: 2 cost time: 8.888221502304077
Epoch: 2, Steps: 89 | Train Loss: 0.411 Vali Loss: 0.295 Vali Acc: 0.909 Test Loss: 0.295 Test Acc: 0.909
Validation loss decreased (-0.834256 --> -0.909468).  Saving model ...
Epoch: 3 cost time: 9.685295581817627
Epoch: 3, Steps: 89 | Train Loss: 0.256 Vali Loss: 0.247 Vali Acc: 0.928 Test Loss: 0.247 Test Acc: 0.928
Validation loss decreased (-0.909468 --> -0.927574).  Saving model ...
Epoch: 4 cost time: 9.79909896850586
Epoch: 4, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.149 Vali Acc: 0.955 Test Loss: 0.149 Test Acc: 0.955
Validation loss decreased (-0.927574 --> -0.954734).  Saving model ...
Epoch: 5 cost time: 10.284013271331787
Epoch: 5, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.167 Vali Acc: 0.954 Test Loss: 0.167 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.116314888000488
Epoch: 6, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.193 Vali Acc: 0.939 Test Loss: 0.193 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.880218982696533
Epoch: 7, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.268 Vali Acc: 0.905 Test Loss: 0.268 Test Acc: 0.905
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 9.955741882324219
Epoch: 8, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.187 Vali Acc: 0.955 Test Loss: 0.187 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 9.52114462852478
Epoch: 9, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.174 Vali Acc: 0.960 Test Loss: 0.174 Test Acc: 0.960
Validation loss decreased (-0.954734 --> -0.959608).  Saving model ...
Epoch: 10 cost time: 9.165562868118286
Epoch: 10, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.237 Vali Acc: 0.933 Test Loss: 0.237 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.131715297698975
Epoch: 11, Steps: 89 | Train Loss: 0.295 Vali Loss: 0.387 Vali Acc: 0.894 Test Loss: 0.387 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 9.25920820236206
Epoch: 12, Steps: 89 | Train Loss: 0.448 Vali Loss: 0.330 Vali Acc: 0.912 Test Loss: 0.330 Test Acc: 0.912
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 10.32821011543274
Epoch: 13, Steps: 89 | Train Loss: 1.020 Vali Loss: 1.906 Vali Acc: 0.483 Test Loss: 1.906 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 9.230417728424072
Epoch: 14, Steps: 89 | Train Loss: 1.331 Vali Loss: 0.750 Vali Acc: 0.781 Test Loss: 0.750 Test Acc: 0.781
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 8.461556911468506
Epoch: 15, Steps: 89 | Train Loss: 1.009 Vali Loss: 0.883 Vali Acc: 0.713 Test Loss: 0.883 Test Acc: 0.713
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 9.413832902908325
Epoch: 16, Steps: 89 | Train Loss: 0.775 Vali Loss: 0.865 Vali Acc: 0.750 Test Loss: 0.865 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 10.027708768844604
Epoch: 17, Steps: 89 | Train Loss: 0.719 Vali Loss: 0.626 Vali Acc: 0.823 Test Loss: 0.626 Test Acc: 0.823
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 9.0335373878479
Epoch: 18, Steps: 89 | Train Loss: 0.714 Vali Loss: 0.807 Vali Acc: 0.802 Test Loss: 0.807 Test Acc: 0.802
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 8.89383578300476
Epoch: 19, Steps: 89 | Train Loss: 0.798 Vali Loss: 1.043 Vali Acc: 0.760 Test Loss: 1.043 Test Acc: 0.760
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9596100278551533
model parameter : 9327684
model size : 40.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.825690507888794
Epoch: 1, Steps: 89 | Train Loss: 1.842 Vali Loss: 0.660 Vali Acc: 0.796 Test Loss: 0.660 Test Acc: 0.796
Validation loss decreased (inf --> -0.795954).  Saving model ...
Epoch: 2 cost time: 8.959152698516846
Epoch: 2, Steps: 89 | Train Loss: 0.404 Vali Loss: 0.276 Vali Acc: 0.918 Test Loss: 0.276 Test Acc: 0.918
Validation loss decreased (-0.795954 --> -0.917825).  Saving model ...
Epoch: 3 cost time: 8.363499879837036
Epoch: 3, Steps: 89 | Train Loss: 0.238 Vali Loss: 0.191 Vali Acc: 0.947 Test Loss: 0.191 Test Acc: 0.947
Validation loss decreased (-0.917825 --> -0.947073).  Saving model ...
Epoch: 4 cost time: 8.324710607528687
Epoch: 4, Steps: 89 | Train Loss: 0.202 Vali Loss: 0.228 Vali Acc: 0.939 Test Loss: 0.228 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.931010007858276
Epoch: 5, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.180 Vali Acc: 0.947 Test Loss: 0.180 Test Acc: 0.947
Validation loss decreased (-0.947073 --> -0.947073).  Saving model ...
Epoch: 6 cost time: 9.254549264907837
Epoch: 6, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.219 Vali Acc: 0.929 Test Loss: 0.219 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.42578673362732
Epoch: 7, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.205 Vali Acc: 0.954 Test Loss: 0.205 Test Acc: 0.954
Validation loss decreased (-0.947073 --> -0.954037).  Saving model ...
Epoch: 8 cost time: 8.855541229248047
Epoch: 8, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.201 Vali Acc: 0.943 Test Loss: 0.201 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.112532615661621
Epoch: 9, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.267 Vali Acc: 0.929 Test Loss: 0.267 Test Acc: 0.929
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 8.272489070892334
Epoch: 10, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.199 Vali Acc: 0.946 Test Loss: 0.199 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 9.515890836715698
Epoch: 11, Steps: 89 | Train Loss: 0.304 Vali Loss: 0.450 Vali Acc: 0.890 Test Loss: 0.450 Test Acc: 0.890
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 8.891157150268555
Epoch: 12, Steps: 89 | Train Loss: 0.546 Vali Loss: 0.706 Vali Acc: 0.807 Test Loss: 0.706 Test Acc: 0.807
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 9.175345659255981
Epoch: 13, Steps: 89 | Train Loss: 0.726 Vali Loss: 0.822 Vali Acc: 0.760 Test Loss: 0.822 Test Acc: 0.760
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 9.310442924499512
Epoch: 14, Steps: 89 | Train Loss: 1.063 Vali Loss: 0.869 Vali Acc: 0.756 Test Loss: 0.869 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 9.217298984527588
Epoch: 15, Steps: 89 | Train Loss: 1.450 Vali Loss: 1.604 Vali Acc: 0.551 Test Loss: 1.604 Test Acc: 0.551
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 7.92556095123291
Epoch: 16, Steps: 89 | Train Loss: 2.784 Vali Loss: 2.694 Vali Acc: 0.241 Test Loss: 2.694 Test Acc: 0.241
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 8.339163064956665
Epoch: 17, Steps: 89 | Train Loss: 3.635 Vali Loss: 4.236 Vali Acc: 0.064 Test Loss: 4.236 Test Acc: 0.064
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9540389972144847
model parameter : 8429892
model size : 37.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.935577392578125
Epoch: 1, Steps: 89 | Train Loss: 1.849 Vali Loss: 0.636 Vali Acc: 0.814 Test Loss: 0.636 Test Acc: 0.814
Validation loss decreased (inf --> -0.814060).  Saving model ...
Epoch: 2 cost time: 9.35994839668274
Epoch: 2, Steps: 89 | Train Loss: 0.427 Vali Loss: 0.318 Vali Acc: 0.902 Test Loss: 0.318 Test Acc: 0.902
Validation loss decreased (-0.814060 --> -0.901807).  Saving model ...
Epoch: 3 cost time: 9.461016178131104
Epoch: 3, Steps: 89 | Train Loss: 0.244 Vali Loss: 0.179 Vali Acc: 0.951 Test Loss: 0.179 Test Acc: 0.951
Validation loss decreased (-0.901807 --> -0.950555).  Saving model ...
Epoch: 4 cost time: 9.172995328903198
Epoch: 4, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.249533653259277
Epoch: 5, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.211 Vali Acc: 0.934 Test Loss: 0.211 Test Acc: 0.934
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.539899349212646
Epoch: 6, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.133 Vali Acc: 0.965 Test Loss: 0.133 Test Acc: 0.965
Validation loss decreased (-0.950555 --> -0.965180).  Saving model ...
Epoch: 7 cost time: 9.974494457244873
Epoch: 7, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.158 Vali Acc: 0.955 Test Loss: 0.158 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.30013370513916
Epoch: 8, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 10.165533304214478
Epoch: 9, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.153 Vali Acc: 0.962 Test Loss: 0.153 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 10.402326107025146
Epoch: 10, Steps: 89 | Train Loss: 0.229 Vali Loss: 0.252 Vali Acc: 0.919 Test Loss: 0.252 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.347976684570312
Epoch: 11, Steps: 89 | Train Loss: 0.252 Vali Loss: 0.298 Vali Acc: 0.912 Test Loss: 0.298 Test Acc: 0.912
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 9.636682033538818
Epoch: 12, Steps: 89 | Train Loss: 0.355 Vali Loss: 0.585 Vali Acc: 0.844 Test Loss: 0.585 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 11.330016851425171
Epoch: 13, Steps: 89 | Train Loss: 0.513 Vali Loss: 0.528 Vali Acc: 0.856 Test Loss: 0.528 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 9.09359860420227
Epoch: 14, Steps: 89 | Train Loss: 0.970 Vali Loss: 0.930 Vali Acc: 0.731 Test Loss: 0.930 Test Acc: 0.731
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 9.97134804725647
Epoch: 15, Steps: 89 | Train Loss: 0.872 Vali Loss: 1.390 Vali Acc: 0.686 Test Loss: 1.390 Test Acc: 0.686
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 9.479082107543945
Epoch: 16, Steps: 89 | Train Loss: 1.400 Vali Loss: 1.375 Vali Acc: 0.628 Test Loss: 1.375 Test Acc: 0.628
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9651810584958217
model parameter : 8422724
model size : 37.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 12.096934080123901
Epoch: 1, Steps: 89 | Train Loss: 1.918 Vali Loss: 0.666 Vali Acc: 0.786 Test Loss: 0.666 Test Acc: 0.786
Validation loss decreased (inf --> -0.785509).  Saving model ...
Epoch: 2 cost time: 10.053316593170166
Epoch: 2, Steps: 89 | Train Loss: 0.444 Vali Loss: 0.258 Vali Acc: 0.927 Test Loss: 0.258 Test Acc: 0.927
Validation loss decreased (-0.785509 --> -0.926878).  Saving model ...
Epoch: 3 cost time: 8.422588109970093
Epoch: 3, Steps: 89 | Train Loss: 0.246 Vali Loss: 0.180 Vali Acc: 0.951 Test Loss: 0.180 Test Acc: 0.951
Validation loss decreased (-0.926878 --> -0.950555).  Saving model ...
Epoch: 4 cost time: 9.592724323272705
Epoch: 4, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.765927076339722
Epoch: 5, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.276406049728394
Epoch: 6, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
Validation loss decreased (-0.950555 --> -0.965180).  Saving model ...
Epoch: 7 cost time: 9.555484294891357
Epoch: 7, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.149 Vali Acc: 0.955 Test Loss: 0.149 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.82857346534729
Epoch: 8, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.235 Vali Acc: 0.934 Test Loss: 0.235 Test Acc: 0.934
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.704356908798218
Epoch: 9, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 8.36912751197815
Epoch: 10, Steps: 89 | Train Loss: 0.209 Vali Loss: 0.219 Vali Acc: 0.930 Test Loss: 0.219 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.15501856803894
Epoch: 11, Steps: 89 | Train Loss: 0.245 Vali Loss: 0.346 Vali Acc: 0.913 Test Loss: 0.346 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 9.480252504348755
Epoch: 12, Steps: 89 | Train Loss: 0.388 Vali Loss: 0.409 Vali Acc: 0.866 Test Loss: 0.409 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 9.764693021774292
Epoch: 13, Steps: 89 | Train Loss: 0.720 Vali Loss: 1.195 Vali Acc: 0.666 Test Loss: 1.195 Test Acc: 0.666
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 9.601993322372437
Epoch: 14, Steps: 89 | Train Loss: 1.132 Vali Loss: 1.399 Vali Acc: 0.620 Test Loss: 1.399 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 10.353854894638062
Epoch: 15, Steps: 89 | Train Loss: 1.323 Vali Loss: 0.581 Vali Acc: 0.826 Test Loss: 0.581 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 9.131428480148315
Epoch: 16, Steps: 89 | Train Loss: 1.188 Vali Loss: 0.902 Vali Acc: 0.731 Test Loss: 0.902 Test Acc: 0.731
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9651810584958217
model parameter : 8415556
model size : 37.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.814738750457764
Epoch: 1, Steps: 89 | Train Loss: 1.909 Vali Loss: 0.643 Vali Acc: 0.798 Test Loss: 0.643 Test Acc: 0.798
Validation loss decreased (inf --> -0.798044).  Saving model ...
Epoch: 2 cost time: 8.70596432685852
Epoch: 2, Steps: 89 | Train Loss: 0.398 Vali Loss: 0.212 Vali Acc: 0.939 Test Loss: 0.212 Test Acc: 0.939
Validation loss decreased (-0.798044 --> -0.939413).  Saving model ...
Epoch: 3 cost time: 9.157992839813232
Epoch: 3, Steps: 89 | Train Loss: 0.214 Vali Loss: 0.159 Vali Acc: 0.953 Test Loss: 0.159 Test Acc: 0.953
Validation loss decreased (-0.939413 --> -0.953341).  Saving model ...
Epoch: 4 cost time: 9.594606399536133
Epoch: 4, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.974903106689453
Epoch: 5, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.201 Vali Acc: 0.938 Test Loss: 0.201 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.600778341293335
Epoch: 6, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
Validation loss decreased (-0.953341 --> -0.956823).  Saving model ...
Epoch: 7 cost time: 8.118101596832275
Epoch: 7, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.234 Vali Acc: 0.935 Test Loss: 0.234 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.103591442108154
Epoch: 8, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.337 Vali Acc: 0.916 Test Loss: 0.337 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.12334680557251
Epoch: 9, Steps: 89 | Train Loss: 0.202 Vali Loss: 0.235 Vali Acc: 0.930 Test Loss: 0.235 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 8.976664543151855
Epoch: 10, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.252 Vali Acc: 0.929 Test Loss: 0.252 Test Acc: 0.929
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 8.673487901687622
Epoch: 11, Steps: 89 | Train Loss: 0.366 Vali Loss: 0.470 Vali Acc: 0.857 Test Loss: 0.470 Test Acc: 0.857
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 9.214593648910522
Epoch: 12, Steps: 89 | Train Loss: 0.425 Vali Loss: 0.298 Vali Acc: 0.909 Test Loss: 0.298 Test Acc: 0.909
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 9.337174892425537
Epoch: 13, Steps: 89 | Train Loss: 0.424 Vali Loss: 0.746 Vali Acc: 0.819 Test Loss: 0.746 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 8.045309782028198
Epoch: 14, Steps: 89 | Train Loss: 0.524 Vali Loss: 0.419 Vali Acc: 0.905 Test Loss: 0.419 Test Acc: 0.905
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 8.457003355026245
Epoch: 15, Steps: 89 | Train Loss: 0.590 Vali Loss: 0.674 Vali Acc: 0.815 Test Loss: 0.674 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 7.746465682983398
Epoch: 16, Steps: 89 | Train Loss: 0.797 Vali Loss: 1.139 Vali Acc: 0.740 Test Loss: 1.139 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9568245125348189
model parameter : 8408388
model size : 37.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 11.41392207145691
Epoch: 1, Steps: 89 | Train Loss: 1.990 Vali Loss: 0.651 Vali Acc: 0.795 Test Loss: 0.651 Test Acc: 0.795
Validation loss decreased (inf --> -0.794562).  Saving model ...
Epoch: 2 cost time: 9.812482357025146
Epoch: 2, Steps: 89 | Train Loss: 0.422 Vali Loss: 0.261 Vali Acc: 0.921 Test Loss: 0.261 Test Acc: 0.921
Validation loss decreased (-0.794562 --> -0.921307).  Saving model ...
Epoch: 3 cost time: 8.836713790893555
Epoch: 3, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.238 Vali Acc: 0.930 Test Loss: 0.238 Test Acc: 0.930
Validation loss decreased (-0.921307 --> -0.930360).  Saving model ...
Epoch: 4 cost time: 8.688702821731567
Epoch: 4, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.132 Vali Acc: 0.958 Test Loss: 0.132 Test Acc: 0.958
Validation loss decreased (-0.930360 --> -0.957520).  Saving model ...
Epoch: 5 cost time: 8.907769918441772
Epoch: 5, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.245 Vali Acc: 0.935 Test Loss: 0.245 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.777084827423096
Epoch: 6, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.206 Vali Acc: 0.935 Test Loss: 0.206 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.519756078720093
Epoch: 7, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.148 Vali Acc: 0.959 Test Loss: 0.148 Test Acc: 0.959
Validation loss decreased (-0.957520 --> -0.958912).  Saving model ...
Epoch: 8 cost time: 8.998432397842407
Epoch: 8, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.254 Vali Acc: 0.923 Test Loss: 0.254 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.508699893951416
Epoch: 9, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.159 Vali Acc: 0.955 Test Loss: 0.159 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.445410251617432
Epoch: 10, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.154 Vali Acc: 0.946 Test Loss: 0.154 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 9.075575590133667
Epoch: 11, Steps: 89 | Train Loss: 0.257 Vali Loss: 0.484 Vali Acc: 0.864 Test Loss: 0.484 Test Acc: 0.864
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 9.476956129074097
Epoch: 12, Steps: 89 | Train Loss: 0.372 Vali Loss: 0.344 Vali Acc: 0.927 Test Loss: 0.344 Test Acc: 0.927
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 9.53773546218872
Epoch: 13, Steps: 89 | Train Loss: 0.639 Vali Loss: 0.492 Vali Acc: 0.853 Test Loss: 0.492 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 9.000116348266602
Epoch: 14, Steps: 89 | Train Loss: 1.384 Vali Loss: 1.562 Vali Acc: 0.515 Test Loss: 1.562 Test Acc: 0.515
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 8.99703598022461
Epoch: 15, Steps: 89 | Train Loss: 1.295 Vali Loss: 2.510 Vali Acc: 0.404 Test Loss: 2.510 Test Acc: 0.404
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 9.395782232284546
Epoch: 16, Steps: 89 | Train Loss: 1.147 Vali Loss: 0.732 Vali Acc: 0.797 Test Loss: 0.732 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 8.295156955718994
Epoch: 17, Steps: 89 | Train Loss: 1.321 Vali Loss: 1.206 Vali Acc: 0.651 Test Loss: 1.206 Test Acc: 0.651
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9589136490250696
model parameter : 7970244
model size : 35.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.572639226913452
Epoch: 1, Steps: 89 | Train Loss: 1.879 Vali Loss: 0.761 Vali Acc: 0.759 Test Loss: 0.761 Test Acc: 0.759
Validation loss decreased (inf --> -0.759045).  Saving model ...
Epoch: 2 cost time: 9.211647987365723
Epoch: 2, Steps: 89 | Train Loss: 0.406 Vali Loss: 0.258 Vali Acc: 0.918 Test Loss: 0.258 Test Acc: 0.918
Validation loss decreased (-0.759045 --> -0.917825).  Saving model ...
Epoch: 3 cost time: 8.357102155685425
Epoch: 3, Steps: 89 | Train Loss: 0.238 Vali Loss: 0.173 Vali Acc: 0.951 Test Loss: 0.173 Test Acc: 0.951
Validation loss decreased (-0.917825 --> -0.950555).  Saving model ...
Epoch: 4 cost time: 8.169830560684204
Epoch: 4, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.154 Vali Acc: 0.953 Test Loss: 0.154 Test Acc: 0.953
Validation loss decreased (-0.950555 --> -0.953341).  Saving model ...
Epoch: 5 cost time: 7.672117233276367
Epoch: 5, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.278 Vali Acc: 0.910 Test Loss: 0.278 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.37174367904663
Epoch: 6, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.144 Vali Acc: 0.951 Test Loss: 0.144 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.220968246459961
Epoch: 7, Steps: 89 | Train Loss: 0.186 Vali Loss: 0.254 Vali Acc: 0.925 Test Loss: 0.254 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.26098084449768
Epoch: 8, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.142 Vali Acc: 0.947 Test Loss: 0.142 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 8.449856281280518
Epoch: 9, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.39467167854309
Epoch: 10, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.251 Vali Acc: 0.928 Test Loss: 0.251 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 7.9775848388671875
Epoch: 11, Steps: 89 | Train Loss: 0.307 Vali Loss: 0.521 Vali Acc: 0.842 Test Loss: 0.521 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 7.82961106300354
Epoch: 12, Steps: 89 | Train Loss: 0.605 Vali Loss: 0.930 Vali Acc: 0.744 Test Loss: 0.930 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 7.781888246536255
Epoch: 13, Steps: 89 | Train Loss: 1.031 Vali Loss: 0.954 Vali Acc: 0.747 Test Loss: 0.954 Test Acc: 0.747
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 8.766902208328247
Epoch: 14, Steps: 89 | Train Loss: 1.007 Vali Loss: 1.090 Vali Acc: 0.667 Test Loss: 1.090 Test Acc: 0.667
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9533426183844012
model parameter : 7963076
model size : 35.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 11.17441701889038
Epoch: 1, Steps: 89 | Train Loss: 1.905 Vali Loss: 0.583 Vali Acc: 0.852 Test Loss: 0.583 Test Acc: 0.852
Validation loss decreased (inf --> -0.851665).  Saving model ...
Epoch: 2 cost time: 7.888389825820923
Epoch: 2, Steps: 89 | Train Loss: 0.395 Vali Loss: 0.313 Vali Acc: 0.902 Test Loss: 0.313 Test Acc: 0.902
Validation loss decreased (-0.851665 --> -0.901807).  Saving model ...
Epoch: 3 cost time: 8.763585805892944
Epoch: 3, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.163 Vali Acc: 0.967 Test Loss: 0.163 Test Acc: 0.967
Validation loss decreased (-0.901807 --> -0.967269).  Saving model ...
Epoch: 4 cost time: 8.233861446380615
Epoch: 4, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.09801197052002
Epoch: 5, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.200 Vali Acc: 0.946 Test Loss: 0.200 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.340246438980103
Epoch: 6, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.224 Vali Acc: 0.930 Test Loss: 0.224 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 8.855576992034912
Epoch: 7, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.156 Vali Acc: 0.959 Test Loss: 0.156 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 9.855925798416138
Epoch: 8, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 10.001598119735718
Epoch: 9, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.141 Vali Acc: 0.958 Test Loss: 0.141 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 9.894060373306274
Epoch: 10, Steps: 89 | Train Loss: 0.195 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 9.680259466171265
Epoch: 11, Steps: 89 | Train Loss: 0.311 Vali Loss: 0.233 Vali Acc: 0.926 Test Loss: 0.233 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 8.327146053314209
Epoch: 12, Steps: 89 | Train Loss: 0.327 Vali Loss: 0.422 Vali Acc: 0.888 Test Loss: 0.422 Test Acc: 0.888
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 9.111228227615356
Epoch: 13, Steps: 89 | Train Loss: 0.467 Vali Loss: 0.524 Vali Acc: 0.864 Test Loss: 0.524 Test Acc: 0.864
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9672701949860725
model parameter : 7955908
model size : 35.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.415276765823364
Epoch: 1, Steps: 89 | Train Loss: 1.887 Vali Loss: 0.594 Vali Acc: 0.840 Test Loss: 0.594 Test Acc: 0.840
Validation loss decreased (inf --> -0.839827).  Saving model ...
Epoch: 2 cost time: 9.076112747192383
Epoch: 2, Steps: 89 | Train Loss: 0.454 Vali Loss: 0.433 Vali Acc: 0.860 Test Loss: 0.433 Test Acc: 0.860
Validation loss decreased (-0.839827 --> -0.860024).  Saving model ...
Epoch: 3 cost time: 8.331819295883179
Epoch: 3, Steps: 89 | Train Loss: 0.295 Vali Loss: 0.237 Vali Acc: 0.925 Test Loss: 0.237 Test Acc: 0.925
Validation loss decreased (-0.860024 --> -0.924789).  Saving model ...
Epoch: 4 cost time: 8.357386350631714
Epoch: 4, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.168 Vali Acc: 0.949 Test Loss: 0.168 Test Acc: 0.949
Validation loss decreased (-0.924789 --> -0.949163).  Saving model ...
Epoch: 5 cost time: 7.84933876991272
Epoch: 5, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.209 Vali Acc: 0.939 Test Loss: 0.209 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.02077841758728
Epoch: 6, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.145 Vali Acc: 0.960 Test Loss: 0.145 Test Acc: 0.960
Validation loss decreased (-0.949163 --> -0.960305).  Saving model ...
Epoch: 7 cost time: 7.860097885131836
Epoch: 7, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.415744304656982
Epoch: 8, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.177 Vali Acc: 0.948 Test Loss: 0.177 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.701824426651001
Epoch: 9, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.152 Vali Acc: 0.950 Test Loss: 0.152 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 10.021383047103882
Epoch: 10, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.227 Vali Acc: 0.930 Test Loss: 0.227 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 8.846882820129395
Epoch: 11, Steps: 89 | Train Loss: 0.259 Vali Loss: 0.490 Vali Acc: 0.882 Test Loss: 0.490 Test Acc: 0.882
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 8.853503465652466
Epoch: 12, Steps: 89 | Train Loss: 0.350 Vali Loss: 0.285 Vali Acc: 0.915 Test Loss: 0.285 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 9.651124000549316
Epoch: 13, Steps: 89 | Train Loss: 0.523 Vali Loss: 0.677 Vali Acc: 0.817 Test Loss: 0.677 Test Acc: 0.817
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 8.278761386871338
Epoch: 14, Steps: 89 | Train Loss: 1.022 Vali Loss: 0.726 Vali Acc: 0.776 Test Loss: 0.726 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 9.913965463638306
Epoch: 15, Steps: 89 | Train Loss: 0.605 Vali Loss: 0.585 Vali Acc: 0.816 Test Loss: 0.585 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 9.288814544677734
Epoch: 16, Steps: 89 | Train Loss: 0.876 Vali Loss: 1.392 Vali Acc: 0.682 Test Loss: 1.392 Test Acc: 0.682
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9603064066852368
model parameter : 7948740
model size : 35.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.903387546539307
Epoch: 1, Steps: 89 | Train Loss: 2.110 Vali Loss: 0.818 Vali Acc: 0.774 Test Loss: 0.818 Test Acc: 0.774
Validation loss decreased (inf --> -0.773669).  Saving model ...
Epoch: 2 cost time: 7.705670118331909
Epoch: 2, Steps: 89 | Train Loss: 0.545 Vali Loss: 0.317 Vali Acc: 0.924 Test Loss: 0.317 Test Acc: 0.924
Validation loss decreased (-0.773669 --> -0.924092).  Saving model ...
Epoch: 3 cost time: 7.433727264404297
Epoch: 3, Steps: 89 | Train Loss: 0.267 Vali Loss: 0.181 Vali Acc: 0.947 Test Loss: 0.181 Test Acc: 0.947
Validation loss decreased (-0.924092 --> -0.947073).  Saving model ...
Epoch: 4 cost time: 8.477212190628052
Epoch: 4, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.140 Vali Acc: 0.961 Test Loss: 0.140 Test Acc: 0.961
Validation loss decreased (-0.947073 --> -0.961001).  Saving model ...
Epoch: 5 cost time: 8.152668714523315
Epoch: 5, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.177 Vali Acc: 0.951 Test Loss: 0.177 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.328521490097046
Epoch: 6, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.142 Vali Acc: 0.960 Test Loss: 0.142 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.52039098739624
Epoch: 7, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.923906326293945
Epoch: 8, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.082 Vali Acc: 0.979 Test Loss: 0.082 Test Acc: 0.979
Validation loss decreased (-0.961001 --> -0.979108).  Saving model ...
Epoch: 9 cost time: 8.052941799163818
Epoch: 9, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.127 Vali Acc: 0.956 Test Loss: 0.127 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.203378438949585
Epoch: 10, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.138 Vali Acc: 0.961 Test Loss: 0.138 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.130382061004639
Epoch: 11, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.179 Vali Acc: 0.947 Test Loss: 0.179 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.9607744216918945
Epoch: 12, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.6861572265625
Epoch: 13, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.198 Vali Acc: 0.946 Test Loss: 0.198 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 9.417381048202515
Epoch: 14, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.151 Vali Acc: 0.955 Test Loss: 0.151 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.999646186828613
Epoch: 15, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.147 Vali Acc: 0.955 Test Loss: 0.147 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 8.324182033538818
Epoch: 16, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 8.667012929916382
Epoch: 17, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 7.913002014160156
Epoch: 18, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.145 Vali Acc: 0.960 Test Loss: 0.145 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 3762500
model size : 16.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.827086448669434
Epoch: 1, Steps: 89 | Train Loss: 2.093 Vali Loss: 0.846 Vali Acc: 0.757 Test Loss: 0.846 Test Acc: 0.757
Validation loss decreased (inf --> -0.756955).  Saving model ...
Epoch: 2 cost time: 9.4891996383667
Epoch: 2, Steps: 89 | Train Loss: 0.520 Vali Loss: 0.351 Vali Acc: 0.905 Test Loss: 0.351 Test Acc: 0.905
Validation loss decreased (-0.756955 --> -0.905289).  Saving model ...
Epoch: 3 cost time: 8.568103075027466
Epoch: 3, Steps: 89 | Train Loss: 0.268 Vali Loss: 0.211 Vali Acc: 0.949 Test Loss: 0.211 Test Acc: 0.949
Validation loss decreased (-0.905289 --> -0.949162).  Saving model ...
Epoch: 4 cost time: 8.834090948104858
Epoch: 4, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.149 Vali Acc: 0.953 Test Loss: 0.149 Test Acc: 0.953
Validation loss decreased (-0.949162 --> -0.953341).  Saving model ...
Epoch: 5 cost time: 9.397663831710815
Epoch: 5, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.30162787437439
Epoch: 6, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.244 Vali Acc: 0.930 Test Loss: 0.244 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.473009586334229
Epoch: 7, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
Validation loss decreased (-0.953341 --> -0.967966).  Saving model ...
Epoch: 8 cost time: 7.84897255897522
Epoch: 8, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.184 Vali Acc: 0.955 Test Loss: 0.184 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.27871298789978
Epoch: 9, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.471631050109863
Epoch: 10, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.094 Vali Acc: 0.969 Test Loss: 0.094 Test Acc: 0.969
Validation loss decreased (-0.967966 --> -0.968662).  Saving model ...
Epoch: 11 cost time: 8.601978540420532
Epoch: 11, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.76030445098877
Epoch: 12, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.142 Vali Acc: 0.960 Test Loss: 0.142 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 9.764221906661987
Epoch: 13, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.205 Vali Acc: 0.946 Test Loss: 0.205 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 8.308115720748901
Epoch: 14, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
Validation loss decreased (-0.968662 --> -0.978411).  Saving model ...
Epoch: 15 cost time: 7.966935634613037
Epoch: 15, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.901327848434448
Epoch: 16, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 8.85775876045227
Epoch: 17, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.153 Vali Acc: 0.956 Test Loss: 0.153 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 9.457886934280396
Epoch: 18, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.121 Vali Acc: 0.963 Test Loss: 0.121 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 10.125784158706665
Epoch: 19, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.237 Vali Acc: 0.935 Test Loss: 0.237 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 10.040242195129395
Epoch: 20, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.209 Vali Acc: 0.948 Test Loss: 0.209 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 10.596437454223633
Epoch: 21, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.377 Vali Acc: 0.894 Test Loss: 0.377 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 9.14441990852356
Epoch: 22, Steps: 89 | Train Loss: 0.242 Vali Loss: 0.224 Vali Acc: 0.940 Test Loss: 0.224 Test Acc: 0.940
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 8.654671430587769
Epoch: 23, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.220 Vali Acc: 0.935 Test Loss: 0.220 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 8.266321897506714
Epoch: 24, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 3758916
model size : 16.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 11.446299314498901
Epoch: 1, Steps: 89 | Train Loss: 2.180 Vali Loss: 0.881 Vali Acc: 0.790 Test Loss: 0.881 Test Acc: 0.790
Validation loss decreased (inf --> -0.789685).  Saving model ...
Epoch: 2 cost time: 9.300458908081055
Epoch: 2, Steps: 89 | Train Loss: 0.583 Vali Loss: 0.382 Vali Acc: 0.891 Test Loss: 0.382 Test Acc: 0.891
Validation loss decreased (-0.789685 --> -0.890665).  Saving model ...
Epoch: 3 cost time: 8.666893005371094
Epoch: 3, Steps: 89 | Train Loss: 0.313 Vali Loss: 0.238 Vali Acc: 0.935 Test Loss: 0.238 Test Acc: 0.935
Validation loss decreased (-0.890665 --> -0.935234).  Saving model ...
Epoch: 4 cost time: 9.843229293823242
Epoch: 4, Steps: 89 | Train Loss: 0.186 Vali Loss: 0.163 Vali Acc: 0.954 Test Loss: 0.163 Test Acc: 0.954
Validation loss decreased (-0.935234 --> -0.954037).  Saving model ...
Epoch: 5 cost time: 9.067244052886963
Epoch: 5, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.204 Vali Acc: 0.928 Test Loss: 0.204 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.372026443481445
Epoch: 6, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.246 Vali Acc: 0.928 Test Loss: 0.246 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.325539588928223
Epoch: 7, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.888240098953247
Epoch: 8, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.131 Vali Acc: 0.964 Test Loss: 0.131 Test Acc: 0.964
Validation loss decreased (-0.954037 --> -0.964483).  Saving model ...
Epoch: 9 cost time: 9.453874111175537
Epoch: 9, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.129 Vali Acc: 0.960 Test Loss: 0.129 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.188251972198486
Epoch: 10, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.119 Vali Acc: 0.967 Test Loss: 0.119 Test Acc: 0.967
Validation loss decreased (-0.964483 --> -0.967269).  Saving model ...
Epoch: 11 cost time: 9.192380428314209
Epoch: 11, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.332336187362671
Epoch: 12, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.161 Vali Acc: 0.952 Test Loss: 0.161 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 8.367083311080933
Epoch: 13, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
Validation loss decreased (-0.967269 --> -0.970054).  Saving model ...
Epoch: 14 cost time: 8.008190155029297
Epoch: 14, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.091 Vali Acc: 0.971 Test Loss: 0.091 Test Acc: 0.971
Validation loss decreased (-0.970054 --> -0.970751).  Saving model ...
Epoch: 15 cost time: 9.296666383743286
Epoch: 15, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 9.059419870376587
Epoch: 16, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.138 Vali Acc: 0.958 Test Loss: 0.138 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 9.644845485687256
Epoch: 17, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.192 Vali Acc: 0.938 Test Loss: 0.192 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 8.965056896209717
Epoch: 18, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.117 Vali Acc: 0.963 Test Loss: 0.117 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 8.564454317092896
Epoch: 19, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.192 Vali Acc: 0.948 Test Loss: 0.192 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 7.903329849243164
Epoch: 20, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.254 Vali Acc: 0.922 Test Loss: 0.254 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 8.20519232749939
Epoch: 21, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.300 Vali Acc: 0.922 Test Loss: 0.300 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 7.422005891799927
Epoch: 22, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.187 Vali Acc: 0.949 Test Loss: 0.187 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 9.148146390914917
Epoch: 23, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 10.142581939697266
Epoch: 24, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.263 Vali Acc: 0.930 Test Loss: 0.263 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9707520891364902
model parameter : 3755332
model size : 16.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.216001272201538
Epoch: 1, Steps: 89 | Train Loss: 2.147 Vali Loss: 0.948 Vali Acc: 0.737 Test Loss: 0.948 Test Acc: 0.737
Validation loss decreased (inf --> -0.736759).  Saving model ...
Epoch: 2 cost time: 7.653185129165649
Epoch: 2, Steps: 89 | Train Loss: 0.553 Vali Loss: 0.506 Vali Acc: 0.887 Test Loss: 0.506 Test Acc: 0.887
Validation loss decreased (-0.736759 --> -0.887182).  Saving model ...
Epoch: 3 cost time: 7.862544536590576
Epoch: 3, Steps: 89 | Train Loss: 0.291 Vali Loss: 0.304 Vali Acc: 0.905 Test Loss: 0.304 Test Acc: 0.905
Validation loss decreased (-0.887182 --> -0.904593).  Saving model ...
Epoch: 4 cost time: 7.401001214981079
Epoch: 4, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.178 Vali Acc: 0.954 Test Loss: 0.178 Test Acc: 0.954
Validation loss decreased (-0.904593 --> -0.954037).  Saving model ...
Epoch: 5 cost time: 7.618342876434326
Epoch: 5, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.147 Vali Acc: 0.955 Test Loss: 0.147 Test Acc: 0.955
Validation loss decreased (-0.954037 --> -0.954734).  Saving model ...
Epoch: 6 cost time: 8.364305973052979
Epoch: 6, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
Validation loss decreased (-0.954734 --> -0.970751).  Saving model ...
Epoch: 7 cost time: 8.188030242919922
Epoch: 7, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.175 Vali Acc: 0.942 Test Loss: 0.175 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.650853157043457
Epoch: 8, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.100 Vali Acc: 0.969 Test Loss: 0.100 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.470079660415649
Epoch: 9, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.904085636138916
Epoch: 10, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.111 Vali Acc: 0.964 Test Loss: 0.111 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.24100136756897
Epoch: 11, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 8.422191619873047
Epoch: 12, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 7.915226697921753
Epoch: 13, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.292 Vali Acc: 0.916 Test Loss: 0.292 Test Acc: 0.916
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 8.248115062713623
Epoch: 14, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.157 Vali Acc: 0.946 Test Loss: 0.157 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 8.496544599533081
Epoch: 15, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 7.804895877838135
Epoch: 16, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.140 Vali Acc: 0.958 Test Loss: 0.140 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9707520891364902
model parameter : 3751748
model size : 16.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 12.371077060699463
Epoch: 1, Steps: 89 | Train Loss: 2.329 Vali Loss: 1.035 Vali Acc: 0.728 Test Loss: 1.035 Test Acc: 0.728
Validation loss decreased (inf --> -0.727706).  Saving model ...
Epoch: 2 cost time: 8.649632930755615
Epoch: 2, Steps: 89 | Train Loss: 0.633 Vali Loss: 0.383 Vali Acc: 0.903 Test Loss: 0.383 Test Acc: 0.903
Validation loss decreased (-0.727706 --> -0.903200).  Saving model ...
Epoch: 3 cost time: 8.391437530517578
Epoch: 3, Steps: 89 | Train Loss: 0.275 Vali Loss: 0.201 Vali Acc: 0.946 Test Loss: 0.201 Test Acc: 0.946
Validation loss decreased (-0.903200 --> -0.945680).  Saving model ...
Epoch: 4 cost time: 8.074354648590088
Epoch: 4, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
Validation loss decreased (-0.945680 --> -0.950555).  Saving model ...
Epoch: 5 cost time: 8.455260992050171
Epoch: 5, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.173 Vali Acc: 0.942 Test Loss: 0.173 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.62109637260437
Epoch: 6, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.139 Vali Acc: 0.963 Test Loss: 0.139 Test Acc: 0.963
Validation loss decreased (-0.950555 --> -0.963091).  Saving model ...
Epoch: 7 cost time: 8.96422028541565
Epoch: 7, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.098 Vali Acc: 0.972 Test Loss: 0.098 Test Acc: 0.972
Validation loss decreased (-0.963091 --> -0.972144).  Saving model ...
Epoch: 8 cost time: 8.016515493392944
Epoch: 8, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.174875736236572
Epoch: 9, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.167 Vali Acc: 0.952 Test Loss: 0.167 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 8.541072845458984
Epoch: 10, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.177 Vali Acc: 0.953 Test Loss: 0.177 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 8.449432373046875
Epoch: 11, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.117 Vali Acc: 0.961 Test Loss: 0.117 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 7.634511232376099
Epoch: 12, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.147 Vali Acc: 0.962 Test Loss: 0.147 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.553412199020386
Epoch: 13, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 7.945974349975586
Epoch: 14, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.162 Vali Acc: 0.948 Test Loss: 0.162 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 9.089565753936768
Epoch: 15, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.972144 --> -0.977019).  Saving model ...
Epoch: 16 cost time: 7.482311248779297
Epoch: 16, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 8.783665895462036
Epoch: 17, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.151 Vali Acc: 0.946 Test Loss: 0.151 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 9.772364854812622
Epoch: 18, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 9.368349552154541
Epoch: 19, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 8.261640548706055
Epoch: 20, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.180 Vali Acc: 0.955 Test Loss: 0.180 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 8.313676834106445
Epoch: 21, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.179 Vali Acc: 0.949 Test Loss: 0.179 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 9.167704820632935
Epoch: 22, Steps: 89 | Train Loss: 0.165 Vali Loss: 0.179 Vali Acc: 0.951 Test Loss: 0.179 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 9.80996298789978
Epoch: 23, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.151 Vali Acc: 0.953 Test Loss: 0.151 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 8.9805428981781
Epoch: 24, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.272 Vali Acc: 0.922 Test Loss: 0.272 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 8.811847925186157
Epoch: 25, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.210 Vali Acc: 0.929 Test Loss: 0.210 Test Acc: 0.929
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 2841412
model size : 13.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.183327913284302
Epoch: 1, Steps: 89 | Train Loss: 2.288 Vali Loss: 0.916 Vali Acc: 0.769 Test Loss: 0.916 Test Acc: 0.769
Validation loss decreased (inf --> -0.769489).  Saving model ...
Epoch: 2 cost time: 7.861225605010986
Epoch: 2, Steps: 89 | Train Loss: 0.551 Vali Loss: 0.329 Vali Acc: 0.913 Test Loss: 0.329 Test Acc: 0.913
Validation loss decreased (-0.769489 --> -0.912949).  Saving model ...
Epoch: 3 cost time: 8.446739912033081
Epoch: 3, Steps: 89 | Train Loss: 0.261 Vali Loss: 0.197 Vali Acc: 0.946 Test Loss: 0.197 Test Acc: 0.946
Validation loss decreased (-0.912949 --> -0.945680).  Saving model ...
Epoch: 4 cost time: 9.049883604049683
Epoch: 4, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.169 Vali Acc: 0.945 Test Loss: 0.169 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.93099856376648
Epoch: 5, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.139 Vali Acc: 0.961 Test Loss: 0.139 Test Acc: 0.961
Validation loss decreased (-0.945680 --> -0.961001).  Saving model ...
Epoch: 6 cost time: 8.457695484161377
Epoch: 6, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.127 Vali Acc: 0.964 Test Loss: 0.127 Test Acc: 0.964
Validation loss decreased (-0.961001 --> -0.963787).  Saving model ...
Epoch: 7 cost time: 8.811485767364502
Epoch: 7, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.503242492675781
Epoch: 8, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.088 Vali Acc: 0.974 Test Loss: 0.088 Test Acc: 0.974
Validation loss decreased (-0.963787 --> -0.973537).  Saving model ...
Epoch: 9 cost time: 8.043527364730835
Epoch: 9, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.199 Vali Acc: 0.947 Test Loss: 0.199 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.191771984100342
Epoch: 10, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.126 Vali Acc: 0.964 Test Loss: 0.126 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.338721513748169
Epoch: 11, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.119 Vali Acc: 0.963 Test Loss: 0.119 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 9.058039903640747
Epoch: 12, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 8.805370092391968
Epoch: 13, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.134 Vali Acc: 0.963 Test Loss: 0.134 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 8.807493448257446
Epoch: 14, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
Validation loss decreased (-0.973537 --> -0.977715).  Saving model ...
Epoch: 15 cost time: 9.85443663597107
Epoch: 15, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 8.7122163772583
Epoch: 16, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.341 Vali Acc: 0.922 Test Loss: 0.341 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 8.472116708755493
Epoch: 17, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.272 Vali Acc: 0.923 Test Loss: 0.272 Test Acc: 0.923
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 8.60534405708313
Epoch: 18, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.201 Vali Acc: 0.948 Test Loss: 0.201 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 9.627948522567749
Epoch: 19, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 8.744614362716675
Epoch: 20, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 9.336857318878174
Epoch: 21, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.146 Vali Acc: 0.961 Test Loss: 0.146 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 9.826949119567871
Epoch: 22, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.128 Vali Acc: 0.964 Test Loss: 0.128 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 8.863810300827026
Epoch: 23, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.195 Vali Acc: 0.946 Test Loss: 0.195 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 7.538527488708496
Epoch: 24, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.187 Vali Acc: 0.950 Test Loss: 0.187 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 2837828
model size : 13.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.631532669067383
Epoch: 1, Steps: 89 | Train Loss: 2.209 Vali Loss: 0.914 Vali Acc: 0.776 Test Loss: 0.914 Test Acc: 0.776
Validation loss decreased (inf --> -0.776453).  Saving model ...
Epoch: 2 cost time: 7.966383218765259
Epoch: 2, Steps: 89 | Train Loss: 0.570 Vali Loss: 0.379 Vali Acc: 0.906 Test Loss: 0.379 Test Acc: 0.906
Validation loss decreased (-0.776453 --> -0.905985).  Saving model ...
Epoch: 3 cost time: 7.50404691696167
Epoch: 3, Steps: 89 | Train Loss: 0.283 Vali Loss: 0.217 Vali Acc: 0.946 Test Loss: 0.217 Test Acc: 0.946
Validation loss decreased (-0.905985 --> -0.945680).  Saving model ...
Epoch: 4 cost time: 7.6437461376190186
Epoch: 4, Steps: 89 | Train Loss: 0.182 Vali Loss: 0.211 Vali Acc: 0.947 Test Loss: 0.211 Test Acc: 0.947
Validation loss decreased (-0.945680 --> -0.947073).  Saving model ...
Epoch: 5 cost time: 7.977776288986206
Epoch: 5, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
Validation loss decreased (-0.947073 --> -0.967965).  Saving model ...
Epoch: 6 cost time: 8.015129804611206
Epoch: 6, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.967965 --> -0.977019).  Saving model ...
Epoch: 7 cost time: 8.327444076538086
Epoch: 7, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.598543643951416
Epoch: 8, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.116 Vali Acc: 0.967 Test Loss: 0.116 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.663473844528198
Epoch: 9, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 8.201026678085327
Epoch: 10, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.135 Vali Acc: 0.953 Test Loss: 0.135 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 8.399069786071777
Epoch: 11, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.160 Vali Acc: 0.950 Test Loss: 0.160 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 8.680243492126465
Epoch: 12, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.176 Vali Acc: 0.954 Test Loss: 0.176 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 8.023822546005249
Epoch: 13, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.158 Vali Acc: 0.960 Test Loss: 0.158 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 8.143592119216919
Epoch: 14, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.213 Vali Acc: 0.946 Test Loss: 0.213 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 7.626265048980713
Epoch: 15, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
Validation loss decreased (-0.977019 --> -0.983286).  Saving model ...
Epoch: 16 cost time: 8.270704746246338
Epoch: 16, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.9398720264434814
Epoch: 17, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 8.218414068222046
Epoch: 18, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 7.428116321563721
Epoch: 19, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.119 Vali Acc: 0.964 Test Loss: 0.119 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 7.999375820159912
Epoch: 20, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.204 Vali Acc: 0.948 Test Loss: 0.204 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 7.530804872512817
Epoch: 21, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 8.097929239273071
Epoch: 22, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.157 Vali Acc: 0.960 Test Loss: 0.157 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 7.941462278366089
Epoch: 23, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.209 Vali Acc: 0.937 Test Loss: 0.209 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 7.41503643989563
Epoch: 24, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.203 Vali Acc: 0.948 Test Loss: 0.203 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 7.617238283157349
Epoch: 25, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 2834244
model size : 13.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 11.729568243026733
Epoch: 1, Steps: 89 | Train Loss: 2.308 Vali Loss: 0.963 Vali Acc: 0.738 Test Loss: 0.963 Test Acc: 0.738
Validation loss decreased (inf --> -0.738152).  Saving model ...
Epoch: 2 cost time: 8.230672597885132
Epoch: 2, Steps: 89 | Train Loss: 0.543 Vali Loss: 0.343 Vali Acc: 0.898 Test Loss: 0.343 Test Acc: 0.898
Validation loss decreased (-0.738152 --> -0.897629).  Saving model ...
Epoch: 3 cost time: 8.312061071395874
Epoch: 3, Steps: 89 | Train Loss: 0.281 Vali Loss: 0.183 Vali Acc: 0.951 Test Loss: 0.183 Test Acc: 0.951
Validation loss decreased (-0.897629 --> -0.950555).  Saving model ...
Epoch: 4 cost time: 10.18441104888916
Epoch: 4, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.169 Vali Acc: 0.945 Test Loss: 0.169 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.223286390304565
Epoch: 5, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.145 Vali Acc: 0.960 Test Loss: 0.145 Test Acc: 0.960
Validation loss decreased (-0.950555 --> -0.959609).  Saving model ...
Epoch: 6 cost time: 7.675280332565308
Epoch: 6, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
Validation loss decreased (-0.959609 --> -0.965180).  Saving model ...
Epoch: 7 cost time: 7.727636337280273
Epoch: 7, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.133 Vali Acc: 0.963 Test Loss: 0.133 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.633942365646362
Epoch: 8, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.195 Vali Acc: 0.941 Test Loss: 0.195 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.632490396499634
Epoch: 9, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.094 Vali Acc: 0.971 Test Loss: 0.094 Test Acc: 0.971
Validation loss decreased (-0.965180 --> -0.970751).  Saving model ...
Epoch: 10 cost time: 8.564892530441284
Epoch: 10, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.970751 --> -0.977019).  Saving model ...
Epoch: 11 cost time: 8.868950128555298
Epoch: 11, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.252 Vali Acc: 0.912 Test Loss: 0.252 Test Acc: 0.912
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.053210973739624
Epoch: 12, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.145 Vali Acc: 0.956 Test Loss: 0.145 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 8.537072896957397
Epoch: 13, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.124 Vali Acc: 0.964 Test Loss: 0.124 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 9.327666997909546
Epoch: 14, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 7.922020196914673
Epoch: 15, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.142 Vali Acc: 0.953 Test Loss: 0.142 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 9.522083520889282
Epoch: 16, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.139 Vali Acc: 0.963 Test Loss: 0.139 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 9.711032390594482
Epoch: 17, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.108 Vali Acc: 0.969 Test Loss: 0.108 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 8.889171600341797
Epoch: 18, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.233 Vali Acc: 0.941 Test Loss: 0.233 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 9.718552350997925
Epoch: 19, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 8.772639274597168
Epoch: 20, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 2830660
model size : 13.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.967634201049805
Epoch: 1, Steps: 89 | Train Loss: 2.445 Vali Loss: 1.127 Vali Acc: 0.758 Test Loss: 1.127 Test Acc: 0.758
Validation loss decreased (inf --> -0.757649).  Saving model ...
Epoch: 2 cost time: 7.930591106414795
Epoch: 2, Steps: 89 | Train Loss: 0.623 Vali Loss: 0.350 Vali Acc: 0.907 Test Loss: 0.350 Test Acc: 0.907
Validation loss decreased (-0.757649 --> -0.906682).  Saving model ...
Epoch: 3 cost time: 7.749052047729492
Epoch: 3, Steps: 89 | Train Loss: 0.273 Vali Loss: 0.206 Vali Acc: 0.943 Test Loss: 0.206 Test Acc: 0.943
Validation loss decreased (-0.906682 --> -0.942895).  Saving model ...
Epoch: 4 cost time: 7.719772815704346
Epoch: 4, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.942895 --> -0.944288).  Saving model ...
Epoch: 5 cost time: 7.339236259460449
Epoch: 5, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.139 Vali Acc: 0.959 Test Loss: 0.139 Test Acc: 0.959
Validation loss decreased (-0.944288 --> -0.958912).  Saving model ...
Epoch: 6 cost time: 7.429474115371704
Epoch: 6, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.116 Vali Acc: 0.964 Test Loss: 0.116 Test Acc: 0.964
Validation loss decreased (-0.958912 --> -0.963787).  Saving model ...
Epoch: 7 cost time: 7.8124988079071045
Epoch: 7, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.831974029541016
Epoch: 8, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.188 Vali Acc: 0.948 Test Loss: 0.188 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.920004367828369
Epoch: 9, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
Validation loss decreased (-0.963787 --> -0.974929).  Saving model ...
Epoch: 10 cost time: 7.76475191116333
Epoch: 10, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.4289655685424805
Epoch: 11, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.273 Vali Acc: 0.926 Test Loss: 0.273 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.175542831420898
Epoch: 12, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.126 Vali Acc: 0.956 Test Loss: 0.126 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.968920469284058
Epoch: 13, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 7.3898842334747314
Epoch: 14, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.116 Vali Acc: 0.967 Test Loss: 0.116 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 7.744872570037842
Epoch: 15, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.131 Vali Acc: 0.964 Test Loss: 0.131 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 8.40415906906128
Epoch: 16, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.153 Vali Acc: 0.955 Test Loss: 0.153 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 7.716161727905273
Epoch: 17, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.102 Vali Acc: 0.969 Test Loss: 0.102 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 7.853437423706055
Epoch: 18, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.169 Vali Acc: 0.954 Test Loss: 0.169 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 7.309295654296875
Epoch: 19, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.130 Vali Acc: 0.964 Test Loss: 0.130 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9749303621169917
model parameter : 2380868
model size : 11.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.509845733642578
Epoch: 1, Steps: 89 | Train Loss: 2.289 Vali Loss: 1.082 Vali Acc: 0.728 Test Loss: 1.082 Test Acc: 0.728
Validation loss decreased (inf --> -0.727705).  Saving model ...
Epoch: 2 cost time: 7.440391302108765
Epoch: 2, Steps: 89 | Train Loss: 0.636 Vali Loss: 0.372 Vali Acc: 0.900 Test Loss: 0.372 Test Acc: 0.900
Validation loss decreased (-0.727705 --> -0.899718).  Saving model ...
Epoch: 3 cost time: 7.861873149871826
Epoch: 3, Steps: 89 | Train Loss: 0.283 Vali Loss: 0.204 Vali Acc: 0.942 Test Loss: 0.204 Test Acc: 0.942
Validation loss decreased (-0.899718 --> -0.941502).  Saving model ...
Epoch: 4 cost time: 7.735310077667236
Epoch: 4, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.164 Vali Acc: 0.955 Test Loss: 0.164 Test Acc: 0.955
Validation loss decreased (-0.941502 --> -0.955430).  Saving model ...
Epoch: 5 cost time: 7.619794607162476
Epoch: 5, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.109 Vali Acc: 0.972 Test Loss: 0.109 Test Acc: 0.972
Validation loss decreased (-0.955430 --> -0.972144).  Saving model ...
Epoch: 6 cost time: 7.808492183685303
Epoch: 6, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.137 Vali Acc: 0.951 Test Loss: 0.137 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.3785481452941895
Epoch: 7, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.106 Vali Acc: 0.967 Test Loss: 0.106 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.64913010597229
Epoch: 8, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.972144 --> -0.972840).  Saving model ...
Epoch: 9 cost time: 8.069576501846313
Epoch: 9, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.143 Vali Acc: 0.956 Test Loss: 0.143 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.64164137840271
Epoch: 10, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.507901906967163
Epoch: 11, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.094 Vali Acc: 0.969 Test Loss: 0.094 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.35384202003479
Epoch: 12, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.247218132019043
Epoch: 13, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.473709583282471
Epoch: 14, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
Validation loss decreased (-0.972840 --> -0.977715).  Saving model ...
Epoch: 15 cost time: 7.045823812484741
Epoch: 15, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.972286939620972
Epoch: 16, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.332 Vali Acc: 0.913 Test Loss: 0.332 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.310908794403076
Epoch: 17, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.182 Vali Acc: 0.954 Test Loss: 0.182 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 7.933763027191162
Epoch: 18, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 7.62999415397644
Epoch: 19, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.145 Vali Acc: 0.958 Test Loss: 0.145 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 7.736537456512451
Epoch: 20, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.155 Vali Acc: 0.961 Test Loss: 0.155 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 7.4090001583099365
Epoch: 21, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 8.459192514419556
Epoch: 22, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.156 Vali Acc: 0.955 Test Loss: 0.156 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 7.325424432754517
Epoch: 23, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.161 Vali Acc: 0.953 Test Loss: 0.161 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 7.544936418533325
Epoch: 24, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 2377284
model size : 11.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.180247068405151
Epoch: 1, Steps: 89 | Train Loss: 2.352 Vali Loss: 1.028 Vali Acc: 0.709 Test Loss: 1.028 Test Acc: 0.709
Validation loss decreased (inf --> -0.708903).  Saving model ...
Epoch: 2 cost time: 8.401960134506226
Epoch: 2, Steps: 89 | Train Loss: 0.608 Vali Loss: 0.426 Vali Acc: 0.853 Test Loss: 0.426 Test Acc: 0.853
Validation loss decreased (-0.708903 --> -0.853060).  Saving model ...
Epoch: 3 cost time: 7.420139312744141
Epoch: 3, Steps: 89 | Train Loss: 0.271 Vali Loss: 0.216 Vali Acc: 0.942 Test Loss: 0.216 Test Acc: 0.942
Validation loss decreased (-0.853060 --> -0.942198).  Saving model ...
Epoch: 4 cost time: 7.6814069747924805
Epoch: 4, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.179 Vali Acc: 0.946 Test Loss: 0.179 Test Acc: 0.946
Validation loss decreased (-0.942198 --> -0.946377).  Saving model ...
Epoch: 5 cost time: 7.489351034164429
Epoch: 5, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.125 Vali Acc: 0.966 Test Loss: 0.125 Test Acc: 0.966
Validation loss decreased (-0.946377 --> -0.965876).  Saving model ...
Epoch: 6 cost time: 7.997661590576172
Epoch: 6, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
Validation loss decreased (-0.965876 --> -0.973537).  Saving model ...
Epoch: 7 cost time: 7.503708362579346
Epoch: 7, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.973632335662842
Epoch: 8, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.174 Vali Acc: 0.951 Test Loss: 0.174 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.39064359664917
Epoch: 9, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.115 Vali Acc: 0.966 Test Loss: 0.115 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 8.07014274597168
Epoch: 10, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.148 Vali Acc: 0.954 Test Loss: 0.148 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.392303228378296
Epoch: 11, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 7.366042852401733
Epoch: 12, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.089 Vali Acc: 0.968 Test Loss: 0.089 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 7.829245090484619
Epoch: 13, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.128 Vali Acc: 0.963 Test Loss: 0.128 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 7.807613849639893
Epoch: 14, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.240 Vali Acc: 0.918 Test Loss: 0.240 Test Acc: 0.918
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 7.031292915344238
Epoch: 15, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
Validation loss decreased (-0.973537 --> -0.975626).  Saving model ...
Epoch: 16 cost time: 7.69999098777771
Epoch: 16, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.142 Vali Acc: 0.960 Test Loss: 0.142 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.8501598834991455
Epoch: 17, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.273 Vali Acc: 0.927 Test Loss: 0.273 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.465084075927734
Epoch: 18, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.181 Vali Acc: 0.949 Test Loss: 0.181 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 8.07836651802063
Epoch: 19, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 7.612254858016968
Epoch: 20, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.214 Vali Acc: 0.932 Test Loss: 0.214 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 8.028430461883545
Epoch: 21, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 7.238864421844482
Epoch: 22, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.190 Vali Acc: 0.945 Test Loss: 0.190 Test Acc: 0.945
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 7.9088428020477295
Epoch: 23, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.322 Vali Acc: 0.910 Test Loss: 0.322 Test Acc: 0.910
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 7.375234842300415
Epoch: 24, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.223 Vali Acc: 0.945 Test Loss: 0.223 Test Acc: 0.945
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 8.506701707839966
Epoch: 25, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 2373700
model size : 11.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 11.016457319259644
Epoch: 1, Steps: 89 | Train Loss: 2.241 Vali Loss: 0.925 Vali Acc: 0.782 Test Loss: 0.925 Test Acc: 0.782
Validation loss decreased (inf --> -0.782024).  Saving model ...
Epoch: 2 cost time: 8.82402777671814
Epoch: 2, Steps: 89 | Train Loss: 0.567 Vali Loss: 0.363 Vali Acc: 0.899 Test Loss: 0.363 Test Acc: 0.899
Validation loss decreased (-0.782024 --> -0.899021).  Saving model ...
Epoch: 3 cost time: 6.861584663391113
Epoch: 3, Steps: 89 | Train Loss: 0.300 Vali Loss: 0.231 Vali Acc: 0.942 Test Loss: 0.231 Test Acc: 0.942
Validation loss decreased (-0.899021 --> -0.942198).  Saving model ...
Epoch: 4 cost time: 7.930086851119995
Epoch: 4, Steps: 89 | Train Loss: 0.182 Vali Loss: 0.195 Vali Acc: 0.948 Test Loss: 0.195 Test Acc: 0.948
Validation loss decreased (-0.942198 --> -0.947770).  Saving model ...
Epoch: 5 cost time: 7.447222471237183
Epoch: 5, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.147 Vali Acc: 0.955 Test Loss: 0.147 Test Acc: 0.955
Validation loss decreased (-0.947770 --> -0.954734).  Saving model ...
Epoch: 6 cost time: 8.554872035980225
Epoch: 6, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.954734 --> -0.972840).  Saving model ...
Epoch: 7 cost time: 7.797885179519653
Epoch: 7, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.102 Vali Acc: 0.962 Test Loss: 0.102 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.809868812561035
Epoch: 8, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.083 Vali Acc: 0.974 Test Loss: 0.083 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.973537).  Saving model ...
Epoch: 9 cost time: 8.746185779571533
Epoch: 9, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.193 Vali Acc: 0.940 Test Loss: 0.193 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.7340357303619385
Epoch: 10, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.253539800643921
Epoch: 11, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.121 Vali Acc: 0.958 Test Loss: 0.121 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 8.724595308303833
Epoch: 12, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.145 Vali Acc: 0.955 Test Loss: 0.145 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 8.296847581863403
Epoch: 13, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
Validation loss decreased (-0.973537 --> -0.978411).  Saving model ...
Epoch: 14 cost time: 9.134475469589233
Epoch: 14, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.249855279922485
Epoch: 15, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.095 Vali Acc: 0.972 Test Loss: 0.095 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 8.315340280532837
Epoch: 16, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 8.96091365814209
Epoch: 17, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.108 Vali Acc: 0.969 Test Loss: 0.108 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 8.822819709777832
Epoch: 18, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 7.777221202850342
Epoch: 19, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.201 Vali Acc: 0.959 Test Loss: 0.201 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 8.386232852935791
Epoch: 20, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.149 Vali Acc: 0.960 Test Loss: 0.149 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 7.242202520370483
Epoch: 21, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.093 Vali Acc: 0.969 Test Loss: 0.093 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 6.940627574920654
Epoch: 22, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.136 Vali Acc: 0.963 Test Loss: 0.136 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 7.652096509933472
Epoch: 23, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.147 Vali Acc: 0.955 Test Loss: 0.147 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 2370116
model size : 11.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.523200750350952
Epoch: 1, Steps: 89 | Train Loss: 2.385 Vali Loss: 1.071 Vali Acc: 0.760 Test Loss: 1.071 Test Acc: 0.760
Validation loss decreased (inf --> -0.759739).  Saving model ...
Epoch: 2 cost time: 7.552382230758667
Epoch: 2, Steps: 89 | Train Loss: 0.641 Vali Loss: 0.402 Vali Acc: 0.902 Test Loss: 0.402 Test Acc: 0.902
Validation loss decreased (-0.759739 --> -0.901807).  Saving model ...
Epoch: 3 cost time: 7.9006028175354
Epoch: 3, Steps: 89 | Train Loss: 0.288 Vali Loss: 0.262 Vali Acc: 0.923 Test Loss: 0.262 Test Acc: 0.923
Validation loss decreased (-0.901807 --> -0.923396).  Saving model ...
Epoch: 4 cost time: 7.397240400314331
Epoch: 4, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.200 Vali Acc: 0.937 Test Loss: 0.200 Test Acc: 0.937
Validation loss decreased (-0.923396 --> -0.937324).  Saving model ...
Epoch: 5 cost time: 7.8278772830963135
Epoch: 5, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.156 Vali Acc: 0.950 Test Loss: 0.156 Test Acc: 0.950
Validation loss decreased (-0.937324 --> -0.949859).  Saving model ...
Epoch: 6 cost time: 7.472784519195557
Epoch: 6, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
Validation loss decreased (-0.949859 --> -0.967965).  Saving model ...
Epoch: 7 cost time: 7.40793776512146
Epoch: 7, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
Validation loss decreased (-0.967965 --> -0.978411).  Saving model ...
Epoch: 8 cost time: 8.157394409179688
Epoch: 8, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.202 Vali Acc: 0.945 Test Loss: 0.202 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.814342260360718
Epoch: 9, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.198 Vali Acc: 0.943 Test Loss: 0.198 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 8.184206247329712
Epoch: 10, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.088 Vali Acc: 0.971 Test Loss: 0.088 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.533093452453613
Epoch: 11, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.071 Vali Acc: 0.976 Test Loss: 0.071 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 8.814427852630615
Epoch: 12, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.571885108947754
Epoch: 13, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.155 Vali Acc: 0.956 Test Loss: 0.155 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 8.171196460723877
Epoch: 14, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.097 Vali Acc: 0.972 Test Loss: 0.097 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 7.267620325088501
Epoch: 15, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.149 Vali Acc: 0.955 Test Loss: 0.149 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 8.620063304901123
Epoch: 16, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.069 Vali Acc: 0.979 Test Loss: 0.069 Test Acc: 0.979
Validation loss decreased (-0.978411 --> -0.979108).  Saving model ...
Epoch: 17 cost time: 8.316210508346558
Epoch: 17, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.182 Vali Acc: 0.942 Test Loss: 0.182 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 7.826391935348511
Epoch: 18, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.389 Vali Acc: 0.912 Test Loss: 0.389 Test Acc: 0.912
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 7.020147085189819
Epoch: 19, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.149 Vali Acc: 0.960 Test Loss: 0.149 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 7.584094524383545
Epoch: 20, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.289 Vali Acc: 0.939 Test Loss: 0.289 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 7.314769744873047
Epoch: 21, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.112 Vali Acc: 0.969 Test Loss: 0.112 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.854912519454956
Epoch: 22, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.140 Vali Acc: 0.964 Test Loss: 0.140 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.8666112422943115
Epoch: 23, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.195 Vali Acc: 0.940 Test Loss: 0.195 Test Acc: 0.940
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 6.833529472351074
Epoch: 24, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.167 Vali Acc: 0.953 Test Loss: 0.167 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 6.809651136398315
Epoch: 25, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 7.7768096923828125
Epoch: 26, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 2150596
model size : 10.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.131192684173584
Epoch: 1, Steps: 89 | Train Loss: 2.493 Vali Loss: 1.232 Vali Acc: 0.694 Test Loss: 1.232 Test Acc: 0.694
Validation loss decreased (inf --> -0.694277).  Saving model ...
Epoch: 2 cost time: 8.259488344192505
Epoch: 2, Steps: 89 | Train Loss: 0.684 Vali Loss: 0.433 Vali Acc: 0.881 Test Loss: 0.433 Test Acc: 0.881
Validation loss decreased (-0.694277 --> -0.880915).  Saving model ...
Epoch: 3 cost time: 8.188868522644043
Epoch: 3, Steps: 89 | Train Loss: 0.312 Vali Loss: 0.244 Vali Acc: 0.933 Test Loss: 0.244 Test Acc: 0.933
Validation loss decreased (-0.880915 --> -0.933145).  Saving model ...
Epoch: 4 cost time: 8.031672954559326
Epoch: 4, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.173 Vali Acc: 0.957 Test Loss: 0.173 Test Acc: 0.957
Validation loss decreased (-0.933145 --> -0.956823).  Saving model ...
Epoch: 5 cost time: 7.765206575393677
Epoch: 5, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
Validation loss decreased (-0.956823 --> -0.961698).  Saving model ...
Epoch: 6 cost time: 8.579866647720337
Epoch: 6, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.187 Vali Acc: 0.945 Test Loss: 0.187 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.734476089477539
Epoch: 7, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
Validation loss decreased (-0.961698 --> -0.970751).  Saving model ...
Epoch: 8 cost time: 8.35420823097229
Epoch: 8, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.970751 --> -0.972840).  Saving model ...
Epoch: 9 cost time: 8.92449140548706
Epoch: 9, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.061 Vali Acc: 0.985 Test Loss: 0.061 Test Acc: 0.985
Validation loss decreased (-0.972840 --> -0.984679).  Saving model ...
Epoch: 10 cost time: 8.960924863815308
Epoch: 10, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.081446886062622
Epoch: 11, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.217947006225586
Epoch: 12, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.088 Vali Acc: 0.971 Test Loss: 0.088 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 8.707703828811646
Epoch: 13, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 8.207963705062866
Epoch: 14, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 8.17542815208435
Epoch: 15, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.126 Vali Acc: 0.963 Test Loss: 0.126 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 8.049643993377686
Epoch: 16, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.166 Vali Acc: 0.948 Test Loss: 0.166 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 8.748984336853027
Epoch: 17, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 9.160309553146362
Epoch: 18, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.274 Vali Acc: 0.933 Test Loss: 0.274 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 7.757531404495239
Epoch: 19, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.275 Vali Acc: 0.942 Test Loss: 0.275 Test Acc: 0.942
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 2147012
model size : 10.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.739482879638672
Epoch: 1, Steps: 89 | Train Loss: 2.396 Vali Loss: 1.067 Vali Acc: 0.763 Test Loss: 1.067 Test Acc: 0.763
Validation loss decreased (inf --> -0.763221).  Saving model ...
Epoch: 2 cost time: 8.044649124145508
Epoch: 2, Steps: 89 | Train Loss: 0.639 Vali Loss: 0.426 Vali Acc: 0.877 Test Loss: 0.426 Test Acc: 0.877
Validation loss decreased (-0.763221 --> -0.876737).  Saving model ...
Epoch: 3 cost time: 8.054133176803589
Epoch: 3, Steps: 89 | Train Loss: 0.293 Vali Loss: 0.239 Vali Acc: 0.929 Test Loss: 0.239 Test Acc: 0.929
Validation loss decreased (-0.876737 --> -0.928967).  Saving model ...
Epoch: 4 cost time: 7.710941791534424
Epoch: 4, Steps: 89 | Train Loss: 0.186 Vali Loss: 0.206 Vali Acc: 0.930 Test Loss: 0.206 Test Acc: 0.930
Validation loss decreased (-0.928967 --> -0.930360).  Saving model ...
Epoch: 5 cost time: 7.18845009803772
Epoch: 5, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.178 Vali Acc: 0.940 Test Loss: 0.178 Test Acc: 0.940
Validation loss decreased (-0.930360 --> -0.940110).  Saving model ...
Epoch: 6 cost time: 8.015563488006592
Epoch: 6, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
Validation loss decreased (-0.940110 --> -0.974233).  Saving model ...
Epoch: 7 cost time: 8.213013410568237
Epoch: 7, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.940967559814453
Epoch: 8, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.974233 --> -0.977019).  Saving model ...
Epoch: 9 cost time: 8.361575603485107
Epoch: 9, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.977019 --> -0.977019).  Saving model ...
Epoch: 10 cost time: 8.242113590240479
Epoch: 10, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.673515558242798
Epoch: 11, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.120 Vali Acc: 0.966 Test Loss: 0.120 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.962720632553101
Epoch: 12, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.068 Vali Acc: 0.982 Test Loss: 0.068 Test Acc: 0.982
Validation loss decreased (-0.977019 --> -0.981893).  Saving model ...
Epoch: 13 cost time: 8.239135980606079
Epoch: 13, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.309588432312012
Epoch: 14, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.119 Vali Acc: 0.963 Test Loss: 0.119 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.889636516571045
Epoch: 15, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.169 Vali Acc: 0.950 Test Loss: 0.169 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 7.878111362457275
Epoch: 16, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.076845169067383
Epoch: 17, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.161 Vali Acc: 0.962 Test Loss: 0.161 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 7.342666149139404
Epoch: 18, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.093 Vali Acc: 0.967 Test Loss: 0.093 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 7.267437219619751
Epoch: 19, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.139 Vali Acc: 0.961 Test Loss: 0.139 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 8.109975099563599
Epoch: 20, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 7.897968292236328
Epoch: 21, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 7.529123306274414
Epoch: 22, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.196 Vali Acc: 0.948 Test Loss: 0.196 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 2143428
model size : 10.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.596448421478271
Epoch: 1, Steps: 89 | Train Loss: 2.518 Vali Loss: 1.190 Vali Acc: 0.721 Test Loss: 1.190 Test Acc: 0.721
Validation loss decreased (inf --> -0.720740).  Saving model ...
Epoch: 2 cost time: 8.572362422943115
Epoch: 2, Steps: 89 | Train Loss: 0.693 Vali Loss: 0.424 Vali Acc: 0.892 Test Loss: 0.424 Test Acc: 0.892
Validation loss decreased (-0.720740 --> -0.892057).  Saving model ...
Epoch: 3 cost time: 8.045469999313354
Epoch: 3, Steps: 89 | Train Loss: 0.311 Vali Loss: 0.249 Vali Acc: 0.924 Test Loss: 0.249 Test Acc: 0.924
Validation loss decreased (-0.892057 --> -0.924092).  Saving model ...
Epoch: 4 cost time: 7.879462242126465
Epoch: 4, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.173 Vali Acc: 0.951 Test Loss: 0.173 Test Acc: 0.951
Validation loss decreased (-0.924092 --> -0.951252).  Saving model ...
Epoch: 5 cost time: 7.495920896530151
Epoch: 5, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.258 Vali Acc: 0.933 Test Loss: 0.258 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.387030601501465
Epoch: 6, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.157 Vali Acc: 0.952 Test Loss: 0.157 Test Acc: 0.952
Validation loss decreased (-0.951252 --> -0.951948).  Saving model ...
Epoch: 7 cost time: 7.741136312484741
Epoch: 7, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.150 Vali Acc: 0.955 Test Loss: 0.150 Test Acc: 0.955
Validation loss decreased (-0.951948 --> -0.955430).  Saving model ...
Epoch: 8 cost time: 7.4301464557647705
Epoch: 8, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.103 Vali Acc: 0.969 Test Loss: 0.103 Test Acc: 0.969
Validation loss decreased (-0.955430 --> -0.969358).  Saving model ...
Epoch: 9 cost time: 7.942885160446167
Epoch: 9, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.199 Vali Acc: 0.936 Test Loss: 0.199 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.241621255874634
Epoch: 10, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.969358 --> -0.970055).  Saving model ...
Epoch: 11 cost time: 9.761452674865723
Epoch: 11, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.150 Vali Acc: 0.953 Test Loss: 0.150 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.346238374710083
Epoch: 12, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.300640344619751
Epoch: 13, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 7.307464361190796
Epoch: 14, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.088 Vali Acc: 0.975 Test Loss: 0.088 Test Acc: 0.975
Validation loss decreased (-0.970055 --> -0.974929).  Saving model ...
Epoch: 15 cost time: 8.48830533027649
Epoch: 15, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.353843450546265
Epoch: 16, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.7050769329071045
Epoch: 17, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 7.758149862289429
Epoch: 18, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.149 Vali Acc: 0.956 Test Loss: 0.149 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 8.096680164337158
Epoch: 19, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 7.538306474685669
Epoch: 20, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 7.042184114456177
Epoch: 21, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.139 Vali Acc: 0.955 Test Loss: 0.139 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 7.75562047958374
Epoch: 22, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.189 Vali Acc: 0.948 Test Loss: 0.189 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 8.125619173049927
Epoch: 23, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 9.378247499465942
Epoch: 24, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9749303621169917
model parameter : 2139844
model size : 10.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.136008024215698
Epoch: 1, Steps: 89 | Train Loss: 2.562 Vali Loss: 1.466 Vali Acc: 0.668 Test Loss: 1.466 Test Acc: 0.668
Validation loss decreased (inf --> -0.667813).  Saving model ...
Epoch: 2 cost time: 7.148262023925781
Epoch: 2, Steps: 89 | Train Loss: 0.913 Vali Loss: 0.565 Vali Acc: 0.870 Test Loss: 0.565 Test Acc: 0.870
Validation loss decreased (-0.667813 --> -0.870468).  Saving model ...
Epoch: 3 cost time: 7.759321689605713
Epoch: 3, Steps: 89 | Train Loss: 0.417 Vali Loss: 0.372 Vali Acc: 0.912 Test Loss: 0.372 Test Acc: 0.912
Validation loss decreased (-0.870468 --> -0.911556).  Saving model ...
Epoch: 4 cost time: 7.513193368911743
Epoch: 4, Steps: 89 | Train Loss: 0.267 Vali Loss: 0.203 Vali Acc: 0.948 Test Loss: 0.203 Test Acc: 0.948
Validation loss decreased (-0.911556 --> -0.948466).  Saving model ...
Epoch: 5 cost time: 7.080487012863159
Epoch: 5, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.163 Vali Acc: 0.952 Test Loss: 0.163 Test Acc: 0.952
Validation loss decreased (-0.948466 --> -0.951948).  Saving model ...
Epoch: 6 cost time: 7.977757453918457
Epoch: 6, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.116 Vali Acc: 0.969 Test Loss: 0.116 Test Acc: 0.969
Validation loss decreased (-0.951948 --> -0.969358).  Saving model ...
Epoch: 7 cost time: 7.709989070892334
Epoch: 7, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.1599860191345215
Epoch: 8, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.168 Vali Acc: 0.948 Test Loss: 0.168 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.224194049835205
Epoch: 9, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.097 Vali Acc: 0.972 Test Loss: 0.097 Test Acc: 0.972
Validation loss decreased (-0.969358 --> -0.972144).  Saving model ...
Epoch: 10 cost time: 7.1691601276397705
Epoch: 10, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.121 Vali Acc: 0.961 Test Loss: 0.121 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.965893745422363
Epoch: 11, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.133 Vali Acc: 0.956 Test Loss: 0.133 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.200845003128052
Epoch: 12, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.987501382827759
Epoch: 13, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.106 Vali Acc: 0.972 Test Loss: 0.106 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 7.876556396484375
Epoch: 14, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
Validation loss decreased (-0.972144 --> -0.977715).  Saving model ...
Epoch: 15 cost time: 6.888605117797852
Epoch: 15, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.138325452804565
Epoch: 16, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.105 Vali Acc: 0.967 Test Loss: 0.105 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.6771628856658936
Epoch: 17, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.143 Vali Acc: 0.955 Test Loss: 0.143 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 7.528944492340088
Epoch: 18, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.137 Vali Acc: 0.956 Test Loss: 0.137 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.648912191390991
Epoch: 19, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 7.074211597442627
Epoch: 20, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.90439510345459
Epoch: 21, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.154 Vali Acc: 0.955 Test Loss: 0.154 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 6.684445858001709
Epoch: 22, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.101 Vali Acc: 0.969 Test Loss: 0.101 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 7.376485586166382
Epoch: 23, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.165 Vali Acc: 0.962 Test Loss: 0.165 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 7.2818310260772705
Epoch: 24, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 1426116
model size : 6.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.581184148788452
Epoch: 1, Steps: 89 | Train Loss: 2.557 Vali Loss: 1.499 Vali Acc: 0.692 Test Loss: 1.499 Test Acc: 0.692
Validation loss decreased (inf --> -0.692186).  Saving model ...
Epoch: 2 cost time: 7.586875677108765
Epoch: 2, Steps: 89 | Train Loss: 0.936 Vali Loss: 0.606 Vali Acc: 0.845 Test Loss: 0.606 Test Acc: 0.845
Validation loss decreased (-0.692186 --> -0.845398).  Saving model ...
Epoch: 3 cost time: 7.877532482147217
Epoch: 3, Steps: 89 | Train Loss: 0.432 Vali Loss: 0.358 Vali Acc: 0.908 Test Loss: 0.358 Test Acc: 0.908
Validation loss decreased (-0.845398 --> -0.908074).  Saving model ...
Epoch: 4 cost time: 8.142431259155273
Epoch: 4, Steps: 89 | Train Loss: 0.275 Vali Loss: 0.226 Vali Acc: 0.936 Test Loss: 0.226 Test Acc: 0.936
Validation loss decreased (-0.908074 --> -0.935931).  Saving model ...
Epoch: 5 cost time: 7.198232173919678
Epoch: 5, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.172 Vali Acc: 0.942 Test Loss: 0.172 Test Acc: 0.942
Validation loss decreased (-0.935931 --> -0.942199).  Saving model ...
Epoch: 6 cost time: 7.313309907913208
Epoch: 6, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.191 Vali Acc: 0.933 Test Loss: 0.191 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.812236309051514
Epoch: 7, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.157 Vali Acc: 0.944 Test Loss: 0.157 Test Acc: 0.944
Validation loss decreased (-0.942199 --> -0.944288).  Saving model ...
Epoch: 8 cost time: 7.40077543258667
Epoch: 8, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.101 Vali Acc: 0.972 Test Loss: 0.101 Test Acc: 0.972
Validation loss decreased (-0.944288 --> -0.972144).  Saving model ...
Epoch: 9 cost time: 7.568191289901733
Epoch: 9, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.112 Vali Acc: 0.969 Test Loss: 0.112 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.5061259269714355
Epoch: 10, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.140 Vali Acc: 0.965 Test Loss: 0.140 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.558103322982788
Epoch: 11, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.120 Vali Acc: 0.960 Test Loss: 0.120 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.3415679931640625
Epoch: 12, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.082 Vali Acc: 0.974 Test Loss: 0.082 Test Acc: 0.974
Validation loss decreased (-0.972144 --> -0.974233).  Saving model ...
Epoch: 13 cost time: 7.296393394470215
Epoch: 13, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.124 Vali Acc: 0.961 Test Loss: 0.124 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.272644996643066
Epoch: 14, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.974233 --> -0.979804).  Saving model ...
Epoch: 15 cost time: 7.801742792129517
Epoch: 15, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.171 Vali Acc: 0.948 Test Loss: 0.171 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.037337779998779
Epoch: 16, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.750653505325317
Epoch: 17, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.111 Vali Acc: 0.964 Test Loss: 0.111 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 7.388672351837158
Epoch: 18, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.194 Vali Acc: 0.935 Test Loss: 0.194 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 7.137405157089233
Epoch: 19, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 7.372248411178589
Epoch: 20, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.92057991027832
Epoch: 21, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.105 Vali Acc: 0.969 Test Loss: 0.105 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 7.101318597793579
Epoch: 22, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 8.431102275848389
Epoch: 23, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 7.5736260414123535
Epoch: 24, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.114 Vali Acc: 0.967 Test Loss: 0.114 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 1424324
model size : 6.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.732182264328003
Epoch: 1, Steps: 89 | Train Loss: 2.502 Vali Loss: 1.383 Vali Acc: 0.675 Test Loss: 1.383 Test Acc: 0.675
Validation loss decreased (inf --> -0.674777).  Saving model ...
Epoch: 2 cost time: 7.773911952972412
Epoch: 2, Steps: 89 | Train Loss: 0.886 Vali Loss: 0.540 Vali Acc: 0.893 Test Loss: 0.540 Test Acc: 0.893
Validation loss decreased (-0.674777 --> -0.892752).  Saving model ...
Epoch: 3 cost time: 8.025868654251099
Epoch: 3, Steps: 89 | Train Loss: 0.434 Vali Loss: 0.322 Vali Acc: 0.916 Test Loss: 0.322 Test Acc: 0.916
Validation loss decreased (-0.892752 --> -0.916431).  Saving model ...
Epoch: 4 cost time: 9.450100421905518
Epoch: 4, Steps: 89 | Train Loss: 0.281 Vali Loss: 0.269 Vali Acc: 0.937 Test Loss: 0.269 Test Acc: 0.937
Validation loss decreased (-0.916431 --> -0.936627).  Saving model ...
Epoch: 5 cost time: 8.28791856765747
Epoch: 5, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.156 Vali Acc: 0.960 Test Loss: 0.156 Test Acc: 0.960
Validation loss decreased (-0.936627 --> -0.960305).  Saving model ...
Epoch: 6 cost time: 7.688406944274902
Epoch: 6, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.138 Vali Acc: 0.967 Test Loss: 0.138 Test Acc: 0.967
Validation loss decreased (-0.960305 --> -0.966572).  Saving model ...
Epoch: 7 cost time: 8.053775072097778
Epoch: 7, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.137 Vali Acc: 0.966 Test Loss: 0.137 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.214038372039795
Epoch: 8, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
Validation loss decreased (-0.966572 --> -0.970751).  Saving model ...
Epoch: 9 cost time: 7.355344295501709
Epoch: 9, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
Validation loss decreased (-0.970751 --> -0.976322).  Saving model ...
Epoch: 10 cost time: 7.2178850173950195
Epoch: 10, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.117 Vali Acc: 0.960 Test Loss: 0.117 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.071120262145996
Epoch: 11, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.490748882293701
Epoch: 12, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.149 Vali Acc: 0.966 Test Loss: 0.149 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.757591724395752
Epoch: 13, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 8.567375421524048
Epoch: 14, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 8.031928539276123
Epoch: 15, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.976322 --> -0.979804).  Saving model ...
Epoch: 16 cost time: 7.780543565750122
Epoch: 16, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 8.909231901168823
Epoch: 17, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.120 Vali Acc: 0.960 Test Loss: 0.120 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.653116941452026
Epoch: 18, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 8.116005897521973
Epoch: 19, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 9.549781084060669
Epoch: 20, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.201 Vali Acc: 0.937 Test Loss: 0.201 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 9.317262649536133
Epoch: 21, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.091 Vali Acc: 0.974 Test Loss: 0.091 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 8.296037912368774
Epoch: 22, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.106 Vali Acc: 0.969 Test Loss: 0.106 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 8.223755359649658
Epoch: 23, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.133 Vali Acc: 0.960 Test Loss: 0.133 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 7.5336363315582275
Epoch: 24, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.116 Vali Acc: 0.967 Test Loss: 0.116 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 8.383340835571289
Epoch: 25, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 1422532
model size : 6.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.071420669555664
Epoch: 1, Steps: 89 | Train Loss: 2.559 Vali Loss: 1.523 Vali Acc: 0.680 Test Loss: 1.523 Test Acc: 0.680
Validation loss decreased (inf --> -0.679651).  Saving model ...
Epoch: 2 cost time: 6.71895170211792
Epoch: 2, Steps: 89 | Train Loss: 0.939 Vali Loss: 0.528 Vali Acc: 0.896 Test Loss: 0.528 Test Acc: 0.896
Validation loss decreased (-0.679651 --> -0.895538).  Saving model ...
Epoch: 3 cost time: 6.934770107269287
Epoch: 3, Steps: 89 | Train Loss: 0.412 Vali Loss: 0.308 Vali Acc: 0.930 Test Loss: 0.308 Test Acc: 0.930
Validation loss decreased (-0.895538 --> -0.929663).  Saving model ...
Epoch: 4 cost time: 7.080693483352661
Epoch: 4, Steps: 89 | Train Loss: 0.261 Vali Loss: 0.197 Vali Acc: 0.957 Test Loss: 0.197 Test Acc: 0.957
Validation loss decreased (-0.929663 --> -0.956823).  Saving model ...
Epoch: 5 cost time: 6.98091459274292
Epoch: 5, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.155 Vali Acc: 0.960 Test Loss: 0.155 Test Acc: 0.960
Validation loss decreased (-0.956823 --> -0.960305).  Saving model ...
Epoch: 6 cost time: 7.158926486968994
Epoch: 6, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.194 Vali Acc: 0.948 Test Loss: 0.194 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.469933986663818
Epoch: 7, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.149 Vali Acc: 0.961 Test Loss: 0.149 Test Acc: 0.961
Validation loss decreased (-0.960305 --> -0.961001).  Saving model ...
Epoch: 8 cost time: 7.164492607116699
Epoch: 8, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.961001 --> -0.972840).  Saving model ...
Epoch: 9 cost time: 7.0381200313568115
Epoch: 9, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.112 Vali Acc: 0.972 Test Loss: 0.112 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.130368232727051
Epoch: 10, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.972840 --> -0.972840).  Saving model ...
Epoch: 11 cost time: 6.772719621658325
Epoch: 11, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.976322).  Saving model ...
Epoch: 12 cost time: 7.466116905212402
Epoch: 12, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.105 Vali Acc: 0.969 Test Loss: 0.105 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.890248775482178
Epoch: 13, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.496484756469727
Epoch: 14, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.061 Vali Acc: 0.980 Test Loss: 0.061 Test Acc: 0.980
Validation loss decreased (-0.976322 --> -0.979804).  Saving model ...
Epoch: 15 cost time: 7.079243421554565
Epoch: 15, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.111 Vali Acc: 0.967 Test Loss: 0.111 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.38817024230957
Epoch: 16, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.249 Vali Acc: 0.916 Test Loss: 0.249 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.196395397186279
Epoch: 17, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.075 Vali Acc: 0.971 Test Loss: 0.075 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 7.518665552139282
Epoch: 18, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.066 Vali Acc: 0.977 Test Loss: 0.066 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 7.173018217086792
Epoch: 19, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.108 Vali Acc: 0.972 Test Loss: 0.108 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 7.824289321899414
Epoch: 20, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.132 Vali Acc: 0.963 Test Loss: 0.132 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 7.2165093421936035
Epoch: 21, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.121 Vali Acc: 0.963 Test Loss: 0.121 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 7.905855178833008
Epoch: 22, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.133 Vali Acc: 0.964 Test Loss: 0.133 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 7.060948610305786
Epoch: 23, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.109 Vali Acc: 0.967 Test Loss: 0.109 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 7.236845970153809
Epoch: 24, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 1420740
model size : 6.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.108304738998413
Epoch: 1, Steps: 89 | Train Loss: 2.539 Vali Loss: 1.523 Vali Acc: 0.627 Test Loss: 1.523 Test Acc: 0.627
Validation loss decreased (inf --> -0.627422).  Saving model ...
Epoch: 2 cost time: 7.795839786529541
Epoch: 2, Steps: 89 | Train Loss: 0.961 Vali Loss: 0.635 Vali Acc: 0.868 Test Loss: 0.635 Test Acc: 0.868
Validation loss decreased (-0.627422 --> -0.867682).  Saving model ...
Epoch: 3 cost time: 8.319749116897583
Epoch: 3, Steps: 89 | Train Loss: 0.437 Vali Loss: 0.314 Vali Acc: 0.930 Test Loss: 0.314 Test Acc: 0.930
Validation loss decreased (-0.867682 --> -0.929663).  Saving model ...
Epoch: 4 cost time: 7.479946136474609
Epoch: 4, Steps: 89 | Train Loss: 0.255 Vali Loss: 0.228 Vali Acc: 0.946 Test Loss: 0.228 Test Acc: 0.946
Validation loss decreased (-0.929663 --> -0.945680).  Saving model ...
Epoch: 5 cost time: 7.765632152557373
Epoch: 5, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.945680 --> -0.958215).  Saving model ...
Epoch: 6 cost time: 8.01801586151123
Epoch: 6, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.143 Vali Acc: 0.960 Test Loss: 0.143 Test Acc: 0.960
Validation loss decreased (-0.958215 --> -0.960305).  Saving model ...
Epoch: 7 cost time: 7.522833347320557
Epoch: 7, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.111 Vali Acc: 0.964 Test Loss: 0.111 Test Acc: 0.964
Validation loss decreased (-0.960305 --> -0.964484).  Saving model ...
Epoch: 8 cost time: 8.957937002182007
Epoch: 8, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
Validation loss decreased (-0.964484 --> -0.965180).  Saving model ...
Epoch: 9 cost time: 7.62029504776001
Epoch: 9, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.115 Vali Acc: 0.969 Test Loss: 0.115 Test Acc: 0.969
Validation loss decreased (-0.965180 --> -0.969358).  Saving model ...
Epoch: 10 cost time: 9.210372924804688
Epoch: 10, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.691249132156372
Epoch: 11, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.091 Vali Acc: 0.974 Test Loss: 0.091 Test Acc: 0.974
Validation loss decreased (-0.969358 --> -0.974233).  Saving model ...
Epoch: 12 cost time: 7.292359113693237
Epoch: 12, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.100 Vali Acc: 0.964 Test Loss: 0.100 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 8.052420139312744
Epoch: 13, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 9.188685417175293
Epoch: 14, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.067 Vali Acc: 0.978 Test Loss: 0.067 Test Acc: 0.978
Validation loss decreased (-0.974233 --> -0.978412).  Saving model ...
Epoch: 15 cost time: 8.172867774963379
Epoch: 15, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.100 Vali Acc: 0.969 Test Loss: 0.100 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 8.94392704963684
Epoch: 16, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.079 Vali Acc: 0.974 Test Loss: 0.079 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 8.567285299301147
Epoch: 17, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.113 Vali Acc: 0.972 Test Loss: 0.113 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 8.707957983016968
Epoch: 18, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 8.201756477355957
Epoch: 19, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.748734951019287
Epoch: 20, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.049 Vali Acc: 0.984 Test Loss: 0.049 Test Acc: 0.984
Validation loss decreased (-0.978412 --> -0.983983).  Saving model ...
Epoch: 21 cost time: 7.10589337348938
Epoch: 21, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.097 Vali Acc: 0.972 Test Loss: 0.097 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 7.610162019729614
Epoch: 22, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.911638259887695
Epoch: 23, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.077 Vali Acc: 0.975 Test Loss: 0.077 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 8.379969835281372
Epoch: 24, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 8.466459274291992
Epoch: 25, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 7.864224195480347
Epoch: 26, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 7.482125997543335
Epoch: 27, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 7.400813579559326
Epoch: 28, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 8.470664262771606
Epoch: 29, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.109 Vali Acc: 0.972 Test Loss: 0.109 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 7.662370920181274
Epoch: 30, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 963780
model size : 5.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.122855424880981
Epoch: 1, Steps: 89 | Train Loss: 2.609 Vali Loss: 1.616 Vali Acc: 0.653 Test Loss: 1.616 Test Acc: 0.653
Validation loss decreased (inf --> -0.653187).  Saving model ...
Epoch: 2 cost time: 7.937921524047852
Epoch: 2, Steps: 89 | Train Loss: 0.965 Vali Loss: 0.583 Vali Acc: 0.862 Test Loss: 0.583 Test Acc: 0.862
Validation loss decreased (-0.653187 --> -0.862111).  Saving model ...
Epoch: 3 cost time: 7.539001703262329
Epoch: 3, Steps: 89 | Train Loss: 0.423 Vali Loss: 0.344 Vali Acc: 0.912 Test Loss: 0.344 Test Acc: 0.912
Validation loss decreased (-0.862111 --> -0.912253).  Saving model ...
Epoch: 4 cost time: 7.913645029067993
Epoch: 4, Steps: 89 | Train Loss: 0.275 Vali Loss: 0.272 Vali Acc: 0.925 Test Loss: 0.272 Test Acc: 0.925
Validation loss decreased (-0.912253 --> -0.924788).  Saving model ...
Epoch: 5 cost time: 8.115227460861206
Epoch: 5, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.162 Vali Acc: 0.956 Test Loss: 0.162 Test Acc: 0.956
Validation loss decreased (-0.924788 --> -0.956127).  Saving model ...
Epoch: 6 cost time: 7.255375146865845
Epoch: 6, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
Validation loss decreased (-0.956127 --> -0.967269).  Saving model ...
Epoch: 7 cost time: 7.203905820846558
Epoch: 7, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.138 Vali Acc: 0.961 Test Loss: 0.138 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.309872150421143
Epoch: 8, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.137 Vali Acc: 0.965 Test Loss: 0.137 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.183507442474365
Epoch: 9, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.126 Vali Acc: 0.963 Test Loss: 0.126 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.75337028503418
Epoch: 10, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.967269 --> -0.977019).  Saving model ...
Epoch: 11 cost time: 8.034686803817749
Epoch: 11, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.065816402435303
Epoch: 12, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.076 Vali Acc: 0.974 Test Loss: 0.076 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.735940933227539
Epoch: 13, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.977019 --> -0.979804).  Saving model ...
Epoch: 14 cost time: 7.251049757003784
Epoch: 14, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.115303993225098
Epoch: 15, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.884143114089966
Epoch: 16, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.151683568954468
Epoch: 17, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 7.550526142120361
Epoch: 18, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.063 Vali Acc: 0.978 Test Loss: 0.063 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 7.45862603187561
Epoch: 19, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980501).  Saving model ...
Epoch: 20 cost time: 8.091913223266602
Epoch: 20, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.173 Vali Acc: 0.957 Test Loss: 0.173 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 7.52211856842041
Epoch: 21, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 7.226987600326538
Epoch: 22, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.089 Vali Acc: 0.974 Test Loss: 0.089 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 7.499343633651733
Epoch: 23, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.118 Vali Acc: 0.960 Test Loss: 0.118 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 7.879887580871582
Epoch: 24, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.072 Vali Acc: 0.972 Test Loss: 0.072 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 7.483974456787109
Epoch: 25, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.105 Vali Acc: 0.971 Test Loss: 0.105 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 7.120678663253784
Epoch: 26, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 7.944436550140381
Epoch: 27, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 8.181681394577026
Epoch: 28, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 8.12761640548706
Epoch: 29, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 961988
model size : 5.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.968228578567505
Epoch: 1, Steps: 89 | Train Loss: 2.621 Vali Loss: 1.684 Vali Acc: 0.620 Test Loss: 1.684 Test Acc: 0.620
Validation loss decreased (inf --> -0.619760).  Saving model ...
Epoch: 2 cost time: 7.466378211975098
Epoch: 2, Steps: 89 | Train Loss: 1.049 Vali Loss: 0.606 Vali Acc: 0.865 Test Loss: 0.606 Test Acc: 0.865
Validation loss decreased (-0.619760 --> -0.864896).  Saving model ...
Epoch: 3 cost time: 7.913668870925903
Epoch: 3, Steps: 89 | Train Loss: 0.494 Vali Loss: 0.362 Vali Acc: 0.918 Test Loss: 0.362 Test Acc: 0.918
Validation loss decreased (-0.864896 --> -0.917824).  Saving model ...
Epoch: 4 cost time: 7.5786333084106445
Epoch: 4, Steps: 89 | Train Loss: 0.293 Vali Loss: 0.287 Vali Acc: 0.923 Test Loss: 0.287 Test Acc: 0.923
Validation loss decreased (-0.917824 --> -0.923395).  Saving model ...
Epoch: 5 cost time: 7.538244009017944
Epoch: 5, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.225 Vali Acc: 0.936 Test Loss: 0.225 Test Acc: 0.936
Validation loss decreased (-0.923395 --> -0.935931).  Saving model ...
Epoch: 6 cost time: 7.388705015182495
Epoch: 6, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
Validation loss decreased (-0.935931 --> -0.965180).  Saving model ...
Epoch: 7 cost time: 7.376727342605591
Epoch: 7, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.154 Vali Acc: 0.955 Test Loss: 0.154 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.1715991497039795
Epoch: 8, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.129 Vali Acc: 0.966 Test Loss: 0.129 Test Acc: 0.966
Validation loss decreased (-0.965180 --> -0.965876).  Saving model ...
Epoch: 9 cost time: 6.776261329650879
Epoch: 9, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.9201765060424805
Epoch: 10, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.072 Vali Acc: 0.976 Test Loss: 0.072 Test Acc: 0.976
Validation loss decreased (-0.965876 --> -0.976322).  Saving model ...
Epoch: 11 cost time: 7.412290573120117
Epoch: 11, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.088 Vali Acc: 0.975 Test Loss: 0.088 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.273815155029297
Epoch: 12, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.127 Vali Acc: 0.960 Test Loss: 0.127 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 8.151572227478027
Epoch: 13, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.684794664382935
Epoch: 14, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.095 Vali Acc: 0.971 Test Loss: 0.095 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 7.942451000213623
Epoch: 15, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.415491342544556
Epoch: 16, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.213 Vali Acc: 0.928 Test Loss: 0.213 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 7.401214122772217
Epoch: 17, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.123 Vali Acc: 0.963 Test Loss: 0.123 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 7.442720651626587
Epoch: 18, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.977715).  Saving model ...
Epoch: 19 cost time: 7.38327169418335
Epoch: 19, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 7.698886394500732
Epoch: 20, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.106 Vali Acc: 0.967 Test Loss: 0.106 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 7.603952169418335
Epoch: 21, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 7.50980019569397
Epoch: 22, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.062 Vali Acc: 0.981 Test Loss: 0.062 Test Acc: 0.981
Validation loss decreased (-0.977715 --> -0.980501).  Saving model ...
Epoch: 23 cost time: 7.281316041946411
Epoch: 23, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.051 Vali Acc: 0.985 Test Loss: 0.051 Test Acc: 0.985
Validation loss decreased (-0.980501 --> -0.985376).  Saving model ...
Epoch: 24 cost time: 7.8565027713775635
Epoch: 24, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 7.042754888534546
Epoch: 25, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 8.240176677703857
Epoch: 26, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 7.4739670753479
Epoch: 27, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.125 Vali Acc: 0.969 Test Loss: 0.125 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 8.20906686782837
Epoch: 28, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 8.420983791351318
Epoch: 29, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.127 Vali Acc: 0.967 Test Loss: 0.127 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 7.558410167694092
Epoch: 30, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 8.16000509262085
Epoch: 31, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.165 Vali Acc: 0.957 Test Loss: 0.165 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 7.039305925369263
Epoch: 32, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.116 Vali Acc: 0.967 Test Loss: 0.116 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 8.362504959106445
Epoch: 33, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 960196
model size : 5.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.606924533843994
Epoch: 1, Steps: 89 | Train Loss: 2.616 Vali Loss: 1.633 Vali Acc: 0.633 Test Loss: 1.633 Test Acc: 0.633
Validation loss decreased (inf --> -0.632992).  Saving model ...
Epoch: 2 cost time: 7.361553430557251
Epoch: 2, Steps: 89 | Train Loss: 0.999 Vali Loss: 0.578 Vali Acc: 0.875 Test Loss: 0.578 Test Acc: 0.875
Validation loss decreased (-0.632992 --> -0.875342).  Saving model ...
Epoch: 3 cost time: 7.62597393989563
Epoch: 3, Steps: 89 | Train Loss: 0.458 Vali Loss: 0.357 Vali Acc: 0.927 Test Loss: 0.357 Test Acc: 0.927
Validation loss decreased (-0.875342 --> -0.926877).  Saving model ...
Epoch: 4 cost time: 7.006919622421265
Epoch: 4, Steps: 89 | Train Loss: 0.280 Vali Loss: 0.249 Vali Acc: 0.926 Test Loss: 0.249 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.02830719947815
Epoch: 5, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.185 Vali Acc: 0.953 Test Loss: 0.185 Test Acc: 0.953
Validation loss decreased (-0.926877 --> -0.952644).  Saving model ...
Epoch: 6 cost time: 7.504913806915283
Epoch: 6, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.180 Vali Acc: 0.953 Test Loss: 0.180 Test Acc: 0.953
Validation loss decreased (-0.952644 --> -0.952644).  Saving model ...
Epoch: 7 cost time: 6.82958984375
Epoch: 7, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.120 Vali Acc: 0.964 Test Loss: 0.120 Test Acc: 0.964
Validation loss decreased (-0.952644 --> -0.963787).  Saving model ...
Epoch: 8 cost time: 8.122623205184937
Epoch: 8, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
Validation loss decreased (-0.963787 --> -0.970055).  Saving model ...
Epoch: 9 cost time: 6.969328165054321
Epoch: 9, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.384262800216675
Epoch: 10, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.937842130661011
Epoch: 11, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.139 Vali Acc: 0.960 Test Loss: 0.139 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.474120378494263
Epoch: 12, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.131 Vali Acc: 0.964 Test Loss: 0.131 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.336725473403931
Epoch: 13, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.091 Vali Acc: 0.974 Test Loss: 0.091 Test Acc: 0.974
Validation loss decreased (-0.970055 --> -0.974233).  Saving model ...
Epoch: 14 cost time: 7.0490851402282715
Epoch: 14, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.086 Vali Acc: 0.974 Test Loss: 0.086 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.400331974029541
Epoch: 15, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.626014471054077
Epoch: 16, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
Validation loss decreased (-0.974233 --> -0.977715).  Saving model ...
Epoch: 17 cost time: 7.638942003250122
Epoch: 17, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 7.26768684387207
Epoch: 18, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.092 Vali Acc: 0.971 Test Loss: 0.092 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 7.169964790344238
Epoch: 19, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 7.1430511474609375
Epoch: 20, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
Validation loss decreased (-0.977715 --> -0.981197).  Saving model ...
Epoch: 21 cost time: 7.129835367202759
Epoch: 21, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.107 Vali Acc: 0.972 Test Loss: 0.107 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.780596017837524
Epoch: 22, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 7.339245080947876
Epoch: 23, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 7.680498838424683
Epoch: 24, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.982590).  Saving model ...
Epoch: 25 cost time: 7.753873348236084
Epoch: 25, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.054 Vali Acc: 0.983 Test Loss: 0.054 Test Acc: 0.983
Validation loss decreased (-0.982590 --> -0.983286).  Saving model ...
Epoch: 26 cost time: 7.8468310832977295
Epoch: 26, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.063 Vali Acc: 0.981 Test Loss: 0.063 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 7.290799617767334
Epoch: 27, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.152 Vali Acc: 0.960 Test Loss: 0.152 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 7.807996988296509
Epoch: 28, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.114 Vali Acc: 0.966 Test Loss: 0.114 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 7.13897180557251
Epoch: 29, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 7.3291075229644775
Epoch: 30, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 7.441036701202393
Epoch: 31, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 7.344683885574341
Epoch: 32, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 7.429010629653931
Epoch: 33, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 6.583695411682129
Epoch: 34, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 7.163811206817627
Epoch: 35, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 958404
model size : 5.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.193551778793335
Epoch: 1, Steps: 89 | Train Loss: 2.761 Vali Loss: 1.974 Vali Acc: 0.527 Test Loss: 1.974 Test Acc: 0.527
Validation loss decreased (inf --> -0.527139).  Saving model ...
Epoch: 2 cost time: 6.732181072235107
Epoch: 2, Steps: 89 | Train Loss: 1.194 Vali Loss: 0.665 Vali Acc: 0.834 Test Loss: 0.665 Test Acc: 0.834
Validation loss decreased (-0.527139 --> -0.833559).  Saving model ...
Epoch: 3 cost time: 7.077948093414307
Epoch: 3, Steps: 89 | Train Loss: 0.491 Vali Loss: 0.423 Vali Acc: 0.869 Test Loss: 0.423 Test Acc: 0.869
Validation loss decreased (-0.833559 --> -0.869077).  Saving model ...
Epoch: 4 cost time: 7.690432071685791
Epoch: 4, Steps: 89 | Train Loss: 0.312 Vali Loss: 0.240 Vali Acc: 0.943 Test Loss: 0.240 Test Acc: 0.943
Validation loss decreased (-0.869077 --> -0.942895).  Saving model ...
Epoch: 5 cost time: 7.4387195110321045
Epoch: 5, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.167 Vali Acc: 0.959 Test Loss: 0.167 Test Acc: 0.959
Validation loss decreased (-0.942895 --> -0.958912).  Saving model ...
Epoch: 6 cost time: 7.193798065185547
Epoch: 6, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
Validation loss decreased (-0.958912 --> -0.967965).  Saving model ...
Epoch: 7 cost time: 7.6150476932525635
Epoch: 7, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.123 Vali Acc: 0.966 Test Loss: 0.123 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.55973219871521
Epoch: 8, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.1859450340271
Epoch: 9, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
Validation loss decreased (-0.967965 --> -0.977715).  Saving model ...
Epoch: 10 cost time: 7.287903547286987
Epoch: 10, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.132 Vali Acc: 0.964 Test Loss: 0.132 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.504073858261108
Epoch: 11, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.578941583633423
Epoch: 12, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.977715 --> -0.979804).  Saving model ...
Epoch: 13 cost time: 7.586421489715576
Epoch: 13, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.049445390701294
Epoch: 14, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.058 Vali Acc: 0.983 Test Loss: 0.058 Test Acc: 0.983
Validation loss decreased (-0.979804 --> -0.982590).  Saving model ...
Epoch: 15 cost time: 7.409663200378418
Epoch: 15, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.566256761550903
Epoch: 16, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.336760997772217
Epoch: 17, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.083 Vali Acc: 0.974 Test Loss: 0.083 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 7.339078903198242
Epoch: 18, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 8.122888565063477
Epoch: 19, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.079 Vali Acc: 0.982 Test Loss: 0.079 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 7.438210487365723
Epoch: 20, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 7.567425966262817
Epoch: 21, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 7.247209310531616
Epoch: 22, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.110 Vali Acc: 0.972 Test Loss: 0.110 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 8.13494610786438
Epoch: 23, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.080 Vali Acc: 0.975 Test Loss: 0.080 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 7.64298152923584
Epoch: 24, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 732612
model size : 4.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.79112434387207
Epoch: 1, Steps: 89 | Train Loss: 2.674 Vali Loss: 1.834 Vali Acc: 0.527 Test Loss: 1.834 Test Acc: 0.527
Validation loss decreased (inf --> -0.527140).  Saving model ...
Epoch: 2 cost time: 8.905635833740234
Epoch: 2, Steps: 89 | Train Loss: 1.107 Vali Loss: 0.654 Vali Acc: 0.809 Test Loss: 0.654 Test Acc: 0.809
Validation loss decreased (-0.527140 --> -0.809186).  Saving model ...
Epoch: 3 cost time: 7.503413915634155
Epoch: 3, Steps: 89 | Train Loss: 0.484 Vali Loss: 0.385 Vali Acc: 0.914 Test Loss: 0.385 Test Acc: 0.914
Validation loss decreased (-0.809186 --> -0.913645).  Saving model ...
Epoch: 4 cost time: 7.6754469871521
Epoch: 4, Steps: 89 | Train Loss: 0.294 Vali Loss: 0.242 Vali Acc: 0.933 Test Loss: 0.242 Test Acc: 0.933
Validation loss decreased (-0.913645 --> -0.933145).  Saving model ...
Epoch: 5 cost time: 8.312131404876709
Epoch: 5, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.215 Vali Acc: 0.937 Test Loss: 0.215 Test Acc: 0.937
Validation loss decreased (-0.933145 --> -0.937324).  Saving model ...
Epoch: 6 cost time: 8.045651197433472
Epoch: 6, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
Validation loss decreased (-0.937324 --> -0.962394).  Saving model ...
Epoch: 7 cost time: 7.957025051116943
Epoch: 7, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.115 Vali Acc: 0.967 Test Loss: 0.115 Test Acc: 0.967
Validation loss decreased (-0.962394 --> -0.966573).  Saving model ...
Epoch: 8 cost time: 7.5319647789001465
Epoch: 8, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
Validation loss decreased (-0.966573 --> -0.974233).  Saving model ...
Epoch: 9 cost time: 7.2996673583984375
Epoch: 9, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.3116614818573
Epoch: 10, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.088 Vali Acc: 0.974 Test Loss: 0.088 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 9.493945360183716
Epoch: 11, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 8.75666332244873
Epoch: 12, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 8.90396523475647
Epoch: 13, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.114 Vali Acc: 0.966 Test Loss: 0.114 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 9.245993375778198
Epoch: 14, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.974233 --> -0.977019).  Saving model ...
Epoch: 15 cost time: 7.594935655593872
Epoch: 15, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.123 Vali Acc: 0.960 Test Loss: 0.123 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.955254316329956
Epoch: 16, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
Validation loss decreased (-0.977019 --> -0.980501).  Saving model ...
Epoch: 17 cost time: 8.583436965942383
Epoch: 17, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 7.566594123840332
Epoch: 18, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.085 Vali Acc: 0.974 Test Loss: 0.085 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 7.876286506652832
Epoch: 19, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 8.15963625907898
Epoch: 20, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 7.2160961627960205
Epoch: 21, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
Validation loss decreased (-0.980501 --> -0.980501).  Saving model ...
Epoch: 22 cost time: 7.315638542175293
Epoch: 22, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.071 Vali Acc: 0.982 Test Loss: 0.071 Test Acc: 0.982
Validation loss decreased (-0.980501 --> -0.981893).  Saving model ...
Epoch: 23 cost time: 6.743714094161987
Epoch: 23, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.064 Vali Acc: 0.982 Test Loss: 0.064 Test Acc: 0.982
Validation loss decreased (-0.981893 --> -0.981894).  Saving model ...
Epoch: 24 cost time: 8.061593770980835
Epoch: 24, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.981894 --> -0.982590).  Saving model ...
Epoch: 25 cost time: 8.298108100891113
Epoch: 25, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.121 Vali Acc: 0.963 Test Loss: 0.121 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 7.760650396347046
Epoch: 26, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 7.7192089557647705
Epoch: 27, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.172 Vali Acc: 0.952 Test Loss: 0.172 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 7.87397575378418
Epoch: 28, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.103 Vali Acc: 0.972 Test Loss: 0.103 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 6.689408302307129
Epoch: 29, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 7.53245210647583
Epoch: 30, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.066 Vali Acc: 0.981 Test Loss: 0.066 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 7.353153467178345
Epoch: 31, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 7.861888408660889
Epoch: 32, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 7.711909055709839
Epoch: 33, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 7.138504266738892
Epoch: 34, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 730820
model size : 4.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.434408187866211
Epoch: 1, Steps: 89 | Train Loss: 2.626 Vali Loss: 1.741 Vali Acc: 0.605 Test Loss: 1.741 Test Acc: 0.605
Validation loss decreased (inf --> -0.605136).  Saving model ...
Epoch: 2 cost time: 7.000844955444336
Epoch: 2, Steps: 89 | Train Loss: 1.098 Vali Loss: 0.623 Vali Acc: 0.864 Test Loss: 0.623 Test Acc: 0.864
Validation loss decreased (-0.605136 --> -0.864200).  Saving model ...
Epoch: 3 cost time: 6.771153211593628
Epoch: 3, Steps: 89 | Train Loss: 0.492 Vali Loss: 0.382 Vali Acc: 0.884 Test Loss: 0.382 Test Acc: 0.884
Validation loss decreased (-0.864200 --> -0.883701).  Saving model ...
Epoch: 4 cost time: 7.6543638706207275
Epoch: 4, Steps: 89 | Train Loss: 0.315 Vali Loss: 0.233 Vali Acc: 0.946 Test Loss: 0.233 Test Acc: 0.946
Validation loss decreased (-0.883701 --> -0.946377).  Saving model ...
Epoch: 5 cost time: 7.400637626647949
Epoch: 5, Steps: 89 | Train Loss: 0.192 Vali Loss: 0.178 Vali Acc: 0.963 Test Loss: 0.178 Test Acc: 0.963
Validation loss decreased (-0.946377 --> -0.963090).  Saving model ...
Epoch: 6 cost time: 7.035087823867798
Epoch: 6, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
Validation loss decreased (-0.963090 --> -0.966572).  Saving model ...
Epoch: 7 cost time: 7.446674823760986
Epoch: 7, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.154 Vali Acc: 0.960 Test Loss: 0.154 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.939849138259888
Epoch: 8, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.109 Vali Acc: 0.969 Test Loss: 0.109 Test Acc: 0.969
Validation loss decreased (-0.966572 --> -0.968662).  Saving model ...
Epoch: 9 cost time: 6.773344039916992
Epoch: 9, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.235 Vali Acc: 0.935 Test Loss: 0.235 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.583612442016602
Epoch: 10, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
Validation loss decreased (-0.968662 --> -0.970055).  Saving model ...
Epoch: 11 cost time: 7.238673210144043
Epoch: 11, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.309899091720581
Epoch: 12, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
Validation loss decreased (-0.970055 --> -0.976322).  Saving model ...
Epoch: 13 cost time: 6.893735647201538
Epoch: 13, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.8166303634643555
Epoch: 14, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.977715).  Saving model ...
Epoch: 15 cost time: 7.51971697807312
Epoch: 15, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.180388450622559
Epoch: 16, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
Validation loss decreased (-0.977715 --> -0.980501).  Saving model ...
Epoch: 17 cost time: 7.581766605377197
Epoch: 17, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.078 Vali Acc: 0.975 Test Loss: 0.078 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 8.321031093597412
Epoch: 18, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 7.098836660385132
Epoch: 19, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.058 Vali Acc: 0.986 Test Loss: 0.058 Test Acc: 0.986
Validation loss decreased (-0.980501 --> -0.986072).  Saving model ...
Epoch: 20 cost time: 7.596212148666382
Epoch: 20, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.061 Vali Acc: 0.985 Test Loss: 0.061 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 8.043367624282837
Epoch: 21, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 7.678460121154785
Epoch: 22, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.086 Vali Acc: 0.971 Test Loss: 0.086 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 8.282820701599121
Epoch: 23, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 7.1878273487091064
Epoch: 24, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 6.823171377182007
Epoch: 25, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.057 Vali Acc: 0.984 Test Loss: 0.057 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 7.170976400375366
Epoch: 26, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 7.780567407608032
Epoch: 27, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 7.137723207473755
Epoch: 28, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 7.359703779220581
Epoch: 29, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 729028
model size : 4.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.117998600006104
Epoch: 1, Steps: 89 | Train Loss: 2.693 Vali Loss: 1.830 Vali Acc: 0.577 Test Loss: 1.830 Test Acc: 0.577
Validation loss decreased (inf --> -0.576583).  Saving model ...
Epoch: 2 cost time: 6.297584056854248
Epoch: 2, Steps: 89 | Train Loss: 1.091 Vali Loss: 0.606 Vali Acc: 0.828 Test Loss: 0.606 Test Acc: 0.828
Validation loss decreased (-0.576583 --> -0.827988).  Saving model ...
Epoch: 3 cost time: 6.702263116836548
Epoch: 3, Steps: 89 | Train Loss: 0.474 Vali Loss: 0.332 Vali Acc: 0.925 Test Loss: 0.332 Test Acc: 0.925
Validation loss decreased (-0.827988 --> -0.925484).  Saving model ...
Epoch: 4 cost time: 6.224529266357422
Epoch: 4, Steps: 89 | Train Loss: 0.275 Vali Loss: 0.207 Vali Acc: 0.948 Test Loss: 0.207 Test Acc: 0.948
Validation loss decreased (-0.925484 --> -0.947770).  Saving model ...
Epoch: 5 cost time: 6.360549449920654
Epoch: 5, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
Validation loss decreased (-0.947770 --> -0.957519).  Saving model ...
Epoch: 6 cost time: 6.640319347381592
Epoch: 6, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
Validation loss decreased (-0.957519 --> -0.967269).  Saving model ...
Epoch: 7 cost time: 7.335967779159546
Epoch: 7, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.144 Vali Acc: 0.955 Test Loss: 0.144 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.001997232437134
Epoch: 8, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.967269 --> -0.972840).  Saving model ...
Epoch: 9 cost time: 6.318857192993164
Epoch: 9, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.972840 --> -0.977019).  Saving model ...
Epoch: 10 cost time: 7.247662782669067
Epoch: 10, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.108 Vali Acc: 0.963 Test Loss: 0.108 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.634493112564087
Epoch: 11, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.157 Vali Acc: 0.955 Test Loss: 0.157 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.655471563339233
Epoch: 12, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.877989768981934
Epoch: 13, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.078 Vali Acc: 0.979 Test Loss: 0.078 Test Acc: 0.979
Validation loss decreased (-0.977019 --> -0.979108).  Saving model ...
Epoch: 14 cost time: 6.834867477416992
Epoch: 14, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.072 Vali Acc: 0.982 Test Loss: 0.072 Test Acc: 0.982
Validation loss decreased (-0.979108 --> -0.981893).  Saving model ...
Epoch: 15 cost time: 6.988152265548706
Epoch: 15, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.912046432495117
Epoch: 16, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.067 Vali Acc: 0.984 Test Loss: 0.067 Test Acc: 0.984
Validation loss decreased (-0.981893 --> -0.983983).  Saving model ...
Epoch: 17 cost time: 6.891913414001465
Epoch: 17, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.111 Vali Acc: 0.964 Test Loss: 0.111 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.597428321838379
Epoch: 18, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.4802703857421875
Epoch: 19, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.960336923599243
Epoch: 20, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.57238245010376
Epoch: 21, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.096 Vali Acc: 0.969 Test Loss: 0.096 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.3845179080963135
Epoch: 22, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 7.028308153152466
Epoch: 23, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 6.475924253463745
Epoch: 24, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 6.781208038330078
Epoch: 25, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 6.194272994995117
Epoch: 26, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.062 Vali Acc: 0.980 Test Loss: 0.062 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 727236
model size : 4.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.210469722747803
Epoch: 1, Steps: 89 | Train Loss: 2.712 Vali Loss: 1.890 Vali Acc: 0.606 Test Loss: 1.890 Test Acc: 0.606
Validation loss decreased (inf --> -0.605831).  Saving model ...
Epoch: 2 cost time: 7.549173355102539
Epoch: 2, Steps: 89 | Train Loss: 1.130 Vali Loss: 0.642 Vali Acc: 0.859 Test Loss: 0.642 Test Acc: 0.859
Validation loss decreased (-0.605831 --> -0.858629).  Saving model ...
Epoch: 3 cost time: 6.9325714111328125
Epoch: 3, Steps: 89 | Train Loss: 0.463 Vali Loss: 0.361 Vali Acc: 0.921 Test Loss: 0.361 Test Acc: 0.921
Validation loss decreased (-0.858629 --> -0.921306).  Saving model ...
Epoch: 4 cost time: 6.972526550292969
Epoch: 4, Steps: 89 | Train Loss: 0.279 Vali Loss: 0.226 Vali Acc: 0.946 Test Loss: 0.226 Test Acc: 0.946
Validation loss decreased (-0.921306 --> -0.946377).  Saving model ...
Epoch: 5 cost time: 6.748367071151733
Epoch: 5, Steps: 89 | Train Loss: 0.197 Vali Loss: 0.171 Vali Acc: 0.962 Test Loss: 0.171 Test Acc: 0.962
Validation loss decreased (-0.946377 --> -0.961697).  Saving model ...
Epoch: 6 cost time: 6.3426673412323
Epoch: 6, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.182 Vali Acc: 0.942 Test Loss: 0.182 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.637704610824585
Epoch: 7, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
Validation loss decreased (-0.961697 --> -0.966573).  Saving model ...
Epoch: 8 cost time: 6.801962852478027
Epoch: 8, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.122 Vali Acc: 0.964 Test Loss: 0.122 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.401277542114258
Epoch: 9, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.186 Vali Acc: 0.937 Test Loss: 0.186 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.073974370956421
Epoch: 10, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.109 Vali Acc: 0.964 Test Loss: 0.109 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.097579717636108
Epoch: 11, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.094 Vali Acc: 0.974 Test Loss: 0.094 Test Acc: 0.974
Validation loss decreased (-0.966573 --> -0.974233).  Saving model ...
Epoch: 12 cost time: 6.9249796867370605
Epoch: 12, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.66672945022583
Epoch: 13, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
Validation loss decreased (-0.974233 --> -0.978412).  Saving model ...
Epoch: 14 cost time: 5.855342626571655
Epoch: 14, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.092 Vali Acc: 0.972 Test Loss: 0.092 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.8636651039123535
Epoch: 15, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.978412 --> -0.979804).  Saving model ...
Epoch: 16 cost time: 6.792767286300659
Epoch: 16, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.087 Vali Acc: 0.971 Test Loss: 0.087 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.943581581115723
Epoch: 17, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.25897741317749
Epoch: 18, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.553104877471924
Epoch: 19, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.114 Vali Acc: 0.964 Test Loss: 0.114 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.574021339416504
Epoch: 20, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.436923027038574
Epoch: 21, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.117 Vali Acc: 0.971 Test Loss: 0.117 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.467256307601929
Epoch: 22, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 6.7631072998046875
Epoch: 23, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.141 Vali Acc: 0.960 Test Loss: 0.141 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 7.028593063354492
Epoch: 24, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 6.65250563621521
Epoch: 25, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 617028
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.208645105361938
Epoch: 1, Steps: 89 | Train Loss: 2.783 Vali Loss: 2.046 Vali Acc: 0.449 Test Loss: 2.046 Test Acc: 0.449
Validation loss decreased (inf --> -0.449144).  Saving model ...
Epoch: 2 cost time: 7.114688158035278
Epoch: 2, Steps: 89 | Train Loss: 1.268 Vali Loss: 0.691 Vali Acc: 0.856 Test Loss: 0.691 Test Acc: 0.856
Validation loss decreased (-0.449144 --> -0.855843).  Saving model ...
Epoch: 3 cost time: 7.547513484954834
Epoch: 3, Steps: 89 | Train Loss: 0.523 Vali Loss: 0.357 Vali Acc: 0.908 Test Loss: 0.357 Test Acc: 0.908
Validation loss decreased (-0.855843 --> -0.908074).  Saving model ...
Epoch: 4 cost time: 7.6559367179870605
Epoch: 4, Steps: 89 | Train Loss: 0.290 Vali Loss: 0.254 Vali Acc: 0.939 Test Loss: 0.254 Test Acc: 0.939
Validation loss decreased (-0.908074 --> -0.939412).  Saving model ...
Epoch: 5 cost time: 6.82650089263916
Epoch: 5, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.150 Vali Acc: 0.963 Test Loss: 0.150 Test Acc: 0.963
Validation loss decreased (-0.939412 --> -0.963090).  Saving model ...
Epoch: 6 cost time: 7.32317042350769
Epoch: 6, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
Validation loss decreased (-0.963090 --> -0.968662).  Saving model ...
Epoch: 7 cost time: 6.982148170471191
Epoch: 7, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.134 Vali Acc: 0.964 Test Loss: 0.134 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.224193572998047
Epoch: 8, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.094 Vali Acc: 0.974 Test Loss: 0.094 Test Acc: 0.974
Validation loss decreased (-0.968662 --> -0.974233).  Saving model ...
Epoch: 9 cost time: 6.3888561725616455
Epoch: 9, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.975626).  Saving model ...
Epoch: 10 cost time: 6.298157691955566
Epoch: 10, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.071 Vali Acc: 0.979 Test Loss: 0.071 Test Acc: 0.979
Validation loss decreased (-0.975626 --> -0.979108).  Saving model ...
Epoch: 11 cost time: 6.710393190383911
Epoch: 11, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.082 Vali Acc: 0.974 Test Loss: 0.082 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.931855916976929
Epoch: 12, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.067 Vali Acc: 0.984 Test Loss: 0.067 Test Acc: 0.984
Validation loss decreased (-0.979108 --> -0.983983).  Saving model ...
Epoch: 13 cost time: 7.231635808944702
Epoch: 13, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.105 Vali Acc: 0.964 Test Loss: 0.105 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.71237587928772
Epoch: 14, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.062 Vali Acc: 0.982 Test Loss: 0.062 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.27604603767395
Epoch: 15, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.139 Vali Acc: 0.959 Test Loss: 0.139 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.619816780090332
Epoch: 16, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.185 Vali Acc: 0.946 Test Loss: 0.185 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.826735973358154
Epoch: 17, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 7.628643274307251
Epoch: 18, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.076 Vali Acc: 0.974 Test Loss: 0.076 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 7.056484937667847
Epoch: 19, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.073 Vali Acc: 0.974 Test Loss: 0.073 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 7.40224027633667
Epoch: 20, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.085 Vali Acc: 0.975 Test Loss: 0.085 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 7.581430912017822
Epoch: 21, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.110 Vali Acc: 0.967 Test Loss: 0.110 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.778763771057129
Epoch: 22, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 615236
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.138342380523682
Epoch: 1, Steps: 89 | Train Loss: 2.823 Vali Loss: 2.079 Vali Acc: 0.542 Test Loss: 2.079 Test Acc: 0.542
Validation loss decreased (inf --> -0.542458).  Saving model ...
Epoch: 2 cost time: 7.189809799194336
Epoch: 2, Steps: 89 | Train Loss: 1.193 Vali Loss: 0.632 Vali Acc: 0.862 Test Loss: 0.632 Test Acc: 0.862
Validation loss decreased (-0.542458 --> -0.862111).  Saving model ...
Epoch: 3 cost time: 6.754299879074097
Epoch: 3, Steps: 89 | Train Loss: 0.487 Vali Loss: 0.383 Vali Acc: 0.896 Test Loss: 0.383 Test Acc: 0.896
Validation loss decreased (-0.862111 --> -0.896236).  Saving model ...
Epoch: 4 cost time: 7.434490919113159
Epoch: 4, Steps: 89 | Train Loss: 0.307 Vali Loss: 0.309 Vali Acc: 0.900 Test Loss: 0.309 Test Acc: 0.900
Validation loss decreased (-0.896236 --> -0.899718).  Saving model ...
Epoch: 5 cost time: 6.745596647262573
Epoch: 5, Steps: 89 | Train Loss: 0.218 Vali Loss: 0.194 Vali Acc: 0.951 Test Loss: 0.194 Test Acc: 0.951
Validation loss decreased (-0.899718 --> -0.951252).  Saving model ...
Epoch: 6 cost time: 7.906234502792358
Epoch: 6, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.169 Vali Acc: 0.950 Test Loss: 0.169 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.862079620361328
Epoch: 7, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.127 Vali Acc: 0.967 Test Loss: 0.127 Test Acc: 0.967
Validation loss decreased (-0.951252 --> -0.966573).  Saving model ...
Epoch: 8 cost time: 6.681811809539795
Epoch: 8, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.103 Vali Acc: 0.972 Test Loss: 0.103 Test Acc: 0.972
Validation loss decreased (-0.966573 --> -0.972144).  Saving model ...
Epoch: 9 cost time: 7.327145576477051
Epoch: 9, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
Validation loss decreased (-0.972144 --> -0.974233).  Saving model ...
Epoch: 10 cost time: 6.6185407638549805
Epoch: 10, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.976322).  Saving model ...
Epoch: 11 cost time: 7.232532262802124
Epoch: 11, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.555092811584473
Epoch: 12, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.620002508163452
Epoch: 13, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.090 Vali Acc: 0.972 Test Loss: 0.090 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.459948539733887
Epoch: 14, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976322 --> -0.977019).  Saving model ...
Epoch: 15 cost time: 7.726561546325684
Epoch: 15, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.977019 --> -0.977019).  Saving model ...
Epoch: 16 cost time: 7.538005590438843
Epoch: 16, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.293596982955933
Epoch: 17, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.678153991699219
Epoch: 18, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.052 Vali Acc: 0.983 Test Loss: 0.052 Test Acc: 0.983
Validation loss decreased (-0.977019 --> -0.983286).  Saving model ...
Epoch: 19 cost time: 7.726638555526733
Epoch: 19, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 7.120328903198242
Epoch: 20, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.097 Vali Acc: 0.969 Test Loss: 0.097 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 7.740001916885376
Epoch: 21, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.104 Vali Acc: 0.969 Test Loss: 0.104 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.308965444564819
Epoch: 22, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.091 Vali Acc: 0.971 Test Loss: 0.091 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.6975181102752686
Epoch: 23, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.115 Vali Acc: 0.969 Test Loss: 0.115 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 6.663570165634155
Epoch: 24, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 6.945044279098511
Epoch: 25, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 6.940707445144653
Epoch: 26, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.121 Vali Acc: 0.971 Test Loss: 0.121 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 7.574667692184448
Epoch: 27, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 7.510267496109009
Epoch: 28, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 613444
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.568629503250122
Epoch: 1, Steps: 89 | Train Loss: 2.718 Vali Loss: 1.939 Vali Acc: 0.559 Test Loss: 1.939 Test Acc: 0.559
Validation loss decreased (inf --> -0.559173).  Saving model ...
Epoch: 2 cost time: 7.71959114074707
Epoch: 2, Steps: 89 | Train Loss: 1.156 Vali Loss: 0.647 Vali Acc: 0.849 Test Loss: 0.647 Test Acc: 0.849
Validation loss decreased (-0.559173 --> -0.848879).  Saving model ...
Epoch: 3 cost time: 7.402578592300415
Epoch: 3, Steps: 89 | Train Loss: 0.481 Vali Loss: 0.358 Vali Acc: 0.909 Test Loss: 0.358 Test Acc: 0.909
Validation loss decreased (-0.848879 --> -0.908771).  Saving model ...
Epoch: 4 cost time: 7.26448917388916
Epoch: 4, Steps: 89 | Train Loss: 0.294 Vali Loss: 0.253 Vali Acc: 0.932 Test Loss: 0.253 Test Acc: 0.932
Validation loss decreased (-0.908771 --> -0.931752).  Saving model ...
Epoch: 5 cost time: 6.8010900020599365
Epoch: 5, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
Validation loss decreased (-0.931752 --> -0.958912).  Saving model ...
Epoch: 6 cost time: 7.869566917419434
Epoch: 6, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.123 Vali Acc: 0.969 Test Loss: 0.123 Test Acc: 0.969
Validation loss decreased (-0.958912 --> -0.969358).  Saving model ...
Epoch: 7 cost time: 7.273809194564819
Epoch: 7, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.130 Vali Acc: 0.967 Test Loss: 0.130 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.112981081008911
Epoch: 8, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
Validation loss decreased (-0.969358 --> -0.978411).  Saving model ...
Epoch: 9 cost time: 7.356202840805054
Epoch: 9, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.113 Vali Acc: 0.972 Test Loss: 0.113 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.0112762451171875
Epoch: 10, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.090 Vali Acc: 0.972 Test Loss: 0.090 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.161375999450684
Epoch: 11, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.084 Vali Acc: 0.974 Test Loss: 0.084 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.242722272872925
Epoch: 12, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.101 Vali Acc: 0.969 Test Loss: 0.101 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.722508192062378
Epoch: 13, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.167564153671265
Epoch: 14, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.070 Vali Acc: 0.978 Test Loss: 0.070 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.960445404052734
Epoch: 15, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.059 Vali Acc: 0.983 Test Loss: 0.059 Test Acc: 0.983
Validation loss decreased (-0.978411 --> -0.983286).  Saving model ...
Epoch: 16 cost time: 6.51697564125061
Epoch: 16, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.068 Vali Acc: 0.979 Test Loss: 0.068 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.072178840637207
Epoch: 17, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.068 Vali Acc: 0.975 Test Loss: 0.068 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.897579193115234
Epoch: 18, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.152727842330933
Epoch: 19, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.464176893234253
Epoch: 20, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.680150032043457
Epoch: 21, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.071 Vali Acc: 0.979 Test Loss: 0.071 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.788625001907349
Epoch: 22, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.115 Vali Acc: 0.966 Test Loss: 0.115 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 6.770130157470703
Epoch: 23, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.068 Vali Acc: 0.981 Test Loss: 0.068 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 6.035990238189697
Epoch: 24, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.063 Vali Acc: 0.985 Test Loss: 0.063 Test Acc: 0.985
Validation loss decreased (-0.983286 --> -0.985375).  Saving model ...
Epoch: 25 cost time: 7.254596710205078
Epoch: 25, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.875610113143921
Epoch: 26, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.053 Vali Acc: 0.983 Test Loss: 0.053 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 7.047489643096924
Epoch: 27, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 6.760532855987549
Epoch: 28, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.141 Vali Acc: 0.963 Test Loss: 0.141 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 6.95883846282959
Epoch: 29, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.065 Vali Acc: 0.982 Test Loss: 0.065 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 6.806097507476807
Epoch: 30, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 6.731195449829102
Epoch: 31, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 6.583513259887695
Epoch: 32, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.137 Vali Acc: 0.963 Test Loss: 0.137 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 7.245954275131226
Epoch: 33, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.171 Vali Acc: 0.962 Test Loss: 0.171 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 6.584662199020386
Epoch: 34, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 611652
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.279429912567139
Epoch: 1, Steps: 89 | Train Loss: 2.770 Vali Loss: 2.063 Vali Acc: 0.526 Test Loss: 2.063 Test Acc: 0.526
Validation loss decreased (inf --> -0.525745).  Saving model ...
Epoch: 2 cost time: 6.18391752243042
Epoch: 2, Steps: 89 | Train Loss: 1.491 Vali Loss: 0.952 Vali Acc: 0.827 Test Loss: 0.952 Test Acc: 0.827
Validation loss decreased (-0.525745 --> -0.826592).  Saving model ...
Epoch: 3 cost time: 6.141122102737427
Epoch: 3, Steps: 89 | Train Loss: 0.763 Vali Loss: 0.559 Vali Acc: 0.862 Test Loss: 0.559 Test Acc: 0.862
Validation loss decreased (-0.826592 --> -0.862111).  Saving model ...
Epoch: 4 cost time: 6.27717924118042
Epoch: 4, Steps: 89 | Train Loss: 0.485 Vali Loss: 0.399 Vali Acc: 0.903 Test Loss: 0.399 Test Acc: 0.903
Validation loss decreased (-0.862111 --> -0.903199).  Saving model ...
Epoch: 5 cost time: 6.32623815536499
Epoch: 5, Steps: 89 | Train Loss: 0.326 Vali Loss: 0.279 Vali Acc: 0.937 Test Loss: 0.279 Test Acc: 0.937
Validation loss decreased (-0.903199 --> -0.937323).  Saving model ...
Epoch: 6 cost time: 6.14183783531189
Epoch: 6, Steps: 89 | Train Loss: 0.252 Vali Loss: 0.219 Vali Acc: 0.945 Test Loss: 0.219 Test Acc: 0.945
Validation loss decreased (-0.937323 --> -0.944984).  Saving model ...
Epoch: 7 cost time: 6.243423938751221
Epoch: 7, Steps: 89 | Train Loss: 0.223 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.0768046379089355
Epoch: 8, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.139 Vali Acc: 0.964 Test Loss: 0.139 Test Acc: 0.964
Validation loss decreased (-0.944984 --> -0.963787).  Saving model ...
Epoch: 9 cost time: 6.045702219009399
Epoch: 9, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.106161832809448
Epoch: 10, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.132 Vali Acc: 0.964 Test Loss: 0.132 Test Acc: 0.964
Validation loss decreased (-0.963787 --> -0.963787).  Saving model ...
Epoch: 11 cost time: 6.615901470184326
Epoch: 11, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.146 Vali Acc: 0.958 Test Loss: 0.146 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.742648124694824
Epoch: 12, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.109 Vali Acc: 0.963 Test Loss: 0.109 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.773539066314697
Epoch: 13, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.129 Vali Acc: 0.963 Test Loss: 0.129 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.419291973114014
Epoch: 14, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
Validation loss decreased (-0.963787 --> -0.973537).  Saving model ...
Epoch: 15 cost time: 6.702335596084595
Epoch: 15, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.094 Vali Acc: 0.974 Test Loss: 0.094 Test Acc: 0.974
Validation loss decreased (-0.973537 --> -0.974233).  Saving model ...
Epoch: 16 cost time: 6.883021354675293
Epoch: 16, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.958289384841919
Epoch: 17, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
Validation loss decreased (-0.974233 --> -0.974929).  Saving model ...
Epoch: 18 cost time: 6.159975051879883
Epoch: 18, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.560370922088623
Epoch: 19, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.088 Vali Acc: 0.974 Test Loss: 0.088 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.652005672454834
Epoch: 20, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.155 Vali Acc: 0.960 Test Loss: 0.155 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.2771522998809814
Epoch: 21, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.43934440612793
Epoch: 22, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.191692113876343
Epoch: 23, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
Validation loss decreased (-0.974929 --> -0.977715).  Saving model ...
Epoch: 24 cost time: 6.550990581512451
Epoch: 24, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.142 Vali Acc: 0.955 Test Loss: 0.142 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.525580167770386
Epoch: 25, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.091 Vali Acc: 0.971 Test Loss: 0.091 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.140840291976929
Epoch: 26, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.085 Vali Acc: 0.974 Test Loss: 0.085 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 6.222880840301514
Epoch: 27, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.254 Vali Acc: 0.929 Test Loss: 0.254 Test Acc: 0.929
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 6.557541370391846
Epoch: 28, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.977715 --> -0.983286).  Saving model ...
Epoch: 29 cost time: 6.527759075164795
Epoch: 29, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.24101185798645
Epoch: 30, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.097 Vali Acc: 0.972 Test Loss: 0.097 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 6.2736101150512695
Epoch: 31, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 5.898287534713745
Epoch: 32, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 6.437538385391235
Epoch: 33, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 6.8247621059417725
Epoch: 34, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 6.2849907875061035
Epoch: 35, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 6.9536566734313965
Epoch: 36, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 7.2196691036224365
Epoch: 37, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.102 Vali Acc: 0.969 Test Loss: 0.102 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 6.700906038284302
Epoch: 38, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 601988
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.68690538406372
Epoch: 1, Steps: 89 | Train Loss: 2.872 Vali Loss: 2.268 Vali Acc: 0.399 Test Loss: 2.268 Test Acc: 0.399
Validation loss decreased (inf --> -0.399002).  Saving model ...
Epoch: 2 cost time: 6.662024974822998
Epoch: 2, Steps: 89 | Train Loss: 1.585 Vali Loss: 1.013 Vali Acc: 0.770 Test Loss: 1.013 Test Acc: 0.770
Validation loss decreased (-0.399002 --> -0.770185).  Saving model ...
Epoch: 3 cost time: 5.960395812988281
Epoch: 3, Steps: 89 | Train Loss: 0.757 Vali Loss: 0.588 Vali Acc: 0.832 Test Loss: 0.588 Test Acc: 0.832
Validation loss decreased (-0.770185 --> -0.832167).  Saving model ...
Epoch: 4 cost time: 6.8627989292144775
Epoch: 4, Steps: 89 | Train Loss: 0.466 Vali Loss: 0.354 Vali Acc: 0.919 Test Loss: 0.354 Test Acc: 0.919
Validation loss decreased (-0.832167 --> -0.919217).  Saving model ...
Epoch: 5 cost time: 6.699319839477539
Epoch: 5, Steps: 89 | Train Loss: 0.308 Vali Loss: 0.260 Vali Acc: 0.937 Test Loss: 0.260 Test Acc: 0.937
Validation loss decreased (-0.919217 --> -0.937323).  Saving model ...
Epoch: 6 cost time: 6.750884294509888
Epoch: 6, Steps: 89 | Train Loss: 0.234 Vali Loss: 0.207 Vali Acc: 0.951 Test Loss: 0.207 Test Acc: 0.951
Validation loss decreased (-0.937323 --> -0.950555).  Saving model ...
Epoch: 7 cost time: 6.053142547607422
Epoch: 7, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.177 Vali Acc: 0.955 Test Loss: 0.177 Test Acc: 0.955
Validation loss decreased (-0.950555 --> -0.954734).  Saving model ...
Epoch: 8 cost time: 6.234204053878784
Epoch: 8, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
Validation loss decreased (-0.954734 --> -0.967965).  Saving model ...
Epoch: 9 cost time: 6.893102169036865
Epoch: 9, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.141402006149292
Epoch: 10, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
Validation loss decreased (-0.967965 --> -0.969358).  Saving model ...
Epoch: 11 cost time: 6.359103679656982
Epoch: 11, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.970751).  Saving model ...
Epoch: 12 cost time: 7.169291257858276
Epoch: 12, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
Validation loss decreased (-0.970751 --> -0.974929).  Saving model ...
Epoch: 13 cost time: 6.435661554336548
Epoch: 13, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.100 Vali Acc: 0.969 Test Loss: 0.100 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.701504230499268
Epoch: 14, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
Validation loss decreased (-0.974929 --> -0.981197).  Saving model ...
Epoch: 15 cost time: 7.063907861709595
Epoch: 15, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.109 Vali Acc: 0.963 Test Loss: 0.109 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.249309539794922
Epoch: 16, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.026293754577637
Epoch: 17, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.118 Vali Acc: 0.964 Test Loss: 0.118 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 7.2116076946258545
Epoch: 18, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.102 Vali Acc: 0.969 Test Loss: 0.102 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.62870192527771
Epoch: 19, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.072 Vali Acc: 0.976 Test Loss: 0.072 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.644193887710571
Epoch: 20, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.142 Vali Acc: 0.946 Test Loss: 0.142 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.840757846832275
Epoch: 21, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.122 Vali Acc: 0.963 Test Loss: 0.122 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 6.656271696090698
Epoch: 22, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 6.174264430999756
Epoch: 23, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 6.063988924026489
Epoch: 24, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 601092
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.402514457702637
Epoch: 1, Steps: 89 | Train Loss: 2.804 Vali Loss: 2.130 Vali Acc: 0.490 Test Loss: 2.130 Test Acc: 0.490
Validation loss decreased (inf --> -0.490229).  Saving model ...
Epoch: 2 cost time: 5.992150545120239
Epoch: 2, Steps: 89 | Train Loss: 1.562 Vali Loss: 1.014 Vali Acc: 0.756 Test Loss: 1.014 Test Acc: 0.756
Validation loss decreased (-0.490229 --> -0.756257).  Saving model ...
Epoch: 3 cost time: 6.62021541595459
Epoch: 3, Steps: 89 | Train Loss: 0.786 Vali Loss: 0.597 Vali Acc: 0.844 Test Loss: 0.597 Test Acc: 0.844
Validation loss decreased (-0.756257 --> -0.844005).  Saving model ...
Epoch: 4 cost time: 6.19068455696106
Epoch: 4, Steps: 89 | Train Loss: 0.485 Vali Loss: 0.422 Vali Acc: 0.890 Test Loss: 0.422 Test Acc: 0.890
Validation loss decreased (-0.844005 --> -0.889968).  Saving model ...
Epoch: 5 cost time: 6.631160497665405
Epoch: 5, Steps: 89 | Train Loss: 0.327 Vali Loss: 0.257 Vali Acc: 0.929 Test Loss: 0.257 Test Acc: 0.929
Validation loss decreased (-0.889968 --> -0.928967).  Saving model ...
Epoch: 6 cost time: 6.5214269161224365
Epoch: 6, Steps: 89 | Train Loss: 0.232 Vali Loss: 0.190 Vali Acc: 0.954 Test Loss: 0.190 Test Acc: 0.954
Validation loss decreased (-0.928967 --> -0.954037).  Saving model ...
Epoch: 7 cost time: 5.64190411567688
Epoch: 7, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.140 Vali Acc: 0.965 Test Loss: 0.140 Test Acc: 0.965
Validation loss decreased (-0.954037 --> -0.965180).  Saving model ...
Epoch: 8 cost time: 6.188738107681274
Epoch: 8, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
Validation loss decreased (-0.965180 --> -0.970054).  Saving model ...
Epoch: 9 cost time: 6.059741497039795
Epoch: 9, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
Validation loss decreased (-0.970054 --> -0.970751).  Saving model ...
Epoch: 10 cost time: 6.932226657867432
Epoch: 10, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.117 Vali Acc: 0.966 Test Loss: 0.117 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.485220670700073
Epoch: 11, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.117 Vali Acc: 0.964 Test Loss: 0.117 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.296072244644165
Epoch: 12, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.095 Vali Acc: 0.971 Test Loss: 0.095 Test Acc: 0.971
Validation loss decreased (-0.970751 --> -0.970751).  Saving model ...
Epoch: 13 cost time: 6.463648557662964
Epoch: 13, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.070 Vali Acc: 0.979 Test Loss: 0.070 Test Acc: 0.979
Validation loss decreased (-0.970751 --> -0.979108).  Saving model ...
Epoch: 14 cost time: 6.492834091186523
Epoch: 14, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.080 Vali Acc: 0.974 Test Loss: 0.080 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.293846607208252
Epoch: 15, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
Validation loss decreased (-0.979108 --> -0.979804).  Saving model ...
Epoch: 16 cost time: 6.34567666053772
Epoch: 16, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.979804 --> -0.982590).  Saving model ...
Epoch: 17 cost time: 6.229666471481323
Epoch: 17, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.103 Vali Acc: 0.967 Test Loss: 0.103 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.3584840297698975
Epoch: 18, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.866812467575073
Epoch: 19, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.076 Vali Acc: 0.975 Test Loss: 0.076 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.28314208984375
Epoch: 20, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.103851795196533
Epoch: 21, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.074 Vali Acc: 0.974 Test Loss: 0.074 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.196625709533691
Epoch: 22, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.737929582595825
Epoch: 23, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 6.231753587722778
Epoch: 24, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.058 Vali Acc: 0.984 Test Loss: 0.058 Test Acc: 0.984
Validation loss decreased (-0.982590 --> -0.983983).  Saving model ...
Epoch: 25 cost time: 6.330456256866455
Epoch: 25, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.054 Vali Acc: 0.984 Test Loss: 0.054 Test Acc: 0.984
Validation loss decreased (-0.983983 --> -0.983983).  Saving model ...
Epoch: 26 cost time: 6.049439430236816
Epoch: 26, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.070 Vali Acc: 0.979 Test Loss: 0.070 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 6.156080961227417
Epoch: 27, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.141 Vali Acc: 0.959 Test Loss: 0.141 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 6.397249937057495
Epoch: 28, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.092 Vali Acc: 0.971 Test Loss: 0.092 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 6.260113477706909
Epoch: 29, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 6.394317865371704
Epoch: 30, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.085 Vali Acc: 0.971 Test Loss: 0.085 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 5.802350044250488
Epoch: 31, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 5.814034700393677
Epoch: 32, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 6.49238657951355
Epoch: 33, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 6.205137014389038
Epoch: 34, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 6.471033573150635
Epoch: 35, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 600196
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.575005769729614
Epoch: 1, Steps: 89 | Train Loss: 2.775 Vali Loss: 2.131 Vali Acc: 0.520 Test Loss: 2.131 Test Acc: 0.520
Validation loss decreased (inf --> -0.520174).  Saving model ...
Epoch: 2 cost time: 6.0723419189453125
Epoch: 2, Steps: 89 | Train Loss: 1.557 Vali Loss: 1.004 Vali Acc: 0.813 Test Loss: 1.004 Test Acc: 0.813
Validation loss decreased (-0.520174 --> -0.813360).  Saving model ...
Epoch: 3 cost time: 6.071653604507446
Epoch: 3, Steps: 89 | Train Loss: 0.774 Vali Loss: 0.580 Vali Acc: 0.875 Test Loss: 0.580 Test Acc: 0.875
Validation loss decreased (-0.813360 --> -0.874646).  Saving model ...
Epoch: 4 cost time: 6.258625745773315
Epoch: 4, Steps: 89 | Train Loss: 0.500 Vali Loss: 0.420 Vali Acc: 0.904 Test Loss: 0.420 Test Acc: 0.904
Validation loss decreased (-0.874646 --> -0.903896).  Saving model ...
Epoch: 5 cost time: 6.303596496582031
Epoch: 5, Steps: 89 | Train Loss: 0.336 Vali Loss: 0.318 Vali Acc: 0.923 Test Loss: 0.318 Test Acc: 0.923
Validation loss decreased (-0.903896 --> -0.922699).  Saving model ...
Epoch: 6 cost time: 6.35485053062439
Epoch: 6, Steps: 89 | Train Loss: 0.239 Vali Loss: 0.220 Vali Acc: 0.935 Test Loss: 0.220 Test Acc: 0.935
Validation loss decreased (-0.922699 --> -0.934538).  Saving model ...
Epoch: 7 cost time: 5.8226752281188965
Epoch: 7, Steps: 89 | Train Loss: 0.192 Vali Loss: 0.175 Vali Acc: 0.951 Test Loss: 0.175 Test Acc: 0.951
Validation loss decreased (-0.934538 --> -0.950555).  Saving model ...
Epoch: 8 cost time: 6.5963966846466064
Epoch: 8, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.156 Vali Acc: 0.956 Test Loss: 0.156 Test Acc: 0.956
Validation loss decreased (-0.950555 --> -0.956127).  Saving model ...
Epoch: 9 cost time: 5.931425333023071
Epoch: 9, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.139 Vali Acc: 0.958 Test Loss: 0.139 Test Acc: 0.958
Validation loss decreased (-0.956127 --> -0.958216).  Saving model ...
Epoch: 10 cost time: 6.100137948989868
Epoch: 10, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.126 Vali Acc: 0.960 Test Loss: 0.126 Test Acc: 0.960
Validation loss decreased (-0.958216 --> -0.960305).  Saving model ...
Epoch: 11 cost time: 6.399443864822388
Epoch: 11, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
Validation loss decreased (-0.960305 --> -0.967965).  Saving model ...
Epoch: 12 cost time: 6.19391393661499
Epoch: 12, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
Validation loss decreased (-0.967965 --> -0.970055).  Saving model ...
Epoch: 13 cost time: 6.058276653289795
Epoch: 13, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.101 Vali Acc: 0.969 Test Loss: 0.101 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.297303199768066
Epoch: 14, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.131 Vali Acc: 0.969 Test Loss: 0.131 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.982522249221802
Epoch: 15, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.107 Vali Acc: 0.969 Test Loss: 0.107 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.256690502166748
Epoch: 16, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
Validation loss decreased (-0.970055 --> -0.980501).  Saving model ...
Epoch: 17 cost time: 5.7757039070129395
Epoch: 17, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.961747169494629
Epoch: 18, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.663780689239502
Epoch: 19, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.079 Vali Acc: 0.975 Test Loss: 0.079 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.175719261169434
Epoch: 20, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.137 Vali Acc: 0.958 Test Loss: 0.137 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.627824068069458
Epoch: 21, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.530815839767456
Epoch: 22, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.341972589492798
Epoch: 23, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.117 Vali Acc: 0.964 Test Loss: 0.117 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 6.528586149215698
Epoch: 24, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.9190733432769775
Epoch: 25, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 6.478196859359741
Epoch: 26, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 599300
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.920226097106934
Epoch: 1, Steps: 89 | Train Loss: 2.749 Vali Loss: 2.193 Vali Acc: 0.449 Test Loss: 2.193 Test Acc: 0.449
Validation loss decreased (inf --> -0.449142).  Saving model ...
Epoch: 2 cost time: 6.612266540527344
Epoch: 2, Steps: 89 | Train Loss: 1.641 Vali Loss: 1.064 Vali Acc: 0.790 Test Loss: 1.064 Test Acc: 0.790
Validation loss decreased (-0.449142 --> -0.790379).  Saving model ...
Epoch: 3 cost time: 6.1337363719940186
Epoch: 3, Steps: 89 | Train Loss: 0.817 Vali Loss: 0.616 Vali Acc: 0.847 Test Loss: 0.616 Test Acc: 0.847
Validation loss decreased (-0.790379 --> -0.847487).  Saving model ...
Epoch: 4 cost time: 6.709780216217041
Epoch: 4, Steps: 89 | Train Loss: 0.526 Vali Loss: 0.399 Vali Acc: 0.903 Test Loss: 0.399 Test Acc: 0.903
Validation loss decreased (-0.847487 --> -0.902503).  Saving model ...
Epoch: 5 cost time: 6.305091857910156
Epoch: 5, Steps: 89 | Train Loss: 0.358 Vali Loss: 0.272 Vali Acc: 0.936 Test Loss: 0.272 Test Acc: 0.936
Validation loss decreased (-0.902503 --> -0.935930).  Saving model ...
Epoch: 6 cost time: 5.9617743492126465
Epoch: 6, Steps: 89 | Train Loss: 0.269 Vali Loss: 0.229 Vali Acc: 0.941 Test Loss: 0.229 Test Acc: 0.941
Validation loss decreased (-0.935930 --> -0.940806).  Saving model ...
Epoch: 7 cost time: 6.234709978103638
Epoch: 7, Steps: 89 | Train Loss: 0.206 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
Validation loss decreased (-0.940806 --> -0.951948).  Saving model ...
Epoch: 8 cost time: 6.413206338882446
Epoch: 8, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.522435426712036
Epoch: 9, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
Validation loss decreased (-0.951948 --> -0.962394).  Saving model ...
Epoch: 10 cost time: 6.29882287979126
Epoch: 10, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.113 Vali Acc: 0.967 Test Loss: 0.113 Test Acc: 0.967
Validation loss decreased (-0.962394 --> -0.966573).  Saving model ...
Epoch: 11 cost time: 5.823909759521484
Epoch: 11, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.555468797683716
Epoch: 12, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
Validation loss decreased (-0.966573 --> -0.970055).  Saving model ...
Epoch: 13 cost time: 6.323868274688721
Epoch: 13, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.114 Vali Acc: 0.961 Test Loss: 0.114 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.464981555938721
Epoch: 14, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
Validation loss decreased (-0.970055 --> -0.977715).  Saving model ...
Epoch: 15 cost time: 6.779348373413086
Epoch: 15, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.138 Vali Acc: 0.960 Test Loss: 0.138 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.1764137744903564
Epoch: 16, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.093 Vali Acc: 0.967 Test Loss: 0.093 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.691999197006226
Epoch: 17, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.087 Vali Acc: 0.971 Test Loss: 0.087 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.879852056503296
Epoch: 18, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.082 Vali Acc: 0.975 Test Loss: 0.082 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.947829008102417
Epoch: 19, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.34761381149292
Epoch: 20, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
Validation loss decreased (-0.977715 --> -0.980501).  Saving model ...
Epoch: 21 cost time: 6.719236135482788
Epoch: 21, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.380127668380737
Epoch: 22, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.357518672943115
Epoch: 23, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.093666076660156
Epoch: 24, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 6.069293260574341
Epoch: 25, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.068 Vali Acc: 0.978 Test Loss: 0.068 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 6.274857759475708
Epoch: 26, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 5.41607666015625
Epoch: 27, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 5.560482501983643
Epoch: 28, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 6.192399263381958
Epoch: 29, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.083 Vali Acc: 0.971 Test Loss: 0.083 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 5.881533145904541
Epoch: 30, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 369028
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.4639503955841064
Epoch: 1, Steps: 89 | Train Loss: 2.852 Vali Loss: 2.307 Vali Acc: 0.393 Test Loss: 2.307 Test Acc: 0.393
Validation loss decreased (inf --> -0.393431).  Saving model ...
Epoch: 2 cost time: 5.487253427505493
Epoch: 2, Steps: 89 | Train Loss: 1.642 Vali Loss: 1.037 Vali Acc: 0.779 Test Loss: 1.037 Test Acc: 0.779
Validation loss decreased (-0.393431 --> -0.778541).  Saving model ...
Epoch: 3 cost time: 6.281420469284058
Epoch: 3, Steps: 89 | Train Loss: 0.801 Vali Loss: 0.614 Vali Acc: 0.861 Test Loss: 0.614 Test Acc: 0.861
Validation loss decreased (-0.778541 --> -0.861414).  Saving model ...
Epoch: 4 cost time: 6.258718967437744
Epoch: 4, Steps: 89 | Train Loss: 0.494 Vali Loss: 0.407 Vali Acc: 0.894 Test Loss: 0.407 Test Acc: 0.894
Validation loss decreased (-0.861414 --> -0.894146).  Saving model ...
Epoch: 5 cost time: 6.093482971191406
Epoch: 5, Steps: 89 | Train Loss: 0.359 Vali Loss: 0.307 Vali Acc: 0.925 Test Loss: 0.307 Test Acc: 0.925
Validation loss decreased (-0.894146 --> -0.925484).  Saving model ...
Epoch: 6 cost time: 6.499823093414307
Epoch: 6, Steps: 89 | Train Loss: 0.252 Vali Loss: 0.226 Vali Acc: 0.935 Test Loss: 0.226 Test Acc: 0.935
Validation loss decreased (-0.925484 --> -0.935235).  Saving model ...
Epoch: 7 cost time: 5.847607851028442
Epoch: 7, Steps: 89 | Train Loss: 0.202 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.935235 --> -0.958216).  Saving model ...
Epoch: 8 cost time: 6.234198093414307
Epoch: 8, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.157 Vali Acc: 0.962 Test Loss: 0.157 Test Acc: 0.962
Validation loss decreased (-0.958216 --> -0.961698).  Saving model ...
Epoch: 9 cost time: 6.217749357223511
Epoch: 9, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.159 Vali Acc: 0.959 Test Loss: 0.159 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.279780149459839
Epoch: 10, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
Validation loss decreased (-0.961698 --> -0.970055).  Saving model ...
Epoch: 11 cost time: 5.866235971450806
Epoch: 11, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.099 Vali Acc: 0.971 Test Loss: 0.099 Test Acc: 0.971
Validation loss decreased (-0.970055 --> -0.971447).  Saving model ...
Epoch: 12 cost time: 5.867390394210815
Epoch: 12, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.113 Vali Acc: 0.972 Test Loss: 0.113 Test Acc: 0.972
Validation loss decreased (-0.971447 --> -0.972144).  Saving model ...
Epoch: 13 cost time: 6.522571802139282
Epoch: 13, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.972144 --> -0.977019).  Saving model ...
Epoch: 14 cost time: 6.521702766418457
Epoch: 14, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
Validation loss decreased (-0.977019 --> -0.979108).  Saving model ...
Epoch: 15 cost time: 5.839725017547607
Epoch: 15, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.1355462074279785
Epoch: 16, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.8370490074157715
Epoch: 17, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.313080549240112
Epoch: 18, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.013293266296387
Epoch: 19, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.066 Vali Acc: 0.979 Test Loss: 0.066 Test Acc: 0.979
Validation loss decreased (-0.979108 --> -0.979108).  Saving model ...
Epoch: 20 cost time: 6.32244610786438
Epoch: 20, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.061 Vali Acc: 0.982 Test Loss: 0.061 Test Acc: 0.982
Validation loss decreased (-0.979108 --> -0.981894).  Saving model ...
Epoch: 21 cost time: 6.17122220993042
Epoch: 21, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.060 Vali Acc: 0.984 Test Loss: 0.060 Test Acc: 0.984
Validation loss decreased (-0.981894 --> -0.983983).  Saving model ...
Epoch: 22 cost time: 6.9698805809021
Epoch: 22, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.068 Vali Acc: 0.985 Test Loss: 0.068 Test Acc: 0.985
Validation loss decreased (-0.983983 --> -0.984679).  Saving model ...
Epoch: 23 cost time: 6.959904670715332
Epoch: 23, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.934134244918823
Epoch: 24, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.017072916030884
Epoch: 25, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.052 Vali Acc: 0.983 Test Loss: 0.052 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 6.640231609344482
Epoch: 26, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.066 Vali Acc: 0.982 Test Loss: 0.066 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 6.1283299922943115
Epoch: 27, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.060 Vali Acc: 0.986 Test Loss: 0.060 Test Acc: 0.986
Validation loss decreased (-0.984679 --> -0.986072).  Saving model ...
Epoch: 28 cost time: 6.424011468887329
Epoch: 28, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.051 Vali Acc: 0.985 Test Loss: 0.051 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 7.133320093154907
Epoch: 29, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.057 Vali Acc: 0.982 Test Loss: 0.057 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 6.2042059898376465
Epoch: 30, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.050 Vali Acc: 0.989 Test Loss: 0.050 Test Acc: 0.989
Validation loss decreased (-0.986072 --> -0.988857).  Saving model ...
Epoch: 31 cost time: 6.673314332962036
Epoch: 31, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.083 Vali Acc: 0.971 Test Loss: 0.083 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 6.748092412948608
Epoch: 32, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.058 Vali Acc: 0.984 Test Loss: 0.058 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 6.926365613937378
Epoch: 33, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.064 Vali Acc: 0.982 Test Loss: 0.064 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 6.516964912414551
Epoch: 34, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.068 Vali Acc: 0.978 Test Loss: 0.068 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 6.943082332611084
Epoch: 35, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 6.888470649719238
Epoch: 36, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.057 Vali Acc: 0.983 Test Loss: 0.057 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 6.059428453445435
Epoch: 37, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 6.390232563018799
Epoch: 38, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.070 Vali Acc: 0.979 Test Loss: 0.070 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 5.910961866378784
Epoch: 39, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.046 Vali Acc: 0.984 Test Loss: 0.046 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 5.794520854949951
Epoch: 40, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.150 Vali Acc: 0.953 Test Loss: 0.150 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9888579387186629
model parameter : 368132
model size : 2.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.983211994171143
Epoch: 1, Steps: 89 | Train Loss: 2.911 Vali Loss: 2.425 Vali Acc: 0.362 Test Loss: 2.425 Test Acc: 0.362
Validation loss decreased (inf --> -0.362093).  Saving model ...
Epoch: 2 cost time: 6.011128187179565
Epoch: 2, Steps: 89 | Train Loss: 1.763 Vali Loss: 1.061 Vali Acc: 0.827 Test Loss: 1.061 Test Acc: 0.827
Validation loss decreased (-0.362093 --> -0.827287).  Saving model ...
Epoch: 3 cost time: 5.725295305252075
Epoch: 3, Steps: 89 | Train Loss: 0.808 Vali Loss: 0.549 Vali Acc: 0.894 Test Loss: 0.549 Test Acc: 0.894
Validation loss decreased (-0.827287 --> -0.894145).  Saving model ...
Epoch: 4 cost time: 5.8358728885650635
Epoch: 4, Steps: 89 | Train Loss: 0.495 Vali Loss: 0.393 Vali Acc: 0.907 Test Loss: 0.393 Test Acc: 0.907
Validation loss decreased (-0.894145 --> -0.907378).  Saving model ...
Epoch: 5 cost time: 6.307638168334961
Epoch: 5, Steps: 89 | Train Loss: 0.335 Vali Loss: 0.298 Vali Acc: 0.922 Test Loss: 0.298 Test Acc: 0.922
Validation loss decreased (-0.907378 --> -0.922003).  Saving model ...
Epoch: 6 cost time: 6.218330144882202
Epoch: 6, Steps: 89 | Train Loss: 0.260 Vali Loss: 0.218 Vali Acc: 0.946 Test Loss: 0.218 Test Acc: 0.946
Validation loss decreased (-0.922003 --> -0.946377).  Saving model ...
Epoch: 7 cost time: 5.813554763793945
Epoch: 7, Steps: 89 | Train Loss: 0.218 Vali Loss: 0.211 Vali Acc: 0.951 Test Loss: 0.211 Test Acc: 0.951
Validation loss decreased (-0.946377 --> -0.951251).  Saving model ...
Epoch: 8 cost time: 6.445154190063477
Epoch: 8, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.152 Vali Acc: 0.963 Test Loss: 0.152 Test Acc: 0.963
Validation loss decreased (-0.951251 --> -0.963090).  Saving model ...
Epoch: 9 cost time: 6.505878925323486
Epoch: 9, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.142 Vali Acc: 0.965 Test Loss: 0.142 Test Acc: 0.965
Validation loss decreased (-0.963090 --> -0.965180).  Saving model ...
Epoch: 10 cost time: 6.346632957458496
Epoch: 10, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.965180 --> -0.972840).  Saving model ...
Epoch: 11 cost time: 6.321613073348999
Epoch: 11, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.117871999740601
Epoch: 12, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.130 Vali Acc: 0.959 Test Loss: 0.130 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.100828409194946
Epoch: 13, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.974233).  Saving model ...
Epoch: 14 cost time: 6.733030796051025
Epoch: 14, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.231309413909912
Epoch: 15, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.120 Vali Acc: 0.974 Test Loss: 0.120 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.295933961868286
Epoch: 16, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.974233 --> -0.977019).  Saving model ...
Epoch: 17 cost time: 6.01619553565979
Epoch: 17, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.295281171798706
Epoch: 18, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.939661026000977
Epoch: 19, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.086 Vali Acc: 0.974 Test Loss: 0.086 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.8155906200408936
Epoch: 20, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.089 Vali Acc: 0.971 Test Loss: 0.089 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.978001594543457
Epoch: 21, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.130 Vali Acc: 0.958 Test Loss: 0.130 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.9795660972595215
Epoch: 22, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
Validation loss decreased (-0.977019 --> -0.981197).  Saving model ...
Epoch: 23 cost time: 6.128303050994873
Epoch: 23, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.3656086921691895
Epoch: 24, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.640780925750732
Epoch: 25, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.639758825302124
Epoch: 26, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 5.888813734054565
Epoch: 27, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.092 Vali Acc: 0.972 Test Loss: 0.092 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 6.299616575241089
Epoch: 28, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 6.019348382949829
Epoch: 29, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 6.399715423583984
Epoch: 30, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.105 Vali Acc: 0.971 Test Loss: 0.105 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 6.091442823410034
Epoch: 31, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 6.598801136016846
Epoch: 32, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 367236
model size : 2.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.005098581314087
Epoch: 1, Steps: 89 | Train Loss: 2.917 Vali Loss: 2.400 Vali Acc: 0.480 Test Loss: 2.400 Test Acc: 0.480
Validation loss decreased (inf --> -0.479781).  Saving model ...
Epoch: 2 cost time: 6.187431812286377
Epoch: 2, Steps: 89 | Train Loss: 1.703 Vali Loss: 1.053 Vali Acc: 0.724 Test Loss: 1.053 Test Acc: 0.724
Validation loss decreased (-0.479781 --> -0.723527).  Saving model ...
Epoch: 3 cost time: 6.340332984924316
Epoch: 3, Steps: 89 | Train Loss: 0.828 Vali Loss: 0.577 Vali Acc: 0.870 Test Loss: 0.577 Test Acc: 0.870
Validation loss decreased (-0.723527 --> -0.869771).  Saving model ...
Epoch: 4 cost time: 6.545774459838867
Epoch: 4, Steps: 89 | Train Loss: 0.479 Vali Loss: 0.457 Vali Acc: 0.882 Test Loss: 0.457 Test Acc: 0.882
Validation loss decreased (-0.869771 --> -0.882307).  Saving model ...
Epoch: 5 cost time: 5.647488355636597
Epoch: 5, Steps: 89 | Train Loss: 0.353 Vali Loss: 0.280 Vali Acc: 0.935 Test Loss: 0.280 Test Acc: 0.935
Validation loss decreased (-0.882307 --> -0.935234).  Saving model ...
Epoch: 6 cost time: 6.181272983551025
Epoch: 6, Steps: 89 | Train Loss: 0.260 Vali Loss: 0.221 Vali Acc: 0.953 Test Loss: 0.221 Test Acc: 0.953
Validation loss decreased (-0.935234 --> -0.953340).  Saving model ...
Epoch: 7 cost time: 5.674433469772339
Epoch: 7, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.257 Vali Acc: 0.916 Test Loss: 0.257 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.912127256393433
Epoch: 8, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.209 Vali Acc: 0.953 Test Loss: 0.209 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.585337400436401
Epoch: 9, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.142 Vali Acc: 0.965 Test Loss: 0.142 Test Acc: 0.965
Validation loss decreased (-0.953340 --> -0.965180).  Saving model ...
Epoch: 10 cost time: 5.659219026565552
Epoch: 10, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.718169927597046
Epoch: 11, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
Validation loss decreased (-0.965180 --> -0.969358).  Saving model ...
Epoch: 12 cost time: 6.090359926223755
Epoch: 12, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.423300743103027
Epoch: 13, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.088 Vali Acc: 0.975 Test Loss: 0.088 Test Acc: 0.975
Validation loss decreased (-0.969358 --> -0.974929).  Saving model ...
Epoch: 14 cost time: 6.251742362976074
Epoch: 14, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
Validation loss decreased (-0.974929 --> -0.979108).  Saving model ...
Epoch: 15 cost time: 5.880699396133423
Epoch: 15, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.671478271484375
Epoch: 16, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.073 Vali Acc: 0.982 Test Loss: 0.073 Test Acc: 0.982
Validation loss decreased (-0.979108 --> -0.981893).  Saving model ...
Epoch: 17 cost time: 6.401981353759766
Epoch: 17, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.094 Vali Acc: 0.971 Test Loss: 0.094 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.2100510597229
Epoch: 18, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.083 Vali Acc: 0.974 Test Loss: 0.083 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.907926559448242
Epoch: 19, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.954689025878906
Epoch: 20, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.886342525482178
Epoch: 21, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.152 Vali Acc: 0.952 Test Loss: 0.152 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.418447971343994
Epoch: 22, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.9214935302734375
Epoch: 23, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.132 Vali Acc: 0.955 Test Loss: 0.132 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 6.1647443771362305
Epoch: 24, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.823216676712036
Epoch: 25, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.89647364616394
Epoch: 26, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 366340
model size : 2.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.284929513931274
Epoch: 1, Steps: 89 | Train Loss: 2.890 Vali Loss: 2.410 Vali Acc: 0.451 Test Loss: 2.410 Test Acc: 0.451
Validation loss decreased (inf --> -0.450533).  Saving model ...
Epoch: 2 cost time: 5.6948676109313965
Epoch: 2, Steps: 89 | Train Loss: 1.758 Vali Loss: 1.079 Vali Acc: 0.765 Test Loss: 1.079 Test Acc: 0.765
Validation loss decreased (-0.450533 --> -0.765310).  Saving model ...
Epoch: 3 cost time: 6.041820764541626
Epoch: 3, Steps: 89 | Train Loss: 0.840 Vali Loss: 0.602 Vali Acc: 0.872 Test Loss: 0.602 Test Acc: 0.872
Validation loss decreased (-0.765310 --> -0.871860).  Saving model ...
Epoch: 4 cost time: 6.353673696517944
Epoch: 4, Steps: 89 | Train Loss: 0.517 Vali Loss: 0.417 Vali Acc: 0.898 Test Loss: 0.417 Test Acc: 0.898
Validation loss decreased (-0.871860 --> -0.897628).  Saving model ...
Epoch: 5 cost time: 5.808414936065674
Epoch: 5, Steps: 89 | Train Loss: 0.373 Vali Loss: 0.306 Vali Acc: 0.928 Test Loss: 0.306 Test Acc: 0.928
Validation loss decreased (-0.897628 --> -0.927574).  Saving model ...
Epoch: 6 cost time: 6.569849014282227
Epoch: 6, Steps: 89 | Train Loss: 0.295 Vali Loss: 0.243 Vali Acc: 0.943 Test Loss: 0.243 Test Acc: 0.943
Validation loss decreased (-0.927574 --> -0.942895).  Saving model ...
Epoch: 7 cost time: 6.693759918212891
Epoch: 7, Steps: 89 | Train Loss: 0.219 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
Validation loss decreased (-0.942895 --> -0.949859).  Saving model ...
Epoch: 8 cost time: 6.649811506271362
Epoch: 8, Steps: 89 | Train Loss: 0.182 Vali Loss: 0.182 Vali Acc: 0.953 Test Loss: 0.182 Test Acc: 0.953
Validation loss decreased (-0.949859 --> -0.952644).  Saving model ...
Epoch: 9 cost time: 6.244531154632568
Epoch: 9, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.192 Vali Acc: 0.945 Test Loss: 0.192 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.468998908996582
Epoch: 10, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.532635688781738
Epoch: 11, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
Validation loss decreased (-0.952644 --> -0.967965).  Saving model ...
Epoch: 12 cost time: 5.775355100631714
Epoch: 12, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
Validation loss decreased (-0.967965 --> -0.974233).  Saving model ...
Epoch: 13 cost time: 6.3061912059783936
Epoch: 13, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
Validation loss decreased (-0.974233 --> -0.974233).  Saving model ...
Epoch: 14 cost time: 5.857628583908081
Epoch: 14, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.108 Vali Acc: 0.972 Test Loss: 0.108 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.860069036483765
Epoch: 15, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.974233 --> -0.977018).  Saving model ...
Epoch: 16 cost time: 6.364329814910889
Epoch: 16, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.837260484695435
Epoch: 17, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.107 Vali Acc: 0.969 Test Loss: 0.107 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.861772775650024
Epoch: 18, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
Validation loss decreased (-0.977018 --> -0.977715).  Saving model ...
Epoch: 19 cost time: 6.153322696685791
Epoch: 19, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.159 Vali Acc: 0.955 Test Loss: 0.159 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.0214221477508545
Epoch: 20, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
Validation loss decreased (-0.977715 --> -0.979108).  Saving model ...
Epoch: 21 cost time: 6.871434688568115
Epoch: 21, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.884809255599976
Epoch: 22, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979108 --> -0.979804).  Saving model ...
Epoch: 23 cost time: 6.088005065917969
Epoch: 23, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.981197).  Saving model ...
Epoch: 24 cost time: 6.364017009735107
Epoch: 24, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.893983364105225
Epoch: 25, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.104 Vali Acc: 0.972 Test Loss: 0.104 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.758024215698242
Epoch: 26, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 5.768291473388672
Epoch: 27, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 6.087914943695068
Epoch: 28, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.085 Vali Acc: 0.974 Test Loss: 0.085 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 6.167003631591797
Epoch: 29, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.056 Vali Acc: 0.983 Test Loss: 0.056 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.982590).  Saving model ...
Epoch: 30 cost time: 5.841233968734741
Epoch: 30, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.93400764465332
Epoch: 31, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 6.245437860488892
Epoch: 32, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.101 Vali Acc: 0.972 Test Loss: 0.101 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 6.097965478897095
Epoch: 33, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 5.750360488891602
Epoch: 34, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.067 Vali Acc: 0.978 Test Loss: 0.067 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 5.79779577255249
Epoch: 35, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.063 Vali Acc: 0.986 Test Loss: 0.063 Test Acc: 0.986
Validation loss decreased (-0.982590 --> -0.986072).  Saving model ...
Epoch: 36 cost time: 6.19194221496582
Epoch: 36, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 6.602091312408447
Epoch: 37, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 6.177372455596924
Epoch: 38, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 6.3294737339019775
Epoch: 39, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 6.1396074295043945
Epoch: 40, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.080 Vali Acc: 0.982 Test Loss: 0.080 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 6.250046730041504
Epoch: 41, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 5.947287082672119
Epoch: 42, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.083 Vali Acc: 0.982 Test Loss: 0.083 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 6.539179086685181
Epoch: 43, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 5.909476280212402
Epoch: 44, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.107 Vali Acc: 0.979 Test Loss: 0.107 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 6.353222131729126
Epoch: 45, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.068 Vali Acc: 0.981 Test Loss: 0.068 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 252548
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.156778812408447
Epoch: 1, Steps: 89 | Train Loss: 2.865 Vali Loss: 2.309 Vali Acc: 0.485 Test Loss: 2.309 Test Acc: 0.485
Validation loss decreased (inf --> -0.484657).  Saving model ...
Epoch: 2 cost time: 6.0248706340789795
Epoch: 2, Steps: 89 | Train Loss: 1.649 Vali Loss: 1.000 Vali Acc: 0.806 Test Loss: 1.000 Test Acc: 0.806
Validation loss decreased (-0.484657 --> -0.806397).  Saving model ...
Epoch: 3 cost time: 5.662112236022949
Epoch: 3, Steps: 89 | Train Loss: 0.776 Vali Loss: 0.580 Vali Acc: 0.843 Test Loss: 0.580 Test Acc: 0.843
Validation loss decreased (-0.806397 --> -0.842613).  Saving model ...
Epoch: 4 cost time: 6.146561622619629
Epoch: 4, Steps: 89 | Train Loss: 0.475 Vali Loss: 0.369 Vali Acc: 0.917 Test Loss: 0.369 Test Acc: 0.917
Validation loss decreased (-0.842613 --> -0.917127).  Saving model ...
Epoch: 5 cost time: 5.9033567905426025
Epoch: 5, Steps: 89 | Train Loss: 0.343 Vali Loss: 0.301 Vali Acc: 0.932 Test Loss: 0.301 Test Acc: 0.932
Validation loss decreased (-0.917127 --> -0.931752).  Saving model ...
Epoch: 6 cost time: 6.042335033416748
Epoch: 6, Steps: 89 | Train Loss: 0.261 Vali Loss: 0.239 Vali Acc: 0.939 Test Loss: 0.239 Test Acc: 0.939
Validation loss decreased (-0.931752 --> -0.939413).  Saving model ...
Epoch: 7 cost time: 5.881200790405273
Epoch: 7, Steps: 89 | Train Loss: 0.202 Vali Loss: 0.195 Vali Acc: 0.948 Test Loss: 0.195 Test Acc: 0.948
Validation loss decreased (-0.939413 --> -0.948466).  Saving model ...
Epoch: 8 cost time: 6.285235643386841
Epoch: 8, Steps: 89 | Train Loss: 0.165 Vali Loss: 0.169 Vali Acc: 0.953 Test Loss: 0.169 Test Acc: 0.953
Validation loss decreased (-0.948466 --> -0.952645).  Saving model ...
Epoch: 9 cost time: 6.008649110794067
Epoch: 9, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.145 Vali Acc: 0.958 Test Loss: 0.145 Test Acc: 0.958
Validation loss decreased (-0.952645 --> -0.958216).  Saving model ...
Epoch: 10 cost time: 5.73353910446167
Epoch: 10, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.0763258934021
Epoch: 11, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
Validation loss decreased (-0.958216 --> -0.962394).  Saving model ...
Epoch: 12 cost time: 6.281305551528931
Epoch: 12, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
Validation loss decreased (-0.962394 --> -0.977715).  Saving model ...
Epoch: 13 cost time: 6.043881893157959
Epoch: 13, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.198728799819946
Epoch: 14, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.977715 --> -0.979804).  Saving model ...
Epoch: 15 cost time: 6.252255201339722
Epoch: 15, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.109 Vali Acc: 0.966 Test Loss: 0.109 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.211765766143799
Epoch: 16, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.105 Vali Acc: 0.969 Test Loss: 0.105 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.42059850692749
Epoch: 17, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.981197).  Saving model ...
Epoch: 18 cost time: 6.099450349807739
Epoch: 18, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.289184093475342
Epoch: 19, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.948514699935913
Epoch: 20, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.072 Vali Acc: 0.982 Test Loss: 0.072 Test Acc: 0.982
Validation loss decreased (-0.981197 --> -0.981893).  Saving model ...
Epoch: 21 cost time: 6.673583507537842
Epoch: 21, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.314463376998901
Epoch: 22, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.7895824909210205
Epoch: 23, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.601047515869141
Epoch: 24, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.078 Vali Acc: 0.975 Test Loss: 0.078 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 6.824661016464233
Epoch: 25, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 6.746739625930786
Epoch: 26, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.095 Vali Acc: 0.972 Test Loss: 0.095 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 6.12266206741333
Epoch: 27, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 6.839724540710449
Epoch: 28, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 6.905482053756714
Epoch: 29, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 5.813220262527466
Epoch: 30, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.129 Vali Acc: 0.964 Test Loss: 0.129 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 251652
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.267377376556396
Epoch: 1, Steps: 89 | Train Loss: 2.953 Vali Loss: 2.558 Vali Acc: 0.390 Test Loss: 2.558 Test Acc: 0.390
Validation loss decreased (inf --> -0.389947).  Saving model ...
Epoch: 2 cost time: 6.481099367141724
Epoch: 2, Steps: 89 | Train Loss: 1.925 Vali Loss: 1.250 Vali Acc: 0.715 Test Loss: 1.250 Test Acc: 0.715
Validation loss decreased (-0.389947 --> -0.715169).  Saving model ...
Epoch: 3 cost time: 6.543266296386719
Epoch: 3, Steps: 89 | Train Loss: 0.930 Vali Loss: 0.617 Vali Acc: 0.873 Test Loss: 0.617 Test Acc: 0.873
Validation loss decreased (-0.715169 --> -0.872557).  Saving model ...
Epoch: 4 cost time: 6.499185562133789
Epoch: 4, Steps: 89 | Train Loss: 0.537 Vali Loss: 0.374 Vali Acc: 0.918 Test Loss: 0.374 Test Acc: 0.918
Validation loss decreased (-0.872557 --> -0.917824).  Saving model ...
Epoch: 5 cost time: 6.26441764831543
Epoch: 5, Steps: 89 | Train Loss: 0.361 Vali Loss: 0.300 Vali Acc: 0.930 Test Loss: 0.300 Test Acc: 0.930
Validation loss decreased (-0.917824 --> -0.930359).  Saving model ...
Epoch: 6 cost time: 6.442630767822266
Epoch: 6, Steps: 89 | Train Loss: 0.252 Vali Loss: 0.218 Vali Acc: 0.948 Test Loss: 0.218 Test Acc: 0.948
Validation loss decreased (-0.930359 --> -0.948466).  Saving model ...
Epoch: 7 cost time: 6.062839508056641
Epoch: 7, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.166 Vali Acc: 0.955 Test Loss: 0.166 Test Acc: 0.955
Validation loss decreased (-0.948466 --> -0.955430).  Saving model ...
Epoch: 8 cost time: 5.749911546707153
Epoch: 8, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
Validation loss decreased (-0.955430 --> -0.967965).  Saving model ...
Epoch: 9 cost time: 6.944484710693359
Epoch: 9, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
Validation loss decreased (-0.967965 --> -0.969358).  Saving model ...
Epoch: 10 cost time: 6.17368483543396
Epoch: 10, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.77783203125
Epoch: 11, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.105 Vali Acc: 0.971 Test Loss: 0.105 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.971447).  Saving model ...
Epoch: 12 cost time: 5.9361231327056885
Epoch: 12, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.103 Vali Acc: 0.966 Test Loss: 0.103 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.454517602920532
Epoch: 13, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
Validation loss decreased (-0.971447 --> -0.977715).  Saving model ...
Epoch: 14 cost time: 5.997567892074585
Epoch: 14, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.03130578994751
Epoch: 15, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.7839860916137695
Epoch: 16, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.099 Vali Acc: 0.969 Test Loss: 0.099 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.878648519515991
Epoch: 17, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.083 Vali Acc: 0.975 Test Loss: 0.083 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.290988206863403
Epoch: 18, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.075 Vali Acc: 0.975 Test Loss: 0.075 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.97523832321167
Epoch: 19, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.514659404754639
Epoch: 20, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 6.013878107070923
Epoch: 21, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.073 Vali Acc: 0.974 Test Loss: 0.073 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 6.022100925445557
Epoch: 22, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.070 Vali Acc: 0.978 Test Loss: 0.070 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.978412).  Saving model ...
Epoch: 23 cost time: 6.654489994049072
Epoch: 23, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.062 Vali Acc: 0.981 Test Loss: 0.062 Test Acc: 0.981
Validation loss decreased (-0.978412 --> -0.980501).  Saving model ...
Epoch: 24 cost time: 5.9827635288238525
Epoch: 24, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.067 Vali Acc: 0.978 Test Loss: 0.067 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.071123838424683
Epoch: 25, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.110 Vali Acc: 0.964 Test Loss: 0.110 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.382136344909668
Epoch: 26, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.068 Vali Acc: 0.978 Test Loss: 0.068 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 6.666088819503784
Epoch: 27, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.069 Vali Acc: 0.978 Test Loss: 0.069 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 6.05474591255188
Epoch: 28, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.082 Vali Acc: 0.974 Test Loss: 0.082 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 6.2696287631988525
Epoch: 29, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.056 Vali Acc: 0.982 Test Loss: 0.056 Test Acc: 0.982
Validation loss decreased (-0.980501 --> -0.981894).  Saving model ...
Epoch: 30 cost time: 5.89128851890564
Epoch: 30, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 6.305779695510864
Epoch: 31, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 5.904468059539795
Epoch: 32, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 5.590367555618286
Epoch: 33, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.096 Vali Acc: 0.971 Test Loss: 0.096 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 6.256636381149292
Epoch: 34, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.096 Vali Acc: 0.971 Test Loss: 0.096 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 6.107114553451538
Epoch: 35, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.065 Vali Acc: 0.979 Test Loss: 0.065 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 5.527048349380493
Epoch: 36, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.981894 --> -0.982590).  Saving model ...
Epoch: 37 cost time: 5.913704872131348
Epoch: 37, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.074 Vali Acc: 0.979 Test Loss: 0.074 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 6.003390789031982
Epoch: 38, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 5.9752724170684814
Epoch: 39, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.088 Vali Acc: 0.974 Test Loss: 0.088 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 6.769184827804565
Epoch: 40, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 5.576059579849243
Epoch: 41, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 6.310842275619507
Epoch: 42, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.112 Vali Acc: 0.967 Test Loss: 0.112 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 6.4563140869140625
Epoch: 43, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.130 Vali Acc: 0.964 Test Loss: 0.130 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 6.1174561977386475
Epoch: 44, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 6.150650978088379
Epoch: 45, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 6.569697856903076
Epoch: 46, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 250756
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.11566710472107
Epoch: 1, Steps: 89 | Train Loss: 2.974 Vali Loss: 2.573 Vali Acc: 0.384 Test Loss: 2.573 Test Acc: 0.384
Validation loss decreased (inf --> -0.383679).  Saving model ...
Epoch: 2 cost time: 6.2191078662872314
Epoch: 2, Steps: 89 | Train Loss: 1.869 Vali Loss: 1.158 Vali Acc: 0.776 Test Loss: 1.158 Test Acc: 0.776
Validation loss decreased (-0.383679 --> -0.775754).  Saving model ...
Epoch: 3 cost time: 6.30779504776001
Epoch: 3, Steps: 89 | Train Loss: 0.883 Vali Loss: 0.612 Vali Acc: 0.871 Test Loss: 0.612 Test Acc: 0.871
Validation loss decreased (-0.775754 --> -0.871164).  Saving model ...
Epoch: 4 cost time: 6.1501853466033936
Epoch: 4, Steps: 89 | Train Loss: 0.524 Vali Loss: 0.423 Vali Acc: 0.903 Test Loss: 0.423 Test Acc: 0.903
Validation loss decreased (-0.871164 --> -0.903199).  Saving model ...
Epoch: 5 cost time: 6.50706148147583
Epoch: 5, Steps: 89 | Train Loss: 0.358 Vali Loss: 0.310 Vali Acc: 0.937 Test Loss: 0.310 Test Acc: 0.937
Validation loss decreased (-0.903199 --> -0.936626).  Saving model ...
Epoch: 6 cost time: 6.885340929031372
Epoch: 6, Steps: 89 | Train Loss: 0.276 Vali Loss: 0.222 Vali Acc: 0.947 Test Loss: 0.222 Test Acc: 0.947
Validation loss decreased (-0.936626 --> -0.947073).  Saving model ...
Epoch: 7 cost time: 6.04781699180603
Epoch: 7, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.196 Vali Acc: 0.949 Test Loss: 0.196 Test Acc: 0.949
Validation loss decreased (-0.947073 --> -0.949162).  Saving model ...
Epoch: 8 cost time: 6.164716958999634
Epoch: 8, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.165 Vali Acc: 0.952 Test Loss: 0.165 Test Acc: 0.952
Validation loss decreased (-0.949162 --> -0.951948).  Saving model ...
Epoch: 9 cost time: 6.3071253299713135
Epoch: 9, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.158 Vali Acc: 0.960 Test Loss: 0.158 Test Acc: 0.960
Validation loss decreased (-0.951948 --> -0.960305).  Saving model ...
Epoch: 10 cost time: 5.971772193908691
Epoch: 10, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.243866205215454
Epoch: 11, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.151 Vali Acc: 0.950 Test Loss: 0.151 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.2329301834106445
Epoch: 12, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
Validation loss decreased (-0.960305 --> -0.973537).  Saving model ...
Epoch: 13 cost time: 6.401592016220093
Epoch: 13, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.6480700969696045
Epoch: 14, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
Validation loss decreased (-0.973537 --> -0.975626).  Saving model ...
Epoch: 15 cost time: 5.916146516799927
Epoch: 15, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.088 Vali Acc: 0.975 Test Loss: 0.088 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.27452540397644
Epoch: 16, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.505218267440796
Epoch: 17, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.975626 --> -0.982590).  Saving model ...
Epoch: 18 cost time: 6.3577189445495605
Epoch: 18, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.501280069351196
Epoch: 19, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.7018067836761475
Epoch: 20, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.685243606567383
Epoch: 21, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.106 Vali Acc: 0.961 Test Loss: 0.106 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.555766344070435
Epoch: 22, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.9487152099609375
Epoch: 23, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.088367462158203
Epoch: 24, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 6.164464235305786
Epoch: 25, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 6.366137981414795
Epoch: 26, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
Validation loss decreased (-0.982590 --> -0.983286).  Saving model ...
Epoch: 27 cost time: 6.529377460479736
Epoch: 27, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.031670093536377
Epoch: 28, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 6.797720909118652
Epoch: 29, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 5.8189404010772705
Epoch: 30, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.065 Vali Acc: 0.981 Test Loss: 0.065 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 5.842725992202759
Epoch: 31, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.061 Vali Acc: 0.982 Test Loss: 0.061 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 6.255707263946533
Epoch: 32, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 6.154120922088623
Epoch: 33, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 6.179692029953003
Epoch: 34, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.086 Vali Acc: 0.975 Test Loss: 0.086 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 6.209019422531128
Epoch: 35, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.086 Vali Acc: 0.974 Test Loss: 0.086 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 6.622899293899536
Epoch: 36, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.154 Vali Acc: 0.965 Test Loss: 0.154 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 249860
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.341960906982422
Epoch: 1, Steps: 89 | Train Loss: 2.898 Vali Loss: 2.554 Vali Acc: 0.349 Test Loss: 2.554 Test Acc: 0.349
Validation loss decreased (inf --> -0.348860).  Saving model ...
Epoch: 2 cost time: 6.397561550140381
Epoch: 2, Steps: 89 | Train Loss: 2.025 Vali Loss: 1.333 Vali Acc: 0.747 Test Loss: 1.333 Test Acc: 0.747
Validation loss decreased (-0.348860 --> -0.746505).  Saving model ...
Epoch: 3 cost time: 6.244405508041382
Epoch: 3, Steps: 89 | Train Loss: 0.993 Vali Loss: 0.683 Vali Acc: 0.844 Test Loss: 0.683 Test Acc: 0.844
Validation loss decreased (-0.746505 --> -0.844004).  Saving model ...
Epoch: 4 cost time: 6.27138876914978
Epoch: 4, Steps: 89 | Train Loss: 0.606 Vali Loss: 0.491 Vali Acc: 0.891 Test Loss: 0.491 Test Acc: 0.891
Validation loss decreased (-0.844004 --> -0.890664).  Saving model ...
Epoch: 5 cost time: 6.361771106719971
Epoch: 5, Steps: 89 | Train Loss: 0.429 Vali Loss: 0.360 Vali Acc: 0.910 Test Loss: 0.360 Test Acc: 0.910
Validation loss decreased (-0.890664 --> -0.910164).  Saving model ...
Epoch: 6 cost time: 5.877569913864136
Epoch: 6, Steps: 89 | Train Loss: 0.307 Vali Loss: 0.280 Vali Acc: 0.918 Test Loss: 0.280 Test Acc: 0.918
Validation loss decreased (-0.910164 --> -0.917825).  Saving model ...
Epoch: 7 cost time: 5.54913854598999
Epoch: 7, Steps: 89 | Train Loss: 0.229 Vali Loss: 0.206 Vali Acc: 0.951 Test Loss: 0.206 Test Acc: 0.951
Validation loss decreased (-0.917825 --> -0.950555).  Saving model ...
Epoch: 8 cost time: 6.046829462051392
Epoch: 8, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.191 Vali Acc: 0.948 Test Loss: 0.191 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.5294623374938965
Epoch: 9, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.160 Vali Acc: 0.955 Test Loss: 0.160 Test Acc: 0.955
Validation loss decreased (-0.950555 --> -0.954734).  Saving model ...
Epoch: 10 cost time: 5.80997371673584
Epoch: 10, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.138 Vali Acc: 0.964 Test Loss: 0.138 Test Acc: 0.964
Validation loss decreased (-0.954734 --> -0.964483).  Saving model ...
Epoch: 11 cost time: 5.986656665802002
Epoch: 11, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.150 Vali Acc: 0.959 Test Loss: 0.150 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.567667245864868
Epoch: 12, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
Validation loss decreased (-0.964483 --> -0.967269).  Saving model ...
Epoch: 13 cost time: 6.304497718811035
Epoch: 13, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.647334575653076
Epoch: 14, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.150 Vali Acc: 0.953 Test Loss: 0.150 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.639383316040039
Epoch: 15, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.3627707958221436
Epoch: 16, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
Validation loss decreased (-0.967269 --> -0.967966).  Saving model ...
Epoch: 17 cost time: 6.003504514694214
Epoch: 17, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
Validation loss decreased (-0.967966 --> -0.973537).  Saving model ...
Epoch: 18 cost time: 6.352844715118408
Epoch: 18, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.099 Vali Acc: 0.969 Test Loss: 0.099 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.939049482345581
Epoch: 19, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.088 Vali Acc: 0.975 Test Loss: 0.088 Test Acc: 0.975
Validation loss decreased (-0.973537 --> -0.974929).  Saving model ...
Epoch: 20 cost time: 6.557237386703491
Epoch: 20, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975626).  Saving model ...
Epoch: 21 cost time: 6.670881509780884
Epoch: 21, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.196469306945801
Epoch: 22, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.975626 --> -0.977019).  Saving model ...
Epoch: 23 cost time: 6.54402756690979
Epoch: 23, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.069 Vali Acc: 0.982 Test Loss: 0.069 Test Acc: 0.982
Validation loss decreased (-0.977019 --> -0.981893).  Saving model ...
Epoch: 24 cost time: 6.400303840637207
Epoch: 24, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.232309103012085
Epoch: 25, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.5689897537231445
Epoch: 26, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 6.5455474853515625
Epoch: 27, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 5.949370384216309
Epoch: 28, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 6.110868215560913
Epoch: 29, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 5.875760316848755
Epoch: 30, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.062 Vali Acc: 0.981 Test Loss: 0.062 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 6.265718698501587
Epoch: 31, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 5.779306411743164
Epoch: 32, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 5.800606966018677
Epoch: 33, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 194308
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.847742557525635
Epoch: 1, Steps: 89 | Train Loss: 2.982 Vali Loss: 2.687 Vali Acc: 0.288 Test Loss: 2.687 Test Acc: 0.288
Validation loss decreased (inf --> -0.288274).  Saving model ...
Epoch: 2 cost time: 5.8840882778167725
Epoch: 2, Steps: 89 | Train Loss: 2.041 Vali Loss: 1.282 Vali Acc: 0.701 Test Loss: 1.282 Test Acc: 0.701
Validation loss decreased (-0.288274 --> -0.700544).  Saving model ...
Epoch: 3 cost time: 5.726016283035278
Epoch: 3, Steps: 89 | Train Loss: 0.960 Vali Loss: 0.662 Vali Acc: 0.845 Test Loss: 0.662 Test Acc: 0.845
Validation loss decreased (-0.700544 --> -0.844701).  Saving model ...
Epoch: 4 cost time: 5.770622253417969
Epoch: 4, Steps: 89 | Train Loss: 0.566 Vali Loss: 0.467 Vali Acc: 0.898 Test Loss: 0.467 Test Acc: 0.898
Validation loss decreased (-0.844701 --> -0.897628).  Saving model ...
Epoch: 5 cost time: 5.8547728061676025
Epoch: 5, Steps: 89 | Train Loss: 0.386 Vali Loss: 0.315 Vali Acc: 0.923 Test Loss: 0.315 Test Acc: 0.923
Validation loss decreased (-0.897628 --> -0.922699).  Saving model ...
Epoch: 6 cost time: 6.093889474868774
Epoch: 6, Steps: 89 | Train Loss: 0.284 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
Validation loss decreased (-0.922699 --> -0.931056).  Saving model ...
Epoch: 7 cost time: 6.370117902755737
Epoch: 7, Steps: 89 | Train Loss: 0.213 Vali Loss: 0.238 Vali Acc: 0.937 Test Loss: 0.238 Test Acc: 0.937
Validation loss decreased (-0.931056 --> -0.937324).  Saving model ...
Epoch: 8 cost time: 5.93343186378479
Epoch: 8, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
Validation loss decreased (-0.937324 --> -0.951252).  Saving model ...
Epoch: 9 cost time: 6.322810649871826
Epoch: 9, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.147 Vali Acc: 0.960 Test Loss: 0.147 Test Acc: 0.960
Validation loss decreased (-0.951252 --> -0.959609).  Saving model ...
Epoch: 10 cost time: 6.31531286239624
Epoch: 10, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.110 Vali Acc: 0.972 Test Loss: 0.110 Test Acc: 0.972
Validation loss decreased (-0.959609 --> -0.972144).  Saving model ...
Epoch: 11 cost time: 6.283215522766113
Epoch: 11, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.142 Vali Acc: 0.953 Test Loss: 0.142 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.179370880126953
Epoch: 12, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.568201780319214
Epoch: 13, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
Validation loss decreased (-0.972144 --> -0.976322).  Saving model ...
Epoch: 14 cost time: 6.139880895614624
Epoch: 14, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.388285398483276
Epoch: 15, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.108 Vali Acc: 0.967 Test Loss: 0.108 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.083796977996826
Epoch: 16, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
Validation loss decreased (-0.976322 --> -0.976322).  Saving model ...
Epoch: 17 cost time: 5.763112306594849
Epoch: 17, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.740334510803223
Epoch: 18, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.976322 --> -0.979804).  Saving model ...
Epoch: 19 cost time: 6.1422717571258545
Epoch: 19, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.967695713043213
Epoch: 20, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.085 Vali Acc: 0.975 Test Loss: 0.085 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.10958194732666
Epoch: 21, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.068 Vali Acc: 0.978 Test Loss: 0.068 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.67758584022522
Epoch: 22, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.071 Vali Acc: 0.979 Test Loss: 0.071 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.843916416168213
Epoch: 23, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.144 Vali Acc: 0.955 Test Loss: 0.144 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.846710443496704
Epoch: 24, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.542634010314941
Epoch: 25, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.055 Vali Acc: 0.985 Test Loss: 0.055 Test Acc: 0.985
Validation loss decreased (-0.979804 --> -0.985375).  Saving model ...
Epoch: 26 cost time: 6.337950944900513
Epoch: 26, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.057 Vali Acc: 0.986 Test Loss: 0.057 Test Acc: 0.986
Validation loss decreased (-0.985375 --> -0.986072).  Saving model ...
Epoch: 27 cost time: 5.892425060272217
Epoch: 27, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.099 Vali Acc: 0.967 Test Loss: 0.099 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.099412441253662
Epoch: 28, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 6.310699462890625
Epoch: 29, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.057 Vali Acc: 0.986 Test Loss: 0.057 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 6.601145505905151
Epoch: 30, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 6.292115926742554
Epoch: 31, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 5.917210578918457
Epoch: 32, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.053 Vali Acc: 0.988 Test Loss: 0.053 Test Acc: 0.988
Validation loss decreased (-0.986072 --> -0.988161).  Saving model ...
Epoch: 33 cost time: 5.988478422164917
Epoch: 33, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 6.596835136413574
Epoch: 34, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.112 Vali Acc: 0.967 Test Loss: 0.112 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 6.733199596405029
Epoch: 35, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 6.103877067565918
Epoch: 36, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.067 Vali Acc: 0.981 Test Loss: 0.067 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 6.389267206192017
Epoch: 37, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.048 Vali Acc: 0.987 Test Loss: 0.048 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 5.903765678405762
Epoch: 38, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.057 Vali Acc: 0.983 Test Loss: 0.057 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 6.045253038406372
Epoch: 39, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 6.46406102180481
Epoch: 40, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 5.74494194984436
Epoch: 41, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 5.568979501724243
Epoch: 42, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9881615598885793
model parameter : 193412
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.875949144363403
Epoch: 1, Steps: 89 | Train Loss: 2.925 Vali Loss: 2.523 Vali Acc: 0.457 Test Loss: 2.523 Test Acc: 0.457
Validation loss decreased (inf --> -0.456799).  Saving model ...
Epoch: 2 cost time: 5.84223747253418
Epoch: 2, Steps: 89 | Train Loss: 1.957 Vali Loss: 1.266 Vali Acc: 0.742 Test Loss: 1.266 Test Acc: 0.742
Validation loss decreased (-0.456799 --> -0.742327).  Saving model ...
Epoch: 3 cost time: 6.002227067947388
Epoch: 3, Steps: 89 | Train Loss: 0.934 Vali Loss: 0.656 Vali Acc: 0.855 Test Loss: 0.656 Test Acc: 0.855
Validation loss decreased (-0.742327 --> -0.855147).  Saving model ...
Epoch: 4 cost time: 5.847440004348755
Epoch: 4, Steps: 89 | Train Loss: 0.544 Vali Loss: 0.423 Vali Acc: 0.898 Test Loss: 0.423 Test Acc: 0.898
Validation loss decreased (-0.855147 --> -0.898324).  Saving model ...
Epoch: 5 cost time: 6.40453314781189
Epoch: 5, Steps: 89 | Train Loss: 0.378 Vali Loss: 0.380 Vali Acc: 0.916 Test Loss: 0.380 Test Acc: 0.916
Validation loss decreased (-0.898324 --> -0.915734).  Saving model ...
Epoch: 6 cost time: 5.9254233837127686
Epoch: 6, Steps: 89 | Train Loss: 0.288 Vali Loss: 0.278 Vali Acc: 0.923 Test Loss: 0.278 Test Acc: 0.923
Validation loss decreased (-0.915734 --> -0.922699).  Saving model ...
Epoch: 7 cost time: 5.689674615859985
Epoch: 7, Steps: 89 | Train Loss: 0.228 Vali Loss: 0.258 Vali Acc: 0.928 Test Loss: 0.258 Test Acc: 0.928
Validation loss decreased (-0.922699 --> -0.928270).  Saving model ...
Epoch: 8 cost time: 5.8911988735198975
Epoch: 8, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.203 Vali Acc: 0.936 Test Loss: 0.203 Test Acc: 0.936
Validation loss decreased (-0.928270 --> -0.935931).  Saving model ...
Epoch: 9 cost time: 5.5425450801849365
Epoch: 9, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
Validation loss decreased (-0.935931 --> -0.958912).  Saving model ...
Epoch: 10 cost time: 6.064345359802246
Epoch: 10, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.289738416671753
Epoch: 11, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.132 Vali Acc: 0.967 Test Loss: 0.132 Test Acc: 0.967
Validation loss decreased (-0.958912 --> -0.966573).  Saving model ...
Epoch: 12 cost time: 6.188542127609253
Epoch: 12, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
Validation loss decreased (-0.966573 --> -0.970751).  Saving model ...
Epoch: 13 cost time: 6.17603874206543
Epoch: 13, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.104 Vali Acc: 0.967 Test Loss: 0.104 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.532797574996948
Epoch: 14, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
Validation loss decreased (-0.970751 --> -0.970751).  Saving model ...
Epoch: 15 cost time: 6.43412709236145
Epoch: 15, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.100751638412476
Epoch: 16, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
Validation loss decreased (-0.970751 --> -0.979108).  Saving model ...
Epoch: 17 cost time: 6.3382887840271
Epoch: 17, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.092 Vali Acc: 0.969 Test Loss: 0.092 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.254324197769165
Epoch: 18, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.083 Vali Acc: 0.975 Test Loss: 0.083 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.967917442321777
Epoch: 19, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 7.164738893508911
Epoch: 20, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.092 Vali Acc: 0.971 Test Loss: 0.092 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.953204393386841
Epoch: 21, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.095 Vali Acc: 0.971 Test Loss: 0.095 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.6885082721710205
Epoch: 22, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979108 --> -0.979804).  Saving model ...
Epoch: 23 cost time: 6.252958536148071
Epoch: 23, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 7.115132093429565
Epoch: 24, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979804 --> -0.979804).  Saving model ...
Epoch: 25 cost time: 6.271434783935547
Epoch: 25, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.069 Vali Acc: 0.979 Test Loss: 0.069 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.688547134399414
Epoch: 26, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.61011004447937
Epoch: 27, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 6.327794790267944
Epoch: 28, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 5.531775712966919
Epoch: 29, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980501).  Saving model ...
Epoch: 30 cost time: 5.789008617401123
Epoch: 30, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.976360321044922
Epoch: 31, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
Validation loss decreased (-0.980501 --> -0.980501).  Saving model ...
Epoch: 32 cost time: 6.356289863586426
Epoch: 32, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.067 Vali Acc: 0.981 Test Loss: 0.067 Test Acc: 0.981
Validation loss decreased (-0.980501 --> -0.980501).  Saving model ...
Epoch: 33 cost time: 6.215576648712158
Epoch: 33, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.073 Vali Acc: 0.982 Test Loss: 0.073 Test Acc: 0.982
Validation loss decreased (-0.980501 --> -0.981893).  Saving model ...
Epoch: 34 cost time: 6.167712926864624
Epoch: 34, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 6.273150682449341
Epoch: 35, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 5.992974042892456
Epoch: 36, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.064 Vali Acc: 0.981 Test Loss: 0.064 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 6.285218000411987
Epoch: 37, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.065 Vali Acc: 0.984 Test Loss: 0.065 Test Acc: 0.984
Validation loss decreased (-0.981893 --> -0.983983).  Saving model ...
Epoch: 38 cost time: 6.465572834014893
Epoch: 38, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 6.166770935058594
Epoch: 39, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 6.07911229133606
Epoch: 40, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.075 Vali Acc: 0.979 Test Loss: 0.075 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 6.029815196990967
Epoch: 41, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 6.327323913574219
Epoch: 42, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 5.7584943771362305
Epoch: 43, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 5.751266717910767
Epoch: 44, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 6.258146047592163
Epoch: 45, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.065 Vali Acc: 0.984 Test Loss: 0.065 Test Acc: 0.984
Validation loss decreased (-0.983983 --> -0.983983).  Saving model ...
Epoch: 46 cost time: 6.301696062088013
Epoch: 46, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 6.177394866943359
Epoch: 47, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.088 Vali Acc: 0.972 Test Loss: 0.088 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 6.031107664108276
Epoch: 48, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 5.5700085163116455
Epoch: 49, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 5.2344810962677
Epoch: 50, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 6.159843921661377
Epoch: 51, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 5.92151141166687
Epoch: 52, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.135 Vali Acc: 0.964 Test Loss: 0.135 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 5.6410112380981445
Epoch: 53, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 5.508238792419434
Epoch: 54, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 6.08747673034668
Epoch: 55, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 192516
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.854918003082275
Epoch: 1, Steps: 89 | Train Loss: 2.976 Vali Loss: 2.656 Vali Acc: 0.235 Test Loss: 2.656 Test Acc: 0.235
Validation loss decreased (inf --> -0.234653).  Saving model ...
Epoch: 2 cost time: 6.189935684204102
Epoch: 2, Steps: 89 | Train Loss: 2.076 Vali Loss: 1.329 Vali Acc: 0.743 Test Loss: 1.329 Test Acc: 0.743
Validation loss decreased (-0.234653 --> -0.743023).  Saving model ...
Epoch: 3 cost time: 6.355402946472168
Epoch: 3, Steps: 89 | Train Loss: 0.957 Vali Loss: 0.652 Vali Acc: 0.826 Test Loss: 0.652 Test Acc: 0.826
Validation loss decreased (-0.743023 --> -0.825899).  Saving model ...
Epoch: 4 cost time: 5.999732255935669
Epoch: 4, Steps: 89 | Train Loss: 0.539 Vali Loss: 0.451 Vali Acc: 0.898 Test Loss: 0.451 Test Acc: 0.898
Validation loss decreased (-0.825899 --> -0.898324).  Saving model ...
Epoch: 5 cost time: 6.231562614440918
Epoch: 5, Steps: 89 | Train Loss: 0.384 Vali Loss: 0.349 Vali Acc: 0.911 Test Loss: 0.349 Test Acc: 0.911
Validation loss decreased (-0.898324 --> -0.910860).  Saving model ...
Epoch: 6 cost time: 6.235133171081543
Epoch: 6, Steps: 89 | Train Loss: 0.289 Vali Loss: 0.251 Vali Acc: 0.942 Test Loss: 0.251 Test Acc: 0.942
Validation loss decreased (-0.910860 --> -0.942198).  Saving model ...
Epoch: 7 cost time: 5.862684488296509
Epoch: 7, Steps: 89 | Train Loss: 0.212 Vali Loss: 0.188 Vali Acc: 0.953 Test Loss: 0.188 Test Acc: 0.953
Validation loss decreased (-0.942198 --> -0.952644).  Saving model ...
Epoch: 8 cost time: 6.168962001800537
Epoch: 8, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.161 Vali Acc: 0.962 Test Loss: 0.161 Test Acc: 0.962
Validation loss decreased (-0.952644 --> -0.962394).  Saving model ...
Epoch: 9 cost time: 5.996654033660889
Epoch: 9, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.157 Vali Acc: 0.955 Test Loss: 0.157 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.600885391235352
Epoch: 10, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.140 Vali Acc: 0.964 Test Loss: 0.140 Test Acc: 0.964
Validation loss decreased (-0.962394 --> -0.963787).  Saving model ...
Epoch: 11 cost time: 6.46959376335144
Epoch: 11, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
Validation loss decreased (-0.963787 --> -0.971447).  Saving model ...
Epoch: 12 cost time: 5.892899513244629
Epoch: 12, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.6815431118011475
Epoch: 13, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.688802242279053
Epoch: 14, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.130 Vali Acc: 0.967 Test Loss: 0.130 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.177858591079712
Epoch: 15, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
Validation loss decreased (-0.971447 --> -0.974929).  Saving model ...
Epoch: 16 cost time: 6.8553383350372314
Epoch: 16, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
Validation loss decreased (-0.974929 --> -0.981197).  Saving model ...
Epoch: 17 cost time: 5.9319939613342285
Epoch: 17, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.657368183135986
Epoch: 18, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.072 Vali Acc: 0.984 Test Loss: 0.072 Test Acc: 0.984
Validation loss decreased (-0.981197 --> -0.983983).  Saving model ...
Epoch: 19 cost time: 5.883437395095825
Epoch: 19, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.074 Vali Acc: 0.982 Test Loss: 0.074 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.770619869232178
Epoch: 20, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.654371500015259
Epoch: 21, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.079 Vali Acc: 0.982 Test Loss: 0.079 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.645214319229126
Epoch: 22, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.390237092971802
Epoch: 23, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 6.34227442741394
Epoch: 24, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 6.433239698410034
Epoch: 25, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.085 Vali Acc: 0.974 Test Loss: 0.085 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 6.264594078063965
Epoch: 26, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.65237283706665
Epoch: 27, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.964831113815308
Epoch: 28, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.149 Vali Acc: 0.967 Test Loss: 0.149 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 191620
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.325496673583984
Epoch: 1, Steps: 89 | Train Loss: 1.782 Vali Loss: 0.529 Vali Acc: 0.833 Test Loss: 0.529 Test Acc: 0.833
Validation loss decreased (inf --> -0.832864).  Saving model ...
Epoch: 2 cost time: 4.356365442276001
Epoch: 2, Steps: 89 | Train Loss: 0.384 Vali Loss: 0.395 Vali Acc: 0.894 Test Loss: 0.395 Test Acc: 0.894
Validation loss decreased (-0.832864 --> -0.894146).  Saving model ...
Epoch: 3 cost time: 4.437835216522217
Epoch: 3, Steps: 89 | Train Loss: 0.242 Vali Loss: 0.220 Vali Acc: 0.939 Test Loss: 0.220 Test Acc: 0.939
Validation loss decreased (-0.894146 --> -0.939413).  Saving model ...
Epoch: 4 cost time: 4.63366961479187
Epoch: 4, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.367 Vali Acc: 0.898 Test Loss: 0.367 Test Acc: 0.898
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.180579662322998
Epoch: 5, Steps: 89 | Train Loss: 0.226 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.939413 --> -0.943591).  Saving model ...
Epoch: 6 cost time: 4.139491558074951
Epoch: 6, Steps: 89 | Train Loss: 0.182 Vali Loss: 0.593 Vali Acc: 0.837 Test Loss: 0.593 Test Acc: 0.837
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.35162878036499
Epoch: 7, Steps: 89 | Train Loss: 0.252 Vali Loss: 0.366 Vali Acc: 0.904 Test Loss: 0.366 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.174782991409302
Epoch: 8, Steps: 89 | Train Loss: 0.205 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
Validation loss decreased (-0.943591 --> -0.949163).  Saving model ...
Epoch: 9 cost time: 5.194226503372192
Epoch: 9, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.206 Vali Acc: 0.946 Test Loss: 0.206 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.175992012023926
Epoch: 10, Steps: 89 | Train Loss: 0.236 Vali Loss: 0.314 Vali Acc: 0.923 Test Loss: 0.314 Test Acc: 0.923
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.87983512878418
Epoch: 11, Steps: 89 | Train Loss: 0.268 Vali Loss: 0.229 Vali Acc: 0.942 Test Loss: 0.229 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.591876268386841
Epoch: 12, Steps: 89 | Train Loss: 0.308 Vali Loss: 0.479 Vali Acc: 0.900 Test Loss: 0.479 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.603585243225098
Epoch: 13, Steps: 89 | Train Loss: 0.469 Vali Loss: 0.651 Vali Acc: 0.875 Test Loss: 0.651 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.724632978439331
Epoch: 14, Steps: 89 | Train Loss: 0.660 Vali Loss: 0.590 Vali Acc: 0.878 Test Loss: 0.590 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.8492913246154785
Epoch: 15, Steps: 89 | Train Loss: 0.847 Vali Loss: 0.865 Vali Acc: 0.811 Test Loss: 0.865 Test Acc: 0.811
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.170860767364502
Epoch: 16, Steps: 89 | Train Loss: 1.260 Vali Loss: 2.149 Vali Acc: 0.497 Test Loss: 2.149 Test Acc: 0.497
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.61934757232666
Epoch: 17, Steps: 89 | Train Loss: 2.284 Vali Loss: 3.378 Vali Acc: 0.292 Test Loss: 3.378 Test Acc: 0.292
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.950423717498779
Epoch: 18, Steps: 89 | Train Loss: 1.925 Vali Loss: 0.747 Vali Acc: 0.770 Test Loss: 0.747 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9491643454038997
model parameter : 8079160
model size : 35.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.490764856338501
Epoch: 1, Steps: 89 | Train Loss: 1.773 Vali Loss: 0.494 Vali Acc: 0.850 Test Loss: 0.494 Test Acc: 0.850
Validation loss decreased (inf --> -0.850274).  Saving model ...
Epoch: 2 cost time: 4.328399896621704
Epoch: 2, Steps: 89 | Train Loss: 0.416 Vali Loss: 0.347 Vali Acc: 0.884 Test Loss: 0.347 Test Acc: 0.884
Validation loss decreased (-0.850274 --> -0.883701).  Saving model ...
Epoch: 3 cost time: 4.485080718994141
Epoch: 3, Steps: 89 | Train Loss: 0.285 Vali Loss: 0.148 Vali Acc: 0.955 Test Loss: 0.148 Test Acc: 0.955
Validation loss decreased (-0.883701 --> -0.954734).  Saving model ...
Epoch: 4 cost time: 4.277946710586548
Epoch: 4, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.229 Vali Acc: 0.938 Test Loss: 0.229 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.640731334686279
Epoch: 5, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.301 Vali Acc: 0.942 Test Loss: 0.301 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.36559796333313
Epoch: 6, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.238 Vali Acc: 0.938 Test Loss: 0.238 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.8751866817474365
Epoch: 7, Steps: 89 | Train Loss: 0.209 Vali Loss: 0.217 Vali Acc: 0.942 Test Loss: 0.217 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.540569305419922
Epoch: 8, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.211 Vali Acc: 0.956 Test Loss: 0.211 Test Acc: 0.956
Validation loss decreased (-0.954734 --> -0.956126).  Saving model ...
Epoch: 9 cost time: 4.547367572784424
Epoch: 9, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.355 Vali Acc: 0.900 Test Loss: 0.355 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.481162786483765
Epoch: 10, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.396 Vali Acc: 0.903 Test Loss: 0.396 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.548723220825195
Epoch: 11, Steps: 89 | Train Loss: 0.386 Vali Loss: 0.307 Vali Acc: 0.914 Test Loss: 0.307 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.359980344772339
Epoch: 12, Steps: 89 | Train Loss: 0.378 Vali Loss: 0.471 Vali Acc: 0.900 Test Loss: 0.471 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.421587228775024
Epoch: 13, Steps: 89 | Train Loss: 0.532 Vali Loss: 0.824 Vali Acc: 0.831 Test Loss: 0.824 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.835782527923584
Epoch: 14, Steps: 89 | Train Loss: 0.944 Vali Loss: 0.995 Vali Acc: 0.753 Test Loss: 0.995 Test Acc: 0.753
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.531196355819702
Epoch: 15, Steps: 89 | Train Loss: 0.830 Vali Loss: 0.741 Vali Acc: 0.827 Test Loss: 0.741 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.1296069622039795
Epoch: 16, Steps: 89 | Train Loss: 1.800 Vali Loss: 1.681 Vali Acc: 0.518 Test Loss: 1.681 Test Acc: 0.518
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.752326011657715
Epoch: 17, Steps: 89 | Train Loss: 1.086 Vali Loss: 0.672 Vali Acc: 0.808 Test Loss: 0.672 Test Acc: 0.808
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.442761182785034
Epoch: 18, Steps: 89 | Train Loss: 0.663 Vali Loss: 0.548 Vali Acc: 0.850 Test Loss: 0.548 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9561281337047354
model parameter : 8073016
model size : 35.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.836609125137329
Epoch: 1, Steps: 89 | Train Loss: 1.814 Vali Loss: 0.597 Vali Acc: 0.787 Test Loss: 0.597 Test Acc: 0.787
Validation loss decreased (inf --> -0.786902).  Saving model ...
Epoch: 2 cost time: 4.186266660690308
Epoch: 2, Steps: 89 | Train Loss: 0.409 Vali Loss: 0.242 Vali Acc: 0.935 Test Loss: 0.242 Test Acc: 0.935
Validation loss decreased (-0.786902 --> -0.934538).  Saving model ...
Epoch: 3 cost time: 4.4116370677948
Epoch: 3, Steps: 89 | Train Loss: 0.310 Vali Loss: 0.452 Vali Acc: 0.907 Test Loss: 0.452 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.026025295257568
Epoch: 4, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.162 Vali Acc: 0.952 Test Loss: 0.162 Test Acc: 0.952
Validation loss decreased (-0.934538 --> -0.951948).  Saving model ...
Epoch: 5 cost time: 4.729557275772095
Epoch: 5, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.232 Vali Acc: 0.935 Test Loss: 0.232 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.384819030761719
Epoch: 6, Steps: 89 | Train Loss: 0.225 Vali Loss: 0.155 Vali Acc: 0.958 Test Loss: 0.155 Test Acc: 0.958
Validation loss decreased (-0.951948 --> -0.957519).  Saving model ...
Epoch: 7 cost time: 4.587087869644165
Epoch: 7, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.595 Vali Acc: 0.877 Test Loss: 0.595 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.957327604293823
Epoch: 8, Steps: 89 | Train Loss: 0.231 Vali Loss: 0.244 Vali Acc: 0.942 Test Loss: 0.244 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.357426881790161
Epoch: 9, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.308 Vali Acc: 0.933 Test Loss: 0.308 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.941763639450073
Epoch: 10, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.189 Vali Acc: 0.948 Test Loss: 0.189 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.7421324253082275
Epoch: 11, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.260 Vali Acc: 0.937 Test Loss: 0.260 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.693525552749634
Epoch: 12, Steps: 89 | Train Loss: 0.325 Vali Loss: 0.301 Vali Acc: 0.936 Test Loss: 0.301 Test Acc: 0.936
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.419541358947754
Epoch: 13, Steps: 89 | Train Loss: 0.717 Vali Loss: 1.502 Vali Acc: 0.620 Test Loss: 1.502 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.552177429199219
Epoch: 14, Steps: 89 | Train Loss: 1.095 Vali Loss: 0.885 Vali Acc: 0.816 Test Loss: 0.885 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.6924049854278564
Epoch: 15, Steps: 89 | Train Loss: 1.193 Vali Loss: 1.268 Vali Acc: 0.719 Test Loss: 1.268 Test Acc: 0.719
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.913127183914185
Epoch: 16, Steps: 89 | Train Loss: 1.243 Vali Loss: 0.946 Vali Acc: 0.772 Test Loss: 0.946 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9575208913649025
model parameter : 8066872
model size : 35.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.760191917419434
Epoch: 1, Steps: 89 | Train Loss: 1.763 Vali Loss: 0.534 Vali Acc: 0.828 Test Loss: 0.534 Test Acc: 0.828
Validation loss decreased (inf --> -0.827989).  Saving model ...
Epoch: 2 cost time: 4.554456949234009
Epoch: 2, Steps: 89 | Train Loss: 0.460 Vali Loss: 0.332 Vali Acc: 0.886 Test Loss: 0.332 Test Acc: 0.886
Validation loss decreased (-0.827989 --> -0.886487).  Saving model ...
Epoch: 3 cost time: 4.00891637802124
Epoch: 3, Steps: 89 | Train Loss: 0.300 Vali Loss: 0.379 Vali Acc: 0.885 Test Loss: 0.379 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.012531995773315
Epoch: 4, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
Validation loss decreased (-0.886487 --> -0.951948).  Saving model ...
Epoch: 5 cost time: 3.981234550476074
Epoch: 5, Steps: 89 | Train Loss: 0.206 Vali Loss: 0.232 Vali Acc: 0.932 Test Loss: 0.232 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.232343673706055
Epoch: 6, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.243 Vali Acc: 0.936 Test Loss: 0.243 Test Acc: 0.936
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.282530069351196
Epoch: 7, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.235413312911987
Epoch: 8, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.362 Vali Acc: 0.902 Test Loss: 0.362 Test Acc: 0.902
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.064520359039307
Epoch: 9, Steps: 89 | Train Loss: 0.259 Vali Loss: 0.297 Vali Acc: 0.925 Test Loss: 0.297 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.239698171615601
Epoch: 10, Steps: 89 | Train Loss: 0.261 Vali Loss: 0.304 Vali Acc: 0.932 Test Loss: 0.304 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.345381498336792
Epoch: 11, Steps: 89 | Train Loss: 0.295 Vali Loss: 0.290 Vali Acc: 0.925 Test Loss: 0.290 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.706322193145752
Epoch: 12, Steps: 89 | Train Loss: 0.367 Vali Loss: 0.480 Vali Acc: 0.880 Test Loss: 0.480 Test Acc: 0.880
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.9801111221313477
Epoch: 13, Steps: 89 | Train Loss: 0.395 Vali Loss: 0.587 Vali Acc: 0.849 Test Loss: 0.587 Test Acc: 0.849
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.109866380691528
Epoch: 14, Steps: 89 | Train Loss: 0.562 Vali Loss: 0.387 Vali Acc: 0.918 Test Loss: 0.387 Test Acc: 0.918
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9519498607242339
model parameter : 8060728
model size : 35.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.63637375831604
Epoch: 1, Steps: 89 | Train Loss: 1.886 Vali Loss: 0.643 Vali Acc: 0.803 Test Loss: 0.643 Test Acc: 0.803
Validation loss decreased (inf --> -0.802918).  Saving model ...
Epoch: 2 cost time: 4.404763221740723
Epoch: 2, Steps: 89 | Train Loss: 0.408 Vali Loss: 0.295 Vali Acc: 0.911 Test Loss: 0.295 Test Acc: 0.911
Validation loss decreased (-0.802918 --> -0.910861).  Saving model ...
Epoch: 3 cost time: 4.806956768035889
Epoch: 3, Steps: 89 | Train Loss: 0.223 Vali Loss: 0.292 Vali Acc: 0.930 Test Loss: 0.292 Test Acc: 0.930
Validation loss decreased (-0.910861 --> -0.929663).  Saving model ...
Epoch: 4 cost time: 4.610581636428833
Epoch: 4, Steps: 89 | Train Loss: 0.209 Vali Loss: 0.140 Vali Acc: 0.960 Test Loss: 0.140 Test Acc: 0.960
Validation loss decreased (-0.929663 --> -0.960305).  Saving model ...
Epoch: 5 cost time: 4.922059535980225
Epoch: 5, Steps: 89 | Train Loss: 0.254 Vali Loss: 0.321 Vali Acc: 0.921 Test Loss: 0.321 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.3736467361450195
Epoch: 6, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.296 Vali Acc: 0.921 Test Loss: 0.296 Test Acc: 0.921
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.69900369644165
Epoch: 7, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.173 Vali Acc: 0.960 Test Loss: 0.173 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.52089262008667
Epoch: 8, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.137 Vali Acc: 0.963 Test Loss: 0.137 Test Acc: 0.963
Validation loss decreased (-0.960305 --> -0.963091).  Saving model ...
Epoch: 9 cost time: 4.4921956062316895
Epoch: 9, Steps: 89 | Train Loss: 0.218 Vali Loss: 0.288 Vali Acc: 0.937 Test Loss: 0.288 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.956796884536743
Epoch: 10, Steps: 89 | Train Loss: 0.211 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.863243818283081
Epoch: 11, Steps: 89 | Train Loss: 0.273 Vali Loss: 0.239 Vali Acc: 0.939 Test Loss: 0.239 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.858303546905518
Epoch: 12, Steps: 89 | Train Loss: 0.293 Vali Loss: 0.350 Vali Acc: 0.909 Test Loss: 0.350 Test Acc: 0.909
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.55604887008667
Epoch: 13, Steps: 89 | Train Loss: 0.389 Vali Loss: 0.474 Vali Acc: 0.889 Test Loss: 0.474 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.381521224975586
Epoch: 14, Steps: 89 | Train Loss: 1.057 Vali Loss: 1.047 Vali Acc: 0.748 Test Loss: 1.047 Test Acc: 0.748
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.340452432632446
Epoch: 15, Steps: 89 | Train Loss: 1.034 Vali Loss: 0.745 Vali Acc: 0.804 Test Loss: 0.745 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.308328628540039
Epoch: 16, Steps: 89 | Train Loss: 1.217 Vali Loss: 1.069 Vali Acc: 0.734 Test Loss: 1.069 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.164294004440308
Epoch: 17, Steps: 89 | Train Loss: 3.603 Vali Loss: 4.008 Vali Acc: 0.046 Test Loss: 4.008 Test Acc: 0.046
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.5338969230651855
Epoch: 18, Steps: 89 | Train Loss: 3.730 Vali Loss: 3.308 Vali Acc: 0.048 Test Loss: 3.308 Test Acc: 0.048
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.963091922005571
model parameter : 6765880
model size : 30.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.87023401260376
Epoch: 1, Steps: 89 | Train Loss: 1.744 Vali Loss: 0.607 Vali Acc: 0.803 Test Loss: 0.607 Test Acc: 0.803
Validation loss decreased (inf --> -0.802919).  Saving model ...
Epoch: 2 cost time: 4.281391859054565
Epoch: 2, Steps: 89 | Train Loss: 0.408 Vali Loss: 0.237 Vali Acc: 0.932 Test Loss: 0.237 Test Acc: 0.932
Validation loss decreased (-0.802919 --> -0.932449).  Saving model ...
Epoch: 3 cost time: 4.396698713302612
Epoch: 3, Steps: 89 | Train Loss: 0.267 Vali Loss: 0.227 Vali Acc: 0.920 Test Loss: 0.227 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.438981533050537
Epoch: 4, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.203 Vali Acc: 0.937 Test Loss: 0.203 Test Acc: 0.937
Validation loss decreased (-0.932449 --> -0.936627).  Saving model ...
Epoch: 5 cost time: 4.036653757095337
Epoch: 5, Steps: 89 | Train Loss: 0.234 Vali Loss: 0.437 Vali Acc: 0.890 Test Loss: 0.437 Test Acc: 0.890
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.09345269203186
Epoch: 6, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.207 Vali Acc: 0.937 Test Loss: 0.207 Test Acc: 0.937
Validation loss decreased (-0.936627 --> -0.937324).  Saving model ...
Epoch: 7 cost time: 4.452827453613281
Epoch: 7, Steps: 89 | Train Loss: 0.230 Vali Loss: 0.305 Vali Acc: 0.914 Test Loss: 0.305 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.2716920375823975
Epoch: 8, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.282 Vali Acc: 0.928 Test Loss: 0.282 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.0275561809539795
Epoch: 9, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.222 Vali Acc: 0.949 Test Loss: 0.222 Test Acc: 0.949
Validation loss decreased (-0.937324 --> -0.949162).  Saving model ...
Epoch: 10 cost time: 4.600287675857544
Epoch: 10, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.209 Vali Acc: 0.951 Test Loss: 0.209 Test Acc: 0.951
Validation loss decreased (-0.949162 --> -0.951251).  Saving model ...
Epoch: 11 cost time: 5.011950969696045
Epoch: 11, Steps: 89 | Train Loss: 0.197 Vali Loss: 0.309 Vali Acc: 0.918 Test Loss: 0.309 Test Acc: 0.918
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.753030061721802
Epoch: 12, Steps: 89 | Train Loss: 0.292 Vali Loss: 0.557 Vali Acc: 0.882 Test Loss: 0.557 Test Acc: 0.882
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.40249228477478
Epoch: 13, Steps: 89 | Train Loss: 0.647 Vali Loss: 0.649 Vali Acc: 0.859 Test Loss: 0.649 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.8324432373046875
Epoch: 14, Steps: 89 | Train Loss: 1.123 Vali Loss: 0.551 Vali Acc: 0.869 Test Loss: 0.551 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.788995265960693
Epoch: 15, Steps: 89 | Train Loss: 1.925 Vali Loss: 1.193 Vali Acc: 0.675 Test Loss: 1.193 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.552617073059082
Epoch: 16, Steps: 89 | Train Loss: 1.088 Vali Loss: 0.609 Vali Acc: 0.847 Test Loss: 0.609 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.9028308391571045
Epoch: 17, Steps: 89 | Train Loss: 0.924 Vali Loss: 1.395 Vali Acc: 0.664 Test Loss: 1.395 Test Acc: 0.664
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.592293977737427
Epoch: 18, Steps: 89 | Train Loss: 1.305 Vali Loss: 1.166 Vali Acc: 0.739 Test Loss: 1.166 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.1872336864471436
Epoch: 19, Steps: 89 | Train Loss: 1.974 Vali Loss: 1.553 Vali Acc: 0.572 Test Loss: 1.553 Test Acc: 0.572
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.836163759231567
Epoch: 20, Steps: 89 | Train Loss: 2.516 Vali Loss: 2.403 Vali Acc: 0.323 Test Loss: 2.403 Test Acc: 0.323
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9512534818941504
model parameter : 6759736
model size : 30.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.878233909606934
Epoch: 1, Steps: 89 | Train Loss: 1.781 Vali Loss: 0.551 Vali Acc: 0.847 Test Loss: 0.551 Test Acc: 0.847
Validation loss decreased (inf --> -0.846791).  Saving model ...
Epoch: 2 cost time: 4.4422078132629395
Epoch: 2, Steps: 89 | Train Loss: 0.456 Vali Loss: 0.272 Vali Acc: 0.919 Test Loss: 0.272 Test Acc: 0.919
Validation loss decreased (-0.846791 --> -0.919217).  Saving model ...
Epoch: 3 cost time: 4.7846760749816895
Epoch: 3, Steps: 89 | Train Loss: 0.258 Vali Loss: 0.238 Vali Acc: 0.930 Test Loss: 0.238 Test Acc: 0.930
Validation loss decreased (-0.919217 --> -0.930360).  Saving model ...
Epoch: 4 cost time: 4.6435322761535645
Epoch: 4, Steps: 89 | Train Loss: 0.287 Vali Loss: 0.262 Vali Acc: 0.923 Test Loss: 0.262 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.591386795043945
Epoch: 5, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
Validation loss decreased (-0.930360 --> -0.950555).  Saving model ...
Epoch: 6 cost time: 4.382107734680176
Epoch: 6, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.318 Vali Acc: 0.924 Test Loss: 0.318 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.221879482269287
Epoch: 7, Steps: 89 | Train Loss: 0.227 Vali Loss: 0.259 Vali Acc: 0.939 Test Loss: 0.259 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.315410614013672
Epoch: 8, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
Validation loss decreased (-0.950555 --> -0.962394).  Saving model ...
Epoch: 9 cost time: 4.446062803268433
Epoch: 9, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.263 Vali Acc: 0.940 Test Loss: 0.263 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.610613584518433
Epoch: 10, Steps: 89 | Train Loss: 0.195 Vali Loss: 0.232 Vali Acc: 0.948 Test Loss: 0.232 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.450740337371826
Epoch: 11, Steps: 89 | Train Loss: 0.242 Vali Loss: 0.323 Vali Acc: 0.932 Test Loss: 0.323 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.522109270095825
Epoch: 12, Steps: 89 | Train Loss: 0.294 Vali Loss: 0.463 Vali Acc: 0.880 Test Loss: 0.463 Test Acc: 0.880
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.688883304595947
Epoch: 13, Steps: 89 | Train Loss: 0.556 Vali Loss: 0.649 Vali Acc: 0.874 Test Loss: 0.649 Test Acc: 0.874
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.127752780914307
Epoch: 14, Steps: 89 | Train Loss: 0.608 Vali Loss: 0.578 Vali Acc: 0.877 Test Loss: 0.578 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.909210205078125
Epoch: 15, Steps: 89 | Train Loss: 1.007 Vali Loss: 1.139 Vali Acc: 0.747 Test Loss: 1.139 Test Acc: 0.747
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.793563604354858
Epoch: 16, Steps: 89 | Train Loss: 1.011 Vali Loss: 1.026 Vali Acc: 0.778 Test Loss: 1.026 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.619372844696045
Epoch: 17, Steps: 89 | Train Loss: 1.109 Vali Loss: 2.045 Vali Acc: 0.620 Test Loss: 2.045 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.045675277709961
Epoch: 18, Steps: 89 | Train Loss: 1.125 Vali Loss: 0.741 Vali Acc: 0.822 Test Loss: 0.741 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9623955431754875
model parameter : 6753592
model size : 30.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.366828441619873
Epoch: 1, Steps: 89 | Train Loss: 1.857 Vali Loss: 0.540 Vali Acc: 0.846 Test Loss: 0.540 Test Acc: 0.846
Validation loss decreased (inf --> -0.846095).  Saving model ...
Epoch: 2 cost time: 4.822134017944336
Epoch: 2, Steps: 89 | Train Loss: 0.424 Vali Loss: 0.261 Vali Acc: 0.927 Test Loss: 0.261 Test Acc: 0.927
Validation loss decreased (-0.846095 --> -0.926878).  Saving model ...
Epoch: 3 cost time: 5.318145513534546
Epoch: 3, Steps: 89 | Train Loss: 0.259 Vali Loss: 0.369 Vali Acc: 0.884 Test Loss: 0.369 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.615522146224976
Epoch: 4, Steps: 89 | Train Loss: 0.253 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.926878 --> -0.943591).  Saving model ...
Epoch: 5 cost time: 5.140790700912476
Epoch: 5, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.247 Vali Acc: 0.925 Test Loss: 0.247 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.976015567779541
Epoch: 6, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.273 Vali Acc: 0.932 Test Loss: 0.273 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.496461868286133
Epoch: 7, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.253 Vali Acc: 0.940 Test Loss: 0.253 Test Acc: 0.940
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.186645269393921
Epoch: 8, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.340 Vali Acc: 0.932 Test Loss: 0.340 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.737704515457153
Epoch: 9, Steps: 89 | Train Loss: 0.241 Vali Loss: 0.210 Vali Acc: 0.952 Test Loss: 0.210 Test Acc: 0.952
Validation loss decreased (-0.943591 --> -0.951948).  Saving model ...
Epoch: 10 cost time: 4.478918552398682
Epoch: 10, Steps: 89 | Train Loss: 0.205 Vali Loss: 0.506 Vali Acc: 0.880 Test Loss: 0.506 Test Acc: 0.880
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.64978551864624
Epoch: 11, Steps: 89 | Train Loss: 0.345 Vali Loss: 0.511 Vali Acc: 0.889 Test Loss: 0.511 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.528717994689941
Epoch: 12, Steps: 89 | Train Loss: 0.415 Vali Loss: 0.603 Vali Acc: 0.857 Test Loss: 0.603 Test Acc: 0.857
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.711222410202026
Epoch: 13, Steps: 89 | Train Loss: 0.427 Vali Loss: 0.741 Vali Acc: 0.853 Test Loss: 0.741 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.59355902671814
Epoch: 14, Steps: 89 | Train Loss: 0.476 Vali Loss: 0.592 Vali Acc: 0.848 Test Loss: 0.592 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.62230110168457
Epoch: 15, Steps: 89 | Train Loss: 0.560 Vali Loss: 0.362 Vali Acc: 0.903 Test Loss: 0.362 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.717450380325317
Epoch: 16, Steps: 89 | Train Loss: 0.423 Vali Loss: 0.670 Vali Acc: 0.865 Test Loss: 0.670 Test Acc: 0.865
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.5834197998046875
Epoch: 17, Steps: 89 | Train Loss: 0.368 Vali Loss: 0.884 Vali Acc: 0.797 Test Loss: 0.884 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.954803705215454
Epoch: 18, Steps: 89 | Train Loss: 0.578 Vali Loss: 0.563 Vali Acc: 0.894 Test Loss: 0.563 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.486381769180298
Epoch: 19, Steps: 89 | Train Loss: 0.571 Vali Loss: 0.592 Vali Acc: 0.873 Test Loss: 0.592 Test Acc: 0.873
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9519498607242339
model parameter : 6747448
model size : 30.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.992247104644775
Epoch: 1, Steps: 89 | Train Loss: 1.838 Vali Loss: 0.677 Vali Acc: 0.786 Test Loss: 0.677 Test Acc: 0.786
Validation loss decreased (inf --> -0.786205).  Saving model ...
Epoch: 2 cost time: 4.6402692794799805
Epoch: 2, Steps: 89 | Train Loss: 0.435 Vali Loss: 0.263 Vali Acc: 0.930 Test Loss: 0.263 Test Acc: 0.930
Validation loss decreased (-0.786205 --> -0.930359).  Saving model ...
Epoch: 3 cost time: 4.702456474304199
Epoch: 3, Steps: 89 | Train Loss: 0.270 Vali Loss: 0.220 Vali Acc: 0.937 Test Loss: 0.220 Test Acc: 0.937
Validation loss decreased (-0.930359 --> -0.937324).  Saving model ...
Epoch: 4 cost time: 5.014387607574463
Epoch: 4, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.307 Vali Acc: 0.930 Test Loss: 0.307 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.37142014503479
Epoch: 5, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.172 Vali Acc: 0.951 Test Loss: 0.172 Test Acc: 0.951
Validation loss decreased (-0.937324 --> -0.950555).  Saving model ...
Epoch: 6 cost time: 5.343528985977173
Epoch: 6, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.199 Vali Acc: 0.951 Test Loss: 0.199 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.940542697906494
Epoch: 7, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.253 Vali Acc: 0.926 Test Loss: 0.253 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.546173572540283
Epoch: 8, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
Validation loss decreased (-0.950555 --> -0.958216).  Saving model ...
Epoch: 9 cost time: 5.349835634231567
Epoch: 9, Steps: 89 | Train Loss: 0.271 Vali Loss: 0.173 Vali Acc: 0.956 Test Loss: 0.173 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.758865833282471
Epoch: 10, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.211 Vali Acc: 0.947 Test Loss: 0.211 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.891159534454346
Epoch: 11, Steps: 89 | Train Loss: 0.202 Vali Loss: 0.431 Vali Acc: 0.904 Test Loss: 0.431 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.191447019577026
Epoch: 12, Steps: 89 | Train Loss: 0.309 Vali Loss: 0.263 Vali Acc: 0.939 Test Loss: 0.263 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.016161918640137
Epoch: 13, Steps: 89 | Train Loss: 0.382 Vali Loss: 0.408 Vali Acc: 0.898 Test Loss: 0.408 Test Acc: 0.898
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.6862547397613525
Epoch: 14, Steps: 89 | Train Loss: 0.656 Vali Loss: 0.934 Vali Acc: 0.797 Test Loss: 0.934 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.113943576812744
Epoch: 15, Steps: 89 | Train Loss: 1.260 Vali Loss: 1.524 Vali Acc: 0.647 Test Loss: 1.524 Test Acc: 0.647
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.728301763534546
Epoch: 16, Steps: 89 | Train Loss: 1.978 Vali Loss: 1.585 Vali Acc: 0.570 Test Loss: 1.585 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.163474798202515
Epoch: 17, Steps: 89 | Train Loss: 3.247 Vali Loss: 3.045 Vali Acc: 0.276 Test Loss: 3.045 Test Acc: 0.276
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.8419389724731445
Epoch: 18, Steps: 89 | Train Loss: 2.463 Vali Loss: 2.170 Vali Acc: 0.427 Test Loss: 2.170 Test Acc: 0.427
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.958217270194986
model parameter : 6109240
model size : 28.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.435787200927734
Epoch: 1, Steps: 89 | Train Loss: 1.871 Vali Loss: 0.552 Vali Acc: 0.840 Test Loss: 0.552 Test Acc: 0.840
Validation loss decreased (inf --> -0.839827).  Saving model ...
Epoch: 2 cost time: 4.264017820358276
Epoch: 2, Steps: 89 | Train Loss: 0.417 Vali Loss: 0.272 Vali Acc: 0.915 Test Loss: 0.272 Test Acc: 0.915
Validation loss decreased (-0.839827 --> -0.915039).  Saving model ...
Epoch: 3 cost time: 4.376492261886597
Epoch: 3, Steps: 89 | Train Loss: 0.235 Vali Loss: 0.231 Vali Acc: 0.932 Test Loss: 0.231 Test Acc: 0.932
Validation loss decreased (-0.915039 --> -0.932449).  Saving model ...
Epoch: 4 cost time: 4.588973522186279
Epoch: 4, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.213 Vali Acc: 0.938 Test Loss: 0.213 Test Acc: 0.938
Validation loss decreased (-0.932449 --> -0.938020).  Saving model ...
Epoch: 5 cost time: 4.363674640655518
Epoch: 5, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.169 Vali Acc: 0.948 Test Loss: 0.169 Test Acc: 0.948
Validation loss decreased (-0.938020 --> -0.948466).  Saving model ...
Epoch: 6 cost time: 4.563320159912109
Epoch: 6, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
Validation loss decreased (-0.948466 --> -0.949858).  Saving model ...
Epoch: 7 cost time: 4.412469148635864
Epoch: 7, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.308 Vali Acc: 0.943 Test Loss: 0.308 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.726931810379028
Epoch: 8, Steps: 89 | Train Loss: 0.232 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.364858627319336
Epoch: 9, Steps: 89 | Train Loss: 0.239 Vali Loss: 0.299 Vali Acc: 0.924 Test Loss: 0.299 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.963182210922241
Epoch: 10, Steps: 89 | Train Loss: 0.209 Vali Loss: 0.289 Vali Acc: 0.932 Test Loss: 0.289 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.989849805831909
Epoch: 11, Steps: 89 | Train Loss: 0.215 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.672175407409668
Epoch: 12, Steps: 89 | Train Loss: 0.261 Vali Loss: 0.386 Vali Acc: 0.916 Test Loss: 0.386 Test Acc: 0.916
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.994943380355835
Epoch: 13, Steps: 89 | Train Loss: 0.284 Vali Loss: 0.510 Vali Acc: 0.898 Test Loss: 0.510 Test Acc: 0.898
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.937219858169556
Epoch: 14, Steps: 89 | Train Loss: 0.578 Vali Loss: 1.333 Vali Acc: 0.737 Test Loss: 1.333 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.736509799957275
Epoch: 15, Steps: 89 | Train Loss: 1.075 Vali Loss: 1.048 Vali Acc: 0.760 Test Loss: 1.048 Test Acc: 0.760
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.8755810260772705
Epoch: 16, Steps: 89 | Train Loss: 1.542 Vali Loss: 1.097 Vali Acc: 0.744 Test Loss: 1.097 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9498607242339833
model parameter : 6103096
model size : 28.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.767657518386841
Epoch: 1, Steps: 89 | Train Loss: 1.909 Vali Loss: 0.650 Vali Acc: 0.818 Test Loss: 0.650 Test Acc: 0.818
Validation loss decreased (inf --> -0.818239).  Saving model ...
Epoch: 2 cost time: 4.955891370773315
Epoch: 2, Steps: 89 | Train Loss: 0.432 Vali Loss: 0.423 Vali Acc: 0.861 Test Loss: 0.423 Test Acc: 0.861
Validation loss decreased (-0.818239 --> -0.861416).  Saving model ...
Epoch: 3 cost time: 4.749641180038452
Epoch: 3, Steps: 89 | Train Loss: 0.280 Vali Loss: 0.263 Vali Acc: 0.925 Test Loss: 0.263 Test Acc: 0.925
Validation loss decreased (-0.861416 --> -0.925485).  Saving model ...
Epoch: 4 cost time: 4.690340518951416
Epoch: 4, Steps: 89 | Train Loss: 0.219 Vali Loss: 0.241 Vali Acc: 0.946 Test Loss: 0.241 Test Acc: 0.946
Validation loss decreased (-0.925485 --> -0.946376).  Saving model ...
Epoch: 5 cost time: 4.748167991638184
Epoch: 5, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.178 Vali Acc: 0.950 Test Loss: 0.178 Test Acc: 0.950
Validation loss decreased (-0.946376 --> -0.949859).  Saving model ...
Epoch: 6 cost time: 4.380732774734497
Epoch: 6, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.278 Vali Acc: 0.940 Test Loss: 0.278 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.724788188934326
Epoch: 7, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.336 Vali Acc: 0.916 Test Loss: 0.336 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.686530828475952
Epoch: 8, Steps: 89 | Train Loss: 0.238 Vali Loss: 0.165 Vali Acc: 0.955 Test Loss: 0.165 Test Acc: 0.955
Validation loss decreased (-0.949859 --> -0.955430).  Saving model ...
Epoch: 9 cost time: 4.568718194961548
Epoch: 9, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.248 Vali Acc: 0.946 Test Loss: 0.248 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.47424054145813
Epoch: 10, Steps: 89 | Train Loss: 0.206 Vali Loss: 0.333 Vali Acc: 0.908 Test Loss: 0.333 Test Acc: 0.908
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.800850868225098
Epoch: 11, Steps: 89 | Train Loss: 0.206 Vali Loss: 0.330 Vali Acc: 0.935 Test Loss: 0.330 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.4274046421051025
Epoch: 12, Steps: 89 | Train Loss: 0.219 Vali Loss: 0.476 Vali Acc: 0.893 Test Loss: 0.476 Test Acc: 0.893
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.175034999847412
Epoch: 13, Steps: 89 | Train Loss: 0.370 Vali Loss: 0.874 Vali Acc: 0.824 Test Loss: 0.874 Test Acc: 0.824
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.782998323440552
Epoch: 14, Steps: 89 | Train Loss: 0.500 Vali Loss: 0.577 Vali Acc: 0.871 Test Loss: 0.577 Test Acc: 0.871
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.788074731826782
Epoch: 15, Steps: 89 | Train Loss: 0.576 Vali Loss: 0.629 Vali Acc: 0.869 Test Loss: 0.629 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.623430252075195
Epoch: 16, Steps: 89 | Train Loss: 0.891 Vali Loss: 1.175 Vali Acc: 0.791 Test Loss: 1.175 Test Acc: 0.791
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.542500972747803
Epoch: 17, Steps: 89 | Train Loss: 0.920 Vali Loss: 0.615 Vali Acc: 0.841 Test Loss: 0.615 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.355823993682861
Epoch: 18, Steps: 89 | Train Loss: 1.224 Vali Loss: 1.117 Vali Acc: 0.750 Test Loss: 1.117 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9554317548746518
model parameter : 6096952
model size : 28.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.055427551269531
Epoch: 1, Steps: 89 | Train Loss: 1.838 Vali Loss: 0.594 Vali Acc: 0.820 Test Loss: 0.594 Test Acc: 0.820
Validation loss decreased (inf --> -0.819632).  Saving model ...
Epoch: 2 cost time: 4.7106170654296875
Epoch: 2, Steps: 89 | Train Loss: 0.413 Vali Loss: 0.358 Vali Acc: 0.897 Test Loss: 0.358 Test Acc: 0.897
Validation loss decreased (-0.819632 --> -0.896932).  Saving model ...
Epoch: 3 cost time: 4.978649377822876
Epoch: 3, Steps: 89 | Train Loss: 0.246 Vali Loss: 0.223 Vali Acc: 0.932 Test Loss: 0.223 Test Acc: 0.932
Validation loss decreased (-0.896932 --> -0.932449).  Saving model ...
Epoch: 4 cost time: 4.681037664413452
Epoch: 4, Steps: 89 | Train Loss: 0.219 Vali Loss: 0.172 Vali Acc: 0.957 Test Loss: 0.172 Test Acc: 0.957
Validation loss decreased (-0.932449 --> -0.956823).  Saving model ...
Epoch: 5 cost time: 4.508959770202637
Epoch: 5, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.259 Vali Acc: 0.935 Test Loss: 0.259 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.8696019649505615
Epoch: 6, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.771356105804443
Epoch: 7, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.265 Vali Acc: 0.936 Test Loss: 0.265 Test Acc: 0.936
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.3816680908203125
Epoch: 8, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.315 Vali Acc: 0.916 Test Loss: 0.315 Test Acc: 0.916
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.777084589004517
Epoch: 9, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.317 Vali Acc: 0.921 Test Loss: 0.317 Test Acc: 0.921
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.1494598388671875
Epoch: 10, Steps: 89 | Train Loss: 0.202 Vali Loss: 0.246 Vali Acc: 0.938 Test Loss: 0.246 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.778947353363037
Epoch: 11, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.210 Vali Acc: 0.954 Test Loss: 0.210 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.459043025970459
Epoch: 12, Steps: 89 | Train Loss: 0.239 Vali Loss: 0.275 Vali Acc: 0.931 Test Loss: 0.275 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.4685609340667725
Epoch: 13, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.553 Vali Acc: 0.885 Test Loss: 0.553 Test Acc: 0.885
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.576187610626221
Epoch: 14, Steps: 89 | Train Loss: 0.418 Vali Loss: 0.311 Vali Acc: 0.932 Test Loss: 0.311 Test Acc: 0.932
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9568245125348189
model parameter : 6090808
model size : 28.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.654439210891724
Epoch: 1, Steps: 89 | Train Loss: 1.907 Vali Loss: 0.781 Vali Acc: 0.772 Test Loss: 0.781 Test Acc: 0.772
Validation loss decreased (inf --> -0.771580).  Saving model ...
Epoch: 2 cost time: 4.5521838665008545
Epoch: 2, Steps: 89 | Train Loss: 0.445 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.771580 --> -0.944288).  Saving model ...
Epoch: 3 cost time: 4.2534308433532715
Epoch: 3, Steps: 89 | Train Loss: 0.332 Vali Loss: 0.316 Vali Acc: 0.912 Test Loss: 0.316 Test Acc: 0.912
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.918370723724365
Epoch: 4, Steps: 89 | Train Loss: 0.229 Vali Loss: 0.198 Vali Acc: 0.947 Test Loss: 0.198 Test Acc: 0.947
Validation loss decreased (-0.944288 --> -0.947073).  Saving model ...
Epoch: 5 cost time: 4.4532082080841064
Epoch: 5, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.178 Vali Acc: 0.953 Test Loss: 0.178 Test Acc: 0.953
Validation loss decreased (-0.947073 --> -0.952644).  Saving model ...
Epoch: 6 cost time: 4.723872661590576
Epoch: 6, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.228 Vali Acc: 0.935 Test Loss: 0.228 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.548640489578247
Epoch: 7, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.418 Vali Acc: 0.910 Test Loss: 0.418 Test Acc: 0.910
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.648432016372681
Epoch: 8, Steps: 89 | Train Loss: 0.165 Vali Loss: 0.206 Vali Acc: 0.947 Test Loss: 0.206 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.965025424957275
Epoch: 9, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.214 Vali Acc: 0.942 Test Loss: 0.214 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.707130193710327
Epoch: 10, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.226 Vali Acc: 0.939 Test Loss: 0.226 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.854266405105591
Epoch: 11, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.418 Vali Acc: 0.893 Test Loss: 0.418 Test Acc: 0.893
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.4728569984436035
Epoch: 12, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.234 Vali Acc: 0.953 Test Loss: 0.234 Test Acc: 0.953
Validation loss decreased (-0.952644 --> -0.953340).  Saving model ...
Epoch: 13 cost time: 4.758623123168945
Epoch: 13, Steps: 89 | Train Loss: 0.303 Vali Loss: 0.388 Vali Acc: 0.913 Test Loss: 0.388 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.5267863273620605
Epoch: 14, Steps: 89 | Train Loss: 0.563 Vali Loss: 0.593 Vali Acc: 0.881 Test Loss: 0.593 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.03869104385376
Epoch: 15, Steps: 89 | Train Loss: 0.591 Vali Loss: 0.514 Vali Acc: 0.874 Test Loss: 0.514 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.665724754333496
Epoch: 16, Steps: 89 | Train Loss: 1.150 Vali Loss: 0.485 Vali Acc: 0.879 Test Loss: 0.485 Test Acc: 0.879
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.537091016769409
Epoch: 17, Steps: 89 | Train Loss: 0.875 Vali Loss: 0.871 Vali Acc: 0.776 Test Loss: 0.871 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.899036169052124
Epoch: 18, Steps: 89 | Train Loss: 1.036 Vali Loss: 1.026 Vali Acc: 0.776 Test Loss: 1.026 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.94599175453186
Epoch: 19, Steps: 89 | Train Loss: 1.525 Vali Loss: 2.229 Vali Acc: 0.556 Test Loss: 2.229 Test Acc: 0.556
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.778308391571045
Epoch: 20, Steps: 89 | Train Loss: 1.998 Vali Loss: 5.760 Vali Acc: 0.233 Test Loss: 5.760 Test Acc: 0.233
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.362189292907715
Epoch: 21, Steps: 89 | Train Loss: 4.337 Vali Loss: 3.312 Vali Acc: 0.078 Test Loss: 3.312 Test Acc: 0.078
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.290166854858398
Epoch: 22, Steps: 89 | Train Loss: 3.791 Vali Loss: 3.187 Vali Acc: 0.045 Test Loss: 3.187 Test Acc: 0.045
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9533426183844012
model parameter : 5780920
model size : 27.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.400993347167969
Epoch: 1, Steps: 89 | Train Loss: 1.835 Vali Loss: 0.735 Vali Acc: 0.777 Test Loss: 0.735 Test Acc: 0.777
Validation loss decreased (inf --> -0.777151).  Saving model ...
Epoch: 2 cost time: 4.641595125198364
Epoch: 2, Steps: 89 | Train Loss: 0.405 Vali Loss: 0.220 Vali Acc: 0.935 Test Loss: 0.220 Test Acc: 0.935
Validation loss decreased (-0.777151 --> -0.935235).  Saving model ...
Epoch: 3 cost time: 4.775418758392334
Epoch: 3, Steps: 89 | Train Loss: 0.254 Vali Loss: 0.320 Vali Acc: 0.905 Test Loss: 0.320 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.578654050827026
Epoch: 4, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
Validation loss decreased (-0.935235 --> -0.940806).  Saving model ...
Epoch: 5 cost time: 4.3523805141448975
Epoch: 5, Steps: 89 | Train Loss: 0.192 Vali Loss: 0.194 Vali Acc: 0.952 Test Loss: 0.194 Test Acc: 0.952
Validation loss decreased (-0.940806 --> -0.951948).  Saving model ...
Epoch: 6 cost time: 4.575618505477905
Epoch: 6, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.261 Vali Acc: 0.953 Test Loss: 0.261 Test Acc: 0.953
Validation loss decreased (-0.951948 --> -0.952644).  Saving model ...
Epoch: 7 cost time: 4.3357954025268555
Epoch: 7, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.264 Vali Acc: 0.935 Test Loss: 0.264 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.868365049362183
Epoch: 8, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.374 Vali Acc: 0.916 Test Loss: 0.374 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.403111934661865
Epoch: 9, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.460 Vali Acc: 0.917 Test Loss: 0.460 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.584374904632568
Epoch: 10, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.446296453475952
Epoch: 11, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.526 Vali Acc: 0.885 Test Loss: 0.526 Test Acc: 0.885
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.700432300567627
Epoch: 12, Steps: 89 | Train Loss: 0.220 Vali Loss: 0.370 Vali Acc: 0.914 Test Loss: 0.370 Test Acc: 0.914
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.742063999176025
Epoch: 13, Steps: 89 | Train Loss: 0.373 Vali Loss: 0.337 Vali Acc: 0.933 Test Loss: 0.337 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.142146110534668
Epoch: 14, Steps: 89 | Train Loss: 0.772 Vali Loss: 0.751 Vali Acc: 0.795 Test Loss: 0.751 Test Acc: 0.795
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.868540048599243
Epoch: 15, Steps: 89 | Train Loss: 1.094 Vali Loss: 0.884 Vali Acc: 0.774 Test Loss: 0.884 Test Acc: 0.774
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.328348636627197
Epoch: 16, Steps: 89 | Train Loss: 1.336 Vali Loss: 1.408 Vali Acc: 0.696 Test Loss: 1.408 Test Acc: 0.696
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9526462395543176
model parameter : 5774776
model size : 27.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.007304668426514
Epoch: 1, Steps: 89 | Train Loss: 1.896 Vali Loss: 0.722 Vali Acc: 0.761 Test Loss: 0.722 Test Acc: 0.761
Validation loss decreased (inf --> -0.761135).  Saving model ...
Epoch: 2 cost time: 4.6370909214019775
Epoch: 2, Steps: 89 | Train Loss: 0.473 Vali Loss: 0.436 Vali Acc: 0.850 Test Loss: 0.436 Test Acc: 0.850
Validation loss decreased (-0.761135 --> -0.849578).  Saving model ...
Epoch: 3 cost time: 4.61613392829895
Epoch: 3, Steps: 89 | Train Loss: 0.277 Vali Loss: 0.382 Vali Acc: 0.901 Test Loss: 0.382 Test Acc: 0.901
Validation loss decreased (-0.849578 --> -0.901110).  Saving model ...
Epoch: 4 cost time: 4.6029887199401855
Epoch: 4, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.370 Vali Acc: 0.914 Test Loss: 0.370 Test Acc: 0.914
Validation loss decreased (-0.901110 --> -0.913645).  Saving model ...
Epoch: 5 cost time: 5.124089956283569
Epoch: 5, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.913645 --> -0.944288).  Saving model ...
Epoch: 6 cost time: 4.532271385192871
Epoch: 6, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.270 Vali Acc: 0.922 Test Loss: 0.270 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.0749359130859375
Epoch: 7, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.276 Vali Acc: 0.941 Test Loss: 0.276 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.074401140213013
Epoch: 8, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.192 Vali Acc: 0.957 Test Loss: 0.192 Test Acc: 0.957
Validation loss decreased (-0.944288 --> -0.956823).  Saving model ...
Epoch: 9 cost time: 4.563540697097778
Epoch: 9, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.259 Vali Acc: 0.948 Test Loss: 0.259 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.4058942794799805
Epoch: 10, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.228 Vali Acc: 0.948 Test Loss: 0.228 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.347802400588989
Epoch: 11, Steps: 89 | Train Loss: 0.239 Vali Loss: 0.442 Vali Acc: 0.901 Test Loss: 0.442 Test Acc: 0.901
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.501060247421265
Epoch: 12, Steps: 89 | Train Loss: 0.317 Vali Loss: 0.521 Vali Acc: 0.887 Test Loss: 0.521 Test Acc: 0.887
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.760152578353882
Epoch: 13, Steps: 89 | Train Loss: 0.305 Vali Loss: 0.330 Vali Acc: 0.924 Test Loss: 0.330 Test Acc: 0.924
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.742250680923462
Epoch: 14, Steps: 89 | Train Loss: 0.341 Vali Loss: 0.412 Vali Acc: 0.896 Test Loss: 0.412 Test Acc: 0.896
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.617607116699219
Epoch: 15, Steps: 89 | Train Loss: 0.451 Vali Loss: 0.567 Vali Acc: 0.865 Test Loss: 0.567 Test Acc: 0.865
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.815513849258423
Epoch: 16, Steps: 89 | Train Loss: 0.611 Vali Loss: 0.688 Vali Acc: 0.856 Test Loss: 0.688 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.680096626281738
Epoch: 17, Steps: 89 | Train Loss: 0.627 Vali Loss: 0.986 Vali Acc: 0.790 Test Loss: 0.986 Test Acc: 0.790
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.624706268310547
Epoch: 18, Steps: 89 | Train Loss: 0.886 Vali Loss: 0.995 Vali Acc: 0.792 Test Loss: 0.995 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9568245125348189
model parameter : 5768632
model size : 27.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.595120429992676
Epoch: 1, Steps: 89 | Train Loss: 1.879 Vali Loss: 0.663 Vali Acc: 0.786 Test Loss: 0.663 Test Acc: 0.786
Validation loss decreased (inf --> -0.786205).  Saving model ...
Epoch: 2 cost time: 4.102006673812866
Epoch: 2, Steps: 89 | Train Loss: 0.472 Vali Loss: 0.492 Vali Acc: 0.841 Test Loss: 0.492 Test Acc: 0.841
Validation loss decreased (-0.786205 --> -0.841221).  Saving model ...
Epoch: 3 cost time: 4.100081443786621
Epoch: 3, Steps: 89 | Train Loss: 0.281 Vali Loss: 0.350 Vali Acc: 0.909 Test Loss: 0.350 Test Acc: 0.909
Validation loss decreased (-0.841221 --> -0.909467).  Saving model ...
Epoch: 4 cost time: 4.9197258949279785
Epoch: 4, Steps: 89 | Train Loss: 0.239 Vali Loss: 0.296 Vali Acc: 0.912 Test Loss: 0.296 Test Acc: 0.912
Validation loss decreased (-0.909467 --> -0.911557).  Saving model ...
Epoch: 5 cost time: 4.3645477294921875
Epoch: 5, Steps: 89 | Train Loss: 0.208 Vali Loss: 0.219 Vali Acc: 0.946 Test Loss: 0.219 Test Acc: 0.946
Validation loss decreased (-0.911557 --> -0.945680).  Saving model ...
Epoch: 6 cost time: 4.899147987365723
Epoch: 6, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.462 Vali Acc: 0.900 Test Loss: 0.462 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.747339487075806
Epoch: 7, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.171 Vali Acc: 0.952 Test Loss: 0.171 Test Acc: 0.952
Validation loss decreased (-0.945680 --> -0.951948).  Saving model ...
Epoch: 8 cost time: 4.5836403369903564
Epoch: 8, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.302609205245972
Epoch: 9, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.331 Vali Acc: 0.921 Test Loss: 0.331 Test Acc: 0.921
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.208319425582886
Epoch: 10, Steps: 89 | Train Loss: 0.251 Vali Loss: 0.388 Vali Acc: 0.927 Test Loss: 0.388 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.744596481323242
Epoch: 11, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.399 Vali Acc: 0.914 Test Loss: 0.399 Test Acc: 0.914
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.808012962341309
Epoch: 12, Steps: 89 | Train Loss: 0.186 Vali Loss: 0.283 Vali Acc: 0.947 Test Loss: 0.283 Test Acc: 0.947
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.330158472061157
Epoch: 13, Steps: 89 | Train Loss: 0.296 Vali Loss: 0.300 Vali Acc: 0.919 Test Loss: 0.300 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.439387083053589
Epoch: 14, Steps: 89 | Train Loss: 0.574 Vali Loss: 0.673 Vali Acc: 0.852 Test Loss: 0.673 Test Acc: 0.852
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.336705446243286
Epoch: 15, Steps: 89 | Train Loss: 0.671 Vali Loss: 0.686 Vali Acc: 0.860 Test Loss: 0.686 Test Acc: 0.860
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.542194128036499
Epoch: 16, Steps: 89 | Train Loss: 0.781 Vali Loss: 0.720 Vali Acc: 0.852 Test Loss: 0.720 Test Acc: 0.852
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.909027814865112
Epoch: 17, Steps: 89 | Train Loss: 0.843 Vali Loss: 0.707 Vali Acc: 0.857 Test Loss: 0.707 Test Acc: 0.857
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9519498607242339
model parameter : 5762488
model size : 26.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.487666368484497
Epoch: 1, Steps: 89 | Train Loss: 2.117 Vali Loss: 0.792 Vali Acc: 0.764 Test Loss: 0.792 Test Acc: 0.764
Validation loss decreased (inf --> -0.763920).  Saving model ...
Epoch: 2 cost time: 4.607692718505859
Epoch: 2, Steps: 89 | Train Loss: 0.537 Vali Loss: 0.389 Vali Acc: 0.895 Test Loss: 0.389 Test Acc: 0.895
Validation loss decreased (-0.763920 --> -0.894843).  Saving model ...
Epoch: 3 cost time: 4.767420768737793
Epoch: 3, Steps: 89 | Train Loss: 0.267 Vali Loss: 0.258 Vali Acc: 0.919 Test Loss: 0.258 Test Acc: 0.919
Validation loss decreased (-0.894843 --> -0.919217).  Saving model ...
Epoch: 4 cost time: 5.1088948249816895
Epoch: 4, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.222 Vali Acc: 0.934 Test Loss: 0.222 Test Acc: 0.934
Validation loss decreased (-0.919217 --> -0.933842).  Saving model ...
Epoch: 5 cost time: 4.854864597320557
Epoch: 5, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.143 Vali Acc: 0.960 Test Loss: 0.143 Test Acc: 0.960
Validation loss decreased (-0.933842 --> -0.960305).  Saving model ...
Epoch: 6 cost time: 4.562535524368286
Epoch: 6, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.196 Vali Acc: 0.946 Test Loss: 0.196 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.345393657684326
Epoch: 7, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.153 Vali Acc: 0.948 Test Loss: 0.153 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.234392404556274
Epoch: 8, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.143 Vali Acc: 0.953 Test Loss: 0.143 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.621802568435669
Epoch: 9, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.120 Vali Acc: 0.964 Test Loss: 0.120 Test Acc: 0.964
Validation loss decreased (-0.960305 --> -0.963787).  Saving model ...
Epoch: 10 cost time: 4.336781024932861
Epoch: 10, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.097 Vali Acc: 0.972 Test Loss: 0.097 Test Acc: 0.972
Validation loss decreased (-0.963787 --> -0.972144).  Saving model ...
Epoch: 11 cost time: 4.832304000854492
Epoch: 11, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.118 Vali Acc: 0.963 Test Loss: 0.118 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.026044845581055
Epoch: 12, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.141 Vali Acc: 0.960 Test Loss: 0.141 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.138393878936768
Epoch: 13, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.674156665802002
Epoch: 14, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
Validation loss decreased (-0.972144 --> -0.973537).  Saving model ...
Epoch: 15 cost time: 5.368120193481445
Epoch: 15, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
Validation loss decreased (-0.973537 --> -0.975626).  Saving model ...
Epoch: 16 cost time: 4.851982116699219
Epoch: 16, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.184 Vali Acc: 0.960 Test Loss: 0.184 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.620655536651611
Epoch: 17, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.148 Vali Acc: 0.967 Test Loss: 0.148 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.413345575332642
Epoch: 18, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.178 Vali Acc: 0.953 Test Loss: 0.178 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.78032922744751
Epoch: 19, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.175 Vali Acc: 0.957 Test Loss: 0.175 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.0641138553619385
Epoch: 20, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.209 Vali Acc: 0.948 Test Loss: 0.209 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.293572664260864
Epoch: 21, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.148 Vali Acc: 0.960 Test Loss: 0.148 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.820768594741821
Epoch: 22, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.180 Vali Acc: 0.961 Test Loss: 0.180 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.619436502456665
Epoch: 23, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.172 Vali Acc: 0.969 Test Loss: 0.172 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.776476621627808
Epoch: 24, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.335 Vali Acc: 0.925 Test Loss: 0.335 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.2938501834869385
Epoch: 25, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.288 Vali Acc: 0.946 Test Loss: 0.288 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 2731448
model size : 12.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.906260251998901
Epoch: 1, Steps: 89 | Train Loss: 2.163 Vali Loss: 0.800 Vali Acc: 0.756 Test Loss: 0.800 Test Acc: 0.756
Validation loss decreased (inf --> -0.756259).  Saving model ...
Epoch: 2 cost time: 4.441144943237305
Epoch: 2, Steps: 89 | Train Loss: 0.535 Vali Loss: 0.475 Vali Acc: 0.845 Test Loss: 0.475 Test Acc: 0.845
Validation loss decreased (-0.756259 --> -0.845399).  Saving model ...
Epoch: 3 cost time: 4.449557781219482
Epoch: 3, Steps: 89 | Train Loss: 0.303 Vali Loss: 0.213 Vali Acc: 0.946 Test Loss: 0.213 Test Acc: 0.946
Validation loss decreased (-0.845399 --> -0.945680).  Saving model ...
Epoch: 4 cost time: 4.636179208755493
Epoch: 4, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.239 Vali Acc: 0.927 Test Loss: 0.239 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.59140682220459
Epoch: 5, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.205 Vali Acc: 0.948 Test Loss: 0.205 Test Acc: 0.948
Validation loss decreased (-0.945680 --> -0.948466).  Saving model ...
Epoch: 6 cost time: 4.384393930435181
Epoch: 6, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.143 Vali Acc: 0.959 Test Loss: 0.143 Test Acc: 0.959
Validation loss decreased (-0.948466 --> -0.958912).  Saving model ...
Epoch: 7 cost time: 4.569622755050659
Epoch: 7, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.37510085105896
Epoch: 8, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.598702669143677
Epoch: 9, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.101 Vali Acc: 0.972 Test Loss: 0.101 Test Acc: 0.972
Validation loss decreased (-0.958912 --> -0.972144).  Saving model ...
Epoch: 10 cost time: 4.749094247817993
Epoch: 10, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.173 Vali Acc: 0.951 Test Loss: 0.173 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.711118221282959
Epoch: 11, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.517288684844971
Epoch: 12, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.871366500854492
Epoch: 13, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.148 Vali Acc: 0.967 Test Loss: 0.148 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.536807537078857
Epoch: 14, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.453100681304932
Epoch: 15, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.972144 --> -0.977018).  Saving model ...
Epoch: 16 cost time: 4.230401277542114
Epoch: 16, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.119 Vali Acc: 0.966 Test Loss: 0.119 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.318088054656982
Epoch: 17, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.5484020709991455
Epoch: 18, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.438569068908691
Epoch: 19, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.216 Vali Acc: 0.948 Test Loss: 0.216 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.836888551712036
Epoch: 20, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.165716171264648
Epoch: 21, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.396692514419556
Epoch: 22, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.212 Vali Acc: 0.960 Test Loss: 0.212 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.494259595870972
Epoch: 23, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.231 Vali Acc: 0.961 Test Loss: 0.231 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.361596584320068
Epoch: 24, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.236 Vali Acc: 0.948 Test Loss: 0.236 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.40575647354126
Epoch: 25, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.229 Vali Acc: 0.950 Test Loss: 0.229 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 2728376
model size : 12.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.929758548736572
Epoch: 1, Steps: 89 | Train Loss: 2.185 Vali Loss: 0.823 Vali Acc: 0.806 Test Loss: 0.823 Test Acc: 0.806
Validation loss decreased (inf --> -0.806398).  Saving model ...
Epoch: 2 cost time: 4.35073184967041
Epoch: 2, Steps: 89 | Train Loss: 0.499 Vali Loss: 0.477 Vali Acc: 0.864 Test Loss: 0.477 Test Acc: 0.864
Validation loss decreased (-0.806398 --> -0.863505).  Saving model ...
Epoch: 3 cost time: 4.3654303550720215
Epoch: 3, Steps: 89 | Train Loss: 0.290 Vali Loss: 0.233 Vali Acc: 0.925 Test Loss: 0.233 Test Acc: 0.925
Validation loss decreased (-0.863505 --> -0.924789).  Saving model ...
Epoch: 4 cost time: 4.712404727935791
Epoch: 4, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.229 Vali Acc: 0.935 Test Loss: 0.229 Test Acc: 0.935
Validation loss decreased (-0.924789 --> -0.935234).  Saving model ...
Epoch: 5 cost time: 4.615229368209839
Epoch: 5, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.222 Vali Acc: 0.948 Test Loss: 0.222 Test Acc: 0.948
Validation loss decreased (-0.935234 --> -0.948466).  Saving model ...
Epoch: 6 cost time: 4.372923135757446
Epoch: 6, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.147 Vali Acc: 0.949 Test Loss: 0.147 Test Acc: 0.949
Validation loss decreased (-0.948466 --> -0.949163).  Saving model ...
Epoch: 7 cost time: 4.430715560913086
Epoch: 7, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.223 Vali Acc: 0.929 Test Loss: 0.223 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.566642761230469
Epoch: 8, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.177 Vali Acc: 0.950 Test Loss: 0.177 Test Acc: 0.950
Validation loss decreased (-0.949163 --> -0.949859).  Saving model ...
Epoch: 9 cost time: 4.905675411224365
Epoch: 9, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.150 Vali Acc: 0.954 Test Loss: 0.150 Test Acc: 0.954
Validation loss decreased (-0.949859 --> -0.954038).  Saving model ...
Epoch: 10 cost time: 4.562031507492065
Epoch: 10, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.173 Vali Acc: 0.948 Test Loss: 0.173 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.85670804977417
Epoch: 11, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.221 Vali Acc: 0.954 Test Loss: 0.221 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.666086196899414
Epoch: 12, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.142 Vali Acc: 0.957 Test Loss: 0.142 Test Acc: 0.957
Validation loss decreased (-0.954038 --> -0.956823).  Saving model ...
Epoch: 13 cost time: 4.553246259689331
Epoch: 13, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.152 Vali Acc: 0.956 Test Loss: 0.152 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.453286647796631
Epoch: 14, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.302 Vali Acc: 0.932 Test Loss: 0.302 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.4770591259002686
Epoch: 15, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
Validation loss decreased (-0.956823 --> -0.975626).  Saving model ...
Epoch: 16 cost time: 4.307685613632202
Epoch: 16, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.243 Vali Acc: 0.932 Test Loss: 0.243 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.11702299118042
Epoch: 17, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.186 Vali Acc: 0.955 Test Loss: 0.186 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.512681007385254
Epoch: 18, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.140 Vali Acc: 0.968 Test Loss: 0.140 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.291686534881592
Epoch: 19, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.127 Vali Acc: 0.966 Test Loss: 0.127 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.463760137557983
Epoch: 20, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.211 Vali Acc: 0.949 Test Loss: 0.211 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.795922756195068
Epoch: 21, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.3705666065216064
Epoch: 22, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.292 Vali Acc: 0.931 Test Loss: 0.292 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.075190544128418
Epoch: 23, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.220 Vali Acc: 0.954 Test Loss: 0.220 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.070226192474365
Epoch: 24, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.141 Vali Acc: 0.963 Test Loss: 0.141 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.215294122695923
Epoch: 25, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.277 Vali Acc: 0.951 Test Loss: 0.277 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 2725304
model size : 12.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.7486419677734375
Epoch: 1, Steps: 89 | Train Loss: 2.200 Vali Loss: 0.841 Vali Acc: 0.761 Test Loss: 0.841 Test Acc: 0.761
Validation loss decreased (inf --> -0.761134).  Saving model ...
Epoch: 2 cost time: 4.30631947517395
Epoch: 2, Steps: 89 | Train Loss: 0.535 Vali Loss: 0.422 Vali Acc: 0.862 Test Loss: 0.422 Test Acc: 0.862
Validation loss decreased (-0.761134 --> -0.862113).  Saving model ...
Epoch: 3 cost time: 4.360709190368652
Epoch: 3, Steps: 89 | Train Loss: 0.311 Vali Loss: 0.269 Vali Acc: 0.925 Test Loss: 0.269 Test Acc: 0.925
Validation loss decreased (-0.862113 --> -0.924788).  Saving model ...
Epoch: 4 cost time: 4.129776954650879
Epoch: 4, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.924788 --> -0.931056).  Saving model ...
Epoch: 5 cost time: 4.3062520027160645
Epoch: 5, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.163 Vali Acc: 0.952 Test Loss: 0.163 Test Acc: 0.952
Validation loss decreased (-0.931056 --> -0.951948).  Saving model ...
Epoch: 6 cost time: 3.8754360675811768
Epoch: 6, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.148 Vali Acc: 0.953 Test Loss: 0.148 Test Acc: 0.953
Validation loss decreased (-0.951948 --> -0.952645).  Saving model ...
Epoch: 7 cost time: 4.057172775268555
Epoch: 7, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.171 Vali Acc: 0.951 Test Loss: 0.171 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.223006963729858
Epoch: 8, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.130 Vali Acc: 0.960 Test Loss: 0.130 Test Acc: 0.960
Validation loss decreased (-0.952645 --> -0.960305).  Saving model ...
Epoch: 9 cost time: 4.295921325683594
Epoch: 9, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
Validation loss decreased (-0.960305 --> -0.968662).  Saving model ...
Epoch: 10 cost time: 4.338090181350708
Epoch: 10, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.181 Vali Acc: 0.955 Test Loss: 0.181 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.472601890563965
Epoch: 11, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.290 Vali Acc: 0.916 Test Loss: 0.290 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.356508493423462
Epoch: 12, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.727979421615601
Epoch: 13, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
Validation loss decreased (-0.968662 --> -0.970055).  Saving model ...
Epoch: 14 cost time: 4.226381540298462
Epoch: 14, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
Validation loss decreased (-0.970055 --> -0.970751).  Saving model ...
Epoch: 15 cost time: 4.234048843383789
Epoch: 15, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.175 Vali Acc: 0.955 Test Loss: 0.175 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.467713356018066
Epoch: 16, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.126 Vali Acc: 0.966 Test Loss: 0.126 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.510142803192139
Epoch: 17, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.241 Vali Acc: 0.943 Test Loss: 0.241 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.672797441482544
Epoch: 18, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.315 Vali Acc: 0.939 Test Loss: 0.315 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.220789432525635
Epoch: 19, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.194 Vali Acc: 0.951 Test Loss: 0.194 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.737187385559082
Epoch: 20, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.163 Vali Acc: 0.955 Test Loss: 0.163 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.490529775619507
Epoch: 21, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.347 Vali Acc: 0.925 Test Loss: 0.347 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.282498121261597
Epoch: 22, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.9419286251068115
Epoch: 23, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.328 Vali Acc: 0.926 Test Loss: 0.328 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.212105989456177
Epoch: 24, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.213 Vali Acc: 0.945 Test Loss: 0.213 Test Acc: 0.945
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9707520891364902
model parameter : 2722232
model size : 12.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.12324333190918
Epoch: 1, Steps: 89 | Train Loss: 2.302 Vali Loss: 0.950 Vali Acc: 0.683 Test Loss: 0.950 Test Acc: 0.683
Validation loss decreased (inf --> -0.683138).  Saving model ...
Epoch: 2 cost time: 4.158654451370239
Epoch: 2, Steps: 89 | Train Loss: 0.548 Vali Loss: 0.307 Vali Acc: 0.909 Test Loss: 0.307 Test Acc: 0.909
Validation loss decreased (-0.683138 --> -0.908771).  Saving model ...
Epoch: 3 cost time: 4.429861068725586
Epoch: 3, Steps: 89 | Train Loss: 0.294 Vali Loss: 0.200 Vali Acc: 0.940 Test Loss: 0.200 Test Acc: 0.940
Validation loss decreased (-0.908771 --> -0.940109).  Saving model ...
Epoch: 4 cost time: 4.6155524253845215
Epoch: 4, Steps: 89 | Train Loss: 0.202 Vali Loss: 0.171 Vali Acc: 0.947 Test Loss: 0.171 Test Acc: 0.947
Validation loss decreased (-0.940109 --> -0.947074).  Saving model ...
Epoch: 5 cost time: 4.509700298309326
Epoch: 5, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.130 Vali Acc: 0.958 Test Loss: 0.130 Test Acc: 0.958
Validation loss decreased (-0.947074 --> -0.957520).  Saving model ...
Epoch: 6 cost time: 4.2268571853637695
Epoch: 6, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.124 Vali Acc: 0.964 Test Loss: 0.124 Test Acc: 0.964
Validation loss decreased (-0.957520 --> -0.963787).  Saving model ...
Epoch: 7 cost time: 4.611644268035889
Epoch: 7, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.116 Vali Acc: 0.969 Test Loss: 0.116 Test Acc: 0.969
Validation loss decreased (-0.963787 --> -0.968662).  Saving model ...
Epoch: 8 cost time: 4.561472177505493
Epoch: 8, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.197 Vali Acc: 0.942 Test Loss: 0.197 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.61192774772644
Epoch: 9, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.210 Vali Acc: 0.946 Test Loss: 0.210 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.389954566955566
Epoch: 10, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.309 Vali Acc: 0.937 Test Loss: 0.309 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.483385324478149
Epoch: 11, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.5062830448150635
Epoch: 12, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.150 Vali Acc: 0.966 Test Loss: 0.150 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.458311080932617
Epoch: 13, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
Validation loss decreased (-0.968662 --> -0.974233).  Saving model ...
Epoch: 14 cost time: 4.515469789505005
Epoch: 14, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.3032066822052
Epoch: 15, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.219 Vali Acc: 0.949 Test Loss: 0.219 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.556168556213379
Epoch: 16, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.210 Vali Acc: 0.951 Test Loss: 0.210 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.7652747631073
Epoch: 17, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.243 Vali Acc: 0.945 Test Loss: 0.243 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.904100656509399
Epoch: 18, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.69774866104126
Epoch: 19, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.195 Vali Acc: 0.956 Test Loss: 0.195 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.9888365268707275
Epoch: 20, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.256 Vali Acc: 0.938 Test Loss: 0.256 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.878101110458374
Epoch: 21, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.159 Vali Acc: 0.962 Test Loss: 0.159 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.624598026275635
Epoch: 22, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.538 Vali Acc: 0.882 Test Loss: 0.538 Test Acc: 0.882
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.350958824157715
Epoch: 23, Steps: 89 | Train Loss: 0.182 Vali Loss: 0.228 Vali Acc: 0.947 Test Loss: 0.228 Test Acc: 0.947
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.974233983286908
model parameter : 2073528
model size : 10.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.195275783538818
Epoch: 1, Steps: 89 | Train Loss: 2.195 Vali Loss: 0.829 Vali Acc: 0.790 Test Loss: 0.829 Test Acc: 0.790
Validation loss decreased (inf --> -0.790382).  Saving model ...
Epoch: 2 cost time: 4.580151557922363
Epoch: 2, Steps: 89 | Train Loss: 0.514 Vali Loss: 0.402 Vali Acc: 0.866 Test Loss: 0.402 Test Acc: 0.866
Validation loss decreased (-0.790382 --> -0.866291).  Saving model ...
Epoch: 3 cost time: 4.224965572357178
Epoch: 3, Steps: 89 | Train Loss: 0.292 Vali Loss: 0.268 Vali Acc: 0.915 Test Loss: 0.268 Test Acc: 0.915
Validation loss decreased (-0.866291 --> -0.915039).  Saving model ...
Epoch: 4 cost time: 4.33713173866272
Epoch: 4, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.218 Vali Acc: 0.940 Test Loss: 0.218 Test Acc: 0.940
Validation loss decreased (-0.915039 --> -0.940109).  Saving model ...
Epoch: 5 cost time: 4.594700813293457
Epoch: 5, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.210 Vali Acc: 0.936 Test Loss: 0.210 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.765171527862549
Epoch: 6, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.141 Vali Acc: 0.953 Test Loss: 0.141 Test Acc: 0.953
Validation loss decreased (-0.940109 --> -0.953341).  Saving model ...
Epoch: 7 cost time: 5.096434831619263
Epoch: 7, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.178 Vali Acc: 0.942 Test Loss: 0.178 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.7195563316345215
Epoch: 8, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.208 Vali Acc: 0.939 Test Loss: 0.208 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.1287267208099365
Epoch: 9, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
Validation loss decreased (-0.953341 --> -0.966573).  Saving model ...
Epoch: 10 cost time: 4.412705421447754
Epoch: 10, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.167 Vali Acc: 0.955 Test Loss: 0.167 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.280089855194092
Epoch: 11, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.142 Vali Acc: 0.961 Test Loss: 0.142 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.830165386199951
Epoch: 12, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.1947572231292725
Epoch: 13, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.131 Vali Acc: 0.960 Test Loss: 0.131 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.8512513637542725
Epoch: 14, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.132 Vali Acc: 0.964 Test Loss: 0.132 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.903603553771973
Epoch: 15, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.136 Vali Acc: 0.972 Test Loss: 0.136 Test Acc: 0.972
Validation loss decreased (-0.966573 --> -0.972143).  Saving model ...
Epoch: 16 cost time: 5.270925521850586
Epoch: 16, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.940019130706787
Epoch: 17, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.138 Vali Acc: 0.969 Test Loss: 0.138 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.8601768016815186
Epoch: 18, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.986939430236816
Epoch: 19, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.179 Vali Acc: 0.948 Test Loss: 0.179 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.0967559814453125
Epoch: 20, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.225 Vali Acc: 0.948 Test Loss: 0.225 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.727302551269531
Epoch: 21, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.246 Vali Acc: 0.947 Test Loss: 0.246 Test Acc: 0.947
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.543676853179932
Epoch: 22, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.166 Vali Acc: 0.962 Test Loss: 0.166 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.23966908454895
Epoch: 23, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.189 Vali Acc: 0.965 Test Loss: 0.189 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.114558219909668
Epoch: 24, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.169 Vali Acc: 0.964 Test Loss: 0.169 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.492045640945435
Epoch: 25, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.286 Vali Acc: 0.945 Test Loss: 0.286 Test Acc: 0.945
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9721448467966574
model parameter : 2070456
model size : 10.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.741443395614624
Epoch: 1, Steps: 89 | Train Loss: 2.287 Vali Loss: 0.875 Vali Acc: 0.762 Test Loss: 0.875 Test Acc: 0.762
Validation loss decreased (inf --> -0.761830).  Saving model ...
Epoch: 2 cost time: 4.250315427780151
Epoch: 2, Steps: 89 | Train Loss: 0.546 Vali Loss: 0.343 Vali Acc: 0.906 Test Loss: 0.343 Test Acc: 0.906
Validation loss decreased (-0.761830 --> -0.905985).  Saving model ...
Epoch: 3 cost time: 4.131659984588623
Epoch: 3, Steps: 89 | Train Loss: 0.255 Vali Loss: 0.264 Vali Acc: 0.922 Test Loss: 0.264 Test Acc: 0.922
Validation loss decreased (-0.905985 --> -0.922003).  Saving model ...
Epoch: 4 cost time: 4.015653848648071
Epoch: 4, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.147 Vali Acc: 0.959 Test Loss: 0.147 Test Acc: 0.959
Validation loss decreased (-0.922003 --> -0.958912).  Saving model ...
Epoch: 5 cost time: 4.318896293640137
Epoch: 5, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.151 Vali Acc: 0.954 Test Loss: 0.151 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.546057462692261
Epoch: 6, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.178 Vali Acc: 0.945 Test Loss: 0.178 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.895236253738403
Epoch: 7, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.175304412841797
Epoch: 8, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.221 Vali Acc: 0.942 Test Loss: 0.221 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.3371570110321045
Epoch: 9, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.14470648765564
Epoch: 10, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.127 Vali Acc: 0.966 Test Loss: 0.127 Test Acc: 0.966
Validation loss decreased (-0.958912 --> -0.965876).  Saving model ...
Epoch: 11 cost time: 4.686716318130493
Epoch: 11, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.109 Vali Acc: 0.972 Test Loss: 0.109 Test Acc: 0.972
Validation loss decreased (-0.965876 --> -0.972144).  Saving model ...
Epoch: 12 cost time: 4.4149110317230225
Epoch: 12, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.180 Vali Acc: 0.953 Test Loss: 0.180 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.5588178634643555
Epoch: 13, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.250 Vali Acc: 0.937 Test Loss: 0.250 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.413123369216919
Epoch: 14, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.144 Vali Acc: 0.974 Test Loss: 0.144 Test Acc: 0.974
Validation loss decreased (-0.972144 --> -0.973536).  Saving model ...
Epoch: 15 cost time: 4.314518690109253
Epoch: 15, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.229 Vali Acc: 0.941 Test Loss: 0.229 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.696936845779419
Epoch: 16, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.148 Vali Acc: 0.960 Test Loss: 0.148 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.595904350280762
Epoch: 17, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.132 Vali Acc: 0.971 Test Loss: 0.132 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.277052879333496
Epoch: 18, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.340 Vali Acc: 0.935 Test Loss: 0.340 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.482167482376099
Epoch: 19, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.110 Vali Acc: 0.978 Test Loss: 0.110 Test Acc: 0.978
Validation loss decreased (-0.973536 --> -0.978411).  Saving model ...
Epoch: 20 cost time: 4.7876317501068115
Epoch: 20, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.143 Vali Acc: 0.963 Test Loss: 0.143 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.644434928894043
Epoch: 21, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.126 Vali Acc: 0.966 Test Loss: 0.126 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.672175884246826
Epoch: 22, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.146 Vali Acc: 0.967 Test Loss: 0.146 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.4208056926727295
Epoch: 23, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.212 Vali Acc: 0.956 Test Loss: 0.212 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.7912092208862305
Epoch: 24, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.264 Vali Acc: 0.943 Test Loss: 0.264 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.419066429138184
Epoch: 25, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.251 Vali Acc: 0.953 Test Loss: 0.251 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.753865718841553
Epoch: 26, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.235 Vali Acc: 0.947 Test Loss: 0.235 Test Acc: 0.947
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.579047441482544
Epoch: 27, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.291 Vali Acc: 0.946 Test Loss: 0.291 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.472688674926758
Epoch: 28, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.295 Vali Acc: 0.937 Test Loss: 0.295 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.261265754699707
Epoch: 29, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.157 Vali Acc: 0.970 Test Loss: 0.157 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 2067384
model size : 10.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.28422474861145
Epoch: 1, Steps: 89 | Train Loss: 2.270 Vali Loss: 0.908 Vali Acc: 0.769 Test Loss: 0.908 Test Acc: 0.769
Validation loss decreased (inf --> -0.768793).  Saving model ...
Epoch: 2 cost time: 4.245688199996948
Epoch: 2, Steps: 89 | Train Loss: 0.513 Vali Loss: 0.319 Vali Acc: 0.912 Test Loss: 0.319 Test Acc: 0.912
Validation loss decreased (-0.768793 --> -0.912253).  Saving model ...
Epoch: 3 cost time: 4.284634113311768
Epoch: 3, Steps: 89 | Train Loss: 0.276 Vali Loss: 0.236 Vali Acc: 0.932 Test Loss: 0.236 Test Acc: 0.932
Validation loss decreased (-0.912253 --> -0.932449).  Saving model ...
Epoch: 4 cost time: 4.113778829574585
Epoch: 4, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.194 Vali Acc: 0.939 Test Loss: 0.194 Test Acc: 0.939
Validation loss decreased (-0.932449 --> -0.938717).  Saving model ...
Epoch: 5 cost time: 4.502198696136475
Epoch: 5, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
Validation loss decreased (-0.938717 --> -0.956823).  Saving model ...
Epoch: 6 cost time: 4.016150236129761
Epoch: 6, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.140 Vali Acc: 0.951 Test Loss: 0.140 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.4361183643341064
Epoch: 7, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.231 Vali Acc: 0.930 Test Loss: 0.231 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.190762281417847
Epoch: 8, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.133 Vali Acc: 0.958 Test Loss: 0.133 Test Acc: 0.958
Validation loss decreased (-0.956823 --> -0.958216).  Saving model ...
Epoch: 9 cost time: 4.578423023223877
Epoch: 9, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.148 Vali Acc: 0.955 Test Loss: 0.148 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.825384616851807
Epoch: 10, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
Validation loss decreased (-0.958216 --> -0.970751).  Saving model ...
Epoch: 11 cost time: 4.562303304672241
Epoch: 11, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.156 Vali Acc: 0.956 Test Loss: 0.156 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.313107252120972
Epoch: 12, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.295 Vali Acc: 0.937 Test Loss: 0.295 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.545105695724487
Epoch: 13, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.279 Vali Acc: 0.925 Test Loss: 0.279 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.097060441970825
Epoch: 14, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.186 Vali Acc: 0.945 Test Loss: 0.186 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.256333827972412
Epoch: 15, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.7051756381988525
Epoch: 16, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.188 Vali Acc: 0.953 Test Loss: 0.188 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.959350824356079
Epoch: 17, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.836697340011597
Epoch: 18, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.255 Vali Acc: 0.957 Test Loss: 0.255 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.492264747619629
Epoch: 19, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.230 Vali Acc: 0.948 Test Loss: 0.230 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.637553930282593
Epoch: 20, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
Validation loss decreased (-0.970751 --> -0.974233).  Saving model ...
Epoch: 21 cost time: 4.318078517913818
Epoch: 21, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.203 Vali Acc: 0.948 Test Loss: 0.203 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.214996576309204
Epoch: 22, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.713732957839966
Epoch: 23, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.334 Vali Acc: 0.926 Test Loss: 0.334 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.739013433456421
Epoch: 24, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.159 Vali Acc: 0.963 Test Loss: 0.159 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.567980766296387
Epoch: 25, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.154 Vali Acc: 0.967 Test Loss: 0.154 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.52963662147522
Epoch: 26, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.145 Vali Acc: 0.965 Test Loss: 0.145 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.452136278152466
Epoch: 27, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.149 Vali Acc: 0.968 Test Loss: 0.149 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.525669574737549
Epoch: 28, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.229826927185059
Epoch: 29, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.261 Vali Acc: 0.951 Test Loss: 0.261 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.720506429672241
Epoch: 30, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.334 Vali Acc: 0.942 Test Loss: 0.334 Test Acc: 0.942
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.974233983286908
model parameter : 2064312
model size : 10.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.506285667419434
Epoch: 1, Steps: 89 | Train Loss: 2.318 Vali Loss: 1.005 Vali Acc: 0.708 Test Loss: 1.005 Test Acc: 0.708
Validation loss decreased (inf --> -0.707511).  Saving model ...
Epoch: 2 cost time: 4.540600538253784
Epoch: 2, Steps: 89 | Train Loss: 0.569 Vali Loss: 0.412 Vali Acc: 0.880 Test Loss: 0.412 Test Acc: 0.880
Validation loss decreased (-0.707511 --> -0.880219).  Saving model ...
Epoch: 3 cost time: 4.61931848526001
Epoch: 3, Steps: 89 | Train Loss: 0.303 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.880219 --> -0.917128).  Saving model ...
Epoch: 4 cost time: 4.752933979034424
Epoch: 4, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.176 Vali Acc: 0.951 Test Loss: 0.176 Test Acc: 0.951
Validation loss decreased (-0.917128 --> -0.951252).  Saving model ...
Epoch: 5 cost time: 4.562686920166016
Epoch: 5, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.263 Vali Acc: 0.927 Test Loss: 0.263 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.651928424835205
Epoch: 6, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
Validation loss decreased (-0.951252 --> -0.974233).  Saving model ...
Epoch: 7 cost time: 4.216330528259277
Epoch: 7, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.138 Vali Acc: 0.958 Test Loss: 0.138 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.661118984222412
Epoch: 8, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.555573225021362
Epoch: 9, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.102 Vali Acc: 0.969 Test Loss: 0.102 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.758182525634766
Epoch: 10, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.217177629470825
Epoch: 11, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.579778671264648
Epoch: 12, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.975626).  Saving model ...
Epoch: 13 cost time: 4.500506401062012
Epoch: 13, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.447462797164917
Epoch: 14, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.144309759140015
Epoch: 15, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
Validation loss decreased (-0.975626 --> -0.978411).  Saving model ...
Epoch: 16 cost time: 4.126286745071411
Epoch: 16, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.154 Vali Acc: 0.964 Test Loss: 0.154 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.031738519668579
Epoch: 17, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.1852192878723145
Epoch: 18, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
Validation loss decreased (-0.978411 --> -0.979108).  Saving model ...
Epoch: 19 cost time: 4.611496686935425
Epoch: 19, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.298 Vali Acc: 0.916 Test Loss: 0.298 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.378654479980469
Epoch: 20, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.116 Vali Acc: 0.969 Test Loss: 0.116 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.421651363372803
Epoch: 21, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.187 Vali Acc: 0.951 Test Loss: 0.187 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.088112831115723
Epoch: 22, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.200 Vali Acc: 0.954 Test Loss: 0.200 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.01250433921814
Epoch: 23, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.225098371505737
Epoch: 24, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.268771648406982
Epoch: 25, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.213 Vali Acc: 0.962 Test Loss: 0.213 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.9558956623077393
Epoch: 26, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.172 Vali Acc: 0.970 Test Loss: 0.172 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.247389078140259
Epoch: 27, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.259 Vali Acc: 0.947 Test Loss: 0.259 Test Acc: 0.947
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.145272970199585
Epoch: 28, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.158 Vali Acc: 0.967 Test Loss: 0.158 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 1744568
model size : 9.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.546127080917358
Epoch: 1, Steps: 89 | Train Loss: 2.342 Vali Loss: 0.949 Vali Acc: 0.774 Test Loss: 0.949 Test Acc: 0.774
Validation loss decreased (inf --> -0.773667).  Saving model ...
Epoch: 2 cost time: 4.623077869415283
Epoch: 2, Steps: 89 | Train Loss: 0.553 Vali Loss: 0.381 Vali Acc: 0.880 Test Loss: 0.381 Test Acc: 0.880
Validation loss decreased (-0.773667 --> -0.880219).  Saving model ...
Epoch: 3 cost time: 4.57460880279541
Epoch: 3, Steps: 89 | Train Loss: 0.283 Vali Loss: 0.212 Vali Acc: 0.938 Test Loss: 0.212 Test Acc: 0.938
Validation loss decreased (-0.880219 --> -0.938020).  Saving model ...
Epoch: 4 cost time: 4.435755729675293
Epoch: 4, Steps: 89 | Train Loss: 0.165 Vali Loss: 0.173 Vali Acc: 0.947 Test Loss: 0.173 Test Acc: 0.947
Validation loss decreased (-0.938020 --> -0.947073).  Saving model ...
Epoch: 5 cost time: 4.354570627212524
Epoch: 5, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.204 Vali Acc: 0.934 Test Loss: 0.204 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.7607810497283936
Epoch: 6, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.152 Vali Acc: 0.950 Test Loss: 0.152 Test Acc: 0.950
Validation loss decreased (-0.947073 --> -0.949859).  Saving model ...
Epoch: 7 cost time: 4.556402206420898
Epoch: 7, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
Validation loss decreased (-0.949859 --> -0.965180).  Saving model ...
Epoch: 8 cost time: 4.838870286941528
Epoch: 8, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
Validation loss decreased (-0.965180 --> -0.966573).  Saving model ...
Epoch: 9 cost time: 4.681923151016235
Epoch: 9, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
Validation loss decreased (-0.966573 --> -0.970055).  Saving model ...
Epoch: 10 cost time: 4.603039264678955
Epoch: 10, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
Validation loss decreased (-0.970055 --> -0.970751).  Saving model ...
Epoch: 11 cost time: 4.8162994384765625
Epoch: 11, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.146 Vali Acc: 0.955 Test Loss: 0.146 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.129248857498169
Epoch: 12, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
Validation loss decreased (-0.970751 --> -0.976322).  Saving model ...
Epoch: 13 cost time: 5.314054727554321
Epoch: 13, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.461848735809326
Epoch: 14, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.152 Vali Acc: 0.960 Test Loss: 0.152 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.55405068397522
Epoch: 15, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.152 Vali Acc: 0.964 Test Loss: 0.152 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.820478200912476
Epoch: 16, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.155 Vali Acc: 0.969 Test Loss: 0.155 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.319759368896484
Epoch: 17, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.223 Vali Acc: 0.952 Test Loss: 0.223 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.962732315063477
Epoch: 18, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.186731815338135
Epoch: 19, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.171 Vali Acc: 0.962 Test Loss: 0.171 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.620360374450684
Epoch: 20, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.6568567752838135
Epoch: 21, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.138 Vali Acc: 0.969 Test Loss: 0.138 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.511300086975098
Epoch: 22, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.147 Vali Acc: 0.964 Test Loss: 0.147 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 1741496
model size : 9.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.764840126037598
Epoch: 1, Steps: 89 | Train Loss: 2.314 Vali Loss: 0.971 Vali Acc: 0.724 Test Loss: 0.971 Test Acc: 0.724
Validation loss decreased (inf --> -0.723528).  Saving model ...
Epoch: 2 cost time: 6.079078435897827
Epoch: 2, Steps: 89 | Train Loss: 0.530 Vali Loss: 0.320 Vali Acc: 0.918 Test Loss: 0.320 Test Acc: 0.918
Validation loss decreased (-0.723528 --> -0.917824).  Saving model ...
Epoch: 3 cost time: 5.77539324760437
Epoch: 3, Steps: 89 | Train Loss: 0.276 Vali Loss: 0.241 Vali Acc: 0.932 Test Loss: 0.241 Test Acc: 0.932
Validation loss decreased (-0.917824 --> -0.931752).  Saving model ...
Epoch: 4 cost time: 5.608442544937134
Epoch: 4, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.199 Vali Acc: 0.937 Test Loss: 0.199 Test Acc: 0.937
Validation loss decreased (-0.931752 --> -0.937324).  Saving model ...
Epoch: 5 cost time: 6.147880554199219
Epoch: 5, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.655152320861816
Epoch: 6, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.218 Vali Acc: 0.932 Test Loss: 0.218 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.6444737911224365
Epoch: 7, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.163 Vali Acc: 0.953 Test Loss: 0.163 Test Acc: 0.953
Validation loss decreased (-0.937324 --> -0.953341).  Saving model ...
Epoch: 8 cost time: 7.142085790634155
Epoch: 8, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.227 Vali Acc: 0.930 Test Loss: 0.227 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.172048330307007
Epoch: 9, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
Validation loss decreased (-0.953341 --> -0.961698).  Saving model ...
Epoch: 10 cost time: 6.984871864318848
Epoch: 10, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.461398124694824
Epoch: 11, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.110 Vali Acc: 0.972 Test Loss: 0.110 Test Acc: 0.972
Validation loss decreased (-0.961698 --> -0.972144).  Saving model ...
Epoch: 12 cost time: 8.534881830215454
Epoch: 12, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 9.054511547088623
Epoch: 13, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
Validation loss decreased (-0.972144 --> -0.976322).  Saving model ...
Epoch: 14 cost time: 7.6961669921875
Epoch: 14, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.271 Vali Acc: 0.945 Test Loss: 0.271 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.5615394115448
Epoch: 15, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 8.385440587997437
Epoch: 16, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 8.991398334503174
Epoch: 17, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 7.68113112449646
Epoch: 18, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.139 Vali Acc: 0.966 Test Loss: 0.139 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 7.933322906494141
Epoch: 19, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.138 Vali Acc: 0.967 Test Loss: 0.138 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 7.239274024963379
Epoch: 20, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 8.11411452293396
Epoch: 21, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 7.607483863830566
Epoch: 22, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.177 Vali Acc: 0.960 Test Loss: 0.177 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 7.569493532180786
Epoch: 23, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.287 Vali Acc: 0.936 Test Loss: 0.287 Test Acc: 0.936
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 1738424
model size : 9.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.78777289390564
Epoch: 1, Steps: 89 | Train Loss: 2.281 Vali Loss: 0.919 Vali Acc: 0.779 Test Loss: 0.919 Test Acc: 0.779
Validation loss decreased (inf --> -0.778542).  Saving model ...
Epoch: 2 cost time: 6.89193058013916
Epoch: 2, Steps: 89 | Train Loss: 0.576 Vali Loss: 0.477 Vali Acc: 0.868 Test Loss: 0.477 Test Acc: 0.868
Validation loss decreased (-0.778542 --> -0.868380).  Saving model ...
Epoch: 3 cost time: 7.072740077972412
Epoch: 3, Steps: 89 | Train Loss: 0.300 Vali Loss: 0.271 Vali Acc: 0.921 Test Loss: 0.271 Test Acc: 0.921
Validation loss decreased (-0.868380 --> -0.921306).  Saving model ...
Epoch: 4 cost time: 6.751009464263916
Epoch: 4, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.164 Vali Acc: 0.955 Test Loss: 0.164 Test Acc: 0.955
Validation loss decreased (-0.921306 --> -0.955430).  Saving model ...
Epoch: 5 cost time: 6.6347737312316895
Epoch: 5, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.165 Vali Acc: 0.950 Test Loss: 0.165 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.298825025558472
Epoch: 6, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.137 Vali Acc: 0.955 Test Loss: 0.137 Test Acc: 0.955
Validation loss decreased (-0.955430 --> -0.955430).  Saving model ...
Epoch: 7 cost time: 6.742084980010986
Epoch: 7, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.089 Vali Acc: 0.974 Test Loss: 0.089 Test Acc: 0.974
Validation loss decreased (-0.955430 --> -0.973537).  Saving model ...
Epoch: 8 cost time: 6.846294403076172
Epoch: 8, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.779094457626343
Epoch: 9, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.388439416885376
Epoch: 10, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.155 Vali Acc: 0.955 Test Loss: 0.155 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.2971954345703125
Epoch: 11, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.394002914428711
Epoch: 12, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.65063738822937
Epoch: 13, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.115 Vali Acc: 0.964 Test Loss: 0.115 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.65879225730896
Epoch: 14, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.149 Vali Acc: 0.955 Test Loss: 0.149 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.324300289154053
Epoch: 15, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.173 Vali Acc: 0.963 Test Loss: 0.173 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.674329996109009
Epoch: 16, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 7.040835618972778
Epoch: 17, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.396 Vali Acc: 0.928 Test Loss: 0.396 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9735376044568245
model parameter : 1735352
model size : 9.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 11.072759866714478
Epoch: 1, Steps: 89 | Train Loss: 2.348 Vali Loss: 0.982 Vali Acc: 0.746 Test Loss: 0.982 Test Acc: 0.746
Validation loss decreased (inf --> -0.745812).  Saving model ...
Epoch: 2 cost time: 7.394019365310669
Epoch: 2, Steps: 89 | Train Loss: 0.584 Vali Loss: 0.390 Vali Acc: 0.898 Test Loss: 0.390 Test Acc: 0.898
Validation loss decreased (-0.745812 --> -0.898325).  Saving model ...
Epoch: 3 cost time: 8.497052192687988
Epoch: 3, Steps: 89 | Train Loss: 0.298 Vali Loss: 0.226 Vali Acc: 0.937 Test Loss: 0.226 Test Acc: 0.937
Validation loss decreased (-0.898325 --> -0.937324).  Saving model ...
Epoch: 4 cost time: 7.086397647857666
Epoch: 4, Steps: 89 | Train Loss: 0.208 Vali Loss: 0.207 Vali Acc: 0.936 Test Loss: 0.207 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.6596081256866455
Epoch: 5, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.146 Vali Acc: 0.958 Test Loss: 0.146 Test Acc: 0.958
Validation loss decreased (-0.937324 --> -0.958216).  Saving model ...
Epoch: 6 cost time: 7.517995595932007
Epoch: 6, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.102 Vali Acc: 0.967 Test Loss: 0.102 Test Acc: 0.967
Validation loss decreased (-0.958216 --> -0.966573).  Saving model ...
Epoch: 7 cost time: 7.321947813034058
Epoch: 7, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.4083099365234375
Epoch: 8, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.106 Vali Acc: 0.972 Test Loss: 0.106 Test Acc: 0.972
Validation loss decreased (-0.966573 --> -0.972144).  Saving model ...
Epoch: 9 cost time: 6.927398681640625
Epoch: 9, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.143 Vali Acc: 0.964 Test Loss: 0.143 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.9161717891693115
Epoch: 10, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.661647796630859
Epoch: 11, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.148 Vali Acc: 0.959 Test Loss: 0.148 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.9721293449401855
Epoch: 12, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.251 Vali Acc: 0.948 Test Loss: 0.251 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.12135124206543
Epoch: 13, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.247 Vali Acc: 0.942 Test Loss: 0.247 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.1615681648254395
Epoch: 14, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
Validation loss decreased (-0.972144 --> -0.974929).  Saving model ...
Epoch: 15 cost time: 7.293201208114624
Epoch: 15, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.109989881515503
Epoch: 16, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.140 Vali Acc: 0.969 Test Loss: 0.140 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.937878131866455
Epoch: 17, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
Validation loss decreased (-0.974929 --> -0.978411).  Saving model ...
Epoch: 18 cost time: 6.578961372375488
Epoch: 18, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.181 Vali Acc: 0.948 Test Loss: 0.181 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 8.268498420715332
Epoch: 19, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.196 Vali Acc: 0.952 Test Loss: 0.196 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 8.013486385345459
Epoch: 20, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.184 Vali Acc: 0.963 Test Loss: 0.184 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 7.588456869125366
Epoch: 21, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.117 Vali Acc: 0.974 Test Loss: 0.117 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 7.380124092102051
Epoch: 22, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.137 Vali Acc: 0.971 Test Loss: 0.137 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 7.931084156036377
Epoch: 23, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.258 Vali Acc: 0.950 Test Loss: 0.258 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 8.248015403747559
Epoch: 24, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.352 Vali Acc: 0.942 Test Loss: 0.352 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 7.483616352081299
Epoch: 25, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.184 Vali Acc: 0.963 Test Loss: 0.184 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 7.115830659866333
Epoch: 26, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.199 Vali Acc: 0.951 Test Loss: 0.199 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 7.360524654388428
Epoch: 27, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.244 Vali Acc: 0.945 Test Loss: 0.244 Test Acc: 0.945
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 1580088
model size : 8.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.268118858337402
Epoch: 1, Steps: 89 | Train Loss: 2.423 Vali Loss: 1.042 Vali Acc: 0.767 Test Loss: 1.042 Test Acc: 0.767
Validation loss decreased (inf --> -0.767399).  Saving model ...
Epoch: 2 cost time: 6.751805305480957
Epoch: 2, Steps: 89 | Train Loss: 0.592 Vali Loss: 0.334 Vali Acc: 0.910 Test Loss: 0.334 Test Acc: 0.910
Validation loss decreased (-0.767399 --> -0.910164).  Saving model ...
Epoch: 3 cost time: 7.64388370513916
Epoch: 3, Steps: 89 | Train Loss: 0.289 Vali Loss: 0.245 Vali Acc: 0.925 Test Loss: 0.245 Test Acc: 0.925
Validation loss decreased (-0.910164 --> -0.924789).  Saving model ...
Epoch: 4 cost time: 6.584141254425049
Epoch: 4, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.346 Vali Acc: 0.890 Test Loss: 0.346 Test Acc: 0.890
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.427512168884277
Epoch: 5, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.339 Vali Acc: 0.926 Test Loss: 0.339 Test Acc: 0.926
Validation loss decreased (-0.924789 --> -0.926180).  Saving model ...
Epoch: 6 cost time: 6.891590595245361
Epoch: 6, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.129 Vali Acc: 0.960 Test Loss: 0.129 Test Acc: 0.960
Validation loss decreased (-0.926180 --> -0.959609).  Saving model ...
Epoch: 7 cost time: 7.2945568561553955
Epoch: 7, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.109 Vali Acc: 0.962 Test Loss: 0.109 Test Acc: 0.962
Validation loss decreased (-0.959609 --> -0.961698).  Saving model ...
Epoch: 8 cost time: 7.18630313873291
Epoch: 8, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.175 Vali Acc: 0.947 Test Loss: 0.175 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.41083836555481
Epoch: 9, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.148 Vali Acc: 0.964 Test Loss: 0.148 Test Acc: 0.964
Validation loss decreased (-0.961698 --> -0.964483).  Saving model ...
Epoch: 10 cost time: 7.469599008560181
Epoch: 10, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.287 Vali Acc: 0.939 Test Loss: 0.287 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.093469142913818
Epoch: 11, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
Validation loss decreased (-0.964483 --> -0.976322).  Saving model ...
Epoch: 12 cost time: 6.882518529891968
Epoch: 12, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.119 Vali Acc: 0.972 Test Loss: 0.119 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.766884803771973
Epoch: 13, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.116 Vali Acc: 0.966 Test Loss: 0.116 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.483709335327148
Epoch: 14, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 7.12991738319397
Epoch: 15, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
Validation loss decreased (-0.976322 --> -0.983286).  Saving model ...
Epoch: 16 cost time: 6.809396266937256
Epoch: 16, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.316 Vali Acc: 0.910 Test Loss: 0.316 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.530700445175171
Epoch: 17, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.141 Vali Acc: 0.969 Test Loss: 0.141 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.220805406570435
Epoch: 18, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.153 Vali Acc: 0.962 Test Loss: 0.153 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.133402347564697
Epoch: 19, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.174 Vali Acc: 0.964 Test Loss: 0.174 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 7.0049567222595215
Epoch: 20, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.205 Vali Acc: 0.957 Test Loss: 0.205 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.665649890899658
Epoch: 21, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.126 Vali Acc: 0.971 Test Loss: 0.126 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 7.303630113601685
Epoch: 22, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 7.157827377319336
Epoch: 23, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.250 Vali Acc: 0.946 Test Loss: 0.250 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 6.587845325469971
Epoch: 24, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.179 Vali Acc: 0.964 Test Loss: 0.179 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 6.893388986587524
Epoch: 25, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.180 Vali Acc: 0.960 Test Loss: 0.180 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 1577016
model size : 8.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.187931060791016
Epoch: 1, Steps: 89 | Train Loss: 2.360 Vali Loss: 1.150 Vali Acc: 0.702 Test Loss: 1.150 Test Acc: 0.702
Validation loss decreased (inf --> -0.701938).  Saving model ...
Epoch: 2 cost time: 6.777909517288208
Epoch: 2, Steps: 89 | Train Loss: 0.604 Vali Loss: 0.379 Vali Acc: 0.893 Test Loss: 0.379 Test Acc: 0.893
Validation loss decreased (-0.701938 --> -0.893450).  Saving model ...
Epoch: 3 cost time: 7.206491947174072
Epoch: 3, Steps: 89 | Train Loss: 0.295 Vali Loss: 0.292 Vali Acc: 0.907 Test Loss: 0.292 Test Acc: 0.907
Validation loss decreased (-0.893450 --> -0.907379).  Saving model ...
Epoch: 4 cost time: 6.635643005371094
Epoch: 4, Steps: 89 | Train Loss: 0.205 Vali Loss: 0.208 Vali Acc: 0.939 Test Loss: 0.208 Test Acc: 0.939
Validation loss decreased (-0.907379 --> -0.938717).  Saving model ...
Epoch: 5 cost time: 6.397338151931763
Epoch: 5, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.123 Vali Acc: 0.964 Test Loss: 0.123 Test Acc: 0.964
Validation loss decreased (-0.938717 --> -0.963787).  Saving model ...
Epoch: 6 cost time: 6.830648183822632
Epoch: 6, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.376 Vali Acc: 0.903 Test Loss: 0.376 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.432184934616089
Epoch: 7, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.117 Vali Acc: 0.964 Test Loss: 0.117 Test Acc: 0.964
Validation loss decreased (-0.963787 --> -0.964484).  Saving model ...
Epoch: 8 cost time: 7.2629616260528564
Epoch: 8, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.120 Vali Acc: 0.964 Test Loss: 0.120 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.941587448120117
Epoch: 9, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.113 Vali Acc: 0.963 Test Loss: 0.113 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.227985382080078
Epoch: 10, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.46083402633667
Epoch: 11, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.177 Vali Acc: 0.965 Test Loss: 0.177 Test Acc: 0.965
Validation loss decreased (-0.964484 --> -0.965179).  Saving model ...
Epoch: 12 cost time: 6.631373167037964
Epoch: 12, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.147 Vali Acc: 0.960 Test Loss: 0.147 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.355297327041626
Epoch: 13, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
Validation loss decreased (-0.965179 --> -0.973537).  Saving model ...
Epoch: 14 cost time: 6.619326114654541
Epoch: 14, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.065880060195923
Epoch: 15, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.152 Vali Acc: 0.956 Test Loss: 0.152 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.79983115196228
Epoch: 16, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.154 Vali Acc: 0.964 Test Loss: 0.154 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.73696231842041
Epoch: 17, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.148 Vali Acc: 0.962 Test Loss: 0.148 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.969188690185547
Epoch: 18, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.184 Vali Acc: 0.952 Test Loss: 0.184 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.9831249713897705
Epoch: 19, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.180 Vali Acc: 0.960 Test Loss: 0.180 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 7.295910358428955
Epoch: 20, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.124 Vali Acc: 0.971 Test Loss: 0.124 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 7.312315940856934
Epoch: 21, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.164 Vali Acc: 0.969 Test Loss: 0.164 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 7.616417169570923
Epoch: 22, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.147 Vali Acc: 0.965 Test Loss: 0.147 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 7.096864700317383
Epoch: 23, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.159 Vali Acc: 0.960 Test Loss: 0.159 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9735376044568245
model parameter : 1573944
model size : 8.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.892319440841675
Epoch: 1, Steps: 89 | Train Loss: 2.328 Vali Loss: 1.058 Vali Acc: 0.743 Test Loss: 1.058 Test Acc: 0.743
Validation loss decreased (inf --> -0.743026).  Saving model ...
Epoch: 2 cost time: 7.077033996582031
Epoch: 2, Steps: 89 | Train Loss: 0.563 Vali Loss: 0.312 Vali Acc: 0.910 Test Loss: 0.312 Test Acc: 0.910
Validation loss decreased (-0.743026 --> -0.910164).  Saving model ...
Epoch: 3 cost time: 6.839726686477661
Epoch: 3, Steps: 89 | Train Loss: 0.269 Vali Loss: 0.261 Vali Acc: 0.914 Test Loss: 0.261 Test Acc: 0.914
Validation loss decreased (-0.910164 --> -0.913646).  Saving model ...
Epoch: 4 cost time: 6.572138786315918
Epoch: 4, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.250 Vali Acc: 0.923 Test Loss: 0.250 Test Acc: 0.923
Validation loss decreased (-0.913646 --> -0.922699).  Saving model ...
Epoch: 5 cost time: 6.418850421905518
Epoch: 5, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.110 Vali Acc: 0.966 Test Loss: 0.110 Test Acc: 0.966
Validation loss decreased (-0.922699 --> -0.965876).  Saving model ...
Epoch: 6 cost time: 7.495782852172852
Epoch: 6, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.158 Vali Acc: 0.959 Test Loss: 0.158 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.558182001113892
Epoch: 7, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.227 Vali Acc: 0.935 Test Loss: 0.227 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.770432949066162
Epoch: 8, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.220 Vali Acc: 0.939 Test Loss: 0.220 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.500072240829468
Epoch: 9, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.168 Vali Acc: 0.954 Test Loss: 0.168 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.700741291046143
Epoch: 10, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.125 Vali Acc: 0.971 Test Loss: 0.125 Test Acc: 0.971
Validation loss decreased (-0.965876 --> -0.970751).  Saving model ...
Epoch: 11 cost time: 6.612117052078247
Epoch: 11, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.180 Vali Acc: 0.956 Test Loss: 0.180 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.56648063659668
Epoch: 12, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.970751 --> -0.972840).  Saving model ...
Epoch: 13 cost time: 6.486671209335327
Epoch: 13, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
Validation loss decreased (-0.972840 --> -0.977715).  Saving model ...
Epoch: 14 cost time: 6.53961968421936
Epoch: 14, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.322164535522461
Epoch: 15, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.156682968139648
Epoch: 16, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.131 Vali Acc: 0.969 Test Loss: 0.131 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.1823999881744385
Epoch: 17, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.189 Vali Acc: 0.956 Test Loss: 0.189 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.654423952102661
Epoch: 18, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.327 Vali Acc: 0.928 Test Loss: 0.327 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.515978097915649
Epoch: 19, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.216 Vali Acc: 0.961 Test Loss: 0.216 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 6.86074686050415
Epoch: 20, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.170 Vali Acc: 0.969 Test Loss: 0.170 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 6.596618413925171
Epoch: 21, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.257 Vali Acc: 0.937 Test Loss: 0.257 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 7.13658881187439
Epoch: 22, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 6.2412121295928955
Epoch: 23, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.151 Vali Acc: 0.970 Test Loss: 0.151 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 1570872
model size : 8.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.561434984207153
Epoch: 1, Steps: 89 | Train Loss: 2.487 Vali Loss: 1.363 Vali Acc: 0.712 Test Loss: 1.363 Test Acc: 0.712
Validation loss decreased (inf --> -0.712382).  Saving model ...
Epoch: 2 cost time: 6.373254060745239
Epoch: 2, Steps: 89 | Train Loss: 0.777 Vali Loss: 0.487 Vali Acc: 0.877 Test Loss: 0.487 Test Acc: 0.877
Validation loss decreased (-0.712382 --> -0.876736).  Saving model ...
Epoch: 3 cost time: 6.198877334594727
Epoch: 3, Steps: 89 | Train Loss: 0.381 Vali Loss: 0.307 Vali Acc: 0.916 Test Loss: 0.307 Test Acc: 0.916
Validation loss decreased (-0.876736 --> -0.916431).  Saving model ...
Epoch: 4 cost time: 6.763324022293091
Epoch: 4, Steps: 89 | Train Loss: 0.275 Vali Loss: 0.281 Vali Acc: 0.907 Test Loss: 0.281 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.19362735748291
Epoch: 5, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.202 Vali Acc: 0.946 Test Loss: 0.202 Test Acc: 0.946
Validation loss decreased (-0.916431 --> -0.946377).  Saving model ...
Epoch: 6 cost time: 7.282841682434082
Epoch: 6, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
Validation loss decreased (-0.946377 --> -0.956823).  Saving model ...
Epoch: 7 cost time: 6.801360368728638
Epoch: 7, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.143 Vali Acc: 0.955 Test Loss: 0.143 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.750264644622803
Epoch: 8, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.122 Vali Acc: 0.964 Test Loss: 0.122 Test Acc: 0.964
Validation loss decreased (-0.956823 --> -0.964483).  Saving model ...
Epoch: 9 cost time: 7.408139705657959
Epoch: 9, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
Validation loss decreased (-0.964483 --> -0.966573).  Saving model ...
Epoch: 10 cost time: 7.108162879943848
Epoch: 10, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.966573 --> -0.972840).  Saving model ...
Epoch: 11 cost time: 6.798906087875366
Epoch: 11, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.831020355224609
Epoch: 12, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
Validation loss decreased (-0.972840 --> -0.978411).  Saving model ...
Epoch: 13 cost time: 7.753445863723755
Epoch: 13, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.822899341583252
Epoch: 14, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.069 Vali Acc: 0.979 Test Loss: 0.069 Test Acc: 0.979
Validation loss decreased (-0.978411 --> -0.979108).  Saving model ...
Epoch: 15 cost time: 7.572576522827148
Epoch: 15, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.496306657791138
Epoch: 16, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.133 Vali Acc: 0.964 Test Loss: 0.133 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.662761926651001
Epoch: 17, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.076 Vali Acc: 0.979 Test Loss: 0.076 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.804806709289551
Epoch: 18, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 7.090462923049927
Epoch: 19, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 7.20280647277832
Epoch: 20, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.2993035316467285
Epoch: 21, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.087 Vali Acc: 0.974 Test Loss: 0.087 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 6.842880010604858
Epoch: 22, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 6.29243540763855
Epoch: 23, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.098 Vali Acc: 0.972 Test Loss: 0.098 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 6.362687587738037
Epoch: 24, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
Validation loss decreased (-0.979108 --> -0.981197).  Saving model ...
Epoch: 25 cost time: 7.772754192352295
Epoch: 25, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.113 Vali Acc: 0.962 Test Loss: 0.113 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.9229512214660645
Epoch: 26, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.133 Vali Acc: 0.964 Test Loss: 0.133 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 7.087163925170898
Epoch: 27, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.119 Vali Acc: 0.967 Test Loss: 0.119 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 6.6330461502075195
Epoch: 28, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 5.749902725219727
Epoch: 29, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.141 Vali Acc: 0.960 Test Loss: 0.141 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 6.468228340148926
Epoch: 30, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.162 Vali Acc: 0.960 Test Loss: 0.162 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 6.614344120025635
Epoch: 31, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 6.744259595870972
Epoch: 32, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 6.130725860595703
Epoch: 33, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.100 Vali Acc: 0.972 Test Loss: 0.100 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 6.689183235168457
Epoch: 34, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.123 Vali Acc: 0.974 Test Loss: 0.123 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 1040632
model size : 5.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.906255006790161
Epoch: 1, Steps: 89 | Train Loss: 2.420 Vali Loss: 1.253 Vali Acc: 0.740 Test Loss: 1.253 Test Acc: 0.740
Validation loss decreased (inf --> -0.739542).  Saving model ...
Epoch: 2 cost time: 6.639641523361206
Epoch: 2, Steps: 89 | Train Loss: 0.743 Vali Loss: 0.463 Vali Acc: 0.882 Test Loss: 0.463 Test Acc: 0.882
Validation loss decreased (-0.739542 --> -0.881611).  Saving model ...
Epoch: 3 cost time: 8.33774995803833
Epoch: 3, Steps: 89 | Train Loss: 0.369 Vali Loss: 0.284 Vali Acc: 0.935 Test Loss: 0.284 Test Acc: 0.935
Validation loss decreased (-0.881611 --> -0.934538).  Saving model ...
Epoch: 4 cost time: 7.742070913314819
Epoch: 4, Steps: 89 | Train Loss: 0.236 Vali Loss: 0.237 Vali Acc: 0.932 Test Loss: 0.237 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.9491424560546875
Epoch: 5, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.237 Vali Acc: 0.923 Test Loss: 0.237 Test Acc: 0.923
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.663811683654785
Epoch: 6, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.151 Vali Acc: 0.955 Test Loss: 0.151 Test Acc: 0.955
Validation loss decreased (-0.934538 --> -0.954734).  Saving model ...
Epoch: 7 cost time: 7.546080589294434
Epoch: 7, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
Validation loss decreased (-0.954734 --> -0.970055).  Saving model ...
Epoch: 8 cost time: 6.986204624176025
Epoch: 8, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.637479066848755
Epoch: 9, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.111 Vali Acc: 0.967 Test Loss: 0.111 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.9345598220825195
Epoch: 10, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.106 Vali Acc: 0.969 Test Loss: 0.106 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.725729703903198
Epoch: 11, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.145 Vali Acc: 0.960 Test Loss: 0.145 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 7.044957160949707
Epoch: 12, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.120 Vali Acc: 0.963 Test Loss: 0.120 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.811430931091309
Epoch: 13, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.970055 --> -0.972840).  Saving model ...
Epoch: 14 cost time: 7.133218050003052
Epoch: 14, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.097 Vali Acc: 0.972 Test Loss: 0.097 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.739748239517212
Epoch: 15, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.975626).  Saving model ...
Epoch: 16 cost time: 6.238853931427002
Epoch: 16, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.00377893447876
Epoch: 17, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.104 Vali Acc: 0.972 Test Loss: 0.104 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.6698760986328125
Epoch: 18, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.975626 --> -0.976322).  Saving model ...
Epoch: 19 cost time: 6.386585235595703
Epoch: 19, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.135 Vali Acc: 0.958 Test Loss: 0.135 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.36122727394104
Epoch: 20, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.078 Vali Acc: 0.975 Test Loss: 0.078 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.899060487747192
Epoch: 21, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.137909173965454
Epoch: 22, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.488846778869629
Epoch: 23, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.112 Vali Acc: 0.966 Test Loss: 0.112 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 6.031007766723633
Epoch: 24, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.977715).  Saving model ...
Epoch: 25 cost time: 6.470357656478882
Epoch: 25, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.149328947067261
Epoch: 26, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.877644062042236
Epoch: 27, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.140 Vali Acc: 0.969 Test Loss: 0.140 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 5.912187337875366
Epoch: 28, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.115 Vali Acc: 0.969 Test Loss: 0.115 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 6.697258234024048
Epoch: 29, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.091 Vali Acc: 0.972 Test Loss: 0.091 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 6.360536575317383
Epoch: 30, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 6.802638053894043
Epoch: 31, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 6.488021373748779
Epoch: 32, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.978412).  Saving model ...
Epoch: 33 cost time: 7.59486722946167
Epoch: 33, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.167 Vali Acc: 0.961 Test Loss: 0.167 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 7.395186185836792
Epoch: 34, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 7.918834924697876
Epoch: 35, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 6.747424364089966
Epoch: 36, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.146 Vali Acc: 0.964 Test Loss: 0.146 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 6.151262521743774
Epoch: 37, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.140 Vali Acc: 0.968 Test Loss: 0.140 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 7.445336818695068
Epoch: 38, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.244 Vali Acc: 0.950 Test Loss: 0.244 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 6.883762359619141
Epoch: 39, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.107 Vali Acc: 0.981 Test Loss: 0.107 Test Acc: 0.981
Validation loss decreased (-0.978412 --> -0.981197).  Saving model ...
Epoch: 40 cost time: 6.777652978897095
Epoch: 40, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.116 Vali Acc: 0.972 Test Loss: 0.116 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 6.698569059371948
Epoch: 41, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.140 Vali Acc: 0.971 Test Loss: 0.140 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 6.497409820556641
Epoch: 42, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.206 Vali Acc: 0.960 Test Loss: 0.206 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 7.178282976150513
Epoch: 43, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 6.220722436904907
Epoch: 44, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.157 Vali Acc: 0.969 Test Loss: 0.157 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 7.710503339767456
Epoch: 45, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.202 Vali Acc: 0.954 Test Loss: 0.202 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 6.041638135910034
Epoch: 46, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.149 Vali Acc: 0.971 Test Loss: 0.149 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 7.142442941665649
Epoch: 47, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 6.379130840301514
Epoch: 48, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.113 Vali Acc: 0.979 Test Loss: 0.113 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 6.390492677688599
Epoch: 49, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.172 Vali Acc: 0.962 Test Loss: 0.172 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 1039096
model size : 5.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.622012615203857
Epoch: 1, Steps: 89 | Train Loss: 2.511 Vali Loss: 1.391 Vali Acc: 0.682 Test Loss: 1.391 Test Acc: 0.682
Validation loss decreased (inf --> -0.681741).  Saving model ...
Epoch: 2 cost time: 6.666499137878418
Epoch: 2, Steps: 89 | Train Loss: 0.794 Vali Loss: 0.482 Vali Acc: 0.875 Test Loss: 0.482 Test Acc: 0.875
Validation loss decreased (-0.681741 --> -0.875343).  Saving model ...
Epoch: 3 cost time: 6.365899085998535
Epoch: 3, Steps: 89 | Train Loss: 0.394 Vali Loss: 0.326 Vali Acc: 0.910 Test Loss: 0.326 Test Acc: 0.910
Validation loss decreased (-0.875343 --> -0.910164).  Saving model ...
Epoch: 4 cost time: 6.787889003753662
Epoch: 4, Steps: 89 | Train Loss: 0.240 Vali Loss: 0.247 Vali Acc: 0.928 Test Loss: 0.247 Test Acc: 0.928
Validation loss decreased (-0.910164 --> -0.928271).  Saving model ...
Epoch: 5 cost time: 7.468585014343262
Epoch: 5, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.155 Vali Acc: 0.958 Test Loss: 0.155 Test Acc: 0.958
Validation loss decreased (-0.928271 --> -0.957519).  Saving model ...
Epoch: 6 cost time: 6.8331849575042725
Epoch: 6, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.159 Vali Acc: 0.952 Test Loss: 0.159 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.662754774093628
Epoch: 7, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.18553614616394
Epoch: 8, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.135 Vali Acc: 0.961 Test Loss: 0.135 Test Acc: 0.961
Validation loss decreased (-0.957519 --> -0.961001).  Saving model ...
Epoch: 9 cost time: 6.94217324256897
Epoch: 9, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
Validation loss decreased (-0.961001 --> -0.970751).  Saving model ...
Epoch: 10 cost time: 7.3464744091033936
Epoch: 10, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.109 Vali Acc: 0.966 Test Loss: 0.109 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.996802568435669
Epoch: 11, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.091 Vali Acc: 0.972 Test Loss: 0.091 Test Acc: 0.972
Validation loss decreased (-0.970751 --> -0.972144).  Saving model ...
Epoch: 12 cost time: 7.303376913070679
Epoch: 12, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.104 Vali Acc: 0.964 Test Loss: 0.104 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.825782537460327
Epoch: 13, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.119 Vali Acc: 0.960 Test Loss: 0.119 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.88694953918457
Epoch: 14, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 8.23952579498291
Epoch: 15, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
Validation loss decreased (-0.972144 --> -0.976322).  Saving model ...
Epoch: 16 cost time: 7.3350608348846436
Epoch: 16, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.167 Vali Acc: 0.950 Test Loss: 0.167 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.475704908370972
Epoch: 17, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.912734746932983
Epoch: 18, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.142 Vali Acc: 0.960 Test Loss: 0.142 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 7.390817880630493
Epoch: 19, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.125 Vali Acc: 0.966 Test Loss: 0.125 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 7.011023998260498
Epoch: 20, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 7.293290376663208
Epoch: 21, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 8.133888483047485
Epoch: 22, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.134 Vali Acc: 0.964 Test Loss: 0.134 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 7.996098041534424
Epoch: 23, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.165 Vali Acc: 0.961 Test Loss: 0.165 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 7.681045293807983
Epoch: 24, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.149 Vali Acc: 0.965 Test Loss: 0.149 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 7.168421030044556
Epoch: 25, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.206 Vali Acc: 0.953 Test Loss: 0.206 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 1037560
model size : 5.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.591225862503052
Epoch: 1, Steps: 89 | Train Loss: 2.522 Vali Loss: 1.343 Vali Acc: 0.692 Test Loss: 1.343 Test Acc: 0.692
Validation loss decreased (inf --> -0.692187).  Saving model ...
Epoch: 2 cost time: 7.203254461288452
Epoch: 2, Steps: 89 | Train Loss: 0.787 Vali Loss: 0.486 Vali Acc: 0.879 Test Loss: 0.486 Test Acc: 0.879
Validation loss decreased (-0.692187 --> -0.878825).  Saving model ...
Epoch: 3 cost time: 5.999699592590332
Epoch: 3, Steps: 89 | Train Loss: 0.365 Vali Loss: 0.283 Vali Acc: 0.926 Test Loss: 0.283 Test Acc: 0.926
Validation loss decreased (-0.878825 --> -0.926181).  Saving model ...
Epoch: 4 cost time: 6.0646209716796875
Epoch: 4, Steps: 89 | Train Loss: 0.248 Vali Loss: 0.215 Vali Acc: 0.933 Test Loss: 0.215 Test Acc: 0.933
Validation loss decreased (-0.926181 --> -0.933145).  Saving model ...
Epoch: 5 cost time: 6.3895721435546875
Epoch: 5, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.184 Vali Acc: 0.943 Test Loss: 0.184 Test Acc: 0.943
Validation loss decreased (-0.933145 --> -0.942895).  Saving model ...
Epoch: 6 cost time: 6.866984844207764
Epoch: 6, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.144 Vali Acc: 0.963 Test Loss: 0.144 Test Acc: 0.963
Validation loss decreased (-0.942895 --> -0.963090).  Saving model ...
Epoch: 7 cost time: 5.873698711395264
Epoch: 7, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.886904954910278
Epoch: 8, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.117 Vali Acc: 0.964 Test Loss: 0.117 Test Acc: 0.964
Validation loss decreased (-0.963090 --> -0.964484).  Saving model ...
Epoch: 9 cost time: 6.81077766418457
Epoch: 9, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.931766033172607
Epoch: 10, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.143 Vali Acc: 0.952 Test Loss: 0.143 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.778923749923706
Epoch: 11, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.964484 --> -0.972840).  Saving model ...
Epoch: 12 cost time: 6.913386106491089
Epoch: 12, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
Validation loss decreased (-0.972840 --> -0.974929).  Saving model ...
Epoch: 13 cost time: 6.384613275527954
Epoch: 13, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.122 Vali Acc: 0.963 Test Loss: 0.122 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.076938152313232
Epoch: 14, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.402030944824219
Epoch: 15, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.733697891235352
Epoch: 16, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.115 Vali Acc: 0.963 Test Loss: 0.115 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.043772220611572
Epoch: 17, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975626).  Saving model ...
Epoch: 18 cost time: 7.198487043380737
Epoch: 18, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
Validation loss decreased (-0.975626 --> -0.978411).  Saving model ...
Epoch: 19 cost time: 6.796766996383667
Epoch: 19, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.135 Vali Acc: 0.969 Test Loss: 0.135 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 7.1042845249176025
Epoch: 20, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.119 Vali Acc: 0.964 Test Loss: 0.119 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.828564643859863
Epoch: 21, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.990974426269531
Epoch: 22, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.148 Vali Acc: 0.967 Test Loss: 0.148 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.709401369094849
Epoch: 23, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
Validation loss decreased (-0.978411 --> -0.980501).  Saving model ...
Epoch: 24 cost time: 6.920862436294556
Epoch: 24, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 7.005755662918091
Epoch: 25, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.141 Vali Acc: 0.968 Test Loss: 0.141 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.380582809448242
Epoch: 26, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 6.647610187530518
Epoch: 27, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.231 Vali Acc: 0.939 Test Loss: 0.231 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 6.166663408279419
Epoch: 28, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.109 Vali Acc: 0.966 Test Loss: 0.109 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 5.893468141555786
Epoch: 29, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.139 Vali Acc: 0.968 Test Loss: 0.139 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 6.271007061004639
Epoch: 30, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 6.4010090827941895
Epoch: 31, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.154 Vali Acc: 0.956 Test Loss: 0.154 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 5.741496801376343
Epoch: 32, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.180 Vali Acc: 0.957 Test Loss: 0.180 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 5.833635330200195
Epoch: 33, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.119 Vali Acc: 0.964 Test Loss: 0.119 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 1036024
model size : 5.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.069486618041992
Epoch: 1, Steps: 89 | Train Loss: 2.593 Vali Loss: 1.511 Vali Acc: 0.694 Test Loss: 1.511 Test Acc: 0.694
Validation loss decreased (inf --> -0.693578).  Saving model ...
Epoch: 2 cost time: 6.917438983917236
Epoch: 2, Steps: 89 | Train Loss: 0.859 Vali Loss: 0.507 Vali Acc: 0.861 Test Loss: 0.507 Test Acc: 0.861
Validation loss decreased (-0.693578 --> -0.861416).  Saving model ...
Epoch: 3 cost time: 6.800048112869263
Epoch: 3, Steps: 89 | Train Loss: 0.388 Vali Loss: 0.298 Vali Acc: 0.921 Test Loss: 0.298 Test Acc: 0.921
Validation loss decreased (-0.861416 --> -0.921306).  Saving model ...
Epoch: 4 cost time: 6.820712327957153
Epoch: 4, Steps: 89 | Train Loss: 0.235 Vali Loss: 0.253 Vali Acc: 0.928 Test Loss: 0.253 Test Acc: 0.928
Validation loss decreased (-0.921306 --> -0.928270).  Saving model ...
Epoch: 5 cost time: 6.628870248794556
Epoch: 5, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.147 Vali Acc: 0.960 Test Loss: 0.147 Test Acc: 0.960
Validation loss decreased (-0.928270 --> -0.960305).  Saving model ...
Epoch: 6 cost time: 7.1161744594573975
Epoch: 6, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.110 Vali Acc: 0.967 Test Loss: 0.110 Test Acc: 0.967
Validation loss decreased (-0.960305 --> -0.966573).  Saving model ...
Epoch: 7 cost time: 7.2686169147491455
Epoch: 7, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.128 Vali Acc: 0.959 Test Loss: 0.128 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.2638773918151855
Epoch: 8, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.128 Vali Acc: 0.960 Test Loss: 0.128 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.875184774398804
Epoch: 9, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.162 Vali Acc: 0.945 Test Loss: 0.162 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.837541341781616
Epoch: 10, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.094 Vali Acc: 0.969 Test Loss: 0.094 Test Acc: 0.969
Validation loss decreased (-0.966573 --> -0.968662).  Saving model ...
Epoch: 11 cost time: 7.314714670181274
Epoch: 11, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
Validation loss decreased (-0.968662 --> -0.978411).  Saving model ...
Epoch: 12 cost time: 7.4048752784729
Epoch: 12, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.119 Vali Acc: 0.960 Test Loss: 0.119 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.4243481159210205
Epoch: 13, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.090 Vali Acc: 0.974 Test Loss: 0.090 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.978440523147583
Epoch: 14, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.070 Vali Acc: 0.979 Test Loss: 0.070 Test Acc: 0.979
Validation loss decreased (-0.978411 --> -0.979108).  Saving model ...
Epoch: 15 cost time: 7.615257978439331
Epoch: 15, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.115 Vali Acc: 0.966 Test Loss: 0.115 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.675106763839722
Epoch: 16, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.627101421356201
Epoch: 17, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 7.453735589981079
Epoch: 18, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.059 Vali Acc: 0.982 Test Loss: 0.059 Test Acc: 0.982
Validation loss decreased (-0.979108 --> -0.981894).  Saving model ...
Epoch: 19 cost time: 7.633886337280273
Epoch: 19, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.087 Vali Acc: 0.974 Test Loss: 0.087 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 7.241865873336792
Epoch: 20, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 7.755148887634277
Epoch: 21, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 7.122408390045166
Epoch: 22, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 7.263947486877441
Epoch: 23, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 7.258713722229004
Epoch: 24, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 7.233827590942383
Epoch: 25, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 6.929494619369507
Epoch: 26, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.096 Vali Acc: 0.972 Test Loss: 0.096 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 6.9675209522247314
Epoch: 27, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 6.96707558631897
Epoch: 28, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 710392
model size : 4.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.989931583404541
Epoch: 1, Steps: 89 | Train Loss: 2.658 Vali Loss: 1.621 Vali Acc: 0.671 Test Loss: 1.621 Test Acc: 0.671
Validation loss decreased (inf --> -0.670597).  Saving model ...
Epoch: 2 cost time: 8.283756256103516
Epoch: 2, Steps: 89 | Train Loss: 0.886 Vali Loss: 0.526 Vali Acc: 0.861 Test Loss: 0.526 Test Acc: 0.861
Validation loss decreased (-0.670597 --> -0.861415).  Saving model ...
Epoch: 3 cost time: 6.650099754333496
Epoch: 3, Steps: 89 | Train Loss: 0.385 Vali Loss: 0.298 Vali Acc: 0.926 Test Loss: 0.298 Test Acc: 0.926
Validation loss decreased (-0.861415 --> -0.926181).  Saving model ...
Epoch: 4 cost time: 7.3982720375061035
Epoch: 4, Steps: 89 | Train Loss: 0.246 Vali Loss: 0.229 Vali Acc: 0.935 Test Loss: 0.229 Test Acc: 0.935
Validation loss decreased (-0.926181 --> -0.935234).  Saving model ...
Epoch: 5 cost time: 7.456757068634033
Epoch: 5, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.935234 --> -0.944288).  Saving model ...
Epoch: 6 cost time: 6.949194669723511
Epoch: 6, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.188 Vali Acc: 0.939 Test Loss: 0.188 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.740337133407593
Epoch: 7, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.123 Vali Acc: 0.963 Test Loss: 0.123 Test Acc: 0.963
Validation loss decreased (-0.944288 --> -0.963091).  Saving model ...
Epoch: 8 cost time: 6.248365163803101
Epoch: 8, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.8336358070373535
Epoch: 9, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.101 Vali Acc: 0.969 Test Loss: 0.101 Test Acc: 0.969
Validation loss decreased (-0.963091 --> -0.969358).  Saving model ...
Epoch: 10 cost time: 6.679232597351074
Epoch: 10, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.092 Vali Acc: 0.972 Test Loss: 0.092 Test Acc: 0.972
Validation loss decreased (-0.969358 --> -0.972144).  Saving model ...
Epoch: 11 cost time: 6.299156665802002
Epoch: 11, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.255 Vali Acc: 0.919 Test Loss: 0.255 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.557528257369995
Epoch: 12, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.108 Vali Acc: 0.964 Test Loss: 0.108 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.673929452896118
Epoch: 13, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.972144 --> -0.979804).  Saving model ...
Epoch: 14 cost time: 6.564786911010742
Epoch: 14, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.901770114898682
Epoch: 15, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.094 Vali Acc: 0.971 Test Loss: 0.094 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.640674829483032
Epoch: 16, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.01960825920105
Epoch: 17, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.054 Vali Acc: 0.984 Test Loss: 0.054 Test Acc: 0.984
Validation loss decreased (-0.979804 --> -0.983983).  Saving model ...
Epoch: 18 cost time: 7.9913036823272705
Epoch: 18, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.084 Vali Acc: 0.974 Test Loss: 0.084 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.762806415557861
Epoch: 19, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 7.150531530380249
Epoch: 20, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.151 Vali Acc: 0.959 Test Loss: 0.151 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.9101035594940186
Epoch: 21, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.151 Vali Acc: 0.962 Test Loss: 0.151 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.743741750717163
Epoch: 22, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.221 Vali Acc: 0.939 Test Loss: 0.221 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.606634616851807
Epoch: 23, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.167 Vali Acc: 0.962 Test Loss: 0.167 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 7.28574800491333
Epoch: 24, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 6.97371768951416
Epoch: 25, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.068 Vali Acc: 0.985 Test Loss: 0.068 Test Acc: 0.985
Validation loss decreased (-0.983983 --> -0.984679).  Saving model ...
Epoch: 26 cost time: 6.945660591125488
Epoch: 26, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 7.40044641494751
Epoch: 27, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 7.142524242401123
Epoch: 28, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 6.8768815994262695
Epoch: 29, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.160 Vali Acc: 0.960 Test Loss: 0.160 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 6.450355291366577
Epoch: 30, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.209 Vali Acc: 0.937 Test Loss: 0.209 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 6.947319746017456
Epoch: 31, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.125 Vali Acc: 0.971 Test Loss: 0.125 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 6.521913766860962
Epoch: 32, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.138 Vali Acc: 0.972 Test Loss: 0.138 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 6.757685899734497
Epoch: 33, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.119 Vali Acc: 0.971 Test Loss: 0.119 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 6.775551080703735
Epoch: 34, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 6.286740064620972
Epoch: 35, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 708856
model size : 4.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.027934312820435
Epoch: 1, Steps: 89 | Train Loss: 2.622 Vali Loss: 1.638 Vali Acc: 0.598 Test Loss: 1.638 Test Acc: 0.598
Validation loss decreased (inf --> -0.598173).  Saving model ...
Epoch: 2 cost time: 6.358227014541626
Epoch: 2, Steps: 89 | Train Loss: 0.910 Vali Loss: 0.547 Vali Acc: 0.858 Test Loss: 0.547 Test Acc: 0.858
Validation loss decreased (-0.598173 --> -0.857933).  Saving model ...
Epoch: 3 cost time: 6.452853441238403
Epoch: 3, Steps: 89 | Train Loss: 0.395 Vali Loss: 0.319 Vali Acc: 0.921 Test Loss: 0.319 Test Acc: 0.921
Validation loss decreased (-0.857933 --> -0.921306).  Saving model ...
Epoch: 4 cost time: 6.491773366928101
Epoch: 4, Steps: 89 | Train Loss: 0.258 Vali Loss: 0.263 Vali Acc: 0.916 Test Loss: 0.263 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.105329990386963
Epoch: 5, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.163 Vali Acc: 0.960 Test Loss: 0.163 Test Acc: 0.960
Validation loss decreased (-0.921306 --> -0.960305).  Saving model ...
Epoch: 6 cost time: 6.842617750167847
Epoch: 6, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.137 Vali Acc: 0.961 Test Loss: 0.137 Test Acc: 0.961
Validation loss decreased (-0.960305 --> -0.961001).  Saving model ...
Epoch: 7 cost time: 7.062763214111328
Epoch: 7, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.112 Vali Acc: 0.966 Test Loss: 0.112 Test Acc: 0.966
Validation loss decreased (-0.961001 --> -0.965876).  Saving model ...
Epoch: 8 cost time: 6.800922393798828
Epoch: 8, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.122 Vali Acc: 0.966 Test Loss: 0.122 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.516753911972046
Epoch: 9, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.088 Vali Acc: 0.974 Test Loss: 0.088 Test Acc: 0.974
Validation loss decreased (-0.965876 --> -0.973537).  Saving model ...
Epoch: 10 cost time: 6.690464496612549
Epoch: 10, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.078 Vali Acc: 0.979 Test Loss: 0.078 Test Acc: 0.979
Validation loss decreased (-0.973537 --> -0.979108).  Saving model ...
Epoch: 11 cost time: 6.585071563720703
Epoch: 11, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.125 Vali Acc: 0.964 Test Loss: 0.125 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.352007865905762
Epoch: 12, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.257222890853882
Epoch: 13, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979108 --> -0.979804).  Saving model ...
Epoch: 14 cost time: 6.69641900062561
Epoch: 14, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.371 Vali Acc: 0.930 Test Loss: 0.371 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.073782444000244
Epoch: 15, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.215933084487915
Epoch: 16, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980501).  Saving model ...
Epoch: 17 cost time: 6.428563356399536
Epoch: 17, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.714583873748779
Epoch: 18, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.110 Vali Acc: 0.969 Test Loss: 0.110 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 7.069697380065918
Epoch: 19, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.141 Vali Acc: 0.960 Test Loss: 0.141 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 7.972509384155273
Epoch: 20, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.139 Vali Acc: 0.954 Test Loss: 0.139 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 7.656692981719971
Epoch: 21, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 8.552310943603516
Epoch: 22, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.123 Vali Acc: 0.964 Test Loss: 0.123 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 7.821909666061401
Epoch: 23, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.196 Vali Acc: 0.952 Test Loss: 0.196 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 7.524163007736206
Epoch: 24, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 6.992918968200684
Epoch: 25, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 7.648793458938599
Epoch: 26, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 707320
model size : 4.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.145679712295532
Epoch: 1, Steps: 89 | Train Loss: 2.567 Vali Loss: 1.485 Vali Acc: 0.696 Test Loss: 1.485 Test Acc: 0.696
Validation loss decreased (inf --> -0.695668).  Saving model ...
Epoch: 2 cost time: 6.830000400543213
Epoch: 2, Steps: 89 | Train Loss: 0.868 Vali Loss: 0.493 Vali Acc: 0.872 Test Loss: 0.493 Test Acc: 0.872
Validation loss decreased (-0.695668 --> -0.871861).  Saving model ...
Epoch: 3 cost time: 6.543631315231323
Epoch: 3, Steps: 89 | Train Loss: 0.397 Vali Loss: 0.278 Vali Acc: 0.936 Test Loss: 0.278 Test Acc: 0.936
Validation loss decreased (-0.871861 --> -0.935930).  Saving model ...
Epoch: 4 cost time: 7.640519142150879
Epoch: 4, Steps: 89 | Train Loss: 0.245 Vali Loss: 0.220 Vali Acc: 0.940 Test Loss: 0.220 Test Acc: 0.940
Validation loss decreased (-0.935930 --> -0.940109).  Saving model ...
Epoch: 5 cost time: 7.66232442855835
Epoch: 5, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.272 Vali Acc: 0.912 Test Loss: 0.272 Test Acc: 0.912
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.695872783660889
Epoch: 6, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.129 Vali Acc: 0.964 Test Loss: 0.129 Test Acc: 0.964
Validation loss decreased (-0.940109 --> -0.964483).  Saving model ...
Epoch: 7 cost time: 7.031357765197754
Epoch: 7, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.942962408065796
Epoch: 8, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
Validation loss decreased (-0.964483 --> -0.965180).  Saving model ...
Epoch: 9 cost time: 7.42066764831543
Epoch: 9, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.83556056022644
Epoch: 10, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.087 Vali Acc: 0.972 Test Loss: 0.087 Test Acc: 0.972
Validation loss decreased (-0.965180 --> -0.972144).  Saving model ...
Epoch: 11 cost time: 7.127774000167847
Epoch: 11, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
Validation loss decreased (-0.972144 --> -0.974929).  Saving model ...
Epoch: 12 cost time: 8.377456188201904
Epoch: 12, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.153 Vali Acc: 0.953 Test Loss: 0.153 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.673522710800171
Epoch: 13, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.829484224319458
Epoch: 14, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.102 Vali Acc: 0.964 Test Loss: 0.102 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 7.364211559295654
Epoch: 15, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975626).  Saving model ...
Epoch: 16 cost time: 8.359127283096313
Epoch: 16, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 8.090916633605957
Epoch: 17, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.103 Vali Acc: 0.969 Test Loss: 0.103 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.873391151428223
Epoch: 18, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.112 Vali Acc: 0.964 Test Loss: 0.112 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 7.930152893066406
Epoch: 19, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
Validation loss decreased (-0.975626 --> -0.978411).  Saving model ...
Epoch: 20 cost time: 6.804033994674683
Epoch: 20, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.102 Vali Acc: 0.972 Test Loss: 0.102 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.725618124008179
Epoch: 21, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 7.450053691864014
Epoch: 22, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 8.370911598205566
Epoch: 23, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 7.500404357910156
Epoch: 24, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 6.834786891937256
Epoch: 25, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 7.150725841522217
Epoch: 26, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.154 Vali Acc: 0.967 Test Loss: 0.154 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 7.281889915466309
Epoch: 27, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.978411 --> -0.983286).  Saving model ...
Epoch: 28 cost time: 6.777023077011108
Epoch: 28, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 6.934274196624756
Epoch: 29, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.232 Vali Acc: 0.946 Test Loss: 0.232 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 7.2006142139434814
Epoch: 30, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.210 Vali Acc: 0.953 Test Loss: 0.210 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 7.079847812652588
Epoch: 31, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 7.311462879180908
Epoch: 32, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 7.218944311141968
Epoch: 33, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.135 Vali Acc: 0.966 Test Loss: 0.135 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 7.436541557312012
Epoch: 34, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.130 Vali Acc: 0.966 Test Loss: 0.130 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 8.307371139526367
Epoch: 35, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 6.776482582092285
Epoch: 36, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.212 Vali Acc: 0.959 Test Loss: 0.212 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 8.282549619674683
Epoch: 37, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.140 Vali Acc: 0.971 Test Loss: 0.140 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 705784
model size : 4.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.61276888847351
Epoch: 1, Steps: 89 | Train Loss: 2.722 Vali Loss: 1.818 Vali Acc: 0.618 Test Loss: 1.818 Test Acc: 0.618
Validation loss decreased (inf --> -0.617670).  Saving model ...
Epoch: 2 cost time: 7.361069679260254
Epoch: 2, Steps: 89 | Train Loss: 0.968 Vali Loss: 0.544 Vali Acc: 0.864 Test Loss: 0.544 Test Acc: 0.864
Validation loss decreased (-0.617670 --> -0.863504).  Saving model ...
Epoch: 3 cost time: 7.228096008300781
Epoch: 3, Steps: 89 | Train Loss: 0.404 Vali Loss: 0.384 Vali Acc: 0.887 Test Loss: 0.384 Test Acc: 0.887
Validation loss decreased (-0.863504 --> -0.887183).  Saving model ...
Epoch: 4 cost time: 6.193634748458862
Epoch: 4, Steps: 89 | Train Loss: 0.263 Vali Loss: 0.316 Vali Acc: 0.891 Test Loss: 0.316 Test Acc: 0.891
Validation loss decreased (-0.887183 --> -0.891362).  Saving model ...
Epoch: 5 cost time: 7.160813331604004
Epoch: 5, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.176 Vali Acc: 0.953 Test Loss: 0.176 Test Acc: 0.953
Validation loss decreased (-0.891362 --> -0.952644).  Saving model ...
Epoch: 6 cost time: 7.272590160369873
Epoch: 6, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
Validation loss decreased (-0.952644 --> -0.958912).  Saving model ...
Epoch: 7 cost time: 7.033891201019287
Epoch: 7, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
Validation loss decreased (-0.958912 --> -0.965180).  Saving model ...
Epoch: 8 cost time: 6.241779804229736
Epoch: 8, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.104 Vali Acc: 0.969 Test Loss: 0.104 Test Acc: 0.969
Validation loss decreased (-0.965180 --> -0.968662).  Saving model ...
Epoch: 9 cost time: 7.045572280883789
Epoch: 9, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.109 Vali Acc: 0.964 Test Loss: 0.109 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.4937567710876465
Epoch: 10, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.944839954376221
Epoch: 11, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.118 Vali Acc: 0.960 Test Loss: 0.118 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.555415391921997
Epoch: 12, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.968662 --> -0.972840).  Saving model ...
Epoch: 13 cost time: 6.649364709854126
Epoch: 13, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.088 Vali Acc: 0.974 Test Loss: 0.088 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.973537).  Saving model ...
Epoch: 14 cost time: 7.335212469100952
Epoch: 14, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.973537 --> -0.977019).  Saving model ...
Epoch: 15 cost time: 6.632736682891846
Epoch: 15, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.116503715515137
Epoch: 16, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.127 Vali Acc: 0.967 Test Loss: 0.127 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.268251657485962
Epoch: 17, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
Validation loss decreased (-0.977019 --> -0.980501).  Saving model ...
Epoch: 18 cost time: 6.208727836608887
Epoch: 18, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.911768436431885
Epoch: 19, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.122 Vali Acc: 0.967 Test Loss: 0.122 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.050537586212158
Epoch: 20, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.285 Vali Acc: 0.923 Test Loss: 0.285 Test Acc: 0.923
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 7.266939878463745
Epoch: 21, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.351273059844971
Epoch: 22, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.133 Vali Acc: 0.971 Test Loss: 0.133 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.74477744102478
Epoch: 23, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.721280336380005
Epoch: 24, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 6.996202230453491
Epoch: 25, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 7.07219934463501
Epoch: 26, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 7.377542734146118
Epoch: 27, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 545272
model size : 3.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 11.013696432113647
Epoch: 1, Steps: 89 | Train Loss: 2.633 Vali Loss: 1.639 Vali Acc: 0.640 Test Loss: 1.639 Test Acc: 0.640
Validation loss decreased (inf --> -0.639956).  Saving model ...
Epoch: 2 cost time: 7.021271705627441
Epoch: 2, Steps: 89 | Train Loss: 0.918 Vali Loss: 0.536 Vali Acc: 0.852 Test Loss: 0.536 Test Acc: 0.852
Validation loss decreased (-0.639956 --> -0.851666).  Saving model ...
Epoch: 3 cost time: 6.752752065658569
Epoch: 3, Steps: 89 | Train Loss: 0.413 Vali Loss: 0.304 Vali Acc: 0.921 Test Loss: 0.304 Test Acc: 0.921
Validation loss decreased (-0.851666 --> -0.921306).  Saving model ...
Epoch: 4 cost time: 6.949968338012695
Epoch: 4, Steps: 89 | Train Loss: 0.258 Vali Loss: 0.236 Vali Acc: 0.936 Test Loss: 0.236 Test Acc: 0.936
Validation loss decreased (-0.921306 --> -0.935931).  Saving model ...
Epoch: 5 cost time: 7.629919767379761
Epoch: 5, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.142 Vali Acc: 0.964 Test Loss: 0.142 Test Acc: 0.964
Validation loss decreased (-0.935931 --> -0.963787).  Saving model ...
Epoch: 6 cost time: 8.540705919265747
Epoch: 6, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.176 Vali Acc: 0.943 Test Loss: 0.176 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.016973972320557
Epoch: 7, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.140 Vali Acc: 0.958 Test Loss: 0.140 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.476144313812256
Epoch: 8, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.099 Vali Acc: 0.971 Test Loss: 0.099 Test Acc: 0.971
Validation loss decreased (-0.963787 --> -0.970751).  Saving model ...
Epoch: 9 cost time: 7.661093235015869
Epoch: 9, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
Validation loss decreased (-0.970751 --> -0.971447).  Saving model ...
Epoch: 10 cost time: 7.142136335372925
Epoch: 10, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
Validation loss decreased (-0.971447 --> -0.977715).  Saving model ...
Epoch: 11 cost time: 7.375102758407593
Epoch: 11, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.51507306098938
Epoch: 12, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.154 Vali Acc: 0.956 Test Loss: 0.154 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.904118299484253
Epoch: 13, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.978411).  Saving model ...
Epoch: 14 cost time: 7.043883323669434
Epoch: 14, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.106 Vali Acc: 0.972 Test Loss: 0.106 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.156947612762451
Epoch: 15, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.841409683227539
Epoch: 16, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.313504457473755
Epoch: 17, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 7.620458602905273
Epoch: 18, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 7.967604875564575
Epoch: 19, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 7.178584575653076
Epoch: 20, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 7.910088777542114
Epoch: 21, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 7.7365217208862305
Epoch: 22, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.106 Vali Acc: 0.969 Test Loss: 0.106 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 8.20771598815918
Epoch: 23, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 543736
model size : 3.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.538471460342407
Epoch: 1, Steps: 89 | Train Loss: 2.541 Vali Loss: 1.592 Vali Acc: 0.620 Test Loss: 1.592 Test Acc: 0.620
Validation loss decreased (inf --> -0.620458).  Saving model ...
Epoch: 2 cost time: 6.093804359436035
Epoch: 2, Steps: 89 | Train Loss: 0.873 Vali Loss: 0.494 Vali Acc: 0.875 Test Loss: 0.494 Test Acc: 0.875
Validation loss decreased (-0.620458 --> -0.875343).  Saving model ...
Epoch: 3 cost time: 6.238118648529053
Epoch: 3, Steps: 89 | Train Loss: 0.392 Vali Loss: 0.295 Vali Acc: 0.919 Test Loss: 0.295 Test Acc: 0.919
Validation loss decreased (-0.875343 --> -0.919217).  Saving model ...
Epoch: 4 cost time: 6.094329833984375
Epoch: 4, Steps: 89 | Train Loss: 0.294 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.866703748703003
Epoch: 5, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
Validation loss decreased (-0.919217 --> -0.958216).  Saving model ...
Epoch: 6 cost time: 6.04566764831543
Epoch: 6, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.150 Vali Acc: 0.956 Test Loss: 0.150 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.587750196456909
Epoch: 7, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.144 Vali Acc: 0.958 Test Loss: 0.144 Test Acc: 0.958
Validation loss decreased (-0.958216 --> -0.958216).  Saving model ...
Epoch: 8 cost time: 6.805078029632568
Epoch: 8, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.147 Vali Acc: 0.950 Test Loss: 0.147 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.773839473724365
Epoch: 9, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.162138938903809
Epoch: 10, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
Validation loss decreased (-0.958216 --> -0.967966).  Saving model ...
Epoch: 11 cost time: 7.13028359413147
Epoch: 11, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
Validation loss decreased (-0.967966 --> -0.970055).  Saving model ...
Epoch: 12 cost time: 6.7746968269348145
Epoch: 12, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.086 Vali Acc: 0.975 Test Loss: 0.086 Test Acc: 0.975
Validation loss decreased (-0.970055 --> -0.974930).  Saving model ...
Epoch: 13 cost time: 6.642308235168457
Epoch: 13, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
Validation loss decreased (-0.974930 --> -0.975626).  Saving model ...
Epoch: 14 cost time: 7.49290919303894
Epoch: 14, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.537713289260864
Epoch: 15, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.626519203186035
Epoch: 16, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.730908393859863
Epoch: 17, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
Validation loss decreased (-0.975626 --> -0.978411).  Saving model ...
Epoch: 18 cost time: 5.549540996551514
Epoch: 18, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
Validation loss decreased (-0.978411 --> -0.979108).  Saving model ...
Epoch: 19 cost time: 6.194500684738159
Epoch: 19, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.080 Vali Acc: 0.974 Test Loss: 0.080 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.303696632385254
Epoch: 20, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.147 Vali Acc: 0.956 Test Loss: 0.147 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.54828953742981
Epoch: 21, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.206564426422119
Epoch: 22, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 7.194775581359863
Epoch: 23, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.085 Vali Acc: 0.974 Test Loss: 0.085 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 7.19241738319397
Epoch: 24, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 6.741707801818848
Epoch: 25, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.068 Vali Acc: 0.985 Test Loss: 0.068 Test Acc: 0.985
Validation loss decreased (-0.979108 --> -0.984679).  Saving model ...
Epoch: 26 cost time: 6.762932062149048
Epoch: 26, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.178 Vali Acc: 0.965 Test Loss: 0.178 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 6.859798431396484
Epoch: 27, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 6.737355947494507
Epoch: 28, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 6.80966329574585
Epoch: 29, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.117 Vali Acc: 0.971 Test Loss: 0.117 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 7.144125699996948
Epoch: 30, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.116 Vali Acc: 0.971 Test Loss: 0.116 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 6.508800983428955
Epoch: 31, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 7.075172424316406
Epoch: 32, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 7.256982803344727
Epoch: 33, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.100 Vali Acc: 0.979 Test Loss: 0.100 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 6.75843620300293
Epoch: 34, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 7.657063245773315
Epoch: 35, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.134 Vali Acc: 0.969 Test Loss: 0.134 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 542200
model size : 3.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.174345016479492
Epoch: 1, Steps: 89 | Train Loss: 2.628 Vali Loss: 1.669 Vali Acc: 0.630 Test Loss: 1.669 Test Acc: 0.630
Validation loss decreased (inf --> -0.629510).  Saving model ...
Epoch: 2 cost time: 6.559495210647583
Epoch: 2, Steps: 89 | Train Loss: 0.937 Vali Loss: 0.548 Vali Acc: 0.856 Test Loss: 0.548 Test Acc: 0.856
Validation loss decreased (-0.629510 --> -0.855844).  Saving model ...
Epoch: 3 cost time: 7.93895697593689
Epoch: 3, Steps: 89 | Train Loss: 0.427 Vali Loss: 0.327 Vali Acc: 0.909 Test Loss: 0.327 Test Acc: 0.909
Validation loss decreased (-0.855844 --> -0.909467).  Saving model ...
Epoch: 4 cost time: 8.133156299591064
Epoch: 4, Steps: 89 | Train Loss: 0.258 Vali Loss: 0.275 Vali Acc: 0.915 Test Loss: 0.275 Test Acc: 0.915
Validation loss decreased (-0.909467 --> -0.915039).  Saving model ...
Epoch: 5 cost time: 7.761250257492065
Epoch: 5, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
Validation loss decreased (-0.915039 --> -0.949163).  Saving model ...
Epoch: 6 cost time: 8.247371673583984
Epoch: 6, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.126 Vali Acc: 0.964 Test Loss: 0.126 Test Acc: 0.964
Validation loss decreased (-0.949163 --> -0.964483).  Saving model ...
Epoch: 7 cost time: 7.680984258651733
Epoch: 7, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.139 Vali Acc: 0.951 Test Loss: 0.139 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.173654079437256
Epoch: 8, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
Validation loss decreased (-0.964483 --> -0.970055).  Saving model ...
Epoch: 9 cost time: 7.262075424194336
Epoch: 9, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.103 Vali Acc: 0.969 Test Loss: 0.103 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.313992738723755
Epoch: 10, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.115 Vali Acc: 0.967 Test Loss: 0.115 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.37520170211792
Epoch: 11, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 8.28747296333313
Epoch: 12, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
Validation loss decreased (-0.970055 --> -0.973537).  Saving model ...
Epoch: 13 cost time: 7.650046110153198
Epoch: 13, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.973537 --> -0.977019).  Saving model ...
Epoch: 14 cost time: 8.651344060897827
Epoch: 14, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.069 Vali Acc: 0.978 Test Loss: 0.069 Test Acc: 0.978
Validation loss decreased (-0.977019 --> -0.977715).  Saving model ...
Epoch: 15 cost time: 7.2092626094818115
Epoch: 15, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.8037192821502686
Epoch: 16, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
Validation loss decreased (-0.977715 --> -0.980501).  Saving model ...
Epoch: 17 cost time: 7.8295814990997314
Epoch: 17, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.104 Vali Acc: 0.969 Test Loss: 0.104 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.775360822677612
Epoch: 18, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 7.705299139022827
Epoch: 19, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.153 Vali Acc: 0.964 Test Loss: 0.153 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 7.354534387588501
Epoch: 20, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.105 Vali Acc: 0.971 Test Loss: 0.105 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 7.450702428817749
Epoch: 21, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 7.7171478271484375
Epoch: 22, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 8.1894052028656
Epoch: 23, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.110 Vali Acc: 0.971 Test Loss: 0.110 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 7.427390813827515
Epoch: 24, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.055 Vali Acc: 0.983 Test Loss: 0.055 Test Acc: 0.983
Validation loss decreased (-0.980501 --> -0.982590).  Saving model ...
Epoch: 25 cost time: 8.676955699920654
Epoch: 25, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.758761644363403
Epoch: 26, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 7.854065656661987
Epoch: 27, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 8.361465215682983
Epoch: 28, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.083 Vali Acc: 0.979 Test Loss: 0.083 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 8.518410921096802
Epoch: 29, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 6.322489500045776
Epoch: 30, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 8.080201625823975
Epoch: 31, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.155 Vali Acc: 0.960 Test Loss: 0.155 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 7.405444145202637
Epoch: 32, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.982590 --> -0.983286).  Saving model ...
Epoch: 33 cost time: 7.8083178997039795
Epoch: 33, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.136 Vali Acc: 0.960 Test Loss: 0.136 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 7.465046644210815
Epoch: 34, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 7.135010004043579
Epoch: 35, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 7.479330778121948
Epoch: 36, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 6.710225820541382
Epoch: 37, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 7.578617811203003
Epoch: 38, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 7.421537637710571
Epoch: 39, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 6.879140138626099
Epoch: 40, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.175 Vali Acc: 0.962 Test Loss: 0.175 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 7.7816362380981445
Epoch: 41, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.163 Vali Acc: 0.968 Test Loss: 0.163 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 6.766317129135132
Epoch: 42, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 540664
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.051778316497803
Epoch: 1, Steps: 89 | Train Loss: 2.640 Vali Loss: 1.770 Vali Acc: 0.514 Test Loss: 1.770 Test Acc: 0.514
Validation loss decreased (inf --> -0.513910).  Saving model ...
Epoch: 2 cost time: 7.587441682815552
Epoch: 2, Steps: 89 | Train Loss: 0.999 Vali Loss: 0.559 Vali Acc: 0.857 Test Loss: 0.559 Test Acc: 0.857
Validation loss decreased (-0.513910 --> -0.856540).  Saving model ...
Epoch: 3 cost time: 7.728900194168091
Epoch: 3, Steps: 89 | Train Loss: 0.420 Vali Loss: 0.357 Vali Acc: 0.910 Test Loss: 0.357 Test Acc: 0.910
Validation loss decreased (-0.856540 --> -0.910164).  Saving model ...
Epoch: 4 cost time: 8.852204322814941
Epoch: 4, Steps: 89 | Train Loss: 0.261 Vali Loss: 0.228 Vali Acc: 0.946 Test Loss: 0.228 Test Acc: 0.946
Validation loss decreased (-0.910164 --> -0.945680).  Saving model ...
Epoch: 5 cost time: 7.896297454833984
Epoch: 5, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
Validation loss decreased (-0.945680 --> -0.956823).  Saving model ...
Epoch: 6 cost time: 7.702875137329102
Epoch: 6, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.140 Vali Acc: 0.960 Test Loss: 0.140 Test Acc: 0.960
Validation loss decreased (-0.956823 --> -0.959609).  Saving model ...
Epoch: 7 cost time: 8.485068798065186
Epoch: 7, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.127 Vali Acc: 0.961 Test Loss: 0.127 Test Acc: 0.961
Validation loss decreased (-0.959609 --> -0.961002).  Saving model ...
Epoch: 8 cost time: 8.62246561050415
Epoch: 8, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
Validation loss decreased (-0.961002 --> -0.969358).  Saving model ...
Epoch: 9 cost time: 7.291885614395142
Epoch: 9, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.097 Vali Acc: 0.972 Test Loss: 0.097 Test Acc: 0.972
Validation loss decreased (-0.969358 --> -0.972144).  Saving model ...
Epoch: 10 cost time: 8.916146993637085
Epoch: 10, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.114 Vali Acc: 0.964 Test Loss: 0.114 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.939575910568237
Epoch: 11, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.972144 --> -0.972840).  Saving model ...
Epoch: 12 cost time: 8.081489086151123
Epoch: 12, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.069 Vali Acc: 0.978 Test Loss: 0.069 Test Acc: 0.978
Validation loss decreased (-0.972840 --> -0.978412).  Saving model ...
Epoch: 13 cost time: 8.502822637557983
Epoch: 13, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.080 Vali Acc: 0.979 Test Loss: 0.080 Test Acc: 0.979
Validation loss decreased (-0.978412 --> -0.979108).  Saving model ...
Epoch: 14 cost time: 7.444600582122803
Epoch: 14, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.129 Vali Acc: 0.956 Test Loss: 0.129 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.16466212272644
Epoch: 15, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.363786697387695
Epoch: 16, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.109 Vali Acc: 0.966 Test Loss: 0.109 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.613109350204468
Epoch: 17, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.136 Vali Acc: 0.955 Test Loss: 0.136 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 8.405051946640015
Epoch: 18, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 7.531548738479614
Epoch: 19, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.087 Vali Acc: 0.972 Test Loss: 0.087 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 9.061556816101074
Epoch: 20, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 8.194006443023682
Epoch: 21, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.199 Vali Acc: 0.959 Test Loss: 0.199 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 7.509972810745239
Epoch: 22, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.069 Vali Acc: 0.985 Test Loss: 0.069 Test Acc: 0.985
Validation loss decreased (-0.979108 --> -0.985375).  Saving model ...
Epoch: 23 cost time: 8.51671051979065
Epoch: 23, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 7.720956087112427
Epoch: 24, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 7.410989999771118
Epoch: 25, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 8.194798231124878
Epoch: 26, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 7.072122812271118
Epoch: 27, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.093 Vali Acc: 0.979 Test Loss: 0.093 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 8.127146482467651
Epoch: 28, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.071 Vali Acc: 0.987 Test Loss: 0.071 Test Acc: 0.987
Validation loss decreased (-0.985375 --> -0.987464).  Saving model ...
Epoch: 29 cost time: 7.539819955825806
Epoch: 29, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 8.428254127502441
Epoch: 30, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 8.383260726928711
Epoch: 31, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 7.527226209640503
Epoch: 32, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.125 Vali Acc: 0.974 Test Loss: 0.125 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 9.1292245388031
Epoch: 33, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 7.365350961685181
Epoch: 34, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.154 Vali Acc: 0.969 Test Loss: 0.154 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 8.55864691734314
Epoch: 35, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.124 Vali Acc: 0.971 Test Loss: 0.124 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 8.063472032546997
Epoch: 36, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.122 Vali Acc: 0.976 Test Loss: 0.122 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 7.630271673202515
Epoch: 37, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.096 Vali Acc: 0.981 Test Loss: 0.096 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 8.548698425292969
Epoch: 38, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 462712
model size : 3.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.716783046722412
Epoch: 1, Steps: 89 | Train Loss: 2.710 Vali Loss: 1.859 Vali Acc: 0.711 Test Loss: 1.859 Test Acc: 0.711
Validation loss decreased (inf --> -0.710984).  Saving model ...
Epoch: 2 cost time: 7.943047523498535
Epoch: 2, Steps: 89 | Train Loss: 1.054 Vali Loss: 0.602 Vali Acc: 0.820 Test Loss: 0.602 Test Acc: 0.820
Validation loss decreased (-0.710984 --> -0.820328).  Saving model ...
Epoch: 3 cost time: 6.743499040603638
Epoch: 3, Steps: 89 | Train Loss: 0.448 Vali Loss: 0.337 Vali Acc: 0.907 Test Loss: 0.337 Test Acc: 0.907
Validation loss decreased (-0.820328 --> -0.907378).  Saving model ...
Epoch: 4 cost time: 7.263104677200317
Epoch: 4, Steps: 89 | Train Loss: 0.261 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
Validation loss decreased (-0.907378 --> -0.940806).  Saving model ...
Epoch: 5 cost time: 7.002063274383545
Epoch: 5, Steps: 89 | Train Loss: 0.192 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
Validation loss decreased (-0.940806 --> -0.954037).  Saving model ...
Epoch: 6 cost time: 6.089604139328003
Epoch: 6, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.146 Vali Acc: 0.964 Test Loss: 0.146 Test Acc: 0.964
Validation loss decreased (-0.954037 --> -0.963787).  Saving model ...
Epoch: 7 cost time: 6.904669523239136
Epoch: 7, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.196254730224609
Epoch: 8, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.096 Vali Acc: 0.971 Test Loss: 0.096 Test Acc: 0.971
Validation loss decreased (-0.963787 --> -0.970751).  Saving model ...
Epoch: 9 cost time: 6.508800029754639
Epoch: 9, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.970751 --> -0.977019).  Saving model ...
Epoch: 10 cost time: 6.382966995239258
Epoch: 10, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.133 Vali Acc: 0.961 Test Loss: 0.133 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.9338438510894775
Epoch: 11, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.113 Vali Acc: 0.964 Test Loss: 0.113 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.547961950302124
Epoch: 12, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
Validation loss decreased (-0.977019 --> -0.980501).  Saving model ...
Epoch: 13 cost time: 6.091954946517944
Epoch: 13, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.325270652770996
Epoch: 14, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.090 Vali Acc: 0.969 Test Loss: 0.090 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.600792169570923
Epoch: 15, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 7.393896102905273
Epoch: 16, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.032197952270508
Epoch: 17, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.138 Vali Acc: 0.963 Test Loss: 0.138 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 7.102377414703369
Epoch: 18, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.098 Vali Acc: 0.972 Test Loss: 0.098 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 7.136662006378174
Epoch: 19, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.089 Vali Acc: 0.971 Test Loss: 0.089 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 7.023188591003418
Epoch: 20, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.063 Vali Acc: 0.984 Test Loss: 0.063 Test Acc: 0.984
Validation loss decreased (-0.980501 --> -0.983983).  Saving model ...
Epoch: 21 cost time: 7.131978511810303
Epoch: 21, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.088 Vali Acc: 0.975 Test Loss: 0.088 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 7.737695693969727
Epoch: 22, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 7.605056524276733
Epoch: 23, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.898916482925415
Epoch: 24, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 7.61711859703064
Epoch: 25, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 7.458005666732788
Epoch: 26, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 7.474971055984497
Epoch: 27, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.175 Vali Acc: 0.955 Test Loss: 0.175 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 6.239980459213257
Epoch: 28, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.126 Vali Acc: 0.964 Test Loss: 0.126 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 7.423285722732544
Epoch: 29, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 6.580853462219238
Epoch: 30, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 461176
model size : 3.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.877943754196167
Epoch: 1, Steps: 89 | Train Loss: 2.637 Vali Loss: 1.685 Vali Acc: 0.728 Test Loss: 1.685 Test Acc: 0.728
Validation loss decreased (inf --> -0.728395).  Saving model ...
Epoch: 2 cost time: 6.850512266159058
Epoch: 2, Steps: 89 | Train Loss: 0.954 Vali Loss: 0.576 Vali Acc: 0.859 Test Loss: 0.576 Test Acc: 0.859
Validation loss decreased (-0.728395 --> -0.859326).  Saving model ...
Epoch: 3 cost time: 7.002760887145996
Epoch: 3, Steps: 89 | Train Loss: 0.438 Vali Loss: 0.349 Vali Acc: 0.909 Test Loss: 0.349 Test Acc: 0.909
Validation loss decreased (-0.859326 --> -0.908771).  Saving model ...
Epoch: 4 cost time: 7.4919984340667725
Epoch: 4, Steps: 89 | Train Loss: 0.285 Vali Loss: 0.293 Vali Acc: 0.910 Test Loss: 0.293 Test Acc: 0.910
Validation loss decreased (-0.908771 --> -0.910164).  Saving model ...
Epoch: 5 cost time: 7.625654220581055
Epoch: 5, Steps: 89 | Train Loss: 0.211 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.910164 --> -0.958215).  Saving model ...
Epoch: 6 cost time: 6.465105772018433
Epoch: 6, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.134 Vali Acc: 0.961 Test Loss: 0.134 Test Acc: 0.961
Validation loss decreased (-0.958215 --> -0.961001).  Saving model ...
Epoch: 7 cost time: 6.5096659660339355
Epoch: 7, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.137 Vali Acc: 0.956 Test Loss: 0.137 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.377241134643555
Epoch: 8, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.104 Vali Acc: 0.967 Test Loss: 0.104 Test Acc: 0.967
Validation loss decreased (-0.961001 --> -0.966573).  Saving model ...
Epoch: 9 cost time: 7.066293001174927
Epoch: 9, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.132 Vali Acc: 0.958 Test Loss: 0.132 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.846914291381836
Epoch: 10, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
Validation loss decreased (-0.966573 --> -0.973537).  Saving model ...
Epoch: 11 cost time: 7.431354522705078
Epoch: 11, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.506781101226807
Epoch: 12, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.050956964492798
Epoch: 13, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.084 Vali Acc: 0.974 Test Loss: 0.084 Test Acc: 0.974
Validation loss decreased (-0.973537 --> -0.974233).  Saving model ...
Epoch: 14 cost time: 7.729038238525391
Epoch: 14, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.161 Vali Acc: 0.955 Test Loss: 0.161 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.227794170379639
Epoch: 15, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.603853702545166
Epoch: 16, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.095 Vali Acc: 0.971 Test Loss: 0.095 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.372109651565552
Epoch: 17, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.974233 --> -0.979804).  Saving model ...
Epoch: 18 cost time: 7.310526609420776
Epoch: 18, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 7.9898505210876465
Epoch: 19, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980501).  Saving model ...
Epoch: 20 cost time: 7.062352895736694
Epoch: 20, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.090 Vali Acc: 0.974 Test Loss: 0.090 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 7.509543180465698
Epoch: 21, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.961375951766968
Epoch: 22, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 7.7722368240356445
Epoch: 23, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 7.649559497833252
Epoch: 24, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.135 Vali Acc: 0.963 Test Loss: 0.135 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 7.515163421630859
Epoch: 25, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.071 Vali Acc: 0.982 Test Loss: 0.071 Test Acc: 0.982
Validation loss decreased (-0.980501 --> -0.981893).  Saving model ...
Epoch: 26 cost time: 8.02573847770691
Epoch: 26, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.074 Vali Acc: 0.984 Test Loss: 0.074 Test Acc: 0.984
Validation loss decreased (-0.981893 --> -0.983983).  Saving model ...
Epoch: 27 cost time: 7.109685897827148
Epoch: 27, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.102 Vali Acc: 0.972 Test Loss: 0.102 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 8.347068548202515
Epoch: 28, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 8.35364317893982
Epoch: 29, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.071 Vali Acc: 0.985 Test Loss: 0.071 Test Acc: 0.985
Validation loss decreased (-0.983983 --> -0.984679).  Saving model ...
Epoch: 30 cost time: 6.8405725955963135
Epoch: 30, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 7.825493812561035
Epoch: 31, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.133 Vali Acc: 0.964 Test Loss: 0.133 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 7.982986211776733
Epoch: 32, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 7.770348787307739
Epoch: 33, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 7.469954967498779
Epoch: 34, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.130 Vali Acc: 0.976 Test Loss: 0.130 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 7.9949259757995605
Epoch: 35, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 7.3645524978637695
Epoch: 36, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.100 Vali Acc: 0.981 Test Loss: 0.100 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 7.693708419799805
Epoch: 37, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 7.262553930282593
Epoch: 38, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.076 Vali Acc: 0.986 Test Loss: 0.076 Test Acc: 0.986
Validation loss decreased (-0.984679 --> -0.986072).  Saving model ...
Epoch: 39 cost time: 7.1155054569244385
Epoch: 39, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.126 Vali Acc: 0.978 Test Loss: 0.126 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 7.673732280731201
Epoch: 40, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.182 Vali Acc: 0.959 Test Loss: 0.182 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 6.771381378173828
Epoch: 41, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.173 Vali Acc: 0.962 Test Loss: 0.173 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 6.7348291873931885
Epoch: 42, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.173 Vali Acc: 0.962 Test Loss: 0.173 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 7.06632137298584
Epoch: 43, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.255 Vali Acc: 0.951 Test Loss: 0.255 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 7.466739177703857
Epoch: 44, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 6.419531345367432
Epoch: 45, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.102 Vali Acc: 0.981 Test Loss: 0.102 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 6.49411940574646
Epoch: 46, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 7.163926839828491
Epoch: 47, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.121 Vali Acc: 0.978 Test Loss: 0.121 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 8.0414719581604
Epoch: 48, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.136 Vali Acc: 0.972 Test Loss: 0.136 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 459640
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.96590542793274
Epoch: 1, Steps: 89 | Train Loss: 2.657 Vali Loss: 1.800 Vali Acc: 0.683 Test Loss: 1.800 Test Acc: 0.683
Validation loss decreased (inf --> -0.683130).  Saving model ...
Epoch: 2 cost time: 7.677504062652588
Epoch: 2, Steps: 89 | Train Loss: 1.025 Vali Loss: 0.575 Vali Acc: 0.853 Test Loss: 0.575 Test Acc: 0.853
Validation loss decreased (-0.683130 --> -0.853058).  Saving model ...
Epoch: 3 cost time: 6.87079381942749
Epoch: 3, Steps: 89 | Train Loss: 0.434 Vali Loss: 0.346 Vali Acc: 0.907 Test Loss: 0.346 Test Acc: 0.907
Validation loss decreased (-0.853058 --> -0.907378).  Saving model ...
Epoch: 4 cost time: 7.026821613311768
Epoch: 4, Steps: 89 | Train Loss: 0.269 Vali Loss: 0.219 Vali Acc: 0.938 Test Loss: 0.219 Test Acc: 0.938
Validation loss decreased (-0.907378 --> -0.938020).  Saving model ...
Epoch: 5 cost time: 7.140557050704956
Epoch: 5, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.184 Vali Acc: 0.947 Test Loss: 0.184 Test Acc: 0.947
Validation loss decreased (-0.938020 --> -0.947073).  Saving model ...
Epoch: 6 cost time: 6.873542547225952
Epoch: 6, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.137 Vali Acc: 0.959 Test Loss: 0.137 Test Acc: 0.959
Validation loss decreased (-0.947073 --> -0.958912).  Saving model ...
Epoch: 7 cost time: 6.169378757476807
Epoch: 7, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.117 Vali Acc: 0.966 Test Loss: 0.117 Test Acc: 0.966
Validation loss decreased (-0.958912 --> -0.965876).  Saving model ...
Epoch: 8 cost time: 7.014761209487915
Epoch: 8, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
Validation loss decreased (-0.965876 --> -0.970055).  Saving model ...
Epoch: 9 cost time: 7.154164791107178
Epoch: 9, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
Validation loss decreased (-0.970055 --> -0.974929).  Saving model ...
Epoch: 10 cost time: 7.116776943206787
Epoch: 10, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.228 Vali Acc: 0.926 Test Loss: 0.228 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.050122022628784
Epoch: 11, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.696449279785156
Epoch: 12, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975626).  Saving model ...
Epoch: 13 cost time: 7.424821615219116
Epoch: 13, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.929736852645874
Epoch: 14, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.283458709716797
Epoch: 15, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.146 Vali Acc: 0.960 Test Loss: 0.146 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.6104576587677
Epoch: 16, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.080 Vali Acc: 0.974 Test Loss: 0.080 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.727525949478149
Epoch: 17, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.110 Vali Acc: 0.971 Test Loss: 0.110 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 7.064960241317749
Epoch: 18, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.065 Vali Acc: 0.981 Test Loss: 0.065 Test Acc: 0.981
Validation loss decreased (-0.975626 --> -0.980501).  Saving model ...
Epoch: 19 cost time: 7.001631498336792
Epoch: 19, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.073 Vali Acc: 0.975 Test Loss: 0.073 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.697684049606323
Epoch: 20, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.117 Vali Acc: 0.972 Test Loss: 0.117 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 7.141818284988403
Epoch: 21, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.112 Vali Acc: 0.972 Test Loss: 0.112 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.968826055526733
Epoch: 22, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.515857219696045
Epoch: 23, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
Validation loss decreased (-0.980501 --> -0.981197).  Saving model ...
Epoch: 24 cost time: 7.900456190109253
Epoch: 24, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.6697070598602295
Epoch: 25, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.456770181655884
Epoch: 26, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.125 Vali Acc: 0.972 Test Loss: 0.125 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 6.726008653640747
Epoch: 27, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 8.240566492080688
Epoch: 28, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.132 Vali Acc: 0.969 Test Loss: 0.132 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 8.19538688659668
Epoch: 29, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 6.979887247085571
Epoch: 30, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 7.700001955032349
Epoch: 31, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 6.579345703125
Epoch: 32, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 7.2725913524627686
Epoch: 33, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.140 Vali Acc: 0.971 Test Loss: 0.140 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 458104
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.036068201065063
Epoch: 1, Steps: 89 | Train Loss: 2.751 Vali Loss: 1.979 Vali Acc: 0.586 Test Loss: 1.979 Test Acc: 0.586
Validation loss decreased (inf --> -0.586331).  Saving model ...
Epoch: 2 cost time: 7.26893162727356
Epoch: 2, Steps: 89 | Train Loss: 1.305 Vali Loss: 0.820 Vali Acc: 0.818 Test Loss: 0.820 Test Acc: 0.818
Validation loss decreased (-0.586331 --> -0.818237).  Saving model ...
Epoch: 3 cost time: 6.8936448097229
Epoch: 3, Steps: 89 | Train Loss: 0.612 Vali Loss: 0.475 Vali Acc: 0.877 Test Loss: 0.475 Test Acc: 0.877
Validation loss decreased (-0.818237 --> -0.877433).  Saving model ...
Epoch: 4 cost time: 7.226781368255615
Epoch: 4, Steps: 89 | Train Loss: 0.395 Vali Loss: 0.340 Vali Acc: 0.923 Test Loss: 0.340 Test Acc: 0.923
Validation loss decreased (-0.877433 --> -0.922699).  Saving model ...
Epoch: 5 cost time: 7.040385961532593
Epoch: 5, Steps: 89 | Train Loss: 0.270 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
Validation loss decreased (-0.922699 --> -0.943591).  Saving model ...
Epoch: 6 cost time: 6.9049999713897705
Epoch: 6, Steps: 89 | Train Loss: 0.202 Vali Loss: 0.243 Vali Acc: 0.926 Test Loss: 0.243 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.817152738571167
Epoch: 7, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.943591 --> -0.943591).  Saving model ...
Epoch: 8 cost time: 7.833670139312744
Epoch: 8, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.178 Vali Acc: 0.951 Test Loss: 0.178 Test Acc: 0.951
Validation loss decreased (-0.943591 --> -0.950555).  Saving model ...
Epoch: 9 cost time: 6.876266956329346
Epoch: 9, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.182 Vali Acc: 0.945 Test Loss: 0.182 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.848481178283691
Epoch: 10, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.146 Vali Acc: 0.953 Test Loss: 0.146 Test Acc: 0.953
Validation loss decreased (-0.950555 --> -0.953341).  Saving model ...
Epoch: 11 cost time: 7.302782297134399
Epoch: 11, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.108 Vali Acc: 0.969 Test Loss: 0.108 Test Acc: 0.969
Validation loss decreased (-0.953341 --> -0.968662).  Saving model ...
Epoch: 12 cost time: 7.532010078430176
Epoch: 12, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.142 Vali Acc: 0.952 Test Loss: 0.142 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.36931586265564
Epoch: 13, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
Validation loss decreased (-0.968662 --> -0.974233).  Saving model ...
Epoch: 14 cost time: 7.560147047042847
Epoch: 14, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.104 Vali Acc: 0.969 Test Loss: 0.104 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.4123454093933105
Epoch: 15, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.108 Vali Acc: 0.969 Test Loss: 0.108 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.583041667938232
Epoch: 16, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.102 Vali Acc: 0.972 Test Loss: 0.102 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.822688579559326
Epoch: 17, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.141 Vali Acc: 0.955 Test Loss: 0.141 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 7.608182430267334
Epoch: 18, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.109 Vali Acc: 0.969 Test Loss: 0.109 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 7.5440356731414795
Epoch: 19, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
Validation loss decreased (-0.974233 --> -0.980501).  Saving model ...
Epoch: 20 cost time: 7.4043121337890625
Epoch: 20, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.091 Vali Acc: 0.971 Test Loss: 0.091 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.990851879119873
Epoch: 21, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.142 Vali Acc: 0.955 Test Loss: 0.142 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.729904651641846
Epoch: 22, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 7.0773303508758545
Epoch: 23, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.115 Vali Acc: 0.966 Test Loss: 0.115 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 7.644785165786743
Epoch: 24, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 6.068596601486206
Epoch: 25, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.090 Vali Acc: 0.971 Test Loss: 0.090 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 6.703376770019531
Epoch: 26, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 6.857277154922485
Epoch: 27, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 7.532463550567627
Epoch: 28, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.095 Vali Acc: 0.971 Test Loss: 0.095 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 6.923584461212158
Epoch: 29, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
Validation loss decreased (-0.980501 --> -0.980501).  Saving model ...
Epoch: 30 cost time: 6.639584064483643
Epoch: 30, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 7.458827495574951
Epoch: 31, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 6.693854570388794
Epoch: 32, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 6.4468934535980225
Epoch: 33, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 6.535691499710083
Epoch: 34, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 6.948415040969849
Epoch: 35, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.980501 --> -0.982590).  Saving model ...
Epoch: 36 cost time: 6.485387802124023
Epoch: 36, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 6.957064390182495
Epoch: 37, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.157 Vali Acc: 0.960 Test Loss: 0.157 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 7.569227933883667
Epoch: 38, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 6.914053201675415
Epoch: 39, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.106 Vali Acc: 0.969 Test Loss: 0.106 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 7.352059602737427
Epoch: 40, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 7.339115381240845
Epoch: 41, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 6.816289663314819
Epoch: 42, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 7.068320035934448
Epoch: 43, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 7.127263307571411
Epoch: 44, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 7.1272947788238525
Epoch: 45, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 440984
model size : 2.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.082230806350708
Epoch: 1, Steps: 89 | Train Loss: 2.907 Vali Loss: 2.362 Vali Acc: 0.320 Test Loss: 2.362 Test Acc: 0.320
Validation loss decreased (inf --> -0.319614).  Saving model ...
Epoch: 2 cost time: 6.714519500732422
Epoch: 2, Steps: 89 | Train Loss: 1.512 Vali Loss: 0.863 Vali Acc: 0.813 Test Loss: 0.863 Test Acc: 0.813
Validation loss decreased (-0.319614 --> -0.812665).  Saving model ...
Epoch: 3 cost time: 7.087433815002441
Epoch: 3, Steps: 89 | Train Loss: 0.659 Vali Loss: 0.507 Vali Acc: 0.868 Test Loss: 0.507 Test Acc: 0.868
Validation loss decreased (-0.812665 --> -0.868379).  Saving model ...
Epoch: 4 cost time: 7.101032733917236
Epoch: 4, Steps: 89 | Train Loss: 0.413 Vali Loss: 0.358 Vali Acc: 0.908 Test Loss: 0.358 Test Acc: 0.908
Validation loss decreased (-0.868379 --> -0.908074).  Saving model ...
Epoch: 5 cost time: 6.741802930831909
Epoch: 5, Steps: 89 | Train Loss: 0.301 Vali Loss: 0.257 Vali Acc: 0.937 Test Loss: 0.257 Test Acc: 0.937
Validation loss decreased (-0.908074 --> -0.937323).  Saving model ...
Epoch: 6 cost time: 6.480398416519165
Epoch: 6, Steps: 89 | Train Loss: 0.228 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.201982736587524
Epoch: 7, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.167 Vali Acc: 0.955 Test Loss: 0.167 Test Acc: 0.955
Validation loss decreased (-0.937323 --> -0.955430).  Saving model ...
Epoch: 8 cost time: 7.3458123207092285
Epoch: 8, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
Validation loss decreased (-0.955430 --> -0.957519).  Saving model ...
Epoch: 9 cost time: 7.1767189502716064
Epoch: 9, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.135 Vali Acc: 0.957 Test Loss: 0.135 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.5542683601379395
Epoch: 10, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.135 Vali Acc: 0.960 Test Loss: 0.135 Test Acc: 0.960
Validation loss decreased (-0.957519 --> -0.960305).  Saving model ...
Epoch: 11 cost time: 6.357571363449097
Epoch: 11, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
Validation loss decreased (-0.960305 --> -0.969358).  Saving model ...
Epoch: 12 cost time: 7.068645477294922
Epoch: 12, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.121 Vali Acc: 0.964 Test Loss: 0.121 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.884358644485474
Epoch: 13, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.859856843948364
Epoch: 14, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.111 Vali Acc: 0.967 Test Loss: 0.111 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.896380424499512
Epoch: 15, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
Validation loss decreased (-0.969358 --> -0.974233).  Saving model ...
Epoch: 16 cost time: 7.493242263793945
Epoch: 16, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
Validation loss decreased (-0.974233 --> -0.978412).  Saving model ...
Epoch: 17 cost time: 7.579064130783081
Epoch: 17, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 7.707487106323242
Epoch: 18, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.256821870803833
Epoch: 19, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.066 Vali Acc: 0.981 Test Loss: 0.066 Test Acc: 0.981
Validation loss decreased (-0.978412 --> -0.981197).  Saving model ...
Epoch: 20 cost time: 6.761831283569336
Epoch: 20, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.089 Vali Acc: 0.971 Test Loss: 0.089 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 7.059035062789917
Epoch: 21, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.115 Vali Acc: 0.967 Test Loss: 0.115 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.887576580047607
Epoch: 22, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 7.806176424026489
Epoch: 23, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 7.9087443351745605
Epoch: 24, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.079 Vali Acc: 0.971 Test Loss: 0.079 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 6.954853534698486
Epoch: 25, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.121 Vali Acc: 0.961 Test Loss: 0.121 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 7.072494745254517
Epoch: 26, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 7.3235743045806885
Epoch: 27, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.064 Vali Acc: 0.981 Test Loss: 0.064 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 6.663433790206909
Epoch: 28, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.099 Vali Acc: 0.971 Test Loss: 0.099 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 7.1367552280426025
Epoch: 29, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 440216
model size : 2.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.859625816345215
Epoch: 1, Steps: 89 | Train Loss: 2.710 Vali Loss: 1.926 Vali Acc: 0.506 Test Loss: 1.926 Test Acc: 0.506
Validation loss decreased (inf --> -0.505552).  Saving model ...
Epoch: 2 cost time: 7.572153329849243
Epoch: 2, Steps: 89 | Train Loss: 1.248 Vali Loss: 0.759 Vali Acc: 0.820 Test Loss: 0.759 Test Acc: 0.820
Validation loss decreased (-0.505552 --> -0.819630).  Saving model ...
Epoch: 3 cost time: 8.286550998687744
Epoch: 3, Steps: 89 | Train Loss: 0.578 Vali Loss: 0.475 Vali Acc: 0.881 Test Loss: 0.475 Test Acc: 0.881
Validation loss decreased (-0.819630 --> -0.880914).  Saving model ...
Epoch: 4 cost time: 8.136836290359497
Epoch: 4, Steps: 89 | Train Loss: 0.381 Vali Loss: 0.311 Vali Acc: 0.912 Test Loss: 0.311 Test Acc: 0.912
Validation loss decreased (-0.880914 --> -0.912253).  Saving model ...
Epoch: 5 cost time: 8.897469997406006
Epoch: 5, Steps: 89 | Train Loss: 0.275 Vali Loss: 0.237 Vali Acc: 0.930 Test Loss: 0.237 Test Acc: 0.930
Validation loss decreased (-0.912253 --> -0.929663).  Saving model ...
Epoch: 6 cost time: 8.595854759216309
Epoch: 6, Steps: 89 | Train Loss: 0.215 Vali Loss: 0.203 Vali Acc: 0.939 Test Loss: 0.203 Test Acc: 0.939
Validation loss decreased (-0.929663 --> -0.938717).  Saving model ...
Epoch: 7 cost time: 8.551518678665161
Epoch: 7, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
Validation loss decreased (-0.938717 --> -0.956823).  Saving model ...
Epoch: 8 cost time: 8.237426042556763
Epoch: 8, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.148 Vali Acc: 0.961 Test Loss: 0.148 Test Acc: 0.961
Validation loss decreased (-0.956823 --> -0.961001).  Saving model ...
Epoch: 9 cost time: 8.292800188064575
Epoch: 9, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.122 Vali Acc: 0.967 Test Loss: 0.122 Test Acc: 0.967
Validation loss decreased (-0.961001 --> -0.966573).  Saving model ...
Epoch: 10 cost time: 9.23697304725647
Epoch: 10, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.119 Vali Acc: 0.967 Test Loss: 0.119 Test Acc: 0.967
Validation loss decreased (-0.966573 --> -0.966573).  Saving model ...
Epoch: 11 cost time: 8.312751054763794
Epoch: 11, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.135 Vali Acc: 0.961 Test Loss: 0.135 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.852089166641235
Epoch: 12, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.966573 --> -0.972840).  Saving model ...
Epoch: 13 cost time: 7.810960292816162
Epoch: 13, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.151 Vali Acc: 0.948 Test Loss: 0.151 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.943535566329956
Epoch: 14, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.974233).  Saving model ...
Epoch: 15 cost time: 7.903938055038452
Epoch: 15, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.974233 --> -0.979804).  Saving model ...
Epoch: 16 cost time: 8.807525157928467
Epoch: 16, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.4526026248931885
Epoch: 17, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.086 Vali Acc: 0.974 Test Loss: 0.086 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.109750747680664
Epoch: 18, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 9.723054647445679
Epoch: 19, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 8.27458119392395
Epoch: 20, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.126 Vali Acc: 0.960 Test Loss: 0.126 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 7.041853904724121
Epoch: 21, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 8.118168830871582
Epoch: 22, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.104 Vali Acc: 0.967 Test Loss: 0.104 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 7.543264389038086
Epoch: 23, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 7.785083532333374
Epoch: 24, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 8.107086181640625
Epoch: 25, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.071 Vali Acc: 0.975 Test Loss: 0.071 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 439448
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.34739089012146
Epoch: 1, Steps: 89 | Train Loss: 2.725 Vali Loss: 2.021 Vali Acc: 0.566 Test Loss: 2.021 Test Acc: 0.566
Validation loss decreased (inf --> -0.566136).  Saving model ...
Epoch: 2 cost time: 7.386187791824341
Epoch: 2, Steps: 89 | Train Loss: 1.340 Vali Loss: 0.836 Vali Acc: 0.802 Test Loss: 0.836 Test Acc: 0.802
Validation loss decreased (-0.566136 --> -0.802220).  Saving model ...
Epoch: 3 cost time: 7.723787069320679
Epoch: 3, Steps: 89 | Train Loss: 0.643 Vali Loss: 0.492 Vali Acc: 0.877 Test Loss: 0.492 Test Acc: 0.877
Validation loss decreased (-0.802220 --> -0.876736).  Saving model ...
Epoch: 4 cost time: 8.919259548187256
Epoch: 4, Steps: 89 | Train Loss: 0.407 Vali Loss: 0.340 Vali Acc: 0.906 Test Loss: 0.340 Test Acc: 0.906
Validation loss decreased (-0.876736 --> -0.905985).  Saving model ...
Epoch: 5 cost time: 8.19885540008545
Epoch: 5, Steps: 89 | Train Loss: 0.302 Vali Loss: 0.343 Vali Acc: 0.890 Test Loss: 0.343 Test Acc: 0.890
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.132697343826294
Epoch: 6, Steps: 89 | Train Loss: 0.223 Vali Loss: 0.203 Vali Acc: 0.947 Test Loss: 0.203 Test Acc: 0.947
Validation loss decreased (-0.905985 --> -0.947073).  Saving model ...
Epoch: 7 cost time: 8.178213596343994
Epoch: 7, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.193 Vali Acc: 0.950 Test Loss: 0.193 Test Acc: 0.950
Validation loss decreased (-0.947073 --> -0.949859).  Saving model ...
Epoch: 8 cost time: 7.745779037475586
Epoch: 8, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.156 Vali Acc: 0.960 Test Loss: 0.156 Test Acc: 0.960
Validation loss decreased (-0.949859 --> -0.959608).  Saving model ...
Epoch: 9 cost time: 8.394437313079834
Epoch: 9, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.753918409347534
Epoch: 10, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.113 Vali Acc: 0.972 Test Loss: 0.113 Test Acc: 0.972
Validation loss decreased (-0.959608 --> -0.972144).  Saving model ...
Epoch: 11 cost time: 7.393982648849487
Epoch: 11, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.115 Vali Acc: 0.967 Test Loss: 0.115 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.996004343032837
Epoch: 12, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.115 Vali Acc: 0.969 Test Loss: 0.115 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 8.836032152175903
Epoch: 13, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.972144 --> -0.972840).  Saving model ...
Epoch: 14 cost time: 7.882542133331299
Epoch: 14, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.115 Vali Acc: 0.967 Test Loss: 0.115 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.558572769165039
Epoch: 15, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.083 Vali Acc: 0.974 Test Loss: 0.083 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.974233).  Saving model ...
Epoch: 16 cost time: 7.679050922393799
Epoch: 16, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.085 Vali Acc: 0.975 Test Loss: 0.085 Test Acc: 0.975
Validation loss decreased (-0.974233 --> -0.974930).  Saving model ...
Epoch: 17 cost time: 7.606019973754883
Epoch: 17, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.974930 --> -0.979804).  Saving model ...
Epoch: 18 cost time: 9.089189052581787
Epoch: 18, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.081 Vali Acc: 0.974 Test Loss: 0.081 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 7.277421712875366
Epoch: 19, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.134 Vali Acc: 0.958 Test Loss: 0.134 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 9.38416576385498
Epoch: 20, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.664614677429199
Epoch: 21, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 7.02148962020874
Epoch: 22, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.097 Vali Acc: 0.969 Test Loss: 0.097 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 8.013105869293213
Epoch: 23, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.057 Vali Acc: 0.982 Test Loss: 0.057 Test Acc: 0.982
Validation loss decreased (-0.979804 --> -0.981894).  Saving model ...
Epoch: 24 cost time: 8.490172863006592
Epoch: 24, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.061 Vali Acc: 0.981 Test Loss: 0.061 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 7.1720805168151855
Epoch: 25, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.115 Vali Acc: 0.967 Test Loss: 0.115 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 7.706964492797852
Epoch: 26, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.067 Vali Acc: 0.979 Test Loss: 0.067 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 8.00858736038208
Epoch: 27, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.142 Vali Acc: 0.964 Test Loss: 0.142 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 7.780256271362305
Epoch: 28, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.167 Vali Acc: 0.954 Test Loss: 0.167 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 7.505555868148804
Epoch: 29, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.116 Vali Acc: 0.967 Test Loss: 0.116 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 9.487855195999146
Epoch: 30, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 7.817691326141357
Epoch: 31, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.078 Vali Acc: 0.975 Test Loss: 0.078 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 7.525448322296143
Epoch: 32, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 7.8464515209198
Epoch: 33, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.076 Vali Acc: 0.979 Test Loss: 0.076 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 438680
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 11.015820264816284
Epoch: 1, Steps: 89 | Train Loss: 2.869 Vali Loss: 2.271 Vali Acc: 0.455 Test Loss: 2.271 Test Acc: 0.455
Validation loss decreased (inf --> -0.454713).  Saving model ...
Epoch: 2 cost time: 8.675117015838623
Epoch: 2, Steps: 89 | Train Loss: 1.543 Vali Loss: 0.944 Vali Acc: 0.792 Test Loss: 0.944 Test Acc: 0.792
Validation loss decreased (-0.454713 --> -0.791773).  Saving model ...
Epoch: 3 cost time: 8.726561307907104
Epoch: 3, Steps: 89 | Train Loss: 0.704 Vali Loss: 0.539 Vali Acc: 0.877 Test Loss: 0.539 Test Acc: 0.877
Validation loss decreased (-0.791773 --> -0.876736).  Saving model ...
Epoch: 4 cost time: 7.7471418380737305
Epoch: 4, Steps: 89 | Train Loss: 0.437 Vali Loss: 0.371 Vali Acc: 0.894 Test Loss: 0.371 Test Acc: 0.894
Validation loss decreased (-0.876736 --> -0.894147).  Saving model ...
Epoch: 5 cost time: 6.97827410697937
Epoch: 5, Steps: 89 | Train Loss: 0.300 Vali Loss: 0.263 Vali Acc: 0.937 Test Loss: 0.263 Test Acc: 0.937
Validation loss decreased (-0.894147 --> -0.937323).  Saving model ...
Epoch: 6 cost time: 8.127739667892456
Epoch: 6, Steps: 89 | Train Loss: 0.213 Vali Loss: 0.236 Vali Acc: 0.935 Test Loss: 0.236 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.157160997390747
Epoch: 7, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
Validation loss decreased (-0.937323 --> -0.948466).  Saving model ...
Epoch: 8 cost time: 8.122629642486572
Epoch: 8, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
Validation loss decreased (-0.948466 --> -0.951948).  Saving model ...
Epoch: 9 cost time: 7.821377992630005
Epoch: 9, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
Validation loss decreased (-0.951948 --> -0.956823).  Saving model ...
Epoch: 10 cost time: 8.71952509880066
Epoch: 10, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.115 Vali Acc: 0.967 Test Loss: 0.115 Test Acc: 0.967
Validation loss decreased (-0.956823 --> -0.967269).  Saving model ...
Epoch: 11 cost time: 8.623046636581421
Epoch: 11, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.101 Vali Acc: 0.969 Test Loss: 0.101 Test Acc: 0.969
Validation loss decreased (-0.967269 --> -0.968662).  Saving model ...
Epoch: 12 cost time: 8.767962455749512
Epoch: 12, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.133 Vali Acc: 0.960 Test Loss: 0.133 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 9.08420181274414
Epoch: 13, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.134 Vali Acc: 0.957 Test Loss: 0.134 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 9.304185390472412
Epoch: 14, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
Validation loss decreased (-0.968662 --> -0.975626).  Saving model ...
Epoch: 15 cost time: 7.84091329574585
Epoch: 15, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 9.062594413757324
Epoch: 16, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 8.224160432815552
Epoch: 17, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.107 Vali Acc: 0.964 Test Loss: 0.107 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 9.96215558052063
Epoch: 18, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 8.102466583251953
Epoch: 19, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
Validation loss decreased (-0.975626 --> -0.978411).  Saving model ...
Epoch: 20 cost time: 7.318080186843872
Epoch: 20, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.119 Vali Acc: 0.966 Test Loss: 0.119 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 7.546076059341431
Epoch: 21, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.099 Vali Acc: 0.971 Test Loss: 0.099 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 8.385436773300171
Epoch: 22, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.103 Vali Acc: 0.972 Test Loss: 0.103 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.410734415054321
Epoch: 23, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
Validation loss decreased (-0.978411 --> -0.978411).  Saving model ...
Epoch: 24 cost time: 7.100631237030029
Epoch: 24, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.093 Vali Acc: 0.971 Test Loss: 0.093 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 8.959759950637817
Epoch: 25, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.116 Vali Acc: 0.967 Test Loss: 0.116 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 9.634891986846924
Epoch: 26, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 8.795836210250854
Epoch: 27, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.084 Vali Acc: 0.975 Test Loss: 0.084 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 7.728575944900513
Epoch: 28, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.112 Vali Acc: 0.967 Test Loss: 0.112 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 7.580993175506592
Epoch: 29, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 9.760280132293701
Epoch: 30, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.115 Vali Acc: 0.964 Test Loss: 0.115 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 8.352324962615967
Epoch: 31, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 7.859238147735596
Epoch: 32, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.123 Vali Acc: 0.969 Test Loss: 0.123 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 8.104088544845581
Epoch: 33, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 274584
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.494937419891357
Epoch: 1, Steps: 89 | Train Loss: 2.852 Vali Loss: 2.267 Vali Acc: 0.453 Test Loss: 2.267 Test Acc: 0.453
Validation loss decreased (inf --> -0.452624).  Saving model ...
Epoch: 2 cost time: 7.983262062072754
Epoch: 2, Steps: 89 | Train Loss: 1.463 Vali Loss: 0.825 Vali Acc: 0.803 Test Loss: 0.825 Test Acc: 0.803
Validation loss decreased (-0.452624 --> -0.802917).  Saving model ...
Epoch: 3 cost time: 7.1634275913238525
Epoch: 3, Steps: 89 | Train Loss: 0.611 Vali Loss: 0.452 Vali Acc: 0.903 Test Loss: 0.452 Test Acc: 0.903
Validation loss decreased (-0.802917 --> -0.903199).  Saving model ...
Epoch: 4 cost time: 8.160576343536377
Epoch: 4, Steps: 89 | Train Loss: 0.375 Vali Loss: 0.343 Vali Acc: 0.903 Test Loss: 0.343 Test Acc: 0.903
Validation loss decreased (-0.903199 --> -0.903200).  Saving model ...
Epoch: 5 cost time: 8.159685134887695
Epoch: 5, Steps: 89 | Train Loss: 0.283 Vali Loss: 0.237 Vali Acc: 0.936 Test Loss: 0.237 Test Acc: 0.936
Validation loss decreased (-0.903200 --> -0.935931).  Saving model ...
Epoch: 6 cost time: 7.93218994140625
Epoch: 6, Steps: 89 | Train Loss: 0.213 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.7429139614105225
Epoch: 7, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.162 Vali Acc: 0.962 Test Loss: 0.162 Test Acc: 0.962
Validation loss decreased (-0.935931 --> -0.961698).  Saving model ...
Epoch: 8 cost time: 7.177345275878906
Epoch: 8, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.168 Vali Acc: 0.950 Test Loss: 0.168 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.419693946838379
Epoch: 9, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.8191375732421875
Epoch: 10, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.147 Vali Acc: 0.960 Test Loss: 0.147 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.185667991638184
Epoch: 11, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
Validation loss decreased (-0.961698 --> -0.970751).  Saving model ...
Epoch: 12 cost time: 6.810249328613281
Epoch: 12, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.111 Vali Acc: 0.966 Test Loss: 0.111 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.477925539016724
Epoch: 13, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.099 Vali Acc: 0.972 Test Loss: 0.099 Test Acc: 0.972
Validation loss decreased (-0.970751 --> -0.972144).  Saving model ...
Epoch: 14 cost time: 6.882701396942139
Epoch: 14, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.106 Vali Acc: 0.964 Test Loss: 0.106 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.957550287246704
Epoch: 15, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.097 Vali Acc: 0.969 Test Loss: 0.097 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.575092792510986
Epoch: 16, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
Validation loss decreased (-0.972144 --> -0.975626).  Saving model ...
Epoch: 17 cost time: 6.531578779220581
Epoch: 17, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.975626 --> -0.977019).  Saving model ...
Epoch: 18 cost time: 6.271832227706909
Epoch: 18, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.094 Vali Acc: 0.974 Test Loss: 0.094 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.281546115875244
Epoch: 19, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.087 Vali Acc: 0.974 Test Loss: 0.087 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 7.371472358703613
Epoch: 20, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.085 Vali Acc: 0.974 Test Loss: 0.085 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.972046136856079
Epoch: 21, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.6854071617126465
Epoch: 22, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.086 Vali Acc: 0.974 Test Loss: 0.086 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 7.44115424156189
Epoch: 23, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 8.330805540084839
Epoch: 24, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.071 Vali Acc: 0.979 Test Loss: 0.071 Test Acc: 0.979
Validation loss decreased (-0.977019 --> -0.979108).  Saving model ...
Epoch: 25 cost time: 7.6437976360321045
Epoch: 25, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.072 Vali Acc: 0.979 Test Loss: 0.072 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 7.718451023101807
Epoch: 26, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.9233410358428955
Epoch: 27, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.108 Vali Acc: 0.967 Test Loss: 0.108 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 6.562135219573975
Epoch: 28, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.090 Vali Acc: 0.974 Test Loss: 0.090 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 6.8853440284729
Epoch: 29, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.100 Vali Acc: 0.972 Test Loss: 0.100 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 6.8727898597717285
Epoch: 30, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 7.2412567138671875
Epoch: 31, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 6.266268491744995
Epoch: 32, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.063 Vali Acc: 0.980 Test Loss: 0.063 Test Acc: 0.980
Validation loss decreased (-0.979108 --> -0.979804).  Saving model ...
Epoch: 33 cost time: 6.499646186828613
Epoch: 33, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.123 Vali Acc: 0.964 Test Loss: 0.123 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 6.527882814407349
Epoch: 34, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 7.264339208602905
Epoch: 35, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.143 Vali Acc: 0.969 Test Loss: 0.143 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 6.795033931732178
Epoch: 36, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.066 Vali Acc: 0.981 Test Loss: 0.066 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.981197).  Saving model ...
Epoch: 37 cost time: 6.372756719589233
Epoch: 37, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.060 Vali Acc: 0.982 Test Loss: 0.060 Test Acc: 0.982
Validation loss decreased (-0.981197 --> -0.981894).  Saving model ...
Epoch: 38 cost time: 6.184711217880249
Epoch: 38, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 6.886133670806885
Epoch: 39, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 6.501961708068848
Epoch: 40, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 7.839014768600464
Epoch: 41, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 6.449512243270874
Epoch: 42, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.107 Vali Acc: 0.972 Test Loss: 0.107 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 7.13554310798645
Epoch: 43, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 6.733902454376221
Epoch: 44, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 6.584752082824707
Epoch: 45, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.170 Vali Acc: 0.967 Test Loss: 0.170 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 7.022336959838867
Epoch: 46, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 6.524703502655029
Epoch: 47, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 273816
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.369160652160645
Epoch: 1, Steps: 89 | Train Loss: 2.812 Vali Loss: 2.199 Vali Acc: 0.467 Test Loss: 2.199 Test Acc: 0.467
Validation loss decreased (inf --> -0.466552).  Saving model ...
Epoch: 2 cost time: 7.789539575576782
Epoch: 2, Steps: 89 | Train Loss: 1.413 Vali Loss: 0.809 Vali Acc: 0.811 Test Loss: 0.809 Test Acc: 0.811
Validation loss decreased (-0.466552 --> -0.811273).  Saving model ...
Epoch: 3 cost time: 7.276643753051758
Epoch: 3, Steps: 89 | Train Loss: 0.631 Vali Loss: 0.456 Vali Acc: 0.886 Test Loss: 0.456 Test Acc: 0.886
Validation loss decreased (-0.811273 --> -0.885789).  Saving model ...
Epoch: 4 cost time: 7.390653371810913
Epoch: 4, Steps: 89 | Train Loss: 0.388 Vali Loss: 0.334 Vali Acc: 0.914 Test Loss: 0.334 Test Acc: 0.914
Validation loss decreased (-0.885789 --> -0.913646).  Saving model ...
Epoch: 5 cost time: 6.538363695144653
Epoch: 5, Steps: 89 | Train Loss: 0.279 Vali Loss: 0.274 Vali Acc: 0.933 Test Loss: 0.274 Test Acc: 0.933
Validation loss decreased (-0.913646 --> -0.933145).  Saving model ...
Epoch: 6 cost time: 6.931182146072388
Epoch: 6, Steps: 89 | Train Loss: 0.217 Vali Loss: 0.295 Vali Acc: 0.916 Test Loss: 0.295 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.964089632034302
Epoch: 7, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.162 Vali Acc: 0.959 Test Loss: 0.162 Test Acc: 0.959
Validation loss decreased (-0.933145 --> -0.958912).  Saving model ...
Epoch: 8 cost time: 7.001720190048218
Epoch: 8, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.154 Vali Acc: 0.960 Test Loss: 0.154 Test Acc: 0.960
Validation loss decreased (-0.958912 --> -0.959608).  Saving model ...
Epoch: 9 cost time: 6.7571117877960205
Epoch: 9, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
Validation loss decreased (-0.959608 --> -0.970055).  Saving model ...
Epoch: 10 cost time: 7.328924655914307
Epoch: 10, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
Validation loss decreased (-0.970055 --> -0.970751).  Saving model ...
Epoch: 11 cost time: 7.065107345581055
Epoch: 11, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.860357046127319
Epoch: 12, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.116 Vali Acc: 0.961 Test Loss: 0.116 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.0571794509887695
Epoch: 13, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
Validation loss decreased (-0.970751 --> -0.977715).  Saving model ...
Epoch: 14 cost time: 6.7564520835876465
Epoch: 14, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.977522850036621
Epoch: 15, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.41274356842041
Epoch: 16, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.083 Vali Acc: 0.979 Test Loss: 0.083 Test Acc: 0.979
Validation loss decreased (-0.977715 --> -0.979108).  Saving model ...
Epoch: 17 cost time: 7.514096975326538
Epoch: 17, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 8.17978572845459
Epoch: 18, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
Validation loss decreased (-0.979108 --> -0.981197).  Saving model ...
Epoch: 19 cost time: 6.992133140563965
Epoch: 19, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 7.820370674133301
Epoch: 20, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.095 Vali Acc: 0.969 Test Loss: 0.095 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 8.528087139129639
Epoch: 21, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.087 Vali Acc: 0.969 Test Loss: 0.087 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 8.288646221160889
Epoch: 22, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.073 Vali Acc: 0.979 Test Loss: 0.073 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 9.570519208908081
Epoch: 23, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 8.731743097305298
Epoch: 24, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.983286).  Saving model ...
Epoch: 25 cost time: 8.199572801589966
Epoch: 25, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 9.531351089477539
Epoch: 26, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.079 Vali Acc: 0.979 Test Loss: 0.079 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 9.737475633621216
Epoch: 27, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.083 Vali Acc: 0.974 Test Loss: 0.083 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 9.514821767807007
Epoch: 28, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 9.127687454223633
Epoch: 29, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.178 Vali Acc: 0.956 Test Loss: 0.178 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 10.934314727783203
Epoch: 30, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.059 Vali Acc: 0.983 Test Loss: 0.059 Test Acc: 0.983
Validation loss decreased (-0.983286 --> -0.983286).  Saving model ...
Epoch: 31 cost time: 9.074654817581177
Epoch: 31, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.069 Vali Acc: 0.976 Test Loss: 0.069 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 9.283100605010986
Epoch: 32, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.068 Vali Acc: 0.982 Test Loss: 0.068 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 10.77980351448059
Epoch: 33, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.067 Vali Acc: 0.979 Test Loss: 0.067 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 10.796551942825317
Epoch: 34, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.071 Vali Acc: 0.982 Test Loss: 0.071 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 8.868917465209961
Epoch: 35, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 9.27867078781128
Epoch: 36, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 9.961652994155884
Epoch: 37, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.081 Vali Acc: 0.975 Test Loss: 0.081 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 9.522357702255249
Epoch: 38, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 9.816743612289429
Epoch: 39, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.148 Vali Acc: 0.960 Test Loss: 0.148 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 8.935122966766357
Epoch: 40, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.136 Vali Acc: 0.964 Test Loss: 0.136 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 273048
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.583211898803711
Epoch: 1, Steps: 89 | Train Loss: 2.895 Vali Loss: 2.416 Vali Acc: 0.356 Test Loss: 2.416 Test Acc: 0.356
Validation loss decreased (inf --> -0.355825).  Saving model ...
Epoch: 2 cost time: 9.455408096313477
Epoch: 2, Steps: 89 | Train Loss: 1.594 Vali Loss: 0.857 Vali Acc: 0.815 Test Loss: 0.857 Test Acc: 0.815
Validation loss decreased (-0.355825 --> -0.814755).  Saving model ...
Epoch: 3 cost time: 7.237171649932861
Epoch: 3, Steps: 89 | Train Loss: 0.660 Vali Loss: 0.517 Vali Acc: 0.849 Test Loss: 0.517 Test Acc: 0.849
Validation loss decreased (-0.814755 --> -0.848881).  Saving model ...
Epoch: 4 cost time: 6.8445611000061035
Epoch: 4, Steps: 89 | Train Loss: 0.420 Vali Loss: 0.382 Vali Acc: 0.893 Test Loss: 0.382 Test Acc: 0.893
Validation loss decreased (-0.848881 --> -0.893450).  Saving model ...
Epoch: 5 cost time: 7.483993291854858
Epoch: 5, Steps: 89 | Train Loss: 0.293 Vali Loss: 0.244 Vali Acc: 0.950 Test Loss: 0.244 Test Acc: 0.950
Validation loss decreased (-0.893450 --> -0.949858).  Saving model ...
Epoch: 6 cost time: 6.758894920349121
Epoch: 6, Steps: 89 | Train Loss: 0.221 Vali Loss: 0.195 Vali Acc: 0.955 Test Loss: 0.195 Test Acc: 0.955
Validation loss decreased (-0.949858 --> -0.955430).  Saving model ...
Epoch: 7 cost time: 8.129290103912354
Epoch: 7, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.160 Vali Acc: 0.955 Test Loss: 0.160 Test Acc: 0.955
Validation loss decreased (-0.955430 --> -0.955430).  Saving model ...
Epoch: 8 cost time: 8.336765766143799
Epoch: 8, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.201 Vali Acc: 0.943 Test Loss: 0.201 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.250730752944946
Epoch: 9, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
Validation loss decreased (-0.955430 --> -0.967965).  Saving model ...
Epoch: 10 cost time: 8.132981777191162
Epoch: 10, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.68598484992981
Epoch: 11, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.134 Vali Acc: 0.963 Test Loss: 0.134 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.2115159034729
Epoch: 12, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.127 Vali Acc: 0.966 Test Loss: 0.127 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.925390720367432
Epoch: 13, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
Validation loss decreased (-0.967965 --> -0.968662).  Saving model ...
Epoch: 14 cost time: 7.435609340667725
Epoch: 14, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.101 Vali Acc: 0.969 Test Loss: 0.101 Test Acc: 0.969
Validation loss decreased (-0.968662 --> -0.969358).  Saving model ...
Epoch: 15 cost time: 7.754735231399536
Epoch: 15, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
Validation loss decreased (-0.969358 --> -0.974929).  Saving model ...
Epoch: 16 cost time: 9.170231342315674
Epoch: 16, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.125 Vali Acc: 0.958 Test Loss: 0.125 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 9.10505723953247
Epoch: 17, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.974929 --> -0.977019).  Saving model ...
Epoch: 18 cost time: 7.16637659072876
Epoch: 18, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.128 Vali Acc: 0.960 Test Loss: 0.128 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 7.592953205108643
Epoch: 19, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 7.338475942611694
Epoch: 20, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.112 Vali Acc: 0.969 Test Loss: 0.112 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 7.467885494232178
Epoch: 21, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
Validation loss decreased (-0.977019 --> -0.978411).  Saving model ...
Epoch: 22 cost time: 7.991187334060669
Epoch: 22, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.978411 --> -0.982590).  Saving model ...
Epoch: 23 cost time: 8.167145013809204
Epoch: 23, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.066 Vali Acc: 0.982 Test Loss: 0.066 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 8.328342914581299
Epoch: 24, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 8.868826627731323
Epoch: 25, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.115 Vali Acc: 0.966 Test Loss: 0.115 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 7.4911675453186035
Epoch: 26, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.189 Vali Acc: 0.938 Test Loss: 0.189 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 7.911085367202759
Epoch: 27, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 8.590579509735107
Epoch: 28, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 7.073671579360962
Epoch: 29, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.982590 --> -0.983286).  Saving model ...
Epoch: 30 cost time: 7.791822671890259
Epoch: 30, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 8.304805994033813
Epoch: 31, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.092 Vali Acc: 0.969 Test Loss: 0.092 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 8.373152256011963
Epoch: 32, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 8.409193754196167
Epoch: 33, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 8.117119550704956
Epoch: 34, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 9.32804274559021
Epoch: 35, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 7.951435565948486
Epoch: 36, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 7.41485857963562
Epoch: 37, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.066 Vali Acc: 0.982 Test Loss: 0.066 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 8.16659164428711
Epoch: 38, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 9.111541509628296
Epoch: 39, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 272280
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 11.251624822616577
Epoch: 1, Steps: 89 | Train Loss: 2.888 Vali Loss: 2.464 Vali Acc: 0.306 Test Loss: 2.464 Test Acc: 0.306
Validation loss decreased (inf --> -0.306382).  Saving model ...
Epoch: 2 cost time: 8.101861000061035
Epoch: 2, Steps: 89 | Train Loss: 1.648 Vali Loss: 0.972 Vali Acc: 0.740 Test Loss: 0.972 Test Acc: 0.740
Validation loss decreased (-0.306382 --> -0.740241).  Saving model ...
Epoch: 3 cost time: 7.474077939987183
Epoch: 3, Steps: 89 | Train Loss: 0.684 Vali Loss: 0.504 Vali Acc: 0.877 Test Loss: 0.504 Test Acc: 0.877
Validation loss decreased (-0.740241 --> -0.877432).  Saving model ...
Epoch: 4 cost time: 7.662403345108032
Epoch: 4, Steps: 89 | Train Loss: 0.419 Vali Loss: 0.343 Vali Acc: 0.915 Test Loss: 0.343 Test Acc: 0.915
Validation loss decreased (-0.877432 --> -0.915038).  Saving model ...
Epoch: 5 cost time: 7.661575555801392
Epoch: 5, Steps: 89 | Train Loss: 0.289 Vali Loss: 0.276 Vali Acc: 0.927 Test Loss: 0.276 Test Acc: 0.927
Validation loss decreased (-0.915038 --> -0.926877).  Saving model ...
Epoch: 6 cost time: 8.066429138183594
Epoch: 6, Steps: 89 | Train Loss: 0.222 Vali Loss: 0.255 Vali Acc: 0.927 Test Loss: 0.255 Test Acc: 0.927
Validation loss decreased (-0.926877 --> -0.926878).  Saving model ...
Epoch: 7 cost time: 7.6525022983551025
Epoch: 7, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.183 Vali Acc: 0.953 Test Loss: 0.183 Test Acc: 0.953
Validation loss decreased (-0.926878 --> -0.953341).  Saving model ...
Epoch: 8 cost time: 9.188154220581055
Epoch: 8, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
Validation loss decreased (-0.953341 --> -0.958912).  Saving model ...
Epoch: 9 cost time: 8.473641395568848
Epoch: 9, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.148 Vali Acc: 0.955 Test Loss: 0.148 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.6931047439575195
Epoch: 10, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.124 Vali Acc: 0.964 Test Loss: 0.124 Test Acc: 0.964
Validation loss decreased (-0.958912 --> -0.963787).  Saving model ...
Epoch: 11 cost time: 6.721436262130737
Epoch: 11, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
Validation loss decreased (-0.963787 --> -0.966573).  Saving model ...
Epoch: 12 cost time: 8.537215232849121
Epoch: 12, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.121 Vali Acc: 0.966 Test Loss: 0.121 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.83779501914978
Epoch: 13, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
Validation loss decreased (-0.966573 --> -0.967966).  Saving model ...
Epoch: 14 cost time: 7.078388929367065
Epoch: 14, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
Validation loss decreased (-0.967966 --> -0.970055).  Saving model ...
Epoch: 15 cost time: 8.094364404678345
Epoch: 15, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
Validation loss decreased (-0.970055 --> -0.976322).  Saving model ...
Epoch: 16 cost time: 8.225114345550537
Epoch: 16, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.112 Vali Acc: 0.964 Test Loss: 0.112 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 9.163516283035278
Epoch: 17, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.080 Vali Acc: 0.975 Test Loss: 0.080 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 8.173900127410889
Epoch: 18, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 8.01516842842102
Epoch: 19, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.072 Vali Acc: 0.974 Test Loss: 0.072 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 7.610178470611572
Epoch: 20, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.977715).  Saving model ...
Epoch: 21 cost time: 8.178596019744873
Epoch: 21, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 9.369358539581299
Epoch: 22, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.977715 --> -0.979804).  Saving model ...
Epoch: 23 cost time: 8.332260131835938
Epoch: 23, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.979804 --> -0.982590).  Saving model ...
Epoch: 24 cost time: 7.805898189544678
Epoch: 24, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 8.460671186447144
Epoch: 25, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 7.9620373249053955
Epoch: 26, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 7.386336803436279
Epoch: 27, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.982590 --> -0.983286).  Saving model ...
Epoch: 28 cost time: 8.377665996551514
Epoch: 28, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 7.113606214523315
Epoch: 29, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.099 Vali Acc: 0.967 Test Loss: 0.099 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 7.239677667617798
Epoch: 30, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.110 Vali Acc: 0.967 Test Loss: 0.110 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 7.650895595550537
Epoch: 31, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.059 Vali Acc: 0.983 Test Loss: 0.059 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 8.572820901870728
Epoch: 32, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 7.69833779335022
Epoch: 33, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 7.712716817855835
Epoch: 34, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 11.159064054489136
Epoch: 35, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 8.432305335998535
Epoch: 36, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 7.899507761001587
Epoch: 37, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.061 Vali Acc: 0.985 Test Loss: 0.061 Test Acc: 0.985
Validation loss decreased (-0.983286 --> -0.984679).  Saving model ...
Epoch: 38 cost time: 8.499368667602539
Epoch: 38, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 7.686639308929443
Epoch: 39, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.982 Test Loss: 0.079 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 8.478247880935669
Epoch: 40, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.052 Vali Acc: 0.987 Test Loss: 0.052 Test Acc: 0.987
Validation loss decreased (-0.984679 --> -0.986768).  Saving model ...
Epoch: 41 cost time: 7.784635305404663
Epoch: 41, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 8.32114577293396
Epoch: 42, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 8.210867881774902
Epoch: 43, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 8.285069942474365
Epoch: 44, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 8.365036249160767
Epoch: 45, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.064 Vali Acc: 0.981 Test Loss: 0.064 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 7.950663328170776
Epoch: 46, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.065 Vali Acc: 0.979 Test Loss: 0.065 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 7.476806640625
Epoch: 47, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 6.61535382270813
Epoch: 48, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.066 Vali Acc: 0.982 Test Loss: 0.066 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 8.136312007904053
Epoch: 49, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 6.9148313999176025
Epoch: 50, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 191384
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 11.107540130615234
Epoch: 1, Steps: 89 | Train Loss: 2.792 Vali Loss: 2.268 Vali Acc: 0.391 Test Loss: 2.268 Test Acc: 0.391
Validation loss decreased (inf --> -0.390646).  Saving model ...
Epoch: 2 cost time: 8.189708471298218
Epoch: 2, Steps: 89 | Train Loss: 1.505 Vali Loss: 0.846 Vali Acc: 0.820 Test Loss: 0.846 Test Acc: 0.820
Validation loss decreased (-0.390646 --> -0.819629).  Saving model ...
Epoch: 3 cost time: 7.045253276824951
Epoch: 3, Steps: 89 | Train Loss: 0.641 Vali Loss: 0.481 Vali Acc: 0.887 Test Loss: 0.481 Test Acc: 0.887
Validation loss decreased (-0.819629 --> -0.887182).  Saving model ...
Epoch: 4 cost time: 7.095807075500488
Epoch: 4, Steps: 89 | Train Loss: 0.400 Vali Loss: 0.322 Vali Acc: 0.921 Test Loss: 0.322 Test Acc: 0.921
Validation loss decreased (-0.887182 --> -0.921306).  Saving model ...
Epoch: 5 cost time: 7.073541164398193
Epoch: 5, Steps: 89 | Train Loss: 0.278 Vali Loss: 0.266 Vali Acc: 0.919 Test Loss: 0.266 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.08422064781189
Epoch: 6, Steps: 89 | Train Loss: 0.215 Vali Loss: 0.208 Vali Acc: 0.947 Test Loss: 0.208 Test Acc: 0.947
Validation loss decreased (-0.921306 --> -0.947073).  Saving model ...
Epoch: 7 cost time: 10.237598896026611
Epoch: 7, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
Validation loss decreased (-0.947073 --> -0.956126).  Saving model ...
Epoch: 8 cost time: 9.291569471359253
Epoch: 8, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.160 Vali Acc: 0.947 Test Loss: 0.160 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.536434650421143
Epoch: 9, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
Validation loss decreased (-0.956126 --> -0.958912).  Saving model ...
Epoch: 10 cost time: 11.23811936378479
Epoch: 10, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 10.20317554473877
Epoch: 11, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
Validation loss decreased (-0.958912 --> -0.971447).  Saving model ...
Epoch: 12 cost time: 10.959728240966797
Epoch: 12, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.971447 --> -0.977019).  Saving model ...
Epoch: 13 cost time: 9.29346489906311
Epoch: 13, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.096967697143555
Epoch: 14, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
Validation loss decreased (-0.977019 --> -0.979108).  Saving model ...
Epoch: 15 cost time: 8.456144332885742
Epoch: 15, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 8.419537544250488
Epoch: 16, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
Validation loss decreased (-0.979108 --> -0.980501).  Saving model ...
Epoch: 17 cost time: 9.203158855438232
Epoch: 17, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 9.01314663887024
Epoch: 18, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.068 Vali Acc: 0.979 Test Loss: 0.068 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 8.182010173797607
Epoch: 19, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.154 Vali Acc: 0.946 Test Loss: 0.154 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 8.78931713104248
Epoch: 20, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.077 Vali Acc: 0.979 Test Loss: 0.077 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 8.55216121673584
Epoch: 21, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 7.665421962738037
Epoch: 22, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.127 Vali Acc: 0.961 Test Loss: 0.127 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 7.943253755569458
Epoch: 23, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.070 Vali Acc: 0.979 Test Loss: 0.070 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 7.613054275512695
Epoch: 24, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 8.365416049957275
Epoch: 25, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 7.521113157272339
Epoch: 26, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 190616
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 11.32589602470398
Epoch: 1, Steps: 89 | Train Loss: 2.849 Vali Loss: 2.332 Vali Acc: 0.430 Test Loss: 2.332 Test Acc: 0.430
Validation loss decreased (inf --> -0.429642).  Saving model ...
Epoch: 2 cost time: 7.812407493591309
Epoch: 2, Steps: 89 | Train Loss: 1.538 Vali Loss: 0.900 Vali Acc: 0.795 Test Loss: 0.900 Test Acc: 0.795
Validation loss decreased (-0.429642 --> -0.794559).  Saving model ...
Epoch: 3 cost time: 8.680911540985107
Epoch: 3, Steps: 89 | Train Loss: 0.679 Vali Loss: 0.524 Vali Acc: 0.857 Test Loss: 0.524 Test Acc: 0.857
Validation loss decreased (-0.794559 --> -0.857237).  Saving model ...
Epoch: 4 cost time: 7.788556098937988
Epoch: 4, Steps: 89 | Train Loss: 0.433 Vali Loss: 0.345 Vali Acc: 0.908 Test Loss: 0.345 Test Acc: 0.908
Validation loss decreased (-0.857237 --> -0.908075).  Saving model ...
Epoch: 5 cost time: 8.198241472244263
Epoch: 5, Steps: 89 | Train Loss: 0.304 Vali Loss: 0.268 Vali Acc: 0.934 Test Loss: 0.268 Test Acc: 0.934
Validation loss decreased (-0.908075 --> -0.933841).  Saving model ...
Epoch: 6 cost time: 8.709089994430542
Epoch: 6, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.213 Vali Acc: 0.945 Test Loss: 0.213 Test Acc: 0.945
Validation loss decreased (-0.933841 --> -0.944984).  Saving model ...
Epoch: 7 cost time: 9.772093057632446
Epoch: 7, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.201 Vali Acc: 0.939 Test Loss: 0.201 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.076762437820435
Epoch: 8, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.149 Vali Acc: 0.959 Test Loss: 0.149 Test Acc: 0.959
Validation loss decreased (-0.944984 --> -0.958912).  Saving model ...
Epoch: 9 cost time: 8.326716423034668
Epoch: 9, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
Validation loss decreased (-0.958912 --> -0.965180).  Saving model ...
Epoch: 10 cost time: 7.082575082778931
Epoch: 10, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
Validation loss decreased (-0.965180 --> -0.967965).  Saving model ...
Epoch: 11 cost time: 7.0820348262786865
Epoch: 11, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.129 Vali Acc: 0.963 Test Loss: 0.129 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.930678606033325
Epoch: 12, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.095 Vali Acc: 0.979 Test Loss: 0.095 Test Acc: 0.979
Validation loss decreased (-0.967965 --> -0.979108).  Saving model ...
Epoch: 13 cost time: 6.849760055541992
Epoch: 13, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.120 Vali Acc: 0.966 Test Loss: 0.120 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.582794904708862
Epoch: 14, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.107 Vali Acc: 0.966 Test Loss: 0.107 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.037418365478516
Epoch: 15, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.087 Vali Acc: 0.974 Test Loss: 0.087 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 8.125185489654541
Epoch: 16, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.405919313430786
Epoch: 17, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.107 Vali Acc: 0.966 Test Loss: 0.107 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 7.203292608261108
Epoch: 18, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 7.816175222396851
Epoch: 19, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.113 Vali Acc: 0.962 Test Loss: 0.113 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 7.387440204620361
Epoch: 20, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.812910556793213
Epoch: 21, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.336617469787598
Epoch: 22, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.129 Vali Acc: 0.960 Test Loss: 0.129 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 189848
model size : 1.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.177876710891724
Epoch: 1, Steps: 89 | Train Loss: 2.912 Vali Loss: 2.396 Vali Acc: 0.497 Test Loss: 2.396 Test Acc: 0.497
Validation loss decreased (inf --> -0.496494).  Saving model ...
Epoch: 2 cost time: 6.648573875427246
Epoch: 2, Steps: 89 | Train Loss: 1.616 Vali Loss: 0.948 Vali Acc: 0.744 Test Loss: 0.948 Test Acc: 0.744
Validation loss decreased (-0.496494 --> -0.744419).  Saving model ...
Epoch: 3 cost time: 7.9710752964019775
Epoch: 3, Steps: 89 | Train Loss: 0.694 Vali Loss: 0.566 Vali Acc: 0.836 Test Loss: 0.566 Test Acc: 0.836
Validation loss decreased (-0.744419 --> -0.836345).  Saving model ...
Epoch: 4 cost time: 7.55192232131958
Epoch: 4, Steps: 89 | Train Loss: 0.453 Vali Loss: 0.385 Vali Acc: 0.897 Test Loss: 0.385 Test Acc: 0.897
Validation loss decreased (-0.836345 --> -0.896932).  Saving model ...
Epoch: 5 cost time: 7.6429290771484375
Epoch: 5, Steps: 89 | Train Loss: 0.324 Vali Loss: 0.297 Vali Acc: 0.923 Test Loss: 0.297 Test Acc: 0.923
Validation loss decreased (-0.896932 --> -0.922699).  Saving model ...
Epoch: 6 cost time: 7.5147528648376465
Epoch: 6, Steps: 89 | Train Loss: 0.230 Vali Loss: 0.238 Vali Acc: 0.933 Test Loss: 0.238 Test Acc: 0.933
Validation loss decreased (-0.922699 --> -0.933145).  Saving model ...
Epoch: 7 cost time: 7.124065399169922
Epoch: 7, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.192 Vali Acc: 0.949 Test Loss: 0.192 Test Acc: 0.949
Validation loss decreased (-0.933145 --> -0.949162).  Saving model ...
Epoch: 8 cost time: 7.975049734115601
Epoch: 8, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
Validation loss decreased (-0.949162 --> -0.961698).  Saving model ...
Epoch: 9 cost time: 7.633188486099243
Epoch: 9, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
Validation loss decreased (-0.961698 --> -0.966573).  Saving model ...
Epoch: 10 cost time: 7.730736255645752
Epoch: 10, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.125 Vali Acc: 0.963 Test Loss: 0.125 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.702324390411377
Epoch: 11, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.104 Vali Acc: 0.969 Test Loss: 0.104 Test Acc: 0.969
Validation loss decreased (-0.966573 --> -0.969358).  Saving model ...
Epoch: 12 cost time: 7.591240406036377
Epoch: 12, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.970751).  Saving model ...
Epoch: 13 cost time: 9.264678001403809
Epoch: 13, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.970751 --> -0.972840).  Saving model ...
Epoch: 14 cost time: 7.219983100891113
Epoch: 14, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.109 Vali Acc: 0.967 Test Loss: 0.109 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.841592073440552
Epoch: 15, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.091 Vali Acc: 0.974 Test Loss: 0.091 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.974233).  Saving model ...
Epoch: 16 cost time: 8.11380934715271
Epoch: 16, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.091 Vali Acc: 0.974 Test Loss: 0.091 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.49241828918457
Epoch: 17, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.115 Vali Acc: 0.967 Test Loss: 0.115 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.353050708770752
Epoch: 18, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 7.346209764480591
Epoch: 19, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.110 Vali Acc: 0.969 Test Loss: 0.110 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 7.973515272140503
Epoch: 20, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 8.526560544967651
Epoch: 21, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.101 Vali Acc: 0.969 Test Loss: 0.101 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 7.4115965366363525
Epoch: 22, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.105 Vali Acc: 0.972 Test Loss: 0.105 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 8.469409942626953
Epoch: 23, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.976322).  Saving model ...
Epoch: 24 cost time: 8.863825798034668
Epoch: 24, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 7.963043212890625
Epoch: 25, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.978411).  Saving model ...
Epoch: 26 cost time: 9.411196231842041
Epoch: 26, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.156 Vali Acc: 0.955 Test Loss: 0.156 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 8.35027003288269
Epoch: 27, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.112 Vali Acc: 0.972 Test Loss: 0.112 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 6.8029868602752686
Epoch: 28, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.978411 --> -0.982590).  Saving model ...
Epoch: 29 cost time: 7.84289026260376
Epoch: 29, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 8.857428073883057
Epoch: 30, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 8.3165602684021
Epoch: 31, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 8.123537540435791
Epoch: 32, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.061 Vali Acc: 0.985 Test Loss: 0.061 Test Acc: 0.985
Validation loss decreased (-0.982590 --> -0.984679).  Saving model ...
Epoch: 33 cost time: 9.411623001098633
Epoch: 33, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 9.566040515899658
Epoch: 34, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 8.509877681732178
Epoch: 35, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.168 Vali Acc: 0.960 Test Loss: 0.168 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 8.41907525062561
Epoch: 36, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 8.030808925628662
Epoch: 37, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 7.605429410934448
Epoch: 38, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 7.2528815269470215
Epoch: 39, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.074 Vali Acc: 0.979 Test Loss: 0.074 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 7.769169330596924
Epoch: 40, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.106 Vali Acc: 0.979 Test Loss: 0.106 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 7.8841657638549805
Epoch: 41, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.138 Vali Acc: 0.969 Test Loss: 0.138 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 8.560482263565063
Epoch: 42, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 189080
model size : 1.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.830248355865479
Epoch: 1, Steps: 89 | Train Loss: 2.900 Vali Loss: 2.492 Vali Acc: 0.435 Test Loss: 2.492 Test Acc: 0.435
Validation loss decreased (inf --> -0.434515).  Saving model ...
Epoch: 2 cost time: 7.877627611160278
Epoch: 2, Steps: 89 | Train Loss: 1.759 Vali Loss: 1.030 Vali Acc: 0.756 Test Loss: 1.030 Test Acc: 0.756
Validation loss decreased (-0.434515 --> -0.756257).  Saving model ...
Epoch: 3 cost time: 7.6936562061309814
Epoch: 3, Steps: 89 | Train Loss: 0.720 Vali Loss: 0.536 Vali Acc: 0.851 Test Loss: 0.536 Test Acc: 0.851
Validation loss decreased (-0.756257 --> -0.850970).  Saving model ...
Epoch: 4 cost time: 7.9173743724823
Epoch: 4, Steps: 89 | Train Loss: 0.428 Vali Loss: 0.374 Vali Acc: 0.909 Test Loss: 0.374 Test Acc: 0.909
Validation loss decreased (-0.850970 --> -0.909467).  Saving model ...
Epoch: 5 cost time: 7.87964653968811
Epoch: 5, Steps: 89 | Train Loss: 0.315 Vali Loss: 0.272 Vali Acc: 0.932 Test Loss: 0.272 Test Acc: 0.932
Validation loss decreased (-0.909467 --> -0.931752).  Saving model ...
Epoch: 6 cost time: 8.346965551376343
Epoch: 6, Steps: 89 | Train Loss: 0.231 Vali Loss: 0.217 Vali Acc: 0.938 Test Loss: 0.217 Test Acc: 0.938
Validation loss decreased (-0.931752 --> -0.938020).  Saving model ...
Epoch: 7 cost time: 9.038802146911621
Epoch: 7, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.210 Vali Acc: 0.939 Test Loss: 0.210 Test Acc: 0.939
Validation loss decreased (-0.938020 --> -0.939413).  Saving model ...
Epoch: 8 cost time: 8.70856499671936
Epoch: 8, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.140 Vali Acc: 0.966 Test Loss: 0.140 Test Acc: 0.966
Validation loss decreased (-0.939413 --> -0.965876).  Saving model ...
Epoch: 9 cost time: 8.631770849227905
Epoch: 9, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.136 Vali Acc: 0.961 Test Loss: 0.136 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.43921947479248
Epoch: 10, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 10.507695436477661
Epoch: 11, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
Validation loss decreased (-0.965876 --> -0.974233).  Saving model ...
Epoch: 12 cost time: 8.561712980270386
Epoch: 12, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.102 Vali Acc: 0.972 Test Loss: 0.102 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.9773571491241455
Epoch: 13, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.105 Vali Acc: 0.964 Test Loss: 0.105 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.678001165390015
Epoch: 14, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
Validation loss decreased (-0.974233 --> -0.974233).  Saving model ...
Epoch: 15 cost time: 7.807183027267456
Epoch: 15, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.095 Vali Acc: 0.969 Test Loss: 0.095 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 8.481038093566895
Epoch: 16, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.975626).  Saving model ...
Epoch: 17 cost time: 6.710551023483276
Epoch: 17, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
Validation loss decreased (-0.975626 --> -0.975626).  Saving model ...
Epoch: 18 cost time: 6.801913022994995
Epoch: 18, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
Validation loss decreased (-0.975626 --> -0.976322).  Saving model ...
Epoch: 19 cost time: 8.581698656082153
Epoch: 19, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.192 Vali Acc: 0.942 Test Loss: 0.192 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 7.990747690200806
Epoch: 20, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.978411).  Saving model ...
Epoch: 21 cost time: 8.69209909439087
Epoch: 21, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 8.742531061172485
Epoch: 22, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 7.680210590362549
Epoch: 23, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 7.898187637329102
Epoch: 24, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 8.058098793029785
Epoch: 25, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.078 Vali Acc: 0.979 Test Loss: 0.078 Test Acc: 0.979
Validation loss decreased (-0.978411 --> -0.979108).  Saving model ...
Epoch: 26 cost time: 9.224387407302856
Epoch: 26, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 7.664811849594116
Epoch: 27, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.078 Vali Acc: 0.974 Test Loss: 0.078 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 8.01492190361023
Epoch: 28, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.116 Vali Acc: 0.972 Test Loss: 0.116 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 8.48533821105957
Epoch: 29, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.066 Vali Acc: 0.979 Test Loss: 0.066 Test Acc: 0.979
Validation loss decreased (-0.979108 --> -0.979108).  Saving model ...
Epoch: 30 cost time: 7.462319612503052
Epoch: 30, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.074 Vali Acc: 0.982 Test Loss: 0.074 Test Acc: 0.982
Validation loss decreased (-0.979108 --> -0.981893).  Saving model ...
Epoch: 31 cost time: 6.9451518058776855
Epoch: 31, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.095 Vali Acc: 0.971 Test Loss: 0.095 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 7.116044044494629
Epoch: 32, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.059 Vali Acc: 0.984 Test Loss: 0.059 Test Acc: 0.984
Validation loss decreased (-0.981893 --> -0.983983).  Saving model ...
Epoch: 33 cost time: 8.896079778671265
Epoch: 33, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 9.145286798477173
Epoch: 34, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 9.253987312316895
Epoch: 35, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 9.447696208953857
Epoch: 36, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 8.090442180633545
Epoch: 37, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 10.06570029258728
Epoch: 38, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 8.625888347625732
Epoch: 39, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.124 Vali Acc: 0.964 Test Loss: 0.124 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 8.444524765014648
Epoch: 40, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 9.35982632637024
Epoch: 41, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 7.993588447570801
Epoch: 42, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 149784
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.009965658187866
Epoch: 1, Steps: 89 | Train Loss: 2.828 Vali Loss: 2.386 Vali Acc: 0.451 Test Loss: 2.386 Test Acc: 0.451
Validation loss decreased (inf --> -0.451230).  Saving model ...
Epoch: 2 cost time: 8.066806316375732
Epoch: 2, Steps: 89 | Train Loss: 1.648 Vali Loss: 0.993 Vali Acc: 0.774 Test Loss: 0.993 Test Acc: 0.774
Validation loss decreased (-0.451230 --> -0.774363).  Saving model ...
Epoch: 3 cost time: 8.234341621398926
Epoch: 3, Steps: 89 | Train Loss: 0.738 Vali Loss: 0.535 Vali Acc: 0.867 Test Loss: 0.535 Test Acc: 0.867
Validation loss decreased (-0.774363 --> -0.866986).  Saving model ...
Epoch: 4 cost time: 7.73627233505249
Epoch: 4, Steps: 89 | Train Loss: 0.443 Vali Loss: 0.371 Vali Acc: 0.898 Test Loss: 0.371 Test Acc: 0.898
Validation loss decreased (-0.866986 --> -0.897629).  Saving model ...
Epoch: 5 cost time: 8.42598819732666
Epoch: 5, Steps: 89 | Train Loss: 0.299 Vali Loss: 0.297 Vali Acc: 0.912 Test Loss: 0.297 Test Acc: 0.912
Validation loss decreased (-0.897629 --> -0.911557).  Saving model ...
Epoch: 6 cost time: 8.13907527923584
Epoch: 6, Steps: 89 | Train Loss: 0.216 Vali Loss: 0.209 Vali Acc: 0.945 Test Loss: 0.209 Test Acc: 0.945
Validation loss decreased (-0.911557 --> -0.944984).  Saving model ...
Epoch: 7 cost time: 8.017607927322388
Epoch: 7, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.177 Vali Acc: 0.951 Test Loss: 0.177 Test Acc: 0.951
Validation loss decreased (-0.944984 --> -0.951252).  Saving model ...
Epoch: 8 cost time: 10.210130214691162
Epoch: 8, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
Validation loss decreased (-0.951252 --> -0.958216).  Saving model ...
Epoch: 9 cost time: 10.013575315475464
Epoch: 9, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.178 Vali Acc: 0.952 Test Loss: 0.178 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.866694450378418
Epoch: 10, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.133 Vali Acc: 0.955 Test Loss: 0.133 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.19154167175293
Epoch: 11, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.116 Vali Acc: 0.971 Test Loss: 0.116 Test Acc: 0.971
Validation loss decreased (-0.958216 --> -0.971447).  Saving model ...
Epoch: 12 cost time: 8.427859544754028
Epoch: 12, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 8.682740211486816
Epoch: 13, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.141 Vali Acc: 0.953 Test Loss: 0.141 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 8.687719821929932
Epoch: 14, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.094 Vali Acc: 0.971 Test Loss: 0.094 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 8.433795928955078
Epoch: 15, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.971447 --> -0.977019).  Saving model ...
Epoch: 16 cost time: 7.756177186965942
Epoch: 16, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.080 Vali Acc: 0.971 Test Loss: 0.080 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.535214185714722
Epoch: 17, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.087 Vali Acc: 0.971 Test Loss: 0.087 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 9.01475214958191
Epoch: 18, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 8.431596040725708
Epoch: 19, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 8.14468264579773
Epoch: 20, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.094 Vali Acc: 0.971 Test Loss: 0.094 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 8.796358823776245
Epoch: 21, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
Validation loss decreased (-0.977019 --> -0.979108).  Saving model ...
Epoch: 22 cost time: 7.8081090450286865
Epoch: 22, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.128 Vali Acc: 0.958 Test Loss: 0.128 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 8.255882501602173
Epoch: 23, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979108 --> -0.979804).  Saving model ...
Epoch: 24 cost time: 8.358919858932495
Epoch: 24, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.078 Vali Acc: 0.979 Test Loss: 0.078 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 8.53724479675293
Epoch: 25, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 7.692819595336914
Epoch: 26, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.981197).  Saving model ...
Epoch: 27 cost time: 7.62939190864563
Epoch: 27, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 7.838111400604248
Epoch: 28, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
Validation loss decreased (-0.981197 --> -0.981197).  Saving model ...
Epoch: 29 cost time: 8.85053825378418
Epoch: 29, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 8.144258499145508
Epoch: 30, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.120 Vali Acc: 0.974 Test Loss: 0.120 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 8.668120384216309
Epoch: 31, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 8.000329732894897
Epoch: 32, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 8.717625617980957
Epoch: 33, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 8.55029845237732
Epoch: 34, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 8.475968360900879
Epoch: 35, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 9.755866050720215
Epoch: 36, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 8.532217025756836
Epoch: 37, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 10.42118239402771
Epoch: 38, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 149016
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.605993509292603
Epoch: 1, Steps: 89 | Train Loss: 2.922 Vali Loss: 2.458 Vali Acc: 0.405 Test Loss: 2.458 Test Acc: 0.405
Validation loss decreased (inf --> -0.405268).  Saving model ...
Epoch: 2 cost time: 7.586827754974365
Epoch: 2, Steps: 89 | Train Loss: 1.764 Vali Loss: 1.025 Vali Acc: 0.766 Test Loss: 1.025 Test Acc: 0.766
Validation loss decreased (-0.405268 --> -0.766006).  Saving model ...
Epoch: 3 cost time: 7.244777202606201
Epoch: 3, Steps: 89 | Train Loss: 0.749 Vali Loss: 0.532 Vali Acc: 0.863 Test Loss: 0.532 Test Acc: 0.863
Validation loss decreased (-0.766006 --> -0.862808).  Saving model ...
Epoch: 4 cost time: 7.300686359405518
Epoch: 4, Steps: 89 | Train Loss: 0.439 Vali Loss: 0.358 Vali Acc: 0.910 Test Loss: 0.358 Test Acc: 0.910
Validation loss decreased (-0.862808 --> -0.910164).  Saving model ...
Epoch: 5 cost time: 7.356428623199463
Epoch: 5, Steps: 89 | Train Loss: 0.313 Vali Loss: 0.263 Vali Acc: 0.932 Test Loss: 0.263 Test Acc: 0.932
Validation loss decreased (-0.910164 --> -0.932449).  Saving model ...
Epoch: 6 cost time: 8.980459928512573
Epoch: 6, Steps: 89 | Train Loss: 0.226 Vali Loss: 0.223 Vali Acc: 0.942 Test Loss: 0.223 Test Acc: 0.942
Validation loss decreased (-0.932449 --> -0.942198).  Saving model ...
Epoch: 7 cost time: 7.267202615737915
Epoch: 7, Steps: 89 | Train Loss: 0.192 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.942198 --> -0.943591).  Saving model ...
Epoch: 8 cost time: 7.4826295375823975
Epoch: 8, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.159 Vali Acc: 0.955 Test Loss: 0.159 Test Acc: 0.955
Validation loss decreased (-0.943591 --> -0.955430).  Saving model ...
Epoch: 9 cost time: 7.442081689834595
Epoch: 9, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.681455135345459
Epoch: 10, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.147 Vali Acc: 0.960 Test Loss: 0.147 Test Acc: 0.960
Validation loss decreased (-0.955430 --> -0.960305).  Saving model ...
Epoch: 11 cost time: 6.896166801452637
Epoch: 11, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.119 Vali Acc: 0.964 Test Loss: 0.119 Test Acc: 0.964
Validation loss decreased (-0.960305 --> -0.963787).  Saving model ...
Epoch: 12 cost time: 7.56029486656189
Epoch: 12, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.116 Vali Acc: 0.967 Test Loss: 0.116 Test Acc: 0.967
Validation loss decreased (-0.963787 --> -0.967269).  Saving model ...
Epoch: 13 cost time: 7.2717506885528564
Epoch: 13, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.109 Vali Acc: 0.969 Test Loss: 0.109 Test Acc: 0.969
Validation loss decreased (-0.967269 --> -0.969358).  Saving model ...
Epoch: 14 cost time: 7.283627033233643
Epoch: 14, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.009208917617798
Epoch: 15, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.101 Vali Acc: 0.969 Test Loss: 0.101 Test Acc: 0.969
Validation loss decreased (-0.969358 --> -0.969358).  Saving model ...
Epoch: 16 cost time: 8.124121904373169
Epoch: 16, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.092 Vali Acc: 0.969 Test Loss: 0.092 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.901078224182129
Epoch: 17, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.089 Vali Acc: 0.971 Test Loss: 0.089 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.971448).  Saving model ...
Epoch: 18 cost time: 7.660842180252075
Epoch: 18, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.971448 --> -0.982590).  Saving model ...
Epoch: 19 cost time: 8.211320638656616
Epoch: 19, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.098 Vali Acc: 0.967 Test Loss: 0.098 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 8.164149522781372
Epoch: 20, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 7.081487417221069
Epoch: 21, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 7.388572931289673
Epoch: 22, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.085 Vali Acc: 0.972 Test Loss: 0.085 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.544988632202148
Epoch: 23, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 8.283383846282959
Epoch: 24, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.084 Vali Acc: 0.974 Test Loss: 0.084 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 8.229201555252075
Epoch: 25, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 8.041065692901611
Epoch: 26, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.066 Vali Acc: 0.978 Test Loss: 0.066 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 7.919992923736572
Epoch: 27, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 7.900729417800903
Epoch: 28, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 148248
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.447212219238281
Epoch: 1, Steps: 89 | Train Loss: 2.839 Vali Loss: 2.389 Vali Acc: 0.446 Test Loss: 2.389 Test Acc: 0.446
Validation loss decreased (inf --> -0.445659).  Saving model ...
Epoch: 2 cost time: 7.880945205688477
Epoch: 2, Steps: 89 | Train Loss: 1.675 Vali Loss: 0.956 Vali Acc: 0.791 Test Loss: 0.956 Test Acc: 0.791
Validation loss decreased (-0.445659 --> -0.791077).  Saving model ...
Epoch: 3 cost time: 7.2290215492248535
Epoch: 3, Steps: 89 | Train Loss: 0.705 Vali Loss: 0.507 Vali Acc: 0.878 Test Loss: 0.507 Test Acc: 0.878
Validation loss decreased (-0.791077 --> -0.878129).  Saving model ...
Epoch: 4 cost time: 7.628833770751953
Epoch: 4, Steps: 89 | Train Loss: 0.419 Vali Loss: 0.354 Vali Acc: 0.912 Test Loss: 0.354 Test Acc: 0.912
Validation loss decreased (-0.878129 --> -0.911556).  Saving model ...
Epoch: 5 cost time: 7.830246925354004
Epoch: 5, Steps: 89 | Train Loss: 0.291 Vali Loss: 0.286 Vali Acc: 0.919 Test Loss: 0.286 Test Acc: 0.919
Validation loss decreased (-0.911556 --> -0.918521).  Saving model ...
Epoch: 6 cost time: 6.732397794723511
Epoch: 6, Steps: 89 | Train Loss: 0.218 Vali Loss: 0.261 Vali Acc: 0.932 Test Loss: 0.261 Test Acc: 0.932
Validation loss decreased (-0.918521 --> -0.931752).  Saving model ...
Epoch: 7 cost time: 7.770116329193115
Epoch: 7, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.190 Vali Acc: 0.951 Test Loss: 0.190 Test Acc: 0.951
Validation loss decreased (-0.931752 --> -0.950555).  Saving model ...
Epoch: 8 cost time: 7.892523765563965
Epoch: 8, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.142 Vali Acc: 0.960 Test Loss: 0.142 Test Acc: 0.960
Validation loss decreased (-0.950555 --> -0.959609).  Saving model ...
Epoch: 9 cost time: 7.174535512924194
Epoch: 9, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.145 Vali Acc: 0.960 Test Loss: 0.145 Test Acc: 0.960
Validation loss decreased (-0.959609 --> -0.960305).  Saving model ...
Epoch: 10 cost time: 8.186318635940552
Epoch: 10, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.117 Vali Acc: 0.964 Test Loss: 0.117 Test Acc: 0.964
Validation loss decreased (-0.960305 --> -0.963787).  Saving model ...
Epoch: 11 cost time: 7.781049489974976
Epoch: 11, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.706172704696655
Epoch: 12, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
Validation loss decreased (-0.963787 --> -0.965180).  Saving model ...
Epoch: 13 cost time: 8.247987031936646
Epoch: 13, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.110 Vali Acc: 0.969 Test Loss: 0.110 Test Acc: 0.969
Validation loss decreased (-0.965180 --> -0.969358).  Saving model ...
Epoch: 14 cost time: 8.104692220687866
Epoch: 14, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
Validation loss decreased (-0.969358 --> -0.970055).  Saving model ...
Epoch: 15 cost time: 6.963271856307983
Epoch: 15, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
Validation loss decreased (-0.970055 --> -0.975626).  Saving model ...
Epoch: 16 cost time: 7.609933614730835
Epoch: 16, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
Validation loss decreased (-0.975626 --> -0.979108).  Saving model ...
Epoch: 17 cost time: 8.04430365562439
Epoch: 17, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 7.998678684234619
Epoch: 18, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.123 Vali Acc: 0.961 Test Loss: 0.123 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 7.6057891845703125
Epoch: 19, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 8.106242656707764
Epoch: 20, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 7.521167039871216
Epoch: 21, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.058 Vali Acc: 0.982 Test Loss: 0.058 Test Acc: 0.982
Validation loss decreased (-0.979108 --> -0.981894).  Saving model ...
Epoch: 22 cost time: 7.277202844619751
Epoch: 22, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.094 Vali Acc: 0.972 Test Loss: 0.094 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 7.193426847457886
Epoch: 23, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 6.7528626918792725
Epoch: 24, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 6.679893255233765
Epoch: 25, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 7.319429636001587
Epoch: 26, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 6.982964277267456
Epoch: 27, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.981894 --> -0.982590).  Saving model ...
Epoch: 28 cost time: 7.896199464797974
Epoch: 28, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.136 Vali Acc: 0.966 Test Loss: 0.136 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 6.50000262260437
Epoch: 29, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.094 Vali Acc: 0.974 Test Loss: 0.094 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 7.781630039215088
Epoch: 30, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 6.192140102386475
Epoch: 31, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 7.259860992431641
Epoch: 32, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 6.122248649597168
Epoch: 33, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 7.407597303390503
Epoch: 34, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 7.50691819190979
Epoch: 35, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 7.664168357849121
Epoch: 36, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 7.248399019241333
Epoch: 37, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.074 Vali Acc: 0.979 Test Loss: 0.074 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 147480
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.755621433258057
Epoch: 1, Steps: 89 | Train Loss: 1.750 Vali Loss: 0.678 Vali Acc: 0.844 Test Loss: 0.678 Test Acc: 0.844
Validation loss decreased (inf --> -0.844004).  Saving model ...
Epoch: 2 cost time: 5.225816488265991
Epoch: 2, Steps: 89 | Train Loss: 0.484 Vali Loss: 0.352 Vali Acc: 0.913 Test Loss: 0.352 Test Acc: 0.913
Validation loss decreased (-0.844004 --> -0.912949).  Saving model ...
Epoch: 3 cost time: 5.553955554962158
Epoch: 3, Steps: 89 | Train Loss: 0.337 Vali Loss: 0.322 Vali Acc: 0.932 Test Loss: 0.322 Test Acc: 0.932
Validation loss decreased (-0.912949 --> -0.932448).  Saving model ...
Epoch: 4 cost time: 5.639132976531982
Epoch: 4, Steps: 89 | Train Loss: 0.292 Vali Loss: 0.293 Vali Acc: 0.932 Test Loss: 0.293 Test Acc: 0.932
Validation loss decreased (-0.932448 --> -0.932448).  Saving model ...
Epoch: 5 cost time: 5.14040207862854
Epoch: 5, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.342 Vali Acc: 0.930 Test Loss: 0.342 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.254124641418457
Epoch: 6, Steps: 89 | Train Loss: 0.224 Vali Loss: 0.321 Vali Acc: 0.937 Test Loss: 0.321 Test Acc: 0.937
Validation loss decreased (-0.932448 --> -0.937323).  Saving model ...
Epoch: 7 cost time: 5.542104721069336
Epoch: 7, Steps: 89 | Train Loss: 0.263 Vali Loss: 0.535 Vali Acc: 0.915 Test Loss: 0.535 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.499647617340088
Epoch: 8, Steps: 89 | Train Loss: 0.259 Vali Loss: 0.432 Vali Acc: 0.943 Test Loss: 0.432 Test Acc: 0.943
Validation loss decreased (-0.937323 --> -0.942893).  Saving model ...
Epoch: 9 cost time: 5.825351238250732
Epoch: 9, Steps: 89 | Train Loss: 0.270 Vali Loss: 0.474 Vali Acc: 0.925 Test Loss: 0.474 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.896748781204224
Epoch: 10, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.489 Vali Acc: 0.944 Test Loss: 0.489 Test Acc: 0.944
Validation loss decreased (-0.942893 --> -0.943588).  Saving model ...
Epoch: 11 cost time: 6.113696336746216
Epoch: 11, Steps: 89 | Train Loss: 0.321 Vali Loss: 0.628 Vali Acc: 0.915 Test Loss: 0.628 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.006333112716675
Epoch: 12, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.676 Vali Acc: 0.921 Test Loss: 0.676 Test Acc: 0.921
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.217625141143799
Epoch: 13, Steps: 89 | Train Loss: 0.214 Vali Loss: 0.530 Vali Acc: 0.945 Test Loss: 0.530 Test Acc: 0.945
Validation loss decreased (-0.943588 --> -0.944981).  Saving model ...
Epoch: 14 cost time: 6.0094006061553955
Epoch: 14, Steps: 89 | Train Loss: 0.274 Vali Loss: 0.541 Vali Acc: 0.932 Test Loss: 0.541 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.2561516761779785
Epoch: 15, Steps: 89 | Train Loss: 0.242 Vali Loss: 0.330 Vali Acc: 0.945 Test Loss: 0.330 Test Acc: 0.945
Validation loss decreased (-0.944981 --> -0.944983).  Saving model ...
Epoch: 16 cost time: 5.866853952407837
Epoch: 16, Steps: 89 | Train Loss: 0.374 Vali Loss: 1.118 Vali Acc: 0.851 Test Loss: 1.118 Test Acc: 0.851
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.577287197113037
Epoch: 17, Steps: 89 | Train Loss: 0.530 Vali Loss: 1.203 Vali Acc: 0.864 Test Loss: 1.203 Test Acc: 0.864
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.401693344116211
Epoch: 18, Steps: 89 | Train Loss: 0.884 Vali Loss: 0.847 Vali Acc: 0.881 Test Loss: 0.847 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.67058539390564
Epoch: 19, Steps: 89 | Train Loss: 0.827 Vali Loss: 1.393 Vali Acc: 0.792 Test Loss: 1.393 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.119621753692627
Epoch: 20, Steps: 89 | Train Loss: 1.155 Vali Loss: 0.925 Vali Acc: 0.876 Test Loss: 0.925 Test Acc: 0.876
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.890366077423096
Epoch: 21, Steps: 89 | Train Loss: 1.126 Vali Loss: 0.927 Vali Acc: 0.843 Test Loss: 0.927 Test Acc: 0.843
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.415582180023193
Epoch: 22, Steps: 89 | Train Loss: 1.159 Vali Loss: 1.069 Vali Acc: 0.813 Test Loss: 1.069 Test Acc: 0.813
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 7.065667152404785
Epoch: 23, Steps: 89 | Train Loss: 1.068 Vali Loss: 0.793 Vali Acc: 0.865 Test Loss: 0.793 Test Acc: 0.865
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 6.077950954437256
Epoch: 24, Steps: 89 | Train Loss: 0.889 Vali Loss: 0.792 Vali Acc: 0.822 Test Loss: 0.792 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 6.327026605606079
Epoch: 25, Steps: 89 | Train Loss: 0.683 Vali Loss: 0.708 Vali Acc: 0.850 Test Loss: 0.708 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9449860724233984
model parameter : 5027884
model size : 24.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.936725378036499
Epoch: 1, Steps: 89 | Train Loss: 1.767 Vali Loss: 0.682 Vali Acc: 0.821 Test Loss: 0.682 Test Acc: 0.821
Validation loss decreased (inf --> -0.821024).  Saving model ...
Epoch: 2 cost time: 4.3827903270721436
Epoch: 2, Steps: 89 | Train Loss: 0.510 Vali Loss: 0.315 Vali Acc: 0.909 Test Loss: 0.315 Test Acc: 0.909
Validation loss decreased (-0.821024 --> -0.909468).  Saving model ...
Epoch: 3 cost time: 5.1104514598846436
Epoch: 3, Steps: 89 | Train Loss: 0.288 Vali Loss: 0.436 Vali Acc: 0.879 Test Loss: 0.436 Test Acc: 0.879
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.505990743637085
Epoch: 4, Steps: 89 | Train Loss: 0.239 Vali Loss: 0.260 Vali Acc: 0.932 Test Loss: 0.260 Test Acc: 0.932
Validation loss decreased (-0.909468 --> -0.931752).  Saving model ...
Epoch: 5 cost time: 5.1276209354400635
Epoch: 5, Steps: 89 | Train Loss: 0.302 Vali Loss: 0.360 Vali Acc: 0.923 Test Loss: 0.360 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.4193642139434814
Epoch: 6, Steps: 89 | Train Loss: 0.287 Vali Loss: 0.306 Vali Acc: 0.944 Test Loss: 0.306 Test Acc: 0.944
Validation loss decreased (-0.931752 --> -0.944287).  Saving model ...
Epoch: 7 cost time: 4.133933782577515
Epoch: 7, Steps: 89 | Train Loss: 0.263 Vali Loss: 0.333 Vali Acc: 0.944 Test Loss: 0.333 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.4582624435424805
Epoch: 8, Steps: 89 | Train Loss: 0.256 Vali Loss: 0.190 Vali Acc: 0.962 Test Loss: 0.190 Test Acc: 0.962
Validation loss decreased (-0.944287 --> -0.961697).  Saving model ...
Epoch: 9 cost time: 3.8171215057373047
Epoch: 9, Steps: 89 | Train Loss: 0.224 Vali Loss: 0.393 Vali Acc: 0.934 Test Loss: 0.393 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.362022876739502
Epoch: 10, Steps: 89 | Train Loss: 0.220 Vali Loss: 0.493 Vali Acc: 0.916 Test Loss: 0.493 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.252208948135376
Epoch: 11, Steps: 89 | Train Loss: 0.255 Vali Loss: 0.430 Vali Acc: 0.950 Test Loss: 0.430 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.686582565307617
Epoch: 12, Steps: 89 | Train Loss: 0.221 Vali Loss: 0.527 Vali Acc: 0.921 Test Loss: 0.527 Test Acc: 0.921
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.9026124477386475
Epoch: 13, Steps: 89 | Train Loss: 0.266 Vali Loss: 0.603 Vali Acc: 0.905 Test Loss: 0.603 Test Acc: 0.905
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.3757851123809814
Epoch: 14, Steps: 89 | Train Loss: 0.300 Vali Loss: 0.325 Vali Acc: 0.956 Test Loss: 0.325 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.658735275268555
Epoch: 15, Steps: 89 | Train Loss: 0.286 Vali Loss: 0.499 Vali Acc: 0.928 Test Loss: 0.499 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.617771148681641
Epoch: 16, Steps: 89 | Train Loss: 0.530 Vali Loss: 0.640 Vali Acc: 0.912 Test Loss: 0.640 Test Acc: 0.912
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.2375078201293945
Epoch: 17, Steps: 89 | Train Loss: 0.976 Vali Loss: 1.261 Vali Acc: 0.825 Test Loss: 1.261 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.069012641906738
Epoch: 18, Steps: 89 | Train Loss: 0.838 Vali Loss: 0.643 Vali Acc: 0.881 Test Loss: 0.643 Test Acc: 0.881
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9616991643454039
model parameter : 5023788
model size : 24.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.010056734085083
Epoch: 1, Steps: 89 | Train Loss: 1.762 Vali Loss: 0.698 Vali Acc: 0.797 Test Loss: 0.698 Test Acc: 0.797
Validation loss decreased (inf --> -0.797347).  Saving model ...
Epoch: 2 cost time: 5.2284770011901855
Epoch: 2, Steps: 89 | Train Loss: 0.533 Vali Loss: 0.679 Vali Acc: 0.840 Test Loss: 0.679 Test Acc: 0.840
Validation loss decreased (-0.797347 --> -0.839826).  Saving model ...
Epoch: 3 cost time: 4.916977167129517
Epoch: 3, Steps: 89 | Train Loss: 0.339 Vali Loss: 0.354 Vali Acc: 0.903 Test Loss: 0.354 Test Acc: 0.903
Validation loss decreased (-0.839826 --> -0.902503).  Saving model ...
Epoch: 4 cost time: 4.951321125030518
Epoch: 4, Steps: 89 | Train Loss: 0.248 Vali Loss: 0.373 Vali Acc: 0.923 Test Loss: 0.373 Test Acc: 0.923
Validation loss decreased (-0.902503 --> -0.922698).  Saving model ...
Epoch: 5 cost time: 5.550661087036133
Epoch: 5, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.402 Vali Acc: 0.925 Test Loss: 0.402 Test Acc: 0.925
Validation loss decreased (-0.922698 --> -0.925483).  Saving model ...
Epoch: 6 cost time: 5.325825929641724
Epoch: 6, Steps: 89 | Train Loss: 0.242 Vali Loss: 0.284 Vali Acc: 0.944 Test Loss: 0.284 Test Acc: 0.944
Validation loss decreased (-0.925483 --> -0.944287).  Saving model ...
Epoch: 7 cost time: 4.732604026794434
Epoch: 7, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.944287 --> -0.957519).  Saving model ...
Epoch: 8 cost time: 5.577804803848267
Epoch: 8, Steps: 89 | Train Loss: 0.251 Vali Loss: 0.543 Vali Acc: 0.915 Test Loss: 0.543 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.437414169311523
Epoch: 9, Steps: 89 | Train Loss: 0.319 Vali Loss: 0.738 Vali Acc: 0.891 Test Loss: 0.738 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.386924743652344
Epoch: 10, Steps: 89 | Train Loss: 0.293 Vali Loss: 0.449 Vali Acc: 0.932 Test Loss: 0.449 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.616865873336792
Epoch: 11, Steps: 89 | Train Loss: 0.245 Vali Loss: 0.561 Vali Acc: 0.925 Test Loss: 0.561 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.381099224090576
Epoch: 12, Steps: 89 | Train Loss: 0.296 Vali Loss: 0.876 Vali Acc: 0.890 Test Loss: 0.876 Test Acc: 0.890
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.426748514175415
Epoch: 13, Steps: 89 | Train Loss: 0.293 Vali Loss: 0.451 Vali Acc: 0.939 Test Loss: 0.451 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.355087757110596
Epoch: 14, Steps: 89 | Train Loss: 0.270 Vali Loss: 0.787 Vali Acc: 0.923 Test Loss: 0.787 Test Acc: 0.923
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.220719814300537
Epoch: 15, Steps: 89 | Train Loss: 0.373 Vali Loss: 0.501 Vali Acc: 0.932 Test Loss: 0.501 Test Acc: 0.932
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.102376699447632
Epoch: 16, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.315 Vali Acc: 0.958 Test Loss: 0.315 Test Acc: 0.958
Validation loss decreased (-0.957519 --> -0.958214).  Saving model ...
Epoch: 17 cost time: 4.830618381500244
Epoch: 17, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.431 Vali Acc: 0.946 Test Loss: 0.431 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.68009614944458
Epoch: 18, Steps: 89 | Train Loss: 0.213 Vali Loss: 0.617 Vali Acc: 0.913 Test Loss: 0.617 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.042603492736816
Epoch: 19, Steps: 89 | Train Loss: 0.228 Vali Loss: 0.355 Vali Acc: 0.945 Test Loss: 0.355 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.5779805183410645
Epoch: 20, Steps: 89 | Train Loss: 0.250 Vali Loss: 0.335 Vali Acc: 0.949 Test Loss: 0.335 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.909047842025757
Epoch: 21, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.326 Vali Acc: 0.950 Test Loss: 0.326 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.673472166061401
Epoch: 22, Steps: 89 | Train Loss: 0.236 Vali Loss: 0.459 Vali Acc: 0.934 Test Loss: 0.459 Test Acc: 0.934
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.7847113609313965
Epoch: 23, Steps: 89 | Train Loss: 0.328 Vali Loss: 0.541 Vali Acc: 0.923 Test Loss: 0.541 Test Acc: 0.923
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.8864171504974365
Epoch: 24, Steps: 89 | Train Loss: 0.439 Vali Loss: 1.079 Vali Acc: 0.834 Test Loss: 1.079 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.031759977340698
Epoch: 25, Steps: 89 | Train Loss: 0.414 Vali Loss: 0.481 Vali Acc: 0.903 Test Loss: 0.481 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.915533781051636
Epoch: 26, Steps: 89 | Train Loss: 0.384 Vali Loss: 0.506 Vali Acc: 0.928 Test Loss: 0.506 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.958217270194986
model parameter : 5019692
model size : 24.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.109033823013306
Epoch: 1, Steps: 89 | Train Loss: 1.914 Vali Loss: 0.899 Vali Acc: 0.735 Test Loss: 0.899 Test Acc: 0.735
Validation loss decreased (inf --> -0.735367).  Saving model ...
Epoch: 2 cost time: 5.092838525772095
Epoch: 2, Steps: 89 | Train Loss: 0.555 Vali Loss: 0.332 Vali Acc: 0.904 Test Loss: 0.332 Test Acc: 0.904
Validation loss decreased (-0.735367 --> -0.903896).  Saving model ...
Epoch: 3 cost time: 5.2461278438568115
Epoch: 3, Steps: 89 | Train Loss: 0.368 Vali Loss: 0.334 Vali Acc: 0.902 Test Loss: 0.334 Test Acc: 0.902
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.316215991973877
Epoch: 4, Steps: 89 | Train Loss: 0.342 Vali Loss: 0.341 Vali Acc: 0.913 Test Loss: 0.341 Test Acc: 0.913
Validation loss decreased (-0.903896 --> -0.912949).  Saving model ...
Epoch: 5 cost time: 5.573291063308716
Epoch: 5, Steps: 89 | Train Loss: 0.297 Vali Loss: 0.229 Vali Acc: 0.948 Test Loss: 0.229 Test Acc: 0.948
Validation loss decreased (-0.912949 --> -0.948466).  Saving model ...
Epoch: 6 cost time: 5.626832485198975
Epoch: 6, Steps: 89 | Train Loss: 0.256 Vali Loss: 0.286 Vali Acc: 0.947 Test Loss: 0.286 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.517493963241577
Epoch: 7, Steps: 89 | Train Loss: 0.308 Vali Loss: 0.339 Vali Acc: 0.949 Test Loss: 0.339 Test Acc: 0.949
Validation loss decreased (-0.948466 --> -0.949161).  Saving model ...
Epoch: 8 cost time: 5.523737668991089
Epoch: 8, Steps: 89 | Train Loss: 0.241 Vali Loss: 0.465 Vali Acc: 0.923 Test Loss: 0.465 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.931010723114014
Epoch: 9, Steps: 89 | Train Loss: 0.240 Vali Loss: 0.509 Vali Acc: 0.909 Test Loss: 0.509 Test Acc: 0.909
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.922068357467651
Epoch: 10, Steps: 89 | Train Loss: 0.227 Vali Loss: 0.432 Vali Acc: 0.936 Test Loss: 0.432 Test Acc: 0.936
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.151306629180908
Epoch: 11, Steps: 89 | Train Loss: 0.221 Vali Loss: 0.441 Vali Acc: 0.928 Test Loss: 0.441 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.893481492996216
Epoch: 12, Steps: 89 | Train Loss: 0.264 Vali Loss: 0.410 Vali Acc: 0.936 Test Loss: 0.410 Test Acc: 0.936
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.659490346908569
Epoch: 13, Steps: 89 | Train Loss: 0.206 Vali Loss: 0.247 Vali Acc: 0.960 Test Loss: 0.247 Test Acc: 0.960
Validation loss decreased (-0.949161 --> -0.960304).  Saving model ...
Epoch: 14 cost time: 5.339504241943359
Epoch: 14, Steps: 89 | Train Loss: 0.257 Vali Loss: 0.287 Vali Acc: 0.952 Test Loss: 0.287 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.82959508895874
Epoch: 15, Steps: 89 | Train Loss: 0.228 Vali Loss: 0.360 Vali Acc: 0.958 Test Loss: 0.360 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.433000564575195
Epoch: 16, Steps: 89 | Train Loss: 0.248 Vali Loss: 0.312 Vali Acc: 0.955 Test Loss: 0.312 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.404151439666748
Epoch: 17, Steps: 89 | Train Loss: 0.246 Vali Loss: 0.284 Vali Acc: 0.964 Test Loss: 0.284 Test Acc: 0.964
Validation loss decreased (-0.960304 --> -0.964482).  Saving model ...
Epoch: 18 cost time: 4.9420976638793945
Epoch: 18, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.576 Vali Acc: 0.929 Test Loss: 0.576 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.762202262878418
Epoch: 19, Steps: 89 | Train Loss: 0.307 Vali Loss: 0.371 Vali Acc: 0.947 Test Loss: 0.371 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.600847959518433
Epoch: 20, Steps: 89 | Train Loss: 0.300 Vali Loss: 0.655 Vali Acc: 0.929 Test Loss: 0.655 Test Acc: 0.929
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.619291305541992
Epoch: 21, Steps: 89 | Train Loss: 0.259 Vali Loss: 0.456 Vali Acc: 0.942 Test Loss: 0.456 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.579043626785278
Epoch: 22, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.486 Vali Acc: 0.942 Test Loss: 0.486 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.246969223022461
Epoch: 23, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.549 Vali Acc: 0.934 Test Loss: 0.549 Test Acc: 0.934
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.9651806354522705
Epoch: 24, Steps: 89 | Train Loss: 0.229 Vali Loss: 0.609 Vali Acc: 0.932 Test Loss: 0.609 Test Acc: 0.932
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.414746999740601
Epoch: 25, Steps: 89 | Train Loss: 0.224 Vali Loss: 0.444 Vali Acc: 0.944 Test Loss: 0.444 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.227687835693359
Epoch: 26, Steps: 89 | Train Loss: 0.192 Vali Loss: 0.433 Vali Acc: 0.944 Test Loss: 0.433 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.440046787261963
Epoch: 27, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.600 Vali Acc: 0.930 Test Loss: 0.600 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9644846796657381
model parameter : 5015596
model size : 24.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.938961505889893
Epoch: 1, Steps: 89 | Train Loss: 1.845 Vali Loss: 0.673 Vali Acc: 0.822 Test Loss: 0.673 Test Acc: 0.822
Validation loss decreased (inf --> -0.822417).  Saving model ...
Epoch: 2 cost time: 5.271417140960693
Epoch: 2, Steps: 89 | Train Loss: 0.543 Vali Loss: 0.597 Vali Acc: 0.864 Test Loss: 0.597 Test Acc: 0.864
Validation loss decreased (-0.822417 --> -0.864200).  Saving model ...
Epoch: 3 cost time: 4.984351396560669
Epoch: 3, Steps: 89 | Train Loss: 0.390 Vali Loss: 0.338 Vali Acc: 0.899 Test Loss: 0.338 Test Acc: 0.899
Validation loss decreased (-0.864200 --> -0.899022).  Saving model ...
Epoch: 4 cost time: 5.407519817352295
Epoch: 4, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.899022 --> -0.943591).  Saving model ...
Epoch: 5 cost time: 5.45615029335022
Epoch: 5, Steps: 89 | Train Loss: 0.277 Vali Loss: 0.211 Vali Acc: 0.955 Test Loss: 0.211 Test Acc: 0.955
Validation loss decreased (-0.943591 --> -0.955430).  Saving model ...
Epoch: 6 cost time: 5.428661584854126
Epoch: 6, Steps: 89 | Train Loss: 0.319 Vali Loss: 0.362 Vali Acc: 0.942 Test Loss: 0.362 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.536171197891235
Epoch: 7, Steps: 89 | Train Loss: 0.209 Vali Loss: 0.753 Vali Acc: 0.928 Test Loss: 0.753 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.788621664047241
Epoch: 8, Steps: 89 | Train Loss: 0.294 Vali Loss: 0.301 Vali Acc: 0.942 Test Loss: 0.301 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.848933935165405
Epoch: 9, Steps: 89 | Train Loss: 0.235 Vali Loss: 0.333 Vali Acc: 0.954 Test Loss: 0.333 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.302400350570679
Epoch: 10, Steps: 89 | Train Loss: 0.288 Vali Loss: 0.370 Vali Acc: 0.946 Test Loss: 0.370 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.707926988601685
Epoch: 11, Steps: 89 | Train Loss: 0.236 Vali Loss: 0.331 Vali Acc: 0.955 Test Loss: 0.331 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.736234903335571
Epoch: 12, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.441 Vali Acc: 0.935 Test Loss: 0.441 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.507125616073608
Epoch: 13, Steps: 89 | Train Loss: 0.244 Vali Loss: 0.437 Vali Acc: 0.936 Test Loss: 0.437 Test Acc: 0.936
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.5662314891815186
Epoch: 14, Steps: 89 | Train Loss: 0.254 Vali Loss: 0.514 Vali Acc: 0.933 Test Loss: 0.514 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.564788103103638
Epoch: 15, Steps: 89 | Train Loss: 0.245 Vali Loss: 0.573 Vali Acc: 0.913 Test Loss: 0.573 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9554317548746518
model parameter : 4239916
model size : 21.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.917391300201416
Epoch: 1, Steps: 89 | Train Loss: 1.835 Vali Loss: 0.834 Vali Acc: 0.740 Test Loss: 0.834 Test Acc: 0.740
Validation loss decreased (inf --> -0.740242).  Saving model ...
Epoch: 2 cost time: 5.530059576034546
Epoch: 2, Steps: 89 | Train Loss: 0.546 Vali Loss: 0.550 Vali Acc: 0.842 Test Loss: 0.550 Test Acc: 0.842
Validation loss decreased (-0.740242 --> -0.841917).  Saving model ...
Epoch: 3 cost time: 5.003732919692993
Epoch: 3, Steps: 89 | Train Loss: 0.335 Vali Loss: 0.537 Vali Acc: 0.892 Test Loss: 0.537 Test Acc: 0.892
Validation loss decreased (-0.841917 --> -0.892056).  Saving model ...
Epoch: 4 cost time: 4.977303981781006
Epoch: 4, Steps: 89 | Train Loss: 0.316 Vali Loss: 0.304 Vali Acc: 0.931 Test Loss: 0.304 Test Acc: 0.931
Validation loss decreased (-0.892056 --> -0.931055).  Saving model ...
Epoch: 5 cost time: 4.383995771408081
Epoch: 5, Steps: 89 | Train Loss: 0.293 Vali Loss: 0.283 Vali Acc: 0.935 Test Loss: 0.283 Test Acc: 0.935
Validation loss decreased (-0.931055 --> -0.935234).  Saving model ...
Epoch: 6 cost time: 5.295087099075317
Epoch: 6, Steps: 89 | Train Loss: 0.235 Vali Loss: 0.337 Vali Acc: 0.923 Test Loss: 0.337 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.76649022102356
Epoch: 7, Steps: 89 | Train Loss: 0.243 Vali Loss: 0.355 Vali Acc: 0.937 Test Loss: 0.355 Test Acc: 0.937
Validation loss decreased (-0.935234 --> -0.936626).  Saving model ...
Epoch: 8 cost time: 4.596304178237915
Epoch: 8, Steps: 89 | Train Loss: 0.272 Vali Loss: 0.355 Vali Acc: 0.942 Test Loss: 0.355 Test Acc: 0.942
Validation loss decreased (-0.936626 --> -0.942197).  Saving model ...
Epoch: 9 cost time: 5.180402517318726
Epoch: 9, Steps: 89 | Train Loss: 0.307 Vali Loss: 0.315 Vali Acc: 0.945 Test Loss: 0.315 Test Acc: 0.945
Validation loss decreased (-0.942197 --> -0.944983).  Saving model ...
Epoch: 10 cost time: 4.6791229248046875
Epoch: 10, Steps: 89 | Train Loss: 0.195 Vali Loss: 0.366 Vali Acc: 0.940 Test Loss: 0.366 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.11150598526001
Epoch: 11, Steps: 89 | Train Loss: 0.266 Vali Loss: 0.335 Vali Acc: 0.953 Test Loss: 0.335 Test Acc: 0.953
Validation loss decreased (-0.944983 --> -0.952643).  Saving model ...
Epoch: 12 cost time: 5.803800821304321
Epoch: 12, Steps: 89 | Train Loss: 0.223 Vali Loss: 0.539 Vali Acc: 0.930 Test Loss: 0.539 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.624379396438599
Epoch: 13, Steps: 89 | Train Loss: 0.294 Vali Loss: 0.485 Vali Acc: 0.916 Test Loss: 0.485 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.963096618652344
Epoch: 14, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.387 Vali Acc: 0.944 Test Loss: 0.387 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.599097490310669
Epoch: 15, Steps: 89 | Train Loss: 0.232 Vali Loss: 0.296 Vali Acc: 0.955 Test Loss: 0.296 Test Acc: 0.955
Validation loss decreased (-0.952643 --> -0.955429).  Saving model ...
Epoch: 16 cost time: 5.330531120300293
Epoch: 16, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.644 Vali Acc: 0.911 Test Loss: 0.644 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.145616292953491
Epoch: 17, Steps: 89 | Train Loss: 0.195 Vali Loss: 0.458 Vali Acc: 0.943 Test Loss: 0.458 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.893828630447388
Epoch: 18, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.552 Vali Acc: 0.933 Test Loss: 0.552 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.6793882846832275
Epoch: 19, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.397 Vali Acc: 0.959 Test Loss: 0.397 Test Acc: 0.959
Validation loss decreased (-0.955429 --> -0.958910).  Saving model ...
Epoch: 20 cost time: 4.8863303661346436
Epoch: 20, Steps: 89 | Train Loss: 0.197 Vali Loss: 0.348 Vali Acc: 0.951 Test Loss: 0.348 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.998738527297974
Epoch: 21, Steps: 89 | Train Loss: 0.468 Vali Loss: 0.926 Vali Acc: 0.882 Test Loss: 0.926 Test Acc: 0.882
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.668655872344971
Epoch: 22, Steps: 89 | Train Loss: 0.435 Vali Loss: 1.130 Vali Acc: 0.861 Test Loss: 1.130 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.744979619979858
Epoch: 23, Steps: 89 | Train Loss: 0.671 Vali Loss: 0.482 Vali Acc: 0.941 Test Loss: 0.482 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.288564920425415
Epoch: 24, Steps: 89 | Train Loss: 0.568 Vali Loss: 0.526 Vali Acc: 0.923 Test Loss: 0.526 Test Acc: 0.923
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.734412908554077
Epoch: 25, Steps: 89 | Train Loss: 0.515 Vali Loss: 0.534 Vali Acc: 0.925 Test Loss: 0.534 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.512359142303467
Epoch: 26, Steps: 89 | Train Loss: 0.551 Vali Loss: 0.649 Vali Acc: 0.886 Test Loss: 0.649 Test Acc: 0.886
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.480160474777222
Epoch: 27, Steps: 89 | Train Loss: 0.383 Vali Loss: 0.672 Vali Acc: 0.915 Test Loss: 0.672 Test Acc: 0.915
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 6.547035217285156
Epoch: 28, Steps: 89 | Train Loss: 0.396 Vali Loss: 0.448 Vali Acc: 0.932 Test Loss: 0.448 Test Acc: 0.932
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 6.0768139362335205
Epoch: 29, Steps: 89 | Train Loss: 0.315 Vali Loss: 0.311 Vali Acc: 0.948 Test Loss: 0.311 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9589136490250696
model parameter : 4235820
model size : 21.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.8403685092926025
Epoch: 1, Steps: 89 | Train Loss: 1.862 Vali Loss: 0.721 Vali Acc: 0.804 Test Loss: 0.721 Test Acc: 0.804
Validation loss decreased (inf --> -0.803614).  Saving model ...
Epoch: 2 cost time: 6.240865230560303
Epoch: 2, Steps: 89 | Train Loss: 0.516 Vali Loss: 0.260 Vali Acc: 0.921 Test Loss: 0.260 Test Acc: 0.921
Validation loss decreased (-0.803614 --> -0.920610).  Saving model ...
Epoch: 3 cost time: 5.760119915008545
Epoch: 3, Steps: 89 | Train Loss: 0.310 Vali Loss: 0.186 Vali Acc: 0.953 Test Loss: 0.186 Test Acc: 0.953
Validation loss decreased (-0.920610 --> -0.952644).  Saving model ...
Epoch: 4 cost time: 4.889127254486084
Epoch: 4, Steps: 89 | Train Loss: 0.220 Vali Loss: 0.363 Vali Acc: 0.919 Test Loss: 0.363 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.217348575592041
Epoch: 5, Steps: 89 | Train Loss: 0.327 Vali Loss: 0.347 Vali Acc: 0.933 Test Loss: 0.347 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.828309774398804
Epoch: 6, Steps: 89 | Train Loss: 0.240 Vali Loss: 0.266 Vali Acc: 0.957 Test Loss: 0.266 Test Acc: 0.957
Validation loss decreased (-0.952644 --> -0.956822).  Saving model ...
Epoch: 7 cost time: 5.624930381774902
Epoch: 7, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.565 Vali Acc: 0.912 Test Loss: 0.565 Test Acc: 0.912
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.0219831466674805
Epoch: 8, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.240 Vali Acc: 0.967 Test Loss: 0.240 Test Acc: 0.967
Validation loss decreased (-0.956822 --> -0.966571).  Saving model ...
Epoch: 9 cost time: 5.3019092082977295
Epoch: 9, Steps: 89 | Train Loss: 0.195 Vali Loss: 0.349 Vali Acc: 0.935 Test Loss: 0.349 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.090440511703491
Epoch: 10, Steps: 89 | Train Loss: 0.337 Vali Loss: 0.275 Vali Acc: 0.953 Test Loss: 0.275 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.084011554718018
Epoch: 11, Steps: 89 | Train Loss: 0.312 Vali Loss: 0.367 Vali Acc: 0.949 Test Loss: 0.367 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.857973337173462
Epoch: 12, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.893 Vali Acc: 0.898 Test Loss: 0.893 Test Acc: 0.898
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.2844154834747314
Epoch: 13, Steps: 89 | Train Loss: 0.339 Vali Loss: 1.165 Vali Acc: 0.782 Test Loss: 1.165 Test Acc: 0.782
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.6967453956604
Epoch: 14, Steps: 89 | Train Loss: 0.304 Vali Loss: 0.380 Vali Acc: 0.948 Test Loss: 0.380 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.2316365242004395
Epoch: 15, Steps: 89 | Train Loss: 0.270 Vali Loss: 0.474 Vali Acc: 0.936 Test Loss: 0.474 Test Acc: 0.936
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.3120505809783936
Epoch: 16, Steps: 89 | Train Loss: 0.315 Vali Loss: 0.537 Vali Acc: 0.930 Test Loss: 0.537 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.260072708129883
Epoch: 17, Steps: 89 | Train Loss: 0.320 Vali Loss: 0.753 Vali Acc: 0.896 Test Loss: 0.753 Test Acc: 0.896
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.448574542999268
Epoch: 18, Steps: 89 | Train Loss: 0.347 Vali Loss: 0.393 Vali Acc: 0.949 Test Loss: 0.393 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9665738161559888
model parameter : 4231724
model size : 21.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.520066499710083
Epoch: 1, Steps: 89 | Train Loss: 1.763 Vali Loss: 0.817 Vali Acc: 0.774 Test Loss: 0.817 Test Acc: 0.774
Validation loss decreased (inf --> -0.774365).  Saving model ...
Epoch: 2 cost time: 4.705022811889648
Epoch: 2, Steps: 89 | Train Loss: 0.517 Vali Loss: 0.270 Vali Acc: 0.921 Test Loss: 0.270 Test Acc: 0.921
Validation loss decreased (-0.774365 --> -0.920610).  Saving model ...
Epoch: 3 cost time: 4.9447596073150635
Epoch: 3, Steps: 89 | Train Loss: 0.311 Vali Loss: 0.274 Vali Acc: 0.927 Test Loss: 0.274 Test Acc: 0.927
Validation loss decreased (-0.920610 --> -0.926877).  Saving model ...
Epoch: 4 cost time: 4.8209850788116455
Epoch: 4, Steps: 89 | Train Loss: 0.296 Vali Loss: 0.416 Vali Acc: 0.896 Test Loss: 0.416 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.982860088348389
Epoch: 5, Steps: 89 | Train Loss: 0.274 Vali Loss: 0.560 Vali Acc: 0.885 Test Loss: 0.560 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.04572606086731
Epoch: 6, Steps: 89 | Train Loss: 0.228 Vali Loss: 0.578 Vali Acc: 0.905 Test Loss: 0.578 Test Acc: 0.905
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.010456085205078
Epoch: 7, Steps: 89 | Train Loss: 0.262 Vali Loss: 0.300 Vali Acc: 0.941 Test Loss: 0.300 Test Acc: 0.941
Validation loss decreased (-0.926877 --> -0.940805).  Saving model ...
Epoch: 8 cost time: 5.295818090438843
Epoch: 8, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.251 Vali Acc: 0.962 Test Loss: 0.251 Test Acc: 0.962
Validation loss decreased (-0.940805 --> -0.961697).  Saving model ...
Epoch: 9 cost time: 4.9750988483428955
Epoch: 9, Steps: 89 | Train Loss: 0.283 Vali Loss: 0.765 Vali Acc: 0.923 Test Loss: 0.765 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.87404465675354
Epoch: 10, Steps: 89 | Train Loss: 0.243 Vali Loss: 0.445 Vali Acc: 0.914 Test Loss: 0.445 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.248479843139648
Epoch: 11, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.279 Vali Acc: 0.946 Test Loss: 0.279 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.732423305511475
Epoch: 12, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.338 Vali Acc: 0.948 Test Loss: 0.338 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.2848896980285645
Epoch: 13, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.339 Vali Acc: 0.950 Test Loss: 0.339 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.11831521987915
Epoch: 14, Steps: 89 | Train Loss: 0.268 Vali Loss: 0.540 Vali Acc: 0.944 Test Loss: 0.540 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.460791110992432
Epoch: 15, Steps: 89 | Train Loss: 0.255 Vali Loss: 0.532 Vali Acc: 0.934 Test Loss: 0.532 Test Acc: 0.934
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.1066224575042725
Epoch: 16, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.332 Vali Acc: 0.956 Test Loss: 0.332 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.42887806892395
Epoch: 17, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.292 Vali Acc: 0.964 Test Loss: 0.292 Test Acc: 0.964
Validation loss decreased (-0.961697 --> -0.964482).  Saving model ...
Epoch: 18 cost time: 4.770421028137207
Epoch: 18, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.678 Vali Acc: 0.931 Test Loss: 0.678 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.178543567657471
Epoch: 19, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.549 Vali Acc: 0.932 Test Loss: 0.549 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.813529968261719
Epoch: 20, Steps: 89 | Train Loss: 0.226 Vali Loss: 0.491 Vali Acc: 0.932 Test Loss: 0.491 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.240374565124512
Epoch: 21, Steps: 89 | Train Loss: 0.245 Vali Loss: 0.461 Vali Acc: 0.949 Test Loss: 0.461 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.887907981872559
Epoch: 22, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.259 Vali Acc: 0.967 Test Loss: 0.259 Test Acc: 0.967
Validation loss decreased (-0.964482 --> -0.966571).  Saving model ...
Epoch: 23 cost time: 4.930830955505371
Epoch: 23, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.352 Vali Acc: 0.955 Test Loss: 0.352 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.551353216171265
Epoch: 24, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.417 Vali Acc: 0.956 Test Loss: 0.417 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.055775880813599
Epoch: 25, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.322 Vali Acc: 0.964 Test Loss: 0.322 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.364582538604736
Epoch: 26, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.328 Vali Acc: 0.961 Test Loss: 0.328 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 5.534396648406982
Epoch: 27, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.273 Vali Acc: 0.966 Test Loss: 0.273 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.93248724937439
Epoch: 28, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.376 Vali Acc: 0.955 Test Loss: 0.376 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 5.055206537246704
Epoch: 29, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.356 Vali Acc: 0.955 Test Loss: 0.356 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 4.79868483543396
Epoch: 30, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.433 Vali Acc: 0.959 Test Loss: 0.433 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 4.6497414112091064
Epoch: 31, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.277 Vali Acc: 0.969 Test Loss: 0.277 Test Acc: 0.969
Validation loss decreased (-0.966571 --> -0.968660).  Saving model ...
Epoch: 32 cost time: 4.966655015945435
Epoch: 32, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.269 Vali Acc: 0.968 Test Loss: 0.269 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 4.9862072467803955
Epoch: 33, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.249 Vali Acc: 0.969 Test Loss: 0.249 Test Acc: 0.969
Validation loss decreased (-0.968660 --> -0.969357).  Saving model ...
Epoch: 34 cost time: 5.239018201828003
Epoch: 34, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.423 Vali Acc: 0.958 Test Loss: 0.423 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 4.513678073883057
Epoch: 35, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.466 Vali Acc: 0.939 Test Loss: 0.466 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 4.883881568908691
Epoch: 36, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.729 Vali Acc: 0.928 Test Loss: 0.729 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 4.552608013153076
Epoch: 37, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.373 Vali Acc: 0.965 Test Loss: 0.373 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 4.785335302352905
Epoch: 38, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.497 Vali Acc: 0.943 Test Loss: 0.497 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 4.503434896469116
Epoch: 39, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.367 Vali Acc: 0.950 Test Loss: 0.367 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 5.068269491195679
Epoch: 40, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.326 Vali Acc: 0.967 Test Loss: 0.326 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 4.588335990905762
Epoch: 41, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.351 Vali Acc: 0.960 Test Loss: 0.351 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 4.479116678237915
Epoch: 42, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.253 Vali Acc: 0.967 Test Loss: 0.253 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 4.985942840576172
Epoch: 43, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.301 Vali Acc: 0.967 Test Loss: 0.301 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9693593314763231
model parameter : 4227628
model size : 21.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.830964088439941
Epoch: 1, Steps: 89 | Train Loss: 1.761 Vali Loss: 0.704 Vali Acc: 0.800 Test Loss: 0.704 Test Acc: 0.800
Validation loss decreased (inf --> -0.800132).  Saving model ...
Epoch: 2 cost time: 5.905059099197388
Epoch: 2, Steps: 89 | Train Loss: 0.522 Vali Loss: 0.473 Vali Acc: 0.865 Test Loss: 0.473 Test Acc: 0.865
Validation loss decreased (-0.800132 --> -0.864898).  Saving model ...
Epoch: 3 cost time: 5.102875471115112
Epoch: 3, Steps: 89 | Train Loss: 0.324 Vali Loss: 0.341 Vali Acc: 0.912 Test Loss: 0.341 Test Acc: 0.912
Validation loss decreased (-0.864898 --> -0.912253).  Saving model ...
Epoch: 4 cost time: 5.8221213817596436
Epoch: 4, Steps: 89 | Train Loss: 0.232 Vali Loss: 0.466 Vali Acc: 0.907 Test Loss: 0.466 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.175583600997925
Epoch: 5, Steps: 89 | Train Loss: 0.281 Vali Loss: 0.232 Vali Acc: 0.951 Test Loss: 0.232 Test Acc: 0.951
Validation loss decreased (-0.912253 --> -0.950555).  Saving model ...
Epoch: 6 cost time: 4.649577856063843
Epoch: 6, Steps: 89 | Train Loss: 0.236 Vali Loss: 0.306 Vali Acc: 0.942 Test Loss: 0.306 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.360305547714233
Epoch: 7, Steps: 89 | Train Loss: 0.228 Vali Loss: 0.369 Vali Acc: 0.927 Test Loss: 0.369 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.004718780517578
Epoch: 8, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.248 Vali Acc: 0.958 Test Loss: 0.248 Test Acc: 0.958
Validation loss decreased (-0.950555 --> -0.958215).  Saving model ...
Epoch: 9 cost time: 5.045180559158325
Epoch: 9, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.248 Vali Acc: 0.952 Test Loss: 0.248 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.210474491119385
Epoch: 10, Steps: 89 | Train Loss: 0.223 Vali Loss: 0.188 Vali Acc: 0.968 Test Loss: 0.188 Test Acc: 0.968
Validation loss decreased (-0.958215 --> -0.967965).  Saving model ...
Epoch: 11 cost time: 5.131215333938599
Epoch: 11, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.631 Vali Acc: 0.931 Test Loss: 0.631 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.4546332359313965
Epoch: 12, Steps: 89 | Train Loss: 0.225 Vali Loss: 0.298 Vali Acc: 0.959 Test Loss: 0.298 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.23912501335144
Epoch: 13, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.352 Vali Acc: 0.959 Test Loss: 0.352 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.923166990280151
Epoch: 14, Steps: 89 | Train Loss: 0.256 Vali Loss: 0.351 Vali Acc: 0.944 Test Loss: 0.351 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.149528980255127
Epoch: 15, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.336 Vali Acc: 0.951 Test Loss: 0.336 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.534172773361206
Epoch: 16, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.274 Vali Acc: 0.958 Test Loss: 0.274 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.468237400054932
Epoch: 17, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.485 Vali Acc: 0.939 Test Loss: 0.485 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.101858377456665
Epoch: 18, Steps: 89 | Train Loss: 0.354 Vali Loss: 0.618 Vali Acc: 0.928 Test Loss: 0.618 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.8048248291015625
Epoch: 19, Steps: 89 | Train Loss: 0.727 Vali Loss: 0.795 Vali Acc: 0.884 Test Loss: 0.795 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.6595141887664795
Epoch: 20, Steps: 89 | Train Loss: 0.798 Vali Loss: 0.792 Vali Acc: 0.910 Test Loss: 0.792 Test Acc: 0.910
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.967966573816156
model parameter : 3845932
model size : 19.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.757565498352051
Epoch: 1, Steps: 89 | Train Loss: 1.810 Vali Loss: 0.729 Vali Acc: 0.795 Test Loss: 0.729 Test Acc: 0.795
Validation loss decreased (inf --> -0.794561).  Saving model ...
Epoch: 2 cost time: 4.673159837722778
Epoch: 2, Steps: 89 | Train Loss: 0.510 Vali Loss: 0.299 Vali Acc: 0.916 Test Loss: 0.299 Test Acc: 0.916
Validation loss decreased (-0.794561 --> -0.916432).  Saving model ...
Epoch: 3 cost time: 4.729699373245239
Epoch: 3, Steps: 89 | Train Loss: 0.353 Vali Loss: 0.420 Vali Acc: 0.900 Test Loss: 0.420 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.798790216445923
Epoch: 4, Steps: 89 | Train Loss: 0.281 Vali Loss: 0.299 Vali Acc: 0.935 Test Loss: 0.299 Test Acc: 0.935
Validation loss decreased (-0.916432 --> -0.935234).  Saving model ...
Epoch: 5 cost time: 4.913026571273804
Epoch: 5, Steps: 89 | Train Loss: 0.264 Vali Loss: 0.413 Vali Acc: 0.909 Test Loss: 0.413 Test Acc: 0.909
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.460813760757446
Epoch: 6, Steps: 89 | Train Loss: 0.262 Vali Loss: 0.183 Vali Acc: 0.959 Test Loss: 0.183 Test Acc: 0.959
Validation loss decreased (-0.935234 --> -0.958912).  Saving model ...
Epoch: 7 cost time: 4.786916255950928
Epoch: 7, Steps: 89 | Train Loss: 0.195 Vali Loss: 0.297 Vali Acc: 0.948 Test Loss: 0.297 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.806978940963745
Epoch: 8, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.304 Vali Acc: 0.951 Test Loss: 0.304 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.122265577316284
Epoch: 9, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.226 Vali Acc: 0.955 Test Loss: 0.226 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.5855114459991455
Epoch: 10, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.317 Vali Acc: 0.955 Test Loss: 0.317 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.547791242599487
Epoch: 11, Steps: 89 | Train Loss: 0.314 Vali Loss: 0.469 Vali Acc: 0.924 Test Loss: 0.469 Test Acc: 0.924
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.619937896728516
Epoch: 12, Steps: 89 | Train Loss: 0.260 Vali Loss: 0.499 Vali Acc: 0.933 Test Loss: 0.499 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.189383506774902
Epoch: 13, Steps: 89 | Train Loss: 0.261 Vali Loss: 0.633 Vali Acc: 0.905 Test Loss: 0.633 Test Acc: 0.905
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.695509910583496
Epoch: 14, Steps: 89 | Train Loss: 0.361 Vali Loss: 0.370 Vali Acc: 0.952 Test Loss: 0.370 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.901624441146851
Epoch: 15, Steps: 89 | Train Loss: 0.291 Vali Loss: 0.431 Vali Acc: 0.953 Test Loss: 0.431 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.632574796676636
Epoch: 16, Steps: 89 | Train Loss: 0.219 Vali Loss: 0.320 Vali Acc: 0.967 Test Loss: 0.320 Test Acc: 0.967
Validation loss decreased (-0.958912 --> -0.966571).  Saving model ...
Epoch: 17 cost time: 4.436532497406006
Epoch: 17, Steps: 89 | Train Loss: 0.254 Vali Loss: 0.545 Vali Acc: 0.927 Test Loss: 0.545 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.0282042026519775
Epoch: 18, Steps: 89 | Train Loss: 0.317 Vali Loss: 0.520 Vali Acc: 0.931 Test Loss: 0.520 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.3705525398254395
Epoch: 19, Steps: 89 | Train Loss: 0.461 Vali Loss: 0.613 Vali Acc: 0.901 Test Loss: 0.613 Test Acc: 0.901
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.99012017250061
Epoch: 20, Steps: 89 | Train Loss: 0.724 Vali Loss: 0.849 Vali Acc: 0.875 Test Loss: 0.849 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.3716042041778564
Epoch: 21, Steps: 89 | Train Loss: 0.902 Vali Loss: 1.209 Vali Acc: 0.834 Test Loss: 1.209 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.239087104797363
Epoch: 22, Steps: 89 | Train Loss: 0.934 Vali Loss: 1.087 Vali Acc: 0.868 Test Loss: 1.087 Test Acc: 0.868
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.9323554039001465
Epoch: 23, Steps: 89 | Train Loss: 0.830 Vali Loss: 0.805 Vali Acc: 0.864 Test Loss: 0.805 Test Acc: 0.864
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.889381170272827
Epoch: 24, Steps: 89 | Train Loss: 0.802 Vali Loss: 1.000 Vali Acc: 0.844 Test Loss: 1.000 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.900262832641602
Epoch: 25, Steps: 89 | Train Loss: 0.917 Vali Loss: 0.520 Vali Acc: 0.888 Test Loss: 0.520 Test Acc: 0.888
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.633686780929565
Epoch: 26, Steps: 89 | Train Loss: 0.931 Vali Loss: 1.206 Vali Acc: 0.786 Test Loss: 1.206 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9665738161559888
model parameter : 3841836
model size : 19.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.521281719207764
Epoch: 1, Steps: 89 | Train Loss: 1.800 Vali Loss: 0.568 Vali Acc: 0.845 Test Loss: 0.568 Test Acc: 0.845
Validation loss decreased (inf --> -0.845398).  Saving model ...
Epoch: 2 cost time: 6.078333854675293
Epoch: 2, Steps: 89 | Train Loss: 0.484 Vali Loss: 0.358 Vali Acc: 0.892 Test Loss: 0.358 Test Acc: 0.892
Validation loss decreased (-0.845398 --> -0.892058).  Saving model ...
Epoch: 3 cost time: 4.7872514724731445
Epoch: 3, Steps: 89 | Train Loss: 0.386 Vali Loss: 0.287 Vali Acc: 0.932 Test Loss: 0.287 Test Acc: 0.932
Validation loss decreased (-0.892058 --> -0.932448).  Saving model ...
Epoch: 4 cost time: 5.5754523277282715
Epoch: 4, Steps: 89 | Train Loss: 0.287 Vali Loss: 0.315 Vali Acc: 0.932 Test Loss: 0.315 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.8100786209106445
Epoch: 5, Steps: 89 | Train Loss: 0.219 Vali Loss: 0.215 Vali Acc: 0.946 Test Loss: 0.215 Test Acc: 0.946
Validation loss decreased (-0.932448 --> -0.946377).  Saving model ...
Epoch: 6 cost time: 5.2270238399505615
Epoch: 6, Steps: 89 | Train Loss: 0.248 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.946377 --> -0.958215).  Saving model ...
Epoch: 7 cost time: 5.240599632263184
Epoch: 7, Steps: 89 | Train Loss: 0.252 Vali Loss: 0.281 Vali Acc: 0.961 Test Loss: 0.281 Test Acc: 0.961
Validation loss decreased (-0.958215 --> -0.961000).  Saving model ...
Epoch: 8 cost time: 6.091507911682129
Epoch: 8, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.191 Vali Acc: 0.964 Test Loss: 0.191 Test Acc: 0.964
Validation loss decreased (-0.961000 --> -0.964483).  Saving model ...
Epoch: 9 cost time: 4.833568811416626
Epoch: 9, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.451 Vali Acc: 0.925 Test Loss: 0.451 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.1162543296813965
Epoch: 10, Steps: 89 | Train Loss: 0.286 Vali Loss: 0.375 Vali Acc: 0.944 Test Loss: 0.375 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.097975730895996
Epoch: 11, Steps: 89 | Train Loss: 0.226 Vali Loss: 0.466 Vali Acc: 0.939 Test Loss: 0.466 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.875728607177734
Epoch: 12, Steps: 89 | Train Loss: 0.246 Vali Loss: 0.391 Vali Acc: 0.953 Test Loss: 0.391 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.317189455032349
Epoch: 13, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.242 Vali Acc: 0.962 Test Loss: 0.242 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.761341094970703
Epoch: 14, Steps: 89 | Train Loss: 0.249 Vali Loss: 0.427 Vali Acc: 0.941 Test Loss: 0.427 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.15950870513916
Epoch: 15, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.347 Vali Acc: 0.948 Test Loss: 0.347 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.225998640060425
Epoch: 16, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.352 Vali Acc: 0.961 Test Loss: 0.352 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.569483280181885
Epoch: 17, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.402 Vali Acc: 0.958 Test Loss: 0.402 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.207051992416382
Epoch: 18, Steps: 89 | Train Loss: 0.234 Vali Loss: 0.457 Vali Acc: 0.951 Test Loss: 0.457 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9644846796657381
model parameter : 3837740
model size : 19.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.101388692855835
Epoch: 1, Steps: 89 | Train Loss: 1.814 Vali Loss: 0.700 Vali Acc: 0.776 Test Loss: 0.700 Test Acc: 0.776
Validation loss decreased (inf --> -0.776455).  Saving model ...
Epoch: 2 cost time: 6.0301172733306885
Epoch: 2, Steps: 89 | Train Loss: 0.538 Vali Loss: 0.472 Vali Acc: 0.859 Test Loss: 0.472 Test Acc: 0.859
Validation loss decreased (-0.776455 --> -0.859327).  Saving model ...
Epoch: 3 cost time: 4.783175945281982
Epoch: 3, Steps: 89 | Train Loss: 0.289 Vali Loss: 0.376 Vali Acc: 0.890 Test Loss: 0.376 Test Acc: 0.890
Validation loss decreased (-0.859327 --> -0.889968).  Saving model ...
Epoch: 4 cost time: 5.039565801620483
Epoch: 4, Steps: 89 | Train Loss: 0.390 Vali Loss: 0.345 Vali Acc: 0.924 Test Loss: 0.345 Test Acc: 0.924
Validation loss decreased (-0.889968 --> -0.924091).  Saving model ...
Epoch: 5 cost time: 6.072974920272827
Epoch: 5, Steps: 89 | Train Loss: 0.269 Vali Loss: 0.354 Vali Acc: 0.921 Test Loss: 0.354 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.4499831199646
Epoch: 6, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.417 Vali Acc: 0.914 Test Loss: 0.417 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.89687705039978
Epoch: 7, Steps: 89 | Train Loss: 0.216 Vali Loss: 0.250 Vali Acc: 0.951 Test Loss: 0.250 Test Acc: 0.951
Validation loss decreased (-0.924091 --> -0.951251).  Saving model ...
Epoch: 8 cost time: 4.372934103012085
Epoch: 8, Steps: 89 | Train Loss: 0.205 Vali Loss: 0.188 Vali Acc: 0.964 Test Loss: 0.188 Test Acc: 0.964
Validation loss decreased (-0.951251 --> -0.963786).  Saving model ...
Epoch: 9 cost time: 4.539820432662964
Epoch: 9, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.598462104797363
Epoch: 10, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.494 Vali Acc: 0.928 Test Loss: 0.494 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.2089245319366455
Epoch: 11, Steps: 89 | Train Loss: 0.212 Vali Loss: 0.409 Vali Acc: 0.941 Test Loss: 0.409 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.313141107559204
Epoch: 12, Steps: 89 | Train Loss: 0.306 Vali Loss: 0.619 Vali Acc: 0.918 Test Loss: 0.619 Test Acc: 0.918
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.543206453323364
Epoch: 13, Steps: 89 | Train Loss: 0.308 Vali Loss: 0.407 Vali Acc: 0.949 Test Loss: 0.407 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.066777467727661
Epoch: 14, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.246 Vali Acc: 0.966 Test Loss: 0.246 Test Acc: 0.966
Validation loss decreased (-0.963786 --> -0.965875).  Saving model ...
Epoch: 15 cost time: 5.035580635070801
Epoch: 15, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.461 Vali Acc: 0.953 Test Loss: 0.461 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.747803211212158
Epoch: 16, Steps: 89 | Train Loss: 0.293 Vali Loss: 0.380 Vali Acc: 0.956 Test Loss: 0.380 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.734472274780273
Epoch: 17, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.333 Vali Acc: 0.963 Test Loss: 0.333 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.665948152542114
Epoch: 18, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.419 Vali Acc: 0.949 Test Loss: 0.419 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.392485618591309
Epoch: 19, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.461 Vali Acc: 0.945 Test Loss: 0.461 Test Acc: 0.945
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.933334827423096
Epoch: 20, Steps: 89 | Train Loss: 0.307 Vali Loss: 0.515 Vali Acc: 0.939 Test Loss: 0.515 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.579358816146851
Epoch: 21, Steps: 89 | Train Loss: 0.250 Vali Loss: 0.474 Vali Acc: 0.953 Test Loss: 0.474 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.598090648651123
Epoch: 22, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.358 Vali Acc: 0.962 Test Loss: 0.358 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 7.022367715835571
Epoch: 23, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.362 Vali Acc: 0.964 Test Loss: 0.362 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.320844650268555
Epoch: 24, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.309 Vali Acc: 0.960 Test Loss: 0.309 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9658774373259053
model parameter : 3833644
model size : 19.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.483703851699829
Epoch: 1, Steps: 89 | Train Loss: 1.866 Vali Loss: 0.724 Vali Acc: 0.794 Test Loss: 0.724 Test Acc: 0.794
Validation loss decreased (inf --> -0.793865).  Saving model ...
Epoch: 2 cost time: 4.822087526321411
Epoch: 2, Steps: 89 | Train Loss: 0.512 Vali Loss: 0.301 Vali Acc: 0.920 Test Loss: 0.301 Test Acc: 0.920
Validation loss decreased (-0.793865 --> -0.919913).  Saving model ...
Epoch: 3 cost time: 4.407603979110718
Epoch: 3, Steps: 89 | Train Loss: 0.298 Vali Loss: 0.317 Vali Acc: 0.911 Test Loss: 0.317 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.483607053756714
Epoch: 4, Steps: 89 | Train Loss: 0.303 Vali Loss: 0.321 Vali Acc: 0.924 Test Loss: 0.321 Test Acc: 0.924
Validation loss decreased (-0.919913 --> -0.924091).  Saving model ...
Epoch: 5 cost time: 4.56008768081665
Epoch: 5, Steps: 89 | Train Loss: 0.221 Vali Loss: 0.273 Vali Acc: 0.937 Test Loss: 0.273 Test Acc: 0.937
Validation loss decreased (-0.924091 --> -0.936627).  Saving model ...
Epoch: 6 cost time: 4.533503532409668
Epoch: 6, Steps: 89 | Train Loss: 0.235 Vali Loss: 0.297 Vali Acc: 0.943 Test Loss: 0.297 Test Acc: 0.943
Validation loss decreased (-0.936627 --> -0.942894).  Saving model ...
Epoch: 7 cost time: 4.580174446105957
Epoch: 7, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.290 Vali Acc: 0.947 Test Loss: 0.290 Test Acc: 0.947
Validation loss decreased (-0.942894 --> -0.947072).  Saving model ...
Epoch: 8 cost time: 5.400559663772583
Epoch: 8, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.822 Vali Acc: 0.886 Test Loss: 0.822 Test Acc: 0.886
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.16312050819397
Epoch: 9, Steps: 89 | Train Loss: 0.353 Vali Loss: 0.295 Vali Acc: 0.942 Test Loss: 0.295 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.386826753616333
Epoch: 10, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.385 Vali Acc: 0.937 Test Loss: 0.385 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.002673149108887
Epoch: 11, Steps: 89 | Train Loss: 0.292 Vali Loss: 0.404 Vali Acc: 0.937 Test Loss: 0.404 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.2546350955963135
Epoch: 12, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.366 Vali Acc: 0.959 Test Loss: 0.366 Test Acc: 0.959
Validation loss decreased (-0.947072 --> -0.958910).  Saving model ...
Epoch: 13 cost time: 5.106885671615601
Epoch: 13, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.182 Vali Acc: 0.969 Test Loss: 0.182 Test Acc: 0.969
Validation loss decreased (-0.958910 --> -0.968661).  Saving model ...
Epoch: 14 cost time: 5.180694341659546
Epoch: 14, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.294 Vali Acc: 0.955 Test Loss: 0.294 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.089244365692139
Epoch: 15, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.390 Vali Acc: 0.950 Test Loss: 0.390 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.071017026901245
Epoch: 16, Steps: 89 | Train Loss: 0.228 Vali Loss: 0.429 Vali Acc: 0.948 Test Loss: 0.429 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.495241165161133
Epoch: 17, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.348 Vali Acc: 0.947 Test Loss: 0.348 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.763396978378296
Epoch: 18, Steps: 89 | Train Loss: 0.386 Vali Loss: 0.681 Vali Acc: 0.896 Test Loss: 0.681 Test Acc: 0.896
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.323985815048218
Epoch: 19, Steps: 89 | Train Loss: 0.570 Vali Loss: 0.425 Vali Acc: 0.919 Test Loss: 0.425 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.3197221755981445
Epoch: 20, Steps: 89 | Train Loss: 0.897 Vali Loss: 1.621 Vali Acc: 0.791 Test Loss: 1.621 Test Acc: 0.791
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.206202507019043
Epoch: 21, Steps: 89 | Train Loss: 0.638 Vali Loss: 0.793 Vali Acc: 0.889 Test Loss: 0.793 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 5.185449123382568
Epoch: 22, Steps: 89 | Train Loss: 1.636 Vali Loss: 1.202 Vali Acc: 0.852 Test Loss: 1.202 Test Acc: 0.852
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 5.001968860626221
Epoch: 23, Steps: 89 | Train Loss: 1.284 Vali Loss: 0.864 Vali Acc: 0.863 Test Loss: 0.864 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9686629526462396
model parameter : 3648940
model size : 18.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.771585702896118
Epoch: 1, Steps: 89 | Train Loss: 1.835 Vali Loss: 0.743 Vali Acc: 0.788 Test Loss: 0.743 Test Acc: 0.788
Validation loss decreased (inf --> -0.787597).  Saving model ...
Epoch: 2 cost time: 6.1899254322052
Epoch: 2, Steps: 89 | Train Loss: 0.560 Vali Loss: 0.367 Vali Acc: 0.907 Test Loss: 0.367 Test Acc: 0.907
Validation loss decreased (-0.787597 --> -0.906682).  Saving model ...
Epoch: 3 cost time: 5.739673852920532
Epoch: 3, Steps: 89 | Train Loss: 0.289 Vali Loss: 0.492 Vali Acc: 0.894 Test Loss: 0.492 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.897142648696899
Epoch: 4, Steps: 89 | Train Loss: 0.286 Vali Loss: 0.257 Vali Acc: 0.941 Test Loss: 0.257 Test Acc: 0.941
Validation loss decreased (-0.906682 --> -0.940805).  Saving model ...
Epoch: 5 cost time: 4.82447075843811
Epoch: 5, Steps: 89 | Train Loss: 0.206 Vali Loss: 0.321 Vali Acc: 0.932 Test Loss: 0.321 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.009346008300781
Epoch: 6, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.235 Vali Acc: 0.962 Test Loss: 0.235 Test Acc: 0.962
Validation loss decreased (-0.940805 --> -0.961697).  Saving model ...
Epoch: 7 cost time: 5.464480638504028
Epoch: 7, Steps: 89 | Train Loss: 0.209 Vali Loss: 0.302 Vali Acc: 0.952 Test Loss: 0.302 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.091131925582886
Epoch: 8, Steps: 89 | Train Loss: 0.246 Vali Loss: 0.501 Vali Acc: 0.934 Test Loss: 0.501 Test Acc: 0.934
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.339930534362793
Epoch: 9, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.353 Vali Acc: 0.946 Test Loss: 0.353 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.5337817668914795
Epoch: 10, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.369 Vali Acc: 0.952 Test Loss: 0.369 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.131306409835815
Epoch: 11, Steps: 89 | Train Loss: 0.238 Vali Loss: 0.290 Vali Acc: 0.957 Test Loss: 0.290 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.596421241760254
Epoch: 12, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.384 Vali Acc: 0.957 Test Loss: 0.384 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.518073081970215
Epoch: 13, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.574 Vali Acc: 0.925 Test Loss: 0.574 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.444101810455322
Epoch: 14, Steps: 89 | Train Loss: 0.226 Vali Loss: 0.348 Vali Acc: 0.952 Test Loss: 0.348 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 6.101237773895264
Epoch: 15, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.386 Vali Acc: 0.942 Test Loss: 0.386 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 6.147780895233154
Epoch: 16, Steps: 89 | Train Loss: 0.342 Vali Loss: 0.334 Vali Acc: 0.955 Test Loss: 0.334 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9616991643454039
model parameter : 3644844
model size : 18.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.315395355224609
Epoch: 1, Steps: 89 | Train Loss: 1.913 Vali Loss: 0.866 Vali Acc: 0.750 Test Loss: 0.866 Test Acc: 0.750
Validation loss decreased (inf --> -0.749991).  Saving model ...
Epoch: 2 cost time: 5.134877920150757
Epoch: 2, Steps: 89 | Train Loss: 0.531 Vali Loss: 0.371 Vali Acc: 0.888 Test Loss: 0.371 Test Acc: 0.888
Validation loss decreased (-0.749991 --> -0.887879).  Saving model ...
Epoch: 3 cost time: 5.71430230140686
Epoch: 3, Steps: 89 | Train Loss: 0.416 Vali Loss: 0.409 Vali Acc: 0.892 Test Loss: 0.409 Test Acc: 0.892
Validation loss decreased (-0.887879 --> -0.892057).  Saving model ...
Epoch: 4 cost time: 4.9428160190582275
Epoch: 4, Steps: 89 | Train Loss: 0.229 Vali Loss: 0.214 Vali Acc: 0.937 Test Loss: 0.214 Test Acc: 0.937
Validation loss decreased (-0.892057 --> -0.937324).  Saving model ...
Epoch: 5 cost time: 5.256030082702637
Epoch: 5, Steps: 89 | Train Loss: 0.251 Vali Loss: 0.250 Vali Acc: 0.942 Test Loss: 0.250 Test Acc: 0.942
Validation loss decreased (-0.937324 --> -0.942198).  Saving model ...
Epoch: 6 cost time: 4.988009929656982
Epoch: 6, Steps: 89 | Train Loss: 0.277 Vali Loss: 0.291 Vali Acc: 0.943 Test Loss: 0.291 Test Acc: 0.943
Validation loss decreased (-0.942198 --> -0.942894).  Saving model ...
Epoch: 7 cost time: 5.846977710723877
Epoch: 7, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.374 Vali Acc: 0.927 Test Loss: 0.374 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.798542499542236
Epoch: 8, Steps: 89 | Train Loss: 0.244 Vali Loss: 0.226 Vali Acc: 0.962 Test Loss: 0.226 Test Acc: 0.962
Validation loss decreased (-0.942894 --> -0.961697).  Saving model ...
Epoch: 9 cost time: 4.874101877212524
Epoch: 9, Steps: 89 | Train Loss: 0.240 Vali Loss: 0.351 Vali Acc: 0.948 Test Loss: 0.351 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.160079002380371
Epoch: 10, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.564 Vali Acc: 0.914 Test Loss: 0.564 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.515840291976929
Epoch: 11, Steps: 89 | Train Loss: 0.248 Vali Loss: 0.322 Vali Acc: 0.955 Test Loss: 0.322 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.342233419418335
Epoch: 12, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.507 Vali Acc: 0.939 Test Loss: 0.507 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.694175720214844
Epoch: 13, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.871 Vali Acc: 0.923 Test Loss: 0.871 Test Acc: 0.923
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.007878065109253
Epoch: 14, Steps: 89 | Train Loss: 0.392 Vali Loss: 0.884 Vali Acc: 0.893 Test Loss: 0.884 Test Acc: 0.893
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.928242444992065
Epoch: 15, Steps: 89 | Train Loss: 0.216 Vali Loss: 0.255 Vali Acc: 0.956 Test Loss: 0.255 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.14480185508728
Epoch: 16, Steps: 89 | Train Loss: 0.245 Vali Loss: 0.258 Vali Acc: 0.961 Test Loss: 0.258 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.314594745635986
Epoch: 17, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.306 Vali Acc: 0.953 Test Loss: 0.306 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.993441343307495
Epoch: 18, Steps: 89 | Train Loss: 0.239 Vali Loss: 0.441 Vali Acc: 0.941 Test Loss: 0.441 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9616991643454039
model parameter : 3640748
model size : 18.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.108291387557983
Epoch: 1, Steps: 89 | Train Loss: 1.844 Vali Loss: 0.661 Vali Acc: 0.828 Test Loss: 0.661 Test Acc: 0.828
Validation loss decreased (inf --> -0.827988).  Saving model ...
Epoch: 2 cost time: 4.670530080795288
Epoch: 2, Steps: 89 | Train Loss: 0.505 Vali Loss: 0.458 Vali Acc: 0.867 Test Loss: 0.458 Test Acc: 0.867
Validation loss decreased (-0.827988 --> -0.866987).  Saving model ...
Epoch: 3 cost time: 5.127458095550537
Epoch: 3, Steps: 89 | Train Loss: 0.298 Vali Loss: 0.238 Vali Acc: 0.934 Test Loss: 0.238 Test Acc: 0.934
Validation loss decreased (-0.866987 --> -0.933842).  Saving model ...
Epoch: 4 cost time: 5.451753854751587
Epoch: 4, Steps: 89 | Train Loss: 0.255 Vali Loss: 0.260 Vali Acc: 0.946 Test Loss: 0.260 Test Acc: 0.946
Validation loss decreased (-0.933842 --> -0.945680).  Saving model ...
Epoch: 5 cost time: 6.12236213684082
Epoch: 5, Steps: 89 | Train Loss: 0.258 Vali Loss: 0.276 Vali Acc: 0.940 Test Loss: 0.276 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.64617133140564
Epoch: 6, Steps: 89 | Train Loss: 0.223 Vali Loss: 0.324 Vali Acc: 0.944 Test Loss: 0.324 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.887164831161499
Epoch: 7, Steps: 89 | Train Loss: 0.239 Vali Loss: 0.424 Vali Acc: 0.923 Test Loss: 0.424 Test Acc: 0.923
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.605864763259888
Epoch: 8, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.308 Vali Acc: 0.948 Test Loss: 0.308 Test Acc: 0.948
Validation loss decreased (-0.945680 --> -0.947769).  Saving model ...
Epoch: 9 cost time: 5.4861159324646
Epoch: 9, Steps: 89 | Train Loss: 0.299 Vali Loss: 0.513 Vali Acc: 0.920 Test Loss: 0.513 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.758081674575806
Epoch: 10, Steps: 89 | Train Loss: 0.229 Vali Loss: 0.249 Vali Acc: 0.960 Test Loss: 0.249 Test Acc: 0.960
Validation loss decreased (-0.947769 --> -0.960304).  Saving model ...
Epoch: 11 cost time: 5.80979061126709
Epoch: 11, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.431 Vali Acc: 0.925 Test Loss: 0.431 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.148191213607788
Epoch: 12, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.607 Vali Acc: 0.916 Test Loss: 0.607 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.219599962234497
Epoch: 13, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.437 Vali Acc: 0.945 Test Loss: 0.437 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.3388144969940186
Epoch: 14, Steps: 89 | Train Loss: 0.225 Vali Loss: 0.491 Vali Acc: 0.944 Test Loss: 0.491 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.985607862472534
Epoch: 15, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.347 Vali Acc: 0.956 Test Loss: 0.347 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.642775297164917
Epoch: 16, Steps: 89 | Train Loss: 0.209 Vali Loss: 0.604 Vali Acc: 0.921 Test Loss: 0.604 Test Acc: 0.921
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.7648749351501465
Epoch: 17, Steps: 89 | Train Loss: 0.265 Vali Loss: 0.460 Vali Acc: 0.945 Test Loss: 0.460 Test Acc: 0.945
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.226309776306152
Epoch: 18, Steps: 89 | Train Loss: 0.216 Vali Loss: 0.648 Vali Acc: 0.926 Test Loss: 0.648 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.395939111709595
Epoch: 19, Steps: 89 | Train Loss: 0.281 Vali Loss: 1.156 Vali Acc: 0.889 Test Loss: 1.156 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.0009167194366455
Epoch: 20, Steps: 89 | Train Loss: 0.234 Vali Loss: 0.417 Vali Acc: 0.956 Test Loss: 0.417 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9603064066852368
model parameter : 3636652
model size : 18.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.972058296203613
Epoch: 1, Steps: 89 | Train Loss: 2.116 Vali Loss: 0.851 Vali Acc: 0.758 Test Loss: 0.851 Test Acc: 0.758
Validation loss decreased (inf --> -0.757652).  Saving model ...
Epoch: 2 cost time: 4.950838088989258
Epoch: 2, Steps: 89 | Train Loss: 0.505 Vali Loss: 0.421 Vali Acc: 0.868 Test Loss: 0.421 Test Acc: 0.868
Validation loss decreased (-0.757652 --> -0.867684).  Saving model ...
Epoch: 3 cost time: 4.738198518753052
Epoch: 3, Steps: 89 | Train Loss: 0.283 Vali Loss: 0.433 Vali Acc: 0.884 Test Loss: 0.433 Test Acc: 0.884
Validation loss decreased (-0.867684 --> -0.884397).  Saving model ...
Epoch: 4 cost time: 4.971566438674927
Epoch: 4, Steps: 89 | Train Loss: 0.261 Vali Loss: 0.268 Vali Acc: 0.930 Test Loss: 0.268 Test Acc: 0.930
Validation loss decreased (-0.884397 --> -0.929663).  Saving model ...
Epoch: 5 cost time: 4.4730751514434814
Epoch: 5, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.286 Vali Acc: 0.922 Test Loss: 0.286 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.420929431915283
Epoch: 6, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.184 Vali Acc: 0.954 Test Loss: 0.184 Test Acc: 0.954
Validation loss decreased (-0.929663 --> -0.954037).  Saving model ...
Epoch: 7 cost time: 4.342357397079468
Epoch: 7, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.240 Vali Acc: 0.941 Test Loss: 0.240 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.380084037780762
Epoch: 8, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.17985987663269
Epoch: 9, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.161 Vali Acc: 0.960 Test Loss: 0.161 Test Acc: 0.960
Validation loss decreased (-0.954037 --> -0.960305).  Saving model ...
Epoch: 10 cost time: 4.158834457397461
Epoch: 10, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.231 Vali Acc: 0.957 Test Loss: 0.231 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.410523414611816
Epoch: 11, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.195 Vali Acc: 0.955 Test Loss: 0.195 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.072368621826172
Epoch: 12, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.229 Vali Acc: 0.951 Test Loss: 0.229 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.980713605880737
Epoch: 13, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.177 Vali Acc: 0.971 Test Loss: 0.177 Test Acc: 0.971
Validation loss decreased (-0.960305 --> -0.970750).  Saving model ...
Epoch: 14 cost time: 4.63507080078125
Epoch: 14, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.209 Vali Acc: 0.962 Test Loss: 0.209 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.3971967697143555
Epoch: 15, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.271 Vali Acc: 0.953 Test Loss: 0.271 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.311853408813477
Epoch: 16, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.228 Vali Acc: 0.958 Test Loss: 0.228 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.928369522094727
Epoch: 17, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.191 Vali Acc: 0.968 Test Loss: 0.191 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.494582653045654
Epoch: 18, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.293 Vali Acc: 0.952 Test Loss: 0.293 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.844736576080322
Epoch: 19, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.315 Vali Acc: 0.958 Test Loss: 0.315 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.5411155223846436
Epoch: 20, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.243 Vali Acc: 0.966 Test Loss: 0.243 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.318844556808472
Epoch: 21, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.188 Vali Acc: 0.973 Test Loss: 0.188 Test Acc: 0.973
Validation loss decreased (-0.970750 --> -0.972839).  Saving model ...
Epoch: 22 cost time: 5.269321918487549
Epoch: 22, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.410 Vali Acc: 0.947 Test Loss: 0.410 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.868758678436279
Epoch: 23, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.325 Vali Acc: 0.955 Test Loss: 0.325 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.796564817428589
Epoch: 24, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.213 Vali Acc: 0.971 Test Loss: 0.213 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.542088747024536
Epoch: 25, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.325 Vali Acc: 0.958 Test Loss: 0.325 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.818217039108276
Epoch: 26, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.305 Vali Acc: 0.961 Test Loss: 0.305 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.0579376220703125
Epoch: 27, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.217 Vali Acc: 0.969 Test Loss: 0.217 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 4.9128029346466064
Epoch: 28, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.240 Vali Acc: 0.976 Test Loss: 0.240 Test Acc: 0.976
Validation loss decreased (-0.972839 --> -0.976321).  Saving model ...
Epoch: 29 cost time: 4.671875
Epoch: 29, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.268 Vali Acc: 0.961 Test Loss: 0.268 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.0078957080841064
Epoch: 30, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.219 Vali Acc: 0.968 Test Loss: 0.219 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 5.140805959701538
Epoch: 31, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.309 Vali Acc: 0.954 Test Loss: 0.309 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 4.649830341339111
Epoch: 32, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.262 Vali Acc: 0.967 Test Loss: 0.262 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 5.194050550460815
Epoch: 33, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.233 Vali Acc: 0.974 Test Loss: 0.233 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 4.388271808624268
Epoch: 34, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.361 Vali Acc: 0.948 Test Loss: 0.361 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 5.072942733764648
Epoch: 35, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.293 Vali Acc: 0.963 Test Loss: 0.293 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 5.558098554611206
Epoch: 36, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.253 Vali Acc: 0.969 Test Loss: 0.253 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 5.602313756942749
Epoch: 37, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.211 Vali Acc: 0.974 Test Loss: 0.211 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 5.09063458442688
Epoch: 38, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.412 Vali Acc: 0.947 Test Loss: 0.412 Test Acc: 0.947
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 1729068
model size : 9.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.9123265743255615
Epoch: 1, Steps: 89 | Train Loss: 2.125 Vali Loss: 0.790 Vali Acc: 0.780 Test Loss: 0.790 Test Acc: 0.780
Validation loss decreased (inf --> -0.779936).  Saving model ...
Epoch: 2 cost time: 5.454569101333618
Epoch: 2, Steps: 89 | Train Loss: 0.536 Vali Loss: 0.508 Vali Acc: 0.836 Test Loss: 0.508 Test Acc: 0.836
Validation loss decreased (-0.779936 --> -0.836346).  Saving model ...
Epoch: 3 cost time: 5.241745471954346
Epoch: 3, Steps: 89 | Train Loss: 0.315 Vali Loss: 0.222 Vali Acc: 0.936 Test Loss: 0.222 Test Acc: 0.936
Validation loss decreased (-0.836346 --> -0.935931).  Saving model ...
Epoch: 4 cost time: 5.269311904907227
Epoch: 4, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.289 Vali Acc: 0.932 Test Loss: 0.289 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.399327754974365
Epoch: 5, Steps: 89 | Train Loss: 0.205 Vali Loss: 0.229 Vali Acc: 0.938 Test Loss: 0.229 Test Acc: 0.938
Validation loss decreased (-0.935931 --> -0.938020).  Saving model ...
Epoch: 6 cost time: 6.233376502990723
Epoch: 6, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.213 Vali Acc: 0.942 Test Loss: 0.213 Test Acc: 0.942
Validation loss decreased (-0.938020 --> -0.942198).  Saving model ...
Epoch: 7 cost time: 5.224720001220703
Epoch: 7, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
Validation loss decreased (-0.942198 --> -0.951252).  Saving model ...
Epoch: 8 cost time: 6.210172414779663
Epoch: 8, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.194 Vali Acc: 0.959 Test Loss: 0.194 Test Acc: 0.959
Validation loss decreased (-0.951252 --> -0.958912).  Saving model ...
Epoch: 9 cost time: 4.875927448272705
Epoch: 9, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.179 Vali Acc: 0.956 Test Loss: 0.179 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.111165523529053
Epoch: 10, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.155 Vali Acc: 0.964 Test Loss: 0.155 Test Acc: 0.964
Validation loss decreased (-0.958912 --> -0.963787).  Saving model ...
Epoch: 11 cost time: 5.472394227981567
Epoch: 11, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.230 Vali Acc: 0.949 Test Loss: 0.230 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.91012167930603
Epoch: 12, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.211 Vali Acc: 0.954 Test Loss: 0.211 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.980889797210693
Epoch: 13, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.152 Vali Acc: 0.960 Test Loss: 0.152 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.5416131019592285
Epoch: 14, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.350 Vali Acc: 0.946 Test Loss: 0.350 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.934105157852173
Epoch: 15, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.253 Vali Acc: 0.947 Test Loss: 0.253 Test Acc: 0.947
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.99636435508728
Epoch: 16, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.200 Vali Acc: 0.968 Test Loss: 0.200 Test Acc: 0.968
Validation loss decreased (-0.963787 --> -0.967965).  Saving model ...
Epoch: 17 cost time: 5.170140504837036
Epoch: 17, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.272 Vali Acc: 0.946 Test Loss: 0.272 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.872876882553101
Epoch: 18, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.190 Vali Acc: 0.961 Test Loss: 0.190 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.170777082443237
Epoch: 19, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.232 Vali Acc: 0.967 Test Loss: 0.232 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.361877918243408
Epoch: 20, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.168 Vali Acc: 0.973 Test Loss: 0.168 Test Acc: 0.973
Validation loss decreased (-0.967965 --> -0.972840).  Saving model ...
Epoch: 21 cost time: 5.1788170337677
Epoch: 21, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.234 Vali Acc: 0.961 Test Loss: 0.234 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.51064920425415
Epoch: 22, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.421 Vali Acc: 0.951 Test Loss: 0.421 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.983327388763428
Epoch: 23, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.334 Vali Acc: 0.955 Test Loss: 0.334 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.284040212631226
Epoch: 24, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.317 Vali Acc: 0.949 Test Loss: 0.317 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.659825801849365
Epoch: 25, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.470 Vali Acc: 0.939 Test Loss: 0.470 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 5.800280332565308
Epoch: 26, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.274 Vali Acc: 0.958 Test Loss: 0.274 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.769759893417358
Epoch: 27, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.216 Vali Acc: 0.976 Test Loss: 0.216 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.975625).  Saving model ...
Epoch: 28 cost time: 5.6569130420684814
Epoch: 28, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.327 Vali Acc: 0.964 Test Loss: 0.327 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.4269115924835205
Epoch: 29, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.277 Vali Acc: 0.967 Test Loss: 0.277 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 5.991317272186279
Epoch: 30, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.244 Vali Acc: 0.969 Test Loss: 0.244 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 5.417367696762085
Epoch: 31, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.262 Vali Acc: 0.967 Test Loss: 0.262 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 5.443086624145508
Epoch: 32, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.260 Vali Acc: 0.969 Test Loss: 0.260 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 6.317683935165405
Epoch: 33, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.420 Vali Acc: 0.946 Test Loss: 0.420 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 5.1122424602508545
Epoch: 34, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.298 Vali Acc: 0.960 Test Loss: 0.298 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 5.434243440628052
Epoch: 35, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.361 Vali Acc: 0.955 Test Loss: 0.361 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 5.342801809310913
Epoch: 36, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.273 Vali Acc: 0.960 Test Loss: 0.273 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 5.702820301055908
Epoch: 37, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.286 Vali Acc: 0.960 Test Loss: 0.286 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 1727020
model size : 9.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.158570766448975
Epoch: 1, Steps: 89 | Train Loss: 2.128 Vali Loss: 0.754 Vali Acc: 0.802 Test Loss: 0.754 Test Acc: 0.802
Validation loss decreased (inf --> -0.801524).  Saving model ...
Epoch: 2 cost time: 5.502869129180908
Epoch: 2, Steps: 89 | Train Loss: 0.549 Vali Loss: 0.426 Vali Acc: 0.864 Test Loss: 0.426 Test Acc: 0.864
Validation loss decreased (-0.801524 --> -0.864202).  Saving model ...
Epoch: 3 cost time: 6.023965120315552
Epoch: 3, Steps: 89 | Train Loss: 0.322 Vali Loss: 0.266 Vali Acc: 0.923 Test Loss: 0.266 Test Acc: 0.923
Validation loss decreased (-0.864202 --> -0.923396).  Saving model ...
Epoch: 4 cost time: 5.393544435501099
Epoch: 4, Steps: 89 | Train Loss: 0.209 Vali Loss: 0.184 Vali Acc: 0.951 Test Loss: 0.184 Test Acc: 0.951
Validation loss decreased (-0.923396 --> -0.951252).  Saving model ...
Epoch: 5 cost time: 4.899090528488159
Epoch: 5, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.309 Vali Acc: 0.920 Test Loss: 0.309 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.899733781814575
Epoch: 6, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.186 Vali Acc: 0.952 Test Loss: 0.186 Test Acc: 0.952
Validation loss decreased (-0.951252 --> -0.951948).  Saving model ...
Epoch: 7 cost time: 5.260673761367798
Epoch: 7, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.221 Vali Acc: 0.947 Test Loss: 0.221 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.83465576171875
Epoch: 8, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.207 Vali Acc: 0.952 Test Loss: 0.207 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.586099147796631
Epoch: 9, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.176 Vali Acc: 0.960 Test Loss: 0.176 Test Acc: 0.960
Validation loss decreased (-0.951948 --> -0.960305).  Saving model ...
Epoch: 10 cost time: 4.651424169540405
Epoch: 10, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.133 Vali Acc: 0.971 Test Loss: 0.133 Test Acc: 0.971
Validation loss decreased (-0.960305 --> -0.971447).  Saving model ...
Epoch: 11 cost time: 4.374379634857178
Epoch: 11, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.311 Vali Acc: 0.944 Test Loss: 0.311 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.594401121139526
Epoch: 12, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.213 Vali Acc: 0.959 Test Loss: 0.213 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.42830491065979
Epoch: 13, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.303 Vali Acc: 0.953 Test Loss: 0.303 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.9039435386657715
Epoch: 14, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.311 Vali Acc: 0.944 Test Loss: 0.311 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.295283079147339
Epoch: 15, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.304 Vali Acc: 0.952 Test Loss: 0.304 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.16766881942749
Epoch: 16, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.203 Vali Acc: 0.967 Test Loss: 0.203 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.016244173049927
Epoch: 17, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.259 Vali Acc: 0.958 Test Loss: 0.259 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.068673610687256
Epoch: 18, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.239 Vali Acc: 0.957 Test Loss: 0.239 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.784542560577393
Epoch: 19, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.218 Vali Acc: 0.960 Test Loss: 0.218 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.304475545883179
Epoch: 20, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.237 Vali Acc: 0.960 Test Loss: 0.237 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9714484679665738
model parameter : 1724972
model size : 9.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.17757248878479
Epoch: 1, Steps: 89 | Train Loss: 2.137 Vali Loss: 0.807 Vali Acc: 0.783 Test Loss: 0.807 Test Acc: 0.783
Validation loss decreased (inf --> -0.782722).  Saving model ...
Epoch: 2 cost time: 4.682116508483887
Epoch: 2, Steps: 89 | Train Loss: 0.515 Vali Loss: 0.409 Vali Acc: 0.884 Test Loss: 0.409 Test Acc: 0.884
Validation loss decreased (-0.782722 --> -0.884397).  Saving model ...
Epoch: 3 cost time: 4.964850902557373
Epoch: 3, Steps: 89 | Train Loss: 0.267 Vali Loss: 0.230 Vali Acc: 0.941 Test Loss: 0.230 Test Acc: 0.941
Validation loss decreased (-0.884397 --> -0.940806).  Saving model ...
Epoch: 4 cost time: 4.815760850906372
Epoch: 4, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.193 Vali Acc: 0.943 Test Loss: 0.193 Test Acc: 0.943
Validation loss decreased (-0.940806 --> -0.942895).  Saving model ...
Epoch: 5 cost time: 4.677312135696411
Epoch: 5, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
Validation loss decreased (-0.942895 --> -0.951252).  Saving model ...
Epoch: 6 cost time: 4.171489238739014
Epoch: 6, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.951252 --> -0.957519).  Saving model ...
Epoch: 7 cost time: 4.435446262359619
Epoch: 7, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.229 Vali Acc: 0.940 Test Loss: 0.229 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.216200590133667
Epoch: 8, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.201 Vali Acc: 0.951 Test Loss: 0.201 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.686936616897583
Epoch: 9, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.167 Vali Acc: 0.962 Test Loss: 0.167 Test Acc: 0.962
Validation loss decreased (-0.957519 --> -0.962394).  Saving model ...
Epoch: 10 cost time: 4.936360836029053
Epoch: 10, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.236 Vali Acc: 0.940 Test Loss: 0.236 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.582203149795532
Epoch: 11, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.294 Vali Acc: 0.942 Test Loss: 0.294 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.628976821899414
Epoch: 12, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.423 Vali Acc: 0.931 Test Loss: 0.423 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.615208864212036
Epoch: 13, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.220 Vali Acc: 0.959 Test Loss: 0.220 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.469382286071777
Epoch: 14, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.224 Vali Acc: 0.960 Test Loss: 0.224 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.017235040664673
Epoch: 15, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.289 Vali Acc: 0.948 Test Loss: 0.289 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.112589359283447
Epoch: 16, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.262 Vali Acc: 0.960 Test Loss: 0.262 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.492849111557007
Epoch: 17, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.295 Vali Acc: 0.944 Test Loss: 0.295 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.403139352798462
Epoch: 18, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.242 Vali Acc: 0.964 Test Loss: 0.242 Test Acc: 0.964
Validation loss decreased (-0.962394 --> -0.963786).  Saving model ...
Epoch: 19 cost time: 4.098387956619263
Epoch: 19, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.335 Vali Acc: 0.951 Test Loss: 0.335 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.256760358810425
Epoch: 20, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.235 Vali Acc: 0.969 Test Loss: 0.235 Test Acc: 0.969
Validation loss decreased (-0.963786 --> -0.969357).  Saving model ...
Epoch: 21 cost time: 4.1745641231536865
Epoch: 21, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.620 Vali Acc: 0.916 Test Loss: 0.620 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.683365345001221
Epoch: 22, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.360 Vali Acc: 0.953 Test Loss: 0.360 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.918069362640381
Epoch: 23, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.281 Vali Acc: 0.956 Test Loss: 0.281 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.788851261138916
Epoch: 24, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.203 Vali Acc: 0.969 Test Loss: 0.203 Test Acc: 0.969
Validation loss decreased (-0.969357 --> -0.969357).  Saving model ...
Epoch: 25 cost time: 4.6109538078308105
Epoch: 25, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.249 Vali Acc: 0.964 Test Loss: 0.249 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.2567925453186035
Epoch: 26, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.288 Vali Acc: 0.971 Test Loss: 0.288 Test Acc: 0.971
Validation loss decreased (-0.969357 --> -0.970749).  Saving model ...
Epoch: 27 cost time: 4.369626760482788
Epoch: 27, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.285 Vali Acc: 0.962 Test Loss: 0.285 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.013262510299683
Epoch: 28, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.410 Vali Acc: 0.948 Test Loss: 0.410 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.722958087921143
Epoch: 29, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.320 Vali Acc: 0.965 Test Loss: 0.320 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.985528230667114
Epoch: 30, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.332 Vali Acc: 0.947 Test Loss: 0.332 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 4.75537109375
Epoch: 31, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.480 Vali Acc: 0.945 Test Loss: 0.480 Test Acc: 0.945
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.67895770072937
Epoch: 32, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.334 Vali Acc: 0.945 Test Loss: 0.334 Test Acc: 0.945
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 4.2714033126831055
Epoch: 33, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.268 Vali Acc: 0.968 Test Loss: 0.268 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 4.865524768829346
Epoch: 34, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.211 Vali Acc: 0.968 Test Loss: 0.211 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 5.273000478744507
Epoch: 35, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.424 Vali Acc: 0.944 Test Loss: 0.424 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 4.6438188552856445
Epoch: 36, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.326 Vali Acc: 0.958 Test Loss: 0.326 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9707520891364902
model parameter : 1722924
model size : 9.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.3195037841796875
Epoch: 1, Steps: 89 | Train Loss: 2.128 Vali Loss: 0.876 Vali Acc: 0.774 Test Loss: 0.876 Test Acc: 0.774
Validation loss decreased (inf --> -0.774364).  Saving model ...
Epoch: 2 cost time: 4.849905252456665
Epoch: 2, Steps: 89 | Train Loss: 0.523 Vali Loss: 0.349 Vali Acc: 0.900 Test Loss: 0.349 Test Acc: 0.900
Validation loss decreased (-0.774364 --> -0.900414).  Saving model ...
Epoch: 3 cost time: 5.0547521114349365
Epoch: 3, Steps: 89 | Train Loss: 0.306 Vali Loss: 0.281 Vali Acc: 0.919 Test Loss: 0.281 Test Acc: 0.919
Validation loss decreased (-0.900414 --> -0.918521).  Saving model ...
Epoch: 4 cost time: 5.018825531005859
Epoch: 4, Steps: 89 | Train Loss: 0.206 Vali Loss: 0.349 Vali Acc: 0.903 Test Loss: 0.349 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.40720796585083
Epoch: 5, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.233 Vali Acc: 0.937 Test Loss: 0.233 Test Acc: 0.937
Validation loss decreased (-0.918521 --> -0.936627).  Saving model ...
Epoch: 6 cost time: 4.820135593414307
Epoch: 6, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
Validation loss decreased (-0.936627 --> -0.950555).  Saving model ...
Epoch: 7 cost time: 4.615918397903442
Epoch: 7, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
Validation loss decreased (-0.950555 --> -0.966573).  Saving model ...
Epoch: 8 cost time: 5.005710124969482
Epoch: 8, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.681783437728882
Epoch: 9, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.207 Vali Acc: 0.948 Test Loss: 0.207 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.4350292682647705
Epoch: 10, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.199 Vali Acc: 0.966 Test Loss: 0.199 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.311177968978882
Epoch: 11, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.183 Vali Acc: 0.960 Test Loss: 0.183 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.081725358963013
Epoch: 12, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.262 Vali Acc: 0.953 Test Loss: 0.262 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.99258828163147
Epoch: 13, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.229 Vali Acc: 0.960 Test Loss: 0.229 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.6814680099487305
Epoch: 14, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.168 Vali Acc: 0.964 Test Loss: 0.168 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.7552430629730225
Epoch: 15, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.304 Vali Acc: 0.938 Test Loss: 0.304 Test Acc: 0.938
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.455720663070679
Epoch: 16, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.169 Vali Acc: 0.964 Test Loss: 0.169 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.420318841934204
Epoch: 17, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.305 Vali Acc: 0.957 Test Loss: 0.305 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9665738161559888
model parameter : 1334316
model size : 7.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.263222932815552
Epoch: 1, Steps: 89 | Train Loss: 2.177 Vali Loss: 0.880 Vali Acc: 0.763 Test Loss: 0.880 Test Acc: 0.763
Validation loss decreased (inf --> -0.763222).  Saving model ...
Epoch: 2 cost time: 5.454375267028809
Epoch: 2, Steps: 89 | Train Loss: 0.572 Vali Loss: 0.372 Vali Acc: 0.898 Test Loss: 0.372 Test Acc: 0.898
Validation loss decreased (-0.763222 --> -0.897629).  Saving model ...
Epoch: 3 cost time: 5.385512113571167
Epoch: 3, Steps: 89 | Train Loss: 0.300 Vali Loss: 0.303 Vali Acc: 0.908 Test Loss: 0.303 Test Acc: 0.908
Validation loss decreased (-0.897629 --> -0.908075).  Saving model ...
Epoch: 4 cost time: 5.028193235397339
Epoch: 4, Steps: 89 | Train Loss: 0.206 Vali Loss: 0.151 Vali Acc: 0.955 Test Loss: 0.151 Test Acc: 0.955
Validation loss decreased (-0.908075 --> -0.954734).  Saving model ...
Epoch: 5 cost time: 5.048445701599121
Epoch: 5, Steps: 89 | Train Loss: 0.182 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.092516660690308
Epoch: 6, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.251 Vali Acc: 0.925 Test Loss: 0.251 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.241124868392944
Epoch: 7, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.171 Vali Acc: 0.954 Test Loss: 0.171 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.5074403285980225
Epoch: 8, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.318 Vali Acc: 0.937 Test Loss: 0.318 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.305095911026001
Epoch: 9, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.273 Vali Acc: 0.928 Test Loss: 0.273 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.053446054458618
Epoch: 10, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.230 Vali Acc: 0.953 Test Loss: 0.230 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.251036167144775
Epoch: 11, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.954734 --> -0.958216).  Saving model ...
Epoch: 12 cost time: 4.499361038208008
Epoch: 12, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.209 Vali Acc: 0.957 Test Loss: 0.209 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.750202178955078
Epoch: 13, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.912768840789795
Epoch: 14, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.260 Vali Acc: 0.948 Test Loss: 0.260 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.759611129760742
Epoch: 15, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.218 Vali Acc: 0.965 Test Loss: 0.218 Test Acc: 0.965
Validation loss decreased (-0.958216 --> -0.965179).  Saving model ...
Epoch: 16 cost time: 5.233279228210449
Epoch: 16, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.253 Vali Acc: 0.953 Test Loss: 0.253 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.519441843032837
Epoch: 17, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.377 Vali Acc: 0.939 Test Loss: 0.377 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.570410490036011
Epoch: 18, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.327 Vali Acc: 0.944 Test Loss: 0.327 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.24514102935791
Epoch: 19, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.220 Vali Acc: 0.969 Test Loss: 0.220 Test Acc: 0.969
Validation loss decreased (-0.965179 --> -0.969357).  Saving model ...
Epoch: 20 cost time: 4.521682977676392
Epoch: 20, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.253 Vali Acc: 0.958 Test Loss: 0.253 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.752774953842163
Epoch: 21, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.355 Vali Acc: 0.950 Test Loss: 0.355 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.81093430519104
Epoch: 22, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.278 Vali Acc: 0.953 Test Loss: 0.278 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.853784799575806
Epoch: 23, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.351 Vali Acc: 0.942 Test Loss: 0.351 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.986939907073975
Epoch: 24, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.386 Vali Acc: 0.945 Test Loss: 0.386 Test Acc: 0.945
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.7085981369018555
Epoch: 25, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.320 Vali Acc: 0.948 Test Loss: 0.320 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.938891887664795
Epoch: 26, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.189 Vali Acc: 0.973 Test Loss: 0.189 Test Acc: 0.973
Validation loss decreased (-0.969357 --> -0.972839).  Saving model ...
Epoch: 27 cost time: 4.941216945648193
Epoch: 27, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.269 Vali Acc: 0.957 Test Loss: 0.269 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.5358662605285645
Epoch: 28, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.250 Vali Acc: 0.967 Test Loss: 0.250 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.752010345458984
Epoch: 29, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.238 Vali Acc: 0.964 Test Loss: 0.238 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.77866530418396
Epoch: 30, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.350 Vali Acc: 0.962 Test Loss: 0.350 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 5.253877401351929
Epoch: 31, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.245 Vali Acc: 0.969 Test Loss: 0.245 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 5.358540296554565
Epoch: 32, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.203 Vali Acc: 0.974 Test Loss: 0.203 Test Acc: 0.974
Validation loss decreased (-0.972839 --> -0.973536).  Saving model ...
Epoch: 33 cost time: 4.5976293087005615
Epoch: 33, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.220 Vali Acc: 0.969 Test Loss: 0.220 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 4.546779155731201
Epoch: 34, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.350 Vali Acc: 0.955 Test Loss: 0.350 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 4.912517070770264
Epoch: 35, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.350 Vali Acc: 0.958 Test Loss: 0.350 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 5.284297227859497
Epoch: 36, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.311 Vali Acc: 0.965 Test Loss: 0.311 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 4.761170148849487
Epoch: 37, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.351 Vali Acc: 0.958 Test Loss: 0.351 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 4.964843988418579
Epoch: 38, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.302 Vali Acc: 0.962 Test Loss: 0.302 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 5.245003938674927
Epoch: 39, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.280 Vali Acc: 0.961 Test Loss: 0.280 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 5.174044132232666
Epoch: 40, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.293 Vali Acc: 0.963 Test Loss: 0.293 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 5.318767547607422
Epoch: 41, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.211 Vali Acc: 0.974 Test Loss: 0.211 Test Acc: 0.974
Validation loss decreased (-0.973536 --> -0.974232).  Saving model ...
Epoch: 42 cost time: 4.787243843078613
Epoch: 42, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.290 Vali Acc: 0.962 Test Loss: 0.290 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 4.464364767074585
Epoch: 43, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.373 Vali Acc: 0.962 Test Loss: 0.373 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 5.066634893417358
Epoch: 44, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.509 Vali Acc: 0.958 Test Loss: 0.509 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 4.488907337188721
Epoch: 45, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.297 Vali Acc: 0.964 Test Loss: 0.297 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 5.121428966522217
Epoch: 46, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.305 Vali Acc: 0.964 Test Loss: 0.305 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 4.5581769943237305
Epoch: 47, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.358 Vali Acc: 0.963 Test Loss: 0.358 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 5.497398138046265
Epoch: 48, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.321 Vali Acc: 0.967 Test Loss: 0.321 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 5.363370895385742
Epoch: 49, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.738 Vali Acc: 0.916 Test Loss: 0.738 Test Acc: 0.916
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 5.129329681396484
Epoch: 50, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.197 Vali Acc: 0.972 Test Loss: 0.197 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 5.449065923690796
Epoch: 51, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.334 Vali Acc: 0.961 Test Loss: 0.334 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.974233983286908
model parameter : 1332268
model size : 7.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.607249021530151
Epoch: 1, Steps: 89 | Train Loss: 2.208 Vali Loss: 0.858 Vali Acc: 0.822 Test Loss: 0.858 Test Acc: 0.822
Validation loss decreased (inf --> -0.821718).  Saving model ...
Epoch: 2 cost time: 4.30853009223938
Epoch: 2, Steps: 89 | Train Loss: 0.553 Vali Loss: 0.405 Vali Acc: 0.886 Test Loss: 0.405 Test Acc: 0.886
Validation loss decreased (-0.821718 --> -0.885790).  Saving model ...
Epoch: 3 cost time: 4.779029846191406
Epoch: 3, Steps: 89 | Train Loss: 0.331 Vali Loss: 0.269 Vali Acc: 0.928 Test Loss: 0.269 Test Acc: 0.928
Validation loss decreased (-0.885790 --> -0.927574).  Saving model ...
Epoch: 4 cost time: 4.874114513397217
Epoch: 4, Steps: 89 | Train Loss: 0.206 Vali Loss: 0.245 Vali Acc: 0.922 Test Loss: 0.245 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.990294456481934
Epoch: 5, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.219 Vali Acc: 0.937 Test Loss: 0.219 Test Acc: 0.937
Validation loss decreased (-0.927574 --> -0.937324).  Saving model ...
Epoch: 6 cost time: 4.811750888824463
Epoch: 6, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
Validation loss decreased (-0.937324 --> -0.958216).  Saving model ...
Epoch: 7 cost time: 4.742386817932129
Epoch: 7, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.314 Vali Acc: 0.928 Test Loss: 0.314 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.840073108673096
Epoch: 8, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.323 Vali Acc: 0.942 Test Loss: 0.323 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.018624544143677
Epoch: 9, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.229 Vali Acc: 0.934 Test Loss: 0.229 Test Acc: 0.934
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.917957544326782
Epoch: 10, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.250 Vali Acc: 0.936 Test Loss: 0.250 Test Acc: 0.936
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.2854108810424805
Epoch: 11, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.202 Vali Acc: 0.960 Test Loss: 0.202 Test Acc: 0.960
Validation loss decreased (-0.958216 --> -0.959608).  Saving model ...
Epoch: 12 cost time: 5.954931259155273
Epoch: 12, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.273 Vali Acc: 0.935 Test Loss: 0.273 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.289644002914429
Epoch: 13, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.158 Vali Acc: 0.967 Test Loss: 0.158 Test Acc: 0.967
Validation loss decreased (-0.959608 --> -0.966572).  Saving model ...
Epoch: 14 cost time: 5.03590202331543
Epoch: 14, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.368 Vali Acc: 0.925 Test Loss: 0.368 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.026982069015503
Epoch: 15, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.172 Vali Acc: 0.967 Test Loss: 0.172 Test Acc: 0.967
Validation loss decreased (-0.966572 --> -0.967268).  Saving model ...
Epoch: 16 cost time: 4.626545429229736
Epoch: 16, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.260 Vali Acc: 0.954 Test Loss: 0.260 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.339024782180786
Epoch: 17, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.367 Vali Acc: 0.942 Test Loss: 0.367 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.05987024307251
Epoch: 18, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.173 Vali Acc: 0.971 Test Loss: 0.173 Test Acc: 0.971
Validation loss decreased (-0.967268 --> -0.971447).  Saving model ...
Epoch: 19 cost time: 5.115674018859863
Epoch: 19, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.246 Vali Acc: 0.956 Test Loss: 0.246 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.727110385894775
Epoch: 20, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.377 Vali Acc: 0.941 Test Loss: 0.377 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.6157708168029785
Epoch: 21, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.218 Vali Acc: 0.971 Test Loss: 0.218 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.712133407592773
Epoch: 22, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.275 Vali Acc: 0.962 Test Loss: 0.275 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.902523994445801
Epoch: 23, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.242 Vali Acc: 0.967 Test Loss: 0.242 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.391370534896851
Epoch: 24, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.260 Vali Acc: 0.961 Test Loss: 0.260 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.73857855796814
Epoch: 25, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.248 Vali Acc: 0.967 Test Loss: 0.248 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.84998631477356
Epoch: 26, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.287 Vali Acc: 0.963 Test Loss: 0.287 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.491949558258057
Epoch: 27, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.311 Vali Acc: 0.959 Test Loss: 0.311 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.900309324264526
Epoch: 28, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.228 Vali Acc: 0.972 Test Loss: 0.228 Test Acc: 0.972
Validation loss decreased (-0.971447 --> -0.972143).  Saving model ...
Epoch: 29 cost time: 4.483001947402954
Epoch: 29, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.250 Vali Acc: 0.969 Test Loss: 0.250 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.346061944961548
Epoch: 30, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.314 Vali Acc: 0.955 Test Loss: 0.314 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 5.569401741027832
Epoch: 31, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.236 Vali Acc: 0.974 Test Loss: 0.236 Test Acc: 0.974
Validation loss decreased (-0.972143 --> -0.973535).  Saving model ...
Epoch: 32 cost time: 5.342487812042236
Epoch: 32, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.257 Vali Acc: 0.974 Test Loss: 0.257 Test Acc: 0.974
Validation loss decreased (-0.973535 --> -0.974231).  Saving model ...
Epoch: 33 cost time: 4.996233224868774
Epoch: 33, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.305 Vali Acc: 0.964 Test Loss: 0.305 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 4.609278440475464
Epoch: 34, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.257 Vali Acc: 0.970 Test Loss: 0.257 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 5.05479884147644
Epoch: 35, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.262 Vali Acc: 0.966 Test Loss: 0.262 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 4.661780118942261
Epoch: 36, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.358 Vali Acc: 0.958 Test Loss: 0.358 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 5.3337531089782715
Epoch: 37, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.251 Vali Acc: 0.970 Test Loss: 0.251 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 5.160109043121338
Epoch: 38, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.498 Vali Acc: 0.956 Test Loss: 0.498 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 5.162592172622681
Epoch: 39, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.350 Vali Acc: 0.955 Test Loss: 0.350 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 4.539910316467285
Epoch: 40, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.444 Vali Acc: 0.953 Test Loss: 0.444 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 5.058557510375977
Epoch: 41, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.313 Vali Acc: 0.971 Test Loss: 0.313 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 5.0007007122039795
Epoch: 42, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.264 Vali Acc: 0.972 Test Loss: 0.264 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.974233983286908
model parameter : 1330220
model size : 7.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.221789360046387
Epoch: 1, Steps: 89 | Train Loss: 2.144 Vali Loss: 0.839 Vali Acc: 0.768 Test Loss: 0.839 Test Acc: 0.768
Validation loss decreased (inf --> -0.768097).  Saving model ...
Epoch: 2 cost time: 4.387893199920654
Epoch: 2, Steps: 89 | Train Loss: 0.521 Vali Loss: 0.364 Vali Acc: 0.896 Test Loss: 0.364 Test Acc: 0.896
Validation loss decreased (-0.768097 --> -0.895540).  Saving model ...
Epoch: 3 cost time: 4.795997858047485
Epoch: 3, Steps: 89 | Train Loss: 0.283 Vali Loss: 0.467 Vali Acc: 0.868 Test Loss: 0.467 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.317508697509766
Epoch: 4, Steps: 89 | Train Loss: 0.236 Vali Loss: 0.276 Vali Acc: 0.921 Test Loss: 0.276 Test Acc: 0.921
Validation loss decreased (-0.895540 --> -0.921306).  Saving model ...
Epoch: 5 cost time: 4.454711675643921
Epoch: 5, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
Validation loss decreased (-0.921306 --> -0.940806).  Saving model ...
Epoch: 6 cost time: 5.3066325187683105
Epoch: 6, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.450 Vali Acc: 0.906 Test Loss: 0.450 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.086597681045532
Epoch: 7, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.147 Vali Acc: 0.960 Test Loss: 0.147 Test Acc: 0.960
Validation loss decreased (-0.940806 --> -0.960305).  Saving model ...
Epoch: 8 cost time: 5.504306077957153
Epoch: 8, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.147 Vali Acc: 0.958 Test Loss: 0.147 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.804426193237305
Epoch: 9, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.222 Vali Acc: 0.938 Test Loss: 0.222 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.640769958496094
Epoch: 10, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.116 Vali Acc: 0.971 Test Loss: 0.116 Test Acc: 0.971
Validation loss decreased (-0.960305 --> -0.970751).  Saving model ...
Epoch: 11 cost time: 5.367352724075317
Epoch: 11, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.163 Vali Acc: 0.964 Test Loss: 0.163 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.510704040527344
Epoch: 12, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.187 Vali Acc: 0.966 Test Loss: 0.187 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.11129903793335
Epoch: 13, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.162 Vali Acc: 0.962 Test Loss: 0.162 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.191007852554321
Epoch: 14, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.414 Vali Acc: 0.928 Test Loss: 0.414 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.2124245166778564
Epoch: 15, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.249 Vali Acc: 0.951 Test Loss: 0.249 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.510002613067627
Epoch: 16, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.268 Vali Acc: 0.963 Test Loss: 0.268 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.0563271045684814
Epoch: 17, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.241 Vali Acc: 0.960 Test Loss: 0.241 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.858687877655029
Epoch: 18, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.208 Vali Acc: 0.969 Test Loss: 0.208 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.4219300746917725
Epoch: 19, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.148 Vali Acc: 0.974 Test Loss: 0.148 Test Acc: 0.974
Validation loss decreased (-0.970751 --> -0.973536).  Saving model ...
Epoch: 20 cost time: 5.41628098487854
Epoch: 20, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.197 Vali Acc: 0.964 Test Loss: 0.197 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.1918745040893555
Epoch: 21, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.164 Vali Acc: 0.981 Test Loss: 0.164 Test Acc: 0.981
Validation loss decreased (-0.973536 --> -0.980500).  Saving model ...
Epoch: 22 cost time: 5.72902250289917
Epoch: 22, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.233 Vali Acc: 0.958 Test Loss: 0.233 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.124040365219116
Epoch: 23, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.277 Vali Acc: 0.958 Test Loss: 0.277 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.708111763000488
Epoch: 24, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.215 Vali Acc: 0.967 Test Loss: 0.215 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.430804014205933
Epoch: 25, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.290 Vali Acc: 0.952 Test Loss: 0.290 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.536837339401245
Epoch: 26, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.216 Vali Acc: 0.967 Test Loss: 0.216 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.607659101486206
Epoch: 27, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.233 Vali Acc: 0.971 Test Loss: 0.233 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.10693621635437
Epoch: 28, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.363 Vali Acc: 0.946 Test Loss: 0.363 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 4.5959250926971436
Epoch: 29, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.197 Vali Acc: 0.967 Test Loss: 0.197 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 4.391378402709961
Epoch: 30, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.263 Vali Acc: 0.958 Test Loss: 0.263 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 4.666252613067627
Epoch: 31, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.260 Vali Acc: 0.972 Test Loss: 0.260 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 1328172
model size : 7.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.656328201293945
Epoch: 1, Steps: 89 | Train Loss: 2.134 Vali Loss: 0.963 Vali Acc: 0.760 Test Loss: 0.963 Test Acc: 0.760
Validation loss decreased (inf --> -0.759740).  Saving model ...
Epoch: 2 cost time: 4.968364238739014
Epoch: 2, Steps: 89 | Train Loss: 0.594 Vali Loss: 0.423 Vali Acc: 0.882 Test Loss: 0.423 Test Acc: 0.882
Validation loss decreased (-0.759740 --> -0.881611).  Saving model ...
Epoch: 3 cost time: 4.494762182235718
Epoch: 3, Steps: 89 | Train Loss: 0.319 Vali Loss: 0.378 Vali Acc: 0.883 Test Loss: 0.378 Test Acc: 0.883
Validation loss decreased (-0.881611 --> -0.883005).  Saving model ...
Epoch: 4 cost time: 5.003417253494263
Epoch: 4, Steps: 89 | Train Loss: 0.229 Vali Loss: 0.222 Vali Acc: 0.933 Test Loss: 0.222 Test Acc: 0.933
Validation loss decreased (-0.883005 --> -0.933145).  Saving model ...
Epoch: 5 cost time: 4.495378255844116
Epoch: 5, Steps: 89 | Train Loss: 0.192 Vali Loss: 0.265 Vali Acc: 0.941 Test Loss: 0.265 Test Acc: 0.941
Validation loss decreased (-0.933145 --> -0.940805).  Saving model ...
Epoch: 6 cost time: 4.404966831207275
Epoch: 6, Steps: 89 | Train Loss: 0.202 Vali Loss: 0.168 Vali Acc: 0.953 Test Loss: 0.168 Test Acc: 0.953
Validation loss decreased (-0.940805 --> -0.952645).  Saving model ...
Epoch: 7 cost time: 4.121589422225952
Epoch: 7, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.952645 --> -0.958216).  Saving model ...
Epoch: 8 cost time: 4.814823865890503
Epoch: 8, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.141 Vali Acc: 0.969 Test Loss: 0.141 Test Acc: 0.969
Validation loss decreased (-0.958216 --> -0.968662).  Saving model ...
Epoch: 9 cost time: 4.163478374481201
Epoch: 9, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.155 Vali Acc: 0.962 Test Loss: 0.155 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.016198396682739
Epoch: 10, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.126 Vali Acc: 0.971 Test Loss: 0.126 Test Acc: 0.971
Validation loss decreased (-0.968662 --> -0.971447).  Saving model ...
Epoch: 11 cost time: 4.477748870849609
Epoch: 11, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.328 Vali Acc: 0.925 Test Loss: 0.328 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.05522608757019
Epoch: 12, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.229 Vali Acc: 0.951 Test Loss: 0.229 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.312188148498535
Epoch: 13, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.277 Vali Acc: 0.951 Test Loss: 0.277 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.205357551574707
Epoch: 14, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.408 Vali Acc: 0.927 Test Loss: 0.408 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.2723517417907715
Epoch: 15, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.250 Vali Acc: 0.960 Test Loss: 0.250 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.241812229156494
Epoch: 16, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.180 Vali Acc: 0.966 Test Loss: 0.180 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.4614996910095215
Epoch: 17, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.218 Vali Acc: 0.971 Test Loss: 0.218 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.528749465942383
Epoch: 18, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.242 Vali Acc: 0.964 Test Loss: 0.242 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.98888897895813
Epoch: 19, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.176 Vali Acc: 0.969 Test Loss: 0.176 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.6592772006988525
Epoch: 20, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.325 Vali Acc: 0.939 Test Loss: 0.325 Test Acc: 0.939
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9714484679665738
model parameter : 1136940
model size : 6.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.976862668991089
Epoch: 1, Steps: 89 | Train Loss: 2.203 Vali Loss: 0.996 Vali Acc: 0.744 Test Loss: 0.996 Test Acc: 0.744
Validation loss decreased (inf --> -0.743723).  Saving model ...
Epoch: 2 cost time: 4.559145212173462
Epoch: 2, Steps: 89 | Train Loss: 0.568 Vali Loss: 0.443 Vali Acc: 0.866 Test Loss: 0.443 Test Acc: 0.866
Validation loss decreased (-0.743723 --> -0.866291).  Saving model ...
Epoch: 3 cost time: 4.994051456451416
Epoch: 3, Steps: 89 | Train Loss: 0.319 Vali Loss: 0.295 Vali Acc: 0.912 Test Loss: 0.295 Test Acc: 0.912
Validation loss decreased (-0.866291 --> -0.912253).  Saving model ...
Epoch: 4 cost time: 5.380780935287476
Epoch: 4, Steps: 89 | Train Loss: 0.229 Vali Loss: 0.204 Vali Acc: 0.939 Test Loss: 0.204 Test Acc: 0.939
Validation loss decreased (-0.912253 --> -0.939413).  Saving model ...
Epoch: 5 cost time: 5.249444484710693
Epoch: 5, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.231 Vali Acc: 0.933 Test Loss: 0.231 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.5917510986328125
Epoch: 6, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.186 Vali Acc: 0.955 Test Loss: 0.186 Test Acc: 0.955
Validation loss decreased (-0.939413 --> -0.954734).  Saving model ...
Epoch: 7 cost time: 4.945698976516724
Epoch: 7, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.232 Vali Acc: 0.942 Test Loss: 0.232 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.733050107955933
Epoch: 8, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.138 Vali Acc: 0.967 Test Loss: 0.138 Test Acc: 0.967
Validation loss decreased (-0.954734 --> -0.966572).  Saving model ...
Epoch: 9 cost time: 4.712159156799316
Epoch: 9, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.196 Vali Acc: 0.955 Test Loss: 0.196 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.032846689224243
Epoch: 10, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.171 Vali Acc: 0.962 Test Loss: 0.171 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.999816656112671
Epoch: 11, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.278 Vali Acc: 0.942 Test Loss: 0.278 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.170412302017212
Epoch: 12, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.447 Vali Acc: 0.909 Test Loss: 0.447 Test Acc: 0.909
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.468058347702026
Epoch: 13, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.182 Vali Acc: 0.973 Test Loss: 0.182 Test Acc: 0.973
Validation loss decreased (-0.966572 --> -0.972839).  Saving model ...
Epoch: 14 cost time: 5.294162034988403
Epoch: 14, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.199 Vali Acc: 0.967 Test Loss: 0.199 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.049708604812622
Epoch: 15, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.183 Vali Acc: 0.964 Test Loss: 0.183 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.277777671813965
Epoch: 16, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.226 Vali Acc: 0.959 Test Loss: 0.226 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.219757318496704
Epoch: 17, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.225 Vali Acc: 0.964 Test Loss: 0.225 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.557323217391968
Epoch: 18, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.331 Vali Acc: 0.948 Test Loss: 0.331 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.024354457855225
Epoch: 19, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.256 Vali Acc: 0.961 Test Loss: 0.256 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.27440071105957
Epoch: 20, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.182 Vali Acc: 0.970 Test Loss: 0.182 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.808722734451294
Epoch: 21, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.217 Vali Acc: 0.964 Test Loss: 0.217 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.61827540397644
Epoch: 22, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.269 Vali Acc: 0.964 Test Loss: 0.269 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 5.487468957901001
Epoch: 23, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.228 Vali Acc: 0.971 Test Loss: 0.228 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9728412256267409
model parameter : 1134892
model size : 6.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.50811505317688
Epoch: 1, Steps: 89 | Train Loss: 2.260 Vali Loss: 1.059 Vali Acc: 0.738 Test Loss: 1.059 Test Acc: 0.738
Validation loss decreased (inf --> -0.738151).  Saving model ...
Epoch: 2 cost time: 4.656294107437134
Epoch: 2, Steps: 89 | Train Loss: 0.585 Vali Loss: 0.495 Vali Acc: 0.854 Test Loss: 0.495 Test Acc: 0.854
Validation loss decreased (-0.738151 --> -0.854452).  Saving model ...
Epoch: 3 cost time: 5.119696617126465
Epoch: 3, Steps: 89 | Train Loss: 0.313 Vali Loss: 0.259 Vali Acc: 0.923 Test Loss: 0.259 Test Acc: 0.923
Validation loss decreased (-0.854452 --> -0.922699).  Saving model ...
Epoch: 4 cost time: 5.4080650806427
Epoch: 4, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.209 Vali Acc: 0.937 Test Loss: 0.209 Test Acc: 0.937
Validation loss decreased (-0.922699 --> -0.936627).  Saving model ...
Epoch: 5 cost time: 5.510339736938477
Epoch: 5, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.266 Vali Acc: 0.930 Test Loss: 0.266 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.457806587219238
Epoch: 6, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
Validation loss decreased (-0.936627 --> -0.958912).  Saving model ...
Epoch: 7 cost time: 5.685033321380615
Epoch: 7, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.198 Vali Acc: 0.953 Test Loss: 0.198 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.851144790649414
Epoch: 8, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.234 Vali Acc: 0.941 Test Loss: 0.234 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.96843957901001
Epoch: 9, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.7814271450042725
Epoch: 10, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.299 Vali Acc: 0.943 Test Loss: 0.299 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.342191219329834
Epoch: 11, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.154 Vali Acc: 0.956 Test Loss: 0.154 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.4218056201934814
Epoch: 12, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.146 Vali Acc: 0.971 Test Loss: 0.146 Test Acc: 0.971
Validation loss decreased (-0.958912 --> -0.970751).  Saving model ...
Epoch: 13 cost time: 4.767224311828613
Epoch: 13, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.142 Vali Acc: 0.969 Test Loss: 0.142 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.810526132583618
Epoch: 14, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.262 Vali Acc: 0.953 Test Loss: 0.262 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.473151445388794
Epoch: 15, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.287 Vali Acc: 0.953 Test Loss: 0.287 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.633436918258667
Epoch: 16, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.182 Vali Acc: 0.968 Test Loss: 0.182 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.390292644500732
Epoch: 17, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.247 Vali Acc: 0.960 Test Loss: 0.247 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.215200424194336
Epoch: 18, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.245 Vali Acc: 0.957 Test Loss: 0.245 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.848177671432495
Epoch: 19, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.297 Vali Acc: 0.951 Test Loss: 0.297 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.908576726913452
Epoch: 20, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.280 Vali Acc: 0.962 Test Loss: 0.280 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.725000858306885
Epoch: 21, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.191 Vali Acc: 0.971 Test Loss: 0.191 Test Acc: 0.971
Validation loss decreased (-0.970751 --> -0.971447).  Saving model ...
Epoch: 22 cost time: 4.95361590385437
Epoch: 22, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.176 Vali Acc: 0.971 Test Loss: 0.176 Test Acc: 0.971
Validation loss decreased (-0.971447 --> -0.971447).  Saving model ...
Epoch: 23 cost time: 4.862065553665161
Epoch: 23, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.320 Vali Acc: 0.953 Test Loss: 0.320 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.130425214767456
Epoch: 24, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.250 Vali Acc: 0.958 Test Loss: 0.250 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.466861963272095
Epoch: 25, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.314 Vali Acc: 0.958 Test Loss: 0.314 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.9198219776153564
Epoch: 26, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.245 Vali Acc: 0.967 Test Loss: 0.245 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 5.625527381896973
Epoch: 27, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.245 Vali Acc: 0.968 Test Loss: 0.245 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.5028440952301025
Epoch: 28, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.325 Vali Acc: 0.962 Test Loss: 0.325 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.98659610748291
Epoch: 29, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.324 Vali Acc: 0.955 Test Loss: 0.324 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 5.511699914932251
Epoch: 30, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.338 Vali Acc: 0.954 Test Loss: 0.338 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 5.157362222671509
Epoch: 31, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.234 Vali Acc: 0.971 Test Loss: 0.234 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 5.805953502655029
Epoch: 32, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.324 Vali Acc: 0.958 Test Loss: 0.324 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9714484679665738
model parameter : 1132844
model size : 6.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.352426767349243
Epoch: 1, Steps: 89 | Train Loss: 2.269 Vali Loss: 1.056 Vali Acc: 0.731 Test Loss: 1.056 Test Acc: 0.731
Validation loss decreased (inf --> -0.730491).  Saving model ...
Epoch: 2 cost time: 4.833291530609131
Epoch: 2, Steps: 89 | Train Loss: 0.592 Vali Loss: 0.473 Vali Acc: 0.848 Test Loss: 0.473 Test Acc: 0.848
Validation loss decreased (-0.730491 --> -0.848185).  Saving model ...
Epoch: 3 cost time: 5.007375955581665
Epoch: 3, Steps: 89 | Train Loss: 0.306 Vali Loss: 0.295 Vali Acc: 0.907 Test Loss: 0.295 Test Acc: 0.907
Validation loss decreased (-0.848185 --> -0.906682).  Saving model ...
Epoch: 4 cost time: 4.2484166622161865
Epoch: 4, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.159 Vali Acc: 0.952 Test Loss: 0.159 Test Acc: 0.952
Validation loss decreased (-0.906682 --> -0.951948).  Saving model ...
Epoch: 5 cost time: 4.889895677566528
Epoch: 5, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.514 Vali Acc: 0.887 Test Loss: 0.514 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.874431610107422
Epoch: 6, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.282 Vali Acc: 0.923 Test Loss: 0.282 Test Acc: 0.923
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.174379825592041
Epoch: 7, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.233 Vali Acc: 0.948 Test Loss: 0.233 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.859272480010986
Epoch: 8, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.241 Vali Acc: 0.938 Test Loss: 0.241 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.161700487136841
Epoch: 9, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.182 Vali Acc: 0.950 Test Loss: 0.182 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.863238096237183
Epoch: 10, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.121 Vali Acc: 0.974 Test Loss: 0.121 Test Acc: 0.974
Validation loss decreased (-0.951948 --> -0.973536).  Saving model ...
Epoch: 11 cost time: 4.929590940475464
Epoch: 11, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.400 Vali Acc: 0.926 Test Loss: 0.400 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.474092960357666
Epoch: 12, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.9607861042022705
Epoch: 13, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.206 Vali Acc: 0.960 Test Loss: 0.206 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.421085834503174
Epoch: 14, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.139 Vali Acc: 0.972 Test Loss: 0.139 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.906970262527466
Epoch: 15, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.178 Vali Acc: 0.967 Test Loss: 0.178 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.839448690414429
Epoch: 16, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.488 Vali Acc: 0.947 Test Loss: 0.488 Test Acc: 0.947
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.940084218978882
Epoch: 17, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.323 Vali Acc: 0.945 Test Loss: 0.323 Test Acc: 0.945
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.701277732849121
Epoch: 18, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.277 Vali Acc: 0.955 Test Loss: 0.277 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.917690753936768
Epoch: 19, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.225 Vali Acc: 0.964 Test Loss: 0.225 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.545273065567017
Epoch: 20, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.288 Vali Acc: 0.958 Test Loss: 0.288 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9735376044568245
model parameter : 1130796
model size : 6.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.0926361083984375
Epoch: 1, Steps: 89 | Train Loss: 2.236 Vali Loss: 0.993 Vali Acc: 0.742 Test Loss: 0.993 Test Acc: 0.742
Validation loss decreased (inf --> -0.741634).  Saving model ...
Epoch: 2 cost time: 5.3183581829071045
Epoch: 2, Steps: 89 | Train Loss: 0.622 Vali Loss: 0.383 Vali Acc: 0.887 Test Loss: 0.383 Test Acc: 0.887
Validation loss decreased (-0.741634 --> -0.887183).  Saving model ...
Epoch: 3 cost time: 5.3899853229522705
Epoch: 3, Steps: 89 | Train Loss: 0.339 Vali Loss: 0.259 Vali Acc: 0.916 Test Loss: 0.259 Test Acc: 0.916
Validation loss decreased (-0.887183 --> -0.915736).  Saving model ...
Epoch: 4 cost time: 4.541763544082642
Epoch: 4, Steps: 89 | Train Loss: 0.225 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.915736 --> -0.943591).  Saving model ...
Epoch: 5 cost time: 5.065333127975464
Epoch: 5, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.308 Vali Acc: 0.921 Test Loss: 0.308 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.477421998977661
Epoch: 6, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.261 Vali Acc: 0.937 Test Loss: 0.261 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.8779590129852295
Epoch: 7, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.164 Vali Acc: 0.957 Test Loss: 0.164 Test Acc: 0.957
Validation loss decreased (-0.943591 --> -0.956823).  Saving model ...
Epoch: 8 cost time: 4.914401292800903
Epoch: 8, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.169 Vali Acc: 0.955 Test Loss: 0.169 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.939000606536865
Epoch: 9, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.300 Vali Acc: 0.937 Test Loss: 0.300 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.8417439460754395
Epoch: 10, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.250 Vali Acc: 0.945 Test Loss: 0.250 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.565782308578491
Epoch: 11, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.178 Vali Acc: 0.960 Test Loss: 0.178 Test Acc: 0.960
Validation loss decreased (-0.956823 --> -0.960305).  Saving model ...
Epoch: 12 cost time: 5.34307599067688
Epoch: 12, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.229 Vali Acc: 0.948 Test Loss: 0.229 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.9878623485565186
Epoch: 13, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.249 Vali Acc: 0.945 Test Loss: 0.249 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.048052549362183
Epoch: 14, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.231 Vali Acc: 0.958 Test Loss: 0.231 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.037489891052246
Epoch: 15, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.229 Vali Acc: 0.960 Test Loss: 0.229 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.525598049163818
Epoch: 16, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.277 Vali Acc: 0.960 Test Loss: 0.277 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.690891265869141
Epoch: 17, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.780 Vali Acc: 0.903 Test Loss: 0.780 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.879860162734985
Epoch: 18, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.370 Vali Acc: 0.943 Test Loss: 0.370 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.4628026485443115
Epoch: 19, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.211 Vali Acc: 0.967 Test Loss: 0.211 Test Acc: 0.967
Validation loss decreased (-0.960305 --> -0.967268).  Saving model ...
Epoch: 20 cost time: 5.230448961257935
Epoch: 20, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.205 Vali Acc: 0.964 Test Loss: 0.205 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.1109278202056885
Epoch: 21, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.353 Vali Acc: 0.948 Test Loss: 0.353 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.991921424865723
Epoch: 22, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.309 Vali Acc: 0.957 Test Loss: 0.309 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.118650436401367
Epoch: 23, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.324 Vali Acc: 0.950 Test Loss: 0.324 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.537172555923462
Epoch: 24, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.363 Vali Acc: 0.946 Test Loss: 0.363 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.396931409835815
Epoch: 25, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.319 Vali Acc: 0.956 Test Loss: 0.319 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.55954647064209
Epoch: 26, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.355 Vali Acc: 0.957 Test Loss: 0.355 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.7184247970581055
Epoch: 27, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.370 Vali Acc: 0.961 Test Loss: 0.370 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.577773809432983
Epoch: 28, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.464 Vali Acc: 0.951 Test Loss: 0.464 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 5.089860439300537
Epoch: 29, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.312 Vali Acc: 0.967 Test Loss: 0.312 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9672701949860725
model parameter : 1038252
model size : 6.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.438917875289917
Epoch: 1, Steps: 89 | Train Loss: 2.249 Vali Loss: 0.993 Vali Acc: 0.781 Test Loss: 0.993 Test Acc: 0.781
Validation loss decreased (inf --> -0.781327).  Saving model ...
Epoch: 2 cost time: 4.792754888534546
Epoch: 2, Steps: 89 | Train Loss: 0.593 Vali Loss: 0.328 Vali Acc: 0.903 Test Loss: 0.328 Test Acc: 0.903
Validation loss decreased (-0.781327 --> -0.902504).  Saving model ...
Epoch: 3 cost time: 4.773921012878418
Epoch: 3, Steps: 89 | Train Loss: 0.312 Vali Loss: 0.252 Vali Acc: 0.923 Test Loss: 0.252 Test Acc: 0.923
Validation loss decreased (-0.902504 --> -0.922699).  Saving model ...
Epoch: 4 cost time: 5.278513431549072
Epoch: 4, Steps: 89 | Train Loss: 0.206 Vali Loss: 0.340 Vali Acc: 0.899 Test Loss: 0.340 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.135133504867554
Epoch: 5, Steps: 89 | Train Loss: 0.256 Vali Loss: 0.279 Vali Acc: 0.931 Test Loss: 0.279 Test Acc: 0.931
Validation loss decreased (-0.922699 --> -0.931056).  Saving model ...
Epoch: 6 cost time: 4.924298048019409
Epoch: 6, Steps: 89 | Train Loss: 0.186 Vali Loss: 0.244 Vali Acc: 0.932 Test Loss: 0.244 Test Acc: 0.932
Validation loss decreased (-0.931056 --> -0.932449).  Saving model ...
Epoch: 7 cost time: 4.893787145614624
Epoch: 7, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.164 Vali Acc: 0.956 Test Loss: 0.164 Test Acc: 0.956
Validation loss decreased (-0.932449 --> -0.956126).  Saving model ...
Epoch: 8 cost time: 4.994062423706055
Epoch: 8, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.187 Vali Acc: 0.955 Test Loss: 0.187 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.502813100814819
Epoch: 9, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.190 Vali Acc: 0.957 Test Loss: 0.190 Test Acc: 0.957
Validation loss decreased (-0.956126 --> -0.956823).  Saving model ...
Epoch: 10 cost time: 4.705464124679565
Epoch: 10, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.190 Vali Acc: 0.960 Test Loss: 0.190 Test Acc: 0.960
Validation loss decreased (-0.956823 --> -0.960305).  Saving model ...
Epoch: 11 cost time: 4.857668161392212
Epoch: 11, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.139 Vali Acc: 0.973 Test Loss: 0.139 Test Acc: 0.973
Validation loss decreased (-0.960305 --> -0.972840).  Saving model ...
Epoch: 12 cost time: 4.534310817718506
Epoch: 12, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.292 Vali Acc: 0.946 Test Loss: 0.292 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.551087856292725
Epoch: 13, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.366 Vali Acc: 0.939 Test Loss: 0.366 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.104732990264893
Epoch: 14, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.219 Vali Acc: 0.955 Test Loss: 0.219 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.9269328117370605
Epoch: 15, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.275 Vali Acc: 0.951 Test Loss: 0.275 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.732730150222778
Epoch: 16, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.182 Vali Acc: 0.967 Test Loss: 0.182 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.900408506393433
Epoch: 17, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.237 Vali Acc: 0.962 Test Loss: 0.237 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.955806255340576
Epoch: 18, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.176 Vali Acc: 0.971 Test Loss: 0.176 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.932652235031128
Epoch: 19, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.186 Vali Acc: 0.970 Test Loss: 0.186 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.779743432998657
Epoch: 20, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.344 Vali Acc: 0.944 Test Loss: 0.344 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.312207221984863
Epoch: 21, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.279 Vali Acc: 0.953 Test Loss: 0.279 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9728412256267409
model parameter : 1036204
model size : 6.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.734752655029297
Epoch: 1, Steps: 89 | Train Loss: 2.230 Vali Loss: 1.024 Vali Acc: 0.787 Test Loss: 1.024 Test Acc: 0.787
Validation loss decreased (inf --> -0.786898).  Saving model ...
Epoch: 2 cost time: 4.8425304889678955
Epoch: 2, Steps: 89 | Train Loss: 0.623 Vali Loss: 0.428 Vali Acc: 0.882 Test Loss: 0.428 Test Acc: 0.882
Validation loss decreased (-0.786898 --> -0.881611).  Saving model ...
Epoch: 3 cost time: 4.87686014175415
Epoch: 3, Steps: 89 | Train Loss: 0.323 Vali Loss: 0.222 Vali Acc: 0.947 Test Loss: 0.222 Test Acc: 0.947
Validation loss decreased (-0.881611 --> -0.947073).  Saving model ...
Epoch: 4 cost time: 5.427266597747803
Epoch: 4, Steps: 89 | Train Loss: 0.248 Vali Loss: 0.419 Vali Acc: 0.875 Test Loss: 0.419 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.193962812423706
Epoch: 5, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.152 Vali Acc: 0.953 Test Loss: 0.152 Test Acc: 0.953
Validation loss decreased (-0.947073 --> -0.952645).  Saving model ...
Epoch: 6 cost time: 5.211839914321899
Epoch: 6, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.142 Vali Acc: 0.966 Test Loss: 0.142 Test Acc: 0.966
Validation loss decreased (-0.952645 --> -0.965876).  Saving model ...
Epoch: 7 cost time: 4.5395121574401855
Epoch: 7, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.152 Vali Acc: 0.959 Test Loss: 0.152 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.385802745819092
Epoch: 8, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
Validation loss decreased (-0.965876 --> -0.967269).  Saving model ...
Epoch: 9 cost time: 5.135005474090576
Epoch: 9, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.155 Vali Acc: 0.960 Test Loss: 0.155 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.606763124465942
Epoch: 10, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.168 Vali Acc: 0.962 Test Loss: 0.168 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.611875295639038
Epoch: 11, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.310 Vali Acc: 0.944 Test Loss: 0.310 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.120973825454712
Epoch: 12, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.152 Vali Acc: 0.967 Test Loss: 0.152 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.614274501800537
Epoch: 13, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
Validation loss decreased (-0.967269 --> -0.975626).  Saving model ...
Epoch: 14 cost time: 4.262200832366943
Epoch: 14, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.234 Vali Acc: 0.960 Test Loss: 0.234 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.011289596557617
Epoch: 15, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.229 Vali Acc: 0.961 Test Loss: 0.229 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.934829473495483
Epoch: 16, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.230 Vali Acc: 0.961 Test Loss: 0.230 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.165435791015625
Epoch: 17, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.189 Vali Acc: 0.964 Test Loss: 0.189 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.522233963012695
Epoch: 18, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.153 Vali Acc: 0.974 Test Loss: 0.153 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.741085052490234
Epoch: 19, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.241 Vali Acc: 0.955 Test Loss: 0.241 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.0904035568237305
Epoch: 20, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.206 Vali Acc: 0.962 Test Loss: 0.206 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.66682767868042
Epoch: 21, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.279 Vali Acc: 0.967 Test Loss: 0.279 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 5.2347095012664795
Epoch: 22, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.290 Vali Acc: 0.958 Test Loss: 0.290 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.16064715385437
Epoch: 23, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.172 Vali Acc: 0.974 Test Loss: 0.172 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 1034156
model size : 6.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.421338796615601
Epoch: 1, Steps: 89 | Train Loss: 2.169 Vali Loss: 1.084 Vali Acc: 0.714 Test Loss: 1.084 Test Acc: 0.714
Validation loss decreased (inf --> -0.713777).  Saving model ...
Epoch: 2 cost time: 4.849338054656982
Epoch: 2, Steps: 89 | Train Loss: 0.579 Vali Loss: 0.376 Vali Acc: 0.887 Test Loss: 0.376 Test Acc: 0.887
Validation loss decreased (-0.713777 --> -0.887183).  Saving model ...
Epoch: 3 cost time: 4.643138647079468
Epoch: 3, Steps: 89 | Train Loss: 0.332 Vali Loss: 0.226 Vali Acc: 0.937 Test Loss: 0.226 Test Acc: 0.937
Validation loss decreased (-0.887183 --> -0.937324).  Saving model ...
Epoch: 4 cost time: 4.663843393325806
Epoch: 4, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.224 Vali Acc: 0.937 Test Loss: 0.224 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.006347894668579
Epoch: 5, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
Validation loss decreased (-0.937324 --> -0.940806).  Saving model ...
Epoch: 6 cost time: 5.23651909828186
Epoch: 6, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.256 Vali Acc: 0.937 Test Loss: 0.256 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.063707590103149
Epoch: 7, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
Validation loss decreased (-0.940806 --> -0.957519).  Saving model ...
Epoch: 8 cost time: 5.1386964321136475
Epoch: 8, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.170 Vali Acc: 0.955 Test Loss: 0.170 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.949566125869751
Epoch: 9, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.253 Vali Acc: 0.942 Test Loss: 0.253 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.0913918018341064
Epoch: 10, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.166 Vali Acc: 0.964 Test Loss: 0.166 Test Acc: 0.964
Validation loss decreased (-0.957519 --> -0.963787).  Saving model ...
Epoch: 11 cost time: 4.561366081237793
Epoch: 11, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.217 Vali Acc: 0.957 Test Loss: 0.217 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.2945334911346436
Epoch: 12, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.153 Vali Acc: 0.969 Test Loss: 0.153 Test Acc: 0.969
Validation loss decreased (-0.963787 --> -0.969358).  Saving model ...
Epoch: 13 cost time: 3.7901182174682617
Epoch: 13, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.387 Vali Acc: 0.939 Test Loss: 0.387 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.5918233394622803
Epoch: 14, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.251870155334473
Epoch: 15, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.201 Vali Acc: 0.960 Test Loss: 0.201 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.29883337020874
Epoch: 16, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.908 Vali Acc: 0.903 Test Loss: 0.908 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.613889217376709
Epoch: 17, Steps: 89 | Train Loss: 0.215 Vali Loss: 0.262 Vali Acc: 0.948 Test Loss: 0.262 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.816153526306152
Epoch: 18, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.294 Vali Acc: 0.951 Test Loss: 0.294 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.317761182785034
Epoch: 19, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.347 Vali Acc: 0.945 Test Loss: 0.347 Test Acc: 0.945
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.797614336013794
Epoch: 20, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.217 Vali Acc: 0.962 Test Loss: 0.217 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.5453572273254395
Epoch: 21, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.335 Vali Acc: 0.948 Test Loss: 0.335 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.862160921096802
Epoch: 22, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.279 Vali Acc: 0.958 Test Loss: 0.279 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9693593314763231
model parameter : 1032108
model size : 6.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.171176910400391
Epoch: 1, Steps: 89 | Train Loss: 2.407 Vali Loss: 1.335 Vali Acc: 0.621 Test Loss: 1.335 Test Acc: 0.621
Validation loss decreased (inf --> -0.621157).  Saving model ...
Epoch: 2 cost time: 5.371782302856445
Epoch: 2, Steps: 89 | Train Loss: 0.749 Vali Loss: 0.450 Vali Acc: 0.882 Test Loss: 0.450 Test Acc: 0.882
Validation loss decreased (-0.621157 --> -0.882307).  Saving model ...
Epoch: 3 cost time: 4.523702144622803
Epoch: 3, Steps: 89 | Train Loss: 0.351 Vali Loss: 0.266 Vali Acc: 0.929 Test Loss: 0.266 Test Acc: 0.929
Validation loss decreased (-0.882307 --> -0.928967).  Saving model ...
Epoch: 4 cost time: 4.284307479858398
Epoch: 4, Steps: 89 | Train Loss: 0.230 Vali Loss: 0.271 Vali Acc: 0.913 Test Loss: 0.271 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.285917520523071
Epoch: 5, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
Validation loss decreased (-0.928967 --> -0.956823).  Saving model ...
Epoch: 6 cost time: 4.34513258934021
Epoch: 6, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.150 Vali Acc: 0.960 Test Loss: 0.150 Test Acc: 0.960
Validation loss decreased (-0.956823 --> -0.960305).  Saving model ...
Epoch: 7 cost time: 4.310071229934692
Epoch: 7, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
Validation loss decreased (-0.960305 --> -0.961698).  Saving model ...
Epoch: 8 cost time: 4.152622938156128
Epoch: 8, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.197 Vali Acc: 0.950 Test Loss: 0.197 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.423293590545654
Epoch: 9, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.116 Vali Acc: 0.966 Test Loss: 0.116 Test Acc: 0.966
Validation loss decreased (-0.961698 --> -0.965876).  Saving model ...
Epoch: 10 cost time: 4.766109228134155
Epoch: 10, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.165 Vali Acc: 0.960 Test Loss: 0.165 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.52489447593689
Epoch: 11, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
Validation loss decreased (-0.965876 --> -0.969358).  Saving model ...
Epoch: 12 cost time: 4.766880989074707
Epoch: 12, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.682274103164673
Epoch: 13, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.427269458770752
Epoch: 14, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.189 Vali Acc: 0.950 Test Loss: 0.189 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.994774341583252
Epoch: 15, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.529642581939697
Epoch: 16, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.153 Vali Acc: 0.965 Test Loss: 0.153 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.781396150588989
Epoch: 17, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.141 Vali Acc: 0.964 Test Loss: 0.141 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.402470111846924
Epoch: 18, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.3118181228637695
Epoch: 19, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.144 Vali Acc: 0.960 Test Loss: 0.144 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.468885660171509
Epoch: 20, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.162 Vali Acc: 0.971 Test Loss: 0.162 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.971447).  Saving model ...
Epoch: 21 cost time: 4.437211751937866
Epoch: 21, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.165 Vali Acc: 0.970 Test Loss: 0.165 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.218744516372681
Epoch: 22, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.43644118309021
Epoch: 23, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.186 Vali Acc: 0.968 Test Loss: 0.186 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.511136054992676
Epoch: 24, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.211 Vali Acc: 0.956 Test Loss: 0.211 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.277938604354858
Epoch: 25, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.160 Vali Acc: 0.971 Test Loss: 0.160 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.388667106628418
Epoch: 26, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.202 Vali Acc: 0.964 Test Loss: 0.202 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.969428300857544
Epoch: 27, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.153 Vali Acc: 0.969 Test Loss: 0.153 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.381725072860718
Epoch: 28, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
Validation loss decreased (-0.971447 --> -0.975626).  Saving model ...
Epoch: 29 cost time: 4.332469940185547
Epoch: 29, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.258 Vali Acc: 0.955 Test Loss: 0.258 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.211310625076294
Epoch: 30, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.175 Vali Acc: 0.971 Test Loss: 0.175 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 4.698896884918213
Epoch: 31, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.145 Vali Acc: 0.975 Test Loss: 0.145 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 4.275676965713501
Epoch: 32, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.180 Vali Acc: 0.971 Test Loss: 0.180 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 4.638974189758301
Epoch: 33, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.172 Vali Acc: 0.970 Test Loss: 0.172 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 5.045068979263306
Epoch: 34, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.125 Vali Acc: 0.978 Test Loss: 0.125 Test Acc: 0.978
Validation loss decreased (-0.975626 --> -0.977715).  Saving model ...
Epoch: 35 cost time: 4.3490355014801025
Epoch: 35, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.254 Vali Acc: 0.955 Test Loss: 0.254 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 4.110101938247681
Epoch: 36, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.154 Vali Acc: 0.979 Test Loss: 0.154 Test Acc: 0.979
Validation loss decreased (-0.977715 --> -0.979107).  Saving model ...
Epoch: 37 cost time: 4.4599761962890625
Epoch: 37, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.148 Vali Acc: 0.978 Test Loss: 0.148 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 4.742917060852051
Epoch: 38, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.141 Vali Acc: 0.977 Test Loss: 0.141 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 4.246189594268799
Epoch: 39, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.182 Vali Acc: 0.972 Test Loss: 0.182 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 4.224122047424316
Epoch: 40, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.145 Vali Acc: 0.974 Test Loss: 0.145 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 4.097470760345459
Epoch: 41, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.180 Vali Acc: 0.974 Test Loss: 0.180 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 4.583912134170532
Epoch: 42, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.149 Vali Acc: 0.976 Test Loss: 0.149 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 4.481338977813721
Epoch: 43, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.167 Vali Acc: 0.972 Test Loss: 0.167 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 4.5014488697052
Epoch: 44, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.223 Vali Acc: 0.971 Test Loss: 0.223 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 4.765742301940918
Epoch: 45, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.223 Vali Acc: 0.966 Test Loss: 0.223 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 4.39374566078186
Epoch: 46, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.246 Vali Acc: 0.955 Test Loss: 0.246 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 669484
model size : 3.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.185702323913574
Epoch: 1, Steps: 89 | Train Loss: 2.429 Vali Loss: 1.292 Vali Acc: 0.719 Test Loss: 1.292 Test Acc: 0.719
Validation loss decreased (inf --> -0.718650).  Saving model ...
Epoch: 2 cost time: 4.498714208602905
Epoch: 2, Steps: 89 | Train Loss: 0.745 Vali Loss: 0.468 Vali Acc: 0.865 Test Loss: 0.468 Test Acc: 0.865
Validation loss decreased (-0.718650 --> -0.864898).  Saving model ...
Epoch: 3 cost time: 4.593051910400391
Epoch: 3, Steps: 89 | Train Loss: 0.389 Vali Loss: 0.340 Vali Acc: 0.907 Test Loss: 0.340 Test Acc: 0.907
Validation loss decreased (-0.864898 --> -0.907378).  Saving model ...
Epoch: 4 cost time: 4.537937164306641
Epoch: 4, Steps: 89 | Train Loss: 0.231 Vali Loss: 0.214 Vali Acc: 0.942 Test Loss: 0.214 Test Acc: 0.942
Validation loss decreased (-0.907378 --> -0.942198).  Saving model ...
Epoch: 5 cost time: 4.881094694137573
Epoch: 5, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.150 Vali Acc: 0.954 Test Loss: 0.150 Test Acc: 0.954
Validation loss decreased (-0.942198 --> -0.954037).  Saving model ...
Epoch: 6 cost time: 5.390275001525879
Epoch: 6, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.188 Vali Acc: 0.942 Test Loss: 0.188 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.207432985305786
Epoch: 7, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
Validation loss decreased (-0.954037 --> -0.961698).  Saving model ...
Epoch: 8 cost time: 4.205063104629517
Epoch: 8, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.961698 --> -0.972840).  Saving model ...
Epoch: 9 cost time: 4.291527986526489
Epoch: 9, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.173 Vali Acc: 0.950 Test Loss: 0.173 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.215834856033325
Epoch: 10, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.105 Vali Acc: 0.969 Test Loss: 0.105 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.3648293018341064
Epoch: 11, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.975626).  Saving model ...
Epoch: 12 cost time: 4.788291692733765
Epoch: 12, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.975626 --> -0.977019).  Saving model ...
Epoch: 13 cost time: 4.158350229263306
Epoch: 13, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.122 Vali Acc: 0.966 Test Loss: 0.122 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.541507244110107
Epoch: 14, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.078 Vali Acc: 0.982 Test Loss: 0.078 Test Acc: 0.982
Validation loss decreased (-0.977019 --> -0.981893).  Saving model ...
Epoch: 15 cost time: 4.491527080535889
Epoch: 15, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.209 Vali Acc: 0.962 Test Loss: 0.209 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.760262727737427
Epoch: 16, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.156 Vali Acc: 0.959 Test Loss: 0.156 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.533883810043335
Epoch: 17, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.1106719970703125
Epoch: 18, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.377300500869751
Epoch: 19, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.132 Vali Acc: 0.971 Test Loss: 0.132 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.656808137893677
Epoch: 20, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.138 Vali Acc: 0.967 Test Loss: 0.138 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.402916193008423
Epoch: 21, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.922908067703247
Epoch: 22, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.153 Vali Acc: 0.973 Test Loss: 0.153 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.0472564697265625
Epoch: 23, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.141 Vali Acc: 0.974 Test Loss: 0.141 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.702887773513794
Epoch: 24, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.131 Vali Acc: 0.976 Test Loss: 0.131 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 668460
model size : 3.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.5211181640625
Epoch: 1, Steps: 89 | Train Loss: 2.387 Vali Loss: 1.236 Vali Acc: 0.736 Test Loss: 1.236 Test Acc: 0.736
Validation loss decreased (inf --> -0.736060).  Saving model ...
Epoch: 2 cost time: 4.12050724029541
Epoch: 2, Steps: 89 | Train Loss: 0.697 Vali Loss: 0.451 Vali Acc: 0.881 Test Loss: 0.451 Test Acc: 0.881
Validation loss decreased (-0.736060 --> -0.880915).  Saving model ...
Epoch: 3 cost time: 4.3171775341033936
Epoch: 3, Steps: 89 | Train Loss: 0.364 Vali Loss: 0.301 Vali Acc: 0.914 Test Loss: 0.301 Test Acc: 0.914
Validation loss decreased (-0.880915 --> -0.913646).  Saving model ...
Epoch: 4 cost time: 4.400043964385986
Epoch: 4, Steps: 89 | Train Loss: 0.249 Vali Loss: 0.262 Vali Acc: 0.923 Test Loss: 0.262 Test Acc: 0.923
Validation loss decreased (-0.913646 --> -0.923396).  Saving model ...
Epoch: 5 cost time: 3.5225541591644287
Epoch: 5, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.175 Vali Acc: 0.942 Test Loss: 0.175 Test Acc: 0.942
Validation loss decreased (-0.923396 --> -0.942199).  Saving model ...
Epoch: 6 cost time: 3.889127492904663
Epoch: 6, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.132 Vali Acc: 0.961 Test Loss: 0.132 Test Acc: 0.961
Validation loss decreased (-0.942199 --> -0.961001).  Saving model ...
Epoch: 7 cost time: 4.261085510253906
Epoch: 7, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.162 Vali Acc: 0.945 Test Loss: 0.162 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.242968797683716
Epoch: 8, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.961001 --> -0.977019).  Saving model ...
Epoch: 9 cost time: 3.654865026473999
Epoch: 9, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.164 Vali Acc: 0.952 Test Loss: 0.164 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.757521867752075
Epoch: 10, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.105 Vali Acc: 0.967 Test Loss: 0.105 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.207284450531006
Epoch: 11, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.227807521820068
Epoch: 12, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.498613119125366
Epoch: 13, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.135 Vali Acc: 0.974 Test Loss: 0.135 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.139341354370117
Epoch: 14, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.7223100662231445
Epoch: 15, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.20784854888916
Epoch: 16, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.134 Vali Acc: 0.964 Test Loss: 0.134 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.541745901107788
Epoch: 17, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.819129943847656
Epoch: 18, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.146 Vali Acc: 0.966 Test Loss: 0.146 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 667436
model size : 3.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.844049692153931
Epoch: 1, Steps: 89 | Train Loss: 2.396 Vali Loss: 1.211 Vali Acc: 0.733 Test Loss: 1.211 Test Acc: 0.733
Validation loss decreased (inf --> -0.733275).  Saving model ...
Epoch: 2 cost time: 4.358120441436768
Epoch: 2, Steps: 89 | Train Loss: 0.729 Vali Loss: 0.437 Vali Acc: 0.882 Test Loss: 0.437 Test Acc: 0.882
Validation loss decreased (-0.733275 --> -0.882308).  Saving model ...
Epoch: 3 cost time: 4.040033340454102
Epoch: 3, Steps: 89 | Train Loss: 0.364 Vali Loss: 0.261 Vali Acc: 0.926 Test Loss: 0.261 Test Acc: 0.926
Validation loss decreased (-0.882308 --> -0.926181).  Saving model ...
Epoch: 4 cost time: 4.074248313903809
Epoch: 4, Steps: 89 | Train Loss: 0.244 Vali Loss: 0.237 Vali Acc: 0.929 Test Loss: 0.237 Test Acc: 0.929
Validation loss decreased (-0.926181 --> -0.928967).  Saving model ...
Epoch: 5 cost time: 4.12701940536499
Epoch: 5, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
Validation loss decreased (-0.928967 --> -0.954037).  Saving model ...
Epoch: 6 cost time: 4.203486204147339
Epoch: 6, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.137 Vali Acc: 0.956 Test Loss: 0.137 Test Acc: 0.956
Validation loss decreased (-0.954037 --> -0.956127).  Saving model ...
Epoch: 7 cost time: 4.234632968902588
Epoch: 7, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.130 Vali Acc: 0.958 Test Loss: 0.130 Test Acc: 0.958
Validation loss decreased (-0.956127 --> -0.957520).  Saving model ...
Epoch: 8 cost time: 3.6296639442443848
Epoch: 8, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.862135648727417
Epoch: 9, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.115 Vali Acc: 0.967 Test Loss: 0.115 Test Acc: 0.967
Validation loss decreased (-0.957520 --> -0.967269).  Saving model ...
Epoch: 10 cost time: 4.234118461608887
Epoch: 10, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.125 Vali Acc: 0.969 Test Loss: 0.125 Test Acc: 0.969
Validation loss decreased (-0.967269 --> -0.968662).  Saving model ...
Epoch: 11 cost time: 3.819446325302124
Epoch: 11, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.884512424468994
Epoch: 12, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.54732608795166
Epoch: 13, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.124 Vali Acc: 0.964 Test Loss: 0.124 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.655055999755859
Epoch: 14, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.097 Vali Acc: 0.972 Test Loss: 0.097 Test Acc: 0.972
Validation loss decreased (-0.968662 --> -0.972144).  Saving model ...
Epoch: 15 cost time: 4.345763683319092
Epoch: 15, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.126 Vali Acc: 0.966 Test Loss: 0.126 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.53791880607605
Epoch: 16, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.151 Vali Acc: 0.964 Test Loss: 0.151 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.304415702819824
Epoch: 17, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.613710880279541
Epoch: 18, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.374909162521362
Epoch: 19, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.166 Vali Acc: 0.966 Test Loss: 0.166 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.533520936965942
Epoch: 20, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.143 Vali Acc: 0.966 Test Loss: 0.143 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.98096776008606
Epoch: 21, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.162 Vali Acc: 0.964 Test Loss: 0.162 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.616334438323975
Epoch: 22, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
Validation loss decreased (-0.972144 --> -0.976322).  Saving model ...
Epoch: 23 cost time: 4.210385799407959
Epoch: 23, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.156 Vali Acc: 0.967 Test Loss: 0.156 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.258188247680664
Epoch: 24, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.174 Vali Acc: 0.967 Test Loss: 0.174 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.30917501449585
Epoch: 25, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.162 Vali Acc: 0.964 Test Loss: 0.162 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.145846366882324
Epoch: 26, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.150 Vali Acc: 0.972 Test Loss: 0.150 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.816848039627075
Epoch: 27, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.160 Vali Acc: 0.967 Test Loss: 0.160 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.734488487243652
Epoch: 28, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.187 Vali Acc: 0.961 Test Loss: 0.187 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.643811941146851
Epoch: 29, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.132 Vali Acc: 0.974 Test Loss: 0.132 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 5.018487453460693
Epoch: 30, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.218 Vali Acc: 0.961 Test Loss: 0.218 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 4.674253463745117
Epoch: 31, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.181 Vali Acc: 0.963 Test Loss: 0.181 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 5.315353631973267
Epoch: 32, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.167 Vali Acc: 0.971 Test Loss: 0.167 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 666412
model size : 3.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.274486064910889
Epoch: 1, Steps: 89 | Train Loss: 2.411 Vali Loss: 1.341 Vali Acc: 0.742 Test Loss: 1.341 Test Acc: 0.742
Validation loss decreased (inf --> -0.742326).  Saving model ...
Epoch: 2 cost time: 4.344186782836914
Epoch: 2, Steps: 89 | Train Loss: 0.765 Vali Loss: 0.448 Vali Acc: 0.882 Test Loss: 0.448 Test Acc: 0.882
Validation loss decreased (-0.742326 --> -0.881611).  Saving model ...
Epoch: 3 cost time: 4.455729246139526
Epoch: 3, Steps: 89 | Train Loss: 0.378 Vali Loss: 0.283 Vali Acc: 0.914 Test Loss: 0.283 Test Acc: 0.914
Validation loss decreased (-0.881611 --> -0.913646).  Saving model ...
Epoch: 4 cost time: 4.25266695022583
Epoch: 4, Steps: 89 | Train Loss: 0.222 Vali Loss: 0.244 Vali Acc: 0.930 Test Loss: 0.244 Test Acc: 0.930
Validation loss decreased (-0.913646 --> -0.929663).  Saving model ...
Epoch: 5 cost time: 4.411608695983887
Epoch: 5, Steps: 89 | Train Loss: 0.165 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.929663 --> -0.943591).  Saving model ...
Epoch: 6 cost time: 4.89999794960022
Epoch: 6, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
Validation loss decreased (-0.943591 --> -0.956823).  Saving model ...
Epoch: 7 cost time: 4.407254457473755
Epoch: 7, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.131 Vali Acc: 0.961 Test Loss: 0.131 Test Acc: 0.961
Validation loss decreased (-0.956823 --> -0.961001).  Saving model ...
Epoch: 8 cost time: 4.53753399848938
Epoch: 8, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.870187044143677
Epoch: 9, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
Validation loss decreased (-0.961001 --> -0.973537).  Saving model ...
Epoch: 10 cost time: 4.785168647766113
Epoch: 10, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.842735767364502
Epoch: 11, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.153 Vali Acc: 0.955 Test Loss: 0.153 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.789497137069702
Epoch: 12, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.101 Vali Acc: 0.969 Test Loss: 0.101 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.765376091003418
Epoch: 13, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.142 Vali Acc: 0.965 Test Loss: 0.142 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.568549871444702
Epoch: 14, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.109 Vali Acc: 0.967 Test Loss: 0.109 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.415031909942627
Epoch: 15, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.271 Vali Acc: 0.929 Test Loss: 0.271 Test Acc: 0.929
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.9191527366638184
Epoch: 16, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.126 Vali Acc: 0.972 Test Loss: 0.126 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.34867787361145
Epoch: 17, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.261107921600342
Epoch: 18, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.448753595352173
Epoch: 19, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9735376044568245
model parameter : 471340
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.382389783859253
Epoch: 1, Steps: 89 | Train Loss: 2.443 Vali Loss: 1.360 Vali Acc: 0.699 Test Loss: 1.360 Test Acc: 0.699
Validation loss decreased (inf --> -0.699151).  Saving model ...
Epoch: 2 cost time: 3.840371608734131
Epoch: 2, Steps: 89 | Train Loss: 0.773 Vali Loss: 0.440 Vali Acc: 0.884 Test Loss: 0.440 Test Acc: 0.884
Validation loss decreased (-0.699151 --> -0.884397).  Saving model ...
Epoch: 3 cost time: 4.37526535987854
Epoch: 3, Steps: 89 | Train Loss: 0.365 Vali Loss: 0.278 Vali Acc: 0.920 Test Loss: 0.278 Test Acc: 0.920
Validation loss decreased (-0.884397 --> -0.919914).  Saving model ...
Epoch: 4 cost time: 4.114834547042847
Epoch: 4, Steps: 89 | Train Loss: 0.246 Vali Loss: 0.264 Vali Acc: 0.914 Test Loss: 0.264 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.385739803314209
Epoch: 5, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.147 Vali Acc: 0.960 Test Loss: 0.147 Test Acc: 0.960
Validation loss decreased (-0.919914 --> -0.959609).  Saving model ...
Epoch: 6 cost time: 4.310003042221069
Epoch: 6, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.145 Vali Acc: 0.958 Test Loss: 0.145 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.194939851760864
Epoch: 7, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.118 Vali Acc: 0.966 Test Loss: 0.118 Test Acc: 0.966
Validation loss decreased (-0.959609 --> -0.965876).  Saving model ...
Epoch: 8 cost time: 4.016298770904541
Epoch: 8, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.205 Vali Acc: 0.937 Test Loss: 0.205 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.1515679359436035
Epoch: 9, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.109 Vali Acc: 0.967 Test Loss: 0.109 Test Acc: 0.967
Validation loss decreased (-0.965876 --> -0.967269).  Saving model ...
Epoch: 10 cost time: 4.173157691955566
Epoch: 10, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
Validation loss decreased (-0.967269 --> -0.970055).  Saving model ...
Epoch: 11 cost time: 4.994153261184692
Epoch: 11, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.148 Vali Acc: 0.960 Test Loss: 0.148 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.790573835372925
Epoch: 12, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
Validation loss decreased (-0.970055 --> -0.970751).  Saving model ...
Epoch: 13 cost time: 4.885205268859863
Epoch: 13, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.440358400344849
Epoch: 14, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
Validation loss decreased (-0.970751 --> -0.976322).  Saving model ...
Epoch: 15 cost time: 4.4158735275268555
Epoch: 15, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.894407272338867
Epoch: 16, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.125482559204102
Epoch: 17, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.6695432662963867
Epoch: 18, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.210107088088989
Epoch: 19, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.649930238723755
Epoch: 20, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.153 Vali Acc: 0.953 Test Loss: 0.153 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.286474943161011
Epoch: 21, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.8232626914978027
Epoch: 22, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.198 Vali Acc: 0.955 Test Loss: 0.198 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.933394432067871
Epoch: 23, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.123 Vali Acc: 0.978 Test Loss: 0.123 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.977715).  Saving model ...
Epoch: 24 cost time: 4.148494005203247
Epoch: 24, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.4364688396453857
Epoch: 25, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.127 Vali Acc: 0.976 Test Loss: 0.127 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.774266242980957
Epoch: 26, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.153 Vali Acc: 0.964 Test Loss: 0.153 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.9904110431671143
Epoch: 27, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.157 Vali Acc: 0.971 Test Loss: 0.157 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.66412353515625
Epoch: 28, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.154 Vali Acc: 0.967 Test Loss: 0.154 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.6108341217041016
Epoch: 29, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.554145336151123
Epoch: 30, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.139 Vali Acc: 0.969 Test Loss: 0.139 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.8276758193969727
Epoch: 31, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.217 Vali Acc: 0.961 Test Loss: 0.217 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 4.025789737701416
Epoch: 32, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.168 Vali Acc: 0.973 Test Loss: 0.168 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.6229982376098633
Epoch: 33, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.144 Vali Acc: 0.970 Test Loss: 0.144 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 470316
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.749932765960693
Epoch: 1, Steps: 89 | Train Loss: 2.463 Vali Loss: 1.371 Vali Acc: 0.696 Test Loss: 1.371 Test Acc: 0.696
Validation loss decreased (inf --> -0.695669).  Saving model ...
Epoch: 2 cost time: 4.383413314819336
Epoch: 2, Steps: 89 | Train Loss: 0.758 Vali Loss: 0.447 Vali Acc: 0.853 Test Loss: 0.447 Test Acc: 0.853
Validation loss decreased (-0.695669 --> -0.853060).  Saving model ...
Epoch: 3 cost time: 3.941256046295166
Epoch: 3, Steps: 89 | Train Loss: 0.358 Vali Loss: 0.262 Vali Acc: 0.933 Test Loss: 0.262 Test Acc: 0.933
Validation loss decreased (-0.853060 --> -0.933145).  Saving model ...
Epoch: 4 cost time: 3.9281606674194336
Epoch: 4, Steps: 89 | Train Loss: 0.226 Vali Loss: 0.236 Vali Acc: 0.921 Test Loss: 0.236 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.991678476333618
Epoch: 5, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
Validation loss decreased (-0.933145 --> -0.958912).  Saving model ...
Epoch: 6 cost time: 3.965817928314209
Epoch: 6, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.129 Vali Acc: 0.963 Test Loss: 0.129 Test Acc: 0.963
Validation loss decreased (-0.958912 --> -0.963091).  Saving model ...
Epoch: 7 cost time: 4.232262372970581
Epoch: 7, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.112 Vali Acc: 0.967 Test Loss: 0.112 Test Acc: 0.967
Validation loss decreased (-0.963091 --> -0.967269).  Saving model ...
Epoch: 8 cost time: 4.1008734703063965
Epoch: 8, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.177 Vali Acc: 0.948 Test Loss: 0.177 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.31661581993103
Epoch: 9, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.106 Vali Acc: 0.972 Test Loss: 0.106 Test Acc: 0.972
Validation loss decreased (-0.967269 --> -0.972144).  Saving model ...
Epoch: 10 cost time: 4.2889251708984375
Epoch: 10, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.141 Vali Acc: 0.960 Test Loss: 0.141 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.0031328201293945
Epoch: 11, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.171 Vali Acc: 0.947 Test Loss: 0.171 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.361485958099365
Epoch: 12, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.166 Vali Acc: 0.964 Test Loss: 0.166 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.669960975646973
Epoch: 13, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
Validation loss decreased (-0.972144 --> -0.975626).  Saving model ...
Epoch: 14 cost time: 4.074577331542969
Epoch: 14, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.5334367752075195
Epoch: 15, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.324021577835083
Epoch: 16, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.975626 --> -0.979804).  Saving model ...
Epoch: 17 cost time: 4.044532537460327
Epoch: 17, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.160 Vali Acc: 0.966 Test Loss: 0.160 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.169452428817749
Epoch: 18, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.148 Vali Acc: 0.965 Test Loss: 0.148 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.869777202606201
Epoch: 19, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.257385969161987
Epoch: 20, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.474 Vali Acc: 0.901 Test Loss: 0.474 Test Acc: 0.901
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.339047193527222
Epoch: 21, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.080038070678711
Epoch: 22, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.174 Vali Acc: 0.957 Test Loss: 0.174 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.690375804901123
Epoch: 23, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.311954498291016
Epoch: 24, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.189 Vali Acc: 0.959 Test Loss: 0.189 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.608628511428833
Epoch: 25, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.110 Vali Acc: 0.978 Test Loss: 0.110 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.549115896224976
Epoch: 26, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 469292
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.064560413360596
Epoch: 1, Steps: 89 | Train Loss: 2.498 Vali Loss: 1.455 Vali Acc: 0.697 Test Loss: 1.455 Test Acc: 0.697
Validation loss decreased (inf --> -0.697061).  Saving model ...
Epoch: 2 cost time: 4.682373523712158
Epoch: 2, Steps: 89 | Train Loss: 0.792 Vali Loss: 0.482 Vali Acc: 0.873 Test Loss: 0.482 Test Acc: 0.873
Validation loss decreased (-0.697061 --> -0.872558).  Saving model ...
Epoch: 3 cost time: 4.910846710205078
Epoch: 3, Steps: 89 | Train Loss: 0.388 Vali Loss: 0.289 Vali Acc: 0.914 Test Loss: 0.289 Test Acc: 0.914
Validation loss decreased (-0.872558 --> -0.913646).  Saving model ...
Epoch: 4 cost time: 4.949044704437256
Epoch: 4, Steps: 89 | Train Loss: 0.242 Vali Loss: 0.230 Vali Acc: 0.934 Test Loss: 0.230 Test Acc: 0.934
Validation loss decreased (-0.913646 --> -0.933842).  Saving model ...
Epoch: 5 cost time: 4.1958746910095215
Epoch: 5, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
Validation loss decreased (-0.933842 --> -0.954037).  Saving model ...
Epoch: 6 cost time: 5.1395299434661865
Epoch: 6, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.137 Vali Acc: 0.963 Test Loss: 0.137 Test Acc: 0.963
Validation loss decreased (-0.954037 --> -0.963091).  Saving model ...
Epoch: 7 cost time: 4.395393371582031
Epoch: 7, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.607875108718872
Epoch: 8, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.145 Vali Acc: 0.958 Test Loss: 0.145 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.307115077972412
Epoch: 9, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.107 Vali Acc: 0.972 Test Loss: 0.107 Test Acc: 0.972
Validation loss decreased (-0.963091 --> -0.972144).  Saving model ...
Epoch: 10 cost time: 4.581376791000366
Epoch: 10, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.171 Vali Acc: 0.954 Test Loss: 0.171 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.853484630584717
Epoch: 11, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.972144 --> -0.972840).  Saving model ...
Epoch: 12 cost time: 4.855280160903931
Epoch: 12, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.151 Vali Acc: 0.959 Test Loss: 0.151 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.550339221954346
Epoch: 13, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.974233).  Saving model ...
Epoch: 14 cost time: 4.934118747711182
Epoch: 14, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.542890310287476
Epoch: 15, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.112 Vali Acc: 0.972 Test Loss: 0.112 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.859824180603027
Epoch: 16, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.437542676925659
Epoch: 17, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.0348076820373535
Epoch: 18, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
Validation loss decreased (-0.974233 --> -0.974929).  Saving model ...
Epoch: 19 cost time: 4.48771858215332
Epoch: 19, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.116 Vali Acc: 0.978 Test Loss: 0.116 Test Acc: 0.978
Validation loss decreased (-0.974929 --> -0.978411).  Saving model ...
Epoch: 20 cost time: 5.0005879402160645
Epoch: 20, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.148 Vali Acc: 0.966 Test Loss: 0.148 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.30594801902771
Epoch: 21, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.131 Vali Acc: 0.971 Test Loss: 0.131 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.676848888397217
Epoch: 22, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.791213035583496
Epoch: 23, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.978411 --> -0.982590).  Saving model ...
Epoch: 24 cost time: 5.033696889877319
Epoch: 24, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.663183689117432
Epoch: 25, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.137 Vali Acc: 0.968 Test Loss: 0.137 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.359189748764038
Epoch: 26, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.271 Vali Acc: 0.947 Test Loss: 0.271 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.938867807388306
Epoch: 27, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 5.009207010269165
Epoch: 28, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.163 Vali Acc: 0.969 Test Loss: 0.163 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.269200325012207
Epoch: 29, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.218 Vali Acc: 0.964 Test Loss: 0.218 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 4.740438938140869
Epoch: 30, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.245 Vali Acc: 0.957 Test Loss: 0.245 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 4.370273113250732
Epoch: 31, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.193 Vali Acc: 0.969 Test Loss: 0.193 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 4.759188890457153
Epoch: 32, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.164 Vali Acc: 0.976 Test Loss: 0.164 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 4.016062021255493
Epoch: 33, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.153 Vali Acc: 0.974 Test Loss: 0.153 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 468268
model size : 3.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.44445013999939
Epoch: 1, Steps: 89 | Train Loss: 2.554 Vali Loss: 1.567 Vali Acc: 0.645 Test Loss: 1.567 Test Acc: 0.645
Validation loss decreased (inf --> -0.644831).  Saving model ...
Epoch: 2 cost time: 4.034612655639648
Epoch: 2, Steps: 89 | Train Loss: 0.848 Vali Loss: 0.494 Vali Acc: 0.866 Test Loss: 0.494 Test Acc: 0.866
Validation loss decreased (-0.644831 --> -0.865594).  Saving model ...
Epoch: 3 cost time: 4.124671220779419
Epoch: 3, Steps: 89 | Train Loss: 0.399 Vali Loss: 0.282 Vali Acc: 0.930 Test Loss: 0.282 Test Acc: 0.930
Validation loss decreased (-0.865594 --> -0.929663).  Saving model ...
Epoch: 4 cost time: 4.500896453857422
Epoch: 4, Steps: 89 | Train Loss: 0.249 Vali Loss: 0.201 Vali Acc: 0.942 Test Loss: 0.201 Test Acc: 0.942
Validation loss decreased (-0.929663 --> -0.942199).  Saving model ...
Epoch: 5 cost time: 4.148038387298584
Epoch: 5, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.208 Vali Acc: 0.942 Test Loss: 0.208 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.111915826797485
Epoch: 6, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.423341751098633
Epoch: 7, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.179 Vali Acc: 0.942 Test Loss: 0.179 Test Acc: 0.942
Validation loss decreased (-0.942199 --> -0.942199).  Saving model ...
Epoch: 8 cost time: 4.335113525390625
Epoch: 8, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
Validation loss decreased (-0.942199 --> -0.962394).  Saving model ...
Epoch: 9 cost time: 3.7705042362213135
Epoch: 9, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.153 Vali Acc: 0.953 Test Loss: 0.153 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.7640151977539062
Epoch: 10, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.102 Vali Acc: 0.972 Test Loss: 0.102 Test Acc: 0.972
Validation loss decreased (-0.962394 --> -0.972144).  Saving model ...
Epoch: 11 cost time: 3.8174452781677246
Epoch: 11, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.169 Vali Acc: 0.955 Test Loss: 0.169 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.028801679611206
Epoch: 12, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.0405168533325195
Epoch: 13, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.112 Vali Acc: 0.972 Test Loss: 0.112 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.166242361068726
Epoch: 14, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.179 Vali Acc: 0.951 Test Loss: 0.179 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.8945329189300537
Epoch: 15, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.143 Vali Acc: 0.965 Test Loss: 0.143 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.537949800491333
Epoch: 16, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.112 Vali Acc: 0.969 Test Loss: 0.112 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.339207887649536
Epoch: 17, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
Validation loss decreased (-0.972144 --> -0.975626).  Saving model ...
Epoch: 18 cost time: 4.373165845870972
Epoch: 18, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.156 Vali Acc: 0.960 Test Loss: 0.156 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.550135850906372
Epoch: 19, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.134 Vali Acc: 0.960 Test Loss: 0.134 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.311228513717651
Epoch: 20, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
Validation loss decreased (-0.975626 --> -0.977715).  Saving model ...
Epoch: 21 cost time: 4.256212472915649
Epoch: 21, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.8632123470306396
Epoch: 22, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.17684531211853
Epoch: 23, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.05080771446228
Epoch: 24, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.283 Vali Acc: 0.937 Test Loss: 0.283 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.059419870376587
Epoch: 25, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.281 Vali Acc: 0.944 Test Loss: 0.281 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.432237386703491
Epoch: 26, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.136 Vali Acc: 0.971 Test Loss: 0.136 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.8462958335876465
Epoch: 27, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.208 Vali Acc: 0.962 Test Loss: 0.208 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.399369478225708
Epoch: 28, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.169 Vali Acc: 0.970 Test Loss: 0.169 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.7186126708984375
Epoch: 29, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.176 Vali Acc: 0.967 Test Loss: 0.176 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.126708030700684
Epoch: 30, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.123 Vali Acc: 0.974 Test Loss: 0.123 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 372268
model size : 2.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.118300199508667
Epoch: 1, Steps: 89 | Train Loss: 2.487 Vali Loss: 1.472 Vali Acc: 0.699 Test Loss: 1.472 Test Acc: 0.699
Validation loss decreased (inf --> -0.699150).  Saving model ...
Epoch: 2 cost time: 3.779020071029663
Epoch: 2, Steps: 89 | Train Loss: 0.822 Vali Loss: 0.520 Vali Acc: 0.862 Test Loss: 0.520 Test Acc: 0.862
Validation loss decreased (-0.699150 --> -0.862112).  Saving model ...
Epoch: 3 cost time: 4.7335593700408936
Epoch: 3, Steps: 89 | Train Loss: 0.402 Vali Loss: 0.282 Vali Acc: 0.911 Test Loss: 0.282 Test Acc: 0.911
Validation loss decreased (-0.862112 --> -0.910861).  Saving model ...
Epoch: 4 cost time: 4.361372232437134
Epoch: 4, Steps: 89 | Train Loss: 0.244 Vali Loss: 0.234 Vali Acc: 0.920 Test Loss: 0.234 Test Acc: 0.920
Validation loss decreased (-0.910861 --> -0.919914).  Saving model ...
Epoch: 5 cost time: 4.724733352661133
Epoch: 5, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.176 Vali Acc: 0.951 Test Loss: 0.176 Test Acc: 0.951
Validation loss decreased (-0.919914 --> -0.950555).  Saving model ...
Epoch: 6 cost time: 4.414168834686279
Epoch: 6, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.155 Vali Acc: 0.956 Test Loss: 0.155 Test Acc: 0.956
Validation loss decreased (-0.950555 --> -0.956127).  Saving model ...
Epoch: 7 cost time: 4.575919151306152
Epoch: 7, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.147 Vali Acc: 0.953 Test Loss: 0.147 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.727598667144775
Epoch: 8, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.139 Vali Acc: 0.955 Test Loss: 0.139 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.501927614212036
Epoch: 9, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.5756516456604
Epoch: 10, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.139 Vali Acc: 0.961 Test Loss: 0.139 Test Acc: 0.961
Validation loss decreased (-0.956127 --> -0.961001).  Saving model ...
Epoch: 11 cost time: 4.033895492553711
Epoch: 11, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
Validation loss decreased (-0.961001 --> -0.966573).  Saving model ...
Epoch: 12 cost time: 4.551604509353638
Epoch: 12, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.142 Vali Acc: 0.963 Test Loss: 0.142 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.386196851730347
Epoch: 13, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.165 Vali Acc: 0.956 Test Loss: 0.165 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.321584224700928
Epoch: 14, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.003079175949097
Epoch: 15, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
Validation loss decreased (-0.966573 --> -0.973537).  Saving model ...
Epoch: 16 cost time: 4.388264894485474
Epoch: 16, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.133 Vali Acc: 0.966 Test Loss: 0.133 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.371077060699463
Epoch: 17, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.4336957931518555
Epoch: 18, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.162 Vali Acc: 0.964 Test Loss: 0.162 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.872335195541382
Epoch: 19, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.072071313858032
Epoch: 20, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.146 Vali Acc: 0.968 Test Loss: 0.146 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.8529045581817627
Epoch: 21, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
Validation loss decreased (-0.973537 --> -0.974929).  Saving model ...
Epoch: 22 cost time: 4.53934383392334
Epoch: 22, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.160 Vali Acc: 0.964 Test Loss: 0.160 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.374131202697754
Epoch: 23, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.236936569213867
Epoch: 24, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.118 Vali Acc: 0.978 Test Loss: 0.118 Test Acc: 0.978
Validation loss decreased (-0.974929 --> -0.978411).  Saving model ...
Epoch: 25 cost time: 3.966881275177002
Epoch: 25, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.277 Vali Acc: 0.953 Test Loss: 0.277 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.156609058380127
Epoch: 26, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.199 Vali Acc: 0.963 Test Loss: 0.199 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.984233140945435
Epoch: 27, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.160 Vali Acc: 0.965 Test Loss: 0.160 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.517892837524414
Epoch: 28, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.232 Vali Acc: 0.954 Test Loss: 0.232 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.093635320663452
Epoch: 29, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.194 Vali Acc: 0.962 Test Loss: 0.194 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.0434441566467285
Epoch: 30, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.256 Vali Acc: 0.962 Test Loss: 0.256 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 4.265413522720337
Epoch: 31, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.198 Vali Acc: 0.967 Test Loss: 0.198 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 4.182935476303101
Epoch: 32, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.172 Vali Acc: 0.969 Test Loss: 0.172 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 4.120879888534546
Epoch: 33, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.153 Vali Acc: 0.972 Test Loss: 0.153 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 4.666725397109985
Epoch: 34, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.146 Vali Acc: 0.977 Test Loss: 0.146 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 371244
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.51057505607605
Epoch: 1, Steps: 89 | Train Loss: 2.452 Vali Loss: 1.378 Vali Acc: 0.731 Test Loss: 1.378 Test Acc: 0.731
Validation loss decreased (inf --> -0.730488).  Saving model ...
Epoch: 2 cost time: 4.22122597694397
Epoch: 2, Steps: 89 | Train Loss: 0.803 Vali Loss: 0.495 Vali Acc: 0.868 Test Loss: 0.495 Test Acc: 0.868
Validation loss decreased (-0.730488 --> -0.867683).  Saving model ...
Epoch: 3 cost time: 4.0750977993011475
Epoch: 3, Steps: 89 | Train Loss: 0.369 Vali Loss: 0.349 Vali Acc: 0.891 Test Loss: 0.349 Test Acc: 0.891
Validation loss decreased (-0.867683 --> -0.891361).  Saving model ...
Epoch: 4 cost time: 4.782214641571045
Epoch: 4, Steps: 89 | Train Loss: 0.241 Vali Loss: 0.234 Vali Acc: 0.933 Test Loss: 0.234 Test Acc: 0.933
Validation loss decreased (-0.891361 --> -0.933145).  Saving model ...
Epoch: 5 cost time: 4.086449384689331
Epoch: 5, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.210 Vali Acc: 0.925 Test Loss: 0.210 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.311354875564575
Epoch: 6, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.152 Vali Acc: 0.960 Test Loss: 0.152 Test Acc: 0.960
Validation loss decreased (-0.933145 --> -0.959609).  Saving model ...
Epoch: 7 cost time: 4.099485158920288
Epoch: 7, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.130 Vali Acc: 0.969 Test Loss: 0.130 Test Acc: 0.969
Validation loss decreased (-0.959609 --> -0.968662).  Saving model ...
Epoch: 8 cost time: 3.9774670600891113
Epoch: 8, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.117 Vali Acc: 0.963 Test Loss: 0.117 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.32850980758667
Epoch: 9, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.144 Vali Acc: 0.963 Test Loss: 0.144 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.625889539718628
Epoch: 10, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.968662 --> -0.975626).  Saving model ...
Epoch: 11 cost time: 5.308574914932251
Epoch: 11, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.746130704879761
Epoch: 12, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.80190372467041
Epoch: 13, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.223321914672852
Epoch: 14, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.975626 --> -0.977019).  Saving model ...
Epoch: 15 cost time: 4.7913947105407715
Epoch: 15, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.116 Vali Acc: 0.969 Test Loss: 0.116 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.360954761505127
Epoch: 16, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.265272617340088
Epoch: 17, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.148 Vali Acc: 0.968 Test Loss: 0.148 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.799229145050049
Epoch: 18, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.4492573738098145
Epoch: 19, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.138 Vali Acc: 0.968 Test Loss: 0.138 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.644355535507202
Epoch: 20, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.151 Vali Acc: 0.960 Test Loss: 0.151 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.0349040031433105
Epoch: 21, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.138 Vali Acc: 0.972 Test Loss: 0.138 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.197582244873047
Epoch: 22, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.134 Vali Acc: 0.974 Test Loss: 0.134 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.351783275604248
Epoch: 23, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.123 Vali Acc: 0.976 Test Loss: 0.123 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.569639205932617
Epoch: 24, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.130 Vali Acc: 0.971 Test Loss: 0.130 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 370220
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.9902122020721436
Epoch: 1, Steps: 89 | Train Loss: 2.454 Vali Loss: 1.361 Vali Acc: 0.745 Test Loss: 1.361 Test Acc: 0.745
Validation loss decreased (inf --> -0.745112).  Saving model ...
Epoch: 2 cost time: 3.473074436187744
Epoch: 2, Steps: 89 | Train Loss: 0.775 Vali Loss: 0.519 Vali Acc: 0.864 Test Loss: 0.519 Test Acc: 0.864
Validation loss decreased (-0.745112 --> -0.864201).  Saving model ...
Epoch: 3 cost time: 3.8334619998931885
Epoch: 3, Steps: 89 | Train Loss: 0.418 Vali Loss: 0.361 Vali Acc: 0.903 Test Loss: 0.361 Test Acc: 0.903
Validation loss decreased (-0.864201 --> -0.902503).  Saving model ...
Epoch: 4 cost time: 3.740016222000122
Epoch: 4, Steps: 89 | Train Loss: 0.240 Vali Loss: 0.241 Vali Acc: 0.929 Test Loss: 0.241 Test Acc: 0.929
Validation loss decreased (-0.902503 --> -0.928967).  Saving model ...
Epoch: 5 cost time: 3.5708327293395996
Epoch: 5, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.208 Vali Acc: 0.942 Test Loss: 0.208 Test Acc: 0.942
Validation loss decreased (-0.928967 --> -0.941502).  Saving model ...
Epoch: 6 cost time: 3.636652946472168
Epoch: 6, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.142 Vali Acc: 0.957 Test Loss: 0.142 Test Acc: 0.957
Validation loss decreased (-0.941502 --> -0.956823).  Saving model ...
Epoch: 7 cost time: 4.324515342712402
Epoch: 7, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.213 Vali Acc: 0.937 Test Loss: 0.213 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.7117063999176025
Epoch: 8, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
Validation loss decreased (-0.956823 --> -0.967965).  Saving model ...
Epoch: 9 cost time: 4.307617902755737
Epoch: 9, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
Validation loss decreased (-0.967965 --> -0.968662).  Saving model ...
Epoch: 10 cost time: 4.317067384719849
Epoch: 10, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.478947877883911
Epoch: 11, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.183 Vali Acc: 0.955 Test Loss: 0.183 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.688336133956909
Epoch: 12, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.282760858535767
Epoch: 13, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.121 Vali Acc: 0.964 Test Loss: 0.121 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.428038120269775
Epoch: 14, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.167 Vali Acc: 0.963 Test Loss: 0.167 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.4038984775543213
Epoch: 15, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.143 Vali Acc: 0.965 Test Loss: 0.143 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.098028659820557
Epoch: 16, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.119 Vali Acc: 0.972 Test Loss: 0.119 Test Acc: 0.972
Validation loss decreased (-0.968662 --> -0.972144).  Saving model ...
Epoch: 17 cost time: 4.761970043182373
Epoch: 17, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.972144 --> -0.972840).  Saving model ...
Epoch: 18 cost time: 4.18316650390625
Epoch: 18, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.139 Vali Acc: 0.966 Test Loss: 0.139 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.488435745239258
Epoch: 19, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.145 Vali Acc: 0.968 Test Loss: 0.145 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.641484975814819
Epoch: 20, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.172 Vali Acc: 0.960 Test Loss: 0.172 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.600271701812744
Epoch: 21, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.119 Vali Acc: 0.976 Test Loss: 0.119 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.975626).  Saving model ...
Epoch: 22 cost time: 4.586162328720093
Epoch: 22, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.124 Vali Acc: 0.978 Test Loss: 0.124 Test Acc: 0.978
Validation loss decreased (-0.975626 --> -0.977715).  Saving model ...
Epoch: 23 cost time: 4.536818027496338
Epoch: 23, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.163 Vali Acc: 0.969 Test Loss: 0.163 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.869706392288208
Epoch: 24, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.190 Vali Acc: 0.964 Test Loss: 0.190 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.089536905288696
Epoch: 25, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.184 Vali Acc: 0.971 Test Loss: 0.184 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.360194206237793
Epoch: 26, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.252 Vali Acc: 0.953 Test Loss: 0.252 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.379376411437988
Epoch: 27, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.195 Vali Acc: 0.964 Test Loss: 0.195 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.682920932769775
Epoch: 28, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.216 Vali Acc: 0.963 Test Loss: 0.216 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.565627813339233
Epoch: 29, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.158 Vali Acc: 0.969 Test Loss: 0.158 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 4.003833532333374
Epoch: 30, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.170 Vali Acc: 0.971 Test Loss: 0.170 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 4.84194016456604
Epoch: 31, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.204 Vali Acc: 0.967 Test Loss: 0.204 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 4.693992614746094
Epoch: 32, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.172 Vali Acc: 0.977 Test Loss: 0.172 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 369196
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.82961368560791
Epoch: 1, Steps: 89 | Train Loss: 2.537 Vali Loss: 1.533 Vali Acc: 0.698 Test Loss: 1.533 Test Acc: 0.698
Validation loss decreased (inf --> -0.697756).  Saving model ...
Epoch: 2 cost time: 4.781771183013916
Epoch: 2, Steps: 89 | Train Loss: 0.873 Vali Loss: 0.512 Vali Acc: 0.855 Test Loss: 0.512 Test Acc: 0.855
Validation loss decreased (-0.697756 --> -0.855148).  Saving model ...
Epoch: 3 cost time: 4.3707427978515625
Epoch: 3, Steps: 89 | Train Loss: 0.380 Vali Loss: 0.338 Vali Acc: 0.910 Test Loss: 0.338 Test Acc: 0.910
Validation loss decreased (-0.855148 --> -0.910164).  Saving model ...
Epoch: 4 cost time: 4.487390995025635
Epoch: 4, Steps: 89 | Train Loss: 0.244 Vali Loss: 0.257 Vali Acc: 0.933 Test Loss: 0.257 Test Acc: 0.933
Validation loss decreased (-0.910164 --> -0.933145).  Saving model ...
Epoch: 5 cost time: 4.453738212585449
Epoch: 5, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.167 Vali Acc: 0.952 Test Loss: 0.167 Test Acc: 0.952
Validation loss decreased (-0.933145 --> -0.951948).  Saving model ...
Epoch: 6 cost time: 4.519012689590454
Epoch: 6, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.138 Vali Acc: 0.960 Test Loss: 0.138 Test Acc: 0.960
Validation loss decreased (-0.951948 --> -0.960305).  Saving model ...
Epoch: 7 cost time: 4.38289737701416
Epoch: 7, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.121 Vali Acc: 0.964 Test Loss: 0.121 Test Acc: 0.964
Validation loss decreased (-0.960305 --> -0.963787).  Saving model ...
Epoch: 8 cost time: 4.597318410873413
Epoch: 8, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
Validation loss decreased (-0.963787 --> -0.965180).  Saving model ...
Epoch: 9 cost time: 4.700064182281494
Epoch: 9, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
Validation loss decreased (-0.965180 --> -0.971447).  Saving model ...
Epoch: 10 cost time: 4.297412633895874
Epoch: 10, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.973537).  Saving model ...
Epoch: 11 cost time: 4.335315704345703
Epoch: 11, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.907607078552246
Epoch: 12, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.119 Vali Acc: 0.972 Test Loss: 0.119 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.893115520477295
Epoch: 13, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.580611944198608
Epoch: 14, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.155 Vali Acc: 0.960 Test Loss: 0.155 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.586538076400757
Epoch: 15, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.208 Vali Acc: 0.942 Test Loss: 0.208 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.2100300788879395
Epoch: 16, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.574355602264404
Epoch: 17, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.173 Vali Acc: 0.955 Test Loss: 0.173 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.260846853256226
Epoch: 18, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.136 Vali Acc: 0.971 Test Loss: 0.136 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.129972696304321
Epoch: 19, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.951209306716919
Epoch: 20, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.169 Vali Acc: 0.968 Test Loss: 0.169 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9735376044568245
model parameter : 322732
model size : 2.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.135225534439087
Epoch: 1, Steps: 89 | Train Loss: 2.585 Vali Loss: 1.650 Vali Acc: 0.608 Test Loss: 1.650 Test Acc: 0.608
Validation loss decreased (inf --> -0.607922).  Saving model ...
Epoch: 2 cost time: 5.018193006515503
Epoch: 2, Steps: 89 | Train Loss: 0.936 Vali Loss: 0.551 Vali Acc: 0.847 Test Loss: 0.551 Test Acc: 0.847
Validation loss decreased (-0.607922 --> -0.846791).  Saving model ...
Epoch: 3 cost time: 4.684224367141724
Epoch: 3, Steps: 89 | Train Loss: 0.408 Vali Loss: 0.327 Vali Acc: 0.903 Test Loss: 0.327 Test Acc: 0.903
Validation loss decreased (-0.846791 --> -0.903200).  Saving model ...
Epoch: 4 cost time: 4.454202651977539
Epoch: 4, Steps: 89 | Train Loss: 0.266 Vali Loss: 0.260 Vali Acc: 0.923 Test Loss: 0.260 Test Acc: 0.923
Validation loss decreased (-0.903200 --> -0.923396).  Saving model ...
Epoch: 5 cost time: 4.954931020736694
Epoch: 5, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.193 Vali Acc: 0.945 Test Loss: 0.193 Test Acc: 0.945
Validation loss decreased (-0.923396 --> -0.944984).  Saving model ...
Epoch: 6 cost time: 4.666876316070557
Epoch: 6, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.233 Vali Acc: 0.928 Test Loss: 0.233 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.061520338058472
Epoch: 7, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.141 Vali Acc: 0.961 Test Loss: 0.141 Test Acc: 0.961
Validation loss decreased (-0.944984 --> -0.961001).  Saving model ...
Epoch: 8 cost time: 4.414061546325684
Epoch: 8, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.128 Vali Acc: 0.964 Test Loss: 0.128 Test Acc: 0.964
Validation loss decreased (-0.961001 --> -0.963787).  Saving model ...
Epoch: 9 cost time: 4.0180346965789795
Epoch: 9, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
Validation loss decreased (-0.963787 --> -0.971447).  Saving model ...
Epoch: 10 cost time: 4.739435911178589
Epoch: 10, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.248 Vali Acc: 0.937 Test Loss: 0.248 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.201656103134155
Epoch: 11, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.973537).  Saving model ...
Epoch: 12 cost time: 4.815167188644409
Epoch: 12, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.102047443389893
Epoch: 13, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.107 Vali Acc: 0.972 Test Loss: 0.107 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.33869481086731
Epoch: 14, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.165 Vali Acc: 0.955 Test Loss: 0.165 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.393319845199585
Epoch: 15, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.029776096343994
Epoch: 16, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.149 Vali Acc: 0.964 Test Loss: 0.149 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.146484613418579
Epoch: 17, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
Validation loss decreased (-0.973537 --> -0.977715).  Saving model ...
Epoch: 18 cost time: 4.6171064376831055
Epoch: 18, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.494749069213867
Epoch: 19, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.173 Vali Acc: 0.962 Test Loss: 0.173 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.687454462051392
Epoch: 20, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.159 Vali Acc: 0.962 Test Loss: 0.159 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.7922914028167725
Epoch: 21, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.100348234176636
Epoch: 22, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.171 Vali Acc: 0.969 Test Loss: 0.171 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.6050944328308105
Epoch: 23, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.175 Vali Acc: 0.965 Test Loss: 0.175 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.399869918823242
Epoch: 24, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.165 Vali Acc: 0.967 Test Loss: 0.165 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.538066864013672
Epoch: 25, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.663015604019165
Epoch: 26, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.114 Vali Acc: 0.972 Test Loss: 0.114 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.519339084625244
Epoch: 27, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 321708
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.262020111083984
Epoch: 1, Steps: 89 | Train Loss: 2.580 Vali Loss: 1.693 Vali Acc: 0.611 Test Loss: 1.693 Test Acc: 0.611
Validation loss decreased (inf --> -0.611404).  Saving model ...
Epoch: 2 cost time: 4.276168346405029
Epoch: 2, Steps: 89 | Train Loss: 0.990 Vali Loss: 0.560 Vali Acc: 0.849 Test Loss: 0.560 Test Acc: 0.849
Validation loss decreased (-0.611404 --> -0.848880).  Saving model ...
Epoch: 3 cost time: 4.539175748825073
Epoch: 3, Steps: 89 | Train Loss: 0.424 Vali Loss: 0.352 Vali Acc: 0.900 Test Loss: 0.352 Test Acc: 0.900
Validation loss decreased (-0.848880 --> -0.900414).  Saving model ...
Epoch: 4 cost time: 4.164252281188965
Epoch: 4, Steps: 89 | Train Loss: 0.254 Vali Loss: 0.212 Vali Acc: 0.942 Test Loss: 0.212 Test Acc: 0.942
Validation loss decreased (-0.900414 --> -0.942198).  Saving model ...
Epoch: 5 cost time: 4.432171106338501
Epoch: 5, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
Validation loss decreased (-0.942198 --> -0.961698).  Saving model ...
Epoch: 6 cost time: 4.571348428726196
Epoch: 6, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.205 Vali Acc: 0.937 Test Loss: 0.205 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.483867168426514
Epoch: 7, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.115 Vali Acc: 0.969 Test Loss: 0.115 Test Acc: 0.969
Validation loss decreased (-0.961698 --> -0.969358).  Saving model ...
Epoch: 8 cost time: 4.164901971817017
Epoch: 8, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.217 Vali Acc: 0.942 Test Loss: 0.217 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.626461744308472
Epoch: 9, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.151 Vali Acc: 0.956 Test Loss: 0.151 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.475158452987671
Epoch: 10, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.112 Vali Acc: 0.966 Test Loss: 0.112 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.764821529388428
Epoch: 11, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.132 Vali Acc: 0.958 Test Loss: 0.132 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.3653244972229
Epoch: 12, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.131 Vali Acc: 0.963 Test Loss: 0.131 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.1415464878082275
Epoch: 13, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.971447).  Saving model ...
Epoch: 14 cost time: 4.732863187789917
Epoch: 14, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.0742857456207275
Epoch: 15, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.134 Vali Acc: 0.963 Test Loss: 0.134 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.1395251750946045
Epoch: 16, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.973537).  Saving model ...
Epoch: 17 cost time: 4.627393960952759
Epoch: 17, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.973537 --> -0.977019).  Saving model ...
Epoch: 18 cost time: 4.568499803543091
Epoch: 18, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.155 Vali Acc: 0.971 Test Loss: 0.155 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.587110996246338
Epoch: 19, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.195 Vali Acc: 0.955 Test Loss: 0.195 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.661312580108643
Epoch: 20, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.146 Vali Acc: 0.967 Test Loss: 0.146 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.614268064498901
Epoch: 21, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.167 Vali Acc: 0.965 Test Loss: 0.167 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.88350772857666
Epoch: 22, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.136 Vali Acc: 0.969 Test Loss: 0.136 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.014501333236694
Epoch: 23, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.158 Vali Acc: 0.967 Test Loss: 0.158 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.357224702835083
Epoch: 24, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.9997119903564453
Epoch: 25, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.205 Vali Acc: 0.963 Test Loss: 0.205 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.673870086669922
Epoch: 26, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.214 Vali Acc: 0.957 Test Loss: 0.214 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.108139753341675
Epoch: 27, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.180 Vali Acc: 0.961 Test Loss: 0.180 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 320684
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.459029197692871
Epoch: 1, Steps: 89 | Train Loss: 2.475 Vali Loss: 1.523 Vali Acc: 0.713 Test Loss: 1.523 Test Acc: 0.713
Validation loss decreased (inf --> -0.713077).  Saving model ...
Epoch: 2 cost time: 3.99415922164917
Epoch: 2, Steps: 89 | Train Loss: 0.900 Vali Loss: 0.569 Vali Acc: 0.854 Test Loss: 0.569 Test Acc: 0.854
Validation loss decreased (-0.713077 --> -0.854451).  Saving model ...
Epoch: 3 cost time: 4.494612216949463
Epoch: 3, Steps: 89 | Train Loss: 0.396 Vali Loss: 0.280 Vali Acc: 0.928 Test Loss: 0.280 Test Acc: 0.928
Validation loss decreased (-0.854451 --> -0.927574).  Saving model ...
Epoch: 4 cost time: 4.535983562469482
Epoch: 4, Steps: 89 | Train Loss: 0.260 Vali Loss: 0.278 Vali Acc: 0.911 Test Loss: 0.278 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.9737460613250732
Epoch: 5, Steps: 89 | Train Loss: 0.192 Vali Loss: 0.232 Vali Acc: 0.928 Test Loss: 0.232 Test Acc: 0.928
Validation loss decreased (-0.927574 --> -0.928271).  Saving model ...
Epoch: 6 cost time: 4.3418638706207275
Epoch: 6, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
Validation loss decreased (-0.928271 --> -0.951252).  Saving model ...
Epoch: 7 cost time: 3.961080551147461
Epoch: 7, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.149 Vali Acc: 0.953 Test Loss: 0.149 Test Acc: 0.953
Validation loss decreased (-0.951252 --> -0.952645).  Saving model ...
Epoch: 8 cost time: 4.362841367721558
Epoch: 8, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.143 Vali Acc: 0.960 Test Loss: 0.143 Test Acc: 0.960
Validation loss decreased (-0.952645 --> -0.960305).  Saving model ...
Epoch: 9 cost time: 3.783337116241455
Epoch: 9, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
Validation loss decreased (-0.960305 --> -0.961698).  Saving model ...
Epoch: 10 cost time: 4.578325510025024
Epoch: 10, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
Validation loss decreased (-0.961698 --> -0.974233).  Saving model ...
Epoch: 11 cost time: 4.810627222061157
Epoch: 11, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.406301498413086
Epoch: 12, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
Validation loss decreased (-0.974233 --> -0.978411).  Saving model ...
Epoch: 13 cost time: 4.591057777404785
Epoch: 13, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.233287811279297
Epoch: 14, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.118053436279297
Epoch: 15, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.228275299072266
Epoch: 16, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.218 Vali Acc: 0.942 Test Loss: 0.218 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.861201524734497
Epoch: 17, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.4924750328063965
Epoch: 18, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.267076015472412
Epoch: 19, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.222020864486694
Epoch: 20, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.4352638721466064
Epoch: 21, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.145 Vali Acc: 0.963 Test Loss: 0.145 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.334331750869751
Epoch: 22, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.112 Vali Acc: 0.972 Test Loss: 0.112 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 319660
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.86725640296936
Epoch: 1, Steps: 89 | Train Loss: 2.739 Vali Loss: 2.002 Vali Acc: 0.558 Test Loss: 2.002 Test Acc: 0.558
Validation loss decreased (inf --> -0.557779).  Saving model ...
Epoch: 2 cost time: 4.658196687698364
Epoch: 2, Steps: 89 | Train Loss: 1.181 Vali Loss: 0.728 Vali Acc: 0.795 Test Loss: 0.728 Test Acc: 0.795
Validation loss decreased (-0.557779 --> -0.795257).  Saving model ...
Epoch: 3 cost time: 4.747512578964233
Epoch: 3, Steps: 89 | Train Loss: 0.546 Vali Loss: 0.468 Vali Acc: 0.860 Test Loss: 0.468 Test Acc: 0.860
Validation loss decreased (-0.795257 --> -0.860023).  Saving model ...
Epoch: 4 cost time: 4.478915452957153
Epoch: 4, Steps: 89 | Train Loss: 0.337 Vali Loss: 0.300 Vali Acc: 0.924 Test Loss: 0.300 Test Acc: 0.924
Validation loss decreased (-0.860023 --> -0.924092).  Saving model ...
Epoch: 5 cost time: 5.289211988449097
Epoch: 5, Steps: 89 | Train Loss: 0.247 Vali Loss: 0.215 Vali Acc: 0.942 Test Loss: 0.215 Test Acc: 0.942
Validation loss decreased (-0.924092 --> -0.941502).  Saving model ...
Epoch: 6 cost time: 4.7624452114105225
Epoch: 6, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.214 Vali Acc: 0.935 Test Loss: 0.214 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.419978141784668
Epoch: 7, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.149 Vali Acc: 0.959 Test Loss: 0.149 Test Acc: 0.959
Validation loss decreased (-0.941502 --> -0.958912).  Saving model ...
Epoch: 8 cost time: 4.102789640426636
Epoch: 8, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.142 Vali Acc: 0.960 Test Loss: 0.142 Test Acc: 0.960
Validation loss decreased (-0.958912 --> -0.960305).  Saving model ...
Epoch: 9 cost time: 3.848775863647461
Epoch: 9, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.125 Vali Acc: 0.964 Test Loss: 0.125 Test Acc: 0.964
Validation loss decreased (-0.960305 --> -0.964483).  Saving model ...
Epoch: 10 cost time: 4.3343517780303955
Epoch: 10, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
Validation loss decreased (-0.964483 --> -0.970055).  Saving model ...
Epoch: 11 cost time: 4.2341814041137695
Epoch: 11, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.128 Vali Acc: 0.964 Test Loss: 0.128 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.025189638137817
Epoch: 12, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.108 Vali Acc: 0.969 Test Loss: 0.108 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.666392803192139
Epoch: 13, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
Validation loss decreased (-0.970055 --> -0.971447).  Saving model ...
Epoch: 14 cost time: 3.7278892993927
Epoch: 14, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.130 Vali Acc: 0.958 Test Loss: 0.130 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.121236801147461
Epoch: 15, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.132 Vali Acc: 0.964 Test Loss: 0.132 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.304988384246826
Epoch: 16, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.101 Vali Acc: 0.969 Test Loss: 0.101 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.548763275146484
Epoch: 17, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.971447 --> -0.972840).  Saving model ...
Epoch: 18 cost time: 4.8907790184021
Epoch: 18, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.813283443450928
Epoch: 19, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.061614036560059
Epoch: 20, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.154 Vali Acc: 0.963 Test Loss: 0.154 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.87286376953125
Epoch: 21, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.607107162475586
Epoch: 22, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.150 Vali Acc: 0.966 Test Loss: 0.150 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.9132730960845947
Epoch: 23, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.125 Vali Acc: 0.971 Test Loss: 0.125 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.850097417831421
Epoch: 24, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.963700532913208
Epoch: 25, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.974233).  Saving model ...
Epoch: 26 cost time: 3.8734452724456787
Epoch: 26, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.333430528640747
Epoch: 27, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.975626).  Saving model ...
Epoch: 28 cost time: 4.509382724761963
Epoch: 28, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.297323942184448
Epoch: 29, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.109 Vali Acc: 0.967 Test Loss: 0.109 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 4.3821845054626465
Epoch: 30, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.141 Vali Acc: 0.966 Test Loss: 0.141 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.822491407394409
Epoch: 31, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.157 Vali Acc: 0.969 Test Loss: 0.157 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 4.2118754386901855
Epoch: 32, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.136 Vali Acc: 0.964 Test Loss: 0.136 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.7594518661499023
Epoch: 33, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.096 Vali Acc: 0.971 Test Loss: 0.096 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.520348072052002
Epoch: 34, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.8156497478485107
Epoch: 35, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.150 Vali Acc: 0.976 Test Loss: 0.150 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 3.9628102779388428
Epoch: 36, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.167 Vali Acc: 0.965 Test Loss: 0.167 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 3.394247531890869
Epoch: 37, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.171 Vali Acc: 0.972 Test Loss: 0.171 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 287148
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.0603249073028564
Epoch: 1, Steps: 89 | Train Loss: 2.781 Vali Loss: 2.092 Vali Acc: 0.482 Test Loss: 2.092 Test Acc: 0.482
Validation loss decreased (inf --> -0.481873).  Saving model ...
Epoch: 2 cost time: 4.25251579284668
Epoch: 2, Steps: 89 | Train Loss: 1.253 Vali Loss: 0.710 Vali Acc: 0.818 Test Loss: 0.710 Test Acc: 0.818
Validation loss decreased (-0.481873 --> -0.818238).  Saving model ...
Epoch: 3 cost time: 4.316010475158691
Epoch: 3, Steps: 89 | Train Loss: 0.534 Vali Loss: 0.413 Vali Acc: 0.886 Test Loss: 0.413 Test Acc: 0.886
Validation loss decreased (-0.818238 --> -0.885790).  Saving model ...
Epoch: 4 cost time: 4.096151828765869
Epoch: 4, Steps: 89 | Train Loss: 0.336 Vali Loss: 0.292 Vali Acc: 0.921 Test Loss: 0.292 Test Acc: 0.921
Validation loss decreased (-0.885790 --> -0.921306).  Saving model ...
Epoch: 5 cost time: 4.35994291305542
Epoch: 5, Steps: 89 | Train Loss: 0.238 Vali Loss: 0.238 Vali Acc: 0.937 Test Loss: 0.238 Test Acc: 0.937
Validation loss decreased (-0.921306 --> -0.936627).  Saving model ...
Epoch: 6 cost time: 4.074104070663452
Epoch: 6, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.173 Vali Acc: 0.951 Test Loss: 0.173 Test Acc: 0.951
Validation loss decreased (-0.936627 --> -0.950555).  Saving model ...
Epoch: 7 cost time: 4.698624134063721
Epoch: 7, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
Validation loss decreased (-0.950555 --> -0.954037).  Saving model ...
Epoch: 8 cost time: 4.2616047859191895
Epoch: 8, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.152 Vali Acc: 0.960 Test Loss: 0.152 Test Acc: 0.960
Validation loss decreased (-0.954037 --> -0.960305).  Saving model ...
Epoch: 9 cost time: 4.06235933303833
Epoch: 9, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.421846151351929
Epoch: 10, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.136 Vali Acc: 0.960 Test Loss: 0.136 Test Acc: 0.960
Validation loss decreased (-0.960305 --> -0.960305).  Saving model ...
Epoch: 11 cost time: 4.554554462432861
Epoch: 11, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.130 Vali Acc: 0.967 Test Loss: 0.130 Test Acc: 0.967
Validation loss decreased (-0.960305 --> -0.966573).  Saving model ...
Epoch: 12 cost time: 4.92397928237915
Epoch: 12, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
Validation loss decreased (-0.966573 --> -0.970751).  Saving model ...
Epoch: 13 cost time: 4.517387866973877
Epoch: 13, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.4009411334991455
Epoch: 14, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.89709734916687
Epoch: 15, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.375736236572266
Epoch: 16, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
Validation loss decreased (-0.970751 --> -0.974929).  Saving model ...
Epoch: 17 cost time: 4.500553607940674
Epoch: 17, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.159 Vali Acc: 0.952 Test Loss: 0.159 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.721730709075928
Epoch: 18, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.123 Vali Acc: 0.966 Test Loss: 0.123 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.9138529300689697
Epoch: 19, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.867466449737549
Epoch: 20, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.114 Vali Acc: 0.967 Test Loss: 0.114 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.516012191772461
Epoch: 21, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.277305603027344
Epoch: 22, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.743723392486572
Epoch: 23, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.347997188568115
Epoch: 24, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.012276887893677
Epoch: 25, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.143 Vali Acc: 0.966 Test Loss: 0.143 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.116168260574341
Epoch: 26, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9749303621169917
model parameter : 286636
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.159286737442017
Epoch: 1, Steps: 89 | Train Loss: 2.732 Vali Loss: 1.990 Vali Acc: 0.613 Test Loss: 1.990 Test Acc: 0.613
Validation loss decreased (inf --> -0.612793).  Saving model ...
Epoch: 2 cost time: 4.319003582000732
Epoch: 2, Steps: 89 | Train Loss: 1.221 Vali Loss: 0.710 Vali Acc: 0.813 Test Loss: 0.710 Test Acc: 0.813
Validation loss decreased (-0.612793 --> -0.813363).  Saving model ...
Epoch: 3 cost time: 3.857774257659912
Epoch: 3, Steps: 89 | Train Loss: 0.549 Vali Loss: 0.433 Vali Acc: 0.883 Test Loss: 0.433 Test Acc: 0.883
Validation loss decreased (-0.813363 --> -0.883004).  Saving model ...
Epoch: 4 cost time: 4.067641496658325
Epoch: 4, Steps: 89 | Train Loss: 0.344 Vali Loss: 0.294 Vali Acc: 0.924 Test Loss: 0.294 Test Acc: 0.924
Validation loss decreased (-0.883004 --> -0.924092).  Saving model ...
Epoch: 5 cost time: 3.6496694087982178
Epoch: 5, Steps: 89 | Train Loss: 0.238 Vali Loss: 0.214 Vali Acc: 0.942 Test Loss: 0.214 Test Acc: 0.942
Validation loss decreased (-0.924092 --> -0.941502).  Saving model ...
Epoch: 6 cost time: 4.366527557373047
Epoch: 6, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.167 Vali Acc: 0.953 Test Loss: 0.167 Test Acc: 0.953
Validation loss decreased (-0.941502 --> -0.953341).  Saving model ...
Epoch: 7 cost time: 4.484018087387085
Epoch: 7, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.159 Vali Acc: 0.955 Test Loss: 0.159 Test Acc: 0.955
Validation loss decreased (-0.953341 --> -0.955430).  Saving model ...
Epoch: 8 cost time: 4.466864109039307
Epoch: 8, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
Validation loss decreased (-0.955430 --> -0.957519).  Saving model ...
Epoch: 9 cost time: 4.5019354820251465
Epoch: 9, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.114 Vali Acc: 0.966 Test Loss: 0.114 Test Acc: 0.966
Validation loss decreased (-0.957519 --> -0.965876).  Saving model ...
Epoch: 10 cost time: 3.910186767578125
Epoch: 10, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.119 Vali Acc: 0.967 Test Loss: 0.119 Test Acc: 0.967
Validation loss decreased (-0.965876 --> -0.966573).  Saving model ...
Epoch: 11 cost time: 3.8384757041931152
Epoch: 11, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.097 Vali Acc: 0.969 Test Loss: 0.097 Test Acc: 0.969
Validation loss decreased (-0.966573 --> -0.968662).  Saving model ...
Epoch: 12 cost time: 4.043477535247803
Epoch: 12, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.120 Vali Acc: 0.960 Test Loss: 0.120 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.790421724319458
Epoch: 13, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.728013038635254
Epoch: 14, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.118 Vali Acc: 0.972 Test Loss: 0.118 Test Acc: 0.972
Validation loss decreased (-0.968662 --> -0.972144).  Saving model ...
Epoch: 15 cost time: 4.00192666053772
Epoch: 15, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.130 Vali Acc: 0.961 Test Loss: 0.130 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.0595619678497314
Epoch: 16, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.770902156829834
Epoch: 17, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.848270893096924
Epoch: 18, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.972144 --> -0.977019).  Saving model ...
Epoch: 19 cost time: 4.108625411987305
Epoch: 19, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.108 Vali Acc: 0.972 Test Loss: 0.108 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.472715616226196
Epoch: 20, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.174 Vali Acc: 0.960 Test Loss: 0.174 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.534998178482056
Epoch: 21, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.2716169357299805
Epoch: 22, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.248950958251953
Epoch: 23, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.134 Vali Acc: 0.964 Test Loss: 0.134 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.9978373050689697
Epoch: 24, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
Validation loss decreased (-0.977019 --> -0.977715).  Saving model ...
Epoch: 25 cost time: 3.738389253616333
Epoch: 25, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.086 Vali Acc: 0.974 Test Loss: 0.086 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.738090515136719
Epoch: 26, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.74233341217041
Epoch: 27, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.184 Vali Acc: 0.953 Test Loss: 0.184 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.228801250457764
Epoch: 28, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.154 Vali Acc: 0.964 Test Loss: 0.154 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.9593749046325684
Epoch: 29, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.501757621765137
Epoch: 30, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.121 Vali Acc: 0.974 Test Loss: 0.121 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 4.60460638999939
Epoch: 31, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.165 Vali Acc: 0.962 Test Loss: 0.165 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 4.484084606170654
Epoch: 32, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 4.396708011627197
Epoch: 33, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
Validation loss decreased (-0.977715 --> -0.981197).  Saving model ...
Epoch: 34 cost time: 4.096580505371094
Epoch: 34, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.9590651988983154
Epoch: 35, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.9233181476593018
Epoch: 36, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.8498196601867676
Epoch: 37, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.200 Vali Acc: 0.952 Test Loss: 0.200 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 4.0396482944488525
Epoch: 38, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.175 Vali Acc: 0.964 Test Loss: 0.175 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 4.604640007019043
Epoch: 39, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.151 Vali Acc: 0.971 Test Loss: 0.151 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 4.334360122680664
Epoch: 40, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 4.744349479675293
Epoch: 41, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.938807249069214
Epoch: 42, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.157 Vali Acc: 0.968 Test Loss: 0.157 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 4.357980251312256
Epoch: 43, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.150 Vali Acc: 0.969 Test Loss: 0.150 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 286124
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.996302843093872
Epoch: 1, Steps: 89 | Train Loss: 2.681 Vali Loss: 1.906 Vali Acc: 0.602 Test Loss: 1.906 Test Acc: 0.602
Validation loss decreased (inf --> -0.601652).  Saving model ...
Epoch: 2 cost time: 3.911461591720581
Epoch: 2, Steps: 89 | Train Loss: 1.182 Vali Loss: 0.700 Vali Acc: 0.804 Test Loss: 0.700 Test Acc: 0.804
Validation loss decreased (-0.601652 --> -0.803614).  Saving model ...
Epoch: 3 cost time: 3.8002848625183105
Epoch: 3, Steps: 89 | Train Loss: 0.527 Vali Loss: 0.410 Vali Acc: 0.890 Test Loss: 0.410 Test Acc: 0.890
Validation loss decreased (-0.803614 --> -0.889968).  Saving model ...
Epoch: 4 cost time: 3.9558353424072266
Epoch: 4, Steps: 89 | Train Loss: 0.326 Vali Loss: 0.283 Vali Acc: 0.926 Test Loss: 0.283 Test Acc: 0.926
Validation loss decreased (-0.889968 --> -0.926181).  Saving model ...
Epoch: 5 cost time: 3.922429084777832
Epoch: 5, Steps: 89 | Train Loss: 0.224 Vali Loss: 0.205 Vali Acc: 0.949 Test Loss: 0.205 Test Acc: 0.949
Validation loss decreased (-0.926181 --> -0.949162).  Saving model ...
Epoch: 6 cost time: 3.8254716396331787
Epoch: 6, Steps: 89 | Train Loss: 0.182 Vali Loss: 0.172 Vali Acc: 0.950 Test Loss: 0.172 Test Acc: 0.950
Validation loss decreased (-0.949162 --> -0.949859).  Saving model ...
Epoch: 7 cost time: 3.7677557468414307
Epoch: 7, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.138 Vali Acc: 0.964 Test Loss: 0.138 Test Acc: 0.964
Validation loss decreased (-0.949859 --> -0.963787).  Saving model ...
Epoch: 8 cost time: 4.281381368637085
Epoch: 8, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
Validation loss decreased (-0.963787 --> -0.967269).  Saving model ...
Epoch: 9 cost time: 4.114576578140259
Epoch: 9, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.136 Vali Acc: 0.968 Test Loss: 0.136 Test Acc: 0.968
Validation loss decreased (-0.967269 --> -0.967965).  Saving model ...
Epoch: 10 cost time: 3.8736770153045654
Epoch: 10, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.186 Vali Acc: 0.939 Test Loss: 0.186 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.3685455322265625
Epoch: 11, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.105 Vali Acc: 0.971 Test Loss: 0.105 Test Acc: 0.971
Validation loss decreased (-0.967965 --> -0.970751).  Saving model ...
Epoch: 12 cost time: 3.83141827583313
Epoch: 12, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.122 Vali Acc: 0.960 Test Loss: 0.122 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.4318041801452637
Epoch: 13, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.8355371952056885
Epoch: 14, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.152 Vali Acc: 0.960 Test Loss: 0.152 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.8866615295410156
Epoch: 15, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.116 Vali Acc: 0.963 Test Loss: 0.116 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.7225594520568848
Epoch: 16, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.3073713779449463
Epoch: 17, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.489386796951294
Epoch: 18, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.108 Vali Acc: 0.969 Test Loss: 0.108 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.893665075302124
Epoch: 19, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.133 Vali Acc: 0.964 Test Loss: 0.133 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.8096377849578857
Epoch: 20, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.7046427726745605
Epoch: 21, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9707520891364902
model parameter : 285612
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.999428987503052
Epoch: 1, Steps: 89 | Train Loss: 2.770 Vali Loss: 2.082 Vali Acc: 0.568 Test Loss: 2.082 Test Acc: 0.568
Validation loss decreased (inf --> -0.568224).  Saving model ...
Epoch: 2 cost time: 3.123137950897217
Epoch: 2, Steps: 89 | Train Loss: 1.259 Vali Loss: 0.726 Vali Acc: 0.814 Test Loss: 0.726 Test Acc: 0.814
Validation loss decreased (-0.568224 --> -0.814060).  Saving model ...
Epoch: 3 cost time: 3.97979998588562
Epoch: 3, Steps: 89 | Train Loss: 0.566 Vali Loss: 0.436 Vali Acc: 0.887 Test Loss: 0.436 Test Acc: 0.887
Validation loss decreased (-0.814060 --> -0.887182).  Saving model ...
Epoch: 4 cost time: 3.734130382537842
Epoch: 4, Steps: 89 | Train Loss: 0.351 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
Validation loss decreased (-0.887182 --> -0.917128).  Saving model ...
Epoch: 5 cost time: 4.070230960845947
Epoch: 5, Steps: 89 | Train Loss: 0.239 Vali Loss: 0.226 Vali Acc: 0.941 Test Loss: 0.226 Test Acc: 0.941
Validation loss decreased (-0.917128 --> -0.940806).  Saving model ...
Epoch: 6 cost time: 4.185452461242676
Epoch: 6, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.213 Vali Acc: 0.941 Test Loss: 0.213 Test Acc: 0.941
Validation loss decreased (-0.940806 --> -0.940806).  Saving model ...
Epoch: 7 cost time: 3.6373555660247803
Epoch: 7, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.161 Vali Acc: 0.956 Test Loss: 0.161 Test Acc: 0.956
Validation loss decreased (-0.940806 --> -0.956127).  Saving model ...
Epoch: 8 cost time: 4.146309852600098
Epoch: 8, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
Validation loss decreased (-0.956127 --> -0.961698).  Saving model ...
Epoch: 9 cost time: 3.5425519943237305
Epoch: 9, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.127 Vali Acc: 0.964 Test Loss: 0.127 Test Acc: 0.964
Validation loss decreased (-0.961698 --> -0.963787).  Saving model ...
Epoch: 10 cost time: 3.871419906616211
Epoch: 10, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.137 Vali Acc: 0.958 Test Loss: 0.137 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.4504408836364746
Epoch: 11, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.602126359939575
Epoch: 12, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
Validation loss decreased (-0.963787 --> -0.965180).  Saving model ...
Epoch: 13 cost time: 4.072575092315674
Epoch: 13, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.7722175121307373
Epoch: 14, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.103 Vali Acc: 0.969 Test Loss: 0.103 Test Acc: 0.969
Validation loss decreased (-0.965180 --> -0.969358).  Saving model ...
Epoch: 15 cost time: 3.852586507797241
Epoch: 15, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.114 Vali Acc: 0.967 Test Loss: 0.114 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.7053210735321045
Epoch: 16, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.970751).  Saving model ...
Epoch: 17 cost time: 4.04622745513916
Epoch: 17, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.112 Vali Acc: 0.969 Test Loss: 0.112 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.639500617980957
Epoch: 18, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.970751 --> -0.972840).  Saving model ...
Epoch: 19 cost time: 3.921532154083252
Epoch: 19, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.973536).  Saving model ...
Epoch: 20 cost time: 4.074090242385864
Epoch: 20, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.112 Vali Acc: 0.967 Test Loss: 0.112 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.5161867141723633
Epoch: 21, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.039350986480713
Epoch: 22, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (-0.973536 --> -0.976322).  Saving model ...
Epoch: 23 cost time: 4.443519353866577
Epoch: 23, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.989288330078125
Epoch: 24, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.563261270523071
Epoch: 25, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.184 Vali Acc: 0.959 Test Loss: 0.184 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.7725541591644287
Epoch: 26, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.6940648555755615
Epoch: 27, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.161 Vali Acc: 0.961 Test Loss: 0.161 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.5709450244903564
Epoch: 28, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.136 Vali Acc: 0.966 Test Loss: 0.136 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.031890153884888
Epoch: 29, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 4.549269676208496
Epoch: 30, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 4.732339859008789
Epoch: 31, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976322 --> -0.977018).  Saving model ...
Epoch: 32 cost time: 4.434105396270752
Epoch: 32, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.126 Vali Acc: 0.964 Test Loss: 0.126 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.9845921993255615
Epoch: 33, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 4.332258701324463
Epoch: 34, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.175 Vali Acc: 0.954 Test Loss: 0.175 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.7093429565429688
Epoch: 35, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.555344343185425
Epoch: 36, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.193 Vali Acc: 0.959 Test Loss: 0.193 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 4.097529172897339
Epoch: 37, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.129 Vali Acc: 0.974 Test Loss: 0.129 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 4.416228532791138
Epoch: 38, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.142 Vali Acc: 0.967 Test Loss: 0.142 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 4.071423292160034
Epoch: 39, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.292 Vali Acc: 0.942 Test Loss: 0.292 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 4.202605247497559
Epoch: 40, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.180 Vali Acc: 0.971 Test Loss: 0.180 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.6970598697662354
Epoch: 41, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.125 Vali Acc: 0.976 Test Loss: 0.125 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 187308
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.0495452880859375
Epoch: 1, Steps: 89 | Train Loss: 2.710 Vali Loss: 2.010 Vali Acc: 0.635 Test Loss: 2.010 Test Acc: 0.635
Validation loss decreased (inf --> -0.635077).  Saving model ...
Epoch: 2 cost time: 3.9803922176361084
Epoch: 2, Steps: 89 | Train Loss: 1.220 Vali Loss: 0.698 Vali Acc: 0.830 Test Loss: 0.698 Test Acc: 0.830
Validation loss decreased (-0.635077 --> -0.830077).  Saving model ...
Epoch: 3 cost time: 3.59040904045105
Epoch: 3, Steps: 89 | Train Loss: 0.532 Vali Loss: 0.438 Vali Acc: 0.872 Test Loss: 0.438 Test Acc: 0.872
Validation loss decreased (-0.830077 --> -0.871862).  Saving model ...
Epoch: 4 cost time: 3.8204123973846436
Epoch: 4, Steps: 89 | Train Loss: 0.353 Vali Loss: 0.307 Vali Acc: 0.923 Test Loss: 0.307 Test Acc: 0.923
Validation loss decreased (-0.871862 --> -0.923395).  Saving model ...
Epoch: 5 cost time: 3.8877298831939697
Epoch: 5, Steps: 89 | Train Loss: 0.243 Vali Loss: 0.215 Vali Acc: 0.939 Test Loss: 0.215 Test Acc: 0.939
Validation loss decreased (-0.923395 --> -0.938717).  Saving model ...
Epoch: 6 cost time: 3.899203300476074
Epoch: 6, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.207 Vali Acc: 0.942 Test Loss: 0.207 Test Acc: 0.942
Validation loss decreased (-0.938717 --> -0.941502).  Saving model ...
Epoch: 7 cost time: 4.514368057250977
Epoch: 7, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.160 Vali Acc: 0.955 Test Loss: 0.160 Test Acc: 0.955
Validation loss decreased (-0.941502 --> -0.954734).  Saving model ...
Epoch: 8 cost time: 4.7901623249053955
Epoch: 8, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.135 Vali Acc: 0.961 Test Loss: 0.135 Test Acc: 0.961
Validation loss decreased (-0.954734 --> -0.961001).  Saving model ...
Epoch: 9 cost time: 4.382015228271484
Epoch: 9, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.147 Vali Acc: 0.958 Test Loss: 0.147 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.110154628753662
Epoch: 10, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.168 Vali Acc: 0.947 Test Loss: 0.168 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.254488945007324
Epoch: 11, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.178 Vali Acc: 0.936 Test Loss: 0.178 Test Acc: 0.936
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.09460711479187
Epoch: 12, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.110 Vali Acc: 0.969 Test Loss: 0.110 Test Acc: 0.969
Validation loss decreased (-0.961001 --> -0.968662).  Saving model ...
Epoch: 13 cost time: 3.9918549060821533
Epoch: 13, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.116 Vali Acc: 0.966 Test Loss: 0.116 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.433009386062622
Epoch: 14, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.135 Vali Acc: 0.961 Test Loss: 0.135 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.614379644393921
Epoch: 15, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.59456992149353
Epoch: 16, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.121 Vali Acc: 0.964 Test Loss: 0.121 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.524590492248535
Epoch: 17, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.955116510391235
Epoch: 18, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.223713159561157
Epoch: 19, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.110 Vali Acc: 0.971 Test Loss: 0.110 Test Acc: 0.971
Validation loss decreased (-0.968662 --> -0.971447).  Saving model ...
Epoch: 20 cost time: 4.2048163414001465
Epoch: 20, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.154 Vali Acc: 0.955 Test Loss: 0.154 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.1298828125
Epoch: 21, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.126 Vali Acc: 0.964 Test Loss: 0.126 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.9859459400177
Epoch: 22, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
Validation loss decreased (-0.971447 --> -0.971447).  Saving model ...
Epoch: 23 cost time: 4.154973983764648
Epoch: 23, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.208763360977173
Epoch: 24, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.100 Vali Acc: 0.972 Test Loss: 0.100 Test Acc: 0.972
Validation loss decreased (-0.971447 --> -0.972144).  Saving model ...
Epoch: 25 cost time: 4.225511312484741
Epoch: 25, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.133 Vali Acc: 0.969 Test Loss: 0.133 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.738187313079834
Epoch: 26, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
Validation loss decreased (-0.972144 --> -0.974233).  Saving model ...
Epoch: 27 cost time: 4.380776405334473
Epoch: 27, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.980551242828369
Epoch: 28, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.119 Vali Acc: 0.971 Test Loss: 0.119 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.7755179405212402
Epoch: 29, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.137661933898926
Epoch: 30, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.131 Vali Acc: 0.971 Test Loss: 0.131 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 4.280604124069214
Epoch: 31, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.159 Vali Acc: 0.964 Test Loss: 0.159 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.988945484161377
Epoch: 32, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.9369876384735107
Epoch: 33, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.9186911582946777
Epoch: 34, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.148 Vali Acc: 0.967 Test Loss: 0.148 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.9527246952056885
Epoch: 35, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.218 Vali Acc: 0.954 Test Loss: 0.218 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 4.101625919342041
Epoch: 36, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.147 Vali Acc: 0.968 Test Loss: 0.147 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.974233983286908
model parameter : 186796
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.575963020324707
Epoch: 1, Steps: 89 | Train Loss: 2.763 Vali Loss: 2.077 Vali Acc: 0.544 Test Loss: 2.077 Test Acc: 0.544
Validation loss decreased (inf --> -0.543851).  Saving model ...
Epoch: 2 cost time: 4.1992998123168945
Epoch: 2, Steps: 89 | Train Loss: 1.277 Vali Loss: 0.749 Vali Acc: 0.811 Test Loss: 0.749 Test Acc: 0.811
Validation loss decreased (-0.543851 --> -0.811274).  Saving model ...
Epoch: 3 cost time: 3.627373218536377
Epoch: 3, Steps: 89 | Train Loss: 0.547 Vali Loss: 0.424 Vali Acc: 0.885 Test Loss: 0.424 Test Acc: 0.885
Validation loss decreased (-0.811274 --> -0.885093).  Saving model ...
Epoch: 4 cost time: 4.298661470413208
Epoch: 4, Steps: 89 | Train Loss: 0.356 Vali Loss: 0.323 Vali Acc: 0.916 Test Loss: 0.323 Test Acc: 0.916
Validation loss decreased (-0.885093 --> -0.916431).  Saving model ...
Epoch: 5 cost time: 4.371317386627197
Epoch: 5, Steps: 89 | Train Loss: 0.236 Vali Loss: 0.265 Vali Acc: 0.911 Test Loss: 0.265 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.9977223873138428
Epoch: 6, Steps: 89 | Train Loss: 0.192 Vali Loss: 0.181 Vali Acc: 0.955 Test Loss: 0.181 Test Acc: 0.955
Validation loss decreased (-0.916431 --> -0.954734).  Saving model ...
Epoch: 7 cost time: 3.6421988010406494
Epoch: 7, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.151 Vali Acc: 0.960 Test Loss: 0.151 Test Acc: 0.960
Validation loss decreased (-0.954734 --> -0.960305).  Saving model ...
Epoch: 8 cost time: 3.5324625968933105
Epoch: 8, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.158 Vali Acc: 0.956 Test Loss: 0.158 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.7405030727386475
Epoch: 9, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.149 Vali Acc: 0.958 Test Loss: 0.149 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.210411787033081
Epoch: 10, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.150 Vali Acc: 0.955 Test Loss: 0.150 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.5683913230896
Epoch: 11, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
Validation loss decreased (-0.960305 --> -0.965180).  Saving model ...
Epoch: 12 cost time: 4.387743949890137
Epoch: 12, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.108 Vali Acc: 0.966 Test Loss: 0.108 Test Acc: 0.966
Validation loss decreased (-0.965180 --> -0.965876).  Saving model ...
Epoch: 13 cost time: 4.043285608291626
Epoch: 13, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
Validation loss decreased (-0.965876 --> -0.973537).  Saving model ...
Epoch: 14 cost time: 4.242257595062256
Epoch: 14, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.593101978302002
Epoch: 15, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.9714877605438232
Epoch: 16, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.113 Vali Acc: 0.964 Test Loss: 0.113 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.4442055225372314
Epoch: 17, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.141 Vali Acc: 0.966 Test Loss: 0.141 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.886944532394409
Epoch: 18, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.9877407550811768
Epoch: 19, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.152 Vali Acc: 0.962 Test Loss: 0.152 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.128579378128052
Epoch: 20, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.195444345474243
Epoch: 21, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.8933348655700684
Epoch: 22, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.10418438911438
Epoch: 23, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9735376044568245
model parameter : 186284
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.830840349197388
Epoch: 1, Steps: 89 | Train Loss: 2.797 Vali Loss: 2.168 Vali Acc: 0.449 Test Loss: 2.168 Test Acc: 0.449
Validation loss decreased (inf --> -0.449143).  Saving model ...
Epoch: 2 cost time: 4.139761924743652
Epoch: 2, Steps: 89 | Train Loss: 1.358 Vali Loss: 0.775 Vali Acc: 0.803 Test Loss: 0.775 Test Acc: 0.803
Validation loss decreased (-0.449143 --> -0.802917).  Saving model ...
Epoch: 3 cost time: 4.014824390411377
Epoch: 3, Steps: 89 | Train Loss: 0.568 Vali Loss: 0.433 Vali Acc: 0.891 Test Loss: 0.433 Test Acc: 0.891
Validation loss decreased (-0.802917 --> -0.890664).  Saving model ...
Epoch: 4 cost time: 3.874652624130249
Epoch: 4, Steps: 89 | Train Loss: 0.360 Vali Loss: 0.287 Vali Acc: 0.928 Test Loss: 0.287 Test Acc: 0.928
Validation loss decreased (-0.890664 --> -0.927574).  Saving model ...
Epoch: 5 cost time: 3.8103575706481934
Epoch: 5, Steps: 89 | Train Loss: 0.244 Vali Loss: 0.241 Vali Acc: 0.939 Test Loss: 0.241 Test Acc: 0.939
Validation loss decreased (-0.927574 --> -0.938716).  Saving model ...
Epoch: 6 cost time: 3.9221014976501465
Epoch: 6, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.224 Vali Acc: 0.937 Test Loss: 0.224 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.280533790588379
Epoch: 7, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.173 Vali Acc: 0.951 Test Loss: 0.173 Test Acc: 0.951
Validation loss decreased (-0.938716 --> -0.950555).  Saving model ...
Epoch: 8 cost time: 4.22212553024292
Epoch: 8, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.172 Vali Acc: 0.955 Test Loss: 0.172 Test Acc: 0.955
Validation loss decreased (-0.950555 --> -0.955430).  Saving model ...
Epoch: 9 cost time: 4.230037450790405
Epoch: 9, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.156 Vali Acc: 0.960 Test Loss: 0.156 Test Acc: 0.960
Validation loss decreased (-0.955430 --> -0.960305).  Saving model ...
Epoch: 10 cost time: 5.057846307754517
Epoch: 10, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.09725284576416
Epoch: 11, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.153 Vali Acc: 0.955 Test Loss: 0.153 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.386411190032959
Epoch: 12, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.135 Vali Acc: 0.963 Test Loss: 0.135 Test Acc: 0.963
Validation loss decreased (-0.960305 --> -0.963091).  Saving model ...
Epoch: 13 cost time: 4.776209115982056
Epoch: 13, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.89243221282959
Epoch: 14, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.122 Vali Acc: 0.964 Test Loss: 0.122 Test Acc: 0.964
Validation loss decreased (-0.963091 --> -0.963787).  Saving model ...
Epoch: 15 cost time: 3.7034878730773926
Epoch: 15, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.103 Vali Acc: 0.969 Test Loss: 0.103 Test Acc: 0.969
Validation loss decreased (-0.963787 --> -0.969358).  Saving model ...
Epoch: 16 cost time: 4.393283128738403
Epoch: 16, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.110 Vali Acc: 0.971 Test Loss: 0.110 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.971447).  Saving model ...
Epoch: 17 cost time: 4.634113073348999
Epoch: 17, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.971447 --> -0.972840).  Saving model ...
Epoch: 18 cost time: 4.29178261756897
Epoch: 18, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.111 Vali Acc: 0.964 Test Loss: 0.111 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.203489303588867
Epoch: 19, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.136 Vali Acc: 0.964 Test Loss: 0.136 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.264370918273926
Epoch: 20, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.107 Vali Acc: 0.969 Test Loss: 0.107 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.203892230987549
Epoch: 21, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.110 Vali Acc: 0.969 Test Loss: 0.110 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.023751974105835
Epoch: 22, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.975626).  Saving model ...
Epoch: 23 cost time: 4.007753372192383
Epoch: 23, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.233603239059448
Epoch: 24, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.550086259841919
Epoch: 25, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.975626 --> -0.979804).  Saving model ...
Epoch: 26 cost time: 4.202971696853638
Epoch: 26, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.269773960113525
Epoch: 27, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.122 Vali Acc: 0.966 Test Loss: 0.122 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.7275545597076416
Epoch: 28, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.165 Vali Acc: 0.961 Test Loss: 0.165 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.917469024658203
Epoch: 29, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.155 Vali Acc: 0.964 Test Loss: 0.155 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 4.261461496353149
Epoch: 30, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.139 Vali Acc: 0.968 Test Loss: 0.139 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 4.598637819290161
Epoch: 31, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.8398871421813965
Epoch: 32, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 4.224554538726807
Epoch: 33, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.157 Vali Acc: 0.962 Test Loss: 0.157 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.731222629547119
Epoch: 34, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.126 Vali Acc: 0.974 Test Loss: 0.126 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 4.264023303985596
Epoch: 35, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.220 Vali Acc: 0.960 Test Loss: 0.220 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 185772
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.328431129455566
Epoch: 1, Steps: 89 | Train Loss: 2.753 Vali Loss: 2.165 Vali Acc: 0.575 Test Loss: 2.165 Test Acc: 0.575
Validation loss decreased (inf --> -0.575187).  Saving model ...
Epoch: 2 cost time: 4.127051830291748
Epoch: 2, Steps: 89 | Train Loss: 1.402 Vali Loss: 0.789 Vali Acc: 0.813 Test Loss: 0.789 Test Acc: 0.813
Validation loss decreased (-0.575187 --> -0.813363).  Saving model ...
Epoch: 3 cost time: 4.0942559242248535
Epoch: 3, Steps: 89 | Train Loss: 0.594 Vali Loss: 0.474 Vali Acc: 0.865 Test Loss: 0.474 Test Acc: 0.865
Validation loss decreased (-0.813363 --> -0.864898).  Saving model ...
Epoch: 4 cost time: 4.126666307449341
Epoch: 4, Steps: 89 | Train Loss: 0.352 Vali Loss: 0.306 Vali Acc: 0.912 Test Loss: 0.306 Test Acc: 0.912
Validation loss decreased (-0.864898 --> -0.911557).  Saving model ...
Epoch: 5 cost time: 4.547955274581909
Epoch: 5, Steps: 89 | Train Loss: 0.252 Vali Loss: 0.242 Vali Acc: 0.927 Test Loss: 0.242 Test Acc: 0.927
Validation loss decreased (-0.911557 --> -0.926878).  Saving model ...
Epoch: 6 cost time: 4.766479253768921
Epoch: 6, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.194 Vali Acc: 0.946 Test Loss: 0.194 Test Acc: 0.946
Validation loss decreased (-0.926878 --> -0.946377).  Saving model ...
Epoch: 7 cost time: 4.287436008453369
Epoch: 7, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.176 Vali Acc: 0.946 Test Loss: 0.176 Test Acc: 0.946
Validation loss decreased (-0.946377 --> -0.946377).  Saving model ...
Epoch: 8 cost time: 4.258158445358276
Epoch: 8, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
Validation loss decreased (-0.946377 --> -0.958216).  Saving model ...
Epoch: 9 cost time: 4.481651782989502
Epoch: 9, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.134 Vali Acc: 0.960 Test Loss: 0.134 Test Acc: 0.960
Validation loss decreased (-0.958216 --> -0.959609).  Saving model ...
Epoch: 10 cost time: 4.529804944992065
Epoch: 10, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
Validation loss decreased (-0.959609 --> -0.961698).  Saving model ...
Epoch: 11 cost time: 4.443610191345215
Epoch: 11, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.120 Vali Acc: 0.966 Test Loss: 0.120 Test Acc: 0.966
Validation loss decreased (-0.961698 --> -0.965876).  Saving model ...
Epoch: 12 cost time: 3.7880733013153076
Epoch: 12, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
Validation loss decreased (-0.965876 --> -0.967965).  Saving model ...
Epoch: 13 cost time: 4.174579858779907
Epoch: 13, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.110 Vali Acc: 0.969 Test Loss: 0.110 Test Acc: 0.969
Validation loss decreased (-0.967965 --> -0.969358).  Saving model ...
Epoch: 14 cost time: 3.8930118083953857
Epoch: 14, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.109 Vali Acc: 0.969 Test Loss: 0.109 Test Acc: 0.969
Validation loss decreased (-0.969358 --> -0.969358).  Saving model ...
Epoch: 15 cost time: 4.297609806060791
Epoch: 15, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.920229196548462
Epoch: 16, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.127 Vali Acc: 0.961 Test Loss: 0.127 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.150821208953857
Epoch: 17, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.140 Vali Acc: 0.961 Test Loss: 0.140 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.685426712036133
Epoch: 18, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.156 Vali Acc: 0.959 Test Loss: 0.156 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.165987730026245
Epoch: 19, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.633296489715576
Epoch: 20, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.970751).  Saving model ...
Epoch: 21 cost time: 3.429502010345459
Epoch: 21, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.9971847534179688
Epoch: 22, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
Validation loss decreased (-0.970751 --> -0.973536).  Saving model ...
Epoch: 23 cost time: 4.0974462032318115
Epoch: 23, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.151 Vali Acc: 0.955 Test Loss: 0.151 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.7488980293273926
Epoch: 24, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.157 Vali Acc: 0.964 Test Loss: 0.157 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.8172569274902344
Epoch: 25, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.114 Vali Acc: 0.966 Test Loss: 0.114 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.7948553562164307
Epoch: 26, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.142 Vali Acc: 0.967 Test Loss: 0.142 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.431733131408691
Epoch: 27, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.762913227081299
Epoch: 28, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.8131368160247803
Epoch: 29, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.9714410305023193
Epoch: 30, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.167 Vali Acc: 0.955 Test Loss: 0.167 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 4.447877883911133
Epoch: 31, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.110 Vali Acc: 0.978 Test Loss: 0.110 Test Acc: 0.978
Validation loss decreased (-0.973536 --> -0.977715).  Saving model ...
Epoch: 32 cost time: 3.894313335418701
Epoch: 32, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 4.5546875
Epoch: 33, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 4.215852975845337
Epoch: 34, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.188 Vali Acc: 0.955 Test Loss: 0.188 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 4.059967994689941
Epoch: 35, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.195 Vali Acc: 0.959 Test Loss: 0.195 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 4.022005796432495
Epoch: 36, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.154 Vali Acc: 0.967 Test Loss: 0.154 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 4.0463361740112305
Epoch: 37, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.183 Vali Acc: 0.961 Test Loss: 0.183 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 4.506155014038086
Epoch: 38, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.142 Vali Acc: 0.973 Test Loss: 0.142 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.553618907928467
Epoch: 39, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.168 Vali Acc: 0.968 Test Loss: 0.168 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.7782557010650635
Epoch: 40, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.161 Vali Acc: 0.964 Test Loss: 0.161 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.4558589458465576
Epoch: 41, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 137388
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.119687795639038
Epoch: 1, Steps: 89 | Train Loss: 2.734 Vali Loss: 2.150 Vali Acc: 0.510 Test Loss: 2.150 Test Acc: 0.510
Validation loss decreased (inf --> -0.510424).  Saving model ...
Epoch: 2 cost time: 3.840881824493408
Epoch: 2, Steps: 89 | Train Loss: 1.400 Vali Loss: 0.827 Vali Acc: 0.805 Test Loss: 0.827 Test Acc: 0.805
Validation loss decreased (-0.510424 --> -0.805006).  Saving model ...
Epoch: 3 cost time: 3.6525986194610596
Epoch: 3, Steps: 89 | Train Loss: 0.612 Vali Loss: 0.454 Vali Acc: 0.883 Test Loss: 0.454 Test Acc: 0.883
Validation loss decreased (-0.805006 --> -0.883004).  Saving model ...
Epoch: 4 cost time: 3.6226508617401123
Epoch: 4, Steps: 89 | Train Loss: 0.362 Vali Loss: 0.323 Vali Acc: 0.904 Test Loss: 0.323 Test Acc: 0.904
Validation loss decreased (-0.883004 --> -0.903896).  Saving model ...
Epoch: 5 cost time: 4.173705816268921
Epoch: 5, Steps: 89 | Train Loss: 0.247 Vali Loss: 0.230 Vali Acc: 0.942 Test Loss: 0.230 Test Acc: 0.942
Validation loss decreased (-0.903896 --> -0.942198).  Saving model ...
Epoch: 6 cost time: 3.576695442199707
Epoch: 6, Steps: 89 | Train Loss: 0.186 Vali Loss: 0.199 Vali Acc: 0.945 Test Loss: 0.199 Test Acc: 0.945
Validation loss decreased (-0.942198 --> -0.944984).  Saving model ...
Epoch: 7 cost time: 4.2088751792907715
Epoch: 7, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.191 Vali Acc: 0.951 Test Loss: 0.191 Test Acc: 0.951
Validation loss decreased (-0.944984 --> -0.950555).  Saving model ...
Epoch: 8 cost time: 3.447880744934082
Epoch: 8, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.147 Vali Acc: 0.960 Test Loss: 0.147 Test Acc: 0.960
Validation loss decreased (-0.950555 --> -0.959609).  Saving model ...
Epoch: 9 cost time: 3.6580097675323486
Epoch: 9, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.144 Vali Acc: 0.959 Test Loss: 0.144 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.5022242069244385
Epoch: 10, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.125 Vali Acc: 0.966 Test Loss: 0.125 Test Acc: 0.966
Validation loss decreased (-0.959609 --> -0.965876).  Saving model ...
Epoch: 11 cost time: 3.490412712097168
Epoch: 11, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.125 Vali Acc: 0.960 Test Loss: 0.125 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.8545455932617188
Epoch: 12, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.9073805809020996
Epoch: 13, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
Validation loss decreased (-0.965876 --> -0.967966).  Saving model ...
Epoch: 14 cost time: 4.181843280792236
Epoch: 14, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.114 Vali Acc: 0.967 Test Loss: 0.114 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.8906190395355225
Epoch: 15, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.144 Vali Acc: 0.958 Test Loss: 0.144 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.7210958003997803
Epoch: 16, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
Validation loss decreased (-0.967966 --> -0.970751).  Saving model ...
Epoch: 17 cost time: 3.9378843307495117
Epoch: 17, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.5639748573303223
Epoch: 18, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.856001377105713
Epoch: 19, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.128 Vali Acc: 0.964 Test Loss: 0.128 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.8424956798553467
Epoch: 20, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.970751 --> -0.972840).  Saving model ...
Epoch: 21 cost time: 3.5903377532958984
Epoch: 21, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.121 Vali Acc: 0.971 Test Loss: 0.121 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.708667516708374
Epoch: 22, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.5501720905303955
Epoch: 23, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.9503250122070312
Epoch: 24, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.116 Vali Acc: 0.969 Test Loss: 0.116 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.6800284385681152
Epoch: 25, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.194127321243286
Epoch: 26, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.9256391525268555
Epoch: 27, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.65447998046875
Epoch: 28, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.974233).  Saving model ...
Epoch: 29 cost time: 3.5398244857788086
Epoch: 29, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.974233 --> -0.977019).  Saving model ...
Epoch: 30 cost time: 3.417127847671509
Epoch: 30, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.977019 --> -0.979804).  Saving model ...
Epoch: 31 cost time: 4.216750860214233
Epoch: 31, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.7028815746307373
Epoch: 32, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.3509042263031006
Epoch: 33, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.148 Vali Acc: 0.973 Test Loss: 0.148 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.5800797939300537
Epoch: 34, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.171 Vali Acc: 0.963 Test Loss: 0.171 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.3657290935516357
Epoch: 35, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.146 Vali Acc: 0.970 Test Loss: 0.146 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.7436304092407227
Epoch: 36, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.189 Vali Acc: 0.962 Test Loss: 0.189 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.6248550415039062
Epoch: 37, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 4.162493467330933
Epoch: 38, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.149 Vali Acc: 0.967 Test Loss: 0.149 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 3.6442549228668213
Epoch: 39, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 3.5589382648468018
Epoch: 40, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.121 Vali Acc: 0.985 Test Loss: 0.121 Test Acc: 0.985
Validation loss decreased (-0.979804 --> -0.985375).  Saving model ...
Epoch: 41 cost time: 3.847827196121216
Epoch: 41, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.139 Vali Acc: 0.976 Test Loss: 0.139 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.8836681842803955
Epoch: 42, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.251 Vali Acc: 0.955 Test Loss: 0.251 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.642744541168213
Epoch: 43, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.144 Vali Acc: 0.976 Test Loss: 0.144 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.3589110374450684
Epoch: 44, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.165 Vali Acc: 0.970 Test Loss: 0.165 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.839381456375122
Epoch: 45, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 3.4075984954833984
Epoch: 46, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 3.805985927581787
Epoch: 47, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.247 Vali Acc: 0.955 Test Loss: 0.247 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 4.057342529296875
Epoch: 48, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 3.4682457447052
Epoch: 49, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.166 Vali Acc: 0.971 Test Loss: 0.166 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 3.7289977073669434
Epoch: 50, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.137 Vali Acc: 0.975 Test Loss: 0.137 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 136876
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.1223464012146
Epoch: 1, Steps: 89 | Train Loss: 2.681 Vali Loss: 2.038 Vali Acc: 0.581 Test Loss: 2.038 Test Acc: 0.581
Validation loss decreased (inf --> -0.580760).  Saving model ...
Epoch: 2 cost time: 3.0262959003448486
Epoch: 2, Steps: 89 | Train Loss: 1.310 Vali Loss: 0.788 Vali Acc: 0.801 Test Loss: 0.788 Test Acc: 0.801
Validation loss decreased (-0.580760 --> -0.800828).  Saving model ...
Epoch: 3 cost time: 3.264742374420166
Epoch: 3, Steps: 89 | Train Loss: 0.602 Vali Loss: 0.521 Vali Acc: 0.856 Test Loss: 0.521 Test Acc: 0.856
Validation loss decreased (-0.800828 --> -0.855844).  Saving model ...
Epoch: 4 cost time: 3.2560641765594482
Epoch: 4, Steps: 89 | Train Loss: 0.383 Vali Loss: 0.334 Vali Acc: 0.912 Test Loss: 0.334 Test Acc: 0.912
Validation loss decreased (-0.855844 --> -0.911557).  Saving model ...
Epoch: 5 cost time: 3.382488489151001
Epoch: 5, Steps: 89 | Train Loss: 0.272 Vali Loss: 0.235 Vali Acc: 0.936 Test Loss: 0.235 Test Acc: 0.936
Validation loss decreased (-0.911557 --> -0.935931).  Saving model ...
Epoch: 6 cost time: 3.6297597885131836
Epoch: 6, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
Validation loss decreased (-0.935931 --> -0.940806).  Saving model ...
Epoch: 7 cost time: 3.3101587295532227
Epoch: 7, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.176 Vali Acc: 0.946 Test Loss: 0.176 Test Acc: 0.946
Validation loss decreased (-0.940806 --> -0.945681).  Saving model ...
Epoch: 8 cost time: 3.5857903957366943
Epoch: 8, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.161 Vali Acc: 0.955 Test Loss: 0.161 Test Acc: 0.955
Validation loss decreased (-0.945681 --> -0.954734).  Saving model ...
Epoch: 9 cost time: 3.189434766769409
Epoch: 9, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.149 Vali Acc: 0.960 Test Loss: 0.149 Test Acc: 0.960
Validation loss decreased (-0.954734 --> -0.960305).  Saving model ...
Epoch: 10 cost time: 3.4746224880218506
Epoch: 10, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.9207873344421387
Epoch: 11, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.137 Vali Acc: 0.963 Test Loss: 0.137 Test Acc: 0.963
Validation loss decreased (-0.960305 --> -0.963091).  Saving model ...
Epoch: 12 cost time: 3.2221693992614746
Epoch: 12, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.7956924438476562
Epoch: 13, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.112 Vali Acc: 0.972 Test Loss: 0.112 Test Acc: 0.972
Validation loss decreased (-0.963091 --> -0.972144).  Saving model ...
Epoch: 14 cost time: 3.204238176345825
Epoch: 14, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.143714666366577
Epoch: 15, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.118 Vali Acc: 0.964 Test Loss: 0.118 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.223975419998169
Epoch: 16, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.099 Vali Acc: 0.971 Test Loss: 0.099 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.4223408699035645
Epoch: 17, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.107 Vali Acc: 0.969 Test Loss: 0.107 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.533468246459961
Epoch: 18, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.130 Vali Acc: 0.958 Test Loss: 0.130 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.425952434539795
Epoch: 19, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.133 Vali Acc: 0.964 Test Loss: 0.133 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.5389182567596436
Epoch: 20, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.249340295791626
Epoch: 21, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
Validation loss decreased (-0.972144 --> -0.974233).  Saving model ...
Epoch: 22 cost time: 3.6499855518341064
Epoch: 22, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
Validation loss decreased (-0.974233 --> -0.974929).  Saving model ...
Epoch: 23 cost time: 3.272599697113037
Epoch: 23, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.6147830486297607
Epoch: 24, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.128 Vali Acc: 0.961 Test Loss: 0.128 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.4869112968444824
Epoch: 25, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.146 Vali Acc: 0.971 Test Loss: 0.146 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.5718941688537598
Epoch: 26, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.4723808765411377
Epoch: 27, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.15006160736084
Epoch: 28, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.569638252258301
Epoch: 29, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.4768314361572266
Epoch: 30, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 4.057528018951416
Epoch: 31, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
Validation loss decreased (-0.974929 --> -0.977715).  Saving model ...
Epoch: 32 cost time: 3.531956672668457
Epoch: 32, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.188 Vali Acc: 0.956 Test Loss: 0.188 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.638850688934326
Epoch: 33, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.7422211170196533
Epoch: 34, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.564629554748535
Epoch: 35, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.124 Vali Acc: 0.974 Test Loss: 0.124 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.7414116859436035
Epoch: 36, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.161 Vali Acc: 0.965 Test Loss: 0.161 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.6509408950805664
Epoch: 37, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.149 Vali Acc: 0.971 Test Loss: 0.149 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.7153327465057373
Epoch: 38, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.179 Vali Acc: 0.961 Test Loss: 0.179 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.420053482055664
Epoch: 39, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.660698890686035
Epoch: 40, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.2660210132598877
Epoch: 41, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 136364
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.266045331954956
Epoch: 1, Steps: 89 | Train Loss: 2.819 Vali Loss: 2.239 Vali Acc: 0.501 Test Loss: 2.239 Test Acc: 0.501
Validation loss decreased (inf --> -0.501370).  Saving model ...
Epoch: 2 cost time: 3.368497610092163
Epoch: 2, Steps: 89 | Train Loss: 1.459 Vali Loss: 0.836 Vali Acc: 0.767 Test Loss: 0.836 Test Acc: 0.767
Validation loss decreased (-0.501370 --> -0.767401).  Saving model ...
Epoch: 3 cost time: 3.1874349117279053
Epoch: 3, Steps: 89 | Train Loss: 0.608 Vali Loss: 0.457 Vali Acc: 0.884 Test Loss: 0.457 Test Acc: 0.884
Validation loss decreased (-0.767401 --> -0.884397).  Saving model ...
Epoch: 4 cost time: 3.415391683578491
Epoch: 4, Steps: 89 | Train Loss: 0.370 Vali Loss: 0.333 Vali Acc: 0.898 Test Loss: 0.333 Test Acc: 0.898
Validation loss decreased (-0.884397 --> -0.897629).  Saving model ...
Epoch: 5 cost time: 3.060826301574707
Epoch: 5, Steps: 89 | Train Loss: 0.258 Vali Loss: 0.247 Vali Acc: 0.928 Test Loss: 0.247 Test Acc: 0.928
Validation loss decreased (-0.897629 --> -0.927574).  Saving model ...
Epoch: 6 cost time: 3.237997055053711
Epoch: 6, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.190 Vali Acc: 0.955 Test Loss: 0.190 Test Acc: 0.955
Validation loss decreased (-0.927574 --> -0.955430).  Saving model ...
Epoch: 7 cost time: 3.358656644821167
Epoch: 7, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.183 Vali Acc: 0.945 Test Loss: 0.183 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.670711040496826
Epoch: 8, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.170 Vali Acc: 0.948 Test Loss: 0.170 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.655299425125122
Epoch: 9, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.159 Vali Acc: 0.953 Test Loss: 0.159 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.4125614166259766
Epoch: 10, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.139 Vali Acc: 0.959 Test Loss: 0.139 Test Acc: 0.959
Validation loss decreased (-0.955430 --> -0.958912).  Saving model ...
Epoch: 11 cost time: 3.1274313926696777
Epoch: 11, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.129 Vali Acc: 0.964 Test Loss: 0.129 Test Acc: 0.964
Validation loss decreased (-0.958912 --> -0.963787).  Saving model ...
Epoch: 12 cost time: 3.4303503036499023
Epoch: 12, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.132 Vali Acc: 0.964 Test Loss: 0.132 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.079373598098755
Epoch: 13, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.141 Vali Acc: 0.961 Test Loss: 0.141 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.4045138359069824
Epoch: 14, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.138 Vali Acc: 0.960 Test Loss: 0.138 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.422473430633545
Epoch: 15, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
Validation loss decreased (-0.963787 --> -0.966573).  Saving model ...
Epoch: 16 cost time: 3.150885581970215
Epoch: 16, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.108 Vali Acc: 0.967 Test Loss: 0.108 Test Acc: 0.967
Validation loss decreased (-0.966573 --> -0.967269).  Saving model ...
Epoch: 17 cost time: 3.318166494369507
Epoch: 17, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.125 Vali Acc: 0.969 Test Loss: 0.125 Test Acc: 0.969
Validation loss decreased (-0.967269 --> -0.968662).  Saving model ...
Epoch: 18 cost time: 3.091536283493042
Epoch: 18, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.122 Vali Acc: 0.966 Test Loss: 0.122 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.594451904296875
Epoch: 19, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.127 Vali Acc: 0.963 Test Loss: 0.127 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.808109998703003
Epoch: 20, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.125 Vali Acc: 0.972 Test Loss: 0.125 Test Acc: 0.972
Validation loss decreased (-0.968662 --> -0.972144).  Saving model ...
Epoch: 21 cost time: 3.434589385986328
Epoch: 21, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.177 Vali Acc: 0.955 Test Loss: 0.177 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.494570732116699
Epoch: 22, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.725482702255249
Epoch: 23, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.094 Vali Acc: 0.972 Test Loss: 0.094 Test Acc: 0.972
Validation loss decreased (-0.972144 --> -0.972144).  Saving model ...
Epoch: 24 cost time: 3.759748697280884
Epoch: 24, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.110 Vali Acc: 0.972 Test Loss: 0.110 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.741971015930176
Epoch: 25, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.107 Vali Acc: 0.972 Test Loss: 0.107 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.525385856628418
Epoch: 26, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.972144 --> -0.972840).  Saving model ...
Epoch: 27 cost time: 3.5497984886169434
Epoch: 27, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.282458543777466
Epoch: 28, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.5366501808166504
Epoch: 29, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.136 Vali Acc: 0.969 Test Loss: 0.136 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.2493984699249268
Epoch: 30, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.163 Vali Acc: 0.963 Test Loss: 0.163 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.221447467803955
Epoch: 31, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.4829156398773193
Epoch: 32, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.976322).  Saving model ...
Epoch: 33 cost time: 3.753823757171631
Epoch: 33, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976322 --> -0.977018).  Saving model ...
Epoch: 34 cost time: 3.271355152130127
Epoch: 34, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 4.0702598094940186
Epoch: 35, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.2871408462524414
Epoch: 36, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.149 Vali Acc: 0.968 Test Loss: 0.149 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.9059932231903076
Epoch: 37, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.165 Vali Acc: 0.962 Test Loss: 0.165 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.6690993309020996
Epoch: 38, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.124 Vali Acc: 0.974 Test Loss: 0.124 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.07336163520813
Epoch: 39, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.5966718196868896
Epoch: 40, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.143 Vali Acc: 0.969 Test Loss: 0.143 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.372166633605957
Epoch: 41, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.203 Vali Acc: 0.960 Test Loss: 0.203 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.7684996128082275
Epoch: 42, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.122 Vali Acc: 0.976 Test Loss: 0.122 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 3.692190170288086
Epoch: 43, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 135852
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.903000593185425
Epoch: 1, Steps: 89 | Train Loss: 2.778 Vali Loss: 2.223 Vali Acc: 0.426 Test Loss: 2.223 Test Acc: 0.426
Validation loss decreased (inf --> -0.426162).  Saving model ...
Epoch: 2 cost time: 3.151926279067993
Epoch: 2, Steps: 89 | Train Loss: 1.472 Vali Loss: 0.879 Vali Acc: 0.739 Test Loss: 0.879 Test Acc: 0.739
Validation loss decreased (-0.426162 --> -0.738849).  Saving model ...
Epoch: 3 cost time: 3.3652539253234863
Epoch: 3, Steps: 89 | Train Loss: 0.646 Vali Loss: 0.538 Vali Acc: 0.840 Test Loss: 0.538 Test Acc: 0.840
Validation loss decreased (-0.738849 --> -0.839827).  Saving model ...
Epoch: 4 cost time: 3.3828816413879395
Epoch: 4, Steps: 89 | Train Loss: 0.396 Vali Loss: 0.339 Vali Acc: 0.902 Test Loss: 0.339 Test Acc: 0.902
Validation loss decreased (-0.839827 --> -0.901807).  Saving model ...
Epoch: 5 cost time: 3.337190628051758
Epoch: 5, Steps: 89 | Train Loss: 0.262 Vali Loss: 0.271 Vali Acc: 0.930 Test Loss: 0.271 Test Acc: 0.930
Validation loss decreased (-0.901807 --> -0.930359).  Saving model ...
Epoch: 6 cost time: 3.431504487991333
Epoch: 6, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.196 Vali Acc: 0.945 Test Loss: 0.196 Test Acc: 0.945
Validation loss decreased (-0.930359 --> -0.944984).  Saving model ...
Epoch: 7 cost time: 3.3173534870147705
Epoch: 7, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.187 Vali Acc: 0.946 Test Loss: 0.187 Test Acc: 0.946
Validation loss decreased (-0.944984 --> -0.946377).  Saving model ...
Epoch: 8 cost time: 3.338196277618408
Epoch: 8, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.160 Vali Acc: 0.959 Test Loss: 0.160 Test Acc: 0.959
Validation loss decreased (-0.946377 --> -0.958912).  Saving model ...
Epoch: 9 cost time: 3.645780563354492
Epoch: 9, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.4569995403289795
Epoch: 10, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.3019118309020996
Epoch: 11, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.128 Vali Acc: 0.963 Test Loss: 0.128 Test Acc: 0.963
Validation loss decreased (-0.958912 --> -0.963091).  Saving model ...
Epoch: 12 cost time: 3.392746686935425
Epoch: 12, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.122 Vali Acc: 0.964 Test Loss: 0.122 Test Acc: 0.964
Validation loss decreased (-0.963091 --> -0.964483).  Saving model ...
Epoch: 13 cost time: 3.728473663330078
Epoch: 13, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.128 Vali Acc: 0.964 Test Loss: 0.128 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.5352890491485596
Epoch: 14, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
Validation loss decreased (-0.964483 --> -0.967269).  Saving model ...
Epoch: 15 cost time: 3.869946002960205
Epoch: 15, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.103 Vali Acc: 0.972 Test Loss: 0.103 Test Acc: 0.972
Validation loss decreased (-0.967269 --> -0.972144).  Saving model ...
Epoch: 16 cost time: 3.5099472999572754
Epoch: 16, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.5229110717773438
Epoch: 17, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.4096806049346924
Epoch: 18, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.175100803375244
Epoch: 19, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.120 Vali Acc: 0.966 Test Loss: 0.120 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.181537389755249
Epoch: 20, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.159 Vali Acc: 0.961 Test Loss: 0.159 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.7871220111846924
Epoch: 21, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.6567258834838867
Epoch: 22, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.115 Vali Acc: 0.969 Test Loss: 0.115 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.4219484329223633
Epoch: 23, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.109 Vali Acc: 0.967 Test Loss: 0.109 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.302795171737671
Epoch: 24, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.6024625301361084
Epoch: 25, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.972144 --> -0.972840).  Saving model ...
Epoch: 26 cost time: 3.7382798194885254
Epoch: 26, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.90515398979187
Epoch: 27, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.125 Vali Acc: 0.972 Test Loss: 0.125 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.6922457218170166
Epoch: 28, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.119 Vali Acc: 0.972 Test Loss: 0.119 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.16986083984375
Epoch: 29, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.121 Vali Acc: 0.971 Test Loss: 0.121 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.2170722484588623
Epoch: 30, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.117 Vali Acc: 0.972 Test Loss: 0.117 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.430183172225952
Epoch: 31, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.171 Vali Acc: 0.962 Test Loss: 0.171 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.454063892364502
Epoch: 32, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.137 Vali Acc: 0.964 Test Loss: 0.137 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.542356252670288
Epoch: 33, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.163 Vali Acc: 0.971 Test Loss: 0.163 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.9713099002838135
Epoch: 34, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.536115884780884
Epoch: 35, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.131 Vali Acc: 0.972 Test Loss: 0.131 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9728412256267409
model parameter : 112428
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.011861324310303
Epoch: 1, Steps: 89 | Train Loss: 2.737 Vali Loss: 2.155 Vali Acc: 0.531 Test Loss: 2.155 Test Acc: 0.531
Validation loss decreased (inf --> -0.531316).  Saving model ...
Epoch: 2 cost time: 3.5394959449768066
Epoch: 2, Steps: 89 | Train Loss: 1.432 Vali Loss: 0.807 Vali Acc: 0.817 Test Loss: 0.807 Test Acc: 0.817
Validation loss decreased (-0.531316 --> -0.816844).  Saving model ...
Epoch: 3 cost time: 3.6067631244659424
Epoch: 3, Steps: 89 | Train Loss: 0.619 Vali Loss: 0.471 Vali Acc: 0.874 Test Loss: 0.471 Test Acc: 0.874
Validation loss decreased (-0.816844 --> -0.873951).  Saving model ...
Epoch: 4 cost time: 3.8234758377075195
Epoch: 4, Steps: 89 | Train Loss: 0.387 Vali Loss: 0.349 Vali Acc: 0.900 Test Loss: 0.349 Test Acc: 0.900
Validation loss decreased (-0.873951 --> -0.899718).  Saving model ...
Epoch: 5 cost time: 4.21317982673645
Epoch: 5, Steps: 89 | Train Loss: 0.261 Vali Loss: 0.259 Vali Acc: 0.936 Test Loss: 0.259 Test Acc: 0.936
Validation loss decreased (-0.899718 --> -0.935931).  Saving model ...
Epoch: 6 cost time: 4.305766820907593
Epoch: 6, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.209 Vali Acc: 0.940 Test Loss: 0.209 Test Acc: 0.940
Validation loss decreased (-0.935931 --> -0.940109).  Saving model ...
Epoch: 7 cost time: 4.061754465103149
Epoch: 7, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.188 Vali Acc: 0.942 Test Loss: 0.188 Test Acc: 0.942
Validation loss decreased (-0.940109 --> -0.942199).  Saving model ...
Epoch: 8 cost time: 4.066546201705933
Epoch: 8, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
Validation loss decreased (-0.942199 --> -0.956823).  Saving model ...
Epoch: 9 cost time: 4.434032201766968
Epoch: 9, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
Validation loss decreased (-0.956823 --> -0.961698).  Saving model ...
Epoch: 10 cost time: 3.4283218383789062
Epoch: 10, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.127 Vali Acc: 0.960 Test Loss: 0.127 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.635643720626831
Epoch: 11, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.125 Vali Acc: 0.960 Test Loss: 0.125 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.5181221961975098
Epoch: 12, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.112 Vali Acc: 0.964 Test Loss: 0.112 Test Acc: 0.964
Validation loss decreased (-0.961698 --> -0.964484).  Saving model ...
Epoch: 13 cost time: 3.7882046699523926
Epoch: 13, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.164 Vali Acc: 0.948 Test Loss: 0.164 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.5190587043762207
Epoch: 14, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.132 Vali Acc: 0.961 Test Loss: 0.132 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.6513476371765137
Epoch: 15, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
Validation loss decreased (-0.964484 --> -0.967965).  Saving model ...
Epoch: 16 cost time: 3.6802167892456055
Epoch: 16, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.172 Vali Acc: 0.947 Test Loss: 0.172 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.3165762424468994
Epoch: 17, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.114 Vali Acc: 0.967 Test Loss: 0.114 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.3526861667633057
Epoch: 18, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
Validation loss decreased (-0.967965 --> -0.968662).  Saving model ...
Epoch: 19 cost time: 3.2455294132232666
Epoch: 19, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.550734043121338
Epoch: 20, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.9197943210601807
Epoch: 21, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.190707206726074
Epoch: 22, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.105 Vali Acc: 0.971 Test Loss: 0.105 Test Acc: 0.971
Validation loss decreased (-0.968662 --> -0.970751).  Saving model ...
Epoch: 23 cost time: 3.3722329139709473
Epoch: 23, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.081249475479126
Epoch: 24, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
Validation loss decreased (-0.970751 --> -0.973536).  Saving model ...
Epoch: 25 cost time: 3.68062424659729
Epoch: 25, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.135 Vali Acc: 0.968 Test Loss: 0.135 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.4776127338409424
Epoch: 26, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.127 Vali Acc: 0.966 Test Loss: 0.127 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.6866559982299805
Epoch: 27, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.2492289543151855
Epoch: 28, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.121 Vali Acc: 0.971 Test Loss: 0.121 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.6243784427642822
Epoch: 29, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.151 Vali Acc: 0.962 Test Loss: 0.151 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.8089497089385986
Epoch: 30, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
Validation loss decreased (-0.973536 --> -0.973537).  Saving model ...
Epoch: 31 cost time: 3.2057418823242188
Epoch: 31, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.203 Vali Acc: 0.961 Test Loss: 0.203 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.961669921875
Epoch: 32, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.174 Vali Acc: 0.961 Test Loss: 0.174 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.9343557357788086
Epoch: 33, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.125 Vali Acc: 0.971 Test Loss: 0.125 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.7368361949920654
Epoch: 34, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.160 Vali Acc: 0.969 Test Loss: 0.160 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.7455906867980957
Epoch: 35, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.168 Vali Acc: 0.962 Test Loss: 0.168 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.5859246253967285
Epoch: 36, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.139 Vali Acc: 0.971 Test Loss: 0.139 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.8974974155426025
Epoch: 37, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.164 Vali Acc: 0.964 Test Loss: 0.164 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.9076461791992188
Epoch: 38, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
Validation loss decreased (-0.973537 --> -0.976322).  Saving model ...
Epoch: 39 cost time: 3.8044533729553223
Epoch: 39, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.5559935569763184
Epoch: 40, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.522203207015991
Epoch: 41, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.156 Vali Acc: 0.964 Test Loss: 0.156 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 4.009104251861572
Epoch: 42, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.978411).  Saving model ...
Epoch: 43 cost time: 3.5317749977111816
Epoch: 43, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.8855199813842773
Epoch: 44, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.6919381618499756
Epoch: 45, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.978411 --> -0.983286).  Saving model ...
Epoch: 46 cost time: 4.0901384353637695
Epoch: 46, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.122 Vali Acc: 0.976 Test Loss: 0.122 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.5163657665252686
Epoch: 47, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.136 Vali Acc: 0.977 Test Loss: 0.136 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 3.071082830429077
Epoch: 48, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.134 Vali Acc: 0.975 Test Loss: 0.134 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 3.0723421573638916
Epoch: 49, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 3.5367209911346436
Epoch: 50, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.124 Vali Acc: 0.974 Test Loss: 0.124 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 3.306540012359619
Epoch: 51, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 3.6147570610046387
Epoch: 52, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.148 Vali Acc: 0.967 Test Loss: 0.148 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 3.471428632736206
Epoch: 53, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 3.7123703956604004
Epoch: 54, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.150 Vali Acc: 0.974 Test Loss: 0.150 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 3.3989546298980713
Epoch: 55, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.163 Vali Acc: 0.968 Test Loss: 0.163 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 111916
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.974801540374756
Epoch: 1, Steps: 89 | Train Loss: 2.740 Vali Loss: 2.151 Vali Acc: 0.575 Test Loss: 2.151 Test Acc: 0.575
Validation loss decreased (inf --> -0.575187).  Saving model ...
Epoch: 2 cost time: 3.3283514976501465
Epoch: 2, Steps: 89 | Train Loss: 1.456 Vali Loss: 0.857 Vali Acc: 0.749 Test Loss: 0.857 Test Acc: 0.749
Validation loss decreased (-0.575187 --> -0.749295).  Saving model ...
Epoch: 3 cost time: 3.4389584064483643
Epoch: 3, Steps: 89 | Train Loss: 0.644 Vali Loss: 0.544 Vali Acc: 0.839 Test Loss: 0.544 Test Acc: 0.839
Validation loss decreased (-0.749295 --> -0.839131).  Saving model ...
Epoch: 4 cost time: 3.4420557022094727
Epoch: 4, Steps: 89 | Train Loss: 0.403 Vali Loss: 0.342 Vali Acc: 0.905 Test Loss: 0.342 Test Acc: 0.905
Validation loss decreased (-0.839131 --> -0.904593).  Saving model ...
Epoch: 5 cost time: 3.246243715286255
Epoch: 5, Steps: 89 | Train Loss: 0.263 Vali Loss: 0.254 Vali Acc: 0.930 Test Loss: 0.254 Test Acc: 0.930
Validation loss decreased (-0.904593 --> -0.929663).  Saving model ...
Epoch: 6 cost time: 3.3300158977508545
Epoch: 6, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.227 Vali Acc: 0.938 Test Loss: 0.227 Test Acc: 0.938
Validation loss decreased (-0.929663 --> -0.938020).  Saving model ...
Epoch: 7 cost time: 3.2871038913726807
Epoch: 7, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.186 Vali Acc: 0.946 Test Loss: 0.186 Test Acc: 0.946
Validation loss decreased (-0.938020 --> -0.945681).  Saving model ...
Epoch: 8 cost time: 3.0720102787017822
Epoch: 8, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
Validation loss decreased (-0.945681 --> -0.951948).  Saving model ...
Epoch: 9 cost time: 3.4831714630126953
Epoch: 9, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.146 Vali Acc: 0.959 Test Loss: 0.146 Test Acc: 0.959
Validation loss decreased (-0.951948 --> -0.958912).  Saving model ...
Epoch: 10 cost time: 3.3296549320220947
Epoch: 10, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.131 Vali Acc: 0.964 Test Loss: 0.131 Test Acc: 0.964
Validation loss decreased (-0.958912 --> -0.964483).  Saving model ...
Epoch: 11 cost time: 3.450955629348755
Epoch: 11, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
Validation loss decreased (-0.964483 --> -0.970054).  Saving model ...
Epoch: 12 cost time: 3.3795907497406006
Epoch: 12, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.130 Vali Acc: 0.963 Test Loss: 0.130 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.069974660873413
Epoch: 13, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.122 Vali Acc: 0.966 Test Loss: 0.122 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.483555555343628
Epoch: 14, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.3872485160827637
Epoch: 15, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
Validation loss decreased (-0.970054 --> -0.970055).  Saving model ...
Epoch: 16 cost time: 3.889996290206909
Epoch: 16, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.101 Vali Acc: 0.972 Test Loss: 0.101 Test Acc: 0.972
Validation loss decreased (-0.970055 --> -0.972144).  Saving model ...
Epoch: 17 cost time: 3.3353140354156494
Epoch: 17, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.161 Vali Acc: 0.948 Test Loss: 0.161 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.3003132343292236
Epoch: 18, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.155 Vali Acc: 0.955 Test Loss: 0.155 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.365532875061035
Epoch: 19, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.4340970516204834
Epoch: 20, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.2829086780548096
Epoch: 21, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.6298539638519287
Epoch: 22, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
Validation loss decreased (-0.972144 --> -0.973537).  Saving model ...
Epoch: 23 cost time: 3.878242015838623
Epoch: 23, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.155 Vali Acc: 0.962 Test Loss: 0.155 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.042625904083252
Epoch: 24, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
Validation loss decreased (-0.973537 --> -0.974929).  Saving model ...
Epoch: 25 cost time: 3.545137882232666
Epoch: 25, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.2071516513824463
Epoch: 26, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
Validation loss decreased (-0.974929 --> -0.974929).  Saving model ...
Epoch: 27 cost time: 3.220405101776123
Epoch: 27, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975626).  Saving model ...
Epoch: 28 cost time: 3.049633741378784
Epoch: 28, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.6501753330230713
Epoch: 29, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.6279327869415283
Epoch: 30, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
Validation loss decreased (-0.975626 --> -0.977715).  Saving model ...
Epoch: 31 cost time: 3.510904550552368
Epoch: 31, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.3852972984313965
Epoch: 32, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.756838321685791
Epoch: 33, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.3880367279052734
Epoch: 34, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.142 Vali Acc: 0.971 Test Loss: 0.142 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.7732317447662354
Epoch: 35, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.432887077331543
Epoch: 36, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.217752456665039
Epoch: 37, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.126 Vali Acc: 0.974 Test Loss: 0.126 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.2515971660614014
Epoch: 38, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.981 Test Loss: 0.105 Test Acc: 0.981
Validation loss decreased (-0.977715 --> -0.980500).  Saving model ...
Epoch: 39 cost time: 3.348886489868164
Epoch: 39, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.981069564819336
Epoch: 40, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.149 Vali Acc: 0.973 Test Loss: 0.149 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.382218837738037
Epoch: 41, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.159 Vali Acc: 0.972 Test Loss: 0.159 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.382648229598999
Epoch: 42, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.160 Vali Acc: 0.971 Test Loss: 0.160 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 3.2514491081237793
Epoch: 43, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.192 Vali Acc: 0.967 Test Loss: 0.192 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 3.421767234802246
Epoch: 44, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.153 Vali Acc: 0.970 Test Loss: 0.153 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 3.280770778656006
Epoch: 45, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.206 Vali Acc: 0.967 Test Loss: 0.206 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 3.3305201530456543
Epoch: 46, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.169 Vali Acc: 0.968 Test Loss: 0.169 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 3.6521928310394287
Epoch: 47, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.175 Vali Acc: 0.971 Test Loss: 0.175 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 3.2792036533355713
Epoch: 48, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.174 Vali Acc: 0.961 Test Loss: 0.174 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 111404
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.097126483917236
Epoch: 1, Steps: 89 | Train Loss: 2.756 Vali Loss: 2.194 Vali Acc: 0.484 Test Loss: 2.194 Test Acc: 0.484
Validation loss decreased (inf --> -0.483961).  Saving model ...
Epoch: 2 cost time: 3.6280264854431152
Epoch: 2, Steps: 89 | Train Loss: 1.433 Vali Loss: 0.853 Vali Acc: 0.756 Test Loss: 0.853 Test Acc: 0.756
Validation loss decreased (-0.483961 --> -0.756259).  Saving model ...
Epoch: 3 cost time: 3.6352427005767822
Epoch: 3, Steps: 89 | Train Loss: 0.622 Vali Loss: 0.499 Vali Acc: 0.854 Test Loss: 0.499 Test Acc: 0.854
Validation loss decreased (-0.756259 --> -0.853755).  Saving model ...
Epoch: 4 cost time: 3.7989354133605957
Epoch: 4, Steps: 89 | Train Loss: 0.383 Vali Loss: 0.310 Vali Acc: 0.921 Test Loss: 0.310 Test Acc: 0.921
Validation loss decreased (-0.853755 --> -0.920610).  Saving model ...
Epoch: 5 cost time: 3.938115119934082
Epoch: 5, Steps: 89 | Train Loss: 0.262 Vali Loss: 0.248 Vali Acc: 0.932 Test Loss: 0.248 Test Acc: 0.932
Validation loss decreased (-0.920610 --> -0.932449).  Saving model ...
Epoch: 6 cost time: 3.483389377593994
Epoch: 6, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.204 Vali Acc: 0.947 Test Loss: 0.204 Test Acc: 0.947
Validation loss decreased (-0.932449 --> -0.947073).  Saving model ...
Epoch: 7 cost time: 3.6182150840759277
Epoch: 7, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.200 Vali Acc: 0.938 Test Loss: 0.200 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.51090931892395
Epoch: 8, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.163 Vali Acc: 0.956 Test Loss: 0.163 Test Acc: 0.956
Validation loss decreased (-0.947073 --> -0.956127).  Saving model ...
Epoch: 9 cost time: 3.429748773574829
Epoch: 9, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.569824695587158
Epoch: 10, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.5370118618011475
Epoch: 11, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.141 Vali Acc: 0.958 Test Loss: 0.141 Test Acc: 0.958
Validation loss decreased (-0.956127 --> -0.957519).  Saving model ...
Epoch: 12 cost time: 3.430734872817993
Epoch: 12, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.3617844581604004
Epoch: 13, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
Validation loss decreased (-0.957519 --> -0.966573).  Saving model ...
Epoch: 14 cost time: 3.1995625495910645
Epoch: 14, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.96266508102417
Epoch: 15, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
Validation loss decreased (-0.966573 --> -0.968662).  Saving model ...
Epoch: 16 cost time: 3.5150258541107178
Epoch: 16, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.124 Vali Acc: 0.963 Test Loss: 0.124 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.104236841201782
Epoch: 17, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.124 Vali Acc: 0.964 Test Loss: 0.124 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.066026449203491
Epoch: 18, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.138 Vali Acc: 0.963 Test Loss: 0.138 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.560948371887207
Epoch: 19, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.128 Vali Acc: 0.966 Test Loss: 0.128 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.8669393062591553
Epoch: 20, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.105 Vali Acc: 0.972 Test Loss: 0.105 Test Acc: 0.972
Validation loss decreased (-0.968662 --> -0.972144).  Saving model ...
Epoch: 21 cost time: 3.533653497695923
Epoch: 21, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.123 Vali Acc: 0.964 Test Loss: 0.123 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.031327486038208
Epoch: 22, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.125 Vali Acc: 0.969 Test Loss: 0.125 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.2390620708465576
Epoch: 23, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.0339643955230713
Epoch: 24, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.367621898651123
Epoch: 25, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.095 Vali Acc: 0.972 Test Loss: 0.095 Test Acc: 0.972
Validation loss decreased (-0.972144 --> -0.972144).  Saving model ...
Epoch: 26 cost time: 2.7815282344818115
Epoch: 26, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.6154367923736572
Epoch: 27, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.914118528366089
Epoch: 28, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.163 Vali Acc: 0.960 Test Loss: 0.163 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.898582935333252
Epoch: 29, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.144 Vali Acc: 0.969 Test Loss: 0.144 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.731537103652954
Epoch: 30, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.145 Vali Acc: 0.969 Test Loss: 0.145 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.630462408065796
Epoch: 31, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.175 Vali Acc: 0.963 Test Loss: 0.175 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.273322343826294
Epoch: 32, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.131 Vali Acc: 0.971 Test Loss: 0.131 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.107950210571289
Epoch: 33, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.972144 --> -0.977018).  Saving model ...
Epoch: 34 cost time: 3.523505687713623
Epoch: 34, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.104 Vali Acc: 0.979 Test Loss: 0.104 Test Acc: 0.979
Validation loss decreased (-0.977018 --> -0.979108).  Saving model ...
Epoch: 35 cost time: 3.4198105335235596
Epoch: 35, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.4510843753814697
Epoch: 36, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.161 Vali Acc: 0.964 Test Loss: 0.161 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.524648427963257
Epoch: 37, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.128 Vali Acc: 0.974 Test Loss: 0.128 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 4.177940368652344
Epoch: 38, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.2333388328552246
Epoch: 39, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.145 Vali Acc: 0.971 Test Loss: 0.145 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.1560916900634766
Epoch: 40, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 3.678370952606201
Epoch: 41, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.125 Vali Acc: 0.976 Test Loss: 0.125 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 3.0962860584259033
Epoch: 42, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.150 Vali Acc: 0.969 Test Loss: 0.150 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.5545432567596436
Epoch: 43, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.238 Vali Acc: 0.954 Test Loss: 0.238 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 3.2693326473236084
Epoch: 44, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.150 Vali Acc: 0.968 Test Loss: 0.150 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_Crossformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 110892
model size : 1.10MB
