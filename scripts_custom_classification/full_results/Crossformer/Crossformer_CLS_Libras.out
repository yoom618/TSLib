Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.452100992202759
Epoch: 1, Steps: 12 | Train Loss: 2.882 Vali Loss: 2.621 Vali Acc: 0.228 Test Loss: 2.621 Test Acc: 0.228
Validation loss decreased (inf --> -0.227752).  Saving model ...
Epoch: 2 cost time: 2.153751850128174
Epoch: 2, Steps: 12 | Train Loss: 2.429 Vali Loss: 2.025 Vali Acc: 0.483 Test Loss: 2.025 Test Acc: 0.483
Validation loss decreased (-0.227752 --> -0.483313).  Saving model ...
Epoch: 3 cost time: 2.389146327972412
Epoch: 3, Steps: 12 | Train Loss: 1.751 Vali Loss: 1.635 Vali Acc: 0.483 Test Loss: 1.635 Test Acc: 0.483
Validation loss decreased (-0.483313 --> -0.483317).  Saving model ...
Epoch: 4 cost time: 2.6224167346954346
Epoch: 4, Steps: 12 | Train Loss: 1.413 Vali Loss: 1.372 Vali Acc: 0.589 Test Loss: 1.372 Test Acc: 0.589
Validation loss decreased (-0.483317 --> -0.588875).  Saving model ...
Epoch: 5 cost time: 3.3417599201202393
Epoch: 5, Steps: 12 | Train Loss: 1.077 Vali Loss: 1.282 Vali Acc: 0.572 Test Loss: 1.282 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1092536449432373
Epoch: 6, Steps: 12 | Train Loss: 0.908 Vali Loss: 0.952 Vali Acc: 0.689 Test Loss: 0.952 Test Acc: 0.689
Validation loss decreased (-0.588875 --> -0.688879).  Saving model ...
Epoch: 7 cost time: 2.801224946975708
Epoch: 7, Steps: 12 | Train Loss: 0.709 Vali Loss: 0.882 Vali Acc: 0.733 Test Loss: 0.882 Test Acc: 0.733
Validation loss decreased (-0.688879 --> -0.733325).  Saving model ...
Epoch: 8 cost time: 2.409672498703003
Epoch: 8, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.881 Vali Acc: 0.761 Test Loss: 0.881 Test Acc: 0.761
Validation loss decreased (-0.733325 --> -0.761102).  Saving model ...
Epoch: 9 cost time: 2.1770222187042236
Epoch: 9, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.790 Vali Acc: 0.817 Test Loss: 0.790 Test Acc: 0.817
Validation loss decreased (-0.761102 --> -0.816659).  Saving model ...
Epoch: 10 cost time: 2.497525215148926
Epoch: 10, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.727 Vali Acc: 0.822 Test Loss: 0.727 Test Acc: 0.822
Validation loss decreased (-0.816659 --> -0.822215).  Saving model ...
Epoch: 11 cost time: 2.5818421840667725
Epoch: 11, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.784 Vali Acc: 0.756 Test Loss: 0.784 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.768660545349121
Epoch: 12, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.802 Vali Acc: 0.789 Test Loss: 0.802 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1422741413116455
Epoch: 13, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.682 Vali Acc: 0.833 Test Loss: 0.682 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833327).  Saving model ...
Epoch: 14 cost time: 2.8228533267974854
Epoch: 14, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.640 Vali Acc: 0.800 Test Loss: 0.640 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.639274835586548
Epoch: 15, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.765 Vali Acc: 0.800 Test Loss: 0.765 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.470381498336792
Epoch: 16, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.675 Vali Acc: 0.833 Test Loss: 0.675 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 17 cost time: 2.071530818939209
Epoch: 17, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.656 Vali Acc: 0.806 Test Loss: 0.656 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.8211474418640137
Epoch: 18, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.648 Vali Acc: 0.828 Test Loss: 0.648 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.5366244316101074
Epoch: 19, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.618 Vali Acc: 0.856 Test Loss: 0.618 Test Acc: 0.856
Validation loss decreased (-0.833327 --> -0.855549).  Saving model ...
Epoch: 20 cost time: 3.0427169799804688
Epoch: 20, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.802 Vali Acc: 0.794 Test Loss: 0.802 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9803919792175293
Epoch: 21, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.706 Vali Acc: 0.783 Test Loss: 0.706 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.4816408157348633
Epoch: 22, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.796 Vali Acc: 0.789 Test Loss: 0.796 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.0556769371032715
Epoch: 23, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.828 Vali Acc: 0.789 Test Loss: 0.828 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.312678813934326
Epoch: 24, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.572 Vali Acc: 0.850 Test Loss: 0.572 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.446305513381958
Epoch: 25, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.621 Vali Acc: 0.872 Test Loss: 0.621 Test Acc: 0.872
Validation loss decreased (-0.855549 --> -0.872216).  Saving model ...
Epoch: 26 cost time: 2.7312657833099365
Epoch: 26, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.671 Vali Acc: 0.817 Test Loss: 0.671 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.6101677417755127
Epoch: 27, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.811 Vali Acc: 0.822 Test Loss: 0.811 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.4677224159240723
Epoch: 28, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.746 Vali Acc: 0.878 Test Loss: 0.746 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877770).  Saving model ...
Epoch: 29 cost time: 2.9796009063720703
Epoch: 29, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.723 Vali Acc: 0.850 Test Loss: 0.723 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.1132330894470215
Epoch: 30, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.874 Vali Acc: 0.817 Test Loss: 0.874 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.5152065753936768
Epoch: 31, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.788 Vali Acc: 0.800 Test Loss: 0.788 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.083798885345459
Epoch: 32, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.737 Vali Acc: 0.811 Test Loss: 0.737 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.2766573429107666
Epoch: 33, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.833 Vali Acc: 0.817 Test Loss: 0.833 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.6253113746643066
Epoch: 34, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.749 Vali Acc: 0.850 Test Loss: 0.749 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.6914618015289307
Epoch: 35, Steps: 12 | Train Loss: 0.375 Vali Loss: 1.154 Vali Acc: 0.644 Test Loss: 1.154 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.5450527667999268
Epoch: 36, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.700 Vali Acc: 0.817 Test Loss: 0.700 Test Acc: 0.817
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.398444890975952
Epoch: 37, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.765 Vali Acc: 0.828 Test Loss: 0.765 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 2.100576639175415
Epoch: 38, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.812 Vali Acc: 0.817 Test Loss: 0.812 Test Acc: 0.817
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 14269259
model size : 59.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.722291707992554
Epoch: 1, Steps: 12 | Train Loss: 2.843 Vali Loss: 2.576 Vali Acc: 0.161 Test Loss: 2.576 Test Acc: 0.161
Validation loss decreased (inf --> -0.161085).  Saving model ...
Epoch: 2 cost time: 2.2838406562805176
Epoch: 2, Steps: 12 | Train Loss: 2.344 Vali Loss: 2.030 Vali Acc: 0.389 Test Loss: 2.030 Test Acc: 0.389
Validation loss decreased (-0.161085 --> -0.388869).  Saving model ...
Epoch: 3 cost time: 2.660144567489624
Epoch: 3, Steps: 12 | Train Loss: 1.847 Vali Loss: 1.713 Vali Acc: 0.483 Test Loss: 1.713 Test Acc: 0.483
Validation loss decreased (-0.388869 --> -0.483316).  Saving model ...
Epoch: 4 cost time: 2.2940614223480225
Epoch: 4, Steps: 12 | Train Loss: 1.403 Vali Loss: 1.382 Vali Acc: 0.589 Test Loss: 1.382 Test Acc: 0.589
Validation loss decreased (-0.483316 --> -0.588875).  Saving model ...
Epoch: 5 cost time: 2.244105815887451
Epoch: 5, Steps: 12 | Train Loss: 1.129 Vali Loss: 1.227 Vali Acc: 0.644 Test Loss: 1.227 Test Acc: 0.644
Validation loss decreased (-0.588875 --> -0.644432).  Saving model ...
Epoch: 6 cost time: 2.509154796600342
Epoch: 6, Steps: 12 | Train Loss: 0.924 Vali Loss: 0.971 Vali Acc: 0.689 Test Loss: 0.971 Test Acc: 0.689
Validation loss decreased (-0.644432 --> -0.688879).  Saving model ...
Epoch: 7 cost time: 2.8763539791107178
Epoch: 7, Steps: 12 | Train Loss: 0.753 Vali Loss: 0.976 Vali Acc: 0.683 Test Loss: 0.976 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8516604900360107
Epoch: 8, Steps: 12 | Train Loss: 0.694 Vali Loss: 0.931 Vali Acc: 0.706 Test Loss: 0.931 Test Acc: 0.706
Validation loss decreased (-0.688879 --> -0.705546).  Saving model ...
Epoch: 9 cost time: 2.360828399658203
Epoch: 9, Steps: 12 | Train Loss: 0.594 Vali Loss: 0.676 Vali Acc: 0.828 Test Loss: 0.676 Test Acc: 0.828
Validation loss decreased (-0.705546 --> -0.827771).  Saving model ...
Epoch: 10 cost time: 2.1014902591705322
Epoch: 10, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.748 Vali Acc: 0.778 Test Loss: 0.748 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.5964715480804443
Epoch: 11, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.642 Vali Acc: 0.794 Test Loss: 0.642 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.013824462890625
Epoch: 12, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.648 Vali Acc: 0.817 Test Loss: 0.648 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.5941004753112793
Epoch: 13, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.561 Vali Acc: 0.878 Test Loss: 0.561 Test Acc: 0.878
Validation loss decreased (-0.827771 --> -0.877772).  Saving model ...
Epoch: 14 cost time: 2.204115390777588
Epoch: 14, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.582 Vali Acc: 0.856 Test Loss: 0.582 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8474979400634766
Epoch: 15, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.568 Vali Acc: 0.856 Test Loss: 0.568 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.1467673778533936
Epoch: 16, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.538 Vali Acc: 0.822 Test Loss: 0.538 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.6914522647857666
Epoch: 17, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.577 Vali Acc: 0.839 Test Loss: 0.577 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.989271640777588
Epoch: 18, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.553 Vali Acc: 0.833 Test Loss: 0.553 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.9173288345336914
Epoch: 19, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.615 Vali Acc: 0.844 Test Loss: 0.615 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.885871410369873
Epoch: 20, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.555 Vali Acc: 0.850 Test Loss: 0.555 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.3486783504486084
Epoch: 21, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.885 Vali Acc: 0.783 Test Loss: 0.885 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.5608997344970703
Epoch: 22, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.950 Vali Acc: 0.794 Test Loss: 0.950 Test Acc: 0.794
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.2067277431488037
Epoch: 23, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.552 Vali Acc: 0.850 Test Loss: 0.552 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 14267211
model size : 59.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.410457372665405
Epoch: 1, Steps: 12 | Train Loss: 2.856 Vali Loss: 2.532 Vali Acc: 0.161 Test Loss: 2.532 Test Acc: 0.161
Validation loss decreased (inf --> -0.161086).  Saving model ...
Epoch: 2 cost time: 2.0839428901672363
Epoch: 2, Steps: 12 | Train Loss: 2.371 Vali Loss: 2.004 Vali Acc: 0.411 Test Loss: 2.004 Test Acc: 0.411
Validation loss decreased (-0.161086 --> -0.411091).  Saving model ...
Epoch: 3 cost time: 2.4218380451202393
Epoch: 3, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.561 Vali Acc: 0.578 Test Loss: 1.561 Test Acc: 0.578
Validation loss decreased (-0.411091 --> -0.577762).  Saving model ...
Epoch: 4 cost time: 2.304558038711548
Epoch: 4, Steps: 12 | Train Loss: 1.410 Vali Loss: 1.325 Vali Acc: 0.594 Test Loss: 1.325 Test Acc: 0.594
Validation loss decreased (-0.577762 --> -0.594431).  Saving model ...
Epoch: 5 cost time: 2.032121181488037
Epoch: 5, Steps: 12 | Train Loss: 1.161 Vali Loss: 1.222 Vali Acc: 0.622 Test Loss: 1.222 Test Acc: 0.622
Validation loss decreased (-0.594431 --> -0.622210).  Saving model ...
Epoch: 6 cost time: 2.248415470123291
Epoch: 6, Steps: 12 | Train Loss: 0.973 Vali Loss: 1.005 Vali Acc: 0.667 Test Loss: 1.005 Test Acc: 0.667
Validation loss decreased (-0.622210 --> -0.666657).  Saving model ...
Epoch: 7 cost time: 2.070056676864624
Epoch: 7, Steps: 12 | Train Loss: 0.681 Vali Loss: 0.861 Vali Acc: 0.728 Test Loss: 0.861 Test Acc: 0.728
Validation loss decreased (-0.666657 --> -0.727769).  Saving model ...
Epoch: 8 cost time: 1.9360764026641846
Epoch: 8, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.804 Vali Acc: 0.800 Test Loss: 0.804 Test Acc: 0.800
Validation loss decreased (-0.727769 --> -0.799992).  Saving model ...
Epoch: 9 cost time: 1.9548695087432861
Epoch: 9, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.733 Vali Acc: 0.761 Test Loss: 0.733 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1012685298919678
Epoch: 10, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.681 Vali Acc: 0.789 Test Loss: 0.681 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.94997239112854
Epoch: 11, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.700 Vali Acc: 0.822 Test Loss: 0.700 Test Acc: 0.822
Validation loss decreased (-0.799992 --> -0.822215).  Saving model ...
Epoch: 12 cost time: 1.9743287563323975
Epoch: 12, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.572 Vali Acc: 0.861 Test Loss: 0.572 Test Acc: 0.861
Validation loss decreased (-0.822215 --> -0.861105).  Saving model ...
Epoch: 13 cost time: 2.2326579093933105
Epoch: 13, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.824 Vali Acc: 0.778 Test Loss: 0.824 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.3970508575439453
Epoch: 14, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.663 Vali Acc: 0.817 Test Loss: 0.663 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.32605242729187
Epoch: 15, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.684 Vali Acc: 0.828 Test Loss: 0.684 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9634830951690674
Epoch: 16, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.675 Vali Acc: 0.861 Test Loss: 0.675 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.5592026710510254
Epoch: 17, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.576 Vali Acc: 0.850 Test Loss: 0.576 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.153428792953491
Epoch: 18, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.778 Vali Acc: 0.794 Test Loss: 0.778 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.3623056411743164
Epoch: 19, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.676 Vali Acc: 0.794 Test Loss: 0.676 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.0334813594818115
Epoch: 20, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.686 Vali Acc: 0.839 Test Loss: 0.686 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.7479658126831055
Epoch: 21, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.732 Vali Acc: 0.833 Test Loss: 0.732 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.2759897708892822
Epoch: 22, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.571 Vali Acc: 0.867 Test Loss: 0.571 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 23 cost time: 2.35487699508667
Epoch: 23, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.729 Vali Acc: 0.844 Test Loss: 0.729 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.7453339099884033
Epoch: 24, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.645 Vali Acc: 0.856 Test Loss: 0.645 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.8529748916625977
Epoch: 25, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.581 Vali Acc: 0.856 Test Loss: 0.581 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.5927317142486572
Epoch: 26, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.682 Vali Acc: 0.850 Test Loss: 0.682 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.772505044937134
Epoch: 27, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.652 Vali Acc: 0.850 Test Loss: 0.652 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.573704242706299
Epoch: 28, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.554 Vali Acc: 0.867 Test Loss: 0.554 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 29 cost time: 2.7147786617279053
Epoch: 29, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.554 Vali Acc: 0.867 Test Loss: 0.554 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 30 cost time: 2.2762064933776855
Epoch: 30, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.540 Vali Acc: 0.894 Test Loss: 0.540 Test Acc: 0.894
Validation loss decreased (-0.866661 --> -0.894439).  Saving model ...
Epoch: 31 cost time: 3.1317195892333984
Epoch: 31, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.697 Vali Acc: 0.861 Test Loss: 0.697 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.363612651824951
Epoch: 32, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.527 Vali Acc: 0.889 Test Loss: 0.527 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.2691402435302734
Epoch: 33, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.515 Vali Acc: 0.878 Test Loss: 0.515 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.490126132965088
Epoch: 34, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.580 Vali Acc: 0.833 Test Loss: 0.580 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.1081182956695557
Epoch: 35, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.696 Vali Acc: 0.833 Test Loss: 0.696 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.0227410793304443
Epoch: 36, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.751 Vali Acc: 0.789 Test Loss: 0.751 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.2225966453552246
Epoch: 37, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.526 Vali Acc: 0.872 Test Loss: 0.526 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.059173822402954
Epoch: 38, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.755 Vali Acc: 0.833 Test Loss: 0.755 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 2.2378830909729004
Epoch: 39, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.847 Vali Acc: 0.744 Test Loss: 0.847 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 2.2245993614196777
Epoch: 40, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.829 Vali Acc: 0.817 Test Loss: 0.829 Test Acc: 0.817
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 14265163
model size : 59.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.009339332580566
Epoch: 1, Steps: 12 | Train Loss: 2.872 Vali Loss: 2.630 Vali Acc: 0.239 Test Loss: 2.630 Test Acc: 0.239
Validation loss decreased (inf --> -0.238863).  Saving model ...
Epoch: 2 cost time: 2.204270124435425
Epoch: 2, Steps: 12 | Train Loss: 2.345 Vali Loss: 2.064 Vali Acc: 0.467 Test Loss: 2.064 Test Acc: 0.467
Validation loss decreased (-0.238863 --> -0.466646).  Saving model ...
Epoch: 3 cost time: 1.902625560760498
Epoch: 3, Steps: 12 | Train Loss: 1.749 Vali Loss: 1.691 Vali Acc: 0.539 Test Loss: 1.691 Test Acc: 0.539
Validation loss decreased (-0.466646 --> -0.538872).  Saving model ...
Epoch: 4 cost time: 2.213031053543091
Epoch: 4, Steps: 12 | Train Loss: 1.357 Vali Loss: 1.410 Vali Acc: 0.594 Test Loss: 1.410 Test Acc: 0.594
Validation loss decreased (-0.538872 --> -0.594430).  Saving model ...
Epoch: 5 cost time: 2.3938565254211426
Epoch: 5, Steps: 12 | Train Loss: 1.109 Vali Loss: 1.167 Vali Acc: 0.622 Test Loss: 1.167 Test Acc: 0.622
Validation loss decreased (-0.594430 --> -0.622211).  Saving model ...
Epoch: 6 cost time: 2.1328132152557373
Epoch: 6, Steps: 12 | Train Loss: 0.820 Vali Loss: 0.896 Vali Acc: 0.739 Test Loss: 0.896 Test Acc: 0.739
Validation loss decreased (-0.622211 --> -0.738880).  Saving model ...
Epoch: 7 cost time: 2.5013301372528076
Epoch: 7, Steps: 12 | Train Loss: 0.612 Vali Loss: 0.932 Vali Acc: 0.739 Test Loss: 0.932 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.243098497390747
Epoch: 8, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.771 Vali Acc: 0.750 Test Loss: 0.771 Test Acc: 0.750
Validation loss decreased (-0.738880 --> -0.749992).  Saving model ...
Epoch: 9 cost time: 2.37497878074646
Epoch: 9, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.821 Vali Acc: 0.756 Test Loss: 0.821 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755547).  Saving model ...
Epoch: 10 cost time: 2.452946901321411
Epoch: 10, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.719 Vali Acc: 0.806 Test Loss: 0.719 Test Acc: 0.806
Validation loss decreased (-0.755547 --> -0.805548).  Saving model ...
Epoch: 11 cost time: 2.412504196166992
Epoch: 11, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.560 Vali Acc: 0.861 Test Loss: 0.560 Test Acc: 0.861
Validation loss decreased (-0.805548 --> -0.861106).  Saving model ...
Epoch: 12 cost time: 2.4718971252441406
Epoch: 12, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.828 Vali Acc: 0.794 Test Loss: 0.828 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3201091289520264
Epoch: 13, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.761 Vali Acc: 0.761 Test Loss: 0.761 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.623563528060913
Epoch: 14, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.769 Vali Acc: 0.811 Test Loss: 0.769 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.3720264434814453
Epoch: 15, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.549 Vali Acc: 0.850 Test Loss: 0.549 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.4020822048187256
Epoch: 16, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.586 Vali Acc: 0.833 Test Loss: 0.586 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.752269983291626
Epoch: 17, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.620 Vali Acc: 0.861 Test Loss: 0.620 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.467210054397583
Epoch: 18, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.524 Vali Acc: 0.856 Test Loss: 0.524 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.5837955474853516
Epoch: 19, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.806 Vali Acc: 0.822 Test Loss: 0.806 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.376314878463745
Epoch: 20, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.560 Vali Acc: 0.883 Test Loss: 0.560 Test Acc: 0.883
Validation loss decreased (-0.861106 --> -0.883328).  Saving model ...
Epoch: 21 cost time: 2.5053653717041016
Epoch: 21, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.666 Vali Acc: 0.811 Test Loss: 0.666 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.425668716430664
Epoch: 22, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.851 Vali Acc: 0.811 Test Loss: 0.851 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.4366824626922607
Epoch: 23, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.628 Vali Acc: 0.856 Test Loss: 0.628 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.3376479148864746
Epoch: 24, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.690 Vali Acc: 0.850 Test Loss: 0.690 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.2941055297851562
Epoch: 25, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.511 Vali Acc: 0.856 Test Loss: 0.511 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.416943073272705
Epoch: 26, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.608 Vali Acc: 0.861 Test Loss: 0.608 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.143319606781006
Epoch: 27, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.608 Vali Acc: 0.867 Test Loss: 0.608 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.5669660568237305
Epoch: 28, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.586 Vali Acc: 0.833 Test Loss: 0.586 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.124788284301758
Epoch: 29, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.676 Vali Acc: 0.844 Test Loss: 0.676 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.194995880126953
Epoch: 30, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.593 Vali Acc: 0.861 Test Loss: 0.593 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 14263115
model size : 59.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.9898083209991455
Epoch: 1, Steps: 12 | Train Loss: 2.855 Vali Loss: 2.555 Vali Acc: 0.217 Test Loss: 2.555 Test Acc: 0.217
Validation loss decreased (inf --> -0.216641).  Saving model ...
Epoch: 2 cost time: 2.588988780975342
Epoch: 2, Steps: 12 | Train Loss: 2.377 Vali Loss: 2.098 Vali Acc: 0.461 Test Loss: 2.098 Test Acc: 0.461
Validation loss decreased (-0.216641 --> -0.461090).  Saving model ...
Epoch: 3 cost time: 2.528836727142334
Epoch: 3, Steps: 12 | Train Loss: 1.869 Vali Loss: 1.787 Vali Acc: 0.494 Test Loss: 1.787 Test Acc: 0.494
Validation loss decreased (-0.461090 --> -0.494427).  Saving model ...
Epoch: 4 cost time: 2.5072643756866455
Epoch: 4, Steps: 12 | Train Loss: 1.577 Vali Loss: 1.522 Vali Acc: 0.544 Test Loss: 1.522 Test Acc: 0.544
Validation loss decreased (-0.494427 --> -0.544429).  Saving model ...
Epoch: 5 cost time: 2.208627223968506
Epoch: 5, Steps: 12 | Train Loss: 1.162 Vali Loss: 1.241 Vali Acc: 0.633 Test Loss: 1.241 Test Acc: 0.633
Validation loss decreased (-0.544429 --> -0.633321).  Saving model ...
Epoch: 6 cost time: 2.684213638305664
Epoch: 6, Steps: 12 | Train Loss: 0.949 Vali Loss: 1.122 Vali Acc: 0.656 Test Loss: 1.122 Test Acc: 0.656
Validation loss decreased (-0.633321 --> -0.655544).  Saving model ...
Epoch: 7 cost time: 2.53828763961792
Epoch: 7, Steps: 12 | Train Loss: 0.811 Vali Loss: 1.022 Vali Acc: 0.711 Test Loss: 1.022 Test Acc: 0.711
Validation loss decreased (-0.655544 --> -0.711101).  Saving model ...
Epoch: 8 cost time: 2.7689576148986816
Epoch: 8, Steps: 12 | Train Loss: 0.717 Vali Loss: 0.964 Vali Acc: 0.706 Test Loss: 0.964 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4265658855438232
Epoch: 9, Steps: 12 | Train Loss: 0.592 Vali Loss: 0.735 Vali Acc: 0.744 Test Loss: 0.735 Test Acc: 0.744
Validation loss decreased (-0.711101 --> -0.744437).  Saving model ...
Epoch: 10 cost time: 2.566321611404419
Epoch: 10, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.782 Vali Acc: 0.750 Test Loss: 0.782 Test Acc: 0.750
Validation loss decreased (-0.744437 --> -0.749992).  Saving model ...
Epoch: 11 cost time: 2.590691566467285
Epoch: 11, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.744 Vali Acc: 0.800 Test Loss: 0.744 Test Acc: 0.800
Validation loss decreased (-0.749992 --> -0.799993).  Saving model ...
Epoch: 12 cost time: 2.2672038078308105
Epoch: 12, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.923 Vali Acc: 0.706 Test Loss: 0.923 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1116058826446533
Epoch: 13, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.669 Vali Acc: 0.767 Test Loss: 0.669 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.7579991817474365
Epoch: 14, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.727 Vali Acc: 0.789 Test Loss: 0.727 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.554922342300415
Epoch: 15, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.681 Vali Acc: 0.839 Test Loss: 0.681 Test Acc: 0.839
Validation loss decreased (-0.799993 --> -0.838882).  Saving model ...
Epoch: 16 cost time: 2.2249321937561035
Epoch: 16, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.586 Vali Acc: 0.850 Test Loss: 0.586 Test Acc: 0.850
Validation loss decreased (-0.838882 --> -0.849994).  Saving model ...
Epoch: 17 cost time: 2.3741226196289062
Epoch: 17, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.533 Vali Acc: 0.833 Test Loss: 0.533 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.641423225402832
Epoch: 18, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.717 Vali Acc: 0.778 Test Loss: 0.717 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.041579484939575
Epoch: 19, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.602 Vali Acc: 0.828 Test Loss: 0.602 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.210465669631958
Epoch: 20, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.765 Vali Acc: 0.806 Test Loss: 0.765 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.311762809753418
Epoch: 21, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.608 Vali Acc: 0.861 Test Loss: 0.608 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 22 cost time: 2.452755928039551
Epoch: 22, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.696 Vali Acc: 0.833 Test Loss: 0.696 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.8182804584503174
Epoch: 23, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.748 Vali Acc: 0.844 Test Loss: 0.748 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.9947490692138672
Epoch: 24, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.716 Vali Acc: 0.839 Test Loss: 0.716 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.191589117050171
Epoch: 25, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.606 Vali Acc: 0.850 Test Loss: 0.606 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.5103344917297363
Epoch: 26, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.636 Vali Acc: 0.839 Test Loss: 0.636 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.585592269897461
Epoch: 27, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.554 Vali Acc: 0.872 Test Loss: 0.554 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872217).  Saving model ...
Epoch: 28 cost time: 2.3315415382385254
Epoch: 28, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.622 Vali Acc: 0.872 Test Loss: 0.622 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.409952402114868
Epoch: 29, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.627 Vali Acc: 0.872 Test Loss: 0.627 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.409397840499878
Epoch: 30, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.621 Vali Acc: 0.878 Test Loss: 0.621 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 31 cost time: 2.492527961730957
Epoch: 31, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.615 Vali Acc: 0.894 Test Loss: 0.615 Test Acc: 0.894
Validation loss decreased (-0.877772 --> -0.894438).  Saving model ...
Epoch: 32 cost time: 2.855243444442749
Epoch: 32, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.627 Vali Acc: 0.889 Test Loss: 0.627 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.106764793395996
Epoch: 33, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.629 Vali Acc: 0.894 Test Loss: 0.629 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.0612926483154297
Epoch: 34, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.624 Vali Acc: 0.894 Test Loss: 0.624 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.1692349910736084
Epoch: 35, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.627 Vali Acc: 0.894 Test Loss: 0.627 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.3635149002075195
Epoch: 36, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.628 Vali Acc: 0.894 Test Loss: 0.628 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.926797866821289
Epoch: 37, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.633 Vali Acc: 0.894 Test Loss: 0.633 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.650545120239258
Epoch: 38, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.624 Vali Acc: 0.900 Test Loss: 0.624 Test Acc: 0.900
Validation loss decreased (-0.894438 --> -0.899994).  Saving model ...
Epoch: 39 cost time: 2.396357297897339
Epoch: 39, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.619 Vali Acc: 0.900 Test Loss: 0.619 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 40 cost time: 2.597341775894165
Epoch: 40, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.616 Vali Acc: 0.900 Test Loss: 0.616 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 41 cost time: 3.1560897827148438
Epoch: 41, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.617 Vali Acc: 0.889 Test Loss: 0.617 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.740924119949341
Epoch: 42, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.627 Vali Acc: 0.883 Test Loss: 0.627 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.5245602130889893
Epoch: 43, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.632 Vali Acc: 0.894 Test Loss: 0.632 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 2.4802870750427246
Epoch: 44, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.638 Vali Acc: 0.894 Test Loss: 0.638 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 2.3288495540618896
Epoch: 45, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.642 Vali Acc: 0.894 Test Loss: 0.642 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 2.3943827152252197
Epoch: 46, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.639 Vali Acc: 0.889 Test Loss: 0.639 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 2.719578266143799
Epoch: 47, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.640 Vali Acc: 0.894 Test Loss: 0.640 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 2.4617438316345215
Epoch: 48, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.642 Vali Acc: 0.894 Test Loss: 0.642 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 2.458428382873535
Epoch: 49, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.644 Vali Acc: 0.889 Test Loss: 0.644 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 2.407681941986084
Epoch: 50, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.647 Vali Acc: 0.889 Test Loss: 0.647 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 11905355
model size : 50.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.596623182296753
Epoch: 1, Steps: 12 | Train Loss: 2.850 Vali Loss: 2.555 Vali Acc: 0.183 Test Loss: 2.555 Test Acc: 0.183
Validation loss decreased (inf --> -0.183308).  Saving model ...
Epoch: 2 cost time: 2.180133104324341
Epoch: 2, Steps: 12 | Train Loss: 2.454 Vali Loss: 2.097 Vali Acc: 0.378 Test Loss: 2.097 Test Acc: 0.378
Validation loss decreased (-0.183308 --> -0.377757).  Saving model ...
Epoch: 3 cost time: 2.0306942462921143
Epoch: 3, Steps: 12 | Train Loss: 1.848 Vali Loss: 1.665 Vali Acc: 0.550 Test Loss: 1.665 Test Acc: 0.550
Validation loss decreased (-0.377757 --> -0.549983).  Saving model ...
Epoch: 4 cost time: 1.96439528465271
Epoch: 4, Steps: 12 | Train Loss: 1.493 Vali Loss: 1.378 Vali Acc: 0.528 Test Loss: 1.378 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0507500171661377
Epoch: 5, Steps: 12 | Train Loss: 1.193 Vali Loss: 1.134 Vali Acc: 0.672 Test Loss: 1.134 Test Acc: 0.672
Validation loss decreased (-0.549983 --> -0.672211).  Saving model ...
Epoch: 6 cost time: 2.2420921325683594
Epoch: 6, Steps: 12 | Train Loss: 0.953 Vali Loss: 1.078 Vali Acc: 0.689 Test Loss: 1.078 Test Acc: 0.689
Validation loss decreased (-0.672211 --> -0.688878).  Saving model ...
Epoch: 7 cost time: 2.2088682651519775
Epoch: 7, Steps: 12 | Train Loss: 0.837 Vali Loss: 1.032 Vali Acc: 0.678 Test Loss: 1.032 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9174368381500244
Epoch: 8, Steps: 12 | Train Loss: 0.660 Vali Loss: 0.871 Vali Acc: 0.767 Test Loss: 0.871 Test Acc: 0.767
Validation loss decreased (-0.688878 --> -0.766658).  Saving model ...
Epoch: 9 cost time: 1.8492178916931152
Epoch: 9, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.694 Vali Acc: 0.811 Test Loss: 0.694 Test Acc: 0.811
Validation loss decreased (-0.766658 --> -0.811104).  Saving model ...
Epoch: 10 cost time: 2.3141183853149414
Epoch: 10, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.974 Vali Acc: 0.739 Test Loss: 0.974 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7675793170928955
Epoch: 11, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.837 Vali Acc: 0.739 Test Loss: 0.837 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.420126438140869
Epoch: 12, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.715 Vali Acc: 0.839 Test Loss: 0.715 Test Acc: 0.839
Validation loss decreased (-0.811104 --> -0.838882).  Saving model ...
Epoch: 13 cost time: 2.5381972789764404
Epoch: 13, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.630 Vali Acc: 0.844 Test Loss: 0.630 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 14 cost time: 2.495196580886841
Epoch: 14, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.734 Vali Acc: 0.822 Test Loss: 0.734 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.7777223587036133
Epoch: 15, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.673 Vali Acc: 0.822 Test Loss: 0.673 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.425983428955078
Epoch: 16, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.606 Vali Acc: 0.867 Test Loss: 0.606 Test Acc: 0.867
Validation loss decreased (-0.844438 --> -0.866661).  Saving model ...
Epoch: 17 cost time: 2.67073655128479
Epoch: 17, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.649 Vali Acc: 0.844 Test Loss: 0.649 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.3840253353118896
Epoch: 18, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.687 Vali Acc: 0.833 Test Loss: 0.687 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.365849733352661
Epoch: 19, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.628 Vali Acc: 0.856 Test Loss: 0.628 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.2960896492004395
Epoch: 20, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.557 Vali Acc: 0.883 Test Loss: 0.557 Test Acc: 0.883
Validation loss decreased (-0.866661 --> -0.883328).  Saving model ...
Epoch: 21 cost time: 2.579798460006714
Epoch: 21, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.594 Vali Acc: 0.856 Test Loss: 0.594 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.8636820316314697
Epoch: 22, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.662 Vali Acc: 0.839 Test Loss: 0.662 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.555135488510132
Epoch: 23, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.769 Vali Acc: 0.833 Test Loss: 0.769 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.40122652053833
Epoch: 24, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.753 Vali Acc: 0.822 Test Loss: 0.753 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.767390012741089
Epoch: 25, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.520 Vali Acc: 0.850 Test Loss: 0.520 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.0872342586517334
Epoch: 26, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.772 Vali Acc: 0.861 Test Loss: 0.772 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.9527029991149902
Epoch: 27, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.535 Vali Acc: 0.878 Test Loss: 0.535 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.5950918197631836
Epoch: 28, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.552 Vali Acc: 0.850 Test Loss: 0.552 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.3659451007843018
Epoch: 29, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.601 Vali Acc: 0.861 Test Loss: 0.601 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.5442864894866943
Epoch: 30, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.556 Vali Acc: 0.872 Test Loss: 0.556 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 11903307
model size : 50.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.112427234649658
Epoch: 1, Steps: 12 | Train Loss: 2.789 Vali Loss: 2.559 Vali Acc: 0.161 Test Loss: 2.559 Test Acc: 0.161
Validation loss decreased (inf --> -0.161086).  Saving model ...
Epoch: 2 cost time: 3.1906981468200684
Epoch: 2, Steps: 12 | Train Loss: 2.260 Vali Loss: 2.088 Vali Acc: 0.433 Test Loss: 2.088 Test Acc: 0.433
Validation loss decreased (-0.161086 --> -0.433312).  Saving model ...
Epoch: 3 cost time: 2.362051486968994
Epoch: 3, Steps: 12 | Train Loss: 1.769 Vali Loss: 1.629 Vali Acc: 0.522 Test Loss: 1.629 Test Acc: 0.522
Validation loss decreased (-0.433312 --> -0.522206).  Saving model ...
Epoch: 4 cost time: 2.3750221729278564
Epoch: 4, Steps: 12 | Train Loss: 1.325 Vali Loss: 1.367 Vali Acc: 0.550 Test Loss: 1.367 Test Acc: 0.550
Validation loss decreased (-0.522206 --> -0.549986).  Saving model ...
Epoch: 5 cost time: 2.272432327270508
Epoch: 5, Steps: 12 | Train Loss: 1.117 Vali Loss: 1.221 Vali Acc: 0.617 Test Loss: 1.221 Test Acc: 0.617
Validation loss decreased (-0.549986 --> -0.616654).  Saving model ...
Epoch: 6 cost time: 2.642132520675659
Epoch: 6, Steps: 12 | Train Loss: 0.961 Vali Loss: 1.087 Vali Acc: 0.672 Test Loss: 1.087 Test Acc: 0.672
Validation loss decreased (-0.616654 --> -0.672211).  Saving model ...
Epoch: 7 cost time: 2.64015531539917
Epoch: 7, Steps: 12 | Train Loss: 0.885 Vali Loss: 0.958 Vali Acc: 0.689 Test Loss: 0.958 Test Acc: 0.689
Validation loss decreased (-0.672211 --> -0.688879).  Saving model ...
Epoch: 8 cost time: 2.3106791973114014
Epoch: 8, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.808 Vali Acc: 0.728 Test Loss: 0.808 Test Acc: 0.728
Validation loss decreased (-0.688879 --> -0.727770).  Saving model ...
Epoch: 9 cost time: 2.297517776489258
Epoch: 9, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.800 Vali Acc: 0.800 Test Loss: 0.800 Test Acc: 0.800
Validation loss decreased (-0.727770 --> -0.799992).  Saving model ...
Epoch: 10 cost time: 2.379467010498047
Epoch: 10, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.726 Vali Acc: 0.789 Test Loss: 0.726 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6871657371520996
Epoch: 11, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.809 Vali Acc: 0.817 Test Loss: 0.809 Test Acc: 0.817
Validation loss decreased (-0.799992 --> -0.816659).  Saving model ...
Epoch: 12 cost time: 2.2552123069763184
Epoch: 12, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.693 Vali Acc: 0.833 Test Loss: 0.693 Test Acc: 0.833
Validation loss decreased (-0.816659 --> -0.833326).  Saving model ...
Epoch: 13 cost time: 2.5251598358154297
Epoch: 13, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.744 Vali Acc: 0.794 Test Loss: 0.744 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.684359073638916
Epoch: 14, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.764 Vali Acc: 0.806 Test Loss: 0.764 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.8137800693511963
Epoch: 15, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.624 Vali Acc: 0.800 Test Loss: 0.624 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.1858184337615967
Epoch: 16, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.727 Vali Acc: 0.856 Test Loss: 0.727 Test Acc: 0.856
Validation loss decreased (-0.833326 --> -0.855548).  Saving model ...
Epoch: 17 cost time: 2.0475857257843018
Epoch: 17, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.601 Vali Acc: 0.833 Test Loss: 0.601 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.5350213050842285
Epoch: 18, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.841 Vali Acc: 0.800 Test Loss: 0.841 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.305877208709717
Epoch: 19, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.837 Vali Acc: 0.811 Test Loss: 0.837 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.5207557678222656
Epoch: 20, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.667 Vali Acc: 0.783 Test Loss: 0.667 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.6863746643066406
Epoch: 21, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.578 Vali Acc: 0.861 Test Loss: 0.578 Test Acc: 0.861
Validation loss decreased (-0.855548 --> -0.861105).  Saving model ...
Epoch: 22 cost time: 2.5270767211914062
Epoch: 22, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.567 Vali Acc: 0.850 Test Loss: 0.567 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.5898303985595703
Epoch: 23, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.664 Vali Acc: 0.839 Test Loss: 0.664 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.686145544052124
Epoch: 24, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.601 Vali Acc: 0.861 Test Loss: 0.601 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.4698851108551025
Epoch: 25, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.602 Vali Acc: 0.856 Test Loss: 0.602 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.5445120334625244
Epoch: 26, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.755 Vali Acc: 0.817 Test Loss: 0.755 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.4466652870178223
Epoch: 27, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.651 Vali Acc: 0.839 Test Loss: 0.651 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.555389404296875
Epoch: 28, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.597 Vali Acc: 0.867 Test Loss: 0.597 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 29 cost time: 2.420682430267334
Epoch: 29, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.649 Vali Acc: 0.856 Test Loss: 0.649 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.3424582481384277
Epoch: 30, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.703 Vali Acc: 0.861 Test Loss: 0.703 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.344879627227783
Epoch: 31, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.806 Vali Acc: 0.867 Test Loss: 0.806 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.6687116622924805
Epoch: 32, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.658 Vali Acc: 0.839 Test Loss: 0.658 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.3391504287719727
Epoch: 33, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.586 Vali Acc: 0.833 Test Loss: 0.586 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.859593629837036
Epoch: 34, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.685 Vali Acc: 0.839 Test Loss: 0.685 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.7297980785369873
Epoch: 35, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.681 Vali Acc: 0.861 Test Loss: 0.681 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.6406075954437256
Epoch: 36, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.545 Vali Acc: 0.872 Test Loss: 0.545 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 37 cost time: 2.6721837520599365
Epoch: 37, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.688 Vali Acc: 0.867 Test Loss: 0.688 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.3437998294830322
Epoch: 38, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.583 Vali Acc: 0.867 Test Loss: 0.583 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.5471341609954834
Epoch: 39, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.651 Vali Acc: 0.856 Test Loss: 0.651 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.6776180267333984
Epoch: 40, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.762 Vali Acc: 0.856 Test Loss: 0.762 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.4465835094451904
Epoch: 41, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.846 Vali Acc: 0.839 Test Loss: 0.846 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.9586470127105713
Epoch: 42, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.750 Vali Acc: 0.817 Test Loss: 0.750 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.4053454399108887
Epoch: 43, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.845 Vali Acc: 0.789 Test Loss: 0.845 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 2.5305263996124268
Epoch: 44, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.576 Vali Acc: 0.822 Test Loss: 0.576 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 2.4231925010681152
Epoch: 45, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.694 Vali Acc: 0.817 Test Loss: 0.694 Test Acc: 0.817
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 3.0588057041168213
Epoch: 46, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.752 Vali Acc: 0.844 Test Loss: 0.752 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 11901259
model size : 50.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.423419237136841
Epoch: 1, Steps: 12 | Train Loss: 2.828 Vali Loss: 2.590 Vali Acc: 0.233 Test Loss: 2.590 Test Acc: 0.233
Validation loss decreased (inf --> -0.233307).  Saving model ...
Epoch: 2 cost time: 2.398754596710205
Epoch: 2, Steps: 12 | Train Loss: 2.500 Vali Loss: 2.218 Vali Acc: 0.433 Test Loss: 2.218 Test Acc: 0.433
Validation loss decreased (-0.233307 --> -0.433311).  Saving model ...
Epoch: 3 cost time: 2.504117965698242
Epoch: 3, Steps: 12 | Train Loss: 1.934 Vali Loss: 1.757 Vali Acc: 0.517 Test Loss: 1.757 Test Acc: 0.517
Validation loss decreased (-0.433311 --> -0.516649).  Saving model ...
Epoch: 4 cost time: 2.2499592304229736
Epoch: 4, Steps: 12 | Train Loss: 1.502 Vali Loss: 1.441 Vali Acc: 0.528 Test Loss: 1.441 Test Acc: 0.528
Validation loss decreased (-0.516649 --> -0.527763).  Saving model ...
Epoch: 5 cost time: 2.2136993408203125
Epoch: 5, Steps: 12 | Train Loss: 1.201 Vali Loss: 1.198 Vali Acc: 0.667 Test Loss: 1.198 Test Acc: 0.667
Validation loss decreased (-0.527763 --> -0.666655).  Saving model ...
Epoch: 6 cost time: 2.0939338207244873
Epoch: 6, Steps: 12 | Train Loss: 1.021 Vali Loss: 1.095 Vali Acc: 0.678 Test Loss: 1.095 Test Acc: 0.678
Validation loss decreased (-0.666655 --> -0.677767).  Saving model ...
Epoch: 7 cost time: 1.6900043487548828
Epoch: 7, Steps: 12 | Train Loss: 0.792 Vali Loss: 0.911 Vali Acc: 0.733 Test Loss: 0.911 Test Acc: 0.733
Validation loss decreased (-0.677767 --> -0.733324).  Saving model ...
Epoch: 8 cost time: 1.9675137996673584
Epoch: 8, Steps: 12 | Train Loss: 0.695 Vali Loss: 0.802 Vali Acc: 0.750 Test Loss: 0.802 Test Acc: 0.750
Validation loss decreased (-0.733324 --> -0.749992).  Saving model ...
Epoch: 9 cost time: 2.177079439163208
Epoch: 9, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.795 Vali Acc: 0.794 Test Loss: 0.795 Test Acc: 0.794
Validation loss decreased (-0.749992 --> -0.794436).  Saving model ...
Epoch: 10 cost time: 2.3071835041046143
Epoch: 10, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.650 Vali Acc: 0.844 Test Loss: 0.650 Test Acc: 0.844
Validation loss decreased (-0.794436 --> -0.844438).  Saving model ...
Epoch: 11 cost time: 2.6621387004852295
Epoch: 11, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.695 Vali Acc: 0.822 Test Loss: 0.695 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8501830101013184
Epoch: 12, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.775 Vali Acc: 0.806 Test Loss: 0.775 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0657083988189697
Epoch: 13, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.672 Vali Acc: 0.822 Test Loss: 0.672 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.024604082107544
Epoch: 14, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.734 Vali Acc: 0.817 Test Loss: 0.734 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.991370439529419
Epoch: 15, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.687 Vali Acc: 0.828 Test Loss: 0.687 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.296276569366455
Epoch: 16, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.738 Vali Acc: 0.806 Test Loss: 0.738 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.1852643489837646
Epoch: 17, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.562 Vali Acc: 0.800 Test Loss: 0.562 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.053398609161377
Epoch: 18, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.610 Vali Acc: 0.878 Test Loss: 0.610 Test Acc: 0.878
Validation loss decreased (-0.844438 --> -0.877772).  Saving model ...
Epoch: 19 cost time: 2.003586530685425
Epoch: 19, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.692 Vali Acc: 0.833 Test Loss: 0.692 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.2210800647735596
Epoch: 20, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.610 Vali Acc: 0.856 Test Loss: 0.610 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.242450714111328
Epoch: 21, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.615 Vali Acc: 0.856 Test Loss: 0.615 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.7852745056152344
Epoch: 22, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.604 Vali Acc: 0.861 Test Loss: 0.604 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.1315760612487793
Epoch: 23, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.629 Vali Acc: 0.806 Test Loss: 0.629 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.145411491394043
Epoch: 24, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.781 Vali Acc: 0.839 Test Loss: 0.781 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.079254150390625
Epoch: 25, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.677 Vali Acc: 0.861 Test Loss: 0.677 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.3736367225646973
Epoch: 26, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.744 Vali Acc: 0.833 Test Loss: 0.744 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.008643627166748
Epoch: 27, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.773 Vali Acc: 0.856 Test Loss: 0.773 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.596914529800415
Epoch: 28, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.748 Vali Acc: 0.856 Test Loss: 0.748 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 11899211
model size : 50.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.1873064041137695
Epoch: 1, Steps: 12 | Train Loss: 2.797 Vali Loss: 2.569 Vali Acc: 0.244 Test Loss: 2.569 Test Acc: 0.244
Validation loss decreased (inf --> -0.244419).  Saving model ...
Epoch: 2 cost time: 2.3280649185180664
Epoch: 2, Steps: 12 | Train Loss: 2.407 Vali Loss: 2.153 Vali Acc: 0.400 Test Loss: 2.153 Test Acc: 0.400
Validation loss decreased (-0.244419 --> -0.399978).  Saving model ...
Epoch: 3 cost time: 2.648390531539917
Epoch: 3, Steps: 12 | Train Loss: 1.951 Vali Loss: 1.747 Vali Acc: 0.494 Test Loss: 1.747 Test Acc: 0.494
Validation loss decreased (-0.399978 --> -0.494427).  Saving model ...
Epoch: 4 cost time: 2.922647476196289
Epoch: 4, Steps: 12 | Train Loss: 1.483 Vali Loss: 1.450 Vali Acc: 0.572 Test Loss: 1.450 Test Acc: 0.572
Validation loss decreased (-0.494427 --> -0.572208).  Saving model ...
Epoch: 5 cost time: 2.8438405990600586
Epoch: 5, Steps: 12 | Train Loss: 1.280 Vali Loss: 1.245 Vali Acc: 0.628 Test Loss: 1.245 Test Acc: 0.628
Validation loss decreased (-0.572208 --> -0.627765).  Saving model ...
Epoch: 6 cost time: 3.2518603801727295
Epoch: 6, Steps: 12 | Train Loss: 1.028 Vali Loss: 1.128 Vali Acc: 0.633 Test Loss: 1.128 Test Acc: 0.633
Validation loss decreased (-0.627765 --> -0.633322).  Saving model ...
Epoch: 7 cost time: 2.9272823333740234
Epoch: 7, Steps: 12 | Train Loss: 0.804 Vali Loss: 0.965 Vali Acc: 0.711 Test Loss: 0.965 Test Acc: 0.711
Validation loss decreased (-0.633322 --> -0.711101).  Saving model ...
Epoch: 8 cost time: 3.2899606227874756
Epoch: 8, Steps: 12 | Train Loss: 0.768 Vali Loss: 0.909 Vali Acc: 0.717 Test Loss: 0.909 Test Acc: 0.717
Validation loss decreased (-0.711101 --> -0.716658).  Saving model ...
Epoch: 9 cost time: 2.5385396480560303
Epoch: 9, Steps: 12 | Train Loss: 0.605 Vali Loss: 0.892 Vali Acc: 0.744 Test Loss: 0.892 Test Acc: 0.744
Validation loss decreased (-0.716658 --> -0.744436).  Saving model ...
Epoch: 10 cost time: 3.1163249015808105
Epoch: 10, Steps: 12 | Train Loss: 0.612 Vali Loss: 0.830 Vali Acc: 0.783 Test Loss: 0.830 Test Acc: 0.783
Validation loss decreased (-0.744436 --> -0.783325).  Saving model ...
Epoch: 11 cost time: 2.7656898498535156
Epoch: 11, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.731 Vali Acc: 0.756 Test Loss: 0.731 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3659257888793945
Epoch: 12, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.760 Vali Acc: 0.789 Test Loss: 0.760 Test Acc: 0.789
Validation loss decreased (-0.783325 --> -0.788881).  Saving model ...
Epoch: 13 cost time: 3.0567750930786133
Epoch: 13, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.644 Vali Acc: 0.822 Test Loss: 0.644 Test Acc: 0.822
Validation loss decreased (-0.788881 --> -0.822216).  Saving model ...
Epoch: 14 cost time: 2.8303322792053223
Epoch: 14, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.614 Vali Acc: 0.806 Test Loss: 0.614 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.40838885307312
Epoch: 15, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.600 Vali Acc: 0.856 Test Loss: 0.600 Test Acc: 0.856
Validation loss decreased (-0.822216 --> -0.855550).  Saving model ...
Epoch: 16 cost time: 2.6090354919433594
Epoch: 16, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.606 Vali Acc: 0.856 Test Loss: 0.606 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.73496413230896
Epoch: 17, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.572 Vali Acc: 0.833 Test Loss: 0.572 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.6724696159362793
Epoch: 18, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.624 Vali Acc: 0.844 Test Loss: 0.624 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.3614349365234375
Epoch: 19, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.503 Vali Acc: 0.861 Test Loss: 0.503 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 20 cost time: 2.874858856201172
Epoch: 20, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.596 Vali Acc: 0.856 Test Loss: 0.596 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.6172871589660645
Epoch: 21, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.585 Vali Acc: 0.828 Test Loss: 0.585 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.428262233734131
Epoch: 22, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.808 Vali Acc: 0.750 Test Loss: 0.808 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.43076491355896
Epoch: 23, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.679 Vali Acc: 0.822 Test Loss: 0.679 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.7078301906585693
Epoch: 24, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.804 Vali Acc: 0.856 Test Loss: 0.804 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.1957848072052
Epoch: 25, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.651 Vali Acc: 0.867 Test Loss: 0.651 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866660).  Saving model ...
Epoch: 26 cost time: 2.444960832595825
Epoch: 26, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.792 Vali Acc: 0.850 Test Loss: 0.792 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.5470550060272217
Epoch: 27, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.639 Vali Acc: 0.850 Test Loss: 0.639 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.82384991645813
Epoch: 28, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.785 Vali Acc: 0.828 Test Loss: 0.785 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.3768093585968018
Epoch: 29, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.653 Vali Acc: 0.872 Test Loss: 0.653 Test Acc: 0.872
Validation loss decreased (-0.866660 --> -0.872216).  Saving model ...
Epoch: 30 cost time: 2.036043882369995
Epoch: 30, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.671 Vali Acc: 0.861 Test Loss: 0.671 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.6095128059387207
Epoch: 31, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.695 Vali Acc: 0.861 Test Loss: 0.695 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.4657344818115234
Epoch: 32, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.666 Vali Acc: 0.867 Test Loss: 0.666 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.5643928050994873
Epoch: 33, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.716 Vali Acc: 0.867 Test Loss: 0.716 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.3858659267425537
Epoch: 34, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.651 Vali Acc: 0.833 Test Loss: 0.651 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.3656792640686035
Epoch: 35, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.927 Vali Acc: 0.806 Test Loss: 0.927 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.3896372318267822
Epoch: 36, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.753 Vali Acc: 0.856 Test Loss: 0.753 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.546821355819702
Epoch: 37, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.886 Vali Acc: 0.811 Test Loss: 0.886 Test Acc: 0.811
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.4146509170532227
Epoch: 38, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.557 Vali Acc: 0.856 Test Loss: 0.557 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.3059492111206055
Epoch: 39, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.673 Vali Acc: 0.844 Test Loss: 0.673 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 10723403
model size : 45.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.482380151748657
Epoch: 1, Steps: 12 | Train Loss: 2.774 Vali Loss: 2.607 Vali Acc: 0.239 Test Loss: 2.607 Test Acc: 0.239
Validation loss decreased (inf --> -0.238863).  Saving model ...
Epoch: 2 cost time: 2.4171087741851807
Epoch: 2, Steps: 12 | Train Loss: 2.497 Vali Loss: 2.226 Vali Acc: 0.406 Test Loss: 2.226 Test Acc: 0.406
Validation loss decreased (-0.238863 --> -0.405533).  Saving model ...
Epoch: 3 cost time: 2.3425164222717285
Epoch: 3, Steps: 12 | Train Loss: 1.899 Vali Loss: 1.778 Vali Acc: 0.483 Test Loss: 1.778 Test Acc: 0.483
Validation loss decreased (-0.405533 --> -0.483316).  Saving model ...
Epoch: 4 cost time: 2.2013607025146484
Epoch: 4, Steps: 12 | Train Loss: 1.482 Vali Loss: 1.462 Vali Acc: 0.567 Test Loss: 1.462 Test Acc: 0.567
Validation loss decreased (-0.483316 --> -0.566652).  Saving model ...
Epoch: 5 cost time: 2.2532804012298584
Epoch: 5, Steps: 12 | Train Loss: 1.188 Vali Loss: 1.238 Vali Acc: 0.622 Test Loss: 1.238 Test Acc: 0.622
Validation loss decreased (-0.566652 --> -0.622210).  Saving model ...
Epoch: 6 cost time: 2.2782018184661865
Epoch: 6, Steps: 12 | Train Loss: 0.991 Vali Loss: 1.144 Vali Acc: 0.639 Test Loss: 1.144 Test Acc: 0.639
Validation loss decreased (-0.622210 --> -0.638877).  Saving model ...
Epoch: 7 cost time: 2.6282732486724854
Epoch: 7, Steps: 12 | Train Loss: 0.827 Vali Loss: 1.013 Vali Acc: 0.683 Test Loss: 1.013 Test Acc: 0.683
Validation loss decreased (-0.638877 --> -0.683323).  Saving model ...
Epoch: 8 cost time: 2.3254334926605225
Epoch: 8, Steps: 12 | Train Loss: 0.767 Vali Loss: 0.864 Vali Acc: 0.711 Test Loss: 0.864 Test Acc: 0.711
Validation loss decreased (-0.683323 --> -0.711102).  Saving model ...
Epoch: 9 cost time: 2.206148624420166
Epoch: 9, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.786 Vali Acc: 0.739 Test Loss: 0.786 Test Acc: 0.739
Validation loss decreased (-0.711102 --> -0.738881).  Saving model ...
Epoch: 10 cost time: 2.0926764011383057
Epoch: 10, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.821 Vali Acc: 0.761 Test Loss: 0.821 Test Acc: 0.761
Validation loss decreased (-0.738881 --> -0.761103).  Saving model ...
Epoch: 11 cost time: 2.1794638633728027
Epoch: 11, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.731 Vali Acc: 0.833 Test Loss: 0.731 Test Acc: 0.833
Validation loss decreased (-0.761103 --> -0.833326).  Saving model ...
Epoch: 12 cost time: 2.456984043121338
Epoch: 12, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.646 Vali Acc: 0.817 Test Loss: 0.646 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2766354084014893
Epoch: 13, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.673 Vali Acc: 0.839 Test Loss: 0.673 Test Acc: 0.839
Validation loss decreased (-0.833326 --> -0.838882).  Saving model ...
Epoch: 14 cost time: 1.9955699443817139
Epoch: 14, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.709 Vali Acc: 0.817 Test Loss: 0.709 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0789172649383545
Epoch: 15, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.609 Vali Acc: 0.833 Test Loss: 0.609 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.3866591453552246
Epoch: 16, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.649 Vali Acc: 0.839 Test Loss: 0.649 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838882).  Saving model ...
Epoch: 17 cost time: 2.54965877532959
Epoch: 17, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.629 Vali Acc: 0.856 Test Loss: 0.629 Test Acc: 0.856
Validation loss decreased (-0.838882 --> -0.855549).  Saving model ...
Epoch: 18 cost time: 2.4462947845458984
Epoch: 18, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.739 Vali Acc: 0.828 Test Loss: 0.739 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.351459503173828
Epoch: 19, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.636 Vali Acc: 0.833 Test Loss: 0.636 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.294053792953491
Epoch: 20, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.780 Vali Acc: 0.778 Test Loss: 0.780 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.4675092697143555
Epoch: 21, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.719 Vali Acc: 0.844 Test Loss: 0.719 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.303757667541504
Epoch: 22, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.845 Vali Acc: 0.844 Test Loss: 0.845 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.2375905513763428
Epoch: 23, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.734 Vali Acc: 0.828 Test Loss: 0.734 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.109853982925415
Epoch: 24, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.626 Vali Acc: 0.833 Test Loss: 0.626 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.0822553634643555
Epoch: 25, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.682 Vali Acc: 0.817 Test Loss: 0.682 Test Acc: 0.817
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.12998366355896
Epoch: 26, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.591 Vali Acc: 0.861 Test Loss: 0.591 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 27 cost time: 2.731200695037842
Epoch: 27, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.651 Vali Acc: 0.856 Test Loss: 0.651 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.3139095306396484
Epoch: 28, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.587 Vali Acc: 0.850 Test Loss: 0.587 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.4354336261749268
Epoch: 29, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.639 Vali Acc: 0.867 Test Loss: 0.639 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866660).  Saving model ...
Epoch: 30 cost time: 2.2473466396331787
Epoch: 30, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.658 Vali Acc: 0.833 Test Loss: 0.658 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.2025856971740723
Epoch: 31, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.601 Vali Acc: 0.867 Test Loss: 0.601 Test Acc: 0.867
Validation loss decreased (-0.866660 --> -0.866661).  Saving model ...
Epoch: 32 cost time: 2.262809991836548
Epoch: 32, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.785 Vali Acc: 0.856 Test Loss: 0.785 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.637047290802002
Epoch: 33, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.593 Vali Acc: 0.867 Test Loss: 0.593 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 34 cost time: 2.493069887161255
Epoch: 34, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.605 Vali Acc: 0.861 Test Loss: 0.605 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.398160457611084
Epoch: 35, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.813 Vali Acc: 0.822 Test Loss: 0.813 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.3024933338165283
Epoch: 36, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.702 Vali Acc: 0.828 Test Loss: 0.702 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.2377407550811768
Epoch: 37, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.688 Vali Acc: 0.828 Test Loss: 0.688 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.544466495513916
Epoch: 38, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.718 Vali Acc: 0.828 Test Loss: 0.718 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.3794164657592773
Epoch: 39, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.678 Vali Acc: 0.850 Test Loss: 0.678 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.2507052421569824
Epoch: 40, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.800 Vali Acc: 0.828 Test Loss: 0.800 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.1377811431884766
Epoch: 41, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.781 Vali Acc: 0.822 Test Loss: 0.781 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.817746639251709
Epoch: 42, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.832 Vali Acc: 0.833 Test Loss: 0.832 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.34128999710083
Epoch: 43, Steps: 12 | Train Loss: 0.161 Vali Loss: 1.005 Vali Acc: 0.806 Test Loss: 1.005 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 10721355
model size : 45.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.3266706466674805
Epoch: 1, Steps: 12 | Train Loss: 2.781 Vali Loss: 2.510 Vali Acc: 0.217 Test Loss: 2.510 Test Acc: 0.217
Validation loss decreased (inf --> -0.216642).  Saving model ...
Epoch: 2 cost time: 2.321523666381836
Epoch: 2, Steps: 12 | Train Loss: 2.353 Vali Loss: 2.025 Vali Acc: 0.456 Test Loss: 2.025 Test Acc: 0.456
Validation loss decreased (-0.216642 --> -0.455535).  Saving model ...
Epoch: 3 cost time: 2.1264936923980713
Epoch: 3, Steps: 12 | Train Loss: 1.946 Vali Loss: 1.703 Vali Acc: 0.578 Test Loss: 1.703 Test Acc: 0.578
Validation loss decreased (-0.455535 --> -0.577761).  Saving model ...
Epoch: 4 cost time: 2.764190435409546
Epoch: 4, Steps: 12 | Train Loss: 1.473 Vali Loss: 1.526 Vali Acc: 0.561 Test Loss: 1.526 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.471116542816162
Epoch: 5, Steps: 12 | Train Loss: 1.280 Vali Loss: 1.279 Vali Acc: 0.606 Test Loss: 1.279 Test Acc: 0.606
Validation loss decreased (-0.577761 --> -0.605543).  Saving model ...
Epoch: 6 cost time: 2.6212759017944336
Epoch: 6, Steps: 12 | Train Loss: 1.058 Vali Loss: 1.116 Vali Acc: 0.606 Test Loss: 1.116 Test Acc: 0.606
Validation loss decreased (-0.605543 --> -0.605544).  Saving model ...
Epoch: 7 cost time: 2.507479429244995
Epoch: 7, Steps: 12 | Train Loss: 0.817 Vali Loss: 0.970 Vali Acc: 0.733 Test Loss: 0.970 Test Acc: 0.733
Validation loss decreased (-0.605544 --> -0.733324).  Saving model ...
Epoch: 8 cost time: 2.6646668910980225
Epoch: 8, Steps: 12 | Train Loss: 0.769 Vali Loss: 1.170 Vali Acc: 0.600 Test Loss: 1.170 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.489612340927124
Epoch: 9, Steps: 12 | Train Loss: 0.666 Vali Loss: 0.893 Vali Acc: 0.739 Test Loss: 0.893 Test Acc: 0.739
Validation loss decreased (-0.733324 --> -0.738880).  Saving model ...
Epoch: 10 cost time: 2.11287784576416
Epoch: 10, Steps: 12 | Train Loss: 0.538 Vali Loss: 0.777 Vali Acc: 0.772 Test Loss: 0.777 Test Acc: 0.772
Validation loss decreased (-0.738880 --> -0.772214).  Saving model ...
Epoch: 11 cost time: 2.55605149269104
Epoch: 11, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.735 Vali Acc: 0.811 Test Loss: 0.735 Test Acc: 0.811
Validation loss decreased (-0.772214 --> -0.811104).  Saving model ...
Epoch: 12 cost time: 2.8128721714019775
Epoch: 12, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.673 Vali Acc: 0.839 Test Loss: 0.673 Test Acc: 0.839
Validation loss decreased (-0.811104 --> -0.838882).  Saving model ...
Epoch: 13 cost time: 2.4060490131378174
Epoch: 13, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.641 Vali Acc: 0.822 Test Loss: 0.641 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.452552318572998
Epoch: 14, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.596 Vali Acc: 0.850 Test Loss: 0.596 Test Acc: 0.850
Validation loss decreased (-0.838882 --> -0.849994).  Saving model ...
Epoch: 15 cost time: 2.3449554443359375
Epoch: 15, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.605 Vali Acc: 0.850 Test Loss: 0.605 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.949068307876587
Epoch: 16, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.757 Vali Acc: 0.817 Test Loss: 0.757 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.2946271896362305
Epoch: 17, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.624 Vali Acc: 0.833 Test Loss: 0.624 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.787452220916748
Epoch: 18, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.638 Vali Acc: 0.822 Test Loss: 0.638 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.373065710067749
Epoch: 19, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.627 Vali Acc: 0.861 Test Loss: 0.627 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 20 cost time: 2.6481077671051025
Epoch: 20, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.597 Vali Acc: 0.861 Test Loss: 0.597 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 21 cost time: 2.3482866287231445
Epoch: 21, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.618 Vali Acc: 0.850 Test Loss: 0.618 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.7202670574188232
Epoch: 22, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.648 Vali Acc: 0.817 Test Loss: 0.648 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.930286169052124
Epoch: 23, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.509 Vali Acc: 0.883 Test Loss: 0.509 Test Acc: 0.883
Validation loss decreased (-0.861105 --> -0.883328).  Saving model ...
Epoch: 24 cost time: 2.4136600494384766
Epoch: 24, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.542 Vali Acc: 0.872 Test Loss: 0.542 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.2689919471740723
Epoch: 25, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.453 Vali Acc: 0.900 Test Loss: 0.453 Test Acc: 0.900
Validation loss decreased (-0.883328 --> -0.899995).  Saving model ...
Epoch: 26 cost time: 2.3402650356292725
Epoch: 26, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.533 Vali Acc: 0.867 Test Loss: 0.533 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.3174328804016113
Epoch: 27, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.665 Vali Acc: 0.856 Test Loss: 0.665 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.419128656387329
Epoch: 28, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.675 Vali Acc: 0.856 Test Loss: 0.675 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.0235443115234375
Epoch: 29, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.748 Vali Acc: 0.861 Test Loss: 0.748 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.2483971118927
Epoch: 30, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.531 Vali Acc: 0.872 Test Loss: 0.531 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.966907501220703
Epoch: 31, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.841 Vali Acc: 0.850 Test Loss: 0.841 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.3578760623931885
Epoch: 32, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.901 Vali Acc: 0.856 Test Loss: 0.901 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.3162264823913574
Epoch: 33, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.540 Vali Acc: 0.833 Test Loss: 0.540 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.6070427894592285
Epoch: 34, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.729 Vali Acc: 0.833 Test Loss: 0.729 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.916205644607544
Epoch: 35, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.891 Vali Acc: 0.767 Test Loss: 0.891 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 10719307
model size : 45.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.956332206726074
Epoch: 1, Steps: 12 | Train Loss: 2.837 Vali Loss: 2.570 Vali Acc: 0.150 Test Loss: 2.570 Test Acc: 0.150
Validation loss decreased (inf --> -0.149974).  Saving model ...
Epoch: 2 cost time: 2.604644536972046
Epoch: 2, Steps: 12 | Train Loss: 2.444 Vali Loss: 2.170 Vali Acc: 0.406 Test Loss: 2.170 Test Acc: 0.406
Validation loss decreased (-0.149974 --> -0.405534).  Saving model ...
Epoch: 3 cost time: 2.183018684387207
Epoch: 3, Steps: 12 | Train Loss: 1.929 Vali Loss: 1.705 Vali Acc: 0.572 Test Loss: 1.705 Test Acc: 0.572
Validation loss decreased (-0.405534 --> -0.572205).  Saving model ...
Epoch: 4 cost time: 2.1304993629455566
Epoch: 4, Steps: 12 | Train Loss: 1.516 Vali Loss: 1.474 Vali Acc: 0.583 Test Loss: 1.474 Test Acc: 0.583
Validation loss decreased (-0.572205 --> -0.583319).  Saving model ...
Epoch: 5 cost time: 2.497230291366577
Epoch: 5, Steps: 12 | Train Loss: 1.257 Vali Loss: 1.338 Vali Acc: 0.617 Test Loss: 1.338 Test Acc: 0.617
Validation loss decreased (-0.583319 --> -0.616653).  Saving model ...
Epoch: 6 cost time: 2.354022979736328
Epoch: 6, Steps: 12 | Train Loss: 1.072 Vali Loss: 1.089 Vali Acc: 0.644 Test Loss: 1.089 Test Acc: 0.644
Validation loss decreased (-0.616653 --> -0.644434).  Saving model ...
Epoch: 7 cost time: 2.4278719425201416
Epoch: 7, Steps: 12 | Train Loss: 0.894 Vali Loss: 0.966 Vali Acc: 0.678 Test Loss: 0.966 Test Acc: 0.678
Validation loss decreased (-0.644434 --> -0.677768).  Saving model ...
Epoch: 8 cost time: 1.9487957954406738
Epoch: 8, Steps: 12 | Train Loss: 0.690 Vali Loss: 0.802 Vali Acc: 0.778 Test Loss: 0.802 Test Acc: 0.778
Validation loss decreased (-0.677768 --> -0.777770).  Saving model ...
Epoch: 9 cost time: 2.2960402965545654
Epoch: 9, Steps: 12 | Train Loss: 0.538 Vali Loss: 0.818 Vali Acc: 0.733 Test Loss: 0.818 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2452313899993896
Epoch: 10, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.722 Vali Acc: 0.744 Test Loss: 0.722 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9441978931427002
Epoch: 11, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.954 Vali Acc: 0.750 Test Loss: 0.954 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.213829755783081
Epoch: 12, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.620 Vali Acc: 0.850 Test Loss: 0.620 Test Acc: 0.850
Validation loss decreased (-0.777770 --> -0.849994).  Saving model ...
Epoch: 13 cost time: 2.3614211082458496
Epoch: 13, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.797 Vali Acc: 0.789 Test Loss: 0.797 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.316246747970581
Epoch: 14, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.615 Vali Acc: 0.844 Test Loss: 0.615 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.356051445007324
Epoch: 15, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.622 Vali Acc: 0.822 Test Loss: 0.622 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.649129629135132
Epoch: 16, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.632 Vali Acc: 0.828 Test Loss: 0.632 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.281233549118042
Epoch: 17, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.700 Vali Acc: 0.833 Test Loss: 0.700 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.5739684104919434
Epoch: 18, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.632 Vali Acc: 0.811 Test Loss: 0.632 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.302455186843872
Epoch: 19, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.533 Vali Acc: 0.861 Test Loss: 0.533 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861106).  Saving model ...
Epoch: 20 cost time: 2.1417627334594727
Epoch: 20, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.549 Vali Acc: 0.883 Test Loss: 0.549 Test Acc: 0.883
Validation loss decreased (-0.861106 --> -0.883328).  Saving model ...
Epoch: 21 cost time: 2.526688575744629
Epoch: 21, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.539 Vali Acc: 0.856 Test Loss: 0.539 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.587085485458374
Epoch: 22, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.636 Vali Acc: 0.850 Test Loss: 0.636 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.0438058376312256
Epoch: 23, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.666 Vali Acc: 0.844 Test Loss: 0.666 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.3920445442199707
Epoch: 24, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.720 Vali Acc: 0.822 Test Loss: 0.720 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.3513600826263428
Epoch: 25, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.736 Vali Acc: 0.822 Test Loss: 0.736 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.117126703262329
Epoch: 26, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.738 Vali Acc: 0.822 Test Loss: 0.738 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.1020941734313965
Epoch: 27, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.678 Vali Acc: 0.839 Test Loss: 0.678 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.831831455230713
Epoch: 28, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.777 Vali Acc: 0.850 Test Loss: 0.777 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.0557668209075928
Epoch: 29, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.734 Vali Acc: 0.844 Test Loss: 0.734 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.9756431579589844
Epoch: 30, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.688 Vali Acc: 0.839 Test Loss: 0.688 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 10717259
model size : 45.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.778470993041992
Epoch: 1, Steps: 12 | Train Loss: 2.785 Vali Loss: 2.540 Vali Acc: 0.183 Test Loss: 2.540 Test Acc: 0.183
Validation loss decreased (inf --> -0.183308).  Saving model ...
Epoch: 2 cost time: 2.230550765991211
Epoch: 2, Steps: 12 | Train Loss: 2.419 Vali Loss: 2.136 Vali Acc: 0.422 Test Loss: 2.136 Test Acc: 0.422
Validation loss decreased (-0.183308 --> -0.422201).  Saving model ...
Epoch: 3 cost time: 2.7110979557037354
Epoch: 3, Steps: 12 | Train Loss: 1.930 Vali Loss: 1.763 Vali Acc: 0.478 Test Loss: 1.763 Test Acc: 0.478
Validation loss decreased (-0.422201 --> -0.477760).  Saving model ...
Epoch: 4 cost time: 2.210893392562866
Epoch: 4, Steps: 12 | Train Loss: 1.494 Vali Loss: 1.444 Vali Acc: 0.578 Test Loss: 1.444 Test Acc: 0.578
Validation loss decreased (-0.477760 --> -0.577763).  Saving model ...
Epoch: 5 cost time: 2.086428165435791
Epoch: 5, Steps: 12 | Train Loss: 1.243 Vali Loss: 1.300 Vali Acc: 0.639 Test Loss: 1.300 Test Acc: 0.639
Validation loss decreased (-0.577763 --> -0.638876).  Saving model ...
Epoch: 6 cost time: 2.2924225330352783
Epoch: 6, Steps: 12 | Train Loss: 1.081 Vali Loss: 1.172 Vali Acc: 0.689 Test Loss: 1.172 Test Acc: 0.689
Validation loss decreased (-0.638876 --> -0.688877).  Saving model ...
Epoch: 7 cost time: 1.9655711650848389
Epoch: 7, Steps: 12 | Train Loss: 0.925 Vali Loss: 1.039 Vali Acc: 0.661 Test Loss: 1.039 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3383114337921143
Epoch: 8, Steps: 12 | Train Loss: 0.815 Vali Loss: 1.050 Vali Acc: 0.639 Test Loss: 1.050 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3715810775756836
Epoch: 9, Steps: 12 | Train Loss: 0.695 Vali Loss: 0.885 Vali Acc: 0.689 Test Loss: 0.885 Test Acc: 0.689
Validation loss decreased (-0.688877 --> -0.688880).  Saving model ...
Epoch: 10 cost time: 2.5868308544158936
Epoch: 10, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.958 Vali Acc: 0.728 Test Loss: 0.958 Test Acc: 0.728
Validation loss decreased (-0.688880 --> -0.727768).  Saving model ...
Epoch: 11 cost time: 2.138378620147705
Epoch: 11, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.856 Vali Acc: 0.717 Test Loss: 0.856 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.523353099822998
Epoch: 12, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.712 Vali Acc: 0.800 Test Loss: 0.712 Test Acc: 0.800
Validation loss decreased (-0.727768 --> -0.799993).  Saving model ...
Epoch: 13 cost time: 2.736985683441162
Epoch: 13, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.680 Vali Acc: 0.772 Test Loss: 0.680 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5901095867156982
Epoch: 14, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.714 Vali Acc: 0.767 Test Loss: 0.714 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.559731960296631
Epoch: 15, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.639 Vali Acc: 0.867 Test Loss: 0.639 Test Acc: 0.867
Validation loss decreased (-0.799993 --> -0.866660).  Saving model ...
Epoch: 16 cost time: 2.128584384918213
Epoch: 16, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.603 Vali Acc: 0.828 Test Loss: 0.603 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2744977474212646
Epoch: 17, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.891 Vali Acc: 0.750 Test Loss: 0.891 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.3069589138031006
Epoch: 18, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.690 Vali Acc: 0.811 Test Loss: 0.690 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.37302303314209
Epoch: 19, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.644 Vali Acc: 0.850 Test Loss: 0.644 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.8157451152801514
Epoch: 20, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.606 Vali Acc: 0.856 Test Loss: 0.606 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.1321845054626465
Epoch: 21, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.655 Vali Acc: 0.839 Test Loss: 0.655 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.3969664573669434
Epoch: 22, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.692 Vali Acc: 0.844 Test Loss: 0.692 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.169447660446167
Epoch: 23, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.595 Vali Acc: 0.861 Test Loss: 0.595 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.7366943359375
Epoch: 24, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.682 Vali Acc: 0.822 Test Loss: 0.682 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.3679704666137695
Epoch: 25, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.612 Vali Acc: 0.861 Test Loss: 0.612 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 10132427
model size : 43.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.024977445602417
Epoch: 1, Steps: 12 | Train Loss: 2.811 Vali Loss: 2.637 Vali Acc: 0.133 Test Loss: 2.637 Test Acc: 0.133
Validation loss decreased (inf --> -0.133307).  Saving model ...
Epoch: 2 cost time: 2.843414068222046
Epoch: 2, Steps: 12 | Train Loss: 2.507 Vali Loss: 2.228 Vali Acc: 0.350 Test Loss: 2.228 Test Acc: 0.350
Validation loss decreased (-0.133307 --> -0.349978).  Saving model ...
Epoch: 3 cost time: 2.2961020469665527
Epoch: 3, Steps: 12 | Train Loss: 1.970 Vali Loss: 1.810 Vali Acc: 0.494 Test Loss: 1.810 Test Acc: 0.494
Validation loss decreased (-0.349978 --> -0.494426).  Saving model ...
Epoch: 4 cost time: 2.7045257091522217
Epoch: 4, Steps: 12 | Train Loss: 1.514 Vali Loss: 1.487 Vali Acc: 0.578 Test Loss: 1.487 Test Acc: 0.578
Validation loss decreased (-0.494426 --> -0.577763).  Saving model ...
Epoch: 5 cost time: 2.612100601196289
Epoch: 5, Steps: 12 | Train Loss: 1.240 Vali Loss: 1.272 Vali Acc: 0.622 Test Loss: 1.272 Test Acc: 0.622
Validation loss decreased (-0.577763 --> -0.622210).  Saving model ...
Epoch: 6 cost time: 2.9646084308624268
Epoch: 6, Steps: 12 | Train Loss: 1.114 Vali Loss: 1.083 Vali Acc: 0.667 Test Loss: 1.083 Test Acc: 0.667
Validation loss decreased (-0.622210 --> -0.666656).  Saving model ...
Epoch: 7 cost time: 2.4064910411834717
Epoch: 7, Steps: 12 | Train Loss: 0.873 Vali Loss: 0.970 Vali Acc: 0.733 Test Loss: 0.970 Test Acc: 0.733
Validation loss decreased (-0.666656 --> -0.733324).  Saving model ...
Epoch: 8 cost time: 2.3941023349761963
Epoch: 8, Steps: 12 | Train Loss: 0.699 Vali Loss: 0.885 Vali Acc: 0.722 Test Loss: 0.885 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.439365863800049
Epoch: 9, Steps: 12 | Train Loss: 0.599 Vali Loss: 0.728 Vali Acc: 0.772 Test Loss: 0.728 Test Acc: 0.772
Validation loss decreased (-0.733324 --> -0.772215).  Saving model ...
Epoch: 10 cost time: 2.714975357055664
Epoch: 10, Steps: 12 | Train Loss: 0.554 Vali Loss: 0.728 Vali Acc: 0.772 Test Loss: 0.728 Test Acc: 0.772
Validation loss decreased (-0.772215 --> -0.772215).  Saving model ...
Epoch: 11 cost time: 2.4298958778381348
Epoch: 11, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.765 Vali Acc: 0.811 Test Loss: 0.765 Test Acc: 0.811
Validation loss decreased (-0.772215 --> -0.811103).  Saving model ...
Epoch: 12 cost time: 2.404287815093994
Epoch: 12, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.647 Vali Acc: 0.783 Test Loss: 0.647 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.116082191467285
Epoch: 13, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.621 Vali Acc: 0.839 Test Loss: 0.621 Test Acc: 0.839
Validation loss decreased (-0.811103 --> -0.838883).  Saving model ...
Epoch: 14 cost time: 2.962434768676758
Epoch: 14, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.616 Vali Acc: 0.839 Test Loss: 0.616 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 15 cost time: 2.854264259338379
Epoch: 15, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.705 Vali Acc: 0.778 Test Loss: 0.705 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.862380266189575
Epoch: 16, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.593 Vali Acc: 0.817 Test Loss: 0.593 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.3369040489196777
Epoch: 17, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.566 Vali Acc: 0.817 Test Loss: 0.566 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.49495530128479
Epoch: 18, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.667 Vali Acc: 0.844 Test Loss: 0.667 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844438).  Saving model ...
Epoch: 19 cost time: 2.6075074672698975
Epoch: 19, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.633 Vali Acc: 0.811 Test Loss: 0.633 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.343621253967285
Epoch: 20, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.586 Vali Acc: 0.856 Test Loss: 0.586 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855550).  Saving model ...
Epoch: 21 cost time: 2.210859775543213
Epoch: 21, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.710 Vali Acc: 0.783 Test Loss: 0.710 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.8353800773620605
Epoch: 22, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.793 Vali Acc: 0.839 Test Loss: 0.793 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.3081469535827637
Epoch: 23, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.746 Vali Acc: 0.800 Test Loss: 0.746 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.302666187286377
Epoch: 24, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.720 Vali Acc: 0.822 Test Loss: 0.720 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.7405340671539307
Epoch: 25, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.688 Vali Acc: 0.844 Test Loss: 0.688 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.6847167015075684
Epoch: 26, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.589 Vali Acc: 0.861 Test Loss: 0.589 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 27 cost time: 2.1242799758911133
Epoch: 27, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.563 Vali Acc: 0.878 Test Loss: 0.563 Test Acc: 0.878
Validation loss decreased (-0.861105 --> -0.877772).  Saving model ...
Epoch: 28 cost time: 2.3028175830841064
Epoch: 28, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.589 Vali Acc: 0.872 Test Loss: 0.589 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.1606783866882324
Epoch: 29, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.714 Vali Acc: 0.817 Test Loss: 0.714 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.1739163398742676
Epoch: 30, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.665 Vali Acc: 0.850 Test Loss: 0.665 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.580653190612793
Epoch: 31, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.552 Vali Acc: 0.856 Test Loss: 0.552 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.4263086318969727
Epoch: 32, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.702 Vali Acc: 0.833 Test Loss: 0.702 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.2625229358673096
Epoch: 33, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.654 Vali Acc: 0.828 Test Loss: 0.654 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.5809459686279297
Epoch: 34, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.710 Vali Acc: 0.872 Test Loss: 0.710 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.462804079055786
Epoch: 35, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.607 Vali Acc: 0.878 Test Loss: 0.607 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.679788589477539
Epoch: 36, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.582 Vali Acc: 0.867 Test Loss: 0.582 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.566652297973633
Epoch: 37, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.806 Vali Acc: 0.811 Test Loss: 0.806 Test Acc: 0.811
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 10130379
model size : 43.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.164073944091797
Epoch: 1, Steps: 12 | Train Loss: 2.799 Vali Loss: 2.607 Vali Acc: 0.089 Test Loss: 2.607 Test Acc: 0.089
Validation loss decreased (inf --> -0.088863).  Saving model ...
Epoch: 2 cost time: 2.4529995918273926
Epoch: 2, Steps: 12 | Train Loss: 2.542 Vali Loss: 2.289 Vali Acc: 0.261 Test Loss: 2.289 Test Acc: 0.261
Validation loss decreased (-0.088863 --> -0.261088).  Saving model ...
Epoch: 3 cost time: 1.9763751029968262
Epoch: 3, Steps: 12 | Train Loss: 2.088 Vali Loss: 1.811 Vali Acc: 0.517 Test Loss: 1.811 Test Acc: 0.517
Validation loss decreased (-0.261088 --> -0.516649).  Saving model ...
Epoch: 4 cost time: 2.2908058166503906
Epoch: 4, Steps: 12 | Train Loss: 1.574 Vali Loss: 1.579 Vali Acc: 0.511 Test Loss: 1.579 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0956568717956543
Epoch: 5, Steps: 12 | Train Loss: 1.283 Vali Loss: 1.296 Vali Acc: 0.567 Test Loss: 1.296 Test Acc: 0.567
Validation loss decreased (-0.516649 --> -0.566654).  Saving model ...
Epoch: 6 cost time: 2.2413759231567383
Epoch: 6, Steps: 12 | Train Loss: 1.080 Vali Loss: 1.139 Vali Acc: 0.639 Test Loss: 1.139 Test Acc: 0.639
Validation loss decreased (-0.566654 --> -0.638878).  Saving model ...
Epoch: 7 cost time: 2.3803870677948
Epoch: 7, Steps: 12 | Train Loss: 0.919 Vali Loss: 1.056 Vali Acc: 0.689 Test Loss: 1.056 Test Acc: 0.689
Validation loss decreased (-0.638878 --> -0.688878).  Saving model ...
Epoch: 8 cost time: 2.7018134593963623
Epoch: 8, Steps: 12 | Train Loss: 0.737 Vali Loss: 0.978 Vali Acc: 0.672 Test Loss: 0.978 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.376704692840576
Epoch: 9, Steps: 12 | Train Loss: 0.695 Vali Loss: 0.882 Vali Acc: 0.711 Test Loss: 0.882 Test Acc: 0.711
Validation loss decreased (-0.688878 --> -0.711102).  Saving model ...
Epoch: 10 cost time: 2.0020675659179688
Epoch: 10, Steps: 12 | Train Loss: 0.564 Vali Loss: 0.808 Vali Acc: 0.744 Test Loss: 0.808 Test Acc: 0.744
Validation loss decreased (-0.711102 --> -0.744436).  Saving model ...
Epoch: 11 cost time: 2.080510377883911
Epoch: 11, Steps: 12 | Train Loss: 0.577 Vali Loss: 0.737 Vali Acc: 0.767 Test Loss: 0.737 Test Acc: 0.767
Validation loss decreased (-0.744436 --> -0.766659).  Saving model ...
Epoch: 12 cost time: 2.284694194793701
Epoch: 12, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.707 Vali Acc: 0.789 Test Loss: 0.707 Test Acc: 0.789
Validation loss decreased (-0.766659 --> -0.788882).  Saving model ...
Epoch: 13 cost time: 2.844576358795166
Epoch: 13, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.567 Vali Acc: 0.822 Test Loss: 0.567 Test Acc: 0.822
Validation loss decreased (-0.788882 --> -0.822217).  Saving model ...
Epoch: 14 cost time: 2.1105637550354004
Epoch: 14, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.831 Vali Acc: 0.789 Test Loss: 0.831 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.439845085144043
Epoch: 15, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.754 Vali Acc: 0.789 Test Loss: 0.754 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.7764575481414795
Epoch: 16, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.576 Vali Acc: 0.828 Test Loss: 0.576 Test Acc: 0.828
Validation loss decreased (-0.822217 --> -0.827772).  Saving model ...
Epoch: 17 cost time: 2.5128872394561768
Epoch: 17, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.676 Vali Acc: 0.811 Test Loss: 0.676 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.1784026622772217
Epoch: 18, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.802 Vali Acc: 0.794 Test Loss: 0.802 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.306442975997925
Epoch: 19, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.603 Vali Acc: 0.850 Test Loss: 0.603 Test Acc: 0.850
Validation loss decreased (-0.827772 --> -0.849994).  Saving model ...
Epoch: 20 cost time: 2.2204372882843018
Epoch: 20, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.561 Vali Acc: 0.872 Test Loss: 0.561 Test Acc: 0.872
Validation loss decreased (-0.849994 --> -0.872217).  Saving model ...
Epoch: 21 cost time: 2.2425425052642822
Epoch: 21, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.655 Vali Acc: 0.856 Test Loss: 0.655 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.008180618286133
Epoch: 22, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.555 Vali Acc: 0.867 Test Loss: 0.555 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.355562925338745
Epoch: 23, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.545 Vali Acc: 0.883 Test Loss: 0.545 Test Acc: 0.883
Validation loss decreased (-0.872217 --> -0.883328).  Saving model ...
Epoch: 24 cost time: 2.709474802017212
Epoch: 24, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.678 Vali Acc: 0.883 Test Loss: 0.678 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.204392671585083
Epoch: 25, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.642 Vali Acc: 0.844 Test Loss: 0.642 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.7465107440948486
Epoch: 26, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.648 Vali Acc: 0.867 Test Loss: 0.648 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.220581293106079
Epoch: 27, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.660 Vali Acc: 0.867 Test Loss: 0.660 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.2998857498168945
Epoch: 28, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.580 Vali Acc: 0.883 Test Loss: 0.580 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.391000986099243
Epoch: 29, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.601 Vali Acc: 0.883 Test Loss: 0.601 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.838837146759033
Epoch: 30, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.598 Vali Acc: 0.894 Test Loss: 0.598 Test Acc: 0.894
Validation loss decreased (-0.883328 --> -0.894438).  Saving model ...
Epoch: 31 cost time: 2.37756609916687
Epoch: 31, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.610 Vali Acc: 0.889 Test Loss: 0.610 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.5969481468200684
Epoch: 32, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.614 Vali Acc: 0.889 Test Loss: 0.614 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.360675573348999
Epoch: 33, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.601 Vali Acc: 0.883 Test Loss: 0.601 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.744330644607544
Epoch: 34, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.610 Vali Acc: 0.878 Test Loss: 0.610 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.5282626152038574
Epoch: 35, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.621 Vali Acc: 0.889 Test Loss: 0.621 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.0534377098083496
Epoch: 36, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.635 Vali Acc: 0.889 Test Loss: 0.635 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.592900276184082
Epoch: 37, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.652 Vali Acc: 0.883 Test Loss: 0.652 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.4689996242523193
Epoch: 38, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.653 Vali Acc: 0.883 Test Loss: 0.653 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 2.356823682785034
Epoch: 39, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.632 Vali Acc: 0.889 Test Loss: 0.632 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 2.5650012493133545
Epoch: 40, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.630 Vali Acc: 0.889 Test Loss: 0.630 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 10128331
model size : 43.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.421241521835327
Epoch: 1, Steps: 12 | Train Loss: 2.828 Vali Loss: 2.552 Vali Acc: 0.167 Test Loss: 2.552 Test Acc: 0.167
Validation loss decreased (inf --> -0.166641).  Saving model ...
Epoch: 2 cost time: 2.378112316131592
Epoch: 2, Steps: 12 | Train Loss: 2.494 Vali Loss: 2.201 Vali Acc: 0.350 Test Loss: 2.201 Test Acc: 0.350
Validation loss decreased (-0.166641 --> -0.349978).  Saving model ...
Epoch: 3 cost time: 2.1939098834991455
Epoch: 3, Steps: 12 | Train Loss: 2.018 Vali Loss: 1.782 Vali Acc: 0.444 Test Loss: 1.782 Test Acc: 0.444
Validation loss decreased (-0.349978 --> -0.444427).  Saving model ...
Epoch: 4 cost time: 2.2021403312683105
Epoch: 4, Steps: 12 | Train Loss: 1.472 Vali Loss: 1.528 Vali Acc: 0.539 Test Loss: 1.528 Test Acc: 0.539
Validation loss decreased (-0.444427 --> -0.538874).  Saving model ...
Epoch: 5 cost time: 2.718040943145752
Epoch: 5, Steps: 12 | Train Loss: 1.247 Vali Loss: 1.280 Vali Acc: 0.583 Test Loss: 1.280 Test Acc: 0.583
Validation loss decreased (-0.538874 --> -0.583321).  Saving model ...
Epoch: 6 cost time: 2.2011101245880127
Epoch: 6, Steps: 12 | Train Loss: 1.048 Vali Loss: 1.160 Vali Acc: 0.672 Test Loss: 1.160 Test Acc: 0.672
Validation loss decreased (-0.583321 --> -0.672211).  Saving model ...
Epoch: 7 cost time: 2.063230037689209
Epoch: 7, Steps: 12 | Train Loss: 0.917 Vali Loss: 0.972 Vali Acc: 0.706 Test Loss: 0.972 Test Acc: 0.706
Validation loss decreased (-0.672211 --> -0.705546).  Saving model ...
Epoch: 8 cost time: 2.1600229740142822
Epoch: 8, Steps: 12 | Train Loss: 0.690 Vali Loss: 0.930 Vali Acc: 0.717 Test Loss: 0.930 Test Acc: 0.717
Validation loss decreased (-0.705546 --> -0.716657).  Saving model ...
Epoch: 9 cost time: 2.1894636154174805
Epoch: 9, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.830 Vali Acc: 0.733 Test Loss: 0.830 Test Acc: 0.733
Validation loss decreased (-0.716657 --> -0.733325).  Saving model ...
Epoch: 10 cost time: 2.279973030090332
Epoch: 10, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.715 Vali Acc: 0.772 Test Loss: 0.715 Test Acc: 0.772
Validation loss decreased (-0.733325 --> -0.772215).  Saving model ...
Epoch: 11 cost time: 2.0578787326812744
Epoch: 11, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.761 Vali Acc: 0.756 Test Loss: 0.761 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0170440673828125
Epoch: 12, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.705 Vali Acc: 0.828 Test Loss: 0.705 Test Acc: 0.828
Validation loss decreased (-0.772215 --> -0.827771).  Saving model ...
Epoch: 13 cost time: 2.4077610969543457
Epoch: 13, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.698 Vali Acc: 0.817 Test Loss: 0.698 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0063118934631348
Epoch: 14, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.755 Vali Acc: 0.800 Test Loss: 0.755 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.016166925430298
Epoch: 15, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.707 Vali Acc: 0.794 Test Loss: 0.707 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.0124406814575195
Epoch: 16, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.839 Vali Acc: 0.800 Test Loss: 0.839 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.0363881587982178
Epoch: 17, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.672 Vali Acc: 0.839 Test Loss: 0.672 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838882).  Saving model ...
Epoch: 18 cost time: 2.1270194053649902
Epoch: 18, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.913 Vali Acc: 0.800 Test Loss: 0.913 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.085115909576416
Epoch: 19, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.696 Vali Acc: 0.822 Test Loss: 0.696 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.195915937423706
Epoch: 20, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.595 Vali Acc: 0.844 Test Loss: 0.595 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 21 cost time: 2.3752894401550293
Epoch: 21, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.786 Vali Acc: 0.828 Test Loss: 0.786 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.211179494857788
Epoch: 22, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.692 Vali Acc: 0.817 Test Loss: 0.692 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.0643322467803955
Epoch: 23, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.691 Vali Acc: 0.833 Test Loss: 0.691 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.0396363735198975
Epoch: 24, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.675 Vali Acc: 0.850 Test Loss: 0.675 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849993).  Saving model ...
Epoch: 25 cost time: 2.221705913543701
Epoch: 25, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.640 Vali Acc: 0.872 Test Loss: 0.640 Test Acc: 0.872
Validation loss decreased (-0.849993 --> -0.872216).  Saving model ...
Epoch: 26 cost time: 1.9720032215118408
Epoch: 26, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.778 Vali Acc: 0.844 Test Loss: 0.778 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.012113571166992
Epoch: 27, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.645 Vali Acc: 0.844 Test Loss: 0.645 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.2257487773895264
Epoch: 28, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.653 Vali Acc: 0.856 Test Loss: 0.653 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.693124771118164
Epoch: 29, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.706 Vali Acc: 0.856 Test Loss: 0.706 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.3753368854522705
Epoch: 30, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.739 Vali Acc: 0.856 Test Loss: 0.739 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.120166778564453
Epoch: 31, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.745 Vali Acc: 0.828 Test Loss: 0.745 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.303957462310791
Epoch: 32, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.684 Vali Acc: 0.856 Test Loss: 0.684 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.1452338695526123
Epoch: 33, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.649 Vali Acc: 0.844 Test Loss: 0.649 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.0352377891540527
Epoch: 34, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.714 Vali Acc: 0.828 Test Loss: 0.714 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.9820241928100586
Epoch: 35, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.667 Vali Acc: 0.833 Test Loss: 0.667 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 10126283
model size : 43.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.550355672836304
Epoch: 1, Steps: 12 | Train Loss: 2.769 Vali Loss: 2.604 Vali Acc: 0.128 Test Loss: 2.604 Test Acc: 0.128
Validation loss decreased (inf --> -0.127752).  Saving model ...
Epoch: 2 cost time: 2.4305734634399414
Epoch: 2, Steps: 12 | Train Loss: 2.556 Vali Loss: 2.347 Vali Acc: 0.233 Test Loss: 2.347 Test Acc: 0.233
Validation loss decreased (-0.127752 --> -0.233310).  Saving model ...
Epoch: 3 cost time: 2.5127527713775635
Epoch: 3, Steps: 12 | Train Loss: 2.200 Vali Loss: 2.006 Vali Acc: 0.372 Test Loss: 2.006 Test Acc: 0.372
Validation loss decreased (-0.233310 --> -0.372202).  Saving model ...
Epoch: 4 cost time: 2.6133873462677
Epoch: 4, Steps: 12 | Train Loss: 1.733 Vali Loss: 1.708 Vali Acc: 0.511 Test Loss: 1.708 Test Acc: 0.511
Validation loss decreased (-0.372202 --> -0.511094).  Saving model ...
Epoch: 5 cost time: 2.823312759399414
Epoch: 5, Steps: 12 | Train Loss: 1.474 Vali Loss: 1.451 Vali Acc: 0.583 Test Loss: 1.451 Test Acc: 0.583
Validation loss decreased (-0.511094 --> -0.583319).  Saving model ...
Epoch: 6 cost time: 2.401101589202881
Epoch: 6, Steps: 12 | Train Loss: 1.267 Vali Loss: 1.317 Vali Acc: 0.622 Test Loss: 1.317 Test Acc: 0.622
Validation loss decreased (-0.583319 --> -0.622209).  Saving model ...
Epoch: 7 cost time: 2.460283041000366
Epoch: 7, Steps: 12 | Train Loss: 1.008 Vali Loss: 1.134 Vali Acc: 0.650 Test Loss: 1.134 Test Acc: 0.650
Validation loss decreased (-0.622209 --> -0.649989).  Saving model ...
Epoch: 8 cost time: 2.53364896774292
Epoch: 8, Steps: 12 | Train Loss: 0.889 Vali Loss: 1.035 Vali Acc: 0.700 Test Loss: 1.035 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699990).  Saving model ...
Epoch: 9 cost time: 2.3726651668548584
Epoch: 9, Steps: 12 | Train Loss: 0.758 Vali Loss: 0.949 Vali Acc: 0.711 Test Loss: 0.949 Test Acc: 0.711
Validation loss decreased (-0.699990 --> -0.711102).  Saving model ...
Epoch: 10 cost time: 2.817239284515381
Epoch: 10, Steps: 12 | Train Loss: 0.661 Vali Loss: 0.863 Vali Acc: 0.767 Test Loss: 0.863 Test Acc: 0.767
Validation loss decreased (-0.711102 --> -0.766658).  Saving model ...
Epoch: 11 cost time: 2.518735647201538
Epoch: 11, Steps: 12 | Train Loss: 0.604 Vali Loss: 0.892 Vali Acc: 0.717 Test Loss: 0.892 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.078103542327881
Epoch: 12, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.735 Vali Acc: 0.800 Test Loss: 0.735 Test Acc: 0.800
Validation loss decreased (-0.766658 --> -0.799993).  Saving model ...
Epoch: 13 cost time: 2.5482585430145264
Epoch: 13, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.766 Vali Acc: 0.806 Test Loss: 0.766 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805548).  Saving model ...
Epoch: 14 cost time: 2.6915295124053955
Epoch: 14, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.675 Vali Acc: 0.800 Test Loss: 0.675 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.7094128131866455
Epoch: 15, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.617 Vali Acc: 0.817 Test Loss: 0.617 Test Acc: 0.817
Validation loss decreased (-0.805548 --> -0.816660).  Saving model ...
Epoch: 16 cost time: 2.7089598178863525
Epoch: 16, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.582 Vali Acc: 0.856 Test Loss: 0.582 Test Acc: 0.856
Validation loss decreased (-0.816660 --> -0.855550).  Saving model ...
Epoch: 17 cost time: 2.352013349533081
Epoch: 17, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.675 Vali Acc: 0.833 Test Loss: 0.675 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9746506214141846
Epoch: 18, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.527 Vali Acc: 0.861 Test Loss: 0.527 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 19 cost time: 2.27270245552063
Epoch: 19, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.787 Vali Acc: 0.778 Test Loss: 0.787 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.198758363723755
Epoch: 20, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.563 Vali Acc: 0.822 Test Loss: 0.563 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.719468116760254
Epoch: 21, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.661 Vali Acc: 0.839 Test Loss: 0.661 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.174326181411743
Epoch: 22, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.637 Vali Acc: 0.839 Test Loss: 0.637 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.190922260284424
Epoch: 23, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.618 Vali Acc: 0.878 Test Loss: 0.618 Test Acc: 0.878
Validation loss decreased (-0.861106 --> -0.877772).  Saving model ...
Epoch: 24 cost time: 1.9831457138061523
Epoch: 24, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.620 Vali Acc: 0.861 Test Loss: 0.620 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.1294617652893066
Epoch: 25, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.639 Vali Acc: 0.856 Test Loss: 0.639 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.2665586471557617
Epoch: 26, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.723 Vali Acc: 0.828 Test Loss: 0.723 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.1336822509765625
Epoch: 27, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.648 Vali Acc: 0.861 Test Loss: 0.648 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.0883450508117676
Epoch: 28, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.568 Vali Acc: 0.867 Test Loss: 0.568 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.3313395977020264
Epoch: 29, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.570 Vali Acc: 0.856 Test Loss: 0.570 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.1212472915649414
Epoch: 30, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.662 Vali Acc: 0.861 Test Loss: 0.662 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.4084081649780273
Epoch: 31, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.575 Vali Acc: 0.867 Test Loss: 0.575 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.178264856338501
Epoch: 32, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.593 Vali Acc: 0.861 Test Loss: 0.593 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.0676748752593994
Epoch: 33, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.629 Vali Acc: 0.850 Test Loss: 0.629 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 4779979
model size : 20.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.190343856811523
Epoch: 1, Steps: 12 | Train Loss: 2.868 Vali Loss: 2.674 Vali Acc: 0.144 Test Loss: 2.674 Test Acc: 0.144
Validation loss decreased (inf --> -0.144418).  Saving model ...
Epoch: 2 cost time: 2.3565847873687744
Epoch: 2, Steps: 12 | Train Loss: 2.653 Vali Loss: 2.462 Vali Acc: 0.317 Test Loss: 2.462 Test Acc: 0.317
Validation loss decreased (-0.144418 --> -0.316642).  Saving model ...
Epoch: 3 cost time: 2.0309696197509766
Epoch: 3, Steps: 12 | Train Loss: 2.320 Vali Loss: 2.132 Vali Acc: 0.411 Test Loss: 2.132 Test Acc: 0.411
Validation loss decreased (-0.316642 --> -0.411090).  Saving model ...
Epoch: 4 cost time: 2.0287137031555176
Epoch: 4, Steps: 12 | Train Loss: 2.021 Vali Loss: 1.777 Vali Acc: 0.539 Test Loss: 1.777 Test Acc: 0.539
Validation loss decreased (-0.411090 --> -0.538871).  Saving model ...
Epoch: 5 cost time: 2.191084384918213
Epoch: 5, Steps: 12 | Train Loss: 1.571 Vali Loss: 1.519 Vali Acc: 0.600 Test Loss: 1.519 Test Acc: 0.600
Validation loss decreased (-0.538871 --> -0.599985).  Saving model ...
Epoch: 6 cost time: 2.41422176361084
Epoch: 6, Steps: 12 | Train Loss: 1.324 Vali Loss: 1.298 Vali Acc: 0.617 Test Loss: 1.298 Test Acc: 0.617
Validation loss decreased (-0.599985 --> -0.616654).  Saving model ...
Epoch: 7 cost time: 2.184739351272583
Epoch: 7, Steps: 12 | Train Loss: 1.150 Vali Loss: 1.189 Vali Acc: 0.661 Test Loss: 1.189 Test Acc: 0.661
Validation loss decreased (-0.616654 --> -0.661099).  Saving model ...
Epoch: 8 cost time: 2.187741756439209
Epoch: 8, Steps: 12 | Train Loss: 0.955 Vali Loss: 1.011 Vali Acc: 0.722 Test Loss: 1.011 Test Acc: 0.722
Validation loss decreased (-0.661099 --> -0.722212).  Saving model ...
Epoch: 9 cost time: 1.8097269535064697
Epoch: 9, Steps: 12 | Train Loss: 0.793 Vali Loss: 1.056 Vali Acc: 0.661 Test Loss: 1.056 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8531324863433838
Epoch: 10, Steps: 12 | Train Loss: 0.714 Vali Loss: 0.845 Vali Acc: 0.789 Test Loss: 0.845 Test Acc: 0.789
Validation loss decreased (-0.722212 --> -0.788880).  Saving model ...
Epoch: 11 cost time: 2.3853092193603516
Epoch: 11, Steps: 12 | Train Loss: 0.554 Vali Loss: 0.762 Vali Acc: 0.789 Test Loss: 0.762 Test Acc: 0.789
Validation loss decreased (-0.788880 --> -0.788881).  Saving model ...
Epoch: 12 cost time: 2.2744433879852295
Epoch: 12, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.795 Vali Acc: 0.756 Test Loss: 0.795 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1184868812561035
Epoch: 13, Steps: 12 | Train Loss: 0.514 Vali Loss: 0.732 Vali Acc: 0.817 Test Loss: 0.732 Test Acc: 0.817
Validation loss decreased (-0.788881 --> -0.816659).  Saving model ...
Epoch: 14 cost time: 2.39841890335083
Epoch: 14, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.600 Vali Acc: 0.822 Test Loss: 0.600 Test Acc: 0.822
Validation loss decreased (-0.816659 --> -0.822216).  Saving model ...
Epoch: 15 cost time: 2.6500325202941895
Epoch: 15, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.587 Vali Acc: 0.872 Test Loss: 0.587 Test Acc: 0.872
Validation loss decreased (-0.822216 --> -0.872216).  Saving model ...
Epoch: 16 cost time: 2.2377731800079346
Epoch: 16, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.605 Vali Acc: 0.828 Test Loss: 0.605 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1075429916381836
Epoch: 17, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.589 Vali Acc: 0.822 Test Loss: 0.589 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.286153554916382
Epoch: 18, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.556 Vali Acc: 0.856 Test Loss: 0.556 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.5602855682373047
Epoch: 19, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.495 Vali Acc: 0.856 Test Loss: 0.495 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.4872653484344482
Epoch: 20, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.513 Vali Acc: 0.867 Test Loss: 0.513 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.1654698848724365
Epoch: 21, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.545 Vali Acc: 0.861 Test Loss: 0.545 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.893611907958984
Epoch: 22, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.567 Vali Acc: 0.867 Test Loss: 0.567 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.6715009212493896
Epoch: 23, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.524 Vali Acc: 0.861 Test Loss: 0.524 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.1532187461853027
Epoch: 24, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.541 Vali Acc: 0.889 Test Loss: 0.541 Test Acc: 0.889
Validation loss decreased (-0.872216 --> -0.888883).  Saving model ...
Epoch: 25 cost time: 2.494612693786621
Epoch: 25, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.616 Vali Acc: 0.867 Test Loss: 0.616 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.345207452774048
Epoch: 26, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.586 Vali Acc: 0.867 Test Loss: 0.586 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.2097878456115723
Epoch: 27, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.587 Vali Acc: 0.844 Test Loss: 0.587 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.2379496097564697
Epoch: 28, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.711 Vali Acc: 0.844 Test Loss: 0.711 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.384488821029663
Epoch: 29, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.528 Vali Acc: 0.867 Test Loss: 0.528 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.4364094734191895
Epoch: 30, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.642 Vali Acc: 0.867 Test Loss: 0.642 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.398543357849121
Epoch: 31, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.552 Vali Acc: 0.878 Test Loss: 0.552 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.4159491062164307
Epoch: 32, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.586 Vali Acc: 0.894 Test Loss: 0.586 Test Acc: 0.894
Validation loss decreased (-0.888883 --> -0.894439).  Saving model ...
Epoch: 33 cost time: 1.9108760356903076
Epoch: 33, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.494 Vali Acc: 0.894 Test Loss: 0.494 Test Acc: 0.894
Validation loss decreased (-0.894439 --> -0.894440).  Saving model ...
Epoch: 34 cost time: 2.231797218322754
Epoch: 34, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.556 Vali Acc: 0.861 Test Loss: 0.556 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.9267730712890625
Epoch: 35, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.550 Vali Acc: 0.867 Test Loss: 0.550 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.291135311126709
Epoch: 36, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.491 Vali Acc: 0.883 Test Loss: 0.491 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.1315879821777344
Epoch: 37, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.523 Vali Acc: 0.878 Test Loss: 0.523 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.360978364944458
Epoch: 38, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.619 Vali Acc: 0.856 Test Loss: 0.619 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.0318572521209717
Epoch: 39, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.488 Vali Acc: 0.883 Test Loss: 0.488 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.167442560195923
Epoch: 40, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.651 Vali Acc: 0.839 Test Loss: 0.651 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.8663647174835205
Epoch: 41, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.671 Vali Acc: 0.856 Test Loss: 0.671 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.048954486846924
Epoch: 42, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.572 Vali Acc: 0.861 Test Loss: 0.572 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.0152294635772705
Epoch: 43, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.691 Vali Acc: 0.856 Test Loss: 0.691 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 4778955
model size : 20.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.022311449050903
Epoch: 1, Steps: 12 | Train Loss: 2.895 Vali Loss: 2.724 Vali Acc: 0.078 Test Loss: 2.724 Test Acc: 0.078
Validation loss decreased (inf --> -0.077751).  Saving model ...
Epoch: 2 cost time: 2.1628308296203613
Epoch: 2, Steps: 12 | Train Loss: 2.664 Vali Loss: 2.461 Vali Acc: 0.200 Test Loss: 2.461 Test Acc: 0.200
Validation loss decreased (-0.077751 --> -0.199975).  Saving model ...
Epoch: 3 cost time: 2.4258220195770264
Epoch: 3, Steps: 12 | Train Loss: 2.280 Vali Loss: 2.114 Vali Acc: 0.483 Test Loss: 2.114 Test Acc: 0.483
Validation loss decreased (-0.199975 --> -0.483312).  Saving model ...
Epoch: 4 cost time: 1.9484302997589111
Epoch: 4, Steps: 12 | Train Loss: 1.840 Vali Loss: 1.806 Vali Acc: 0.517 Test Loss: 1.806 Test Acc: 0.517
Validation loss decreased (-0.483312 --> -0.516649).  Saving model ...
Epoch: 5 cost time: 2.390874147415161
Epoch: 5, Steps: 12 | Train Loss: 1.492 Vali Loss: 1.570 Vali Acc: 0.589 Test Loss: 1.570 Test Acc: 0.589
Validation loss decreased (-0.516649 --> -0.588873).  Saving model ...
Epoch: 6 cost time: 2.2898037433624268
Epoch: 6, Steps: 12 | Train Loss: 1.310 Vali Loss: 1.360 Vali Acc: 0.656 Test Loss: 1.360 Test Acc: 0.656
Validation loss decreased (-0.588873 --> -0.655542).  Saving model ...
Epoch: 7 cost time: 2.258871078491211
Epoch: 7, Steps: 12 | Train Loss: 1.064 Vali Loss: 1.179 Vali Acc: 0.717 Test Loss: 1.179 Test Acc: 0.717
Validation loss decreased (-0.655542 --> -0.716655).  Saving model ...
Epoch: 8 cost time: 2.2005443572998047
Epoch: 8, Steps: 12 | Train Loss: 0.976 Vali Loss: 1.052 Vali Acc: 0.706 Test Loss: 1.052 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.079378604888916
Epoch: 9, Steps: 12 | Train Loss: 0.799 Vali Loss: 0.913 Vali Acc: 0.739 Test Loss: 0.913 Test Acc: 0.739
Validation loss decreased (-0.716655 --> -0.738880).  Saving model ...
Epoch: 10 cost time: 2.1817004680633545
Epoch: 10, Steps: 12 | Train Loss: 0.684 Vali Loss: 0.825 Vali Acc: 0.761 Test Loss: 0.825 Test Acc: 0.761
Validation loss decreased (-0.738880 --> -0.761103).  Saving model ...
Epoch: 11 cost time: 2.272078037261963
Epoch: 11, Steps: 12 | Train Loss: 0.531 Vali Loss: 0.753 Vali Acc: 0.828 Test Loss: 0.753 Test Acc: 0.828
Validation loss decreased (-0.761103 --> -0.827770).  Saving model ...
Epoch: 12 cost time: 2.3037991523742676
Epoch: 12, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.599 Vali Acc: 0.850 Test Loss: 0.599 Test Acc: 0.850
Validation loss decreased (-0.827770 --> -0.849994).  Saving model ...
Epoch: 13 cost time: 2.301663398742676
Epoch: 13, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.634 Vali Acc: 0.839 Test Loss: 0.634 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.243506908416748
Epoch: 14, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.595 Vali Acc: 0.839 Test Loss: 0.595 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.685861349105835
Epoch: 15, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.558 Vali Acc: 0.856 Test Loss: 0.558 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 16 cost time: 2.154222011566162
Epoch: 16, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.544 Vali Acc: 0.839 Test Loss: 0.544 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.5269415378570557
Epoch: 17, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.498 Vali Acc: 0.867 Test Loss: 0.498 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866662).  Saving model ...
Epoch: 18 cost time: 2.5311849117279053
Epoch: 18, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.568 Vali Acc: 0.850 Test Loss: 0.568 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.3368465900421143
Epoch: 19, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.500 Vali Acc: 0.872 Test Loss: 0.500 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872217).  Saving model ...
Epoch: 20 cost time: 2.3819949626922607
Epoch: 20, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.532 Vali Acc: 0.856 Test Loss: 0.532 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.5002927780151367
Epoch: 21, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.546 Vali Acc: 0.889 Test Loss: 0.546 Test Acc: 0.889
Validation loss decreased (-0.872217 --> -0.888883).  Saving model ...
Epoch: 22 cost time: 2.164869785308838
Epoch: 22, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.558 Vali Acc: 0.861 Test Loss: 0.558 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.1422154903411865
Epoch: 23, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.540 Vali Acc: 0.878 Test Loss: 0.540 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.059375286102295
Epoch: 24, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.555 Vali Acc: 0.839 Test Loss: 0.555 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.4029643535614014
Epoch: 25, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.648 Vali Acc: 0.872 Test Loss: 0.648 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.345787525177002
Epoch: 26, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.596 Vali Acc: 0.856 Test Loss: 0.596 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.537280321121216
Epoch: 27, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.671 Vali Acc: 0.844 Test Loss: 0.671 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.7966690063476562
Epoch: 28, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.544 Vali Acc: 0.856 Test Loss: 0.544 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.2266364097595215
Epoch: 29, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.626 Vali Acc: 0.811 Test Loss: 0.626 Test Acc: 0.811
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.9442713260650635
Epoch: 30, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.511 Vali Acc: 0.861 Test Loss: 0.511 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.9956448078155518
Epoch: 31, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.595 Vali Acc: 0.867 Test Loss: 0.595 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 4777931
model size : 20.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.797330379486084
Epoch: 1, Steps: 12 | Train Loss: 2.816 Vali Loss: 2.665 Vali Acc: 0.183 Test Loss: 2.665 Test Acc: 0.183
Validation loss decreased (inf --> -0.183307).  Saving model ...
Epoch: 2 cost time: 2.5775346755981445
Epoch: 2, Steps: 12 | Train Loss: 2.562 Vali Loss: 2.383 Vali Acc: 0.322 Test Loss: 2.383 Test Acc: 0.322
Validation loss decreased (-0.183307 --> -0.322198).  Saving model ...
Epoch: 3 cost time: 2.1135575771331787
Epoch: 3, Steps: 12 | Train Loss: 2.188 Vali Loss: 2.007 Vali Acc: 0.444 Test Loss: 2.007 Test Acc: 0.444
Validation loss decreased (-0.322198 --> -0.444424).  Saving model ...
Epoch: 4 cost time: 1.9507462978363037
Epoch: 4, Steps: 12 | Train Loss: 1.823 Vali Loss: 1.719 Vali Acc: 0.478 Test Loss: 1.719 Test Acc: 0.478
Validation loss decreased (-0.444424 --> -0.477761).  Saving model ...
Epoch: 5 cost time: 2.113713026046753
Epoch: 5, Steps: 12 | Train Loss: 1.486 Vali Loss: 1.430 Vali Acc: 0.639 Test Loss: 1.430 Test Acc: 0.639
Validation loss decreased (-0.477761 --> -0.638875).  Saving model ...
Epoch: 6 cost time: 1.8207712173461914
Epoch: 6, Steps: 12 | Train Loss: 1.264 Vali Loss: 1.347 Vali Acc: 0.694 Test Loss: 1.347 Test Acc: 0.694
Validation loss decreased (-0.638875 --> -0.694431).  Saving model ...
Epoch: 7 cost time: 2.524749755859375
Epoch: 7, Steps: 12 | Train Loss: 1.034 Vali Loss: 1.135 Vali Acc: 0.689 Test Loss: 1.135 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1631996631622314
Epoch: 8, Steps: 12 | Train Loss: 0.883 Vali Loss: 1.035 Vali Acc: 0.700 Test Loss: 1.035 Test Acc: 0.700
Validation loss decreased (-0.694431 --> -0.699990).  Saving model ...
Epoch: 9 cost time: 1.9228870868682861
Epoch: 9, Steps: 12 | Train Loss: 0.830 Vali Loss: 0.906 Vali Acc: 0.772 Test Loss: 0.906 Test Acc: 0.772
Validation loss decreased (-0.699990 --> -0.772213).  Saving model ...
Epoch: 10 cost time: 1.9830682277679443
Epoch: 10, Steps: 12 | Train Loss: 0.587 Vali Loss: 0.795 Vali Acc: 0.800 Test Loss: 0.795 Test Acc: 0.800
Validation loss decreased (-0.772213 --> -0.799992).  Saving model ...
Epoch: 11 cost time: 2.527439832687378
Epoch: 11, Steps: 12 | Train Loss: 0.520 Vali Loss: 0.685 Vali Acc: 0.839 Test Loss: 0.685 Test Acc: 0.839
Validation loss decreased (-0.799992 --> -0.838882).  Saving model ...
Epoch: 12 cost time: 2.1918997764587402
Epoch: 12, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.678 Vali Acc: 0.822 Test Loss: 0.678 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2985527515411377
Epoch: 13, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.646 Vali Acc: 0.850 Test Loss: 0.646 Test Acc: 0.850
Validation loss decreased (-0.838882 --> -0.849994).  Saving model ...
Epoch: 14 cost time: 2.22540545463562
Epoch: 14, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.593 Vali Acc: 0.839 Test Loss: 0.593 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4322972297668457
Epoch: 15, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.668 Vali Acc: 0.850 Test Loss: 0.668 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.7094898223876953
Epoch: 16, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.557 Vali Acc: 0.867 Test Loss: 0.557 Test Acc: 0.867
Validation loss decreased (-0.849994 --> -0.866661).  Saving model ...
Epoch: 17 cost time: 2.4387073516845703
Epoch: 17, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.579 Vali Acc: 0.867 Test Loss: 0.579 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.2805168628692627
Epoch: 18, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.550 Vali Acc: 0.844 Test Loss: 0.550 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.5077195167541504
Epoch: 19, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.655 Vali Acc: 0.844 Test Loss: 0.655 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.3139243125915527
Epoch: 20, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.552 Vali Acc: 0.850 Test Loss: 0.552 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.0975615978240967
Epoch: 21, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.740 Vali Acc: 0.844 Test Loss: 0.740 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.055234432220459
Epoch: 22, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.617 Vali Acc: 0.850 Test Loss: 0.617 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.2665517330169678
Epoch: 23, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.634 Vali Acc: 0.867 Test Loss: 0.634 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.2863855361938477
Epoch: 24, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.449 Vali Acc: 0.894 Test Loss: 0.449 Test Acc: 0.894
Validation loss decreased (-0.866661 --> -0.894440).  Saving model ...
Epoch: 25 cost time: 1.9374158382415771
Epoch: 25, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.504 Vali Acc: 0.861 Test Loss: 0.504 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.5780797004699707
Epoch: 26, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.645 Vali Acc: 0.867 Test Loss: 0.645 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.358410358428955
Epoch: 27, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.572 Vali Acc: 0.861 Test Loss: 0.572 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.2656517028808594
Epoch: 28, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.638 Vali Acc: 0.872 Test Loss: 0.638 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.249030828475952
Epoch: 29, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.556 Vali Acc: 0.856 Test Loss: 0.556 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.4647738933563232
Epoch: 30, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.525 Vali Acc: 0.856 Test Loss: 0.525 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.8862972259521484
Epoch: 31, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.600 Vali Acc: 0.900 Test Loss: 0.600 Test Acc: 0.900
Validation loss decreased (-0.894440 --> -0.899994).  Saving model ...
Epoch: 32 cost time: 2.1115427017211914
Epoch: 32, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.588 Vali Acc: 0.872 Test Loss: 0.588 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.2348055839538574
Epoch: 33, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.485 Vali Acc: 0.883 Test Loss: 0.485 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.1830787658691406
Epoch: 34, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.519 Vali Acc: 0.878 Test Loss: 0.519 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.167783260345459
Epoch: 35, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.552 Vali Acc: 0.878 Test Loss: 0.552 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.2805492877960205
Epoch: 36, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.597 Vali Acc: 0.867 Test Loss: 0.597 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.371526002883911
Epoch: 37, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.621 Vali Acc: 0.844 Test Loss: 0.621 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.1798317432403564
Epoch: 38, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.664 Vali Acc: 0.883 Test Loss: 0.664 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.171898365020752
Epoch: 39, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.686 Vali Acc: 0.828 Test Loss: 0.686 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.1168465614318848
Epoch: 40, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.717 Vali Acc: 0.833 Test Loss: 0.717 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.121713399887085
Epoch: 41, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.586 Vali Acc: 0.850 Test Loss: 0.586 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 4776907
model size : 20.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.938385248184204
Epoch: 1, Steps: 12 | Train Loss: 2.833 Vali Loss: 2.698 Vali Acc: 0.094 Test Loss: 2.698 Test Acc: 0.094
Validation loss decreased (inf --> -0.094417).  Saving model ...
Epoch: 2 cost time: 2.182379722595215
Epoch: 2, Steps: 12 | Train Loss: 2.641 Vali Loss: 2.483 Vali Acc: 0.217 Test Loss: 2.483 Test Acc: 0.217
Validation loss decreased (-0.094417 --> -0.216642).  Saving model ...
Epoch: 3 cost time: 2.3625693321228027
Epoch: 3, Steps: 12 | Train Loss: 2.296 Vali Loss: 2.117 Vali Acc: 0.394 Test Loss: 2.117 Test Acc: 0.394
Validation loss decreased (-0.216642 --> -0.394423).  Saving model ...
Epoch: 4 cost time: 2.47634220123291
Epoch: 4, Steps: 12 | Train Loss: 1.893 Vali Loss: 1.802 Vali Acc: 0.528 Test Loss: 1.802 Test Acc: 0.528
Validation loss decreased (-0.394423 --> -0.527760).  Saving model ...
Epoch: 5 cost time: 2.6244044303894043
Epoch: 5, Steps: 12 | Train Loss: 1.561 Vali Loss: 1.526 Vali Acc: 0.572 Test Loss: 1.526 Test Acc: 0.572
Validation loss decreased (-0.527760 --> -0.572207).  Saving model ...
Epoch: 6 cost time: 2.07910418510437
Epoch: 6, Steps: 12 | Train Loss: 1.365 Vali Loss: 1.407 Vali Acc: 0.600 Test Loss: 1.407 Test Acc: 0.600
Validation loss decreased (-0.572207 --> -0.599986).  Saving model ...
Epoch: 7 cost time: 2.5925188064575195
Epoch: 7, Steps: 12 | Train Loss: 1.210 Vali Loss: 1.299 Vali Acc: 0.661 Test Loss: 1.299 Test Acc: 0.661
Validation loss decreased (-0.599986 --> -0.661098).  Saving model ...
Epoch: 8 cost time: 2.1870312690734863
Epoch: 8, Steps: 12 | Train Loss: 1.051 Vali Loss: 1.226 Vali Acc: 0.661 Test Loss: 1.226 Test Acc: 0.661
Validation loss decreased (-0.661098 --> -0.661099).  Saving model ...
Epoch: 9 cost time: 2.335160493850708
Epoch: 9, Steps: 12 | Train Loss: 0.927 Vali Loss: 1.120 Vali Acc: 0.689 Test Loss: 1.120 Test Acc: 0.689
Validation loss decreased (-0.661099 --> -0.688878).  Saving model ...
Epoch: 10 cost time: 2.636754035949707
Epoch: 10, Steps: 12 | Train Loss: 0.743 Vali Loss: 0.976 Vali Acc: 0.728 Test Loss: 0.976 Test Acc: 0.728
Validation loss decreased (-0.688878 --> -0.727768).  Saving model ...
Epoch: 11 cost time: 2.60752272605896
Epoch: 11, Steps: 12 | Train Loss: 0.683 Vali Loss: 0.949 Vali Acc: 0.711 Test Loss: 0.949 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.279320240020752
Epoch: 12, Steps: 12 | Train Loss: 0.546 Vali Loss: 0.747 Vali Acc: 0.800 Test Loss: 0.747 Test Acc: 0.800
Validation loss decreased (-0.727768 --> -0.799993).  Saving model ...
Epoch: 13 cost time: 2.1133744716644287
Epoch: 13, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.775 Vali Acc: 0.811 Test Loss: 0.775 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811103).  Saving model ...
Epoch: 14 cost time: 2.945284843444824
Epoch: 14, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.654 Vali Acc: 0.783 Test Loss: 0.654 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.9200875759124756
Epoch: 15, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.572 Vali Acc: 0.856 Test Loss: 0.572 Test Acc: 0.856
Validation loss decreased (-0.811103 --> -0.855550).  Saving model ...
Epoch: 16 cost time: 2.567121744155884
Epoch: 16, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.594 Vali Acc: 0.839 Test Loss: 0.594 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.451336145401001
Epoch: 17, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.629 Vali Acc: 0.833 Test Loss: 0.629 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.8580174446105957
Epoch: 18, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.545 Vali Acc: 0.867 Test Loss: 0.545 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 19 cost time: 2.637418031692505
Epoch: 19, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.563 Vali Acc: 0.867 Test Loss: 0.563 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.0925676822662354
Epoch: 20, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.549 Vali Acc: 0.850 Test Loss: 0.549 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.4589121341705322
Epoch: 21, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.581 Vali Acc: 0.850 Test Loss: 0.581 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.703303098678589
Epoch: 22, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.546 Vali Acc: 0.872 Test Loss: 0.546 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 23 cost time: 2.366450309753418
Epoch: 23, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.518 Vali Acc: 0.889 Test Loss: 0.518 Test Acc: 0.889
Validation loss decreased (-0.872217 --> -0.888884).  Saving model ...
Epoch: 24 cost time: 2.370457887649536
Epoch: 24, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.573 Vali Acc: 0.867 Test Loss: 0.573 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.440739631652832
Epoch: 25, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.562 Vali Acc: 0.861 Test Loss: 0.562 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.0098493099212646
Epoch: 26, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.443 Vali Acc: 0.883 Test Loss: 0.443 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.0465643405914307
Epoch: 27, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.547 Vali Acc: 0.872 Test Loss: 0.547 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.5207767486572266
Epoch: 28, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.600 Vali Acc: 0.867 Test Loss: 0.600 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.7883028984069824
Epoch: 29, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.463 Vali Acc: 0.894 Test Loss: 0.463 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894440).  Saving model ...
Epoch: 30 cost time: 2.8728814125061035
Epoch: 30, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.612 Vali Acc: 0.867 Test Loss: 0.612 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.2284021377563477
Epoch: 31, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.523 Vali Acc: 0.867 Test Loss: 0.523 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.4053218364715576
Epoch: 32, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.519 Vali Acc: 0.906 Test Loss: 0.519 Test Acc: 0.906
Validation loss decreased (-0.894440 --> -0.905550).  Saving model ...
Epoch: 33 cost time: 2.9571468830108643
Epoch: 33, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.560 Vali Acc: 0.883 Test Loss: 0.560 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.308769464492798
Epoch: 34, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.567 Vali Acc: 0.894 Test Loss: 0.567 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.5101003646850586
Epoch: 35, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.676 Vali Acc: 0.839 Test Loss: 0.676 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.2483139038085938
Epoch: 36, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.602 Vali Acc: 0.878 Test Loss: 0.602 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.2894513607025146
Epoch: 37, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.543 Vali Acc: 0.867 Test Loss: 0.543 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 2.5081636905670166
Epoch: 38, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.593 Vali Acc: 0.878 Test Loss: 0.593 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 2.446486234664917
Epoch: 39, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.572 Vali Acc: 0.894 Test Loss: 0.572 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 2.1675989627838135
Epoch: 40, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.562 Vali Acc: 0.861 Test Loss: 0.562 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 2.3771512508392334
Epoch: 41, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.585 Vali Acc: 0.867 Test Loss: 0.585 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 2.0636935234069824
Epoch: 42, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.576 Vali Acc: 0.878 Test Loss: 0.576 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 3595723
model size : 16.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9767117500305176
Epoch: 1, Steps: 12 | Train Loss: 2.856 Vali Loss: 2.656 Vali Acc: 0.106 Test Loss: 2.656 Test Acc: 0.106
Validation loss decreased (inf --> -0.105529).  Saving model ...
Epoch: 2 cost time: 2.599994659423828
Epoch: 2, Steps: 12 | Train Loss: 2.638 Vali Loss: 2.437 Vali Acc: 0.328 Test Loss: 2.437 Test Acc: 0.328
Validation loss decreased (-0.105529 --> -0.327753).  Saving model ...
Epoch: 3 cost time: 2.378061056137085
Epoch: 3, Steps: 12 | Train Loss: 2.324 Vali Loss: 2.117 Vali Acc: 0.417 Test Loss: 2.117 Test Acc: 0.417
Validation loss decreased (-0.327753 --> -0.416645).  Saving model ...
Epoch: 4 cost time: 2.187040328979492
Epoch: 4, Steps: 12 | Train Loss: 1.937 Vali Loss: 1.789 Vali Acc: 0.506 Test Loss: 1.789 Test Acc: 0.506
Validation loss decreased (-0.416645 --> -0.505538).  Saving model ...
Epoch: 5 cost time: 1.9080886840820312
Epoch: 5, Steps: 12 | Train Loss: 1.502 Vali Loss: 1.555 Vali Acc: 0.556 Test Loss: 1.555 Test Acc: 0.556
Validation loss decreased (-0.505538 --> -0.555540).  Saving model ...
Epoch: 6 cost time: 2.051854372024536
Epoch: 6, Steps: 12 | Train Loss: 1.315 Vali Loss: 1.419 Vali Acc: 0.594 Test Loss: 1.419 Test Acc: 0.594
Validation loss decreased (-0.555540 --> -0.594430).  Saving model ...
Epoch: 7 cost time: 2.080167770385742
Epoch: 7, Steps: 12 | Train Loss: 1.187 Vali Loss: 1.236 Vali Acc: 0.656 Test Loss: 1.236 Test Acc: 0.656
Validation loss decreased (-0.594430 --> -0.655543).  Saving model ...
Epoch: 8 cost time: 1.7536115646362305
Epoch: 8, Steps: 12 | Train Loss: 0.995 Vali Loss: 1.087 Vali Acc: 0.722 Test Loss: 1.087 Test Acc: 0.722
Validation loss decreased (-0.655543 --> -0.722211).  Saving model ...
Epoch: 9 cost time: 1.83583402633667
Epoch: 9, Steps: 12 | Train Loss: 0.825 Vali Loss: 1.007 Vali Acc: 0.694 Test Loss: 1.007 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0137343406677246
Epoch: 10, Steps: 12 | Train Loss: 0.723 Vali Loss: 0.932 Vali Acc: 0.717 Test Loss: 0.932 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9670956134796143
Epoch: 11, Steps: 12 | Train Loss: 0.665 Vali Loss: 0.784 Vali Acc: 0.778 Test Loss: 0.784 Test Acc: 0.778
Validation loss decreased (-0.722211 --> -0.777770).  Saving model ...
Epoch: 12 cost time: 1.8565952777862549
Epoch: 12, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.754 Vali Acc: 0.794 Test Loss: 0.754 Test Acc: 0.794
Validation loss decreased (-0.777770 --> -0.794437).  Saving model ...
Epoch: 13 cost time: 1.8515572547912598
Epoch: 13, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.719 Vali Acc: 0.794 Test Loss: 0.719 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794437).  Saving model ...
Epoch: 14 cost time: 2.214014768600464
Epoch: 14, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.737 Vali Acc: 0.800 Test Loss: 0.737 Test Acc: 0.800
Validation loss decreased (-0.794437 --> -0.799993).  Saving model ...
Epoch: 15 cost time: 1.9873807430267334
Epoch: 15, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.571 Vali Acc: 0.833 Test Loss: 0.571 Test Acc: 0.833
Validation loss decreased (-0.799993 --> -0.833328).  Saving model ...
Epoch: 16 cost time: 2.2571370601654053
Epoch: 16, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.620 Vali Acc: 0.856 Test Loss: 0.620 Test Acc: 0.856
Validation loss decreased (-0.833328 --> -0.855549).  Saving model ...
Epoch: 17 cost time: 2.129896402359009
Epoch: 17, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.618 Vali Acc: 0.800 Test Loss: 0.618 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.229764461517334
Epoch: 18, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.565 Vali Acc: 0.856 Test Loss: 0.565 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855550).  Saving model ...
Epoch: 19 cost time: 1.8401446342468262
Epoch: 19, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.494 Vali Acc: 0.872 Test Loss: 0.494 Test Acc: 0.872
Validation loss decreased (-0.855550 --> -0.872217).  Saving model ...
Epoch: 20 cost time: 2.0743024349212646
Epoch: 20, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.540 Vali Acc: 0.872 Test Loss: 0.540 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.2172799110412598
Epoch: 21, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.520 Vali Acc: 0.850 Test Loss: 0.520 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.15592360496521
Epoch: 22, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.543 Vali Acc: 0.894 Test Loss: 0.543 Test Acc: 0.894
Validation loss decreased (-0.872217 --> -0.894439).  Saving model ...
Epoch: 23 cost time: 2.059084177017212
Epoch: 23, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.503 Vali Acc: 0.872 Test Loss: 0.503 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.106266736984253
Epoch: 24, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.582 Vali Acc: 0.883 Test Loss: 0.582 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.8090569972991943
Epoch: 25, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.492 Vali Acc: 0.900 Test Loss: 0.492 Test Acc: 0.900
Validation loss decreased (-0.894439 --> -0.899995).  Saving model ...
Epoch: 26 cost time: 1.9341356754302979
Epoch: 26, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.564 Vali Acc: 0.844 Test Loss: 0.564 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.247363567352295
Epoch: 27, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.565 Vali Acc: 0.889 Test Loss: 0.565 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.007154703140259
Epoch: 28, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.563 Vali Acc: 0.878 Test Loss: 0.563 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.889488935470581
Epoch: 29, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.527 Vali Acc: 0.889 Test Loss: 0.527 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.351196050643921
Epoch: 30, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.534 Vali Acc: 0.861 Test Loss: 0.534 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.439500093460083
Epoch: 31, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.614 Vali Acc: 0.867 Test Loss: 0.614 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.3235690593719482
Epoch: 32, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.639 Vali Acc: 0.861 Test Loss: 0.639 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.147794723510742
Epoch: 33, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.531 Vali Acc: 0.878 Test Loss: 0.531 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.2683310508728027
Epoch: 34, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.629 Vali Acc: 0.844 Test Loss: 0.629 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.4137723445892334
Epoch: 35, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.563 Vali Acc: 0.872 Test Loss: 0.563 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 3594699
model size : 16.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.596265077590942
Epoch: 1, Steps: 12 | Train Loss: 2.912 Vali Loss: 2.688 Vali Acc: 0.089 Test Loss: 2.688 Test Acc: 0.089
Validation loss decreased (inf --> -0.088862).  Saving model ...
Epoch: 2 cost time: 2.2691810131073
Epoch: 2, Steps: 12 | Train Loss: 2.664 Vali Loss: 2.466 Vali Acc: 0.183 Test Loss: 2.466 Test Acc: 0.183
Validation loss decreased (-0.088862 --> -0.183309).  Saving model ...
Epoch: 3 cost time: 2.4120452404022217
Epoch: 3, Steps: 12 | Train Loss: 2.326 Vali Loss: 2.102 Vali Acc: 0.439 Test Loss: 2.102 Test Acc: 0.439
Validation loss decreased (-0.183309 --> -0.438868).  Saving model ...
Epoch: 4 cost time: 2.35963773727417
Epoch: 4, Steps: 12 | Train Loss: 1.934 Vali Loss: 1.768 Vali Acc: 0.583 Test Loss: 1.768 Test Acc: 0.583
Validation loss decreased (-0.438868 --> -0.583316).  Saving model ...
Epoch: 5 cost time: 1.9793624877929688
Epoch: 5, Steps: 12 | Train Loss: 1.579 Vali Loss: 1.520 Vali Acc: 0.589 Test Loss: 1.520 Test Acc: 0.589
Validation loss decreased (-0.583316 --> -0.588874).  Saving model ...
Epoch: 6 cost time: 2.356099843978882
Epoch: 6, Steps: 12 | Train Loss: 1.355 Vali Loss: 1.333 Vali Acc: 0.689 Test Loss: 1.333 Test Acc: 0.689
Validation loss decreased (-0.588874 --> -0.688876).  Saving model ...
Epoch: 7 cost time: 1.9907245635986328
Epoch: 7, Steps: 12 | Train Loss: 1.080 Vali Loss: 1.149 Vali Acc: 0.706 Test Loss: 1.149 Test Acc: 0.706
Validation loss decreased (-0.688876 --> -0.705544).  Saving model ...
Epoch: 8 cost time: 2.3638226985931396
Epoch: 8, Steps: 12 | Train Loss: 1.032 Vali Loss: 1.140 Vali Acc: 0.656 Test Loss: 1.140 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3367295265197754
Epoch: 9, Steps: 12 | Train Loss: 0.830 Vali Loss: 0.973 Vali Acc: 0.739 Test Loss: 0.973 Test Acc: 0.739
Validation loss decreased (-0.705544 --> -0.738879).  Saving model ...
Epoch: 10 cost time: 2.3285107612609863
Epoch: 10, Steps: 12 | Train Loss: 0.806 Vali Loss: 0.865 Vali Acc: 0.756 Test Loss: 0.865 Test Acc: 0.756
Validation loss decreased (-0.738879 --> -0.755547).  Saving model ...
Epoch: 11 cost time: 2.7479639053344727
Epoch: 11, Steps: 12 | Train Loss: 0.629 Vali Loss: 0.833 Vali Acc: 0.739 Test Loss: 0.833 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.231673240661621
Epoch: 12, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.683 Vali Acc: 0.822 Test Loss: 0.683 Test Acc: 0.822
Validation loss decreased (-0.755547 --> -0.822215).  Saving model ...
Epoch: 13 cost time: 2.0285208225250244
Epoch: 13, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.691 Vali Acc: 0.817 Test Loss: 0.691 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0656352043151855
Epoch: 14, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.624 Vali Acc: 0.806 Test Loss: 0.624 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.2303202152252197
Epoch: 15, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.728 Vali Acc: 0.783 Test Loss: 0.728 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.7001662254333496
Epoch: 16, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.531 Vali Acc: 0.867 Test Loss: 0.531 Test Acc: 0.867
Validation loss decreased (-0.822215 --> -0.866661).  Saving model ...
Epoch: 17 cost time: 2.071598768234253
Epoch: 17, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.516 Vali Acc: 0.844 Test Loss: 0.516 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.2750132083892822
Epoch: 18, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.569 Vali Acc: 0.833 Test Loss: 0.569 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.312915325164795
Epoch: 19, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.534 Vali Acc: 0.844 Test Loss: 0.534 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.950839042663574
Epoch: 20, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.513 Vali Acc: 0.856 Test Loss: 0.513 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.0543272495269775
Epoch: 21, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.486 Vali Acc: 0.867 Test Loss: 0.486 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866662).  Saving model ...
Epoch: 22 cost time: 1.9553568363189697
Epoch: 22, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.564 Vali Acc: 0.878 Test Loss: 0.564 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877772).  Saving model ...
Epoch: 23 cost time: 2.412010908126831
Epoch: 23, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.573 Vali Acc: 0.850 Test Loss: 0.573 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.291843891143799
Epoch: 24, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.521 Vali Acc: 0.856 Test Loss: 0.521 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.090512275695801
Epoch: 25, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.578 Vali Acc: 0.872 Test Loss: 0.578 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.228224754333496
Epoch: 26, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.580 Vali Acc: 0.856 Test Loss: 0.580 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.234355926513672
Epoch: 27, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.601 Vali Acc: 0.883 Test Loss: 0.601 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883327).  Saving model ...
Epoch: 28 cost time: 2.970024347305298
Epoch: 28, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.562 Vali Acc: 0.844 Test Loss: 0.562 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.5647475719451904
Epoch: 29, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.607 Vali Acc: 0.844 Test Loss: 0.607 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.4662833213806152
Epoch: 30, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.623 Vali Acc: 0.878 Test Loss: 0.623 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.583247661590576
Epoch: 31, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.638 Vali Acc: 0.867 Test Loss: 0.638 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.608543872833252
Epoch: 32, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.594 Vali Acc: 0.850 Test Loss: 0.594 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.8632140159606934
Epoch: 33, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.680 Vali Acc: 0.856 Test Loss: 0.680 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.4310402870178223
Epoch: 34, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.524 Vali Acc: 0.883 Test Loss: 0.524 Test Acc: 0.883
Validation loss decreased (-0.883327 --> -0.883328).  Saving model ...
Epoch: 35 cost time: 2.516835927963257
Epoch: 35, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.586 Vali Acc: 0.878 Test Loss: 0.586 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.559535503387451
Epoch: 36, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.640 Vali Acc: 0.867 Test Loss: 0.640 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.45711350440979
Epoch: 37, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.568 Vali Acc: 0.861 Test Loss: 0.568 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.522923707962036
Epoch: 38, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.604 Vali Acc: 0.872 Test Loss: 0.604 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.5147929191589355
Epoch: 39, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.600 Vali Acc: 0.889 Test Loss: 0.600 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888883).  Saving model ...
Epoch: 40 cost time: 2.2804319858551025
Epoch: 40, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.587 Vali Acc: 0.889 Test Loss: 0.587 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888883).  Saving model ...
Epoch: 41 cost time: 2.3905224800109863
Epoch: 41, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.601 Vali Acc: 0.889 Test Loss: 0.601 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.939061403274536
Epoch: 42, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.607 Vali Acc: 0.889 Test Loss: 0.607 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.754040241241455
Epoch: 43, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.618 Vali Acc: 0.889 Test Loss: 0.618 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 2.425489902496338
Epoch: 44, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.627 Vali Acc: 0.878 Test Loss: 0.627 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 2.230902910232544
Epoch: 45, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.638 Vali Acc: 0.878 Test Loss: 0.638 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 2.478055238723755
Epoch: 46, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.647 Vali Acc: 0.878 Test Loss: 0.647 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 2.884490966796875
Epoch: 47, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.657 Vali Acc: 0.878 Test Loss: 0.657 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 2.7003512382507324
Epoch: 48, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.656 Vali Acc: 0.878 Test Loss: 0.656 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 2.846714973449707
Epoch: 49, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.658 Vali Acc: 0.878 Test Loss: 0.658 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 2.720545530319214
Epoch: 50, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.659 Vali Acc: 0.883 Test Loss: 0.659 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 3593675
model size : 16.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.671478748321533
Epoch: 1, Steps: 12 | Train Loss: 2.872 Vali Loss: 2.738 Vali Acc: 0.072 Test Loss: 2.738 Test Acc: 0.072
Validation loss decreased (inf --> -0.072195).  Saving model ...
Epoch: 2 cost time: 2.3229758739471436
Epoch: 2, Steps: 12 | Train Loss: 2.656 Vali Loss: 2.484 Vali Acc: 0.311 Test Loss: 2.484 Test Acc: 0.311
Validation loss decreased (-0.072195 --> -0.311086).  Saving model ...
Epoch: 3 cost time: 1.881523847579956
Epoch: 3, Steps: 12 | Train Loss: 2.392 Vali Loss: 2.184 Vali Acc: 0.478 Test Loss: 2.184 Test Acc: 0.478
Validation loss decreased (-0.311086 --> -0.477756).  Saving model ...
Epoch: 4 cost time: 1.9978446960449219
Epoch: 4, Steps: 12 | Train Loss: 2.006 Vali Loss: 1.814 Vali Acc: 0.528 Test Loss: 1.814 Test Acc: 0.528
Validation loss decreased (-0.477756 --> -0.527760).  Saving model ...
Epoch: 5 cost time: 2.007801055908203
Epoch: 5, Steps: 12 | Train Loss: 1.709 Vali Loss: 1.572 Vali Acc: 0.567 Test Loss: 1.572 Test Acc: 0.567
Validation loss decreased (-0.527760 --> -0.566651).  Saving model ...
Epoch: 6 cost time: 1.9296119213104248
Epoch: 6, Steps: 12 | Train Loss: 1.468 Vali Loss: 1.369 Vali Acc: 0.617 Test Loss: 1.369 Test Acc: 0.617
Validation loss decreased (-0.566651 --> -0.616653).  Saving model ...
Epoch: 7 cost time: 2.0294759273529053
Epoch: 7, Steps: 12 | Train Loss: 1.187 Vali Loss: 1.205 Vali Acc: 0.667 Test Loss: 1.205 Test Acc: 0.667
Validation loss decreased (-0.616653 --> -0.666655).  Saving model ...
Epoch: 8 cost time: 2.240321636199951
Epoch: 8, Steps: 12 | Train Loss: 1.059 Vali Loss: 1.121 Vali Acc: 0.678 Test Loss: 1.121 Test Acc: 0.678
Validation loss decreased (-0.666655 --> -0.677767).  Saving model ...
Epoch: 9 cost time: 2.2255496978759766
Epoch: 9, Steps: 12 | Train Loss: 0.975 Vali Loss: 1.011 Vali Acc: 0.750 Test Loss: 1.011 Test Acc: 0.750
Validation loss decreased (-0.677767 --> -0.749990).  Saving model ...
Epoch: 10 cost time: 1.9841012954711914
Epoch: 10, Steps: 12 | Train Loss: 0.839 Vali Loss: 0.889 Vali Acc: 0.756 Test Loss: 0.889 Test Acc: 0.756
Validation loss decreased (-0.749990 --> -0.755547).  Saving model ...
Epoch: 11 cost time: 1.9392120838165283
Epoch: 11, Steps: 12 | Train Loss: 0.677 Vali Loss: 0.779 Vali Acc: 0.817 Test Loss: 0.779 Test Acc: 0.817
Validation loss decreased (-0.755547 --> -0.816659).  Saving model ...
Epoch: 12 cost time: 2.8135080337524414
Epoch: 12, Steps: 12 | Train Loss: 0.635 Vali Loss: 0.726 Vali Acc: 0.800 Test Loss: 0.726 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1571226119995117
Epoch: 13, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.706 Vali Acc: 0.828 Test Loss: 0.706 Test Acc: 0.828
Validation loss decreased (-0.816659 --> -0.827771).  Saving model ...
Epoch: 14 cost time: 1.6840918064117432
Epoch: 14, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.676 Vali Acc: 0.839 Test Loss: 0.676 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838882).  Saving model ...
Epoch: 15 cost time: 2.1659348011016846
Epoch: 15, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.633 Vali Acc: 0.839 Test Loss: 0.633 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838883).  Saving model ...
Epoch: 16 cost time: 2.607869863510132
Epoch: 16, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.614 Vali Acc: 0.844 Test Loss: 0.614 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844438).  Saving model ...
Epoch: 17 cost time: 2.1617915630340576
Epoch: 17, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.582 Vali Acc: 0.856 Test Loss: 0.582 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855550).  Saving model ...
Epoch: 18 cost time: 1.7937991619110107
Epoch: 18, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.593 Vali Acc: 0.844 Test Loss: 0.593 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0638022422790527
Epoch: 19, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.597 Vali Acc: 0.883 Test Loss: 0.597 Test Acc: 0.883
Validation loss decreased (-0.855550 --> -0.883327).  Saving model ...
Epoch: 20 cost time: 2.3691909313201904
Epoch: 20, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.553 Vali Acc: 0.850 Test Loss: 0.553 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.939669132232666
Epoch: 21, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.648 Vali Acc: 0.856 Test Loss: 0.648 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7283387184143066
Epoch: 22, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.538 Vali Acc: 0.872 Test Loss: 0.538 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.8964955806732178
Epoch: 23, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.575 Vali Acc: 0.856 Test Loss: 0.575 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.9532020092010498
Epoch: 24, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.543 Vali Acc: 0.839 Test Loss: 0.543 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.1149935722351074
Epoch: 25, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.575 Vali Acc: 0.839 Test Loss: 0.575 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.0192525386810303
Epoch: 26, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.545 Vali Acc: 0.867 Test Loss: 0.545 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.8437917232513428
Epoch: 27, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.579 Vali Acc: 0.844 Test Loss: 0.579 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.7116854190826416
Epoch: 28, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.645 Vali Acc: 0.844 Test Loss: 0.645 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.943962574005127
Epoch: 29, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.573 Vali Acc: 0.872 Test Loss: 0.573 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 3592651
model size : 16.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7384865283966064
Epoch: 1, Steps: 12 | Train Loss: 2.800 Vali Loss: 2.642 Vali Acc: 0.122 Test Loss: 2.642 Test Acc: 0.122
Validation loss decreased (inf --> -0.122196).  Saving model ...
Epoch: 2 cost time: 1.8529016971588135
Epoch: 2, Steps: 12 | Train Loss: 2.695 Vali Loss: 2.483 Vali Acc: 0.256 Test Loss: 2.483 Test Acc: 0.256
Validation loss decreased (-0.122196 --> -0.255531).  Saving model ...
Epoch: 3 cost time: 2.136871576309204
Epoch: 3, Steps: 12 | Train Loss: 2.391 Vali Loss: 2.204 Vali Acc: 0.383 Test Loss: 2.204 Test Acc: 0.383
Validation loss decreased (-0.255531 --> -0.383311).  Saving model ...
Epoch: 4 cost time: 2.173563241958618
Epoch: 4, Steps: 12 | Train Loss: 2.062 Vali Loss: 1.905 Vali Acc: 0.444 Test Loss: 1.905 Test Acc: 0.444
Validation loss decreased (-0.383311 --> -0.444425).  Saving model ...
Epoch: 5 cost time: 2.1639795303344727
Epoch: 5, Steps: 12 | Train Loss: 1.736 Vali Loss: 1.707 Vali Acc: 0.556 Test Loss: 1.707 Test Acc: 0.556
Validation loss decreased (-0.444425 --> -0.555538).  Saving model ...
Epoch: 6 cost time: 2.221001386642456
Epoch: 6, Steps: 12 | Train Loss: 1.458 Vali Loss: 1.494 Vali Acc: 0.583 Test Loss: 1.494 Test Acc: 0.583
Validation loss decreased (-0.555538 --> -0.583318).  Saving model ...
Epoch: 7 cost time: 2.184584856033325
Epoch: 7, Steps: 12 | Train Loss: 1.294 Vali Loss: 1.345 Vali Acc: 0.650 Test Loss: 1.345 Test Acc: 0.650
Validation loss decreased (-0.583318 --> -0.649987).  Saving model ...
Epoch: 8 cost time: 2.306417226791382
Epoch: 8, Steps: 12 | Train Loss: 1.171 Vali Loss: 1.235 Vali Acc: 0.694 Test Loss: 1.235 Test Acc: 0.694
Validation loss decreased (-0.649987 --> -0.694432).  Saving model ...
Epoch: 9 cost time: 1.7882797718048096
Epoch: 9, Steps: 12 | Train Loss: 1.098 Vali Loss: 1.156 Vali Acc: 0.661 Test Loss: 1.156 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.535454511642456
Epoch: 10, Steps: 12 | Train Loss: 0.941 Vali Loss: 1.080 Vali Acc: 0.672 Test Loss: 1.080 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.1924238204956055
Epoch: 11, Steps: 12 | Train Loss: 0.773 Vali Loss: 1.024 Vali Acc: 0.694 Test Loss: 1.024 Test Acc: 0.694
Validation loss decreased (-0.694432 --> -0.694434).  Saving model ...
Epoch: 12 cost time: 2.0181102752685547
Epoch: 12, Steps: 12 | Train Loss: 0.701 Vali Loss: 0.880 Vali Acc: 0.744 Test Loss: 0.880 Test Acc: 0.744
Validation loss decreased (-0.694434 --> -0.744436).  Saving model ...
Epoch: 13 cost time: 2.1835193634033203
Epoch: 13, Steps: 12 | Train Loss: 0.622 Vali Loss: 0.814 Vali Acc: 0.772 Test Loss: 0.814 Test Acc: 0.772
Validation loss decreased (-0.744436 --> -0.772214).  Saving model ...
Epoch: 14 cost time: 2.2854251861572266
Epoch: 14, Steps: 12 | Train Loss: 0.569 Vali Loss: 0.863 Vali Acc: 0.772 Test Loss: 0.863 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.204008102416992
Epoch: 15, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.772 Vali Acc: 0.778 Test Loss: 0.772 Test Acc: 0.778
Validation loss decreased (-0.772214 --> -0.777770).  Saving model ...
Epoch: 16 cost time: 2.1029701232910156
Epoch: 16, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.625 Vali Acc: 0.817 Test Loss: 0.625 Test Acc: 0.817
Validation loss decreased (-0.777770 --> -0.816660).  Saving model ...
Epoch: 17 cost time: 1.9742748737335205
Epoch: 17, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.682 Vali Acc: 0.850 Test Loss: 0.682 Test Acc: 0.850
Validation loss decreased (-0.816660 --> -0.849993).  Saving model ...
Epoch: 18 cost time: 1.9651618003845215
Epoch: 18, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.604 Vali Acc: 0.828 Test Loss: 0.604 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.865379810333252
Epoch: 19, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.636 Vali Acc: 0.833 Test Loss: 0.636 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.0920722484588623
Epoch: 20, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.546 Vali Acc: 0.867 Test Loss: 0.546 Test Acc: 0.867
Validation loss decreased (-0.849993 --> -0.866661).  Saving model ...
Epoch: 21 cost time: 2.39513897895813
Epoch: 21, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.528 Vali Acc: 0.872 Test Loss: 0.528 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 22 cost time: 2.4724531173706055
Epoch: 22, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.543 Vali Acc: 0.861 Test Loss: 0.543 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.6338772773742676
Epoch: 23, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.572 Vali Acc: 0.861 Test Loss: 0.572 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.249593496322632
Epoch: 24, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.554 Vali Acc: 0.867 Test Loss: 0.554 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.9978625774383545
Epoch: 25, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.547 Vali Acc: 0.883 Test Loss: 0.547 Test Acc: 0.883
Validation loss decreased (-0.872217 --> -0.883328).  Saving model ...
Epoch: 26 cost time: 2.149491548538208
Epoch: 26, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.515 Vali Acc: 0.856 Test Loss: 0.515 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.0951595306396484
Epoch: 27, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.630 Vali Acc: 0.861 Test Loss: 0.630 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.622012138366699
Epoch: 28, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.493 Vali Acc: 0.872 Test Loss: 0.493 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.9686357975006104
Epoch: 29, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.531 Vali Acc: 0.889 Test Loss: 0.531 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888884).  Saving model ...
Epoch: 30 cost time: 2.360527753829956
Epoch: 30, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.536 Vali Acc: 0.878 Test Loss: 0.536 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.60503888130188
Epoch: 31, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.625 Vali Acc: 0.839 Test Loss: 0.625 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.866363286972046
Epoch: 32, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.617 Vali Acc: 0.894 Test Loss: 0.617 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894438).  Saving model ...
Epoch: 33 cost time: 1.8893940448760986
Epoch: 33, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.567 Vali Acc: 0.894 Test Loss: 0.567 Test Acc: 0.894
Validation loss decreased (-0.894438 --> -0.894439).  Saving model ...
Epoch: 34 cost time: 1.9946694374084473
Epoch: 34, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.609 Vali Acc: 0.894 Test Loss: 0.609 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.039468288421631
Epoch: 35, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.649 Vali Acc: 0.883 Test Loss: 0.649 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.6877455711364746
Epoch: 36, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.612 Vali Acc: 0.900 Test Loss: 0.612 Test Acc: 0.900
Validation loss decreased (-0.894439 --> -0.899994).  Saving model ...
Epoch: 37 cost time: 2.1614272594451904
Epoch: 37, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.626 Vali Acc: 0.883 Test Loss: 0.626 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.717519760131836
Epoch: 38, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.678 Vali Acc: 0.867 Test Loss: 0.678 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.3418753147125244
Epoch: 39, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.645 Vali Acc: 0.878 Test Loss: 0.645 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.8312137126922607
Epoch: 40, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.656 Vali Acc: 0.889 Test Loss: 0.656 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.022695302963257
Epoch: 41, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.660 Vali Acc: 0.872 Test Loss: 0.660 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.9432899951934814
Epoch: 42, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.621 Vali Acc: 0.878 Test Loss: 0.621 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.8625705242156982
Epoch: 43, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.704 Vali Acc: 0.878 Test Loss: 0.704 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 2.3331692218780518
Epoch: 44, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.705 Vali Acc: 0.889 Test Loss: 0.705 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 2.0459914207458496
Epoch: 45, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.689 Vali Acc: 0.889 Test Loss: 0.689 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 2.2614500522613525
Epoch: 46, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.663 Vali Acc: 0.894 Test Loss: 0.663 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 3003595
model size : 14.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.754606485366821
Epoch: 1, Steps: 12 | Train Loss: 2.821 Vali Loss: 2.664 Vali Acc: 0.133 Test Loss: 2.664 Test Acc: 0.133
Validation loss decreased (inf --> -0.133307).  Saving model ...
Epoch: 2 cost time: 2.148470640182495
Epoch: 2, Steps: 12 | Train Loss: 2.634 Vali Loss: 2.458 Vali Acc: 0.311 Test Loss: 2.458 Test Acc: 0.311
Validation loss decreased (-0.133307 --> -0.311087).  Saving model ...
Epoch: 3 cost time: 3.150169849395752
Epoch: 3, Steps: 12 | Train Loss: 2.368 Vali Loss: 2.125 Vali Acc: 0.444 Test Loss: 2.125 Test Acc: 0.444
Validation loss decreased (-0.311087 --> -0.444423).  Saving model ...
Epoch: 4 cost time: 2.540017604827881
Epoch: 4, Steps: 12 | Train Loss: 2.075 Vali Loss: 1.827 Vali Acc: 0.533 Test Loss: 1.827 Test Acc: 0.533
Validation loss decreased (-0.444423 --> -0.533315).  Saving model ...
Epoch: 5 cost time: 2.3512394428253174
Epoch: 5, Steps: 12 | Train Loss: 1.694 Vali Loss: 1.604 Vali Acc: 0.578 Test Loss: 1.604 Test Acc: 0.578
Validation loss decreased (-0.533315 --> -0.577762).  Saving model ...
Epoch: 6 cost time: 2.2588109970092773
Epoch: 6, Steps: 12 | Train Loss: 1.442 Vali Loss: 1.411 Vali Acc: 0.672 Test Loss: 1.411 Test Acc: 0.672
Validation loss decreased (-0.577762 --> -0.672208).  Saving model ...
Epoch: 7 cost time: 2.2730133533477783
Epoch: 7, Steps: 12 | Train Loss: 1.283 Vali Loss: 1.282 Vali Acc: 0.628 Test Loss: 1.282 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3539862632751465
Epoch: 8, Steps: 12 | Train Loss: 1.085 Vali Loss: 1.192 Vali Acc: 0.722 Test Loss: 1.192 Test Acc: 0.722
Validation loss decreased (-0.672208 --> -0.722210).  Saving model ...
Epoch: 9 cost time: 2.3553690910339355
Epoch: 9, Steps: 12 | Train Loss: 0.922 Vali Loss: 1.057 Vali Acc: 0.722 Test Loss: 1.057 Test Acc: 0.722
Validation loss decreased (-0.722210 --> -0.722212).  Saving model ...
Epoch: 10 cost time: 2.007091522216797
Epoch: 10, Steps: 12 | Train Loss: 0.822 Vali Loss: 0.997 Vali Acc: 0.739 Test Loss: 0.997 Test Acc: 0.739
Validation loss decreased (-0.722212 --> -0.738879).  Saving model ...
Epoch: 11 cost time: 2.1005630493164062
Epoch: 11, Steps: 12 | Train Loss: 0.694 Vali Loss: 0.884 Vali Acc: 0.733 Test Loss: 0.884 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5205981731414795
Epoch: 12, Steps: 12 | Train Loss: 0.599 Vali Loss: 0.827 Vali Acc: 0.761 Test Loss: 0.827 Test Acc: 0.761
Validation loss decreased (-0.738879 --> -0.761103).  Saving model ...
Epoch: 13 cost time: 2.160513401031494
Epoch: 13, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.714 Vali Acc: 0.811 Test Loss: 0.714 Test Acc: 0.811
Validation loss decreased (-0.761103 --> -0.811104).  Saving model ...
Epoch: 14 cost time: 2.163616180419922
Epoch: 14, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.710 Vali Acc: 0.817 Test Loss: 0.710 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816660).  Saving model ...
Epoch: 15 cost time: 2.206653594970703
Epoch: 15, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.635 Vali Acc: 0.839 Test Loss: 0.635 Test Acc: 0.839
Validation loss decreased (-0.816660 --> -0.838883).  Saving model ...
Epoch: 16 cost time: 2.2020528316497803
Epoch: 16, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.627 Vali Acc: 0.817 Test Loss: 0.627 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.4787957668304443
Epoch: 17, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.665 Vali Acc: 0.839 Test Loss: 0.665 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.280604124069214
Epoch: 18, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.605 Vali Acc: 0.850 Test Loss: 0.605 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 19 cost time: 1.8937344551086426
Epoch: 19, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.623 Vali Acc: 0.856 Test Loss: 0.623 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 20 cost time: 2.255333423614502
Epoch: 20, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.602 Vali Acc: 0.839 Test Loss: 0.602 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.121004819869995
Epoch: 21, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.656 Vali Acc: 0.839 Test Loss: 0.656 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8810079097747803
Epoch: 22, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.623 Vali Acc: 0.844 Test Loss: 0.623 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.0168724060058594
Epoch: 23, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.554 Vali Acc: 0.867 Test Loss: 0.554 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866661).  Saving model ...
Epoch: 24 cost time: 2.3639729022979736
Epoch: 24, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.615 Vali Acc: 0.867 Test Loss: 0.615 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.2827374935150146
Epoch: 25, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.510 Vali Acc: 0.850 Test Loss: 0.510 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.1761815547943115
Epoch: 26, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.601 Vali Acc: 0.844 Test Loss: 0.601 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.9552087783813477
Epoch: 27, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.574 Vali Acc: 0.872 Test Loss: 0.574 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 28 cost time: 2.3842594623565674
Epoch: 28, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.590 Vali Acc: 0.867 Test Loss: 0.590 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.335648775100708
Epoch: 29, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.605 Vali Acc: 0.872 Test Loss: 0.605 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.2900328636169434
Epoch: 30, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.553 Vali Acc: 0.833 Test Loss: 0.553 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.450258255004883
Epoch: 31, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.643 Vali Acc: 0.817 Test Loss: 0.643 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.1963298320770264
Epoch: 32, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.542 Vali Acc: 0.867 Test Loss: 0.542 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.2688212394714355
Epoch: 33, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.675 Vali Acc: 0.850 Test Loss: 0.675 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.313469171524048
Epoch: 34, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.744 Vali Acc: 0.839 Test Loss: 0.744 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.5206573009490967
Epoch: 35, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.698 Vali Acc: 0.822 Test Loss: 0.698 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.2538957595825195
Epoch: 36, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.701 Vali Acc: 0.822 Test Loss: 0.701 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.2441201210021973
Epoch: 37, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.588 Vali Acc: 0.844 Test Loss: 0.588 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 3002571
model size : 14.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.723084926605225
Epoch: 1, Steps: 12 | Train Loss: 2.841 Vali Loss: 2.686 Vali Acc: 0.106 Test Loss: 2.686 Test Acc: 0.106
Validation loss decreased (inf --> -0.105529).  Saving model ...
Epoch: 2 cost time: 2.0376882553100586
Epoch: 2, Steps: 12 | Train Loss: 2.661 Vali Loss: 2.496 Vali Acc: 0.222 Test Loss: 2.496 Test Acc: 0.222
Validation loss decreased (-0.105529 --> -0.222197).  Saving model ...
Epoch: 3 cost time: 2.4639101028442383
Epoch: 3, Steps: 12 | Train Loss: 2.365 Vali Loss: 2.241 Vali Acc: 0.389 Test Loss: 2.241 Test Acc: 0.389
Validation loss decreased (-0.222197 --> -0.388866).  Saving model ...
Epoch: 4 cost time: 2.5620508193969727
Epoch: 4, Steps: 12 | Train Loss: 2.048 Vali Loss: 1.887 Vali Acc: 0.478 Test Loss: 1.887 Test Acc: 0.478
Validation loss decreased (-0.388866 --> -0.477759).  Saving model ...
Epoch: 5 cost time: 2.7791635990142822
Epoch: 5, Steps: 12 | Train Loss: 1.693 Vali Loss: 1.632 Vali Acc: 0.511 Test Loss: 1.632 Test Acc: 0.511
Validation loss decreased (-0.477759 --> -0.511095).  Saving model ...
Epoch: 6 cost time: 2.245884895324707
Epoch: 6, Steps: 12 | Train Loss: 1.451 Vali Loss: 1.428 Vali Acc: 0.594 Test Loss: 1.428 Test Acc: 0.594
Validation loss decreased (-0.511095 --> -0.594430).  Saving model ...
Epoch: 7 cost time: 2.405456781387329
Epoch: 7, Steps: 12 | Train Loss: 1.225 Vali Loss: 1.266 Vali Acc: 0.656 Test Loss: 1.266 Test Acc: 0.656
Validation loss decreased (-0.594430 --> -0.655543).  Saving model ...
Epoch: 8 cost time: 2.975146770477295
Epoch: 8, Steps: 12 | Train Loss: 1.134 Vali Loss: 1.145 Vali Acc: 0.656 Test Loss: 1.145 Test Acc: 0.656
Validation loss decreased (-0.655543 --> -0.655544).  Saving model ...
Epoch: 9 cost time: 2.3308281898498535
Epoch: 9, Steps: 12 | Train Loss: 0.903 Vali Loss: 1.020 Vali Acc: 0.722 Test Loss: 1.020 Test Acc: 0.722
Validation loss decreased (-0.655544 --> -0.722212).  Saving model ...
Epoch: 10 cost time: 2.7579336166381836
Epoch: 10, Steps: 12 | Train Loss: 0.824 Vali Loss: 0.899 Vali Acc: 0.756 Test Loss: 0.899 Test Acc: 0.756
Validation loss decreased (-0.722212 --> -0.755547).  Saving model ...
Epoch: 11 cost time: 2.116678237915039
Epoch: 11, Steps: 12 | Train Loss: 0.663 Vali Loss: 0.831 Vali Acc: 0.750 Test Loss: 0.831 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.14459228515625
Epoch: 12, Steps: 12 | Train Loss: 0.530 Vali Loss: 0.730 Vali Acc: 0.789 Test Loss: 0.730 Test Acc: 0.789
Validation loss decreased (-0.755547 --> -0.788882).  Saving model ...
Epoch: 13 cost time: 2.065159320831299
Epoch: 13, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.672 Vali Acc: 0.822 Test Loss: 0.672 Test Acc: 0.822
Validation loss decreased (-0.788882 --> -0.822216).  Saving model ...
Epoch: 14 cost time: 2.3385584354400635
Epoch: 14, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.645 Vali Acc: 0.817 Test Loss: 0.645 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.1236793994903564
Epoch: 15, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.602 Vali Acc: 0.833 Test Loss: 0.602 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833327).  Saving model ...
Epoch: 16 cost time: 2.4122183322906494
Epoch: 16, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.600 Vali Acc: 0.828 Test Loss: 0.600 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0920615196228027
Epoch: 17, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.560 Vali Acc: 0.817 Test Loss: 0.560 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.6918280124664307
Epoch: 18, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.525 Vali Acc: 0.828 Test Loss: 0.525 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.4891269207000732
Epoch: 19, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.612 Vali Acc: 0.833 Test Loss: 0.612 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.753969192504883
Epoch: 20, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.516 Vali Acc: 0.844 Test Loss: 0.516 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844439).  Saving model ...
Epoch: 21 cost time: 2.0971338748931885
Epoch: 21, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.534 Vali Acc: 0.861 Test Loss: 0.534 Test Acc: 0.861
Validation loss decreased (-0.844439 --> -0.861106).  Saving model ...
Epoch: 22 cost time: 2.6334421634674072
Epoch: 22, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.628 Vali Acc: 0.817 Test Loss: 0.628 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.5161023139953613
Epoch: 23, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.514 Vali Acc: 0.900 Test Loss: 0.514 Test Acc: 0.900
Validation loss decreased (-0.861106 --> -0.899995).  Saving model ...
Epoch: 24 cost time: 3.0438694953918457
Epoch: 24, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.499 Vali Acc: 0.856 Test Loss: 0.499 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.3636691570281982
Epoch: 25, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.590 Vali Acc: 0.867 Test Loss: 0.590 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.2793281078338623
Epoch: 26, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.550 Vali Acc: 0.850 Test Loss: 0.550 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.5572760105133057
Epoch: 27, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.627 Vali Acc: 0.839 Test Loss: 0.627 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.3398361206054688
Epoch: 28, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.668 Vali Acc: 0.861 Test Loss: 0.668 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.12087082862854
Epoch: 29, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.581 Vali Acc: 0.861 Test Loss: 0.581 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.7769715785980225
Epoch: 30, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.580 Vali Acc: 0.872 Test Loss: 0.580 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.506700038909912
Epoch: 31, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.526 Vali Acc: 0.872 Test Loss: 0.526 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.3763277530670166
Epoch: 32, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.576 Vali Acc: 0.872 Test Loss: 0.576 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.1674959659576416
Epoch: 33, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.517 Vali Acc: 0.889 Test Loss: 0.517 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 3001547
model size : 14.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.068222999572754
Epoch: 1, Steps: 12 | Train Loss: 2.837 Vali Loss: 2.660 Vali Acc: 0.111 Test Loss: 2.660 Test Acc: 0.111
Validation loss decreased (inf --> -0.111085).  Saving model ...
Epoch: 2 cost time: 2.394155263900757
Epoch: 2, Steps: 12 | Train Loss: 2.601 Vali Loss: 2.469 Vali Acc: 0.239 Test Loss: 2.469 Test Acc: 0.239
Validation loss decreased (-0.111085 --> -0.238864).  Saving model ...
Epoch: 3 cost time: 2.571601152420044
Epoch: 3, Steps: 12 | Train Loss: 2.336 Vali Loss: 2.128 Vali Acc: 0.411 Test Loss: 2.128 Test Acc: 0.411
Validation loss decreased (-0.238864 --> -0.411090).  Saving model ...
Epoch: 4 cost time: 2.4069035053253174
Epoch: 4, Steps: 12 | Train Loss: 2.040 Vali Loss: 1.899 Vali Acc: 0.528 Test Loss: 1.899 Test Acc: 0.528
Validation loss decreased (-0.411090 --> -0.527759).  Saving model ...
Epoch: 5 cost time: 2.0597898960113525
Epoch: 5, Steps: 12 | Train Loss: 1.673 Vali Loss: 1.719 Vali Acc: 0.511 Test Loss: 1.719 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.355384349822998
Epoch: 6, Steps: 12 | Train Loss: 1.548 Vali Loss: 1.545 Vali Acc: 0.578 Test Loss: 1.545 Test Acc: 0.578
Validation loss decreased (-0.527759 --> -0.577762).  Saving model ...
Epoch: 7 cost time: 2.1914970874786377
Epoch: 7, Steps: 12 | Train Loss: 1.278 Vali Loss: 1.402 Vali Acc: 0.600 Test Loss: 1.402 Test Acc: 0.600
Validation loss decreased (-0.577762 --> -0.599986).  Saving model ...
Epoch: 8 cost time: 2.1999082565307617
Epoch: 8, Steps: 12 | Train Loss: 1.160 Vali Loss: 1.263 Vali Acc: 0.628 Test Loss: 1.263 Test Acc: 0.628
Validation loss decreased (-0.599986 --> -0.627765).  Saving model ...
Epoch: 9 cost time: 2.336235523223877
Epoch: 9, Steps: 12 | Train Loss: 0.970 Vali Loss: 1.156 Vali Acc: 0.678 Test Loss: 1.156 Test Acc: 0.678
Validation loss decreased (-0.627765 --> -0.677766).  Saving model ...
Epoch: 10 cost time: 2.3137614727020264
Epoch: 10, Steps: 12 | Train Loss: 0.827 Vali Loss: 0.978 Vali Acc: 0.783 Test Loss: 0.978 Test Acc: 0.783
Validation loss decreased (-0.677766 --> -0.783324).  Saving model ...
Epoch: 11 cost time: 2.1876676082611084
Epoch: 11, Steps: 12 | Train Loss: 0.740 Vali Loss: 0.931 Vali Acc: 0.744 Test Loss: 0.931 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.122058868408203
Epoch: 12, Steps: 12 | Train Loss: 0.741 Vali Loss: 0.925 Vali Acc: 0.783 Test Loss: 0.925 Test Acc: 0.783
Validation loss decreased (-0.783324 --> -0.783324).  Saving model ...
Epoch: 13 cost time: 2.2389447689056396
Epoch: 13, Steps: 12 | Train Loss: 0.635 Vali Loss: 0.819 Vali Acc: 0.772 Test Loss: 0.819 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.128408670425415
Epoch: 14, Steps: 12 | Train Loss: 0.514 Vali Loss: 0.738 Vali Acc: 0.817 Test Loss: 0.738 Test Acc: 0.817
Validation loss decreased (-0.783324 --> -0.816659).  Saving model ...
Epoch: 15 cost time: 2.1406524181365967
Epoch: 15, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.693 Vali Acc: 0.817 Test Loss: 0.693 Test Acc: 0.817
Validation loss decreased (-0.816659 --> -0.816660).  Saving model ...
Epoch: 16 cost time: 2.456449031829834
Epoch: 16, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.735 Vali Acc: 0.828 Test Loss: 0.735 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827770).  Saving model ...
Epoch: 17 cost time: 2.4450604915618896
Epoch: 17, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.667 Vali Acc: 0.822 Test Loss: 0.667 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.327996015548706
Epoch: 18, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.623 Vali Acc: 0.833 Test Loss: 0.623 Test Acc: 0.833
Validation loss decreased (-0.827770 --> -0.833327).  Saving model ...
Epoch: 19 cost time: 2.360342502593994
Epoch: 19, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.605 Vali Acc: 0.850 Test Loss: 0.605 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849994).  Saving model ...
Epoch: 20 cost time: 2.3113436698913574
Epoch: 20, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.639 Vali Acc: 0.839 Test Loss: 0.639 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.4541640281677246
Epoch: 21, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.517 Vali Acc: 0.861 Test Loss: 0.517 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861106).  Saving model ...
Epoch: 22 cost time: 2.5878138542175293
Epoch: 22, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.596 Vali Acc: 0.856 Test Loss: 0.596 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.1753151416778564
Epoch: 23, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.607 Vali Acc: 0.861 Test Loss: 0.607 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.6708643436431885
Epoch: 24, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.574 Vali Acc: 0.839 Test Loss: 0.574 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.373443603515625
Epoch: 25, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.596 Vali Acc: 0.856 Test Loss: 0.596 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.5586133003234863
Epoch: 26, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.639 Vali Acc: 0.861 Test Loss: 0.639 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.2284843921661377
Epoch: 27, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.650 Vali Acc: 0.850 Test Loss: 0.650 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.7536063194274902
Epoch: 28, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.551 Vali Acc: 0.867 Test Loss: 0.551 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 29 cost time: 2.696639060974121
Epoch: 29, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.566 Vali Acc: 0.867 Test Loss: 0.566 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.1800413131713867
Epoch: 30, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.646 Vali Acc: 0.856 Test Loss: 0.646 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.3135602474212646
Epoch: 31, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.583 Vali Acc: 0.872 Test Loss: 0.583 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 32 cost time: 2.561140298843384
Epoch: 32, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.581 Vali Acc: 0.861 Test Loss: 0.581 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.9428517818450928
Epoch: 33, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.610 Vali Acc: 0.889 Test Loss: 0.610 Test Acc: 0.889
Validation loss decreased (-0.872216 --> -0.888883).  Saving model ...
Epoch: 34 cost time: 2.2382843494415283
Epoch: 34, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.579 Vali Acc: 0.867 Test Loss: 0.579 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.5444724559783936
Epoch: 35, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.549 Vali Acc: 0.883 Test Loss: 0.549 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.1971442699432373
Epoch: 36, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.590 Vali Acc: 0.878 Test Loss: 0.590 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.192751884460449
Epoch: 37, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.627 Vali Acc: 0.850 Test Loss: 0.627 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.1824452877044678
Epoch: 38, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.625 Vali Acc: 0.878 Test Loss: 0.625 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.138641119003296
Epoch: 39, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.649 Vali Acc: 0.861 Test Loss: 0.649 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.27453351020813
Epoch: 40, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.661 Vali Acc: 0.878 Test Loss: 0.661 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.065358877182007
Epoch: 41, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.641 Vali Acc: 0.867 Test Loss: 0.641 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.5221900939941406
Epoch: 42, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.656 Vali Acc: 0.856 Test Loss: 0.656 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.384875774383545
Epoch: 43, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.645 Vali Acc: 0.867 Test Loss: 0.645 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 3000523
model size : 14.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.764449119567871
Epoch: 1, Steps: 12 | Train Loss: 2.832 Vali Loss: 2.716 Vali Acc: 0.067 Test Loss: 2.716 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 2.3602116107940674
Epoch: 2, Steps: 12 | Train Loss: 2.678 Vali Loss: 2.582 Vali Acc: 0.211 Test Loss: 2.582 Test Acc: 0.211
Validation loss decreased (-0.066640 --> -0.211085).  Saving model ...
Epoch: 3 cost time: 2.832087516784668
Epoch: 3, Steps: 12 | Train Loss: 2.479 Vali Loss: 2.391 Vali Acc: 0.217 Test Loss: 2.391 Test Acc: 0.217
Validation loss decreased (-0.211085 --> -0.216643).  Saving model ...
Epoch: 4 cost time: 2.0551540851593018
Epoch: 4, Steps: 12 | Train Loss: 2.191 Vali Loss: 2.111 Vali Acc: 0.422 Test Loss: 2.111 Test Acc: 0.422
Validation loss decreased (-0.216643 --> -0.422201).  Saving model ...
Epoch: 5 cost time: 2.463167905807495
Epoch: 5, Steps: 12 | Train Loss: 1.912 Vali Loss: 1.821 Vali Acc: 0.494 Test Loss: 1.821 Test Acc: 0.494
Validation loss decreased (-0.422201 --> -0.494426).  Saving model ...
Epoch: 6 cost time: 2.4024646282196045
Epoch: 6, Steps: 12 | Train Loss: 1.593 Vali Loss: 1.566 Vali Acc: 0.567 Test Loss: 1.566 Test Acc: 0.567
Validation loss decreased (-0.494426 --> -0.566651).  Saving model ...
Epoch: 7 cost time: 2.861478328704834
Epoch: 7, Steps: 12 | Train Loss: 1.425 Vali Loss: 1.469 Vali Acc: 0.639 Test Loss: 1.469 Test Acc: 0.639
Validation loss decreased (-0.566651 --> -0.638874).  Saving model ...
Epoch: 8 cost time: 2.4719793796539307
Epoch: 8, Steps: 12 | Train Loss: 1.237 Vali Loss: 1.369 Vali Acc: 0.644 Test Loss: 1.369 Test Acc: 0.644
Validation loss decreased (-0.638874 --> -0.644431).  Saving model ...
Epoch: 9 cost time: 2.60837721824646
Epoch: 9, Steps: 12 | Train Loss: 1.130 Vali Loss: 1.247 Vali Acc: 0.656 Test Loss: 1.247 Test Acc: 0.656
Validation loss decreased (-0.644431 --> -0.655543).  Saving model ...
Epoch: 10 cost time: 2.535360097885132
Epoch: 10, Steps: 12 | Train Loss: 0.937 Vali Loss: 1.110 Vali Acc: 0.706 Test Loss: 1.110 Test Acc: 0.706
Validation loss decreased (-0.655543 --> -0.705544).  Saving model ...
Epoch: 11 cost time: 2.604353189468384
Epoch: 11, Steps: 12 | Train Loss: 0.812 Vali Loss: 1.009 Vali Acc: 0.706 Test Loss: 1.009 Test Acc: 0.706
Validation loss decreased (-0.705544 --> -0.705545).  Saving model ...
Epoch: 12 cost time: 2.470421552658081
Epoch: 12, Steps: 12 | Train Loss: 0.740 Vali Loss: 0.897 Vali Acc: 0.728 Test Loss: 0.897 Test Acc: 0.728
Validation loss decreased (-0.705545 --> -0.727769).  Saving model ...
Epoch: 13 cost time: 2.3517394065856934
Epoch: 13, Steps: 12 | Train Loss: 0.634 Vali Loss: 0.866 Vali Acc: 0.772 Test Loss: 0.866 Test Acc: 0.772
Validation loss decreased (-0.727769 --> -0.772214).  Saving model ...
Epoch: 14 cost time: 2.5592150688171387
Epoch: 14, Steps: 12 | Train Loss: 0.623 Vali Loss: 0.803 Vali Acc: 0.789 Test Loss: 0.803 Test Acc: 0.789
Validation loss decreased (-0.772214 --> -0.788881).  Saving model ...
Epoch: 15 cost time: 2.87347412109375
Epoch: 15, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.694 Vali Acc: 0.822 Test Loss: 0.694 Test Acc: 0.822
Validation loss decreased (-0.788881 --> -0.822215).  Saving model ...
Epoch: 16 cost time: 2.9729714393615723
Epoch: 16, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.726 Vali Acc: 0.811 Test Loss: 0.726 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2964251041412354
Epoch: 17, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.647 Vali Acc: 0.833 Test Loss: 0.647 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833327).  Saving model ...
Epoch: 18 cost time: 2.628678560256958
Epoch: 18, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.572 Vali Acc: 0.867 Test Loss: 0.572 Test Acc: 0.867
Validation loss decreased (-0.833327 --> -0.866661).  Saving model ...
Epoch: 19 cost time: 2.6832714080810547
Epoch: 19, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.589 Vali Acc: 0.844 Test Loss: 0.589 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.460784912109375
Epoch: 20, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.566 Vali Acc: 0.850 Test Loss: 0.566 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.4464712142944336
Epoch: 21, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.581 Vali Acc: 0.872 Test Loss: 0.581 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 22 cost time: 2.951260566711426
Epoch: 22, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.597 Vali Acc: 0.828 Test Loss: 0.597 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.2176947593688965
Epoch: 23, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.680 Vali Acc: 0.861 Test Loss: 0.680 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.2038121223449707
Epoch: 24, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.567 Vali Acc: 0.867 Test Loss: 0.567 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.4929370880126953
Epoch: 25, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.578 Vali Acc: 0.883 Test Loss: 0.578 Test Acc: 0.883
Validation loss decreased (-0.872216 --> -0.883328).  Saving model ...
Epoch: 26 cost time: 2.1429548263549805
Epoch: 26, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.473 Vali Acc: 0.850 Test Loss: 0.473 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.5896716117858887
Epoch: 27, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.598 Vali Acc: 0.872 Test Loss: 0.598 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.2751669883728027
Epoch: 28, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.636 Vali Acc: 0.833 Test Loss: 0.636 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.436065673828125
Epoch: 29, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.579 Vali Acc: 0.861 Test Loss: 0.579 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.0473670959472656
Epoch: 30, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.673 Vali Acc: 0.850 Test Loss: 0.673 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.3959641456604004
Epoch: 31, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.653 Vali Acc: 0.806 Test Loss: 0.653 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.270794630050659
Epoch: 32, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.615 Vali Acc: 0.872 Test Loss: 0.615 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.6456921100616455
Epoch: 33, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.607 Vali Acc: 0.878 Test Loss: 0.607 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.9419691562652588
Epoch: 34, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.549 Vali Acc: 0.850 Test Loss: 0.549 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.3653934001922607
Epoch: 35, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.666 Vali Acc: 0.839 Test Loss: 0.666 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 2707531
model size : 12.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.48445463180542
Epoch: 1, Steps: 12 | Train Loss: 2.814 Vali Loss: 2.639 Vali Acc: 0.078 Test Loss: 2.639 Test Acc: 0.078
Validation loss decreased (inf --> -0.077751).  Saving model ...
Epoch: 2 cost time: 2.0143423080444336
Epoch: 2, Steps: 12 | Train Loss: 2.584 Vali Loss: 2.466 Vali Acc: 0.283 Test Loss: 2.466 Test Acc: 0.283
Validation loss decreased (-0.077751 --> -0.283309).  Saving model ...
Epoch: 3 cost time: 2.3699541091918945
Epoch: 3, Steps: 12 | Train Loss: 2.383 Vali Loss: 2.206 Vali Acc: 0.417 Test Loss: 2.206 Test Acc: 0.417
Validation loss decreased (-0.283309 --> -0.416645).  Saving model ...
Epoch: 4 cost time: 2.323890447616577
Epoch: 4, Steps: 12 | Train Loss: 2.147 Vali Loss: 1.927 Vali Acc: 0.511 Test Loss: 1.927 Test Acc: 0.511
Validation loss decreased (-0.416645 --> -0.511092).  Saving model ...
Epoch: 5 cost time: 2.1125288009643555
Epoch: 5, Steps: 12 | Train Loss: 1.793 Vali Loss: 1.702 Vali Acc: 0.572 Test Loss: 1.702 Test Acc: 0.572
Validation loss decreased (-0.511092 --> -0.572205).  Saving model ...
Epoch: 6 cost time: 1.9645984172821045
Epoch: 6, Steps: 12 | Train Loss: 1.526 Vali Loss: 1.512 Vali Acc: 0.583 Test Loss: 1.512 Test Acc: 0.583
Validation loss decreased (-0.572205 --> -0.583318).  Saving model ...
Epoch: 7 cost time: 2.216796636581421
Epoch: 7, Steps: 12 | Train Loss: 1.329 Vali Loss: 1.347 Vali Acc: 0.661 Test Loss: 1.347 Test Acc: 0.661
Validation loss decreased (-0.583318 --> -0.661098).  Saving model ...
Epoch: 8 cost time: 2.071277141571045
Epoch: 8, Steps: 12 | Train Loss: 1.178 Vali Loss: 1.244 Vali Acc: 0.678 Test Loss: 1.244 Test Acc: 0.678
Validation loss decreased (-0.661098 --> -0.677765).  Saving model ...
Epoch: 9 cost time: 1.910278558731079
Epoch: 9, Steps: 12 | Train Loss: 1.041 Vali Loss: 1.142 Vali Acc: 0.700 Test Loss: 1.142 Test Acc: 0.700
Validation loss decreased (-0.677765 --> -0.699989).  Saving model ...
Epoch: 10 cost time: 2.062326669692993
Epoch: 10, Steps: 12 | Train Loss: 0.963 Vali Loss: 1.075 Vali Acc: 0.706 Test Loss: 1.075 Test Acc: 0.706
Validation loss decreased (-0.699989 --> -0.705545).  Saving model ...
Epoch: 11 cost time: 2.5218417644500732
Epoch: 11, Steps: 12 | Train Loss: 0.821 Vali Loss: 0.992 Vali Acc: 0.756 Test Loss: 0.992 Test Acc: 0.756
Validation loss decreased (-0.705545 --> -0.755546).  Saving model ...
Epoch: 12 cost time: 2.144608497619629
Epoch: 12, Steps: 12 | Train Loss: 0.725 Vali Loss: 0.910 Vali Acc: 0.744 Test Loss: 0.910 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0944552421569824
Epoch: 13, Steps: 12 | Train Loss: 0.630 Vali Loss: 0.828 Vali Acc: 0.806 Test Loss: 0.828 Test Acc: 0.806
Validation loss decreased (-0.755546 --> -0.805547).  Saving model ...
Epoch: 14 cost time: 2.200758934020996
Epoch: 14, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.812 Vali Acc: 0.744 Test Loss: 0.812 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.379955291748047
Epoch: 15, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.712 Vali Acc: 0.828 Test Loss: 0.712 Test Acc: 0.828
Validation loss decreased (-0.805547 --> -0.827771).  Saving model ...
Epoch: 16 cost time: 1.829143762588501
Epoch: 16, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.642 Vali Acc: 0.844 Test Loss: 0.642 Test Acc: 0.844
Validation loss decreased (-0.827771 --> -0.844438).  Saving model ...
Epoch: 17 cost time: 1.8224117755889893
Epoch: 17, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.640 Vali Acc: 0.817 Test Loss: 0.640 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.7597508430480957
Epoch: 18, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.586 Vali Acc: 0.839 Test Loss: 0.586 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.3418591022491455
Epoch: 19, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.647 Vali Acc: 0.811 Test Loss: 0.647 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.102280378341675
Epoch: 20, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.691 Vali Acc: 0.772 Test Loss: 0.691 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.187232732772827
Epoch: 21, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.539 Vali Acc: 0.867 Test Loss: 0.539 Test Acc: 0.867
Validation loss decreased (-0.844438 --> -0.866661).  Saving model ...
Epoch: 22 cost time: 2.181633472442627
Epoch: 22, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.594 Vali Acc: 0.867 Test Loss: 0.594 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.350816011428833
Epoch: 23, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.549 Vali Acc: 0.861 Test Loss: 0.549 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.2730517387390137
Epoch: 24, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.514 Vali Acc: 0.861 Test Loss: 0.514 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.00223445892334
Epoch: 25, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.570 Vali Acc: 0.878 Test Loss: 0.570 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877772).  Saving model ...
Epoch: 26 cost time: 2.320467472076416
Epoch: 26, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.613 Vali Acc: 0.833 Test Loss: 0.613 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.597984552383423
Epoch: 27, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.576 Vali Acc: 0.839 Test Loss: 0.576 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.1281206607818604
Epoch: 28, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.638 Vali Acc: 0.833 Test Loss: 0.638 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.318864583969116
Epoch: 29, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.624 Vali Acc: 0.850 Test Loss: 0.624 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.470543622970581
Epoch: 30, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.616 Vali Acc: 0.856 Test Loss: 0.616 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.1702873706817627
Epoch: 31, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.576 Vali Acc: 0.861 Test Loss: 0.576 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.2655856609344482
Epoch: 32, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.602 Vali Acc: 0.867 Test Loss: 0.602 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.117166757583618
Epoch: 33, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.574 Vali Acc: 0.844 Test Loss: 0.574 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.3300952911376953
Epoch: 34, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.616 Vali Acc: 0.872 Test Loss: 0.616 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.271674871444702
Epoch: 35, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.614 Vali Acc: 0.861 Test Loss: 0.614 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 2706507
model size : 12.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.878842830657959
Epoch: 1, Steps: 12 | Train Loss: 2.800 Vali Loss: 2.713 Vali Acc: 0.117 Test Loss: 2.713 Test Acc: 0.117
Validation loss decreased (inf --> -0.116640).  Saving model ...
Epoch: 2 cost time: 2.856330633163452
Epoch: 2, Steps: 12 | Train Loss: 2.619 Vali Loss: 2.518 Vali Acc: 0.206 Test Loss: 2.518 Test Acc: 0.206
Validation loss decreased (-0.116640 --> -0.205530).  Saving model ...
Epoch: 3 cost time: 2.420473337173462
Epoch: 3, Steps: 12 | Train Loss: 2.338 Vali Loss: 2.218 Vali Acc: 0.394 Test Loss: 2.218 Test Acc: 0.394
Validation loss decreased (-0.205530 --> -0.394422).  Saving model ...
Epoch: 4 cost time: 2.2328834533691406
Epoch: 4, Steps: 12 | Train Loss: 1.928 Vali Loss: 1.962 Vali Acc: 0.489 Test Loss: 1.962 Test Acc: 0.489
Validation loss decreased (-0.394422 --> -0.488869).  Saving model ...
Epoch: 5 cost time: 2.505114793777466
Epoch: 5, Steps: 12 | Train Loss: 1.729 Vali Loss: 1.701 Vali Acc: 0.561 Test Loss: 1.701 Test Acc: 0.561
Validation loss decreased (-0.488869 --> -0.561094).  Saving model ...
Epoch: 6 cost time: 2.385279417037964
Epoch: 6, Steps: 12 | Train Loss: 1.415 Vali Loss: 1.431 Vali Acc: 0.594 Test Loss: 1.431 Test Acc: 0.594
Validation loss decreased (-0.561094 --> -0.594430).  Saving model ...
Epoch: 7 cost time: 2.4589157104492188
Epoch: 7, Steps: 12 | Train Loss: 1.191 Vali Loss: 1.333 Vali Acc: 0.589 Test Loss: 1.333 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.352304220199585
Epoch: 8, Steps: 12 | Train Loss: 1.134 Vali Loss: 1.145 Vali Acc: 0.656 Test Loss: 1.145 Test Acc: 0.656
Validation loss decreased (-0.594430 --> -0.655544).  Saving model ...
Epoch: 9 cost time: 2.4777801036834717
Epoch: 9, Steps: 12 | Train Loss: 0.976 Vali Loss: 1.048 Vali Acc: 0.706 Test Loss: 1.048 Test Acc: 0.706
Validation loss decreased (-0.655544 --> -0.705545).  Saving model ...
Epoch: 10 cost time: 2.082587718963623
Epoch: 10, Steps: 12 | Train Loss: 0.914 Vali Loss: 0.961 Vali Acc: 0.750 Test Loss: 0.961 Test Acc: 0.750
Validation loss decreased (-0.705545 --> -0.749990).  Saving model ...
Epoch: 11 cost time: 2.3995447158813477
Epoch: 11, Steps: 12 | Train Loss: 0.782 Vali Loss: 0.908 Vali Acc: 0.750 Test Loss: 0.908 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 12 cost time: 2.708099126815796
Epoch: 12, Steps: 12 | Train Loss: 0.679 Vali Loss: 0.828 Vali Acc: 0.739 Test Loss: 0.828 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6030540466308594
Epoch: 13, Steps: 12 | Train Loss: 0.594 Vali Loss: 0.713 Vali Acc: 0.800 Test Loss: 0.713 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799993).  Saving model ...
Epoch: 14 cost time: 2.349738597869873
Epoch: 14, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.712 Vali Acc: 0.817 Test Loss: 0.712 Test Acc: 0.817
Validation loss decreased (-0.799993 --> -0.816660).  Saving model ...
Epoch: 15 cost time: 2.0978431701660156
Epoch: 15, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.778 Vali Acc: 0.783 Test Loss: 0.778 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.338494300842285
Epoch: 16, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.591 Vali Acc: 0.856 Test Loss: 0.591 Test Acc: 0.856
Validation loss decreased (-0.816660 --> -0.855550).  Saving model ...
Epoch: 17 cost time: 2.4993977546691895
Epoch: 17, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.611 Vali Acc: 0.850 Test Loss: 0.611 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.941643476486206
Epoch: 18, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.582 Vali Acc: 0.850 Test Loss: 0.582 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.772282361984253
Epoch: 19, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.619 Vali Acc: 0.856 Test Loss: 0.619 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.665837287902832
Epoch: 20, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.567 Vali Acc: 0.861 Test Loss: 0.567 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 21 cost time: 2.456975221633911
Epoch: 21, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.527 Vali Acc: 0.878 Test Loss: 0.527 Test Acc: 0.878
Validation loss decreased (-0.861105 --> -0.877773).  Saving model ...
Epoch: 22 cost time: 3.246708393096924
Epoch: 22, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.585 Vali Acc: 0.844 Test Loss: 0.585 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.054654121398926
Epoch: 23, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.535 Vali Acc: 0.844 Test Loss: 0.535 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.4152984619140625
Epoch: 24, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.535 Vali Acc: 0.872 Test Loss: 0.535 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.2163169384002686
Epoch: 25, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.626 Vali Acc: 0.844 Test Loss: 0.626 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.4001307487487793
Epoch: 26, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.502 Vali Acc: 0.894 Test Loss: 0.502 Test Acc: 0.894
Validation loss decreased (-0.877773 --> -0.894439).  Saving model ...
Epoch: 27 cost time: 2.7389333248138428
Epoch: 27, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.586 Vali Acc: 0.883 Test Loss: 0.586 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.6613402366638184
Epoch: 28, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.568 Vali Acc: 0.867 Test Loss: 0.568 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.8946890830993652
Epoch: 29, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.592 Vali Acc: 0.850 Test Loss: 0.592 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.615251302719116
Epoch: 30, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.435 Vali Acc: 0.883 Test Loss: 0.435 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.0722999572753906
Epoch: 31, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.616 Vali Acc: 0.872 Test Loss: 0.616 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.449634552001953
Epoch: 32, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.529 Vali Acc: 0.878 Test Loss: 0.529 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.4955177307128906
Epoch: 33, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.614 Vali Acc: 0.861 Test Loss: 0.614 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.310312509536743
Epoch: 34, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.565 Vali Acc: 0.872 Test Loss: 0.565 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.227008581161499
Epoch: 35, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.524 Vali Acc: 0.894 Test Loss: 0.524 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.2776448726654053
Epoch: 36, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.565 Vali Acc: 0.883 Test Loss: 0.565 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 2705483
model size : 12.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.792329788208008
Epoch: 1, Steps: 12 | Train Loss: 2.844 Vali Loss: 2.721 Vali Acc: 0.072 Test Loss: 2.721 Test Acc: 0.072
Validation loss decreased (inf --> -0.072195).  Saving model ...
Epoch: 2 cost time: 1.8129799365997314
Epoch: 2, Steps: 12 | Train Loss: 2.693 Vali Loss: 2.533 Vali Acc: 0.178 Test Loss: 2.533 Test Acc: 0.178
Validation loss decreased (-0.072195 --> -0.177752).  Saving model ...
Epoch: 3 cost time: 2.066983461380005
Epoch: 3, Steps: 12 | Train Loss: 2.452 Vali Loss: 2.282 Vali Acc: 0.372 Test Loss: 2.282 Test Acc: 0.372
Validation loss decreased (-0.177752 --> -0.372199).  Saving model ...
Epoch: 4 cost time: 2.3562228679656982
Epoch: 4, Steps: 12 | Train Loss: 2.085 Vali Loss: 1.957 Vali Acc: 0.494 Test Loss: 1.957 Test Acc: 0.494
Validation loss decreased (-0.372199 --> -0.494425).  Saving model ...
Epoch: 5 cost time: 1.8878328800201416
Epoch: 5, Steps: 12 | Train Loss: 1.744 Vali Loss: 1.679 Vali Acc: 0.589 Test Loss: 1.679 Test Acc: 0.589
Validation loss decreased (-0.494425 --> -0.588872).  Saving model ...
Epoch: 6 cost time: 2.330784797668457
Epoch: 6, Steps: 12 | Train Loss: 1.418 Vali Loss: 1.497 Vali Acc: 0.572 Test Loss: 1.497 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3067758083343506
Epoch: 7, Steps: 12 | Train Loss: 1.279 Vali Loss: 1.360 Vali Acc: 0.656 Test Loss: 1.360 Test Acc: 0.656
Validation loss decreased (-0.588872 --> -0.655542).  Saving model ...
Epoch: 8 cost time: 2.2075977325439453
Epoch: 8, Steps: 12 | Train Loss: 1.091 Vali Loss: 1.260 Vali Acc: 0.706 Test Loss: 1.260 Test Acc: 0.706
Validation loss decreased (-0.655542 --> -0.705543).  Saving model ...
Epoch: 9 cost time: 2.3686294555664062
Epoch: 9, Steps: 12 | Train Loss: 0.943 Vali Loss: 1.072 Vali Acc: 0.733 Test Loss: 1.072 Test Acc: 0.733
Validation loss decreased (-0.705543 --> -0.733323).  Saving model ...
Epoch: 10 cost time: 2.2621843814849854
Epoch: 10, Steps: 12 | Train Loss: 0.890 Vali Loss: 1.018 Vali Acc: 0.733 Test Loss: 1.018 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 11 cost time: 2.352684259414673
Epoch: 11, Steps: 12 | Train Loss: 0.781 Vali Loss: 0.937 Vali Acc: 0.750 Test Loss: 0.937 Test Acc: 0.750
Validation loss decreased (-0.733323 --> -0.749991).  Saving model ...
Epoch: 12 cost time: 2.205505847930908
Epoch: 12, Steps: 12 | Train Loss: 0.674 Vali Loss: 0.819 Vali Acc: 0.794 Test Loss: 0.819 Test Acc: 0.794
Validation loss decreased (-0.749991 --> -0.794436).  Saving model ...
Epoch: 13 cost time: 2.4560346603393555
Epoch: 13, Steps: 12 | Train Loss: 0.570 Vali Loss: 0.761 Vali Acc: 0.800 Test Loss: 0.761 Test Acc: 0.800
Validation loss decreased (-0.794436 --> -0.799992).  Saving model ...
Epoch: 14 cost time: 2.311849355697632
Epoch: 14, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.676 Vali Acc: 0.817 Test Loss: 0.676 Test Acc: 0.817
Validation loss decreased (-0.799992 --> -0.816660).  Saving model ...
Epoch: 15 cost time: 2.1908843517303467
Epoch: 15, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.665 Vali Acc: 0.828 Test Loss: 0.665 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827771).  Saving model ...
Epoch: 16 cost time: 2.786207437515259
Epoch: 16, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.621 Vali Acc: 0.833 Test Loss: 0.621 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 17 cost time: 2.109200954437256
Epoch: 17, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.534 Vali Acc: 0.861 Test Loss: 0.534 Test Acc: 0.861
Validation loss decreased (-0.833327 --> -0.861106).  Saving model ...
Epoch: 18 cost time: 2.217482566833496
Epoch: 18, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.614 Vali Acc: 0.856 Test Loss: 0.614 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.526200294494629
Epoch: 19, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.617 Vali Acc: 0.822 Test Loss: 0.617 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.3496501445770264
Epoch: 20, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.644 Vali Acc: 0.811 Test Loss: 0.644 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.0684926509857178
Epoch: 21, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.601 Vali Acc: 0.867 Test Loss: 0.601 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 22 cost time: 2.0212364196777344
Epoch: 22, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.623 Vali Acc: 0.867 Test Loss: 0.623 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.0702075958251953
Epoch: 23, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.463 Vali Acc: 0.850 Test Loss: 0.463 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.1450448036193848
Epoch: 24, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.568 Vali Acc: 0.861 Test Loss: 0.568 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.9748728275299072
Epoch: 25, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.635 Vali Acc: 0.861 Test Loss: 0.635 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.7838375568389893
Epoch: 26, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.580 Vali Acc: 0.833 Test Loss: 0.580 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.0067367553710938
Epoch: 27, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.592 Vali Acc: 0.850 Test Loss: 0.592 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.0077707767486572
Epoch: 28, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.598 Vali Acc: 0.856 Test Loss: 0.598 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.42506742477417
Epoch: 29, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.671 Vali Acc: 0.867 Test Loss: 0.671 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.082582950592041
Epoch: 30, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.686 Vali Acc: 0.833 Test Loss: 0.686 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.012415885925293
Epoch: 31, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.599 Vali Acc: 0.861 Test Loss: 0.599 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 2704459
model size : 12.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.381175994873047
Epoch: 1, Steps: 12 | Train Loss: 2.832 Vali Loss: 2.695 Vali Acc: 0.061 Test Loss: 2.695 Test Acc: 0.061
Validation loss decreased (inf --> -0.061084).  Saving model ...
Epoch: 2 cost time: 2.4342260360717773
Epoch: 2, Steps: 12 | Train Loss: 2.714 Vali Loss: 2.547 Vali Acc: 0.183 Test Loss: 2.547 Test Acc: 0.183
Validation loss decreased (-0.061084 --> -0.183308).  Saving model ...
Epoch: 3 cost time: 2.1574418544769287
Epoch: 3, Steps: 12 | Train Loss: 2.547 Vali Loss: 2.404 Vali Acc: 0.333 Test Loss: 2.404 Test Acc: 0.333
Validation loss decreased (-0.183308 --> -0.333309).  Saving model ...
Epoch: 4 cost time: 2.6824381351470947
Epoch: 4, Steps: 12 | Train Loss: 2.295 Vali Loss: 2.157 Vali Acc: 0.417 Test Loss: 2.157 Test Acc: 0.417
Validation loss decreased (-0.333309 --> -0.416645).  Saving model ...
Epoch: 5 cost time: 2.38824200630188
Epoch: 5, Steps: 12 | Train Loss: 2.035 Vali Loss: 1.935 Vali Acc: 0.511 Test Loss: 1.935 Test Acc: 0.511
Validation loss decreased (-0.416645 --> -0.511092).  Saving model ...
Epoch: 6 cost time: 2.255697250366211
Epoch: 6, Steps: 12 | Train Loss: 1.726 Vali Loss: 1.715 Vali Acc: 0.550 Test Loss: 1.715 Test Acc: 0.550
Validation loss decreased (-0.511092 --> -0.549983).  Saving model ...
Epoch: 7 cost time: 2.76977276802063
Epoch: 7, Steps: 12 | Train Loss: 1.500 Vali Loss: 1.532 Vali Acc: 0.611 Test Loss: 1.532 Test Acc: 0.611
Validation loss decreased (-0.549983 --> -0.611096).  Saving model ...
Epoch: 8 cost time: 2.3506641387939453
Epoch: 8, Steps: 12 | Train Loss: 1.355 Vali Loss: 1.382 Vali Acc: 0.656 Test Loss: 1.382 Test Acc: 0.656
Validation loss decreased (-0.611096 --> -0.655542).  Saving model ...
Epoch: 9 cost time: 2.4330403804779053
Epoch: 9, Steps: 12 | Train Loss: 1.201 Vali Loss: 1.269 Vali Acc: 0.683 Test Loss: 1.269 Test Acc: 0.683
Validation loss decreased (-0.655542 --> -0.683321).  Saving model ...
Epoch: 10 cost time: 2.2608642578125
Epoch: 10, Steps: 12 | Train Loss: 1.117 Vali Loss: 1.138 Vali Acc: 0.711 Test Loss: 1.138 Test Acc: 0.711
Validation loss decreased (-0.683321 --> -0.711100).  Saving model ...
Epoch: 11 cost time: 1.959082841873169
Epoch: 11, Steps: 12 | Train Loss: 0.917 Vali Loss: 1.025 Vali Acc: 0.767 Test Loss: 1.025 Test Acc: 0.767
Validation loss decreased (-0.711100 --> -0.766656).  Saving model ...
Epoch: 12 cost time: 2.1735057830810547
Epoch: 12, Steps: 12 | Train Loss: 0.858 Vali Loss: 0.934 Vali Acc: 0.794 Test Loss: 0.934 Test Acc: 0.794
Validation loss decreased (-0.766656 --> -0.794435).  Saving model ...
Epoch: 13 cost time: 2.10335111618042
Epoch: 13, Steps: 12 | Train Loss: 0.723 Vali Loss: 0.842 Vali Acc: 0.822 Test Loss: 0.842 Test Acc: 0.822
Validation loss decreased (-0.794435 --> -0.822214).  Saving model ...
Epoch: 14 cost time: 1.9329447746276855
Epoch: 14, Steps: 12 | Train Loss: 0.623 Vali Loss: 0.781 Vali Acc: 0.794 Test Loss: 0.781 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.923079252243042
Epoch: 15, Steps: 12 | Train Loss: 0.534 Vali Loss: 0.732 Vali Acc: 0.817 Test Loss: 0.732 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9368329048156738
Epoch: 16, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.663 Vali Acc: 0.839 Test Loss: 0.663 Test Acc: 0.839
Validation loss decreased (-0.822214 --> -0.838882).  Saving model ...
Epoch: 17 cost time: 2.0088071823120117
Epoch: 17, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.676 Vali Acc: 0.839 Test Loss: 0.676 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.518786668777466
Epoch: 18, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.646 Vali Acc: 0.817 Test Loss: 0.646 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8521556854248047
Epoch: 19, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.637 Vali Acc: 0.817 Test Loss: 0.637 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.3077948093414307
Epoch: 20, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.598 Vali Acc: 0.822 Test Loss: 0.598 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.9103944301605225
Epoch: 21, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.498 Vali Acc: 0.867 Test Loss: 0.498 Test Acc: 0.867
Validation loss decreased (-0.838882 --> -0.866662).  Saving model ...
Epoch: 22 cost time: 1.886887550354004
Epoch: 22, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.505 Vali Acc: 0.867 Test Loss: 0.505 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9804751873016357
Epoch: 23, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.526 Vali Acc: 0.850 Test Loss: 0.526 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.45688796043396
Epoch: 24, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.540 Vali Acc: 0.839 Test Loss: 0.540 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.7771730422973633
Epoch: 25, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.487 Vali Acc: 0.861 Test Loss: 0.487 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.0690250396728516
Epoch: 26, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.524 Vali Acc: 0.872 Test Loss: 0.524 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872217).  Saving model ...
Epoch: 27 cost time: 2.1392829418182373
Epoch: 27, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.545 Vali Acc: 0.872 Test Loss: 0.545 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.8483760356903076
Epoch: 28, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.531 Vali Acc: 0.872 Test Loss: 0.531 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.031980037689209
Epoch: 29, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.554 Vali Acc: 0.844 Test Loss: 0.554 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.1384408473968506
Epoch: 30, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.575 Vali Acc: 0.856 Test Loss: 0.575 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.028209686279297
Epoch: 31, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.515 Vali Acc: 0.861 Test Loss: 0.515 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.079333782196045
Epoch: 32, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.531 Vali Acc: 0.872 Test Loss: 0.531 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.453744411468506
Epoch: 33, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.558 Vali Acc: 0.867 Test Loss: 0.558 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.31520414352417
Epoch: 34, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.479 Vali Acc: 0.867 Test Loss: 0.479 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.9355754852294922
Epoch: 35, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.452 Vali Acc: 0.867 Test Loss: 0.452 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.968291997909546
Epoch: 36, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.504 Vali Acc: 0.872 Test Loss: 0.504 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 37 cost time: 2.124523639678955
Epoch: 37, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.454 Vali Acc: 0.878 Test Loss: 0.454 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 38 cost time: 2.2517032623291016
Epoch: 38, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.452 Vali Acc: 0.861 Test Loss: 0.452 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.347886800765991
Epoch: 39, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.619 Vali Acc: 0.856 Test Loss: 0.619 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.7897436618804932
Epoch: 40, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.559 Vali Acc: 0.856 Test Loss: 0.559 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.8542766571044922
Epoch: 41, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.439 Vali Acc: 0.872 Test Loss: 0.439 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.943042516708374
Epoch: 42, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.508 Vali Acc: 0.878 Test Loss: 0.508 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 2.2363533973693848
Epoch: 43, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.499 Vali Acc: 0.872 Test Loss: 0.499 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.9564118385314941
Epoch: 44, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.554 Vali Acc: 0.867 Test Loss: 0.554 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.9653394222259521
Epoch: 45, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.536 Vali Acc: 0.867 Test Loss: 0.536 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 2.1164262294769287
Epoch: 46, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.542 Vali Acc: 0.883 Test Loss: 0.542 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883328).  Saving model ...
Epoch: 47 cost time: 2.1645452976226807
Epoch: 47, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.515 Vali Acc: 0.900 Test Loss: 0.515 Test Acc: 0.900
Validation loss decreased (-0.883328 --> -0.899995).  Saving model ...
Epoch: 48 cost time: 2.1701834201812744
Epoch: 48, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.494 Vali Acc: 0.883 Test Loss: 0.494 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.218675136566162
Epoch: 49, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.541 Vali Acc: 0.856 Test Loss: 0.541 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 2.3994457721710205
Epoch: 50, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.494 Vali Acc: 0.872 Test Loss: 0.494 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 2.4412598609924316
Epoch: 51, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.610 Vali Acc: 0.844 Test Loss: 0.610 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 2.602177619934082
Epoch: 52, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.513 Vali Acc: 0.867 Test Loss: 0.513 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 2.0836517810821533
Epoch: 53, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.537 Vali Acc: 0.833 Test Loss: 0.537 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 2.4975392818450928
Epoch: 54, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.690 Vali Acc: 0.856 Test Loss: 0.690 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 2.3262250423431396
Epoch: 55, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.504 Vali Acc: 0.889 Test Loss: 0.504 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 2.7714569568634033
Epoch: 56, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.527 Vali Acc: 0.844 Test Loss: 0.527 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 2.2894749641418457
Epoch: 57, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.537 Vali Acc: 0.894 Test Loss: 0.537 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 1804811
model size : 8.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.576449871063232
Epoch: 1, Steps: 12 | Train Loss: 2.830 Vali Loss: 2.731 Vali Acc: 0.089 Test Loss: 2.731 Test Acc: 0.089
Validation loss decreased (inf --> -0.088862).  Saving model ...
Epoch: 2 cost time: 2.1103405952453613
Epoch: 2, Steps: 12 | Train Loss: 2.646 Vali Loss: 2.548 Vali Acc: 0.267 Test Loss: 2.548 Test Acc: 0.267
Validation loss decreased (-0.088862 --> -0.266641).  Saving model ...
Epoch: 3 cost time: 2.2889280319213867
Epoch: 3, Steps: 12 | Train Loss: 2.496 Vali Loss: 2.312 Vali Acc: 0.350 Test Loss: 2.312 Test Acc: 0.350
Validation loss decreased (-0.266641 --> -0.349977).  Saving model ...
Epoch: 4 cost time: 2.409153938293457
Epoch: 4, Steps: 12 | Train Loss: 2.206 Vali Loss: 2.060 Vali Acc: 0.489 Test Loss: 2.060 Test Acc: 0.489
Validation loss decreased (-0.349977 --> -0.488868).  Saving model ...
Epoch: 5 cost time: 2.5922629833221436
Epoch: 5, Steps: 12 | Train Loss: 1.888 Vali Loss: 1.832 Vali Acc: 0.533 Test Loss: 1.832 Test Acc: 0.533
Validation loss decreased (-0.488868 --> -0.533315).  Saving model ...
Epoch: 6 cost time: 2.906195640563965
Epoch: 6, Steps: 12 | Train Loss: 1.675 Vali Loss: 1.641 Vali Acc: 0.606 Test Loss: 1.641 Test Acc: 0.606
Validation loss decreased (-0.533315 --> -0.605539).  Saving model ...
Epoch: 7 cost time: 2.479062080383301
Epoch: 7, Steps: 12 | Train Loss: 1.469 Vali Loss: 1.437 Vali Acc: 0.656 Test Loss: 1.437 Test Acc: 0.656
Validation loss decreased (-0.605539 --> -0.655541).  Saving model ...
Epoch: 8 cost time: 2.296586275100708
Epoch: 8, Steps: 12 | Train Loss: 1.324 Vali Loss: 1.319 Vali Acc: 0.689 Test Loss: 1.319 Test Acc: 0.689
Validation loss decreased (-0.655541 --> -0.688876).  Saving model ...
Epoch: 9 cost time: 2.389394760131836
Epoch: 9, Steps: 12 | Train Loss: 1.126 Vali Loss: 1.173 Vali Acc: 0.700 Test Loss: 1.173 Test Acc: 0.700
Validation loss decreased (-0.688876 --> -0.699988).  Saving model ...
Epoch: 10 cost time: 2.5030999183654785
Epoch: 10, Steps: 12 | Train Loss: 0.957 Vali Loss: 1.114 Vali Acc: 0.722 Test Loss: 1.114 Test Acc: 0.722
Validation loss decreased (-0.699988 --> -0.722211).  Saving model ...
Epoch: 11 cost time: 2.1620044708251953
Epoch: 11, Steps: 12 | Train Loss: 0.918 Vali Loss: 1.025 Vali Acc: 0.728 Test Loss: 1.025 Test Acc: 0.728
Validation loss decreased (-0.722211 --> -0.727768).  Saving model ...
Epoch: 12 cost time: 2.247404098510742
Epoch: 12, Steps: 12 | Train Loss: 0.789 Vali Loss: 0.912 Vali Acc: 0.761 Test Loss: 0.912 Test Acc: 0.761
Validation loss decreased (-0.727768 --> -0.761102).  Saving model ...
Epoch: 13 cost time: 2.4769222736358643
Epoch: 13, Steps: 12 | Train Loss: 0.668 Vali Loss: 0.839 Vali Acc: 0.783 Test Loss: 0.839 Test Acc: 0.783
Validation loss decreased (-0.761102 --> -0.783325).  Saving model ...
Epoch: 14 cost time: 2.509913682937622
Epoch: 14, Steps: 12 | Train Loss: 0.622 Vali Loss: 0.786 Vali Acc: 0.794 Test Loss: 0.786 Test Acc: 0.794
Validation loss decreased (-0.783325 --> -0.794437).  Saving model ...
Epoch: 15 cost time: 2.429252862930298
Epoch: 15, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.737 Vali Acc: 0.789 Test Loss: 0.737 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.15470814704895
Epoch: 16, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.669 Vali Acc: 0.811 Test Loss: 0.669 Test Acc: 0.811
Validation loss decreased (-0.794437 --> -0.811104).  Saving model ...
Epoch: 17 cost time: 2.799729585647583
Epoch: 17, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.649 Vali Acc: 0.800 Test Loss: 0.649 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.3014490604400635
Epoch: 18, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.658 Vali Acc: 0.778 Test Loss: 0.658 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.270836591720581
Epoch: 19, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.614 Vali Acc: 0.828 Test Loss: 0.614 Test Acc: 0.828
Validation loss decreased (-0.811104 --> -0.827772).  Saving model ...
Epoch: 20 cost time: 2.008887767791748
Epoch: 20, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.585 Vali Acc: 0.839 Test Loss: 0.585 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838883).  Saving model ...
Epoch: 21 cost time: 2.267838716506958
Epoch: 21, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.543 Vali Acc: 0.833 Test Loss: 0.543 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.4347894191741943
Epoch: 22, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.599 Vali Acc: 0.828 Test Loss: 0.599 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.1823477745056152
Epoch: 23, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.506 Vali Acc: 0.828 Test Loss: 0.506 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.9211740493774414
Epoch: 24, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.541 Vali Acc: 0.844 Test Loss: 0.541 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 25 cost time: 2.0262060165405273
Epoch: 25, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.495 Vali Acc: 0.856 Test Loss: 0.495 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855551).  Saving model ...
Epoch: 26 cost time: 2.790574550628662
Epoch: 26, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.522 Vali Acc: 0.856 Test Loss: 0.522 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.5470008850097656
Epoch: 27, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.503 Vali Acc: 0.872 Test Loss: 0.503 Test Acc: 0.872
Validation loss decreased (-0.855551 --> -0.872217).  Saving model ...
Epoch: 28 cost time: 2.9161646366119385
Epoch: 28, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.513 Vali Acc: 0.867 Test Loss: 0.513 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.8905658721923828
Epoch: 29, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.597 Vali Acc: 0.861 Test Loss: 0.597 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.121997594833374
Epoch: 30, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.530 Vali Acc: 0.861 Test Loss: 0.530 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.4988386631011963
Epoch: 31, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.509 Vali Acc: 0.867 Test Loss: 0.509 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.325031280517578
Epoch: 32, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.565 Vali Acc: 0.867 Test Loss: 0.565 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.1573092937469482
Epoch: 33, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.547 Vali Acc: 0.861 Test Loss: 0.547 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.46435284614563
Epoch: 34, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.625 Vali Acc: 0.867 Test Loss: 0.625 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.6288561820983887
Epoch: 35, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.508 Vali Acc: 0.867 Test Loss: 0.508 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.9727346897125244
Epoch: 36, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.543 Vali Acc: 0.867 Test Loss: 0.543 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.216843605041504
Epoch: 37, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.480 Vali Acc: 0.889 Test Loss: 0.480 Test Acc: 0.889
Validation loss decreased (-0.872217 --> -0.888884).  Saving model ...
Epoch: 38 cost time: 2.3416614532470703
Epoch: 38, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.540 Vali Acc: 0.883 Test Loss: 0.540 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.7942984104156494
Epoch: 39, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.556 Vali Acc: 0.872 Test Loss: 0.556 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.47682785987854
Epoch: 40, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.593 Vali Acc: 0.856 Test Loss: 0.593 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.5370543003082275
Epoch: 41, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.612 Vali Acc: 0.844 Test Loss: 0.612 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.4557666778564453
Epoch: 42, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.692 Vali Acc: 0.822 Test Loss: 0.692 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 2.5248324871063232
Epoch: 43, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.586 Vali Acc: 0.850 Test Loss: 0.586 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 2.2129828929901123
Epoch: 44, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.527 Vali Acc: 0.878 Test Loss: 0.527 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 2.9410245418548584
Epoch: 45, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.578 Vali Acc: 0.872 Test Loss: 0.578 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 2.8224992752075195
Epoch: 46, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.550 Vali Acc: 0.878 Test Loss: 0.550 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 2.24135422706604
Epoch: 47, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.565 Vali Acc: 0.900 Test Loss: 0.565 Test Acc: 0.900
Validation loss decreased (-0.888884 --> -0.899994).  Saving model ...
Epoch: 48 cost time: 2.191925287246704
Epoch: 48, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.625 Vali Acc: 0.878 Test Loss: 0.625 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.8559815883636475
Epoch: 49, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.544 Vali Acc: 0.878 Test Loss: 0.544 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 2.537677049636841
Epoch: 50, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.530 Vali Acc: 0.889 Test Loss: 0.530 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 2.826578140258789
Epoch: 51, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.611 Vali Acc: 0.878 Test Loss: 0.611 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 2.3759162425994873
Epoch: 52, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.632 Vali Acc: 0.867 Test Loss: 0.632 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.9956519603729248
Epoch: 53, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.553 Vali Acc: 0.856 Test Loss: 0.553 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 2.088494300842285
Epoch: 54, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.640 Vali Acc: 0.889 Test Loss: 0.640 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 2.461742877960205
Epoch: 55, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.508 Vali Acc: 0.883 Test Loss: 0.508 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 2.2062594890594482
Epoch: 56, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.527 Vali Acc: 0.878 Test Loss: 0.527 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 2.6273252964019775
Epoch: 57, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.595 Vali Acc: 0.861 Test Loss: 0.595 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 1804299
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.5995447635650635
Epoch: 1, Steps: 12 | Train Loss: 2.855 Vali Loss: 2.730 Vali Acc: 0.089 Test Loss: 2.730 Test Acc: 0.089
Validation loss decreased (inf --> -0.088862).  Saving model ...
Epoch: 2 cost time: 2.253074884414673
Epoch: 2, Steps: 12 | Train Loss: 2.645 Vali Loss: 2.586 Vali Acc: 0.217 Test Loss: 2.586 Test Acc: 0.217
Validation loss decreased (-0.088862 --> -0.216641).  Saving model ...
Epoch: 3 cost time: 2.5525741577148438
Epoch: 3, Steps: 12 | Train Loss: 2.459 Vali Loss: 2.391 Vali Acc: 0.289 Test Loss: 2.391 Test Acc: 0.289
Validation loss decreased (-0.216641 --> -0.288865).  Saving model ...
Epoch: 4 cost time: 2.4094510078430176
Epoch: 4, Steps: 12 | Train Loss: 2.154 Vali Loss: 2.142 Vali Acc: 0.372 Test Loss: 2.142 Test Acc: 0.372
Validation loss decreased (-0.288865 --> -0.372201).  Saving model ...
Epoch: 5 cost time: 2.164379358291626
Epoch: 5, Steps: 12 | Train Loss: 1.961 Vali Loss: 1.884 Vali Acc: 0.456 Test Loss: 1.884 Test Acc: 0.456
Validation loss decreased (-0.372201 --> -0.455537).  Saving model ...
Epoch: 6 cost time: 2.119034767150879
Epoch: 6, Steps: 12 | Train Loss: 1.760 Vali Loss: 1.685 Vali Acc: 0.594 Test Loss: 1.685 Test Acc: 0.594
Validation loss decreased (-0.455537 --> -0.594428).  Saving model ...
Epoch: 7 cost time: 2.187258243560791
Epoch: 7, Steps: 12 | Train Loss: 1.560 Vali Loss: 1.483 Vali Acc: 0.667 Test Loss: 1.483 Test Acc: 0.667
Validation loss decreased (-0.594428 --> -0.666652).  Saving model ...
Epoch: 8 cost time: 2.169374704360962
Epoch: 8, Steps: 12 | Train Loss: 1.288 Vali Loss: 1.346 Vali Acc: 0.728 Test Loss: 1.346 Test Acc: 0.728
Validation loss decreased (-0.666652 --> -0.727764).  Saving model ...
Epoch: 9 cost time: 2.287585973739624
Epoch: 9, Steps: 12 | Train Loss: 1.141 Vali Loss: 1.256 Vali Acc: 0.678 Test Loss: 1.256 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3646724224090576
Epoch: 10, Steps: 12 | Train Loss: 1.029 Vali Loss: 1.091 Vali Acc: 0.772 Test Loss: 1.091 Test Acc: 0.772
Validation loss decreased (-0.727764 --> -0.772211).  Saving model ...
Epoch: 11 cost time: 2.4659502506256104
Epoch: 11, Steps: 12 | Train Loss: 0.967 Vali Loss: 1.104 Vali Acc: 0.761 Test Loss: 1.104 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3118667602539062
Epoch: 12, Steps: 12 | Train Loss: 0.856 Vali Loss: 0.931 Vali Acc: 0.783 Test Loss: 0.931 Test Acc: 0.783
Validation loss decreased (-0.772211 --> -0.783324).  Saving model ...
Epoch: 13 cost time: 2.1771419048309326
Epoch: 13, Steps: 12 | Train Loss: 0.743 Vali Loss: 0.848 Vali Acc: 0.806 Test Loss: 0.848 Test Acc: 0.806
Validation loss decreased (-0.783324 --> -0.805547).  Saving model ...
Epoch: 14 cost time: 2.5553722381591797
Epoch: 14, Steps: 12 | Train Loss: 0.617 Vali Loss: 0.766 Vali Acc: 0.811 Test Loss: 0.766 Test Acc: 0.811
Validation loss decreased (-0.805547 --> -0.811103).  Saving model ...
Epoch: 15 cost time: 2.819342613220215
Epoch: 15, Steps: 12 | Train Loss: 0.588 Vali Loss: 0.696 Vali Acc: 0.833 Test Loss: 0.696 Test Acc: 0.833
Validation loss decreased (-0.811103 --> -0.833326).  Saving model ...
Epoch: 16 cost time: 2.55376935005188
Epoch: 16, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.680 Vali Acc: 0.822 Test Loss: 0.680 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1410999298095703
Epoch: 17, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.698 Vali Acc: 0.800 Test Loss: 0.698 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.6672801971435547
Epoch: 18, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.609 Vali Acc: 0.850 Test Loss: 0.609 Test Acc: 0.850
Validation loss decreased (-0.833326 --> -0.849994).  Saving model ...
Epoch: 19 cost time: 2.3986542224884033
Epoch: 19, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.562 Vali Acc: 0.856 Test Loss: 0.562 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 20 cost time: 2.1035044193267822
Epoch: 20, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.590 Vali Acc: 0.856 Test Loss: 0.590 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.6123313903808594
Epoch: 21, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.507 Vali Acc: 0.872 Test Loss: 0.507 Test Acc: 0.872
Validation loss decreased (-0.855550 --> -0.872217).  Saving model ...
Epoch: 22 cost time: 2.153120517730713
Epoch: 22, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.585 Vali Acc: 0.844 Test Loss: 0.585 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.5950374603271484
Epoch: 23, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.551 Vali Acc: 0.856 Test Loss: 0.551 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.232424259185791
Epoch: 24, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.467 Vali Acc: 0.861 Test Loss: 0.467 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.1546337604522705
Epoch: 25, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.525 Vali Acc: 0.844 Test Loss: 0.525 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.9294664859771729
Epoch: 26, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.490 Vali Acc: 0.861 Test Loss: 0.490 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.1884496212005615
Epoch: 27, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.480 Vali Acc: 0.861 Test Loss: 0.480 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.2417867183685303
Epoch: 28, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.517 Vali Acc: 0.861 Test Loss: 0.517 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.1495022773742676
Epoch: 29, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.503 Vali Acc: 0.867 Test Loss: 0.503 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.3862545490264893
Epoch: 30, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.503 Vali Acc: 0.878 Test Loss: 0.503 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 31 cost time: 2.218770980834961
Epoch: 31, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.434 Vali Acc: 0.872 Test Loss: 0.434 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.069810628890991
Epoch: 32, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.539 Vali Acc: 0.850 Test Loss: 0.539 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.1712872982025146
Epoch: 33, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.486 Vali Acc: 0.850 Test Loss: 0.486 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.135335683822632
Epoch: 34, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.477 Vali Acc: 0.867 Test Loss: 0.477 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.3656487464904785
Epoch: 35, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.492 Vali Acc: 0.894 Test Loss: 0.492 Test Acc: 0.894
Validation loss decreased (-0.877773 --> -0.894440).  Saving model ...
Epoch: 36 cost time: 2.230935573577881
Epoch: 36, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.531 Vali Acc: 0.894 Test Loss: 0.531 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.002692937850952
Epoch: 37, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.506 Vali Acc: 0.872 Test Loss: 0.506 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.337261438369751
Epoch: 38, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.505 Vali Acc: 0.878 Test Loss: 0.505 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.05155086517334
Epoch: 39, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.542 Vali Acc: 0.867 Test Loss: 0.542 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.2216219902038574
Epoch: 40, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.537 Vali Acc: 0.883 Test Loss: 0.537 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.1150286197662354
Epoch: 41, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.529 Vali Acc: 0.878 Test Loss: 0.529 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 2.2517778873443604
Epoch: 42, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.520 Vali Acc: 0.889 Test Loss: 0.520 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 2.0595037937164307
Epoch: 43, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.508 Vali Acc: 0.900 Test Loss: 0.508 Test Acc: 0.900
Validation loss decreased (-0.894440 --> -0.899995).  Saving model ...
Epoch: 44 cost time: 2.0815155506134033
Epoch: 44, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.517 Vali Acc: 0.889 Test Loss: 0.517 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.2021219730377197
Epoch: 45, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.536 Vali Acc: 0.889 Test Loss: 0.536 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.2489116191864014
Epoch: 46, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.541 Vali Acc: 0.883 Test Loss: 0.541 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.36678409576416
Epoch: 47, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.575 Vali Acc: 0.867 Test Loss: 0.575 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 2.095262289047241
Epoch: 48, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.564 Vali Acc: 0.861 Test Loss: 0.564 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 2.2907304763793945
Epoch: 49, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.556 Vali Acc: 0.872 Test Loss: 0.556 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 2.4279820919036865
Epoch: 50, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.481 Vali Acc: 0.889 Test Loss: 0.481 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 2.021578311920166
Epoch: 51, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.515 Vali Acc: 0.900 Test Loss: 0.515 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 2.008618116378784
Epoch: 52, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.526 Vali Acc: 0.889 Test Loss: 0.526 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 2.2328107357025146
Epoch: 53, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.539 Vali Acc: 0.894 Test Loss: 0.539 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 1803787
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.452005624771118
Epoch: 1, Steps: 12 | Train Loss: 2.795 Vali Loss: 2.640 Vali Acc: 0.172 Test Loss: 2.640 Test Acc: 0.172
Validation loss decreased (inf --> -0.172196).  Saving model ...
Epoch: 2 cost time: 2.6675362586975098
Epoch: 2, Steps: 12 | Train Loss: 2.611 Vali Loss: 2.434 Vali Acc: 0.333 Test Loss: 2.434 Test Acc: 0.333
Validation loss decreased (-0.172196 --> -0.333309).  Saving model ...
Epoch: 3 cost time: 2.3750805854797363
Epoch: 3, Steps: 12 | Train Loss: 2.378 Vali Loss: 2.178 Vali Acc: 0.411 Test Loss: 2.178 Test Acc: 0.411
Validation loss decreased (-0.333309 --> -0.411089).  Saving model ...
Epoch: 4 cost time: 2.4122886657714844
Epoch: 4, Steps: 12 | Train Loss: 2.091 Vali Loss: 1.965 Vali Acc: 0.467 Test Loss: 1.965 Test Acc: 0.467
Validation loss decreased (-0.411089 --> -0.466647).  Saving model ...
Epoch: 5 cost time: 2.2413411140441895
Epoch: 5, Steps: 12 | Train Loss: 1.866 Vali Loss: 1.773 Vali Acc: 0.517 Test Loss: 1.773 Test Acc: 0.517
Validation loss decreased (-0.466647 --> -0.516649).  Saving model ...
Epoch: 6 cost time: 2.808029890060425
Epoch: 6, Steps: 12 | Train Loss: 1.661 Vali Loss: 1.569 Vali Acc: 0.600 Test Loss: 1.569 Test Acc: 0.600
Validation loss decreased (-0.516649 --> -0.599984).  Saving model ...
Epoch: 7 cost time: 2.3155720233917236
Epoch: 7, Steps: 12 | Train Loss: 1.489 Vali Loss: 1.446 Vali Acc: 0.667 Test Loss: 1.446 Test Acc: 0.667
Validation loss decreased (-0.599984 --> -0.666652).  Saving model ...
Epoch: 8 cost time: 2.136962413787842
Epoch: 8, Steps: 12 | Train Loss: 1.337 Vali Loss: 1.278 Vali Acc: 0.733 Test Loss: 1.278 Test Acc: 0.733
Validation loss decreased (-0.666652 --> -0.733321).  Saving model ...
Epoch: 9 cost time: 2.3328793048858643
Epoch: 9, Steps: 12 | Train Loss: 1.172 Vali Loss: 1.168 Vali Acc: 0.733 Test Loss: 1.168 Test Acc: 0.733
Validation loss decreased (-0.733321 --> -0.733322).  Saving model ...
Epoch: 10 cost time: 2.7929069995880127
Epoch: 10, Steps: 12 | Train Loss: 0.998 Vali Loss: 1.103 Vali Acc: 0.711 Test Loss: 1.103 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2717697620391846
Epoch: 11, Steps: 12 | Train Loss: 0.915 Vali Loss: 0.954 Vali Acc: 0.778 Test Loss: 0.954 Test Acc: 0.778
Validation loss decreased (-0.733322 --> -0.777768).  Saving model ...
Epoch: 12 cost time: 2.586278200149536
Epoch: 12, Steps: 12 | Train Loss: 0.847 Vali Loss: 0.889 Vali Acc: 0.789 Test Loss: 0.889 Test Acc: 0.789
Validation loss decreased (-0.777768 --> -0.788880).  Saving model ...
Epoch: 13 cost time: 2.349783420562744
Epoch: 13, Steps: 12 | Train Loss: 0.707 Vali Loss: 0.840 Vali Acc: 0.811 Test Loss: 0.840 Test Acc: 0.811
Validation loss decreased (-0.788880 --> -0.811103).  Saving model ...
Epoch: 14 cost time: 2.220376968383789
Epoch: 14, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.720 Vali Acc: 0.856 Test Loss: 0.720 Test Acc: 0.856
Validation loss decreased (-0.811103 --> -0.855548).  Saving model ...
Epoch: 15 cost time: 2.4711756706237793
Epoch: 15, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.708 Vali Acc: 0.822 Test Loss: 0.708 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.1502726078033447
Epoch: 16, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.672 Vali Acc: 0.844 Test Loss: 0.672 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.12162709236145
Epoch: 17, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.599 Vali Acc: 0.856 Test Loss: 0.599 Test Acc: 0.856
Validation loss decreased (-0.855548 --> -0.855550).  Saving model ...
Epoch: 18 cost time: 2.4014132022857666
Epoch: 18, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.549 Vali Acc: 0.861 Test Loss: 0.549 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 19 cost time: 2.224634885787964
Epoch: 19, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.649 Vali Acc: 0.839 Test Loss: 0.649 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.808354377746582
Epoch: 20, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.564 Vali Acc: 0.850 Test Loss: 0.564 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.379136800765991
Epoch: 21, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.534 Vali Acc: 0.850 Test Loss: 0.534 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.195281982421875
Epoch: 22, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.538 Vali Acc: 0.856 Test Loss: 0.538 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.954735279083252
Epoch: 23, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.541 Vali Acc: 0.839 Test Loss: 0.541 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.2969553470611572
Epoch: 24, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.551 Vali Acc: 0.856 Test Loss: 0.551 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.9727354049682617
Epoch: 25, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.493 Vali Acc: 0.861 Test Loss: 0.493 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 26 cost time: 2.4236812591552734
Epoch: 26, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.486 Vali Acc: 0.861 Test Loss: 0.486 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 27 cost time: 2.875420093536377
Epoch: 27, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.515 Vali Acc: 0.878 Test Loss: 0.515 Test Acc: 0.878
Validation loss decreased (-0.861106 --> -0.877773).  Saving model ...
Epoch: 28 cost time: 2.0846681594848633
Epoch: 28, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.457 Vali Acc: 0.878 Test Loss: 0.457 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 29 cost time: 2.3460028171539307
Epoch: 29, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.480 Vali Acc: 0.861 Test Loss: 0.480 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.227867841720581
Epoch: 30, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.503 Vali Acc: 0.856 Test Loss: 0.503 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.498516321182251
Epoch: 31, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.463 Vali Acc: 0.872 Test Loss: 0.463 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.9708335399627686
Epoch: 32, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.541 Vali Acc: 0.861 Test Loss: 0.541 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.137012481689453
Epoch: 33, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.514 Vali Acc: 0.878 Test Loss: 0.514 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.1360726356506348
Epoch: 34, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.475 Vali Acc: 0.872 Test Loss: 0.475 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.8099215030670166
Epoch: 35, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.464 Vali Acc: 0.878 Test Loss: 0.464 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.3338940143585205
Epoch: 36, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.456 Vali Acc: 0.883 Test Loss: 0.456 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883329).  Saving model ...
Epoch: 37 cost time: 2.5134780406951904
Epoch: 37, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.563 Vali Acc: 0.861 Test Loss: 0.563 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.281299114227295
Epoch: 38, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.599 Vali Acc: 0.856 Test Loss: 0.599 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.8595008850097656
Epoch: 39, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.512 Vali Acc: 0.861 Test Loss: 0.512 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.6367475986480713
Epoch: 40, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.494 Vali Acc: 0.894 Test Loss: 0.494 Test Acc: 0.894
Validation loss decreased (-0.883329 --> -0.894440).  Saving model ...
Epoch: 41 cost time: 2.541964530944824
Epoch: 41, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.558 Vali Acc: 0.872 Test Loss: 0.558 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.3575406074523926
Epoch: 42, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.509 Vali Acc: 0.894 Test Loss: 0.509 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.376790761947632
Epoch: 43, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.534 Vali Acc: 0.878 Test Loss: 0.534 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 2.208709478378296
Epoch: 44, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.536 Vali Acc: 0.872 Test Loss: 0.536 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 2.7035114765167236
Epoch: 45, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.652 Vali Acc: 0.861 Test Loss: 0.652 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 2.726205825805664
Epoch: 46, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.584 Vali Acc: 0.872 Test Loss: 0.584 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 2.9014642238616943
Epoch: 47, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.578 Vali Acc: 0.878 Test Loss: 0.578 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 2.4903600215911865
Epoch: 48, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.492 Vali Acc: 0.894 Test Loss: 0.492 Test Acc: 0.894
Validation loss decreased (-0.894440 --> -0.894440).  Saving model ...
Epoch: 49 cost time: 2.4744646549224854
Epoch: 49, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.519 Vali Acc: 0.894 Test Loss: 0.519 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 2.22461199760437
Epoch: 50, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.576 Vali Acc: 0.867 Test Loss: 0.576 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 3.114516258239746
Epoch: 51, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.583 Vali Acc: 0.878 Test Loss: 0.583 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 2.6543047428131104
Epoch: 52, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.582 Vali Acc: 0.889 Test Loss: 0.582 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 2.848576784133911
Epoch: 53, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.616 Vali Acc: 0.883 Test Loss: 0.616 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.7716801166534424
Epoch: 54, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.609 Vali Acc: 0.894 Test Loss: 0.609 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.8211643695831299
Epoch: 55, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.574 Vali Acc: 0.889 Test Loss: 0.574 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 2.476097345352173
Epoch: 56, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.554 Vali Acc: 0.867 Test Loss: 0.554 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 2.28713059425354
Epoch: 57, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.597 Vali Acc: 0.883 Test Loss: 0.597 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 2.1925976276397705
Epoch: 58, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.554 Vali Acc: 0.878 Test Loss: 0.554 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 1803275
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.221318960189819
Epoch: 1, Steps: 12 | Train Loss: 2.797 Vali Loss: 2.683 Vali Acc: 0.100 Test Loss: 2.683 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 2.2535221576690674
Epoch: 2, Steps: 12 | Train Loss: 2.707 Vali Loss: 2.597 Vali Acc: 0.217 Test Loss: 2.597 Test Acc: 0.217
Validation loss decreased (-0.099973 --> -0.216641).  Saving model ...
Epoch: 3 cost time: 2.08396315574646
Epoch: 3, Steps: 12 | Train Loss: 2.575 Vali Loss: 2.451 Vali Acc: 0.244 Test Loss: 2.451 Test Acc: 0.244
Validation loss decreased (-0.216641 --> -0.244420).  Saving model ...
Epoch: 4 cost time: 2.3108739852905273
Epoch: 4, Steps: 12 | Train Loss: 2.352 Vali Loss: 2.260 Vali Acc: 0.406 Test Loss: 2.260 Test Acc: 0.406
Validation loss decreased (-0.244420 --> -0.405533).  Saving model ...
Epoch: 5 cost time: 1.82454514503479
Epoch: 5, Steps: 12 | Train Loss: 2.106 Vali Loss: 2.051 Vali Acc: 0.467 Test Loss: 2.051 Test Acc: 0.467
Validation loss decreased (-0.405533 --> -0.466646).  Saving model ...
Epoch: 6 cost time: 1.8176136016845703
Epoch: 6, Steps: 12 | Train Loss: 1.910 Vali Loss: 1.832 Vali Acc: 0.544 Test Loss: 1.832 Test Acc: 0.544
Validation loss decreased (-0.466646 --> -0.544426).  Saving model ...
Epoch: 7 cost time: 1.8998498916625977
Epoch: 7, Steps: 12 | Train Loss: 1.638 Vali Loss: 1.648 Vali Acc: 0.611 Test Loss: 1.648 Test Acc: 0.611
Validation loss decreased (-0.544426 --> -0.611095).  Saving model ...
Epoch: 8 cost time: 2.251858949661255
Epoch: 8, Steps: 12 | Train Loss: 1.518 Vali Loss: 1.583 Vali Acc: 0.589 Test Loss: 1.583 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.065013885498047
Epoch: 9, Steps: 12 | Train Loss: 1.345 Vali Loss: 1.434 Vali Acc: 0.667 Test Loss: 1.434 Test Acc: 0.667
Validation loss decreased (-0.611095 --> -0.666652).  Saving model ...
Epoch: 10 cost time: 2.374077796936035
Epoch: 10, Steps: 12 | Train Loss: 1.219 Vali Loss: 1.274 Vali Acc: 0.728 Test Loss: 1.274 Test Acc: 0.728
Validation loss decreased (-0.666652 --> -0.727765).  Saving model ...
Epoch: 11 cost time: 2.324471950531006
Epoch: 11, Steps: 12 | Train Loss: 1.081 Vali Loss: 1.178 Vali Acc: 0.728 Test Loss: 1.178 Test Acc: 0.728
Validation loss decreased (-0.727765 --> -0.727766).  Saving model ...
Epoch: 12 cost time: 2.001688241958618
Epoch: 12, Steps: 12 | Train Loss: 1.010 Vali Loss: 1.075 Vali Acc: 0.756 Test Loss: 1.075 Test Acc: 0.756
Validation loss decreased (-0.727766 --> -0.755545).  Saving model ...
Epoch: 13 cost time: 2.115783929824829
Epoch: 13, Steps: 12 | Train Loss: 0.903 Vali Loss: 0.988 Vali Acc: 0.783 Test Loss: 0.988 Test Acc: 0.783
Validation loss decreased (-0.755545 --> -0.783323).  Saving model ...
Epoch: 14 cost time: 2.1957597732543945
Epoch: 14, Steps: 12 | Train Loss: 0.769 Vali Loss: 0.906 Vali Acc: 0.800 Test Loss: 0.906 Test Acc: 0.800
Validation loss decreased (-0.783323 --> -0.799991).  Saving model ...
Epoch: 15 cost time: 2.252013683319092
Epoch: 15, Steps: 12 | Train Loss: 0.681 Vali Loss: 0.894 Vali Acc: 0.811 Test Loss: 0.894 Test Acc: 0.811
Validation loss decreased (-0.799991 --> -0.811102).  Saving model ...
Epoch: 16 cost time: 2.2272298336029053
Epoch: 16, Steps: 12 | Train Loss: 0.599 Vali Loss: 0.768 Vali Acc: 0.839 Test Loss: 0.768 Test Acc: 0.839
Validation loss decreased (-0.811102 --> -0.838881).  Saving model ...
Epoch: 17 cost time: 2.2799019813537598
Epoch: 17, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.734 Vali Acc: 0.844 Test Loss: 0.734 Test Acc: 0.844
Validation loss decreased (-0.838881 --> -0.844437).  Saving model ...
Epoch: 18 cost time: 2.0107669830322266
Epoch: 18, Steps: 12 | Train Loss: 0.533 Vali Loss: 0.658 Vali Acc: 0.856 Test Loss: 0.658 Test Acc: 0.856
Validation loss decreased (-0.844437 --> -0.855549).  Saving model ...
Epoch: 19 cost time: 2.0425777435302734
Epoch: 19, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.657 Vali Acc: 0.861 Test Loss: 0.657 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 20 cost time: 1.6301391124725342
Epoch: 20, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.600 Vali Acc: 0.883 Test Loss: 0.600 Test Acc: 0.883
Validation loss decreased (-0.861105 --> -0.883327).  Saving model ...
Epoch: 21 cost time: 1.8365907669067383
Epoch: 21, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.685 Vali Acc: 0.822 Test Loss: 0.685 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.2980353832244873
Epoch: 22, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.610 Vali Acc: 0.861 Test Loss: 0.610 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8345470428466797
Epoch: 23, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.584 Vali Acc: 0.856 Test Loss: 0.584 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.81300950050354
Epoch: 24, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.541 Vali Acc: 0.883 Test Loss: 0.541 Test Acc: 0.883
Validation loss decreased (-0.883327 --> -0.883328).  Saving model ...
Epoch: 25 cost time: 1.6615071296691895
Epoch: 25, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.560 Vali Acc: 0.856 Test Loss: 0.560 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8385734558105469
Epoch: 26, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.539 Vali Acc: 0.894 Test Loss: 0.539 Test Acc: 0.894
Validation loss decreased (-0.883328 --> -0.894439).  Saving model ...
Epoch: 27 cost time: 2.104196071624756
Epoch: 27, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.559 Vali Acc: 0.867 Test Loss: 0.559 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.446253776550293
Epoch: 28, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.560 Vali Acc: 0.867 Test Loss: 0.560 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.966651201248169
Epoch: 29, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.556 Vali Acc: 0.883 Test Loss: 0.556 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.8153784275054932
Epoch: 30, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.522 Vali Acc: 0.872 Test Loss: 0.522 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.9688754081726074
Epoch: 31, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.553 Vali Acc: 0.872 Test Loss: 0.553 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.0374367237091064
Epoch: 32, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.458 Vali Acc: 0.883 Test Loss: 0.458 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.050261974334717
Epoch: 33, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.485 Vali Acc: 0.883 Test Loss: 0.485 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.0831122398376465
Epoch: 34, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.512 Vali Acc: 0.872 Test Loss: 0.512 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.7657361030578613
Epoch: 35, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.513 Vali Acc: 0.883 Test Loss: 0.513 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.3628852367401123
Epoch: 36, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.501 Vali Acc: 0.894 Test Loss: 0.501 Test Acc: 0.894
Validation loss decreased (-0.894439 --> -0.894439).  Saving model ...
Epoch: 37 cost time: 1.928337574005127
Epoch: 37, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.564 Vali Acc: 0.878 Test Loss: 0.564 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.4828684329986572
Epoch: 38, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.494 Vali Acc: 0.889 Test Loss: 0.494 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.3670294284820557
Epoch: 39, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.508 Vali Acc: 0.889 Test Loss: 0.508 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.8482260704040527
Epoch: 40, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.494 Vali Acc: 0.894 Test Loss: 0.494 Test Acc: 0.894
Validation loss decreased (-0.894439 --> -0.894440).  Saving model ...
Epoch: 41 cost time: 2.043558359146118
Epoch: 41, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.534 Vali Acc: 0.883 Test Loss: 0.534 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.918731927871704
Epoch: 42, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.534 Vali Acc: 0.894 Test Loss: 0.534 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.0731897354125977
Epoch: 43, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.583 Vali Acc: 0.894 Test Loss: 0.583 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 2.075407028198242
Epoch: 44, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.593 Vali Acc: 0.883 Test Loss: 0.593 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 2.1112918853759766
Epoch: 45, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.602 Vali Acc: 0.878 Test Loss: 0.602 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 2.152017593383789
Epoch: 46, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.612 Vali Acc: 0.883 Test Loss: 0.612 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 2.469586133956909
Epoch: 47, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.579 Vali Acc: 0.878 Test Loss: 0.579 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 2.049433708190918
Epoch: 48, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.560 Vali Acc: 0.894 Test Loss: 0.560 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 2.303377866744995
Epoch: 49, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.597 Vali Acc: 0.889 Test Loss: 0.597 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 2.1151580810546875
Epoch: 50, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.593 Vali Acc: 0.878 Test Loss: 0.593 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 1210379
model size : 6.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.330801010131836
Epoch: 1, Steps: 12 | Train Loss: 2.924 Vali Loss: 2.693 Vali Acc: 0.089 Test Loss: 2.693 Test Acc: 0.089
Validation loss decreased (inf --> -0.088862).  Saving model ...
Epoch: 2 cost time: 2.101410150527954
Epoch: 2, Steps: 12 | Train Loss: 2.725 Vali Loss: 2.563 Vali Acc: 0.194 Test Loss: 2.563 Test Acc: 0.194
Validation loss decreased (-0.088862 --> -0.194419).  Saving model ...
Epoch: 3 cost time: 2.046809434890747
Epoch: 3, Steps: 12 | Train Loss: 2.518 Vali Loss: 2.430 Vali Acc: 0.317 Test Loss: 2.430 Test Acc: 0.317
Validation loss decreased (-0.194419 --> -0.316642).  Saving model ...
Epoch: 4 cost time: 2.2852344512939453
Epoch: 4, Steps: 12 | Train Loss: 2.319 Vali Loss: 2.200 Vali Acc: 0.389 Test Loss: 2.200 Test Acc: 0.389
Validation loss decreased (-0.316642 --> -0.388867).  Saving model ...
Epoch: 5 cost time: 2.1678245067596436
Epoch: 5, Steps: 12 | Train Loss: 2.088 Vali Loss: 1.995 Vali Acc: 0.456 Test Loss: 1.995 Test Acc: 0.456
Validation loss decreased (-0.388867 --> -0.455536).  Saving model ...
Epoch: 6 cost time: 1.9701154232025146
Epoch: 6, Steps: 12 | Train Loss: 1.877 Vali Loss: 1.835 Vali Acc: 0.511 Test Loss: 1.835 Test Acc: 0.511
Validation loss decreased (-0.455536 --> -0.511093).  Saving model ...
Epoch: 7 cost time: 2.2205963134765625
Epoch: 7, Steps: 12 | Train Loss: 1.670 Vali Loss: 1.691 Vali Acc: 0.517 Test Loss: 1.691 Test Acc: 0.517
Validation loss decreased (-0.511093 --> -0.516650).  Saving model ...
Epoch: 8 cost time: 1.8310027122497559
Epoch: 8, Steps: 12 | Train Loss: 1.491 Vali Loss: 1.541 Vali Acc: 0.611 Test Loss: 1.541 Test Acc: 0.611
Validation loss decreased (-0.516650 --> -0.611096).  Saving model ...
Epoch: 9 cost time: 2.23807692527771
Epoch: 9, Steps: 12 | Train Loss: 1.365 Vali Loss: 1.464 Vali Acc: 0.567 Test Loss: 1.464 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.166762113571167
Epoch: 10, Steps: 12 | Train Loss: 1.236 Vali Loss: 1.243 Vali Acc: 0.700 Test Loss: 1.243 Test Acc: 0.700
Validation loss decreased (-0.611096 --> -0.699988).  Saving model ...
Epoch: 11 cost time: 2.260469436645508
Epoch: 11, Steps: 12 | Train Loss: 1.086 Vali Loss: 1.155 Vali Acc: 0.722 Test Loss: 1.155 Test Acc: 0.722
Validation loss decreased (-0.699988 --> -0.722211).  Saving model ...
Epoch: 12 cost time: 2.271185874938965
Epoch: 12, Steps: 12 | Train Loss: 0.982 Vali Loss: 1.034 Vali Acc: 0.733 Test Loss: 1.034 Test Acc: 0.733
Validation loss decreased (-0.722211 --> -0.733323).  Saving model ...
Epoch: 13 cost time: 1.9862656593322754
Epoch: 13, Steps: 12 | Train Loss: 0.908 Vali Loss: 0.973 Vali Acc: 0.750 Test Loss: 0.973 Test Acc: 0.750
Validation loss decreased (-0.733323 --> -0.749990).  Saving model ...
Epoch: 14 cost time: 2.2165708541870117
Epoch: 14, Steps: 12 | Train Loss: 0.770 Vali Loss: 0.892 Vali Acc: 0.822 Test Loss: 0.892 Test Acc: 0.822
Validation loss decreased (-0.749990 --> -0.822213).  Saving model ...
Epoch: 15 cost time: 2.0678932666778564
Epoch: 15, Steps: 12 | Train Loss: 0.789 Vali Loss: 0.867 Vali Acc: 0.806 Test Loss: 0.867 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.205939531326294
Epoch: 16, Steps: 12 | Train Loss: 0.654 Vali Loss: 0.785 Vali Acc: 0.800 Test Loss: 0.785 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.077533483505249
Epoch: 17, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.724 Vali Acc: 0.844 Test Loss: 0.724 Test Acc: 0.844
Validation loss decreased (-0.822213 --> -0.844437).  Saving model ...
Epoch: 18 cost time: 1.9662086963653564
Epoch: 18, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.671 Vali Acc: 0.839 Test Loss: 0.671 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.210063934326172
Epoch: 19, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.641 Vali Acc: 0.856 Test Loss: 0.641 Test Acc: 0.856
Validation loss decreased (-0.844437 --> -0.855549).  Saving model ...
Epoch: 20 cost time: 2.107354164123535
Epoch: 20, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.627 Vali Acc: 0.839 Test Loss: 0.627 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.217827558517456
Epoch: 21, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.609 Vali Acc: 0.844 Test Loss: 0.609 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.793895959854126
Epoch: 22, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.578 Vali Acc: 0.861 Test Loss: 0.578 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 23 cost time: 2.1762328147888184
Epoch: 23, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.573 Vali Acc: 0.844 Test Loss: 0.573 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.107726812362671
Epoch: 24, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.537 Vali Acc: 0.856 Test Loss: 0.537 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.1291306018829346
Epoch: 25, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.535 Vali Acc: 0.872 Test Loss: 0.535 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872217).  Saving model ...
Epoch: 26 cost time: 2.401492118835449
Epoch: 26, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.524 Vali Acc: 0.872 Test Loss: 0.524 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 27 cost time: 2.1030023097991943
Epoch: 27, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.501 Vali Acc: 0.878 Test Loss: 0.501 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 28 cost time: 2.3843138217926025
Epoch: 28, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.487 Vali Acc: 0.878 Test Loss: 0.487 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 29 cost time: 2.3177459239959717
Epoch: 29, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.485 Vali Acc: 0.889 Test Loss: 0.485 Test Acc: 0.889
Validation loss decreased (-0.877773 --> -0.888884).  Saving model ...
Epoch: 30 cost time: 2.0491535663604736
Epoch: 30, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.502 Vali Acc: 0.883 Test Loss: 0.502 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.4423820972442627
Epoch: 31, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.484 Vali Acc: 0.861 Test Loss: 0.484 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.933027744293213
Epoch: 32, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.539 Vali Acc: 0.867 Test Loss: 0.539 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.189852714538574
Epoch: 33, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.448 Vali Acc: 0.878 Test Loss: 0.448 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.3232977390289307
Epoch: 34, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.535 Vali Acc: 0.878 Test Loss: 0.535 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.0694963932037354
Epoch: 35, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.486 Vali Acc: 0.883 Test Loss: 0.486 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.200047731399536
Epoch: 36, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.522 Vali Acc: 0.878 Test Loss: 0.522 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.1657161712646484
Epoch: 37, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.486 Vali Acc: 0.889 Test Loss: 0.486 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.194591760635376
Epoch: 38, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.497 Vali Acc: 0.878 Test Loss: 0.497 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.0555379390716553
Epoch: 39, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.530 Vali Acc: 0.872 Test Loss: 0.530 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 1209867
model size : 6.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.0070109367370605
Epoch: 1, Steps: 12 | Train Loss: 2.768 Vali Loss: 2.671 Vali Acc: 0.133 Test Loss: 2.671 Test Acc: 0.133
Validation loss decreased (inf --> -0.133307).  Saving model ...
Epoch: 2 cost time: 2.4811904430389404
Epoch: 2, Steps: 12 | Train Loss: 2.582 Vali Loss: 2.460 Vali Acc: 0.239 Test Loss: 2.460 Test Acc: 0.239
Validation loss decreased (-0.133307 --> -0.238864).  Saving model ...
Epoch: 3 cost time: 2.2455649375915527
Epoch: 3, Steps: 12 | Train Loss: 2.384 Vali Loss: 2.277 Vali Acc: 0.400 Test Loss: 2.277 Test Acc: 0.400
Validation loss decreased (-0.238864 --> -0.399977).  Saving model ...
Epoch: 4 cost time: 2.7271196842193604
Epoch: 4, Steps: 12 | Train Loss: 2.231 Vali Loss: 2.102 Vali Acc: 0.422 Test Loss: 2.102 Test Acc: 0.422
Validation loss decreased (-0.399977 --> -0.422201).  Saving model ...
Epoch: 5 cost time: 2.3613967895507812
Epoch: 5, Steps: 12 | Train Loss: 1.953 Vali Loss: 1.933 Vali Acc: 0.500 Test Loss: 1.933 Test Acc: 0.500
Validation loss decreased (-0.422201 --> -0.499981).  Saving model ...
Epoch: 6 cost time: 2.9931392669677734
Epoch: 6, Steps: 12 | Train Loss: 1.804 Vali Loss: 1.799 Vali Acc: 0.517 Test Loss: 1.799 Test Acc: 0.517
Validation loss decreased (-0.499981 --> -0.516649).  Saving model ...
Epoch: 7 cost time: 2.335927724838257
Epoch: 7, Steps: 12 | Train Loss: 1.629 Vali Loss: 1.668 Vali Acc: 0.567 Test Loss: 1.668 Test Acc: 0.567
Validation loss decreased (-0.516649 --> -0.566650).  Saving model ...
Epoch: 8 cost time: 2.8235747814178467
Epoch: 8, Steps: 12 | Train Loss: 1.479 Vali Loss: 1.557 Vali Acc: 0.611 Test Loss: 1.557 Test Acc: 0.611
Validation loss decreased (-0.566650 --> -0.611096).  Saving model ...
Epoch: 9 cost time: 2.744706869125366
Epoch: 9, Steps: 12 | Train Loss: 1.380 Vali Loss: 1.410 Vali Acc: 0.672 Test Loss: 1.410 Test Acc: 0.672
Validation loss decreased (-0.611096 --> -0.672208).  Saving model ...
Epoch: 10 cost time: 2.9494388103485107
Epoch: 10, Steps: 12 | Train Loss: 1.256 Vali Loss: 1.329 Vali Acc: 0.678 Test Loss: 1.329 Test Acc: 0.678
Validation loss decreased (-0.672208 --> -0.677764).  Saving model ...
Epoch: 11 cost time: 2.766671657562256
Epoch: 11, Steps: 12 | Train Loss: 1.077 Vali Loss: 1.197 Vali Acc: 0.694 Test Loss: 1.197 Test Acc: 0.694
Validation loss decreased (-0.677764 --> -0.694432).  Saving model ...
Epoch: 12 cost time: 2.92146897315979
Epoch: 12, Steps: 12 | Train Loss: 0.982 Vali Loss: 1.064 Vali Acc: 0.778 Test Loss: 1.064 Test Acc: 0.778
Validation loss decreased (-0.694432 --> -0.777767).  Saving model ...
Epoch: 13 cost time: 2.716992139816284
Epoch: 13, Steps: 12 | Train Loss: 0.853 Vali Loss: 1.031 Vali Acc: 0.772 Test Loss: 1.031 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.212578773498535
Epoch: 14, Steps: 12 | Train Loss: 0.759 Vali Loss: 0.893 Vali Acc: 0.811 Test Loss: 0.893 Test Acc: 0.811
Validation loss decreased (-0.777767 --> -0.811102).  Saving model ...
Epoch: 15 cost time: 2.8982346057891846
Epoch: 15, Steps: 12 | Train Loss: 0.658 Vali Loss: 0.825 Vali Acc: 0.822 Test Loss: 0.825 Test Acc: 0.822
Validation loss decreased (-0.811102 --> -0.822214).  Saving model ...
Epoch: 16 cost time: 2.3935840129852295
Epoch: 16, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.754 Vali Acc: 0.811 Test Loss: 0.754 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.22056245803833
Epoch: 17, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.678 Vali Acc: 0.844 Test Loss: 0.678 Test Acc: 0.844
Validation loss decreased (-0.822214 --> -0.844438).  Saving model ...
Epoch: 18 cost time: 3.16385817527771
Epoch: 18, Steps: 12 | Train Loss: 0.495 Vali Loss: 0.634 Vali Acc: 0.839 Test Loss: 0.634 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.849280595779419
Epoch: 19, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.613 Vali Acc: 0.856 Test Loss: 0.613 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855549).  Saving model ...
Epoch: 20 cost time: 2.436166524887085
Epoch: 20, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.589 Vali Acc: 0.850 Test Loss: 0.589 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.631603717803955
Epoch: 21, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.571 Vali Acc: 0.856 Test Loss: 0.571 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855550).  Saving model ...
Epoch: 22 cost time: 3.0509560108184814
Epoch: 22, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.557 Vali Acc: 0.861 Test Loss: 0.557 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 23 cost time: 2.6477251052856445
Epoch: 23, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.507 Vali Acc: 0.844 Test Loss: 0.507 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.3940229415893555
Epoch: 24, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.510 Vali Acc: 0.856 Test Loss: 0.510 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.2835569381713867
Epoch: 25, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.493 Vali Acc: 0.850 Test Loss: 0.493 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.846235513687134
Epoch: 26, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.510 Vali Acc: 0.872 Test Loss: 0.510 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 27 cost time: 2.5430169105529785
Epoch: 27, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.550 Vali Acc: 0.850 Test Loss: 0.550 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.7047929763793945
Epoch: 28, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.479 Vali Acc: 0.878 Test Loss: 0.479 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 29 cost time: 2.5506327152252197
Epoch: 29, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.477 Vali Acc: 0.872 Test Loss: 0.477 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.587026834487915
Epoch: 30, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.555 Vali Acc: 0.850 Test Loss: 0.555 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.5468833446502686
Epoch: 31, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.546 Vali Acc: 0.867 Test Loss: 0.546 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.7472167015075684
Epoch: 32, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.480 Vali Acc: 0.872 Test Loss: 0.480 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.8397269248962402
Epoch: 33, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.474 Vali Acc: 0.878 Test Loss: 0.474 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 34 cost time: 2.9639980792999268
Epoch: 34, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.440 Vali Acc: 0.883 Test Loss: 0.440 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883329).  Saving model ...
Epoch: 35 cost time: 2.4522864818573
Epoch: 35, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.485 Vali Acc: 0.867 Test Loss: 0.485 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.3323283195495605
Epoch: 36, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.519 Vali Acc: 0.872 Test Loss: 0.519 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.6183114051818848
Epoch: 37, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.556 Vali Acc: 0.872 Test Loss: 0.556 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.970247745513916
Epoch: 38, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.504 Vali Acc: 0.872 Test Loss: 0.504 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.544328451156616
Epoch: 39, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.562 Vali Acc: 0.872 Test Loss: 0.562 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.319977045059204
Epoch: 40, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.492 Vali Acc: 0.883 Test Loss: 0.492 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.2230682373046875
Epoch: 41, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.564 Vali Acc: 0.867 Test Loss: 0.564 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.467237710952759
Epoch: 42, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.542 Vali Acc: 0.856 Test Loss: 0.542 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 2.1712257862091064
Epoch: 43, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.571 Vali Acc: 0.839 Test Loss: 0.571 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 3.0614376068115234
Epoch: 44, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.515 Vali Acc: 0.839 Test Loss: 0.515 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 1209355
model size : 6.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.511616468429565
Epoch: 1, Steps: 12 | Train Loss: 2.779 Vali Loss: 2.622 Vali Acc: 0.117 Test Loss: 2.622 Test Acc: 0.117
Validation loss decreased (inf --> -0.116640).  Saving model ...
Epoch: 2 cost time: 2.762748956680298
Epoch: 2, Steps: 12 | Train Loss: 2.638 Vali Loss: 2.455 Vali Acc: 0.278 Test Loss: 2.455 Test Acc: 0.278
Validation loss decreased (-0.116640 --> -0.277753).  Saving model ...
Epoch: 3 cost time: 2.667729377746582
Epoch: 3, Steps: 12 | Train Loss: 2.446 Vali Loss: 2.239 Vali Acc: 0.400 Test Loss: 2.239 Test Acc: 0.400
Validation loss decreased (-0.277753 --> -0.399978).  Saving model ...
Epoch: 4 cost time: 2.2684619426727295
Epoch: 4, Steps: 12 | Train Loss: 2.168 Vali Loss: 2.032 Vali Acc: 0.489 Test Loss: 2.032 Test Acc: 0.489
Validation loss decreased (-0.399978 --> -0.488869).  Saving model ...
Epoch: 5 cost time: 2.3603203296661377
Epoch: 5, Steps: 12 | Train Loss: 1.924 Vali Loss: 1.869 Vali Acc: 0.511 Test Loss: 1.869 Test Acc: 0.511
Validation loss decreased (-0.488869 --> -0.511092).  Saving model ...
Epoch: 6 cost time: 2.476839780807495
Epoch: 6, Steps: 12 | Train Loss: 1.688 Vali Loss: 1.726 Vali Acc: 0.589 Test Loss: 1.726 Test Acc: 0.589
Validation loss decreased (-0.511092 --> -0.588872).  Saving model ...
Epoch: 7 cost time: 2.202714681625366
Epoch: 7, Steps: 12 | Train Loss: 1.525 Vali Loss: 1.585 Vali Acc: 0.622 Test Loss: 1.585 Test Acc: 0.622
Validation loss decreased (-0.588872 --> -0.622206).  Saving model ...
Epoch: 8 cost time: 2.3730480670928955
Epoch: 8, Steps: 12 | Train Loss: 1.388 Vali Loss: 1.503 Vali Acc: 0.594 Test Loss: 1.503 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.472909927368164
Epoch: 9, Steps: 12 | Train Loss: 1.238 Vali Loss: 1.382 Vali Acc: 0.628 Test Loss: 1.382 Test Acc: 0.628
Validation loss decreased (-0.622206 --> -0.627764).  Saving model ...
Epoch: 10 cost time: 2.3693199157714844
Epoch: 10, Steps: 12 | Train Loss: 1.116 Vali Loss: 1.273 Vali Acc: 0.672 Test Loss: 1.273 Test Acc: 0.672
Validation loss decreased (-0.627764 --> -0.672209).  Saving model ...
Epoch: 11 cost time: 2.1882565021514893
Epoch: 11, Steps: 12 | Train Loss: 1.036 Vali Loss: 1.159 Vali Acc: 0.717 Test Loss: 1.159 Test Acc: 0.717
Validation loss decreased (-0.672209 --> -0.716655).  Saving model ...
Epoch: 12 cost time: 2.7051405906677246
Epoch: 12, Steps: 12 | Train Loss: 0.960 Vali Loss: 1.119 Vali Acc: 0.711 Test Loss: 1.119 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.818403720855713
Epoch: 13, Steps: 12 | Train Loss: 0.858 Vali Loss: 0.985 Vali Acc: 0.772 Test Loss: 0.985 Test Acc: 0.772
Validation loss decreased (-0.716655 --> -0.772212).  Saving model ...
Epoch: 14 cost time: 2.2398486137390137
Epoch: 14, Steps: 12 | Train Loss: 0.774 Vali Loss: 0.927 Vali Acc: 0.811 Test Loss: 0.927 Test Acc: 0.811
Validation loss decreased (-0.772212 --> -0.811102).  Saving model ...
Epoch: 15 cost time: 2.1450250148773193
Epoch: 15, Steps: 12 | Train Loss: 0.691 Vali Loss: 0.836 Vali Acc: 0.800 Test Loss: 0.836 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.7217981815338135
Epoch: 16, Steps: 12 | Train Loss: 0.608 Vali Loss: 0.776 Vali Acc: 0.806 Test Loss: 0.776 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.5071866512298584
Epoch: 17, Steps: 12 | Train Loss: 0.510 Vali Loss: 0.694 Vali Acc: 0.822 Test Loss: 0.694 Test Acc: 0.822
Validation loss decreased (-0.811102 --> -0.822215).  Saving model ...
Epoch: 18 cost time: 1.895383358001709
Epoch: 18, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.666 Vali Acc: 0.839 Test Loss: 0.666 Test Acc: 0.839
Validation loss decreased (-0.822215 --> -0.838882).  Saving model ...
Epoch: 19 cost time: 2.0509824752807617
Epoch: 19, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.606 Vali Acc: 0.856 Test Loss: 0.606 Test Acc: 0.856
Validation loss decreased (-0.838882 --> -0.855550).  Saving model ...
Epoch: 20 cost time: 2.5539135932922363
Epoch: 20, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.584 Vali Acc: 0.850 Test Loss: 0.584 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.0612103939056396
Epoch: 21, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.559 Vali Acc: 0.861 Test Loss: 0.559 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 22 cost time: 2.359487295150757
Epoch: 22, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.524 Vali Acc: 0.872 Test Loss: 0.524 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 23 cost time: 2.270927906036377
Epoch: 23, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.504 Vali Acc: 0.861 Test Loss: 0.504 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.775878429412842
Epoch: 24, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.577 Vali Acc: 0.856 Test Loss: 0.577 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.604616403579712
Epoch: 25, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.510 Vali Acc: 0.861 Test Loss: 0.510 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.0311672687530518
Epoch: 26, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.522 Vali Acc: 0.861 Test Loss: 0.522 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.3008575439453125
Epoch: 27, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.606 Vali Acc: 0.856 Test Loss: 0.606 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.373481273651123
Epoch: 28, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.505 Vali Acc: 0.856 Test Loss: 0.505 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.4324402809143066
Epoch: 29, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.487 Vali Acc: 0.861 Test Loss: 0.487 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.8017737865448
Epoch: 30, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.575 Vali Acc: 0.850 Test Loss: 0.575 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.38741135597229
Epoch: 31, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.523 Vali Acc: 0.850 Test Loss: 0.523 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.1822452545166016
Epoch: 32, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.503 Vali Acc: 0.878 Test Loss: 0.503 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 33 cost time: 2.2383718490600586
Epoch: 33, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.446 Vali Acc: 0.872 Test Loss: 0.446 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.3566596508026123
Epoch: 34, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.511 Vali Acc: 0.867 Test Loss: 0.511 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.4454383850097656
Epoch: 35, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.461 Vali Acc: 0.872 Test Loss: 0.461 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.386709690093994
Epoch: 36, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.535 Vali Acc: 0.839 Test Loss: 0.535 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.7999348640441895
Epoch: 37, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.520 Vali Acc: 0.872 Test Loss: 0.520 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 2.31746768951416
Epoch: 38, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.486 Vali Acc: 0.883 Test Loss: 0.486 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883328).  Saving model ...
Epoch: 39 cost time: 2.161024332046509
Epoch: 39, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.444 Vali Acc: 0.894 Test Loss: 0.444 Test Acc: 0.894
Validation loss decreased (-0.883328 --> -0.894440).  Saving model ...
Epoch: 40 cost time: 2.615354061126709
Epoch: 40, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.486 Vali Acc: 0.894 Test Loss: 0.486 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.6295199394226074
Epoch: 41, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.470 Vali Acc: 0.894 Test Loss: 0.470 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.313030242919922
Epoch: 42, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.517 Vali Acc: 0.883 Test Loss: 0.517 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.2211334705352783
Epoch: 43, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.476 Vali Acc: 0.878 Test Loss: 0.476 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 2.8118839263916016
Epoch: 44, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.454 Vali Acc: 0.900 Test Loss: 0.454 Test Acc: 0.900
Validation loss decreased (-0.894440 --> -0.899995).  Saving model ...
Epoch: 45 cost time: 2.6013824939727783
Epoch: 45, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.506 Vali Acc: 0.872 Test Loss: 0.506 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.347806453704834
Epoch: 46, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.490 Vali Acc: 0.894 Test Loss: 0.490 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.362298011779785
Epoch: 47, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.508 Vali Acc: 0.872 Test Loss: 0.508 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 2.2420012950897217
Epoch: 48, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.480 Vali Acc: 0.883 Test Loss: 0.480 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 2.1286468505859375
Epoch: 49, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.522 Vali Acc: 0.867 Test Loss: 0.522 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 2.6969172954559326
Epoch: 50, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.574 Vali Acc: 0.833 Test Loss: 0.574 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 2.3394863605499268
Epoch: 51, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.575 Vali Acc: 0.878 Test Loss: 0.575 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 2.7538650035858154
Epoch: 52, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.583 Vali Acc: 0.872 Test Loss: 0.583 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 3.10512375831604
Epoch: 53, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.631 Vali Acc: 0.883 Test Loss: 0.631 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 2.7375383377075195
Epoch: 54, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.474 Vali Acc: 0.894 Test Loss: 0.474 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 1208843
model size : 6.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.1059019565582275
Epoch: 1, Steps: 12 | Train Loss: 2.820 Vali Loss: 2.687 Vali Acc: 0.078 Test Loss: 2.687 Test Acc: 0.078
Validation loss decreased (inf --> -0.077751).  Saving model ...
Epoch: 2 cost time: 2.1784303188323975
Epoch: 2, Steps: 12 | Train Loss: 2.697 Vali Loss: 2.579 Vali Acc: 0.178 Test Loss: 2.579 Test Acc: 0.178
Validation loss decreased (-0.077751 --> -0.177752).  Saving model ...
Epoch: 3 cost time: 2.0631351470947266
Epoch: 3, Steps: 12 | Train Loss: 2.622 Vali Loss: 2.465 Vali Acc: 0.306 Test Loss: 2.465 Test Acc: 0.306
Validation loss decreased (-0.177752 --> -0.305531).  Saving model ...
Epoch: 4 cost time: 2.2922141551971436
Epoch: 4, Steps: 12 | Train Loss: 2.383 Vali Loss: 2.281 Vali Acc: 0.417 Test Loss: 2.281 Test Acc: 0.417
Validation loss decreased (-0.305531 --> -0.416644).  Saving model ...
Epoch: 5 cost time: 2.0100362300872803
Epoch: 5, Steps: 12 | Train Loss: 2.185 Vali Loss: 2.089 Vali Acc: 0.411 Test Loss: 2.089 Test Acc: 0.411
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8330357074737549
Epoch: 6, Steps: 12 | Train Loss: 1.923 Vali Loss: 1.918 Vali Acc: 0.506 Test Loss: 1.918 Test Acc: 0.506
Validation loss decreased (-0.416644 --> -0.505536).  Saving model ...
Epoch: 7 cost time: 2.0326714515686035
Epoch: 7, Steps: 12 | Train Loss: 1.728 Vali Loss: 1.750 Vali Acc: 0.556 Test Loss: 1.750 Test Acc: 0.556
Validation loss decreased (-0.505536 --> -0.555538).  Saving model ...
Epoch: 8 cost time: 1.8224680423736572
Epoch: 8, Steps: 12 | Train Loss: 1.573 Vali Loss: 1.640 Vali Acc: 0.572 Test Loss: 1.640 Test Acc: 0.572
Validation loss decreased (-0.555538 --> -0.572206).  Saving model ...
Epoch: 9 cost time: 1.7491228580474854
Epoch: 9, Steps: 12 | Train Loss: 1.447 Vali Loss: 1.518 Vali Acc: 0.628 Test Loss: 1.518 Test Acc: 0.628
Validation loss decreased (-0.572206 --> -0.627763).  Saving model ...
Epoch: 10 cost time: 2.0892844200134277
Epoch: 10, Steps: 12 | Train Loss: 1.322 Vali Loss: 1.418 Vali Acc: 0.633 Test Loss: 1.418 Test Acc: 0.633
Validation loss decreased (-0.627763 --> -0.633319).  Saving model ...
Epoch: 11 cost time: 1.9591567516326904
Epoch: 11, Steps: 12 | Train Loss: 1.230 Vali Loss: 1.311 Vali Acc: 0.672 Test Loss: 1.311 Test Acc: 0.672
Validation loss decreased (-0.633319 --> -0.672209).  Saving model ...
Epoch: 12 cost time: 2.0313808917999268
Epoch: 12, Steps: 12 | Train Loss: 1.085 Vali Loss: 1.249 Vali Acc: 0.672 Test Loss: 1.249 Test Acc: 0.672
Validation loss decreased (-0.672209 --> -0.672210).  Saving model ...
Epoch: 13 cost time: 2.0362091064453125
Epoch: 13, Steps: 12 | Train Loss: 0.988 Vali Loss: 1.114 Vali Acc: 0.728 Test Loss: 1.114 Test Acc: 0.728
Validation loss decreased (-0.672210 --> -0.727767).  Saving model ...
Epoch: 14 cost time: 1.77573561668396
Epoch: 14, Steps: 12 | Train Loss: 0.879 Vali Loss: 1.026 Vali Acc: 0.717 Test Loss: 1.026 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9567830562591553
Epoch: 15, Steps: 12 | Train Loss: 0.812 Vali Loss: 0.965 Vali Acc: 0.711 Test Loss: 0.965 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.108713388442993
Epoch: 16, Steps: 12 | Train Loss: 0.793 Vali Loss: 0.890 Vali Acc: 0.789 Test Loss: 0.890 Test Acc: 0.789
Validation loss decreased (-0.727767 --> -0.788880).  Saving model ...
Epoch: 17 cost time: 2.1979074478149414
Epoch: 17, Steps: 12 | Train Loss: 0.646 Vali Loss: 0.819 Vali Acc: 0.794 Test Loss: 0.819 Test Acc: 0.794
Validation loss decreased (-0.788880 --> -0.794436).  Saving model ...
Epoch: 18 cost time: 2.195596218109131
Epoch: 18, Steps: 12 | Train Loss: 0.576 Vali Loss: 0.834 Vali Acc: 0.744 Test Loss: 0.834 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.160989284515381
Epoch: 19, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.712 Vali Acc: 0.817 Test Loss: 0.712 Test Acc: 0.817
Validation loss decreased (-0.794436 --> -0.816660).  Saving model ...
Epoch: 20 cost time: 2.338700532913208
Epoch: 20, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.664 Vali Acc: 0.828 Test Loss: 0.664 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827771).  Saving model ...
Epoch: 21 cost time: 2.0545129776000977
Epoch: 21, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.638 Vali Acc: 0.828 Test Loss: 0.638 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827771).  Saving model ...
Epoch: 22 cost time: 2.4935641288757324
Epoch: 22, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.599 Vali Acc: 0.822 Test Loss: 0.599 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.442530870437622
Epoch: 23, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.587 Vali Acc: 0.844 Test Loss: 0.587 Test Acc: 0.844
Validation loss decreased (-0.827771 --> -0.844439).  Saving model ...
Epoch: 24 cost time: 2.016960859298706
Epoch: 24, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.536 Vali Acc: 0.861 Test Loss: 0.536 Test Acc: 0.861
Validation loss decreased (-0.844439 --> -0.861106).  Saving model ...
Epoch: 25 cost time: 2.3691775798797607
Epoch: 25, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.546 Vali Acc: 0.828 Test Loss: 0.546 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.123060464859009
Epoch: 26, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.559 Vali Acc: 0.856 Test Loss: 0.559 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8823599815368652
Epoch: 27, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.570 Vali Acc: 0.833 Test Loss: 0.570 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.470623254776001
Epoch: 28, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.501 Vali Acc: 0.867 Test Loss: 0.501 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866662).  Saving model ...
Epoch: 29 cost time: 2.344792604446411
Epoch: 29, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.482 Vali Acc: 0.850 Test Loss: 0.482 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.0404884815216064
Epoch: 30, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.465 Vali Acc: 0.867 Test Loss: 0.465 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 31 cost time: 2.459892749786377
Epoch: 31, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.557 Vali Acc: 0.844 Test Loss: 0.557 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.9783930778503418
Epoch: 32, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.511 Vali Acc: 0.861 Test Loss: 0.511 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.0852811336517334
Epoch: 33, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.467 Vali Acc: 0.872 Test Loss: 0.467 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872218).  Saving model ...
Epoch: 34 cost time: 2.068035125732422
Epoch: 34, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.492 Vali Acc: 0.867 Test Loss: 0.492 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.2641921043395996
Epoch: 35, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.505 Vali Acc: 0.861 Test Loss: 0.505 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.179733991622925
Epoch: 36, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.439 Vali Acc: 0.872 Test Loss: 0.439 Test Acc: 0.872
Validation loss decreased (-0.872218 --> -0.872218).  Saving model ...
Epoch: 37 cost time: 1.898308277130127
Epoch: 37, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.524 Vali Acc: 0.861 Test Loss: 0.524 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.1187572479248047
Epoch: 38, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.534 Vali Acc: 0.856 Test Loss: 0.534 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.1305031776428223
Epoch: 39, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.620 Vali Acc: 0.839 Test Loss: 0.620 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.0276548862457275
Epoch: 40, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.490 Vali Acc: 0.856 Test Loss: 0.490 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.002667188644409
Epoch: 41, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.535 Vali Acc: 0.872 Test Loss: 0.535 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 2.1825003623962402
Epoch: 42, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.552 Vali Acc: 0.878 Test Loss: 0.552 Test Acc: 0.878
Validation loss decreased (-0.872218 --> -0.877772).  Saving model ...
Epoch: 43 cost time: 1.8200438022613525
Epoch: 43, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.542 Vali Acc: 0.867 Test Loss: 0.542 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.222048759460449
Epoch: 44, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.586 Vali Acc: 0.867 Test Loss: 0.586 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.0457961559295654
Epoch: 45, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.550 Vali Acc: 0.872 Test Loss: 0.550 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 2.099024772644043
Epoch: 46, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.556 Vali Acc: 0.883 Test Loss: 0.556 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883328).  Saving model ...
Epoch: 47 cost time: 1.9611263275146484
Epoch: 47, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.563 Vali Acc: 0.872 Test Loss: 0.563 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.9907357692718506
Epoch: 48, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.577 Vali Acc: 0.867 Test Loss: 0.577 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.9294743537902832
Epoch: 49, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.539 Vali Acc: 0.883 Test Loss: 0.539 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883328).  Saving model ...
Epoch: 50 cost time: 2.0492238998413086
Epoch: 50, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.553 Vali Acc: 0.889 Test Loss: 0.553 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888883).  Saving model ...
Epoch: 51 cost time: 2.061387538909912
Epoch: 51, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.488 Vali Acc: 0.889 Test Loss: 0.488 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888884).  Saving model ...
Epoch: 52 cost time: 2.2677958011627197
Epoch: 52, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.599 Vali Acc: 0.883 Test Loss: 0.599 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 2.8724331855773926
Epoch: 53, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.666 Vali Acc: 0.850 Test Loss: 0.666 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 2.457110643386841
Epoch: 54, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.545 Vali Acc: 0.861 Test Loss: 0.545 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 2.8606276512145996
Epoch: 55, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.608 Vali Acc: 0.850 Test Loss: 0.608 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 2.7597482204437256
Epoch: 56, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.687 Vali Acc: 0.861 Test Loss: 0.687 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 2.1504569053649902
Epoch: 57, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.635 Vali Acc: 0.878 Test Loss: 0.635 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 2.169781446456909
Epoch: 58, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.597 Vali Acc: 0.878 Test Loss: 0.597 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 2.37302827835083
Epoch: 59, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.532 Vali Acc: 0.883 Test Loss: 0.532 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 2.580599069595337
Epoch: 60, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.590 Vali Acc: 0.883 Test Loss: 0.590 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 2.9796557426452637
Epoch: 61, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.591 Vali Acc: 0.872 Test Loss: 0.591 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 913163
model size : 4.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.6169774532318115
Epoch: 1, Steps: 12 | Train Loss: 2.988 Vali Loss: 2.810 Vali Acc: 0.028 Test Loss: 2.810 Test Acc: 0.028
Validation loss decreased (inf --> -0.027750).  Saving model ...
Epoch: 2 cost time: 2.5677342414855957
Epoch: 2, Steps: 12 | Train Loss: 2.765 Vali Loss: 2.657 Vali Acc: 0.089 Test Loss: 2.657 Test Acc: 0.089
Validation loss decreased (-0.027750 --> -0.088862).  Saving model ...
Epoch: 3 cost time: 1.9193203449249268
Epoch: 3, Steps: 12 | Train Loss: 2.639 Vali Loss: 2.536 Vali Acc: 0.150 Test Loss: 2.536 Test Acc: 0.150
Validation loss decreased (-0.088862 --> -0.149975).  Saving model ...
Epoch: 4 cost time: 2.7334961891174316
Epoch: 4, Steps: 12 | Train Loss: 2.457 Vali Loss: 2.335 Vali Acc: 0.228 Test Loss: 2.335 Test Acc: 0.228
Validation loss decreased (-0.149975 --> -0.227754).  Saving model ...
Epoch: 5 cost time: 2.452366828918457
Epoch: 5, Steps: 12 | Train Loss: 2.220 Vali Loss: 2.150 Vali Acc: 0.378 Test Loss: 2.150 Test Acc: 0.378
Validation loss decreased (-0.227754 --> -0.377756).  Saving model ...
Epoch: 6 cost time: 2.0169763565063477
Epoch: 6, Steps: 12 | Train Loss: 2.010 Vali Loss: 1.961 Vali Acc: 0.494 Test Loss: 1.961 Test Acc: 0.494
Validation loss decreased (-0.377756 --> -0.494425).  Saving model ...
Epoch: 7 cost time: 2.292088031768799
Epoch: 7, Steps: 12 | Train Loss: 1.790 Vali Loss: 1.807 Vali Acc: 0.533 Test Loss: 1.807 Test Acc: 0.533
Validation loss decreased (-0.494425 --> -0.533315).  Saving model ...
Epoch: 8 cost time: 2.1670234203338623
Epoch: 8, Steps: 12 | Train Loss: 1.681 Vali Loss: 1.661 Vali Acc: 0.561 Test Loss: 1.661 Test Acc: 0.561
Validation loss decreased (-0.533315 --> -0.561095).  Saving model ...
Epoch: 9 cost time: 2.476550340652466
Epoch: 9, Steps: 12 | Train Loss: 1.490 Vali Loss: 1.525 Vali Acc: 0.606 Test Loss: 1.525 Test Acc: 0.606
Validation loss decreased (-0.561095 --> -0.605540).  Saving model ...
Epoch: 10 cost time: 2.3539888858795166
Epoch: 10, Steps: 12 | Train Loss: 1.347 Vali Loss: 1.407 Vali Acc: 0.644 Test Loss: 1.407 Test Acc: 0.644
Validation loss decreased (-0.605540 --> -0.644430).  Saving model ...
Epoch: 11 cost time: 2.346073627471924
Epoch: 11, Steps: 12 | Train Loss: 1.251 Vali Loss: 1.334 Vali Acc: 0.672 Test Loss: 1.334 Test Acc: 0.672
Validation loss decreased (-0.644430 --> -0.672209).  Saving model ...
Epoch: 12 cost time: 2.1292293071746826
Epoch: 12, Steps: 12 | Train Loss: 1.176 Vali Loss: 1.236 Vali Acc: 0.689 Test Loss: 1.236 Test Acc: 0.689
Validation loss decreased (-0.672209 --> -0.688877).  Saving model ...
Epoch: 13 cost time: 2.5189507007598877
Epoch: 13, Steps: 12 | Train Loss: 1.050 Vali Loss: 1.131 Vali Acc: 0.733 Test Loss: 1.131 Test Acc: 0.733
Validation loss decreased (-0.688877 --> -0.733322).  Saving model ...
Epoch: 14 cost time: 2.207308530807495
Epoch: 14, Steps: 12 | Train Loss: 1.008 Vali Loss: 1.065 Vali Acc: 0.744 Test Loss: 1.065 Test Acc: 0.744
Validation loss decreased (-0.733322 --> -0.744434).  Saving model ...
Epoch: 15 cost time: 2.784320116043091
Epoch: 15, Steps: 12 | Train Loss: 0.870 Vali Loss: 0.978 Vali Acc: 0.756 Test Loss: 0.978 Test Acc: 0.756
Validation loss decreased (-0.744434 --> -0.755546).  Saving model ...
Epoch: 16 cost time: 2.534383535385132
Epoch: 16, Steps: 12 | Train Loss: 0.814 Vali Loss: 0.947 Vali Acc: 0.783 Test Loss: 0.947 Test Acc: 0.783
Validation loss decreased (-0.755546 --> -0.783324).  Saving model ...
Epoch: 17 cost time: 2.426271915435791
Epoch: 17, Steps: 12 | Train Loss: 0.707 Vali Loss: 0.865 Vali Acc: 0.806 Test Loss: 0.865 Test Acc: 0.806
Validation loss decreased (-0.783324 --> -0.805547).  Saving model ...
Epoch: 18 cost time: 2.029343605041504
Epoch: 18, Steps: 12 | Train Loss: 0.679 Vali Loss: 0.795 Vali Acc: 0.833 Test Loss: 0.795 Test Acc: 0.833
Validation loss decreased (-0.805547 --> -0.833325).  Saving model ...
Epoch: 19 cost time: 2.559910297393799
Epoch: 19, Steps: 12 | Train Loss: 0.575 Vali Loss: 0.731 Vali Acc: 0.844 Test Loss: 0.731 Test Acc: 0.844
Validation loss decreased (-0.833325 --> -0.844437).  Saving model ...
Epoch: 20 cost time: 2.67000150680542
Epoch: 20, Steps: 12 | Train Loss: 0.511 Vali Loss: 0.727 Vali Acc: 0.833 Test Loss: 0.727 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.024320602416992
Epoch: 21, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.651 Vali Acc: 0.839 Test Loss: 0.651 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.5491983890533447
Epoch: 22, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.615 Vali Acc: 0.850 Test Loss: 0.615 Test Acc: 0.850
Validation loss decreased (-0.844437 --> -0.849994).  Saving model ...
Epoch: 23 cost time: 2.5667262077331543
Epoch: 23, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.604 Vali Acc: 0.833 Test Loss: 0.604 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.414720296859741
Epoch: 24, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.608 Vali Acc: 0.844 Test Loss: 0.608 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.6037557125091553
Epoch: 25, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.557 Vali Acc: 0.861 Test Loss: 0.557 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861106).  Saving model ...
Epoch: 26 cost time: 2.343447208404541
Epoch: 26, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.565 Vali Acc: 0.883 Test Loss: 0.565 Test Acc: 0.883
Validation loss decreased (-0.861106 --> -0.883328).  Saving model ...
Epoch: 27 cost time: 2.9852821826934814
Epoch: 27, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.588 Vali Acc: 0.878 Test Loss: 0.588 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.7734737396240234
Epoch: 28, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.535 Vali Acc: 0.883 Test Loss: 0.535 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883328).  Saving model ...
Epoch: 29 cost time: 2.673074722290039
Epoch: 29, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.586 Vali Acc: 0.856 Test Loss: 0.586 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.5204217433929443
Epoch: 30, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.564 Vali Acc: 0.889 Test Loss: 0.564 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888883).  Saving model ...
Epoch: 31 cost time: 3.2110989093780518
Epoch: 31, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.502 Vali Acc: 0.867 Test Loss: 0.502 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.420132637023926
Epoch: 32, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.550 Vali Acc: 0.889 Test Loss: 0.550 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888883).  Saving model ...
Epoch: 33 cost time: 2.456472873687744
Epoch: 33, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.539 Vali Acc: 0.894 Test Loss: 0.539 Test Acc: 0.894
Validation loss decreased (-0.888883 --> -0.894439).  Saving model ...
Epoch: 34 cost time: 2.8524718284606934
Epoch: 34, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.529 Vali Acc: 0.878 Test Loss: 0.529 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.603562831878662
Epoch: 35, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.604 Vali Acc: 0.883 Test Loss: 0.604 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.3882832527160645
Epoch: 36, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.522 Vali Acc: 0.889 Test Loss: 0.522 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.3296008110046387
Epoch: 37, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.571 Vali Acc: 0.894 Test Loss: 0.571 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.481302261352539
Epoch: 38, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.508 Vali Acc: 0.872 Test Loss: 0.508 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.325350761413574
Epoch: 39, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.575 Vali Acc: 0.889 Test Loss: 0.575 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.4080748558044434
Epoch: 40, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.640 Vali Acc: 0.878 Test Loss: 0.640 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.3765299320220947
Epoch: 41, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.548 Vali Acc: 0.883 Test Loss: 0.548 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.4592514038085938
Epoch: 42, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.693 Vali Acc: 0.861 Test Loss: 0.693 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.6049041748046875
Epoch: 43, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.565 Vali Acc: 0.900 Test Loss: 0.565 Test Acc: 0.900
Validation loss decreased (-0.894439 --> -0.899994).  Saving model ...
Epoch: 44 cost time: 2.680263042449951
Epoch: 44, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.528 Vali Acc: 0.889 Test Loss: 0.528 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.7446930408477783
Epoch: 45, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.577 Vali Acc: 0.894 Test Loss: 0.577 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.699140787124634
Epoch: 46, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.610 Vali Acc: 0.894 Test Loss: 0.610 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.445554256439209
Epoch: 47, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.589 Vali Acc: 0.878 Test Loss: 0.589 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 2.511258840560913
Epoch: 48, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.584 Vali Acc: 0.883 Test Loss: 0.584 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 2.4568822383880615
Epoch: 49, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.594 Vali Acc: 0.889 Test Loss: 0.594 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 3.1817033290863037
Epoch: 50, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.620 Vali Acc: 0.883 Test Loss: 0.620 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 2.3644485473632812
Epoch: 51, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.597 Vali Acc: 0.889 Test Loss: 0.597 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 2.27801251411438
Epoch: 52, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.563 Vali Acc: 0.889 Test Loss: 0.563 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 2.2533071041107178
Epoch: 53, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.582 Vali Acc: 0.889 Test Loss: 0.582 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 912651
model size : 4.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.621933460235596
Epoch: 1, Steps: 12 | Train Loss: 2.795 Vali Loss: 2.749 Vali Acc: 0.094 Test Loss: 2.749 Test Acc: 0.094
Validation loss decreased (inf --> -0.094417).  Saving model ...
Epoch: 2 cost time: 2.3680970668792725
Epoch: 2, Steps: 12 | Train Loss: 2.643 Vali Loss: 2.595 Vali Acc: 0.156 Test Loss: 2.595 Test Acc: 0.156
Validation loss decreased (-0.094417 --> -0.155530).  Saving model ...
Epoch: 3 cost time: 2.1927900314331055
Epoch: 3, Steps: 12 | Train Loss: 2.558 Vali Loss: 2.421 Vali Acc: 0.283 Test Loss: 2.421 Test Acc: 0.283
Validation loss decreased (-0.155530 --> -0.283309).  Saving model ...
Epoch: 4 cost time: 2.7278597354888916
Epoch: 4, Steps: 12 | Train Loss: 2.308 Vali Loss: 2.220 Vali Acc: 0.344 Test Loss: 2.220 Test Acc: 0.344
Validation loss decreased (-0.283309 --> -0.344422).  Saving model ...
Epoch: 5 cost time: 2.5515785217285156
Epoch: 5, Steps: 12 | Train Loss: 2.122 Vali Loss: 2.005 Vali Acc: 0.433 Test Loss: 2.005 Test Acc: 0.433
Validation loss decreased (-0.344422 --> -0.433313).  Saving model ...
Epoch: 6 cost time: 2.338730573654175
Epoch: 6, Steps: 12 | Train Loss: 1.914 Vali Loss: 1.869 Vali Acc: 0.506 Test Loss: 1.869 Test Acc: 0.506
Validation loss decreased (-0.433313 --> -0.505537).  Saving model ...
Epoch: 7 cost time: 2.014319658279419
Epoch: 7, Steps: 12 | Train Loss: 1.766 Vali Loss: 1.749 Vali Acc: 0.522 Test Loss: 1.749 Test Acc: 0.522
Validation loss decreased (-0.505537 --> -0.522205).  Saving model ...
Epoch: 8 cost time: 2.6067607402801514
Epoch: 8, Steps: 12 | Train Loss: 1.581 Vali Loss: 1.605 Vali Acc: 0.617 Test Loss: 1.605 Test Acc: 0.617
Validation loss decreased (-0.522205 --> -0.616651).  Saving model ...
Epoch: 9 cost time: 2.708308458328247
Epoch: 9, Steps: 12 | Train Loss: 1.469 Vali Loss: 1.489 Vali Acc: 0.617 Test Loss: 1.489 Test Acc: 0.617
Validation loss decreased (-0.616651 --> -0.616652).  Saving model ...
Epoch: 10 cost time: 2.35830020904541
Epoch: 10, Steps: 12 | Train Loss: 1.348 Vali Loss: 1.428 Vali Acc: 0.678 Test Loss: 1.428 Test Acc: 0.678
Validation loss decreased (-0.616652 --> -0.677763).  Saving model ...
Epoch: 11 cost time: 2.639913320541382
Epoch: 11, Steps: 12 | Train Loss: 1.233 Vali Loss: 1.306 Vali Acc: 0.700 Test Loss: 1.306 Test Acc: 0.700
Validation loss decreased (-0.677763 --> -0.699987).  Saving model ...
Epoch: 12 cost time: 2.1964282989501953
Epoch: 12, Steps: 12 | Train Loss: 1.118 Vali Loss: 1.251 Vali Acc: 0.717 Test Loss: 1.251 Test Acc: 0.717
Validation loss decreased (-0.699987 --> -0.716654).  Saving model ...
Epoch: 13 cost time: 2.5403151512145996
Epoch: 13, Steps: 12 | Train Loss: 1.017 Vali Loss: 1.114 Vali Acc: 0.744 Test Loss: 1.114 Test Acc: 0.744
Validation loss decreased (-0.716654 --> -0.744433).  Saving model ...
Epoch: 14 cost time: 2.054616928100586
Epoch: 14, Steps: 12 | Train Loss: 0.898 Vali Loss: 1.043 Vali Acc: 0.739 Test Loss: 1.043 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.5064215660095215
Epoch: 15, Steps: 12 | Train Loss: 0.818 Vali Loss: 0.949 Vali Acc: 0.778 Test Loss: 0.949 Test Acc: 0.778
Validation loss decreased (-0.744433 --> -0.777768).  Saving model ...
Epoch: 16 cost time: 1.9679310321807861
Epoch: 16, Steps: 12 | Train Loss: 0.799 Vali Loss: 0.856 Vali Acc: 0.800 Test Loss: 0.856 Test Acc: 0.800
Validation loss decreased (-0.777768 --> -0.799991).  Saving model ...
Epoch: 17 cost time: 2.46919846534729
Epoch: 17, Steps: 12 | Train Loss: 0.657 Vali Loss: 0.805 Vali Acc: 0.806 Test Loss: 0.805 Test Acc: 0.806
Validation loss decreased (-0.799991 --> -0.805548).  Saving model ...
Epoch: 18 cost time: 2.053917646408081
Epoch: 18, Steps: 12 | Train Loss: 0.568 Vali Loss: 0.763 Vali Acc: 0.817 Test Loss: 0.763 Test Acc: 0.817
Validation loss decreased (-0.805548 --> -0.816659).  Saving model ...
Epoch: 19 cost time: 2.350820541381836
Epoch: 19, Steps: 12 | Train Loss: 0.545 Vali Loss: 0.767 Vali Acc: 0.811 Test Loss: 0.767 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.4140474796295166
Epoch: 20, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.715 Vali Acc: 0.817 Test Loss: 0.715 Test Acc: 0.817
Validation loss decreased (-0.816659 --> -0.816660).  Saving model ...
Epoch: 21 cost time: 2.1535003185272217
Epoch: 21, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.648 Vali Acc: 0.856 Test Loss: 0.648 Test Acc: 0.856
Validation loss decreased (-0.816660 --> -0.855549).  Saving model ...
Epoch: 22 cost time: 2.3194098472595215
Epoch: 22, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.659 Vali Acc: 0.844 Test Loss: 0.659 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.5121891498565674
Epoch: 23, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.572 Vali Acc: 0.861 Test Loss: 0.572 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 24 cost time: 2.1415672302246094
Epoch: 24, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.603 Vali Acc: 0.861 Test Loss: 0.603 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.4016640186309814
Epoch: 25, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.581 Vali Acc: 0.856 Test Loss: 0.581 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.5161142349243164
Epoch: 26, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.615 Vali Acc: 0.856 Test Loss: 0.615 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.156466245651245
Epoch: 27, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.555 Vali Acc: 0.844 Test Loss: 0.555 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.3308887481689453
Epoch: 28, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.558 Vali Acc: 0.861 Test Loss: 0.558 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861106).  Saving model ...
Epoch: 29 cost time: 2.313627004623413
Epoch: 29, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.542 Vali Acc: 0.856 Test Loss: 0.542 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.3186771869659424
Epoch: 30, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.543 Vali Acc: 0.878 Test Loss: 0.543 Test Acc: 0.878
Validation loss decreased (-0.861106 --> -0.877772).  Saving model ...
Epoch: 31 cost time: 2.1625001430511475
Epoch: 31, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.566 Vali Acc: 0.850 Test Loss: 0.566 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.9250297546386719
Epoch: 32, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.558 Vali Acc: 0.872 Test Loss: 0.558 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.497389793395996
Epoch: 33, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.537 Vali Acc: 0.878 Test Loss: 0.537 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 34 cost time: 2.1488633155822754
Epoch: 34, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.530 Vali Acc: 0.867 Test Loss: 0.530 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.218893527984619
Epoch: 35, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.548 Vali Acc: 0.889 Test Loss: 0.548 Test Acc: 0.889
Validation loss decreased (-0.877772 --> -0.888883).  Saving model ...
Epoch: 36 cost time: 2.058568239212036
Epoch: 36, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.505 Vali Acc: 0.883 Test Loss: 0.505 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.0010294914245605
Epoch: 37, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.526 Vali Acc: 0.883 Test Loss: 0.526 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.2838120460510254
Epoch: 38, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.562 Vali Acc: 0.867 Test Loss: 0.562 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.4569807052612305
Epoch: 39, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.607 Vali Acc: 0.867 Test Loss: 0.607 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.064768075942993
Epoch: 40, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.533 Vali Acc: 0.878 Test Loss: 0.533 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.5815036296844482
Epoch: 41, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.551 Vali Acc: 0.872 Test Loss: 0.551 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 2.5115737915039062
Epoch: 42, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.500 Vali Acc: 0.883 Test Loss: 0.500 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 2.2073395252227783
Epoch: 43, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.601 Vali Acc: 0.872 Test Loss: 0.601 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 2.596625566482544
Epoch: 44, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.539 Vali Acc: 0.894 Test Loss: 0.539 Test Acc: 0.894
Validation loss decreased (-0.888883 --> -0.894439).  Saving model ...
Epoch: 45 cost time: 2.503394365310669
Epoch: 45, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.612 Vali Acc: 0.872 Test Loss: 0.612 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.1683061122894287
Epoch: 46, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.536 Vali Acc: 0.883 Test Loss: 0.536 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.4667959213256836
Epoch: 47, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.568 Vali Acc: 0.889 Test Loss: 0.568 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.9644949436187744
Epoch: 48, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.566 Vali Acc: 0.900 Test Loss: 0.566 Test Acc: 0.900
Validation loss decreased (-0.894439 --> -0.899994).  Saving model ...
Epoch: 49 cost time: 2.3931236267089844
Epoch: 49, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.543 Vali Acc: 0.889 Test Loss: 0.543 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 2.2672736644744873
Epoch: 50, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.601 Vali Acc: 0.878 Test Loss: 0.601 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 2.412583589553833
Epoch: 51, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.576 Vali Acc: 0.889 Test Loss: 0.576 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 2.6533966064453125
Epoch: 52, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.617 Vali Acc: 0.889 Test Loss: 0.617 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 2.451953649520874
Epoch: 53, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.572 Vali Acc: 0.889 Test Loss: 0.572 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 2.199043035507202
Epoch: 54, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.538 Vali Acc: 0.894 Test Loss: 0.538 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 2.3381805419921875
Epoch: 55, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.587 Vali Acc: 0.878 Test Loss: 0.587 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 2.3714349269866943
Epoch: 56, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.586 Vali Acc: 0.883 Test Loss: 0.586 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 2.3097362518310547
Epoch: 57, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.576 Vali Acc: 0.894 Test Loss: 0.576 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 2.2014503479003906
Epoch: 58, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.598 Vali Acc: 0.889 Test Loss: 0.598 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 912139
model size : 4.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.578296422958374
Epoch: 1, Steps: 12 | Train Loss: 2.844 Vali Loss: 2.760 Vali Acc: 0.072 Test Loss: 2.760 Test Acc: 0.072
Validation loss decreased (inf --> -0.072195).  Saving model ...
Epoch: 2 cost time: 1.9509365558624268
Epoch: 2, Steps: 12 | Train Loss: 2.724 Vali Loss: 2.643 Vali Acc: 0.133 Test Loss: 2.643 Test Acc: 0.133
Validation loss decreased (-0.072195 --> -0.133307).  Saving model ...
Epoch: 3 cost time: 1.897400140762329
Epoch: 3, Steps: 12 | Train Loss: 2.630 Vali Loss: 2.546 Vali Acc: 0.222 Test Loss: 2.546 Test Acc: 0.222
Validation loss decreased (-0.133307 --> -0.222197).  Saving model ...
Epoch: 4 cost time: 1.9064438343048096
Epoch: 4, Steps: 12 | Train Loss: 2.475 Vali Loss: 2.405 Vali Acc: 0.306 Test Loss: 2.405 Test Acc: 0.306
Validation loss decreased (-0.222197 --> -0.305532).  Saving model ...
Epoch: 5 cost time: 2.5545456409454346
Epoch: 5, Steps: 12 | Train Loss: 2.332 Vali Loss: 2.245 Vali Acc: 0.372 Test Loss: 2.245 Test Acc: 0.372
Validation loss decreased (-0.305532 --> -0.372200).  Saving model ...
Epoch: 6 cost time: 2.211569309234619
Epoch: 6, Steps: 12 | Train Loss: 2.134 Vali Loss: 2.087 Vali Acc: 0.383 Test Loss: 2.087 Test Acc: 0.383
Validation loss decreased (-0.372200 --> -0.383312).  Saving model ...
Epoch: 7 cost time: 1.935302972793579
Epoch: 7, Steps: 12 | Train Loss: 1.923 Vali Loss: 1.890 Vali Acc: 0.422 Test Loss: 1.890 Test Acc: 0.422
Validation loss decreased (-0.383312 --> -0.422203).  Saving model ...
Epoch: 8 cost time: 2.4925692081451416
Epoch: 8, Steps: 12 | Train Loss: 1.753 Vali Loss: 1.724 Vali Acc: 0.561 Test Loss: 1.724 Test Acc: 0.561
Validation loss decreased (-0.422203 --> -0.561094).  Saving model ...
Epoch: 9 cost time: 2.2287864685058594
Epoch: 9, Steps: 12 | Train Loss: 1.543 Vali Loss: 1.565 Vali Acc: 0.606 Test Loss: 1.565 Test Acc: 0.606
Validation loss decreased (-0.561094 --> -0.605540).  Saving model ...
Epoch: 10 cost time: 2.5798966884613037
Epoch: 10, Steps: 12 | Train Loss: 1.406 Vali Loss: 1.437 Vali Acc: 0.633 Test Loss: 1.437 Test Acc: 0.633
Validation loss decreased (-0.605540 --> -0.633319).  Saving model ...
Epoch: 11 cost time: 2.620443105697632
Epoch: 11, Steps: 12 | Train Loss: 1.308 Vali Loss: 1.305 Vali Acc: 0.678 Test Loss: 1.305 Test Acc: 0.678
Validation loss decreased (-0.633319 --> -0.677765).  Saving model ...
Epoch: 12 cost time: 2.6456589698791504
Epoch: 12, Steps: 12 | Train Loss: 1.121 Vali Loss: 1.197 Vali Acc: 0.733 Test Loss: 1.197 Test Acc: 0.733
Validation loss decreased (-0.677765 --> -0.733321).  Saving model ...
Epoch: 13 cost time: 2.2224674224853516
Epoch: 13, Steps: 12 | Train Loss: 1.056 Vali Loss: 1.115 Vali Acc: 0.750 Test Loss: 1.115 Test Acc: 0.750
Validation loss decreased (-0.733321 --> -0.749989).  Saving model ...
Epoch: 14 cost time: 2.0262811183929443
Epoch: 14, Steps: 12 | Train Loss: 0.914 Vali Loss: 1.015 Vali Acc: 0.767 Test Loss: 1.015 Test Acc: 0.767
Validation loss decreased (-0.749989 --> -0.766657).  Saving model ...
Epoch: 15 cost time: 2.093177080154419
Epoch: 15, Steps: 12 | Train Loss: 0.814 Vali Loss: 0.938 Vali Acc: 0.800 Test Loss: 0.938 Test Acc: 0.800
Validation loss decreased (-0.766657 --> -0.799991).  Saving model ...
Epoch: 16 cost time: 2.3959484100341797
Epoch: 16, Steps: 12 | Train Loss: 0.749 Vali Loss: 0.912 Vali Acc: 0.789 Test Loss: 0.912 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2563276290893555
Epoch: 17, Steps: 12 | Train Loss: 0.688 Vali Loss: 0.800 Vali Acc: 0.839 Test Loss: 0.800 Test Acc: 0.839
Validation loss decreased (-0.799991 --> -0.838881).  Saving model ...
Epoch: 18 cost time: 1.929065465927124
Epoch: 18, Steps: 12 | Train Loss: 0.649 Vali Loss: 0.761 Vali Acc: 0.822 Test Loss: 0.761 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.044492244720459
Epoch: 19, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.735 Vali Acc: 0.811 Test Loss: 0.735 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.421881914138794
Epoch: 20, Steps: 12 | Train Loss: 0.528 Vali Loss: 0.692 Vali Acc: 0.850 Test Loss: 0.692 Test Acc: 0.850
Validation loss decreased (-0.838881 --> -0.849993).  Saving model ...
Epoch: 21 cost time: 2.901393413543701
Epoch: 21, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.636 Vali Acc: 0.856 Test Loss: 0.636 Test Acc: 0.856
Validation loss decreased (-0.849993 --> -0.855549).  Saving model ...
Epoch: 22 cost time: 2.0498530864715576
Epoch: 22, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.626 Vali Acc: 0.839 Test Loss: 0.626 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.241933822631836
Epoch: 23, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.598 Vali Acc: 0.867 Test Loss: 0.598 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866661).  Saving model ...
Epoch: 24 cost time: 1.9162445068359375
Epoch: 24, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.524 Vali Acc: 0.872 Test Loss: 0.524 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 25 cost time: 2.4371120929718018
Epoch: 25, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.519 Vali Acc: 0.861 Test Loss: 0.519 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.4667813777923584
Epoch: 26, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.495 Vali Acc: 0.878 Test Loss: 0.495 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 27 cost time: 2.3010458946228027
Epoch: 27, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.524 Vali Acc: 0.850 Test Loss: 0.524 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.586042642593384
Epoch: 28, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.502 Vali Acc: 0.861 Test Loss: 0.502 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.259768009185791
Epoch: 29, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.489 Vali Acc: 0.867 Test Loss: 0.489 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.1158714294433594
Epoch: 30, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.471 Vali Acc: 0.878 Test Loss: 0.471 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 31 cost time: 2.5105574131011963
Epoch: 31, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.521 Vali Acc: 0.867 Test Loss: 0.521 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.170240879058838
Epoch: 32, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.509 Vali Acc: 0.856 Test Loss: 0.509 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.290768623352051
Epoch: 33, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.469 Vali Acc: 0.878 Test Loss: 0.469 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 34 cost time: 2.515054702758789
Epoch: 34, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.509 Vali Acc: 0.844 Test Loss: 0.509 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.174201726913452
Epoch: 35, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.510 Vali Acc: 0.878 Test Loss: 0.510 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.1364872455596924
Epoch: 36, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.487 Vali Acc: 0.861 Test Loss: 0.487 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.2630577087402344
Epoch: 37, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.443 Vali Acc: 0.889 Test Loss: 0.443 Test Acc: 0.889
Validation loss decreased (-0.877773 --> -0.888884).  Saving model ...
Epoch: 38 cost time: 2.2219338417053223
Epoch: 38, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.510 Vali Acc: 0.861 Test Loss: 0.510 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.469414710998535
Epoch: 39, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.521 Vali Acc: 0.856 Test Loss: 0.521 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.2291500568389893
Epoch: 40, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.446 Vali Acc: 0.883 Test Loss: 0.446 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.274641752243042
Epoch: 41, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.486 Vali Acc: 0.872 Test Loss: 0.486 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.631023645401001
Epoch: 42, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.517 Vali Acc: 0.889 Test Loss: 0.517 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 2.2468783855438232
Epoch: 43, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.522 Vali Acc: 0.883 Test Loss: 0.522 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 2.311487913131714
Epoch: 44, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.595 Vali Acc: 0.878 Test Loss: 0.595 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 2.890803575515747
Epoch: 45, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.540 Vali Acc: 0.872 Test Loss: 0.540 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 2.64986252784729
Epoch: 46, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.565 Vali Acc: 0.878 Test Loss: 0.565 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 2.154402256011963
Epoch: 47, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.539 Vali Acc: 0.900 Test Loss: 0.539 Test Acc: 0.900
Validation loss decreased (-0.888884 --> -0.899995).  Saving model ...
Epoch: 48 cost time: 1.9945790767669678
Epoch: 48, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.556 Vali Acc: 0.883 Test Loss: 0.556 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.8968074321746826
Epoch: 49, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.516 Vali Acc: 0.900 Test Loss: 0.516 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 50 cost time: 2.2531137466430664
Epoch: 50, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.524 Vali Acc: 0.894 Test Loss: 0.524 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 2.433166742324829
Epoch: 51, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.553 Vali Acc: 0.894 Test Loss: 0.553 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 2.1252012252807617
Epoch: 52, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.496 Vali Acc: 0.883 Test Loss: 0.496 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 2.369337320327759
Epoch: 53, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.504 Vali Acc: 0.872 Test Loss: 0.504 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 2.243565320968628
Epoch: 54, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.526 Vali Acc: 0.889 Test Loss: 0.526 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.8882653713226318
Epoch: 55, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.531 Vali Acc: 0.889 Test Loss: 0.531 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 2.1479709148406982
Epoch: 56, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.540 Vali Acc: 0.878 Test Loss: 0.540 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 2.0921826362609863
Epoch: 57, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.515 Vali Acc: 0.889 Test Loss: 0.515 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.9005177021026611
Epoch: 58, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.635 Vali Acc: 0.878 Test Loss: 0.635 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.9934701919555664
Epoch: 59, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.635 Vali Acc: 0.844 Test Loss: 0.635 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 911627
model size : 4.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.657596111297607
Epoch: 1, Steps: 12 | Train Loss: 2.948 Vali Loss: 2.860 Vali Acc: 0.067 Test Loss: 2.860 Test Acc: 0.067
Validation loss decreased (inf --> -0.066638).  Saving model ...
Epoch: 2 cost time: 2.298105001449585
Epoch: 2, Steps: 12 | Train Loss: 2.775 Vali Loss: 2.693 Vali Acc: 0.094 Test Loss: 2.693 Test Acc: 0.094
Validation loss decreased (-0.066638 --> -0.094418).  Saving model ...
Epoch: 3 cost time: 2.51057767868042
Epoch: 3, Steps: 12 | Train Loss: 2.645 Vali Loss: 2.583 Vali Acc: 0.178 Test Loss: 2.583 Test Acc: 0.178
Validation loss decreased (-0.094418 --> -0.177752).  Saving model ...
Epoch: 4 cost time: 2.346318006515503
Epoch: 4, Steps: 12 | Train Loss: 2.556 Vali Loss: 2.457 Vali Acc: 0.333 Test Loss: 2.457 Test Acc: 0.333
Validation loss decreased (-0.177752 --> -0.333309).  Saving model ...
Epoch: 5 cost time: 2.3878061771392822
Epoch: 5, Steps: 12 | Train Loss: 2.312 Vali Loss: 2.228 Vali Acc: 0.456 Test Loss: 2.228 Test Acc: 0.456
Validation loss decreased (-0.333309 --> -0.455533).  Saving model ...
Epoch: 6 cost time: 2.207519769668579
Epoch: 6, Steps: 12 | Train Loss: 2.134 Vali Loss: 2.057 Vali Acc: 0.489 Test Loss: 2.057 Test Acc: 0.489
Validation loss decreased (-0.455533 --> -0.488868).  Saving model ...
Epoch: 7 cost time: 2.3489999771118164
Epoch: 7, Steps: 12 | Train Loss: 1.899 Vali Loss: 1.896 Vali Acc: 0.561 Test Loss: 1.896 Test Acc: 0.561
Validation loss decreased (-0.488868 --> -0.561092).  Saving model ...
Epoch: 8 cost time: 1.7719390392303467
Epoch: 8, Steps: 12 | Train Loss: 1.722 Vali Loss: 1.737 Vali Acc: 0.550 Test Loss: 1.737 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9704811573028564
Epoch: 9, Steps: 12 | Train Loss: 1.581 Vali Loss: 1.612 Vali Acc: 0.611 Test Loss: 1.612 Test Acc: 0.611
Validation loss decreased (-0.561092 --> -0.611095).  Saving model ...
Epoch: 10 cost time: 2.1833999156951904
Epoch: 10, Steps: 12 | Train Loss: 1.404 Vali Loss: 1.473 Vali Acc: 0.644 Test Loss: 1.473 Test Acc: 0.644
Validation loss decreased (-0.611095 --> -0.644430).  Saving model ...
Epoch: 11 cost time: 2.265244722366333
Epoch: 11, Steps: 12 | Train Loss: 1.301 Vali Loss: 1.382 Vali Acc: 0.689 Test Loss: 1.382 Test Acc: 0.689
Validation loss decreased (-0.644430 --> -0.688875).  Saving model ...
Epoch: 12 cost time: 2.5258874893188477
Epoch: 12, Steps: 12 | Train Loss: 1.166 Vali Loss: 1.250 Vali Acc: 0.728 Test Loss: 1.250 Test Acc: 0.728
Validation loss decreased (-0.688875 --> -0.727765).  Saving model ...
Epoch: 13 cost time: 2.020441770553589
Epoch: 13, Steps: 12 | Train Loss: 1.086 Vali Loss: 1.178 Vali Acc: 0.722 Test Loss: 1.178 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.4377808570861816
Epoch: 14, Steps: 12 | Train Loss: 0.951 Vali Loss: 1.083 Vali Acc: 0.744 Test Loss: 1.083 Test Acc: 0.744
Validation loss decreased (-0.727765 --> -0.744434).  Saving model ...
Epoch: 15 cost time: 2.8988630771636963
Epoch: 15, Steps: 12 | Train Loss: 0.851 Vali Loss: 0.998 Vali Acc: 0.744 Test Loss: 0.998 Test Acc: 0.744
Validation loss decreased (-0.744434 --> -0.744434).  Saving model ...
Epoch: 16 cost time: 2.164780378341675
Epoch: 16, Steps: 12 | Train Loss: 0.766 Vali Loss: 0.913 Vali Acc: 0.789 Test Loss: 0.913 Test Acc: 0.789
Validation loss decreased (-0.744434 --> -0.788880).  Saving model ...
Epoch: 17 cost time: 2.2307088375091553
Epoch: 17, Steps: 12 | Train Loss: 0.717 Vali Loss: 0.827 Vali Acc: 0.800 Test Loss: 0.827 Test Acc: 0.800
Validation loss decreased (-0.788880 --> -0.799992).  Saving model ...
Epoch: 18 cost time: 2.1365649700164795
Epoch: 18, Steps: 12 | Train Loss: 0.618 Vali Loss: 0.794 Vali Acc: 0.811 Test Loss: 0.794 Test Acc: 0.811
Validation loss decreased (-0.799992 --> -0.811103).  Saving model ...
Epoch: 19 cost time: 2.22574782371521
Epoch: 19, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.761 Vali Acc: 0.811 Test Loss: 0.761 Test Acc: 0.811
Validation loss decreased (-0.811103 --> -0.811104).  Saving model ...
Epoch: 20 cost time: 1.9261116981506348
Epoch: 20, Steps: 12 | Train Loss: 0.569 Vali Loss: 0.720 Vali Acc: 0.828 Test Loss: 0.720 Test Acc: 0.828
Validation loss decreased (-0.811104 --> -0.827771).  Saving model ...
Epoch: 21 cost time: 2.7700488567352295
Epoch: 21, Steps: 12 | Train Loss: 0.495 Vali Loss: 0.714 Vali Acc: 0.839 Test Loss: 0.714 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838882).  Saving model ...
Epoch: 22 cost time: 1.7574543952941895
Epoch: 22, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.648 Vali Acc: 0.844 Test Loss: 0.648 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 23 cost time: 1.8561959266662598
Epoch: 23, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.610 Vali Acc: 0.844 Test Loss: 0.610 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 24 cost time: 1.9165089130401611
Epoch: 24, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.657 Vali Acc: 0.833 Test Loss: 0.657 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.1469268798828125
Epoch: 25, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.561 Vali Acc: 0.861 Test Loss: 0.561 Test Acc: 0.861
Validation loss decreased (-0.844438 --> -0.861105).  Saving model ...
Epoch: 26 cost time: 2.34378981590271
Epoch: 26, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.589 Vali Acc: 0.861 Test Loss: 0.589 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.350121021270752
Epoch: 27, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.483 Vali Acc: 0.867 Test Loss: 0.483 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866662).  Saving model ...
Epoch: 28 cost time: 2.0311777591705322
Epoch: 28, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.518 Vali Acc: 0.878 Test Loss: 0.518 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877773).  Saving model ...
Epoch: 29 cost time: 2.497189521789551
Epoch: 29, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.549 Vali Acc: 0.833 Test Loss: 0.549 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.1763856410980225
Epoch: 30, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.528 Vali Acc: 0.872 Test Loss: 0.528 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.374659776687622
Epoch: 31, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.549 Vali Acc: 0.833 Test Loss: 0.549 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.470534324645996
Epoch: 32, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.488 Vali Acc: 0.867 Test Loss: 0.488 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.76070237159729
Epoch: 33, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.582 Vali Acc: 0.867 Test Loss: 0.582 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.8030645847320557
Epoch: 34, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.524 Vali Acc: 0.867 Test Loss: 0.524 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.708369255065918
Epoch: 35, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.491 Vali Acc: 0.856 Test Loss: 0.491 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.8564271926879883
Epoch: 36, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.519 Vali Acc: 0.867 Test Loss: 0.519 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.891442060470581
Epoch: 37, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.560 Vali Acc: 0.850 Test Loss: 0.560 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 2.155714511871338
Epoch: 38, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.556 Vali Acc: 0.861 Test Loss: 0.556 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 764555
model size : 4.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.575315713882446
Epoch: 1, Steps: 12 | Train Loss: 2.792 Vali Loss: 2.690 Vali Acc: 0.078 Test Loss: 2.690 Test Acc: 0.078
Validation loss decreased (inf --> -0.077751).  Saving model ...
Epoch: 2 cost time: 2.42758846282959
Epoch: 2, Steps: 12 | Train Loss: 2.690 Vali Loss: 2.580 Vali Acc: 0.111 Test Loss: 2.580 Test Acc: 0.111
Validation loss decreased (-0.077751 --> -0.111085).  Saving model ...
Epoch: 3 cost time: 2.4067838191986084
Epoch: 3, Steps: 12 | Train Loss: 2.576 Vali Loss: 2.480 Vali Acc: 0.206 Test Loss: 2.480 Test Acc: 0.206
Validation loss decreased (-0.111085 --> -0.205531).  Saving model ...
Epoch: 4 cost time: 2.8452980518341064
Epoch: 4, Steps: 12 | Train Loss: 2.437 Vali Loss: 2.301 Vali Acc: 0.344 Test Loss: 2.301 Test Acc: 0.344
Validation loss decreased (-0.205531 --> -0.344421).  Saving model ...
Epoch: 5 cost time: 2.3448920249938965
Epoch: 5, Steps: 12 | Train Loss: 2.218 Vali Loss: 2.087 Vali Acc: 0.478 Test Loss: 2.087 Test Acc: 0.478
Validation loss decreased (-0.344421 --> -0.477757).  Saving model ...
Epoch: 6 cost time: 2.3391709327697754
Epoch: 6, Steps: 12 | Train Loss: 2.006 Vali Loss: 1.887 Vali Acc: 0.561 Test Loss: 1.887 Test Acc: 0.561
Validation loss decreased (-0.477757 --> -0.561092).  Saving model ...
Epoch: 7 cost time: 2.0517687797546387
Epoch: 7, Steps: 12 | Train Loss: 1.775 Vali Loss: 1.754 Vali Acc: 0.583 Test Loss: 1.754 Test Acc: 0.583
Validation loss decreased (-0.561092 --> -0.583316).  Saving model ...
Epoch: 8 cost time: 2.1842799186706543
Epoch: 8, Steps: 12 | Train Loss: 1.688 Vali Loss: 1.616 Vali Acc: 0.622 Test Loss: 1.616 Test Acc: 0.622
Validation loss decreased (-0.583316 --> -0.622206).  Saving model ...
Epoch: 9 cost time: 2.5272700786590576
Epoch: 9, Steps: 12 | Train Loss: 1.489 Vali Loss: 1.485 Vali Acc: 0.717 Test Loss: 1.485 Test Acc: 0.717
Validation loss decreased (-0.622206 --> -0.716652).  Saving model ...
Epoch: 10 cost time: 1.89320969581604
Epoch: 10, Steps: 12 | Train Loss: 1.326 Vali Loss: 1.368 Vali Acc: 0.694 Test Loss: 1.368 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8220643997192383
Epoch: 11, Steps: 12 | Train Loss: 1.219 Vali Loss: 1.268 Vali Acc: 0.711 Test Loss: 1.268 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.409454345703125
Epoch: 12, Steps: 12 | Train Loss: 1.112 Vali Loss: 1.197 Vali Acc: 0.750 Test Loss: 1.197 Test Acc: 0.750
Validation loss decreased (-0.716652 --> -0.749988).  Saving model ...
Epoch: 13 cost time: 2.383949041366577
Epoch: 13, Steps: 12 | Train Loss: 1.010 Vali Loss: 1.134 Vali Acc: 0.767 Test Loss: 1.134 Test Acc: 0.767
Validation loss decreased (-0.749988 --> -0.766655).  Saving model ...
Epoch: 14 cost time: 2.562439203262329
Epoch: 14, Steps: 12 | Train Loss: 1.006 Vali Loss: 1.034 Vali Acc: 0.783 Test Loss: 1.034 Test Acc: 0.783
Validation loss decreased (-0.766655 --> -0.783323).  Saving model ...
Epoch: 15 cost time: 2.5595996379852295
Epoch: 15, Steps: 12 | Train Loss: 0.854 Vali Loss: 0.988 Vali Acc: 0.789 Test Loss: 0.988 Test Acc: 0.789
Validation loss decreased (-0.783323 --> -0.788879).  Saving model ...
Epoch: 16 cost time: 2.0045411586761475
Epoch: 16, Steps: 12 | Train Loss: 0.788 Vali Loss: 0.910 Vali Acc: 0.789 Test Loss: 0.910 Test Acc: 0.789
Validation loss decreased (-0.788879 --> -0.788880).  Saving model ...
Epoch: 17 cost time: 2.2498223781585693
Epoch: 17, Steps: 12 | Train Loss: 0.717 Vali Loss: 0.875 Vali Acc: 0.817 Test Loss: 0.875 Test Acc: 0.817
Validation loss decreased (-0.788880 --> -0.816658).  Saving model ...
Epoch: 18 cost time: 2.642332077026367
Epoch: 18, Steps: 12 | Train Loss: 0.633 Vali Loss: 0.775 Vali Acc: 0.828 Test Loss: 0.775 Test Acc: 0.828
Validation loss decreased (-0.816658 --> -0.827770).  Saving model ...
Epoch: 19 cost time: 2.381171703338623
Epoch: 19, Steps: 12 | Train Loss: 0.639 Vali Loss: 0.755 Vali Acc: 0.828 Test Loss: 0.755 Test Acc: 0.828
Validation loss decreased (-0.827770 --> -0.827770).  Saving model ...
Epoch: 20 cost time: 2.0918095111846924
Epoch: 20, Steps: 12 | Train Loss: 0.535 Vali Loss: 0.678 Vali Acc: 0.839 Test Loss: 0.678 Test Acc: 0.839
Validation loss decreased (-0.827770 --> -0.838882).  Saving model ...
Epoch: 21 cost time: 2.425105571746826
Epoch: 21, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.658 Vali Acc: 0.833 Test Loss: 0.658 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.383146047592163
Epoch: 22, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.666 Vali Acc: 0.878 Test Loss: 0.666 Test Acc: 0.878
Validation loss decreased (-0.838882 --> -0.877771).  Saving model ...
Epoch: 23 cost time: 2.161564588546753
Epoch: 23, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.565 Vali Acc: 0.828 Test Loss: 0.565 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.5137040615081787
Epoch: 24, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.563 Vali Acc: 0.844 Test Loss: 0.563 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.4721291065216064
Epoch: 25, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.536 Vali Acc: 0.878 Test Loss: 0.536 Test Acc: 0.878
Validation loss decreased (-0.877771 --> -0.877772).  Saving model ...
Epoch: 26 cost time: 2.111588954925537
Epoch: 26, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.513 Vali Acc: 0.872 Test Loss: 0.513 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.249171018600464
Epoch: 27, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.511 Vali Acc: 0.861 Test Loss: 0.511 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.411424160003662
Epoch: 28, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.533 Vali Acc: 0.867 Test Loss: 0.533 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.4605743885040283
Epoch: 29, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.542 Vali Acc: 0.867 Test Loss: 0.542 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.3149213790893555
Epoch: 30, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.542 Vali Acc: 0.856 Test Loss: 0.542 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.0137317180633545
Epoch: 31, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.500 Vali Acc: 0.867 Test Loss: 0.500 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.28865909576416
Epoch: 32, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.581 Vali Acc: 0.872 Test Loss: 0.581 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.4476523399353027
Epoch: 33, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.455 Vali Acc: 0.894 Test Loss: 0.455 Test Acc: 0.894
Validation loss decreased (-0.877772 --> -0.894440).  Saving model ...
Epoch: 34 cost time: 2.7126920223236084
Epoch: 34, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.485 Vali Acc: 0.883 Test Loss: 0.485 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.4753072261810303
Epoch: 35, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.492 Vali Acc: 0.883 Test Loss: 0.492 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.0070085525512695
Epoch: 36, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.518 Vali Acc: 0.883 Test Loss: 0.518 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.644129514694214
Epoch: 37, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.507 Vali Acc: 0.861 Test Loss: 0.507 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.287907838821411
Epoch: 38, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.547 Vali Acc: 0.867 Test Loss: 0.547 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.431959867477417
Epoch: 39, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.509 Vali Acc: 0.872 Test Loss: 0.509 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.2177672386169434
Epoch: 40, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.534 Vali Acc: 0.878 Test Loss: 0.534 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.26519513130188
Epoch: 41, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.442 Vali Acc: 0.872 Test Loss: 0.442 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.3974368572235107
Epoch: 42, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.474 Vali Acc: 0.883 Test Loss: 0.474 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.5284276008605957
Epoch: 43, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.484 Vali Acc: 0.894 Test Loss: 0.484 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 764043
model size : 4.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.316996097564697
Epoch: 1, Steps: 12 | Train Loss: 2.907 Vali Loss: 2.813 Vali Acc: 0.133 Test Loss: 2.813 Test Acc: 0.133
Validation loss decreased (inf --> -0.133305).  Saving model ...
Epoch: 2 cost time: 2.5660111904144287
Epoch: 2, Steps: 12 | Train Loss: 2.706 Vali Loss: 2.642 Vali Acc: 0.150 Test Loss: 2.642 Test Acc: 0.150
Validation loss decreased (-0.133305 --> -0.149974).  Saving model ...
Epoch: 3 cost time: 2.4305331707000732
Epoch: 3, Steps: 12 | Train Loss: 2.684 Vali Loss: 2.518 Vali Acc: 0.294 Test Loss: 2.518 Test Acc: 0.294
Validation loss decreased (-0.149974 --> -0.294419).  Saving model ...
Epoch: 4 cost time: 2.475555658340454
Epoch: 4, Steps: 12 | Train Loss: 2.441 Vali Loss: 2.394 Vali Acc: 0.283 Test Loss: 2.394 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4240329265594482
Epoch: 5, Steps: 12 | Train Loss: 2.249 Vali Loss: 2.210 Vali Acc: 0.389 Test Loss: 2.210 Test Acc: 0.389
Validation loss decreased (-0.294419 --> -0.388867).  Saving model ...
Epoch: 6 cost time: 1.887723445892334
Epoch: 6, Steps: 12 | Train Loss: 2.078 Vali Loss: 2.052 Vali Acc: 0.472 Test Loss: 2.052 Test Acc: 0.472
Validation loss decreased (-0.388867 --> -0.472202).  Saving model ...
Epoch: 7 cost time: 2.2428736686706543
Epoch: 7, Steps: 12 | Train Loss: 1.894 Vali Loss: 1.920 Vali Acc: 0.561 Test Loss: 1.920 Test Acc: 0.561
Validation loss decreased (-0.472202 --> -0.561092).  Saving model ...
Epoch: 8 cost time: 2.180055856704712
Epoch: 8, Steps: 12 | Train Loss: 1.730 Vali Loss: 1.805 Vali Acc: 0.544 Test Loss: 1.805 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.998241901397705
Epoch: 9, Steps: 12 | Train Loss: 1.594 Vali Loss: 1.676 Vali Acc: 0.606 Test Loss: 1.676 Test Acc: 0.606
Validation loss decreased (-0.561092 --> -0.605539).  Saving model ...
Epoch: 10 cost time: 2.3102900981903076
Epoch: 10, Steps: 12 | Train Loss: 1.446 Vali Loss: 1.575 Vali Acc: 0.617 Test Loss: 1.575 Test Acc: 0.617
Validation loss decreased (-0.605539 --> -0.616651).  Saving model ...
Epoch: 11 cost time: 2.1540069580078125
Epoch: 11, Steps: 12 | Train Loss: 1.379 Vali Loss: 1.458 Vali Acc: 0.661 Test Loss: 1.458 Test Acc: 0.661
Validation loss decreased (-0.616651 --> -0.661097).  Saving model ...
Epoch: 12 cost time: 1.7577340602874756
Epoch: 12, Steps: 12 | Train Loss: 1.223 Vali Loss: 1.396 Vali Acc: 0.678 Test Loss: 1.396 Test Acc: 0.678
Validation loss decreased (-0.661097 --> -0.677764).  Saving model ...
Epoch: 13 cost time: 1.9322493076324463
Epoch: 13, Steps: 12 | Train Loss: 1.131 Vali Loss: 1.341 Vali Acc: 0.694 Test Loss: 1.341 Test Acc: 0.694
Validation loss decreased (-0.677764 --> -0.694431).  Saving model ...
Epoch: 14 cost time: 2.0649116039276123
Epoch: 14, Steps: 12 | Train Loss: 1.075 Vali Loss: 1.238 Vali Acc: 0.694 Test Loss: 1.238 Test Acc: 0.694
Validation loss decreased (-0.694431 --> -0.694432).  Saving model ...
Epoch: 15 cost time: 2.869837760925293
Epoch: 15, Steps: 12 | Train Loss: 0.978 Vali Loss: 1.149 Vali Acc: 0.678 Test Loss: 1.149 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.4089531898498535
Epoch: 16, Steps: 12 | Train Loss: 0.933 Vali Loss: 1.051 Vali Acc: 0.728 Test Loss: 1.051 Test Acc: 0.728
Validation loss decreased (-0.694432 --> -0.727767).  Saving model ...
Epoch: 17 cost time: 2.1030092239379883
Epoch: 17, Steps: 12 | Train Loss: 0.837 Vali Loss: 0.984 Vali Acc: 0.739 Test Loss: 0.984 Test Acc: 0.739
Validation loss decreased (-0.727767 --> -0.738879).  Saving model ...
Epoch: 18 cost time: 2.318711519241333
Epoch: 18, Steps: 12 | Train Loss: 0.795 Vali Loss: 0.890 Vali Acc: 0.756 Test Loss: 0.890 Test Acc: 0.756
Validation loss decreased (-0.738879 --> -0.755547).  Saving model ...
Epoch: 19 cost time: 2.3909716606140137
Epoch: 19, Steps: 12 | Train Loss: 0.631 Vali Loss: 0.847 Vali Acc: 0.772 Test Loss: 0.847 Test Acc: 0.772
Validation loss decreased (-0.755547 --> -0.772214).  Saving model ...
Epoch: 20 cost time: 2.3649327754974365
Epoch: 20, Steps: 12 | Train Loss: 0.646 Vali Loss: 0.817 Vali Acc: 0.783 Test Loss: 0.817 Test Acc: 0.783
Validation loss decreased (-0.772214 --> -0.783325).  Saving model ...
Epoch: 21 cost time: 2.1814157962799072
Epoch: 21, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.760 Vali Acc: 0.756 Test Loss: 0.760 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0744857788085938
Epoch: 22, Steps: 12 | Train Loss: 0.510 Vali Loss: 0.698 Vali Acc: 0.817 Test Loss: 0.698 Test Acc: 0.817
Validation loss decreased (-0.783325 --> -0.816660).  Saving model ...
Epoch: 23 cost time: 1.981917142868042
Epoch: 23, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.635 Vali Acc: 0.817 Test Loss: 0.635 Test Acc: 0.817
Validation loss decreased (-0.816660 --> -0.816660).  Saving model ...
Epoch: 24 cost time: 2.027538537979126
Epoch: 24, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.590 Vali Acc: 0.850 Test Loss: 0.590 Test Acc: 0.850
Validation loss decreased (-0.816660 --> -0.849994).  Saving model ...
Epoch: 25 cost time: 1.9369423389434814
Epoch: 25, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.581 Vali Acc: 0.833 Test Loss: 0.581 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.1363348960876465
Epoch: 26, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.568 Vali Acc: 0.850 Test Loss: 0.568 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 27 cost time: 1.9715969562530518
Epoch: 27, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.541 Vali Acc: 0.844 Test Loss: 0.541 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7952642440795898
Epoch: 28, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.534 Vali Acc: 0.867 Test Loss: 0.534 Test Acc: 0.867
Validation loss decreased (-0.849994 --> -0.866661).  Saving model ...
Epoch: 29 cost time: 1.9467146396636963
Epoch: 29, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.506 Vali Acc: 0.844 Test Loss: 0.506 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.017301082611084
Epoch: 30, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.483 Vali Acc: 0.861 Test Loss: 0.483 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.9728286266326904
Epoch: 31, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.474 Vali Acc: 0.872 Test Loss: 0.474 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 32 cost time: 2.034003973007202
Epoch: 32, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.473 Vali Acc: 0.878 Test Loss: 0.473 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 33 cost time: 1.9178507328033447
Epoch: 33, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.441 Vali Acc: 0.872 Test Loss: 0.441 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.1528329849243164
Epoch: 34, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.508 Vali Acc: 0.861 Test Loss: 0.508 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.8924334049224854
Epoch: 35, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.484 Vali Acc: 0.844 Test Loss: 0.484 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.0469439029693604
Epoch: 36, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.519 Vali Acc: 0.861 Test Loss: 0.519 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.1498055458068848
Epoch: 37, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.466 Vali Acc: 0.878 Test Loss: 0.466 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 38 cost time: 1.9722638130187988
Epoch: 38, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.471 Vali Acc: 0.878 Test Loss: 0.471 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.2014145851135254
Epoch: 39, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.482 Vali Acc: 0.861 Test Loss: 0.482 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.1178839206695557
Epoch: 40, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.453 Vali Acc: 0.872 Test Loss: 0.453 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.9112868309020996
Epoch: 41, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.483 Vali Acc: 0.872 Test Loss: 0.483 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.20986270904541
Epoch: 42, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.470 Vali Acc: 0.883 Test Loss: 0.470 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883329).  Saving model ...
Epoch: 43 cost time: 1.8897440433502197
Epoch: 43, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.464 Vali Acc: 0.878 Test Loss: 0.464 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.001345157623291
Epoch: 44, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.465 Vali Acc: 0.878 Test Loss: 0.465 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.0659658908843994
Epoch: 45, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.496 Vali Acc: 0.850 Test Loss: 0.496 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.872284173965454
Epoch: 46, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.496 Vali Acc: 0.861 Test Loss: 0.496 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 2.291461944580078
Epoch: 47, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.442 Vali Acc: 0.878 Test Loss: 0.442 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.8748970031738281
Epoch: 48, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.458 Vali Acc: 0.883 Test Loss: 0.458 Test Acc: 0.883
Validation loss decreased (-0.883329 --> -0.883329).  Saving model ...
Epoch: 49 cost time: 1.8981003761291504
Epoch: 49, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.465 Vali Acc: 0.883 Test Loss: 0.465 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 2.100847005844116
Epoch: 50, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.497 Vali Acc: 0.878 Test Loss: 0.497 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 2.164760112762451
Epoch: 51, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.512 Vali Acc: 0.867 Test Loss: 0.512 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.9254796504974365
Epoch: 52, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.571 Vali Acc: 0.856 Test Loss: 0.571 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.9937715530395508
Epoch: 53, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.585 Vali Acc: 0.856 Test Loss: 0.585 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.9578585624694824
Epoch: 54, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.587 Vali Acc: 0.878 Test Loss: 0.587 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.7454867362976074
Epoch: 55, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.581 Vali Acc: 0.856 Test Loss: 0.581 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.9835374355316162
Epoch: 56, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.598 Vali Acc: 0.867 Test Loss: 0.598 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 2.166316032409668
Epoch: 57, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.579 Vali Acc: 0.878 Test Loss: 0.579 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 2.6778481006622314
Epoch: 58, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.555 Vali Acc: 0.900 Test Loss: 0.555 Test Acc: 0.900
Validation loss decreased (-0.883329 --> -0.899994).  Saving model ...
Epoch: 59 cost time: 1.7675721645355225
Epoch: 59, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.569 Vali Acc: 0.883 Test Loss: 0.569 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.950425386428833
Epoch: 60, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.551 Vali Acc: 0.889 Test Loss: 0.551 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.7063064575195312
Epoch: 61, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.575 Vali Acc: 0.856 Test Loss: 0.575 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.763455867767334
Epoch: 62, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.531 Vali Acc: 0.867 Test Loss: 0.531 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 2.066795825958252
Epoch: 63, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.548 Vali Acc: 0.872 Test Loss: 0.548 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 2.0886387825012207
Epoch: 64, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.535 Vali Acc: 0.878 Test Loss: 0.535 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 1.7527532577514648
Epoch: 65, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.579 Vali Acc: 0.878 Test Loss: 0.579 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 1.964892864227295
Epoch: 66, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.571 Vali Acc: 0.878 Test Loss: 0.571 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 2.0368988513946533
Epoch: 67, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.562 Vali Acc: 0.872 Test Loss: 0.562 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 1.90468430519104
Epoch: 68, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.562 Vali Acc: 0.878 Test Loss: 0.562 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 763531
model size : 4.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7565629482269287
Epoch: 1, Steps: 12 | Train Loss: 2.818 Vali Loss: 2.718 Vali Acc: 0.111 Test Loss: 2.718 Test Acc: 0.111
Validation loss decreased (inf --> -0.111084).  Saving model ...
Epoch: 2 cost time: 2.486821413040161
Epoch: 2, Steps: 12 | Train Loss: 2.757 Vali Loss: 2.621 Vali Acc: 0.139 Test Loss: 2.621 Test Acc: 0.139
Validation loss decreased (-0.111084 --> -0.138863).  Saving model ...
Epoch: 3 cost time: 2.6847617626190186
Epoch: 3, Steps: 12 | Train Loss: 2.608 Vali Loss: 2.533 Vali Acc: 0.267 Test Loss: 2.533 Test Acc: 0.267
Validation loss decreased (-0.138863 --> -0.266641).  Saving model ...
Epoch: 4 cost time: 2.618419647216797
Epoch: 4, Steps: 12 | Train Loss: 2.470 Vali Loss: 2.316 Vali Acc: 0.311 Test Loss: 2.316 Test Acc: 0.311
Validation loss decreased (-0.266641 --> -0.311088).  Saving model ...
Epoch: 5 cost time: 2.024503707885742
Epoch: 5, Steps: 12 | Train Loss: 2.269 Vali Loss: 2.097 Vali Acc: 0.400 Test Loss: 2.097 Test Acc: 0.400
Validation loss decreased (-0.311088 --> -0.399979).  Saving model ...
Epoch: 6 cost time: 2.2509350776672363
Epoch: 6, Steps: 12 | Train Loss: 2.027 Vali Loss: 1.939 Vali Acc: 0.511 Test Loss: 1.939 Test Acc: 0.511
Validation loss decreased (-0.399979 --> -0.511092).  Saving model ...
Epoch: 7 cost time: 2.834597587585449
Epoch: 7, Steps: 12 | Train Loss: 1.822 Vali Loss: 1.795 Vali Acc: 0.550 Test Loss: 1.795 Test Acc: 0.550
Validation loss decreased (-0.511092 --> -0.549982).  Saving model ...
Epoch: 8 cost time: 1.968496322631836
Epoch: 8, Steps: 12 | Train Loss: 1.642 Vali Loss: 1.671 Vali Acc: 0.572 Test Loss: 1.671 Test Acc: 0.572
Validation loss decreased (-0.549982 --> -0.572206).  Saving model ...
Epoch: 9 cost time: 2.1305320262908936
Epoch: 9, Steps: 12 | Train Loss: 1.487 Vali Loss: 1.537 Vali Acc: 0.594 Test Loss: 1.537 Test Acc: 0.594
Validation loss decreased (-0.572206 --> -0.594429).  Saving model ...
Epoch: 10 cost time: 2.2441585063934326
Epoch: 10, Steps: 12 | Train Loss: 1.396 Vali Loss: 1.429 Vali Acc: 0.639 Test Loss: 1.429 Test Acc: 0.639
Validation loss decreased (-0.594429 --> -0.638875).  Saving model ...
Epoch: 11 cost time: 2.112748861312866
Epoch: 11, Steps: 12 | Train Loss: 1.252 Vali Loss: 1.321 Vali Acc: 0.683 Test Loss: 1.321 Test Acc: 0.683
Validation loss decreased (-0.638875 --> -0.683320).  Saving model ...
Epoch: 12 cost time: 1.8824331760406494
Epoch: 12, Steps: 12 | Train Loss: 1.140 Vali Loss: 1.232 Vali Acc: 0.661 Test Loss: 1.232 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3284900188446045
Epoch: 13, Steps: 12 | Train Loss: 1.056 Vali Loss: 1.134 Vali Acc: 0.706 Test Loss: 1.134 Test Acc: 0.706
Validation loss decreased (-0.683320 --> -0.705544).  Saving model ...
Epoch: 14 cost time: 2.0704612731933594
Epoch: 14, Steps: 12 | Train Loss: 0.979 Vali Loss: 1.070 Vali Acc: 0.706 Test Loss: 1.070 Test Acc: 0.706
Validation loss decreased (-0.705544 --> -0.705545).  Saving model ...
Epoch: 15 cost time: 2.4239859580993652
Epoch: 15, Steps: 12 | Train Loss: 0.880 Vali Loss: 0.986 Vali Acc: 0.756 Test Loss: 0.986 Test Acc: 0.756
Validation loss decreased (-0.705545 --> -0.755546).  Saving model ...
Epoch: 16 cost time: 2.463029146194458
Epoch: 16, Steps: 12 | Train Loss: 0.811 Vali Loss: 0.915 Vali Acc: 0.783 Test Loss: 0.915 Test Acc: 0.783
Validation loss decreased (-0.755546 --> -0.783324).  Saving model ...
Epoch: 17 cost time: 2.3238134384155273
Epoch: 17, Steps: 12 | Train Loss: 0.739 Vali Loss: 0.845 Vali Acc: 0.772 Test Loss: 0.845 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.3438878059387207
Epoch: 18, Steps: 12 | Train Loss: 0.688 Vali Loss: 0.823 Vali Acc: 0.794 Test Loss: 0.823 Test Acc: 0.794
Validation loss decreased (-0.783324 --> -0.794436).  Saving model ...
Epoch: 19 cost time: 2.4058375358581543
Epoch: 19, Steps: 12 | Train Loss: 0.657 Vali Loss: 0.818 Vali Acc: 0.794 Test Loss: 0.818 Test Acc: 0.794
Validation loss decreased (-0.794436 --> -0.794436).  Saving model ...
Epoch: 20 cost time: 2.0499610900878906
Epoch: 20, Steps: 12 | Train Loss: 0.545 Vali Loss: 0.707 Vali Acc: 0.806 Test Loss: 0.707 Test Acc: 0.806
Validation loss decreased (-0.794436 --> -0.805548).  Saving model ...
Epoch: 21 cost time: 1.8216700553894043
Epoch: 21, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.657 Vali Acc: 0.817 Test Loss: 0.657 Test Acc: 0.817
Validation loss decreased (-0.805548 --> -0.816660).  Saving model ...
Epoch: 22 cost time: 2.0888803005218506
Epoch: 22, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.660 Vali Acc: 0.833 Test Loss: 0.660 Test Acc: 0.833
Validation loss decreased (-0.816660 --> -0.833327).  Saving model ...
Epoch: 23 cost time: 2.250856399536133
Epoch: 23, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.594 Vali Acc: 0.839 Test Loss: 0.594 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 24 cost time: 2.2791390419006348
Epoch: 24, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.598 Vali Acc: 0.850 Test Loss: 0.598 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 25 cost time: 2.0966572761535645
Epoch: 25, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.567 Vali Acc: 0.856 Test Loss: 0.567 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 26 cost time: 2.1106698513031006
Epoch: 26, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.538 Vali Acc: 0.850 Test Loss: 0.538 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.3858988285064697
Epoch: 27, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.534 Vali Acc: 0.850 Test Loss: 0.534 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.937866449356079
Epoch: 28, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.549 Vali Acc: 0.844 Test Loss: 0.549 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.4541378021240234
Epoch: 29, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.512 Vali Acc: 0.861 Test Loss: 0.512 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 30 cost time: 2.1954615116119385
Epoch: 30, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.489 Vali Acc: 0.850 Test Loss: 0.489 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.357119083404541
Epoch: 31, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.561 Vali Acc: 0.861 Test Loss: 0.561 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.2150368690490723
Epoch: 32, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.529 Vali Acc: 0.844 Test Loss: 0.529 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.931319236755371
Epoch: 33, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.528 Vali Acc: 0.833 Test Loss: 0.528 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.1682584285736084
Epoch: 34, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.504 Vali Acc: 0.867 Test Loss: 0.504 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866662).  Saving model ...
Epoch: 35 cost time: 2.413785457611084
Epoch: 35, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.504 Vali Acc: 0.889 Test Loss: 0.504 Test Acc: 0.889
Validation loss decreased (-0.866662 --> -0.888884).  Saving model ...
Epoch: 36 cost time: 2.425225019454956
Epoch: 36, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.556 Vali Acc: 0.872 Test Loss: 0.556 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.3754148483276367
Epoch: 37, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.521 Vali Acc: 0.872 Test Loss: 0.521 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.341850519180298
Epoch: 38, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.519 Vali Acc: 0.878 Test Loss: 0.519 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.31974458694458
Epoch: 39, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.561 Vali Acc: 0.872 Test Loss: 0.561 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.4255645275115967
Epoch: 40, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.585 Vali Acc: 0.867 Test Loss: 0.585 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.1482622623443604
Epoch: 41, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.499 Vali Acc: 0.878 Test Loss: 0.499 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 2.001619338989258
Epoch: 42, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.467 Vali Acc: 0.894 Test Loss: 0.467 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894440).  Saving model ...
Epoch: 43 cost time: 1.8075125217437744
Epoch: 43, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.464 Vali Acc: 0.894 Test Loss: 0.464 Test Acc: 0.894
Validation loss decreased (-0.894440 --> -0.894440).  Saving model ...
Epoch: 44 cost time: 2.8792314529418945
Epoch: 44, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.549 Vali Acc: 0.883 Test Loss: 0.549 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.174565076828003
Epoch: 45, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.482 Vali Acc: 0.889 Test Loss: 0.482 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.0669634342193604
Epoch: 46, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.533 Vali Acc: 0.872 Test Loss: 0.533 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.008347272872925
Epoch: 47, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.515 Vali Acc: 0.900 Test Loss: 0.515 Test Acc: 0.900
Validation loss decreased (-0.894440 --> -0.899995).  Saving model ...
Epoch: 48 cost time: 2.2411134243011475
Epoch: 48, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.531 Vali Acc: 0.878 Test Loss: 0.531 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.3006200790405273
Epoch: 49, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.578 Vali Acc: 0.872 Test Loss: 0.578 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 2.1287646293640137
Epoch: 50, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.624 Vali Acc: 0.867 Test Loss: 0.624 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 2.5161898136138916
Epoch: 51, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.595 Vali Acc: 0.872 Test Loss: 0.595 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 2.025238275527954
Epoch: 52, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.685 Vali Acc: 0.833 Test Loss: 0.685 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.7480647563934326
Epoch: 53, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.638 Vali Acc: 0.856 Test Loss: 0.638 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 2.4416022300720215
Epoch: 54, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.586 Vali Acc: 0.889 Test Loss: 0.586 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 2.249723434448242
Epoch: 55, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.572 Vali Acc: 0.872 Test Loss: 0.572 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.936535358428955
Epoch: 56, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.593 Vali Acc: 0.883 Test Loss: 0.593 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 2.139695405960083
Epoch: 57, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.610 Vali Acc: 0.878 Test Loss: 0.610 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 763019
model size : 4.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.416045665740967
Epoch: 1, Steps: 12 | Train Loss: 2.828 Vali Loss: 2.832 Vali Acc: 0.033 Test Loss: 2.832 Test Acc: 0.033
Validation loss decreased (inf --> -0.033305).  Saving model ...
Epoch: 2 cost time: 2.3410747051239014
Epoch: 2, Steps: 12 | Train Loss: 2.761 Vali Loss: 2.717 Vali Acc: 0.067 Test Loss: 2.717 Test Acc: 0.067
Validation loss decreased (-0.033305 --> -0.066639).  Saving model ...
Epoch: 3 cost time: 2.0060908794403076
Epoch: 3, Steps: 12 | Train Loss: 2.633 Vali Loss: 2.602 Vali Acc: 0.233 Test Loss: 2.602 Test Acc: 0.233
Validation loss decreased (-0.066639 --> -0.233307).  Saving model ...
Epoch: 4 cost time: 2.0684926509857178
Epoch: 4, Steps: 12 | Train Loss: 2.540 Vali Loss: 2.454 Vali Acc: 0.339 Test Loss: 2.454 Test Acc: 0.339
Validation loss decreased (-0.233307 --> -0.338864).  Saving model ...
Epoch: 5 cost time: 2.0763442516326904
Epoch: 5, Steps: 12 | Train Loss: 2.370 Vali Loss: 2.276 Vali Acc: 0.400 Test Loss: 2.276 Test Acc: 0.400
Validation loss decreased (-0.338864 --> -0.399977).  Saving model ...
Epoch: 6 cost time: 1.8563868999481201
Epoch: 6, Steps: 12 | Train Loss: 2.182 Vali Loss: 2.143 Vali Acc: 0.417 Test Loss: 2.143 Test Acc: 0.417
Validation loss decreased (-0.399977 --> -0.416645).  Saving model ...
Epoch: 7 cost time: 2.136756658554077
Epoch: 7, Steps: 12 | Train Loss: 2.088 Vali Loss: 2.018 Vali Acc: 0.422 Test Loss: 2.018 Test Acc: 0.422
Validation loss decreased (-0.416645 --> -0.422202).  Saving model ...
Epoch: 8 cost time: 2.1246535778045654
Epoch: 8, Steps: 12 | Train Loss: 1.932 Vali Loss: 1.872 Vali Acc: 0.511 Test Loss: 1.872 Test Acc: 0.511
Validation loss decreased (-0.422202 --> -0.511092).  Saving model ...
Epoch: 9 cost time: 2.2084996700286865
Epoch: 9, Steps: 12 | Train Loss: 1.812 Vali Loss: 1.777 Vali Acc: 0.500 Test Loss: 1.777 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9601891040802002
Epoch: 10, Steps: 12 | Train Loss: 1.660 Vali Loss: 1.731 Vali Acc: 0.539 Test Loss: 1.731 Test Acc: 0.539
Validation loss decreased (-0.511092 --> -0.538872).  Saving model ...
Epoch: 11 cost time: 2.152254104614258
Epoch: 11, Steps: 12 | Train Loss: 1.598 Vali Loss: 1.586 Vali Acc: 0.611 Test Loss: 1.586 Test Acc: 0.611
Validation loss decreased (-0.538872 --> -0.611095).  Saving model ...
Epoch: 12 cost time: 2.33661150932312
Epoch: 12, Steps: 12 | Train Loss: 1.477 Vali Loss: 1.468 Vali Acc: 0.633 Test Loss: 1.468 Test Acc: 0.633
Validation loss decreased (-0.611095 --> -0.633319).  Saving model ...
Epoch: 13 cost time: 2.259927272796631
Epoch: 13, Steps: 12 | Train Loss: 1.422 Vali Loss: 1.424 Vali Acc: 0.667 Test Loss: 1.424 Test Acc: 0.667
Validation loss decreased (-0.633319 --> -0.666652).  Saving model ...
Epoch: 14 cost time: 2.340405225753784
Epoch: 14, Steps: 12 | Train Loss: 1.298 Vali Loss: 1.353 Vali Acc: 0.617 Test Loss: 1.353 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.348935604095459
Epoch: 15, Steps: 12 | Train Loss: 1.218 Vali Loss: 1.252 Vali Acc: 0.689 Test Loss: 1.252 Test Acc: 0.689
Validation loss decreased (-0.666652 --> -0.688876).  Saving model ...
Epoch: 16 cost time: 2.211003065109253
Epoch: 16, Steps: 12 | Train Loss: 1.159 Vali Loss: 1.169 Vali Acc: 0.706 Test Loss: 1.169 Test Acc: 0.706
Validation loss decreased (-0.688876 --> -0.705544).  Saving model ...
Epoch: 17 cost time: 2.0001840591430664
Epoch: 17, Steps: 12 | Train Loss: 1.077 Vali Loss: 1.169 Vali Acc: 0.683 Test Loss: 1.169 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.4367432594299316
Epoch: 18, Steps: 12 | Train Loss: 0.996 Vali Loss: 1.048 Vali Acc: 0.722 Test Loss: 1.048 Test Acc: 0.722
Validation loss decreased (-0.705544 --> -0.722212).  Saving model ...
Epoch: 19 cost time: 1.8970685005187988
Epoch: 19, Steps: 12 | Train Loss: 0.886 Vali Loss: 0.980 Vali Acc: 0.728 Test Loss: 0.980 Test Acc: 0.728
Validation loss decreased (-0.722212 --> -0.727768).  Saving model ...
Epoch: 20 cost time: 2.8867483139038086
Epoch: 20, Steps: 12 | Train Loss: 0.848 Vali Loss: 0.940 Vali Acc: 0.783 Test Loss: 0.940 Test Acc: 0.783
Validation loss decreased (-0.727768 --> -0.783324).  Saving model ...
Epoch: 21 cost time: 2.290147542953491
Epoch: 21, Steps: 12 | Train Loss: 0.754 Vali Loss: 0.941 Vali Acc: 0.767 Test Loss: 0.941 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0827865600585938
Epoch: 22, Steps: 12 | Train Loss: 0.712 Vali Loss: 0.838 Vali Acc: 0.772 Test Loss: 0.838 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.2079710960388184
Epoch: 23, Steps: 12 | Train Loss: 0.709 Vali Loss: 0.852 Vali Acc: 0.806 Test Loss: 0.852 Test Acc: 0.806
Validation loss decreased (-0.783324 --> -0.805547).  Saving model ...
Epoch: 24 cost time: 2.456023693084717
Epoch: 24, Steps: 12 | Train Loss: 0.641 Vali Loss: 0.746 Vali Acc: 0.822 Test Loss: 0.746 Test Acc: 0.822
Validation loss decreased (-0.805547 --> -0.822215).  Saving model ...
Epoch: 25 cost time: 1.8990590572357178
Epoch: 25, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.689 Vali Acc: 0.861 Test Loss: 0.689 Test Acc: 0.861
Validation loss decreased (-0.822215 --> -0.861104).  Saving model ...
Epoch: 26 cost time: 2.0248630046844482
Epoch: 26, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.656 Vali Acc: 0.867 Test Loss: 0.656 Test Acc: 0.867
Validation loss decreased (-0.861104 --> -0.866660).  Saving model ...
Epoch: 27 cost time: 1.7858145236968994
Epoch: 27, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.647 Vali Acc: 0.867 Test Loss: 0.647 Test Acc: 0.867
Validation loss decreased (-0.866660 --> -0.866660).  Saving model ...
Epoch: 28 cost time: 1.980513095855713
Epoch: 28, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.637 Vali Acc: 0.850 Test Loss: 0.637 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.1893341541290283
Epoch: 29, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.610 Vali Acc: 0.872 Test Loss: 0.610 Test Acc: 0.872
Validation loss decreased (-0.866660 --> -0.872216).  Saving model ...
Epoch: 30 cost time: 2.1663196086883545
Epoch: 30, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.626 Vali Acc: 0.844 Test Loss: 0.626 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.079261064529419
Epoch: 31, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.554 Vali Acc: 0.872 Test Loss: 0.554 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872217).  Saving model ...
Epoch: 32 cost time: 1.915069580078125
Epoch: 32, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.548 Vali Acc: 0.856 Test Loss: 0.548 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.4773874282836914
Epoch: 33, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.553 Vali Acc: 0.872 Test Loss: 0.553 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 34 cost time: 2.283247947692871
Epoch: 34, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.505 Vali Acc: 0.883 Test Loss: 0.505 Test Acc: 0.883
Validation loss decreased (-0.872217 --> -0.883328).  Saving model ...
Epoch: 35 cost time: 1.8983871936798096
Epoch: 35, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.582 Vali Acc: 0.861 Test Loss: 0.582 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.0213372707366943
Epoch: 36, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.530 Vali Acc: 0.872 Test Loss: 0.530 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.170100450515747
Epoch: 37, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.522 Vali Acc: 0.883 Test Loss: 0.522 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.1486456394195557
Epoch: 38, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.498 Vali Acc: 0.894 Test Loss: 0.498 Test Acc: 0.894
Validation loss decreased (-0.883328 --> -0.894439).  Saving model ...
Epoch: 39 cost time: 1.8933014869689941
Epoch: 39, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.491 Vali Acc: 0.872 Test Loss: 0.491 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.057314157485962
Epoch: 40, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.465 Vali Acc: 0.883 Test Loss: 0.465 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.523073673248291
Epoch: 41, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.488 Vali Acc: 0.883 Test Loss: 0.488 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.9820504188537598
Epoch: 42, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.490 Vali Acc: 0.883 Test Loss: 0.490 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.95786714553833
Epoch: 43, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.491 Vali Acc: 0.894 Test Loss: 0.491 Test Acc: 0.894
Validation loss decreased (-0.894439 --> -0.894440).  Saving model ...
Epoch: 44 cost time: 2.3834924697875977
Epoch: 44, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.486 Vali Acc: 0.883 Test Loss: 0.486 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.4847629070281982
Epoch: 45, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.501 Vali Acc: 0.867 Test Loss: 0.501 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.1461267471313477
Epoch: 46, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.488 Vali Acc: 0.894 Test Loss: 0.488 Test Acc: 0.894
Validation loss decreased (-0.894440 --> -0.894440).  Saving model ...
Epoch: 47 cost time: 2.306708574295044
Epoch: 47, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.456 Vali Acc: 0.889 Test Loss: 0.456 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 2.1603550910949707
Epoch: 48, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.514 Vali Acc: 0.878 Test Loss: 0.514 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.8944809436798096
Epoch: 49, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.552 Vali Acc: 0.867 Test Loss: 0.552 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 2.0175299644470215
Epoch: 50, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.546 Vali Acc: 0.883 Test Loss: 0.546 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 2.324402093887329
Epoch: 51, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.476 Vali Acc: 0.878 Test Loss: 0.476 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 2.2360613346099854
Epoch: 52, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.462 Vali Acc: 0.894 Test Loss: 0.462 Test Acc: 0.894
Validation loss decreased (-0.894440 --> -0.894440).  Saving model ...
Epoch: 53 cost time: 2.1096482276916504
Epoch: 53, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.444 Vali Acc: 0.894 Test Loss: 0.444 Test Acc: 0.894
Validation loss decreased (-0.894440 --> -0.894440).  Saving model ...
Epoch: 54 cost time: 2.4293761253356934
Epoch: 54, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.518 Vali Acc: 0.894 Test Loss: 0.518 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 2.1937355995178223
Epoch: 55, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.502 Vali Acc: 0.878 Test Loss: 0.502 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 2.3235905170440674
Epoch: 56, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.590 Vali Acc: 0.867 Test Loss: 0.590 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 2.2570762634277344
Epoch: 57, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.546 Vali Acc: 0.850 Test Loss: 0.546 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 2.0078907012939453
Epoch: 58, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.576 Vali Acc: 0.861 Test Loss: 0.576 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.9888875484466553
Epoch: 59, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.566 Vali Acc: 0.867 Test Loss: 0.566 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 2.0653698444366455
Epoch: 60, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.640 Vali Acc: 0.833 Test Loss: 0.640 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.9859278202056885
Epoch: 61, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.506 Vali Acc: 0.856 Test Loss: 0.506 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 2.0712854862213135
Epoch: 62, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.534 Vali Acc: 0.867 Test Loss: 0.534 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 1.8200242519378662
Epoch: 63, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.576 Vali Acc: 0.856 Test Loss: 0.576 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 759595
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.3217384815216064
Epoch: 1, Steps: 12 | Train Loss: 2.896 Vali Loss: 2.732 Vali Acc: 0.078 Test Loss: 2.732 Test Acc: 0.078
Validation loss decreased (inf --> -0.077750).  Saving model ...
Epoch: 2 cost time: 2.082662582397461
Epoch: 2, Steps: 12 | Train Loss: 2.726 Vali Loss: 2.657 Vali Acc: 0.100 Test Loss: 2.657 Test Acc: 0.100
Validation loss decreased (-0.077750 --> -0.099973).  Saving model ...
Epoch: 3 cost time: 2.203679323196411
Epoch: 3, Steps: 12 | Train Loss: 2.717 Vali Loss: 2.587 Vali Acc: 0.156 Test Loss: 2.587 Test Acc: 0.156
Validation loss decreased (-0.099973 --> -0.155530).  Saving model ...
Epoch: 4 cost time: 1.9642982482910156
Epoch: 4, Steps: 12 | Train Loss: 2.578 Vali Loss: 2.420 Vali Acc: 0.278 Test Loss: 2.420 Test Acc: 0.278
Validation loss decreased (-0.155530 --> -0.277754).  Saving model ...
Epoch: 5 cost time: 2.388279676437378
Epoch: 5, Steps: 12 | Train Loss: 2.414 Vali Loss: 2.212 Vali Acc: 0.333 Test Loss: 2.212 Test Acc: 0.333
Validation loss decreased (-0.277754 --> -0.333311).  Saving model ...
Epoch: 6 cost time: 2.4164934158325195
Epoch: 6, Steps: 12 | Train Loss: 2.205 Vali Loss: 2.050 Vali Acc: 0.400 Test Loss: 2.050 Test Acc: 0.400
Validation loss decreased (-0.333311 --> -0.399980).  Saving model ...
Epoch: 7 cost time: 2.242166519165039
Epoch: 7, Steps: 12 | Train Loss: 2.091 Vali Loss: 1.910 Vali Acc: 0.456 Test Loss: 1.910 Test Acc: 0.456
Validation loss decreased (-0.399980 --> -0.455536).  Saving model ...
Epoch: 8 cost time: 2.181267023086548
Epoch: 8, Steps: 12 | Train Loss: 1.892 Vali Loss: 1.808 Vali Acc: 0.517 Test Loss: 1.808 Test Acc: 0.517
Validation loss decreased (-0.455536 --> -0.516649).  Saving model ...
Epoch: 9 cost time: 2.470672369003296
Epoch: 9, Steps: 12 | Train Loss: 1.766 Vali Loss: 1.717 Vali Acc: 0.583 Test Loss: 1.717 Test Acc: 0.583
Validation loss decreased (-0.516649 --> -0.583316).  Saving model ...
Epoch: 10 cost time: 2.5005173683166504
Epoch: 10, Steps: 12 | Train Loss: 1.644 Vali Loss: 1.616 Vali Acc: 0.589 Test Loss: 1.616 Test Acc: 0.589
Validation loss decreased (-0.583316 --> -0.588873).  Saving model ...
Epoch: 11 cost time: 2.4575045108795166
Epoch: 11, Steps: 12 | Train Loss: 1.567 Vali Loss: 1.547 Vali Acc: 0.644 Test Loss: 1.547 Test Acc: 0.644
Validation loss decreased (-0.588873 --> -0.644429).  Saving model ...
Epoch: 12 cost time: 2.469482898712158
Epoch: 12, Steps: 12 | Train Loss: 1.430 Vali Loss: 1.453 Vali Acc: 0.661 Test Loss: 1.453 Test Acc: 0.661
Validation loss decreased (-0.644429 --> -0.661097).  Saving model ...
Epoch: 13 cost time: 2.1082088947296143
Epoch: 13, Steps: 12 | Train Loss: 1.349 Vali Loss: 1.391 Vali Acc: 0.672 Test Loss: 1.391 Test Acc: 0.672
Validation loss decreased (-0.661097 --> -0.672208).  Saving model ...
Epoch: 14 cost time: 1.8579835891723633
Epoch: 14, Steps: 12 | Train Loss: 1.257 Vali Loss: 1.334 Vali Acc: 0.689 Test Loss: 1.334 Test Acc: 0.689
Validation loss decreased (-0.672208 --> -0.688876).  Saving model ...
Epoch: 15 cost time: 2.0227863788604736
Epoch: 15, Steps: 12 | Train Loss: 1.216 Vali Loss: 1.260 Vali Acc: 0.689 Test Loss: 1.260 Test Acc: 0.689
Validation loss decreased (-0.688876 --> -0.688876).  Saving model ...
Epoch: 16 cost time: 1.8980114459991455
Epoch: 16, Steps: 12 | Train Loss: 1.052 Vali Loss: 1.216 Vali Acc: 0.739 Test Loss: 1.216 Test Acc: 0.739
Validation loss decreased (-0.688876 --> -0.738877).  Saving model ...
Epoch: 17 cost time: 2.1531362533569336
Epoch: 17, Steps: 12 | Train Loss: 1.057 Vali Loss: 1.143 Vali Acc: 0.733 Test Loss: 1.143 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.3241994380950928
Epoch: 18, Steps: 12 | Train Loss: 0.948 Vali Loss: 1.096 Vali Acc: 0.722 Test Loss: 1.096 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.4130771160125732
Epoch: 19, Steps: 12 | Train Loss: 0.892 Vali Loss: 1.032 Vali Acc: 0.750 Test Loss: 1.032 Test Acc: 0.750
Validation loss decreased (-0.738877 --> -0.749990).  Saving model ...
Epoch: 20 cost time: 2.1821255683898926
Epoch: 20, Steps: 12 | Train Loss: 0.838 Vali Loss: 1.019 Vali Acc: 0.761 Test Loss: 1.019 Test Acc: 0.761
Validation loss decreased (-0.749990 --> -0.761101).  Saving model ...
Epoch: 21 cost time: 2.116755962371826
Epoch: 21, Steps: 12 | Train Loss: 0.804 Vali Loss: 0.928 Vali Acc: 0.789 Test Loss: 0.928 Test Acc: 0.789
Validation loss decreased (-0.761101 --> -0.788880).  Saving model ...
Epoch: 22 cost time: 2.2645058631896973
Epoch: 22, Steps: 12 | Train Loss: 0.753 Vali Loss: 0.953 Vali Acc: 0.739 Test Loss: 0.953 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.269838809967041
Epoch: 23, Steps: 12 | Train Loss: 0.752 Vali Loss: 0.884 Vali Acc: 0.794 Test Loss: 0.884 Test Acc: 0.794
Validation loss decreased (-0.788880 --> -0.794436).  Saving model ...
Epoch: 24 cost time: 2.4823086261749268
Epoch: 24, Steps: 12 | Train Loss: 0.652 Vali Loss: 0.884 Vali Acc: 0.761 Test Loss: 0.884 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.2840726375579834
Epoch: 25, Steps: 12 | Train Loss: 0.610 Vali Loss: 0.818 Vali Acc: 0.828 Test Loss: 0.818 Test Acc: 0.828
Validation loss decreased (-0.794436 --> -0.827770).  Saving model ...
Epoch: 26 cost time: 2.1943886280059814
Epoch: 26, Steps: 12 | Train Loss: 0.566 Vali Loss: 0.746 Vali Acc: 0.817 Test Loss: 0.746 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8843412399291992
Epoch: 27, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.760 Vali Acc: 0.833 Test Loss: 0.760 Test Acc: 0.833
Validation loss decreased (-0.827770 --> -0.833326).  Saving model ...
Epoch: 28 cost time: 2.2602806091308594
Epoch: 28, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.694 Vali Acc: 0.822 Test Loss: 0.694 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.3532397747039795
Epoch: 29, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.655 Vali Acc: 0.839 Test Loss: 0.655 Test Acc: 0.839
Validation loss decreased (-0.833326 --> -0.838882).  Saving model ...
Epoch: 30 cost time: 2.0254170894622803
Epoch: 30, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.637 Vali Acc: 0.850 Test Loss: 0.637 Test Acc: 0.850
Validation loss decreased (-0.838882 --> -0.849994).  Saving model ...
Epoch: 31 cost time: 1.9449875354766846
Epoch: 31, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.626 Vali Acc: 0.850 Test Loss: 0.626 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 32 cost time: 1.9455628395080566
Epoch: 32, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.621 Vali Acc: 0.844 Test Loss: 0.621 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.5145411491394043
Epoch: 33, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.609 Vali Acc: 0.833 Test Loss: 0.609 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.329045057296753
Epoch: 34, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.586 Vali Acc: 0.839 Test Loss: 0.586 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.181612014770508
Epoch: 35, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.573 Vali Acc: 0.861 Test Loss: 0.573 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 36 cost time: 2.2615442276000977
Epoch: 36, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.544 Vali Acc: 0.844 Test Loss: 0.544 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.0945067405700684
Epoch: 37, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.582 Vali Acc: 0.844 Test Loss: 0.582 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.3632144927978516
Epoch: 38, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.541 Vali Acc: 0.844 Test Loss: 0.541 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.0946714878082275
Epoch: 39, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.571 Vali Acc: 0.856 Test Loss: 0.571 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.335094451904297
Epoch: 40, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.533 Vali Acc: 0.861 Test Loss: 0.533 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861106).  Saving model ...
Epoch: 41 cost time: 2.081146717071533
Epoch: 41, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.568 Vali Acc: 0.839 Test Loss: 0.568 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.27030873298645
Epoch: 42, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.615 Vali Acc: 0.828 Test Loss: 0.615 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.471970796585083
Epoch: 43, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.582 Vali Acc: 0.833 Test Loss: 0.582 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 2.361367702484131
Epoch: 44, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.528 Vali Acc: 0.856 Test Loss: 0.528 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 2.449740409851074
Epoch: 45, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.571 Vali Acc: 0.839 Test Loss: 0.571 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 2.392847776412964
Epoch: 46, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.564 Vali Acc: 0.872 Test Loss: 0.564 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 47 cost time: 2.2431347370147705
Epoch: 47, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.561 Vali Acc: 0.850 Test Loss: 0.561 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 2.5504648685455322
Epoch: 48, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.564 Vali Acc: 0.872 Test Loss: 0.564 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 2.151365041732788
Epoch: 49, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.598 Vali Acc: 0.844 Test Loss: 0.598 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 2.227781057357788
Epoch: 50, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.585 Vali Acc: 0.839 Test Loss: 0.585 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 2.3263683319091797
Epoch: 51, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.576 Vali Acc: 0.867 Test Loss: 0.576 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 2.514552593231201
Epoch: 52, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.562 Vali Acc: 0.822 Test Loss: 0.562 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 2.577284097671509
Epoch: 53, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.584 Vali Acc: 0.844 Test Loss: 0.584 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 2.8580522537231445
Epoch: 54, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.589 Vali Acc: 0.867 Test Loss: 0.589 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 2.1629199981689453
Epoch: 55, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.603 Vali Acc: 0.850 Test Loss: 0.603 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 2.204925060272217
Epoch: 56, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.632 Vali Acc: 0.839 Test Loss: 0.632 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 759339
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.135421991348267
Epoch: 1, Steps: 12 | Train Loss: 2.896 Vali Loss: 2.715 Vali Acc: 0.172 Test Loss: 2.715 Test Acc: 0.172
Validation loss decreased (inf --> -0.172195).  Saving model ...
Epoch: 2 cost time: 2.06860089302063
Epoch: 2, Steps: 12 | Train Loss: 2.765 Vali Loss: 2.611 Vali Acc: 0.111 Test Loss: 2.611 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1164333820343018
Epoch: 3, Steps: 12 | Train Loss: 2.627 Vali Loss: 2.529 Vali Acc: 0.200 Test Loss: 2.529 Test Acc: 0.200
Validation loss decreased (-0.172195 --> -0.199975).  Saving model ...
Epoch: 4 cost time: 2.0324532985687256
Epoch: 4, Steps: 12 | Train Loss: 2.493 Vali Loss: 2.422 Vali Acc: 0.278 Test Loss: 2.422 Test Acc: 0.278
Validation loss decreased (-0.199975 --> -0.277754).  Saving model ...
Epoch: 5 cost time: 1.9964628219604492
Epoch: 5, Steps: 12 | Train Loss: 2.303 Vali Loss: 2.290 Vali Acc: 0.278 Test Loss: 2.290 Test Acc: 0.278
Validation loss decreased (-0.277754 --> -0.277755).  Saving model ...
Epoch: 6 cost time: 2.0327394008636475
Epoch: 6, Steps: 12 | Train Loss: 2.191 Vali Loss: 2.151 Vali Acc: 0.428 Test Loss: 2.151 Test Acc: 0.428
Validation loss decreased (-0.277755 --> -0.427756).  Saving model ...
Epoch: 7 cost time: 2.5061464309692383
Epoch: 7, Steps: 12 | Train Loss: 2.090 Vali Loss: 2.040 Vali Acc: 0.461 Test Loss: 2.040 Test Acc: 0.461
Validation loss decreased (-0.427756 --> -0.461091).  Saving model ...
Epoch: 8 cost time: 2.6254239082336426
Epoch: 8, Steps: 12 | Train Loss: 1.972 Vali Loss: 1.950 Vali Acc: 0.483 Test Loss: 1.950 Test Acc: 0.483
Validation loss decreased (-0.461091 --> -0.483314).  Saving model ...
Epoch: 9 cost time: 1.9380240440368652
Epoch: 9, Steps: 12 | Train Loss: 1.851 Vali Loss: 1.867 Vali Acc: 0.500 Test Loss: 1.867 Test Acc: 0.500
Validation loss decreased (-0.483314 --> -0.499981).  Saving model ...
Epoch: 10 cost time: 1.9819080829620361
Epoch: 10, Steps: 12 | Train Loss: 1.755 Vali Loss: 1.786 Vali Acc: 0.544 Test Loss: 1.786 Test Acc: 0.544
Validation loss decreased (-0.499981 --> -0.544427).  Saving model ...
Epoch: 11 cost time: 2.0819883346557617
Epoch: 11, Steps: 12 | Train Loss: 1.658 Vali Loss: 1.722 Vali Acc: 0.539 Test Loss: 1.722 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9815819263458252
Epoch: 12, Steps: 12 | Train Loss: 1.551 Vali Loss: 1.621 Vali Acc: 0.583 Test Loss: 1.621 Test Acc: 0.583
Validation loss decreased (-0.544427 --> -0.583317).  Saving model ...
Epoch: 13 cost time: 2.1751484870910645
Epoch: 13, Steps: 12 | Train Loss: 1.452 Vali Loss: 1.538 Vali Acc: 0.644 Test Loss: 1.538 Test Acc: 0.644
Validation loss decreased (-0.583317 --> -0.644429).  Saving model ...
Epoch: 14 cost time: 1.8600459098815918
Epoch: 14, Steps: 12 | Train Loss: 1.376 Vali Loss: 1.462 Vali Acc: 0.672 Test Loss: 1.462 Test Acc: 0.672
Validation loss decreased (-0.644429 --> -0.672208).  Saving model ...
Epoch: 15 cost time: 2.108515739440918
Epoch: 15, Steps: 12 | Train Loss: 1.296 Vali Loss: 1.380 Vali Acc: 0.672 Test Loss: 1.380 Test Acc: 0.672
Validation loss decreased (-0.672208 --> -0.672208).  Saving model ...
Epoch: 16 cost time: 1.91862154006958
Epoch: 16, Steps: 12 | Train Loss: 1.192 Vali Loss: 1.320 Vali Acc: 0.706 Test Loss: 1.320 Test Acc: 0.706
Validation loss decreased (-0.672208 --> -0.705542).  Saving model ...
Epoch: 17 cost time: 2.014364004135132
Epoch: 17, Steps: 12 | Train Loss: 1.131 Vali Loss: 1.228 Vali Acc: 0.728 Test Loss: 1.228 Test Acc: 0.728
Validation loss decreased (-0.705542 --> -0.727765).  Saving model ...
Epoch: 18 cost time: 1.831075668334961
Epoch: 18, Steps: 12 | Train Loss: 1.095 Vali Loss: 1.187 Vali Acc: 0.711 Test Loss: 1.187 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0383172035217285
Epoch: 19, Steps: 12 | Train Loss: 0.957 Vali Loss: 1.085 Vali Acc: 0.744 Test Loss: 1.085 Test Acc: 0.744
Validation loss decreased (-0.727765 --> -0.744434).  Saving model ...
Epoch: 20 cost time: 2.369403600692749
Epoch: 20, Steps: 12 | Train Loss: 0.884 Vali Loss: 1.038 Vali Acc: 0.761 Test Loss: 1.038 Test Acc: 0.761
Validation loss decreased (-0.744434 --> -0.761101).  Saving model ...
Epoch: 21 cost time: 2.2013466358184814
Epoch: 21, Steps: 12 | Train Loss: 0.804 Vali Loss: 0.956 Vali Acc: 0.778 Test Loss: 0.956 Test Acc: 0.778
Validation loss decreased (-0.761101 --> -0.777768).  Saving model ...
Epoch: 22 cost time: 1.907944679260254
Epoch: 22, Steps: 12 | Train Loss: 0.739 Vali Loss: 0.921 Vali Acc: 0.783 Test Loss: 0.921 Test Acc: 0.783
Validation loss decreased (-0.777768 --> -0.783324).  Saving model ...
Epoch: 23 cost time: 2.0819778442382812
Epoch: 23, Steps: 12 | Train Loss: 0.680 Vali Loss: 0.860 Vali Acc: 0.794 Test Loss: 0.860 Test Acc: 0.794
Validation loss decreased (-0.783324 --> -0.794436).  Saving model ...
Epoch: 24 cost time: 1.7209062576293945
Epoch: 24, Steps: 12 | Train Loss: 0.624 Vali Loss: 0.818 Vali Acc: 0.828 Test Loss: 0.818 Test Acc: 0.828
Validation loss decreased (-0.794436 --> -0.827770).  Saving model ...
Epoch: 25 cost time: 2.0272767543792725
Epoch: 25, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.817 Vali Acc: 0.778 Test Loss: 0.817 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9565017223358154
Epoch: 26, Steps: 12 | Train Loss: 0.528 Vali Loss: 0.775 Vali Acc: 0.817 Test Loss: 0.775 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.2557950019836426
Epoch: 27, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.740 Vali Acc: 0.811 Test Loss: 0.740 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.016735792160034
Epoch: 28, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.744 Vali Acc: 0.811 Test Loss: 0.744 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.7426636219024658
Epoch: 29, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.730 Vali Acc: 0.806 Test Loss: 0.730 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.0228607654571533
Epoch: 30, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.653 Vali Acc: 0.817 Test Loss: 0.653 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.9650423526763916
Epoch: 31, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.671 Vali Acc: 0.800 Test Loss: 0.671 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.2139992713928223
Epoch: 32, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.661 Vali Acc: 0.833 Test Loss: 0.661 Test Acc: 0.833
Validation loss decreased (-0.827770 --> -0.833327).  Saving model ...
Epoch: 33 cost time: 1.9393811225891113
Epoch: 33, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.664 Vali Acc: 0.811 Test Loss: 0.664 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.8093898296356201
Epoch: 34, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.626 Vali Acc: 0.828 Test Loss: 0.626 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.0125815868377686
Epoch: 35, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.657 Vali Acc: 0.811 Test Loss: 0.657 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.7865450382232666
Epoch: 36, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.651 Vali Acc: 0.817 Test Loss: 0.651 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.8192036151885986
Epoch: 37, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.686 Vali Acc: 0.822 Test Loss: 0.686 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.9404408931732178
Epoch: 38, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.599 Vali Acc: 0.839 Test Loss: 0.599 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 39 cost time: 2.079991340637207
Epoch: 39, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.602 Vali Acc: 0.833 Test Loss: 0.602 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.114708423614502
Epoch: 40, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.667 Vali Acc: 0.800 Test Loss: 0.667 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.1776113510131836
Epoch: 41, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.534 Vali Acc: 0.844 Test Loss: 0.534 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 42 cost time: 2.4687705039978027
Epoch: 42, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.583 Vali Acc: 0.833 Test Loss: 0.583 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.899118423461914
Epoch: 43, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.589 Vali Acc: 0.839 Test Loss: 0.589 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.917626142501831
Epoch: 44, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.589 Vali Acc: 0.822 Test Loss: 0.589 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 2.3395912647247314
Epoch: 45, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.567 Vali Acc: 0.828 Test Loss: 0.567 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 2.1920268535614014
Epoch: 46, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.616 Vali Acc: 0.833 Test Loss: 0.616 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 2.4071285724639893
Epoch: 47, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.548 Vali Acc: 0.850 Test Loss: 0.548 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849995).  Saving model ...
Epoch: 48 cost time: 2.08181095123291
Epoch: 48, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.518 Vali Acc: 0.844 Test Loss: 0.518 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.9663710594177246
Epoch: 49, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.571 Vali Acc: 0.856 Test Loss: 0.571 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855550).  Saving model ...
Epoch: 50 cost time: 1.7470216751098633
Epoch: 50, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.575 Vali Acc: 0.828 Test Loss: 0.575 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.8975741863250732
Epoch: 51, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.597 Vali Acc: 0.856 Test Loss: 0.597 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.77656888961792
Epoch: 52, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.498 Vali Acc: 0.872 Test Loss: 0.498 Test Acc: 0.872
Validation loss decreased (-0.855550 --> -0.872217).  Saving model ...
Epoch: 53 cost time: 2.0701699256896973
Epoch: 53, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.527 Vali Acc: 0.872 Test Loss: 0.527 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 2.2070107460021973
Epoch: 54, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.526 Vali Acc: 0.861 Test Loss: 0.526 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.7283031940460205
Epoch: 55, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.596 Vali Acc: 0.822 Test Loss: 0.596 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.9804177284240723
Epoch: 56, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.559 Vali Acc: 0.850 Test Loss: 0.559 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 2.132197141647339
Epoch: 57, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.541 Vali Acc: 0.861 Test Loss: 0.541 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 2.3474793434143066
Epoch: 58, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.516 Vali Acc: 0.872 Test Loss: 0.516 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 2.18711256980896
Epoch: 59, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.537 Vali Acc: 0.872 Test Loss: 0.537 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 2.0774731636047363
Epoch: 60, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.535 Vali Acc: 0.856 Test Loss: 0.535 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 2.192138671875
Epoch: 61, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.619 Vali Acc: 0.839 Test Loss: 0.619 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 2.155792474746704
Epoch: 62, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.604 Vali Acc: 0.833 Test Loss: 0.604 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 759083
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.472883462905884
Epoch: 1, Steps: 12 | Train Loss: 2.823 Vali Loss: 2.730 Vali Acc: 0.006 Test Loss: 2.730 Test Acc: 0.006
Validation loss decreased (inf --> -0.005528).  Saving model ...
Epoch: 2 cost time: 2.207695484161377
Epoch: 2, Steps: 12 | Train Loss: 2.699 Vali Loss: 2.578 Vali Acc: 0.133 Test Loss: 2.578 Test Acc: 0.133
Validation loss decreased (-0.005528 --> -0.133308).  Saving model ...
Epoch: 3 cost time: 2.35416841506958
Epoch: 3, Steps: 12 | Train Loss: 2.534 Vali Loss: 2.437 Vali Acc: 0.294 Test Loss: 2.437 Test Acc: 0.294
Validation loss decreased (-0.133308 --> -0.294420).  Saving model ...
Epoch: 4 cost time: 2.182915449142456
Epoch: 4, Steps: 12 | Train Loss: 2.337 Vali Loss: 2.259 Vali Acc: 0.400 Test Loss: 2.259 Test Acc: 0.400
Validation loss decreased (-0.294420 --> -0.399977).  Saving model ...
Epoch: 5 cost time: 2.243370532989502
Epoch: 5, Steps: 12 | Train Loss: 2.181 Vali Loss: 2.149 Vali Acc: 0.400 Test Loss: 2.149 Test Acc: 0.400
Validation loss decreased (-0.399977 --> -0.399979).  Saving model ...
Epoch: 6 cost time: 2.4861955642700195
Epoch: 6, Steps: 12 | Train Loss: 1.991 Vali Loss: 2.020 Vali Acc: 0.478 Test Loss: 2.020 Test Acc: 0.478
Validation loss decreased (-0.399979 --> -0.477758).  Saving model ...
Epoch: 7 cost time: 1.941587209701538
Epoch: 7, Steps: 12 | Train Loss: 1.863 Vali Loss: 1.934 Vali Acc: 0.428 Test Loss: 1.934 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7297823429107666
Epoch: 8, Steps: 12 | Train Loss: 1.805 Vali Loss: 1.824 Vali Acc: 0.494 Test Loss: 1.824 Test Acc: 0.494
Validation loss decreased (-0.477758 --> -0.494426).  Saving model ...
Epoch: 9 cost time: 2.0673811435699463
Epoch: 9, Steps: 12 | Train Loss: 1.734 Vali Loss: 1.747 Vali Acc: 0.539 Test Loss: 1.747 Test Acc: 0.539
Validation loss decreased (-0.494426 --> -0.538871).  Saving model ...
Epoch: 10 cost time: 1.8048570156097412
Epoch: 10, Steps: 12 | Train Loss: 1.586 Vali Loss: 1.630 Vali Acc: 0.572 Test Loss: 1.630 Test Acc: 0.572
Validation loss decreased (-0.538871 --> -0.572206).  Saving model ...
Epoch: 11 cost time: 2.12093186378479
Epoch: 11, Steps: 12 | Train Loss: 1.463 Vali Loss: 1.537 Vali Acc: 0.656 Test Loss: 1.537 Test Acc: 0.656
Validation loss decreased (-0.572206 --> -0.655540).  Saving model ...
Epoch: 12 cost time: 2.111593008041382
Epoch: 12, Steps: 12 | Train Loss: 1.354 Vali Loss: 1.450 Vali Acc: 0.661 Test Loss: 1.450 Test Acc: 0.661
Validation loss decreased (-0.655540 --> -0.661097).  Saving model ...
Epoch: 13 cost time: 1.8017377853393555
Epoch: 13, Steps: 12 | Train Loss: 1.233 Vali Loss: 1.328 Vali Acc: 0.717 Test Loss: 1.328 Test Acc: 0.717
Validation loss decreased (-0.661097 --> -0.716653).  Saving model ...
Epoch: 14 cost time: 2.1345040798187256
Epoch: 14, Steps: 12 | Train Loss: 1.197 Vali Loss: 1.261 Vali Acc: 0.689 Test Loss: 1.261 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.896301507949829
Epoch: 15, Steps: 12 | Train Loss: 1.052 Vali Loss: 1.181 Vali Acc: 0.733 Test Loss: 1.181 Test Acc: 0.733
Validation loss decreased (-0.716653 --> -0.733322).  Saving model ...
Epoch: 16 cost time: 1.9507639408111572
Epoch: 16, Steps: 12 | Train Loss: 1.009 Vali Loss: 1.112 Vali Acc: 0.772 Test Loss: 1.112 Test Acc: 0.772
Validation loss decreased (-0.733322 --> -0.772211).  Saving model ...
Epoch: 17 cost time: 1.853006362915039
Epoch: 17, Steps: 12 | Train Loss: 0.920 Vali Loss: 1.061 Vali Acc: 0.767 Test Loss: 1.061 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0493762493133545
Epoch: 18, Steps: 12 | Train Loss: 0.872 Vali Loss: 0.966 Vali Acc: 0.811 Test Loss: 0.966 Test Acc: 0.811
Validation loss decreased (-0.772211 --> -0.811101).  Saving model ...
Epoch: 19 cost time: 1.7396445274353027
Epoch: 19, Steps: 12 | Train Loss: 0.804 Vali Loss: 0.927 Vali Acc: 0.800 Test Loss: 0.927 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.085487127304077
Epoch: 20, Steps: 12 | Train Loss: 0.758 Vali Loss: 0.860 Vali Acc: 0.817 Test Loss: 0.860 Test Acc: 0.817
Validation loss decreased (-0.811101 --> -0.816658).  Saving model ...
Epoch: 21 cost time: 1.9520978927612305
Epoch: 21, Steps: 12 | Train Loss: 0.708 Vali Loss: 0.826 Vali Acc: 0.817 Test Loss: 0.826 Test Acc: 0.817
Validation loss decreased (-0.816658 --> -0.816658).  Saving model ...
Epoch: 22 cost time: 2.0358529090881348
Epoch: 22, Steps: 12 | Train Loss: 0.623 Vali Loss: 0.780 Vali Acc: 0.828 Test Loss: 0.780 Test Acc: 0.828
Validation loss decreased (-0.816658 --> -0.827770).  Saving model ...
Epoch: 23 cost time: 1.6986432075500488
Epoch: 23, Steps: 12 | Train Loss: 0.595 Vali Loss: 0.712 Vali Acc: 0.856 Test Loss: 0.712 Test Acc: 0.856
Validation loss decreased (-0.827770 --> -0.855548).  Saving model ...
Epoch: 24 cost time: 1.9441797733306885
Epoch: 24, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.696 Vali Acc: 0.839 Test Loss: 0.696 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9715921878814697
Epoch: 25, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.695 Vali Acc: 0.833 Test Loss: 0.695 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.7391963005065918
Epoch: 26, Steps: 12 | Train Loss: 0.496 Vali Loss: 0.648 Vali Acc: 0.833 Test Loss: 0.648 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.9226336479187012
Epoch: 27, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.617 Vali Acc: 0.850 Test Loss: 0.617 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.9926247596740723
Epoch: 28, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.561 Vali Acc: 0.844 Test Loss: 0.561 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.4248592853546143
Epoch: 29, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.595 Vali Acc: 0.867 Test Loss: 0.595 Test Acc: 0.867
Validation loss decreased (-0.855548 --> -0.866661).  Saving model ...
Epoch: 30 cost time: 1.9397709369659424
Epoch: 30, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.607 Vali Acc: 0.822 Test Loss: 0.607 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.1647210121154785
Epoch: 31, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.532 Vali Acc: 0.839 Test Loss: 0.532 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.9089617729187012
Epoch: 32, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.527 Vali Acc: 0.856 Test Loss: 0.527 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.9821734428405762
Epoch: 33, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.556 Vali Acc: 0.850 Test Loss: 0.556 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.2443363666534424
Epoch: 34, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.482 Vali Acc: 0.861 Test Loss: 0.482 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.0690557956695557
Epoch: 35, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.531 Vali Acc: 0.856 Test Loss: 0.531 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.2353482246398926
Epoch: 36, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.475 Vali Acc: 0.861 Test Loss: 0.475 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.0953640937805176
Epoch: 37, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.490 Vali Acc: 0.872 Test Loss: 0.490 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 38 cost time: 2.244969129562378
Epoch: 38, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.465 Vali Acc: 0.867 Test Loss: 0.465 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.192216157913208
Epoch: 39, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.475 Vali Acc: 0.867 Test Loss: 0.475 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.570955991744995
Epoch: 40, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.488 Vali Acc: 0.850 Test Loss: 0.488 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.4376730918884277
Epoch: 41, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.474 Vali Acc: 0.867 Test Loss: 0.474 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.9416553974151611
Epoch: 42, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.519 Vali Acc: 0.850 Test Loss: 0.519 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 2.2795863151550293
Epoch: 43, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.450 Vali Acc: 0.856 Test Loss: 0.450 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 2.1409475803375244
Epoch: 44, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.477 Vali Acc: 0.856 Test Loss: 0.477 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 2.154000997543335
Epoch: 45, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.434 Vali Acc: 0.861 Test Loss: 0.434 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 2.1487550735473633
Epoch: 46, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.556 Vali Acc: 0.850 Test Loss: 0.556 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 2.4949419498443604
Epoch: 47, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.386 Vali Acc: 0.861 Test Loss: 0.386 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 758827
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7658042907714844
Epoch: 1, Steps: 12 | Train Loss: 2.810 Vali Loss: 2.755 Vali Acc: 0.067 Test Loss: 2.755 Test Acc: 0.067
Validation loss decreased (inf --> -0.066639).  Saving model ...
Epoch: 2 cost time: 2.4055893421173096
Epoch: 2, Steps: 12 | Train Loss: 2.735 Vali Loss: 2.635 Vali Acc: 0.150 Test Loss: 2.635 Test Acc: 0.150
Validation loss decreased (-0.066639 --> -0.149974).  Saving model ...
Epoch: 3 cost time: 2.487905502319336
Epoch: 3, Steps: 12 | Train Loss: 2.633 Vali Loss: 2.535 Vali Acc: 0.228 Test Loss: 2.535 Test Acc: 0.228
Validation loss decreased (-0.149974 --> -0.227752).  Saving model ...
Epoch: 4 cost time: 2.4584619998931885
Epoch: 4, Steps: 12 | Train Loss: 2.516 Vali Loss: 2.404 Vali Acc: 0.261 Test Loss: 2.404 Test Acc: 0.261
Validation loss decreased (-0.227752 --> -0.261087).  Saving model ...
Epoch: 5 cost time: 2.4329118728637695
Epoch: 5, Steps: 12 | Train Loss: 2.413 Vali Loss: 2.288 Vali Acc: 0.306 Test Loss: 2.288 Test Acc: 0.306
Validation loss decreased (-0.261087 --> -0.305533).  Saving model ...
Epoch: 6 cost time: 1.7207834720611572
Epoch: 6, Steps: 12 | Train Loss: 2.260 Vali Loss: 2.170 Vali Acc: 0.400 Test Loss: 2.170 Test Acc: 0.400
Validation loss decreased (-0.305533 --> -0.399978).  Saving model ...
Epoch: 7 cost time: 2.6092684268951416
Epoch: 7, Steps: 12 | Train Loss: 2.166 Vali Loss: 2.077 Vali Acc: 0.422 Test Loss: 2.077 Test Acc: 0.422
Validation loss decreased (-0.399978 --> -0.422201).  Saving model ...
Epoch: 8 cost time: 2.1429224014282227
Epoch: 8, Steps: 12 | Train Loss: 2.068 Vali Loss: 2.015 Vali Acc: 0.428 Test Loss: 2.015 Test Acc: 0.428
Validation loss decreased (-0.422201 --> -0.427758).  Saving model ...
Epoch: 9 cost time: 1.8238894939422607
Epoch: 9, Steps: 12 | Train Loss: 1.963 Vali Loss: 1.968 Vali Acc: 0.439 Test Loss: 1.968 Test Acc: 0.439
Validation loss decreased (-0.427758 --> -0.438869).  Saving model ...
Epoch: 10 cost time: 2.2367403507232666
Epoch: 10, Steps: 12 | Train Loss: 1.846 Vali Loss: 1.861 Vali Acc: 0.522 Test Loss: 1.861 Test Acc: 0.522
Validation loss decreased (-0.438869 --> -0.522204).  Saving model ...
Epoch: 11 cost time: 1.9741883277893066
Epoch: 11, Steps: 12 | Train Loss: 1.800 Vali Loss: 1.814 Vali Acc: 0.533 Test Loss: 1.814 Test Acc: 0.533
Validation loss decreased (-0.522204 --> -0.533315).  Saving model ...
Epoch: 12 cost time: 2.114450693130493
Epoch: 12, Steps: 12 | Train Loss: 1.693 Vali Loss: 1.719 Vali Acc: 0.533 Test Loss: 1.719 Test Acc: 0.533
Validation loss decreased (-0.533315 --> -0.533316).  Saving model ...
Epoch: 13 cost time: 2.1309735774993896
Epoch: 13, Steps: 12 | Train Loss: 1.619 Vali Loss: 1.668 Vali Acc: 0.528 Test Loss: 1.668 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.137007713317871
Epoch: 14, Steps: 12 | Train Loss: 1.502 Vali Loss: 1.569 Vali Acc: 0.578 Test Loss: 1.569 Test Acc: 0.578
Validation loss decreased (-0.533316 --> -0.577762).  Saving model ...
Epoch: 15 cost time: 2.23675799369812
Epoch: 15, Steps: 12 | Train Loss: 1.404 Vali Loss: 1.483 Vali Acc: 0.656 Test Loss: 1.483 Test Acc: 0.656
Validation loss decreased (-0.577762 --> -0.655541).  Saving model ...
Epoch: 16 cost time: 1.924924373626709
Epoch: 16, Steps: 12 | Train Loss: 1.395 Vali Loss: 1.404 Vali Acc: 0.633 Test Loss: 1.404 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2195193767547607
Epoch: 17, Steps: 12 | Train Loss: 1.274 Vali Loss: 1.342 Vali Acc: 0.678 Test Loss: 1.342 Test Acc: 0.678
Validation loss decreased (-0.655541 --> -0.677764).  Saving model ...
Epoch: 18 cost time: 2.0470168590545654
Epoch: 18, Steps: 12 | Train Loss: 1.180 Vali Loss: 1.266 Vali Acc: 0.733 Test Loss: 1.266 Test Acc: 0.733
Validation loss decreased (-0.677764 --> -0.733321).  Saving model ...
Epoch: 19 cost time: 2.2751662731170654
Epoch: 19, Steps: 12 | Train Loss: 1.115 Vali Loss: 1.167 Vali Acc: 0.778 Test Loss: 1.167 Test Acc: 0.778
Validation loss decreased (-0.733321 --> -0.777766).  Saving model ...
Epoch: 20 cost time: 2.3607611656188965
Epoch: 20, Steps: 12 | Train Loss: 1.031 Vali Loss: 1.143 Vali Acc: 0.744 Test Loss: 1.143 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.1560893058776855
Epoch: 21, Steps: 12 | Train Loss: 1.014 Vali Loss: 1.053 Vali Acc: 0.789 Test Loss: 1.053 Test Acc: 0.789
Validation loss decreased (-0.777766 --> -0.788878).  Saving model ...
Epoch: 22 cost time: 2.046417236328125
Epoch: 22, Steps: 12 | Train Loss: 0.944 Vali Loss: 1.036 Vali Acc: 0.794 Test Loss: 1.036 Test Acc: 0.794
Validation loss decreased (-0.788878 --> -0.794434).  Saving model ...
Epoch: 23 cost time: 2.1604278087615967
Epoch: 23, Steps: 12 | Train Loss: 0.816 Vali Loss: 0.942 Vali Acc: 0.817 Test Loss: 0.942 Test Acc: 0.817
Validation loss decreased (-0.794434 --> -0.816657).  Saving model ...
Epoch: 24 cost time: 2.9421162605285645
Epoch: 24, Steps: 12 | Train Loss: 0.846 Vali Loss: 0.947 Vali Acc: 0.794 Test Loss: 0.947 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.914961814880371
Epoch: 25, Steps: 12 | Train Loss: 0.780 Vali Loss: 0.893 Vali Acc: 0.817 Test Loss: 0.893 Test Acc: 0.817
Validation loss decreased (-0.816657 --> -0.816658).  Saving model ...
Epoch: 26 cost time: 2.064296245574951
Epoch: 26, Steps: 12 | Train Loss: 0.680 Vali Loss: 0.857 Vali Acc: 0.828 Test Loss: 0.857 Test Acc: 0.828
Validation loss decreased (-0.816658 --> -0.827769).  Saving model ...
Epoch: 27 cost time: 2.586508274078369
Epoch: 27, Steps: 12 | Train Loss: 0.677 Vali Loss: 0.826 Vali Acc: 0.839 Test Loss: 0.826 Test Acc: 0.839
Validation loss decreased (-0.827769 --> -0.838881).  Saving model ...
Epoch: 28 cost time: 2.4608545303344727
Epoch: 28, Steps: 12 | Train Loss: 0.614 Vali Loss: 0.797 Vali Acc: 0.839 Test Loss: 0.797 Test Acc: 0.839
Validation loss decreased (-0.838881 --> -0.838881).  Saving model ...
Epoch: 29 cost time: 2.1277287006378174
Epoch: 29, Steps: 12 | Train Loss: 0.574 Vali Loss: 0.794 Vali Acc: 0.794 Test Loss: 0.794 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.0281639099121094
Epoch: 30, Steps: 12 | Train Loss: 0.596 Vali Loss: 0.709 Vali Acc: 0.839 Test Loss: 0.709 Test Acc: 0.839
Validation loss decreased (-0.838881 --> -0.838882).  Saving model ...
Epoch: 31 cost time: 2.03855299949646
Epoch: 31, Steps: 12 | Train Loss: 0.513 Vali Loss: 0.680 Vali Acc: 0.844 Test Loss: 0.680 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 32 cost time: 1.9791524410247803
Epoch: 32, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.664 Vali Acc: 0.844 Test Loss: 0.664 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 33 cost time: 1.7235698699951172
Epoch: 33, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.673 Vali Acc: 0.861 Test Loss: 0.673 Test Acc: 0.861
Validation loss decreased (-0.844438 --> -0.861104).  Saving model ...
Epoch: 34 cost time: 1.7875556945800781
Epoch: 34, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.641 Vali Acc: 0.856 Test Loss: 0.641 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.0326342582702637
Epoch: 35, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.623 Vali Acc: 0.861 Test Loss: 0.623 Test Acc: 0.861
Validation loss decreased (-0.861104 --> -0.861105).  Saving model ...
Epoch: 36 cost time: 2.176955461502075
Epoch: 36, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.593 Vali Acc: 0.861 Test Loss: 0.593 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 37 cost time: 1.9556152820587158
Epoch: 37, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.581 Vali Acc: 0.872 Test Loss: 0.581 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872216).  Saving model ...
Epoch: 38 cost time: 2.165497303009033
Epoch: 38, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.608 Vali Acc: 0.856 Test Loss: 0.608 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.057037353515625
Epoch: 39, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.551 Vali Acc: 0.878 Test Loss: 0.551 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877772).  Saving model ...
Epoch: 40 cost time: 1.9651522636413574
Epoch: 40, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.532 Vali Acc: 0.872 Test Loss: 0.532 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.2103757858276367
Epoch: 41, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.515 Vali Acc: 0.872 Test Loss: 0.515 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.082270383834839
Epoch: 42, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.497 Vali Acc: 0.878 Test Loss: 0.497 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877773).  Saving model ...
Epoch: 43 cost time: 2.130072832107544
Epoch: 43, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.500 Vali Acc: 0.894 Test Loss: 0.500 Test Acc: 0.894
Validation loss decreased (-0.877773 --> -0.894439).  Saving model ...
Epoch: 44 cost time: 2.3250937461853027
Epoch: 44, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.540 Vali Acc: 0.861 Test Loss: 0.540 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.3129050731658936
Epoch: 45, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.508 Vali Acc: 0.872 Test Loss: 0.508 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.0778696537017822
Epoch: 46, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.530 Vali Acc: 0.878 Test Loss: 0.530 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.281158924102783
Epoch: 47, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.484 Vali Acc: 0.867 Test Loss: 0.484 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 2.28218936920166
Epoch: 48, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.483 Vali Acc: 0.883 Test Loss: 0.483 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 2.0745439529418945
Epoch: 49, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.494 Vali Acc: 0.883 Test Loss: 0.494 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 2.2614922523498535
Epoch: 50, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.520 Vali Acc: 0.883 Test Loss: 0.520 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.8341121673583984
Epoch: 51, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.530 Vali Acc: 0.883 Test Loss: 0.530 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 2.202939987182617
Epoch: 52, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.479 Vali Acc: 0.889 Test Loss: 0.479 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 2.1507108211517334
Epoch: 53, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.523 Vali Acc: 0.872 Test Loss: 0.523 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 460075
model size : 2.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.058269023895264
Epoch: 1, Steps: 12 | Train Loss: 2.865 Vali Loss: 2.780 Vali Acc: 0.072 Test Loss: 2.780 Test Acc: 0.072
Validation loss decreased (inf --> -0.072194).  Saving model ...
Epoch: 2 cost time: 2.428478240966797
Epoch: 2, Steps: 12 | Train Loss: 2.772 Vali Loss: 2.697 Vali Acc: 0.078 Test Loss: 2.697 Test Acc: 0.078
Validation loss decreased (-0.072194 --> -0.077751).  Saving model ...
Epoch: 3 cost time: 2.0201475620269775
Epoch: 3, Steps: 12 | Train Loss: 2.730 Vali Loss: 2.635 Vali Acc: 0.111 Test Loss: 2.635 Test Acc: 0.111
Validation loss decreased (-0.077751 --> -0.111085).  Saving model ...
Epoch: 4 cost time: 2.1888341903686523
Epoch: 4, Steps: 12 | Train Loss: 2.669 Vali Loss: 2.545 Vali Acc: 0.306 Test Loss: 2.545 Test Acc: 0.306
Validation loss decreased (-0.111085 --> -0.305530).  Saving model ...
Epoch: 5 cost time: 2.3237082958221436
Epoch: 5, Steps: 12 | Train Loss: 2.515 Vali Loss: 2.425 Vali Acc: 0.317 Test Loss: 2.425 Test Acc: 0.317
Validation loss decreased (-0.305530 --> -0.316642).  Saving model ...
Epoch: 6 cost time: 2.015493154525757
Epoch: 6, Steps: 12 | Train Loss: 2.369 Vali Loss: 2.292 Vali Acc: 0.322 Test Loss: 2.292 Test Acc: 0.322
Validation loss decreased (-0.316642 --> -0.322199).  Saving model ...
Epoch: 7 cost time: 2.1705331802368164
Epoch: 7, Steps: 12 | Train Loss: 2.250 Vali Loss: 2.178 Vali Acc: 0.356 Test Loss: 2.178 Test Acc: 0.356
Validation loss decreased (-0.322199 --> -0.355534).  Saving model ...
Epoch: 8 cost time: 2.2630908489227295
Epoch: 8, Steps: 12 | Train Loss: 2.109 Vali Loss: 2.061 Vali Acc: 0.383 Test Loss: 2.061 Test Acc: 0.383
Validation loss decreased (-0.355534 --> -0.383313).  Saving model ...
Epoch: 9 cost time: 2.1880815029144287
Epoch: 9, Steps: 12 | Train Loss: 2.045 Vali Loss: 1.962 Vali Acc: 0.467 Test Loss: 1.962 Test Acc: 0.467
Validation loss decreased (-0.383313 --> -0.466647).  Saving model ...
Epoch: 10 cost time: 2.0813612937927246
Epoch: 10, Steps: 12 | Train Loss: 1.830 Vali Loss: 1.847 Vali Acc: 0.506 Test Loss: 1.847 Test Acc: 0.506
Validation loss decreased (-0.466647 --> -0.505537).  Saving model ...
Epoch: 11 cost time: 1.9309842586517334
Epoch: 11, Steps: 12 | Train Loss: 1.762 Vali Loss: 1.777 Vali Acc: 0.533 Test Loss: 1.777 Test Acc: 0.533
Validation loss decreased (-0.505537 --> -0.533316).  Saving model ...
Epoch: 12 cost time: 2.076106548309326
Epoch: 12, Steps: 12 | Train Loss: 1.670 Vali Loss: 1.650 Vali Acc: 0.578 Test Loss: 1.650 Test Acc: 0.578
Validation loss decreased (-0.533316 --> -0.577761).  Saving model ...
Epoch: 13 cost time: 2.152785062789917
Epoch: 13, Steps: 12 | Train Loss: 1.592 Vali Loss: 1.596 Vali Acc: 0.617 Test Loss: 1.596 Test Acc: 0.617
Validation loss decreased (-0.577761 --> -0.616651).  Saving model ...
Epoch: 14 cost time: 1.6101198196411133
Epoch: 14, Steps: 12 | Train Loss: 1.507 Vali Loss: 1.511 Vali Acc: 0.656 Test Loss: 1.511 Test Acc: 0.656
Validation loss decreased (-0.616651 --> -0.655540).  Saving model ...
Epoch: 15 cost time: 2.007371187210083
Epoch: 15, Steps: 12 | Train Loss: 1.382 Vali Loss: 1.413 Vali Acc: 0.694 Test Loss: 1.413 Test Acc: 0.694
Validation loss decreased (-0.655540 --> -0.694430).  Saving model ...
Epoch: 16 cost time: 2.139779806137085
Epoch: 16, Steps: 12 | Train Loss: 1.222 Vali Loss: 1.316 Vali Acc: 0.756 Test Loss: 1.316 Test Acc: 0.756
Validation loss decreased (-0.694430 --> -0.755542).  Saving model ...
Epoch: 17 cost time: 1.8278529644012451
Epoch: 17, Steps: 12 | Train Loss: 1.194 Vali Loss: 1.228 Vali Acc: 0.733 Test Loss: 1.228 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0822293758392334
Epoch: 18, Steps: 12 | Train Loss: 1.048 Vali Loss: 1.143 Vali Acc: 0.778 Test Loss: 1.143 Test Acc: 0.778
Validation loss decreased (-0.755542 --> -0.777766).  Saving model ...
Epoch: 19 cost time: 1.949028491973877
Epoch: 19, Steps: 12 | Train Loss: 1.044 Vali Loss: 1.101 Vali Acc: 0.789 Test Loss: 1.101 Test Acc: 0.789
Validation loss decreased (-0.777766 --> -0.788878).  Saving model ...
Epoch: 20 cost time: 2.4979469776153564
Epoch: 20, Steps: 12 | Train Loss: 0.949 Vali Loss: 1.018 Vali Acc: 0.800 Test Loss: 1.018 Test Acc: 0.800
Validation loss decreased (-0.788878 --> -0.799990).  Saving model ...
Epoch: 21 cost time: 1.8921589851379395
Epoch: 21, Steps: 12 | Train Loss: 0.873 Vali Loss: 0.985 Vali Acc: 0.772 Test Loss: 0.985 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9769999980926514
Epoch: 22, Steps: 12 | Train Loss: 0.816 Vali Loss: 0.905 Vali Acc: 0.822 Test Loss: 0.905 Test Acc: 0.822
Validation loss decreased (-0.799990 --> -0.822213).  Saving model ...
Epoch: 23 cost time: 2.024803876876831
Epoch: 23, Steps: 12 | Train Loss: 0.727 Vali Loss: 0.888 Vali Acc: 0.811 Test Loss: 0.888 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.705871820449829
Epoch: 24, Steps: 12 | Train Loss: 0.716 Vali Loss: 0.779 Vali Acc: 0.839 Test Loss: 0.779 Test Acc: 0.839
Validation loss decreased (-0.822213 --> -0.838881).  Saving model ...
Epoch: 25 cost time: 1.7831432819366455
Epoch: 25, Steps: 12 | Train Loss: 0.653 Vali Loss: 0.780 Vali Acc: 0.850 Test Loss: 0.780 Test Acc: 0.850
Validation loss decreased (-0.838881 --> -0.849992).  Saving model ...
Epoch: 26 cost time: 1.9388303756713867
Epoch: 26, Steps: 12 | Train Loss: 0.589 Vali Loss: 0.714 Vali Acc: 0.850 Test Loss: 0.714 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 27 cost time: 2.3125994205474854
Epoch: 27, Steps: 12 | Train Loss: 0.562 Vali Loss: 0.676 Vali Acc: 0.850 Test Loss: 0.676 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 28 cost time: 2.0874712467193604
Epoch: 28, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.659 Vali Acc: 0.850 Test Loss: 0.659 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 29 cost time: 2.248229503631592
Epoch: 29, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.649 Vali Acc: 0.844 Test Loss: 0.649 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.1578385829925537
Epoch: 30, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.591 Vali Acc: 0.867 Test Loss: 0.591 Test Acc: 0.867
Validation loss decreased (-0.849993 --> -0.866661).  Saving model ...
Epoch: 31 cost time: 2.0196304321289062
Epoch: 31, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.584 Vali Acc: 0.856 Test Loss: 0.584 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.4735050201416016
Epoch: 32, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.558 Vali Acc: 0.872 Test Loss: 0.558 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 33 cost time: 2.604168176651001
Epoch: 33, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.548 Vali Acc: 0.861 Test Loss: 0.548 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.654101610183716
Epoch: 34, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.2210912704467773
Epoch: 35, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.563 Vali Acc: 0.856 Test Loss: 0.563 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.311375379562378
Epoch: 36, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.481 Vali Acc: 0.867 Test Loss: 0.481 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.312483072280884
Epoch: 37, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.519 Vali Acc: 0.867 Test Loss: 0.519 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 2.479246139526367
Epoch: 38, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.515 Vali Acc: 0.867 Test Loss: 0.515 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 2.120394468307495
Epoch: 39, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.498 Vali Acc: 0.867 Test Loss: 0.498 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 2.2993462085723877
Epoch: 40, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.471 Vali Acc: 0.867 Test Loss: 0.471 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.938582420349121
Epoch: 41, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.453 Vali Acc: 0.900 Test Loss: 0.453 Test Acc: 0.900
Validation loss decreased (-0.872217 --> -0.899995).  Saving model ...
Epoch: 42 cost time: 2.490708112716675
Epoch: 42, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.485 Vali Acc: 0.861 Test Loss: 0.485 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.673509359359741
Epoch: 43, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.448 Vali Acc: 0.889 Test Loss: 0.448 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 2.525320529937744
Epoch: 44, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.520 Vali Acc: 0.861 Test Loss: 0.520 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 2.325505495071411
Epoch: 45, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.500 Vali Acc: 0.872 Test Loss: 0.500 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 2.437985897064209
Epoch: 46, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.482 Vali Acc: 0.872 Test Loss: 0.482 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 2.12638258934021
Epoch: 47, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.455 Vali Acc: 0.883 Test Loss: 0.455 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 2.731410264968872
Epoch: 48, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.438 Vali Acc: 0.889 Test Loss: 0.438 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 2.19828724861145
Epoch: 49, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.444 Vali Acc: 0.889 Test Loss: 0.444 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 2.056962490081787
Epoch: 50, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.448 Vali Acc: 0.889 Test Loss: 0.448 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 2.166135549545288
Epoch: 51, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.466 Vali Acc: 0.878 Test Loss: 0.466 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 459819
model size : 2.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.018975257873535
Epoch: 1, Steps: 12 | Train Loss: 2.843 Vali Loss: 2.797 Vali Acc: 0.089 Test Loss: 2.797 Test Acc: 0.089
Validation loss decreased (inf --> -0.088861).  Saving model ...
Epoch: 2 cost time: 2.4550349712371826
Epoch: 2, Steps: 12 | Train Loss: 2.798 Vali Loss: 2.720 Vali Acc: 0.111 Test Loss: 2.720 Test Acc: 0.111
Validation loss decreased (-0.088861 --> -0.111084).  Saving model ...
Epoch: 3 cost time: 1.8894832134246826
Epoch: 3, Steps: 12 | Train Loss: 2.711 Vali Loss: 2.628 Vali Acc: 0.156 Test Loss: 2.628 Test Acc: 0.156
Validation loss decreased (-0.111084 --> -0.155529).  Saving model ...
Epoch: 4 cost time: 2.3276216983795166
Epoch: 4, Steps: 12 | Train Loss: 2.596 Vali Loss: 2.505 Vali Acc: 0.194 Test Loss: 2.505 Test Acc: 0.194
Validation loss decreased (-0.155529 --> -0.194419).  Saving model ...
Epoch: 5 cost time: 2.0293309688568115
Epoch: 5, Steps: 12 | Train Loss: 2.379 Vali Loss: 2.343 Vali Acc: 0.272 Test Loss: 2.343 Test Acc: 0.272
Validation loss decreased (-0.194419 --> -0.272199).  Saving model ...
Epoch: 6 cost time: 1.829610824584961
Epoch: 6, Steps: 12 | Train Loss: 2.283 Vali Loss: 2.192 Vali Acc: 0.350 Test Loss: 2.192 Test Acc: 0.350
Validation loss decreased (-0.272199 --> -0.349978).  Saving model ...
Epoch: 7 cost time: 2.3526575565338135
Epoch: 7, Steps: 12 | Train Loss: 2.110 Vali Loss: 2.049 Vali Acc: 0.417 Test Loss: 2.049 Test Acc: 0.417
Validation loss decreased (-0.349978 --> -0.416646).  Saving model ...
Epoch: 8 cost time: 2.0438973903656006
Epoch: 8, Steps: 12 | Train Loss: 1.968 Vali Loss: 1.925 Vali Acc: 0.500 Test Loss: 1.925 Test Acc: 0.500
Validation loss decreased (-0.416646 --> -0.499981).  Saving model ...
Epoch: 9 cost time: 2.186619520187378
Epoch: 9, Steps: 12 | Train Loss: 1.914 Vali Loss: 1.903 Vali Acc: 0.489 Test Loss: 1.903 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.1317121982574463
Epoch: 10, Steps: 12 | Train Loss: 1.788 Vali Loss: 1.772 Vali Acc: 0.572 Test Loss: 1.772 Test Acc: 0.572
Validation loss decreased (-0.499981 --> -0.572204).  Saving model ...
Epoch: 11 cost time: 2.1163129806518555
Epoch: 11, Steps: 12 | Train Loss: 1.682 Vali Loss: 1.684 Vali Acc: 0.628 Test Loss: 1.684 Test Acc: 0.628
Validation loss decreased (-0.572204 --> -0.627761).  Saving model ...
Epoch: 12 cost time: 2.2114336490631104
Epoch: 12, Steps: 12 | Train Loss: 1.604 Vali Loss: 1.590 Vali Acc: 0.644 Test Loss: 1.590 Test Acc: 0.644
Validation loss decreased (-0.627761 --> -0.644429).  Saving model ...
Epoch: 13 cost time: 2.0858068466186523
Epoch: 13, Steps: 12 | Train Loss: 1.480 Vali Loss: 1.480 Vali Acc: 0.661 Test Loss: 1.480 Test Acc: 0.661
Validation loss decreased (-0.644429 --> -0.661096).  Saving model ...
Epoch: 14 cost time: 2.4805171489715576
Epoch: 14, Steps: 12 | Train Loss: 1.381 Vali Loss: 1.423 Vali Acc: 0.672 Test Loss: 1.423 Test Acc: 0.672
Validation loss decreased (-0.661096 --> -0.672208).  Saving model ...
Epoch: 15 cost time: 2.04089617729187
Epoch: 15, Steps: 12 | Train Loss: 1.278 Vali Loss: 1.348 Vali Acc: 0.700 Test Loss: 1.348 Test Acc: 0.700
Validation loss decreased (-0.672208 --> -0.699987).  Saving model ...
Epoch: 16 cost time: 2.2519235610961914
Epoch: 16, Steps: 12 | Train Loss: 1.248 Vali Loss: 1.283 Vali Acc: 0.717 Test Loss: 1.283 Test Acc: 0.717
Validation loss decreased (-0.699987 --> -0.716654).  Saving model ...
Epoch: 17 cost time: 1.919809341430664
Epoch: 17, Steps: 12 | Train Loss: 1.192 Vali Loss: 1.224 Vali Acc: 0.739 Test Loss: 1.224 Test Acc: 0.739
Validation loss decreased (-0.716654 --> -0.738877).  Saving model ...
Epoch: 18 cost time: 2.2857859134674072
Epoch: 18, Steps: 12 | Train Loss: 1.084 Vali Loss: 1.145 Vali Acc: 0.717 Test Loss: 1.145 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.458379030227661
Epoch: 19, Steps: 12 | Train Loss: 1.024 Vali Loss: 1.090 Vali Acc: 0.767 Test Loss: 1.090 Test Acc: 0.767
Validation loss decreased (-0.738877 --> -0.766656).  Saving model ...
Epoch: 20 cost time: 2.5350422859191895
Epoch: 20, Steps: 12 | Train Loss: 0.924 Vali Loss: 1.024 Vali Acc: 0.778 Test Loss: 1.024 Test Acc: 0.778
Validation loss decreased (-0.766656 --> -0.777768).  Saving model ...
Epoch: 21 cost time: 2.8066794872283936
Epoch: 21, Steps: 12 | Train Loss: 0.876 Vali Loss: 1.007 Vali Acc: 0.800 Test Loss: 1.007 Test Acc: 0.800
Validation loss decreased (-0.777768 --> -0.799990).  Saving model ...
Epoch: 22 cost time: 2.4570534229278564
Epoch: 22, Steps: 12 | Train Loss: 0.875 Vali Loss: 0.937 Vali Acc: 0.811 Test Loss: 0.937 Test Acc: 0.811
Validation loss decreased (-0.799990 --> -0.811102).  Saving model ...
Epoch: 23 cost time: 2.4023702144622803
Epoch: 23, Steps: 12 | Train Loss: 0.808 Vali Loss: 0.928 Vali Acc: 0.794 Test Loss: 0.928 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.3823916912078857
Epoch: 24, Steps: 12 | Train Loss: 0.692 Vali Loss: 0.863 Vali Acc: 0.828 Test Loss: 0.863 Test Acc: 0.828
Validation loss decreased (-0.811102 --> -0.827769).  Saving model ...
Epoch: 25 cost time: 2.1047074794769287
Epoch: 25, Steps: 12 | Train Loss: 0.647 Vali Loss: 0.787 Vali Acc: 0.828 Test Loss: 0.787 Test Acc: 0.828
Validation loss decreased (-0.827769 --> -0.827770).  Saving model ...
Epoch: 26 cost time: 2.185687780380249
Epoch: 26, Steps: 12 | Train Loss: 0.629 Vali Loss: 0.751 Vali Acc: 0.844 Test Loss: 0.751 Test Acc: 0.844
Validation loss decreased (-0.827770 --> -0.844437).  Saving model ...
Epoch: 27 cost time: 2.7156431674957275
Epoch: 27, Steps: 12 | Train Loss: 0.552 Vali Loss: 0.733 Vali Acc: 0.844 Test Loss: 0.733 Test Acc: 0.844
Validation loss decreased (-0.844437 --> -0.844437).  Saving model ...
Epoch: 28 cost time: 2.7844207286834717
Epoch: 28, Steps: 12 | Train Loss: 0.533 Vali Loss: 0.684 Vali Acc: 0.850 Test Loss: 0.684 Test Acc: 0.850
Validation loss decreased (-0.844437 --> -0.849993).  Saving model ...
Epoch: 29 cost time: 2.312087297439575
Epoch: 29, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.666 Vali Acc: 0.872 Test Loss: 0.666 Test Acc: 0.872
Validation loss decreased (-0.849993 --> -0.872216).  Saving model ...
Epoch: 30 cost time: 2.3595850467681885
Epoch: 30, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.656 Vali Acc: 0.850 Test Loss: 0.656 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.261500835418701
Epoch: 31, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.622 Vali Acc: 0.861 Test Loss: 0.622 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.145595073699951
Epoch: 32, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.590 Vali Acc: 0.872 Test Loss: 0.590 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872216).  Saving model ...
Epoch: 33 cost time: 2.310049295425415
Epoch: 33, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.569 Vali Acc: 0.872 Test Loss: 0.569 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872217).  Saving model ...
Epoch: 34 cost time: 2.3747105598449707
Epoch: 34, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.574 Vali Acc: 0.861 Test Loss: 0.574 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.8029422760009766
Epoch: 35, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.562 Vali Acc: 0.861 Test Loss: 0.562 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.7553138732910156
Epoch: 36, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.511 Vali Acc: 0.867 Test Loss: 0.511 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.3773488998413086
Epoch: 37, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.532 Vali Acc: 0.867 Test Loss: 0.532 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.3938283920288086
Epoch: 38, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.527 Vali Acc: 0.878 Test Loss: 0.527 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 39 cost time: 2.3929977416992188
Epoch: 39, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.530 Vali Acc: 0.850 Test Loss: 0.530 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.2128336429595947
Epoch: 40, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.494 Vali Acc: 0.867 Test Loss: 0.494 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.9758572578430176
Epoch: 41, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.499 Vali Acc: 0.872 Test Loss: 0.499 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.020779609680176
Epoch: 42, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.475 Vali Acc: 0.861 Test Loss: 0.475 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.474877119064331
Epoch: 43, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.478 Vali Acc: 0.861 Test Loss: 0.478 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 2.4505391120910645
Epoch: 44, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.462 Vali Acc: 0.861 Test Loss: 0.462 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 2.3263566493988037
Epoch: 45, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.477 Vali Acc: 0.856 Test Loss: 0.477 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 2.976520299911499
Epoch: 46, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.474 Vali Acc: 0.883 Test Loss: 0.474 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883329).  Saving model ...
Epoch: 47 cost time: 2.073584794998169
Epoch: 47, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.524 Vali Acc: 0.839 Test Loss: 0.524 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 2.5466268062591553
Epoch: 48, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.478 Vali Acc: 0.872 Test Loss: 0.478 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.9446654319763184
Epoch: 49, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.468 Vali Acc: 0.861 Test Loss: 0.468 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 2.595400094985962
Epoch: 50, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.497 Vali Acc: 0.878 Test Loss: 0.497 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 2.5926058292388916
Epoch: 51, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.470 Vali Acc: 0.872 Test Loss: 0.470 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 2.443009614944458
Epoch: 52, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.478 Vali Acc: 0.878 Test Loss: 0.478 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 2.6036019325256348
Epoch: 53, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.472 Vali Acc: 0.867 Test Loss: 0.472 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 2.4662821292877197
Epoch: 54, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.464 Vali Acc: 0.889 Test Loss: 0.464 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888884).  Saving model ...
Epoch: 55 cost time: 2.282181978225708
Epoch: 55, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.478 Vali Acc: 0.889 Test Loss: 0.478 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 2.2509262561798096
Epoch: 56, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.488 Vali Acc: 0.878 Test Loss: 0.488 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 2.3582615852355957
Epoch: 57, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.482 Vali Acc: 0.889 Test Loss: 0.482 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 2.5378870964050293
Epoch: 58, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.471 Vali Acc: 0.872 Test Loss: 0.471 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 2.5796456336975098
Epoch: 59, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.512 Vali Acc: 0.883 Test Loss: 0.512 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 2.1891250610351562
Epoch: 60, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.480 Vali Acc: 0.856 Test Loss: 0.480 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 2.0959997177124023
Epoch: 61, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.469 Vali Acc: 0.878 Test Loss: 0.469 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 2.5930094718933105
Epoch: 62, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.473 Vali Acc: 0.883 Test Loss: 0.473 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 2.320040702819824
Epoch: 63, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.498 Vali Acc: 0.878 Test Loss: 0.498 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 2.1877036094665527
Epoch: 64, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.470 Vali Acc: 0.883 Test Loss: 0.470 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 459563
model size : 2.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.566591739654541
Epoch: 1, Steps: 12 | Train Loss: 2.937 Vali Loss: 2.897 Vali Acc: 0.056 Test Loss: 2.897 Test Acc: 0.056
Validation loss decreased (inf --> -0.055527).  Saving model ...
Epoch: 2 cost time: 2.1663455963134766
Epoch: 2, Steps: 12 | Train Loss: 2.864 Vali Loss: 2.770 Vali Acc: 0.067 Test Loss: 2.770 Test Acc: 0.067
Validation loss decreased (-0.055527 --> -0.066639).  Saving model ...
Epoch: 3 cost time: 2.539473295211792
Epoch: 3, Steps: 12 | Train Loss: 2.768 Vali Loss: 2.663 Vali Acc: 0.106 Test Loss: 2.663 Test Acc: 0.106
Validation loss decreased (-0.066639 --> -0.105529).  Saving model ...
Epoch: 4 cost time: 2.033482789993286
Epoch: 4, Steps: 12 | Train Loss: 2.659 Vali Loss: 2.545 Vali Acc: 0.183 Test Loss: 2.545 Test Acc: 0.183
Validation loss decreased (-0.105529 --> -0.183308).  Saving model ...
Epoch: 5 cost time: 2.151177406311035
Epoch: 5, Steps: 12 | Train Loss: 2.569 Vali Loss: 2.430 Vali Acc: 0.217 Test Loss: 2.430 Test Acc: 0.217
Validation loss decreased (-0.183308 --> -0.216642).  Saving model ...
Epoch: 6 cost time: 2.0978410243988037
Epoch: 6, Steps: 12 | Train Loss: 2.444 Vali Loss: 2.283 Vali Acc: 0.294 Test Loss: 2.283 Test Acc: 0.294
Validation loss decreased (-0.216642 --> -0.294422).  Saving model ...
Epoch: 7 cost time: 2.0227210521698
Epoch: 7, Steps: 12 | Train Loss: 2.248 Vali Loss: 2.146 Vali Acc: 0.383 Test Loss: 2.146 Test Acc: 0.383
Validation loss decreased (-0.294422 --> -0.383312).  Saving model ...
Epoch: 8 cost time: 2.5842466354370117
Epoch: 8, Steps: 12 | Train Loss: 2.124 Vali Loss: 2.017 Vali Acc: 0.439 Test Loss: 2.017 Test Acc: 0.439
Validation loss decreased (-0.383312 --> -0.438869).  Saving model ...
Epoch: 9 cost time: 2.3282835483551025
Epoch: 9, Steps: 12 | Train Loss: 2.004 Vali Loss: 1.953 Vali Acc: 0.433 Test Loss: 1.953 Test Acc: 0.433
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8364481925964355
Epoch: 10, Steps: 12 | Train Loss: 1.822 Vali Loss: 1.809 Vali Acc: 0.506 Test Loss: 1.809 Test Acc: 0.506
Validation loss decreased (-0.438869 --> -0.505537).  Saving model ...
Epoch: 11 cost time: 2.1646318435668945
Epoch: 11, Steps: 12 | Train Loss: 1.756 Vali Loss: 1.714 Vali Acc: 0.594 Test Loss: 1.714 Test Acc: 0.594
Validation loss decreased (-0.505537 --> -0.594427).  Saving model ...
Epoch: 12 cost time: 2.2489635944366455
Epoch: 12, Steps: 12 | Train Loss: 1.637 Vali Loss: 1.618 Vali Acc: 0.628 Test Loss: 1.618 Test Acc: 0.628
Validation loss decreased (-0.594427 --> -0.627762).  Saving model ...
Epoch: 13 cost time: 2.427367925643921
Epoch: 13, Steps: 12 | Train Loss: 1.561 Vali Loss: 1.495 Vali Acc: 0.639 Test Loss: 1.495 Test Acc: 0.639
Validation loss decreased (-0.627762 --> -0.638874).  Saving model ...
Epoch: 14 cost time: 2.5743439197540283
Epoch: 14, Steps: 12 | Train Loss: 1.413 Vali Loss: 1.435 Vali Acc: 0.656 Test Loss: 1.435 Test Acc: 0.656
Validation loss decreased (-0.638874 --> -0.655541).  Saving model ...
Epoch: 15 cost time: 2.65874981880188
Epoch: 15, Steps: 12 | Train Loss: 1.297 Vali Loss: 1.358 Vali Acc: 0.667 Test Loss: 1.358 Test Acc: 0.667
Validation loss decreased (-0.655541 --> -0.666653).  Saving model ...
Epoch: 16 cost time: 2.191136360168457
Epoch: 16, Steps: 12 | Train Loss: 1.173 Vali Loss: 1.273 Vali Acc: 0.683 Test Loss: 1.273 Test Acc: 0.683
Validation loss decreased (-0.666653 --> -0.683321).  Saving model ...
Epoch: 17 cost time: 2.442876100540161
Epoch: 17, Steps: 12 | Train Loss: 1.125 Vali Loss: 1.189 Vali Acc: 0.722 Test Loss: 1.189 Test Acc: 0.722
Validation loss decreased (-0.683321 --> -0.722210).  Saving model ...
Epoch: 18 cost time: 2.5168731212615967
Epoch: 18, Steps: 12 | Train Loss: 1.059 Vali Loss: 1.129 Vali Acc: 0.750 Test Loss: 1.129 Test Acc: 0.750
Validation loss decreased (-0.722210 --> -0.749989).  Saving model ...
Epoch: 19 cost time: 2.399722099304199
Epoch: 19, Steps: 12 | Train Loss: 1.018 Vali Loss: 1.066 Vali Acc: 0.767 Test Loss: 1.066 Test Acc: 0.767
Validation loss decreased (-0.749989 --> -0.766656).  Saving model ...
Epoch: 20 cost time: 2.173635244369507
Epoch: 20, Steps: 12 | Train Loss: 0.966 Vali Loss: 1.009 Vali Acc: 0.778 Test Loss: 1.009 Test Acc: 0.778
Validation loss decreased (-0.766656 --> -0.777768).  Saving model ...
Epoch: 21 cost time: 2.0490148067474365
Epoch: 21, Steps: 12 | Train Loss: 0.899 Vali Loss: 0.944 Vali Acc: 0.794 Test Loss: 0.944 Test Acc: 0.794
Validation loss decreased (-0.777768 --> -0.794435).  Saving model ...
Epoch: 22 cost time: 1.995396614074707
Epoch: 22, Steps: 12 | Train Loss: 0.806 Vali Loss: 0.919 Vali Acc: 0.783 Test Loss: 0.919 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.0989651679992676
Epoch: 23, Steps: 12 | Train Loss: 0.749 Vali Loss: 0.880 Vali Acc: 0.800 Test Loss: 0.880 Test Acc: 0.800
Validation loss decreased (-0.794435 --> -0.799991).  Saving model ...
Epoch: 24 cost time: 2.1103107929229736
Epoch: 24, Steps: 12 | Train Loss: 0.719 Vali Loss: 0.804 Vali Acc: 0.806 Test Loss: 0.804 Test Acc: 0.806
Validation loss decreased (-0.799991 --> -0.805548).  Saving model ...
Epoch: 25 cost time: 1.9899954795837402
Epoch: 25, Steps: 12 | Train Loss: 0.638 Vali Loss: 0.796 Vali Acc: 0.811 Test Loss: 0.796 Test Acc: 0.811
Validation loss decreased (-0.805548 --> -0.811103).  Saving model ...
Epoch: 26 cost time: 2.0641868114471436
Epoch: 26, Steps: 12 | Train Loss: 0.632 Vali Loss: 0.758 Vali Acc: 0.833 Test Loss: 0.758 Test Acc: 0.833
Validation loss decreased (-0.811103 --> -0.833326).  Saving model ...
Epoch: 27 cost time: 1.97312593460083
Epoch: 27, Steps: 12 | Train Loss: 0.546 Vali Loss: 0.737 Vali Acc: 0.828 Test Loss: 0.737 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.238527536392212
Epoch: 28, Steps: 12 | Train Loss: 0.514 Vali Loss: 0.692 Vali Acc: 0.839 Test Loss: 0.692 Test Acc: 0.839
Validation loss decreased (-0.833326 --> -0.838882).  Saving model ...
Epoch: 29 cost time: 2.021498441696167
Epoch: 29, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.681 Vali Acc: 0.828 Test Loss: 0.681 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.5472662448883057
Epoch: 30, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.669 Vali Acc: 0.844 Test Loss: 0.669 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 31 cost time: 2.1102399826049805
Epoch: 31, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.667 Vali Acc: 0.811 Test Loss: 0.667 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.126765012741089
Epoch: 32, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.637 Vali Acc: 0.833 Test Loss: 0.637 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.305921792984009
Epoch: 33, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.560 Vali Acc: 0.844 Test Loss: 0.560 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844439).  Saving model ...
Epoch: 34 cost time: 1.9919278621673584
Epoch: 34, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.581 Vali Acc: 0.850 Test Loss: 0.581 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849994).  Saving model ...
Epoch: 35 cost time: 2.1597695350646973
Epoch: 35, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.519 Vali Acc: 0.856 Test Loss: 0.519 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 36 cost time: 1.9679059982299805
Epoch: 36, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.546 Vali Acc: 0.839 Test Loss: 0.546 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.3770976066589355
Epoch: 37, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.543 Vali Acc: 0.867 Test Loss: 0.543 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 38 cost time: 2.6032071113586426
Epoch: 38, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.522 Vali Acc: 0.856 Test Loss: 0.522 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.1344947814941406
Epoch: 39, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.528 Vali Acc: 0.850 Test Loss: 0.528 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.5517284870147705
Epoch: 40, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.513 Vali Acc: 0.856 Test Loss: 0.513 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.195105791091919
Epoch: 41, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.1248273849487305
Epoch: 42, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.501 Vali Acc: 0.850 Test Loss: 0.501 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 2.070507764816284
Epoch: 43, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.508 Vali Acc: 0.839 Test Loss: 0.508 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 2.2750191688537598
Epoch: 44, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.526 Vali Acc: 0.850 Test Loss: 0.526 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 2.555026054382324
Epoch: 45, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.478 Vali Acc: 0.856 Test Loss: 0.478 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 2.1514475345611572
Epoch: 46, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.542 Vali Acc: 0.839 Test Loss: 0.542 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 2.2759339809417725
Epoch: 47, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.476 Vali Acc: 0.867 Test Loss: 0.476 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866662).  Saving model ...
Epoch: 48 cost time: 2.0263898372650146
Epoch: 48, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.468 Vali Acc: 0.878 Test Loss: 0.468 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877773).  Saving model ...
Epoch: 49 cost time: 2.493638515472412
Epoch: 49, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.544 Vali Acc: 0.839 Test Loss: 0.544 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.8926126956939697
Epoch: 50, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.503 Vali Acc: 0.833 Test Loss: 0.503 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.903923511505127
Epoch: 51, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.510 Vali Acc: 0.861 Test Loss: 0.510 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 2.0545766353607178
Epoch: 52, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.542 Vali Acc: 0.800 Test Loss: 0.542 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.976952075958252
Epoch: 53, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.454 Vali Acc: 0.883 Test Loss: 0.454 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883329).  Saving model ...
Epoch: 54 cost time: 2.095757484436035
Epoch: 54, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.517 Vali Acc: 0.878 Test Loss: 0.517 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.8292536735534668
Epoch: 55, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.483 Vali Acc: 0.878 Test Loss: 0.483 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 2.007158041000366
Epoch: 56, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.517 Vali Acc: 0.872 Test Loss: 0.517 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.843092679977417
Epoch: 57, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.541 Vali Acc: 0.861 Test Loss: 0.541 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.9013514518737793
Epoch: 58, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.496 Vali Acc: 0.861 Test Loss: 0.496 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.9198434352874756
Epoch: 59, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.501 Vali Acc: 0.856 Test Loss: 0.501 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 2.0154857635498047
Epoch: 60, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.518 Vali Acc: 0.883 Test Loss: 0.518 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 2.0899622440338135
Epoch: 61, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.565 Vali Acc: 0.839 Test Loss: 0.565 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 2.077678680419922
Epoch: 62, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.529 Vali Acc: 0.856 Test Loss: 0.529 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 1.9683165550231934
Epoch: 63, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.590 Vali Acc: 0.844 Test Loss: 0.590 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 459307
model size : 2.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.224255323410034
Epoch: 1, Steps: 12 | Train Loss: 2.921 Vali Loss: 2.806 Vali Acc: 0.128 Test Loss: 2.806 Test Acc: 0.128
Validation loss decreased (inf --> -0.127750).  Saving model ...
Epoch: 2 cost time: 2.195746660232544
Epoch: 2, Steps: 12 | Train Loss: 2.732 Vali Loss: 2.708 Vali Acc: 0.089 Test Loss: 2.708 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.494215726852417
Epoch: 3, Steps: 12 | Train Loss: 2.691 Vali Loss: 2.636 Vali Acc: 0.106 Test Loss: 2.636 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.2065765857696533
Epoch: 4, Steps: 12 | Train Loss: 2.598 Vali Loss: 2.576 Vali Acc: 0.144 Test Loss: 2.576 Test Acc: 0.144
Validation loss decreased (-0.127750 --> -0.144419).  Saving model ...
Epoch: 5 cost time: 2.0181448459625244
Epoch: 5, Steps: 12 | Train Loss: 2.543 Vali Loss: 2.484 Vali Acc: 0.250 Test Loss: 2.484 Test Acc: 0.250
Validation loss decreased (-0.144419 --> -0.249975).  Saving model ...
Epoch: 6 cost time: 1.9379541873931885
Epoch: 6, Steps: 12 | Train Loss: 2.387 Vali Loss: 2.360 Vali Acc: 0.239 Test Loss: 2.360 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1572039127349854
Epoch: 7, Steps: 12 | Train Loss: 2.243 Vali Loss: 2.243 Vali Acc: 0.294 Test Loss: 2.243 Test Acc: 0.294
Validation loss decreased (-0.249975 --> -0.294422).  Saving model ...
Epoch: 8 cost time: 2.0671963691711426
Epoch: 8, Steps: 12 | Train Loss: 2.105 Vali Loss: 2.106 Vali Acc: 0.350 Test Loss: 2.106 Test Acc: 0.350
Validation loss decreased (-0.294422 --> -0.349979).  Saving model ...
Epoch: 9 cost time: 1.944108486175537
Epoch: 9, Steps: 12 | Train Loss: 2.039 Vali Loss: 2.017 Vali Acc: 0.422 Test Loss: 2.017 Test Acc: 0.422
Validation loss decreased (-0.349979 --> -0.422202).  Saving model ...
Epoch: 10 cost time: 2.068096160888672
Epoch: 10, Steps: 12 | Train Loss: 1.956 Vali Loss: 1.960 Vali Acc: 0.411 Test Loss: 1.960 Test Acc: 0.411
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.901700496673584
Epoch: 11, Steps: 12 | Train Loss: 1.807 Vali Loss: 1.860 Vali Acc: 0.517 Test Loss: 1.860 Test Acc: 0.517
Validation loss decreased (-0.422202 --> -0.516648).  Saving model ...
Epoch: 12 cost time: 2.0897274017333984
Epoch: 12, Steps: 12 | Train Loss: 1.729 Vali Loss: 1.800 Vali Acc: 0.550 Test Loss: 1.800 Test Acc: 0.550
Validation loss decreased (-0.516648 --> -0.549982).  Saving model ...
Epoch: 13 cost time: 2.2190518379211426
Epoch: 13, Steps: 12 | Train Loss: 1.730 Vali Loss: 1.728 Vali Acc: 0.556 Test Loss: 1.728 Test Acc: 0.556
Validation loss decreased (-0.549982 --> -0.555538).  Saving model ...
Epoch: 14 cost time: 1.8032536506652832
Epoch: 14, Steps: 12 | Train Loss: 1.601 Vali Loss: 1.657 Vali Acc: 0.594 Test Loss: 1.657 Test Acc: 0.594
Validation loss decreased (-0.555538 --> -0.594428).  Saving model ...
Epoch: 15 cost time: 2.6159205436706543
Epoch: 15, Steps: 12 | Train Loss: 1.536 Vali Loss: 1.588 Vali Acc: 0.628 Test Loss: 1.588 Test Acc: 0.628
Validation loss decreased (-0.594428 --> -0.627762).  Saving model ...
Epoch: 16 cost time: 1.8402299880981445
Epoch: 16, Steps: 12 | Train Loss: 1.464 Vali Loss: 1.517 Vali Acc: 0.628 Test Loss: 1.517 Test Acc: 0.628
Validation loss decreased (-0.627762 --> -0.627763).  Saving model ...
Epoch: 17 cost time: 2.073335647583008
Epoch: 17, Steps: 12 | Train Loss: 1.346 Vali Loss: 1.440 Vali Acc: 0.650 Test Loss: 1.440 Test Acc: 0.650
Validation loss decreased (-0.627763 --> -0.649986).  Saving model ...
Epoch: 18 cost time: 2.18454909324646
Epoch: 18, Steps: 12 | Train Loss: 1.283 Vali Loss: 1.379 Vali Acc: 0.639 Test Loss: 1.379 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.2152605056762695
Epoch: 19, Steps: 12 | Train Loss: 1.225 Vali Loss: 1.308 Vali Acc: 0.689 Test Loss: 1.308 Test Acc: 0.689
Validation loss decreased (-0.649986 --> -0.688876).  Saving model ...
Epoch: 20 cost time: 2.1049418449401855
Epoch: 20, Steps: 12 | Train Loss: 1.174 Vali Loss: 1.276 Vali Acc: 0.683 Test Loss: 1.276 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.823716640472412
Epoch: 21, Steps: 12 | Train Loss: 1.094 Vali Loss: 1.190 Vali Acc: 0.700 Test Loss: 1.190 Test Acc: 0.700
Validation loss decreased (-0.688876 --> -0.699988).  Saving model ...
Epoch: 22 cost time: 2.14534068107605
Epoch: 22, Steps: 12 | Train Loss: 1.032 Vali Loss: 1.155 Vali Acc: 0.733 Test Loss: 1.155 Test Acc: 0.733
Validation loss decreased (-0.699988 --> -0.733322).  Saving model ...
Epoch: 23 cost time: 1.9264013767242432
Epoch: 23, Steps: 12 | Train Loss: 0.994 Vali Loss: 1.089 Vali Acc: 0.717 Test Loss: 1.089 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.1718246936798096
Epoch: 24, Steps: 12 | Train Loss: 0.916 Vali Loss: 1.006 Vali Acc: 0.772 Test Loss: 1.006 Test Acc: 0.772
Validation loss decreased (-0.733322 --> -0.772212).  Saving model ...
Epoch: 25 cost time: 2.0004401206970215
Epoch: 25, Steps: 12 | Train Loss: 0.828 Vali Loss: 0.970 Vali Acc: 0.756 Test Loss: 0.970 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.0668342113494873
Epoch: 26, Steps: 12 | Train Loss: 0.822 Vali Loss: 0.929 Vali Acc: 0.772 Test Loss: 0.929 Test Acc: 0.772
Validation loss decreased (-0.772212 --> -0.772213).  Saving model ...
Epoch: 27 cost time: 2.0663084983825684
Epoch: 27, Steps: 12 | Train Loss: 0.748 Vali Loss: 0.895 Vali Acc: 0.761 Test Loss: 0.895 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7751803398132324
Epoch: 28, Steps: 12 | Train Loss: 0.713 Vali Loss: 0.811 Vali Acc: 0.789 Test Loss: 0.811 Test Acc: 0.789
Validation loss decreased (-0.772213 --> -0.788881).  Saving model ...
Epoch: 29 cost time: 1.7031567096710205
Epoch: 29, Steps: 12 | Train Loss: 0.625 Vali Loss: 0.795 Vali Acc: 0.789 Test Loss: 0.795 Test Acc: 0.789
Validation loss decreased (-0.788881 --> -0.788881).  Saving model ...
Epoch: 30 cost time: 1.943063735961914
Epoch: 30, Steps: 12 | Train Loss: 0.640 Vali Loss: 0.771 Vali Acc: 0.811 Test Loss: 0.771 Test Acc: 0.811
Validation loss decreased (-0.788881 --> -0.811103).  Saving model ...
Epoch: 31 cost time: 1.921584129333496
Epoch: 31, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.711 Vali Acc: 0.817 Test Loss: 0.711 Test Acc: 0.817
Validation loss decreased (-0.811103 --> -0.816660).  Saving model ...
Epoch: 32 cost time: 2.217425584793091
Epoch: 32, Steps: 12 | Train Loss: 0.538 Vali Loss: 0.742 Vali Acc: 0.789 Test Loss: 0.742 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.1251699924468994
Epoch: 33, Steps: 12 | Train Loss: 0.473 Vali Loss: 0.669 Vali Acc: 0.817 Test Loss: 0.669 Test Acc: 0.817
Validation loss decreased (-0.816660 --> -0.816660).  Saving model ...
Epoch: 34 cost time: 2.1133930683135986
Epoch: 34, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.664 Vali Acc: 0.778 Test Loss: 0.664 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.481194257736206
Epoch: 35, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.656 Vali Acc: 0.828 Test Loss: 0.656 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827771).  Saving model ...
Epoch: 36 cost time: 2.240450382232666
Epoch: 36, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.599 Vali Acc: 0.828 Test Loss: 0.599 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827772).  Saving model ...
Epoch: 37 cost time: 2.427093267440796
Epoch: 37, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.590 Vali Acc: 0.839 Test Loss: 0.590 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838883).  Saving model ...
Epoch: 38 cost time: 2.2094662189483643
Epoch: 38, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.582 Vali Acc: 0.828 Test Loss: 0.582 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.265503406524658
Epoch: 39, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.556 Vali Acc: 0.828 Test Loss: 0.556 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.238893747329712
Epoch: 40, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.515 Vali Acc: 0.861 Test Loss: 0.515 Test Acc: 0.861
Validation loss decreased (-0.838883 --> -0.861106).  Saving model ...
Epoch: 41 cost time: 2.2771103382110596
Epoch: 41, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.527 Vali Acc: 0.833 Test Loss: 0.527 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.088834762573242
Epoch: 42, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.547 Vali Acc: 0.833 Test Loss: 0.547 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.2261409759521484
Epoch: 43, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.526 Vali Acc: 0.856 Test Loss: 0.526 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 2.0358359813690186
Epoch: 44, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.533 Vali Acc: 0.833 Test Loss: 0.533 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.8642258644104004
Epoch: 45, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.556 Vali Acc: 0.828 Test Loss: 0.556 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 2.272291898727417
Epoch: 46, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.504 Vali Acc: 0.850 Test Loss: 0.504 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 2.4380736351013184
Epoch: 47, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.528 Vali Acc: 0.856 Test Loss: 0.528 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 2.321347951889038
Epoch: 48, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.480 Vali Acc: 0.856 Test Loss: 0.480 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 2.4964139461517334
Epoch: 49, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.481 Vali Acc: 0.850 Test Loss: 0.481 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 2.0501909255981445
Epoch: 50, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.488 Vali Acc: 0.844 Test Loss: 0.488 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 310315
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.535671710968018
Epoch: 1, Steps: 12 | Train Loss: 2.827 Vali Loss: 2.774 Vali Acc: 0.056 Test Loss: 2.774 Test Acc: 0.056
Validation loss decreased (inf --> -0.055528).  Saving model ...
Epoch: 2 cost time: 2.0618302822113037
Epoch: 2, Steps: 12 | Train Loss: 2.776 Vali Loss: 2.720 Vali Acc: 0.083 Test Loss: 2.720 Test Acc: 0.083
Validation loss decreased (-0.055528 --> -0.083306).  Saving model ...
Epoch: 3 cost time: 2.1221425533294678
Epoch: 3, Steps: 12 | Train Loss: 2.724 Vali Loss: 2.667 Vali Acc: 0.078 Test Loss: 2.667 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2231409549713135
Epoch: 4, Steps: 12 | Train Loss: 2.661 Vali Loss: 2.597 Vali Acc: 0.128 Test Loss: 2.597 Test Acc: 0.128
Validation loss decreased (-0.083306 --> -0.127752).  Saving model ...
Epoch: 5 cost time: 2.2663347721099854
Epoch: 5, Steps: 12 | Train Loss: 2.585 Vali Loss: 2.517 Vali Acc: 0.189 Test Loss: 2.517 Test Acc: 0.189
Validation loss decreased (-0.127752 --> -0.188864).  Saving model ...
Epoch: 6 cost time: 2.035740375518799
Epoch: 6, Steps: 12 | Train Loss: 2.465 Vali Loss: 2.409 Vali Acc: 0.228 Test Loss: 2.409 Test Acc: 0.228
Validation loss decreased (-0.188864 --> -0.227754).  Saving model ...
Epoch: 7 cost time: 2.015881299972534
Epoch: 7, Steps: 12 | Train Loss: 2.337 Vali Loss: 2.290 Vali Acc: 0.367 Test Loss: 2.290 Test Acc: 0.367
Validation loss decreased (-0.227754 --> -0.366644).  Saving model ...
Epoch: 8 cost time: 2.0764169692993164
Epoch: 8, Steps: 12 | Train Loss: 2.212 Vali Loss: 2.198 Vali Acc: 0.361 Test Loss: 2.198 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3089590072631836
Epoch: 9, Steps: 12 | Train Loss: 2.130 Vali Loss: 2.095 Vali Acc: 0.467 Test Loss: 2.095 Test Acc: 0.467
Validation loss decreased (-0.366644 --> -0.466646).  Saving model ...
Epoch: 10 cost time: 2.1675524711608887
Epoch: 10, Steps: 12 | Train Loss: 2.052 Vali Loss: 2.020 Vali Acc: 0.494 Test Loss: 2.020 Test Acc: 0.494
Validation loss decreased (-0.466646 --> -0.494424).  Saving model ...
Epoch: 11 cost time: 2.001885414123535
Epoch: 11, Steps: 12 | Train Loss: 1.880 Vali Loss: 1.958 Vali Acc: 0.556 Test Loss: 1.958 Test Acc: 0.556
Validation loss decreased (-0.494424 --> -0.555536).  Saving model ...
Epoch: 12 cost time: 1.8709499835968018
Epoch: 12, Steps: 12 | Train Loss: 1.811 Vali Loss: 1.872 Vali Acc: 0.517 Test Loss: 1.872 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3162407875061035
Epoch: 13, Steps: 12 | Train Loss: 1.690 Vali Loss: 1.806 Vali Acc: 0.567 Test Loss: 1.806 Test Acc: 0.567
Validation loss decreased (-0.555536 --> -0.566649).  Saving model ...
Epoch: 14 cost time: 2.2410919666290283
Epoch: 14, Steps: 12 | Train Loss: 1.590 Vali Loss: 1.724 Vali Acc: 0.539 Test Loss: 1.724 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.580557346343994
Epoch: 15, Steps: 12 | Train Loss: 1.574 Vali Loss: 1.628 Vali Acc: 0.589 Test Loss: 1.628 Test Acc: 0.589
Validation loss decreased (-0.566649 --> -0.588873).  Saving model ...
Epoch: 16 cost time: 2.147541046142578
Epoch: 16, Steps: 12 | Train Loss: 1.492 Vali Loss: 1.564 Vali Acc: 0.639 Test Loss: 1.564 Test Acc: 0.639
Validation loss decreased (-0.588873 --> -0.638873).  Saving model ...
Epoch: 17 cost time: 2.101956367492676
Epoch: 17, Steps: 12 | Train Loss: 1.467 Vali Loss: 1.537 Vali Acc: 0.628 Test Loss: 1.537 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.286421537399292
Epoch: 18, Steps: 12 | Train Loss: 1.320 Vali Loss: 1.452 Vali Acc: 0.633 Test Loss: 1.452 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.5239474773406982
Epoch: 19, Steps: 12 | Train Loss: 1.255 Vali Loss: 1.383 Vali Acc: 0.700 Test Loss: 1.383 Test Acc: 0.700
Validation loss decreased (-0.638873 --> -0.699986).  Saving model ...
Epoch: 20 cost time: 2.303581476211548
Epoch: 20, Steps: 12 | Train Loss: 1.240 Vali Loss: 1.310 Vali Acc: 0.700 Test Loss: 1.310 Test Acc: 0.700
Validation loss decreased (-0.699986 --> -0.699987).  Saving model ...
Epoch: 21 cost time: 2.414651393890381
Epoch: 21, Steps: 12 | Train Loss: 1.159 Vali Loss: 1.251 Vali Acc: 0.711 Test Loss: 1.251 Test Acc: 0.711
Validation loss decreased (-0.699987 --> -0.711099).  Saving model ...
Epoch: 22 cost time: 1.8018383979797363
Epoch: 22, Steps: 12 | Train Loss: 1.164 Vali Loss: 1.169 Vali Acc: 0.733 Test Loss: 1.169 Test Acc: 0.733
Validation loss decreased (-0.711099 --> -0.733322).  Saving model ...
Epoch: 23 cost time: 1.921515703201294
Epoch: 23, Steps: 12 | Train Loss: 1.021 Vali Loss: 1.128 Vali Acc: 0.761 Test Loss: 1.128 Test Acc: 0.761
Validation loss decreased (-0.733322 --> -0.761100).  Saving model ...
Epoch: 24 cost time: 2.214834451675415
Epoch: 24, Steps: 12 | Train Loss: 0.937 Vali Loss: 1.086 Vali Acc: 0.778 Test Loss: 1.086 Test Acc: 0.778
Validation loss decreased (-0.761100 --> -0.777767).  Saving model ...
Epoch: 25 cost time: 2.0172712802886963
Epoch: 25, Steps: 12 | Train Loss: 0.890 Vali Loss: 0.976 Vali Acc: 0.789 Test Loss: 0.976 Test Acc: 0.789
Validation loss decreased (-0.777767 --> -0.788879).  Saving model ...
Epoch: 26 cost time: 1.895820140838623
Epoch: 26, Steps: 12 | Train Loss: 0.785 Vali Loss: 0.977 Vali Acc: 0.756 Test Loss: 0.977 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.0490331649780273
Epoch: 27, Steps: 12 | Train Loss: 0.815 Vali Loss: 0.922 Vali Acc: 0.778 Test Loss: 0.922 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.242269992828369
Epoch: 28, Steps: 12 | Train Loss: 0.711 Vali Loss: 0.855 Vali Acc: 0.800 Test Loss: 0.855 Test Acc: 0.800
Validation loss decreased (-0.788879 --> -0.799991).  Saving model ...
Epoch: 29 cost time: 2.4274039268493652
Epoch: 29, Steps: 12 | Train Loss: 0.755 Vali Loss: 0.802 Vali Acc: 0.800 Test Loss: 0.802 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 30 cost time: 2.1652400493621826
Epoch: 30, Steps: 12 | Train Loss: 0.675 Vali Loss: 0.787 Vali Acc: 0.800 Test Loss: 0.787 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 31 cost time: 2.1808266639709473
Epoch: 31, Steps: 12 | Train Loss: 0.620 Vali Loss: 0.802 Vali Acc: 0.794 Test Loss: 0.802 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.9772295951843262
Epoch: 32, Steps: 12 | Train Loss: 0.582 Vali Loss: 0.739 Vali Acc: 0.828 Test Loss: 0.739 Test Acc: 0.828
Validation loss decreased (-0.799992 --> -0.827770).  Saving model ...
Epoch: 33 cost time: 2.2096056938171387
Epoch: 33, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.703 Vali Acc: 0.822 Test Loss: 0.703 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.1704676151275635
Epoch: 34, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.709 Vali Acc: 0.839 Test Loss: 0.709 Test Acc: 0.839
Validation loss decreased (-0.827770 --> -0.838882).  Saving model ...
Epoch: 35 cost time: 2.079533576965332
Epoch: 35, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.622 Vali Acc: 0.867 Test Loss: 0.622 Test Acc: 0.867
Validation loss decreased (-0.838882 --> -0.866660).  Saving model ...
Epoch: 36 cost time: 2.3324644565582275
Epoch: 36, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.626 Vali Acc: 0.861 Test Loss: 0.626 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.2535033226013184
Epoch: 37, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.642 Vali Acc: 0.828 Test Loss: 0.642 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.1224019527435303
Epoch: 38, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.614 Vali Acc: 0.867 Test Loss: 0.614 Test Acc: 0.867
Validation loss decreased (-0.866660 --> -0.866661).  Saving model ...
Epoch: 39 cost time: 1.9239137172698975
Epoch: 39, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.625 Vali Acc: 0.861 Test Loss: 0.625 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.9629826545715332
Epoch: 40, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.575 Vali Acc: 0.850 Test Loss: 0.575 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.457026481628418
Epoch: 41, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.563 Vali Acc: 0.867 Test Loss: 0.563 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 42 cost time: 2.1030752658843994
Epoch: 42, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.529 Vali Acc: 0.867 Test Loss: 0.529 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 43 cost time: 2.111062526702881
Epoch: 43, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.545 Vali Acc: 0.867 Test Loss: 0.545 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.039895534515381
Epoch: 44, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.550 Vali Acc: 0.850 Test Loss: 0.550 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.99776291847229
Epoch: 45, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.560 Vali Acc: 0.861 Test Loss: 0.560 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 2.2687578201293945
Epoch: 46, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.498 Vali Acc: 0.878 Test Loss: 0.498 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877773).  Saving model ...
Epoch: 47 cost time: 2.380505323410034
Epoch: 47, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.588 Vali Acc: 0.867 Test Loss: 0.588 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 2.2232086658477783
Epoch: 48, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.534 Vali Acc: 0.867 Test Loss: 0.534 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.9363548755645752
Epoch: 49, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.481 Vali Acc: 0.883 Test Loss: 0.481 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883329).  Saving model ...
Epoch: 50 cost time: 2.2201616764068604
Epoch: 50, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.515 Vali Acc: 0.856 Test Loss: 0.515 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 2.1247851848602295
Epoch: 51, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.530 Vali Acc: 0.867 Test Loss: 0.530 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 2.27211856842041
Epoch: 52, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.449 Vali Acc: 0.883 Test Loss: 0.449 Test Acc: 0.883
Validation loss decreased (-0.883329 --> -0.883329).  Saving model ...
Epoch: 53 cost time: 2.5152652263641357
Epoch: 53, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.512 Vali Acc: 0.850 Test Loss: 0.512 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 2.0871503353118896
Epoch: 54, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.509 Vali Acc: 0.861 Test Loss: 0.509 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 2.078568935394287
Epoch: 55, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.517 Vali Acc: 0.861 Test Loss: 0.517 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 2.013561248779297
Epoch: 56, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.518 Vali Acc: 0.867 Test Loss: 0.518 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 2.2865238189697266
Epoch: 57, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.563 Vali Acc: 0.867 Test Loss: 0.563 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 2.140570640563965
Epoch: 58, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.481 Vali Acc: 0.861 Test Loss: 0.481 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.9953384399414062
Epoch: 59, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.643 Vali Acc: 0.839 Test Loss: 0.643 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 1.8570058345794678
Epoch: 60, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.492 Vali Acc: 0.867 Test Loss: 0.492 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 2.2338292598724365
Epoch: 61, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.594 Vali Acc: 0.867 Test Loss: 0.594 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 1.8953819274902344
Epoch: 62, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.468 Vali Acc: 0.889 Test Loss: 0.468 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888884).  Saving model ...
Epoch: 63 cost time: 1.9258499145507812
Epoch: 63, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.466 Vali Acc: 0.894 Test Loss: 0.466 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894440).  Saving model ...
Epoch: 64 cost time: 2.22536301612854
Epoch: 64, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.548 Vali Acc: 0.872 Test Loss: 0.548 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 2.0836780071258545
Epoch: 65, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.525 Vali Acc: 0.872 Test Loss: 0.525 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 2.2555651664733887
Epoch: 66, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.481 Vali Acc: 0.872 Test Loss: 0.481 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 2.2600746154785156
Epoch: 67, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.506 Vali Acc: 0.883 Test Loss: 0.506 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 2.234905242919922
Epoch: 68, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.464 Vali Acc: 0.867 Test Loss: 0.464 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 2.149409770965576
Epoch: 69, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.526 Vali Acc: 0.872 Test Loss: 0.526 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 1.848501205444336
Epoch: 70, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.527 Vali Acc: 0.867 Test Loss: 0.527 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 2.0185444355010986
Epoch: 71, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.501 Vali Acc: 0.878 Test Loss: 0.501 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 2.3604629039764404
Epoch: 72, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.513 Vali Acc: 0.878 Test Loss: 0.513 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 2.2412877082824707
Epoch: 73, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.502 Vali Acc: 0.872 Test Loss: 0.502 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 310059
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.196005582809448
Epoch: 1, Steps: 12 | Train Loss: 2.834 Vali Loss: 2.781 Vali Acc: 0.139 Test Loss: 2.781 Test Acc: 0.139
Validation loss decreased (inf --> -0.138861).  Saving model ...
Epoch: 2 cost time: 2.1904258728027344
Epoch: 2, Steps: 12 | Train Loss: 2.762 Vali Loss: 2.697 Vali Acc: 0.083 Test Loss: 2.697 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8599002361297607
Epoch: 3, Steps: 12 | Train Loss: 2.712 Vali Loss: 2.619 Vali Acc: 0.089 Test Loss: 2.619 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.154080867767334
Epoch: 4, Steps: 12 | Train Loss: 2.618 Vali Loss: 2.526 Vali Acc: 0.189 Test Loss: 2.526 Test Acc: 0.189
Validation loss decreased (-0.138861 --> -0.188864).  Saving model ...
Epoch: 5 cost time: 2.3410580158233643
Epoch: 5, Steps: 12 | Train Loss: 2.533 Vali Loss: 2.414 Vali Acc: 0.222 Test Loss: 2.414 Test Acc: 0.222
Validation loss decreased (-0.188864 --> -0.222198).  Saving model ...
Epoch: 6 cost time: 2.40840220451355
Epoch: 6, Steps: 12 | Train Loss: 2.454 Vali Loss: 2.290 Vali Acc: 0.389 Test Loss: 2.290 Test Acc: 0.389
Validation loss decreased (-0.222198 --> -0.388866).  Saving model ...
Epoch: 7 cost time: 2.160088062286377
Epoch: 7, Steps: 12 | Train Loss: 2.276 Vali Loss: 2.198 Vali Acc: 0.433 Test Loss: 2.198 Test Acc: 0.433
Validation loss decreased (-0.388866 --> -0.433311).  Saving model ...
Epoch: 8 cost time: 2.1625702381134033
Epoch: 8, Steps: 12 | Train Loss: 2.126 Vali Loss: 2.100 Vali Acc: 0.444 Test Loss: 2.100 Test Acc: 0.444
Validation loss decreased (-0.433311 --> -0.444423).  Saving model ...
Epoch: 9 cost time: 2.2200145721435547
Epoch: 9, Steps: 12 | Train Loss: 2.049 Vali Loss: 2.001 Vali Acc: 0.433 Test Loss: 2.001 Test Acc: 0.433
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.14644193649292
Epoch: 10, Steps: 12 | Train Loss: 1.974 Vali Loss: 1.909 Vali Acc: 0.550 Test Loss: 1.909 Test Acc: 0.550
Validation loss decreased (-0.444423 --> -0.549981).  Saving model ...
Epoch: 11 cost time: 1.9070806503295898
Epoch: 11, Steps: 12 | Train Loss: 1.871 Vali Loss: 1.840 Vali Acc: 0.517 Test Loss: 1.840 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.268862009048462
Epoch: 12, Steps: 12 | Train Loss: 1.756 Vali Loss: 1.781 Vali Acc: 0.556 Test Loss: 1.781 Test Acc: 0.556
Validation loss decreased (-0.549981 --> -0.555538).  Saving model ...
Epoch: 13 cost time: 2.1115078926086426
Epoch: 13, Steps: 12 | Train Loss: 1.706 Vali Loss: 1.701 Vali Acc: 0.572 Test Loss: 1.701 Test Acc: 0.572
Validation loss decreased (-0.555538 --> -0.572205).  Saving model ...
Epoch: 14 cost time: 1.909498691558838
Epoch: 14, Steps: 12 | Train Loss: 1.584 Vali Loss: 1.628 Vali Acc: 0.628 Test Loss: 1.628 Test Acc: 0.628
Validation loss decreased (-0.572205 --> -0.627761).  Saving model ...
Epoch: 15 cost time: 1.9191431999206543
Epoch: 15, Steps: 12 | Train Loss: 1.503 Vali Loss: 1.533 Vali Acc: 0.611 Test Loss: 1.533 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.4106080532073975
Epoch: 16, Steps: 12 | Train Loss: 1.473 Vali Loss: 1.499 Vali Acc: 0.600 Test Loss: 1.499 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.5295703411102295
Epoch: 17, Steps: 12 | Train Loss: 1.399 Vali Loss: 1.448 Vali Acc: 0.644 Test Loss: 1.448 Test Acc: 0.644
Validation loss decreased (-0.627761 --> -0.644430).  Saving model ...
Epoch: 18 cost time: 1.953848123550415
Epoch: 18, Steps: 12 | Train Loss: 1.323 Vali Loss: 1.393 Vali Acc: 0.606 Test Loss: 1.393 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.1878132820129395
Epoch: 19, Steps: 12 | Train Loss: 1.233 Vali Loss: 1.317 Vali Acc: 0.628 Test Loss: 1.317 Test Acc: 0.628
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.3586816787719727
Epoch: 20, Steps: 12 | Train Loss: 1.198 Vali Loss: 1.228 Vali Acc: 0.678 Test Loss: 1.228 Test Acc: 0.678
Validation loss decreased (-0.644430 --> -0.677765).  Saving model ...
Epoch: 21 cost time: 2.2293760776519775
Epoch: 21, Steps: 12 | Train Loss: 1.083 Vali Loss: 1.224 Vali Acc: 0.700 Test Loss: 1.224 Test Acc: 0.700
Validation loss decreased (-0.677765 --> -0.699988).  Saving model ...
Epoch: 22 cost time: 1.9229328632354736
Epoch: 22, Steps: 12 | Train Loss: 1.039 Vali Loss: 1.124 Vali Acc: 0.689 Test Loss: 1.124 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.7288620471954346
Epoch: 23, Steps: 12 | Train Loss: 1.054 Vali Loss: 1.135 Vali Acc: 0.689 Test Loss: 1.135 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.140526056289673
Epoch: 24, Steps: 12 | Train Loss: 0.959 Vali Loss: 1.073 Vali Acc: 0.717 Test Loss: 1.073 Test Acc: 0.717
Validation loss decreased (-0.699988 --> -0.716656).  Saving model ...
Epoch: 25 cost time: 2.308088779449463
Epoch: 25, Steps: 12 | Train Loss: 0.936 Vali Loss: 0.985 Vali Acc: 0.756 Test Loss: 0.985 Test Acc: 0.756
Validation loss decreased (-0.716656 --> -0.755546).  Saving model ...
Epoch: 26 cost time: 2.0312559604644775
Epoch: 26, Steps: 12 | Train Loss: 0.803 Vali Loss: 0.938 Vali Acc: 0.756 Test Loss: 0.938 Test Acc: 0.756
Validation loss decreased (-0.755546 --> -0.755546).  Saving model ...
Epoch: 27 cost time: 2.291552782058716
Epoch: 27, Steps: 12 | Train Loss: 0.739 Vali Loss: 0.900 Vali Acc: 0.744 Test Loss: 0.900 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.9290542602539062
Epoch: 28, Steps: 12 | Train Loss: 0.803 Vali Loss: 0.853 Vali Acc: 0.794 Test Loss: 0.853 Test Acc: 0.794
Validation loss decreased (-0.755546 --> -0.794436).  Saving model ...
Epoch: 29 cost time: 2.2095749378204346
Epoch: 29, Steps: 12 | Train Loss: 0.682 Vali Loss: 0.808 Vali Acc: 0.800 Test Loss: 0.808 Test Acc: 0.800
Validation loss decreased (-0.794436 --> -0.799992).  Saving model ...
Epoch: 30 cost time: 1.9201915264129639
Epoch: 30, Steps: 12 | Train Loss: 0.642 Vali Loss: 0.807 Vali Acc: 0.772 Test Loss: 0.807 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.1049644947052
Epoch: 31, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.774 Vali Acc: 0.794 Test Loss: 0.774 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.4198200702667236
Epoch: 32, Steps: 12 | Train Loss: 0.552 Vali Loss: 0.741 Vali Acc: 0.833 Test Loss: 0.741 Test Acc: 0.833
Validation loss decreased (-0.799992 --> -0.833326).  Saving model ...
Epoch: 33 cost time: 2.1196212768554688
Epoch: 33, Steps: 12 | Train Loss: 0.507 Vali Loss: 0.720 Vali Acc: 0.783 Test Loss: 0.720 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.2448461055755615
Epoch: 34, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.683 Vali Acc: 0.806 Test Loss: 0.683 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.088794469833374
Epoch: 35, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.644 Vali Acc: 0.839 Test Loss: 0.644 Test Acc: 0.839
Validation loss decreased (-0.833326 --> -0.838882).  Saving model ...
Epoch: 36 cost time: 2.888145923614502
Epoch: 36, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.635 Vali Acc: 0.817 Test Loss: 0.635 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.0958142280578613
Epoch: 37, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.610 Vali Acc: 0.850 Test Loss: 0.610 Test Acc: 0.850
Validation loss decreased (-0.838882 --> -0.849994).  Saving model ...
Epoch: 38 cost time: 2.1774349212646484
Epoch: 38, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.638 Vali Acc: 0.839 Test Loss: 0.638 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.278050184249878
Epoch: 39, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.593 Vali Acc: 0.828 Test Loss: 0.593 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.5084924697875977
Epoch: 40, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.641 Vali Acc: 0.833 Test Loss: 0.641 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.530674457550049
Epoch: 41, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.594 Vali Acc: 0.822 Test Loss: 0.594 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.6644134521484375
Epoch: 42, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.580 Vali Acc: 0.833 Test Loss: 0.580 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 2.5645763874053955
Epoch: 43, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.564 Vali Acc: 0.844 Test Loss: 0.564 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 2.295344352722168
Epoch: 44, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.547 Vali Acc: 0.828 Test Loss: 0.547 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 3.0186290740966797
Epoch: 45, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.540 Vali Acc: 0.856 Test Loss: 0.540 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 46 cost time: 2.454211473464966
Epoch: 46, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.531 Vali Acc: 0.844 Test Loss: 0.531 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.337834596633911
Epoch: 47, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.536 Vali Acc: 0.839 Test Loss: 0.536 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 2.347111701965332
Epoch: 48, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.526 Vali Acc: 0.856 Test Loss: 0.526 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 49 cost time: 2.2219278812408447
Epoch: 49, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.533 Vali Acc: 0.856 Test Loss: 0.533 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 2.317283868789673
Epoch: 50, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.552 Vali Acc: 0.856 Test Loss: 0.552 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 2.5152995586395264
Epoch: 51, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.520 Vali Acc: 0.878 Test Loss: 0.520 Test Acc: 0.878
Validation loss decreased (-0.855550 --> -0.877773).  Saving model ...
Epoch: 52 cost time: 2.293771982192993
Epoch: 52, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.511 Vali Acc: 0.861 Test Loss: 0.511 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 2.1994285583496094
Epoch: 53, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.572 Vali Acc: 0.850 Test Loss: 0.572 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.9950525760650635
Epoch: 54, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.568 Vali Acc: 0.833 Test Loss: 0.568 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 2.1608359813690186
Epoch: 55, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.596 Vali Acc: 0.850 Test Loss: 0.596 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 2.437889575958252
Epoch: 56, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.532 Vali Acc: 0.856 Test Loss: 0.532 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 2.382991313934326
Epoch: 57, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.526 Vali Acc: 0.867 Test Loss: 0.526 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 2.0222747325897217
Epoch: 58, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.538 Vali Acc: 0.872 Test Loss: 0.538 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 2.2104721069335938
Epoch: 59, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.557 Vali Acc: 0.839 Test Loss: 0.557 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 2.064173698425293
Epoch: 60, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.565 Vali Acc: 0.872 Test Loss: 0.565 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 2.2880468368530273
Epoch: 61, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.601 Vali Acc: 0.839 Test Loss: 0.601 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 309803
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.133002281188965
Epoch: 1, Steps: 12 | Train Loss: 2.865 Vali Loss: 2.813 Vali Acc: 0.083 Test Loss: 2.813 Test Acc: 0.083
Validation loss decreased (inf --> -0.083305).  Saving model ...
Epoch: 2 cost time: 1.8541078567504883
Epoch: 2, Steps: 12 | Train Loss: 2.799 Vali Loss: 2.723 Vali Acc: 0.111 Test Loss: 2.723 Test Acc: 0.111
Validation loss decreased (-0.083305 --> -0.111084).  Saving model ...
Epoch: 3 cost time: 1.5840706825256348
Epoch: 3, Steps: 12 | Train Loss: 2.713 Vali Loss: 2.667 Vali Acc: 0.128 Test Loss: 2.667 Test Acc: 0.128
Validation loss decreased (-0.111084 --> -0.127751).  Saving model ...
Epoch: 4 cost time: 1.93636155128479
Epoch: 4, Steps: 12 | Train Loss: 2.653 Vali Loss: 2.615 Vali Acc: 0.133 Test Loss: 2.615 Test Acc: 0.133
Validation loss decreased (-0.127751 --> -0.133307).  Saving model ...
Epoch: 5 cost time: 1.839700698852539
Epoch: 5, Steps: 12 | Train Loss: 2.584 Vali Loss: 2.538 Vali Acc: 0.206 Test Loss: 2.538 Test Acc: 0.206
Validation loss decreased (-0.133307 --> -0.205530).  Saving model ...
Epoch: 6 cost time: 2.2470266819000244
Epoch: 6, Steps: 12 | Train Loss: 2.513 Vali Loss: 2.430 Vali Acc: 0.244 Test Loss: 2.430 Test Acc: 0.244
Validation loss decreased (-0.205530 --> -0.244420).  Saving model ...
Epoch: 7 cost time: 2.158567428588867
Epoch: 7, Steps: 12 | Train Loss: 2.326 Vali Loss: 2.306 Vali Acc: 0.239 Test Loss: 2.306 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.741847038269043
Epoch: 8, Steps: 12 | Train Loss: 2.209 Vali Loss: 2.183 Vali Acc: 0.361 Test Loss: 2.183 Test Acc: 0.361
Validation loss decreased (-0.244420 --> -0.361089).  Saving model ...
Epoch: 9 cost time: 1.8308115005493164
Epoch: 9, Steps: 12 | Train Loss: 2.125 Vali Loss: 2.080 Vali Acc: 0.439 Test Loss: 2.080 Test Acc: 0.439
Validation loss decreased (-0.361089 --> -0.438868).  Saving model ...
Epoch: 10 cost time: 2.1580095291137695
Epoch: 10, Steps: 12 | Train Loss: 1.992 Vali Loss: 1.964 Vali Acc: 0.539 Test Loss: 1.964 Test Acc: 0.539
Validation loss decreased (-0.438868 --> -0.538869).  Saving model ...
Epoch: 11 cost time: 2.1331779956817627
Epoch: 11, Steps: 12 | Train Loss: 1.854 Vali Loss: 1.866 Vali Acc: 0.550 Test Loss: 1.866 Test Acc: 0.550
Validation loss decreased (-0.538869 --> -0.549981).  Saving model ...
Epoch: 12 cost time: 1.9522621631622314
Epoch: 12, Steps: 12 | Train Loss: 1.744 Vali Loss: 1.772 Vali Acc: 0.578 Test Loss: 1.772 Test Acc: 0.578
Validation loss decreased (-0.549981 --> -0.577760).  Saving model ...
Epoch: 13 cost time: 1.944917917251587
Epoch: 13, Steps: 12 | Train Loss: 1.648 Vali Loss: 1.684 Vali Acc: 0.567 Test Loss: 1.684 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9110326766967773
Epoch: 14, Steps: 12 | Train Loss: 1.560 Vali Loss: 1.601 Vali Acc: 0.639 Test Loss: 1.601 Test Acc: 0.639
Validation loss decreased (-0.577760 --> -0.638873).  Saving model ...
Epoch: 15 cost time: 1.8930878639221191
Epoch: 15, Steps: 12 | Train Loss: 1.503 Vali Loss: 1.563 Vali Acc: 0.633 Test Loss: 1.563 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.098348617553711
Epoch: 16, Steps: 12 | Train Loss: 1.467 Vali Loss: 1.460 Vali Acc: 0.633 Test Loss: 1.460 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.029696226119995
Epoch: 17, Steps: 12 | Train Loss: 1.326 Vali Loss: 1.369 Vali Acc: 0.661 Test Loss: 1.369 Test Acc: 0.661
Validation loss decreased (-0.638873 --> -0.661097).  Saving model ...
Epoch: 18 cost time: 2.096686601638794
Epoch: 18, Steps: 12 | Train Loss: 1.243 Vali Loss: 1.309 Vali Acc: 0.711 Test Loss: 1.309 Test Acc: 0.711
Validation loss decreased (-0.661097 --> -0.711098).  Saving model ...
Epoch: 19 cost time: 1.8451707363128662
Epoch: 19, Steps: 12 | Train Loss: 1.164 Vali Loss: 1.258 Vali Acc: 0.728 Test Loss: 1.258 Test Acc: 0.728
Validation loss decreased (-0.711098 --> -0.727765).  Saving model ...
Epoch: 20 cost time: 2.1444530487060547
Epoch: 20, Steps: 12 | Train Loss: 1.077 Vali Loss: 1.189 Vali Acc: 0.733 Test Loss: 1.189 Test Acc: 0.733
Validation loss decreased (-0.727765 --> -0.733321).  Saving model ...
Epoch: 21 cost time: 1.8721928596496582
Epoch: 21, Steps: 12 | Train Loss: 1.095 Vali Loss: 1.148 Vali Acc: 0.728 Test Loss: 1.148 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.1576321125030518
Epoch: 22, Steps: 12 | Train Loss: 1.051 Vali Loss: 1.081 Vali Acc: 0.778 Test Loss: 1.081 Test Acc: 0.778
Validation loss decreased (-0.733321 --> -0.777767).  Saving model ...
Epoch: 23 cost time: 1.9742398262023926
Epoch: 23, Steps: 12 | Train Loss: 0.921 Vali Loss: 1.021 Vali Acc: 0.783 Test Loss: 1.021 Test Acc: 0.783
Validation loss decreased (-0.777767 --> -0.783323).  Saving model ...
Epoch: 24 cost time: 1.8833999633789062
Epoch: 24, Steps: 12 | Train Loss: 0.857 Vali Loss: 0.989 Vali Acc: 0.800 Test Loss: 0.989 Test Acc: 0.800
Validation loss decreased (-0.783323 --> -0.799990).  Saving model ...
Epoch: 25 cost time: 1.7298221588134766
Epoch: 25, Steps: 12 | Train Loss: 0.815 Vali Loss: 0.917 Vali Acc: 0.822 Test Loss: 0.917 Test Acc: 0.822
Validation loss decreased (-0.799990 --> -0.822213).  Saving model ...
Epoch: 26 cost time: 1.902315378189087
Epoch: 26, Steps: 12 | Train Loss: 0.739 Vali Loss: 0.876 Vali Acc: 0.811 Test Loss: 0.876 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7775835990905762
Epoch: 27, Steps: 12 | Train Loss: 0.752 Vali Loss: 0.846 Vali Acc: 0.822 Test Loss: 0.846 Test Acc: 0.822
Validation loss decreased (-0.822213 --> -0.822214).  Saving model ...
Epoch: 28 cost time: 2.0974385738372803
Epoch: 28, Steps: 12 | Train Loss: 0.659 Vali Loss: 0.802 Vali Acc: 0.822 Test Loss: 0.802 Test Acc: 0.822
Validation loss decreased (-0.822214 --> -0.822214).  Saving model ...
Epoch: 29 cost time: 1.9600188732147217
Epoch: 29, Steps: 12 | Train Loss: 0.623 Vali Loss: 0.773 Vali Acc: 0.839 Test Loss: 0.773 Test Acc: 0.839
Validation loss decreased (-0.822214 --> -0.838881).  Saving model ...
Epoch: 30 cost time: 1.7764809131622314
Epoch: 30, Steps: 12 | Train Loss: 0.656 Vali Loss: 0.786 Vali Acc: 0.828 Test Loss: 0.786 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.1654372215270996
Epoch: 31, Steps: 12 | Train Loss: 0.555 Vali Loss: 0.730 Vali Acc: 0.833 Test Loss: 0.730 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.0119428634643555
Epoch: 32, Steps: 12 | Train Loss: 0.513 Vali Loss: 0.710 Vali Acc: 0.844 Test Loss: 0.710 Test Acc: 0.844
Validation loss decreased (-0.838881 --> -0.844437).  Saving model ...
Epoch: 33 cost time: 2.0266616344451904
Epoch: 33, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.696 Vali Acc: 0.844 Test Loss: 0.696 Test Acc: 0.844
Validation loss decreased (-0.844437 --> -0.844437).  Saving model ...
Epoch: 34 cost time: 2.129295825958252
Epoch: 34, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.648 Vali Acc: 0.850 Test Loss: 0.648 Test Acc: 0.850
Validation loss decreased (-0.844437 --> -0.849994).  Saving model ...
Epoch: 35 cost time: 1.932525396347046
Epoch: 35, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.608 Vali Acc: 0.861 Test Loss: 0.608 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 36 cost time: 1.9961295127868652
Epoch: 36, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.593 Vali Acc: 0.861 Test Loss: 0.593 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 37 cost time: 1.9399447441101074
Epoch: 37, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.565 Vali Acc: 0.867 Test Loss: 0.565 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 38 cost time: 1.8957014083862305
Epoch: 38, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.547 Vali Acc: 0.861 Test Loss: 0.547 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.3148655891418457
Epoch: 39, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.555 Vali Acc: 0.867 Test Loss: 0.555 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 40 cost time: 2.1086370944976807
Epoch: 40, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.524 Vali Acc: 0.867 Test Loss: 0.524 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 41 cost time: 1.7814347743988037
Epoch: 41, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.545 Vali Acc: 0.861 Test Loss: 0.545 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.6506659984588623
Epoch: 42, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.567 Vali Acc: 0.844 Test Loss: 0.567 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.337871789932251
Epoch: 43, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.492 Vali Acc: 0.867 Test Loss: 0.492 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866662).  Saving model ...
Epoch: 44 cost time: 1.8564319610595703
Epoch: 44, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.533 Vali Acc: 0.867 Test Loss: 0.533 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.4939684867858887
Epoch: 45, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.503 Vali Acc: 0.867 Test Loss: 0.503 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.9790537357330322
Epoch: 46, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.505 Vali Acc: 0.867 Test Loss: 0.505 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.8629775047302246
Epoch: 47, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.502 Vali Acc: 0.867 Test Loss: 0.502 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 2.0026209354400635
Epoch: 48, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.461 Vali Acc: 0.878 Test Loss: 0.461 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877773).  Saving model ...
Epoch: 49 cost time: 2.4624826908111572
Epoch: 49, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.497 Vali Acc: 0.867 Test Loss: 0.497 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.8320913314819336
Epoch: 50, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.461 Vali Acc: 0.861 Test Loss: 0.461 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 2.1623051166534424
Epoch: 51, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.464 Vali Acc: 0.861 Test Loss: 0.464 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 2.056323766708374
Epoch: 52, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.442 Vali Acc: 0.867 Test Loss: 0.442 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.8040874004364014
Epoch: 53, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.537 Vali Acc: 0.844 Test Loss: 0.537 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 2.015411376953125
Epoch: 54, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.487 Vali Acc: 0.856 Test Loss: 0.487 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 2.133049726486206
Epoch: 55, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.471 Vali Acc: 0.867 Test Loss: 0.471 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 2.051264524459839
Epoch: 56, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.430 Vali Acc: 0.889 Test Loss: 0.430 Test Acc: 0.889
Validation loss decreased (-0.877773 --> -0.888885).  Saving model ...
Epoch: 57 cost time: 1.8172290325164795
Epoch: 57, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.497 Vali Acc: 0.867 Test Loss: 0.497 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.825845718383789
Epoch: 58, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.469 Vali Acc: 0.867 Test Loss: 0.469 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.8498430252075195
Epoch: 59, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.435 Vali Acc: 0.861 Test Loss: 0.435 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.975611925125122
Epoch: 60, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.447 Vali Acc: 0.867 Test Loss: 0.447 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.9048974514007568
Epoch: 61, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.485 Vali Acc: 0.850 Test Loss: 0.485 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.8791656494140625
Epoch: 62, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.496 Vali Acc: 0.872 Test Loss: 0.496 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.9544720649719238
Epoch: 63, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.517 Vali Acc: 0.861 Test Loss: 0.517 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 2.1081485748291016
Epoch: 64, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.442 Vali Acc: 0.894 Test Loss: 0.442 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894440).  Saving model ...
Epoch: 65 cost time: 2.0841259956359863
Epoch: 65, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.505 Vali Acc: 0.856 Test Loss: 0.505 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 2.151567220687866
Epoch: 66, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.467 Vali Acc: 0.861 Test Loss: 0.467 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 2.4018239974975586
Epoch: 67, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.463 Vali Acc: 0.878 Test Loss: 0.463 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 1.8134336471557617
Epoch: 68, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.446 Vali Acc: 0.872 Test Loss: 0.446 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 2.0640041828155518
Epoch: 69, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.424 Vali Acc: 0.883 Test Loss: 0.424 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 1.984018325805664
Epoch: 70, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.530 Vali Acc: 0.867 Test Loss: 0.530 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 2.4568378925323486
Epoch: 71, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.535 Vali Acc: 0.872 Test Loss: 0.535 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 2.1761279106140137
Epoch: 72, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.588 Vali Acc: 0.850 Test Loss: 0.588 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 1.7650065422058105
Epoch: 73, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.480 Vali Acc: 0.878 Test Loss: 0.480 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 1.867269515991211
Epoch: 74, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.474 Vali Acc: 0.867 Test Loss: 0.474 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 309547
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.479679584503174
Epoch: 1, Steps: 12 | Train Loss: 2.825 Vali Loss: 2.782 Vali Acc: 0.067 Test Loss: 2.782 Test Acc: 0.067
Validation loss decreased (inf --> -0.066639).  Saving model ...
Epoch: 2 cost time: 1.8821144104003906
Epoch: 2, Steps: 12 | Train Loss: 2.793 Vali Loss: 2.721 Vali Acc: 0.072 Test Loss: 2.721 Test Acc: 0.072
Validation loss decreased (-0.066639 --> -0.072195).  Saving model ...
Epoch: 3 cost time: 1.8093862533569336
Epoch: 3, Steps: 12 | Train Loss: 2.743 Vali Loss: 2.681 Vali Acc: 0.156 Test Loss: 2.681 Test Acc: 0.156
Validation loss decreased (-0.072195 --> -0.155529).  Saving model ...
Epoch: 4 cost time: 2.0422720909118652
Epoch: 4, Steps: 12 | Train Loss: 2.720 Vali Loss: 2.628 Vali Acc: 0.217 Test Loss: 2.628 Test Acc: 0.217
Validation loss decreased (-0.155529 --> -0.216640).  Saving model ...
Epoch: 5 cost time: 1.9509398937225342
Epoch: 5, Steps: 12 | Train Loss: 2.636 Vali Loss: 2.581 Vali Acc: 0.222 Test Loss: 2.581 Test Acc: 0.222
Validation loss decreased (-0.216640 --> -0.222196).  Saving model ...
Epoch: 6 cost time: 1.8431682586669922
Epoch: 6, Steps: 12 | Train Loss: 2.551 Vali Loss: 2.521 Vali Acc: 0.206 Test Loss: 2.521 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.681457281112671
Epoch: 7, Steps: 12 | Train Loss: 2.409 Vali Loss: 2.430 Vali Acc: 0.306 Test Loss: 2.430 Test Acc: 0.306
Validation loss decreased (-0.222196 --> -0.305531).  Saving model ...
Epoch: 8 cost time: 2.1479036808013916
Epoch: 8, Steps: 12 | Train Loss: 2.328 Vali Loss: 2.320 Vali Acc: 0.361 Test Loss: 2.320 Test Acc: 0.361
Validation loss decreased (-0.305531 --> -0.361088).  Saving model ...
Epoch: 9 cost time: 2.0571250915527344
Epoch: 9, Steps: 12 | Train Loss: 2.153 Vali Loss: 2.208 Vali Acc: 0.372 Test Loss: 2.208 Test Acc: 0.372
Validation loss decreased (-0.361088 --> -0.372200).  Saving model ...
Epoch: 10 cost time: 1.8503644466400146
Epoch: 10, Steps: 12 | Train Loss: 2.094 Vali Loss: 2.100 Vali Acc: 0.444 Test Loss: 2.100 Test Acc: 0.444
Validation loss decreased (-0.372200 --> -0.444423).  Saving model ...
Epoch: 11 cost time: 1.990762710571289
Epoch: 11, Steps: 12 | Train Loss: 1.986 Vali Loss: 2.013 Vali Acc: 0.500 Test Loss: 2.013 Test Acc: 0.500
Validation loss decreased (-0.444423 --> -0.499980).  Saving model ...
Epoch: 12 cost time: 1.7940888404846191
Epoch: 12, Steps: 12 | Train Loss: 1.930 Vali Loss: 1.903 Vali Acc: 0.528 Test Loss: 1.903 Test Acc: 0.528
Validation loss decreased (-0.499980 --> -0.527759).  Saving model ...
Epoch: 13 cost time: 1.8545374870300293
Epoch: 13, Steps: 12 | Train Loss: 1.772 Vali Loss: 1.838 Vali Acc: 0.567 Test Loss: 1.838 Test Acc: 0.567
Validation loss decreased (-0.527759 --> -0.566648).  Saving model ...
Epoch: 14 cost time: 1.9197540283203125
Epoch: 14, Steps: 12 | Train Loss: 1.720 Vali Loss: 1.776 Vali Acc: 0.583 Test Loss: 1.776 Test Acc: 0.583
Validation loss decreased (-0.566648 --> -0.583316).  Saving model ...
Epoch: 15 cost time: 2.3977158069610596
Epoch: 15, Steps: 12 | Train Loss: 1.696 Vali Loss: 1.658 Vali Acc: 0.583 Test Loss: 1.658 Test Acc: 0.583
Validation loss decreased (-0.583316 --> -0.583317).  Saving model ...
Epoch: 16 cost time: 2.0639700889587402
Epoch: 16, Steps: 12 | Train Loss: 1.560 Vali Loss: 1.594 Vali Acc: 0.628 Test Loss: 1.594 Test Acc: 0.628
Validation loss decreased (-0.583317 --> -0.627762).  Saving model ...
Epoch: 17 cost time: 1.8895561695098877
Epoch: 17, Steps: 12 | Train Loss: 1.491 Vali Loss: 1.540 Vali Acc: 0.644 Test Loss: 1.540 Test Acc: 0.644
Validation loss decreased (-0.627762 --> -0.644429).  Saving model ...
Epoch: 18 cost time: 1.789949655532837
Epoch: 18, Steps: 12 | Train Loss: 1.392 Vali Loss: 1.456 Vali Acc: 0.639 Test Loss: 1.456 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.077162742614746
Epoch: 19, Steps: 12 | Train Loss: 1.305 Vali Loss: 1.388 Vali Acc: 0.656 Test Loss: 1.388 Test Acc: 0.656
Validation loss decreased (-0.644429 --> -0.655542).  Saving model ...
Epoch: 20 cost time: 2.318117380142212
Epoch: 20, Steps: 12 | Train Loss: 1.246 Vali Loss: 1.309 Vali Acc: 0.694 Test Loss: 1.309 Test Acc: 0.694
Validation loss decreased (-0.655542 --> -0.694431).  Saving model ...
Epoch: 21 cost time: 1.9963953495025635
Epoch: 21, Steps: 12 | Train Loss: 1.245 Vali Loss: 1.267 Vali Acc: 0.694 Test Loss: 1.267 Test Acc: 0.694
Validation loss decreased (-0.694431 --> -0.694432).  Saving model ...
Epoch: 22 cost time: 2.010035276412964
Epoch: 22, Steps: 12 | Train Loss: 1.162 Vali Loss: 1.215 Vali Acc: 0.711 Test Loss: 1.215 Test Acc: 0.711
Validation loss decreased (-0.694432 --> -0.711099).  Saving model ...
Epoch: 23 cost time: 1.8902759552001953
Epoch: 23, Steps: 12 | Train Loss: 1.099 Vali Loss: 1.151 Vali Acc: 0.778 Test Loss: 1.151 Test Acc: 0.778
Validation loss decreased (-0.711099 --> -0.777766).  Saving model ...
Epoch: 24 cost time: 2.057795286178589
Epoch: 24, Steps: 12 | Train Loss: 0.983 Vali Loss: 1.082 Vali Acc: 0.756 Test Loss: 1.082 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.209872245788574
Epoch: 25, Steps: 12 | Train Loss: 0.975 Vali Loss: 1.035 Vali Acc: 0.817 Test Loss: 1.035 Test Acc: 0.817
Validation loss decreased (-0.777766 --> -0.816656).  Saving model ...
Epoch: 26 cost time: 2.457261323928833
Epoch: 26, Steps: 12 | Train Loss: 0.940 Vali Loss: 0.975 Vali Acc: 0.800 Test Loss: 0.975 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.9824473857879639
Epoch: 27, Steps: 12 | Train Loss: 0.866 Vali Loss: 0.943 Vali Acc: 0.794 Test Loss: 0.943 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.7038295269012451
Epoch: 28, Steps: 12 | Train Loss: 0.807 Vali Loss: 0.925 Vali Acc: 0.800 Test Loss: 0.925 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.1663835048675537
Epoch: 29, Steps: 12 | Train Loss: 0.748 Vali Loss: 0.865 Vali Acc: 0.817 Test Loss: 0.865 Test Acc: 0.817
Validation loss decreased (-0.816656 --> -0.816658).  Saving model ...
Epoch: 30 cost time: 2.1430342197418213
Epoch: 30, Steps: 12 | Train Loss: 0.697 Vali Loss: 0.832 Vali Acc: 0.817 Test Loss: 0.832 Test Acc: 0.817
Validation loss decreased (-0.816658 --> -0.816658).  Saving model ...
Epoch: 31 cost time: 2.435906171798706
Epoch: 31, Steps: 12 | Train Loss: 0.665 Vali Loss: 0.791 Vali Acc: 0.828 Test Loss: 0.791 Test Acc: 0.828
Validation loss decreased (-0.816658 --> -0.827770).  Saving model ...
Epoch: 32 cost time: 2.064762830734253
Epoch: 32, Steps: 12 | Train Loss: 0.661 Vali Loss: 0.752 Vali Acc: 0.833 Test Loss: 0.752 Test Acc: 0.833
Validation loss decreased (-0.827770 --> -0.833326).  Saving model ...
Epoch: 33 cost time: 2.0453038215637207
Epoch: 33, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.718 Vali Acc: 0.822 Test Loss: 0.718 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.0917274951934814
Epoch: 34, Steps: 12 | Train Loss: 0.530 Vali Loss: 0.711 Vali Acc: 0.828 Test Loss: 0.711 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.9157044887542725
Epoch: 35, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.691 Vali Acc: 0.828 Test Loss: 0.691 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.873429536819458
Epoch: 36, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.658 Vali Acc: 0.839 Test Loss: 0.658 Test Acc: 0.839
Validation loss decreased (-0.833326 --> -0.838882).  Saving model ...
Epoch: 37 cost time: 2.104372262954712
Epoch: 37, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.642 Vali Acc: 0.856 Test Loss: 0.642 Test Acc: 0.856
Validation loss decreased (-0.838882 --> -0.855549).  Saving model ...
Epoch: 38 cost time: 1.943354606628418
Epoch: 38, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.656 Vali Acc: 0.839 Test Loss: 0.656 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.849318504333496
Epoch: 39, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.600 Vali Acc: 0.850 Test Loss: 0.600 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.0252773761749268
Epoch: 40, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.590 Vali Acc: 0.850 Test Loss: 0.590 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.1116409301757812
Epoch: 41, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.588 Vali Acc: 0.839 Test Loss: 0.588 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.9411959648132324
Epoch: 42, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.590 Vali Acc: 0.856 Test Loss: 0.590 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855550).  Saving model ...
Epoch: 43 cost time: 1.9105730056762695
Epoch: 43, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.556 Vali Acc: 0.856 Test Loss: 0.556 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 44 cost time: 1.824230432510376
Epoch: 44, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.524 Vali Acc: 0.850 Test Loss: 0.524 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.9976978302001953
Epoch: 45, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.551 Vali Acc: 0.850 Test Loss: 0.551 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.241643190383911
Epoch: 46, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.495 Vali Acc: 0.867 Test Loss: 0.495 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866662).  Saving model ...
Epoch: 47 cost time: 2.2956340312957764
Epoch: 47, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.543 Vali Acc: 0.861 Test Loss: 0.543 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 2.355722427368164
Epoch: 48, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.508 Vali Acc: 0.850 Test Loss: 0.508 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 2.1089634895324707
Epoch: 49, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.489 Vali Acc: 0.861 Test Loss: 0.489 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 2.096717357635498
Epoch: 50, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.505 Vali Acc: 0.872 Test Loss: 0.505 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872217).  Saving model ...
Epoch: 51 cost time: 1.9467864036560059
Epoch: 51, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.487 Vali Acc: 0.861 Test Loss: 0.487 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 2.599008560180664
Epoch: 52, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.556 Vali Acc: 0.839 Test Loss: 0.556 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.828477382659912
Epoch: 53, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.496 Vali Acc: 0.861 Test Loss: 0.496 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 2.0019876956939697
Epoch: 54, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.481 Vali Acc: 0.872 Test Loss: 0.481 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 55 cost time: 1.9886374473571777
Epoch: 55, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.479 Vali Acc: 0.867 Test Loss: 0.479 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 2.0166287422180176
Epoch: 56, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.515 Vali Acc: 0.861 Test Loss: 0.515 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.9045209884643555
Epoch: 57, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.484 Vali Acc: 0.867 Test Loss: 0.484 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.9092884063720703
Epoch: 58, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.511 Vali Acc: 0.856 Test Loss: 0.511 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 2.2081234455108643
Epoch: 59, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.529 Vali Acc: 0.844 Test Loss: 0.529 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 2.130873680114746
Epoch: 60, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.486 Vali Acc: 0.867 Test Loss: 0.486 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 2.0556538105010986
Epoch: 61, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.524 Vali Acc: 0.856 Test Loss: 0.524 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 2.2664408683776855
Epoch: 62, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.523 Vali Acc: 0.867 Test Loss: 0.523 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 1.9472320079803467
Epoch: 63, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.535 Vali Acc: 0.856 Test Loss: 0.535 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 2.2630257606506348
Epoch: 64, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.495 Vali Acc: 0.872 Test Loss: 0.495 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 235435
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9125711917877197
Epoch: 1, Steps: 12 | Train Loss: 2.791 Vali Loss: 2.783 Vali Acc: 0.083 Test Loss: 2.783 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 1.9545817375183105
Epoch: 2, Steps: 12 | Train Loss: 2.773 Vali Loss: 2.679 Vali Acc: 0.078 Test Loss: 2.679 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.302952527999878
Epoch: 3, Steps: 12 | Train Loss: 2.613 Vali Loss: 2.599 Vali Acc: 0.133 Test Loss: 2.599 Test Acc: 0.133
Validation loss decreased (-0.083306 --> -0.133307).  Saving model ...
Epoch: 4 cost time: 2.128802537918091
Epoch: 4, Steps: 12 | Train Loss: 2.585 Vali Loss: 2.532 Vali Acc: 0.183 Test Loss: 2.532 Test Acc: 0.183
Validation loss decreased (-0.133307 --> -0.183308).  Saving model ...
Epoch: 5 cost time: 2.2100305557250977
Epoch: 5, Steps: 12 | Train Loss: 2.504 Vali Loss: 2.445 Vali Acc: 0.228 Test Loss: 2.445 Test Acc: 0.228
Validation loss decreased (-0.183308 --> -0.227753).  Saving model ...
Epoch: 6 cost time: 2.100440502166748
Epoch: 6, Steps: 12 | Train Loss: 2.430 Vali Loss: 2.341 Vali Acc: 0.250 Test Loss: 2.341 Test Acc: 0.250
Validation loss decreased (-0.227753 --> -0.249977).  Saving model ...
Epoch: 7 cost time: 2.1714155673980713
Epoch: 7, Steps: 12 | Train Loss: 2.311 Vali Loss: 2.261 Vali Acc: 0.317 Test Loss: 2.261 Test Acc: 0.317
Validation loss decreased (-0.249977 --> -0.316644).  Saving model ...
Epoch: 8 cost time: 1.7109425067901611
Epoch: 8, Steps: 12 | Train Loss: 2.199 Vali Loss: 2.175 Vali Acc: 0.394 Test Loss: 2.175 Test Acc: 0.394
Validation loss decreased (-0.316644 --> -0.394423).  Saving model ...
Epoch: 9 cost time: 2.072674512863159
Epoch: 9, Steps: 12 | Train Loss: 2.044 Vali Loss: 2.083 Vali Acc: 0.422 Test Loss: 2.083 Test Acc: 0.422
Validation loss decreased (-0.394423 --> -0.422201).  Saving model ...
Epoch: 10 cost time: 2.030197858810425
Epoch: 10, Steps: 12 | Train Loss: 2.023 Vali Loss: 2.009 Vali Acc: 0.422 Test Loss: 2.009 Test Acc: 0.422
Validation loss decreased (-0.422201 --> -0.422202).  Saving model ...
Epoch: 11 cost time: 1.772587776184082
Epoch: 11, Steps: 12 | Train Loss: 1.924 Vali Loss: 1.928 Vali Acc: 0.456 Test Loss: 1.928 Test Acc: 0.456
Validation loss decreased (-0.422202 --> -0.455536).  Saving model ...
Epoch: 12 cost time: 2.8587491512298584
Epoch: 12, Steps: 12 | Train Loss: 1.816 Vali Loss: 1.856 Vali Acc: 0.489 Test Loss: 1.856 Test Acc: 0.489
Validation loss decreased (-0.455536 --> -0.488870).  Saving model ...
Epoch: 13 cost time: 2.0932886600494385
Epoch: 13, Steps: 12 | Train Loss: 1.744 Vali Loss: 1.786 Vali Acc: 0.478 Test Loss: 1.786 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0769968032836914
Epoch: 14, Steps: 12 | Train Loss: 1.668 Vali Loss: 1.733 Vali Acc: 0.467 Test Loss: 1.733 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.341251850128174
Epoch: 15, Steps: 12 | Train Loss: 1.635 Vali Loss: 1.658 Vali Acc: 0.556 Test Loss: 1.658 Test Acc: 0.556
Validation loss decreased (-0.488870 --> -0.555539).  Saving model ...
Epoch: 16 cost time: 1.8244519233703613
Epoch: 16, Steps: 12 | Train Loss: 1.494 Vali Loss: 1.600 Vali Acc: 0.533 Test Loss: 1.600 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.3743460178375244
Epoch: 17, Steps: 12 | Train Loss: 1.467 Vali Loss: 1.540 Vali Acc: 0.572 Test Loss: 1.540 Test Acc: 0.572
Validation loss decreased (-0.555539 --> -0.572207).  Saving model ...
Epoch: 18 cost time: 2.174877166748047
Epoch: 18, Steps: 12 | Train Loss: 1.412 Vali Loss: 1.467 Vali Acc: 0.578 Test Loss: 1.467 Test Acc: 0.578
Validation loss decreased (-0.572207 --> -0.577763).  Saving model ...
Epoch: 19 cost time: 2.3188745975494385
Epoch: 19, Steps: 12 | Train Loss: 1.259 Vali Loss: 1.403 Vali Acc: 0.639 Test Loss: 1.403 Test Acc: 0.639
Validation loss decreased (-0.577763 --> -0.638875).  Saving model ...
Epoch: 20 cost time: 2.284654140472412
Epoch: 20, Steps: 12 | Train Loss: 1.242 Vali Loss: 1.342 Vali Acc: 0.633 Test Loss: 1.342 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.5169711112976074
Epoch: 21, Steps: 12 | Train Loss: 1.173 Vali Loss: 1.323 Vali Acc: 0.633 Test Loss: 1.323 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.3132545948028564
Epoch: 22, Steps: 12 | Train Loss: 1.181 Vali Loss: 1.232 Vali Acc: 0.661 Test Loss: 1.232 Test Acc: 0.661
Validation loss decreased (-0.638875 --> -0.661099).  Saving model ...
Epoch: 23 cost time: 2.6199116706848145
Epoch: 23, Steps: 12 | Train Loss: 1.077 Vali Loss: 1.227 Vali Acc: 0.689 Test Loss: 1.227 Test Acc: 0.689
Validation loss decreased (-0.661099 --> -0.688877).  Saving model ...
Epoch: 24 cost time: 1.8343052864074707
Epoch: 24, Steps: 12 | Train Loss: 1.038 Vali Loss: 1.159 Vali Acc: 0.700 Test Loss: 1.159 Test Acc: 0.700
Validation loss decreased (-0.688877 --> -0.699988).  Saving model ...
Epoch: 25 cost time: 1.9377825260162354
Epoch: 25, Steps: 12 | Train Loss: 1.008 Vali Loss: 1.122 Vali Acc: 0.711 Test Loss: 1.122 Test Acc: 0.711
Validation loss decreased (-0.699988 --> -0.711100).  Saving model ...
Epoch: 26 cost time: 2.456851005554199
Epoch: 26, Steps: 12 | Train Loss: 0.915 Vali Loss: 1.123 Vali Acc: 0.700 Test Loss: 1.123 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.269651412963867
Epoch: 27, Steps: 12 | Train Loss: 0.897 Vali Loss: 1.035 Vali Acc: 0.739 Test Loss: 1.035 Test Acc: 0.739
Validation loss decreased (-0.711100 --> -0.738879).  Saving model ...
Epoch: 28 cost time: 2.0968148708343506
Epoch: 28, Steps: 12 | Train Loss: 0.855 Vali Loss: 0.991 Vali Acc: 0.750 Test Loss: 0.991 Test Acc: 0.750
Validation loss decreased (-0.738879 --> -0.749990).  Saving model ...
Epoch: 29 cost time: 2.0262250900268555
Epoch: 29, Steps: 12 | Train Loss: 0.770 Vali Loss: 0.968 Vali Acc: 0.739 Test Loss: 0.968 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.1697769165039062
Epoch: 30, Steps: 12 | Train Loss: 0.760 Vali Loss: 0.920 Vali Acc: 0.772 Test Loss: 0.920 Test Acc: 0.772
Validation loss decreased (-0.749990 --> -0.772213).  Saving model ...
Epoch: 31 cost time: 1.9749820232391357
Epoch: 31, Steps: 12 | Train Loss: 0.729 Vali Loss: 0.894 Vali Acc: 0.800 Test Loss: 0.894 Test Acc: 0.800
Validation loss decreased (-0.772213 --> -0.799991).  Saving model ...
Epoch: 32 cost time: 2.194000720977783
Epoch: 32, Steps: 12 | Train Loss: 0.721 Vali Loss: 0.898 Vali Acc: 0.761 Test Loss: 0.898 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.188349723815918
Epoch: 33, Steps: 12 | Train Loss: 0.623 Vali Loss: 0.852 Vali Acc: 0.767 Test Loss: 0.852 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.8106486797332764
Epoch: 34, Steps: 12 | Train Loss: 0.584 Vali Loss: 0.839 Vali Acc: 0.811 Test Loss: 0.839 Test Acc: 0.811
Validation loss decreased (-0.799991 --> -0.811103).  Saving model ...
Epoch: 35 cost time: 1.8056728839874268
Epoch: 35, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.831 Vali Acc: 0.783 Test Loss: 0.831 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.0346872806549072
Epoch: 36, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.774 Vali Acc: 0.811 Test Loss: 0.774 Test Acc: 0.811
Validation loss decreased (-0.811103 --> -0.811103).  Saving model ...
Epoch: 37 cost time: 2.294130802154541
Epoch: 37, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.761 Vali Acc: 0.789 Test Loss: 0.761 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.322664499282837
Epoch: 38, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.739 Vali Acc: 0.839 Test Loss: 0.739 Test Acc: 0.839
Validation loss decreased (-0.811103 --> -0.838881).  Saving model ...
Epoch: 39 cost time: 2.0971686840057373
Epoch: 39, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.670 Vali Acc: 0.856 Test Loss: 0.670 Test Acc: 0.856
Validation loss decreased (-0.838881 --> -0.855549).  Saving model ...
Epoch: 40 cost time: 2.0216832160949707
Epoch: 40, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.704 Vali Acc: 0.833 Test Loss: 0.704 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.151148557662964
Epoch: 41, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.712 Vali Acc: 0.822 Test Loss: 0.712 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.420712947845459
Epoch: 42, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.641 Vali Acc: 0.850 Test Loss: 0.641 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.9504902362823486
Epoch: 43, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.658 Vali Acc: 0.861 Test Loss: 0.658 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 44 cost time: 1.8883421421051025
Epoch: 44, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.623 Vali Acc: 0.844 Test Loss: 0.623 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.4341113567352295
Epoch: 45, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.610 Vali Acc: 0.844 Test Loss: 0.610 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.2916483879089355
Epoch: 46, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.618 Vali Acc: 0.861 Test Loss: 0.618 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 47 cost time: 2.197359800338745
Epoch: 47, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.601 Vali Acc: 0.850 Test Loss: 0.601 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 2.131570816040039
Epoch: 48, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.578 Vali Acc: 0.856 Test Loss: 0.578 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.8759539127349854
Epoch: 49, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.582 Vali Acc: 0.867 Test Loss: 0.582 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 50 cost time: 1.9940273761749268
Epoch: 50, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.582 Vali Acc: 0.844 Test Loss: 0.582 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 2.269278049468994
Epoch: 51, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.568 Vali Acc: 0.872 Test Loss: 0.568 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 52 cost time: 2.3069608211517334
Epoch: 52, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.516 Vali Acc: 0.867 Test Loss: 0.516 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 2.145967721939087
Epoch: 53, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.516 Vali Acc: 0.872 Test Loss: 0.516 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 54 cost time: 2.139427661895752
Epoch: 54, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.519 Vali Acc: 0.872 Test Loss: 0.519 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 2.236076593399048
Epoch: 55, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.536 Vali Acc: 0.867 Test Loss: 0.536 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.8977346420288086
Epoch: 56, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.511 Vali Acc: 0.878 Test Loss: 0.511 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 57 cost time: 1.656113862991333
Epoch: 57, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.495 Vali Acc: 0.856 Test Loss: 0.495 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 2.0367209911346436
Epoch: 58, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.503 Vali Acc: 0.883 Test Loss: 0.503 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883328).  Saving model ...
Epoch: 59 cost time: 2.106314182281494
Epoch: 59, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.482 Vali Acc: 0.872 Test Loss: 0.482 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.9627923965454102
Epoch: 60, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.465 Vali Acc: 0.878 Test Loss: 0.465 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.9157359600067139
Epoch: 61, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.475 Vali Acc: 0.867 Test Loss: 0.475 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.9188673496246338
Epoch: 62, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.492 Vali Acc: 0.878 Test Loss: 0.492 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.911921501159668
Epoch: 63, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.472 Vali Acc: 0.883 Test Loss: 0.472 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883329).  Saving model ...
Epoch: 64 cost time: 2.164717674255371
Epoch: 64, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.429 Vali Acc: 0.889 Test Loss: 0.429 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888885).  Saving model ...
Epoch: 65 cost time: 2.188612222671509
Epoch: 65, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.464 Vali Acc: 0.872 Test Loss: 0.464 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 2.237501621246338
Epoch: 66, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.503 Vali Acc: 0.889 Test Loss: 0.503 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 2.187653064727783
Epoch: 67, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.463 Vali Acc: 0.878 Test Loss: 0.463 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 2.5327908992767334
Epoch: 68, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.490 Vali Acc: 0.883 Test Loss: 0.490 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 1.918262004852295
Epoch: 69, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.519 Vali Acc: 0.867 Test Loss: 0.519 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 2.251924514770508
Epoch: 70, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 2.092742681503296
Epoch: 71, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.573 Vali Acc: 0.867 Test Loss: 0.573 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 1.7446205615997314
Epoch: 72, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.529 Vali Acc: 0.878 Test Loss: 0.529 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 1.8612587451934814
Epoch: 73, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.519 Vali Acc: 0.872 Test Loss: 0.519 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 1.9873926639556885
Epoch: 74, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.521 Vali Acc: 0.872 Test Loss: 0.521 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 235179
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4927737712860107
Epoch: 1, Steps: 12 | Train Loss: 2.902 Vali Loss: 2.833 Vali Acc: 0.028 Test Loss: 2.833 Test Acc: 0.028
Validation loss decreased (inf --> -0.027749).  Saving model ...
Epoch: 2 cost time: 1.9473507404327393
Epoch: 2, Steps: 12 | Train Loss: 2.878 Vali Loss: 2.770 Vali Acc: 0.033 Test Loss: 2.770 Test Acc: 0.033
Validation loss decreased (-0.027749 --> -0.033306).  Saving model ...
Epoch: 3 cost time: 2.07991361618042
Epoch: 3, Steps: 12 | Train Loss: 2.760 Vali Loss: 2.711 Vali Acc: 0.033 Test Loss: 2.711 Test Acc: 0.033
Validation loss decreased (-0.033306 --> -0.033306).  Saving model ...
Epoch: 4 cost time: 2.3056774139404297
Epoch: 4, Steps: 12 | Train Loss: 2.720 Vali Loss: 2.649 Vali Acc: 0.089 Test Loss: 2.649 Test Acc: 0.089
Validation loss decreased (-0.033306 --> -0.088862).  Saving model ...
Epoch: 5 cost time: 2.1206417083740234
Epoch: 5, Steps: 12 | Train Loss: 2.619 Vali Loss: 2.584 Vali Acc: 0.156 Test Loss: 2.584 Test Acc: 0.156
Validation loss decreased (-0.088862 --> -0.155530).  Saving model ...
Epoch: 6 cost time: 2.219599962234497
Epoch: 6, Steps: 12 | Train Loss: 2.483 Vali Loss: 2.497 Vali Acc: 0.206 Test Loss: 2.497 Test Acc: 0.206
Validation loss decreased (-0.155530 --> -0.205531).  Saving model ...
Epoch: 7 cost time: 2.735327959060669
Epoch: 7, Steps: 12 | Train Loss: 2.330 Vali Loss: 2.401 Vali Acc: 0.233 Test Loss: 2.401 Test Acc: 0.233
Validation loss decreased (-0.205531 --> -0.233309).  Saving model ...
Epoch: 8 cost time: 2.559110403060913
Epoch: 8, Steps: 12 | Train Loss: 2.292 Vali Loss: 2.327 Vali Acc: 0.278 Test Loss: 2.327 Test Acc: 0.278
Validation loss decreased (-0.233309 --> -0.277755).  Saving model ...
Epoch: 9 cost time: 2.091135025024414
Epoch: 9, Steps: 12 | Train Loss: 2.156 Vali Loss: 2.250 Vali Acc: 0.333 Test Loss: 2.250 Test Acc: 0.333
Validation loss decreased (-0.277755 --> -0.333311).  Saving model ...
Epoch: 10 cost time: 2.5999152660369873
Epoch: 10, Steps: 12 | Train Loss: 2.082 Vali Loss: 2.172 Vali Acc: 0.350 Test Loss: 2.172 Test Acc: 0.350
Validation loss decreased (-0.333311 --> -0.349978).  Saving model ...
Epoch: 11 cost time: 2.977755546569824
Epoch: 11, Steps: 12 | Train Loss: 1.992 Vali Loss: 2.090 Vali Acc: 0.378 Test Loss: 2.090 Test Acc: 0.378
Validation loss decreased (-0.349978 --> -0.377757).  Saving model ...
Epoch: 12 cost time: 2.123063325881958
Epoch: 12, Steps: 12 | Train Loss: 1.911 Vali Loss: 2.033 Vali Acc: 0.433 Test Loss: 2.033 Test Acc: 0.433
Validation loss decreased (-0.377757 --> -0.433313).  Saving model ...
Epoch: 13 cost time: 2.29048228263855
Epoch: 13, Steps: 12 | Train Loss: 1.834 Vali Loss: 1.957 Vali Acc: 0.433 Test Loss: 1.957 Test Acc: 0.433
Validation loss decreased (-0.433313 --> -0.433314).  Saving model ...
Epoch: 14 cost time: 1.9634010791778564
Epoch: 14, Steps: 12 | Train Loss: 1.804 Vali Loss: 1.888 Vali Acc: 0.506 Test Loss: 1.888 Test Acc: 0.506
Validation loss decreased (-0.433314 --> -0.505537).  Saving model ...
Epoch: 15 cost time: 2.2089476585388184
Epoch: 15, Steps: 12 | Train Loss: 1.700 Vali Loss: 1.819 Vali Acc: 0.522 Test Loss: 1.819 Test Acc: 0.522
Validation loss decreased (-0.505537 --> -0.522204).  Saving model ...
Epoch: 16 cost time: 1.8967082500457764
Epoch: 16, Steps: 12 | Train Loss: 1.596 Vali Loss: 1.740 Vali Acc: 0.583 Test Loss: 1.740 Test Acc: 0.583
Validation loss decreased (-0.522204 --> -0.583316).  Saving model ...
Epoch: 17 cost time: 2.071922779083252
Epoch: 17, Steps: 12 | Train Loss: 1.590 Vali Loss: 1.680 Vali Acc: 0.589 Test Loss: 1.680 Test Acc: 0.589
Validation loss decreased (-0.583316 --> -0.588872).  Saving model ...
Epoch: 18 cost time: 2.30549693107605
Epoch: 18, Steps: 12 | Train Loss: 1.458 Vali Loss: 1.605 Vali Acc: 0.594 Test Loss: 1.605 Test Acc: 0.594
Validation loss decreased (-0.588872 --> -0.594428).  Saving model ...
Epoch: 19 cost time: 2.098271131515503
Epoch: 19, Steps: 12 | Train Loss: 1.408 Vali Loss: 1.526 Vali Acc: 0.639 Test Loss: 1.526 Test Acc: 0.639
Validation loss decreased (-0.594428 --> -0.638874).  Saving model ...
Epoch: 20 cost time: 2.2715859413146973
Epoch: 20, Steps: 12 | Train Loss: 1.372 Vali Loss: 1.467 Vali Acc: 0.667 Test Loss: 1.467 Test Acc: 0.667
Validation loss decreased (-0.638874 --> -0.666652).  Saving model ...
Epoch: 21 cost time: 1.9570350646972656
Epoch: 21, Steps: 12 | Train Loss: 1.295 Vali Loss: 1.392 Vali Acc: 0.650 Test Loss: 1.392 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.2827298641204834
Epoch: 22, Steps: 12 | Train Loss: 1.213 Vali Loss: 1.329 Vali Acc: 0.689 Test Loss: 1.329 Test Acc: 0.689
Validation loss decreased (-0.666652 --> -0.688876).  Saving model ...
Epoch: 23 cost time: 2.0653293132781982
Epoch: 23, Steps: 12 | Train Loss: 1.147 Vali Loss: 1.262 Vali Acc: 0.700 Test Loss: 1.262 Test Acc: 0.700
Validation loss decreased (-0.688876 --> -0.699987).  Saving model ...
Epoch: 24 cost time: 2.100956439971924
Epoch: 24, Steps: 12 | Train Loss: 1.062 Vali Loss: 1.192 Vali Acc: 0.694 Test Loss: 1.192 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.2000300884246826
Epoch: 25, Steps: 12 | Train Loss: 1.037 Vali Loss: 1.136 Vali Acc: 0.739 Test Loss: 1.136 Test Acc: 0.739
Validation loss decreased (-0.699987 --> -0.738878).  Saving model ...
Epoch: 26 cost time: 2.209346055984497
Epoch: 26, Steps: 12 | Train Loss: 0.966 Vali Loss: 1.092 Vali Acc: 0.744 Test Loss: 1.092 Test Acc: 0.744
Validation loss decreased (-0.738878 --> -0.744434).  Saving model ...
Epoch: 27 cost time: 1.939582109451294
Epoch: 27, Steps: 12 | Train Loss: 0.893 Vali Loss: 1.047 Vali Acc: 0.767 Test Loss: 1.047 Test Acc: 0.767
Validation loss decreased (-0.744434 --> -0.766656).  Saving model ...
Epoch: 28 cost time: 2.1074788570404053
Epoch: 28, Steps: 12 | Train Loss: 0.843 Vali Loss: 0.990 Vali Acc: 0.783 Test Loss: 0.990 Test Acc: 0.783
Validation loss decreased (-0.766656 --> -0.783323).  Saving model ...
Epoch: 29 cost time: 2.1681814193725586
Epoch: 29, Steps: 12 | Train Loss: 0.787 Vali Loss: 0.928 Vali Acc: 0.822 Test Loss: 0.928 Test Acc: 0.822
Validation loss decreased (-0.783323 --> -0.822213).  Saving model ...
Epoch: 30 cost time: 2.2738685607910156
Epoch: 30, Steps: 12 | Train Loss: 0.755 Vali Loss: 0.900 Vali Acc: 0.794 Test Loss: 0.900 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.235647439956665
Epoch: 31, Steps: 12 | Train Loss: 0.678 Vali Loss: 0.848 Vali Acc: 0.806 Test Loss: 0.848 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.0112013816833496
Epoch: 32, Steps: 12 | Train Loss: 0.675 Vali Loss: 0.803 Vali Acc: 0.822 Test Loss: 0.803 Test Acc: 0.822
Validation loss decreased (-0.822213 --> -0.822214).  Saving model ...
Epoch: 33 cost time: 1.9796805381774902
Epoch: 33, Steps: 12 | Train Loss: 0.624 Vali Loss: 0.789 Vali Acc: 0.817 Test Loss: 0.789 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.0053224563598633
Epoch: 34, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.712 Vali Acc: 0.844 Test Loss: 0.712 Test Acc: 0.844
Validation loss decreased (-0.822214 --> -0.844437).  Saving model ...
Epoch: 35 cost time: 2.1885111331939697
Epoch: 35, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.696 Vali Acc: 0.833 Test Loss: 0.696 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.4241302013397217
Epoch: 36, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.659 Vali Acc: 0.850 Test Loss: 0.659 Test Acc: 0.850
Validation loss decreased (-0.844437 --> -0.849993).  Saving model ...
Epoch: 37 cost time: 2.059783458709717
Epoch: 37, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.638 Vali Acc: 0.861 Test Loss: 0.638 Test Acc: 0.861
Validation loss decreased (-0.849993 --> -0.861105).  Saving model ...
Epoch: 38 cost time: 2.230154037475586
Epoch: 38, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.620 Vali Acc: 0.867 Test Loss: 0.620 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866660).  Saving model ...
Epoch: 39 cost time: 2.395669460296631
Epoch: 39, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.576 Vali Acc: 0.867 Test Loss: 0.576 Test Acc: 0.867
Validation loss decreased (-0.866660 --> -0.866661).  Saving model ...
Epoch: 40 cost time: 2.548346757888794
Epoch: 40, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.549 Vali Acc: 0.883 Test Loss: 0.549 Test Acc: 0.883
Validation loss decreased (-0.866661 --> -0.883328).  Saving model ...
Epoch: 41 cost time: 1.9073607921600342
Epoch: 41, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.545 Vali Acc: 0.867 Test Loss: 0.545 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.931854486465454
Epoch: 42, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.547 Vali Acc: 0.878 Test Loss: 0.547 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.027200698852539
Epoch: 43, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.524 Vali Acc: 0.850 Test Loss: 0.524 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 2.21942400932312
Epoch: 44, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.512 Vali Acc: 0.883 Test Loss: 0.512 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883328).  Saving model ...
Epoch: 45 cost time: 2.207075595855713
Epoch: 45, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.487 Vali Acc: 0.878 Test Loss: 0.487 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.064459800720215
Epoch: 46, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.455 Vali Acc: 0.872 Test Loss: 0.455 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.051730155944824
Epoch: 47, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.487 Vali Acc: 0.878 Test Loss: 0.487 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 2.228095531463623
Epoch: 48, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.462 Vali Acc: 0.872 Test Loss: 0.462 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 2.187349319458008
Epoch: 49, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.442 Vali Acc: 0.872 Test Loss: 0.442 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 2.3174431324005127
Epoch: 50, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.467 Vali Acc: 0.861 Test Loss: 0.467 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 2.492600679397583
Epoch: 51, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.439 Vali Acc: 0.878 Test Loss: 0.439 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.7875452041625977
Epoch: 52, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.472 Vali Acc: 0.872 Test Loss: 0.472 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 2.4671859741210938
Epoch: 53, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.428 Vali Acc: 0.883 Test Loss: 0.428 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883329).  Saving model ...
Epoch: 54 cost time: 2.182598114013672
Epoch: 54, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.445 Vali Acc: 0.878 Test Loss: 0.445 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 2.1197309494018555
Epoch: 55, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.443 Vali Acc: 0.872 Test Loss: 0.443 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 2.109532356262207
Epoch: 56, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.502 Vali Acc: 0.872 Test Loss: 0.502 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.947657585144043
Epoch: 57, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.431 Vali Acc: 0.889 Test Loss: 0.431 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888885).  Saving model ...
Epoch: 58 cost time: 1.835521936416626
Epoch: 58, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.402 Vali Acc: 0.883 Test Loss: 0.402 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.8615307807922363
Epoch: 59, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.446 Vali Acc: 0.883 Test Loss: 0.446 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 2.256115436553955
Epoch: 60, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.434 Vali Acc: 0.883 Test Loss: 0.434 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.8255982398986816
Epoch: 61, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.489 Vali Acc: 0.867 Test Loss: 0.489 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.7383718490600586
Epoch: 62, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.391 Vali Acc: 0.883 Test Loss: 0.391 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 2.035747766494751
Epoch: 63, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.450 Vali Acc: 0.889 Test Loss: 0.450 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 2.3569400310516357
Epoch: 64, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.416 Vali Acc: 0.889 Test Loss: 0.416 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 65 cost time: 2.2353010177612305
Epoch: 65, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.429 Vali Acc: 0.889 Test Loss: 0.429 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 2.231677293777466
Epoch: 66, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.455 Vali Acc: 0.883 Test Loss: 0.455 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.9797890186309814
Epoch: 67, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.447 Vali Acc: 0.872 Test Loss: 0.447 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 2.123242139816284
Epoch: 68, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.449 Vali Acc: 0.889 Test Loss: 0.449 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 2.101109504699707
Epoch: 69, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.420 Vali Acc: 0.883 Test Loss: 0.420 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 2.345031976699829
Epoch: 70, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.448 Vali Acc: 0.883 Test Loss: 0.448 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 1.9576122760772705
Epoch: 71, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.389 Vali Acc: 0.889 Test Loss: 0.389 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 72 cost time: 1.8603003025054932
Epoch: 72, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.452 Vali Acc: 0.872 Test Loss: 0.452 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 2.1974592208862305
Epoch: 73, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.466 Vali Acc: 0.889 Test Loss: 0.466 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 2.1050875186920166
Epoch: 74, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.521 Vali Acc: 0.883 Test Loss: 0.521 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 2.11586856842041
Epoch: 75, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.499 Vali Acc: 0.883 Test Loss: 0.499 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 2.2090532779693604
Epoch: 76, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.423 Vali Acc: 0.878 Test Loss: 0.423 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 2.301419496536255
Epoch: 77, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.458 Vali Acc: 0.878 Test Loss: 0.458 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 2.3093316555023193
Epoch: 78, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.468 Vali Acc: 0.889 Test Loss: 0.468 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 2.346417188644409
Epoch: 79, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.494 Vali Acc: 0.889 Test Loss: 0.494 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 1.9715747833251953
Epoch: 80, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.492 Vali Acc: 0.883 Test Loss: 0.492 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 81 cost time: 2.034874677658081
Epoch: 81, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.499 Vali Acc: 0.883 Test Loss: 0.499 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 234923
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.454171657562256
Epoch: 1, Steps: 12 | Train Loss: 2.870 Vali Loss: 2.826 Vali Acc: 0.106 Test Loss: 2.826 Test Acc: 0.106
Validation loss decreased (inf --> -0.105527).  Saving model ...
Epoch: 2 cost time: 1.9924356937408447
Epoch: 2, Steps: 12 | Train Loss: 2.805 Vali Loss: 2.768 Vali Acc: 0.133 Test Loss: 2.768 Test Acc: 0.133
Validation loss decreased (-0.105527 --> -0.133306).  Saving model ...
Epoch: 3 cost time: 2.290250301361084
Epoch: 3, Steps: 12 | Train Loss: 2.727 Vali Loss: 2.692 Vali Acc: 0.144 Test Loss: 2.692 Test Acc: 0.144
Validation loss decreased (-0.133306 --> -0.144418).  Saving model ...
Epoch: 4 cost time: 1.956117868423462
Epoch: 4, Steps: 12 | Train Loss: 2.667 Vali Loss: 2.622 Vali Acc: 0.194 Test Loss: 2.622 Test Acc: 0.194
Validation loss decreased (-0.144418 --> -0.194418).  Saving model ...
Epoch: 5 cost time: 1.9198722839355469
Epoch: 5, Steps: 12 | Train Loss: 2.550 Vali Loss: 2.541 Vali Acc: 0.211 Test Loss: 2.541 Test Acc: 0.211
Validation loss decreased (-0.194418 --> -0.211086).  Saving model ...
Epoch: 6 cost time: 2.0834014415740967
Epoch: 6, Steps: 12 | Train Loss: 2.553 Vali Loss: 2.466 Vali Acc: 0.278 Test Loss: 2.466 Test Acc: 0.278
Validation loss decreased (-0.211086 --> -0.277753).  Saving model ...
Epoch: 7 cost time: 1.9848785400390625
Epoch: 7, Steps: 12 | Train Loss: 2.467 Vali Loss: 2.373 Vali Acc: 0.278 Test Loss: 2.373 Test Acc: 0.278
Validation loss decreased (-0.277753 --> -0.277754).  Saving model ...
Epoch: 8 cost time: 2.07438325881958
Epoch: 8, Steps: 12 | Train Loss: 2.376 Vali Loss: 2.287 Vali Acc: 0.372 Test Loss: 2.287 Test Acc: 0.372
Validation loss decreased (-0.277754 --> -0.372199).  Saving model ...
Epoch: 9 cost time: 1.9391117095947266
Epoch: 9, Steps: 12 | Train Loss: 2.266 Vali Loss: 2.216 Vali Acc: 0.367 Test Loss: 2.216 Test Acc: 0.367
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.980637788772583
Epoch: 10, Steps: 12 | Train Loss: 2.164 Vali Loss: 2.150 Vali Acc: 0.394 Test Loss: 2.150 Test Acc: 0.394
Validation loss decreased (-0.372199 --> -0.394423).  Saving model ...
Epoch: 11 cost time: 1.7752606868743896
Epoch: 11, Steps: 12 | Train Loss: 2.008 Vali Loss: 2.081 Vali Acc: 0.383 Test Loss: 2.081 Test Acc: 0.383
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8405351638793945
Epoch: 12, Steps: 12 | Train Loss: 1.970 Vali Loss: 2.019 Vali Acc: 0.428 Test Loss: 2.019 Test Acc: 0.428
Validation loss decreased (-0.394423 --> -0.427758).  Saving model ...
Epoch: 13 cost time: 2.3747189044952393
Epoch: 13, Steps: 12 | Train Loss: 1.908 Vali Loss: 1.952 Vali Acc: 0.428 Test Loss: 1.952 Test Acc: 0.428
Validation loss decreased (-0.427758 --> -0.427758).  Saving model ...
Epoch: 14 cost time: 1.8002026081085205
Epoch: 14, Steps: 12 | Train Loss: 1.816 Vali Loss: 1.893 Vali Acc: 0.467 Test Loss: 1.893 Test Acc: 0.467
Validation loss decreased (-0.427758 --> -0.466648).  Saving model ...
Epoch: 15 cost time: 1.7584309577941895
Epoch: 15, Steps: 12 | Train Loss: 1.735 Vali Loss: 1.822 Vali Acc: 0.467 Test Loss: 1.822 Test Acc: 0.467
Validation loss decreased (-0.466648 --> -0.466648).  Saving model ...
Epoch: 16 cost time: 1.866835117340088
Epoch: 16, Steps: 12 | Train Loss: 1.654 Vali Loss: 1.728 Vali Acc: 0.517 Test Loss: 1.728 Test Acc: 0.517
Validation loss decreased (-0.466648 --> -0.516649).  Saving model ...
Epoch: 17 cost time: 2.261997699737549
Epoch: 17, Steps: 12 | Train Loss: 1.573 Vali Loss: 1.661 Vali Acc: 0.533 Test Loss: 1.661 Test Acc: 0.533
Validation loss decreased (-0.516649 --> -0.533317).  Saving model ...
Epoch: 18 cost time: 2.041369676589966
Epoch: 18, Steps: 12 | Train Loss: 1.448 Vali Loss: 1.611 Vali Acc: 0.544 Test Loss: 1.611 Test Acc: 0.544
Validation loss decreased (-0.533317 --> -0.544428).  Saving model ...
Epoch: 19 cost time: 2.315166711807251
Epoch: 19, Steps: 12 | Train Loss: 1.411 Vali Loss: 1.546 Vali Acc: 0.556 Test Loss: 1.546 Test Acc: 0.556
Validation loss decreased (-0.544428 --> -0.555540).  Saving model ...
Epoch: 20 cost time: 2.183586359024048
Epoch: 20, Steps: 12 | Train Loss: 1.377 Vali Loss: 1.463 Vali Acc: 0.561 Test Loss: 1.463 Test Acc: 0.561
Validation loss decreased (-0.555540 --> -0.561096).  Saving model ...
Epoch: 21 cost time: 2.088996648788452
Epoch: 21, Steps: 12 | Train Loss: 1.286 Vali Loss: 1.388 Vali Acc: 0.644 Test Loss: 1.388 Test Acc: 0.644
Validation loss decreased (-0.561096 --> -0.644431).  Saving model ...
Epoch: 22 cost time: 1.945690393447876
Epoch: 22, Steps: 12 | Train Loss: 1.210 Vali Loss: 1.340 Vali Acc: 0.628 Test Loss: 1.340 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9370379447937012
Epoch: 23, Steps: 12 | Train Loss: 1.126 Vali Loss: 1.278 Vali Acc: 0.639 Test Loss: 1.278 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.165485143661499
Epoch: 24, Steps: 12 | Train Loss: 1.095 Vali Loss: 1.209 Vali Acc: 0.639 Test Loss: 1.209 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.033376932144165
Epoch: 25, Steps: 12 | Train Loss: 1.059 Vali Loss: 1.171 Vali Acc: 0.650 Test Loss: 1.171 Test Acc: 0.650
Validation loss decreased (-0.644431 --> -0.649988).  Saving model ...
Epoch: 26 cost time: 1.8557541370391846
Epoch: 26, Steps: 12 | Train Loss: 0.980 Vali Loss: 1.129 Vali Acc: 0.678 Test Loss: 1.129 Test Acc: 0.678
Validation loss decreased (-0.649988 --> -0.677766).  Saving model ...
Epoch: 27 cost time: 1.8760950565338135
Epoch: 27, Steps: 12 | Train Loss: 0.882 Vali Loss: 1.093 Vali Acc: 0.711 Test Loss: 1.093 Test Acc: 0.711
Validation loss decreased (-0.677766 --> -0.711100).  Saving model ...
Epoch: 28 cost time: 1.8453099727630615
Epoch: 28, Steps: 12 | Train Loss: 0.853 Vali Loss: 1.057 Vali Acc: 0.711 Test Loss: 1.057 Test Acc: 0.711
Validation loss decreased (-0.711100 --> -0.711101).  Saving model ...
Epoch: 29 cost time: 1.9772696495056152
Epoch: 29, Steps: 12 | Train Loss: 0.826 Vali Loss: 0.987 Vali Acc: 0.717 Test Loss: 0.987 Test Acc: 0.717
Validation loss decreased (-0.711101 --> -0.716657).  Saving model ...
Epoch: 30 cost time: 1.8975679874420166
Epoch: 30, Steps: 12 | Train Loss: 0.802 Vali Loss: 0.978 Vali Acc: 0.739 Test Loss: 0.978 Test Acc: 0.739
Validation loss decreased (-0.716657 --> -0.738879).  Saving model ...
Epoch: 31 cost time: 1.7754132747650146
Epoch: 31, Steps: 12 | Train Loss: 0.708 Vali Loss: 0.899 Vali Acc: 0.728 Test Loss: 0.899 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.921658992767334
Epoch: 32, Steps: 12 | Train Loss: 0.684 Vali Loss: 0.902 Vali Acc: 0.750 Test Loss: 0.902 Test Acc: 0.750
Validation loss decreased (-0.738879 --> -0.749991).  Saving model ...
Epoch: 33 cost time: 2.4470748901367188
Epoch: 33, Steps: 12 | Train Loss: 0.678 Vali Loss: 0.866 Vali Acc: 0.750 Test Loss: 0.866 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 34 cost time: 2.2015886306762695
Epoch: 34, Steps: 12 | Train Loss: 0.605 Vali Loss: 0.819 Vali Acc: 0.811 Test Loss: 0.819 Test Acc: 0.811
Validation loss decreased (-0.749991 --> -0.811103).  Saving model ...
Epoch: 35 cost time: 2.3265883922576904
Epoch: 35, Steps: 12 | Train Loss: 0.570 Vali Loss: 0.801 Vali Acc: 0.806 Test Loss: 0.801 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.1109604835510254
Epoch: 36, Steps: 12 | Train Loss: 0.559 Vali Loss: 0.756 Vali Acc: 0.817 Test Loss: 0.756 Test Acc: 0.817
Validation loss decreased (-0.811103 --> -0.816659).  Saving model ...
Epoch: 37 cost time: 2.127182722091675
Epoch: 37, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.754 Vali Acc: 0.800 Test Loss: 0.754 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.9922106266021729
Epoch: 38, Steps: 12 | Train Loss: 0.510 Vali Loss: 0.741 Vali Acc: 0.828 Test Loss: 0.741 Test Acc: 0.828
Validation loss decreased (-0.816659 --> -0.827770).  Saving model ...
Epoch: 39 cost time: 1.845508337020874
Epoch: 39, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.734 Vali Acc: 0.806 Test Loss: 0.734 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.0139975547790527
Epoch: 40, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.673 Vali Acc: 0.850 Test Loss: 0.673 Test Acc: 0.850
Validation loss decreased (-0.827770 --> -0.849993).  Saving model ...
Epoch: 41 cost time: 1.960719108581543
Epoch: 41, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.679 Vali Acc: 0.844 Test Loss: 0.679 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.0436885356903076
Epoch: 42, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.645 Vali Acc: 0.844 Test Loss: 0.645 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.20682954788208
Epoch: 43, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.643 Vali Acc: 0.828 Test Loss: 0.643 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 2.093759298324585
Epoch: 44, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.632 Vali Acc: 0.822 Test Loss: 0.632 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 2.134024143218994
Epoch: 45, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.615 Vali Acc: 0.822 Test Loss: 0.615 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 2.1503665447235107
Epoch: 46, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.605 Vali Acc: 0.839 Test Loss: 0.605 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 2.0297272205352783
Epoch: 47, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.618 Vali Acc: 0.833 Test Loss: 0.618 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 2.020005702972412
Epoch: 48, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.616 Vali Acc: 0.833 Test Loss: 0.616 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 2.125565767288208
Epoch: 49, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.560 Vali Acc: 0.850 Test Loss: 0.560 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 50 cost time: 2.0912671089172363
Epoch: 50, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.574 Vali Acc: 0.844 Test Loss: 0.574 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.8024287223815918
Epoch: 51, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.584 Vali Acc: 0.833 Test Loss: 0.584 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 2.3408265113830566
Epoch: 52, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.549 Vali Acc: 0.856 Test Loss: 0.549 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 53 cost time: 2.1586506366729736
Epoch: 53, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.586 Vali Acc: 0.839 Test Loss: 0.586 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.9369933605194092
Epoch: 54, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.564 Vali Acc: 0.867 Test Loss: 0.564 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 55 cost time: 2.0775797367095947
Epoch: 55, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.553 Vali Acc: 0.850 Test Loss: 0.553 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 2.1801912784576416
Epoch: 56, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.558 Vali Acc: 0.872 Test Loss: 0.558 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 57 cost time: 2.1197702884674072
Epoch: 57, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.524 Vali Acc: 0.861 Test Loss: 0.524 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 2.400499105453491
Epoch: 58, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.602 Vali Acc: 0.839 Test Loss: 0.602 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.9437041282653809
Epoch: 59, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.525 Vali Acc: 0.867 Test Loss: 0.525 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 2.023881435394287
Epoch: 60, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.514 Vali Acc: 0.861 Test Loss: 0.514 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 2.300931930541992
Epoch: 61, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.552 Vali Acc: 0.850 Test Loss: 0.552 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 2.1680333614349365
Epoch: 62, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.555 Vali Acc: 0.844 Test Loss: 0.555 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.8199293613433838
Epoch: 63, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.534 Vali Acc: 0.850 Test Loss: 0.534 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 1.9583191871643066
Epoch: 64, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.535 Vali Acc: 0.867 Test Loss: 0.535 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 1.8746767044067383
Epoch: 65, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.511 Vali Acc: 0.878 Test Loss: 0.511 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 66 cost time: 2.2443606853485107
Epoch: 66, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.569 Vali Acc: 0.839 Test Loss: 0.569 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 2.18170428276062
Epoch: 67, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.519 Vali Acc: 0.867 Test Loss: 0.519 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 2.026982307434082
Epoch: 68, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.579 Vali Acc: 0.861 Test Loss: 0.579 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 2.0607359409332275
Epoch: 69, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.552 Vali Acc: 0.856 Test Loss: 0.552 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.9906020164489746
Epoch: 70, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.580 Vali Acc: 0.850 Test Loss: 0.580 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.969783067703247
Epoch: 71, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.544 Vali Acc: 0.861 Test Loss: 0.544 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 2.3021581172943115
Epoch: 72, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.545 Vali Acc: 0.872 Test Loss: 0.545 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 2.274829149246216
Epoch: 73, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.576 Vali Acc: 0.861 Test Loss: 0.576 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 2.122128963470459
Epoch: 74, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.550 Vali Acc: 0.867 Test Loss: 0.550 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 2.0036606788635254
Epoch: 75, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.550 Vali Acc: 0.856 Test Loss: 0.550 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 234667
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8402106761932373
Epoch: 1, Steps: 12 | Train Loss: 2.757 Vali Loss: 2.529 Vali Acc: 0.167 Test Loss: 2.529 Test Acc: 0.167
Validation loss decreased (inf --> -0.166641).  Saving model ...
Epoch: 2 cost time: 1.6084001064300537
Epoch: 2, Steps: 12 | Train Loss: 2.402 Vali Loss: 2.098 Vali Acc: 0.511 Test Loss: 2.098 Test Acc: 0.511
Validation loss decreased (-0.166641 --> -0.511090).  Saving model ...
Epoch: 3 cost time: 1.7253193855285645
Epoch: 3, Steps: 12 | Train Loss: 1.816 Vali Loss: 1.648 Vali Acc: 0.511 Test Loss: 1.648 Test Acc: 0.511
Validation loss decreased (-0.511090 --> -0.511095).  Saving model ...
Epoch: 4 cost time: 1.679335594177246
Epoch: 4, Steps: 12 | Train Loss: 1.421 Vali Loss: 1.349 Vali Acc: 0.606 Test Loss: 1.349 Test Acc: 0.606
Validation loss decreased (-0.511095 --> -0.605542).  Saving model ...
Epoch: 5 cost time: 1.7316813468933105
Epoch: 5, Steps: 12 | Train Loss: 1.079 Vali Loss: 1.169 Vali Acc: 0.622 Test Loss: 1.169 Test Acc: 0.622
Validation loss decreased (-0.605542 --> -0.622211).  Saving model ...
Epoch: 6 cost time: 2.4727516174316406
Epoch: 6, Steps: 12 | Train Loss: 0.994 Vali Loss: 1.101 Vali Acc: 0.683 Test Loss: 1.101 Test Acc: 0.683
Validation loss decreased (-0.622211 --> -0.683322).  Saving model ...
Epoch: 7 cost time: 1.8738572597503662
Epoch: 7, Steps: 12 | Train Loss: 0.750 Vali Loss: 0.888 Vali Acc: 0.733 Test Loss: 0.888 Test Acc: 0.733
Validation loss decreased (-0.683322 --> -0.733324).  Saving model ...
Epoch: 8 cost time: 1.7440297603607178
Epoch: 8, Steps: 12 | Train Loss: 0.628 Vali Loss: 0.944 Vali Acc: 0.728 Test Loss: 0.944 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6085033416748047
Epoch: 9, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.911 Vali Acc: 0.711 Test Loss: 0.911 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6649670600891113
Epoch: 10, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.686 Vali Acc: 0.806 Test Loss: 0.686 Test Acc: 0.806
Validation loss decreased (-0.733324 --> -0.805549).  Saving model ...
Epoch: 11 cost time: 2.062751531600952
Epoch: 11, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.788 Vali Acc: 0.767 Test Loss: 0.788 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9484317302703857
Epoch: 12, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.579 Vali Acc: 0.839 Test Loss: 0.579 Test Acc: 0.839
Validation loss decreased (-0.805549 --> -0.838883).  Saving model ...
Epoch: 13 cost time: 1.9977343082427979
Epoch: 13, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.569 Vali Acc: 0.844 Test Loss: 0.569 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 14 cost time: 1.7847459316253662
Epoch: 14, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.760 Vali Acc: 0.772 Test Loss: 0.760 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7782602310180664
Epoch: 15, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.608 Vali Acc: 0.833 Test Loss: 0.608 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4481050968170166
Epoch: 16, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.679 Vali Acc: 0.833 Test Loss: 0.679 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7654569149017334
Epoch: 17, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.605 Vali Acc: 0.856 Test Loss: 0.605 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 18 cost time: 1.9801404476165771
Epoch: 18, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.656 Vali Acc: 0.844 Test Loss: 0.656 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.926377773284912
Epoch: 19, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.543 Vali Acc: 0.856 Test Loss: 0.543 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 20 cost time: 1.5486388206481934
Epoch: 20, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.711 Vali Acc: 0.839 Test Loss: 0.711 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4193756580352783
Epoch: 21, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.681 Vali Acc: 0.850 Test Loss: 0.681 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8952972888946533
Epoch: 22, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.615 Vali Acc: 0.856 Test Loss: 0.615 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.9193158149719238
Epoch: 23, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.676 Vali Acc: 0.861 Test Loss: 0.676 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861104).  Saving model ...
Epoch: 24 cost time: 1.5803794860839844
Epoch: 24, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.738 Vali Acc: 0.833 Test Loss: 0.738 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7441108226776123
Epoch: 25, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.580 Vali Acc: 0.867 Test Loss: 0.580 Test Acc: 0.867
Validation loss decreased (-0.861104 --> -0.866661).  Saving model ...
Epoch: 26 cost time: 1.6893503665924072
Epoch: 26, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.627 Vali Acc: 0.878 Test Loss: 0.627 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877772).  Saving model ...
Epoch: 27 cost time: 1.7352674007415771
Epoch: 27, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.533 Vali Acc: 0.883 Test Loss: 0.533 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883328).  Saving model ...
Epoch: 28 cost time: 1.648045539855957
Epoch: 28, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.516 Vali Acc: 0.894 Test Loss: 0.516 Test Acc: 0.894
Validation loss decreased (-0.883328 --> -0.894439).  Saving model ...
Epoch: 29 cost time: 1.77730393409729
Epoch: 29, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.550 Vali Acc: 0.883 Test Loss: 0.550 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5704402923583984
Epoch: 30, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.582 Vali Acc: 0.883 Test Loss: 0.582 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.794419527053833
Epoch: 31, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.579 Vali Acc: 0.883 Test Loss: 0.579 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.5661475658416748
Epoch: 32, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.599 Vali Acc: 0.889 Test Loss: 0.599 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.5821597576141357
Epoch: 33, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.618 Vali Acc: 0.889 Test Loss: 0.618 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.7975349426269531
Epoch: 34, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.625 Vali Acc: 0.889 Test Loss: 0.625 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.1718544960021973
Epoch: 35, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.632 Vali Acc: 0.894 Test Loss: 0.632 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.9758713245391846
Epoch: 36, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.639 Vali Acc: 0.889 Test Loss: 0.639 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.8776001930236816
Epoch: 37, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.635 Vali Acc: 0.889 Test Loss: 0.635 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.8418710231781006
Epoch: 38, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.634 Vali Acc: 0.889 Test Loss: 0.634 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 11102271
model size : 47.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.828629970550537
Epoch: 1, Steps: 12 | Train Loss: 2.752 Vali Loss: 2.613 Vali Acc: 0.178 Test Loss: 2.613 Test Acc: 0.178
Validation loss decreased (inf --> -0.177752).  Saving model ...
Epoch: 2 cost time: 1.9373972415924072
Epoch: 2, Steps: 12 | Train Loss: 2.446 Vali Loss: 2.107 Vali Acc: 0.439 Test Loss: 2.107 Test Acc: 0.439
Validation loss decreased (-0.177752 --> -0.438868).  Saving model ...
Epoch: 3 cost time: 1.8456175327301025
Epoch: 3, Steps: 12 | Train Loss: 1.896 Vali Loss: 1.737 Vali Acc: 0.506 Test Loss: 1.737 Test Acc: 0.506
Validation loss decreased (-0.438868 --> -0.505538).  Saving model ...
Epoch: 4 cost time: 1.742630958557129
Epoch: 4, Steps: 12 | Train Loss: 1.457 Vali Loss: 1.519 Vali Acc: 0.539 Test Loss: 1.519 Test Acc: 0.539
Validation loss decreased (-0.505538 --> -0.538874).  Saving model ...
Epoch: 5 cost time: 1.9068655967712402
Epoch: 5, Steps: 12 | Train Loss: 1.272 Vali Loss: 1.293 Vali Acc: 0.572 Test Loss: 1.293 Test Acc: 0.572
Validation loss decreased (-0.538874 --> -0.572209).  Saving model ...
Epoch: 6 cost time: 1.593566656112671
Epoch: 6, Steps: 12 | Train Loss: 0.959 Vali Loss: 1.130 Vali Acc: 0.633 Test Loss: 1.130 Test Acc: 0.633
Validation loss decreased (-0.572209 --> -0.633322).  Saving model ...
Epoch: 7 cost time: 2.426203966140747
Epoch: 7, Steps: 12 | Train Loss: 0.814 Vali Loss: 0.964 Vali Acc: 0.722 Test Loss: 0.964 Test Acc: 0.722
Validation loss decreased (-0.633322 --> -0.722213).  Saving model ...
Epoch: 8 cost time: 1.834291934967041
Epoch: 8, Steps: 12 | Train Loss: 0.596 Vali Loss: 0.854 Vali Acc: 0.728 Test Loss: 0.854 Test Acc: 0.728
Validation loss decreased (-0.722213 --> -0.727769).  Saving model ...
Epoch: 9 cost time: 1.705223560333252
Epoch: 9, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.770 Vali Acc: 0.756 Test Loss: 0.770 Test Acc: 0.756
Validation loss decreased (-0.727769 --> -0.755548).  Saving model ...
Epoch: 10 cost time: 1.6494247913360596
Epoch: 10, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.676 Vali Acc: 0.800 Test Loss: 0.676 Test Acc: 0.800
Validation loss decreased (-0.755548 --> -0.799993).  Saving model ...
Epoch: 11 cost time: 1.7983763217926025
Epoch: 11, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.598 Vali Acc: 0.850 Test Loss: 0.598 Test Acc: 0.850
Validation loss decreased (-0.799993 --> -0.849994).  Saving model ...
Epoch: 12 cost time: 1.6871073246002197
Epoch: 12, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.647 Vali Acc: 0.806 Test Loss: 0.647 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.963369369506836
Epoch: 13, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.619 Vali Acc: 0.850 Test Loss: 0.619 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.477597713470459
Epoch: 14, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.605 Vali Acc: 0.861 Test Loss: 0.605 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 15 cost time: 1.7869596481323242
Epoch: 15, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.700 Vali Acc: 0.856 Test Loss: 0.700 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.503206729888916
Epoch: 16, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.561 Vali Acc: 0.856 Test Loss: 0.561 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.031172513961792
Epoch: 17, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.635 Vali Acc: 0.856 Test Loss: 0.635 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7966523170471191
Epoch: 18, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.548 Vali Acc: 0.856 Test Loss: 0.548 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6981704235076904
Epoch: 19, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.735 Vali Acc: 0.856 Test Loss: 0.735 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.6842584609985352
Epoch: 20, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.753 Vali Acc: 0.822 Test Loss: 0.753 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.6134531497955322
Epoch: 21, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.499 Vali Acc: 0.850 Test Loss: 0.499 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.8957536220550537
Epoch: 22, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.616 Vali Acc: 0.844 Test Loss: 0.616 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.7872767448425293
Epoch: 23, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.592 Vali Acc: 0.856 Test Loss: 0.592 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.775909662246704
Epoch: 24, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.636 Vali Acc: 0.833 Test Loss: 0.636 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 11100479
model size : 47.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8587441444396973
Epoch: 1, Steps: 12 | Train Loss: 2.802 Vali Loss: 2.565 Vali Acc: 0.156 Test Loss: 2.565 Test Acc: 0.156
Validation loss decreased (inf --> -0.155530).  Saving model ...
Epoch: 2 cost time: 1.6531932353973389
Epoch: 2, Steps: 12 | Train Loss: 2.433 Vali Loss: 2.173 Vali Acc: 0.406 Test Loss: 2.173 Test Acc: 0.406
Validation loss decreased (-0.155530 --> -0.405534).  Saving model ...
Epoch: 3 cost time: 1.7176964282989502
Epoch: 3, Steps: 12 | Train Loss: 1.966 Vali Loss: 1.712 Vali Acc: 0.461 Test Loss: 1.712 Test Acc: 0.461
Validation loss decreased (-0.405534 --> -0.461094).  Saving model ...
Epoch: 4 cost time: 1.8964457511901855
Epoch: 4, Steps: 12 | Train Loss: 1.464 Vali Loss: 1.406 Vali Acc: 0.556 Test Loss: 1.406 Test Acc: 0.556
Validation loss decreased (-0.461094 --> -0.555541).  Saving model ...
Epoch: 5 cost time: 1.7899341583251953
Epoch: 5, Steps: 12 | Train Loss: 1.144 Vali Loss: 1.177 Vali Acc: 0.622 Test Loss: 1.177 Test Acc: 0.622
Validation loss decreased (-0.555541 --> -0.622210).  Saving model ...
Epoch: 6 cost time: 1.6428425312042236
Epoch: 6, Steps: 12 | Train Loss: 0.931 Vali Loss: 1.188 Vali Acc: 0.628 Test Loss: 1.188 Test Acc: 0.628
Validation loss decreased (-0.622210 --> -0.627766).  Saving model ...
Epoch: 7 cost time: 2.0504963397979736
Epoch: 7, Steps: 12 | Train Loss: 0.877 Vali Loss: 0.944 Vali Acc: 0.728 Test Loss: 0.944 Test Acc: 0.728
Validation loss decreased (-0.627766 --> -0.727768).  Saving model ...
Epoch: 8 cost time: 2.1751320362091064
Epoch: 8, Steps: 12 | Train Loss: 0.654 Vali Loss: 0.848 Vali Acc: 0.717 Test Loss: 0.848 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9338340759277344
Epoch: 9, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.813 Vali Acc: 0.739 Test Loss: 0.813 Test Acc: 0.739
Validation loss decreased (-0.727768 --> -0.738881).  Saving model ...
Epoch: 10 cost time: 1.5926892757415771
Epoch: 10, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.686 Vali Acc: 0.833 Test Loss: 0.686 Test Acc: 0.833
Validation loss decreased (-0.738881 --> -0.833326).  Saving model ...
Epoch: 11 cost time: 1.9233531951904297
Epoch: 11, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.579 Vali Acc: 0.828 Test Loss: 0.579 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.92466139793396
Epoch: 12, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.789 Vali Acc: 0.794 Test Loss: 0.789 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.668792724609375
Epoch: 13, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.575 Vali Acc: 0.850 Test Loss: 0.575 Test Acc: 0.850
Validation loss decreased (-0.833326 --> -0.849994).  Saving model ...
Epoch: 14 cost time: 1.6659109592437744
Epoch: 14, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.626 Vali Acc: 0.844 Test Loss: 0.626 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.505553960800171
Epoch: 15, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.629 Vali Acc: 0.839 Test Loss: 0.629 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7607378959655762
Epoch: 16, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.626 Vali Acc: 0.844 Test Loss: 0.626 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.8380072116851807
Epoch: 17, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.573 Vali Acc: 0.833 Test Loss: 0.573 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7644538879394531
Epoch: 18, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.567 Vali Acc: 0.839 Test Loss: 0.567 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6501200199127197
Epoch: 19, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.515 Vali Acc: 0.878 Test Loss: 0.515 Test Acc: 0.878
Validation loss decreased (-0.849994 --> -0.877773).  Saving model ...
Epoch: 20 cost time: 1.5893206596374512
Epoch: 20, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.568 Vali Acc: 0.850 Test Loss: 0.568 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.831230640411377
Epoch: 21, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.600 Vali Acc: 0.883 Test Loss: 0.600 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883327).  Saving model ...
Epoch: 22 cost time: 1.6604971885681152
Epoch: 22, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.674 Vali Acc: 0.883 Test Loss: 0.674 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7828898429870605
Epoch: 23, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.735 Vali Acc: 0.856 Test Loss: 0.735 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.717696189880371
Epoch: 24, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.645 Vali Acc: 0.878 Test Loss: 0.645 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.7492167949676514
Epoch: 25, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.694 Vali Acc: 0.861 Test Loss: 0.694 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.6727447509765625
Epoch: 26, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.694 Vali Acc: 0.839 Test Loss: 0.694 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.6990127563476562
Epoch: 27, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.651 Vali Acc: 0.867 Test Loss: 0.651 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.0602476596832275
Epoch: 28, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.619 Vali Acc: 0.867 Test Loss: 0.619 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.9370434284210205
Epoch: 29, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.643 Vali Acc: 0.883 Test Loss: 0.643 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.0216245651245117
Epoch: 30, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.634 Vali Acc: 0.883 Test Loss: 0.634 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.546393871307373
Epoch: 31, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.641 Vali Acc: 0.878 Test Loss: 0.641 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 11098687
model size : 47.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.239035606384277
Epoch: 1, Steps: 12 | Train Loss: 2.848 Vali Loss: 2.632 Vali Acc: 0.139 Test Loss: 2.632 Test Acc: 0.139
Validation loss decreased (inf --> -0.138863).  Saving model ...
Epoch: 2 cost time: 1.6513495445251465
Epoch: 2, Steps: 12 | Train Loss: 2.449 Vali Loss: 2.141 Vali Acc: 0.433 Test Loss: 2.141 Test Acc: 0.433
Validation loss decreased (-0.138863 --> -0.433312).  Saving model ...
Epoch: 3 cost time: 1.4327337741851807
Epoch: 3, Steps: 12 | Train Loss: 1.902 Vali Loss: 1.705 Vali Acc: 0.511 Test Loss: 1.705 Test Acc: 0.511
Validation loss decreased (-0.433312 --> -0.511094).  Saving model ...
Epoch: 4 cost time: 1.7513759136199951
Epoch: 4, Steps: 12 | Train Loss: 1.404 Vali Loss: 1.438 Vali Acc: 0.589 Test Loss: 1.438 Test Acc: 0.589
Validation loss decreased (-0.511094 --> -0.588875).  Saving model ...
Epoch: 5 cost time: 2.0412604808807373
Epoch: 5, Steps: 12 | Train Loss: 1.132 Vali Loss: 1.164 Vali Acc: 0.622 Test Loss: 1.164 Test Acc: 0.622
Validation loss decreased (-0.588875 --> -0.622211).  Saving model ...
Epoch: 6 cost time: 1.7684624195098877
Epoch: 6, Steps: 12 | Train Loss: 0.912 Vali Loss: 1.089 Vali Acc: 0.661 Test Loss: 1.089 Test Acc: 0.661
Validation loss decreased (-0.622211 --> -0.661100).  Saving model ...
Epoch: 7 cost time: 1.689272403717041
Epoch: 7, Steps: 12 | Train Loss: 0.795 Vali Loss: 0.956 Vali Acc: 0.706 Test Loss: 0.956 Test Acc: 0.706
Validation loss decreased (-0.661100 --> -0.705546).  Saving model ...
Epoch: 8 cost time: 1.9327666759490967
Epoch: 8, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.916 Vali Acc: 0.711 Test Loss: 0.916 Test Acc: 0.711
Validation loss decreased (-0.705546 --> -0.711102).  Saving model ...
Epoch: 9 cost time: 1.8554534912109375
Epoch: 9, Steps: 12 | Train Loss: 0.609 Vali Loss: 0.850 Vali Acc: 0.761 Test Loss: 0.850 Test Acc: 0.761
Validation loss decreased (-0.711102 --> -0.761103).  Saving model ...
Epoch: 10 cost time: 1.76515531539917
Epoch: 10, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.699 Vali Acc: 0.800 Test Loss: 0.699 Test Acc: 0.800
Validation loss decreased (-0.761103 --> -0.799993).  Saving model ...
Epoch: 11 cost time: 1.8730871677398682
Epoch: 11, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.748 Vali Acc: 0.817 Test Loss: 0.748 Test Acc: 0.817
Validation loss decreased (-0.799993 --> -0.816659).  Saving model ...
Epoch: 12 cost time: 1.5644142627716064
Epoch: 12, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.648 Vali Acc: 0.850 Test Loss: 0.648 Test Acc: 0.850
Validation loss decreased (-0.816659 --> -0.849994).  Saving model ...
Epoch: 13 cost time: 1.888711929321289
Epoch: 13, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.717 Vali Acc: 0.817 Test Loss: 0.717 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7381319999694824
Epoch: 14, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.671 Vali Acc: 0.822 Test Loss: 0.671 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8674306869506836
Epoch: 15, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.738 Vali Acc: 0.806 Test Loss: 0.738 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9304263591766357
Epoch: 16, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.635 Vali Acc: 0.833 Test Loss: 0.635 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.738041877746582
Epoch: 17, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.581 Vali Acc: 0.839 Test Loss: 0.581 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.631584882736206
Epoch: 18, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.603 Vali Acc: 0.867 Test Loss: 0.603 Test Acc: 0.867
Validation loss decreased (-0.849994 --> -0.866661).  Saving model ...
Epoch: 19 cost time: 1.577939748764038
Epoch: 19, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.684 Vali Acc: 0.856 Test Loss: 0.684 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8464503288269043
Epoch: 20, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.619 Vali Acc: 0.844 Test Loss: 0.619 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.925232172012329
Epoch: 21, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.638 Vali Acc: 0.861 Test Loss: 0.638 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.8905797004699707
Epoch: 22, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.646 Vali Acc: 0.822 Test Loss: 0.646 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6319408416748047
Epoch: 23, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.742 Vali Acc: 0.839 Test Loss: 0.742 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.6082422733306885
Epoch: 24, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.611 Vali Acc: 0.861 Test Loss: 0.611 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.524024248123169
Epoch: 25, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.658 Vali Acc: 0.889 Test Loss: 0.658 Test Acc: 0.889
Validation loss decreased (-0.866661 --> -0.888882).  Saving model ...
Epoch: 26 cost time: 1.526310682296753
Epoch: 26, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.600 Vali Acc: 0.833 Test Loss: 0.600 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7239794731140137
Epoch: 27, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.605 Vali Acc: 0.850 Test Loss: 0.605 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.718904972076416
Epoch: 28, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.627 Vali Acc: 0.878 Test Loss: 0.627 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.5545094013214111
Epoch: 29, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.790 Vali Acc: 0.850 Test Loss: 0.790 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.807326316833496
Epoch: 30, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.665 Vali Acc: 0.839 Test Loss: 0.665 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.4831256866455078
Epoch: 31, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.698 Vali Acc: 0.867 Test Loss: 0.698 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.848613977432251
Epoch: 32, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.670 Vali Acc: 0.839 Test Loss: 0.670 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.9055233001708984
Epoch: 33, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.731 Vali Acc: 0.833 Test Loss: 0.731 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.8515710830688477
Epoch: 34, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.635 Vali Acc: 0.872 Test Loss: 0.635 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.8100433349609375
Epoch: 35, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.714 Vali Acc: 0.817 Test Loss: 0.714 Test Acc: 0.817
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 11096895
model size : 47.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.100666284561157
Epoch: 1, Steps: 12 | Train Loss: 2.782 Vali Loss: 2.554 Vali Acc: 0.222 Test Loss: 2.554 Test Acc: 0.222
Validation loss decreased (inf --> -0.222197).  Saving model ...
Epoch: 2 cost time: 1.5199580192565918
Epoch: 2, Steps: 12 | Train Loss: 2.470 Vali Loss: 2.188 Vali Acc: 0.417 Test Loss: 2.188 Test Acc: 0.417
Validation loss decreased (-0.222197 --> -0.416645).  Saving model ...
Epoch: 3 cost time: 1.585127592086792
Epoch: 3, Steps: 12 | Train Loss: 1.940 Vali Loss: 1.782 Vali Acc: 0.522 Test Loss: 1.782 Test Acc: 0.522
Validation loss decreased (-0.416645 --> -0.522204).  Saving model ...
Epoch: 4 cost time: 1.9043731689453125
Epoch: 4, Steps: 12 | Train Loss: 1.490 Vali Loss: 1.443 Vali Acc: 0.556 Test Loss: 1.443 Test Acc: 0.556
Validation loss decreased (-0.522204 --> -0.555541).  Saving model ...
Epoch: 5 cost time: 2.0574300289154053
Epoch: 5, Steps: 12 | Train Loss: 1.246 Vali Loss: 1.300 Vali Acc: 0.606 Test Loss: 1.300 Test Acc: 0.606
Validation loss decreased (-0.555541 --> -0.605543).  Saving model ...
Epoch: 6 cost time: 1.8802456855773926
Epoch: 6, Steps: 12 | Train Loss: 1.047 Vali Loss: 1.151 Vali Acc: 0.578 Test Loss: 1.151 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6491751670837402
Epoch: 7, Steps: 12 | Train Loss: 0.933 Vali Loss: 1.187 Vali Acc: 0.650 Test Loss: 1.187 Test Acc: 0.650
Validation loss decreased (-0.605543 --> -0.649988).  Saving model ...
Epoch: 8 cost time: 1.5796291828155518
Epoch: 8, Steps: 12 | Train Loss: 0.886 Vali Loss: 1.035 Vali Acc: 0.656 Test Loss: 1.035 Test Acc: 0.656
Validation loss decreased (-0.649988 --> -0.655545).  Saving model ...
Epoch: 9 cost time: 1.804163932800293
Epoch: 9, Steps: 12 | Train Loss: 0.674 Vali Loss: 0.798 Vali Acc: 0.750 Test Loss: 0.798 Test Acc: 0.750
Validation loss decreased (-0.655545 --> -0.749992).  Saving model ...
Epoch: 10 cost time: 1.764319658279419
Epoch: 10, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.777 Vali Acc: 0.767 Test Loss: 0.777 Test Acc: 0.767
Validation loss decreased (-0.749992 --> -0.766659).  Saving model ...
Epoch: 11 cost time: 1.9928972721099854
Epoch: 11, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.712 Vali Acc: 0.811 Test Loss: 0.712 Test Acc: 0.811
Validation loss decreased (-0.766659 --> -0.811104).  Saving model ...
Epoch: 12 cost time: 1.6983273029327393
Epoch: 12, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.637 Vali Acc: 0.817 Test Loss: 0.637 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816660).  Saving model ...
Epoch: 13 cost time: 1.6482443809509277
Epoch: 13, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.818 Vali Acc: 0.772 Test Loss: 0.818 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.831083059310913
Epoch: 14, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.596 Vali Acc: 0.839 Test Loss: 0.596 Test Acc: 0.839
Validation loss decreased (-0.816660 --> -0.838883).  Saving model ...
Epoch: 15 cost time: 1.6136500835418701
Epoch: 15, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.730 Vali Acc: 0.806 Test Loss: 0.730 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6581437587738037
Epoch: 16, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.675 Vali Acc: 0.861 Test Loss: 0.675 Test Acc: 0.861
Validation loss decreased (-0.838883 --> -0.861104).  Saving model ...
Epoch: 17 cost time: 1.793928623199463
Epoch: 17, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.544 Vali Acc: 0.833 Test Loss: 0.544 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7027654647827148
Epoch: 18, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.680 Vali Acc: 0.844 Test Loss: 0.680 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.810990333557129
Epoch: 19, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.605 Vali Acc: 0.817 Test Loss: 0.605 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.651578426361084
Epoch: 20, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.582 Vali Acc: 0.850 Test Loss: 0.582 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.8322696685791016
Epoch: 21, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.659 Vali Acc: 0.861 Test Loss: 0.659 Test Acc: 0.861
Validation loss decreased (-0.861104 --> -0.861105).  Saving model ...
Epoch: 22 cost time: 1.734792709350586
Epoch: 22, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.619 Vali Acc: 0.844 Test Loss: 0.619 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7272727489471436
Epoch: 23, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.646 Vali Acc: 0.867 Test Loss: 0.646 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866660).  Saving model ...
Epoch: 24 cost time: 1.54522705078125
Epoch: 24, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.677 Vali Acc: 0.850 Test Loss: 0.677 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5318834781646729
Epoch: 25, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.571 Vali Acc: 0.817 Test Loss: 0.571 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.5272409915924072
Epoch: 26, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.674 Vali Acc: 0.839 Test Loss: 0.674 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.639733076095581
Epoch: 27, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.638 Vali Acc: 0.878 Test Loss: 0.638 Test Acc: 0.878
Validation loss decreased (-0.866660 --> -0.877771).  Saving model ...
Epoch: 28 cost time: 1.6494970321655273
Epoch: 28, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.663 Vali Acc: 0.867 Test Loss: 0.663 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.9693796634674072
Epoch: 29, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.711 Vali Acc: 0.856 Test Loss: 0.711 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4281001091003418
Epoch: 30, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.675 Vali Acc: 0.861 Test Loss: 0.675 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.636542797088623
Epoch: 31, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.670 Vali Acc: 0.839 Test Loss: 0.670 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.6437194347381592
Epoch: 32, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.673 Vali Acc: 0.861 Test Loss: 0.673 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.8420796394348145
Epoch: 33, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.628 Vali Acc: 0.883 Test Loss: 0.628 Test Acc: 0.883
Validation loss decreased (-0.877771 --> -0.883327).  Saving model ...
Epoch: 34 cost time: 1.848543405532837
Epoch: 34, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.806 Vali Acc: 0.850 Test Loss: 0.806 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.775768518447876
Epoch: 35, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.771 Vali Acc: 0.833 Test Loss: 0.771 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.4709668159484863
Epoch: 36, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.846 Vali Acc: 0.822 Test Loss: 0.846 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.0847277641296387
Epoch: 37, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.580 Vali Acc: 0.867 Test Loss: 0.580 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.5238673686981201
Epoch: 38, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.854 Vali Acc: 0.800 Test Loss: 0.854 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.9478034973144531
Epoch: 39, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.755 Vali Acc: 0.817 Test Loss: 0.755 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.6329286098480225
Epoch: 40, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.649 Vali Acc: 0.822 Test Loss: 0.649 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.844034194946289
Epoch: 41, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.670 Vali Acc: 0.811 Test Loss: 0.670 Test Acc: 0.811
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.7746608257293701
Epoch: 42, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.768 Vali Acc: 0.817 Test Loss: 0.768 Test Acc: 0.817
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.7576911449432373
Epoch: 43, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.669 Vali Acc: 0.811 Test Loss: 0.669 Test Acc: 0.811
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 9263679
model size : 40.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8428139686584473
Epoch: 1, Steps: 12 | Train Loss: 2.763 Vali Loss: 2.493 Vali Acc: 0.256 Test Loss: 2.493 Test Acc: 0.256
Validation loss decreased (inf --> -0.255531).  Saving model ...
Epoch: 2 cost time: 2.041980504989624
Epoch: 2, Steps: 12 | Train Loss: 2.414 Vali Loss: 2.116 Vali Acc: 0.383 Test Loss: 2.116 Test Acc: 0.383
Validation loss decreased (-0.255531 --> -0.383312).  Saving model ...
Epoch: 3 cost time: 2.306441068649292
Epoch: 3, Steps: 12 | Train Loss: 1.952 Vali Loss: 1.676 Vali Acc: 0.528 Test Loss: 1.676 Test Acc: 0.528
Validation loss decreased (-0.383312 --> -0.527761).  Saving model ...
Epoch: 4 cost time: 1.7464141845703125
Epoch: 4, Steps: 12 | Train Loss: 1.579 Vali Loss: 1.486 Vali Acc: 0.544 Test Loss: 1.486 Test Acc: 0.544
Validation loss decreased (-0.527761 --> -0.544430).  Saving model ...
Epoch: 5 cost time: 1.854029655456543
Epoch: 5, Steps: 12 | Train Loss: 1.175 Vali Loss: 1.329 Vali Acc: 0.622 Test Loss: 1.329 Test Acc: 0.622
Validation loss decreased (-0.544430 --> -0.622209).  Saving model ...
Epoch: 6 cost time: 1.7789227962493896
Epoch: 6, Steps: 12 | Train Loss: 1.069 Vali Loss: 1.249 Vali Acc: 0.611 Test Loss: 1.249 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8528249263763428
Epoch: 7, Steps: 12 | Train Loss: 0.920 Vali Loss: 1.012 Vali Acc: 0.694 Test Loss: 1.012 Test Acc: 0.694
Validation loss decreased (-0.622209 --> -0.694434).  Saving model ...
Epoch: 8 cost time: 1.9527027606964111
Epoch: 8, Steps: 12 | Train Loss: 0.824 Vali Loss: 0.990 Vali Acc: 0.661 Test Loss: 0.990 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.941232442855835
Epoch: 9, Steps: 12 | Train Loss: 0.620 Vali Loss: 0.913 Vali Acc: 0.683 Test Loss: 0.913 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.112574338912964
Epoch: 10, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.742 Vali Acc: 0.789 Test Loss: 0.742 Test Acc: 0.789
Validation loss decreased (-0.694434 --> -0.788881).  Saving model ...
Epoch: 11 cost time: 1.724583387374878
Epoch: 11, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.784 Vali Acc: 0.750 Test Loss: 0.784 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.705237627029419
Epoch: 12, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.689 Vali Acc: 0.800 Test Loss: 0.689 Test Acc: 0.800
Validation loss decreased (-0.788881 --> -0.799993).  Saving model ...
Epoch: 13 cost time: 1.7103362083435059
Epoch: 13, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.823 Vali Acc: 0.794 Test Loss: 0.823 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0701351165771484
Epoch: 14, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.741 Vali Acc: 0.794 Test Loss: 0.741 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8131177425384521
Epoch: 15, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.721 Vali Acc: 0.811 Test Loss: 0.721 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811104).  Saving model ...
Epoch: 16 cost time: 1.8037919998168945
Epoch: 16, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.811 Vali Acc: 0.767 Test Loss: 0.811 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9812390804290771
Epoch: 17, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.635 Vali Acc: 0.861 Test Loss: 0.635 Test Acc: 0.861
Validation loss decreased (-0.811104 --> -0.861105).  Saving model ...
Epoch: 18 cost time: 2.2921950817108154
Epoch: 18, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.587 Vali Acc: 0.861 Test Loss: 0.587 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 19 cost time: 2.012993097305298
Epoch: 19, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.711 Vali Acc: 0.817 Test Loss: 0.711 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8535101413726807
Epoch: 20, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.699 Vali Acc: 0.817 Test Loss: 0.699 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.0268747806549072
Epoch: 21, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.707 Vali Acc: 0.794 Test Loss: 0.707 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.703660488128662
Epoch: 22, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.639 Vali Acc: 0.822 Test Loss: 0.639 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.9465699195861816
Epoch: 23, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.711 Vali Acc: 0.806 Test Loss: 0.711 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.1370341777801514
Epoch: 24, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.773 Vali Acc: 0.828 Test Loss: 0.773 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.163536548614502
Epoch: 25, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.666 Vali Acc: 0.867 Test Loss: 0.666 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866660).  Saving model ...
Epoch: 26 cost time: 1.817202091217041
Epoch: 26, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.548 Vali Acc: 0.861 Test Loss: 0.548 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.9112498760223389
Epoch: 27, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.713 Vali Acc: 0.839 Test Loss: 0.713 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8523390293121338
Epoch: 28, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.591 Vali Acc: 0.861 Test Loss: 0.591 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.248577833175659
Epoch: 29, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.619 Vali Acc: 0.867 Test Loss: 0.619 Test Acc: 0.867
Validation loss decreased (-0.866660 --> -0.866660).  Saving model ...
Epoch: 30 cost time: 1.9625725746154785
Epoch: 30, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.705 Vali Acc: 0.861 Test Loss: 0.705 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.010298252105713
Epoch: 31, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.587 Vali Acc: 0.894 Test Loss: 0.587 Test Acc: 0.894
Validation loss decreased (-0.866660 --> -0.894439).  Saving model ...
Epoch: 32 cost time: 1.9531841278076172
Epoch: 32, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.723 Vali Acc: 0.878 Test Loss: 0.723 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.2472305297851562
Epoch: 33, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.712 Vali Acc: 0.883 Test Loss: 0.712 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.9914026260375977
Epoch: 34, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.663 Vali Acc: 0.878 Test Loss: 0.663 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.8867566585540771
Epoch: 35, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.611 Vali Acc: 0.872 Test Loss: 0.611 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.8024687767028809
Epoch: 36, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.668 Vali Acc: 0.883 Test Loss: 0.668 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.9742491245269775
Epoch: 37, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.651 Vali Acc: 0.889 Test Loss: 0.651 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.8666884899139404
Epoch: 38, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.713 Vali Acc: 0.883 Test Loss: 0.713 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.9156935214996338
Epoch: 39, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.721 Vali Acc: 0.883 Test Loss: 0.721 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.9904837608337402
Epoch: 40, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.726 Vali Acc: 0.883 Test Loss: 0.726 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.1421279907226562
Epoch: 41, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.716 Vali Acc: 0.883 Test Loss: 0.716 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 9261887
model size : 40.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.345248460769653
Epoch: 1, Steps: 12 | Train Loss: 2.903 Vali Loss: 2.648 Vali Acc: 0.139 Test Loss: 2.648 Test Acc: 0.139
Validation loss decreased (inf --> -0.138862).  Saving model ...
Epoch: 2 cost time: 1.456427812576294
Epoch: 2, Steps: 12 | Train Loss: 2.535 Vali Loss: 2.263 Vali Acc: 0.417 Test Loss: 2.263 Test Acc: 0.417
Validation loss decreased (-0.138862 --> -0.416644).  Saving model ...
Epoch: 3 cost time: 1.617372751235962
Epoch: 3, Steps: 12 | Train Loss: 2.146 Vali Loss: 1.838 Vali Acc: 0.517 Test Loss: 1.838 Test Acc: 0.517
Validation loss decreased (-0.416644 --> -0.516648).  Saving model ...
Epoch: 4 cost time: 1.9493293762207031
Epoch: 4, Steps: 12 | Train Loss: 1.568 Vali Loss: 1.535 Vali Acc: 0.572 Test Loss: 1.535 Test Acc: 0.572
Validation loss decreased (-0.516648 --> -0.572207).  Saving model ...
Epoch: 5 cost time: 1.7999815940856934
Epoch: 5, Steps: 12 | Train Loss: 1.341 Vali Loss: 1.261 Vali Acc: 0.583 Test Loss: 1.261 Test Acc: 0.583
Validation loss decreased (-0.572207 --> -0.583321).  Saving model ...
Epoch: 6 cost time: 2.1414003372192383
Epoch: 6, Steps: 12 | Train Loss: 1.045 Vali Loss: 1.190 Vali Acc: 0.639 Test Loss: 1.190 Test Acc: 0.639
Validation loss decreased (-0.583321 --> -0.638877).  Saving model ...
Epoch: 7 cost time: 1.709075689315796
Epoch: 7, Steps: 12 | Train Loss: 0.858 Vali Loss: 1.011 Vali Acc: 0.711 Test Loss: 1.011 Test Acc: 0.711
Validation loss decreased (-0.638877 --> -0.711101).  Saving model ...
Epoch: 8 cost time: 1.5306298732757568
Epoch: 8, Steps: 12 | Train Loss: 0.728 Vali Loss: 0.919 Vali Acc: 0.694 Test Loss: 0.919 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9568371772766113
Epoch: 9, Steps: 12 | Train Loss: 0.617 Vali Loss: 0.838 Vali Acc: 0.761 Test Loss: 0.838 Test Acc: 0.761
Validation loss decreased (-0.711101 --> -0.761103).  Saving model ...
Epoch: 10 cost time: 1.9173603057861328
Epoch: 10, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.814 Vali Acc: 0.767 Test Loss: 0.814 Test Acc: 0.767
Validation loss decreased (-0.761103 --> -0.766659).  Saving model ...
Epoch: 11 cost time: 1.8266890048980713
Epoch: 11, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.752 Vali Acc: 0.811 Test Loss: 0.752 Test Acc: 0.811
Validation loss decreased (-0.766659 --> -0.811104).  Saving model ...
Epoch: 12 cost time: 1.8815538883209229
Epoch: 12, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.713 Vali Acc: 0.783 Test Loss: 0.713 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9378480911254883
Epoch: 13, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.759 Vali Acc: 0.817 Test Loss: 0.759 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816659).  Saving model ...
Epoch: 14 cost time: 1.9046814441680908
Epoch: 14, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.745 Vali Acc: 0.828 Test Loss: 0.745 Test Acc: 0.828
Validation loss decreased (-0.816659 --> -0.827770).  Saving model ...
Epoch: 15 cost time: 1.9668009281158447
Epoch: 15, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.536 Vali Acc: 0.844 Test Loss: 0.536 Test Acc: 0.844
Validation loss decreased (-0.827770 --> -0.844439).  Saving model ...
Epoch: 16 cost time: 1.7371163368225098
Epoch: 16, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.620 Vali Acc: 0.844 Test Loss: 0.620 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.157205104827881
Epoch: 17, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.718 Vali Acc: 0.811 Test Loss: 0.718 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7582440376281738
Epoch: 18, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.813 Vali Acc: 0.806 Test Loss: 0.813 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7335596084594727
Epoch: 19, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.670 Vali Acc: 0.822 Test Loss: 0.670 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.713402509689331
Epoch: 20, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.761 Vali Acc: 0.833 Test Loss: 0.761 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.194845199584961
Epoch: 21, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.561 Vali Acc: 0.844 Test Loss: 0.561 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.110645294189453
Epoch: 22, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.622 Vali Acc: 0.850 Test Loss: 0.622 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849994).  Saving model ...
Epoch: 23 cost time: 1.797180414199829
Epoch: 23, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.633 Vali Acc: 0.850 Test Loss: 0.633 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.423201084136963
Epoch: 24, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.628 Vali Acc: 0.867 Test Loss: 0.628 Test Acc: 0.867
Validation loss decreased (-0.849994 --> -0.866660).  Saving model ...
Epoch: 25 cost time: 1.8619916439056396
Epoch: 25, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.645 Vali Acc: 0.867 Test Loss: 0.645 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8185434341430664
Epoch: 26, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.665 Vali Acc: 0.861 Test Loss: 0.665 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.6690077781677246
Epoch: 27, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.658 Vali Acc: 0.850 Test Loss: 0.658 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.732192039489746
Epoch: 28, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.666 Vali Acc: 0.861 Test Loss: 0.666 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.9042596817016602
Epoch: 29, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.670 Vali Acc: 0.867 Test Loss: 0.670 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.5951898097991943
Epoch: 30, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.679 Vali Acc: 0.867 Test Loss: 0.679 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.7079648971557617
Epoch: 31, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.673 Vali Acc: 0.867 Test Loss: 0.673 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.6244227886199951
Epoch: 32, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.680 Vali Acc: 0.867 Test Loss: 0.680 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.653137445449829
Epoch: 33, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.693 Vali Acc: 0.867 Test Loss: 0.693 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.870934247970581
Epoch: 34, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.691 Vali Acc: 0.867 Test Loss: 0.691 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 9260095
model size : 40.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9094669818878174
Epoch: 1, Steps: 12 | Train Loss: 2.915 Vali Loss: 2.580 Vali Acc: 0.161 Test Loss: 2.580 Test Acc: 0.161
Validation loss decreased (inf --> -0.161085).  Saving model ...
Epoch: 2 cost time: 2.1168406009674072
Epoch: 2, Steps: 12 | Train Loss: 2.466 Vali Loss: 2.270 Vali Acc: 0.433 Test Loss: 2.270 Test Acc: 0.433
Validation loss decreased (-0.161085 --> -0.433311).  Saving model ...
Epoch: 3 cost time: 1.5541813373565674
Epoch: 3, Steps: 12 | Train Loss: 2.110 Vali Loss: 1.838 Vali Acc: 0.511 Test Loss: 1.838 Test Acc: 0.511
Validation loss decreased (-0.433311 --> -0.511093).  Saving model ...
Epoch: 4 cost time: 1.6383435726165771
Epoch: 4, Steps: 12 | Train Loss: 1.640 Vali Loss: 1.556 Vali Acc: 0.556 Test Loss: 1.556 Test Acc: 0.556
Validation loss decreased (-0.511093 --> -0.555540).  Saving model ...
Epoch: 5 cost time: 1.6915831565856934
Epoch: 5, Steps: 12 | Train Loss: 1.333 Vali Loss: 1.346 Vali Acc: 0.578 Test Loss: 1.346 Test Acc: 0.578
Validation loss decreased (-0.555540 --> -0.577764).  Saving model ...
Epoch: 6 cost time: 1.7447295188903809
Epoch: 6, Steps: 12 | Train Loss: 1.043 Vali Loss: 1.150 Vali Acc: 0.672 Test Loss: 1.150 Test Acc: 0.672
Validation loss decreased (-0.577764 --> -0.672211).  Saving model ...
Epoch: 7 cost time: 1.9692473411560059
Epoch: 7, Steps: 12 | Train Loss: 0.906 Vali Loss: 1.049 Vali Acc: 0.700 Test Loss: 1.049 Test Acc: 0.700
Validation loss decreased (-0.672211 --> -0.699990).  Saving model ...
Epoch: 8 cost time: 1.6909701824188232
Epoch: 8, Steps: 12 | Train Loss: 0.708 Vali Loss: 0.907 Vali Acc: 0.722 Test Loss: 0.907 Test Acc: 0.722
Validation loss decreased (-0.699990 --> -0.722213).  Saving model ...
Epoch: 9 cost time: 1.5544242858886719
Epoch: 9, Steps: 12 | Train Loss: 0.609 Vali Loss: 0.834 Vali Acc: 0.778 Test Loss: 0.834 Test Acc: 0.778
Validation loss decreased (-0.722213 --> -0.777769).  Saving model ...
Epoch: 10 cost time: 1.7046353816986084
Epoch: 10, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.717 Vali Acc: 0.789 Test Loss: 0.717 Test Acc: 0.789
Validation loss decreased (-0.777769 --> -0.788882).  Saving model ...
Epoch: 11 cost time: 1.7365810871124268
Epoch: 11, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.704 Vali Acc: 0.750 Test Loss: 0.704 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7620916366577148
Epoch: 12, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.725 Vali Acc: 0.806 Test Loss: 0.725 Test Acc: 0.806
Validation loss decreased (-0.788882 --> -0.805548).  Saving model ...
Epoch: 13 cost time: 1.7010798454284668
Epoch: 13, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.732 Vali Acc: 0.811 Test Loss: 0.732 Test Acc: 0.811
Validation loss decreased (-0.805548 --> -0.811104).  Saving model ...
Epoch: 14 cost time: 1.7706804275512695
Epoch: 14, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.776 Vali Acc: 0.767 Test Loss: 0.776 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9632599353790283
Epoch: 15, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.733 Vali Acc: 0.778 Test Loss: 0.733 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6019136905670166
Epoch: 16, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.632 Vali Acc: 0.839 Test Loss: 0.632 Test Acc: 0.839
Validation loss decreased (-0.811104 --> -0.838883).  Saving model ...
Epoch: 17 cost time: 1.8800301551818848
Epoch: 17, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.586 Vali Acc: 0.844 Test Loss: 0.586 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 18 cost time: 1.7885336875915527
Epoch: 18, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.613 Vali Acc: 0.850 Test Loss: 0.613 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849994).  Saving model ...
Epoch: 19 cost time: 1.8354692459106445
Epoch: 19, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.592 Vali Acc: 0.850 Test Loss: 0.592 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 20 cost time: 1.710461139678955
Epoch: 20, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.566 Vali Acc: 0.850 Test Loss: 0.566 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 21 cost time: 1.741511583328247
Epoch: 21, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.631 Vali Acc: 0.833 Test Loss: 0.631 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8683044910430908
Epoch: 22, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.604 Vali Acc: 0.850 Test Loss: 0.604 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8798723220825195
Epoch: 23, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.687 Vali Acc: 0.856 Test Loss: 0.687 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 24 cost time: 1.743757724761963
Epoch: 24, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.617 Vali Acc: 0.844 Test Loss: 0.617 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9580488204956055
Epoch: 25, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.646 Vali Acc: 0.856 Test Loss: 0.646 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855549).  Saving model ...
Epoch: 26 cost time: 1.5669474601745605
Epoch: 26, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.711 Vali Acc: 0.867 Test Loss: 0.711 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866660).  Saving model ...
Epoch: 27 cost time: 1.5334579944610596
Epoch: 27, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.686 Vali Acc: 0.867 Test Loss: 0.686 Test Acc: 0.867
Validation loss decreased (-0.866660 --> -0.866660).  Saving model ...
Epoch: 28 cost time: 1.4466524124145508
Epoch: 28, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.625 Vali Acc: 0.872 Test Loss: 0.625 Test Acc: 0.872
Validation loss decreased (-0.866660 --> -0.872216).  Saving model ...
Epoch: 29 cost time: 1.977001428604126
Epoch: 29, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.606 Vali Acc: 0.867 Test Loss: 0.606 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7715544700622559
Epoch: 30, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.632 Vali Acc: 0.872 Test Loss: 0.632 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.7462739944458008
Epoch: 31, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.656 Vali Acc: 0.872 Test Loss: 0.656 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.6445906162261963
Epoch: 32, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.663 Vali Acc: 0.872 Test Loss: 0.663 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.597874641418457
Epoch: 33, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.655 Vali Acc: 0.872 Test Loss: 0.655 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.586106777191162
Epoch: 34, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.665 Vali Acc: 0.872 Test Loss: 0.665 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.7227303981781006
Epoch: 35, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.669 Vali Acc: 0.872 Test Loss: 0.669 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.583155632019043
Epoch: 36, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.676 Vali Acc: 0.872 Test Loss: 0.676 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.7817823886871338
Epoch: 37, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.676 Vali Acc: 0.878 Test Loss: 0.676 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877771).  Saving model ...
Epoch: 38 cost time: 1.5845584869384766
Epoch: 38, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.676 Vali Acc: 0.878 Test Loss: 0.676 Test Acc: 0.878
Validation loss decreased (-0.877771 --> -0.877771).  Saving model ...
Epoch: 39 cost time: 1.5910427570343018
Epoch: 39, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.673 Vali Acc: 0.878 Test Loss: 0.673 Test Acc: 0.878
Validation loss decreased (-0.877771 --> -0.877771).  Saving model ...
Epoch: 40 cost time: 1.805147409439087
Epoch: 40, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.675 Vali Acc: 0.878 Test Loss: 0.675 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.7272069454193115
Epoch: 41, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.682 Vali Acc: 0.878 Test Loss: 0.682 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.7779254913330078
Epoch: 42, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.697 Vali Acc: 0.883 Test Loss: 0.697 Test Acc: 0.883
Validation loss decreased (-0.877771 --> -0.883326).  Saving model ...
Epoch: 43 cost time: 1.7968666553497314
Epoch: 43, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.703 Vali Acc: 0.883 Test Loss: 0.703 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.7023489475250244
Epoch: 44, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.701 Vali Acc: 0.878 Test Loss: 0.701 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.7171235084533691
Epoch: 45, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.703 Vali Acc: 0.878 Test Loss: 0.703 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.6113324165344238
Epoch: 46, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.708 Vali Acc: 0.878 Test Loss: 0.708 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.8295996189117432
Epoch: 47, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.709 Vali Acc: 0.878 Test Loss: 0.709 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.9688799381256104
Epoch: 48, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.711 Vali Acc: 0.878 Test Loss: 0.711 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.612196922302246
Epoch: 49, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.711 Vali Acc: 0.878 Test Loss: 0.711 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.4072976112365723
Epoch: 50, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.705 Vali Acc: 0.878 Test Loss: 0.705 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.8238062858581543
Epoch: 51, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.705 Vali Acc: 0.883 Test Loss: 0.705 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.6948928833007812
Epoch: 52, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.710 Vali Acc: 0.883 Test Loss: 0.710 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 9258303
model size : 40.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.360562801361084
Epoch: 1, Steps: 12 | Train Loss: 2.772 Vali Loss: 2.549 Vali Acc: 0.250 Test Loss: 2.549 Test Acc: 0.250
Validation loss decreased (inf --> -0.249975).  Saving model ...
Epoch: 2 cost time: 1.9361846446990967
Epoch: 2, Steps: 12 | Train Loss: 2.518 Vali Loss: 2.227 Vali Acc: 0.456 Test Loss: 2.227 Test Acc: 0.456
Validation loss decreased (-0.249975 --> -0.455533).  Saving model ...
Epoch: 3 cost time: 2.1523165702819824
Epoch: 3, Steps: 12 | Train Loss: 2.027 Vali Loss: 1.812 Vali Acc: 0.500 Test Loss: 1.812 Test Acc: 0.500
Validation loss decreased (-0.455533 --> -0.499982).  Saving model ...
Epoch: 4 cost time: 1.8071718215942383
Epoch: 4, Steps: 12 | Train Loss: 1.650 Vali Loss: 1.602 Vali Acc: 0.511 Test Loss: 1.602 Test Acc: 0.511
Validation loss decreased (-0.499982 --> -0.511095).  Saving model ...
Epoch: 5 cost time: 1.753223180770874
Epoch: 5, Steps: 12 | Train Loss: 1.362 Vali Loss: 1.373 Vali Acc: 0.572 Test Loss: 1.373 Test Acc: 0.572
Validation loss decreased (-0.511095 --> -0.572208).  Saving model ...
Epoch: 6 cost time: 2.0543267726898193
Epoch: 6, Steps: 12 | Train Loss: 1.081 Vali Loss: 1.194 Vali Acc: 0.644 Test Loss: 1.194 Test Acc: 0.644
Validation loss decreased (-0.572208 --> -0.644433).  Saving model ...
Epoch: 7 cost time: 2.0557544231414795
Epoch: 7, Steps: 12 | Train Loss: 1.003 Vali Loss: 1.028 Vali Acc: 0.667 Test Loss: 1.028 Test Acc: 0.667
Validation loss decreased (-0.644433 --> -0.666656).  Saving model ...
Epoch: 8 cost time: 2.1901345252990723
Epoch: 8, Steps: 12 | Train Loss: 0.805 Vali Loss: 0.943 Vali Acc: 0.694 Test Loss: 0.943 Test Acc: 0.694
Validation loss decreased (-0.666656 --> -0.694435).  Saving model ...
Epoch: 9 cost time: 1.9856395721435547
Epoch: 9, Steps: 12 | Train Loss: 0.665 Vali Loss: 0.890 Vali Acc: 0.706 Test Loss: 0.890 Test Acc: 0.706
Validation loss decreased (-0.694435 --> -0.705547).  Saving model ...
Epoch: 10 cost time: 2.02500319480896
Epoch: 10, Steps: 12 | Train Loss: 0.545 Vali Loss: 0.831 Vali Acc: 0.750 Test Loss: 0.831 Test Acc: 0.750
Validation loss decreased (-0.705547 --> -0.749992).  Saving model ...
Epoch: 11 cost time: 2.0670084953308105
Epoch: 11, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.722 Vali Acc: 0.794 Test Loss: 0.722 Test Acc: 0.794
Validation loss decreased (-0.749992 --> -0.794437).  Saving model ...
Epoch: 12 cost time: 1.626211166381836
Epoch: 12, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.613 Vali Acc: 0.856 Test Loss: 0.613 Test Acc: 0.856
Validation loss decreased (-0.794437 --> -0.855549).  Saving model ...
Epoch: 13 cost time: 2.073867082595825
Epoch: 13, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.800 Vali Acc: 0.778 Test Loss: 0.800 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.238898992538452
Epoch: 14, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.539 Vali Acc: 0.844 Test Loss: 0.539 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7906262874603271
Epoch: 15, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.551 Vali Acc: 0.861 Test Loss: 0.551 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861106).  Saving model ...
Epoch: 16 cost time: 2.284693479537964
Epoch: 16, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.540 Vali Acc: 0.839 Test Loss: 0.540 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.890183448791504
Epoch: 17, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.669 Vali Acc: 0.789 Test Loss: 0.669 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8526108264923096
Epoch: 18, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.607 Vali Acc: 0.828 Test Loss: 0.607 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.893362283706665
Epoch: 19, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.562 Vali Acc: 0.850 Test Loss: 0.562 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.7801454067230225
Epoch: 20, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.505 Vali Acc: 0.872 Test Loss: 0.505 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 21 cost time: 2.0113041400909424
Epoch: 21, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.560 Vali Acc: 0.850 Test Loss: 0.560 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9146158695220947
Epoch: 22, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.703 Vali Acc: 0.850 Test Loss: 0.703 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.32515549659729
Epoch: 23, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.719 Vali Acc: 0.839 Test Loss: 0.719 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.9589674472808838
Epoch: 24, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.629 Vali Acc: 0.856 Test Loss: 0.629 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.9054765701293945
Epoch: 25, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.680 Vali Acc: 0.844 Test Loss: 0.680 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.9428324699401855
Epoch: 26, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.571 Vali Acc: 0.867 Test Loss: 0.571 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.9222564697265625
Epoch: 27, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.576 Vali Acc: 0.872 Test Loss: 0.576 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.7355313301086426
Epoch: 28, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.650 Vali Acc: 0.883 Test Loss: 0.650 Test Acc: 0.883
Validation loss decreased (-0.872217 --> -0.883327).  Saving model ...
Epoch: 29 cost time: 2.2598989009857178
Epoch: 29, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.708 Vali Acc: 0.850 Test Loss: 0.708 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.3527884483337402
Epoch: 30, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.716 Vali Acc: 0.822 Test Loss: 0.716 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.1904051303863525
Epoch: 31, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.724 Vali Acc: 0.861 Test Loss: 0.724 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.016268491744995
Epoch: 32, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.616 Vali Acc: 0.828 Test Loss: 0.616 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.999131441116333
Epoch: 33, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.621 Vali Acc: 0.856 Test Loss: 0.621 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.205862283706665
Epoch: 34, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.622 Vali Acc: 0.839 Test Loss: 0.622 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.0408427715301514
Epoch: 35, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.702 Vali Acc: 0.850 Test Loss: 0.702 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.9777557849884033
Epoch: 36, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.741 Vali Acc: 0.839 Test Loss: 0.741 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.7246754169464111
Epoch: 37, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.672 Vali Acc: 0.878 Test Loss: 0.672 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.9505276679992676
Epoch: 38, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.704 Vali Acc: 0.872 Test Loss: 0.704 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 8344383
model size : 36.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5959274768829346
Epoch: 1, Steps: 12 | Train Loss: 2.828 Vali Loss: 2.619 Vali Acc: 0.200 Test Loss: 2.619 Test Acc: 0.200
Validation loss decreased (inf --> -0.199974).  Saving model ...
Epoch: 2 cost time: 1.6187500953674316
Epoch: 2, Steps: 12 | Train Loss: 2.515 Vali Loss: 2.306 Vali Acc: 0.400 Test Loss: 2.306 Test Acc: 0.400
Validation loss decreased (-0.199974 --> -0.399977).  Saving model ...
Epoch: 3 cost time: 1.7936155796051025
Epoch: 3, Steps: 12 | Train Loss: 2.153 Vali Loss: 1.939 Vali Acc: 0.450 Test Loss: 1.939 Test Acc: 0.450
Validation loss decreased (-0.399977 --> -0.449981).  Saving model ...
Epoch: 4 cost time: 1.9983856678009033
Epoch: 4, Steps: 12 | Train Loss: 1.726 Vali Loss: 1.598 Vali Acc: 0.556 Test Loss: 1.598 Test Acc: 0.556
Validation loss decreased (-0.449981 --> -0.555540).  Saving model ...
Epoch: 5 cost time: 1.6526708602905273
Epoch: 5, Steps: 12 | Train Loss: 1.325 Vali Loss: 1.310 Vali Acc: 0.594 Test Loss: 1.310 Test Acc: 0.594
Validation loss decreased (-0.555540 --> -0.594431).  Saving model ...
Epoch: 6 cost time: 1.6515026092529297
Epoch: 6, Steps: 12 | Train Loss: 1.109 Vali Loss: 1.184 Vali Acc: 0.644 Test Loss: 1.184 Test Acc: 0.644
Validation loss decreased (-0.594431 --> -0.644433).  Saving model ...
Epoch: 7 cost time: 1.654740333557129
Epoch: 7, Steps: 12 | Train Loss: 0.846 Vali Loss: 0.995 Vali Acc: 0.733 Test Loss: 0.995 Test Acc: 0.733
Validation loss decreased (-0.644433 --> -0.733323).  Saving model ...
Epoch: 8 cost time: 1.8447833061218262
Epoch: 8, Steps: 12 | Train Loss: 0.724 Vali Loss: 0.938 Vali Acc: 0.722 Test Loss: 0.938 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.893747329711914
Epoch: 9, Steps: 12 | Train Loss: 0.664 Vali Loss: 0.887 Vali Acc: 0.756 Test Loss: 0.887 Test Acc: 0.756
Validation loss decreased (-0.733323 --> -0.755547).  Saving model ...
Epoch: 10 cost time: 1.582839012145996
Epoch: 10, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.786 Vali Acc: 0.789 Test Loss: 0.786 Test Acc: 0.789
Validation loss decreased (-0.755547 --> -0.788881).  Saving model ...
Epoch: 11 cost time: 1.8707373142242432
Epoch: 11, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.698 Vali Acc: 0.772 Test Loss: 0.698 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.699012279510498
Epoch: 12, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.748 Vali Acc: 0.794 Test Loss: 0.748 Test Acc: 0.794
Validation loss decreased (-0.788881 --> -0.794437).  Saving model ...
Epoch: 13 cost time: 1.7339332103729248
Epoch: 13, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.610 Vali Acc: 0.817 Test Loss: 0.610 Test Acc: 0.817
Validation loss decreased (-0.794437 --> -0.816661).  Saving model ...
Epoch: 14 cost time: 2.0407705307006836
Epoch: 14, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.682 Vali Acc: 0.817 Test Loss: 0.682 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7798092365264893
Epoch: 15, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.698 Vali Acc: 0.828 Test Loss: 0.698 Test Acc: 0.828
Validation loss decreased (-0.816661 --> -0.827771).  Saving model ...
Epoch: 16 cost time: 1.6017661094665527
Epoch: 16, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.510 Vali Acc: 0.867 Test Loss: 0.510 Test Acc: 0.867
Validation loss decreased (-0.827771 --> -0.866662).  Saving model ...
Epoch: 17 cost time: 1.978325605392456
Epoch: 17, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.540 Vali Acc: 0.861 Test Loss: 0.540 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.813093662261963
Epoch: 18, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.516 Vali Acc: 0.861 Test Loss: 0.516 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.753291130065918
Epoch: 19, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.527 Vali Acc: 0.856 Test Loss: 0.527 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7273240089416504
Epoch: 20, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.625 Vali Acc: 0.850 Test Loss: 0.625 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.662806749343872
Epoch: 21, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.501 Vali Acc: 0.856 Test Loss: 0.501 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.9273936748504639
Epoch: 22, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.703 Vali Acc: 0.833 Test Loss: 0.703 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.945511817932129
Epoch: 23, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.611 Vali Acc: 0.878 Test Loss: 0.611 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877772).  Saving model ...
Epoch: 24 cost time: 2.3538401126861572
Epoch: 24, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.484 Vali Acc: 0.878 Test Loss: 0.484 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877773).  Saving model ...
Epoch: 25 cost time: 1.7194950580596924
Epoch: 25, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.537 Vali Acc: 0.883 Test Loss: 0.537 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883328).  Saving model ...
Epoch: 26 cost time: 1.6097471714019775
Epoch: 26, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.537 Vali Acc: 0.883 Test Loss: 0.537 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883328).  Saving model ...
Epoch: 27 cost time: 1.9152357578277588
Epoch: 27, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.573 Vali Acc: 0.872 Test Loss: 0.573 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.0056142807006836
Epoch: 28, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.593 Vali Acc: 0.872 Test Loss: 0.593 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.925419807434082
Epoch: 29, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.588 Vali Acc: 0.889 Test Loss: 0.588 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888883).  Saving model ...
Epoch: 30 cost time: 1.6380090713500977
Epoch: 30, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.602 Vali Acc: 0.889 Test Loss: 0.602 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.6294670104980469
Epoch: 31, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.607 Vali Acc: 0.889 Test Loss: 0.607 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.895864725112915
Epoch: 32, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.606 Vali Acc: 0.889 Test Loss: 0.606 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.5397591590881348
Epoch: 33, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.601 Vali Acc: 0.883 Test Loss: 0.601 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.0218441486358643
Epoch: 34, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.604 Vali Acc: 0.883 Test Loss: 0.604 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.7194123268127441
Epoch: 35, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.609 Vali Acc: 0.883 Test Loss: 0.609 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.8323729038238525
Epoch: 36, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.619 Vali Acc: 0.889 Test Loss: 0.619 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.8211314678192139
Epoch: 37, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.627 Vali Acc: 0.900 Test Loss: 0.627 Test Acc: 0.900
Validation loss decreased (-0.888883 --> -0.899994).  Saving model ...
Epoch: 38 cost time: 2.08198618888855
Epoch: 38, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.633 Vali Acc: 0.894 Test Loss: 0.633 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.5347154140472412
Epoch: 39, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.641 Vali Acc: 0.894 Test Loss: 0.641 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.8766701221466064
Epoch: 40, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.641 Vali Acc: 0.889 Test Loss: 0.641 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.8115718364715576
Epoch: 41, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.650 Vali Acc: 0.889 Test Loss: 0.650 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.6051809787750244
Epoch: 42, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.651 Vali Acc: 0.894 Test Loss: 0.651 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 2.028167963027954
Epoch: 43, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.657 Vali Acc: 0.889 Test Loss: 0.657 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.9272222518920898
Epoch: 44, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.664 Vali Acc: 0.889 Test Loss: 0.664 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.8591969013214111
Epoch: 45, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.661 Vali Acc: 0.894 Test Loss: 0.661 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.9193761348724365
Epoch: 46, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.656 Vali Acc: 0.894 Test Loss: 0.656 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.9839518070220947
Epoch: 47, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.661 Vali Acc: 0.894 Test Loss: 0.661 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 8342591
model size : 36.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.56397819519043
Epoch: 1, Steps: 12 | Train Loss: 2.822 Vali Loss: 2.621 Vali Acc: 0.161 Test Loss: 2.621 Test Acc: 0.161
Validation loss decreased (inf --> -0.161085).  Saving model ...
Epoch: 2 cost time: 1.794572114944458
Epoch: 2, Steps: 12 | Train Loss: 2.547 Vali Loss: 2.312 Vali Acc: 0.361 Test Loss: 2.312 Test Acc: 0.361
Validation loss decreased (-0.161085 --> -0.361088).  Saving model ...
Epoch: 3 cost time: 2.028566837310791
Epoch: 3, Steps: 12 | Train Loss: 2.167 Vali Loss: 1.904 Vali Acc: 0.522 Test Loss: 1.904 Test Acc: 0.522
Validation loss decreased (-0.361088 --> -0.522203).  Saving model ...
Epoch: 4 cost time: 1.8700346946716309
Epoch: 4, Steps: 12 | Train Loss: 1.681 Vali Loss: 1.559 Vali Acc: 0.561 Test Loss: 1.559 Test Acc: 0.561
Validation loss decreased (-0.522203 --> -0.561096).  Saving model ...
Epoch: 5 cost time: 1.7437591552734375
Epoch: 5, Steps: 12 | Train Loss: 1.312 Vali Loss: 1.399 Vali Acc: 0.622 Test Loss: 1.399 Test Acc: 0.622
Validation loss decreased (-0.561096 --> -0.622208).  Saving model ...
Epoch: 6 cost time: 1.923563003540039
Epoch: 6, Steps: 12 | Train Loss: 1.099 Vali Loss: 1.171 Vali Acc: 0.667 Test Loss: 1.171 Test Acc: 0.667
Validation loss decreased (-0.622208 --> -0.666655).  Saving model ...
Epoch: 7 cost time: 1.7555737495422363
Epoch: 7, Steps: 12 | Train Loss: 0.920 Vali Loss: 0.947 Vali Acc: 0.706 Test Loss: 0.947 Test Acc: 0.706
Validation loss decreased (-0.666655 --> -0.705546).  Saving model ...
Epoch: 8 cost time: 2.238492012023926
Epoch: 8, Steps: 12 | Train Loss: 0.778 Vali Loss: 1.083 Vali Acc: 0.683 Test Loss: 1.083 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6080918312072754
Epoch: 9, Steps: 12 | Train Loss: 0.765 Vali Loss: 0.924 Vali Acc: 0.728 Test Loss: 0.924 Test Acc: 0.728
Validation loss decreased (-0.705546 --> -0.727769).  Saving model ...
Epoch: 10 cost time: 1.4461102485656738
Epoch: 10, Steps: 12 | Train Loss: 0.555 Vali Loss: 0.841 Vali Acc: 0.728 Test Loss: 0.841 Test Acc: 0.728
Validation loss decreased (-0.727769 --> -0.727769).  Saving model ...
Epoch: 11 cost time: 1.9055275917053223
Epoch: 11, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.752 Vali Acc: 0.728 Test Loss: 0.752 Test Acc: 0.728
Validation loss decreased (-0.727769 --> -0.727770).  Saving model ...
Epoch: 12 cost time: 1.9446589946746826
Epoch: 12, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.657 Vali Acc: 0.833 Test Loss: 0.657 Test Acc: 0.833
Validation loss decreased (-0.727770 --> -0.833327).  Saving model ...
Epoch: 13 cost time: 1.965512990951538
Epoch: 13, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.684 Vali Acc: 0.822 Test Loss: 0.684 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8263368606567383
Epoch: 14, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.648 Vali Acc: 0.817 Test Loss: 0.648 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.0554122924804688
Epoch: 15, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.539 Vali Acc: 0.856 Test Loss: 0.539 Test Acc: 0.856
Validation loss decreased (-0.833327 --> -0.855550).  Saving model ...
Epoch: 16 cost time: 1.90000581741333
Epoch: 16, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.577 Vali Acc: 0.844 Test Loss: 0.577 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9730055332183838
Epoch: 17, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.522 Vali Acc: 0.850 Test Loss: 0.522 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.3045239448547363
Epoch: 18, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.719 Vali Acc: 0.872 Test Loss: 0.719 Test Acc: 0.872
Validation loss decreased (-0.855550 --> -0.872215).  Saving model ...
Epoch: 19 cost time: 1.662782907485962
Epoch: 19, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.475 Vali Acc: 0.856 Test Loss: 0.475 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6839275360107422
Epoch: 20, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.540 Vali Acc: 0.867 Test Loss: 0.540 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6189336776733398
Epoch: 21, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.646 Vali Acc: 0.833 Test Loss: 0.646 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.037076234817505
Epoch: 22, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.493 Vali Acc: 0.867 Test Loss: 0.493 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6219382286071777
Epoch: 23, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.538 Vali Acc: 0.883 Test Loss: 0.538 Test Acc: 0.883
Validation loss decreased (-0.872215 --> -0.883328).  Saving model ...
Epoch: 24 cost time: 1.886042833328247
Epoch: 24, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.594 Vali Acc: 0.856 Test Loss: 0.594 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9959297180175781
Epoch: 25, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.623 Vali Acc: 0.856 Test Loss: 0.623 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.8975844383239746
Epoch: 26, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.656 Vali Acc: 0.850 Test Loss: 0.656 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.69986891746521
Epoch: 27, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.717 Vali Acc: 0.822 Test Loss: 0.717 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.9829235076904297
Epoch: 28, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.610 Vali Acc: 0.844 Test Loss: 0.610 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.085087776184082
Epoch: 29, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.692 Vali Acc: 0.839 Test Loss: 0.692 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.9421021938323975
Epoch: 30, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.598 Vali Acc: 0.867 Test Loss: 0.598 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.0050055980682373
Epoch: 31, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.588 Vali Acc: 0.861 Test Loss: 0.588 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.696122407913208
Epoch: 32, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.630 Vali Acc: 0.861 Test Loss: 0.630 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.9644765853881836
Epoch: 33, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.676 Vali Acc: 0.822 Test Loss: 0.676 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 8340799
model size : 36.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3993804454803467
Epoch: 1, Steps: 12 | Train Loss: 2.889 Vali Loss: 2.622 Vali Acc: 0.122 Test Loss: 2.622 Test Acc: 0.122
Validation loss decreased (inf --> -0.122196).  Saving model ...
Epoch: 2 cost time: 1.730468988418579
Epoch: 2, Steps: 12 | Train Loss: 2.565 Vali Loss: 2.294 Vali Acc: 0.367 Test Loss: 2.294 Test Acc: 0.367
Validation loss decreased (-0.122196 --> -0.366644).  Saving model ...
Epoch: 3 cost time: 1.9091784954071045
Epoch: 3, Steps: 12 | Train Loss: 2.109 Vali Loss: 1.877 Vali Acc: 0.483 Test Loss: 1.877 Test Acc: 0.483
Validation loss decreased (-0.366644 --> -0.483315).  Saving model ...
Epoch: 4 cost time: 1.6583998203277588
Epoch: 4, Steps: 12 | Train Loss: 1.645 Vali Loss: 1.553 Vali Acc: 0.544 Test Loss: 1.553 Test Acc: 0.544
Validation loss decreased (-0.483315 --> -0.544429).  Saving model ...
Epoch: 5 cost time: 1.684192180633545
Epoch: 5, Steps: 12 | Train Loss: 1.307 Vali Loss: 1.343 Vali Acc: 0.561 Test Loss: 1.343 Test Acc: 0.561
Validation loss decreased (-0.544429 --> -0.561098).  Saving model ...
Epoch: 6 cost time: 2.253873825073242
Epoch: 6, Steps: 12 | Train Loss: 1.090 Vali Loss: 1.237 Vali Acc: 0.689 Test Loss: 1.237 Test Acc: 0.689
Validation loss decreased (-0.561098 --> -0.688877).  Saving model ...
Epoch: 7 cost time: 1.8323261737823486
Epoch: 7, Steps: 12 | Train Loss: 0.932 Vali Loss: 1.064 Vali Acc: 0.667 Test Loss: 1.064 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9513614177703857
Epoch: 8, Steps: 12 | Train Loss: 0.783 Vali Loss: 0.964 Vali Acc: 0.650 Test Loss: 0.964 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0995466709136963
Epoch: 9, Steps: 12 | Train Loss: 0.736 Vali Loss: 0.884 Vali Acc: 0.761 Test Loss: 0.884 Test Acc: 0.761
Validation loss decreased (-0.688877 --> -0.761102).  Saving model ...
Epoch: 10 cost time: 2.1052744388580322
Epoch: 10, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.820 Vali Acc: 0.706 Test Loss: 0.820 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9020655155181885
Epoch: 11, Steps: 12 | Train Loss: 0.482 Vali Loss: 0.762 Vali Acc: 0.772 Test Loss: 0.762 Test Acc: 0.772
Validation loss decreased (-0.761102 --> -0.772215).  Saving model ...
Epoch: 12 cost time: 2.0749971866607666
Epoch: 12, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.650 Vali Acc: 0.794 Test Loss: 0.650 Test Acc: 0.794
Validation loss decreased (-0.772215 --> -0.794438).  Saving model ...
Epoch: 13 cost time: 1.816514253616333
Epoch: 13, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.885 Vali Acc: 0.772 Test Loss: 0.885 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8218071460723877
Epoch: 14, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.682 Vali Acc: 0.850 Test Loss: 0.682 Test Acc: 0.850
Validation loss decreased (-0.794438 --> -0.849993).  Saving model ...
Epoch: 15 cost time: 1.7703442573547363
Epoch: 15, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.599 Vali Acc: 0.844 Test Loss: 0.599 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.3305578231811523
Epoch: 16, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.556 Vali Acc: 0.850 Test Loss: 0.556 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 17 cost time: 1.7854204177856445
Epoch: 17, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.645 Vali Acc: 0.828 Test Loss: 0.645 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.490981101989746
Epoch: 18, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.569 Vali Acc: 0.833 Test Loss: 0.569 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.1483962535858154
Epoch: 19, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.644 Vali Acc: 0.850 Test Loss: 0.644 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.889270305633545
Epoch: 20, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.603 Vali Acc: 0.850 Test Loss: 0.603 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.8940482139587402
Epoch: 21, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.579 Vali Acc: 0.844 Test Loss: 0.579 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.789640188217163
Epoch: 22, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.546 Vali Acc: 0.867 Test Loss: 0.546 Test Acc: 0.867
Validation loss decreased (-0.849994 --> -0.866661).  Saving model ...
Epoch: 23 cost time: 1.8871688842773438
Epoch: 23, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.680 Vali Acc: 0.856 Test Loss: 0.680 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.832568645477295
Epoch: 24, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.685 Vali Acc: 0.872 Test Loss: 0.685 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872215).  Saving model ...
Epoch: 25 cost time: 1.7766287326812744
Epoch: 25, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.620 Vali Acc: 0.867 Test Loss: 0.620 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7057344913482666
Epoch: 26, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.650 Vali Acc: 0.856 Test Loss: 0.650 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.7544379234313965
Epoch: 27, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.720 Vali Acc: 0.828 Test Loss: 0.720 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.0322682857513428
Epoch: 28, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.708 Vali Acc: 0.856 Test Loss: 0.708 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.621791124343872
Epoch: 29, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.729 Vali Acc: 0.828 Test Loss: 0.729 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.0554702281951904
Epoch: 30, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.648 Vali Acc: 0.833 Test Loss: 0.648 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.8520278930664062
Epoch: 31, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.744 Vali Acc: 0.833 Test Loss: 0.744 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.8888583183288574
Epoch: 32, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.617 Vali Acc: 0.867 Test Loss: 0.617 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.9748706817626953
Epoch: 33, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.653 Vali Acc: 0.867 Test Loss: 0.653 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.9452412128448486
Epoch: 34, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.640 Vali Acc: 0.872 Test Loss: 0.640 Test Acc: 0.872
Validation loss decreased (-0.872215 --> -0.872216).  Saving model ...
Epoch: 35 cost time: 2.003777027130127
Epoch: 35, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.693 Vali Acc: 0.850 Test Loss: 0.693 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.204927921295166
Epoch: 36, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.704 Vali Acc: 0.861 Test Loss: 0.704 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.8887805938720703
Epoch: 37, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.709 Vali Acc: 0.850 Test Loss: 0.709 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.751044511795044
Epoch: 38, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.719 Vali Acc: 0.856 Test Loss: 0.719 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.8367655277252197
Epoch: 39, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.760 Vali Acc: 0.839 Test Loss: 0.760 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.896695852279663
Epoch: 40, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.809 Vali Acc: 0.850 Test Loss: 0.809 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.849259376525879
Epoch: 41, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.675 Vali Acc: 0.833 Test Loss: 0.675 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.1895291805267334
Epoch: 42, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.788 Vali Acc: 0.861 Test Loss: 0.788 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 2.0092248916625977
Epoch: 43, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.712 Vali Acc: 0.850 Test Loss: 0.712 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 2.1821277141571045
Epoch: 44, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.934 Vali Acc: 0.806 Test Loss: 0.934 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 8339007
model size : 36.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7406911849975586
Epoch: 1, Steps: 12 | Train Loss: 2.769 Vali Loss: 2.568 Vali Acc: 0.189 Test Loss: 2.568 Test Acc: 0.189
Validation loss decreased (inf --> -0.188863).  Saving model ...
Epoch: 2 cost time: 1.634140968322754
Epoch: 2, Steps: 12 | Train Loss: 2.503 Vali Loss: 2.261 Vali Acc: 0.383 Test Loss: 2.261 Test Acc: 0.383
Validation loss decreased (-0.188863 --> -0.383311).  Saving model ...
Epoch: 3 cost time: 1.7890198230743408
Epoch: 3, Steps: 12 | Train Loss: 2.075 Vali Loss: 1.910 Vali Acc: 0.489 Test Loss: 1.910 Test Acc: 0.489
Validation loss decreased (-0.383311 --> -0.488870).  Saving model ...
Epoch: 4 cost time: 1.8860464096069336
Epoch: 4, Steps: 12 | Train Loss: 1.712 Vali Loss: 1.610 Vali Acc: 0.567 Test Loss: 1.610 Test Acc: 0.567
Validation loss decreased (-0.488870 --> -0.566651).  Saving model ...
Epoch: 5 cost time: 1.5334150791168213
Epoch: 5, Steps: 12 | Train Loss: 1.397 Vali Loss: 1.398 Vali Acc: 0.578 Test Loss: 1.398 Test Acc: 0.578
Validation loss decreased (-0.566651 --> -0.577764).  Saving model ...
Epoch: 6 cost time: 1.700772762298584
Epoch: 6, Steps: 12 | Train Loss: 1.163 Vali Loss: 1.216 Vali Acc: 0.678 Test Loss: 1.216 Test Acc: 0.678
Validation loss decreased (-0.577764 --> -0.677766).  Saving model ...
Epoch: 7 cost time: 1.4709069728851318
Epoch: 7, Steps: 12 | Train Loss: 0.939 Vali Loss: 1.208 Vali Acc: 0.567 Test Loss: 1.208 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5940091609954834
Epoch: 8, Steps: 12 | Train Loss: 0.972 Vali Loss: 1.029 Vali Acc: 0.706 Test Loss: 1.029 Test Acc: 0.706
Validation loss decreased (-0.677766 --> -0.705545).  Saving model ...
Epoch: 9 cost time: 1.7027497291564941
Epoch: 9, Steps: 12 | Train Loss: 0.752 Vali Loss: 0.941 Vali Acc: 0.722 Test Loss: 0.941 Test Acc: 0.722
Validation loss decreased (-0.705545 --> -0.722213).  Saving model ...
Epoch: 10 cost time: 1.932990312576294
Epoch: 10, Steps: 12 | Train Loss: 0.627 Vali Loss: 0.876 Vali Acc: 0.739 Test Loss: 0.876 Test Acc: 0.739
Validation loss decreased (-0.722213 --> -0.738880).  Saving model ...
Epoch: 11 cost time: 1.6893956661224365
Epoch: 11, Steps: 12 | Train Loss: 0.578 Vali Loss: 0.740 Vali Acc: 0.761 Test Loss: 0.740 Test Acc: 0.761
Validation loss decreased (-0.738880 --> -0.761104).  Saving model ...
Epoch: 12 cost time: 1.71358323097229
Epoch: 12, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.790 Vali Acc: 0.789 Test Loss: 0.790 Test Acc: 0.789
Validation loss decreased (-0.761104 --> -0.788881).  Saving model ...
Epoch: 13 cost time: 1.7062320709228516
Epoch: 13, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.645 Vali Acc: 0.839 Test Loss: 0.645 Test Acc: 0.839
Validation loss decreased (-0.788881 --> -0.838882).  Saving model ...
Epoch: 14 cost time: 1.6896026134490967
Epoch: 14, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.649 Vali Acc: 0.850 Test Loss: 0.649 Test Acc: 0.850
Validation loss decreased (-0.838882 --> -0.849994).  Saving model ...
Epoch: 15 cost time: 1.5888464450836182
Epoch: 15, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.683 Vali Acc: 0.811 Test Loss: 0.683 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7711694240570068
Epoch: 16, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.603 Vali Acc: 0.844 Test Loss: 0.603 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7148149013519287
Epoch: 17, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.699 Vali Acc: 0.839 Test Loss: 0.699 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.514178991317749
Epoch: 18, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.624 Vali Acc: 0.856 Test Loss: 0.624 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 19 cost time: 1.6199464797973633
Epoch: 19, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.569 Vali Acc: 0.867 Test Loss: 0.569 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866661).  Saving model ...
Epoch: 20 cost time: 1.4322078227996826
Epoch: 20, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.704 Vali Acc: 0.828 Test Loss: 0.704 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7420687675476074
Epoch: 21, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.904 Vali Acc: 0.783 Test Loss: 0.904 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5026731491088867
Epoch: 22, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.686 Vali Acc: 0.844 Test Loss: 0.686 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7045764923095703
Epoch: 23, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.546 Vali Acc: 0.844 Test Loss: 0.546 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.5890929698944092
Epoch: 24, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.619 Vali Acc: 0.850 Test Loss: 0.619 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.530867338180542
Epoch: 25, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.622 Vali Acc: 0.861 Test Loss: 0.622 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.607356071472168
Epoch: 26, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.780 Vali Acc: 0.817 Test Loss: 0.780 Test Acc: 0.817
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.6114776134490967
Epoch: 27, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.804 Vali Acc: 0.806 Test Loss: 0.804 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.4637131690979004
Epoch: 28, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.626 Vali Acc: 0.844 Test Loss: 0.626 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.8019022941589355
Epoch: 29, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.713 Vali Acc: 0.856 Test Loss: 0.713 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 7884735
model size : 35.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.499987840652466
Epoch: 1, Steps: 12 | Train Loss: 2.861 Vali Loss: 2.596 Vali Acc: 0.139 Test Loss: 2.596 Test Acc: 0.139
Validation loss decreased (inf --> -0.138863).  Saving model ...
Epoch: 2 cost time: 1.7551665306091309
Epoch: 2, Steps: 12 | Train Loss: 2.531 Vali Loss: 2.268 Vali Acc: 0.328 Test Loss: 2.268 Test Acc: 0.328
Validation loss decreased (-0.138863 --> -0.327755).  Saving model ...
Epoch: 3 cost time: 1.7955565452575684
Epoch: 3, Steps: 12 | Train Loss: 2.165 Vali Loss: 1.921 Vali Acc: 0.433 Test Loss: 1.921 Test Acc: 0.433
Validation loss decreased (-0.327755 --> -0.433314).  Saving model ...
Epoch: 4 cost time: 2.007059097290039
Epoch: 4, Steps: 12 | Train Loss: 1.674 Vali Loss: 1.609 Vali Acc: 0.511 Test Loss: 1.609 Test Acc: 0.511
Validation loss decreased (-0.433314 --> -0.511095).  Saving model ...
Epoch: 5 cost time: 1.6258180141448975
Epoch: 5, Steps: 12 | Train Loss: 1.348 Vali Loss: 1.366 Vali Acc: 0.533 Test Loss: 1.366 Test Acc: 0.533
Validation loss decreased (-0.511095 --> -0.533320).  Saving model ...
Epoch: 6 cost time: 1.8348968029022217
Epoch: 6, Steps: 12 | Train Loss: 1.106 Vali Loss: 1.285 Vali Acc: 0.644 Test Loss: 1.285 Test Acc: 0.644
Validation loss decreased (-0.533320 --> -0.644432).  Saving model ...
Epoch: 7 cost time: 1.625591516494751
Epoch: 7, Steps: 12 | Train Loss: 1.032 Vali Loss: 1.072 Vali Acc: 0.672 Test Loss: 1.072 Test Acc: 0.672
Validation loss decreased (-0.644432 --> -0.672211).  Saving model ...
Epoch: 8 cost time: 1.8842852115631104
Epoch: 8, Steps: 12 | Train Loss: 0.807 Vali Loss: 0.976 Vali Acc: 0.689 Test Loss: 0.976 Test Acc: 0.689
Validation loss decreased (-0.672211 --> -0.688879).  Saving model ...
Epoch: 9 cost time: 1.892141580581665
Epoch: 9, Steps: 12 | Train Loss: 0.730 Vali Loss: 0.803 Vali Acc: 0.783 Test Loss: 0.803 Test Acc: 0.783
Validation loss decreased (-0.688879 --> -0.783325).  Saving model ...
Epoch: 10 cost time: 1.9255688190460205
Epoch: 10, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.793 Vali Acc: 0.733 Test Loss: 0.793 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6095964908599854
Epoch: 11, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.761 Vali Acc: 0.761 Test Loss: 0.761 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5901563167572021
Epoch: 12, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.680 Vali Acc: 0.800 Test Loss: 0.680 Test Acc: 0.800
Validation loss decreased (-0.783325 --> -0.799993).  Saving model ...
Epoch: 13 cost time: 1.7310590744018555
Epoch: 13, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.625 Vali Acc: 0.794 Test Loss: 0.625 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8213565349578857
Epoch: 14, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.810 Vali Acc: 0.789 Test Loss: 0.810 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8474016189575195
Epoch: 15, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.605 Vali Acc: 0.839 Test Loss: 0.605 Test Acc: 0.839
Validation loss decreased (-0.799993 --> -0.838883).  Saving model ...
Epoch: 16 cost time: 1.649564266204834
Epoch: 16, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.692 Vali Acc: 0.800 Test Loss: 0.692 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5631623268127441
Epoch: 17, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.619 Vali Acc: 0.828 Test Loss: 0.619 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8137059211730957
Epoch: 18, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.628 Vali Acc: 0.850 Test Loss: 0.628 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 19 cost time: 1.6479041576385498
Epoch: 19, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.712 Vali Acc: 0.794 Test Loss: 0.712 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.0854310989379883
Epoch: 20, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.581 Vali Acc: 0.811 Test Loss: 0.581 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.9067037105560303
Epoch: 21, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.707 Vali Acc: 0.806 Test Loss: 0.707 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.8102548122406006
Epoch: 22, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.736 Vali Acc: 0.844 Test Loss: 0.736 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.289066791534424
Epoch: 23, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.691 Vali Acc: 0.833 Test Loss: 0.691 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.7364933490753174
Epoch: 24, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.678 Vali Acc: 0.856 Test Loss: 0.678 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 25 cost time: 2.0548903942108154
Epoch: 25, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.633 Vali Acc: 0.844 Test Loss: 0.633 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9145066738128662
Epoch: 26, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.779 Vali Acc: 0.844 Test Loss: 0.779 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.0007517337799072
Epoch: 27, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.770 Vali Acc: 0.839 Test Loss: 0.770 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.8547158241271973
Epoch: 28, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.732 Vali Acc: 0.861 Test Loss: 0.732 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861104).  Saving model ...
Epoch: 29 cost time: 1.7161376476287842
Epoch: 29, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.692 Vali Acc: 0.878 Test Loss: 0.692 Test Acc: 0.878
Validation loss decreased (-0.861104 --> -0.877771).  Saving model ...
Epoch: 30 cost time: 1.7951514720916748
Epoch: 30, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.697 Vali Acc: 0.867 Test Loss: 0.697 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.6006278991699219
Epoch: 31, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.762 Vali Acc: 0.867 Test Loss: 0.762 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.7737507820129395
Epoch: 32, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.723 Vali Acc: 0.850 Test Loss: 0.723 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.7162127494812012
Epoch: 33, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.753 Vali Acc: 0.861 Test Loss: 0.753 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.8309681415557861
Epoch: 34, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.693 Vali Acc: 0.872 Test Loss: 0.693 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.9042868614196777
Epoch: 35, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.678 Vali Acc: 0.872 Test Loss: 0.678 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.8563232421875
Epoch: 36, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.692 Vali Acc: 0.867 Test Loss: 0.692 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.8416881561279297
Epoch: 37, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.665 Vali Acc: 0.867 Test Loss: 0.665 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.9392809867858887
Epoch: 38, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.690 Vali Acc: 0.839 Test Loss: 0.690 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.8921332359313965
Epoch: 39, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.710 Vali Acc: 0.861 Test Loss: 0.710 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 7882943
model size : 35.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.500370740890503
Epoch: 1, Steps: 12 | Train Loss: 2.754 Vali Loss: 2.563 Vali Acc: 0.167 Test Loss: 2.563 Test Acc: 0.167
Validation loss decreased (inf --> -0.166641).  Saving model ...
Epoch: 2 cost time: 1.9633710384368896
Epoch: 2, Steps: 12 | Train Loss: 2.464 Vali Loss: 2.269 Vali Acc: 0.378 Test Loss: 2.269 Test Acc: 0.378
Validation loss decreased (-0.166641 --> -0.377755).  Saving model ...
Epoch: 3 cost time: 1.679032564163208
Epoch: 3, Steps: 12 | Train Loss: 2.058 Vali Loss: 1.854 Vali Acc: 0.522 Test Loss: 1.854 Test Acc: 0.522
Validation loss decreased (-0.377755 --> -0.522204).  Saving model ...
Epoch: 4 cost time: 1.5194416046142578
Epoch: 4, Steps: 12 | Train Loss: 1.650 Vali Loss: 1.570 Vali Acc: 0.517 Test Loss: 1.570 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7527670860290527
Epoch: 5, Steps: 12 | Train Loss: 1.294 Vali Loss: 1.377 Vali Acc: 0.567 Test Loss: 1.377 Test Acc: 0.567
Validation loss decreased (-0.522204 --> -0.566653).  Saving model ...
Epoch: 6 cost time: 1.6009204387664795
Epoch: 6, Steps: 12 | Train Loss: 1.168 Vali Loss: 1.207 Vali Acc: 0.628 Test Loss: 1.207 Test Acc: 0.628
Validation loss decreased (-0.566653 --> -0.627766).  Saving model ...
Epoch: 7 cost time: 1.466653823852539
Epoch: 7, Steps: 12 | Train Loss: 1.036 Vali Loss: 1.144 Vali Acc: 0.628 Test Loss: 1.144 Test Acc: 0.628
Validation loss decreased (-0.627766 --> -0.627766).  Saving model ...
Epoch: 8 cost time: 1.7635605335235596
Epoch: 8, Steps: 12 | Train Loss: 0.830 Vali Loss: 1.021 Vali Acc: 0.672 Test Loss: 1.021 Test Acc: 0.672
Validation loss decreased (-0.627766 --> -0.672212).  Saving model ...
Epoch: 9 cost time: 1.6411280632019043
Epoch: 9, Steps: 12 | Train Loss: 0.716 Vali Loss: 0.963 Vali Acc: 0.678 Test Loss: 0.963 Test Acc: 0.678
Validation loss decreased (-0.672212 --> -0.677768).  Saving model ...
Epoch: 10 cost time: 1.6946392059326172
Epoch: 10, Steps: 12 | Train Loss: 0.741 Vali Loss: 0.885 Vali Acc: 0.700 Test Loss: 0.885 Test Acc: 0.700
Validation loss decreased (-0.677768 --> -0.699991).  Saving model ...
Epoch: 11 cost time: 1.553548812866211
Epoch: 11, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.788 Vali Acc: 0.778 Test Loss: 0.788 Test Acc: 0.778
Validation loss decreased (-0.699991 --> -0.777770).  Saving model ...
Epoch: 12 cost time: 1.5674970149993896
Epoch: 12, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.635 Vali Acc: 0.833 Test Loss: 0.635 Test Acc: 0.833
Validation loss decreased (-0.777770 --> -0.833327).  Saving model ...
Epoch: 13 cost time: 1.7353425025939941
Epoch: 13, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.732 Vali Acc: 0.789 Test Loss: 0.732 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.893080234527588
Epoch: 14, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.847 Vali Acc: 0.744 Test Loss: 0.847 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.674375057220459
Epoch: 15, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.649 Vali Acc: 0.744 Test Loss: 0.649 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7261409759521484
Epoch: 16, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.722 Vali Acc: 0.789 Test Loss: 0.722 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.74898362159729
Epoch: 17, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.558 Vali Acc: 0.833 Test Loss: 0.558 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833328).  Saving model ...
Epoch: 18 cost time: 1.7318363189697266
Epoch: 18, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.669 Vali Acc: 0.800 Test Loss: 0.669 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.837731122970581
Epoch: 19, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.519 Vali Acc: 0.839 Test Loss: 0.519 Test Acc: 0.839
Validation loss decreased (-0.833328 --> -0.838884).  Saving model ...
Epoch: 20 cost time: 1.6933801174163818
Epoch: 20, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.615 Vali Acc: 0.839 Test Loss: 0.615 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6378881931304932
Epoch: 21, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.584 Vali Acc: 0.856 Test Loss: 0.584 Test Acc: 0.856
Validation loss decreased (-0.838884 --> -0.855550).  Saving model ...
Epoch: 22 cost time: 1.7191965579986572
Epoch: 22, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.601 Vali Acc: 0.856 Test Loss: 0.601 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.997495174407959
Epoch: 23, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.652 Vali Acc: 0.867 Test Loss: 0.652 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866660).  Saving model ...
Epoch: 24 cost time: 1.6877508163452148
Epoch: 24, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.608 Vali Acc: 0.878 Test Loss: 0.608 Test Acc: 0.878
Validation loss decreased (-0.866660 --> -0.877772).  Saving model ...
Epoch: 25 cost time: 1.8301479816436768
Epoch: 25, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.592 Vali Acc: 0.878 Test Loss: 0.592 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 26 cost time: 1.9939374923706055
Epoch: 26, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.624 Vali Acc: 0.872 Test Loss: 0.624 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7832391262054443
Epoch: 27, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.647 Vali Acc: 0.861 Test Loss: 0.647 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8388893604278564
Epoch: 28, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.645 Vali Acc: 0.844 Test Loss: 0.645 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.136735200881958
Epoch: 29, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.617 Vali Acc: 0.850 Test Loss: 0.617 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.8070569038391113
Epoch: 30, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.592 Vali Acc: 0.867 Test Loss: 0.592 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.946080207824707
Epoch: 31, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.672 Vali Acc: 0.861 Test Loss: 0.672 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.0310120582580566
Epoch: 32, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.607 Vali Acc: 0.878 Test Loss: 0.607 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.0516104698181152
Epoch: 33, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.586 Vali Acc: 0.856 Test Loss: 0.586 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.9852030277252197
Epoch: 34, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.803 Vali Acc: 0.822 Test Loss: 0.803 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.1445488929748535
Epoch: 35, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.706 Vali Acc: 0.839 Test Loss: 0.706 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 7881151
model size : 35.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.393502712249756
Epoch: 1, Steps: 12 | Train Loss: 2.823 Vali Loss: 2.599 Vali Acc: 0.200 Test Loss: 2.599 Test Acc: 0.200
Validation loss decreased (inf --> -0.199974).  Saving model ...
Epoch: 2 cost time: 1.8357734680175781
Epoch: 2, Steps: 12 | Train Loss: 2.512 Vali Loss: 2.312 Vali Acc: 0.367 Test Loss: 2.312 Test Acc: 0.367
Validation loss decreased (-0.199974 --> -0.366644).  Saving model ...
Epoch: 3 cost time: 1.6510798931121826
Epoch: 3, Steps: 12 | Train Loss: 2.107 Vali Loss: 1.925 Vali Acc: 0.489 Test Loss: 1.925 Test Acc: 0.489
Validation loss decreased (-0.366644 --> -0.488870).  Saving model ...
Epoch: 4 cost time: 1.5896384716033936
Epoch: 4, Steps: 12 | Train Loss: 1.706 Vali Loss: 1.596 Vali Acc: 0.550 Test Loss: 1.596 Test Acc: 0.550
Validation loss decreased (-0.488870 --> -0.549984).  Saving model ...
Epoch: 5 cost time: 1.7528369426727295
Epoch: 5, Steps: 12 | Train Loss: 1.366 Vali Loss: 1.433 Vali Acc: 0.583 Test Loss: 1.433 Test Acc: 0.583
Validation loss decreased (-0.549984 --> -0.583319).  Saving model ...
Epoch: 6 cost time: 1.8584012985229492
Epoch: 6, Steps: 12 | Train Loss: 1.186 Vali Loss: 1.214 Vali Acc: 0.622 Test Loss: 1.214 Test Acc: 0.622
Validation loss decreased (-0.583319 --> -0.622210).  Saving model ...
Epoch: 7 cost time: 1.7516257762908936
Epoch: 7, Steps: 12 | Train Loss: 0.957 Vali Loss: 1.050 Vali Acc: 0.678 Test Loss: 1.050 Test Acc: 0.678
Validation loss decreased (-0.622210 --> -0.677767).  Saving model ...
Epoch: 8 cost time: 1.5958740711212158
Epoch: 8, Steps: 12 | Train Loss: 0.872 Vali Loss: 0.978 Vali Acc: 0.700 Test Loss: 0.978 Test Acc: 0.700
Validation loss decreased (-0.677767 --> -0.699990).  Saving model ...
Epoch: 9 cost time: 1.9464232921600342
Epoch: 9, Steps: 12 | Train Loss: 0.696 Vali Loss: 0.880 Vali Acc: 0.739 Test Loss: 0.880 Test Acc: 0.739
Validation loss decreased (-0.699990 --> -0.738880).  Saving model ...
Epoch: 10 cost time: 1.828618049621582
Epoch: 10, Steps: 12 | Train Loss: 0.637 Vali Loss: 0.853 Vali Acc: 0.717 Test Loss: 0.853 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6189446449279785
Epoch: 11, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.762 Vali Acc: 0.767 Test Loss: 0.762 Test Acc: 0.767
Validation loss decreased (-0.738880 --> -0.766659).  Saving model ...
Epoch: 12 cost time: 2.0599231719970703
Epoch: 12, Steps: 12 | Train Loss: 0.518 Vali Loss: 0.879 Vali Acc: 0.739 Test Loss: 0.879 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.895517110824585
Epoch: 13, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.663 Vali Acc: 0.789 Test Loss: 0.663 Test Acc: 0.789
Validation loss decreased (-0.766659 --> -0.788882).  Saving model ...
Epoch: 14 cost time: 1.9771957397460938
Epoch: 14, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.707 Vali Acc: 0.811 Test Loss: 0.707 Test Acc: 0.811
Validation loss decreased (-0.788882 --> -0.811104).  Saving model ...
Epoch: 15 cost time: 1.9029438495635986
Epoch: 15, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.683 Vali Acc: 0.833 Test Loss: 0.683 Test Acc: 0.833
Validation loss decreased (-0.811104 --> -0.833327).  Saving model ...
Epoch: 16 cost time: 1.9177677631378174
Epoch: 16, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.754 Vali Acc: 0.806 Test Loss: 0.754 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4832262992858887
Epoch: 17, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.699 Vali Acc: 0.828 Test Loss: 0.699 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9801831245422363
Epoch: 18, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.623 Vali Acc: 0.828 Test Loss: 0.623 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9656002521514893
Epoch: 19, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.616 Vali Acc: 0.861 Test Loss: 0.616 Test Acc: 0.861
Validation loss decreased (-0.833327 --> -0.861105).  Saving model ...
Epoch: 20 cost time: 1.7542340755462646
Epoch: 20, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.716 Vali Acc: 0.844 Test Loss: 0.716 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.100250244140625
Epoch: 21, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.726 Vali Acc: 0.839 Test Loss: 0.726 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8572275638580322
Epoch: 22, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.714 Vali Acc: 0.800 Test Loss: 0.714 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.4826650619506836
Epoch: 23, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.817 Vali Acc: 0.822 Test Loss: 0.817 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.051712989807129
Epoch: 24, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.833 Vali Acc: 0.811 Test Loss: 0.833 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.017486333847046
Epoch: 25, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.759 Vali Acc: 0.867 Test Loss: 0.759 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866659).  Saving model ...
Epoch: 26 cost time: 2.0275559425354004
Epoch: 26, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.727 Vali Acc: 0.839 Test Loss: 0.727 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5439014434814453
Epoch: 27, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.829 Vali Acc: 0.833 Test Loss: 0.829 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8720731735229492
Epoch: 28, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.605 Vali Acc: 0.861 Test Loss: 0.605 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.568225622177124
Epoch: 29, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.647 Vali Acc: 0.867 Test Loss: 0.647 Test Acc: 0.867
Validation loss decreased (-0.866659 --> -0.866660).  Saving model ...
Epoch: 30 cost time: 1.9259247779846191
Epoch: 30, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.671 Vali Acc: 0.867 Test Loss: 0.671 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.8842437267303467
Epoch: 31, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.680 Vali Acc: 0.867 Test Loss: 0.680 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.2174582481384277
Epoch: 32, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.676 Vali Acc: 0.872 Test Loss: 0.676 Test Acc: 0.872
Validation loss decreased (-0.866660 --> -0.872215).  Saving model ...
Epoch: 33 cost time: 1.5649421215057373
Epoch: 33, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.681 Vali Acc: 0.867 Test Loss: 0.681 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.779043436050415
Epoch: 34, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.703 Vali Acc: 0.867 Test Loss: 0.703 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.6546766757965088
Epoch: 35, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.712 Vali Acc: 0.867 Test Loss: 0.712 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.7818365097045898
Epoch: 36, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.716 Vali Acc: 0.867 Test Loss: 0.716 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.0289013385772705
Epoch: 37, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.718 Vali Acc: 0.867 Test Loss: 0.718 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.8437299728393555
Epoch: 38, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.719 Vali Acc: 0.867 Test Loss: 0.719 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.6671350002288818
Epoch: 39, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.718 Vali Acc: 0.867 Test Loss: 0.718 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.5315401554107666
Epoch: 40, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.727 Vali Acc: 0.867 Test Loss: 0.727 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 2.0216116905212402
Epoch: 41, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.735 Vali Acc: 0.867 Test Loss: 0.735 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 2.0596067905426025
Epoch: 42, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.738 Vali Acc: 0.867 Test Loss: 0.738 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 7879359
model size : 35.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.1147541999816895
Epoch: 1, Steps: 12 | Train Loss: 2.888 Vali Loss: 2.724 Vali Acc: 0.111 Test Loss: 2.724 Test Acc: 0.111
Validation loss decreased (inf --> -0.111084).  Saving model ...
Epoch: 2 cost time: 2.1141998767852783
Epoch: 2, Steps: 12 | Train Loss: 2.656 Vali Loss: 2.484 Vali Acc: 0.189 Test Loss: 2.484 Test Acc: 0.189
Validation loss decreased (-0.111084 --> -0.188864).  Saving model ...
Epoch: 3 cost time: 1.8890564441680908
Epoch: 3, Steps: 12 | Train Loss: 2.331 Vali Loss: 2.212 Vali Acc: 0.317 Test Loss: 2.212 Test Acc: 0.317
Validation loss decreased (-0.188864 --> -0.316645).  Saving model ...
Epoch: 4 cost time: 2.170464277267456
Epoch: 4, Steps: 12 | Train Loss: 2.017 Vali Loss: 1.899 Vali Acc: 0.539 Test Loss: 1.899 Test Acc: 0.539
Validation loss decreased (-0.316645 --> -0.538870).  Saving model ...
Epoch: 5 cost time: 1.871917724609375
Epoch: 5, Steps: 12 | Train Loss: 1.665 Vali Loss: 1.620 Vali Acc: 0.567 Test Loss: 1.620 Test Acc: 0.567
Validation loss decreased (-0.538870 --> -0.566650).  Saving model ...
Epoch: 6 cost time: 1.8784582614898682
Epoch: 6, Steps: 12 | Train Loss: 1.371 Vali Loss: 1.424 Vali Acc: 0.644 Test Loss: 1.424 Test Acc: 0.644
Validation loss decreased (-0.566650 --> -0.644430).  Saving model ...
Epoch: 7 cost time: 1.9961228370666504
Epoch: 7, Steps: 12 | Train Loss: 1.229 Vali Loss: 1.295 Vali Acc: 0.650 Test Loss: 1.295 Test Acc: 0.650
Validation loss decreased (-0.644430 --> -0.649987).  Saving model ...
Epoch: 8 cost time: 1.7975437641143799
Epoch: 8, Steps: 12 | Train Loss: 1.050 Vali Loss: 1.141 Vali Acc: 0.706 Test Loss: 1.141 Test Acc: 0.706
Validation loss decreased (-0.649987 --> -0.705544).  Saving model ...
Epoch: 9 cost time: 1.6807048320770264
Epoch: 9, Steps: 12 | Train Loss: 0.855 Vali Loss: 1.066 Vali Acc: 0.683 Test Loss: 1.066 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0367326736450195
Epoch: 10, Steps: 12 | Train Loss: 0.769 Vali Loss: 1.027 Vali Acc: 0.733 Test Loss: 1.027 Test Acc: 0.733
Validation loss decreased (-0.705544 --> -0.733323).  Saving model ...
Epoch: 11 cost time: 2.0896646976470947
Epoch: 11, Steps: 12 | Train Loss: 0.687 Vali Loss: 0.878 Vali Acc: 0.761 Test Loss: 0.878 Test Acc: 0.761
Validation loss decreased (-0.733323 --> -0.761102).  Saving model ...
Epoch: 12 cost time: 1.8439147472381592
Epoch: 12, Steps: 12 | Train Loss: 0.575 Vali Loss: 0.788 Vali Acc: 0.822 Test Loss: 0.788 Test Acc: 0.822
Validation loss decreased (-0.761102 --> -0.822214).  Saving model ...
Epoch: 13 cost time: 2.510927438735962
Epoch: 13, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.673 Vali Acc: 0.817 Test Loss: 0.673 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0626590251922607
Epoch: 14, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.612 Vali Acc: 0.861 Test Loss: 0.612 Test Acc: 0.861
Validation loss decreased (-0.822214 --> -0.861105).  Saving model ...
Epoch: 15 cost time: 2.061337947845459
Epoch: 15, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.582 Vali Acc: 0.833 Test Loss: 0.582 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.1145782470703125
Epoch: 16, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.542 Vali Acc: 0.850 Test Loss: 0.542 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.196434497833252
Epoch: 17, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.555 Vali Acc: 0.839 Test Loss: 0.555 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9620726108551025
Epoch: 18, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.535 Vali Acc: 0.850 Test Loss: 0.535 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.903367519378662
Epoch: 19, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.529 Vali Acc: 0.872 Test Loss: 0.529 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872217).  Saving model ...
Epoch: 20 cost time: 1.7113499641418457
Epoch: 20, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.459 Vali Acc: 0.878 Test Loss: 0.459 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 21 cost time: 1.7430784702301025
Epoch: 21, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.520 Vali Acc: 0.861 Test Loss: 0.520 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.1489429473876953
Epoch: 22, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.535 Vali Acc: 0.872 Test Loss: 0.535 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8796353340148926
Epoch: 23, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.492 Vali Acc: 0.878 Test Loss: 0.492 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.7298040390014648
Epoch: 24, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.476 Vali Acc: 0.856 Test Loss: 0.476 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.0684521198272705
Epoch: 25, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.517 Vali Acc: 0.889 Test Loss: 0.517 Test Acc: 0.889
Validation loss decreased (-0.877773 --> -0.888884).  Saving model ...
Epoch: 26 cost time: 2.0276453495025635
Epoch: 26, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.510 Vali Acc: 0.872 Test Loss: 0.510 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.2093493938446045
Epoch: 27, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.505 Vali Acc: 0.889 Test Loss: 0.505 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 28 cost time: 2.116288661956787
Epoch: 28, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.540 Vali Acc: 0.878 Test Loss: 0.540 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.278233766555786
Epoch: 29, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.503 Vali Acc: 0.889 Test Loss: 0.503 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 30 cost time: 1.8550631999969482
Epoch: 30, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.662 Vali Acc: 0.850 Test Loss: 0.662 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.198368787765503
Epoch: 31, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.585 Vali Acc: 0.844 Test Loss: 0.585 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.772995948791504
Epoch: 32, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.719 Vali Acc: 0.839 Test Loss: 0.719 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.061483383178711
Epoch: 33, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.553 Vali Acc: 0.839 Test Loss: 0.553 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.9086661338806152
Epoch: 34, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.564 Vali Acc: 0.828 Test Loss: 0.564 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.0393667221069336
Epoch: 35, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.577 Vali Acc: 0.889 Test Loss: 0.577 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.6138417720794678
Epoch: 36, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.688 Vali Acc: 0.828 Test Loss: 0.688 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.8000242710113525
Epoch: 37, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.693 Vali Acc: 0.839 Test Loss: 0.693 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.694664716720581
Epoch: 38, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.516 Vali Acc: 0.867 Test Loss: 0.516 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.9598972797393799
Epoch: 39, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.485 Vali Acc: 0.889 Test Loss: 0.485 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 40 cost time: 1.8716075420379639
Epoch: 40, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.536 Vali Acc: 0.872 Test Loss: 0.536 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.0229063034057617
Epoch: 41, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.556 Vali Acc: 0.861 Test Loss: 0.556 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.662977695465088
Epoch: 42, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.702 Vali Acc: 0.850 Test Loss: 0.702 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.767639398574829
Epoch: 43, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.620 Vali Acc: 0.856 Test Loss: 0.620 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.8008592128753662
Epoch: 44, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.581 Vali Acc: 0.867 Test Loss: 0.581 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.891533374786377
Epoch: 45, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.613 Vali Acc: 0.867 Test Loss: 0.613 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.9661059379577637
Epoch: 46, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.590 Vali Acc: 0.850 Test Loss: 0.590 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.7879116535186768
Epoch: 47, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.587 Vali Acc: 0.889 Test Loss: 0.587 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.793731451034546
Epoch: 48, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.601 Vali Acc: 0.883 Test Loss: 0.601 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.927703857421875
Epoch: 49, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.574 Vali Acc: 0.894 Test Loss: 0.574 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894439).  Saving model ...
Epoch: 50 cost time: 1.7162439823150635
Epoch: 50, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.587 Vali Acc: 0.894 Test Loss: 0.587 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.6878788471221924
Epoch: 51, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.595 Vali Acc: 0.894 Test Loss: 0.595 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.8498632907867432
Epoch: 52, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.601 Vali Acc: 0.889 Test Loss: 0.601 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.9934453964233398
Epoch: 53, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.597 Vali Acc: 0.883 Test Loss: 0.597 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.7675275802612305
Epoch: 54, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.597 Vali Acc: 0.889 Test Loss: 0.597 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 2.021690845489502
Epoch: 55, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.606 Vali Acc: 0.894 Test Loss: 0.606 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.5437095165252686
Epoch: 56, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.609 Vali Acc: 0.889 Test Loss: 0.609 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.777017593383789
Epoch: 57, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.608 Vali Acc: 0.894 Test Loss: 0.608 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.7999927997589111
Epoch: 58, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.605 Vali Acc: 0.894 Test Loss: 0.605 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.8321888446807861
Epoch: 59, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.607 Vali Acc: 0.894 Test Loss: 0.607 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 3719743
model size : 16.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7711286544799805
Epoch: 1, Steps: 12 | Train Loss: 2.796 Vali Loss: 2.666 Vali Acc: 0.117 Test Loss: 2.666 Test Acc: 0.117
Validation loss decreased (inf --> -0.116640).  Saving model ...
Epoch: 2 cost time: 1.5028393268585205
Epoch: 2, Steps: 12 | Train Loss: 2.613 Vali Loss: 2.462 Vali Acc: 0.294 Test Loss: 2.462 Test Acc: 0.294
Validation loss decreased (-0.116640 --> -0.294420).  Saving model ...
Epoch: 3 cost time: 1.4458034038543701
Epoch: 3, Steps: 12 | Train Loss: 2.367 Vali Loss: 2.181 Vali Acc: 0.394 Test Loss: 2.181 Test Acc: 0.394
Validation loss decreased (-0.294420 --> -0.394423).  Saving model ...
Epoch: 4 cost time: 1.6279475688934326
Epoch: 4, Steps: 12 | Train Loss: 2.027 Vali Loss: 1.845 Vali Acc: 0.472 Test Loss: 1.845 Test Acc: 0.472
Validation loss decreased (-0.394423 --> -0.472204).  Saving model ...
Epoch: 5 cost time: 1.6805052757263184
Epoch: 5, Steps: 12 | Train Loss: 1.698 Vali Loss: 1.603 Vali Acc: 0.567 Test Loss: 1.603 Test Acc: 0.567
Validation loss decreased (-0.472204 --> -0.566651).  Saving model ...
Epoch: 6 cost time: 1.634056806564331
Epoch: 6, Steps: 12 | Train Loss: 1.452 Vali Loss: 1.423 Vali Acc: 0.622 Test Loss: 1.423 Test Acc: 0.622
Validation loss decreased (-0.566651 --> -0.622208).  Saving model ...
Epoch: 7 cost time: 1.8159849643707275
Epoch: 7, Steps: 12 | Train Loss: 1.214 Vali Loss: 1.283 Vali Acc: 0.622 Test Loss: 1.283 Test Acc: 0.622
Validation loss decreased (-0.622208 --> -0.622209).  Saving model ...
Epoch: 8 cost time: 1.6141364574432373
Epoch: 8, Steps: 12 | Train Loss: 0.985 Vali Loss: 1.074 Vali Acc: 0.689 Test Loss: 1.074 Test Acc: 0.689
Validation loss decreased (-0.622209 --> -0.688878).  Saving model ...
Epoch: 9 cost time: 1.6944642066955566
Epoch: 9, Steps: 12 | Train Loss: 0.908 Vali Loss: 0.976 Vali Acc: 0.683 Test Loss: 0.976 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.760744571685791
Epoch: 10, Steps: 12 | Train Loss: 0.746 Vali Loss: 0.910 Vali Acc: 0.744 Test Loss: 0.910 Test Acc: 0.744
Validation loss decreased (-0.688878 --> -0.744435).  Saving model ...
Epoch: 11 cost time: 1.9807119369506836
Epoch: 11, Steps: 12 | Train Loss: 0.609 Vali Loss: 0.755 Vali Acc: 0.772 Test Loss: 0.755 Test Acc: 0.772
Validation loss decreased (-0.744435 --> -0.772215).  Saving model ...
Epoch: 12 cost time: 1.7380707263946533
Epoch: 12, Steps: 12 | Train Loss: 0.495 Vali Loss: 0.691 Vali Acc: 0.817 Test Loss: 0.691 Test Acc: 0.817
Validation loss decreased (-0.772215 --> -0.816660).  Saving model ...
Epoch: 13 cost time: 1.8833942413330078
Epoch: 13, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.654 Vali Acc: 0.811 Test Loss: 0.654 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6386594772338867
Epoch: 14, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.585 Vali Acc: 0.833 Test Loss: 0.585 Test Acc: 0.833
Validation loss decreased (-0.816660 --> -0.833327).  Saving model ...
Epoch: 15 cost time: 1.620351791381836
Epoch: 15, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.555 Vali Acc: 0.828 Test Loss: 0.555 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.405529260635376
Epoch: 16, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.634 Vali Acc: 0.783 Test Loss: 0.634 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9567255973815918
Epoch: 17, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.526 Vali Acc: 0.839 Test Loss: 0.526 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838884).  Saving model ...
Epoch: 18 cost time: 1.667776346206665
Epoch: 18, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.574 Vali Acc: 0.844 Test Loss: 0.574 Test Acc: 0.844
Validation loss decreased (-0.838884 --> -0.844439).  Saving model ...
Epoch: 19 cost time: 1.7549293041229248
Epoch: 19, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.485 Vali Acc: 0.867 Test Loss: 0.485 Test Acc: 0.867
Validation loss decreased (-0.844439 --> -0.866662).  Saving model ...
Epoch: 20 cost time: 2.101036310195923
Epoch: 20, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.555 Vali Acc: 0.861 Test Loss: 0.555 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7910804748535156
Epoch: 21, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.440 Vali Acc: 0.867 Test Loss: 0.440 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 22 cost time: 1.7644298076629639
Epoch: 22, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.482 Vali Acc: 0.861 Test Loss: 0.482 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.112366199493408
Epoch: 23, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.532 Vali Acc: 0.867 Test Loss: 0.532 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.8056020736694336
Epoch: 24, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.453 Vali Acc: 0.856 Test Loss: 0.453 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.2491912841796875
Epoch: 25, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.544 Vali Acc: 0.883 Test Loss: 0.544 Test Acc: 0.883
Validation loss decreased (-0.866662 --> -0.883328).  Saving model ...
Epoch: 26 cost time: 1.9554266929626465
Epoch: 26, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.557 Vali Acc: 0.861 Test Loss: 0.557 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6347534656524658
Epoch: 27, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.523 Vali Acc: 0.878 Test Loss: 0.523 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5467209815979004
Epoch: 28, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.481 Vali Acc: 0.894 Test Loss: 0.481 Test Acc: 0.894
Validation loss decreased (-0.883328 --> -0.894440).  Saving model ...
Epoch: 29 cost time: 1.69693922996521
Epoch: 29, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.494 Vali Acc: 0.889 Test Loss: 0.494 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7674901485443115
Epoch: 30, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.526 Vali Acc: 0.872 Test Loss: 0.526 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.5628681182861328
Epoch: 31, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.563 Vali Acc: 0.861 Test Loss: 0.563 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.4842686653137207
Epoch: 32, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.642 Vali Acc: 0.861 Test Loss: 0.642 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.877912998199463
Epoch: 33, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.621 Vali Acc: 0.883 Test Loss: 0.621 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.6694257259368896
Epoch: 34, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.619 Vali Acc: 0.867 Test Loss: 0.619 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.6994531154632568
Epoch: 35, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.546 Vali Acc: 0.867 Test Loss: 0.546 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.720156192779541
Epoch: 36, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.645 Vali Acc: 0.867 Test Loss: 0.645 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.630472183227539
Epoch: 37, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.571 Vali Acc: 0.861 Test Loss: 0.571 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.560978651046753
Epoch: 38, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.525 Vali Acc: 0.894 Test Loss: 0.525 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 3718847
model size : 16.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.768206834793091
Epoch: 1, Steps: 12 | Train Loss: 2.838 Vali Loss: 2.644 Vali Acc: 0.144 Test Loss: 2.644 Test Acc: 0.144
Validation loss decreased (inf --> -0.144418).  Saving model ...
Epoch: 2 cost time: 1.776789903640747
Epoch: 2, Steps: 12 | Train Loss: 2.638 Vali Loss: 2.455 Vali Acc: 0.261 Test Loss: 2.455 Test Acc: 0.261
Validation loss decreased (-0.144418 --> -0.261087).  Saving model ...
Epoch: 3 cost time: 1.9322640895843506
Epoch: 3, Steps: 12 | Train Loss: 2.364 Vali Loss: 2.200 Vali Acc: 0.406 Test Loss: 2.200 Test Acc: 0.406
Validation loss decreased (-0.261087 --> -0.405534).  Saving model ...
Epoch: 4 cost time: 1.8141200542449951
Epoch: 4, Steps: 12 | Train Loss: 1.988 Vali Loss: 1.825 Vali Acc: 0.539 Test Loss: 1.825 Test Acc: 0.539
Validation loss decreased (-0.405534 --> -0.538871).  Saving model ...
Epoch: 5 cost time: 1.922541618347168
Epoch: 5, Steps: 12 | Train Loss: 1.568 Vali Loss: 1.577 Vali Acc: 0.567 Test Loss: 1.577 Test Acc: 0.567
Validation loss decreased (-0.538871 --> -0.566651).  Saving model ...
Epoch: 6 cost time: 2.0108721256256104
Epoch: 6, Steps: 12 | Train Loss: 1.318 Vali Loss: 1.386 Vali Acc: 0.644 Test Loss: 1.386 Test Acc: 0.644
Validation loss decreased (-0.566651 --> -0.644431).  Saving model ...
Epoch: 7 cost time: 2.2724549770355225
Epoch: 7, Steps: 12 | Train Loss: 1.173 Vali Loss: 1.196 Vali Acc: 0.689 Test Loss: 1.196 Test Acc: 0.689
Validation loss decreased (-0.644431 --> -0.688877).  Saving model ...
Epoch: 8 cost time: 1.6859676837921143
Epoch: 8, Steps: 12 | Train Loss: 0.971 Vali Loss: 1.061 Vali Acc: 0.717 Test Loss: 1.061 Test Acc: 0.717
Validation loss decreased (-0.688877 --> -0.716656).  Saving model ...
Epoch: 9 cost time: 1.9228641986846924
Epoch: 9, Steps: 12 | Train Loss: 0.848 Vali Loss: 1.006 Vali Acc: 0.761 Test Loss: 1.006 Test Acc: 0.761
Validation loss decreased (-0.716656 --> -0.761101).  Saving model ...
Epoch: 10 cost time: 2.0274252891540527
Epoch: 10, Steps: 12 | Train Loss: 0.698 Vali Loss: 0.909 Vali Acc: 0.778 Test Loss: 0.909 Test Acc: 0.778
Validation loss decreased (-0.761101 --> -0.777769).  Saving model ...
Epoch: 11 cost time: 1.667628288269043
Epoch: 11, Steps: 12 | Train Loss: 0.572 Vali Loss: 0.824 Vali Acc: 0.794 Test Loss: 0.824 Test Acc: 0.794
Validation loss decreased (-0.777769 --> -0.794436).  Saving model ...
Epoch: 12 cost time: 1.7838146686553955
Epoch: 12, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.743 Vali Acc: 0.839 Test Loss: 0.743 Test Acc: 0.839
Validation loss decreased (-0.794436 --> -0.838881).  Saving model ...
Epoch: 13 cost time: 1.6779656410217285
Epoch: 13, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.671 Vali Acc: 0.833 Test Loss: 0.671 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8087184429168701
Epoch: 14, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.622 Vali Acc: 0.850 Test Loss: 0.622 Test Acc: 0.850
Validation loss decreased (-0.838881 --> -0.849994).  Saving model ...
Epoch: 15 cost time: 1.7400274276733398
Epoch: 15, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.592 Vali Acc: 0.861 Test Loss: 0.592 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 16 cost time: 2.075127363204956
Epoch: 16, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.613 Vali Acc: 0.861 Test Loss: 0.613 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8739814758300781
Epoch: 17, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.557 Vali Acc: 0.856 Test Loss: 0.557 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8170678615570068
Epoch: 18, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.647 Vali Acc: 0.817 Test Loss: 0.647 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9419915676116943
Epoch: 19, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.576 Vali Acc: 0.867 Test Loss: 0.576 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 20 cost time: 1.8641808032989502
Epoch: 20, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.571 Vali Acc: 0.883 Test Loss: 0.571 Test Acc: 0.883
Validation loss decreased (-0.866661 --> -0.883328).  Saving model ...
Epoch: 21 cost time: 1.7695348262786865
Epoch: 21, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.533 Vali Acc: 0.883 Test Loss: 0.533 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883328).  Saving model ...
Epoch: 22 cost time: 1.8337175846099854
Epoch: 22, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.514 Vali Acc: 0.883 Test Loss: 0.514 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883328).  Saving model ...
Epoch: 23 cost time: 1.7040235996246338
Epoch: 23, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.555 Vali Acc: 0.889 Test Loss: 0.555 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888883).  Saving model ...
Epoch: 24 cost time: 1.6523716449737549
Epoch: 24, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.558 Vali Acc: 0.878 Test Loss: 0.558 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.134586811065674
Epoch: 25, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.580 Vali Acc: 0.861 Test Loss: 0.580 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.7629096508026123
Epoch: 26, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.661 Vali Acc: 0.872 Test Loss: 0.661 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.163261890411377
Epoch: 27, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.632 Vali Acc: 0.889 Test Loss: 0.632 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.7842586040496826
Epoch: 28, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.515 Vali Acc: 0.878 Test Loss: 0.515 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.135779619216919
Epoch: 29, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.546 Vali Acc: 0.872 Test Loss: 0.546 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.8949596881866455
Epoch: 30, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.715 Vali Acc: 0.850 Test Loss: 0.715 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.9002351760864258
Epoch: 31, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.607 Vali Acc: 0.883 Test Loss: 0.607 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.343852996826172
Epoch: 32, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.646 Vali Acc: 0.867 Test Loss: 0.646 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.9452614784240723
Epoch: 33, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.750 Vali Acc: 0.856 Test Loss: 0.750 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 3717951
model size : 16.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.076454162597656
Epoch: 1, Steps: 12 | Train Loss: 2.789 Vali Loss: 2.632 Vali Acc: 0.161 Test Loss: 2.632 Test Acc: 0.161
Validation loss decreased (inf --> -0.161085).  Saving model ...
Epoch: 2 cost time: 2.070834159851074
Epoch: 2, Steps: 12 | Train Loss: 2.528 Vali Loss: 2.379 Vali Acc: 0.411 Test Loss: 2.379 Test Acc: 0.411
Validation loss decreased (-0.161085 --> -0.411087).  Saving model ...
Epoch: 3 cost time: 1.6236505508422852
Epoch: 3, Steps: 12 | Train Loss: 2.255 Vali Loss: 2.041 Vali Acc: 0.528 Test Loss: 2.041 Test Acc: 0.528
Validation loss decreased (-0.411087 --> -0.527757).  Saving model ...
Epoch: 4 cost time: 1.7973673343658447
Epoch: 4, Steps: 12 | Train Loss: 1.916 Vali Loss: 1.718 Vali Acc: 0.556 Test Loss: 1.718 Test Acc: 0.556
Validation loss decreased (-0.527757 --> -0.555538).  Saving model ...
Epoch: 5 cost time: 1.8470561504364014
Epoch: 5, Steps: 12 | Train Loss: 1.533 Vali Loss: 1.489 Vali Acc: 0.594 Test Loss: 1.489 Test Acc: 0.594
Validation loss decreased (-0.555538 --> -0.594430).  Saving model ...
Epoch: 6 cost time: 1.804283857345581
Epoch: 6, Steps: 12 | Train Loss: 1.309 Vali Loss: 1.344 Vali Acc: 0.661 Test Loss: 1.344 Test Acc: 0.661
Validation loss decreased (-0.594430 --> -0.661098).  Saving model ...
Epoch: 7 cost time: 1.9113810062408447
Epoch: 7, Steps: 12 | Train Loss: 1.131 Vali Loss: 1.227 Vali Acc: 0.672 Test Loss: 1.227 Test Acc: 0.672
Validation loss decreased (-0.661098 --> -0.672210).  Saving model ...
Epoch: 8 cost time: 1.6600544452667236
Epoch: 8, Steps: 12 | Train Loss: 0.979 Vali Loss: 1.081 Vali Acc: 0.728 Test Loss: 1.081 Test Acc: 0.728
Validation loss decreased (-0.672210 --> -0.727767).  Saving model ...
Epoch: 9 cost time: 1.8191680908203125
Epoch: 9, Steps: 12 | Train Loss: 0.827 Vali Loss: 0.951 Vali Acc: 0.778 Test Loss: 0.951 Test Acc: 0.778
Validation loss decreased (-0.727767 --> -0.777768).  Saving model ...
Epoch: 10 cost time: 1.7966852188110352
Epoch: 10, Steps: 12 | Train Loss: 0.736 Vali Loss: 0.875 Vali Acc: 0.733 Test Loss: 0.875 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8969027996063232
Epoch: 11, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.786 Vali Acc: 0.800 Test Loss: 0.786 Test Acc: 0.800
Validation loss decreased (-0.777768 --> -0.799992).  Saving model ...
Epoch: 12 cost time: 1.602257251739502
Epoch: 12, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.697 Vali Acc: 0.833 Test Loss: 0.697 Test Acc: 0.833
Validation loss decreased (-0.799992 --> -0.833326).  Saving model ...
Epoch: 13 cost time: 1.562490463256836
Epoch: 13, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.714 Vali Acc: 0.850 Test Loss: 0.714 Test Acc: 0.850
Validation loss decreased (-0.833326 --> -0.849993).  Saving model ...
Epoch: 14 cost time: 1.974381923675537
Epoch: 14, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.641 Vali Acc: 0.828 Test Loss: 0.641 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6828033924102783
Epoch: 15, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.612 Vali Acc: 0.872 Test Loss: 0.612 Test Acc: 0.872
Validation loss decreased (-0.849993 --> -0.872216).  Saving model ...
Epoch: 16 cost time: 1.8952760696411133
Epoch: 16, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.562 Vali Acc: 0.856 Test Loss: 0.562 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7350881099700928
Epoch: 17, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.534 Vali Acc: 0.872 Test Loss: 0.534 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872217).  Saving model ...
Epoch: 18 cost time: 1.8606746196746826
Epoch: 18, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.510 Vali Acc: 0.878 Test Loss: 0.510 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 19 cost time: 1.6736280918121338
Epoch: 19, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.520 Vali Acc: 0.889 Test Loss: 0.520 Test Acc: 0.889
Validation loss decreased (-0.877773 --> -0.888884).  Saving model ...
Epoch: 20 cost time: 1.7247252464294434
Epoch: 20, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.535 Vali Acc: 0.867 Test Loss: 0.535 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8161065578460693
Epoch: 21, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.475 Vali Acc: 0.872 Test Loss: 0.475 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9601600170135498
Epoch: 22, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.542 Vali Acc: 0.889 Test Loss: 0.542 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.8379311561584473
Epoch: 23, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.537 Vali Acc: 0.867 Test Loss: 0.537 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.094860076904297
Epoch: 24, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.536 Vali Acc: 0.878 Test Loss: 0.536 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.0406346321105957
Epoch: 25, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.505 Vali Acc: 0.883 Test Loss: 0.505 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.6253955364227295
Epoch: 26, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.556 Vali Acc: 0.872 Test Loss: 0.556 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.5630862712860107
Epoch: 27, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.562 Vali Acc: 0.844 Test Loss: 0.562 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.5176286697387695
Epoch: 28, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.590 Vali Acc: 0.889 Test Loss: 0.590 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.5194764137268066
Epoch: 29, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.538 Vali Acc: 0.889 Test Loss: 0.538 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 3717055
model size : 16.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9719200134277344
Epoch: 1, Steps: 12 | Train Loss: 2.871 Vali Loss: 2.772 Vali Acc: 0.083 Test Loss: 2.772 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 1.7641403675079346
Epoch: 2, Steps: 12 | Train Loss: 2.677 Vali Loss: 2.602 Vali Acc: 0.200 Test Loss: 2.602 Test Acc: 0.200
Validation loss decreased (-0.083306 --> -0.199974).  Saving model ...
Epoch: 3 cost time: 1.6963565349578857
Epoch: 3, Steps: 12 | Train Loss: 2.523 Vali Loss: 2.361 Vali Acc: 0.317 Test Loss: 2.361 Test Acc: 0.317
Validation loss decreased (-0.199974 --> -0.316643).  Saving model ...
Epoch: 4 cost time: 1.586798906326294
Epoch: 4, Steps: 12 | Train Loss: 2.213 Vali Loss: 2.006 Vali Acc: 0.472 Test Loss: 2.006 Test Acc: 0.472
Validation loss decreased (-0.316643 --> -0.472202).  Saving model ...
Epoch: 5 cost time: 1.8969886302947998
Epoch: 5, Steps: 12 | Train Loss: 1.834 Vali Loss: 1.683 Vali Acc: 0.578 Test Loss: 1.683 Test Acc: 0.578
Validation loss decreased (-0.472202 --> -0.577761).  Saving model ...
Epoch: 6 cost time: 1.7196636199951172
Epoch: 6, Steps: 12 | Train Loss: 1.524 Vali Loss: 1.465 Vali Acc: 0.639 Test Loss: 1.465 Test Acc: 0.639
Validation loss decreased (-0.577761 --> -0.638874).  Saving model ...
Epoch: 7 cost time: 2.1369776725769043
Epoch: 7, Steps: 12 | Train Loss: 1.293 Vali Loss: 1.329 Vali Acc: 0.672 Test Loss: 1.329 Test Acc: 0.672
Validation loss decreased (-0.638874 --> -0.672209).  Saving model ...
Epoch: 8 cost time: 1.6860771179199219
Epoch: 8, Steps: 12 | Train Loss: 1.099 Vali Loss: 1.200 Vali Acc: 0.689 Test Loss: 1.200 Test Acc: 0.689
Validation loss decreased (-0.672209 --> -0.688877).  Saving model ...
Epoch: 9 cost time: 1.669703722000122
Epoch: 9, Steps: 12 | Train Loss: 0.998 Vali Loss: 1.121 Vali Acc: 0.672 Test Loss: 1.121 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8267786502838135
Epoch: 10, Steps: 12 | Train Loss: 0.887 Vali Loss: 1.076 Vali Acc: 0.683 Test Loss: 1.076 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9691874980926514
Epoch: 11, Steps: 12 | Train Loss: 0.754 Vali Loss: 0.918 Vali Acc: 0.750 Test Loss: 0.918 Test Acc: 0.750
Validation loss decreased (-0.688877 --> -0.749991).  Saving model ...
Epoch: 12 cost time: 1.821030855178833
Epoch: 12, Steps: 12 | Train Loss: 0.688 Vali Loss: 0.894 Vali Acc: 0.722 Test Loss: 0.894 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6970534324645996
Epoch: 13, Steps: 12 | Train Loss: 0.562 Vali Loss: 0.829 Vali Acc: 0.733 Test Loss: 0.829 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8646867275238037
Epoch: 14, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.694 Vali Acc: 0.817 Test Loss: 0.694 Test Acc: 0.817
Validation loss decreased (-0.749991 --> -0.816660).  Saving model ...
Epoch: 15 cost time: 1.6860768795013428
Epoch: 15, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.646 Vali Acc: 0.833 Test Loss: 0.646 Test Acc: 0.833
Validation loss decreased (-0.816660 --> -0.833327).  Saving model ...
Epoch: 16 cost time: 1.845376968383789
Epoch: 16, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.607 Vali Acc: 0.839 Test Loss: 0.607 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 17 cost time: 1.96791672706604
Epoch: 17, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.585 Vali Acc: 0.844 Test Loss: 0.585 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 18 cost time: 1.994767665863037
Epoch: 18, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.572 Vali Acc: 0.856 Test Loss: 0.572 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 19 cost time: 1.790980577468872
Epoch: 19, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.509 Vali Acc: 0.872 Test Loss: 0.509 Test Acc: 0.872
Validation loss decreased (-0.855550 --> -0.872217).  Saving model ...
Epoch: 20 cost time: 1.5436387062072754
Epoch: 20, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.529 Vali Acc: 0.856 Test Loss: 0.529 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6338555812835693
Epoch: 21, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.574 Vali Acc: 0.856 Test Loss: 0.574 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7522964477539062
Epoch: 22, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.509 Vali Acc: 0.867 Test Loss: 0.509 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7752292156219482
Epoch: 23, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.487 Vali Acc: 0.867 Test Loss: 0.487 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.9447152614593506
Epoch: 24, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.484 Vali Acc: 0.872 Test Loss: 0.484 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 25 cost time: 1.9431262016296387
Epoch: 25, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.522 Vali Acc: 0.883 Test Loss: 0.522 Test Acc: 0.883
Validation loss decreased (-0.872217 --> -0.883328).  Saving model ...
Epoch: 26 cost time: 1.7861723899841309
Epoch: 26, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.532 Vali Acc: 0.856 Test Loss: 0.532 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6155598163604736
Epoch: 27, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.518 Vali Acc: 0.900 Test Loss: 0.518 Test Acc: 0.900
Validation loss decreased (-0.883328 --> -0.899995).  Saving model ...
Epoch: 28 cost time: 1.4370017051696777
Epoch: 28, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.480 Vali Acc: 0.872 Test Loss: 0.480 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.648115873336792
Epoch: 29, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.578 Vali Acc: 0.894 Test Loss: 0.578 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.7071919441223145
Epoch: 30, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.510 Vali Acc: 0.889 Test Loss: 0.510 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.8239476680755615
Epoch: 31, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.558 Vali Acc: 0.889 Test Loss: 0.558 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.709268569946289
Epoch: 32, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.576 Vali Acc: 0.889 Test Loss: 0.576 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.6230707168579102
Epoch: 33, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.552 Vali Acc: 0.889 Test Loss: 0.552 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.8794474601745605
Epoch: 34, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.556 Vali Acc: 0.883 Test Loss: 0.556 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.666694164276123
Epoch: 35, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.567 Vali Acc: 0.900 Test Loss: 0.567 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.079218864440918
Epoch: 36, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.583 Vali Acc: 0.889 Test Loss: 0.583 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.6726667881011963
Epoch: 37, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.569 Vali Acc: 0.889 Test Loss: 0.569 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 2798655
model size : 13.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.5673744678497314
Epoch: 1, Steps: 12 | Train Loss: 2.842 Vali Loss: 2.667 Vali Acc: 0.128 Test Loss: 2.667 Test Acc: 0.128
Validation loss decreased (inf --> -0.127751).  Saving model ...
Epoch: 2 cost time: 1.8687069416046143
Epoch: 2, Steps: 12 | Train Loss: 2.606 Vali Loss: 2.478 Vali Acc: 0.250 Test Loss: 2.478 Test Acc: 0.250
Validation loss decreased (-0.127751 --> -0.249975).  Saving model ...
Epoch: 3 cost time: 2.036099672317505
Epoch: 3, Steps: 12 | Train Loss: 2.358 Vali Loss: 2.231 Vali Acc: 0.383 Test Loss: 2.231 Test Acc: 0.383
Validation loss decreased (-0.249975 --> -0.383311).  Saving model ...
Epoch: 4 cost time: 2.035860061645508
Epoch: 4, Steps: 12 | Train Loss: 2.020 Vali Loss: 1.915 Vali Acc: 0.511 Test Loss: 1.915 Test Acc: 0.511
Validation loss decreased (-0.383311 --> -0.511092).  Saving model ...
Epoch: 5 cost time: 1.7849128246307373
Epoch: 5, Steps: 12 | Train Loss: 1.718 Vali Loss: 1.681 Vali Acc: 0.511 Test Loss: 1.681 Test Acc: 0.511
Validation loss decreased (-0.511092 --> -0.511094).  Saving model ...
Epoch: 6 cost time: 2.0862631797790527
Epoch: 6, Steps: 12 | Train Loss: 1.489 Vali Loss: 1.487 Vali Acc: 0.556 Test Loss: 1.487 Test Acc: 0.556
Validation loss decreased (-0.511094 --> -0.555541).  Saving model ...
Epoch: 7 cost time: 2.0850393772125244
Epoch: 7, Steps: 12 | Train Loss: 1.312 Vali Loss: 1.321 Vali Acc: 0.678 Test Loss: 1.321 Test Acc: 0.678
Validation loss decreased (-0.555541 --> -0.677765).  Saving model ...
Epoch: 8 cost time: 2.257197380065918
Epoch: 8, Steps: 12 | Train Loss: 1.058 Vali Loss: 1.205 Vali Acc: 0.639 Test Loss: 1.205 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1182289123535156
Epoch: 9, Steps: 12 | Train Loss: 0.930 Vali Loss: 1.123 Vali Acc: 0.706 Test Loss: 1.123 Test Acc: 0.706
Validation loss decreased (-0.677765 --> -0.705544).  Saving model ...
Epoch: 10 cost time: 1.91218900680542
Epoch: 10, Steps: 12 | Train Loss: 0.816 Vali Loss: 0.982 Vali Acc: 0.739 Test Loss: 0.982 Test Acc: 0.739
Validation loss decreased (-0.705544 --> -0.738879).  Saving model ...
Epoch: 11 cost time: 2.1575851440429688
Epoch: 11, Steps: 12 | Train Loss: 0.765 Vali Loss: 0.897 Vali Acc: 0.761 Test Loss: 0.897 Test Acc: 0.761
Validation loss decreased (-0.738879 --> -0.761102).  Saving model ...
Epoch: 12 cost time: 1.9689922332763672
Epoch: 12, Steps: 12 | Train Loss: 0.627 Vali Loss: 0.807 Vali Acc: 0.783 Test Loss: 0.807 Test Acc: 0.783
Validation loss decreased (-0.761102 --> -0.783325).  Saving model ...
Epoch: 13 cost time: 2.4097204208374023
Epoch: 13, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.734 Vali Acc: 0.767 Test Loss: 0.734 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.166261672973633
Epoch: 14, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.700 Vali Acc: 0.811 Test Loss: 0.700 Test Acc: 0.811
Validation loss decreased (-0.783325 --> -0.811104).  Saving model ...
Epoch: 15 cost time: 1.9534671306610107
Epoch: 15, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.717 Vali Acc: 0.839 Test Loss: 0.717 Test Acc: 0.839
Validation loss decreased (-0.811104 --> -0.838882).  Saving model ...
Epoch: 16 cost time: 2.321904420852661
Epoch: 16, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.591 Vali Acc: 0.850 Test Loss: 0.591 Test Acc: 0.850
Validation loss decreased (-0.838882 --> -0.849994).  Saving model ...
Epoch: 17 cost time: 2.1380088329315186
Epoch: 17, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.570 Vali Acc: 0.856 Test Loss: 0.570 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 18 cost time: 2.0063765048980713
Epoch: 18, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.569 Vali Acc: 0.844 Test Loss: 0.569 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7117676734924316
Epoch: 19, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.594 Vali Acc: 0.844 Test Loss: 0.594 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.964510440826416
Epoch: 20, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.540 Vali Acc: 0.856 Test Loss: 0.540 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 21 cost time: 1.9581737518310547
Epoch: 21, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.593 Vali Acc: 0.867 Test Loss: 0.593 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 22 cost time: 1.5993804931640625
Epoch: 22, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.593 Vali Acc: 0.867 Test Loss: 0.593 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9502038955688477
Epoch: 23, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.673 Vali Acc: 0.844 Test Loss: 0.673 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.939427375793457
Epoch: 24, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.623 Vali Acc: 0.844 Test Loss: 0.623 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.7598466873168945
Epoch: 25, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.577 Vali Acc: 0.894 Test Loss: 0.577 Test Acc: 0.894
Validation loss decreased (-0.866661 --> -0.894439).  Saving model ...
Epoch: 26 cost time: 1.8493447303771973
Epoch: 26, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.560 Vali Acc: 0.878 Test Loss: 0.560 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8545684814453125
Epoch: 27, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.599 Vali Acc: 0.856 Test Loss: 0.599 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8603434562683105
Epoch: 28, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.617 Vali Acc: 0.850 Test Loss: 0.617 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.9646673202514648
Epoch: 29, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.665 Vali Acc: 0.861 Test Loss: 0.665 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.9762744903564453
Epoch: 30, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.651 Vali Acc: 0.844 Test Loss: 0.651 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.0816609859466553
Epoch: 31, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.659 Vali Acc: 0.867 Test Loss: 0.659 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.1779441833496094
Epoch: 32, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.668 Vali Acc: 0.867 Test Loss: 0.668 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.8026468753814697
Epoch: 33, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.685 Vali Acc: 0.833 Test Loss: 0.685 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.2824928760528564
Epoch: 34, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.653 Vali Acc: 0.872 Test Loss: 0.653 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.8433561325073242
Epoch: 35, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.582 Vali Acc: 0.878 Test Loss: 0.582 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 2797759
model size : 13.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.152798414230347
Epoch: 1, Steps: 12 | Train Loss: 2.724 Vali Loss: 2.625 Vali Acc: 0.122 Test Loss: 2.625 Test Acc: 0.122
Validation loss decreased (inf --> -0.122196).  Saving model ...
Epoch: 2 cost time: 2.0555784702301025
Epoch: 2, Steps: 12 | Train Loss: 2.600 Vali Loss: 2.437 Vali Acc: 0.294 Test Loss: 2.437 Test Acc: 0.294
Validation loss decreased (-0.122196 --> -0.294420).  Saving model ...
Epoch: 3 cost time: 2.2385222911834717
Epoch: 3, Steps: 12 | Train Loss: 2.306 Vali Loss: 2.160 Vali Acc: 0.394 Test Loss: 2.160 Test Acc: 0.394
Validation loss decreased (-0.294420 --> -0.394423).  Saving model ...
Epoch: 4 cost time: 1.8470897674560547
Epoch: 4, Steps: 12 | Train Loss: 2.035 Vali Loss: 1.857 Vali Acc: 0.500 Test Loss: 1.857 Test Acc: 0.500
Validation loss decreased (-0.394423 --> -0.499981).  Saving model ...
Epoch: 5 cost time: 1.6671125888824463
Epoch: 5, Steps: 12 | Train Loss: 1.703 Vali Loss: 1.621 Vali Acc: 0.572 Test Loss: 1.621 Test Acc: 0.572
Validation loss decreased (-0.499981 --> -0.572206).  Saving model ...
Epoch: 6 cost time: 2.0734543800354004
Epoch: 6, Steps: 12 | Train Loss: 1.489 Vali Loss: 1.420 Vali Acc: 0.611 Test Loss: 1.420 Test Acc: 0.611
Validation loss decreased (-0.572206 --> -0.611097).  Saving model ...
Epoch: 7 cost time: 1.7940585613250732
Epoch: 7, Steps: 12 | Train Loss: 1.270 Vali Loss: 1.281 Vali Acc: 0.694 Test Loss: 1.281 Test Acc: 0.694
Validation loss decreased (-0.611097 --> -0.694432).  Saving model ...
Epoch: 8 cost time: 2.151087999343872
Epoch: 8, Steps: 12 | Train Loss: 1.093 Vali Loss: 1.158 Vali Acc: 0.717 Test Loss: 1.158 Test Acc: 0.717
Validation loss decreased (-0.694432 --> -0.716655).  Saving model ...
Epoch: 9 cost time: 2.2038495540618896
Epoch: 9, Steps: 12 | Train Loss: 0.989 Vali Loss: 1.114 Vali Acc: 0.678 Test Loss: 1.114 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8386263847351074
Epoch: 10, Steps: 12 | Train Loss: 0.842 Vali Loss: 1.070 Vali Acc: 0.733 Test Loss: 1.070 Test Acc: 0.733
Validation loss decreased (-0.716655 --> -0.733323).  Saving model ...
Epoch: 11 cost time: 1.7726306915283203
Epoch: 11, Steps: 12 | Train Loss: 0.802 Vali Loss: 0.877 Vali Acc: 0.717 Test Loss: 0.877 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5657601356506348
Epoch: 12, Steps: 12 | Train Loss: 0.679 Vali Loss: 0.891 Vali Acc: 0.767 Test Loss: 0.891 Test Acc: 0.767
Validation loss decreased (-0.733323 --> -0.766658).  Saving model ...
Epoch: 13 cost time: 1.627112627029419
Epoch: 13, Steps: 12 | Train Loss: 0.584 Vali Loss: 0.698 Vali Acc: 0.800 Test Loss: 0.698 Test Acc: 0.800
Validation loss decreased (-0.766658 --> -0.799993).  Saving model ...
Epoch: 14 cost time: 1.9548556804656982
Epoch: 14, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.721 Vali Acc: 0.806 Test Loss: 0.721 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805548).  Saving model ...
Epoch: 15 cost time: 1.8705968856811523
Epoch: 15, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.642 Vali Acc: 0.800 Test Loss: 0.642 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.658644437789917
Epoch: 16, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.637 Vali Acc: 0.828 Test Loss: 0.637 Test Acc: 0.828
Validation loss decreased (-0.805548 --> -0.827771).  Saving model ...
Epoch: 17 cost time: 1.7807457447052002
Epoch: 17, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.582 Vali Acc: 0.844 Test Loss: 0.582 Test Acc: 0.844
Validation loss decreased (-0.827771 --> -0.844439).  Saving model ...
Epoch: 18 cost time: 2.129739284515381
Epoch: 18, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.592 Vali Acc: 0.850 Test Loss: 0.592 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849994).  Saving model ...
Epoch: 19 cost time: 2.0841712951660156
Epoch: 19, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.565 Vali Acc: 0.867 Test Loss: 0.565 Test Acc: 0.867
Validation loss decreased (-0.849994 --> -0.866661).  Saving model ...
Epoch: 20 cost time: 1.8567125797271729
Epoch: 20, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.626 Vali Acc: 0.828 Test Loss: 0.626 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.787548542022705
Epoch: 21, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.585 Vali Acc: 0.867 Test Loss: 0.585 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9809355735778809
Epoch: 22, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.537 Vali Acc: 0.856 Test Loss: 0.537 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.6601033210754395
Epoch: 23, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.671 Vali Acc: 0.850 Test Loss: 0.671 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.893486499786377
Epoch: 24, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.606 Vali Acc: 0.867 Test Loss: 0.606 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.062803030014038
Epoch: 25, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.595 Vali Acc: 0.872 Test Loss: 0.595 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 26 cost time: 1.56624436378479
Epoch: 26, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.599 Vali Acc: 0.861 Test Loss: 0.599 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.2224724292755127
Epoch: 27, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.641 Vali Acc: 0.861 Test Loss: 0.641 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.7265632152557373
Epoch: 28, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.621 Vali Acc: 0.856 Test Loss: 0.621 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.7688453197479248
Epoch: 29, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.599 Vali Acc: 0.856 Test Loss: 0.599 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.024752140045166
Epoch: 30, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.640 Vali Acc: 0.872 Test Loss: 0.640 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.0364575386047363
Epoch: 31, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.553 Vali Acc: 0.861 Test Loss: 0.553 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.9703772068023682
Epoch: 32, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.676 Vali Acc: 0.872 Test Loss: 0.676 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.464350461959839
Epoch: 33, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.610 Vali Acc: 0.872 Test Loss: 0.610 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.95100998878479
Epoch: 34, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.770 Vali Acc: 0.856 Test Loss: 0.770 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.7519323825836182
Epoch: 35, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.622 Vali Acc: 0.872 Test Loss: 0.622 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 2796863
model size : 13.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5453336238861084
Epoch: 1, Steps: 12 | Train Loss: 2.808 Vali Loss: 2.670 Vali Acc: 0.089 Test Loss: 2.670 Test Acc: 0.089
Validation loss decreased (inf --> -0.088862).  Saving model ...
Epoch: 2 cost time: 1.6723127365112305
Epoch: 2, Steps: 12 | Train Loss: 2.595 Vali Loss: 2.489 Vali Acc: 0.267 Test Loss: 2.489 Test Acc: 0.267
Validation loss decreased (-0.088862 --> -0.266642).  Saving model ...
Epoch: 3 cost time: 2.081876277923584
Epoch: 3, Steps: 12 | Train Loss: 2.390 Vali Loss: 2.243 Vali Acc: 0.450 Test Loss: 2.243 Test Acc: 0.450
Validation loss decreased (-0.266642 --> -0.449978).  Saving model ...
Epoch: 4 cost time: 1.5718114376068115
Epoch: 4, Steps: 12 | Train Loss: 2.010 Vali Loss: 1.914 Vali Acc: 0.517 Test Loss: 1.914 Test Acc: 0.517
Validation loss decreased (-0.449978 --> -0.516648).  Saving model ...
Epoch: 5 cost time: 1.569352149963379
Epoch: 5, Steps: 12 | Train Loss: 1.718 Vali Loss: 1.676 Vali Acc: 0.561 Test Loss: 1.676 Test Acc: 0.561
Validation loss decreased (-0.516648 --> -0.561094).  Saving model ...
Epoch: 6 cost time: 1.5053119659423828
Epoch: 6, Steps: 12 | Train Loss: 1.443 Vali Loss: 1.496 Vali Acc: 0.606 Test Loss: 1.496 Test Acc: 0.606
Validation loss decreased (-0.561094 --> -0.605541).  Saving model ...
Epoch: 7 cost time: 1.693202257156372
Epoch: 7, Steps: 12 | Train Loss: 1.257 Vali Loss: 1.331 Vali Acc: 0.628 Test Loss: 1.331 Test Acc: 0.628
Validation loss decreased (-0.605541 --> -0.627764).  Saving model ...
Epoch: 8 cost time: 1.734149694442749
Epoch: 8, Steps: 12 | Train Loss: 1.098 Vali Loss: 1.156 Vali Acc: 0.706 Test Loss: 1.156 Test Acc: 0.706
Validation loss decreased (-0.627764 --> -0.705544).  Saving model ...
Epoch: 9 cost time: 1.4495127201080322
Epoch: 9, Steps: 12 | Train Loss: 0.936 Vali Loss: 1.039 Vali Acc: 0.700 Test Loss: 1.039 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.540374517440796
Epoch: 10, Steps: 12 | Train Loss: 0.824 Vali Loss: 1.005 Vali Acc: 0.733 Test Loss: 1.005 Test Acc: 0.733
Validation loss decreased (-0.705544 --> -0.733323).  Saving model ...
Epoch: 11 cost time: 1.4978060722351074
Epoch: 11, Steps: 12 | Train Loss: 0.701 Vali Loss: 0.971 Vali Acc: 0.750 Test Loss: 0.971 Test Acc: 0.750
Validation loss decreased (-0.733323 --> -0.749990).  Saving model ...
Epoch: 12 cost time: 1.5468769073486328
Epoch: 12, Steps: 12 | Train Loss: 0.648 Vali Loss: 0.807 Vali Acc: 0.783 Test Loss: 0.807 Test Acc: 0.783
Validation loss decreased (-0.749990 --> -0.783325).  Saving model ...
Epoch: 13 cost time: 1.6650159358978271
Epoch: 13, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.786 Vali Acc: 0.772 Test Loss: 0.786 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.012847661972046
Epoch: 14, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.680 Vali Acc: 0.822 Test Loss: 0.680 Test Acc: 0.822
Validation loss decreased (-0.783325 --> -0.822215).  Saving model ...
Epoch: 15 cost time: 1.573077917098999
Epoch: 15, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.683 Vali Acc: 0.839 Test Loss: 0.683 Test Acc: 0.839
Validation loss decreased (-0.822215 --> -0.838882).  Saving model ...
Epoch: 16 cost time: 1.5927550792694092
Epoch: 16, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.605 Vali Acc: 0.844 Test Loss: 0.605 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 17 cost time: 1.9547970294952393
Epoch: 17, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.606 Vali Acc: 0.867 Test Loss: 0.606 Test Acc: 0.867
Validation loss decreased (-0.844438 --> -0.866661).  Saving model ...
Epoch: 18 cost time: 1.7564847469329834
Epoch: 18, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.570 Vali Acc: 0.867 Test Loss: 0.570 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 19 cost time: 1.9198975563049316
Epoch: 19, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.527 Vali Acc: 0.861 Test Loss: 0.527 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7265222072601318
Epoch: 20, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.514 Vali Acc: 0.878 Test Loss: 0.514 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877773).  Saving model ...
Epoch: 21 cost time: 1.7753019332885742
Epoch: 21, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.530 Vali Acc: 0.867 Test Loss: 0.530 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7685186862945557
Epoch: 22, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.493 Vali Acc: 0.883 Test Loss: 0.493 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883328).  Saving model ...
Epoch: 23 cost time: 1.7093312740325928
Epoch: 23, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.596 Vali Acc: 0.856 Test Loss: 0.596 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7022061347961426
Epoch: 24, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.534 Vali Acc: 0.872 Test Loss: 0.534 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.8713324069976807
Epoch: 25, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.583 Vali Acc: 0.856 Test Loss: 0.583 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.7246885299682617
Epoch: 26, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.577 Vali Acc: 0.867 Test Loss: 0.577 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.8685643672943115
Epoch: 27, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.563 Vali Acc: 0.878 Test Loss: 0.563 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.723557472229004
Epoch: 28, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.584 Vali Acc: 0.867 Test Loss: 0.584 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.7940928936004639
Epoch: 29, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.538 Vali Acc: 0.861 Test Loss: 0.538 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.7081990242004395
Epoch: 30, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.660 Vali Acc: 0.861 Test Loss: 0.660 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.1257553100585938
Epoch: 31, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.654 Vali Acc: 0.850 Test Loss: 0.654 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.7573599815368652
Epoch: 32, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.618 Vali Acc: 0.856 Test Loss: 0.618 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 2795967
model size : 13.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7354111671447754
Epoch: 1, Steps: 12 | Train Loss: 2.836 Vali Loss: 2.655 Vali Acc: 0.156 Test Loss: 2.655 Test Acc: 0.156
Validation loss decreased (inf --> -0.155529).  Saving model ...
Epoch: 2 cost time: 1.9475126266479492
Epoch: 2, Steps: 12 | Train Loss: 2.665 Vali Loss: 2.534 Vali Acc: 0.283 Test Loss: 2.534 Test Acc: 0.283
Validation loss decreased (-0.155529 --> -0.283308).  Saving model ...
Epoch: 3 cost time: 1.581390380859375
Epoch: 3, Steps: 12 | Train Loss: 2.451 Vali Loss: 2.317 Vali Acc: 0.378 Test Loss: 2.317 Test Acc: 0.378
Validation loss decreased (-0.283308 --> -0.377755).  Saving model ...
Epoch: 4 cost time: 1.6596896648406982
Epoch: 4, Steps: 12 | Train Loss: 2.171 Vali Loss: 2.029 Vali Acc: 0.467 Test Loss: 2.029 Test Acc: 0.467
Validation loss decreased (-0.377755 --> -0.466646).  Saving model ...
Epoch: 5 cost time: 1.5156352519989014
Epoch: 5, Steps: 12 | Train Loss: 1.857 Vali Loss: 1.783 Vali Acc: 0.522 Test Loss: 1.783 Test Acc: 0.522
Validation loss decreased (-0.466646 --> -0.522204).  Saving model ...
Epoch: 6 cost time: 1.6090588569641113
Epoch: 6, Steps: 12 | Train Loss: 1.597 Vali Loss: 1.563 Vali Acc: 0.583 Test Loss: 1.563 Test Acc: 0.583
Validation loss decreased (-0.522204 --> -0.583318).  Saving model ...
Epoch: 7 cost time: 1.9041805267333984
Epoch: 7, Steps: 12 | Train Loss: 1.382 Vali Loss: 1.423 Vali Acc: 0.639 Test Loss: 1.423 Test Acc: 0.639
Validation loss decreased (-0.583318 --> -0.638875).  Saving model ...
Epoch: 8 cost time: 1.8492791652679443
Epoch: 8, Steps: 12 | Train Loss: 1.263 Vali Loss: 1.311 Vali Acc: 0.633 Test Loss: 1.311 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9717504978179932
Epoch: 9, Steps: 12 | Train Loss: 1.097 Vali Loss: 1.200 Vali Acc: 0.711 Test Loss: 1.200 Test Acc: 0.711
Validation loss decreased (-0.638875 --> -0.711099).  Saving model ...
Epoch: 10 cost time: 1.6270763874053955
Epoch: 10, Steps: 12 | Train Loss: 0.947 Vali Loss: 1.112 Vali Acc: 0.722 Test Loss: 1.112 Test Acc: 0.722
Validation loss decreased (-0.711099 --> -0.722211).  Saving model ...
Epoch: 11 cost time: 1.5897717475891113
Epoch: 11, Steps: 12 | Train Loss: 0.871 Vali Loss: 1.004 Vali Acc: 0.739 Test Loss: 1.004 Test Acc: 0.739
Validation loss decreased (-0.722211 --> -0.738879).  Saving model ...
Epoch: 12 cost time: 1.5045781135559082
Epoch: 12, Steps: 12 | Train Loss: 0.791 Vali Loss: 0.923 Vali Acc: 0.756 Test Loss: 0.923 Test Acc: 0.756
Validation loss decreased (-0.738879 --> -0.755546).  Saving model ...
Epoch: 13 cost time: 1.6096220016479492
Epoch: 13, Steps: 12 | Train Loss: 0.742 Vali Loss: 0.831 Vali Acc: 0.772 Test Loss: 0.831 Test Acc: 0.772
Validation loss decreased (-0.755546 --> -0.772214).  Saving model ...
Epoch: 14 cost time: 1.506974220275879
Epoch: 14, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.797 Vali Acc: 0.822 Test Loss: 0.797 Test Acc: 0.822
Validation loss decreased (-0.772214 --> -0.822214).  Saving model ...
Epoch: 15 cost time: 1.53065824508667
Epoch: 15, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.730 Vali Acc: 0.806 Test Loss: 0.730 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.754805326461792
Epoch: 16, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.657 Vali Acc: 0.856 Test Loss: 0.657 Test Acc: 0.856
Validation loss decreased (-0.822214 --> -0.855549).  Saving model ...
Epoch: 17 cost time: 1.6572661399841309
Epoch: 17, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.686 Vali Acc: 0.828 Test Loss: 0.686 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8800101280212402
Epoch: 18, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.623 Vali Acc: 0.822 Test Loss: 0.623 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7161986827850342
Epoch: 19, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.635 Vali Acc: 0.833 Test Loss: 0.635 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.041593313217163
Epoch: 20, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.535 Vali Acc: 0.867 Test Loss: 0.535 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866661).  Saving model ...
Epoch: 21 cost time: 1.8727006912231445
Epoch: 21, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.499 Vali Acc: 0.861 Test Loss: 0.499 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9928045272827148
Epoch: 22, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.492 Vali Acc: 0.861 Test Loss: 0.492 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7196333408355713
Epoch: 23, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.496 Vali Acc: 0.850 Test Loss: 0.496 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.6125266551971436
Epoch: 24, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.608 Vali Acc: 0.833 Test Loss: 0.608 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.909956932067871
Epoch: 25, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.502 Vali Acc: 0.844 Test Loss: 0.502 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.8013875484466553
Epoch: 26, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.518 Vali Acc: 0.867 Test Loss: 0.518 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 27 cost time: 1.9918227195739746
Epoch: 27, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.511 Vali Acc: 0.878 Test Loss: 0.511 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877773).  Saving model ...
Epoch: 28 cost time: 1.8356587886810303
Epoch: 28, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.477 Vali Acc: 0.883 Test Loss: 0.477 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883329).  Saving model ...
Epoch: 29 cost time: 1.912571907043457
Epoch: 29, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.469 Vali Acc: 0.878 Test Loss: 0.469 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.6430327892303467
Epoch: 30, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.470 Vali Acc: 0.889 Test Loss: 0.470 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888884).  Saving model ...
Epoch: 31 cost time: 1.7768113613128662
Epoch: 31, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.508 Vali Acc: 0.872 Test Loss: 0.508 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.6529309749603271
Epoch: 32, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.509 Vali Acc: 0.867 Test Loss: 0.509 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.8837919235229492
Epoch: 33, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.498 Vali Acc: 0.867 Test Loss: 0.498 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.6782197952270508
Epoch: 34, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.594 Vali Acc: 0.856 Test Loss: 0.594 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.7769341468811035
Epoch: 35, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.490 Vali Acc: 0.889 Test Loss: 0.490 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.759199857711792
Epoch: 36, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.564 Vali Acc: 0.883 Test Loss: 0.564 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.7928848266601562
Epoch: 37, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.467 Vali Acc: 0.894 Test Loss: 0.467 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894440).  Saving model ...
Epoch: 38 cost time: 1.6675670146942139
Epoch: 38, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.468 Vali Acc: 0.900 Test Loss: 0.468 Test Acc: 0.900
Validation loss decreased (-0.894440 --> -0.899995).  Saving model ...
Epoch: 39 cost time: 1.8903329372406006
Epoch: 39, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.518 Vali Acc: 0.900 Test Loss: 0.518 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.635305643081665
Epoch: 40, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.525 Vali Acc: 0.900 Test Loss: 0.525 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.771730899810791
Epoch: 41, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.529 Vali Acc: 0.900 Test Loss: 0.529 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.9060380458831787
Epoch: 42, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.527 Vali Acc: 0.889 Test Loss: 0.527 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.7380335330963135
Epoch: 43, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.519 Vali Acc: 0.889 Test Loss: 0.519 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 2.1108133792877197
Epoch: 44, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.527 Vali Acc: 0.883 Test Loss: 0.527 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.9760477542877197
Epoch: 45, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.558 Vali Acc: 0.889 Test Loss: 0.558 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.7993440628051758
Epoch: 46, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.545 Vali Acc: 0.889 Test Loss: 0.545 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.650686502456665
Epoch: 47, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.546 Vali Acc: 0.894 Test Loss: 0.546 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.8188469409942627
Epoch: 48, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.554 Vali Acc: 0.889 Test Loss: 0.554 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 2338111
model size : 11.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.048293590545654
Epoch: 1, Steps: 12 | Train Loss: 2.791 Vali Loss: 2.689 Vali Acc: 0.144 Test Loss: 2.689 Test Acc: 0.144
Validation loss decreased (inf --> -0.144418).  Saving model ...
Epoch: 2 cost time: 2.177708864212036
Epoch: 2, Steps: 12 | Train Loss: 2.674 Vali Loss: 2.536 Vali Acc: 0.211 Test Loss: 2.536 Test Acc: 0.211
Validation loss decreased (-0.144418 --> -0.211086).  Saving model ...
Epoch: 3 cost time: 1.9678566455841064
Epoch: 3, Steps: 12 | Train Loss: 2.498 Vali Loss: 2.337 Vali Acc: 0.383 Test Loss: 2.337 Test Acc: 0.383
Validation loss decreased (-0.211086 --> -0.383310).  Saving model ...
Epoch: 4 cost time: 1.9104900360107422
Epoch: 4, Steps: 12 | Train Loss: 2.198 Vali Loss: 2.096 Vali Acc: 0.467 Test Loss: 2.096 Test Acc: 0.467
Validation loss decreased (-0.383310 --> -0.466646).  Saving model ...
Epoch: 5 cost time: 2.0414185523986816
Epoch: 5, Steps: 12 | Train Loss: 1.848 Vali Loss: 1.777 Vali Acc: 0.528 Test Loss: 1.777 Test Acc: 0.528
Validation loss decreased (-0.466646 --> -0.527760).  Saving model ...
Epoch: 6 cost time: 1.7580139636993408
Epoch: 6, Steps: 12 | Train Loss: 1.650 Vali Loss: 1.561 Vali Acc: 0.594 Test Loss: 1.561 Test Acc: 0.594
Validation loss decreased (-0.527760 --> -0.594429).  Saving model ...
Epoch: 7 cost time: 1.9800634384155273
Epoch: 7, Steps: 12 | Train Loss: 1.349 Vali Loss: 1.417 Vali Acc: 0.633 Test Loss: 1.417 Test Acc: 0.633
Validation loss decreased (-0.594429 --> -0.633319).  Saving model ...
Epoch: 8 cost time: 2.0703649520874023
Epoch: 8, Steps: 12 | Train Loss: 1.216 Vali Loss: 1.277 Vali Acc: 0.644 Test Loss: 1.277 Test Acc: 0.644
Validation loss decreased (-0.633319 --> -0.644432).  Saving model ...
Epoch: 9 cost time: 1.8496081829071045
Epoch: 9, Steps: 12 | Train Loss: 1.092 Vali Loss: 1.186 Vali Acc: 0.683 Test Loss: 1.186 Test Acc: 0.683
Validation loss decreased (-0.644432 --> -0.683321).  Saving model ...
Epoch: 10 cost time: 1.8869493007659912
Epoch: 10, Steps: 12 | Train Loss: 0.929 Vali Loss: 1.022 Vali Acc: 0.739 Test Loss: 1.022 Test Acc: 0.739
Validation loss decreased (-0.683321 --> -0.738879).  Saving model ...
Epoch: 11 cost time: 1.7144818305969238
Epoch: 11, Steps: 12 | Train Loss: 0.785 Vali Loss: 1.021 Vali Acc: 0.700 Test Loss: 1.021 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.047147035598755
Epoch: 12, Steps: 12 | Train Loss: 0.710 Vali Loss: 0.921 Vali Acc: 0.761 Test Loss: 0.921 Test Acc: 0.761
Validation loss decreased (-0.738879 --> -0.761102).  Saving model ...
Epoch: 13 cost time: 2.3349649906158447
Epoch: 13, Steps: 12 | Train Loss: 0.695 Vali Loss: 0.878 Vali Acc: 0.744 Test Loss: 0.878 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9449820518493652
Epoch: 14, Steps: 12 | Train Loss: 0.655 Vali Loss: 0.827 Vali Acc: 0.772 Test Loss: 0.827 Test Acc: 0.772
Validation loss decreased (-0.761102 --> -0.772214).  Saving model ...
Epoch: 15 cost time: 1.5780854225158691
Epoch: 15, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.737 Vali Acc: 0.794 Test Loss: 0.737 Test Acc: 0.794
Validation loss decreased (-0.772214 --> -0.794437).  Saving model ...
Epoch: 16 cost time: 1.7931818962097168
Epoch: 16, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.738 Vali Acc: 0.833 Test Loss: 0.738 Test Acc: 0.833
Validation loss decreased (-0.794437 --> -0.833326).  Saving model ...
Epoch: 17 cost time: 2.1374077796936035
Epoch: 17, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.653 Vali Acc: 0.811 Test Loss: 0.653 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8301887512207031
Epoch: 18, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.611 Vali Acc: 0.856 Test Loss: 0.611 Test Acc: 0.856
Validation loss decreased (-0.833326 --> -0.855549).  Saving model ...
Epoch: 19 cost time: 1.890650749206543
Epoch: 19, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.548 Vali Acc: 0.861 Test Loss: 0.548 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861106).  Saving model ...
Epoch: 20 cost time: 1.9290599822998047
Epoch: 20, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.577 Vali Acc: 0.844 Test Loss: 0.577 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9808356761932373
Epoch: 21, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.549 Vali Acc: 0.856 Test Loss: 0.549 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.0460822582244873
Epoch: 22, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.552 Vali Acc: 0.856 Test Loss: 0.552 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.177942991256714
Epoch: 23, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.620 Vali Acc: 0.861 Test Loss: 0.620 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.9238848686218262
Epoch: 24, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.9783530235290527
Epoch: 25, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.574 Vali Acc: 0.856 Test Loss: 0.574 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.440396785736084
Epoch: 26, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.543 Vali Acc: 0.861 Test Loss: 0.543 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 27 cost time: 1.9796969890594482
Epoch: 27, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.575 Vali Acc: 0.850 Test Loss: 0.575 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.00618839263916
Epoch: 28, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.564 Vali Acc: 0.878 Test Loss: 0.564 Test Acc: 0.878
Validation loss decreased (-0.861106 --> -0.877772).  Saving model ...
Epoch: 29 cost time: 1.992478370666504
Epoch: 29, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.547 Vali Acc: 0.856 Test Loss: 0.547 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.045205593109131
Epoch: 30, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.632 Vali Acc: 0.844 Test Loss: 0.632 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.7908689975738525
Epoch: 31, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.768 Vali Acc: 0.822 Test Loss: 0.768 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.7477922439575195
Epoch: 32, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.644 Vali Acc: 0.844 Test Loss: 0.644 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.9220216274261475
Epoch: 33, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.695 Vali Acc: 0.867 Test Loss: 0.695 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.059417486190796
Epoch: 34, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.527 Vali Acc: 0.878 Test Loss: 0.527 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877773).  Saving model ...
Epoch: 35 cost time: 1.9982669353485107
Epoch: 35, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.544 Vali Acc: 0.861 Test Loss: 0.544 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.473400354385376
Epoch: 36, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.718 Vali Acc: 0.850 Test Loss: 0.718 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.9455687999725342
Epoch: 37, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.497 Vali Acc: 0.867 Test Loss: 0.497 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.9102494716644287
Epoch: 38, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.549 Vali Acc: 0.856 Test Loss: 0.549 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.9694344997406006
Epoch: 39, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.608 Vali Acc: 0.872 Test Loss: 0.608 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.107609272003174
Epoch: 40, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.606 Vali Acc: 0.878 Test Loss: 0.606 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.153938055038452
Epoch: 41, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.558 Vali Acc: 0.889 Test Loss: 0.558 Test Acc: 0.889
Validation loss decreased (-0.877773 --> -0.888883).  Saving model ...
Epoch: 42 cost time: 1.8992433547973633
Epoch: 42, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.542 Vali Acc: 0.889 Test Loss: 0.542 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888883).  Saving model ...
Epoch: 43 cost time: 2.006304979324341
Epoch: 43, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.557 Vali Acc: 0.889 Test Loss: 0.557 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.8023412227630615
Epoch: 44, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.580 Vali Acc: 0.894 Test Loss: 0.580 Test Acc: 0.894
Validation loss decreased (-0.888883 --> -0.894439).  Saving model ...
Epoch: 45 cost time: 1.717268466949463
Epoch: 45, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.589 Vali Acc: 0.900 Test Loss: 0.589 Test Acc: 0.900
Validation loss decreased (-0.894439 --> -0.899994).  Saving model ...
Epoch: 46 cost time: 1.9844434261322021
Epoch: 46, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.589 Vali Acc: 0.900 Test Loss: 0.589 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 47 cost time: 2.1259257793426514
Epoch: 47, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.593 Vali Acc: 0.889 Test Loss: 0.593 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.8386547565460205
Epoch: 48, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.602 Vali Acc: 0.889 Test Loss: 0.602 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.7730717658996582
Epoch: 49, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.609 Vali Acc: 0.889 Test Loss: 0.609 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 2.005788803100586
Epoch: 50, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.609 Vali Acc: 0.894 Test Loss: 0.609 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.9478645324707031
Epoch: 51, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.615 Vali Acc: 0.878 Test Loss: 0.615 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.8031721115112305
Epoch: 52, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.613 Vali Acc: 0.883 Test Loss: 0.613 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 2.3828916549682617
Epoch: 53, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.609 Vali Acc: 0.878 Test Loss: 0.609 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 2.0239486694335938
Epoch: 54, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.614 Vali Acc: 0.894 Test Loss: 0.614 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 2.2043488025665283
Epoch: 55, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.626 Vali Acc: 0.906 Test Loss: 0.626 Test Acc: 0.906
Validation loss decreased (-0.899994 --> -0.905549).  Saving model ...
Epoch: 56 cost time: 1.7424681186676025
Epoch: 56, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.628 Vali Acc: 0.906 Test Loss: 0.628 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 2.346033811569214
Epoch: 57, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.626 Vali Acc: 0.894 Test Loss: 0.626 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.7773399353027344
Epoch: 58, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.628 Vali Acc: 0.894 Test Loss: 0.628 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 2.0776612758636475
Epoch: 59, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.624 Vali Acc: 0.894 Test Loss: 0.624 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 2.0935304164886475
Epoch: 60, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.626 Vali Acc: 0.894 Test Loss: 0.626 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.7424261569976807
Epoch: 61, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.627 Vali Acc: 0.900 Test Loss: 0.627 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.9970793724060059
Epoch: 62, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.642 Vali Acc: 0.900 Test Loss: 0.642 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 2.0891921520233154
Epoch: 63, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.651 Vali Acc: 0.900 Test Loss: 0.651 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 2.1449971199035645
Epoch: 64, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.643 Vali Acc: 0.906 Test Loss: 0.643 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 2.3368594646453857
Epoch: 65, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.627 Vali Acc: 0.894 Test Loss: 0.627 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 2337215
model size : 11.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.480820894241333
Epoch: 1, Steps: 12 | Train Loss: 2.854 Vali Loss: 2.674 Vali Acc: 0.078 Test Loss: 2.674 Test Acc: 0.078
Validation loss decreased (inf --> -0.077751).  Saving model ...
Epoch: 2 cost time: 1.6065359115600586
Epoch: 2, Steps: 12 | Train Loss: 2.676 Vali Loss: 2.546 Vali Acc: 0.239 Test Loss: 2.546 Test Acc: 0.239
Validation loss decreased (-0.077751 --> -0.238863).  Saving model ...
Epoch: 3 cost time: 1.5904066562652588
Epoch: 3, Steps: 12 | Train Loss: 2.520 Vali Loss: 2.325 Vali Acc: 0.356 Test Loss: 2.325 Test Acc: 0.356
Validation loss decreased (-0.238863 --> -0.355532).  Saving model ...
Epoch: 4 cost time: 1.521470069885254
Epoch: 4, Steps: 12 | Train Loss: 2.170 Vali Loss: 2.003 Vali Acc: 0.483 Test Loss: 2.003 Test Acc: 0.483
Validation loss decreased (-0.355532 --> -0.483313).  Saving model ...
Epoch: 5 cost time: 1.4444522857666016
Epoch: 5, Steps: 12 | Train Loss: 1.884 Vali Loss: 1.743 Vali Acc: 0.561 Test Loss: 1.743 Test Acc: 0.561
Validation loss decreased (-0.483313 --> -0.561094).  Saving model ...
Epoch: 6 cost time: 1.59731125831604
Epoch: 6, Steps: 12 | Train Loss: 1.595 Vali Loss: 1.512 Vali Acc: 0.567 Test Loss: 1.512 Test Acc: 0.567
Validation loss decreased (-0.561094 --> -0.566652).  Saving model ...
Epoch: 7 cost time: 1.7140908241271973
Epoch: 7, Steps: 12 | Train Loss: 1.356 Vali Loss: 1.377 Vali Acc: 0.622 Test Loss: 1.377 Test Acc: 0.622
Validation loss decreased (-0.566652 --> -0.622208).  Saving model ...
Epoch: 8 cost time: 1.6929895877838135
Epoch: 8, Steps: 12 | Train Loss: 1.249 Vali Loss: 1.239 Vali Acc: 0.711 Test Loss: 1.239 Test Acc: 0.711
Validation loss decreased (-0.622208 --> -0.711099).  Saving model ...
Epoch: 9 cost time: 1.5229229927062988
Epoch: 9, Steps: 12 | Train Loss: 1.079 Vali Loss: 1.117 Vali Acc: 0.711 Test Loss: 1.117 Test Acc: 0.711
Validation loss decreased (-0.711099 --> -0.711100).  Saving model ...
Epoch: 10 cost time: 1.742462158203125
Epoch: 10, Steps: 12 | Train Loss: 0.919 Vali Loss: 1.019 Vali Acc: 0.772 Test Loss: 1.019 Test Acc: 0.772
Validation loss decreased (-0.711100 --> -0.772212).  Saving model ...
Epoch: 11 cost time: 1.51939058303833
Epoch: 11, Steps: 12 | Train Loss: 0.777 Vali Loss: 0.932 Vali Acc: 0.717 Test Loss: 0.932 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8234572410583496
Epoch: 12, Steps: 12 | Train Loss: 0.641 Vali Loss: 0.838 Vali Acc: 0.733 Test Loss: 0.838 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7194514274597168
Epoch: 13, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.791 Vali Acc: 0.772 Test Loss: 0.791 Test Acc: 0.772
Validation loss decreased (-0.772212 --> -0.772214).  Saving model ...
Epoch: 14 cost time: 1.5741033554077148
Epoch: 14, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.761 Vali Acc: 0.817 Test Loss: 0.761 Test Acc: 0.817
Validation loss decreased (-0.772214 --> -0.816659).  Saving model ...
Epoch: 15 cost time: 1.88822603225708
Epoch: 15, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.658 Vali Acc: 0.817 Test Loss: 0.658 Test Acc: 0.817
Validation loss decreased (-0.816659 --> -0.816660).  Saving model ...
Epoch: 16 cost time: 1.4850513935089111
Epoch: 16, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.683 Vali Acc: 0.828 Test Loss: 0.683 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827771).  Saving model ...
Epoch: 17 cost time: 1.6721713542938232
Epoch: 17, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.655 Vali Acc: 0.806 Test Loss: 0.655 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7375690937042236
Epoch: 18, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.635 Vali Acc: 0.833 Test Loss: 0.635 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 19 cost time: 1.8551084995269775
Epoch: 19, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.613 Vali Acc: 0.833 Test Loss: 0.613 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 20 cost time: 1.9431605339050293
Epoch: 20, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.655 Vali Acc: 0.817 Test Loss: 0.655 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8681132793426514
Epoch: 21, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.595 Vali Acc: 0.844 Test Loss: 0.595 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844438).  Saving model ...
Epoch: 22 cost time: 1.9254887104034424
Epoch: 22, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.702 Vali Acc: 0.806 Test Loss: 0.702 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7000482082366943
Epoch: 23, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.625 Vali Acc: 0.844 Test Loss: 0.625 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.9666993618011475
Epoch: 24, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.639 Vali Acc: 0.844 Test Loss: 0.639 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.9199211597442627
Epoch: 25, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.535 Vali Acc: 0.861 Test Loss: 0.535 Test Acc: 0.861
Validation loss decreased (-0.844438 --> -0.861106).  Saving model ...
Epoch: 26 cost time: 1.824709415435791
Epoch: 26, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.538 Vali Acc: 0.883 Test Loss: 0.538 Test Acc: 0.883
Validation loss decreased (-0.861106 --> -0.883328).  Saving model ...
Epoch: 27 cost time: 1.6545796394348145
Epoch: 27, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.599 Vali Acc: 0.872 Test Loss: 0.599 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7879884243011475
Epoch: 28, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.544 Vali Acc: 0.856 Test Loss: 0.544 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.6425156593322754
Epoch: 29, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.602 Vali Acc: 0.861 Test Loss: 0.602 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.6235125064849854
Epoch: 30, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.542 Vali Acc: 0.861 Test Loss: 0.542 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.6284563541412354
Epoch: 31, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.525 Vali Acc: 0.872 Test Loss: 0.525 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.5599620342254639
Epoch: 32, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.576 Vali Acc: 0.867 Test Loss: 0.576 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.684880256652832
Epoch: 33, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.649 Vali Acc: 0.861 Test Loss: 0.649 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.7880759239196777
Epoch: 34, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.548 Vali Acc: 0.861 Test Loss: 0.548 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.7510356903076172
Epoch: 35, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.553 Vali Acc: 0.867 Test Loss: 0.553 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.6741814613342285
Epoch: 36, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.641 Vali Acc: 0.867 Test Loss: 0.641 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 2336319
model size : 11.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.268661737442017
Epoch: 1, Steps: 12 | Train Loss: 2.956 Vali Loss: 2.757 Vali Acc: 0.094 Test Loss: 2.757 Test Acc: 0.094
Validation loss decreased (inf --> -0.094417).  Saving model ...
Epoch: 2 cost time: 2.071229934692383
Epoch: 2, Steps: 12 | Train Loss: 2.655 Vali Loss: 2.587 Vali Acc: 0.100 Test Loss: 2.587 Test Acc: 0.100
Validation loss decreased (-0.094417 --> -0.099974).  Saving model ...
Epoch: 3 cost time: 1.7172937393188477
Epoch: 3, Steps: 12 | Train Loss: 2.527 Vali Loss: 2.412 Vali Acc: 0.267 Test Loss: 2.412 Test Acc: 0.267
Validation loss decreased (-0.099974 --> -0.266643).  Saving model ...
Epoch: 4 cost time: 1.686842441558838
Epoch: 4, Steps: 12 | Train Loss: 2.247 Vali Loss: 2.168 Vali Acc: 0.417 Test Loss: 2.168 Test Acc: 0.417
Validation loss decreased (-0.266643 --> -0.416645).  Saving model ...
Epoch: 5 cost time: 1.5859298706054688
Epoch: 5, Steps: 12 | Train Loss: 1.972 Vali Loss: 1.933 Vali Acc: 0.517 Test Loss: 1.933 Test Acc: 0.517
Validation loss decreased (-0.416645 --> -0.516647).  Saving model ...
Epoch: 6 cost time: 2.041900396347046
Epoch: 6, Steps: 12 | Train Loss: 1.673 Vali Loss: 1.695 Vali Acc: 0.550 Test Loss: 1.695 Test Acc: 0.550
Validation loss decreased (-0.516647 --> -0.549983).  Saving model ...
Epoch: 7 cost time: 1.6270480155944824
Epoch: 7, Steps: 12 | Train Loss: 1.453 Vali Loss: 1.555 Vali Acc: 0.589 Test Loss: 1.555 Test Acc: 0.589
Validation loss decreased (-0.549983 --> -0.588873).  Saving model ...
Epoch: 8 cost time: 1.7659459114074707
Epoch: 8, Steps: 12 | Train Loss: 1.293 Vali Loss: 1.421 Vali Acc: 0.606 Test Loss: 1.421 Test Acc: 0.606
Validation loss decreased (-0.588873 --> -0.605541).  Saving model ...
Epoch: 9 cost time: 1.8692338466644287
Epoch: 9, Steps: 12 | Train Loss: 1.115 Vali Loss: 1.300 Vali Acc: 0.650 Test Loss: 1.300 Test Acc: 0.650
Validation loss decreased (-0.605541 --> -0.649987).  Saving model ...
Epoch: 10 cost time: 1.6945247650146484
Epoch: 10, Steps: 12 | Train Loss: 0.961 Vali Loss: 1.123 Vali Acc: 0.728 Test Loss: 1.123 Test Acc: 0.728
Validation loss decreased (-0.649987 --> -0.727767).  Saving model ...
Epoch: 11 cost time: 1.5457072257995605
Epoch: 11, Steps: 12 | Train Loss: 0.909 Vali Loss: 1.072 Vali Acc: 0.717 Test Loss: 1.072 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.886735200881958
Epoch: 12, Steps: 12 | Train Loss: 0.762 Vali Loss: 0.969 Vali Acc: 0.722 Test Loss: 0.969 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0092036724090576
Epoch: 13, Steps: 12 | Train Loss: 0.687 Vali Loss: 0.862 Vali Acc: 0.761 Test Loss: 0.862 Test Acc: 0.761
Validation loss decreased (-0.727767 --> -0.761102).  Saving model ...
Epoch: 14 cost time: 1.726569652557373
Epoch: 14, Steps: 12 | Train Loss: 0.593 Vali Loss: 0.818 Vali Acc: 0.767 Test Loss: 0.818 Test Acc: 0.767
Validation loss decreased (-0.761102 --> -0.766658).  Saving model ...
Epoch: 15 cost time: 1.6378133296966553
Epoch: 15, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.708 Vali Acc: 0.778 Test Loss: 0.708 Test Acc: 0.778
Validation loss decreased (-0.766658 --> -0.777771).  Saving model ...
Epoch: 16 cost time: 1.7462992668151855
Epoch: 16, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.693 Vali Acc: 0.806 Test Loss: 0.693 Test Acc: 0.806
Validation loss decreased (-0.777771 --> -0.805549).  Saving model ...
Epoch: 17 cost time: 1.6555962562561035
Epoch: 17, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.618 Vali Acc: 0.817 Test Loss: 0.618 Test Acc: 0.817
Validation loss decreased (-0.805549 --> -0.816660).  Saving model ...
Epoch: 18 cost time: 1.659377098083496
Epoch: 18, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.602 Vali Acc: 0.828 Test Loss: 0.602 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827772).  Saving model ...
Epoch: 19 cost time: 1.7146315574645996
Epoch: 19, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.635 Vali Acc: 0.839 Test Loss: 0.635 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838883).  Saving model ...
Epoch: 20 cost time: 1.6632628440856934
Epoch: 20, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.545 Vali Acc: 0.844 Test Loss: 0.545 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 21 cost time: 1.7224011421203613
Epoch: 21, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.562 Vali Acc: 0.839 Test Loss: 0.562 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8122227191925049
Epoch: 22, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.579 Vali Acc: 0.856 Test Loss: 0.579 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 23 cost time: 1.513110876083374
Epoch: 23, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.521 Vali Acc: 0.861 Test Loss: 0.521 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 24 cost time: 1.8146610260009766
Epoch: 24, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.536 Vali Acc: 0.856 Test Loss: 0.536 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6680138111114502
Epoch: 25, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.579 Vali Acc: 0.867 Test Loss: 0.579 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 26 cost time: 1.5604603290557861
Epoch: 26, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.529 Vali Acc: 0.856 Test Loss: 0.529 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6777684688568115
Epoch: 27, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.692 Vali Acc: 0.850 Test Loss: 0.692 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.6717875003814697
Epoch: 28, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.604 Vali Acc: 0.856 Test Loss: 0.604 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.8031213283538818
Epoch: 29, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.637 Vali Acc: 0.844 Test Loss: 0.637 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.5498831272125244
Epoch: 30, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.595 Vali Acc: 0.872 Test Loss: 0.595 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 31 cost time: 1.6363792419433594
Epoch: 31, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.632 Vali Acc: 0.889 Test Loss: 0.632 Test Acc: 0.889
Validation loss decreased (-0.872216 --> -0.888883).  Saving model ...
Epoch: 32 cost time: 1.6297707557678223
Epoch: 32, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.550 Vali Acc: 0.867 Test Loss: 0.550 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.6175463199615479
Epoch: 33, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.633 Vali Acc: 0.850 Test Loss: 0.633 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.6871769428253174
Epoch: 34, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.524 Vali Acc: 0.872 Test Loss: 0.524 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.8448829650878906
Epoch: 35, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.439 Vali Acc: 0.883 Test Loss: 0.439 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.386375904083252
Epoch: 36, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.503 Vali Acc: 0.883 Test Loss: 0.503 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.466142177581787
Epoch: 37, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.537 Vali Acc: 0.883 Test Loss: 0.537 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.9577281475067139
Epoch: 38, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.523 Vali Acc: 0.889 Test Loss: 0.523 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888884).  Saving model ...
Epoch: 39 cost time: 1.6342551708221436
Epoch: 39, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.546 Vali Acc: 0.883 Test Loss: 0.546 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.6474382877349854
Epoch: 40, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.606 Vali Acc: 0.878 Test Loss: 0.606 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.6373226642608643
Epoch: 41, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.558 Vali Acc: 0.878 Test Loss: 0.558 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.8637027740478516
Epoch: 42, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.566 Vali Acc: 0.878 Test Loss: 0.566 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.5153791904449463
Epoch: 43, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.564 Vali Acc: 0.878 Test Loss: 0.564 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.4594001770019531
Epoch: 44, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.558 Vali Acc: 0.883 Test Loss: 0.558 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.6035759449005127
Epoch: 45, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.573 Vali Acc: 0.883 Test Loss: 0.573 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.6436054706573486
Epoch: 46, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.588 Vali Acc: 0.883 Test Loss: 0.588 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.8921034336090088
Epoch: 47, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.591 Vali Acc: 0.883 Test Loss: 0.591 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.5485756397247314
Epoch: 48, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.603 Vali Acc: 0.883 Test Loss: 0.603 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 2335423
model size : 11.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6346921920776367
Epoch: 1, Steps: 12 | Train Loss: 2.825 Vali Loss: 2.709 Vali Acc: 0.094 Test Loss: 2.709 Test Acc: 0.094
Validation loss decreased (inf --> -0.094417).  Saving model ...
Epoch: 2 cost time: 1.6505720615386963
Epoch: 2, Steps: 12 | Train Loss: 2.676 Vali Loss: 2.609 Vali Acc: 0.172 Test Loss: 2.609 Test Acc: 0.172
Validation loss decreased (-0.094417 --> -0.172196).  Saving model ...
Epoch: 3 cost time: 1.7596204280853271
Epoch: 3, Steps: 12 | Train Loss: 2.591 Vali Loss: 2.457 Vali Acc: 0.328 Test Loss: 2.457 Test Acc: 0.328
Validation loss decreased (-0.172196 --> -0.327753).  Saving model ...
Epoch: 4 cost time: 1.6698253154754639
Epoch: 4, Steps: 12 | Train Loss: 2.373 Vali Loss: 2.259 Vali Acc: 0.383 Test Loss: 2.259 Test Acc: 0.383
Validation loss decreased (-0.327753 --> -0.383311).  Saving model ...
Epoch: 5 cost time: 1.3704655170440674
Epoch: 5, Steps: 12 | Train Loss: 2.048 Vali Loss: 1.976 Vali Acc: 0.517 Test Loss: 1.976 Test Acc: 0.517
Validation loss decreased (-0.383311 --> -0.516647).  Saving model ...
Epoch: 6 cost time: 1.5483932495117188
Epoch: 6, Steps: 12 | Train Loss: 1.745 Vali Loss: 1.749 Vali Acc: 0.556 Test Loss: 1.749 Test Acc: 0.556
Validation loss decreased (-0.516647 --> -0.555538).  Saving model ...
Epoch: 7 cost time: 1.6683986186981201
Epoch: 7, Steps: 12 | Train Loss: 1.501 Vali Loss: 1.557 Vali Acc: 0.617 Test Loss: 1.557 Test Acc: 0.617
Validation loss decreased (-0.555538 --> -0.616651).  Saving model ...
Epoch: 8 cost time: 1.5577433109283447
Epoch: 8, Steps: 12 | Train Loss: 1.363 Vali Loss: 1.446 Vali Acc: 0.617 Test Loss: 1.446 Test Acc: 0.617
Validation loss decreased (-0.616651 --> -0.616652).  Saving model ...
Epoch: 9 cost time: 1.5340700149536133
Epoch: 9, Steps: 12 | Train Loss: 1.195 Vali Loss: 1.301 Vali Acc: 0.644 Test Loss: 1.301 Test Acc: 0.644
Validation loss decreased (-0.616652 --> -0.644431).  Saving model ...
Epoch: 10 cost time: 1.612736463546753
Epoch: 10, Steps: 12 | Train Loss: 1.055 Vali Loss: 1.166 Vali Acc: 0.694 Test Loss: 1.166 Test Acc: 0.694
Validation loss decreased (-0.644431 --> -0.694433).  Saving model ...
Epoch: 11 cost time: 1.5617249011993408
Epoch: 11, Steps: 12 | Train Loss: 0.937 Vali Loss: 1.104 Vali Acc: 0.728 Test Loss: 1.104 Test Acc: 0.728
Validation loss decreased (-0.694433 --> -0.727767).  Saving model ...
Epoch: 12 cost time: 1.6258971691131592
Epoch: 12, Steps: 12 | Train Loss: 0.817 Vali Loss: 0.991 Vali Acc: 0.706 Test Loss: 0.991 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6425743103027344
Epoch: 13, Steps: 12 | Train Loss: 0.693 Vali Loss: 0.923 Vali Acc: 0.722 Test Loss: 0.923 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9699876308441162
Epoch: 14, Steps: 12 | Train Loss: 0.628 Vali Loss: 0.953 Vali Acc: 0.756 Test Loss: 0.953 Test Acc: 0.756
Validation loss decreased (-0.727767 --> -0.755546).  Saving model ...
Epoch: 15 cost time: 2.0024704933166504
Epoch: 15, Steps: 12 | Train Loss: 0.640 Vali Loss: 0.763 Vali Acc: 0.800 Test Loss: 0.763 Test Acc: 0.800
Validation loss decreased (-0.755546 --> -0.799992).  Saving model ...
Epoch: 16 cost time: 1.695793867111206
Epoch: 16, Steps: 12 | Train Loss: 0.563 Vali Loss: 0.738 Vali Acc: 0.811 Test Loss: 0.738 Test Acc: 0.811
Validation loss decreased (-0.799992 --> -0.811104).  Saving model ...
Epoch: 17 cost time: 1.4681670665740967
Epoch: 17, Steps: 12 | Train Loss: 0.440 Vali Loss: 0.676 Vali Acc: 0.817 Test Loss: 0.676 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816660).  Saving model ...
Epoch: 18 cost time: 1.6517627239227295
Epoch: 18, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.564 Vali Acc: 0.856 Test Loss: 0.564 Test Acc: 0.856
Validation loss decreased (-0.816660 --> -0.855550).  Saving model ...
Epoch: 19 cost time: 1.562990665435791
Epoch: 19, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.569 Vali Acc: 0.833 Test Loss: 0.569 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.1220970153808594
Epoch: 20, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.569 Vali Acc: 0.861 Test Loss: 0.569 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 21 cost time: 1.7328553199768066
Epoch: 21, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.564 Vali Acc: 0.878 Test Loss: 0.564 Test Acc: 0.878
Validation loss decreased (-0.861105 --> -0.877772).  Saving model ...
Epoch: 22 cost time: 1.8386874198913574
Epoch: 22, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.531 Vali Acc: 0.850 Test Loss: 0.531 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6911087036132812
Epoch: 23, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.533 Vali Acc: 0.856 Test Loss: 0.533 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.8113698959350586
Epoch: 24, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.584 Vali Acc: 0.867 Test Loss: 0.584 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.6353914737701416
Epoch: 25, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.494 Vali Acc: 0.861 Test Loss: 0.494 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.9344427585601807
Epoch: 26, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.494 Vali Acc: 0.889 Test Loss: 0.494 Test Acc: 0.889
Validation loss decreased (-0.877772 --> -0.888884).  Saving model ...
Epoch: 27 cost time: 1.5108237266540527
Epoch: 27, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.577 Vali Acc: 0.867 Test Loss: 0.577 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5328481197357178
Epoch: 28, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.540 Vali Acc: 0.872 Test Loss: 0.540 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7140424251556396
Epoch: 29, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.622 Vali Acc: 0.844 Test Loss: 0.622 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.73295259475708
Epoch: 30, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.464 Vali Acc: 0.889 Test Loss: 0.464 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 31 cost time: 1.6407084465026855
Epoch: 31, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.527 Vali Acc: 0.872 Test Loss: 0.527 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.515014410018921
Epoch: 32, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.526 Vali Acc: 0.872 Test Loss: 0.526 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.768186330795288
Epoch: 33, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.527 Vali Acc: 0.872 Test Loss: 0.527 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.7249565124511719
Epoch: 34, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.645 Vali Acc: 0.883 Test Loss: 0.645 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.6929736137390137
Epoch: 35, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.539 Vali Acc: 0.872 Test Loss: 0.539 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.5266716480255127
Epoch: 36, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.570 Vali Acc: 0.867 Test Loss: 0.570 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.693145513534546
Epoch: 37, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.547 Vali Acc: 0.889 Test Loss: 0.547 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.6601753234863281
Epoch: 38, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.600 Vali Acc: 0.878 Test Loss: 0.600 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.9191532135009766
Epoch: 39, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.590 Vali Acc: 0.867 Test Loss: 0.590 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.982154369354248
Epoch: 40, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.608 Vali Acc: 0.889 Test Loss: 0.608 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 2107839
model size : 10.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.26594614982605
Epoch: 1, Steps: 12 | Train Loss: 2.856 Vali Loss: 2.683 Vali Acc: 0.144 Test Loss: 2.683 Test Acc: 0.144
Validation loss decreased (inf --> -0.144418).  Saving model ...
Epoch: 2 cost time: 1.4519858360290527
Epoch: 2, Steps: 12 | Train Loss: 2.661 Vali Loss: 2.501 Vali Acc: 0.267 Test Loss: 2.501 Test Acc: 0.267
Validation loss decreased (-0.144418 --> -0.266642).  Saving model ...
Epoch: 3 cost time: 1.5656688213348389
Epoch: 3, Steps: 12 | Train Loss: 2.501 Vali Loss: 2.308 Vali Acc: 0.400 Test Loss: 2.308 Test Acc: 0.400
Validation loss decreased (-0.266642 --> -0.399977).  Saving model ...
Epoch: 4 cost time: 1.6069180965423584
Epoch: 4, Steps: 12 | Train Loss: 2.251 Vali Loss: 2.061 Vali Acc: 0.500 Test Loss: 2.061 Test Acc: 0.500
Validation loss decreased (-0.399977 --> -0.499979).  Saving model ...
Epoch: 5 cost time: 1.6046528816223145
Epoch: 5, Steps: 12 | Train Loss: 1.947 Vali Loss: 1.802 Vali Acc: 0.528 Test Loss: 1.802 Test Acc: 0.528
Validation loss decreased (-0.499979 --> -0.527760).  Saving model ...
Epoch: 6 cost time: 1.7854135036468506
Epoch: 6, Steps: 12 | Train Loss: 1.653 Vali Loss: 1.608 Vali Acc: 0.567 Test Loss: 1.608 Test Acc: 0.567
Validation loss decreased (-0.527760 --> -0.566651).  Saving model ...
Epoch: 7 cost time: 1.6556339263916016
Epoch: 7, Steps: 12 | Train Loss: 1.407 Vali Loss: 1.424 Vali Acc: 0.622 Test Loss: 1.424 Test Acc: 0.622
Validation loss decreased (-0.566651 --> -0.622208).  Saving model ...
Epoch: 8 cost time: 1.6963856220245361
Epoch: 8, Steps: 12 | Train Loss: 1.285 Vali Loss: 1.335 Vali Acc: 0.656 Test Loss: 1.335 Test Acc: 0.656
Validation loss decreased (-0.622208 --> -0.655542).  Saving model ...
Epoch: 9 cost time: 1.7396714687347412
Epoch: 9, Steps: 12 | Train Loss: 1.133 Vali Loss: 1.221 Vali Acc: 0.672 Test Loss: 1.221 Test Acc: 0.672
Validation loss decreased (-0.655542 --> -0.672210).  Saving model ...
Epoch: 10 cost time: 1.6632068157196045
Epoch: 10, Steps: 12 | Train Loss: 1.051 Vali Loss: 1.073 Vali Acc: 0.717 Test Loss: 1.073 Test Acc: 0.717
Validation loss decreased (-0.672210 --> -0.716656).  Saving model ...
Epoch: 11 cost time: 2.2509498596191406
Epoch: 11, Steps: 12 | Train Loss: 0.872 Vali Loss: 0.974 Vali Acc: 0.750 Test Loss: 0.974 Test Acc: 0.750
Validation loss decreased (-0.716656 --> -0.749990).  Saving model ...
Epoch: 12 cost time: 1.9487676620483398
Epoch: 12, Steps: 12 | Train Loss: 0.790 Vali Loss: 0.892 Vali Acc: 0.756 Test Loss: 0.892 Test Acc: 0.756
Validation loss decreased (-0.749990 --> -0.755547).  Saving model ...
Epoch: 13 cost time: 1.8738670349121094
Epoch: 13, Steps: 12 | Train Loss: 0.662 Vali Loss: 0.811 Vali Acc: 0.772 Test Loss: 0.811 Test Acc: 0.772
Validation loss decreased (-0.755547 --> -0.772214).  Saving model ...
Epoch: 14 cost time: 2.1511335372924805
Epoch: 14, Steps: 12 | Train Loss: 0.600 Vali Loss: 0.784 Vali Acc: 0.783 Test Loss: 0.784 Test Acc: 0.783
Validation loss decreased (-0.772214 --> -0.783325).  Saving model ...
Epoch: 15 cost time: 1.820483922958374
Epoch: 15, Steps: 12 | Train Loss: 0.500 Vali Loss: 0.749 Vali Acc: 0.767 Test Loss: 0.749 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.087637424468994
Epoch: 16, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.669 Vali Acc: 0.817 Test Loss: 0.669 Test Acc: 0.817
Validation loss decreased (-0.783325 --> -0.816660).  Saving model ...
Epoch: 17 cost time: 1.9218730926513672
Epoch: 17, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.641 Vali Acc: 0.811 Test Loss: 0.641 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.2520992755889893
Epoch: 18, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.586 Vali Acc: 0.822 Test Loss: 0.586 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 19 cost time: 2.1813905239105225
Epoch: 19, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.597 Vali Acc: 0.817 Test Loss: 0.597 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.2350456714630127
Epoch: 20, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.556 Vali Acc: 0.833 Test Loss: 0.556 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833328).  Saving model ...
Epoch: 21 cost time: 2.1349871158599854
Epoch: 21, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.533 Vali Acc: 0.856 Test Loss: 0.533 Test Acc: 0.856
Validation loss decreased (-0.833328 --> -0.855550).  Saving model ...
Epoch: 22 cost time: 1.9051556587219238
Epoch: 22, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.548 Vali Acc: 0.844 Test Loss: 0.548 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.009321689605713
Epoch: 23, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.564 Vali Acc: 0.844 Test Loss: 0.564 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.3393428325653076
Epoch: 24, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.534 Vali Acc: 0.856 Test Loss: 0.534 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.6868929862976074
Epoch: 25, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.522 Vali Acc: 0.872 Test Loss: 0.522 Test Acc: 0.872
Validation loss decreased (-0.855550 --> -0.872217).  Saving model ...
Epoch: 26 cost time: 1.9576435089111328
Epoch: 26, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.542 Vali Acc: 0.856 Test Loss: 0.542 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.9758460521697998
Epoch: 27, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.499 Vali Acc: 0.867 Test Loss: 0.499 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8064911365509033
Epoch: 28, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.561 Vali Acc: 0.861 Test Loss: 0.561 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.8841297626495361
Epoch: 29, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.695 Vali Acc: 0.844 Test Loss: 0.695 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.1862499713897705
Epoch: 30, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.602 Vali Acc: 0.828 Test Loss: 0.602 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.103929042816162
Epoch: 31, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.595 Vali Acc: 0.872 Test Loss: 0.595 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.7219486236572266
Epoch: 32, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.538 Vali Acc: 0.867 Test Loss: 0.538 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.0304224491119385
Epoch: 33, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.561 Vali Acc: 0.878 Test Loss: 0.561 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 34 cost time: 1.9651100635528564
Epoch: 34, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.566 Vali Acc: 0.867 Test Loss: 0.566 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.2384212017059326
Epoch: 35, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.568 Vali Acc: 0.867 Test Loss: 0.568 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.8073396682739258
Epoch: 36, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.582 Vali Acc: 0.872 Test Loss: 0.582 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.974708080291748
Epoch: 37, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.569 Vali Acc: 0.867 Test Loss: 0.569 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.0224239826202393
Epoch: 38, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.576 Vali Acc: 0.878 Test Loss: 0.576 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.873316764831543
Epoch: 39, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.556 Vali Acc: 0.894 Test Loss: 0.556 Test Acc: 0.894
Validation loss decreased (-0.877772 --> -0.894439).  Saving model ...
Epoch: 40 cost time: 1.5809266567230225
Epoch: 40, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.595 Vali Acc: 0.867 Test Loss: 0.595 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.0036799907684326
Epoch: 41, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.590 Vali Acc: 0.872 Test Loss: 0.590 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.7580046653747559
Epoch: 42, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.682 Vali Acc: 0.856 Test Loss: 0.682 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.9966833591461182
Epoch: 43, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.645 Vali Acc: 0.856 Test Loss: 0.645 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 2.192854166030884
Epoch: 44, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.692 Vali Acc: 0.861 Test Loss: 0.692 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.786041498184204
Epoch: 45, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.624 Vali Acc: 0.861 Test Loss: 0.624 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.5346121788024902
Epoch: 46, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.668 Vali Acc: 0.856 Test Loss: 0.668 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.7642052173614502
Epoch: 47, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.656 Vali Acc: 0.850 Test Loss: 0.656 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.6835613250732422
Epoch: 48, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.603 Vali Acc: 0.850 Test Loss: 0.603 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.8068914413452148
Epoch: 49, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.654 Vali Acc: 0.867 Test Loss: 0.654 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 2106943
model size : 10.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6724298000335693
Epoch: 1, Steps: 12 | Train Loss: 2.800 Vali Loss: 2.700 Vali Acc: 0.089 Test Loss: 2.700 Test Acc: 0.089
Validation loss decreased (inf --> -0.088862).  Saving model ...
Epoch: 2 cost time: 1.5631518363952637
Epoch: 2, Steps: 12 | Train Loss: 2.639 Vali Loss: 2.590 Vali Acc: 0.183 Test Loss: 2.590 Test Acc: 0.183
Validation loss decreased (-0.088862 --> -0.183307).  Saving model ...
Epoch: 3 cost time: 1.7847626209259033
Epoch: 3, Steps: 12 | Train Loss: 2.448 Vali Loss: 2.396 Vali Acc: 0.300 Test Loss: 2.396 Test Acc: 0.300
Validation loss decreased (-0.183307 --> -0.299976).  Saving model ...
Epoch: 4 cost time: 1.5193746089935303
Epoch: 4, Steps: 12 | Train Loss: 2.246 Vali Loss: 2.132 Vali Acc: 0.394 Test Loss: 2.132 Test Acc: 0.394
Validation loss decreased (-0.299976 --> -0.394423).  Saving model ...
Epoch: 5 cost time: 1.880812168121338
Epoch: 5, Steps: 12 | Train Loss: 2.002 Vali Loss: 1.888 Vali Acc: 0.500 Test Loss: 1.888 Test Acc: 0.500
Validation loss decreased (-0.394423 --> -0.499981).  Saving model ...
Epoch: 6 cost time: 1.670365333557129
Epoch: 6, Steps: 12 | Train Loss: 1.645 Vali Loss: 1.645 Vali Acc: 0.589 Test Loss: 1.645 Test Acc: 0.589
Validation loss decreased (-0.499981 --> -0.588872).  Saving model ...
Epoch: 7 cost time: 1.6542644500732422
Epoch: 7, Steps: 12 | Train Loss: 1.467 Vali Loss: 1.472 Vali Acc: 0.606 Test Loss: 1.472 Test Acc: 0.606
Validation loss decreased (-0.588872 --> -0.605541).  Saving model ...
Epoch: 8 cost time: 1.9496581554412842
Epoch: 8, Steps: 12 | Train Loss: 1.332 Vali Loss: 1.361 Vali Acc: 0.656 Test Loss: 1.361 Test Acc: 0.656
Validation loss decreased (-0.605541 --> -0.655542).  Saving model ...
Epoch: 9 cost time: 1.6879453659057617
Epoch: 9, Steps: 12 | Train Loss: 1.157 Vali Loss: 1.190 Vali Acc: 0.700 Test Loss: 1.190 Test Acc: 0.700
Validation loss decreased (-0.655542 --> -0.699988).  Saving model ...
Epoch: 10 cost time: 1.936429500579834
Epoch: 10, Steps: 12 | Train Loss: 1.076 Vali Loss: 1.136 Vali Acc: 0.711 Test Loss: 1.136 Test Acc: 0.711
Validation loss decreased (-0.699988 --> -0.711100).  Saving model ...
Epoch: 11 cost time: 1.717853307723999
Epoch: 11, Steps: 12 | Train Loss: 0.944 Vali Loss: 1.096 Vali Acc: 0.683 Test Loss: 1.096 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7632598876953125
Epoch: 12, Steps: 12 | Train Loss: 0.805 Vali Loss: 0.971 Vali Acc: 0.711 Test Loss: 0.971 Test Acc: 0.711
Validation loss decreased (-0.711100 --> -0.711101).  Saving model ...
Epoch: 13 cost time: 1.9126527309417725
Epoch: 13, Steps: 12 | Train Loss: 0.726 Vali Loss: 0.948 Vali Acc: 0.711 Test Loss: 0.948 Test Acc: 0.711
Validation loss decreased (-0.711101 --> -0.711102).  Saving model ...
Epoch: 14 cost time: 1.8156404495239258
Epoch: 14, Steps: 12 | Train Loss: 0.685 Vali Loss: 0.813 Vali Acc: 0.744 Test Loss: 0.813 Test Acc: 0.744
Validation loss decreased (-0.711102 --> -0.744436).  Saving model ...
Epoch: 15 cost time: 1.7225027084350586
Epoch: 15, Steps: 12 | Train Loss: 0.612 Vali Loss: 0.750 Vali Acc: 0.783 Test Loss: 0.750 Test Acc: 0.783
Validation loss decreased (-0.744436 --> -0.783326).  Saving model ...
Epoch: 16 cost time: 1.8220326900482178
Epoch: 16, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.732 Vali Acc: 0.811 Test Loss: 0.732 Test Acc: 0.811
Validation loss decreased (-0.783326 --> -0.811104).  Saving model ...
Epoch: 17 cost time: 1.5900318622589111
Epoch: 17, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.663 Vali Acc: 0.794 Test Loss: 0.663 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5076649188995361
Epoch: 18, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.663 Vali Acc: 0.811 Test Loss: 0.663 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 19 cost time: 1.5810754299163818
Epoch: 19, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.561 Vali Acc: 0.861 Test Loss: 0.561 Test Acc: 0.861
Validation loss decreased (-0.811104 --> -0.861105).  Saving model ...
Epoch: 20 cost time: 1.6460227966308594
Epoch: 20, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.540 Vali Acc: 0.861 Test Loss: 0.540 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861106).  Saving model ...
Epoch: 21 cost time: 1.7904083728790283
Epoch: 21, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.602 Vali Acc: 0.839 Test Loss: 0.602 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7189886569976807
Epoch: 22, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.560 Vali Acc: 0.828 Test Loss: 0.560 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.9084339141845703
Epoch: 23, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.508 Vali Acc: 0.850 Test Loss: 0.508 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.837623119354248
Epoch: 24, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.552 Vali Acc: 0.850 Test Loss: 0.552 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.0988729000091553
Epoch: 25, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.506 Vali Acc: 0.872 Test Loss: 0.506 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 26 cost time: 1.41933012008667
Epoch: 26, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.481 Vali Acc: 0.861 Test Loss: 0.481 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.208533525466919
Epoch: 27, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.499 Vali Acc: 0.872 Test Loss: 0.499 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 28 cost time: 1.7469513416290283
Epoch: 28, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.479 Vali Acc: 0.856 Test Loss: 0.479 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.8907444477081299
Epoch: 29, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.544 Vali Acc: 0.856 Test Loss: 0.544 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4509379863739014
Epoch: 30, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.554 Vali Acc: 0.872 Test Loss: 0.554 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.5551562309265137
Epoch: 31, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.533 Vali Acc: 0.867 Test Loss: 0.533 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.021503210067749
Epoch: 32, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.481 Vali Acc: 0.872 Test Loss: 0.481 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 33 cost time: 1.5704882144927979
Epoch: 33, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.459 Vali Acc: 0.867 Test Loss: 0.459 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.5095205307006836
Epoch: 34, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.525 Vali Acc: 0.883 Test Loss: 0.525 Test Acc: 0.883
Validation loss decreased (-0.872217 --> -0.883328).  Saving model ...
Epoch: 35 cost time: 1.5162975788116455
Epoch: 35, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.519 Vali Acc: 0.872 Test Loss: 0.519 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.6518745422363281
Epoch: 36, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.499 Vali Acc: 0.872 Test Loss: 0.499 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.8977084159851074
Epoch: 37, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.632 Vali Acc: 0.861 Test Loss: 0.632 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.6328725814819336
Epoch: 38, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.534 Vali Acc: 0.867 Test Loss: 0.534 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.7766709327697754
Epoch: 39, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.561 Vali Acc: 0.889 Test Loss: 0.561 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888883).  Saving model ...
Epoch: 40 cost time: 1.7712812423706055
Epoch: 40, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.615 Vali Acc: 0.872 Test Loss: 0.615 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.6293764114379883
Epoch: 41, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.596 Vali Acc: 0.878 Test Loss: 0.596 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.8353710174560547
Epoch: 42, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.616 Vali Acc: 0.878 Test Loss: 0.616 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.0186851024627686
Epoch: 43, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.599 Vali Acc: 0.883 Test Loss: 0.599 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.9865477085113525
Epoch: 44, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.597 Vali Acc: 0.867 Test Loss: 0.597 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 2.034562587738037
Epoch: 45, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.589 Vali Acc: 0.867 Test Loss: 0.589 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.9189558029174805
Epoch: 46, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.596 Vali Acc: 0.872 Test Loss: 0.596 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.7713391780853271
Epoch: 47, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.607 Vali Acc: 0.878 Test Loss: 0.607 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.5422742366790771
Epoch: 48, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.593 Vali Acc: 0.878 Test Loss: 0.593 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.6493031978607178
Epoch: 49, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.596 Vali Acc: 0.872 Test Loss: 0.596 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 2106047
model size : 10.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.783132791519165
Epoch: 1, Steps: 12 | Train Loss: 2.859 Vali Loss: 2.719 Vali Acc: 0.050 Test Loss: 2.719 Test Acc: 0.050
Validation loss decreased (inf --> -0.049973).  Saving model ...
Epoch: 2 cost time: 2.0011634826660156
Epoch: 2, Steps: 12 | Train Loss: 2.694 Vali Loss: 2.575 Vali Acc: 0.178 Test Loss: 2.575 Test Acc: 0.178
Validation loss decreased (-0.049973 --> -0.177752).  Saving model ...
Epoch: 3 cost time: 1.669579029083252
Epoch: 3, Steps: 12 | Train Loss: 2.516 Vali Loss: 2.411 Vali Acc: 0.339 Test Loss: 2.411 Test Acc: 0.339
Validation loss decreased (-0.177752 --> -0.338865).  Saving model ...
Epoch: 4 cost time: 1.997178316116333
Epoch: 4, Steps: 12 | Train Loss: 2.297 Vali Loss: 2.172 Vali Acc: 0.406 Test Loss: 2.172 Test Acc: 0.406
Validation loss decreased (-0.338865 --> -0.405534).  Saving model ...
Epoch: 5 cost time: 1.6731531620025635
Epoch: 5, Steps: 12 | Train Loss: 1.975 Vali Loss: 1.898 Vali Acc: 0.561 Test Loss: 1.898 Test Acc: 0.561
Validation loss decreased (-0.405534 --> -0.561092).  Saving model ...
Epoch: 6 cost time: 2.0511233806610107
Epoch: 6, Steps: 12 | Train Loss: 1.664 Vali Loss: 1.652 Vali Acc: 0.589 Test Loss: 1.652 Test Acc: 0.589
Validation loss decreased (-0.561092 --> -0.588872).  Saving model ...
Epoch: 7 cost time: 1.984541893005371
Epoch: 7, Steps: 12 | Train Loss: 1.411 Vali Loss: 1.474 Vali Acc: 0.622 Test Loss: 1.474 Test Acc: 0.622
Validation loss decreased (-0.588872 --> -0.622207).  Saving model ...
Epoch: 8 cost time: 1.90592622756958
Epoch: 8, Steps: 12 | Train Loss: 1.372 Vali Loss: 1.346 Vali Acc: 0.633 Test Loss: 1.346 Test Acc: 0.633
Validation loss decreased (-0.622207 --> -0.633320).  Saving model ...
Epoch: 9 cost time: 1.7862911224365234
Epoch: 9, Steps: 12 | Train Loss: 1.129 Vali Loss: 1.239 Vali Acc: 0.611 Test Loss: 1.239 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.849752426147461
Epoch: 10, Steps: 12 | Train Loss: 1.004 Vali Loss: 1.112 Vali Acc: 0.650 Test Loss: 1.112 Test Acc: 0.650
Validation loss decreased (-0.633320 --> -0.649989).  Saving model ...
Epoch: 11 cost time: 1.6173856258392334
Epoch: 11, Steps: 12 | Train Loss: 0.900 Vali Loss: 0.979 Vali Acc: 0.733 Test Loss: 0.979 Test Acc: 0.733
Validation loss decreased (-0.649989 --> -0.733324).  Saving model ...
Epoch: 12 cost time: 1.6909599304199219
Epoch: 12, Steps: 12 | Train Loss: 0.785 Vali Loss: 0.951 Vali Acc: 0.733 Test Loss: 0.951 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 13 cost time: 1.876861810684204
Epoch: 13, Steps: 12 | Train Loss: 0.687 Vali Loss: 0.806 Vali Acc: 0.756 Test Loss: 0.806 Test Acc: 0.756
Validation loss decreased (-0.733324 --> -0.755547).  Saving model ...
Epoch: 14 cost time: 1.7901675701141357
Epoch: 14, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.778 Vali Acc: 0.778 Test Loss: 0.778 Test Acc: 0.778
Validation loss decreased (-0.755547 --> -0.777770).  Saving model ...
Epoch: 15 cost time: 1.6174614429473877
Epoch: 15, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.758 Vali Acc: 0.811 Test Loss: 0.758 Test Acc: 0.811
Validation loss decreased (-0.777770 --> -0.811104).  Saving model ...
Epoch: 16 cost time: 1.7252581119537354
Epoch: 16, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.647 Vali Acc: 0.811 Test Loss: 0.647 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811105).  Saving model ...
Epoch: 17 cost time: 1.7562661170959473
Epoch: 17, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.684 Vali Acc: 0.817 Test Loss: 0.684 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816660).  Saving model ...
Epoch: 18 cost time: 1.9043474197387695
Epoch: 18, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.623 Vali Acc: 0.800 Test Loss: 0.623 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6921377182006836
Epoch: 19, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.575 Vali Acc: 0.833 Test Loss: 0.575 Test Acc: 0.833
Validation loss decreased (-0.816660 --> -0.833328).  Saving model ...
Epoch: 20 cost time: 1.698587417602539
Epoch: 20, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.526 Vali Acc: 0.861 Test Loss: 0.526 Test Acc: 0.861
Validation loss decreased (-0.833328 --> -0.861106).  Saving model ...
Epoch: 21 cost time: 1.6930601596832275
Epoch: 21, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.524 Vali Acc: 0.850 Test Loss: 0.524 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6472830772399902
Epoch: 22, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.488 Vali Acc: 0.856 Test Loss: 0.488 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5629754066467285
Epoch: 23, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.513 Vali Acc: 0.872 Test Loss: 0.513 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 24 cost time: 1.5343191623687744
Epoch: 24, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.497 Vali Acc: 0.878 Test Loss: 0.497 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 25 cost time: 1.4971141815185547
Epoch: 25, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.490 Vali Acc: 0.872 Test Loss: 0.490 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.761549949645996
Epoch: 26, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.579 Vali Acc: 0.839 Test Loss: 0.579 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.717374324798584
Epoch: 27, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.561 Vali Acc: 0.856 Test Loss: 0.561 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.7149074077606201
Epoch: 28, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.553 Vali Acc: 0.861 Test Loss: 0.553 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.7381198406219482
Epoch: 29, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.625 Vali Acc: 0.828 Test Loss: 0.625 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.5340986251831055
Epoch: 30, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.536 Vali Acc: 0.856 Test Loss: 0.536 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.832353115081787
Epoch: 31, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.569 Vali Acc: 0.867 Test Loss: 0.569 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.6108407974243164
Epoch: 32, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.572 Vali Acc: 0.878 Test Loss: 0.572 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.9528357982635498
Epoch: 33, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.540 Vali Acc: 0.861 Test Loss: 0.540 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.7986559867858887
Epoch: 34, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.664 Vali Acc: 0.861 Test Loss: 0.664 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 2105151
model size : 10.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.911189079284668
Epoch: 1, Steps: 12 | Train Loss: 2.930 Vali Loss: 2.766 Vali Acc: 0.078 Test Loss: 2.766 Test Acc: 0.078
Validation loss decreased (inf --> -0.077750).  Saving model ...
Epoch: 2 cost time: 2.085326671600342
Epoch: 2, Steps: 12 | Train Loss: 2.664 Vali Loss: 2.563 Vali Acc: 0.178 Test Loss: 2.563 Test Acc: 0.178
Validation loss decreased (-0.077750 --> -0.177752).  Saving model ...
Epoch: 3 cost time: 1.7451767921447754
Epoch: 3, Steps: 12 | Train Loss: 2.551 Vali Loss: 2.375 Vali Acc: 0.278 Test Loss: 2.375 Test Acc: 0.278
Validation loss decreased (-0.177752 --> -0.277754).  Saving model ...
Epoch: 4 cost time: 1.6798021793365479
Epoch: 4, Steps: 12 | Train Loss: 2.241 Vali Loss: 2.172 Vali Acc: 0.350 Test Loss: 2.172 Test Acc: 0.350
Validation loss decreased (-0.277754 --> -0.349978).  Saving model ...
Epoch: 5 cost time: 1.9779293537139893
Epoch: 5, Steps: 12 | Train Loss: 2.039 Vali Loss: 1.993 Vali Acc: 0.394 Test Loss: 1.993 Test Acc: 0.394
Validation loss decreased (-0.349978 --> -0.394425).  Saving model ...
Epoch: 6 cost time: 1.490459680557251
Epoch: 6, Steps: 12 | Train Loss: 1.862 Vali Loss: 1.821 Vali Acc: 0.550 Test Loss: 1.821 Test Acc: 0.550
Validation loss decreased (-0.394425 --> -0.549982).  Saving model ...
Epoch: 7 cost time: 1.6331839561462402
Epoch: 7, Steps: 12 | Train Loss: 1.653 Vali Loss: 1.674 Vali Acc: 0.544 Test Loss: 1.674 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9912323951721191
Epoch: 8, Steps: 12 | Train Loss: 1.526 Vali Loss: 1.535 Vali Acc: 0.628 Test Loss: 1.535 Test Acc: 0.628
Validation loss decreased (-0.549982 --> -0.627762).  Saving model ...
Epoch: 9 cost time: 1.7256536483764648
Epoch: 9, Steps: 12 | Train Loss: 1.315 Vali Loss: 1.414 Vali Acc: 0.639 Test Loss: 1.414 Test Acc: 0.639
Validation loss decreased (-0.627762 --> -0.638875).  Saving model ...
Epoch: 10 cost time: 1.9751677513122559
Epoch: 10, Steps: 12 | Train Loss: 1.139 Vali Loss: 1.257 Vali Acc: 0.689 Test Loss: 1.257 Test Acc: 0.689
Validation loss decreased (-0.638875 --> -0.688876).  Saving model ...
Epoch: 11 cost time: 1.535980224609375
Epoch: 11, Steps: 12 | Train Loss: 1.002 Vali Loss: 1.199 Vali Acc: 0.678 Test Loss: 1.199 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.988731861114502
Epoch: 12, Steps: 12 | Train Loss: 0.979 Vali Loss: 1.048 Vali Acc: 0.744 Test Loss: 1.048 Test Acc: 0.744
Validation loss decreased (-0.688876 --> -0.744434).  Saving model ...
Epoch: 13 cost time: 1.9980762004852295
Epoch: 13, Steps: 12 | Train Loss: 0.867 Vali Loss: 0.965 Vali Acc: 0.783 Test Loss: 0.965 Test Acc: 0.783
Validation loss decreased (-0.744434 --> -0.783324).  Saving model ...
Epoch: 14 cost time: 1.8710296154022217
Epoch: 14, Steps: 12 | Train Loss: 0.732 Vali Loss: 0.878 Vali Acc: 0.772 Test Loss: 0.878 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8613557815551758
Epoch: 15, Steps: 12 | Train Loss: 0.619 Vali Loss: 0.783 Vali Acc: 0.839 Test Loss: 0.783 Test Acc: 0.839
Validation loss decreased (-0.783324 --> -0.838881).  Saving model ...
Epoch: 16 cost time: 1.9575626850128174
Epoch: 16, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.762 Vali Acc: 0.794 Test Loss: 0.762 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6832821369171143
Epoch: 17, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.697 Vali Acc: 0.817 Test Loss: 0.697 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9199941158294678
Epoch: 18, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.677 Vali Acc: 0.833 Test Loss: 0.677 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.0432686805725098
Epoch: 19, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.628 Vali Acc: 0.844 Test Loss: 0.628 Test Acc: 0.844
Validation loss decreased (-0.838881 --> -0.844438).  Saving model ...
Epoch: 20 cost time: 1.6725132465362549
Epoch: 20, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.610 Vali Acc: 0.828 Test Loss: 0.610 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6300382614135742
Epoch: 21, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.572 Vali Acc: 0.839 Test Loss: 0.572 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5830624103546143
Epoch: 22, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.582 Vali Acc: 0.828 Test Loss: 0.582 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7699718475341797
Epoch: 23, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.560 Vali Acc: 0.861 Test Loss: 0.560 Test Acc: 0.861
Validation loss decreased (-0.844438 --> -0.861106).  Saving model ...
Epoch: 24 cost time: 1.7539739608764648
Epoch: 24, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.575 Vali Acc: 0.850 Test Loss: 0.575 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5531976222991943
Epoch: 25, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.555 Vali Acc: 0.856 Test Loss: 0.555 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.7420814037322998
Epoch: 26, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.517 Vali Acc: 0.839 Test Loss: 0.517 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.5675134658813477
Epoch: 27, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.556 Vali Acc: 0.856 Test Loss: 0.556 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.8031799793243408
Epoch: 28, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.492 Vali Acc: 0.883 Test Loss: 0.492 Test Acc: 0.883
Validation loss decreased (-0.861106 --> -0.883328).  Saving model ...
Epoch: 29 cost time: 1.6437194347381592
Epoch: 29, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.550 Vali Acc: 0.833 Test Loss: 0.550 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.072420835494995
Epoch: 30, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.521 Vali Acc: 0.861 Test Loss: 0.521 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.6822736263275146
Epoch: 31, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.525 Vali Acc: 0.872 Test Loss: 0.525 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.8124725818634033
Epoch: 32, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.559 Vali Acc: 0.839 Test Loss: 0.559 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.220876693725586
Epoch: 33, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.499 Vali Acc: 0.883 Test Loss: 0.499 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.6699450016021729
Epoch: 34, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.523 Vali Acc: 0.867 Test Loss: 0.523 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.7795910835266113
Epoch: 35, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.518 Vali Acc: 0.872 Test Loss: 0.518 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.892258644104004
Epoch: 36, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.530 Vali Acc: 0.867 Test Loss: 0.530 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.7905290126800537
Epoch: 37, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.571 Vali Acc: 0.878 Test Loss: 0.571 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.6996979713439941
Epoch: 38, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.503 Vali Acc: 0.861 Test Loss: 0.503 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 1404735
model size : 6.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.603662729263306
Epoch: 1, Steps: 12 | Train Loss: 2.882 Vali Loss: 2.791 Vali Acc: 0.128 Test Loss: 2.791 Test Acc: 0.128
Validation loss decreased (inf --> -0.127750).  Saving model ...
Epoch: 2 cost time: 2.1061859130859375
Epoch: 2, Steps: 12 | Train Loss: 2.734 Vali Loss: 2.628 Vali Acc: 0.211 Test Loss: 2.628 Test Acc: 0.211
Validation loss decreased (-0.127750 --> -0.211085).  Saving model ...
Epoch: 3 cost time: 1.7743146419525146
Epoch: 3, Steps: 12 | Train Loss: 2.566 Vali Loss: 2.480 Vali Acc: 0.311 Test Loss: 2.480 Test Acc: 0.311
Validation loss decreased (-0.211085 --> -0.311086).  Saving model ...
Epoch: 4 cost time: 1.919053077697754
Epoch: 4, Steps: 12 | Train Loss: 2.386 Vali Loss: 2.276 Vali Acc: 0.400 Test Loss: 2.276 Test Acc: 0.400
Validation loss decreased (-0.311086 --> -0.399977).  Saving model ...
Epoch: 5 cost time: 1.7875347137451172
Epoch: 5, Steps: 12 | Train Loss: 2.051 Vali Loss: 2.065 Vali Acc: 0.400 Test Loss: 2.065 Test Acc: 0.400
Validation loss decreased (-0.399977 --> -0.399979).  Saving model ...
Epoch: 6 cost time: 2.333103656768799
Epoch: 6, Steps: 12 | Train Loss: 1.875 Vali Loss: 1.854 Vali Acc: 0.511 Test Loss: 1.854 Test Acc: 0.511
Validation loss decreased (-0.399979 --> -0.511093).  Saving model ...
Epoch: 7 cost time: 1.8604559898376465
Epoch: 7, Steps: 12 | Train Loss: 1.632 Vali Loss: 1.663 Vali Acc: 0.611 Test Loss: 1.663 Test Acc: 0.611
Validation loss decreased (-0.511093 --> -0.611094).  Saving model ...
Epoch: 8 cost time: 2.3402011394500732
Epoch: 8, Steps: 12 | Train Loss: 1.515 Vali Loss: 1.499 Vali Acc: 0.656 Test Loss: 1.499 Test Acc: 0.656
Validation loss decreased (-0.611094 --> -0.655541).  Saving model ...
Epoch: 9 cost time: 1.6664297580718994
Epoch: 9, Steps: 12 | Train Loss: 1.310 Vali Loss: 1.349 Vali Acc: 0.700 Test Loss: 1.349 Test Acc: 0.700
Validation loss decreased (-0.655541 --> -0.699987).  Saving model ...
Epoch: 10 cost time: 1.5784904956817627
Epoch: 10, Steps: 12 | Train Loss: 1.127 Vali Loss: 1.219 Vali Acc: 0.689 Test Loss: 1.219 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.114929676055908
Epoch: 11, Steps: 12 | Train Loss: 1.027 Vali Loss: 1.104 Vali Acc: 0.756 Test Loss: 1.104 Test Acc: 0.756
Validation loss decreased (-0.699987 --> -0.755545).  Saving model ...
Epoch: 12 cost time: 1.9535651206970215
Epoch: 12, Steps: 12 | Train Loss: 0.873 Vali Loss: 0.999 Vali Acc: 0.750 Test Loss: 0.999 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.408690929412842
Epoch: 13, Steps: 12 | Train Loss: 0.768 Vali Loss: 0.880 Vali Acc: 0.756 Test Loss: 0.880 Test Acc: 0.756
Validation loss decreased (-0.755545 --> -0.755547).  Saving model ...
Epoch: 14 cost time: 2.1189725399017334
Epoch: 14, Steps: 12 | Train Loss: 0.701 Vali Loss: 0.850 Vali Acc: 0.750 Test Loss: 0.850 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7101378440856934
Epoch: 15, Steps: 12 | Train Loss: 0.636 Vali Loss: 0.822 Vali Acc: 0.778 Test Loss: 0.822 Test Acc: 0.778
Validation loss decreased (-0.755547 --> -0.777770).  Saving model ...
Epoch: 16 cost time: 1.571669101715088
Epoch: 16, Steps: 12 | Train Loss: 0.534 Vali Loss: 0.710 Vali Acc: 0.828 Test Loss: 0.710 Test Acc: 0.828
Validation loss decreased (-0.777770 --> -0.827771).  Saving model ...
Epoch: 17 cost time: 1.7297825813293457
Epoch: 17, Steps: 12 | Train Loss: 0.511 Vali Loss: 0.676 Vali Acc: 0.811 Test Loss: 0.676 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.686058521270752
Epoch: 18, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.648 Vali Acc: 0.839 Test Loss: 0.648 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838882).  Saving model ...
Epoch: 19 cost time: 2.014368772506714
Epoch: 19, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.613 Vali Acc: 0.833 Test Loss: 0.613 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.0993824005126953
Epoch: 20, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.615 Vali Acc: 0.822 Test Loss: 0.615 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5551679134368896
Epoch: 21, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.568 Vali Acc: 0.856 Test Loss: 0.568 Test Acc: 0.856
Validation loss decreased (-0.838882 --> -0.855550).  Saving model ...
Epoch: 22 cost time: 1.5812184810638428
Epoch: 22, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.591 Vali Acc: 0.839 Test Loss: 0.591 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7387621402740479
Epoch: 23, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.544 Vali Acc: 0.844 Test Loss: 0.544 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.087961435317993
Epoch: 24, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.486 Vali Acc: 0.861 Test Loss: 0.486 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 25 cost time: 1.8673045635223389
Epoch: 25, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.492 Vali Acc: 0.872 Test Loss: 0.492 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 26 cost time: 2.026853322982788
Epoch: 26, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.480 Vali Acc: 0.861 Test Loss: 0.480 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.0191915035247803
Epoch: 27, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.473 Vali Acc: 0.872 Test Loss: 0.473 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 28 cost time: 1.8026273250579834
Epoch: 28, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.507 Vali Acc: 0.872 Test Loss: 0.507 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.3727872371673584
Epoch: 29, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.515 Vali Acc: 0.850 Test Loss: 0.515 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.954744815826416
Epoch: 30, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.484 Vali Acc: 0.850 Test Loss: 0.484 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.1160173416137695
Epoch: 31, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.483 Vali Acc: 0.861 Test Loss: 0.483 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.139357805252075
Epoch: 32, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.499 Vali Acc: 0.889 Test Loss: 0.499 Test Acc: 0.889
Validation loss decreased (-0.872217 --> -0.888884).  Saving model ...
Epoch: 33 cost time: 1.9022619724273682
Epoch: 33, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.505 Vali Acc: 0.867 Test Loss: 0.505 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.1517703533172607
Epoch: 34, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.533 Vali Acc: 0.844 Test Loss: 0.533 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.09975528717041
Epoch: 35, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.463 Vali Acc: 0.889 Test Loss: 0.463 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 36 cost time: 1.7132174968719482
Epoch: 36, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.491 Vali Acc: 0.878 Test Loss: 0.491 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.7054529190063477
Epoch: 37, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.500 Vali Acc: 0.883 Test Loss: 0.500 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.99908447265625
Epoch: 38, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.489 Vali Acc: 0.883 Test Loss: 0.489 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.9069032669067383
Epoch: 39, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.467 Vali Acc: 0.889 Test Loss: 0.467 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.9505600929260254
Epoch: 40, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.436 Vali Acc: 0.883 Test Loss: 0.436 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.188514471054077
Epoch: 41, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.476 Vali Acc: 0.878 Test Loss: 0.476 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.9313571453094482
Epoch: 42, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.508 Vali Acc: 0.883 Test Loss: 0.508 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.7011475563049316
Epoch: 43, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.480 Vali Acc: 0.878 Test Loss: 0.480 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.755220890045166
Epoch: 44, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.502 Vali Acc: 0.878 Test Loss: 0.502 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.843773603439331
Epoch: 45, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.463 Vali Acc: 0.883 Test Loss: 0.463 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 1404287
model size : 6.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.1472063064575195
Epoch: 1, Steps: 12 | Train Loss: 2.811 Vali Loss: 2.705 Vali Acc: 0.139 Test Loss: 2.705 Test Acc: 0.139
Validation loss decreased (inf --> -0.138862).  Saving model ...
Epoch: 2 cost time: 1.7446136474609375
Epoch: 2, Steps: 12 | Train Loss: 2.681 Vali Loss: 2.552 Vali Acc: 0.200 Test Loss: 2.552 Test Acc: 0.200
Validation loss decreased (-0.138862 --> -0.199974).  Saving model ...
Epoch: 3 cost time: 1.7740013599395752
Epoch: 3, Steps: 12 | Train Loss: 2.469 Vali Loss: 2.378 Vali Acc: 0.339 Test Loss: 2.378 Test Acc: 0.339
Validation loss decreased (-0.199974 --> -0.338865).  Saving model ...
Epoch: 4 cost time: 1.933210849761963
Epoch: 4, Steps: 12 | Train Loss: 2.233 Vali Loss: 2.164 Vali Acc: 0.439 Test Loss: 2.164 Test Acc: 0.439
Validation loss decreased (-0.338865 --> -0.438867).  Saving model ...
Epoch: 5 cost time: 1.8014824390411377
Epoch: 5, Steps: 12 | Train Loss: 1.994 Vali Loss: 1.968 Vali Acc: 0.533 Test Loss: 1.968 Test Acc: 0.533
Validation loss decreased (-0.438867 --> -0.533314).  Saving model ...
Epoch: 6 cost time: 1.494654655456543
Epoch: 6, Steps: 12 | Train Loss: 1.770 Vali Loss: 1.780 Vali Acc: 0.589 Test Loss: 1.780 Test Acc: 0.589
Validation loss decreased (-0.533314 --> -0.588871).  Saving model ...
Epoch: 7 cost time: 1.6124908924102783
Epoch: 7, Steps: 12 | Train Loss: 1.600 Vali Loss: 1.642 Vali Acc: 0.583 Test Loss: 1.642 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6109185218811035
Epoch: 8, Steps: 12 | Train Loss: 1.508 Vali Loss: 1.457 Vali Acc: 0.678 Test Loss: 1.457 Test Acc: 0.678
Validation loss decreased (-0.588871 --> -0.677763).  Saving model ...
Epoch: 9 cost time: 1.5796642303466797
Epoch: 9, Steps: 12 | Train Loss: 1.325 Vali Loss: 1.316 Vali Acc: 0.728 Test Loss: 1.316 Test Acc: 0.728
Validation loss decreased (-0.677763 --> -0.727765).  Saving model ...
Epoch: 10 cost time: 1.6704769134521484
Epoch: 10, Steps: 12 | Train Loss: 1.110 Vali Loss: 1.176 Vali Acc: 0.739 Test Loss: 1.176 Test Acc: 0.739
Validation loss decreased (-0.727765 --> -0.738877).  Saving model ...
Epoch: 11 cost time: 1.6106481552124023
Epoch: 11, Steps: 12 | Train Loss: 1.050 Vali Loss: 1.080 Vali Acc: 0.767 Test Loss: 1.080 Test Acc: 0.767
Validation loss decreased (-0.738877 --> -0.766656).  Saving model ...
Epoch: 12 cost time: 1.7777135372161865
Epoch: 12, Steps: 12 | Train Loss: 0.881 Vali Loss: 0.970 Vali Acc: 0.817 Test Loss: 0.970 Test Acc: 0.817
Validation loss decreased (-0.766656 --> -0.816657).  Saving model ...
Epoch: 13 cost time: 1.496638298034668
Epoch: 13, Steps: 12 | Train Loss: 0.852 Vali Loss: 0.884 Vali Acc: 0.800 Test Loss: 0.884 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8073687553405762
Epoch: 14, Steps: 12 | Train Loss: 0.700 Vali Loss: 0.782 Vali Acc: 0.817 Test Loss: 0.782 Test Acc: 0.817
Validation loss decreased (-0.816657 --> -0.816659).  Saving model ...
Epoch: 15 cost time: 1.7074062824249268
Epoch: 15, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.719 Vali Acc: 0.822 Test Loss: 0.719 Test Acc: 0.822
Validation loss decreased (-0.816659 --> -0.822215).  Saving model ...
Epoch: 16 cost time: 1.5961973667144775
Epoch: 16, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.679 Vali Acc: 0.850 Test Loss: 0.679 Test Acc: 0.850
Validation loss decreased (-0.822215 --> -0.849993).  Saving model ...
Epoch: 17 cost time: 1.4715304374694824
Epoch: 17, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.676 Vali Acc: 0.833 Test Loss: 0.676 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4554104804992676
Epoch: 18, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.589 Vali Acc: 0.861 Test Loss: 0.589 Test Acc: 0.861
Validation loss decreased (-0.849993 --> -0.861105).  Saving model ...
Epoch: 19 cost time: 2.005958080291748
Epoch: 19, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.577 Vali Acc: 0.872 Test Loss: 0.577 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872216).  Saving model ...
Epoch: 20 cost time: 1.435147762298584
Epoch: 20, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.575 Vali Acc: 0.872 Test Loss: 0.575 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872216).  Saving model ...
Epoch: 21 cost time: 1.8868584632873535
Epoch: 21, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.508 Vali Acc: 0.883 Test Loss: 0.508 Test Acc: 0.883
Validation loss decreased (-0.872216 --> -0.883328).  Saving model ...
Epoch: 22 cost time: 1.5377197265625
Epoch: 22, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.497 Vali Acc: 0.867 Test Loss: 0.497 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.616694450378418
Epoch: 23, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.521 Vali Acc: 0.883 Test Loss: 0.521 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6240293979644775
Epoch: 24, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.526 Vali Acc: 0.850 Test Loss: 0.526 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.4985780715942383
Epoch: 25, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.505 Vali Acc: 0.883 Test Loss: 0.505 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883328).  Saving model ...
Epoch: 26 cost time: 1.8134455680847168
Epoch: 26, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.490 Vali Acc: 0.883 Test Loss: 0.490 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883328).  Saving model ...
Epoch: 27 cost time: 1.7155005931854248
Epoch: 27, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.489 Vali Acc: 0.867 Test Loss: 0.489 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6408560276031494
Epoch: 28, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.474 Vali Acc: 0.867 Test Loss: 0.474 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5383498668670654
Epoch: 29, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.561 Vali Acc: 0.850 Test Loss: 0.561 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.7308523654937744
Epoch: 30, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.487 Vali Acc: 0.889 Test Loss: 0.487 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888884).  Saving model ...
Epoch: 31 cost time: 1.586186170578003
Epoch: 31, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.493 Vali Acc: 0.878 Test Loss: 0.493 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.8332490921020508
Epoch: 32, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.488 Vali Acc: 0.883 Test Loss: 0.488 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.917403221130371
Epoch: 33, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.516 Vali Acc: 0.883 Test Loss: 0.516 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.786780834197998
Epoch: 34, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.423 Vali Acc: 0.894 Test Loss: 0.423 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894440).  Saving model ...
Epoch: 35 cost time: 1.7275595664978027
Epoch: 35, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.477 Vali Acc: 0.889 Test Loss: 0.477 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.9360337257385254
Epoch: 36, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.482 Vali Acc: 0.872 Test Loss: 0.482 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.5669803619384766
Epoch: 37, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.472 Vali Acc: 0.883 Test Loss: 0.472 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.5636744499206543
Epoch: 38, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.485 Vali Acc: 0.889 Test Loss: 0.485 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.6153302192687988
Epoch: 39, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.463 Vali Acc: 0.894 Test Loss: 0.463 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.00500226020813
Epoch: 40, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.477 Vali Acc: 0.894 Test Loss: 0.477 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.8213121891021729
Epoch: 41, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.485 Vali Acc: 0.867 Test Loss: 0.485 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.678187608718872
Epoch: 42, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.571 Vali Acc: 0.867 Test Loss: 0.571 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.6890952587127686
Epoch: 43, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.529 Vali Acc: 0.856 Test Loss: 0.529 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.7764513492584229
Epoch: 44, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.534 Vali Acc: 0.894 Test Loss: 0.534 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 1403839
model size : 6.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9570436477661133
Epoch: 1, Steps: 12 | Train Loss: 2.779 Vali Loss: 2.661 Vali Acc: 0.133 Test Loss: 2.661 Test Acc: 0.133
Validation loss decreased (inf --> -0.133307).  Saving model ...
Epoch: 2 cost time: 1.924882173538208
Epoch: 2, Steps: 12 | Train Loss: 2.634 Vali Loss: 2.524 Vali Acc: 0.233 Test Loss: 2.524 Test Acc: 0.233
Validation loss decreased (-0.133307 --> -0.233308).  Saving model ...
Epoch: 3 cost time: 1.862699031829834
Epoch: 3, Steps: 12 | Train Loss: 2.506 Vali Loss: 2.340 Vali Acc: 0.361 Test Loss: 2.340 Test Acc: 0.361
Validation loss decreased (-0.233308 --> -0.361088).  Saving model ...
Epoch: 4 cost time: 1.813295602798462
Epoch: 4, Steps: 12 | Train Loss: 2.221 Vali Loss: 2.119 Vali Acc: 0.444 Test Loss: 2.119 Test Acc: 0.444
Validation loss decreased (-0.361088 --> -0.444423).  Saving model ...
Epoch: 5 cost time: 1.8130154609680176
Epoch: 5, Steps: 12 | Train Loss: 2.016 Vali Loss: 1.889 Vali Acc: 0.522 Test Loss: 1.889 Test Acc: 0.522
Validation loss decreased (-0.444423 --> -0.522203).  Saving model ...
Epoch: 6 cost time: 1.6703176498413086
Epoch: 6, Steps: 12 | Train Loss: 1.779 Vali Loss: 1.733 Vali Acc: 0.550 Test Loss: 1.733 Test Acc: 0.550
Validation loss decreased (-0.522203 --> -0.549983).  Saving model ...
Epoch: 7 cost time: 1.5967698097229004
Epoch: 7, Steps: 12 | Train Loss: 1.578 Vali Loss: 1.566 Vali Acc: 0.667 Test Loss: 1.566 Test Acc: 0.667
Validation loss decreased (-0.549983 --> -0.666651).  Saving model ...
Epoch: 8 cost time: 1.6529207229614258
Epoch: 8, Steps: 12 | Train Loss: 1.391 Vali Loss: 1.413 Vali Acc: 0.661 Test Loss: 1.413 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0726921558380127
Epoch: 9, Steps: 12 | Train Loss: 1.310 Vali Loss: 1.301 Vali Acc: 0.722 Test Loss: 1.301 Test Acc: 0.722
Validation loss decreased (-0.666651 --> -0.722209).  Saving model ...
Epoch: 10 cost time: 1.6383416652679443
Epoch: 10, Steps: 12 | Train Loss: 1.096 Vali Loss: 1.208 Vali Acc: 0.739 Test Loss: 1.208 Test Acc: 0.739
Validation loss decreased (-0.722209 --> -0.738877).  Saving model ...
Epoch: 11 cost time: 1.7297372817993164
Epoch: 11, Steps: 12 | Train Loss: 0.995 Vali Loss: 1.096 Vali Acc: 0.733 Test Loss: 1.096 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.932830810546875
Epoch: 12, Steps: 12 | Train Loss: 0.857 Vali Loss: 0.980 Vali Acc: 0.761 Test Loss: 0.980 Test Acc: 0.761
Validation loss decreased (-0.738877 --> -0.761101).  Saving model ...
Epoch: 13 cost time: 1.9994523525238037
Epoch: 13, Steps: 12 | Train Loss: 0.798 Vali Loss: 0.878 Vali Acc: 0.778 Test Loss: 0.878 Test Acc: 0.778
Validation loss decreased (-0.761101 --> -0.777769).  Saving model ...
Epoch: 14 cost time: 1.651402235031128
Epoch: 14, Steps: 12 | Train Loss: 0.728 Vali Loss: 0.847 Vali Acc: 0.789 Test Loss: 0.847 Test Acc: 0.789
Validation loss decreased (-0.777769 --> -0.788880).  Saving model ...
Epoch: 15 cost time: 1.6167349815368652
Epoch: 15, Steps: 12 | Train Loss: 0.629 Vali Loss: 0.754 Vali Acc: 0.800 Test Loss: 0.754 Test Acc: 0.800
Validation loss decreased (-0.788880 --> -0.799992).  Saving model ...
Epoch: 16 cost time: 1.7608320713043213
Epoch: 16, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.701 Vali Acc: 0.817 Test Loss: 0.701 Test Acc: 0.817
Validation loss decreased (-0.799992 --> -0.816660).  Saving model ...
Epoch: 17 cost time: 1.7268338203430176
Epoch: 17, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.683 Vali Acc: 0.806 Test Loss: 0.683 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.1689870357513428
Epoch: 18, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.645 Vali Acc: 0.822 Test Loss: 0.645 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 19 cost time: 1.8092293739318848
Epoch: 19, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.611 Vali Acc: 0.822 Test Loss: 0.611 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 20 cost time: 1.9672763347625732
Epoch: 20, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.573 Vali Acc: 0.839 Test Loss: 0.573 Test Acc: 0.839
Validation loss decreased (-0.822216 --> -0.838883).  Saving model ...
Epoch: 21 cost time: 1.9320085048675537
Epoch: 21, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.560 Vali Acc: 0.839 Test Loss: 0.560 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 22 cost time: 1.9044735431671143
Epoch: 22, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.548 Vali Acc: 0.850 Test Loss: 0.548 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849995).  Saving model ...
Epoch: 23 cost time: 1.8252809047698975
Epoch: 23, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.527 Vali Acc: 0.850 Test Loss: 0.527 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 24 cost time: 1.6496880054473877
Epoch: 24, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.504 Vali Acc: 0.839 Test Loss: 0.504 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8070929050445557
Epoch: 25, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.474 Vali Acc: 0.878 Test Loss: 0.474 Test Acc: 0.878
Validation loss decreased (-0.849995 --> -0.877773).  Saving model ...
Epoch: 26 cost time: 1.9683599472045898
Epoch: 26, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.485 Vali Acc: 0.867 Test Loss: 0.485 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8894853591918945
Epoch: 27, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.455 Vali Acc: 0.867 Test Loss: 0.455 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.735051155090332
Epoch: 28, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.474 Vali Acc: 0.861 Test Loss: 0.474 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.9087958335876465
Epoch: 29, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.469 Vali Acc: 0.872 Test Loss: 0.469 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.8393850326538086
Epoch: 30, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.481 Vali Acc: 0.861 Test Loss: 0.481 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.7934889793395996
Epoch: 31, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.467 Vali Acc: 0.867 Test Loss: 0.467 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.9840192794799805
Epoch: 32, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.474 Vali Acc: 0.850 Test Loss: 0.474 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.0430490970611572
Epoch: 33, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.531 Vali Acc: 0.850 Test Loss: 0.531 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.005139112472534
Epoch: 34, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.491 Vali Acc: 0.850 Test Loss: 0.491 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.3045361042022705
Epoch: 35, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.505 Vali Acc: 0.889 Test Loss: 0.505 Test Acc: 0.889
Validation loss decreased (-0.877773 --> -0.888884).  Saving model ...
Epoch: 36 cost time: 1.8423781394958496
Epoch: 36, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.463 Vali Acc: 0.894 Test Loss: 0.463 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894440).  Saving model ...
Epoch: 37 cost time: 1.8653292655944824
Epoch: 37, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.478 Vali Acc: 0.867 Test Loss: 0.478 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.7631070613861084
Epoch: 38, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.527 Vali Acc: 0.883 Test Loss: 0.527 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.660505771636963
Epoch: 39, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.462 Vali Acc: 0.878 Test Loss: 0.462 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.736802101135254
Epoch: 40, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.495 Vali Acc: 0.872 Test Loss: 0.495 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.822115182876587
Epoch: 41, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.523 Vali Acc: 0.878 Test Loss: 0.523 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.645810604095459
Epoch: 42, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.489 Vali Acc: 0.889 Test Loss: 0.489 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.8962907791137695
Epoch: 43, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.461 Vali Acc: 0.878 Test Loss: 0.461 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.8767037391662598
Epoch: 44, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.464 Vali Acc: 0.894 Test Loss: 0.464 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.672652244567871
Epoch: 45, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.499 Vali Acc: 0.883 Test Loss: 0.499 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.7040777206420898
Epoch: 46, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.519 Vali Acc: 0.872 Test Loss: 0.519 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 1403391
model size : 6.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8485500812530518
Epoch: 1, Steps: 12 | Train Loss: 2.884 Vali Loss: 2.789 Vali Acc: 0.039 Test Loss: 2.789 Test Acc: 0.039
Validation loss decreased (inf --> -0.038861).  Saving model ...
Epoch: 2 cost time: 1.7810592651367188
Epoch: 2, Steps: 12 | Train Loss: 2.745 Vali Loss: 2.637 Vali Acc: 0.100 Test Loss: 2.637 Test Acc: 0.100
Validation loss decreased (-0.038861 --> -0.099974).  Saving model ...
Epoch: 3 cost time: 1.9517691135406494
Epoch: 3, Steps: 12 | Train Loss: 2.642 Vali Loss: 2.547 Vali Acc: 0.300 Test Loss: 2.547 Test Acc: 0.300
Validation loss decreased (-0.099974 --> -0.299975).  Saving model ...
Epoch: 4 cost time: 1.889085292816162
Epoch: 4, Steps: 12 | Train Loss: 2.494 Vali Loss: 2.388 Vali Acc: 0.311 Test Loss: 2.388 Test Acc: 0.311
Validation loss decreased (-0.299975 --> -0.311087).  Saving model ...
Epoch: 5 cost time: 1.8498303890228271
Epoch: 5, Steps: 12 | Train Loss: 2.239 Vali Loss: 2.189 Vali Acc: 0.444 Test Loss: 2.189 Test Acc: 0.444
Validation loss decreased (-0.311087 --> -0.444423).  Saving model ...
Epoch: 6 cost time: 2.1624674797058105
Epoch: 6, Steps: 12 | Train Loss: 2.073 Vali Loss: 2.011 Vali Acc: 0.433 Test Loss: 2.011 Test Acc: 0.433
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7325718402862549
Epoch: 7, Steps: 12 | Train Loss: 1.848 Vali Loss: 1.825 Vali Acc: 0.483 Test Loss: 1.825 Test Acc: 0.483
Validation loss decreased (-0.444423 --> -0.483315).  Saving model ...
Epoch: 8 cost time: 1.5297305583953857
Epoch: 8, Steps: 12 | Train Loss: 1.670 Vali Loss: 1.650 Vali Acc: 0.544 Test Loss: 1.650 Test Acc: 0.544
Validation loss decreased (-0.483315 --> -0.544428).  Saving model ...
Epoch: 9 cost time: 1.7003827095031738
Epoch: 9, Steps: 12 | Train Loss: 1.460 Vali Loss: 1.507 Vali Acc: 0.633 Test Loss: 1.507 Test Acc: 0.633
Validation loss decreased (-0.544428 --> -0.633318).  Saving model ...
Epoch: 10 cost time: 2.2298266887664795
Epoch: 10, Steps: 12 | Train Loss: 1.351 Vali Loss: 1.388 Vali Acc: 0.622 Test Loss: 1.388 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0606586933135986
Epoch: 11, Steps: 12 | Train Loss: 1.221 Vali Loss: 1.342 Vali Acc: 0.689 Test Loss: 1.342 Test Acc: 0.689
Validation loss decreased (-0.633318 --> -0.688875).  Saving model ...
Epoch: 12 cost time: 1.8703455924987793
Epoch: 12, Steps: 12 | Train Loss: 1.116 Vali Loss: 1.198 Vali Acc: 0.689 Test Loss: 1.198 Test Acc: 0.689
Validation loss decreased (-0.688875 --> -0.688877).  Saving model ...
Epoch: 13 cost time: 2.1079635620117188
Epoch: 13, Steps: 12 | Train Loss: 0.980 Vali Loss: 1.092 Vali Acc: 0.739 Test Loss: 1.092 Test Acc: 0.739
Validation loss decreased (-0.688877 --> -0.738878).  Saving model ...
Epoch: 14 cost time: 1.6871254444122314
Epoch: 14, Steps: 12 | Train Loss: 0.909 Vali Loss: 1.023 Vali Acc: 0.772 Test Loss: 1.023 Test Acc: 0.772
Validation loss decreased (-0.738878 --> -0.772212).  Saving model ...
Epoch: 15 cost time: 2.1392338275909424
Epoch: 15, Steps: 12 | Train Loss: 0.785 Vali Loss: 0.975 Vali Acc: 0.756 Test Loss: 0.975 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.1223535537719727
Epoch: 16, Steps: 12 | Train Loss: 0.690 Vali Loss: 0.857 Vali Acc: 0.778 Test Loss: 0.857 Test Acc: 0.778
Validation loss decreased (-0.772212 --> -0.777769).  Saving model ...
Epoch: 17 cost time: 1.9827172756195068
Epoch: 17, Steps: 12 | Train Loss: 0.650 Vali Loss: 0.840 Vali Acc: 0.806 Test Loss: 0.840 Test Acc: 0.806
Validation loss decreased (-0.777769 --> -0.805547).  Saving model ...
Epoch: 18 cost time: 1.979485273361206
Epoch: 18, Steps: 12 | Train Loss: 0.618 Vali Loss: 0.767 Vali Acc: 0.811 Test Loss: 0.767 Test Acc: 0.811
Validation loss decreased (-0.805547 --> -0.811103).  Saving model ...
Epoch: 19 cost time: 1.881932020187378
Epoch: 19, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.706 Vali Acc: 0.839 Test Loss: 0.706 Test Acc: 0.839
Validation loss decreased (-0.811103 --> -0.838882).  Saving model ...
Epoch: 20 cost time: 1.871922254562378
Epoch: 20, Steps: 12 | Train Loss: 0.482 Vali Loss: 0.663 Vali Acc: 0.828 Test Loss: 0.663 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.001338481903076
Epoch: 21, Steps: 12 | Train Loss: 0.440 Vali Loss: 0.675 Vali Acc: 0.828 Test Loss: 0.675 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.913060188293457
Epoch: 22, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.614 Vali Acc: 0.839 Test Loss: 0.614 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838883).  Saving model ...
Epoch: 23 cost time: 1.8532755374908447
Epoch: 23, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.630 Vali Acc: 0.833 Test Loss: 0.630 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7134788036346436
Epoch: 24, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.622 Vali Acc: 0.867 Test Loss: 0.622 Test Acc: 0.867
Validation loss decreased (-0.838883 --> -0.866660).  Saving model ...
Epoch: 25 cost time: 1.8356595039367676
Epoch: 25, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.576 Vali Acc: 0.878 Test Loss: 0.576 Test Acc: 0.878
Validation loss decreased (-0.866660 --> -0.877772).  Saving model ...
Epoch: 26 cost time: 1.9807367324829102
Epoch: 26, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.585 Vali Acc: 0.856 Test Loss: 0.585 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.9916801452636719
Epoch: 27, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.603 Vali Acc: 0.828 Test Loss: 0.603 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8279271125793457
Epoch: 28, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.580 Vali Acc: 0.850 Test Loss: 0.580 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.7681653499603271
Epoch: 29, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.551 Vali Acc: 0.878 Test Loss: 0.551 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 30 cost time: 1.7595388889312744
Epoch: 30, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.578 Vali Acc: 0.883 Test Loss: 0.578 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883328).  Saving model ...
Epoch: 31 cost time: 1.6316657066345215
Epoch: 31, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.584 Vali Acc: 0.867 Test Loss: 0.584 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.8902528285980225
Epoch: 32, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.595 Vali Acc: 0.883 Test Loss: 0.595 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.8241889476776123
Epoch: 33, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.587 Vali Acc: 0.889 Test Loss: 0.587 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888883).  Saving model ...
Epoch: 34 cost time: 2.131840229034424
Epoch: 34, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.575 Vali Acc: 0.889 Test Loss: 0.575 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888883).  Saving model ...
Epoch: 35 cost time: 1.6266191005706787
Epoch: 35, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.570 Vali Acc: 0.883 Test Loss: 0.570 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.974334716796875
Epoch: 36, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.571 Vali Acc: 0.872 Test Loss: 0.571 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.3920886516571045
Epoch: 37, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.605 Vali Acc: 0.878 Test Loss: 0.605 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.0031399726867676
Epoch: 38, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.543 Vali Acc: 0.883 Test Loss: 0.543 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.737757682800293
Epoch: 39, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.611 Vali Acc: 0.872 Test Loss: 0.611 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.9670827388763428
Epoch: 40, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.607 Vali Acc: 0.872 Test Loss: 0.607 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.645007610321045
Epoch: 41, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.636 Vali Acc: 0.867 Test Loss: 0.636 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.968729019165039
Epoch: 42, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.588 Vali Acc: 0.878 Test Loss: 0.588 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.8697290420532227
Epoch: 43, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.567 Vali Acc: 0.883 Test Loss: 0.567 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.997558832168579
Epoch: 44, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.592 Vali Acc: 0.883 Test Loss: 0.592 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 942399
model size : 4.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6571826934814453
Epoch: 1, Steps: 12 | Train Loss: 2.799 Vali Loss: 2.722 Vali Acc: 0.028 Test Loss: 2.722 Test Acc: 0.028
Validation loss decreased (inf --> -0.027751).  Saving model ...
Epoch: 2 cost time: 1.8011341094970703
Epoch: 2, Steps: 12 | Train Loss: 2.655 Vali Loss: 2.574 Vali Acc: 0.178 Test Loss: 2.574 Test Acc: 0.178
Validation loss decreased (-0.027751 --> -0.177752).  Saving model ...
Epoch: 3 cost time: 1.8325631618499756
Epoch: 3, Steps: 12 | Train Loss: 2.555 Vali Loss: 2.395 Vali Acc: 0.300 Test Loss: 2.395 Test Acc: 0.300
Validation loss decreased (-0.177752 --> -0.299976).  Saving model ...
Epoch: 4 cost time: 1.7183618545532227
Epoch: 4, Steps: 12 | Train Loss: 2.368 Vali Loss: 2.205 Vali Acc: 0.422 Test Loss: 2.205 Test Acc: 0.422
Validation loss decreased (-0.299976 --> -0.422200).  Saving model ...
Epoch: 5 cost time: 1.7076852321624756
Epoch: 5, Steps: 12 | Train Loss: 2.109 Vali Loss: 2.032 Vali Acc: 0.422 Test Loss: 2.032 Test Acc: 0.422
Validation loss decreased (-0.422200 --> -0.422202).  Saving model ...
Epoch: 6 cost time: 1.7390573024749756
Epoch: 6, Steps: 12 | Train Loss: 1.913 Vali Loss: 1.874 Vali Acc: 0.500 Test Loss: 1.874 Test Acc: 0.500
Validation loss decreased (-0.422202 --> -0.499981).  Saving model ...
Epoch: 7 cost time: 2.166717767715454
Epoch: 7, Steps: 12 | Train Loss: 1.787 Vali Loss: 1.739 Vali Acc: 0.556 Test Loss: 1.739 Test Acc: 0.556
Validation loss decreased (-0.499981 --> -0.555538).  Saving model ...
Epoch: 8 cost time: 1.8247222900390625
Epoch: 8, Steps: 12 | Train Loss: 1.638 Vali Loss: 1.622 Vali Acc: 0.556 Test Loss: 1.622 Test Acc: 0.556
Validation loss decreased (-0.555538 --> -0.555539).  Saving model ...
Epoch: 9 cost time: 2.0626306533813477
Epoch: 9, Steps: 12 | Train Loss: 1.480 Vali Loss: 1.531 Vali Acc: 0.617 Test Loss: 1.531 Test Acc: 0.617
Validation loss decreased (-0.555539 --> -0.616651).  Saving model ...
Epoch: 10 cost time: 2.1028034687042236
Epoch: 10, Steps: 12 | Train Loss: 1.321 Vali Loss: 1.397 Vali Acc: 0.644 Test Loss: 1.397 Test Acc: 0.644
Validation loss decreased (-0.616651 --> -0.644430).  Saving model ...
Epoch: 11 cost time: 1.5505273342132568
Epoch: 11, Steps: 12 | Train Loss: 1.259 Vali Loss: 1.306 Vali Acc: 0.667 Test Loss: 1.306 Test Acc: 0.667
Validation loss decreased (-0.644430 --> -0.666654).  Saving model ...
Epoch: 12 cost time: 1.6427931785583496
Epoch: 12, Steps: 12 | Train Loss: 1.118 Vali Loss: 1.228 Vali Acc: 0.678 Test Loss: 1.228 Test Acc: 0.678
Validation loss decreased (-0.666654 --> -0.677765).  Saving model ...
Epoch: 13 cost time: 2.170633554458618
Epoch: 13, Steps: 12 | Train Loss: 0.978 Vali Loss: 1.123 Vali Acc: 0.706 Test Loss: 1.123 Test Acc: 0.706
Validation loss decreased (-0.677765 --> -0.705544).  Saving model ...
Epoch: 14 cost time: 2.0338761806488037
Epoch: 14, Steps: 12 | Train Loss: 0.883 Vali Loss: 1.027 Vali Acc: 0.717 Test Loss: 1.027 Test Acc: 0.717
Validation loss decreased (-0.705544 --> -0.716656).  Saving model ...
Epoch: 15 cost time: 1.8760700225830078
Epoch: 15, Steps: 12 | Train Loss: 0.801 Vali Loss: 0.980 Vali Acc: 0.733 Test Loss: 0.980 Test Acc: 0.733
Validation loss decreased (-0.716656 --> -0.733324).  Saving model ...
Epoch: 16 cost time: 1.647705078125
Epoch: 16, Steps: 12 | Train Loss: 0.706 Vali Loss: 0.911 Vali Acc: 0.778 Test Loss: 0.911 Test Acc: 0.778
Validation loss decreased (-0.733324 --> -0.777769).  Saving model ...
Epoch: 17 cost time: 1.6330077648162842
Epoch: 17, Steps: 12 | Train Loss: 0.667 Vali Loss: 0.876 Vali Acc: 0.778 Test Loss: 0.876 Test Acc: 0.778
Validation loss decreased (-0.777769 --> -0.777769).  Saving model ...
Epoch: 18 cost time: 1.8578500747680664
Epoch: 18, Steps: 12 | Train Loss: 0.632 Vali Loss: 0.833 Vali Acc: 0.772 Test Loss: 0.833 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7848808765411377
Epoch: 19, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.748 Vali Acc: 0.817 Test Loss: 0.748 Test Acc: 0.817
Validation loss decreased (-0.777769 --> -0.816659).  Saving model ...
Epoch: 20 cost time: 1.9567415714263916
Epoch: 20, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.714 Vali Acc: 0.844 Test Loss: 0.714 Test Acc: 0.844
Validation loss decreased (-0.816659 --> -0.844437).  Saving model ...
Epoch: 21 cost time: 1.9347610473632812
Epoch: 21, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.678 Vali Acc: 0.856 Test Loss: 0.678 Test Acc: 0.856
Validation loss decreased (-0.844437 --> -0.855549).  Saving model ...
Epoch: 22 cost time: 1.6049268245697021
Epoch: 22, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.728 Vali Acc: 0.800 Test Loss: 0.728 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7367632389068604
Epoch: 23, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.629 Vali Acc: 0.828 Test Loss: 0.629 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.971789836883545
Epoch: 24, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.651 Vali Acc: 0.828 Test Loss: 0.651 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.0582056045532227
Epoch: 25, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.603 Vali Acc: 0.861 Test Loss: 0.603 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 26 cost time: 2.029332160949707
Epoch: 26, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.606 Vali Acc: 0.844 Test Loss: 0.606 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.0110135078430176
Epoch: 27, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.591 Vali Acc: 0.867 Test Loss: 0.591 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 28 cost time: 1.9849777221679688
Epoch: 28, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.649 Vali Acc: 0.872 Test Loss: 0.649 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 29 cost time: 1.786618709564209
Epoch: 29, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.582 Vali Acc: 0.839 Test Loss: 0.582 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.6803874969482422
Epoch: 30, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.581 Vali Acc: 0.861 Test Loss: 0.581 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.178621530532837
Epoch: 31, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.596 Vali Acc: 0.850 Test Loss: 0.596 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.0572283267974854
Epoch: 32, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.581 Vali Acc: 0.844 Test Loss: 0.581 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.1347460746765137
Epoch: 33, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.580 Vali Acc: 0.867 Test Loss: 0.580 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.011016607284546
Epoch: 34, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.541 Vali Acc: 0.867 Test Loss: 0.541 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.0105502605438232
Epoch: 35, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.543 Vali Acc: 0.878 Test Loss: 0.543 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877772).  Saving model ...
Epoch: 36 cost time: 2.0923290252685547
Epoch: 36, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.560 Vali Acc: 0.867 Test Loss: 0.560 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.189805269241333
Epoch: 37, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.576 Vali Acc: 0.878 Test Loss: 0.576 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.305626392364502
Epoch: 38, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.549 Vali Acc: 0.878 Test Loss: 0.549 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.048546552658081
Epoch: 39, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.582 Vali Acc: 0.872 Test Loss: 0.582 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.9258625507354736
Epoch: 40, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.550 Vali Acc: 0.872 Test Loss: 0.550 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.810354232788086
Epoch: 41, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.571 Vali Acc: 0.867 Test Loss: 0.571 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 2.055429458618164
Epoch: 42, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.574 Vali Acc: 0.889 Test Loss: 0.574 Test Acc: 0.889
Validation loss decreased (-0.877772 --> -0.888883).  Saving model ...
Epoch: 43 cost time: 2.285897970199585
Epoch: 43, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.545 Vali Acc: 0.883 Test Loss: 0.545 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.8948085308074951
Epoch: 44, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.567 Vali Acc: 0.867 Test Loss: 0.567 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.288710594177246
Epoch: 45, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.619 Vali Acc: 0.867 Test Loss: 0.619 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.8338711261749268
Epoch: 46, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.649 Vali Acc: 0.861 Test Loss: 0.649 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.9261701107025146
Epoch: 47, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.584 Vali Acc: 0.883 Test Loss: 0.584 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.882755994796753
Epoch: 48, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.585 Vali Acc: 0.878 Test Loss: 0.585 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.9732229709625244
Epoch: 49, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.585 Vali Acc: 0.883 Test Loss: 0.585 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.9125895500183105
Epoch: 50, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.553 Vali Acc: 0.872 Test Loss: 0.553 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.9422919750213623
Epoch: 51, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.651 Vali Acc: 0.850 Test Loss: 0.651 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.5909149646759033
Epoch: 52, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.665 Vali Acc: 0.844 Test Loss: 0.665 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 941951
model size : 4.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9214625358581543
Epoch: 1, Steps: 12 | Train Loss: 2.830 Vali Loss: 2.704 Vali Acc: 0.072 Test Loss: 2.704 Test Acc: 0.072
Validation loss decreased (inf --> -0.072195).  Saving model ...
Epoch: 2 cost time: 1.7558555603027344
Epoch: 2, Steps: 12 | Train Loss: 2.689 Vali Loss: 2.614 Vali Acc: 0.233 Test Loss: 2.614 Test Acc: 0.233
Validation loss decreased (-0.072195 --> -0.233307).  Saving model ...
Epoch: 3 cost time: 2.105611562728882
Epoch: 3, Steps: 12 | Train Loss: 2.536 Vali Loss: 2.485 Vali Acc: 0.250 Test Loss: 2.485 Test Acc: 0.250
Validation loss decreased (-0.233307 --> -0.249975).  Saving model ...
Epoch: 4 cost time: 2.5545387268066406
Epoch: 4, Steps: 12 | Train Loss: 2.320 Vali Loss: 2.324 Vali Acc: 0.406 Test Loss: 2.324 Test Acc: 0.406
Validation loss decreased (-0.249975 --> -0.405532).  Saving model ...
Epoch: 5 cost time: 1.9115638732910156
Epoch: 5, Steps: 12 | Train Loss: 2.133 Vali Loss: 2.126 Vali Acc: 0.439 Test Loss: 2.126 Test Acc: 0.439
Validation loss decreased (-0.405532 --> -0.438868).  Saving model ...
Epoch: 6 cost time: 1.7550270557403564
Epoch: 6, Steps: 12 | Train Loss: 1.884 Vali Loss: 1.974 Vali Acc: 0.522 Test Loss: 1.974 Test Acc: 0.522
Validation loss decreased (-0.438868 --> -0.522202).  Saving model ...
Epoch: 7 cost time: 1.8041329383850098
Epoch: 7, Steps: 12 | Train Loss: 1.767 Vali Loss: 1.820 Vali Acc: 0.533 Test Loss: 1.820 Test Acc: 0.533
Validation loss decreased (-0.522202 --> -0.533315).  Saving model ...
Epoch: 8 cost time: 1.6278703212738037
Epoch: 8, Steps: 12 | Train Loss: 1.589 Vali Loss: 1.680 Vali Acc: 0.528 Test Loss: 1.680 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0820131301879883
Epoch: 9, Steps: 12 | Train Loss: 1.415 Vali Loss: 1.516 Vali Acc: 0.572 Test Loss: 1.516 Test Acc: 0.572
Validation loss decreased (-0.533315 --> -0.572207).  Saving model ...
Epoch: 10 cost time: 2.048539161682129
Epoch: 10, Steps: 12 | Train Loss: 1.299 Vali Loss: 1.441 Vali Acc: 0.589 Test Loss: 1.441 Test Acc: 0.589
Validation loss decreased (-0.572207 --> -0.588874).  Saving model ...
Epoch: 11 cost time: 1.8617427349090576
Epoch: 11, Steps: 12 | Train Loss: 1.195 Vali Loss: 1.311 Vali Acc: 0.678 Test Loss: 1.311 Test Acc: 0.678
Validation loss decreased (-0.588874 --> -0.677765).  Saving model ...
Epoch: 12 cost time: 1.708780288696289
Epoch: 12, Steps: 12 | Train Loss: 1.102 Vali Loss: 1.167 Vali Acc: 0.694 Test Loss: 1.167 Test Acc: 0.694
Validation loss decreased (-0.677765 --> -0.694433).  Saving model ...
Epoch: 13 cost time: 1.9744114875793457
Epoch: 13, Steps: 12 | Train Loss: 0.962 Vali Loss: 1.112 Vali Acc: 0.706 Test Loss: 1.112 Test Acc: 0.706
Validation loss decreased (-0.694433 --> -0.705544).  Saving model ...
Epoch: 14 cost time: 1.8395273685455322
Epoch: 14, Steps: 12 | Train Loss: 0.895 Vali Loss: 1.058 Vali Acc: 0.700 Test Loss: 1.058 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.152791738510132
Epoch: 15, Steps: 12 | Train Loss: 0.742 Vali Loss: 0.925 Vali Acc: 0.767 Test Loss: 0.925 Test Acc: 0.767
Validation loss decreased (-0.705544 --> -0.766657).  Saving model ...
Epoch: 16 cost time: 2.0683956146240234
Epoch: 16, Steps: 12 | Train Loss: 0.706 Vali Loss: 0.874 Vali Acc: 0.750 Test Loss: 0.874 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6691083908081055
Epoch: 17, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.791 Vali Acc: 0.822 Test Loss: 0.791 Test Acc: 0.822
Validation loss decreased (-0.766657 --> -0.822214).  Saving model ...
Epoch: 18 cost time: 2.02524995803833
Epoch: 18, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.729 Vali Acc: 0.822 Test Loss: 0.729 Test Acc: 0.822
Validation loss decreased (-0.822214 --> -0.822215).  Saving model ...
Epoch: 19 cost time: 1.533768892288208
Epoch: 19, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.668 Vali Acc: 0.850 Test Loss: 0.668 Test Acc: 0.850
Validation loss decreased (-0.822215 --> -0.849993).  Saving model ...
Epoch: 20 cost time: 1.5827486515045166
Epoch: 20, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.619 Vali Acc: 0.850 Test Loss: 0.619 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 21 cost time: 1.9381539821624756
Epoch: 21, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.611 Vali Acc: 0.850 Test Loss: 0.611 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 22 cost time: 2.2058074474334717
Epoch: 22, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.578 Vali Acc: 0.856 Test Loss: 0.578 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 23 cost time: 2.000950336456299
Epoch: 23, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.568 Vali Acc: 0.850 Test Loss: 0.568 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.955848217010498
Epoch: 24, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.582 Vali Acc: 0.872 Test Loss: 0.582 Test Acc: 0.872
Validation loss decreased (-0.855550 --> -0.872216).  Saving model ...
Epoch: 25 cost time: 1.5449965000152588
Epoch: 25, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.517 Vali Acc: 0.850 Test Loss: 0.517 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.7262189388275146
Epoch: 26, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.537 Vali Acc: 0.861 Test Loss: 0.537 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.9083967208862305
Epoch: 27, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.492 Vali Acc: 0.878 Test Loss: 0.492 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877773).  Saving model ...
Epoch: 28 cost time: 1.7824604511260986
Epoch: 28, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.512 Vali Acc: 0.872 Test Loss: 0.512 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7906818389892578
Epoch: 29, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.528 Vali Acc: 0.878 Test Loss: 0.528 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.8207509517669678
Epoch: 30, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.461 Vali Acc: 0.872 Test Loss: 0.461 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.8035459518432617
Epoch: 31, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.509 Vali Acc: 0.850 Test Loss: 0.509 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.9508092403411865
Epoch: 32, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.485 Vali Acc: 0.878 Test Loss: 0.485 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 33 cost time: 1.9293811321258545
Epoch: 33, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.468 Vali Acc: 0.872 Test Loss: 0.468 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.9759464263916016
Epoch: 34, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.494 Vali Acc: 0.889 Test Loss: 0.494 Test Acc: 0.889
Validation loss decreased (-0.877773 --> -0.888884).  Saving model ...
Epoch: 35 cost time: 2.0719761848449707
Epoch: 35, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.483 Vali Acc: 0.889 Test Loss: 0.483 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 36 cost time: 1.6451892852783203
Epoch: 36, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.522 Vali Acc: 0.883 Test Loss: 0.522 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.6395282745361328
Epoch: 37, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.511 Vali Acc: 0.872 Test Loss: 0.511 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.1061203479766846
Epoch: 38, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.498 Vali Acc: 0.872 Test Loss: 0.498 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.8053689002990723
Epoch: 39, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.491 Vali Acc: 0.878 Test Loss: 0.491 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.06074857711792
Epoch: 40, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.508 Vali Acc: 0.878 Test Loss: 0.508 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.0661423206329346
Epoch: 41, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.501 Vali Acc: 0.883 Test Loss: 0.501 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.8345940113067627
Epoch: 42, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.489 Vali Acc: 0.878 Test Loss: 0.489 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.6959736347198486
Epoch: 43, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.503 Vali Acc: 0.894 Test Loss: 0.503 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894439).  Saving model ...
Epoch: 44 cost time: 2.298250436782837
Epoch: 44, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.483 Vali Acc: 0.889 Test Loss: 0.483 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.8221337795257568
Epoch: 45, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.503 Vali Acc: 0.889 Test Loss: 0.503 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.7699480056762695
Epoch: 46, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.540 Vali Acc: 0.894 Test Loss: 0.540 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.2392215728759766
Epoch: 47, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.608 Vali Acc: 0.856 Test Loss: 0.608 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.8412678241729736
Epoch: 48, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.554 Vali Acc: 0.850 Test Loss: 0.554 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 2.3954012393951416
Epoch: 49, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.616 Vali Acc: 0.883 Test Loss: 0.616 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.8829565048217773
Epoch: 50, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.544 Vali Acc: 0.861 Test Loss: 0.544 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.6009764671325684
Epoch: 51, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.576 Vali Acc: 0.872 Test Loss: 0.576 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 2.184030055999756
Epoch: 52, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.471 Vali Acc: 0.906 Test Loss: 0.471 Test Acc: 0.906
Validation loss decreased (-0.894439 --> -0.905551).  Saving model ...
Epoch: 53 cost time: 1.738590955734253
Epoch: 53, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.501 Vali Acc: 0.894 Test Loss: 0.501 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.8752129077911377
Epoch: 54, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.480 Vali Acc: 0.894 Test Loss: 0.480 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 2.0212738513946533
Epoch: 55, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.482 Vali Acc: 0.889 Test Loss: 0.482 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.9463062286376953
Epoch: 56, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.505 Vali Acc: 0.889 Test Loss: 0.505 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.9782979488372803
Epoch: 57, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.515 Vali Acc: 0.889 Test Loss: 0.515 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.8421943187713623
Epoch: 58, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.533 Vali Acc: 0.894 Test Loss: 0.533 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 2.2607717514038086
Epoch: 59, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.515 Vali Acc: 0.894 Test Loss: 0.515 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 1.695690631866455
Epoch: 60, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.516 Vali Acc: 0.894 Test Loss: 0.516 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 2.0075206756591797
Epoch: 61, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.517 Vali Acc: 0.894 Test Loss: 0.517 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 1.7260808944702148
Epoch: 62, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.520 Vali Acc: 0.894 Test Loss: 0.520 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 941503
model size : 4.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.061893701553345
Epoch: 1, Steps: 12 | Train Loss: 2.837 Vali Loss: 2.747 Vali Acc: 0.083 Test Loss: 2.747 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 2.0214853286743164
Epoch: 2, Steps: 12 | Train Loss: 2.775 Vali Loss: 2.647 Vali Acc: 0.094 Test Loss: 2.647 Test Acc: 0.094
Validation loss decreased (-0.083306 --> -0.094418).  Saving model ...
Epoch: 3 cost time: 1.7695825099945068
Epoch: 3, Steps: 12 | Train Loss: 2.620 Vali Loss: 2.529 Vali Acc: 0.206 Test Loss: 2.529 Test Acc: 0.206
Validation loss decreased (-0.094418 --> -0.205530).  Saving model ...
Epoch: 4 cost time: 1.9009363651275635
Epoch: 4, Steps: 12 | Train Loss: 2.504 Vali Loss: 2.395 Vali Acc: 0.294 Test Loss: 2.395 Test Acc: 0.294
Validation loss decreased (-0.205530 --> -0.294420).  Saving model ...
Epoch: 5 cost time: 1.7051723003387451
Epoch: 5, Steps: 12 | Train Loss: 2.280 Vali Loss: 2.221 Vali Acc: 0.344 Test Loss: 2.221 Test Acc: 0.344
Validation loss decreased (-0.294420 --> -0.344422).  Saving model ...
Epoch: 6 cost time: 1.4992377758026123
Epoch: 6, Steps: 12 | Train Loss: 2.113 Vali Loss: 2.035 Vali Acc: 0.433 Test Loss: 2.035 Test Acc: 0.433
Validation loss decreased (-0.344422 --> -0.433313).  Saving model ...
Epoch: 7 cost time: 1.8753376007080078
Epoch: 7, Steps: 12 | Train Loss: 1.981 Vali Loss: 1.869 Vali Acc: 0.511 Test Loss: 1.869 Test Acc: 0.511
Validation loss decreased (-0.433313 --> -0.511092).  Saving model ...
Epoch: 8 cost time: 1.727644681930542
Epoch: 8, Steps: 12 | Train Loss: 1.716 Vali Loss: 1.727 Vali Acc: 0.578 Test Loss: 1.727 Test Acc: 0.578
Validation loss decreased (-0.511092 --> -0.577761).  Saving model ...
Epoch: 9 cost time: 1.930154800415039
Epoch: 9, Steps: 12 | Train Loss: 1.558 Vali Loss: 1.587 Vali Acc: 0.600 Test Loss: 1.587 Test Acc: 0.600
Validation loss decreased (-0.577761 --> -0.599984).  Saving model ...
Epoch: 10 cost time: 1.8744685649871826
Epoch: 10, Steps: 12 | Train Loss: 1.401 Vali Loss: 1.455 Vali Acc: 0.600 Test Loss: 1.455 Test Acc: 0.600
Validation loss decreased (-0.599984 --> -0.599985).  Saving model ...
Epoch: 11 cost time: 1.5366382598876953
Epoch: 11, Steps: 12 | Train Loss: 1.248 Vali Loss: 1.308 Vali Acc: 0.678 Test Loss: 1.308 Test Acc: 0.678
Validation loss decreased (-0.599985 --> -0.677765).  Saving model ...
Epoch: 12 cost time: 1.9867212772369385
Epoch: 12, Steps: 12 | Train Loss: 1.213 Vali Loss: 1.212 Vali Acc: 0.717 Test Loss: 1.212 Test Acc: 0.717
Validation loss decreased (-0.677765 --> -0.716655).  Saving model ...
Epoch: 13 cost time: 1.8972196578979492
Epoch: 13, Steps: 12 | Train Loss: 1.006 Vali Loss: 1.126 Vali Acc: 0.733 Test Loss: 1.126 Test Acc: 0.733
Validation loss decreased (-0.716655 --> -0.733322).  Saving model ...
Epoch: 14 cost time: 1.7238988876342773
Epoch: 14, Steps: 12 | Train Loss: 0.967 Vali Loss: 1.015 Vali Acc: 0.761 Test Loss: 1.015 Test Acc: 0.761
Validation loss decreased (-0.733322 --> -0.761101).  Saving model ...
Epoch: 15 cost time: 2.330897331237793
Epoch: 15, Steps: 12 | Train Loss: 0.790 Vali Loss: 0.962 Vali Acc: 0.767 Test Loss: 0.962 Test Acc: 0.767
Validation loss decreased (-0.761101 --> -0.766657).  Saving model ...
Epoch: 16 cost time: 2.1013686656951904
Epoch: 16, Steps: 12 | Train Loss: 0.718 Vali Loss: 0.893 Vali Acc: 0.767 Test Loss: 0.893 Test Acc: 0.767
Validation loss decreased (-0.766657 --> -0.766658).  Saving model ...
Epoch: 17 cost time: 1.7765464782714844
Epoch: 17, Steps: 12 | Train Loss: 0.660 Vali Loss: 0.824 Vali Acc: 0.806 Test Loss: 0.824 Test Acc: 0.806
Validation loss decreased (-0.766658 --> -0.805547).  Saving model ...
Epoch: 18 cost time: 1.8025341033935547
Epoch: 18, Steps: 12 | Train Loss: 0.577 Vali Loss: 0.762 Vali Acc: 0.811 Test Loss: 0.762 Test Acc: 0.811
Validation loss decreased (-0.805547 --> -0.811103).  Saving model ...
Epoch: 19 cost time: 2.080702781677246
Epoch: 19, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.728 Vali Acc: 0.828 Test Loss: 0.728 Test Acc: 0.828
Validation loss decreased (-0.811103 --> -0.827770).  Saving model ...
Epoch: 20 cost time: 1.9873275756835938
Epoch: 20, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.651 Vali Acc: 0.828 Test Loss: 0.651 Test Acc: 0.828
Validation loss decreased (-0.827770 --> -0.827771).  Saving model ...
Epoch: 21 cost time: 2.0626659393310547
Epoch: 21, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.618 Vali Acc: 0.828 Test Loss: 0.618 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827772).  Saving model ...
Epoch: 22 cost time: 1.8955647945404053
Epoch: 22, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.626 Vali Acc: 0.861 Test Loss: 0.626 Test Acc: 0.861
Validation loss decreased (-0.827772 --> -0.861105).  Saving model ...
Epoch: 23 cost time: 1.7348659038543701
Epoch: 23, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.593 Vali Acc: 0.828 Test Loss: 0.593 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.794245958328247
Epoch: 24, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.590 Vali Acc: 0.850 Test Loss: 0.590 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.8862051963806152
Epoch: 25, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.542 Vali Acc: 0.889 Test Loss: 0.542 Test Acc: 0.889
Validation loss decreased (-0.861105 --> -0.888883).  Saving model ...
Epoch: 26 cost time: 1.9440932273864746
Epoch: 26, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.580 Vali Acc: 0.867 Test Loss: 0.580 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7169060707092285
Epoch: 27, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.538 Vali Acc: 0.872 Test Loss: 0.538 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8529934883117676
Epoch: 28, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.521 Vali Acc: 0.872 Test Loss: 0.521 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.6965339183807373
Epoch: 29, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.546 Vali Acc: 0.867 Test Loss: 0.546 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.996422529220581
Epoch: 30, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.548 Vali Acc: 0.878 Test Loss: 0.548 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.4164011478424072
Epoch: 31, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.509 Vali Acc: 0.867 Test Loss: 0.509 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.1971561908721924
Epoch: 32, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.541 Vali Acc: 0.872 Test Loss: 0.541 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.2068846225738525
Epoch: 33, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.528 Vali Acc: 0.872 Test Loss: 0.528 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.6527230739593506
Epoch: 34, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.540 Vali Acc: 0.872 Test Loss: 0.540 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.7372617721557617
Epoch: 35, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.523 Vali Acc: 0.878 Test Loss: 0.523 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 941055
model size : 4.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.033523797988892
Epoch: 1, Steps: 12 | Train Loss: 2.844 Vali Loss: 2.796 Vali Acc: 0.033 Test Loss: 2.796 Test Acc: 0.033
Validation loss decreased (inf --> -0.033305).  Saving model ...
Epoch: 2 cost time: 1.8250846862792969
Epoch: 2, Steps: 12 | Train Loss: 2.768 Vali Loss: 2.653 Vali Acc: 0.094 Test Loss: 2.653 Test Acc: 0.094
Validation loss decreased (-0.033305 --> -0.094418).  Saving model ...
Epoch: 3 cost time: 1.8100879192352295
Epoch: 3, Steps: 12 | Train Loss: 2.685 Vali Loss: 2.548 Vali Acc: 0.233 Test Loss: 2.548 Test Acc: 0.233
Validation loss decreased (-0.094418 --> -0.233308).  Saving model ...
Epoch: 4 cost time: 1.9847416877746582
Epoch: 4, Steps: 12 | Train Loss: 2.520 Vali Loss: 2.426 Vali Acc: 0.317 Test Loss: 2.426 Test Acc: 0.317
Validation loss decreased (-0.233308 --> -0.316642).  Saving model ...
Epoch: 5 cost time: 1.6796634197235107
Epoch: 5, Steps: 12 | Train Loss: 2.378 Vali Loss: 2.235 Vali Acc: 0.417 Test Loss: 2.235 Test Acc: 0.417
Validation loss decreased (-0.316642 --> -0.416644).  Saving model ...
Epoch: 6 cost time: 1.860931396484375
Epoch: 6, Steps: 12 | Train Loss: 2.177 Vali Loss: 2.056 Vali Acc: 0.450 Test Loss: 2.056 Test Acc: 0.450
Validation loss decreased (-0.416644 --> -0.449979).  Saving model ...
Epoch: 7 cost time: 1.4593703746795654
Epoch: 7, Steps: 12 | Train Loss: 2.006 Vali Loss: 1.869 Vali Acc: 0.522 Test Loss: 1.869 Test Acc: 0.522
Validation loss decreased (-0.449979 --> -0.522204).  Saving model ...
Epoch: 8 cost time: 2.007768154144287
Epoch: 8, Steps: 12 | Train Loss: 1.799 Vali Loss: 1.732 Vali Acc: 0.611 Test Loss: 1.732 Test Acc: 0.611
Validation loss decreased (-0.522204 --> -0.611094).  Saving model ...
Epoch: 9 cost time: 2.1904942989349365
Epoch: 9, Steps: 12 | Train Loss: 1.682 Vali Loss: 1.611 Vali Acc: 0.611 Test Loss: 1.611 Test Acc: 0.611
Validation loss decreased (-0.611094 --> -0.611095).  Saving model ...
Epoch: 10 cost time: 1.668994426727295
Epoch: 10, Steps: 12 | Train Loss: 1.584 Vali Loss: 1.541 Vali Acc: 0.639 Test Loss: 1.541 Test Acc: 0.639
Validation loss decreased (-0.611095 --> -0.638873).  Saving model ...
Epoch: 11 cost time: 1.9249067306518555
Epoch: 11, Steps: 12 | Train Loss: 1.413 Vali Loss: 1.411 Vali Acc: 0.678 Test Loss: 1.411 Test Acc: 0.678
Validation loss decreased (-0.638873 --> -0.677764).  Saving model ...
Epoch: 12 cost time: 1.9055500030517578
Epoch: 12, Steps: 12 | Train Loss: 1.245 Vali Loss: 1.319 Vali Acc: 0.689 Test Loss: 1.319 Test Acc: 0.689
Validation loss decreased (-0.677764 --> -0.688876).  Saving model ...
Epoch: 13 cost time: 1.9117016792297363
Epoch: 13, Steps: 12 | Train Loss: 1.126 Vali Loss: 1.235 Vali Acc: 0.711 Test Loss: 1.235 Test Acc: 0.711
Validation loss decreased (-0.688876 --> -0.711099).  Saving model ...
Epoch: 14 cost time: 1.957059383392334
Epoch: 14, Steps: 12 | Train Loss: 1.068 Vali Loss: 1.152 Vali Acc: 0.689 Test Loss: 1.152 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7076213359832764
Epoch: 15, Steps: 12 | Train Loss: 1.006 Vali Loss: 1.095 Vali Acc: 0.733 Test Loss: 1.095 Test Acc: 0.733
Validation loss decreased (-0.711099 --> -0.733322).  Saving model ...
Epoch: 16 cost time: 1.5225014686584473
Epoch: 16, Steps: 12 | Train Loss: 0.970 Vali Loss: 1.045 Vali Acc: 0.728 Test Loss: 1.045 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.598057746887207
Epoch: 17, Steps: 12 | Train Loss: 0.794 Vali Loss: 0.941 Vali Acc: 0.789 Test Loss: 0.941 Test Acc: 0.789
Validation loss decreased (-0.733322 --> -0.788879).  Saving model ...
Epoch: 18 cost time: 1.6492061614990234
Epoch: 18, Steps: 12 | Train Loss: 0.738 Vali Loss: 0.932 Vali Acc: 0.778 Test Loss: 0.932 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7378523349761963
Epoch: 19, Steps: 12 | Train Loss: 0.672 Vali Loss: 0.820 Vali Acc: 0.806 Test Loss: 0.820 Test Acc: 0.806
Validation loss decreased (-0.788879 --> -0.805547).  Saving model ...
Epoch: 20 cost time: 1.6521546840667725
Epoch: 20, Steps: 12 | Train Loss: 0.577 Vali Loss: 0.789 Vali Acc: 0.789 Test Loss: 0.789 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8897936344146729
Epoch: 21, Steps: 12 | Train Loss: 0.528 Vali Loss: 0.712 Vali Acc: 0.822 Test Loss: 0.712 Test Acc: 0.822
Validation loss decreased (-0.805547 --> -0.822215).  Saving model ...
Epoch: 22 cost time: 2.0162487030029297
Epoch: 22, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.697 Vali Acc: 0.839 Test Loss: 0.697 Test Acc: 0.839
Validation loss decreased (-0.822215 --> -0.838882).  Saving model ...
Epoch: 23 cost time: 1.8909196853637695
Epoch: 23, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.644 Vali Acc: 0.817 Test Loss: 0.644 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8831679821014404
Epoch: 24, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.599 Vali Acc: 0.839 Test Loss: 0.599 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838883).  Saving model ...
Epoch: 25 cost time: 1.892519474029541
Epoch: 25, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.582 Vali Acc: 0.861 Test Loss: 0.582 Test Acc: 0.861
Validation loss decreased (-0.838883 --> -0.861105).  Saving model ...
Epoch: 26 cost time: 1.5502800941467285
Epoch: 26, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.561 Vali Acc: 0.856 Test Loss: 0.561 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.680051565170288
Epoch: 27, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.569 Vali Acc: 0.850 Test Loss: 0.569 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8085191249847412
Epoch: 28, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.549 Vali Acc: 0.856 Test Loss: 0.549 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.2626473903656006
Epoch: 29, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.553 Vali Acc: 0.861 Test Loss: 0.553 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861106).  Saving model ...
Epoch: 30 cost time: 1.7890896797180176
Epoch: 30, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.524 Vali Acc: 0.867 Test Loss: 0.524 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 31 cost time: 1.8795089721679688
Epoch: 31, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.541 Vali Acc: 0.872 Test Loss: 0.541 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 32 cost time: 2.100919485092163
Epoch: 32, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.523 Vali Acc: 0.878 Test Loss: 0.523 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 33 cost time: 1.830378770828247
Epoch: 33, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.530 Vali Acc: 0.889 Test Loss: 0.530 Test Acc: 0.889
Validation loss decreased (-0.877773 --> -0.888884).  Saving model ...
Epoch: 34 cost time: 1.859116792678833
Epoch: 34, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.491 Vali Acc: 0.872 Test Loss: 0.491 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.9064083099365234
Epoch: 35, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.513 Vali Acc: 0.861 Test Loss: 0.513 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.4857618808746338
Epoch: 36, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.502 Vali Acc: 0.861 Test Loss: 0.502 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.703310251235962
Epoch: 37, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.513 Vali Acc: 0.856 Test Loss: 0.513 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.9363768100738525
Epoch: 38, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.539 Vali Acc: 0.850 Test Loss: 0.539 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.835355281829834
Epoch: 39, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.536 Vali Acc: 0.872 Test Loss: 0.536 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.6255266666412354
Epoch: 40, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.483 Vali Acc: 0.872 Test Loss: 0.483 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.809173345565796
Epoch: 41, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.489 Vali Acc: 0.889 Test Loss: 0.489 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 42 cost time: 1.8806674480438232
Epoch: 42, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.469 Vali Acc: 0.878 Test Loss: 0.469 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.735124111175537
Epoch: 43, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.484 Vali Acc: 0.872 Test Loss: 0.484 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.935863733291626
Epoch: 44, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.502 Vali Acc: 0.889 Test Loss: 0.502 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.5950515270233154
Epoch: 45, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.475 Vali Acc: 0.894 Test Loss: 0.475 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894440).  Saving model ...
Epoch: 46 cost time: 1.734734296798706
Epoch: 46, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.518 Vali Acc: 0.883 Test Loss: 0.518 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.765549898147583
Epoch: 47, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.482 Vali Acc: 0.894 Test Loss: 0.482 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.6609697341918945
Epoch: 48, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.495 Vali Acc: 0.894 Test Loss: 0.495 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.7487943172454834
Epoch: 49, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.493 Vali Acc: 0.889 Test Loss: 0.493 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 2.0590009689331055
Epoch: 50, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.518 Vali Acc: 0.889 Test Loss: 0.518 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 2.017975091934204
Epoch: 51, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.516 Vali Acc: 0.883 Test Loss: 0.516 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.7824182510375977
Epoch: 52, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.470 Vali Acc: 0.900 Test Loss: 0.470 Test Acc: 0.900
Validation loss decreased (-0.894440 --> -0.899995).  Saving model ...
Epoch: 53 cost time: 1.9878764152526855
Epoch: 53, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.490 Vali Acc: 0.883 Test Loss: 0.490 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.826674461364746
Epoch: 54, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.530 Vali Acc: 0.894 Test Loss: 0.530 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.8932371139526367
Epoch: 55, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.511 Vali Acc: 0.894 Test Loss: 0.511 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.78763747215271
Epoch: 56, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.519 Vali Acc: 0.900 Test Loss: 0.519 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.7454187870025635
Epoch: 57, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.542 Vali Acc: 0.889 Test Loss: 0.542 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.800110101699829
Epoch: 58, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.527 Vali Acc: 0.883 Test Loss: 0.527 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 2.162834405899048
Epoch: 59, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.531 Vali Acc: 0.889 Test Loss: 0.531 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 2.0772008895874023
Epoch: 60, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.521 Vali Acc: 0.883 Test Loss: 0.521 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 2.050168037414551
Epoch: 61, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.521 Vali Acc: 0.883 Test Loss: 0.521 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 1.6718382835388184
Epoch: 62, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.534 Vali Acc: 0.894 Test Loss: 0.534 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 711231
model size : 4.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.775277614593506
Epoch: 1, Steps: 12 | Train Loss: 2.815 Vali Loss: 2.780 Vali Acc: 0.094 Test Loss: 2.780 Test Acc: 0.094
Validation loss decreased (inf --> -0.094417).  Saving model ...
Epoch: 2 cost time: 1.8550822734832764
Epoch: 2, Steps: 12 | Train Loss: 2.743 Vali Loss: 2.670 Vali Acc: 0.144 Test Loss: 2.670 Test Acc: 0.144
Validation loss decreased (-0.094417 --> -0.144418).  Saving model ...
Epoch: 3 cost time: 1.932197093963623
Epoch: 3, Steps: 12 | Train Loss: 2.615 Vali Loss: 2.565 Vali Acc: 0.206 Test Loss: 2.565 Test Acc: 0.206
Validation loss decreased (-0.144418 --> -0.205530).  Saving model ...
Epoch: 4 cost time: 2.1447720527648926
Epoch: 4, Steps: 12 | Train Loss: 2.531 Vali Loss: 2.448 Vali Acc: 0.367 Test Loss: 2.448 Test Acc: 0.367
Validation loss decreased (-0.205530 --> -0.366642).  Saving model ...
Epoch: 5 cost time: 2.087212562561035
Epoch: 5, Steps: 12 | Train Loss: 2.292 Vali Loss: 2.240 Vali Acc: 0.383 Test Loss: 2.240 Test Acc: 0.383
Validation loss decreased (-0.366642 --> -0.383311).  Saving model ...
Epoch: 6 cost time: 1.916623592376709
Epoch: 6, Steps: 12 | Train Loss: 2.076 Vali Loss: 2.051 Vali Acc: 0.406 Test Loss: 2.051 Test Acc: 0.406
Validation loss decreased (-0.383311 --> -0.405535).  Saving model ...
Epoch: 7 cost time: 2.3723607063293457
Epoch: 7, Steps: 12 | Train Loss: 1.916 Vali Loss: 1.901 Vali Acc: 0.483 Test Loss: 1.901 Test Acc: 0.483
Validation loss decreased (-0.405535 --> -0.483314).  Saving model ...
Epoch: 8 cost time: 1.7037460803985596
Epoch: 8, Steps: 12 | Train Loss: 1.730 Vali Loss: 1.752 Vali Acc: 0.544 Test Loss: 1.752 Test Acc: 0.544
Validation loss decreased (-0.483314 --> -0.544427).  Saving model ...
Epoch: 9 cost time: 2.021023988723755
Epoch: 9, Steps: 12 | Train Loss: 1.517 Vali Loss: 1.638 Vali Acc: 0.622 Test Loss: 1.638 Test Acc: 0.622
Validation loss decreased (-0.544427 --> -0.622206).  Saving model ...
Epoch: 10 cost time: 2.163867235183716
Epoch: 10, Steps: 12 | Train Loss: 1.465 Vali Loss: 1.528 Vali Acc: 0.617 Test Loss: 1.528 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.925311803817749
Epoch: 11, Steps: 12 | Train Loss: 1.324 Vali Loss: 1.440 Vali Acc: 0.689 Test Loss: 1.440 Test Acc: 0.689
Validation loss decreased (-0.622206 --> -0.688874).  Saving model ...
Epoch: 12 cost time: 2.089705228805542
Epoch: 12, Steps: 12 | Train Loss: 1.210 Vali Loss: 1.338 Vali Acc: 0.678 Test Loss: 1.338 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7395849227905273
Epoch: 13, Steps: 12 | Train Loss: 1.094 Vali Loss: 1.231 Vali Acc: 0.739 Test Loss: 1.231 Test Acc: 0.739
Validation loss decreased (-0.688874 --> -0.738877).  Saving model ...
Epoch: 14 cost time: 2.3322625160217285
Epoch: 14, Steps: 12 | Train Loss: 0.998 Vali Loss: 1.131 Vali Acc: 0.717 Test Loss: 1.131 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8090901374816895
Epoch: 15, Steps: 12 | Train Loss: 0.867 Vali Loss: 1.066 Vali Acc: 0.728 Test Loss: 1.066 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7380664348602295
Epoch: 16, Steps: 12 | Train Loss: 0.792 Vali Loss: 0.979 Vali Acc: 0.778 Test Loss: 0.979 Test Acc: 0.778
Validation loss decreased (-0.738877 --> -0.777768).  Saving model ...
Epoch: 17 cost time: 2.1488003730773926
Epoch: 17, Steps: 12 | Train Loss: 0.732 Vali Loss: 0.899 Vali Acc: 0.761 Test Loss: 0.899 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7373387813568115
Epoch: 18, Steps: 12 | Train Loss: 0.719 Vali Loss: 0.949 Vali Acc: 0.711 Test Loss: 0.949 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.2215356826782227
Epoch: 19, Steps: 12 | Train Loss: 0.670 Vali Loss: 0.826 Vali Acc: 0.789 Test Loss: 0.826 Test Acc: 0.789
Validation loss decreased (-0.777768 --> -0.788881).  Saving model ...
Epoch: 20 cost time: 2.0256924629211426
Epoch: 20, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.755 Vali Acc: 0.833 Test Loss: 0.755 Test Acc: 0.833
Validation loss decreased (-0.788881 --> -0.833326).  Saving model ...
Epoch: 21 cost time: 2.341427803039551
Epoch: 21, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.722 Vali Acc: 0.839 Test Loss: 0.722 Test Acc: 0.839
Validation loss decreased (-0.833326 --> -0.838882).  Saving model ...
Epoch: 22 cost time: 2.1588006019592285
Epoch: 22, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.702 Vali Acc: 0.850 Test Loss: 0.702 Test Acc: 0.850
Validation loss decreased (-0.838882 --> -0.849993).  Saving model ...
Epoch: 23 cost time: 2.050339460372925
Epoch: 23, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.676 Vali Acc: 0.828 Test Loss: 0.676 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.0359442234039307
Epoch: 24, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.635 Vali Acc: 0.850 Test Loss: 0.635 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 25 cost time: 1.659982442855835
Epoch: 25, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.604 Vali Acc: 0.839 Test Loss: 0.604 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.419914960861206
Epoch: 26, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.565 Vali Acc: 0.844 Test Loss: 0.565 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.062734842300415
Epoch: 27, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.596 Vali Acc: 0.861 Test Loss: 0.596 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 28 cost time: 2.0839054584503174
Epoch: 28, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.566 Vali Acc: 0.856 Test Loss: 0.566 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.8345422744750977
Epoch: 29, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.521 Vali Acc: 0.878 Test Loss: 0.521 Test Acc: 0.878
Validation loss decreased (-0.861105 --> -0.877773).  Saving model ...
Epoch: 30 cost time: 2.0251526832580566
Epoch: 30, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.512 Vali Acc: 0.878 Test Loss: 0.512 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 31 cost time: 1.9214067459106445
Epoch: 31, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.502 Vali Acc: 0.861 Test Loss: 0.502 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.1991896629333496
Epoch: 32, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.550 Vali Acc: 0.861 Test Loss: 0.550 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.210066556930542
Epoch: 33, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.516 Vali Acc: 0.878 Test Loss: 0.516 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.8653926849365234
Epoch: 34, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.485 Vali Acc: 0.878 Test Loss: 0.485 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 35 cost time: 1.9534354209899902
Epoch: 35, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.499 Vali Acc: 0.867 Test Loss: 0.499 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.9363915920257568
Epoch: 36, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.521 Vali Acc: 0.872 Test Loss: 0.521 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.199979305267334
Epoch: 37, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.523 Vali Acc: 0.883 Test Loss: 0.523 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883328).  Saving model ...
Epoch: 38 cost time: 1.874457597732544
Epoch: 38, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.527 Vali Acc: 0.872 Test Loss: 0.527 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.167253255844116
Epoch: 39, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.563 Vali Acc: 0.878 Test Loss: 0.563 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.284393310546875
Epoch: 40, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.513 Vali Acc: 0.872 Test Loss: 0.513 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.8997130393981934
Epoch: 41, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.541 Vali Acc: 0.878 Test Loss: 0.541 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.2791905403137207
Epoch: 42, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.520 Vali Acc: 0.883 Test Loss: 0.520 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883328).  Saving model ...
Epoch: 43 cost time: 2.3798775672912598
Epoch: 43, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.508 Vali Acc: 0.878 Test Loss: 0.508 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.2688841819763184
Epoch: 44, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.531 Vali Acc: 0.872 Test Loss: 0.531 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.5185964107513428
Epoch: 45, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.547 Vali Acc: 0.889 Test Loss: 0.547 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888883).  Saving model ...
Epoch: 46 cost time: 2.0601818561553955
Epoch: 46, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.573 Vali Acc: 0.878 Test Loss: 0.573 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.7392394542694092
Epoch: 47, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.620 Vali Acc: 0.872 Test Loss: 0.620 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.9124674797058105
Epoch: 48, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.551 Vali Acc: 0.867 Test Loss: 0.551 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.8666300773620605
Epoch: 49, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.562 Vali Acc: 0.861 Test Loss: 0.562 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.9251368045806885
Epoch: 50, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.547 Vali Acc: 0.878 Test Loss: 0.547 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.8250079154968262
Epoch: 51, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.525 Vali Acc: 0.878 Test Loss: 0.525 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 2.095146656036377
Epoch: 52, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.547 Vali Acc: 0.872 Test Loss: 0.547 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.7020719051361084
Epoch: 53, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.557 Vali Acc: 0.883 Test Loss: 0.557 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.8327994346618652
Epoch: 54, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.573 Vali Acc: 0.883 Test Loss: 0.573 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 2.02439546585083
Epoch: 55, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.572 Vali Acc: 0.883 Test Loss: 0.572 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 710783
model size : 4.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.558330774307251
Epoch: 1, Steps: 12 | Train Loss: 2.810 Vali Loss: 2.753 Vali Acc: 0.067 Test Loss: 2.753 Test Acc: 0.067
Validation loss decreased (inf --> -0.066639).  Saving model ...
Epoch: 2 cost time: 1.6350440979003906
Epoch: 2, Steps: 12 | Train Loss: 2.755 Vali Loss: 2.653 Vali Acc: 0.083 Test Loss: 2.653 Test Acc: 0.083
Validation loss decreased (-0.066639 --> -0.083307).  Saving model ...
Epoch: 3 cost time: 1.5970752239227295
Epoch: 3, Steps: 12 | Train Loss: 2.657 Vali Loss: 2.566 Vali Acc: 0.211 Test Loss: 2.566 Test Acc: 0.211
Validation loss decreased (-0.083307 --> -0.211085).  Saving model ...
Epoch: 4 cost time: 1.4477500915527344
Epoch: 4, Steps: 12 | Train Loss: 2.511 Vali Loss: 2.450 Vali Acc: 0.283 Test Loss: 2.450 Test Acc: 0.283
Validation loss decreased (-0.211085 --> -0.283309).  Saving model ...
Epoch: 5 cost time: 1.9598541259765625
Epoch: 5, Steps: 12 | Train Loss: 2.391 Vali Loss: 2.274 Vali Acc: 0.400 Test Loss: 2.274 Test Acc: 0.400
Validation loss decreased (-0.283309 --> -0.399977).  Saving model ...
Epoch: 6 cost time: 1.7977604866027832
Epoch: 6, Steps: 12 | Train Loss: 2.180 Vali Loss: 2.083 Vali Acc: 0.444 Test Loss: 2.083 Test Acc: 0.444
Validation loss decreased (-0.399977 --> -0.444424).  Saving model ...
Epoch: 7 cost time: 1.805267333984375
Epoch: 7, Steps: 12 | Train Loss: 1.986 Vali Loss: 1.875 Vali Acc: 0.544 Test Loss: 1.875 Test Acc: 0.544
Validation loss decreased (-0.444424 --> -0.544426).  Saving model ...
Epoch: 8 cost time: 1.8366096019744873
Epoch: 8, Steps: 12 | Train Loss: 1.782 Vali Loss: 1.717 Vali Acc: 0.544 Test Loss: 1.717 Test Acc: 0.544
Validation loss decreased (-0.544426 --> -0.544427).  Saving model ...
Epoch: 9 cost time: 1.911026954650879
Epoch: 9, Steps: 12 | Train Loss: 1.589 Vali Loss: 1.583 Vali Acc: 0.617 Test Loss: 1.583 Test Acc: 0.617
Validation loss decreased (-0.544427 --> -0.616651).  Saving model ...
Epoch: 10 cost time: 1.473491907119751
Epoch: 10, Steps: 12 | Train Loss: 1.454 Vali Loss: 1.476 Vali Acc: 0.678 Test Loss: 1.476 Test Acc: 0.678
Validation loss decreased (-0.616651 --> -0.677763).  Saving model ...
Epoch: 11 cost time: 1.8659467697143555
Epoch: 11, Steps: 12 | Train Loss: 1.305 Vali Loss: 1.398 Vali Acc: 0.689 Test Loss: 1.398 Test Acc: 0.689
Validation loss decreased (-0.677763 --> -0.688875).  Saving model ...
Epoch: 12 cost time: 1.8278374671936035
Epoch: 12, Steps: 12 | Train Loss: 1.200 Vali Loss: 1.302 Vali Acc: 0.689 Test Loss: 1.302 Test Acc: 0.689
Validation loss decreased (-0.688875 --> -0.688876).  Saving model ...
Epoch: 13 cost time: 1.6503150463104248
Epoch: 13, Steps: 12 | Train Loss: 1.171 Vali Loss: 1.227 Vali Acc: 0.722 Test Loss: 1.227 Test Acc: 0.722
Validation loss decreased (-0.688876 --> -0.722210).  Saving model ...
Epoch: 14 cost time: 1.5326189994812012
Epoch: 14, Steps: 12 | Train Loss: 1.029 Vali Loss: 1.140 Vali Acc: 0.739 Test Loss: 1.140 Test Acc: 0.739
Validation loss decreased (-0.722210 --> -0.738877).  Saving model ...
Epoch: 15 cost time: 1.652233362197876
Epoch: 15, Steps: 12 | Train Loss: 0.945 Vali Loss: 1.069 Vali Acc: 0.717 Test Loss: 1.069 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7877094745635986
Epoch: 16, Steps: 12 | Train Loss: 0.874 Vali Loss: 1.011 Vali Acc: 0.733 Test Loss: 1.011 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.771348476409912
Epoch: 17, Steps: 12 | Train Loss: 0.771 Vali Loss: 0.949 Vali Acc: 0.739 Test Loss: 0.949 Test Acc: 0.739
Validation loss decreased (-0.738877 --> -0.738879).  Saving model ...
Epoch: 18 cost time: 1.8272979259490967
Epoch: 18, Steps: 12 | Train Loss: 0.731 Vali Loss: 0.917 Vali Acc: 0.767 Test Loss: 0.917 Test Acc: 0.767
Validation loss decreased (-0.738879 --> -0.766657).  Saving model ...
Epoch: 19 cost time: 1.963850498199463
Epoch: 19, Steps: 12 | Train Loss: 0.620 Vali Loss: 0.830 Vali Acc: 0.778 Test Loss: 0.830 Test Acc: 0.778
Validation loss decreased (-0.766657 --> -0.777769).  Saving model ...
Epoch: 20 cost time: 1.7804179191589355
Epoch: 20, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.773 Vali Acc: 0.794 Test Loss: 0.773 Test Acc: 0.794
Validation loss decreased (-0.777769 --> -0.794437).  Saving model ...
Epoch: 21 cost time: 1.6477832794189453
Epoch: 21, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.755 Vali Acc: 0.794 Test Loss: 0.755 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794437).  Saving model ...
Epoch: 22 cost time: 2.2195394039154053
Epoch: 22, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.725 Vali Acc: 0.789 Test Loss: 0.725 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.819143295288086
Epoch: 23, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.652 Vali Acc: 0.817 Test Loss: 0.652 Test Acc: 0.817
Validation loss decreased (-0.794437 --> -0.816660).  Saving model ...
Epoch: 24 cost time: 1.7858669757843018
Epoch: 24, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.647 Vali Acc: 0.817 Test Loss: 0.647 Test Acc: 0.817
Validation loss decreased (-0.816660 --> -0.816660).  Saving model ...
Epoch: 25 cost time: 1.6502325534820557
Epoch: 25, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.669 Vali Acc: 0.811 Test Loss: 0.669 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6592473983764648
Epoch: 26, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.553 Vali Acc: 0.822 Test Loss: 0.553 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822217).  Saving model ...
Epoch: 27 cost time: 1.8221638202667236
Epoch: 27, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.588 Vali Acc: 0.828 Test Loss: 0.588 Test Acc: 0.828
Validation loss decreased (-0.822217 --> -0.827772).  Saving model ...
Epoch: 28 cost time: 1.9801321029663086
Epoch: 28, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.555 Vali Acc: 0.839 Test Loss: 0.555 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838883).  Saving model ...
Epoch: 29 cost time: 1.874614953994751
Epoch: 29, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.577 Vali Acc: 0.833 Test Loss: 0.577 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.8032166957855225
Epoch: 30, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.523 Vali Acc: 0.850 Test Loss: 0.523 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849995).  Saving model ...
Epoch: 31 cost time: 1.616236925125122
Epoch: 31, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.527 Vali Acc: 0.861 Test Loss: 0.527 Test Acc: 0.861
Validation loss decreased (-0.849995 --> -0.861106).  Saving model ...
Epoch: 32 cost time: 1.886216640472412
Epoch: 32, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.542 Vali Acc: 0.839 Test Loss: 0.542 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.801532506942749
Epoch: 33, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.532 Vali Acc: 0.867 Test Loss: 0.532 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 34 cost time: 1.7358088493347168
Epoch: 34, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.515 Vali Acc: 0.861 Test Loss: 0.515 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.899082899093628
Epoch: 35, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.550 Vali Acc: 0.861 Test Loss: 0.550 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.7183542251586914
Epoch: 36, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.478 Vali Acc: 0.872 Test Loss: 0.478 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 37 cost time: 1.896934986114502
Epoch: 37, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.555 Vali Acc: 0.850 Test Loss: 0.555 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.6876797676086426
Epoch: 38, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.509 Vali Acc: 0.867 Test Loss: 0.509 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.9154267311096191
Epoch: 39, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.523 Vali Acc: 0.867 Test Loss: 0.523 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.045710325241089
Epoch: 40, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.536 Vali Acc: 0.867 Test Loss: 0.536 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.191699266433716
Epoch: 41, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.551 Vali Acc: 0.856 Test Loss: 0.551 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.8762664794921875
Epoch: 42, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.529 Vali Acc: 0.867 Test Loss: 0.529 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.64975905418396
Epoch: 43, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.484 Vali Acc: 0.878 Test Loss: 0.484 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 44 cost time: 1.6714792251586914
Epoch: 44, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.526 Vali Acc: 0.867 Test Loss: 0.526 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.7954914569854736
Epoch: 45, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.538 Vali Acc: 0.861 Test Loss: 0.538 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.6917476654052734
Epoch: 46, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.559 Vali Acc: 0.861 Test Loss: 0.559 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.097590208053589
Epoch: 47, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.525 Vali Acc: 0.856 Test Loss: 0.525 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.89182448387146
Epoch: 48, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.577 Vali Acc: 0.861 Test Loss: 0.577 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.675938606262207
Epoch: 49, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.553 Vali Acc: 0.872 Test Loss: 0.553 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.843169927597046
Epoch: 50, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.550 Vali Acc: 0.878 Test Loss: 0.550 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.8276848793029785
Epoch: 51, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.554 Vali Acc: 0.867 Test Loss: 0.554 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.8981273174285889
Epoch: 52, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.576 Vali Acc: 0.867 Test Loss: 0.576 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.5723135471343994
Epoch: 53, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.559 Vali Acc: 0.867 Test Loss: 0.559 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 710335
model size : 4.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3493430614471436
Epoch: 1, Steps: 12 | Train Loss: 2.906 Vali Loss: 2.807 Vali Acc: 0.094 Test Loss: 2.807 Test Acc: 0.094
Validation loss decreased (inf --> -0.094416).  Saving model ...
Epoch: 2 cost time: 1.5504748821258545
Epoch: 2, Steps: 12 | Train Loss: 2.782 Vali Loss: 2.679 Vali Acc: 0.089 Test Loss: 2.679 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8353691101074219
Epoch: 3, Steps: 12 | Train Loss: 2.644 Vali Loss: 2.587 Vali Acc: 0.222 Test Loss: 2.587 Test Acc: 0.222
Validation loss decreased (-0.094416 --> -0.222196).  Saving model ...
Epoch: 4 cost time: 1.8019843101501465
Epoch: 4, Steps: 12 | Train Loss: 2.521 Vali Loss: 2.491 Vali Acc: 0.278 Test Loss: 2.491 Test Acc: 0.278
Validation loss decreased (-0.222196 --> -0.277753).  Saving model ...
Epoch: 5 cost time: 1.3557641506195068
Epoch: 5, Steps: 12 | Train Loss: 2.421 Vali Loss: 2.339 Vali Acc: 0.300 Test Loss: 2.339 Test Acc: 0.300
Validation loss decreased (-0.277753 --> -0.299977).  Saving model ...
Epoch: 6 cost time: 1.7606542110443115
Epoch: 6, Steps: 12 | Train Loss: 2.201 Vali Loss: 2.131 Vali Acc: 0.350 Test Loss: 2.131 Test Acc: 0.350
Validation loss decreased (-0.299977 --> -0.349979).  Saving model ...
Epoch: 7 cost time: 1.87900972366333
Epoch: 7, Steps: 12 | Train Loss: 1.943 Vali Loss: 1.929 Vali Acc: 0.456 Test Loss: 1.929 Test Acc: 0.456
Validation loss decreased (-0.349979 --> -0.455536).  Saving model ...
Epoch: 8 cost time: 1.907409906387329
Epoch: 8, Steps: 12 | Train Loss: 1.742 Vali Loss: 1.744 Vali Acc: 0.511 Test Loss: 1.744 Test Acc: 0.511
Validation loss decreased (-0.455536 --> -0.511094).  Saving model ...
Epoch: 9 cost time: 1.7262349128723145
Epoch: 9, Steps: 12 | Train Loss: 1.597 Vali Loss: 1.593 Vali Acc: 0.544 Test Loss: 1.593 Test Acc: 0.544
Validation loss decreased (-0.511094 --> -0.544429).  Saving model ...
Epoch: 10 cost time: 1.910463571548462
Epoch: 10, Steps: 12 | Train Loss: 1.472 Vali Loss: 1.467 Vali Acc: 0.600 Test Loss: 1.467 Test Acc: 0.600
Validation loss decreased (-0.544429 --> -0.599985).  Saving model ...
Epoch: 11 cost time: 1.7954387664794922
Epoch: 11, Steps: 12 | Train Loss: 1.376 Vali Loss: 1.346 Vali Acc: 0.644 Test Loss: 1.346 Test Acc: 0.644
Validation loss decreased (-0.599985 --> -0.644431).  Saving model ...
Epoch: 12 cost time: 1.7957329750061035
Epoch: 12, Steps: 12 | Train Loss: 1.159 Vali Loss: 1.235 Vali Acc: 0.683 Test Loss: 1.235 Test Acc: 0.683
Validation loss decreased (-0.644431 --> -0.683321).  Saving model ...
Epoch: 13 cost time: 1.7488760948181152
Epoch: 13, Steps: 12 | Train Loss: 1.086 Vali Loss: 1.140 Vali Acc: 0.722 Test Loss: 1.140 Test Acc: 0.722
Validation loss decreased (-0.683321 --> -0.722211).  Saving model ...
Epoch: 14 cost time: 2.0850017070770264
Epoch: 14, Steps: 12 | Train Loss: 0.980 Vali Loss: 1.035 Vali Acc: 0.694 Test Loss: 1.035 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8606336116790771
Epoch: 15, Steps: 12 | Train Loss: 0.966 Vali Loss: 0.993 Vali Acc: 0.733 Test Loss: 0.993 Test Acc: 0.733
Validation loss decreased (-0.722211 --> -0.733323).  Saving model ...
Epoch: 16 cost time: 1.7415564060211182
Epoch: 16, Steps: 12 | Train Loss: 0.821 Vali Loss: 0.883 Vali Acc: 0.750 Test Loss: 0.883 Test Acc: 0.750
Validation loss decreased (-0.733323 --> -0.749991).  Saving model ...
Epoch: 17 cost time: 1.6112425327301025
Epoch: 17, Steps: 12 | Train Loss: 0.761 Vali Loss: 0.803 Vali Acc: 0.800 Test Loss: 0.803 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799992).  Saving model ...
Epoch: 18 cost time: 1.5561246871948242
Epoch: 18, Steps: 12 | Train Loss: 0.658 Vali Loss: 0.757 Vali Acc: 0.817 Test Loss: 0.757 Test Acc: 0.817
Validation loss decreased (-0.799992 --> -0.816659).  Saving model ...
Epoch: 19 cost time: 1.6110024452209473
Epoch: 19, Steps: 12 | Train Loss: 0.587 Vali Loss: 0.705 Vali Acc: 0.817 Test Loss: 0.705 Test Acc: 0.817
Validation loss decreased (-0.816659 --> -0.816660).  Saving model ...
Epoch: 20 cost time: 1.9032275676727295
Epoch: 20, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.652 Vali Acc: 0.844 Test Loss: 0.652 Test Acc: 0.844
Validation loss decreased (-0.816660 --> -0.844438).  Saving model ...
Epoch: 21 cost time: 1.5620720386505127
Epoch: 21, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.626 Vali Acc: 0.828 Test Loss: 0.626 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.750807762145996
Epoch: 22, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.585 Vali Acc: 0.828 Test Loss: 0.585 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.739673137664795
Epoch: 23, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.562 Vali Acc: 0.867 Test Loss: 0.562 Test Acc: 0.867
Validation loss decreased (-0.844438 --> -0.866661).  Saving model ...
Epoch: 24 cost time: 1.4000470638275146
Epoch: 24, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.569 Vali Acc: 0.839 Test Loss: 0.569 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5842313766479492
Epoch: 25, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.512 Vali Acc: 0.856 Test Loss: 0.512 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.1826741695404053
Epoch: 26, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.520 Vali Acc: 0.856 Test Loss: 0.520 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.8665032386779785
Epoch: 27, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.487 Vali Acc: 0.861 Test Loss: 0.487 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.8469760417938232
Epoch: 28, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.458 Vali Acc: 0.861 Test Loss: 0.458 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.8941023349761963
Epoch: 29, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.504 Vali Acc: 0.861 Test Loss: 0.504 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.6471683979034424
Epoch: 30, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.461 Vali Acc: 0.867 Test Loss: 0.461 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866662).  Saving model ...
Epoch: 31 cost time: 1.4956820011138916
Epoch: 31, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.494 Vali Acc: 0.861 Test Loss: 0.494 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.8939967155456543
Epoch: 32, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.433 Vali Acc: 0.856 Test Loss: 0.433 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.965238332748413
Epoch: 33, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.479 Vali Acc: 0.878 Test Loss: 0.479 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877773).  Saving model ...
Epoch: 34 cost time: 1.595228910446167
Epoch: 34, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.442 Vali Acc: 0.872 Test Loss: 0.442 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.6763873100280762
Epoch: 35, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.446 Vali Acc: 0.856 Test Loss: 0.446 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.4483013153076172
Epoch: 36, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.502 Vali Acc: 0.861 Test Loss: 0.502 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.6973977088928223
Epoch: 37, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.462 Vali Acc: 0.872 Test Loss: 0.462 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.5040488243103027
Epoch: 38, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.486 Vali Acc: 0.889 Test Loss: 0.486 Test Acc: 0.889
Validation loss decreased (-0.877773 --> -0.888884).  Saving model ...
Epoch: 39 cost time: 1.7499125003814697
Epoch: 39, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.452 Vali Acc: 0.889 Test Loss: 0.452 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 40 cost time: 1.6377627849578857
Epoch: 40, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.460 Vali Acc: 0.878 Test Loss: 0.460 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.6231694221496582
Epoch: 41, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.491 Vali Acc: 0.883 Test Loss: 0.491 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.853477954864502
Epoch: 42, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.466 Vali Acc: 0.878 Test Loss: 0.466 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.1428754329681396
Epoch: 43, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.535 Vali Acc: 0.883 Test Loss: 0.535 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.6642887592315674
Epoch: 44, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.510 Vali Acc: 0.883 Test Loss: 0.510 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.6196279525756836
Epoch: 45, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.558 Vali Acc: 0.894 Test Loss: 0.558 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894439).  Saving model ...
Epoch: 46 cost time: 1.6703040599822998
Epoch: 46, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.472 Vali Acc: 0.889 Test Loss: 0.472 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.7694587707519531
Epoch: 47, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.478 Vali Acc: 0.878 Test Loss: 0.478 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.7835843563079834
Epoch: 48, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.510 Vali Acc: 0.889 Test Loss: 0.510 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.9938945770263672
Epoch: 49, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.527 Vali Acc: 0.894 Test Loss: 0.527 Test Acc: 0.894
Validation loss decreased (-0.894439 --> -0.894439).  Saving model ...
Epoch: 50 cost time: 1.4432222843170166
Epoch: 50, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.525 Vali Acc: 0.894 Test Loss: 0.525 Test Acc: 0.894
Validation loss decreased (-0.894439 --> -0.894439).  Saving model ...
Epoch: 51 cost time: 1.6125133037567139
Epoch: 51, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.529 Vali Acc: 0.883 Test Loss: 0.529 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.5671701431274414
Epoch: 52, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.504 Vali Acc: 0.889 Test Loss: 0.504 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.939004898071289
Epoch: 53, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.505 Vali Acc: 0.889 Test Loss: 0.505 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.685256004333496
Epoch: 54, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.541 Vali Acc: 0.889 Test Loss: 0.541 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.6243953704833984
Epoch: 55, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.541 Vali Acc: 0.889 Test Loss: 0.541 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.7620282173156738
Epoch: 56, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.541 Vali Acc: 0.889 Test Loss: 0.541 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.7200558185577393
Epoch: 57, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.540 Vali Acc: 0.894 Test Loss: 0.540 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.5880122184753418
Epoch: 58, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.551 Vali Acc: 0.889 Test Loss: 0.551 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.6939313411712646
Epoch: 59, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.542 Vali Acc: 0.889 Test Loss: 0.542 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.8387134075164795
Epoch: 60, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.535 Vali Acc: 0.894 Test Loss: 0.535 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 709887
model size : 4.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.143603801727295
Epoch: 1, Steps: 12 | Train Loss: 2.869 Vali Loss: 2.755 Vali Acc: 0.061 Test Loss: 2.755 Test Acc: 0.061
Validation loss decreased (inf --> -0.061084).  Saving model ...
Epoch: 2 cost time: 1.7393157482147217
Epoch: 2, Steps: 12 | Train Loss: 2.724 Vali Loss: 2.627 Vali Acc: 0.111 Test Loss: 2.627 Test Acc: 0.111
Validation loss decreased (-0.061084 --> -0.111085).  Saving model ...
Epoch: 3 cost time: 1.8827989101409912
Epoch: 3, Steps: 12 | Train Loss: 2.662 Vali Loss: 2.551 Vali Acc: 0.178 Test Loss: 2.551 Test Acc: 0.178
Validation loss decreased (-0.111085 --> -0.177752).  Saving model ...
Epoch: 4 cost time: 1.5708448886871338
Epoch: 4, Steps: 12 | Train Loss: 2.570 Vali Loss: 2.444 Vali Acc: 0.272 Test Loss: 2.444 Test Acc: 0.272
Validation loss decreased (-0.177752 --> -0.272198).  Saving model ...
Epoch: 5 cost time: 1.7388412952423096
Epoch: 5, Steps: 12 | Train Loss: 2.399 Vali Loss: 2.311 Vali Acc: 0.389 Test Loss: 2.311 Test Acc: 0.389
Validation loss decreased (-0.272198 --> -0.388866).  Saving model ...
Epoch: 6 cost time: 1.666942834854126
Epoch: 6, Steps: 12 | Train Loss: 2.205 Vali Loss: 2.143 Vali Acc: 0.472 Test Loss: 2.143 Test Acc: 0.472
Validation loss decreased (-0.388866 --> -0.472201).  Saving model ...
Epoch: 7 cost time: 1.9008705615997314
Epoch: 7, Steps: 12 | Train Loss: 2.074 Vali Loss: 2.014 Vali Acc: 0.483 Test Loss: 2.014 Test Acc: 0.483
Validation loss decreased (-0.472201 --> -0.483313).  Saving model ...
Epoch: 8 cost time: 1.609985589981079
Epoch: 8, Steps: 12 | Train Loss: 1.839 Vali Loss: 1.842 Vali Acc: 0.533 Test Loss: 1.842 Test Acc: 0.533
Validation loss decreased (-0.483313 --> -0.533315).  Saving model ...
Epoch: 9 cost time: 1.4596278667449951
Epoch: 9, Steps: 12 | Train Loss: 1.676 Vali Loss: 1.719 Vali Acc: 0.578 Test Loss: 1.719 Test Acc: 0.578
Validation loss decreased (-0.533315 --> -0.577761).  Saving model ...
Epoch: 10 cost time: 1.689751386642456
Epoch: 10, Steps: 12 | Train Loss: 1.558 Vali Loss: 1.616 Vali Acc: 0.633 Test Loss: 1.616 Test Acc: 0.633
Validation loss decreased (-0.577761 --> -0.633317).  Saving model ...
Epoch: 11 cost time: 1.841334581375122
Epoch: 11, Steps: 12 | Train Loss: 1.432 Vali Loss: 1.532 Vali Acc: 0.622 Test Loss: 1.532 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7378926277160645
Epoch: 12, Steps: 12 | Train Loss: 1.356 Vali Loss: 1.424 Vali Acc: 0.672 Test Loss: 1.424 Test Acc: 0.672
Validation loss decreased (-0.633317 --> -0.672208).  Saving model ...
Epoch: 13 cost time: 2.15063214302063
Epoch: 13, Steps: 12 | Train Loss: 1.236 Vali Loss: 1.302 Vali Acc: 0.706 Test Loss: 1.302 Test Acc: 0.706
Validation loss decreased (-0.672208 --> -0.705543).  Saving model ...
Epoch: 14 cost time: 1.7158503532409668
Epoch: 14, Steps: 12 | Train Loss: 1.139 Vali Loss: 1.221 Vali Acc: 0.700 Test Loss: 1.221 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0593764781951904
Epoch: 15, Steps: 12 | Train Loss: 1.053 Vali Loss: 1.161 Vali Acc: 0.711 Test Loss: 1.161 Test Acc: 0.711
Validation loss decreased (-0.705543 --> -0.711100).  Saving model ...
Epoch: 16 cost time: 1.9899592399597168
Epoch: 16, Steps: 12 | Train Loss: 0.931 Vali Loss: 1.097 Vali Acc: 0.733 Test Loss: 1.097 Test Acc: 0.733
Validation loss decreased (-0.711100 --> -0.733322).  Saving model ...
Epoch: 17 cost time: 2.451303005218506
Epoch: 17, Steps: 12 | Train Loss: 0.922 Vali Loss: 1.002 Vali Acc: 0.767 Test Loss: 1.002 Test Acc: 0.767
Validation loss decreased (-0.733322 --> -0.766657).  Saving model ...
Epoch: 18 cost time: 2.082165241241455
Epoch: 18, Steps: 12 | Train Loss: 0.868 Vali Loss: 0.997 Vali Acc: 0.750 Test Loss: 0.997 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.2168099880218506
Epoch: 19, Steps: 12 | Train Loss: 0.753 Vali Loss: 0.856 Vali Acc: 0.778 Test Loss: 0.856 Test Acc: 0.778
Validation loss decreased (-0.766657 --> -0.777769).  Saving model ...
Epoch: 20 cost time: 1.9642441272735596
Epoch: 20, Steps: 12 | Train Loss: 0.668 Vali Loss: 0.821 Vali Acc: 0.789 Test Loss: 0.821 Test Acc: 0.789
Validation loss decreased (-0.777769 --> -0.788881).  Saving model ...
Epoch: 21 cost time: 1.967585802078247
Epoch: 21, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.800 Vali Acc: 0.783 Test Loss: 0.800 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6689856052398682
Epoch: 22, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.745 Vali Acc: 0.794 Test Loss: 0.745 Test Acc: 0.794
Validation loss decreased (-0.788881 --> -0.794437).  Saving model ...
Epoch: 23 cost time: 1.8255138397216797
Epoch: 23, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.697 Vali Acc: 0.772 Test Loss: 0.697 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.0169408321380615
Epoch: 24, Steps: 12 | Train Loss: 0.482 Vali Loss: 0.679 Vali Acc: 0.822 Test Loss: 0.679 Test Acc: 0.822
Validation loss decreased (-0.794437 --> -0.822215).  Saving model ...
Epoch: 25 cost time: 2.2984917163848877
Epoch: 25, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.686 Vali Acc: 0.817 Test Loss: 0.686 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.982832431793213
Epoch: 26, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.596 Vali Acc: 0.844 Test Loss: 0.596 Test Acc: 0.844
Validation loss decreased (-0.822215 --> -0.844438).  Saving model ...
Epoch: 27 cost time: 2.2221338748931885
Epoch: 27, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.609 Vali Acc: 0.844 Test Loss: 0.609 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.3539605140686035
Epoch: 28, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.555 Vali Acc: 0.850 Test Loss: 0.555 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 29 cost time: 2.059572219848633
Epoch: 29, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 30 cost time: 1.8023715019226074
Epoch: 30, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.523 Vali Acc: 0.856 Test Loss: 0.523 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855550).  Saving model ...
Epoch: 31 cost time: 2.345332384109497
Epoch: 31, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.520 Vali Acc: 0.861 Test Loss: 0.520 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 32 cost time: 1.9774084091186523
Epoch: 32, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.530 Vali Acc: 0.867 Test Loss: 0.530 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 33 cost time: 2.081918239593506
Epoch: 33, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.463 Vali Acc: 0.872 Test Loss: 0.463 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872218).  Saving model ...
Epoch: 34 cost time: 1.8571608066558838
Epoch: 34, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.521 Vali Acc: 0.867 Test Loss: 0.521 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.9309077262878418
Epoch: 35, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.483 Vali Acc: 0.861 Test Loss: 0.483 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.0696003437042236
Epoch: 36, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.459 Vali Acc: 0.872 Test Loss: 0.459 Test Acc: 0.872
Validation loss decreased (-0.872218 --> -0.872218).  Saving model ...
Epoch: 37 cost time: 2.2302629947662354
Epoch: 37, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.460 Vali Acc: 0.872 Test Loss: 0.460 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.6752121448516846
Epoch: 38, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.446 Vali Acc: 0.878 Test Loss: 0.446 Test Acc: 0.878
Validation loss decreased (-0.872218 --> -0.877773).  Saving model ...
Epoch: 39 cost time: 2.1161577701568604
Epoch: 39, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.481 Vali Acc: 0.878 Test Loss: 0.481 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.9870777130126953
Epoch: 40, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.464 Vali Acc: 0.878 Test Loss: 0.464 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.5837576389312744
Epoch: 41, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.524 Vali Acc: 0.878 Test Loss: 0.524 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.869560956954956
Epoch: 42, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.484 Vali Acc: 0.861 Test Loss: 0.484 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.8438231945037842
Epoch: 43, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.493 Vali Acc: 0.872 Test Loss: 0.493 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.9929370880126953
Epoch: 44, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.506 Vali Acc: 0.867 Test Loss: 0.506 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.9564664363861084
Epoch: 45, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.477 Vali Acc: 0.878 Test Loss: 0.477 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.887683391571045
Epoch: 46, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.503 Vali Acc: 0.872 Test Loss: 0.503 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 2.0973293781280518
Epoch: 47, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.480 Vali Acc: 0.872 Test Loss: 0.480 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 2.0137813091278076
Epoch: 48, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.494 Vali Acc: 0.878 Test Loss: 0.494 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 595647
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.226779222488403
Epoch: 1, Steps: 12 | Train Loss: 2.803 Vali Loss: 2.700 Vali Acc: 0.089 Test Loss: 2.700 Test Acc: 0.089
Validation loss decreased (inf --> -0.088862).  Saving model ...
Epoch: 2 cost time: 1.801922082901001
Epoch: 2, Steps: 12 | Train Loss: 2.704 Vali Loss: 2.610 Vali Acc: 0.100 Test Loss: 2.610 Test Acc: 0.100
Validation loss decreased (-0.088862 --> -0.099974).  Saving model ...
Epoch: 3 cost time: 1.9731910228729248
Epoch: 3, Steps: 12 | Train Loss: 2.580 Vali Loss: 2.509 Vali Acc: 0.239 Test Loss: 2.509 Test Acc: 0.239
Validation loss decreased (-0.099974 --> -0.238864).  Saving model ...
Epoch: 4 cost time: 1.9974877834320068
Epoch: 4, Steps: 12 | Train Loss: 2.496 Vali Loss: 2.388 Vali Acc: 0.306 Test Loss: 2.388 Test Acc: 0.306
Validation loss decreased (-0.238864 --> -0.305532).  Saving model ...
Epoch: 5 cost time: 2.2744405269622803
Epoch: 5, Steps: 12 | Train Loss: 2.267 Vali Loss: 2.223 Vali Acc: 0.389 Test Loss: 2.223 Test Acc: 0.389
Validation loss decreased (-0.305532 --> -0.388867).  Saving model ...
Epoch: 6 cost time: 2.177649974822998
Epoch: 6, Steps: 12 | Train Loss: 2.104 Vali Loss: 2.050 Vali Acc: 0.461 Test Loss: 2.050 Test Acc: 0.461
Validation loss decreased (-0.388867 --> -0.461091).  Saving model ...
Epoch: 7 cost time: 2.265299081802368
Epoch: 7, Steps: 12 | Train Loss: 1.943 Vali Loss: 1.913 Vali Acc: 0.483 Test Loss: 1.913 Test Acc: 0.483
Validation loss decreased (-0.461091 --> -0.483314).  Saving model ...
Epoch: 8 cost time: 1.561086654663086
Epoch: 8, Steps: 12 | Train Loss: 1.767 Vali Loss: 1.784 Vali Acc: 0.556 Test Loss: 1.784 Test Acc: 0.556
Validation loss decreased (-0.483314 --> -0.555538).  Saving model ...
Epoch: 9 cost time: 2.0948634147644043
Epoch: 9, Steps: 12 | Train Loss: 1.636 Vali Loss: 1.672 Vali Acc: 0.578 Test Loss: 1.672 Test Acc: 0.578
Validation loss decreased (-0.555538 --> -0.577761).  Saving model ...
Epoch: 10 cost time: 1.939391851425171
Epoch: 10, Steps: 12 | Train Loss: 1.496 Vali Loss: 1.568 Vali Acc: 0.606 Test Loss: 1.568 Test Acc: 0.606
Validation loss decreased (-0.577761 --> -0.605540).  Saving model ...
Epoch: 11 cost time: 1.7659647464752197
Epoch: 11, Steps: 12 | Train Loss: 1.440 Vali Loss: 1.468 Vali Acc: 0.644 Test Loss: 1.468 Test Acc: 0.644
Validation loss decreased (-0.605540 --> -0.644430).  Saving model ...
Epoch: 12 cost time: 2.0892550945281982
Epoch: 12, Steps: 12 | Train Loss: 1.312 Vali Loss: 1.362 Vali Acc: 0.672 Test Loss: 1.362 Test Acc: 0.672
Validation loss decreased (-0.644430 --> -0.672209).  Saving model ...
Epoch: 13 cost time: 1.987379550933838
Epoch: 13, Steps: 12 | Train Loss: 1.188 Vali Loss: 1.313 Vali Acc: 0.661 Test Loss: 1.313 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1306674480438232
Epoch: 14, Steps: 12 | Train Loss: 1.102 Vali Loss: 1.226 Vali Acc: 0.667 Test Loss: 1.226 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.139801025390625
Epoch: 15, Steps: 12 | Train Loss: 1.000 Vali Loss: 1.129 Vali Acc: 0.717 Test Loss: 1.129 Test Acc: 0.717
Validation loss decreased (-0.672209 --> -0.716655).  Saving model ...
Epoch: 16 cost time: 1.7346961498260498
Epoch: 16, Steps: 12 | Train Loss: 0.994 Vali Loss: 1.069 Vali Acc: 0.717 Test Loss: 1.069 Test Acc: 0.717
Validation loss decreased (-0.716655 --> -0.716656).  Saving model ...
Epoch: 17 cost time: 1.9430582523345947
Epoch: 17, Steps: 12 | Train Loss: 0.846 Vali Loss: 0.986 Vali Acc: 0.761 Test Loss: 0.986 Test Acc: 0.761
Validation loss decreased (-0.716656 --> -0.761101).  Saving model ...
Epoch: 18 cost time: 2.064842939376831
Epoch: 18, Steps: 12 | Train Loss: 0.812 Vali Loss: 0.917 Vali Acc: 0.756 Test Loss: 0.917 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0199167728424072
Epoch: 19, Steps: 12 | Train Loss: 0.742 Vali Loss: 0.890 Vali Acc: 0.744 Test Loss: 0.890 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.763021469116211
Epoch: 20, Steps: 12 | Train Loss: 0.653 Vali Loss: 0.829 Vali Acc: 0.767 Test Loss: 0.829 Test Acc: 0.767
Validation loss decreased (-0.761101 --> -0.766658).  Saving model ...
Epoch: 21 cost time: 1.8073334693908691
Epoch: 21, Steps: 12 | Train Loss: 0.653 Vali Loss: 0.794 Vali Acc: 0.794 Test Loss: 0.794 Test Acc: 0.794
Validation loss decreased (-0.766658 --> -0.794437).  Saving model ...
Epoch: 22 cost time: 2.229796886444092
Epoch: 22, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.736 Vali Acc: 0.811 Test Loss: 0.736 Test Acc: 0.811
Validation loss decreased (-0.794437 --> -0.811104).  Saving model ...
Epoch: 23 cost time: 2.039797306060791
Epoch: 23, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.674 Vali Acc: 0.828 Test Loss: 0.674 Test Acc: 0.828
Validation loss decreased (-0.811104 --> -0.827771).  Saving model ...
Epoch: 24 cost time: 1.6285171508789062
Epoch: 24, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.657 Vali Acc: 0.833 Test Loss: 0.657 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 25 cost time: 1.6880054473876953
Epoch: 25, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.622 Vali Acc: 0.844 Test Loss: 0.622 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844438).  Saving model ...
Epoch: 26 cost time: 2.2214205265045166
Epoch: 26, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.590 Vali Acc: 0.856 Test Loss: 0.590 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855550).  Saving model ...
Epoch: 27 cost time: 1.8386836051940918
Epoch: 27, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.584 Vali Acc: 0.833 Test Loss: 0.584 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.245567560195923
Epoch: 28, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.555 Vali Acc: 0.856 Test Loss: 0.555 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 29 cost time: 1.6941783428192139
Epoch: 29, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.542 Vali Acc: 0.856 Test Loss: 0.542 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 30 cost time: 1.9809558391571045
Epoch: 30, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.530 Vali Acc: 0.861 Test Loss: 0.530 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 31 cost time: 1.7750420570373535
Epoch: 31, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.490 Vali Acc: 0.861 Test Loss: 0.490 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 32 cost time: 2.1125078201293945
Epoch: 32, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.507 Vali Acc: 0.844 Test Loss: 0.507 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.275498628616333
Epoch: 33, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.493 Vali Acc: 0.867 Test Loss: 0.493 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866662).  Saving model ...
Epoch: 34 cost time: 1.7118885517120361
Epoch: 34, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.470 Vali Acc: 0.889 Test Loss: 0.470 Test Acc: 0.889
Validation loss decreased (-0.866662 --> -0.888884).  Saving model ...
Epoch: 35 cost time: 1.9190616607666016
Epoch: 35, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.480 Vali Acc: 0.878 Test Loss: 0.480 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.9089891910552979
Epoch: 36, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.452 Vali Acc: 0.878 Test Loss: 0.452 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.088460683822632
Epoch: 37, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.475 Vali Acc: 0.872 Test Loss: 0.475 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.6755452156066895
Epoch: 38, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.475 Vali Acc: 0.889 Test Loss: 0.475 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.8463499546051025
Epoch: 39, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.463 Vali Acc: 0.894 Test Loss: 0.463 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894440).  Saving model ...
Epoch: 40 cost time: 2.56022310256958
Epoch: 40, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.481 Vali Acc: 0.872 Test Loss: 0.481 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.032755136489868
Epoch: 41, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.507 Vali Acc: 0.861 Test Loss: 0.507 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.946009635925293
Epoch: 42, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.452 Vali Acc: 0.883 Test Loss: 0.452 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.464860677719116
Epoch: 43, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.468 Vali Acc: 0.878 Test Loss: 0.468 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.9240901470184326
Epoch: 44, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.500 Vali Acc: 0.878 Test Loss: 0.500 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.7191858291625977
Epoch: 45, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.468 Vali Acc: 0.883 Test Loss: 0.468 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 2.3958001136779785
Epoch: 46, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.489 Vali Acc: 0.861 Test Loss: 0.489 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 2.1185109615325928
Epoch: 47, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.453 Vali Acc: 0.872 Test Loss: 0.453 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.9820878505706787
Epoch: 48, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.495 Vali Acc: 0.878 Test Loss: 0.495 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 2.1658225059509277
Epoch: 49, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.471 Vali Acc: 0.872 Test Loss: 0.471 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 595199
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.989079713821411
Epoch: 1, Steps: 12 | Train Loss: 2.854 Vali Loss: 2.803 Vali Acc: 0.133 Test Loss: 2.803 Test Acc: 0.133
Validation loss decreased (inf --> -0.133305).  Saving model ...
Epoch: 2 cost time: 1.7886264324188232
Epoch: 2, Steps: 12 | Train Loss: 2.750 Vali Loss: 2.668 Vali Acc: 0.189 Test Loss: 2.668 Test Acc: 0.189
Validation loss decreased (-0.133305 --> -0.188862).  Saving model ...
Epoch: 3 cost time: 1.5680146217346191
Epoch: 3, Steps: 12 | Train Loss: 2.647 Vali Loss: 2.562 Vali Acc: 0.239 Test Loss: 2.562 Test Acc: 0.239
Validation loss decreased (-0.188862 --> -0.238863).  Saving model ...
Epoch: 4 cost time: 1.6116538047790527
Epoch: 4, Steps: 12 | Train Loss: 2.537 Vali Loss: 2.462 Vali Acc: 0.344 Test Loss: 2.462 Test Acc: 0.344
Validation loss decreased (-0.238863 --> -0.344420).  Saving model ...
Epoch: 5 cost time: 1.4807708263397217
Epoch: 5, Steps: 12 | Train Loss: 2.425 Vali Loss: 2.332 Vali Acc: 0.433 Test Loss: 2.332 Test Acc: 0.433
Validation loss decreased (-0.344420 --> -0.433310).  Saving model ...
Epoch: 6 cost time: 1.603905200958252
Epoch: 6, Steps: 12 | Train Loss: 2.192 Vali Loss: 2.167 Vali Acc: 0.489 Test Loss: 2.167 Test Acc: 0.489
Validation loss decreased (-0.433310 --> -0.488867).  Saving model ...
Epoch: 7 cost time: 1.6125149726867676
Epoch: 7, Steps: 12 | Train Loss: 2.018 Vali Loss: 2.000 Vali Acc: 0.517 Test Loss: 2.000 Test Acc: 0.517
Validation loss decreased (-0.488867 --> -0.516647).  Saving model ...
Epoch: 8 cost time: 2.0461549758911133
Epoch: 8, Steps: 12 | Train Loss: 1.823 Vali Loss: 1.844 Vali Acc: 0.550 Test Loss: 1.844 Test Acc: 0.550
Validation loss decreased (-0.516647 --> -0.549982).  Saving model ...
Epoch: 9 cost time: 1.699213981628418
Epoch: 9, Steps: 12 | Train Loss: 1.697 Vali Loss: 1.739 Vali Acc: 0.578 Test Loss: 1.739 Test Acc: 0.578
Validation loss decreased (-0.549982 --> -0.577760).  Saving model ...
Epoch: 10 cost time: 1.5220043659210205
Epoch: 10, Steps: 12 | Train Loss: 1.531 Vali Loss: 1.617 Vali Acc: 0.578 Test Loss: 1.617 Test Acc: 0.578
Validation loss decreased (-0.577760 --> -0.577762).  Saving model ...
Epoch: 11 cost time: 2.081986665725708
Epoch: 11, Steps: 12 | Train Loss: 1.488 Vali Loss: 1.502 Vali Acc: 0.589 Test Loss: 1.502 Test Acc: 0.589
Validation loss decreased (-0.577762 --> -0.588874).  Saving model ...
Epoch: 12 cost time: 1.529520034790039
Epoch: 12, Steps: 12 | Train Loss: 1.366 Vali Loss: 1.421 Vali Acc: 0.622 Test Loss: 1.421 Test Acc: 0.622
Validation loss decreased (-0.588874 --> -0.622208).  Saving model ...
Epoch: 13 cost time: 1.703110933303833
Epoch: 13, Steps: 12 | Train Loss: 1.228 Vali Loss: 1.347 Vali Acc: 0.644 Test Loss: 1.347 Test Acc: 0.644
Validation loss decreased (-0.622208 --> -0.644431).  Saving model ...
Epoch: 14 cost time: 1.5242934226989746
Epoch: 14, Steps: 12 | Train Loss: 1.175 Vali Loss: 1.250 Vali Acc: 0.667 Test Loss: 1.250 Test Acc: 0.667
Validation loss decreased (-0.644431 --> -0.666654).  Saving model ...
Epoch: 15 cost time: 1.639552116394043
Epoch: 15, Steps: 12 | Train Loss: 1.100 Vali Loss: 1.192 Vali Acc: 0.711 Test Loss: 1.192 Test Acc: 0.711
Validation loss decreased (-0.666654 --> -0.711099).  Saving model ...
Epoch: 16 cost time: 1.6417765617370605
Epoch: 16, Steps: 12 | Train Loss: 1.001 Vali Loss: 1.109 Vali Acc: 0.728 Test Loss: 1.109 Test Acc: 0.728
Validation loss decreased (-0.711099 --> -0.727767).  Saving model ...
Epoch: 17 cost time: 2.041306972503662
Epoch: 17, Steps: 12 | Train Loss: 0.860 Vali Loss: 1.058 Vali Acc: 0.711 Test Loss: 1.058 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7328510284423828
Epoch: 18, Steps: 12 | Train Loss: 0.799 Vali Loss: 0.981 Vali Acc: 0.739 Test Loss: 0.981 Test Acc: 0.739
Validation loss decreased (-0.727767 --> -0.738879).  Saving model ...
Epoch: 19 cost time: 1.8138766288757324
Epoch: 19, Steps: 12 | Train Loss: 0.706 Vali Loss: 0.915 Vali Acc: 0.761 Test Loss: 0.915 Test Acc: 0.761
Validation loss decreased (-0.738879 --> -0.761102).  Saving model ...
Epoch: 20 cost time: 1.6406922340393066
Epoch: 20, Steps: 12 | Train Loss: 0.651 Vali Loss: 0.845 Vali Acc: 0.772 Test Loss: 0.845 Test Acc: 0.772
Validation loss decreased (-0.761102 --> -0.772214).  Saving model ...
Epoch: 21 cost time: 1.6860649585723877
Epoch: 21, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.844 Vali Acc: 0.778 Test Loss: 0.844 Test Acc: 0.778
Validation loss decreased (-0.772214 --> -0.777769).  Saving model ...
Epoch: 22 cost time: 1.5985021591186523
Epoch: 22, Steps: 12 | Train Loss: 0.531 Vali Loss: 0.780 Vali Acc: 0.817 Test Loss: 0.780 Test Acc: 0.817
Validation loss decreased (-0.777769 --> -0.816659).  Saving model ...
Epoch: 23 cost time: 1.5341110229492188
Epoch: 23, Steps: 12 | Train Loss: 0.482 Vali Loss: 0.712 Vali Acc: 0.833 Test Loss: 0.712 Test Acc: 0.833
Validation loss decreased (-0.816659 --> -0.833326).  Saving model ...
Epoch: 24 cost time: 1.732114315032959
Epoch: 24, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.682 Vali Acc: 0.828 Test Loss: 0.682 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.877833366394043
Epoch: 25, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.679 Vali Acc: 0.833 Test Loss: 0.679 Test Acc: 0.833
Validation loss decreased (-0.833326 --> -0.833327).  Saving model ...
Epoch: 26 cost time: 1.5484750270843506
Epoch: 26, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.611 Vali Acc: 0.861 Test Loss: 0.611 Test Acc: 0.861
Validation loss decreased (-0.833327 --> -0.861105).  Saving model ...
Epoch: 27 cost time: 1.6945984363555908
Epoch: 27, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.544 Vali Acc: 0.878 Test Loss: 0.544 Test Acc: 0.878
Validation loss decreased (-0.861105 --> -0.877772).  Saving model ...
Epoch: 28 cost time: 1.8083629608154297
Epoch: 28, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.576 Vali Acc: 0.878 Test Loss: 0.576 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7780935764312744
Epoch: 29, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.523 Vali Acc: 0.878 Test Loss: 0.523 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877773).  Saving model ...
Epoch: 30 cost time: 1.633441686630249
Epoch: 30, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.482 Vali Acc: 0.889 Test Loss: 0.482 Test Acc: 0.889
Validation loss decreased (-0.877773 --> -0.888884).  Saving model ...
Epoch: 31 cost time: 1.715106725692749
Epoch: 31, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.498 Vali Acc: 0.889 Test Loss: 0.498 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.6598565578460693
Epoch: 32, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.509 Vali Acc: 0.883 Test Loss: 0.509 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.6154279708862305
Epoch: 33, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.476 Vali Acc: 0.883 Test Loss: 0.476 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.0314064025878906
Epoch: 34, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.486 Vali Acc: 0.878 Test Loss: 0.486 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.8362104892730713
Epoch: 35, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.528 Vali Acc: 0.861 Test Loss: 0.528 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.8096084594726562
Epoch: 36, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.459 Vali Acc: 0.883 Test Loss: 0.459 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.4722537994384766
Epoch: 37, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.480 Vali Acc: 0.872 Test Loss: 0.480 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.6155657768249512
Epoch: 38, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.481 Vali Acc: 0.894 Test Loss: 0.481 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894440).  Saving model ...
Epoch: 39 cost time: 1.7980120182037354
Epoch: 39, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.455 Vali Acc: 0.900 Test Loss: 0.455 Test Acc: 0.900
Validation loss decreased (-0.894440 --> -0.899995).  Saving model ...
Epoch: 40 cost time: 1.7847635746002197
Epoch: 40, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.480 Vali Acc: 0.872 Test Loss: 0.480 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.0276501178741455
Epoch: 41, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.472 Vali Acc: 0.889 Test Loss: 0.472 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.617785930633545
Epoch: 42, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.527 Vali Acc: 0.844 Test Loss: 0.527 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.033726692199707
Epoch: 43, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.528 Vali Acc: 0.878 Test Loss: 0.528 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.6393842697143555
Epoch: 44, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.500 Vali Acc: 0.872 Test Loss: 0.500 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 2.1269617080688477
Epoch: 45, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.498 Vali Acc: 0.883 Test Loss: 0.498 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 2.1188206672668457
Epoch: 46, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.489 Vali Acc: 0.894 Test Loss: 0.489 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.7542169094085693
Epoch: 47, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.492 Vali Acc: 0.878 Test Loss: 0.492 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.8339171409606934
Epoch: 48, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.477 Vali Acc: 0.883 Test Loss: 0.477 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.8907744884490967
Epoch: 49, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.505 Vali Acc: 0.878 Test Loss: 0.505 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 594751
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.781582832336426
Epoch: 1, Steps: 12 | Train Loss: 2.958 Vali Loss: 2.874 Vali Acc: 0.100 Test Loss: 2.874 Test Acc: 0.100
Validation loss decreased (inf --> -0.099971).  Saving model ...
Epoch: 2 cost time: 1.7827796936035156
Epoch: 2, Steps: 12 | Train Loss: 2.805 Vali Loss: 2.707 Vali Acc: 0.122 Test Loss: 2.707 Test Acc: 0.122
Validation loss decreased (-0.099971 --> -0.122195).  Saving model ...
Epoch: 3 cost time: 1.612901210784912
Epoch: 3, Steps: 12 | Train Loss: 2.650 Vali Loss: 2.599 Vali Acc: 0.194 Test Loss: 2.599 Test Acc: 0.194
Validation loss decreased (-0.122195 --> -0.194418).  Saving model ...
Epoch: 4 cost time: 1.8989195823669434
Epoch: 4, Steps: 12 | Train Loss: 2.532 Vali Loss: 2.484 Vali Acc: 0.283 Test Loss: 2.484 Test Acc: 0.283
Validation loss decreased (-0.194418 --> -0.283308).  Saving model ...
Epoch: 5 cost time: 1.7769842147827148
Epoch: 5, Steps: 12 | Train Loss: 2.411 Vali Loss: 2.344 Vali Acc: 0.450 Test Loss: 2.344 Test Acc: 0.450
Validation loss decreased (-0.283308 --> -0.449977).  Saving model ...
Epoch: 6 cost time: 1.5718896389007568
Epoch: 6, Steps: 12 | Train Loss: 2.203 Vali Loss: 2.162 Vali Acc: 0.472 Test Loss: 2.162 Test Acc: 0.472
Validation loss decreased (-0.449977 --> -0.472201).  Saving model ...
Epoch: 7 cost time: 1.6400394439697266
Epoch: 7, Steps: 12 | Train Loss: 2.071 Vali Loss: 2.005 Vali Acc: 0.533 Test Loss: 2.005 Test Acc: 0.533
Validation loss decreased (-0.472201 --> -0.533313).  Saving model ...
Epoch: 8 cost time: 1.6827476024627686
Epoch: 8, Steps: 12 | Train Loss: 1.957 Vali Loss: 1.882 Vali Acc: 0.528 Test Loss: 1.882 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6098575592041016
Epoch: 9, Steps: 12 | Train Loss: 1.716 Vali Loss: 1.753 Vali Acc: 0.578 Test Loss: 1.753 Test Acc: 0.578
Validation loss decreased (-0.533313 --> -0.577760).  Saving model ...
Epoch: 10 cost time: 1.4315376281738281
Epoch: 10, Steps: 12 | Train Loss: 1.525 Vali Loss: 1.636 Vali Acc: 0.606 Test Loss: 1.636 Test Acc: 0.606
Validation loss decreased (-0.577760 --> -0.605539).  Saving model ...
Epoch: 11 cost time: 1.6167361736297607
Epoch: 11, Steps: 12 | Train Loss: 1.484 Vali Loss: 1.530 Vali Acc: 0.656 Test Loss: 1.530 Test Acc: 0.656
Validation loss decreased (-0.605539 --> -0.655540).  Saving model ...
Epoch: 12 cost time: 1.4164633750915527
Epoch: 12, Steps: 12 | Train Loss: 1.361 Vali Loss: 1.423 Vali Acc: 0.644 Test Loss: 1.423 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.103496551513672
Epoch: 13, Steps: 12 | Train Loss: 1.253 Vali Loss: 1.334 Vali Acc: 0.706 Test Loss: 1.334 Test Acc: 0.706
Validation loss decreased (-0.655540 --> -0.705542).  Saving model ...
Epoch: 14 cost time: 1.6098957061767578
Epoch: 14, Steps: 12 | Train Loss: 1.169 Vali Loss: 1.238 Vali Acc: 0.700 Test Loss: 1.238 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.870746374130249
Epoch: 15, Steps: 12 | Train Loss: 1.011 Vali Loss: 1.149 Vali Acc: 0.717 Test Loss: 1.149 Test Acc: 0.717
Validation loss decreased (-0.705542 --> -0.716655).  Saving model ...
Epoch: 16 cost time: 2.0123541355133057
Epoch: 16, Steps: 12 | Train Loss: 0.982 Vali Loss: 1.100 Vali Acc: 0.711 Test Loss: 1.100 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5274574756622314
Epoch: 17, Steps: 12 | Train Loss: 0.854 Vali Loss: 1.013 Vali Acc: 0.767 Test Loss: 1.013 Test Acc: 0.767
Validation loss decreased (-0.716655 --> -0.766657).  Saving model ...
Epoch: 18 cost time: 1.7946836948394775
Epoch: 18, Steps: 12 | Train Loss: 0.819 Vali Loss: 0.957 Vali Acc: 0.761 Test Loss: 0.957 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7115161418914795
Epoch: 19, Steps: 12 | Train Loss: 0.696 Vali Loss: 0.898 Vali Acc: 0.789 Test Loss: 0.898 Test Acc: 0.789
Validation loss decreased (-0.766657 --> -0.788880).  Saving model ...
Epoch: 20 cost time: 2.006713390350342
Epoch: 20, Steps: 12 | Train Loss: 0.622 Vali Loss: 0.880 Vali Acc: 0.778 Test Loss: 0.880 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0503857135772705
Epoch: 21, Steps: 12 | Train Loss: 0.633 Vali Loss: 0.795 Vali Acc: 0.800 Test Loss: 0.795 Test Acc: 0.800
Validation loss decreased (-0.788880 --> -0.799992).  Saving model ...
Epoch: 22 cost time: 1.67555570602417
Epoch: 22, Steps: 12 | Train Loss: 0.534 Vali Loss: 0.751 Vali Acc: 0.789 Test Loss: 0.751 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9468340873718262
Epoch: 23, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.723 Vali Acc: 0.828 Test Loss: 0.723 Test Acc: 0.828
Validation loss decreased (-0.799992 --> -0.827771).  Saving model ...
Epoch: 24 cost time: 1.9386112689971924
Epoch: 24, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.702 Vali Acc: 0.817 Test Loss: 0.702 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.600433826446533
Epoch: 25, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.653 Vali Acc: 0.850 Test Loss: 0.653 Test Acc: 0.850
Validation loss decreased (-0.827771 --> -0.849993).  Saving model ...
Epoch: 26 cost time: 1.8445215225219727
Epoch: 26, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.625 Vali Acc: 0.844 Test Loss: 0.625 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.9678044319152832
Epoch: 27, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.622 Vali Acc: 0.856 Test Loss: 0.622 Test Acc: 0.856
Validation loss decreased (-0.849993 --> -0.855549).  Saving model ...
Epoch: 28 cost time: 2.0250935554504395
Epoch: 28, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.584 Vali Acc: 0.861 Test Loss: 0.584 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 29 cost time: 2.216740369796753
Epoch: 29, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.569 Vali Acc: 0.850 Test Loss: 0.569 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.8540127277374268
Epoch: 30, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.575 Vali Acc: 0.856 Test Loss: 0.575 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.1489288806915283
Epoch: 31, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.533 Vali Acc: 0.861 Test Loss: 0.533 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861106).  Saving model ...
Epoch: 32 cost time: 2.27807879447937
Epoch: 32, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.547 Vali Acc: 0.872 Test Loss: 0.547 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 33 cost time: 1.9334971904754639
Epoch: 33, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.505 Vali Acc: 0.878 Test Loss: 0.505 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 34 cost time: 1.68015718460083
Epoch: 34, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.561 Vali Acc: 0.856 Test Loss: 0.561 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.9773497581481934
Epoch: 35, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.524 Vali Acc: 0.872 Test Loss: 0.524 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.166867733001709
Epoch: 36, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.519 Vali Acc: 0.872 Test Loss: 0.519 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.9493191242218018
Epoch: 37, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.558 Vali Acc: 0.861 Test Loss: 0.558 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.0632164478302
Epoch: 38, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.496 Vali Acc: 0.883 Test Loss: 0.496 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883328).  Saving model ...
Epoch: 39 cost time: 1.871131181716919
Epoch: 39, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.552 Vali Acc: 0.883 Test Loss: 0.552 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.3042685985565186
Epoch: 40, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.468 Vali Acc: 0.867 Test Loss: 0.468 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.7997441291809082
Epoch: 41, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.570 Vali Acc: 0.878 Test Loss: 0.570 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.5805680751800537
Epoch: 42, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.591 Vali Acc: 0.867 Test Loss: 0.591 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.8542041778564453
Epoch: 43, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.561 Vali Acc: 0.878 Test Loss: 0.561 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.9946982860565186
Epoch: 44, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.533 Vali Acc: 0.872 Test Loss: 0.533 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.9560010433197021
Epoch: 45, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.567 Vali Acc: 0.878 Test Loss: 0.567 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.9093971252441406
Epoch: 46, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.538 Vali Acc: 0.867 Test Loss: 0.538 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.6192901134490967
Epoch: 47, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.542 Vali Acc: 0.900 Test Loss: 0.542 Test Acc: 0.900
Validation loss decreased (-0.883328 --> -0.899995).  Saving model ...
Epoch: 48 cost time: 1.9697725772857666
Epoch: 48, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.524 Vali Acc: 0.878 Test Loss: 0.524 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.2956535816192627
Epoch: 49, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.562 Vali Acc: 0.878 Test Loss: 0.562 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.8041224479675293
Epoch: 50, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.555 Vali Acc: 0.889 Test Loss: 0.555 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 2.00235915184021
Epoch: 51, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.573 Vali Acc: 0.878 Test Loss: 0.573 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.821204423904419
Epoch: 52, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.563 Vali Acc: 0.883 Test Loss: 0.563 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 2.374385356903076
Epoch: 53, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.591 Vali Acc: 0.883 Test Loss: 0.591 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.9873442649841309
Epoch: 54, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.554 Vali Acc: 0.883 Test Loss: 0.554 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 2.419865131378174
Epoch: 55, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.545 Vali Acc: 0.889 Test Loss: 0.545 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.9580295085906982
Epoch: 56, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.552 Vali Acc: 0.883 Test Loss: 0.552 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 2.0407495498657227
Epoch: 57, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.568 Vali Acc: 0.883 Test Loss: 0.568 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 594303
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3889336585998535
Epoch: 1, Steps: 12 | Train Loss: 2.857 Vali Loss: 2.745 Vali Acc: 0.111 Test Loss: 2.745 Test Acc: 0.111
Validation loss decreased (inf --> -0.111084).  Saving model ...
Epoch: 2 cost time: 1.7728791236877441
Epoch: 2, Steps: 12 | Train Loss: 2.662 Vali Loss: 2.641 Vali Acc: 0.106 Test Loss: 2.641 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.91721773147583
Epoch: 3, Steps: 12 | Train Loss: 2.612 Vali Loss: 2.572 Vali Acc: 0.139 Test Loss: 2.572 Test Acc: 0.139
Validation loss decreased (-0.111084 --> -0.138863).  Saving model ...
Epoch: 4 cost time: 1.9388206005096436
Epoch: 4, Steps: 12 | Train Loss: 2.477 Vali Loss: 2.498 Vali Acc: 0.244 Test Loss: 2.498 Test Acc: 0.244
Validation loss decreased (-0.138863 --> -0.244419).  Saving model ...
Epoch: 5 cost time: 1.6491172313690186
Epoch: 5, Steps: 12 | Train Loss: 2.407 Vali Loss: 2.381 Vali Acc: 0.272 Test Loss: 2.381 Test Acc: 0.272
Validation loss decreased (-0.244419 --> -0.272198).  Saving model ...
Epoch: 6 cost time: 1.6933717727661133
Epoch: 6, Steps: 12 | Train Loss: 2.247 Vali Loss: 2.247 Vali Acc: 0.322 Test Loss: 2.247 Test Acc: 0.322
Validation loss decreased (-0.272198 --> -0.322200).  Saving model ...
Epoch: 7 cost time: 1.6554687023162842
Epoch: 7, Steps: 12 | Train Loss: 2.107 Vali Loss: 2.146 Vali Acc: 0.417 Test Loss: 2.146 Test Acc: 0.417
Validation loss decreased (-0.322200 --> -0.416645).  Saving model ...
Epoch: 8 cost time: 1.6512129306793213
Epoch: 8, Steps: 12 | Train Loss: 1.959 Vali Loss: 2.038 Vali Acc: 0.411 Test Loss: 2.038 Test Acc: 0.411
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5046272277832031
Epoch: 9, Steps: 12 | Train Loss: 1.892 Vali Loss: 1.930 Vali Acc: 0.478 Test Loss: 1.930 Test Acc: 0.478
Validation loss decreased (-0.416645 --> -0.477758).  Saving model ...
Epoch: 10 cost time: 1.554887056350708
Epoch: 10, Steps: 12 | Train Loss: 1.708 Vali Loss: 1.834 Vali Acc: 0.478 Test Loss: 1.834 Test Acc: 0.478
Validation loss decreased (-0.477758 --> -0.477759).  Saving model ...
Epoch: 11 cost time: 1.4476115703582764
Epoch: 11, Steps: 12 | Train Loss: 1.654 Vali Loss: 1.731 Vali Acc: 0.539 Test Loss: 1.731 Test Acc: 0.539
Validation loss decreased (-0.477759 --> -0.538872).  Saving model ...
Epoch: 12 cost time: 1.5268464088439941
Epoch: 12, Steps: 12 | Train Loss: 1.527 Vali Loss: 1.687 Vali Acc: 0.522 Test Loss: 1.687 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.774364709854126
Epoch: 13, Steps: 12 | Train Loss: 1.433 Vali Loss: 1.570 Vali Acc: 0.594 Test Loss: 1.570 Test Acc: 0.594
Validation loss decreased (-0.538872 --> -0.594429).  Saving model ...
Epoch: 14 cost time: 1.740251064300537
Epoch: 14, Steps: 12 | Train Loss: 1.378 Vali Loss: 1.479 Vali Acc: 0.617 Test Loss: 1.479 Test Acc: 0.617
Validation loss decreased (-0.594429 --> -0.616652).  Saving model ...
Epoch: 15 cost time: 1.8099408149719238
Epoch: 15, Steps: 12 | Train Loss: 1.322 Vali Loss: 1.356 Vali Acc: 0.661 Test Loss: 1.356 Test Acc: 0.661
Validation loss decreased (-0.616652 --> -0.661098).  Saving model ...
Epoch: 16 cost time: 1.954498052597046
Epoch: 16, Steps: 12 | Train Loss: 1.184 Vali Loss: 1.291 Vali Acc: 0.689 Test Loss: 1.291 Test Acc: 0.689
Validation loss decreased (-0.661098 --> -0.688876).  Saving model ...
Epoch: 17 cost time: 1.4540820121765137
Epoch: 17, Steps: 12 | Train Loss: 1.092 Vali Loss: 1.219 Vali Acc: 0.672 Test Loss: 1.219 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6419751644134521
Epoch: 18, Steps: 12 | Train Loss: 1.016 Vali Loss: 1.119 Vali Acc: 0.739 Test Loss: 1.119 Test Acc: 0.739
Validation loss decreased (-0.688876 --> -0.738878).  Saving model ...
Epoch: 19 cost time: 1.472527027130127
Epoch: 19, Steps: 12 | Train Loss: 0.927 Vali Loss: 1.074 Vali Acc: 0.739 Test Loss: 1.074 Test Acc: 0.739
Validation loss decreased (-0.738878 --> -0.738878).  Saving model ...
Epoch: 20 cost time: 1.6405119895935059
Epoch: 20, Steps: 12 | Train Loss: 0.917 Vali Loss: 1.004 Vali Acc: 0.767 Test Loss: 1.004 Test Acc: 0.767
Validation loss decreased (-0.738878 --> -0.766657).  Saving model ...
Epoch: 21 cost time: 2.084340810775757
Epoch: 21, Steps: 12 | Train Loss: 0.787 Vali Loss: 0.940 Vali Acc: 0.794 Test Loss: 0.940 Test Acc: 0.794
Validation loss decreased (-0.766657 --> -0.794435).  Saving model ...
Epoch: 22 cost time: 1.663311243057251
Epoch: 22, Steps: 12 | Train Loss: 0.727 Vali Loss: 0.904 Vali Acc: 0.822 Test Loss: 0.904 Test Acc: 0.822
Validation loss decreased (-0.794435 --> -0.822213).  Saving model ...
Epoch: 23 cost time: 1.668358325958252
Epoch: 23, Steps: 12 | Train Loss: 0.686 Vali Loss: 0.823 Vali Acc: 0.811 Test Loss: 0.823 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7841267585754395
Epoch: 24, Steps: 12 | Train Loss: 0.718 Vali Loss: 0.795 Vali Acc: 0.833 Test Loss: 0.795 Test Acc: 0.833
Validation loss decreased (-0.822213 --> -0.833325).  Saving model ...
Epoch: 25 cost time: 1.5675439834594727
Epoch: 25, Steps: 12 | Train Loss: 0.609 Vali Loss: 0.807 Vali Acc: 0.811 Test Loss: 0.807 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8452398777008057
Epoch: 26, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.769 Vali Acc: 0.850 Test Loss: 0.769 Test Acc: 0.850
Validation loss decreased (-0.833325 --> -0.849992).  Saving model ...
Epoch: 27 cost time: 1.5552096366882324
Epoch: 27, Steps: 12 | Train Loss: 0.538 Vali Loss: 0.700 Vali Acc: 0.833 Test Loss: 0.700 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6699340343475342
Epoch: 28, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.682 Vali Acc: 0.850 Test Loss: 0.682 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 29 cost time: 2.025068998336792
Epoch: 29, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.650 Vali Acc: 0.867 Test Loss: 0.650 Test Acc: 0.867
Validation loss decreased (-0.849993 --> -0.866660).  Saving model ...
Epoch: 30 cost time: 1.537135362625122
Epoch: 30, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.662 Vali Acc: 0.844 Test Loss: 0.662 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.1111464500427246
Epoch: 31, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.616 Vali Acc: 0.856 Test Loss: 0.616 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.8135335445404053
Epoch: 32, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.591 Vali Acc: 0.850 Test Loss: 0.591 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.9889674186706543
Epoch: 33, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.594 Vali Acc: 0.861 Test Loss: 0.594 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.9465227127075195
Epoch: 34, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.572 Vali Acc: 0.856 Test Loss: 0.572 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.6114389896392822
Epoch: 35, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.565 Vali Acc: 0.856 Test Loss: 0.565 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.6605756282806396
Epoch: 36, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.548 Vali Acc: 0.850 Test Loss: 0.548 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.095822811126709
Epoch: 37, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.534 Vali Acc: 0.856 Test Loss: 0.534 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.211836099624634
Epoch: 38, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.540 Vali Acc: 0.867 Test Loss: 0.540 Test Acc: 0.867
Validation loss decreased (-0.866660 --> -0.866661).  Saving model ...
Epoch: 39 cost time: 1.9936633110046387
Epoch: 39, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.503 Vali Acc: 0.883 Test Loss: 0.503 Test Acc: 0.883
Validation loss decreased (-0.866661 --> -0.883328).  Saving model ...
Epoch: 40 cost time: 2.213484048843384
Epoch: 40, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.502 Vali Acc: 0.878 Test Loss: 0.502 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.819242000579834
Epoch: 41, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.491 Vali Acc: 0.867 Test Loss: 0.491 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.6540579795837402
Epoch: 42, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.491 Vali Acc: 0.844 Test Loss: 0.491 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.0919392108917236
Epoch: 43, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.457 Vali Acc: 0.872 Test Loss: 0.457 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 2.0232417583465576
Epoch: 44, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.483 Vali Acc: 0.883 Test Loss: 0.483 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883328).  Saving model ...
Epoch: 45 cost time: 1.997532606124878
Epoch: 45, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.467 Vali Acc: 0.861 Test Loss: 0.467 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.8107085227966309
Epoch: 46, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.465 Vali Acc: 0.861 Test Loss: 0.465 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.884416103363037
Epoch: 47, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.485 Vali Acc: 0.861 Test Loss: 0.485 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.746192455291748
Epoch: 48, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.490 Vali Acc: 0.856 Test Loss: 0.490 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 2.0402259826660156
Epoch: 49, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.429 Vali Acc: 0.872 Test Loss: 0.429 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.5896015167236328
Epoch: 50, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.474 Vali Acc: 0.867 Test Loss: 0.474 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.5615019798278809
Epoch: 51, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.463 Vali Acc: 0.878 Test Loss: 0.463 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.5319879055023193
Epoch: 52, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.485 Vali Acc: 0.883 Test Loss: 0.485 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.6944563388824463
Epoch: 53, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.457 Vali Acc: 0.878 Test Loss: 0.457 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.719961404800415
Epoch: 54, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.521 Vali Acc: 0.872 Test Loss: 0.521 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 591295
model size : 3.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.285527944564819
Epoch: 1, Steps: 12 | Train Loss: 2.934 Vali Loss: 2.772 Vali Acc: 0.028 Test Loss: 2.772 Test Acc: 0.028
Validation loss decreased (inf --> -0.027750).  Saving model ...
Epoch: 2 cost time: 2.150812864303589
Epoch: 2, Steps: 12 | Train Loss: 2.800 Vali Loss: 2.694 Vali Acc: 0.050 Test Loss: 2.694 Test Acc: 0.050
Validation loss decreased (-0.027750 --> -0.049973).  Saving model ...
Epoch: 3 cost time: 2.3795320987701416
Epoch: 3, Steps: 12 | Train Loss: 2.751 Vali Loss: 2.659 Vali Acc: 0.094 Test Loss: 2.659 Test Acc: 0.094
Validation loss decreased (-0.049973 --> -0.094418).  Saving model ...
Epoch: 4 cost time: 2.1879613399505615
Epoch: 4, Steps: 12 | Train Loss: 2.658 Vali Loss: 2.602 Vali Acc: 0.194 Test Loss: 2.602 Test Acc: 0.194
Validation loss decreased (-0.094418 --> -0.194418).  Saving model ...
Epoch: 5 cost time: 1.9282019138336182
Epoch: 5, Steps: 12 | Train Loss: 2.567 Vali Loss: 2.507 Vali Acc: 0.228 Test Loss: 2.507 Test Acc: 0.228
Validation loss decreased (-0.194418 --> -0.227753).  Saving model ...
Epoch: 6 cost time: 1.7202866077423096
Epoch: 6, Steps: 12 | Train Loss: 2.453 Vali Loss: 2.371 Vali Acc: 0.278 Test Loss: 2.371 Test Acc: 0.278
Validation loss decreased (-0.227753 --> -0.277754).  Saving model ...
Epoch: 7 cost time: 2.5030789375305176
Epoch: 7, Steps: 12 | Train Loss: 2.224 Vali Loss: 2.203 Vali Acc: 0.339 Test Loss: 2.203 Test Acc: 0.339
Validation loss decreased (-0.277754 --> -0.338867).  Saving model ...
Epoch: 8 cost time: 1.8387608528137207
Epoch: 8, Steps: 12 | Train Loss: 2.099 Vali Loss: 2.054 Vali Acc: 0.406 Test Loss: 2.054 Test Acc: 0.406
Validation loss decreased (-0.338867 --> -0.405535).  Saving model ...
Epoch: 9 cost time: 1.741182804107666
Epoch: 9, Steps: 12 | Train Loss: 1.968 Vali Loss: 1.949 Vali Acc: 0.450 Test Loss: 1.949 Test Acc: 0.450
Validation loss decreased (-0.405535 --> -0.449981).  Saving model ...
Epoch: 10 cost time: 2.215794801712036
Epoch: 10, Steps: 12 | Train Loss: 1.851 Vali Loss: 1.854 Vali Acc: 0.428 Test Loss: 1.854 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.100471258163452
Epoch: 11, Steps: 12 | Train Loss: 1.766 Vali Loss: 1.755 Vali Acc: 0.539 Test Loss: 1.755 Test Acc: 0.539
Validation loss decreased (-0.449981 --> -0.538871).  Saving model ...
Epoch: 12 cost time: 2.194077730178833
Epoch: 12, Steps: 12 | Train Loss: 1.614 Vali Loss: 1.633 Vali Acc: 0.572 Test Loss: 1.633 Test Acc: 0.572
Validation loss decreased (-0.538871 --> -0.572206).  Saving model ...
Epoch: 13 cost time: 2.428968906402588
Epoch: 13, Steps: 12 | Train Loss: 1.576 Vali Loss: 1.544 Vali Acc: 0.650 Test Loss: 1.544 Test Acc: 0.650
Validation loss decreased (-0.572206 --> -0.649985).  Saving model ...
Epoch: 14 cost time: 2.0750722885131836
Epoch: 14, Steps: 12 | Train Loss: 1.463 Vali Loss: 1.455 Vali Acc: 0.639 Test Loss: 1.455 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.143739700317383
Epoch: 15, Steps: 12 | Train Loss: 1.335 Vali Loss: 1.370 Vali Acc: 0.678 Test Loss: 1.370 Test Acc: 0.678
Validation loss decreased (-0.649985 --> -0.677764).  Saving model ...
Epoch: 16 cost time: 2.2186079025268555
Epoch: 16, Steps: 12 | Train Loss: 1.241 Vali Loss: 1.330 Vali Acc: 0.689 Test Loss: 1.330 Test Acc: 0.689
Validation loss decreased (-0.677764 --> -0.688876).  Saving model ...
Epoch: 17 cost time: 2.394782781600952
Epoch: 17, Steps: 12 | Train Loss: 1.207 Vali Loss: 1.232 Vali Acc: 0.706 Test Loss: 1.232 Test Acc: 0.706
Validation loss decreased (-0.688876 --> -0.705543).  Saving model ...
Epoch: 18 cost time: 2.0746586322784424
Epoch: 18, Steps: 12 | Train Loss: 1.124 Vali Loss: 1.235 Vali Acc: 0.694 Test Loss: 1.235 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.1639657020568848
Epoch: 19, Steps: 12 | Train Loss: 1.055 Vali Loss: 1.129 Vali Acc: 0.706 Test Loss: 1.129 Test Acc: 0.706
Validation loss decreased (-0.705543 --> -0.705544).  Saving model ...
Epoch: 20 cost time: 1.810016393661499
Epoch: 20, Steps: 12 | Train Loss: 0.996 Vali Loss: 1.086 Vali Acc: 0.694 Test Loss: 1.086 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.867997646331787
Epoch: 21, Steps: 12 | Train Loss: 0.916 Vali Loss: 1.069 Vali Acc: 0.728 Test Loss: 1.069 Test Acc: 0.728
Validation loss decreased (-0.705544 --> -0.727767).  Saving model ...
Epoch: 22 cost time: 2.217146158218384
Epoch: 22, Steps: 12 | Train Loss: 0.895 Vali Loss: 0.976 Vali Acc: 0.744 Test Loss: 0.976 Test Acc: 0.744
Validation loss decreased (-0.727767 --> -0.744435).  Saving model ...
Epoch: 23 cost time: 2.0207912921905518
Epoch: 23, Steps: 12 | Train Loss: 0.770 Vali Loss: 0.925 Vali Acc: 0.756 Test Loss: 0.925 Test Acc: 0.756
Validation loss decreased (-0.744435 --> -0.755546).  Saving model ...
Epoch: 24 cost time: 1.9660141468048096
Epoch: 24, Steps: 12 | Train Loss: 0.726 Vali Loss: 0.899 Vali Acc: 0.789 Test Loss: 0.899 Test Acc: 0.789
Validation loss decreased (-0.755546 --> -0.788880).  Saving model ...
Epoch: 25 cost time: 2.004422664642334
Epoch: 25, Steps: 12 | Train Loss: 0.673 Vali Loss: 0.862 Vali Acc: 0.783 Test Loss: 0.862 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.1567299365997314
Epoch: 26, Steps: 12 | Train Loss: 0.669 Vali Loss: 0.858 Vali Acc: 0.733 Test Loss: 0.858 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8309788703918457
Epoch: 27, Steps: 12 | Train Loss: 0.633 Vali Loss: 0.803 Vali Acc: 0.789 Test Loss: 0.803 Test Acc: 0.789
Validation loss decreased (-0.788880 --> -0.788881).  Saving model ...
Epoch: 28 cost time: 1.6119403839111328
Epoch: 28, Steps: 12 | Train Loss: 0.559 Vali Loss: 0.759 Vali Acc: 0.794 Test Loss: 0.759 Test Acc: 0.794
Validation loss decreased (-0.788881 --> -0.794437).  Saving model ...
Epoch: 29 cost time: 1.8634140491485596
Epoch: 29, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.708 Vali Acc: 0.822 Test Loss: 0.708 Test Acc: 0.822
Validation loss decreased (-0.794437 --> -0.822215).  Saving model ...
Epoch: 30 cost time: 1.6800436973571777
Epoch: 30, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.752 Vali Acc: 0.822 Test Loss: 0.752 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.647899866104126
Epoch: 31, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.667 Vali Acc: 0.833 Test Loss: 0.667 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833327).  Saving model ...
Epoch: 32 cost time: 2.3059988021850586
Epoch: 32, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.651 Vali Acc: 0.844 Test Loss: 0.651 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844438).  Saving model ...
Epoch: 33 cost time: 1.6837310791015625
Epoch: 33, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.692 Vali Acc: 0.817 Test Loss: 0.692 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.8527817726135254
Epoch: 34, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.619 Vali Acc: 0.828 Test Loss: 0.619 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.8335785865783691
Epoch: 35, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.669 Vali Acc: 0.811 Test Loss: 0.669 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.8271491527557373
Epoch: 36, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.581 Vali Acc: 0.844 Test Loss: 0.581 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844439).  Saving model ...
Epoch: 37 cost time: 1.6183710098266602
Epoch: 37, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.555 Vali Acc: 0.867 Test Loss: 0.555 Test Acc: 0.867
Validation loss decreased (-0.844439 --> -0.866661).  Saving model ...
Epoch: 38 cost time: 2.2197489738464355
Epoch: 38, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.577 Vali Acc: 0.839 Test Loss: 0.577 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.163257360458374
Epoch: 39, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.599 Vali Acc: 0.817 Test Loss: 0.599 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.890815258026123
Epoch: 40, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.537 Vali Acc: 0.833 Test Loss: 0.537 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.8504917621612549
Epoch: 41, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.582 Vali Acc: 0.833 Test Loss: 0.582 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.5893125534057617
Epoch: 42, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.545 Vali Acc: 0.839 Test Loss: 0.545 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.7862699031829834
Epoch: 43, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.566 Vali Acc: 0.822 Test Loss: 0.566 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 2.1755614280700684
Epoch: 44, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.525 Vali Acc: 0.833 Test Loss: 0.525 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 2.2007620334625244
Epoch: 45, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.550 Vali Acc: 0.839 Test Loss: 0.550 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.8988420963287354
Epoch: 46, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.533 Vali Acc: 0.856 Test Loss: 0.533 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.8733699321746826
Epoch: 47, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.530 Vali Acc: 0.856 Test Loss: 0.530 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 591071
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.626124858856201
Epoch: 1, Steps: 12 | Train Loss: 2.890 Vali Loss: 2.768 Vali Acc: 0.067 Test Loss: 2.768 Test Acc: 0.067
Validation loss decreased (inf --> -0.066639).  Saving model ...
Epoch: 2 cost time: 1.5494871139526367
Epoch: 2, Steps: 12 | Train Loss: 2.756 Vali Loss: 2.684 Vali Acc: 0.106 Test Loss: 2.684 Test Acc: 0.106
Validation loss decreased (-0.066639 --> -0.105529).  Saving model ...
Epoch: 3 cost time: 1.8772501945495605
Epoch: 3, Steps: 12 | Train Loss: 2.649 Vali Loss: 2.599 Vali Acc: 0.161 Test Loss: 2.599 Test Acc: 0.161
Validation loss decreased (-0.105529 --> -0.161085).  Saving model ...
Epoch: 4 cost time: 1.8487565517425537
Epoch: 4, Steps: 12 | Train Loss: 2.562 Vali Loss: 2.530 Vali Acc: 0.172 Test Loss: 2.530 Test Acc: 0.172
Validation loss decreased (-0.161085 --> -0.172197).  Saving model ...
Epoch: 5 cost time: 1.9025766849517822
Epoch: 5, Steps: 12 | Train Loss: 2.446 Vali Loss: 2.389 Vali Acc: 0.283 Test Loss: 2.389 Test Acc: 0.283
Validation loss decreased (-0.172197 --> -0.283309).  Saving model ...
Epoch: 6 cost time: 1.532926082611084
Epoch: 6, Steps: 12 | Train Loss: 2.299 Vali Loss: 2.252 Vali Acc: 0.339 Test Loss: 2.252 Test Acc: 0.339
Validation loss decreased (-0.283309 --> -0.338866).  Saving model ...
Epoch: 7 cost time: 1.8494899272918701
Epoch: 7, Steps: 12 | Train Loss: 2.126 Vali Loss: 2.138 Vali Acc: 0.367 Test Loss: 2.138 Test Acc: 0.367
Validation loss decreased (-0.338866 --> -0.366645).  Saving model ...
Epoch: 8 cost time: 2.0415120124816895
Epoch: 8, Steps: 12 | Train Loss: 1.958 Vali Loss: 2.031 Vali Acc: 0.417 Test Loss: 2.031 Test Acc: 0.417
Validation loss decreased (-0.366645 --> -0.416646).  Saving model ...
Epoch: 9 cost time: 1.800614356994629
Epoch: 9, Steps: 12 | Train Loss: 1.929 Vali Loss: 1.945 Vali Acc: 0.428 Test Loss: 1.945 Test Acc: 0.428
Validation loss decreased (-0.416646 --> -0.427758).  Saving model ...
Epoch: 10 cost time: 1.9630532264709473
Epoch: 10, Steps: 12 | Train Loss: 1.776 Vali Loss: 1.866 Vali Acc: 0.494 Test Loss: 1.866 Test Acc: 0.494
Validation loss decreased (-0.427758 --> -0.494426).  Saving model ...
Epoch: 11 cost time: 1.8844926357269287
Epoch: 11, Steps: 12 | Train Loss: 1.713 Vali Loss: 1.810 Vali Acc: 0.472 Test Loss: 1.810 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8060073852539062
Epoch: 12, Steps: 12 | Train Loss: 1.598 Vali Loss: 1.684 Vali Acc: 0.533 Test Loss: 1.684 Test Acc: 0.533
Validation loss decreased (-0.494426 --> -0.533316).  Saving model ...
Epoch: 13 cost time: 2.1216583251953125
Epoch: 13, Steps: 12 | Train Loss: 1.488 Vali Loss: 1.595 Vali Acc: 0.556 Test Loss: 1.595 Test Acc: 0.556
Validation loss decreased (-0.533316 --> -0.555540).  Saving model ...
Epoch: 14 cost time: 2.6473886966705322
Epoch: 14, Steps: 12 | Train Loss: 1.388 Vali Loss: 1.511 Vali Acc: 0.600 Test Loss: 1.511 Test Acc: 0.600
Validation loss decreased (-0.555540 --> -0.599985).  Saving model ...
Epoch: 15 cost time: 1.7321608066558838
Epoch: 15, Steps: 12 | Train Loss: 1.307 Vali Loss: 1.412 Vali Acc: 0.639 Test Loss: 1.412 Test Acc: 0.639
Validation loss decreased (-0.599985 --> -0.638875).  Saving model ...
Epoch: 16 cost time: 1.4381322860717773
Epoch: 16, Steps: 12 | Train Loss: 1.239 Vali Loss: 1.365 Vali Acc: 0.633 Test Loss: 1.365 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9434235095977783
Epoch: 17, Steps: 12 | Train Loss: 1.138 Vali Loss: 1.294 Vali Acc: 0.672 Test Loss: 1.294 Test Acc: 0.672
Validation loss decreased (-0.638875 --> -0.672209).  Saving model ...
Epoch: 18 cost time: 1.7483820915222168
Epoch: 18, Steps: 12 | Train Loss: 1.039 Vali Loss: 1.202 Vali Acc: 0.717 Test Loss: 1.202 Test Acc: 0.717
Validation loss decreased (-0.672209 --> -0.716655).  Saving model ...
Epoch: 19 cost time: 2.003772497177124
Epoch: 19, Steps: 12 | Train Loss: 0.958 Vali Loss: 1.146 Vali Acc: 0.744 Test Loss: 1.146 Test Acc: 0.744
Validation loss decreased (-0.716655 --> -0.744433).  Saving model ...
Epoch: 20 cost time: 2.1820027828216553
Epoch: 20, Steps: 12 | Train Loss: 0.960 Vali Loss: 1.079 Vali Acc: 0.756 Test Loss: 1.079 Test Acc: 0.756
Validation loss decreased (-0.744433 --> -0.755545).  Saving model ...
Epoch: 21 cost time: 1.7335848808288574
Epoch: 21, Steps: 12 | Train Loss: 0.897 Vali Loss: 1.054 Vali Acc: 0.772 Test Loss: 1.054 Test Acc: 0.772
Validation loss decreased (-0.755545 --> -0.772212).  Saving model ...
Epoch: 22 cost time: 1.7302920818328857
Epoch: 22, Steps: 12 | Train Loss: 0.823 Vali Loss: 0.945 Vali Acc: 0.783 Test Loss: 0.945 Test Acc: 0.783
Validation loss decreased (-0.772212 --> -0.783324).  Saving model ...
Epoch: 23 cost time: 1.8821022510528564
Epoch: 23, Steps: 12 | Train Loss: 0.753 Vali Loss: 0.926 Vali Acc: 0.800 Test Loss: 0.926 Test Acc: 0.800
Validation loss decreased (-0.783324 --> -0.799991).  Saving model ...
Epoch: 24 cost time: 1.9619061946868896
Epoch: 24, Steps: 12 | Train Loss: 0.668 Vali Loss: 0.869 Vali Acc: 0.817 Test Loss: 0.869 Test Acc: 0.817
Validation loss decreased (-0.799991 --> -0.816658).  Saving model ...
Epoch: 25 cost time: 2.0026695728302
Epoch: 25, Steps: 12 | Train Loss: 0.606 Vali Loss: 0.829 Vali Acc: 0.817 Test Loss: 0.829 Test Acc: 0.817
Validation loss decreased (-0.816658 --> -0.816658).  Saving model ...
Epoch: 26 cost time: 2.054312229156494
Epoch: 26, Steps: 12 | Train Loss: 0.592 Vali Loss: 0.875 Vali Acc: 0.811 Test Loss: 0.875 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.589815378189087
Epoch: 27, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.735 Vali Acc: 0.828 Test Loss: 0.735 Test Acc: 0.828
Validation loss decreased (-0.816658 --> -0.827770).  Saving model ...
Epoch: 28 cost time: 2.0705158710479736
Epoch: 28, Steps: 12 | Train Loss: 0.475 Vali Loss: 0.730 Vali Acc: 0.822 Test Loss: 0.730 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.1560637950897217
Epoch: 29, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.720 Vali Acc: 0.833 Test Loss: 0.720 Test Acc: 0.833
Validation loss decreased (-0.827770 --> -0.833326).  Saving model ...
Epoch: 30 cost time: 2.164447069168091
Epoch: 30, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.647 Vali Acc: 0.850 Test Loss: 0.647 Test Acc: 0.850
Validation loss decreased (-0.833326 --> -0.849994).  Saving model ...
Epoch: 31 cost time: 1.9375519752502441
Epoch: 31, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.661 Vali Acc: 0.850 Test Loss: 0.661 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.0380923748016357
Epoch: 32, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.612 Vali Acc: 0.856 Test Loss: 0.612 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 33 cost time: 2.1480257511138916
Epoch: 33, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.615 Vali Acc: 0.856 Test Loss: 0.615 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.9740290641784668
Epoch: 34, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.595 Vali Acc: 0.856 Test Loss: 0.595 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855550).  Saving model ...
Epoch: 35 cost time: 1.8752918243408203
Epoch: 35, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.623 Vali Acc: 0.822 Test Loss: 0.623 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.8232431411743164
Epoch: 36, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.570 Vali Acc: 0.856 Test Loss: 0.570 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 37 cost time: 1.9510457515716553
Epoch: 37, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.560 Vali Acc: 0.839 Test Loss: 0.560 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.2563254833221436
Epoch: 38, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.555 Vali Acc: 0.856 Test Loss: 0.555 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 39 cost time: 1.8577301502227783
Epoch: 39, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.537 Vali Acc: 0.850 Test Loss: 0.537 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.2889223098754883
Epoch: 40, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.520 Vali Acc: 0.850 Test Loss: 0.520 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.7987666130065918
Epoch: 41, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.513 Vali Acc: 0.856 Test Loss: 0.513 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 42 cost time: 1.6374828815460205
Epoch: 42, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.502 Vali Acc: 0.839 Test Loss: 0.502 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.9186530113220215
Epoch: 43, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.511 Vali Acc: 0.850 Test Loss: 0.511 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 2.495736837387085
Epoch: 44, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.492 Vali Acc: 0.861 Test Loss: 0.492 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 45 cost time: 1.7428159713745117
Epoch: 45, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.491 Vali Acc: 0.872 Test Loss: 0.491 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 46 cost time: 1.8886637687683105
Epoch: 46, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.494 Vali Acc: 0.867 Test Loss: 0.494 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.301727294921875
Epoch: 47, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.531 Vali Acc: 0.872 Test Loss: 0.531 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.8933656215667725
Epoch: 48, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.529 Vali Acc: 0.872 Test Loss: 0.529 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.958186149597168
Epoch: 49, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.470 Vali Acc: 0.856 Test Loss: 0.470 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.8273646831512451
Epoch: 50, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.502 Vali Acc: 0.889 Test Loss: 0.502 Test Acc: 0.889
Validation loss decreased (-0.872217 --> -0.888884).  Saving model ...
Epoch: 51 cost time: 1.8233106136322021
Epoch: 51, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.493 Vali Acc: 0.878 Test Loss: 0.493 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 2.3214638233184814
Epoch: 52, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.497 Vali Acc: 0.872 Test Loss: 0.497 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.846703290939331
Epoch: 53, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.515 Vali Acc: 0.889 Test Loss: 0.515 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.8481636047363281
Epoch: 54, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.586 Vali Acc: 0.839 Test Loss: 0.586 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.673387050628662
Epoch: 55, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.506 Vali Acc: 0.878 Test Loss: 0.506 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 2.023064136505127
Epoch: 56, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.485 Vali Acc: 0.883 Test Loss: 0.485 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.9258556365966797
Epoch: 57, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.525 Vali Acc: 0.883 Test Loss: 0.525 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 2.177096128463745
Epoch: 58, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.543 Vali Acc: 0.872 Test Loss: 0.543 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.709892749786377
Epoch: 59, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.494 Vali Acc: 0.894 Test Loss: 0.494 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894440).  Saving model ...
Epoch: 60 cost time: 1.954052448272705
Epoch: 60, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.472 Vali Acc: 0.878 Test Loss: 0.472 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 2.0239789485931396
Epoch: 61, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.501 Vali Acc: 0.883 Test Loss: 0.501 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 2.0917534828186035
Epoch: 62, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.520 Vali Acc: 0.878 Test Loss: 0.520 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.900529146194458
Epoch: 63, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.569 Vali Acc: 0.889 Test Loss: 0.569 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 2.020684003829956
Epoch: 64, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.510 Vali Acc: 0.867 Test Loss: 0.510 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 2.00783634185791
Epoch: 65, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.533 Vali Acc: 0.883 Test Loss: 0.533 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 2.210214614868164
Epoch: 66, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.541 Vali Acc: 0.867 Test Loss: 0.541 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 2.0411007404327393
Epoch: 67, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.553 Vali Acc: 0.883 Test Loss: 0.553 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 1.8943562507629395
Epoch: 68, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.541 Vali Acc: 0.889 Test Loss: 0.541 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 2.3927083015441895
Epoch: 69, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.570 Vali Acc: 0.850 Test Loss: 0.570 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 590847
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7783548831939697
Epoch: 1, Steps: 12 | Train Loss: 2.843 Vali Loss: 2.770 Vali Acc: 0.056 Test Loss: 2.770 Test Acc: 0.056
Validation loss decreased (inf --> -0.055528).  Saving model ...
Epoch: 2 cost time: 1.929692268371582
Epoch: 2, Steps: 12 | Train Loss: 2.754 Vali Loss: 2.688 Vali Acc: 0.106 Test Loss: 2.688 Test Acc: 0.106
Validation loss decreased (-0.055528 --> -0.105529).  Saving model ...
Epoch: 3 cost time: 1.6973936557769775
Epoch: 3, Steps: 12 | Train Loss: 2.690 Vali Loss: 2.602 Vali Acc: 0.167 Test Loss: 2.602 Test Acc: 0.167
Validation loss decreased (-0.105529 --> -0.166641).  Saving model ...
Epoch: 4 cost time: 1.8478164672851562
Epoch: 4, Steps: 12 | Train Loss: 2.626 Vali Loss: 2.506 Vali Acc: 0.250 Test Loss: 2.506 Test Acc: 0.250
Validation loss decreased (-0.166641 --> -0.249975).  Saving model ...
Epoch: 5 cost time: 1.9394524097442627
Epoch: 5, Steps: 12 | Train Loss: 2.461 Vali Loss: 2.394 Vali Acc: 0.367 Test Loss: 2.394 Test Acc: 0.367
Validation loss decreased (-0.249975 --> -0.366643).  Saving model ...
Epoch: 6 cost time: 1.9188907146453857
Epoch: 6, Steps: 12 | Train Loss: 2.318 Vali Loss: 2.263 Vali Acc: 0.361 Test Loss: 2.263 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1112310886383057
Epoch: 7, Steps: 12 | Train Loss: 2.155 Vali Loss: 2.131 Vali Acc: 0.400 Test Loss: 2.131 Test Acc: 0.400
Validation loss decreased (-0.366643 --> -0.399979).  Saving model ...
Epoch: 8 cost time: 1.9735617637634277
Epoch: 8, Steps: 12 | Train Loss: 1.946 Vali Loss: 2.021 Vali Acc: 0.517 Test Loss: 2.021 Test Acc: 0.517
Validation loss decreased (-0.399979 --> -0.516646).  Saving model ...
Epoch: 9 cost time: 1.9284937381744385
Epoch: 9, Steps: 12 | Train Loss: 1.854 Vali Loss: 1.955 Vali Acc: 0.500 Test Loss: 1.955 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.231316566467285
Epoch: 10, Steps: 12 | Train Loss: 1.773 Vali Loss: 1.837 Vali Acc: 0.561 Test Loss: 1.837 Test Acc: 0.561
Validation loss decreased (-0.516646 --> -0.561093).  Saving model ...
Epoch: 11 cost time: 1.9266252517700195
Epoch: 11, Steps: 12 | Train Loss: 1.673 Vali Loss: 1.768 Vali Acc: 0.589 Test Loss: 1.768 Test Acc: 0.589
Validation loss decreased (-0.561093 --> -0.588871).  Saving model ...
Epoch: 12 cost time: 1.9654104709625244
Epoch: 12, Steps: 12 | Train Loss: 1.563 Vali Loss: 1.707 Vali Acc: 0.589 Test Loss: 1.707 Test Acc: 0.589
Validation loss decreased (-0.588871 --> -0.588872).  Saving model ...
Epoch: 13 cost time: 1.5805604457855225
Epoch: 13, Steps: 12 | Train Loss: 1.514 Vali Loss: 1.619 Vali Acc: 0.639 Test Loss: 1.619 Test Acc: 0.639
Validation loss decreased (-0.588872 --> -0.638873).  Saving model ...
Epoch: 14 cost time: 1.6381313800811768
Epoch: 14, Steps: 12 | Train Loss: 1.381 Vali Loss: 1.522 Vali Acc: 0.650 Test Loss: 1.522 Test Acc: 0.650
Validation loss decreased (-0.638873 --> -0.649985).  Saving model ...
Epoch: 15 cost time: 1.7812418937683105
Epoch: 15, Steps: 12 | Train Loss: 1.338 Vali Loss: 1.475 Vali Acc: 0.667 Test Loss: 1.475 Test Acc: 0.667
Validation loss decreased (-0.649985 --> -0.666652).  Saving model ...
Epoch: 16 cost time: 2.0150296688079834
Epoch: 16, Steps: 12 | Train Loss: 1.215 Vali Loss: 1.393 Vali Acc: 0.672 Test Loss: 1.393 Test Acc: 0.672
Validation loss decreased (-0.666652 --> -0.672208).  Saving model ...
Epoch: 17 cost time: 1.6089434623718262
Epoch: 17, Steps: 12 | Train Loss: 1.153 Vali Loss: 1.344 Vali Acc: 0.650 Test Loss: 1.344 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.475947618484497
Epoch: 18, Steps: 12 | Train Loss: 1.093 Vali Loss: 1.259 Vali Acc: 0.711 Test Loss: 1.259 Test Acc: 0.711
Validation loss decreased (-0.672208 --> -0.711099).  Saving model ...
Epoch: 19 cost time: 1.7008466720581055
Epoch: 19, Steps: 12 | Train Loss: 0.977 Vali Loss: 1.190 Vali Acc: 0.761 Test Loss: 1.190 Test Acc: 0.761
Validation loss decreased (-0.711099 --> -0.761099).  Saving model ...
Epoch: 20 cost time: 1.878361701965332
Epoch: 20, Steps: 12 | Train Loss: 0.954 Vali Loss: 1.155 Vali Acc: 0.733 Test Loss: 1.155 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6908187866210938
Epoch: 21, Steps: 12 | Train Loss: 0.915 Vali Loss: 1.100 Vali Acc: 0.767 Test Loss: 1.100 Test Acc: 0.767
Validation loss decreased (-0.761099 --> -0.766656).  Saving model ...
Epoch: 22 cost time: 1.6831846237182617
Epoch: 22, Steps: 12 | Train Loss: 0.860 Vali Loss: 1.036 Vali Acc: 0.756 Test Loss: 1.036 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8668630123138428
Epoch: 23, Steps: 12 | Train Loss: 0.762 Vali Loss: 0.985 Vali Acc: 0.794 Test Loss: 0.985 Test Acc: 0.794
Validation loss decreased (-0.766656 --> -0.794435).  Saving model ...
Epoch: 24 cost time: 1.8637604713439941
Epoch: 24, Steps: 12 | Train Loss: 0.756 Vali Loss: 0.945 Vali Acc: 0.783 Test Loss: 0.945 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.713625431060791
Epoch: 25, Steps: 12 | Train Loss: 0.682 Vali Loss: 0.899 Vali Acc: 0.794 Test Loss: 0.899 Test Acc: 0.794
Validation loss decreased (-0.794435 --> -0.794435).  Saving model ...
Epoch: 26 cost time: 1.8603098392486572
Epoch: 26, Steps: 12 | Train Loss: 0.671 Vali Loss: 0.857 Vali Acc: 0.794 Test Loss: 0.857 Test Acc: 0.794
Validation loss decreased (-0.794435 --> -0.794436).  Saving model ...
Epoch: 27 cost time: 1.6448259353637695
Epoch: 27, Steps: 12 | Train Loss: 0.604 Vali Loss: 0.800 Vali Acc: 0.817 Test Loss: 0.800 Test Acc: 0.817
Validation loss decreased (-0.794436 --> -0.816659).  Saving model ...
Epoch: 28 cost time: 1.654186487197876
Epoch: 28, Steps: 12 | Train Loss: 0.518 Vali Loss: 0.775 Vali Acc: 0.794 Test Loss: 0.775 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.89921236038208
Epoch: 29, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.815 Vali Acc: 0.794 Test Loss: 0.815 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.5466969013214111
Epoch: 30, Steps: 12 | Train Loss: 0.475 Vali Loss: 0.710 Vali Acc: 0.856 Test Loss: 0.710 Test Acc: 0.856
Validation loss decreased (-0.816659 --> -0.855548).  Saving model ...
Epoch: 31 cost time: 1.974090814590454
Epoch: 31, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.710 Vali Acc: 0.844 Test Loss: 0.710 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.7914502620697021
Epoch: 32, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.667 Vali Acc: 0.828 Test Loss: 0.667 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.9318182468414307
Epoch: 33, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.684 Vali Acc: 0.817 Test Loss: 0.684 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.762251853942871
Epoch: 34, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.670 Vali Acc: 0.839 Test Loss: 0.670 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.735135555267334
Epoch: 35, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.618 Vali Acc: 0.856 Test Loss: 0.618 Test Acc: 0.856
Validation loss decreased (-0.855548 --> -0.855549).  Saving model ...
Epoch: 36 cost time: 1.9176065921783447
Epoch: 36, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.654 Vali Acc: 0.811 Test Loss: 0.654 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.6220817565917969
Epoch: 37, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.594 Vali Acc: 0.850 Test Loss: 0.594 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.7171590328216553
Epoch: 38, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.569 Vali Acc: 0.844 Test Loss: 0.569 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.6100707054138184
Epoch: 39, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.601 Vali Acc: 0.844 Test Loss: 0.601 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.7221705913543701
Epoch: 40, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.513 Vali Acc: 0.867 Test Loss: 0.513 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866662).  Saving model ...
Epoch: 41 cost time: 1.5532870292663574
Epoch: 41, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.560 Vali Acc: 0.861 Test Loss: 0.560 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.082768440246582
Epoch: 42, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.519 Vali Acc: 0.856 Test Loss: 0.519 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.8625922203063965
Epoch: 43, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.576 Vali Acc: 0.867 Test Loss: 0.576 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.8811824321746826
Epoch: 44, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.474 Vali Acc: 0.867 Test Loss: 0.474 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 45 cost time: 1.6399457454681396
Epoch: 45, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.473 Vali Acc: 0.883 Test Loss: 0.473 Test Acc: 0.883
Validation loss decreased (-0.866662 --> -0.883329).  Saving model ...
Epoch: 46 cost time: 1.5813565254211426
Epoch: 46, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.450 Vali Acc: 0.889 Test Loss: 0.450 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888884).  Saving model ...
Epoch: 47 cost time: 1.8949365615844727
Epoch: 47, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.526 Vali Acc: 0.889 Test Loss: 0.526 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.878143310546875
Epoch: 48, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.455 Vali Acc: 0.894 Test Loss: 0.455 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894440).  Saving model ...
Epoch: 49 cost time: 1.6019337177276611
Epoch: 49, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.484 Vali Acc: 0.894 Test Loss: 0.484 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.785909652709961
Epoch: 50, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.515 Vali Acc: 0.867 Test Loss: 0.515 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.7701807022094727
Epoch: 51, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.497 Vali Acc: 0.878 Test Loss: 0.497 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.9737520217895508
Epoch: 52, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.486 Vali Acc: 0.883 Test Loss: 0.486 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.6095507144927979
Epoch: 53, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.449 Vali Acc: 0.906 Test Loss: 0.449 Test Acc: 0.906
Validation loss decreased (-0.894440 --> -0.905551).  Saving model ...
Epoch: 54 cost time: 1.5332551002502441
Epoch: 54, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.458 Vali Acc: 0.883 Test Loss: 0.458 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.9275648593902588
Epoch: 55, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.458 Vali Acc: 0.883 Test Loss: 0.458 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.7807505130767822
Epoch: 56, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.492 Vali Acc: 0.894 Test Loss: 0.492 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.81005859375
Epoch: 57, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.508 Vali Acc: 0.883 Test Loss: 0.508 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.7581682205200195
Epoch: 58, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.460 Vali Acc: 0.900 Test Loss: 0.460 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 2.552288055419922
Epoch: 59, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.473 Vali Acc: 0.856 Test Loss: 0.473 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.823723316192627
Epoch: 60, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.524 Vali Acc: 0.889 Test Loss: 0.524 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.9137494564056396
Epoch: 61, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.519 Vali Acc: 0.872 Test Loss: 0.519 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 1.8583319187164307
Epoch: 62, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.487 Vali Acc: 0.889 Test Loss: 0.487 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 2.1003024578094482
Epoch: 63, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.517 Vali Acc: 0.889 Test Loss: 0.517 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 590623
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.2603700160980225
Epoch: 1, Steps: 12 | Train Loss: 2.825 Vali Loss: 2.811 Vali Acc: 0.061 Test Loss: 2.811 Test Acc: 0.061
Validation loss decreased (inf --> -0.061083).  Saving model ...
Epoch: 2 cost time: 1.8842167854309082
Epoch: 2, Steps: 12 | Train Loss: 2.809 Vali Loss: 2.742 Vali Acc: 0.061 Test Loss: 2.742 Test Acc: 0.061
Validation loss decreased (-0.061083 --> -0.061084).  Saving model ...
Epoch: 3 cost time: 1.9004597663879395
Epoch: 3, Steps: 12 | Train Loss: 2.769 Vali Loss: 2.699 Vali Acc: 0.072 Test Loss: 2.699 Test Acc: 0.072
Validation loss decreased (-0.061084 --> -0.072195).  Saving model ...
Epoch: 4 cost time: 1.7284128665924072
Epoch: 4, Steps: 12 | Train Loss: 2.711 Vali Loss: 2.652 Vali Acc: 0.144 Test Loss: 2.652 Test Acc: 0.144
Validation loss decreased (-0.072195 --> -0.144418).  Saving model ...
Epoch: 5 cost time: 1.7606184482574463
Epoch: 5, Steps: 12 | Train Loss: 2.670 Vali Loss: 2.593 Vali Acc: 0.194 Test Loss: 2.593 Test Acc: 0.194
Validation loss decreased (-0.144418 --> -0.194419).  Saving model ...
Epoch: 6 cost time: 1.7790963649749756
Epoch: 6, Steps: 12 | Train Loss: 2.573 Vali Loss: 2.519 Vali Acc: 0.211 Test Loss: 2.519 Test Acc: 0.211
Validation loss decreased (-0.194419 --> -0.211086).  Saving model ...
Epoch: 7 cost time: 1.9481770992279053
Epoch: 7, Steps: 12 | Train Loss: 2.445 Vali Loss: 2.386 Vali Acc: 0.278 Test Loss: 2.386 Test Acc: 0.278
Validation loss decreased (-0.211086 --> -0.277754).  Saving model ...
Epoch: 8 cost time: 1.5785419940948486
Epoch: 8, Steps: 12 | Train Loss: 2.259 Vali Loss: 2.239 Vali Acc: 0.367 Test Loss: 2.239 Test Acc: 0.367
Validation loss decreased (-0.277754 --> -0.366644).  Saving model ...
Epoch: 9 cost time: 1.6292452812194824
Epoch: 9, Steps: 12 | Train Loss: 2.154 Vali Loss: 2.113 Vali Acc: 0.394 Test Loss: 2.113 Test Acc: 0.394
Validation loss decreased (-0.366644 --> -0.394423).  Saving model ...
Epoch: 10 cost time: 2.0461723804473877
Epoch: 10, Steps: 12 | Train Loss: 1.889 Vali Loss: 1.993 Vali Acc: 0.467 Test Loss: 1.993 Test Acc: 0.467
Validation loss decreased (-0.394423 --> -0.466647).  Saving model ...
Epoch: 11 cost time: 1.6334259510040283
Epoch: 11, Steps: 12 | Train Loss: 1.885 Vali Loss: 1.951 Vali Acc: 0.467 Test Loss: 1.951 Test Acc: 0.467
Validation loss decreased (-0.466647 --> -0.466647).  Saving model ...
Epoch: 12 cost time: 1.6754539012908936
Epoch: 12, Steps: 12 | Train Loss: 1.801 Vali Loss: 1.843 Vali Acc: 0.517 Test Loss: 1.843 Test Acc: 0.517
Validation loss decreased (-0.466647 --> -0.516648).  Saving model ...
Epoch: 13 cost time: 1.8037230968475342
Epoch: 13, Steps: 12 | Train Loss: 1.663 Vali Loss: 1.761 Vali Acc: 0.528 Test Loss: 1.761 Test Acc: 0.528
Validation loss decreased (-0.516648 --> -0.527760).  Saving model ...
Epoch: 14 cost time: 1.741753339767456
Epoch: 14, Steps: 12 | Train Loss: 1.623 Vali Loss: 1.702 Vali Acc: 0.572 Test Loss: 1.702 Test Acc: 0.572
Validation loss decreased (-0.527760 --> -0.572205).  Saving model ...
Epoch: 15 cost time: 1.801351547241211
Epoch: 15, Steps: 12 | Train Loss: 1.498 Vali Loss: 1.635 Vali Acc: 0.567 Test Loss: 1.635 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6317942142486572
Epoch: 16, Steps: 12 | Train Loss: 1.472 Vali Loss: 1.574 Vali Acc: 0.600 Test Loss: 1.574 Test Acc: 0.600
Validation loss decreased (-0.572205 --> -0.599984).  Saving model ...
Epoch: 17 cost time: 1.7397665977478027
Epoch: 17, Steps: 12 | Train Loss: 1.341 Vali Loss: 1.479 Vali Acc: 0.656 Test Loss: 1.479 Test Acc: 0.656
Validation loss decreased (-0.599984 --> -0.655541).  Saving model ...
Epoch: 18 cost time: 1.8275210857391357
Epoch: 18, Steps: 12 | Train Loss: 1.262 Vali Loss: 1.416 Vali Acc: 0.650 Test Loss: 1.416 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6153271198272705
Epoch: 19, Steps: 12 | Train Loss: 1.185 Vali Loss: 1.359 Vali Acc: 0.667 Test Loss: 1.359 Test Acc: 0.667
Validation loss decreased (-0.655541 --> -0.666653).  Saving model ...
Epoch: 20 cost time: 1.6497745513916016
Epoch: 20, Steps: 12 | Train Loss: 1.139 Vali Loss: 1.272 Vali Acc: 0.717 Test Loss: 1.272 Test Acc: 0.717
Validation loss decreased (-0.666653 --> -0.716654).  Saving model ...
Epoch: 21 cost time: 1.688551664352417
Epoch: 21, Steps: 12 | Train Loss: 1.013 Vali Loss: 1.208 Vali Acc: 0.744 Test Loss: 1.208 Test Acc: 0.744
Validation loss decreased (-0.716654 --> -0.744432).  Saving model ...
Epoch: 22 cost time: 1.8368251323699951
Epoch: 22, Steps: 12 | Train Loss: 1.036 Vali Loss: 1.181 Vali Acc: 0.744 Test Loss: 1.181 Test Acc: 0.744
Validation loss decreased (-0.744432 --> -0.744433).  Saving model ...
Epoch: 23 cost time: 1.8037879467010498
Epoch: 23, Steps: 12 | Train Loss: 0.935 Vali Loss: 1.080 Vali Acc: 0.778 Test Loss: 1.080 Test Acc: 0.778
Validation loss decreased (-0.744433 --> -0.777767).  Saving model ...
Epoch: 24 cost time: 1.8033792972564697
Epoch: 24, Steps: 12 | Train Loss: 0.895 Vali Loss: 1.042 Vali Acc: 0.800 Test Loss: 1.042 Test Acc: 0.800
Validation loss decreased (-0.777767 --> -0.799990).  Saving model ...
Epoch: 25 cost time: 1.752476692199707
Epoch: 25, Steps: 12 | Train Loss: 0.811 Vali Loss: 0.960 Vali Acc: 0.811 Test Loss: 0.960 Test Acc: 0.811
Validation loss decreased (-0.799990 --> -0.811102).  Saving model ...
Epoch: 26 cost time: 1.8000411987304688
Epoch: 26, Steps: 12 | Train Loss: 0.728 Vali Loss: 0.928 Vali Acc: 0.817 Test Loss: 0.928 Test Acc: 0.817
Validation loss decreased (-0.811102 --> -0.816657).  Saving model ...
Epoch: 27 cost time: 1.8483397960662842
Epoch: 27, Steps: 12 | Train Loss: 0.662 Vali Loss: 0.888 Vali Acc: 0.833 Test Loss: 0.888 Test Acc: 0.833
Validation loss decreased (-0.816657 --> -0.833324).  Saving model ...
Epoch: 28 cost time: 1.7444109916687012
Epoch: 28, Steps: 12 | Train Loss: 0.683 Vali Loss: 0.835 Vali Acc: 0.850 Test Loss: 0.835 Test Acc: 0.850
Validation loss decreased (-0.833324 --> -0.849992).  Saving model ...
Epoch: 29 cost time: 1.9297916889190674
Epoch: 29, Steps: 12 | Train Loss: 0.623 Vali Loss: 0.797 Vali Acc: 0.833 Test Loss: 0.797 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.6798815727233887
Epoch: 30, Steps: 12 | Train Loss: 0.589 Vali Loss: 0.811 Vali Acc: 0.817 Test Loss: 0.811 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.8811399936676025
Epoch: 31, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.727 Vali Acc: 0.844 Test Loss: 0.727 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.7098000049591064
Epoch: 32, Steps: 12 | Train Loss: 0.529 Vali Loss: 0.729 Vali Acc: 0.850 Test Loss: 0.729 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 33 cost time: 1.6171622276306152
Epoch: 33, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.682 Vali Acc: 0.856 Test Loss: 0.682 Test Acc: 0.856
Validation loss decreased (-0.849993 --> -0.855549).  Saving model ...
Epoch: 34 cost time: 1.8240015506744385
Epoch: 34, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.684 Vali Acc: 0.828 Test Loss: 0.684 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.6490566730499268
Epoch: 35, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.644 Vali Acc: 0.861 Test Loss: 0.644 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 36 cost time: 1.6604969501495361
Epoch: 36, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.651 Vali Acc: 0.822 Test Loss: 0.651 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.7218236923217773
Epoch: 37, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.612 Vali Acc: 0.833 Test Loss: 0.612 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.7562367916107178
Epoch: 38, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.628 Vali Acc: 0.833 Test Loss: 0.628 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.8144431114196777
Epoch: 39, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.604 Vali Acc: 0.828 Test Loss: 0.604 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.150986909866333
Epoch: 40, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.613 Vali Acc: 0.850 Test Loss: 0.613 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.6101062297821045
Epoch: 41, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.605 Vali Acc: 0.839 Test Loss: 0.605 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.7217581272125244
Epoch: 42, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.561 Vali Acc: 0.856 Test Loss: 0.561 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.9289474487304688
Epoch: 43, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.572 Vali Acc: 0.844 Test Loss: 0.572 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.9476444721221924
Epoch: 44, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.558 Vali Acc: 0.861 Test Loss: 0.558 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861106).  Saving model ...
Epoch: 45 cost time: 1.684600830078125
Epoch: 45, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.566 Vali Acc: 0.850 Test Loss: 0.566 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.8957390785217285
Epoch: 46, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.549 Vali Acc: 0.850 Test Loss: 0.549 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.6966640949249268
Epoch: 47, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.573 Vali Acc: 0.828 Test Loss: 0.573 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.722379446029663
Epoch: 48, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.540 Vali Acc: 0.844 Test Loss: 0.540 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 2.0165586471557617
Epoch: 49, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.574 Vali Acc: 0.861 Test Loss: 0.574 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.7532312870025635
Epoch: 50, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.586 Vali Acc: 0.850 Test Loss: 0.586 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.640791654586792
Epoch: 51, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.562 Vali Acc: 0.844 Test Loss: 0.562 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.4980270862579346
Epoch: 52, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.558 Vali Acc: 0.850 Test Loss: 0.558 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.7402842044830322
Epoch: 53, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.561 Vali Acc: 0.833 Test Loss: 0.561 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.5800225734710693
Epoch: 54, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.548 Vali Acc: 0.856 Test Loss: 0.548 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 358335
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.643383026123047
Epoch: 1, Steps: 12 | Train Loss: 2.870 Vali Loss: 2.792 Vali Acc: 0.089 Test Loss: 2.792 Test Acc: 0.089
Validation loss decreased (inf --> -0.088861).  Saving model ...
Epoch: 2 cost time: 1.5762579441070557
Epoch: 2, Steps: 12 | Train Loss: 2.789 Vali Loss: 2.706 Vali Acc: 0.094 Test Loss: 2.706 Test Acc: 0.094
Validation loss decreased (-0.088861 --> -0.094417).  Saving model ...
Epoch: 3 cost time: 1.8031067848205566
Epoch: 3, Steps: 12 | Train Loss: 2.710 Vali Loss: 2.639 Vali Acc: 0.183 Test Loss: 2.639 Test Acc: 0.183
Validation loss decreased (-0.094417 --> -0.183307).  Saving model ...
Epoch: 4 cost time: 1.4668855667114258
Epoch: 4, Steps: 12 | Train Loss: 2.614 Vali Loss: 2.565 Vali Acc: 0.211 Test Loss: 2.565 Test Acc: 0.211
Validation loss decreased (-0.183307 --> -0.211085).  Saving model ...
Epoch: 5 cost time: 1.5496587753295898
Epoch: 5, Steps: 12 | Train Loss: 2.580 Vali Loss: 2.464 Vali Acc: 0.317 Test Loss: 2.464 Test Acc: 0.317
Validation loss decreased (-0.211085 --> -0.316642).  Saving model ...
Epoch: 6 cost time: 1.3350422382354736
Epoch: 6, Steps: 12 | Train Loss: 2.369 Vali Loss: 2.348 Vali Acc: 0.322 Test Loss: 2.348 Test Acc: 0.322
Validation loss decreased (-0.316642 --> -0.322199).  Saving model ...
Epoch: 7 cost time: 2.470569133758545
Epoch: 7, Steps: 12 | Train Loss: 2.324 Vali Loss: 2.211 Vali Acc: 0.367 Test Loss: 2.211 Test Acc: 0.367
Validation loss decreased (-0.322199 --> -0.366645).  Saving model ...
Epoch: 8 cost time: 1.9321141242980957
Epoch: 8, Steps: 12 | Train Loss: 2.121 Vali Loss: 2.082 Vali Acc: 0.478 Test Loss: 2.082 Test Acc: 0.478
Validation loss decreased (-0.366645 --> -0.477757).  Saving model ...
Epoch: 9 cost time: 1.4925425052642822
Epoch: 9, Steps: 12 | Train Loss: 1.990 Vali Loss: 1.975 Vali Acc: 0.456 Test Loss: 1.975 Test Acc: 0.456
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9866013526916504
Epoch: 10, Steps: 12 | Train Loss: 1.924 Vali Loss: 1.873 Vali Acc: 0.483 Test Loss: 1.873 Test Acc: 0.483
Validation loss decreased (-0.477757 --> -0.483315).  Saving model ...
Epoch: 11 cost time: 1.8579776287078857
Epoch: 11, Steps: 12 | Train Loss: 1.798 Vali Loss: 1.780 Vali Acc: 0.528 Test Loss: 1.780 Test Acc: 0.528
Validation loss decreased (-0.483315 --> -0.527760).  Saving model ...
Epoch: 12 cost time: 1.6700329780578613
Epoch: 12, Steps: 12 | Train Loss: 1.675 Vali Loss: 1.701 Vali Acc: 0.567 Test Loss: 1.701 Test Acc: 0.567
Validation loss decreased (-0.527760 --> -0.566650).  Saving model ...
Epoch: 13 cost time: 1.9872281551361084
Epoch: 13, Steps: 12 | Train Loss: 1.598 Vali Loss: 1.644 Vali Acc: 0.594 Test Loss: 1.644 Test Acc: 0.594
Validation loss decreased (-0.566650 --> -0.594428).  Saving model ...
Epoch: 14 cost time: 1.8865861892700195
Epoch: 14, Steps: 12 | Train Loss: 1.514 Vali Loss: 1.575 Vali Acc: 0.594 Test Loss: 1.575 Test Acc: 0.594
Validation loss decreased (-0.594428 --> -0.594429).  Saving model ...
Epoch: 15 cost time: 1.5771009922027588
Epoch: 15, Steps: 12 | Train Loss: 1.498 Vali Loss: 1.491 Vali Acc: 0.650 Test Loss: 1.491 Test Acc: 0.650
Validation loss decreased (-0.594429 --> -0.649985).  Saving model ...
Epoch: 16 cost time: 1.8323183059692383
Epoch: 16, Steps: 12 | Train Loss: 1.350 Vali Loss: 1.424 Vali Acc: 0.650 Test Loss: 1.424 Test Acc: 0.650
Validation loss decreased (-0.649985 --> -0.649986).  Saving model ...
Epoch: 17 cost time: 1.8188729286193848
Epoch: 17, Steps: 12 | Train Loss: 1.313 Vali Loss: 1.320 Vali Acc: 0.689 Test Loss: 1.320 Test Acc: 0.689
Validation loss decreased (-0.649986 --> -0.688876).  Saving model ...
Epoch: 18 cost time: 2.013960838317871
Epoch: 18, Steps: 12 | Train Loss: 1.209 Vali Loss: 1.254 Vali Acc: 0.706 Test Loss: 1.254 Test Acc: 0.706
Validation loss decreased (-0.688876 --> -0.705543).  Saving model ...
Epoch: 19 cost time: 1.8801956176757812
Epoch: 19, Steps: 12 | Train Loss: 1.153 Vali Loss: 1.174 Vali Acc: 0.744 Test Loss: 1.174 Test Acc: 0.744
Validation loss decreased (-0.705543 --> -0.744433).  Saving model ...
Epoch: 20 cost time: 1.5625264644622803
Epoch: 20, Steps: 12 | Train Loss: 1.093 Vali Loss: 1.114 Vali Acc: 0.761 Test Loss: 1.114 Test Acc: 0.761
Validation loss decreased (-0.744433 --> -0.761100).  Saving model ...
Epoch: 21 cost time: 1.6920576095581055
Epoch: 21, Steps: 12 | Train Loss: 1.023 Vali Loss: 1.043 Vali Acc: 0.778 Test Loss: 1.043 Test Acc: 0.778
Validation loss decreased (-0.761100 --> -0.777767).  Saving model ...
Epoch: 22 cost time: 1.7400848865509033
Epoch: 22, Steps: 12 | Train Loss: 0.931 Vali Loss: 0.973 Vali Acc: 0.806 Test Loss: 0.973 Test Acc: 0.806
Validation loss decreased (-0.777767 --> -0.805546).  Saving model ...
Epoch: 23 cost time: 1.6044044494628906
Epoch: 23, Steps: 12 | Train Loss: 0.881 Vali Loss: 0.919 Vali Acc: 0.806 Test Loss: 0.919 Test Acc: 0.806
Validation loss decreased (-0.805546 --> -0.805546).  Saving model ...
Epoch: 24 cost time: 1.7950413227081299
Epoch: 24, Steps: 12 | Train Loss: 0.848 Vali Loss: 0.892 Vali Acc: 0.806 Test Loss: 0.892 Test Acc: 0.806
Validation loss decreased (-0.805546 --> -0.805547).  Saving model ...
Epoch: 25 cost time: 1.538874626159668
Epoch: 25, Steps: 12 | Train Loss: 0.781 Vali Loss: 0.844 Vali Acc: 0.833 Test Loss: 0.844 Test Acc: 0.833
Validation loss decreased (-0.805547 --> -0.833325).  Saving model ...
Epoch: 26 cost time: 1.4460995197296143
Epoch: 26, Steps: 12 | Train Loss: 0.712 Vali Loss: 0.792 Vali Acc: 0.811 Test Loss: 0.792 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6461482048034668
Epoch: 27, Steps: 12 | Train Loss: 0.662 Vali Loss: 0.739 Vali Acc: 0.833 Test Loss: 0.739 Test Acc: 0.833
Validation loss decreased (-0.833325 --> -0.833326).  Saving model ...
Epoch: 28 cost time: 1.6976451873779297
Epoch: 28, Steps: 12 | Train Loss: 0.677 Vali Loss: 0.714 Vali Acc: 0.817 Test Loss: 0.714 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.6197538375854492
Epoch: 29, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.680 Vali Acc: 0.817 Test Loss: 0.680 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.5151512622833252
Epoch: 30, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.713 Vali Acc: 0.811 Test Loss: 0.713 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.809753656387329
Epoch: 31, Steps: 12 | Train Loss: 0.534 Vali Loss: 0.640 Vali Acc: 0.828 Test Loss: 0.640 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.4864816665649414
Epoch: 32, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.597 Vali Acc: 0.850 Test Loss: 0.597 Test Acc: 0.850
Validation loss decreased (-0.833326 --> -0.849994).  Saving model ...
Epoch: 33 cost time: 1.6476845741271973
Epoch: 33, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.597 Vali Acc: 0.844 Test Loss: 0.597 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.032169818878174
Epoch: 34, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.549 Vali Acc: 0.878 Test Loss: 0.549 Test Acc: 0.878
Validation loss decreased (-0.849994 --> -0.877772).  Saving model ...
Epoch: 35 cost time: 1.5890519618988037
Epoch: 35, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.555 Vali Acc: 0.833 Test Loss: 0.555 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.5768518447875977
Epoch: 36, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.538 Vali Acc: 0.872 Test Loss: 0.538 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.7207801342010498
Epoch: 37, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.535 Vali Acc: 0.861 Test Loss: 0.535 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.7166039943695068
Epoch: 38, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.539 Vali Acc: 0.839 Test Loss: 0.539 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.4941275119781494
Epoch: 39, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.509 Vali Acc: 0.872 Test Loss: 0.509 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.6989731788635254
Epoch: 40, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.525 Vali Acc: 0.856 Test Loss: 0.525 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.3776342868804932
Epoch: 41, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.482 Vali Acc: 0.872 Test Loss: 0.482 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.70573091506958
Epoch: 42, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.460 Vali Acc: 0.872 Test Loss: 0.460 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.7124090194702148
Epoch: 43, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.502 Vali Acc: 0.861 Test Loss: 0.502 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.6630959510803223
Epoch: 44, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.464 Vali Acc: 0.872 Test Loss: 0.464 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 358111
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6158604621887207
Epoch: 1, Steps: 12 | Train Loss: 2.809 Vali Loss: 2.782 Vali Acc: 0.106 Test Loss: 2.782 Test Acc: 0.106
Validation loss decreased (inf --> -0.105528).  Saving model ...
Epoch: 2 cost time: 1.6193175315856934
Epoch: 2, Steps: 12 | Train Loss: 2.783 Vali Loss: 2.705 Vali Acc: 0.094 Test Loss: 2.705 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7075505256652832
Epoch: 3, Steps: 12 | Train Loss: 2.741 Vali Loss: 2.637 Vali Acc: 0.139 Test Loss: 2.637 Test Acc: 0.139
Validation loss decreased (-0.105528 --> -0.138863).  Saving model ...
Epoch: 4 cost time: 1.9853856563568115
Epoch: 4, Steps: 12 | Train Loss: 2.679 Vali Loss: 2.563 Vali Acc: 0.217 Test Loss: 2.563 Test Acc: 0.217
Validation loss decreased (-0.138863 --> -0.216641).  Saving model ...
Epoch: 5 cost time: 1.7425537109375
Epoch: 5, Steps: 12 | Train Loss: 2.580 Vali Loss: 2.465 Vali Acc: 0.261 Test Loss: 2.465 Test Acc: 0.261
Validation loss decreased (-0.216641 --> -0.261086).  Saving model ...
Epoch: 6 cost time: 2.025299310684204
Epoch: 6, Steps: 12 | Train Loss: 2.472 Vali Loss: 2.348 Vali Acc: 0.328 Test Loss: 2.348 Test Acc: 0.328
Validation loss decreased (-0.261086 --> -0.327754).  Saving model ...
Epoch: 7 cost time: 1.7647268772125244
Epoch: 7, Steps: 12 | Train Loss: 2.350 Vali Loss: 2.245 Vali Acc: 0.356 Test Loss: 2.245 Test Acc: 0.356
Validation loss decreased (-0.327754 --> -0.355533).  Saving model ...
Epoch: 8 cost time: 1.5861551761627197
Epoch: 8, Steps: 12 | Train Loss: 2.222 Vali Loss: 2.134 Vali Acc: 0.444 Test Loss: 2.134 Test Acc: 0.444
Validation loss decreased (-0.355533 --> -0.444423).  Saving model ...
Epoch: 9 cost time: 2.0621631145477295
Epoch: 9, Steps: 12 | Train Loss: 2.155 Vali Loss: 2.026 Vali Acc: 0.483 Test Loss: 2.026 Test Acc: 0.483
Validation loss decreased (-0.444423 --> -0.483313).  Saving model ...
Epoch: 10 cost time: 1.7295587062835693
Epoch: 10, Steps: 12 | Train Loss: 1.989 Vali Loss: 1.910 Vali Acc: 0.556 Test Loss: 1.910 Test Acc: 0.556
Validation loss decreased (-0.483313 --> -0.555536).  Saving model ...
Epoch: 11 cost time: 1.7818751335144043
Epoch: 11, Steps: 12 | Train Loss: 1.853 Vali Loss: 1.813 Vali Acc: 0.567 Test Loss: 1.813 Test Acc: 0.567
Validation loss decreased (-0.555536 --> -0.566649).  Saving model ...
Epoch: 12 cost time: 1.7295241355895996
Epoch: 12, Steps: 12 | Train Loss: 1.760 Vali Loss: 1.718 Vali Acc: 0.606 Test Loss: 1.718 Test Acc: 0.606
Validation loss decreased (-0.566649 --> -0.605538).  Saving model ...
Epoch: 13 cost time: 1.848189115524292
Epoch: 13, Steps: 12 | Train Loss: 1.623 Vali Loss: 1.624 Vali Acc: 0.622 Test Loss: 1.624 Test Acc: 0.622
Validation loss decreased (-0.605538 --> -0.622206).  Saving model ...
Epoch: 14 cost time: 1.8441321849822998
Epoch: 14, Steps: 12 | Train Loss: 1.573 Vali Loss: 1.557 Vali Acc: 0.689 Test Loss: 1.557 Test Acc: 0.689
Validation loss decreased (-0.622206 --> -0.688873).  Saving model ...
Epoch: 15 cost time: 1.9318866729736328
Epoch: 15, Steps: 12 | Train Loss: 1.424 Vali Loss: 1.472 Vali Acc: 0.656 Test Loss: 1.472 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.3319923877716064
Epoch: 16, Steps: 12 | Train Loss: 1.336 Vali Loss: 1.395 Vali Acc: 0.689 Test Loss: 1.395 Test Acc: 0.689
Validation loss decreased (-0.688873 --> -0.688875).  Saving model ...
Epoch: 17 cost time: 1.8625469207763672
Epoch: 17, Steps: 12 | Train Loss: 1.326 Vali Loss: 1.337 Vali Acc: 0.739 Test Loss: 1.337 Test Acc: 0.739
Validation loss decreased (-0.688875 --> -0.738876).  Saving model ...
Epoch: 18 cost time: 1.7581541538238525
Epoch: 18, Steps: 12 | Train Loss: 1.226 Vali Loss: 1.243 Vali Acc: 0.750 Test Loss: 1.243 Test Acc: 0.750
Validation loss decreased (-0.738876 --> -0.749988).  Saving model ...
Epoch: 19 cost time: 1.9832630157470703
Epoch: 19, Steps: 12 | Train Loss: 1.130 Vali Loss: 1.203 Vali Acc: 0.744 Test Loss: 1.203 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6257996559143066
Epoch: 20, Steps: 12 | Train Loss: 1.059 Vali Loss: 1.139 Vali Acc: 0.767 Test Loss: 1.139 Test Acc: 0.767
Validation loss decreased (-0.749988 --> -0.766655).  Saving model ...
Epoch: 21 cost time: 1.7702758312225342
Epoch: 21, Steps: 12 | Train Loss: 1.008 Vali Loss: 1.066 Vali Acc: 0.778 Test Loss: 1.066 Test Acc: 0.778
Validation loss decreased (-0.766655 --> -0.777767).  Saving model ...
Epoch: 22 cost time: 1.551978349685669
Epoch: 22, Steps: 12 | Train Loss: 0.892 Vali Loss: 1.007 Vali Acc: 0.811 Test Loss: 1.007 Test Acc: 0.811
Validation loss decreased (-0.777767 --> -0.811101).  Saving model ...
Epoch: 23 cost time: 1.7729239463806152
Epoch: 23, Steps: 12 | Train Loss: 0.868 Vali Loss: 0.953 Vali Acc: 0.811 Test Loss: 0.953 Test Acc: 0.811
Validation loss decreased (-0.811101 --> -0.811102).  Saving model ...
Epoch: 24 cost time: 1.652047872543335
Epoch: 24, Steps: 12 | Train Loss: 0.798 Vali Loss: 0.931 Vali Acc: 0.811 Test Loss: 0.931 Test Acc: 0.811
Validation loss decreased (-0.811102 --> -0.811102).  Saving model ...
Epoch: 25 cost time: 1.606039047241211
Epoch: 25, Steps: 12 | Train Loss: 0.739 Vali Loss: 0.869 Vali Acc: 0.811 Test Loss: 0.869 Test Acc: 0.811
Validation loss decreased (-0.811102 --> -0.811102).  Saving model ...
Epoch: 26 cost time: 1.5967893600463867
Epoch: 26, Steps: 12 | Train Loss: 0.738 Vali Loss: 0.829 Vali Acc: 0.833 Test Loss: 0.829 Test Acc: 0.833
Validation loss decreased (-0.811102 --> -0.833325).  Saving model ...
Epoch: 27 cost time: 1.6069867610931396
Epoch: 27, Steps: 12 | Train Loss: 0.617 Vali Loss: 0.818 Vali Acc: 0.811 Test Loss: 0.818 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5327558517456055
Epoch: 28, Steps: 12 | Train Loss: 0.664 Vali Loss: 0.760 Vali Acc: 0.833 Test Loss: 0.760 Test Acc: 0.833
Validation loss decreased (-0.833325 --> -0.833326).  Saving model ...
Epoch: 29 cost time: 1.7064802646636963
Epoch: 29, Steps: 12 | Train Loss: 0.590 Vali Loss: 0.750 Vali Acc: 0.844 Test Loss: 0.750 Test Acc: 0.844
Validation loss decreased (-0.833326 --> -0.844437).  Saving model ...
Epoch: 30 cost time: 1.6967966556549072
Epoch: 30, Steps: 12 | Train Loss: 0.555 Vali Loss: 0.703 Vali Acc: 0.861 Test Loss: 0.703 Test Acc: 0.861
Validation loss decreased (-0.844437 --> -0.861104).  Saving model ...
Epoch: 31 cost time: 1.7118432521820068
Epoch: 31, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.672 Vali Acc: 0.861 Test Loss: 0.672 Test Acc: 0.861
Validation loss decreased (-0.861104 --> -0.861104).  Saving model ...
Epoch: 32 cost time: 1.7397103309631348
Epoch: 32, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.668 Vali Acc: 0.856 Test Loss: 0.668 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.5664026737213135
Epoch: 33, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.622 Vali Acc: 0.861 Test Loss: 0.622 Test Acc: 0.861
Validation loss decreased (-0.861104 --> -0.861105).  Saving model ...
Epoch: 34 cost time: 1.7076444625854492
Epoch: 34, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.604 Vali Acc: 0.861 Test Loss: 0.604 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 35 cost time: 1.708113670349121
Epoch: 35, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.621 Vali Acc: 0.867 Test Loss: 0.621 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866660).  Saving model ...
Epoch: 36 cost time: 1.6248841285705566
Epoch: 36, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.588 Vali Acc: 0.856 Test Loss: 0.588 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.6912107467651367
Epoch: 37, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.566 Vali Acc: 0.867 Test Loss: 0.566 Test Acc: 0.867
Validation loss decreased (-0.866660 --> -0.866661).  Saving model ...
Epoch: 38 cost time: 1.5184383392333984
Epoch: 38, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.540 Vali Acc: 0.856 Test Loss: 0.540 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.009136915206909
Epoch: 39, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.561 Vali Acc: 0.856 Test Loss: 0.561 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.7629060745239258
Epoch: 40, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.551 Vali Acc: 0.850 Test Loss: 0.551 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.4942936897277832
Epoch: 41, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.534 Vali Acc: 0.867 Test Loss: 0.534 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 42 cost time: 1.8606128692626953
Epoch: 42, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.498 Vali Acc: 0.878 Test Loss: 0.498 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877773).  Saving model ...
Epoch: 43 cost time: 1.425731897354126
Epoch: 43, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.520 Vali Acc: 0.872 Test Loss: 0.520 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.5634703636169434
Epoch: 44, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.512 Vali Acc: 0.883 Test Loss: 0.512 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883328).  Saving model ...
Epoch: 45 cost time: 1.7181015014648438
Epoch: 45, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.510 Vali Acc: 0.872 Test Loss: 0.510 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.6432344913482666
Epoch: 46, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.488 Vali Acc: 0.867 Test Loss: 0.488 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.625328779220581
Epoch: 47, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.491 Vali Acc: 0.872 Test Loss: 0.491 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.9045302867889404
Epoch: 48, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.504 Vali Acc: 0.867 Test Loss: 0.504 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.970564603805542
Epoch: 49, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.500 Vali Acc: 0.872 Test Loss: 0.500 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.8716883659362793
Epoch: 50, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.502 Vali Acc: 0.878 Test Loss: 0.502 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.8602774143218994
Epoch: 51, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.492 Vali Acc: 0.872 Test Loss: 0.492 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.821441650390625
Epoch: 52, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.576 Vali Acc: 0.844 Test Loss: 0.576 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.5475938320159912
Epoch: 53, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.524 Vali Acc: 0.872 Test Loss: 0.524 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.691129207611084
Epoch: 54, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.550 Vali Acc: 0.856 Test Loss: 0.550 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 357887
model size : 2.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6710896492004395
Epoch: 1, Steps: 12 | Train Loss: 2.844 Vali Loss: 2.821 Vali Acc: 0.078 Test Loss: 2.821 Test Acc: 0.078
Validation loss decreased (inf --> -0.077750).  Saving model ...
Epoch: 2 cost time: 1.6038053035736084
Epoch: 2, Steps: 12 | Train Loss: 2.794 Vali Loss: 2.737 Vali Acc: 0.061 Test Loss: 2.737 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5617425441741943
Epoch: 3, Steps: 12 | Train Loss: 2.710 Vali Loss: 2.678 Vali Acc: 0.100 Test Loss: 2.678 Test Acc: 0.100
Validation loss decreased (-0.077750 --> -0.099973).  Saving model ...
Epoch: 4 cost time: 1.4651494026184082
Epoch: 4, Steps: 12 | Train Loss: 2.686 Vali Loss: 2.627 Vali Acc: 0.200 Test Loss: 2.627 Test Acc: 0.200
Validation loss decreased (-0.099973 --> -0.199974).  Saving model ...
Epoch: 5 cost time: 1.6744589805603027
Epoch: 5, Steps: 12 | Train Loss: 2.626 Vali Loss: 2.550 Vali Acc: 0.217 Test Loss: 2.550 Test Acc: 0.217
Validation loss decreased (-0.199974 --> -0.216641).  Saving model ...
Epoch: 6 cost time: 1.6415321826934814
Epoch: 6, Steps: 12 | Train Loss: 2.503 Vali Loss: 2.425 Vali Acc: 0.339 Test Loss: 2.425 Test Acc: 0.339
Validation loss decreased (-0.216641 --> -0.338865).  Saving model ...
Epoch: 7 cost time: 1.3983123302459717
Epoch: 7, Steps: 12 | Train Loss: 2.329 Vali Loss: 2.282 Vali Acc: 0.283 Test Loss: 2.282 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4744665622711182
Epoch: 8, Steps: 12 | Train Loss: 2.224 Vali Loss: 2.169 Vali Acc: 0.356 Test Loss: 2.169 Test Acc: 0.356
Validation loss decreased (-0.338865 --> -0.355534).  Saving model ...
Epoch: 9 cost time: 1.5526912212371826
Epoch: 9, Steps: 12 | Train Loss: 2.077 Vali Loss: 2.068 Vali Acc: 0.417 Test Loss: 2.068 Test Acc: 0.417
Validation loss decreased (-0.355534 --> -0.416646).  Saving model ...
Epoch: 10 cost time: 1.5633196830749512
Epoch: 10, Steps: 12 | Train Loss: 1.956 Vali Loss: 1.972 Vali Acc: 0.489 Test Loss: 1.972 Test Acc: 0.489
Validation loss decreased (-0.416646 --> -0.488869).  Saving model ...
Epoch: 11 cost time: 1.7270488739013672
Epoch: 11, Steps: 12 | Train Loss: 1.878 Vali Loss: 1.902 Vali Acc: 0.478 Test Loss: 1.902 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5357911586761475
Epoch: 12, Steps: 12 | Train Loss: 1.769 Vali Loss: 1.821 Vali Acc: 0.517 Test Loss: 1.821 Test Acc: 0.517
Validation loss decreased (-0.488869 --> -0.516648).  Saving model ...
Epoch: 13 cost time: 1.6827630996704102
Epoch: 13, Steps: 12 | Train Loss: 1.659 Vali Loss: 1.711 Vali Acc: 0.589 Test Loss: 1.711 Test Acc: 0.589
Validation loss decreased (-0.516648 --> -0.588872).  Saving model ...
Epoch: 14 cost time: 1.522538185119629
Epoch: 14, Steps: 12 | Train Loss: 1.579 Vali Loss: 1.642 Vali Acc: 0.667 Test Loss: 1.642 Test Acc: 0.667
Validation loss decreased (-0.588872 --> -0.666650).  Saving model ...
Epoch: 15 cost time: 1.5586040019989014
Epoch: 15, Steps: 12 | Train Loss: 1.521 Vali Loss: 1.558 Vali Acc: 0.683 Test Loss: 1.558 Test Acc: 0.683
Validation loss decreased (-0.666650 --> -0.683318).  Saving model ...
Epoch: 16 cost time: 1.7427394390106201
Epoch: 16, Steps: 12 | Train Loss: 1.466 Vali Loss: 1.521 Vali Acc: 0.678 Test Loss: 1.521 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6656267642974854
Epoch: 17, Steps: 12 | Train Loss: 1.365 Vali Loss: 1.443 Vali Acc: 0.700 Test Loss: 1.443 Test Acc: 0.700
Validation loss decreased (-0.683318 --> -0.699986).  Saving model ...
Epoch: 18 cost time: 1.467353105545044
Epoch: 18, Steps: 12 | Train Loss: 1.279 Vali Loss: 1.393 Vali Acc: 0.728 Test Loss: 1.393 Test Acc: 0.728
Validation loss decreased (-0.699986 --> -0.727764).  Saving model ...
Epoch: 19 cost time: 1.6897213459014893
Epoch: 19, Steps: 12 | Train Loss: 1.252 Vali Loss: 1.319 Vali Acc: 0.750 Test Loss: 1.319 Test Acc: 0.750
Validation loss decreased (-0.727764 --> -0.749987).  Saving model ...
Epoch: 20 cost time: 1.3673598766326904
Epoch: 20, Steps: 12 | Train Loss: 1.128 Vali Loss: 1.228 Vali Acc: 0.733 Test Loss: 1.228 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6497936248779297
Epoch: 21, Steps: 12 | Train Loss: 1.143 Vali Loss: 1.176 Vali Acc: 0.761 Test Loss: 1.176 Test Acc: 0.761
Validation loss decreased (-0.749987 --> -0.761099).  Saving model ...
Epoch: 22 cost time: 1.6120877265930176
Epoch: 22, Steps: 12 | Train Loss: 1.032 Vali Loss: 1.110 Vali Acc: 0.767 Test Loss: 1.110 Test Acc: 0.767
Validation loss decreased (-0.761099 --> -0.766656).  Saving model ...
Epoch: 23 cost time: 1.4991605281829834
Epoch: 23, Steps: 12 | Train Loss: 0.961 Vali Loss: 1.064 Vali Acc: 0.750 Test Loss: 1.064 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.57552170753479
Epoch: 24, Steps: 12 | Train Loss: 0.908 Vali Loss: 1.018 Vali Acc: 0.767 Test Loss: 1.018 Test Acc: 0.767
Validation loss decreased (-0.766656 --> -0.766656).  Saving model ...
Epoch: 25 cost time: 1.692918300628662
Epoch: 25, Steps: 12 | Train Loss: 0.822 Vali Loss: 0.961 Vali Acc: 0.789 Test Loss: 0.961 Test Acc: 0.789
Validation loss decreased (-0.766656 --> -0.788879).  Saving model ...
Epoch: 26 cost time: 1.6693320274353027
Epoch: 26, Steps: 12 | Train Loss: 0.805 Vali Loss: 0.926 Vali Acc: 0.800 Test Loss: 0.926 Test Acc: 0.800
Validation loss decreased (-0.788879 --> -0.799991).  Saving model ...
Epoch: 27 cost time: 1.5617897510528564
Epoch: 27, Steps: 12 | Train Loss: 0.732 Vali Loss: 0.873 Vali Acc: 0.778 Test Loss: 0.873 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5004723072052002
Epoch: 28, Steps: 12 | Train Loss: 0.721 Vali Loss: 0.837 Vali Acc: 0.794 Test Loss: 0.837 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.540945053100586
Epoch: 29, Steps: 12 | Train Loss: 0.656 Vali Loss: 0.838 Vali Acc: 0.794 Test Loss: 0.838 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4587032794952393
Epoch: 30, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.799 Vali Acc: 0.794 Test Loss: 0.799 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.690119981765747
Epoch: 31, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.749 Vali Acc: 0.817 Test Loss: 0.749 Test Acc: 0.817
Validation loss decreased (-0.799991 --> -0.816659).  Saving model ...
Epoch: 32 cost time: 1.5105986595153809
Epoch: 32, Steps: 12 | Train Loss: 0.564 Vali Loss: 0.731 Vali Acc: 0.800 Test Loss: 0.731 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.74233078956604
Epoch: 33, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.695 Vali Acc: 0.817 Test Loss: 0.695 Test Acc: 0.817
Validation loss decreased (-0.816659 --> -0.816660).  Saving model ...
Epoch: 34 cost time: 1.5524792671203613
Epoch: 34, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.655 Vali Acc: 0.839 Test Loss: 0.655 Test Acc: 0.839
Validation loss decreased (-0.816660 --> -0.838882).  Saving model ...
Epoch: 35 cost time: 1.4948053359985352
Epoch: 35, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.679 Vali Acc: 0.828 Test Loss: 0.679 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.4992179870605469
Epoch: 36, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.610 Vali Acc: 0.850 Test Loss: 0.610 Test Acc: 0.850
Validation loss decreased (-0.838882 --> -0.849994).  Saving model ...
Epoch: 37 cost time: 1.5805299282073975
Epoch: 37, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.644 Vali Acc: 0.839 Test Loss: 0.644 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.7021048069000244
Epoch: 38, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.586 Vali Acc: 0.850 Test Loss: 0.586 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 39 cost time: 1.5479061603546143
Epoch: 39, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.566 Vali Acc: 0.867 Test Loss: 0.566 Test Acc: 0.867
Validation loss decreased (-0.849994 --> -0.866661).  Saving model ...
Epoch: 40 cost time: 1.4459631443023682
Epoch: 40, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.593 Vali Acc: 0.833 Test Loss: 0.593 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.78236722946167
Epoch: 41, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.538 Vali Acc: 0.861 Test Loss: 0.538 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.898705244064331
Epoch: 42, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.590 Vali Acc: 0.850 Test Loss: 0.590 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.5783936977386475
Epoch: 43, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.553 Vali Acc: 0.839 Test Loss: 0.553 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.5775723457336426
Epoch: 44, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.547 Vali Acc: 0.839 Test Loss: 0.547 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.6056208610534668
Epoch: 45, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.513 Vali Acc: 0.861 Test Loss: 0.513 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.6297814846038818
Epoch: 46, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.515 Vali Acc: 0.867 Test Loss: 0.515 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866662).  Saving model ...
Epoch: 47 cost time: 2.001667022705078
Epoch: 47, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.526 Vali Acc: 0.861 Test Loss: 0.526 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.5904617309570312
Epoch: 48, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.555 Vali Acc: 0.856 Test Loss: 0.555 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.726581335067749
Epoch: 49, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.511 Vali Acc: 0.856 Test Loss: 0.511 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.5932865142822266
Epoch: 50, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.532 Vali Acc: 0.833 Test Loss: 0.532 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.3987109661102295
Epoch: 51, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.530 Vali Acc: 0.878 Test Loss: 0.530 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877772).  Saving model ...
Epoch: 52 cost time: 1.574507713317871
Epoch: 52, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.482 Vali Acc: 0.861 Test Loss: 0.482 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.5212719440460205
Epoch: 53, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.474 Vali Acc: 0.878 Test Loss: 0.474 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877773).  Saving model ...
Epoch: 54 cost time: 1.6674976348876953
Epoch: 54, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.507 Vali Acc: 0.878 Test Loss: 0.507 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.7818150520324707
Epoch: 55, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.494 Vali Acc: 0.861 Test Loss: 0.494 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.6053805351257324
Epoch: 56, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.481 Vali Acc: 0.878 Test Loss: 0.481 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.5806143283843994
Epoch: 57, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.484 Vali Acc: 0.872 Test Loss: 0.484 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.6057558059692383
Epoch: 58, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.479 Vali Acc: 0.867 Test Loss: 0.479 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.5767552852630615
Epoch: 59, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.476 Vali Acc: 0.872 Test Loss: 0.476 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.7389130592346191
Epoch: 60, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.486 Vali Acc: 0.878 Test Loss: 0.486 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.7823774814605713
Epoch: 61, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.450 Vali Acc: 0.883 Test Loss: 0.450 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883329).  Saving model ...
Epoch: 62 cost time: 1.5810298919677734
Epoch: 62, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.467 Vali Acc: 0.872 Test Loss: 0.467 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 2.1407971382141113
Epoch: 63, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.506 Vali Acc: 0.850 Test Loss: 0.506 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.543262243270874
Epoch: 64, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.483 Vali Acc: 0.883 Test Loss: 0.483 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 1.8657667636871338
Epoch: 65, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.465 Vali Acc: 0.878 Test Loss: 0.465 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 1.6199960708618164
Epoch: 66, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.470 Vali Acc: 0.883 Test Loss: 0.470 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 2.2993171215057373
Epoch: 67, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.463 Vali Acc: 0.889 Test Loss: 0.463 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888884).  Saving model ...
Epoch: 68 cost time: 1.7228116989135742
Epoch: 68, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.472 Vali Acc: 0.878 Test Loss: 0.472 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.7417867183685303
Epoch: 69, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.550 Vali Acc: 0.872 Test Loss: 0.550 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 2.0085389614105225
Epoch: 70, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.502 Vali Acc: 0.878 Test Loss: 0.502 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.9680113792419434
Epoch: 71, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.534 Vali Acc: 0.861 Test Loss: 0.534 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 1.9010984897613525
Epoch: 72, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.500 Vali Acc: 0.872 Test Loss: 0.500 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 1.6634209156036377
Epoch: 73, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.491 Vali Acc: 0.872 Test Loss: 0.491 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 1.6768181324005127
Epoch: 74, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.458 Vali Acc: 0.883 Test Loss: 0.458 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 1.8346753120422363
Epoch: 75, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.486 Vali Acc: 0.872 Test Loss: 0.486 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 1.806046724319458
Epoch: 76, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.495 Vali Acc: 0.883 Test Loss: 0.495 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 1.842045545578003
Epoch: 77, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.492 Vali Acc: 0.878 Test Loss: 0.492 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 357663
model size : 2.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.190018892288208
Epoch: 1, Steps: 12 | Train Loss: 2.992 Vali Loss: 2.975 Vali Acc: 0.028 Test Loss: 2.975 Test Acc: 0.028
Validation loss decreased (inf --> -0.027748).  Saving model ...
Epoch: 2 cost time: 1.8981823921203613
Epoch: 2, Steps: 12 | Train Loss: 2.880 Vali Loss: 2.838 Vali Acc: 0.028 Test Loss: 2.838 Test Acc: 0.028
Validation loss decreased (-0.027748 --> -0.027749).  Saving model ...
Epoch: 3 cost time: 1.73081636428833
Epoch: 3, Steps: 12 | Train Loss: 2.793 Vali Loss: 2.746 Vali Acc: 0.106 Test Loss: 2.746 Test Acc: 0.106
Validation loss decreased (-0.027749 --> -0.105528).  Saving model ...
Epoch: 4 cost time: 1.8279845714569092
Epoch: 4, Steps: 12 | Train Loss: 2.736 Vali Loss: 2.669 Vali Acc: 0.072 Test Loss: 2.669 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0389444828033447
Epoch: 5, Steps: 12 | Train Loss: 2.644 Vali Loss: 2.612 Vali Acc: 0.133 Test Loss: 2.612 Test Acc: 0.133
Validation loss decreased (-0.105528 --> -0.133307).  Saving model ...
Epoch: 6 cost time: 1.5858619213104248
Epoch: 6, Steps: 12 | Train Loss: 2.592 Vali Loss: 2.541 Vali Acc: 0.211 Test Loss: 2.541 Test Acc: 0.211
Validation loss decreased (-0.133307 --> -0.211086).  Saving model ...
Epoch: 7 cost time: 2.1153979301452637
Epoch: 7, Steps: 12 | Train Loss: 2.527 Vali Loss: 2.448 Vali Acc: 0.217 Test Loss: 2.448 Test Acc: 0.217
Validation loss decreased (-0.211086 --> -0.216642).  Saving model ...
Epoch: 8 cost time: 1.7687406539916992
Epoch: 8, Steps: 12 | Train Loss: 2.368 Vali Loss: 2.337 Vali Acc: 0.311 Test Loss: 2.337 Test Acc: 0.311
Validation loss decreased (-0.216642 --> -0.311088).  Saving model ...
Epoch: 9 cost time: 1.756133794784546
Epoch: 9, Steps: 12 | Train Loss: 2.247 Vali Loss: 2.238 Vali Acc: 0.317 Test Loss: 2.238 Test Acc: 0.317
Validation loss decreased (-0.311088 --> -0.316644).  Saving model ...
Epoch: 10 cost time: 1.7150869369506836
Epoch: 10, Steps: 12 | Train Loss: 2.110 Vali Loss: 2.130 Vali Acc: 0.411 Test Loss: 2.130 Test Acc: 0.411
Validation loss decreased (-0.316644 --> -0.411090).  Saving model ...
Epoch: 11 cost time: 1.5980265140533447
Epoch: 11, Steps: 12 | Train Loss: 2.039 Vali Loss: 2.041 Vali Acc: 0.411 Test Loss: 2.041 Test Acc: 0.411
Validation loss decreased (-0.411090 --> -0.411091).  Saving model ...
Epoch: 12 cost time: 1.5949113368988037
Epoch: 12, Steps: 12 | Train Loss: 1.906 Vali Loss: 1.935 Vali Acc: 0.517 Test Loss: 1.935 Test Acc: 0.517
Validation loss decreased (-0.411091 --> -0.516647).  Saving model ...
Epoch: 13 cost time: 1.6497235298156738
Epoch: 13, Steps: 12 | Train Loss: 1.890 Vali Loss: 1.853 Vali Acc: 0.539 Test Loss: 1.853 Test Acc: 0.539
Validation loss decreased (-0.516647 --> -0.538870).  Saving model ...
Epoch: 14 cost time: 1.7943458557128906
Epoch: 14, Steps: 12 | Train Loss: 1.793 Vali Loss: 1.771 Vali Acc: 0.544 Test Loss: 1.771 Test Acc: 0.544
Validation loss decreased (-0.538870 --> -0.544427).  Saving model ...
Epoch: 15 cost time: 1.6146204471588135
Epoch: 15, Steps: 12 | Train Loss: 1.713 Vali Loss: 1.692 Vali Acc: 0.600 Test Loss: 1.692 Test Acc: 0.600
Validation loss decreased (-0.544427 --> -0.599983).  Saving model ...
Epoch: 16 cost time: 1.6170787811279297
Epoch: 16, Steps: 12 | Train Loss: 1.639 Vali Loss: 1.619 Vali Acc: 0.633 Test Loss: 1.619 Test Acc: 0.633
Validation loss decreased (-0.599983 --> -0.633317).  Saving model ...
Epoch: 17 cost time: 1.558506727218628
Epoch: 17, Steps: 12 | Train Loss: 1.556 Vali Loss: 1.527 Vali Acc: 0.667 Test Loss: 1.527 Test Acc: 0.667
Validation loss decreased (-0.633317 --> -0.666651).  Saving model ...
Epoch: 18 cost time: 1.5827257633209229
Epoch: 18, Steps: 12 | Train Loss: 1.477 Vali Loss: 1.468 Vali Acc: 0.700 Test Loss: 1.468 Test Acc: 0.700
Validation loss decreased (-0.666651 --> -0.699985).  Saving model ...
Epoch: 19 cost time: 1.636462688446045
Epoch: 19, Steps: 12 | Train Loss: 1.408 Vali Loss: 1.376 Vali Acc: 0.711 Test Loss: 1.376 Test Acc: 0.711
Validation loss decreased (-0.699985 --> -0.711097).  Saving model ...
Epoch: 20 cost time: 1.540151834487915
Epoch: 20, Steps: 12 | Train Loss: 1.336 Vali Loss: 1.310 Vali Acc: 0.728 Test Loss: 1.310 Test Acc: 0.728
Validation loss decreased (-0.711097 --> -0.727765).  Saving model ...
Epoch: 21 cost time: 1.7024497985839844
Epoch: 21, Steps: 12 | Train Loss: 1.202 Vali Loss: 1.240 Vali Acc: 0.717 Test Loss: 1.240 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6651930809020996
Epoch: 22, Steps: 12 | Train Loss: 1.128 Vali Loss: 1.174 Vali Acc: 0.722 Test Loss: 1.174 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6427369117736816
Epoch: 23, Steps: 12 | Train Loss: 1.082 Vali Loss: 1.127 Vali Acc: 0.750 Test Loss: 1.127 Test Acc: 0.750
Validation loss decreased (-0.727765 --> -0.749989).  Saving model ...
Epoch: 24 cost time: 1.600029468536377
Epoch: 24, Steps: 12 | Train Loss: 1.047 Vali Loss: 1.067 Vali Acc: 0.739 Test Loss: 1.067 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6832449436187744
Epoch: 25, Steps: 12 | Train Loss: 0.947 Vali Loss: 1.006 Vali Acc: 0.789 Test Loss: 1.006 Test Acc: 0.789
Validation loss decreased (-0.749989 --> -0.788879).  Saving model ...
Epoch: 26 cost time: 1.755664348602295
Epoch: 26, Steps: 12 | Train Loss: 0.916 Vali Loss: 0.967 Vali Acc: 0.778 Test Loss: 0.967 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6088085174560547
Epoch: 27, Steps: 12 | Train Loss: 0.924 Vali Loss: 0.933 Vali Acc: 0.783 Test Loss: 0.933 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.652179479598999
Epoch: 28, Steps: 12 | Train Loss: 0.811 Vali Loss: 0.881 Vali Acc: 0.806 Test Loss: 0.881 Test Acc: 0.806
Validation loss decreased (-0.788879 --> -0.805547).  Saving model ...
Epoch: 29 cost time: 1.638824462890625
Epoch: 29, Steps: 12 | Train Loss: 0.754 Vali Loss: 0.822 Vali Acc: 0.794 Test Loss: 0.822 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7651472091674805
Epoch: 30, Steps: 12 | Train Loss: 0.701 Vali Loss: 0.774 Vali Acc: 0.828 Test Loss: 0.774 Test Acc: 0.828
Validation loss decreased (-0.805547 --> -0.827770).  Saving model ...
Epoch: 31 cost time: 1.7848191261291504
Epoch: 31, Steps: 12 | Train Loss: 0.660 Vali Loss: 0.763 Vali Acc: 0.822 Test Loss: 0.763 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.7982394695281982
Epoch: 32, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.709 Vali Acc: 0.839 Test Loss: 0.709 Test Acc: 0.839
Validation loss decreased (-0.827770 --> -0.838882).  Saving model ...
Epoch: 33 cost time: 1.539428949356079
Epoch: 33, Steps: 12 | Train Loss: 0.574 Vali Loss: 0.654 Vali Acc: 0.844 Test Loss: 0.654 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 34 cost time: 1.7620820999145508
Epoch: 34, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.670 Vali Acc: 0.850 Test Loss: 0.670 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849993).  Saving model ...
Epoch: 35 cost time: 1.6628520488739014
Epoch: 35, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.676 Vali Acc: 0.817 Test Loss: 0.676 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.5548648834228516
Epoch: 36, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.616 Vali Acc: 0.844 Test Loss: 0.616 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.7670493125915527
Epoch: 37, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.600 Vali Acc: 0.839 Test Loss: 0.600 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.7721800804138184
Epoch: 38, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.589 Vali Acc: 0.833 Test Loss: 0.589 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.6486330032348633
Epoch: 39, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.554 Vali Acc: 0.867 Test Loss: 0.554 Test Acc: 0.867
Validation loss decreased (-0.849993 --> -0.866661).  Saving model ...
Epoch: 40 cost time: 1.5631473064422607
Epoch: 40, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.559 Vali Acc: 0.867 Test Loss: 0.559 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.4876737594604492
Epoch: 41, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.527 Vali Acc: 0.867 Test Loss: 0.527 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 42 cost time: 1.5386762619018555
Epoch: 42, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.511 Vali Acc: 0.861 Test Loss: 0.511 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.5753552913665771
Epoch: 43, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.517 Vali Acc: 0.861 Test Loss: 0.517 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.5114684104919434
Epoch: 44, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.499 Vali Acc: 0.861 Test Loss: 0.499 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.8475639820098877
Epoch: 45, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.483 Vali Acc: 0.867 Test Loss: 0.483 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866662).  Saving model ...
Epoch: 46 cost time: 1.6746633052825928
Epoch: 46, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.473 Vali Acc: 0.867 Test Loss: 0.473 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 47 cost time: 1.5511059761047363
Epoch: 47, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.492 Vali Acc: 0.850 Test Loss: 0.492 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.5284998416900635
Epoch: 48, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.475 Vali Acc: 0.861 Test Loss: 0.475 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.5989646911621094
Epoch: 49, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.423 Vali Acc: 0.878 Test Loss: 0.423 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877774).  Saving model ...
Epoch: 50 cost time: 1.470654010772705
Epoch: 50, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.455 Vali Acc: 0.878 Test Loss: 0.455 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.726088285446167
Epoch: 51, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.431 Vali Acc: 0.856 Test Loss: 0.431 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.6881859302520752
Epoch: 52, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.450 Vali Acc: 0.872 Test Loss: 0.450 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.7888600826263428
Epoch: 53, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.483 Vali Acc: 0.861 Test Loss: 0.483 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.907909631729126
Epoch: 54, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.461 Vali Acc: 0.878 Test Loss: 0.461 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.5369844436645508
Epoch: 55, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.441 Vali Acc: 0.883 Test Loss: 0.441 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883329).  Saving model ...
Epoch: 56 cost time: 1.7625443935394287
Epoch: 56, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.432 Vali Acc: 0.878 Test Loss: 0.432 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.6099989414215088
Epoch: 57, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.443 Vali Acc: 0.878 Test Loss: 0.443 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.896930456161499
Epoch: 58, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.434 Vali Acc: 0.878 Test Loss: 0.434 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.4801290035247803
Epoch: 59, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.486 Vali Acc: 0.883 Test Loss: 0.486 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.864490032196045
Epoch: 60, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.451 Vali Acc: 0.872 Test Loss: 0.451 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 2.0851800441741943
Epoch: 61, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.433 Vali Acc: 0.872 Test Loss: 0.433 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.7526912689208984
Epoch: 62, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.437 Vali Acc: 0.872 Test Loss: 0.437 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 1.6113436222076416
Epoch: 63, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.435 Vali Acc: 0.867 Test Loss: 0.435 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 1.752488374710083
Epoch: 64, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.517 Vali Acc: 0.867 Test Loss: 0.517 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 1.9132168292999268
Epoch: 65, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.461 Vali Acc: 0.894 Test Loss: 0.461 Test Acc: 0.894
Validation loss decreased (-0.883329 --> -0.894440).  Saving model ...
Epoch: 66 cost time: 1.6456186771392822
Epoch: 66, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.453 Vali Acc: 0.889 Test Loss: 0.453 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.7043004035949707
Epoch: 67, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.475 Vali Acc: 0.878 Test Loss: 0.475 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.5884723663330078
Epoch: 68, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.467 Vali Acc: 0.872 Test Loss: 0.467 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.5616097450256348
Epoch: 69, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.488 Vali Acc: 0.878 Test Loss: 0.488 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.3743231296539307
Epoch: 70, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.464 Vali Acc: 0.861 Test Loss: 0.464 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.5702998638153076
Epoch: 71, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.511 Vali Acc: 0.872 Test Loss: 0.511 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 1.7103211879730225
Epoch: 72, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.482 Vali Acc: 0.883 Test Loss: 0.482 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 1.685072422027588
Epoch: 73, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.508 Vali Acc: 0.878 Test Loss: 0.508 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 1.6454317569732666
Epoch: 74, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.522 Vali Acc: 0.872 Test Loss: 0.522 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 1.49245023727417
Epoch: 75, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.490 Vali Acc: 0.872 Test Loss: 0.490 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 241855
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.244041442871094
Epoch: 1, Steps: 12 | Train Loss: 2.841 Vali Loss: 2.769 Vali Acc: 0.067 Test Loss: 2.769 Test Acc: 0.067
Validation loss decreased (inf --> -0.066639).  Saving model ...
Epoch: 2 cost time: 2.020190715789795
Epoch: 2, Steps: 12 | Train Loss: 2.794 Vali Loss: 2.717 Vali Acc: 0.100 Test Loss: 2.717 Test Acc: 0.100
Validation loss decreased (-0.066639 --> -0.099973).  Saving model ...
Epoch: 3 cost time: 1.8263616561889648
Epoch: 3, Steps: 12 | Train Loss: 2.715 Vali Loss: 2.657 Vali Acc: 0.172 Test Loss: 2.657 Test Acc: 0.172
Validation loss decreased (-0.099973 --> -0.172196).  Saving model ...
Epoch: 4 cost time: 1.867518663406372
Epoch: 4, Steps: 12 | Train Loss: 2.671 Vali Loss: 2.598 Vali Acc: 0.200 Test Loss: 2.598 Test Acc: 0.200
Validation loss decreased (-0.172196 --> -0.199974).  Saving model ...
Epoch: 5 cost time: 1.7637133598327637
Epoch: 5, Steps: 12 | Train Loss: 2.647 Vali Loss: 2.535 Vali Acc: 0.233 Test Loss: 2.535 Test Acc: 0.233
Validation loss decreased (-0.199974 --> -0.233308).  Saving model ...
Epoch: 6 cost time: 2.108353853225708
Epoch: 6, Steps: 12 | Train Loss: 2.542 Vali Loss: 2.453 Vali Acc: 0.289 Test Loss: 2.453 Test Acc: 0.289
Validation loss decreased (-0.233308 --> -0.288864).  Saving model ...
Epoch: 7 cost time: 2.2466559410095215
Epoch: 7, Steps: 12 | Train Loss: 2.472 Vali Loss: 2.350 Vali Acc: 0.394 Test Loss: 2.350 Test Acc: 0.394
Validation loss decreased (-0.288864 --> -0.394421).  Saving model ...
Epoch: 8 cost time: 2.1132493019104004
Epoch: 8, Steps: 12 | Train Loss: 2.330 Vali Loss: 2.240 Vali Acc: 0.411 Test Loss: 2.240 Test Acc: 0.411
Validation loss decreased (-0.394421 --> -0.411089).  Saving model ...
Epoch: 9 cost time: 1.6061699390411377
Epoch: 9, Steps: 12 | Train Loss: 2.222 Vali Loss: 2.141 Vali Acc: 0.433 Test Loss: 2.141 Test Acc: 0.433
Validation loss decreased (-0.411089 --> -0.433312).  Saving model ...
Epoch: 10 cost time: 1.7793183326721191
Epoch: 10, Steps: 12 | Train Loss: 2.094 Vali Loss: 2.023 Vali Acc: 0.483 Test Loss: 2.023 Test Acc: 0.483
Validation loss decreased (-0.433312 --> -0.483313).  Saving model ...
Epoch: 11 cost time: 1.9803752899169922
Epoch: 11, Steps: 12 | Train Loss: 2.016 Vali Loss: 1.923 Vali Acc: 0.533 Test Loss: 1.923 Test Acc: 0.533
Validation loss decreased (-0.483313 --> -0.533314).  Saving model ...
Epoch: 12 cost time: 1.912198781967163
Epoch: 12, Steps: 12 | Train Loss: 1.863 Vali Loss: 1.866 Vali Acc: 0.511 Test Loss: 1.866 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9109678268432617
Epoch: 13, Steps: 12 | Train Loss: 1.815 Vali Loss: 1.778 Vali Acc: 0.556 Test Loss: 1.778 Test Acc: 0.556
Validation loss decreased (-0.533314 --> -0.555538).  Saving model ...
Epoch: 14 cost time: 1.910024642944336
Epoch: 14, Steps: 12 | Train Loss: 1.660 Vali Loss: 1.726 Vali Acc: 0.550 Test Loss: 1.726 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9885108470916748
Epoch: 15, Steps: 12 | Train Loss: 1.560 Vali Loss: 1.666 Vali Acc: 0.583 Test Loss: 1.666 Test Acc: 0.583
Validation loss decreased (-0.555538 --> -0.583317).  Saving model ...
Epoch: 16 cost time: 1.997286081314087
Epoch: 16, Steps: 12 | Train Loss: 1.522 Vali Loss: 1.607 Vali Acc: 0.572 Test Loss: 1.607 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8873441219329834
Epoch: 17, Steps: 12 | Train Loss: 1.433 Vali Loss: 1.545 Vali Acc: 0.600 Test Loss: 1.545 Test Acc: 0.600
Validation loss decreased (-0.583317 --> -0.599985).  Saving model ...
Epoch: 18 cost time: 2.052302598953247
Epoch: 18, Steps: 12 | Train Loss: 1.430 Vali Loss: 1.478 Vali Acc: 0.611 Test Loss: 1.478 Test Acc: 0.611
Validation loss decreased (-0.599985 --> -0.611096).  Saving model ...
Epoch: 19 cost time: 2.015543222427368
Epoch: 19, Steps: 12 | Train Loss: 1.323 Vali Loss: 1.409 Vali Acc: 0.622 Test Loss: 1.409 Test Acc: 0.622
Validation loss decreased (-0.611096 --> -0.622208).  Saving model ...
Epoch: 20 cost time: 1.766176700592041
Epoch: 20, Steps: 12 | Train Loss: 1.271 Vali Loss: 1.344 Vali Acc: 0.656 Test Loss: 1.344 Test Acc: 0.656
Validation loss decreased (-0.622208 --> -0.655542).  Saving model ...
Epoch: 21 cost time: 1.6811916828155518
Epoch: 21, Steps: 12 | Train Loss: 1.212 Vali Loss: 1.299 Vali Acc: 0.667 Test Loss: 1.299 Test Acc: 0.667
Validation loss decreased (-0.655542 --> -0.666654).  Saving model ...
Epoch: 22 cost time: 2.348463535308838
Epoch: 22, Steps: 12 | Train Loss: 1.135 Vali Loss: 1.272 Vali Acc: 0.700 Test Loss: 1.272 Test Acc: 0.700
Validation loss decreased (-0.666654 --> -0.699987).  Saving model ...
Epoch: 23 cost time: 1.7393789291381836
Epoch: 23, Steps: 12 | Train Loss: 1.111 Vali Loss: 1.193 Vali Acc: 0.700 Test Loss: 1.193 Test Acc: 0.700
Validation loss decreased (-0.699987 --> -0.699988).  Saving model ...
Epoch: 24 cost time: 2.3067121505737305
Epoch: 24, Steps: 12 | Train Loss: 0.996 Vali Loss: 1.142 Vali Acc: 0.728 Test Loss: 1.142 Test Acc: 0.728
Validation loss decreased (-0.699988 --> -0.727766).  Saving model ...
Epoch: 25 cost time: 1.9584691524505615
Epoch: 25, Steps: 12 | Train Loss: 0.956 Vali Loss: 1.110 Vali Acc: 0.722 Test Loss: 1.110 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.193193197250366
Epoch: 26, Steps: 12 | Train Loss: 0.961 Vali Loss: 1.054 Vali Acc: 0.744 Test Loss: 1.054 Test Acc: 0.744
Validation loss decreased (-0.727766 --> -0.744434).  Saving model ...
Epoch: 27 cost time: 2.0145514011383057
Epoch: 27, Steps: 12 | Train Loss: 0.835 Vali Loss: 1.012 Vali Acc: 0.767 Test Loss: 1.012 Test Acc: 0.767
Validation loss decreased (-0.744434 --> -0.766657).  Saving model ...
Epoch: 28 cost time: 2.360771894454956
Epoch: 28, Steps: 12 | Train Loss: 0.810 Vali Loss: 0.973 Vali Acc: 0.783 Test Loss: 0.973 Test Acc: 0.783
Validation loss decreased (-0.766657 --> -0.783324).  Saving model ...
Epoch: 29 cost time: 2.278508424758911
Epoch: 29, Steps: 12 | Train Loss: 0.734 Vali Loss: 0.917 Vali Acc: 0.806 Test Loss: 0.917 Test Acc: 0.806
Validation loss decreased (-0.783324 --> -0.805546).  Saving model ...
Epoch: 30 cost time: 2.0683469772338867
Epoch: 30, Steps: 12 | Train Loss: 0.739 Vali Loss: 0.880 Vali Acc: 0.811 Test Loss: 0.880 Test Acc: 0.811
Validation loss decreased (-0.805546 --> -0.811102).  Saving model ...
Epoch: 31 cost time: 1.6868836879730225
Epoch: 31, Steps: 12 | Train Loss: 0.646 Vali Loss: 0.835 Vali Acc: 0.806 Test Loss: 0.835 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.2305753231048584
Epoch: 32, Steps: 12 | Train Loss: 0.670 Vali Loss: 0.788 Vali Acc: 0.811 Test Loss: 0.788 Test Acc: 0.811
Validation loss decreased (-0.811102 --> -0.811103).  Saving model ...
Epoch: 33 cost time: 2.23576021194458
Epoch: 33, Steps: 12 | Train Loss: 0.587 Vali Loss: 0.767 Vali Acc: 0.828 Test Loss: 0.767 Test Acc: 0.828
Validation loss decreased (-0.811103 --> -0.827770).  Saving model ...
Epoch: 34 cost time: 1.9166462421417236
Epoch: 34, Steps: 12 | Train Loss: 0.563 Vali Loss: 0.731 Vali Acc: 0.828 Test Loss: 0.731 Test Acc: 0.828
Validation loss decreased (-0.827770 --> -0.827770).  Saving model ...
Epoch: 35 cost time: 1.683262586593628
Epoch: 35, Steps: 12 | Train Loss: 0.500 Vali Loss: 0.735 Vali Acc: 0.817 Test Loss: 0.735 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.9533607959747314
Epoch: 36, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.685 Vali Acc: 0.833 Test Loss: 0.685 Test Acc: 0.833
Validation loss decreased (-0.827770 --> -0.833326).  Saving model ...
Epoch: 37 cost time: 2.357800245285034
Epoch: 37, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.683 Vali Acc: 0.822 Test Loss: 0.683 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.9281840324401855
Epoch: 38, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.644 Vali Acc: 0.833 Test Loss: 0.644 Test Acc: 0.833
Validation loss decreased (-0.833326 --> -0.833327).  Saving model ...
Epoch: 39 cost time: 2.0052130222320557
Epoch: 39, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.619 Vali Acc: 0.828 Test Loss: 0.619 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.636009693145752
Epoch: 40, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.630 Vali Acc: 0.844 Test Loss: 0.630 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844438).  Saving model ...
Epoch: 41 cost time: 1.8909945487976074
Epoch: 41, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.636 Vali Acc: 0.844 Test Loss: 0.636 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.7703733444213867
Epoch: 42, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.587 Vali Acc: 0.839 Test Loss: 0.587 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.1495416164398193
Epoch: 43, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.571 Vali Acc: 0.839 Test Loss: 0.571 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 2.341782569885254
Epoch: 44, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.588 Vali Acc: 0.839 Test Loss: 0.588 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.6430833339691162
Epoch: 45, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.554 Vali Acc: 0.844 Test Loss: 0.554 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844439).  Saving model ...
Epoch: 46 cost time: 2.113906145095825
Epoch: 46, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.551 Vali Acc: 0.850 Test Loss: 0.551 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849994).  Saving model ...
Epoch: 47 cost time: 1.9201011657714844
Epoch: 47, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.544 Vali Acc: 0.839 Test Loss: 0.544 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.8470563888549805
Epoch: 48, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.549 Vali Acc: 0.844 Test Loss: 0.549 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 2.231328248977661
Epoch: 49, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.530 Vali Acc: 0.867 Test Loss: 0.530 Test Acc: 0.867
Validation loss decreased (-0.849994 --> -0.866661).  Saving model ...
Epoch: 50 cost time: 1.6538870334625244
Epoch: 50, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.520 Vali Acc: 0.856 Test Loss: 0.520 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 2.4883008003234863
Epoch: 51, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.528 Vali Acc: 0.839 Test Loss: 0.528 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 2.1499955654144287
Epoch: 52, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.521 Vali Acc: 0.844 Test Loss: 0.521 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 2.0368423461914062
Epoch: 53, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.523 Vali Acc: 0.850 Test Loss: 0.523 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.8250977993011475
Epoch: 54, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.533 Vali Acc: 0.850 Test Loss: 0.533 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.7959609031677246
Epoch: 55, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.503 Vali Acc: 0.844 Test Loss: 0.503 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.80765700340271
Epoch: 56, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.511 Vali Acc: 0.850 Test Loss: 0.511 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 2.02070689201355
Epoch: 57, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.506 Vali Acc: 0.839 Test Loss: 0.506 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.965928077697754
Epoch: 58, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.508 Vali Acc: 0.839 Test Loss: 0.508 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.7767484188079834
Epoch: 59, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.516 Vali Acc: 0.833 Test Loss: 0.516 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 241631
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.029014825820923
Epoch: 1, Steps: 12 | Train Loss: 2.914 Vali Loss: 2.841 Vali Acc: 0.039 Test Loss: 2.841 Test Acc: 0.039
Validation loss decreased (inf --> -0.038860).  Saving model ...
Epoch: 2 cost time: 2.046358585357666
Epoch: 2, Steps: 12 | Train Loss: 2.829 Vali Loss: 2.766 Vali Acc: 0.044 Test Loss: 2.766 Test Acc: 0.044
Validation loss decreased (-0.038860 --> -0.044417).  Saving model ...
Epoch: 3 cost time: 1.600003719329834
Epoch: 3, Steps: 12 | Train Loss: 2.729 Vali Loss: 2.703 Vali Acc: 0.061 Test Loss: 2.703 Test Acc: 0.061
Validation loss decreased (-0.044417 --> -0.061084).  Saving model ...
Epoch: 4 cost time: 1.8745794296264648
Epoch: 4, Steps: 12 | Train Loss: 2.698 Vali Loss: 2.662 Vali Acc: 0.117 Test Loss: 2.662 Test Acc: 0.117
Validation loss decreased (-0.061084 --> -0.116640).  Saving model ...
Epoch: 5 cost time: 1.587153434753418
Epoch: 5, Steps: 12 | Train Loss: 2.624 Vali Loss: 2.622 Vali Acc: 0.200 Test Loss: 2.622 Test Acc: 0.200
Validation loss decreased (-0.116640 --> -0.199974).  Saving model ...
Epoch: 6 cost time: 1.633835792541504
Epoch: 6, Steps: 12 | Train Loss: 2.526 Vali Loss: 2.562 Vali Acc: 0.194 Test Loss: 2.562 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.457231044769287
Epoch: 7, Steps: 12 | Train Loss: 2.468 Vali Loss: 2.465 Vali Acc: 0.267 Test Loss: 2.465 Test Acc: 0.267
Validation loss decreased (-0.199974 --> -0.266642).  Saving model ...
Epoch: 8 cost time: 1.5447471141815186
Epoch: 8, Steps: 12 | Train Loss: 2.430 Vali Loss: 2.383 Vali Acc: 0.306 Test Loss: 2.383 Test Acc: 0.306
Validation loss decreased (-0.266642 --> -0.305532).  Saving model ...
Epoch: 9 cost time: 1.5414695739746094
Epoch: 9, Steps: 12 | Train Loss: 2.291 Vali Loss: 2.271 Vali Acc: 0.344 Test Loss: 2.271 Test Acc: 0.344
Validation loss decreased (-0.305532 --> -0.344422).  Saving model ...
Epoch: 10 cost time: 1.7021996974945068
Epoch: 10, Steps: 12 | Train Loss: 2.202 Vali Loss: 2.181 Vali Acc: 0.394 Test Loss: 2.181 Test Acc: 0.394
Validation loss decreased (-0.344422 --> -0.394423).  Saving model ...
Epoch: 11 cost time: 1.8501098155975342
Epoch: 11, Steps: 12 | Train Loss: 2.028 Vali Loss: 2.076 Vali Acc: 0.433 Test Loss: 2.076 Test Acc: 0.433
Validation loss decreased (-0.394423 --> -0.433313).  Saving model ...
Epoch: 12 cost time: 1.696281909942627
Epoch: 12, Steps: 12 | Train Loss: 1.954 Vali Loss: 1.995 Vali Acc: 0.456 Test Loss: 1.995 Test Acc: 0.456
Validation loss decreased (-0.433313 --> -0.455536).  Saving model ...
Epoch: 13 cost time: 1.5235157012939453
Epoch: 13, Steps: 12 | Train Loss: 1.885 Vali Loss: 1.927 Vali Acc: 0.483 Test Loss: 1.927 Test Acc: 0.483
Validation loss decreased (-0.455536 --> -0.483314).  Saving model ...
Epoch: 14 cost time: 1.5416254997253418
Epoch: 14, Steps: 12 | Train Loss: 1.795 Vali Loss: 1.850 Vali Acc: 0.506 Test Loss: 1.850 Test Acc: 0.506
Validation loss decreased (-0.483314 --> -0.505537).  Saving model ...
Epoch: 15 cost time: 1.720107078552246
Epoch: 15, Steps: 12 | Train Loss: 1.728 Vali Loss: 1.785 Vali Acc: 0.528 Test Loss: 1.785 Test Acc: 0.528
Validation loss decreased (-0.505537 --> -0.527760).  Saving model ...
Epoch: 16 cost time: 1.5246350765228271
Epoch: 16, Steps: 12 | Train Loss: 1.651 Vali Loss: 1.710 Vali Acc: 0.517 Test Loss: 1.710 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6597018241882324
Epoch: 17, Steps: 12 | Train Loss: 1.516 Vali Loss: 1.623 Vali Acc: 0.572 Test Loss: 1.623 Test Acc: 0.572
Validation loss decreased (-0.527760 --> -0.572206).  Saving model ...
Epoch: 18 cost time: 1.677497148513794
Epoch: 18, Steps: 12 | Train Loss: 1.451 Vali Loss: 1.577 Vali Acc: 0.578 Test Loss: 1.577 Test Acc: 0.578
Validation loss decreased (-0.572206 --> -0.577762).  Saving model ...
Epoch: 19 cost time: 1.6097609996795654
Epoch: 19, Steps: 12 | Train Loss: 1.372 Vali Loss: 1.479 Vali Acc: 0.617 Test Loss: 1.479 Test Acc: 0.617
Validation loss decreased (-0.577762 --> -0.616652).  Saving model ...
Epoch: 20 cost time: 1.6430199146270752
Epoch: 20, Steps: 12 | Train Loss: 1.277 Vali Loss: 1.403 Vali Acc: 0.644 Test Loss: 1.403 Test Acc: 0.644
Validation loss decreased (-0.616652 --> -0.644430).  Saving model ...
Epoch: 21 cost time: 1.649193286895752
Epoch: 21, Steps: 12 | Train Loss: 1.267 Vali Loss: 1.348 Vali Acc: 0.672 Test Loss: 1.348 Test Acc: 0.672
Validation loss decreased (-0.644430 --> -0.672209).  Saving model ...
Epoch: 22 cost time: 1.403898000717163
Epoch: 22, Steps: 12 | Train Loss: 1.176 Vali Loss: 1.298 Vali Acc: 0.694 Test Loss: 1.298 Test Acc: 0.694
Validation loss decreased (-0.672209 --> -0.694431).  Saving model ...
Epoch: 23 cost time: 1.524963617324829
Epoch: 23, Steps: 12 | Train Loss: 1.123 Vali Loss: 1.230 Vali Acc: 0.700 Test Loss: 1.230 Test Acc: 0.700
Validation loss decreased (-0.694431 --> -0.699988).  Saving model ...
Epoch: 24 cost time: 1.6839847564697266
Epoch: 24, Steps: 12 | Train Loss: 1.079 Vali Loss: 1.163 Vali Acc: 0.711 Test Loss: 1.163 Test Acc: 0.711
Validation loss decreased (-0.699988 --> -0.711099).  Saving model ...
Epoch: 25 cost time: 1.5970377922058105
Epoch: 25, Steps: 12 | Train Loss: 0.985 Vali Loss: 1.102 Vali Acc: 0.706 Test Loss: 1.102 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8366663455963135
Epoch: 26, Steps: 12 | Train Loss: 0.922 Vali Loss: 1.054 Vali Acc: 0.728 Test Loss: 1.054 Test Acc: 0.728
Validation loss decreased (-0.711099 --> -0.727767).  Saving model ...
Epoch: 27 cost time: 1.4941537380218506
Epoch: 27, Steps: 12 | Train Loss: 0.907 Vali Loss: 1.014 Vali Acc: 0.756 Test Loss: 1.014 Test Acc: 0.756
Validation loss decreased (-0.727767 --> -0.755545).  Saving model ...
Epoch: 28 cost time: 1.6677789688110352
Epoch: 28, Steps: 12 | Train Loss: 0.873 Vali Loss: 0.947 Vali Acc: 0.778 Test Loss: 0.947 Test Acc: 0.778
Validation loss decreased (-0.755545 --> -0.777768).  Saving model ...
Epoch: 29 cost time: 1.4837582111358643
Epoch: 29, Steps: 12 | Train Loss: 0.801 Vali Loss: 0.904 Vali Acc: 0.789 Test Loss: 0.904 Test Acc: 0.789
Validation loss decreased (-0.777768 --> -0.788880).  Saving model ...
Epoch: 30 cost time: 1.6259028911590576
Epoch: 30, Steps: 12 | Train Loss: 0.769 Vali Loss: 0.862 Vali Acc: 0.806 Test Loss: 0.862 Test Acc: 0.806
Validation loss decreased (-0.788880 --> -0.805547).  Saving model ...
Epoch: 31 cost time: 1.5933539867401123
Epoch: 31, Steps: 12 | Train Loss: 0.721 Vali Loss: 0.841 Vali Acc: 0.778 Test Loss: 0.841 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.6387338638305664
Epoch: 32, Steps: 12 | Train Loss: 0.637 Vali Loss: 0.812 Vali Acc: 0.794 Test Loss: 0.812 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.6272151470184326
Epoch: 33, Steps: 12 | Train Loss: 0.613 Vali Loss: 0.781 Vali Acc: 0.817 Test Loss: 0.781 Test Acc: 0.817
Validation loss decreased (-0.805547 --> -0.816659).  Saving model ...
Epoch: 34 cost time: 1.6949892044067383
Epoch: 34, Steps: 12 | Train Loss: 0.597 Vali Loss: 0.741 Vali Acc: 0.833 Test Loss: 0.741 Test Acc: 0.833
Validation loss decreased (-0.816659 --> -0.833326).  Saving model ...
Epoch: 35 cost time: 1.447490930557251
Epoch: 35, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.710 Vali Acc: 0.844 Test Loss: 0.710 Test Acc: 0.844
Validation loss decreased (-0.833326 --> -0.844437).  Saving model ...
Epoch: 36 cost time: 1.4978442192077637
Epoch: 36, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.692 Vali Acc: 0.844 Test Loss: 0.692 Test Acc: 0.844
Validation loss decreased (-0.844437 --> -0.844438).  Saving model ...
Epoch: 37 cost time: 1.6595072746276855
Epoch: 37, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.674 Vali Acc: 0.850 Test Loss: 0.674 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849993).  Saving model ...
Epoch: 38 cost time: 1.8014521598815918
Epoch: 38, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.670 Vali Acc: 0.839 Test Loss: 0.670 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.5931549072265625
Epoch: 39, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.636 Vali Acc: 0.844 Test Loss: 0.636 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.5790283679962158
Epoch: 40, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.621 Vali Acc: 0.856 Test Loss: 0.621 Test Acc: 0.856
Validation loss decreased (-0.849993 --> -0.855549).  Saving model ...
Epoch: 41 cost time: 1.5620875358581543
Epoch: 41, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.605 Vali Acc: 0.867 Test Loss: 0.605 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866661).  Saving model ...
Epoch: 42 cost time: 1.571129322052002
Epoch: 42, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.628 Vali Acc: 0.833 Test Loss: 0.628 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.836186408996582
Epoch: 43, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.574 Vali Acc: 0.856 Test Loss: 0.574 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.7926428318023682
Epoch: 44, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.577 Vali Acc: 0.850 Test Loss: 0.577 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.8617596626281738
Epoch: 45, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.550 Vali Acc: 0.867 Test Loss: 0.550 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 46 cost time: 1.7997939586639404
Epoch: 46, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.548 Vali Acc: 0.867 Test Loss: 0.548 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 47 cost time: 1.5133919715881348
Epoch: 47, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.550 Vali Acc: 0.861 Test Loss: 0.550 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.5861144065856934
Epoch: 48, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.528 Vali Acc: 0.867 Test Loss: 0.528 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 49 cost time: 1.6725795269012451
Epoch: 49, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.516 Vali Acc: 0.867 Test Loss: 0.516 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866662).  Saving model ...
Epoch: 50 cost time: 1.4995372295379639
Epoch: 50, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.527 Vali Acc: 0.856 Test Loss: 0.527 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.6191091537475586
Epoch: 51, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.503 Vali Acc: 0.878 Test Loss: 0.503 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877773).  Saving model ...
Epoch: 52 cost time: 1.5168161392211914
Epoch: 52, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.502 Vali Acc: 0.883 Test Loss: 0.502 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883328).  Saving model ...
Epoch: 53 cost time: 1.606334924697876
Epoch: 53, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.486 Vali Acc: 0.872 Test Loss: 0.486 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.4707257747650146
Epoch: 54, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.486 Vali Acc: 0.883 Test Loss: 0.486 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883328).  Saving model ...
Epoch: 55 cost time: 1.7821986675262451
Epoch: 55, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.500 Vali Acc: 0.878 Test Loss: 0.500 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.6092705726623535
Epoch: 56, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.484 Vali Acc: 0.889 Test Loss: 0.484 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888884).  Saving model ...
Epoch: 57 cost time: 1.492159366607666
Epoch: 57, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.480 Vali Acc: 0.872 Test Loss: 0.480 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.588331937789917
Epoch: 58, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.498 Vali Acc: 0.872 Test Loss: 0.498 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.773535966873169
Epoch: 59, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.465 Vali Acc: 0.883 Test Loss: 0.465 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.4244022369384766
Epoch: 60, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.455 Vali Acc: 0.889 Test Loss: 0.455 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 61 cost time: 1.853524923324585
Epoch: 61, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.494 Vali Acc: 0.889 Test Loss: 0.494 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.7585182189941406
Epoch: 62, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.471 Vali Acc: 0.878 Test Loss: 0.471 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.7070329189300537
Epoch: 63, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.502 Vali Acc: 0.872 Test Loss: 0.502 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.5777630805969238
Epoch: 64, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.475 Vali Acc: 0.878 Test Loss: 0.475 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 1.7360210418701172
Epoch: 65, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.471 Vali Acc: 0.883 Test Loss: 0.471 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 1.489229679107666
Epoch: 66, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.460 Vali Acc: 0.878 Test Loss: 0.460 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 1.7989180088043213
Epoch: 67, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.483 Vali Acc: 0.894 Test Loss: 0.483 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894440).  Saving model ...
Epoch: 68 cost time: 1.5748414993286133
Epoch: 68, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.495 Vali Acc: 0.900 Test Loss: 0.495 Test Acc: 0.900
Validation loss decreased (-0.894440 --> -0.899995).  Saving model ...
Epoch: 69 cost time: 1.7064845561981201
Epoch: 69, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.467 Vali Acc: 0.889 Test Loss: 0.467 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.7740793228149414
Epoch: 70, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.479 Vali Acc: 0.889 Test Loss: 0.479 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 1.732309341430664
Epoch: 71, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.474 Vali Acc: 0.872 Test Loss: 0.474 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 1.640084981918335
Epoch: 72, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.503 Vali Acc: 0.894 Test Loss: 0.503 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 1.4390389919281006
Epoch: 73, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.534 Vali Acc: 0.867 Test Loss: 0.534 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 1.6416947841644287
Epoch: 74, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.506 Vali Acc: 0.878 Test Loss: 0.506 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 1.7702794075012207
Epoch: 75, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.498 Vali Acc: 0.883 Test Loss: 0.498 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 1.797102451324463
Epoch: 76, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.501 Vali Acc: 0.894 Test Loss: 0.501 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 1.7792041301727295
Epoch: 77, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.498 Vali Acc: 0.894 Test Loss: 0.498 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 2.0230512619018555
Epoch: 78, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.508 Vali Acc: 0.872 Test Loss: 0.508 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 241407
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.681802988052368
Epoch: 1, Steps: 12 | Train Loss: 2.774 Vali Loss: 2.786 Vali Acc: 0.094 Test Loss: 2.786 Test Acc: 0.094
Validation loss decreased (inf --> -0.094417).  Saving model ...
Epoch: 2 cost time: 1.8522884845733643
Epoch: 2, Steps: 12 | Train Loss: 2.730 Vali Loss: 2.712 Vali Acc: 0.117 Test Loss: 2.712 Test Acc: 0.117
Validation loss decreased (-0.094417 --> -0.116640).  Saving model ...
Epoch: 3 cost time: 2.18153715133667
Epoch: 3, Steps: 12 | Train Loss: 2.656 Vali Loss: 2.649 Vali Acc: 0.150 Test Loss: 2.649 Test Acc: 0.150
Validation loss decreased (-0.116640 --> -0.149974).  Saving model ...
Epoch: 4 cost time: 2.1000561714172363
Epoch: 4, Steps: 12 | Train Loss: 2.587 Vali Loss: 2.587 Vali Acc: 0.200 Test Loss: 2.587 Test Acc: 0.200
Validation loss decreased (-0.149974 --> -0.199974).  Saving model ...
Epoch: 5 cost time: 2.1551413536071777
Epoch: 5, Steps: 12 | Train Loss: 2.499 Vali Loss: 2.493 Vali Acc: 0.256 Test Loss: 2.493 Test Acc: 0.256
Validation loss decreased (-0.199974 --> -0.255531).  Saving model ...
Epoch: 6 cost time: 1.764613389968872
Epoch: 6, Steps: 12 | Train Loss: 2.425 Vali Loss: 2.401 Vali Acc: 0.361 Test Loss: 2.401 Test Acc: 0.361
Validation loss decreased (-0.255531 --> -0.361087).  Saving model ...
Epoch: 7 cost time: 1.8582820892333984
Epoch: 7, Steps: 12 | Train Loss: 2.308 Vali Loss: 2.320 Vali Acc: 0.417 Test Loss: 2.320 Test Acc: 0.417
Validation loss decreased (-0.361087 --> -0.416643).  Saving model ...
Epoch: 8 cost time: 1.7120637893676758
Epoch: 8, Steps: 12 | Train Loss: 2.185 Vali Loss: 2.191 Vali Acc: 0.444 Test Loss: 2.191 Test Acc: 0.444
Validation loss decreased (-0.416643 --> -0.444423).  Saving model ...
Epoch: 9 cost time: 2.114367723464966
Epoch: 9, Steps: 12 | Train Loss: 2.077 Vali Loss: 2.121 Vali Acc: 0.461 Test Loss: 2.121 Test Acc: 0.461
Validation loss decreased (-0.444423 --> -0.461090).  Saving model ...
Epoch: 10 cost time: 2.179316282272339
Epoch: 10, Steps: 12 | Train Loss: 1.947 Vali Loss: 2.020 Vali Acc: 0.517 Test Loss: 2.020 Test Acc: 0.517
Validation loss decreased (-0.461090 --> -0.516646).  Saving model ...
Epoch: 11 cost time: 1.8999409675598145
Epoch: 11, Steps: 12 | Train Loss: 1.895 Vali Loss: 1.914 Vali Acc: 0.578 Test Loss: 1.914 Test Acc: 0.578
Validation loss decreased (-0.516646 --> -0.577759).  Saving model ...
Epoch: 12 cost time: 1.5974831581115723
Epoch: 12, Steps: 12 | Train Loss: 1.777 Vali Loss: 1.837 Vali Acc: 0.617 Test Loss: 1.837 Test Acc: 0.617
Validation loss decreased (-0.577759 --> -0.616648).  Saving model ...
Epoch: 13 cost time: 1.7554223537445068
Epoch: 13, Steps: 12 | Train Loss: 1.733 Vali Loss: 1.745 Vali Acc: 0.606 Test Loss: 1.745 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.137669086456299
Epoch: 14, Steps: 12 | Train Loss: 1.688 Vali Loss: 1.662 Vali Acc: 0.622 Test Loss: 1.662 Test Acc: 0.622
Validation loss decreased (-0.616648 --> -0.622206).  Saving model ...
Epoch: 15 cost time: 1.887258529663086
Epoch: 15, Steps: 12 | Train Loss: 1.561 Vali Loss: 1.599 Vali Acc: 0.661 Test Loss: 1.599 Test Acc: 0.661
Validation loss decreased (-0.622206 --> -0.661095).  Saving model ...
Epoch: 16 cost time: 1.9312372207641602
Epoch: 16, Steps: 12 | Train Loss: 1.467 Vali Loss: 1.553 Vali Acc: 0.633 Test Loss: 1.553 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.861764669418335
Epoch: 17, Steps: 12 | Train Loss: 1.401 Vali Loss: 1.464 Vali Acc: 0.689 Test Loss: 1.464 Test Acc: 0.689
Validation loss decreased (-0.661095 --> -0.688874).  Saving model ...
Epoch: 18 cost time: 1.6043312549591064
Epoch: 18, Steps: 12 | Train Loss: 1.323 Vali Loss: 1.408 Vali Acc: 0.700 Test Loss: 1.408 Test Acc: 0.700
Validation loss decreased (-0.688874 --> -0.699986).  Saving model ...
Epoch: 19 cost time: 1.8013863563537598
Epoch: 19, Steps: 12 | Train Loss: 1.285 Vali Loss: 1.357 Vali Acc: 0.733 Test Loss: 1.357 Test Acc: 0.733
Validation loss decreased (-0.699986 --> -0.733320).  Saving model ...
Epoch: 20 cost time: 1.661780834197998
Epoch: 20, Steps: 12 | Train Loss: 1.214 Vali Loss: 1.299 Vali Acc: 0.717 Test Loss: 1.299 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7210509777069092
Epoch: 21, Steps: 12 | Train Loss: 1.104 Vali Loss: 1.232 Vali Acc: 0.756 Test Loss: 1.232 Test Acc: 0.756
Validation loss decreased (-0.733320 --> -0.755543).  Saving model ...
Epoch: 22 cost time: 1.8979759216308594
Epoch: 22, Steps: 12 | Train Loss: 1.051 Vali Loss: 1.179 Vali Acc: 0.750 Test Loss: 1.179 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5731489658355713
Epoch: 23, Steps: 12 | Train Loss: 0.975 Vali Loss: 1.131 Vali Acc: 0.750 Test Loss: 1.131 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6024887561798096
Epoch: 24, Steps: 12 | Train Loss: 0.932 Vali Loss: 1.077 Vali Acc: 0.756 Test Loss: 1.077 Test Acc: 0.756
Validation loss decreased (-0.755543 --> -0.755545).  Saving model ...
Epoch: 25 cost time: 1.5397734642028809
Epoch: 25, Steps: 12 | Train Loss: 0.875 Vali Loss: 1.012 Vali Acc: 0.794 Test Loss: 1.012 Test Acc: 0.794
Validation loss decreased (-0.755545 --> -0.794434).  Saving model ...
Epoch: 26 cost time: 1.9129314422607422
Epoch: 26, Steps: 12 | Train Loss: 0.820 Vali Loss: 0.980 Vali Acc: 0.778 Test Loss: 0.980 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.778275966644287
Epoch: 27, Steps: 12 | Train Loss: 0.733 Vali Loss: 0.932 Vali Acc: 0.794 Test Loss: 0.932 Test Acc: 0.794
Validation loss decreased (-0.794434 --> -0.794435).  Saving model ...
Epoch: 28 cost time: 2.0757620334625244
Epoch: 28, Steps: 12 | Train Loss: 0.741 Vali Loss: 0.877 Vali Acc: 0.811 Test Loss: 0.877 Test Acc: 0.811
Validation loss decreased (-0.794435 --> -0.811102).  Saving model ...
Epoch: 29 cost time: 1.9925203323364258
Epoch: 29, Steps: 12 | Train Loss: 0.704 Vali Loss: 0.864 Vali Acc: 0.794 Test Loss: 0.864 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.9773929119110107
Epoch: 30, Steps: 12 | Train Loss: 0.628 Vali Loss: 0.819 Vali Acc: 0.817 Test Loss: 0.819 Test Acc: 0.817
Validation loss decreased (-0.811102 --> -0.816658).  Saving model ...
Epoch: 31 cost time: 1.7898344993591309
Epoch: 31, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.775 Vali Acc: 0.833 Test Loss: 0.775 Test Acc: 0.833
Validation loss decreased (-0.816658 --> -0.833326).  Saving model ...
Epoch: 32 cost time: 1.811466932296753
Epoch: 32, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.756 Vali Acc: 0.817 Test Loss: 0.756 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.8416447639465332
Epoch: 33, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.733 Vali Acc: 0.828 Test Loss: 0.733 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.1882920265197754
Epoch: 34, Steps: 12 | Train Loss: 0.482 Vali Loss: 0.688 Vali Acc: 0.833 Test Loss: 0.688 Test Acc: 0.833
Validation loss decreased (-0.833326 --> -0.833326).  Saving model ...
Epoch: 35 cost time: 2.3561389446258545
Epoch: 35, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.665 Vali Acc: 0.844 Test Loss: 0.665 Test Acc: 0.844
Validation loss decreased (-0.833326 --> -0.844438).  Saving model ...
Epoch: 36 cost time: 1.7936227321624756
Epoch: 36, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.643 Vali Acc: 0.839 Test Loss: 0.643 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.9838979244232178
Epoch: 37, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.633 Vali Acc: 0.844 Test Loss: 0.633 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 38 cost time: 1.8138847351074219
Epoch: 38, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.622 Vali Acc: 0.839 Test Loss: 0.622 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.7302284240722656
Epoch: 39, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.608 Vali Acc: 0.828 Test Loss: 0.608 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.723494291305542
Epoch: 40, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.597 Vali Acc: 0.844 Test Loss: 0.597 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 41 cost time: 1.8521530628204346
Epoch: 41, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.608 Vali Acc: 0.844 Test Loss: 0.608 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.972278356552124
Epoch: 42, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.571 Vali Acc: 0.850 Test Loss: 0.571 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 43 cost time: 1.926893949508667
Epoch: 43, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.558 Vali Acc: 0.861 Test Loss: 0.558 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861106).  Saving model ...
Epoch: 44 cost time: 1.6033260822296143
Epoch: 44, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.538 Vali Acc: 0.872 Test Loss: 0.538 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 45 cost time: 1.7398371696472168
Epoch: 45, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.563 Vali Acc: 0.856 Test Loss: 0.563 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.169070243835449
Epoch: 46, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.508 Vali Acc: 0.867 Test Loss: 0.508 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.7421345710754395
Epoch: 47, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.524 Vali Acc: 0.856 Test Loss: 0.524 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.9713821411132812
Epoch: 48, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.470 Vali Acc: 0.867 Test Loss: 0.470 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.6710865497589111
Epoch: 49, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.496 Vali Acc: 0.861 Test Loss: 0.496 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.6252782344818115
Epoch: 50, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.502 Vali Acc: 0.861 Test Loss: 0.502 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 2.0997917652130127
Epoch: 51, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.495 Vali Acc: 0.867 Test Loss: 0.495 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 2.306198835372925
Epoch: 52, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.471 Vali Acc: 0.867 Test Loss: 0.471 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.786219596862793
Epoch: 53, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.480 Vali Acc: 0.872 Test Loss: 0.480 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 54 cost time: 1.5633206367492676
Epoch: 54, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.503 Vali Acc: 0.861 Test Loss: 0.503 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.684201717376709
Epoch: 55, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.476 Vali Acc: 0.856 Test Loss: 0.476 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.768007516860962
Epoch: 56, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.470 Vali Acc: 0.883 Test Loss: 0.470 Test Acc: 0.883
Validation loss decreased (-0.872217 --> -0.883329).  Saving model ...
Epoch: 57 cost time: 2.0294759273529053
Epoch: 57, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.448 Vali Acc: 0.878 Test Loss: 0.448 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.813934564590454
Epoch: 58, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.490 Vali Acc: 0.861 Test Loss: 0.490 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.5429232120513916
Epoch: 59, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.481 Vali Acc: 0.856 Test Loss: 0.481 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.6428916454315186
Epoch: 60, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.435 Vali Acc: 0.872 Test Loss: 0.435 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.830655813217163
Epoch: 61, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.503 Vali Acc: 0.861 Test Loss: 0.503 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.3778555393218994
Epoch: 62, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.466 Vali Acc: 0.867 Test Loss: 0.466 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.500392198562622
Epoch: 63, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.479 Vali Acc: 0.878 Test Loss: 0.479 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 2.1693596839904785
Epoch: 64, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.420 Vali Acc: 0.906 Test Loss: 0.420 Test Acc: 0.906
Validation loss decreased (-0.883329 --> -0.905551).  Saving model ...
Epoch: 65 cost time: 2.0793616771698
Epoch: 65, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.491 Vali Acc: 0.850 Test Loss: 0.491 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.7461421489715576
Epoch: 66, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.472 Vali Acc: 0.872 Test Loss: 0.472 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.7826600074768066
Epoch: 67, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.471 Vali Acc: 0.883 Test Loss: 0.471 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 1.716015338897705
Epoch: 68, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.482 Vali Acc: 0.872 Test Loss: 0.482 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 2.122957706451416
Epoch: 69, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.440 Vali Acc: 0.883 Test Loss: 0.440 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 2.022231340408325
Epoch: 70, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.454 Vali Acc: 0.883 Test Loss: 0.454 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 1.8889927864074707
Epoch: 71, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.458 Vali Acc: 0.867 Test Loss: 0.458 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 1.6563224792480469
Epoch: 72, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.437 Vali Acc: 0.867 Test Loss: 0.437 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 1.8166356086730957
Epoch: 73, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.523 Vali Acc: 0.861 Test Loss: 0.523 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 2.103436231613159
Epoch: 74, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.493 Vali Acc: 0.856 Test Loss: 0.493 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 241183
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2350986003875732
Epoch: 1, Steps: 12 | Train Loss: 2.862 Vali Loss: 2.887 Vali Acc: 0.039 Test Loss: 2.887 Test Acc: 0.039
Validation loss decreased (inf --> -0.038860).  Saving model ...
Epoch: 2 cost time: 1.6042149066925049
Epoch: 2, Steps: 12 | Train Loss: 2.846 Vali Loss: 2.804 Vali Acc: 0.050 Test Loss: 2.804 Test Acc: 0.050
Validation loss decreased (-0.038860 --> -0.049972).  Saving model ...
Epoch: 3 cost time: 1.8221187591552734
Epoch: 3, Steps: 12 | Train Loss: 2.739 Vali Loss: 2.730 Vali Acc: 0.106 Test Loss: 2.730 Test Acc: 0.106
Validation loss decreased (-0.049972 --> -0.105528).  Saving model ...
Epoch: 4 cost time: 1.6684632301330566
Epoch: 4, Steps: 12 | Train Loss: 2.743 Vali Loss: 2.658 Vali Acc: 0.144 Test Loss: 2.658 Test Acc: 0.144
Validation loss decreased (-0.105528 --> -0.144418).  Saving model ...
Epoch: 5 cost time: 1.921886682510376
Epoch: 5, Steps: 12 | Train Loss: 2.682 Vali Loss: 2.580 Vali Acc: 0.156 Test Loss: 2.580 Test Acc: 0.156
Validation loss decreased (-0.144418 --> -0.155530).  Saving model ...
Epoch: 6 cost time: 1.6310324668884277
Epoch: 6, Steps: 12 | Train Loss: 2.575 Vali Loss: 2.491 Vali Acc: 0.222 Test Loss: 2.491 Test Acc: 0.222
Validation loss decreased (-0.155530 --> -0.222197).  Saving model ...
Epoch: 7 cost time: 1.6420700550079346
Epoch: 7, Steps: 12 | Train Loss: 2.480 Vali Loss: 2.382 Vali Acc: 0.289 Test Loss: 2.382 Test Acc: 0.289
Validation loss decreased (-0.222197 --> -0.288865).  Saving model ...
Epoch: 8 cost time: 1.6338865756988525
Epoch: 8, Steps: 12 | Train Loss: 2.335 Vali Loss: 2.259 Vali Acc: 0.344 Test Loss: 2.259 Test Acc: 0.344
Validation loss decreased (-0.288865 --> -0.344422).  Saving model ...
Epoch: 9 cost time: 1.7398521900177002
Epoch: 9, Steps: 12 | Train Loss: 2.196 Vali Loss: 2.139 Vali Acc: 0.378 Test Loss: 2.139 Test Acc: 0.378
Validation loss decreased (-0.344422 --> -0.377756).  Saving model ...
Epoch: 10 cost time: 1.7584528923034668
Epoch: 10, Steps: 12 | Train Loss: 2.128 Vali Loss: 2.044 Vali Acc: 0.461 Test Loss: 2.044 Test Acc: 0.461
Validation loss decreased (-0.377756 --> -0.461091).  Saving model ...
Epoch: 11 cost time: 1.5850298404693604
Epoch: 11, Steps: 12 | Train Loss: 2.007 Vali Loss: 1.960 Vali Acc: 0.428 Test Loss: 1.960 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8049848079681396
Epoch: 12, Steps: 12 | Train Loss: 1.911 Vali Loss: 1.865 Vali Acc: 0.456 Test Loss: 1.865 Test Acc: 0.456
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5605683326721191
Epoch: 13, Steps: 12 | Train Loss: 1.821 Vali Loss: 1.793 Vali Acc: 0.489 Test Loss: 1.793 Test Acc: 0.489
Validation loss decreased (-0.461091 --> -0.488871).  Saving model ...
Epoch: 14 cost time: 1.6017537117004395
Epoch: 14, Steps: 12 | Train Loss: 1.701 Vali Loss: 1.738 Vali Acc: 0.500 Test Loss: 1.738 Test Acc: 0.500
Validation loss decreased (-0.488871 --> -0.499983).  Saving model ...
Epoch: 15 cost time: 1.8965215682983398
Epoch: 15, Steps: 12 | Train Loss: 1.605 Vali Loss: 1.670 Vali Acc: 0.517 Test Loss: 1.670 Test Acc: 0.517
Validation loss decreased (-0.499983 --> -0.516650).  Saving model ...
Epoch: 16 cost time: 2.044296979904175
Epoch: 16, Steps: 12 | Train Loss: 1.525 Vali Loss: 1.607 Vali Acc: 0.539 Test Loss: 1.607 Test Acc: 0.539
Validation loss decreased (-0.516650 --> -0.538873).  Saving model ...
Epoch: 17 cost time: 1.7890806198120117
Epoch: 17, Steps: 12 | Train Loss: 1.549 Vali Loss: 1.559 Vali Acc: 0.583 Test Loss: 1.559 Test Acc: 0.583
Validation loss decreased (-0.538873 --> -0.583318).  Saving model ...
Epoch: 18 cost time: 1.8296446800231934
Epoch: 18, Steps: 12 | Train Loss: 1.440 Vali Loss: 1.498 Vali Acc: 0.594 Test Loss: 1.498 Test Acc: 0.594
Validation loss decreased (-0.583318 --> -0.594429).  Saving model ...
Epoch: 19 cost time: 1.6912319660186768
Epoch: 19, Steps: 12 | Train Loss: 1.463 Vali Loss: 1.468 Vali Acc: 0.600 Test Loss: 1.468 Test Acc: 0.600
Validation loss decreased (-0.594429 --> -0.599985).  Saving model ...
Epoch: 20 cost time: 1.925835371017456
Epoch: 20, Steps: 12 | Train Loss: 1.331 Vali Loss: 1.417 Vali Acc: 0.606 Test Loss: 1.417 Test Acc: 0.606
Validation loss decreased (-0.599985 --> -0.605541).  Saving model ...
Epoch: 21 cost time: 1.7155256271362305
Epoch: 21, Steps: 12 | Train Loss: 1.273 Vali Loss: 1.365 Vali Acc: 0.633 Test Loss: 1.365 Test Acc: 0.633
Validation loss decreased (-0.605541 --> -0.633320).  Saving model ...
Epoch: 22 cost time: 1.8328075408935547
Epoch: 22, Steps: 12 | Train Loss: 1.207 Vali Loss: 1.335 Vali Acc: 0.611 Test Loss: 1.335 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.957353115081787
Epoch: 23, Steps: 12 | Train Loss: 1.158 Vali Loss: 1.280 Vali Acc: 0.650 Test Loss: 1.280 Test Acc: 0.650
Validation loss decreased (-0.633320 --> -0.649987).  Saving model ...
Epoch: 24 cost time: 1.6522600650787354
Epoch: 24, Steps: 12 | Train Loss: 1.122 Vali Loss: 1.240 Vali Acc: 0.656 Test Loss: 1.240 Test Acc: 0.656
Validation loss decreased (-0.649987 --> -0.655543).  Saving model ...
Epoch: 25 cost time: 1.8576490879058838
Epoch: 25, Steps: 12 | Train Loss: 1.112 Vali Loss: 1.178 Vali Acc: 0.656 Test Loss: 1.178 Test Acc: 0.656
Validation loss decreased (-0.655543 --> -0.655544).  Saving model ...
Epoch: 26 cost time: 1.614212989807129
Epoch: 26, Steps: 12 | Train Loss: 1.000 Vali Loss: 1.134 Vali Acc: 0.678 Test Loss: 1.134 Test Acc: 0.678
Validation loss decreased (-0.655544 --> -0.677766).  Saving model ...
Epoch: 27 cost time: 1.4552037715911865
Epoch: 27, Steps: 12 | Train Loss: 0.971 Vali Loss: 1.094 Vali Acc: 0.700 Test Loss: 1.094 Test Acc: 0.700
Validation loss decreased (-0.677766 --> -0.699989).  Saving model ...
Epoch: 28 cost time: 1.7612359523773193
Epoch: 28, Steps: 12 | Train Loss: 0.897 Vali Loss: 1.081 Vali Acc: 0.706 Test Loss: 1.081 Test Acc: 0.706
Validation loss decreased (-0.699989 --> -0.705545).  Saving model ...
Epoch: 29 cost time: 1.9158728122711182
Epoch: 29, Steps: 12 | Train Loss: 0.903 Vali Loss: 1.037 Vali Acc: 0.728 Test Loss: 1.037 Test Acc: 0.728
Validation loss decreased (-0.705545 --> -0.727767).  Saving model ...
Epoch: 30 cost time: 2.0027692317962646
Epoch: 30, Steps: 12 | Train Loss: 0.860 Vali Loss: 0.993 Vali Acc: 0.717 Test Loss: 0.993 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.8035821914672852
Epoch: 31, Steps: 12 | Train Loss: 0.829 Vali Loss: 0.950 Vali Acc: 0.733 Test Loss: 0.950 Test Acc: 0.733
Validation loss decreased (-0.727767 --> -0.733324).  Saving model ...
Epoch: 32 cost time: 1.6543364524841309
Epoch: 32, Steps: 12 | Train Loss: 0.740 Vali Loss: 0.903 Vali Acc: 0.767 Test Loss: 0.903 Test Acc: 0.767
Validation loss decreased (-0.733324 --> -0.766658).  Saving model ...
Epoch: 33 cost time: 1.6691350936889648
Epoch: 33, Steps: 12 | Train Loss: 0.726 Vali Loss: 0.860 Vali Acc: 0.761 Test Loss: 0.860 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.7186279296875
Epoch: 34, Steps: 12 | Train Loss: 0.690 Vali Loss: 0.830 Vali Acc: 0.772 Test Loss: 0.830 Test Acc: 0.772
Validation loss decreased (-0.766658 --> -0.772214).  Saving model ...
Epoch: 35 cost time: 1.8534705638885498
Epoch: 35, Steps: 12 | Train Loss: 0.645 Vali Loss: 0.793 Vali Acc: 0.800 Test Loss: 0.793 Test Acc: 0.800
Validation loss decreased (-0.772214 --> -0.799992).  Saving model ...
Epoch: 36 cost time: 1.8743643760681152
Epoch: 36, Steps: 12 | Train Loss: 0.600 Vali Loss: 0.796 Vali Acc: 0.783 Test Loss: 0.796 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.5142414569854736
Epoch: 37, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.756 Vali Acc: 0.794 Test Loss: 0.756 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.6825816631317139
Epoch: 38, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.716 Vali Acc: 0.811 Test Loss: 0.716 Test Acc: 0.811
Validation loss decreased (-0.799992 --> -0.811104).  Saving model ...
Epoch: 39 cost time: 1.8324878215789795
Epoch: 39, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.721 Vali Acc: 0.817 Test Loss: 0.721 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816659).  Saving model ...
Epoch: 40 cost time: 1.5353662967681885
Epoch: 40, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.712 Vali Acc: 0.811 Test Loss: 0.712 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.818216323852539
Epoch: 41, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.705 Vali Acc: 0.839 Test Loss: 0.705 Test Acc: 0.839
Validation loss decreased (-0.816659 --> -0.838882).  Saving model ...
Epoch: 42 cost time: 1.6115078926086426
Epoch: 42, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.661 Vali Acc: 0.833 Test Loss: 0.661 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.8590943813323975
Epoch: 43, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.664 Vali Acc: 0.828 Test Loss: 0.664 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.8482606410980225
Epoch: 44, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.652 Vali Acc: 0.828 Test Loss: 0.652 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.8683791160583496
Epoch: 45, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.627 Vali Acc: 0.822 Test Loss: 0.627 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.778411865234375
Epoch: 46, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.617 Vali Acc: 0.822 Test Loss: 0.617 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.8548495769500732
Epoch: 47, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.621 Vali Acc: 0.839 Test Loss: 0.621 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838883).  Saving model ...
Epoch: 48 cost time: 1.4659078121185303
Epoch: 48, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.587 Vali Acc: 0.839 Test Loss: 0.587 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 49 cost time: 1.712329387664795
Epoch: 49, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.583 Vali Acc: 0.822 Test Loss: 0.583 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.6674532890319824
Epoch: 50, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.571 Vali Acc: 0.844 Test Loss: 0.571 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 51 cost time: 1.9329912662506104
Epoch: 51, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.585 Vali Acc: 0.856 Test Loss: 0.585 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 52 cost time: 1.5669429302215576
Epoch: 52, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.582 Vali Acc: 0.839 Test Loss: 0.582 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.8078022003173828
Epoch: 53, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.595 Vali Acc: 0.839 Test Loss: 0.595 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.6972012519836426
Epoch: 54, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.554 Vali Acc: 0.833 Test Loss: 0.554 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.5805718898773193
Epoch: 55, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.575 Vali Acc: 0.844 Test Loss: 0.575 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.9781694412231445
Epoch: 56, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.529 Vali Acc: 0.833 Test Loss: 0.529 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.6824331283569336
Epoch: 57, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.550 Vali Acc: 0.861 Test Loss: 0.550 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 58 cost time: 2.0089643001556396
Epoch: 58, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.510 Vali Acc: 0.861 Test Loss: 0.510 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 59 cost time: 1.835200548171997
Epoch: 59, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.535 Vali Acc: 0.867 Test Loss: 0.535 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 60 cost time: 1.843226432800293
Epoch: 60, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.558 Vali Acc: 0.861 Test Loss: 0.558 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.7546401023864746
Epoch: 61, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.575 Vali Acc: 0.856 Test Loss: 0.575 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.639256238937378
Epoch: 62, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.557 Vali Acc: 0.844 Test Loss: 0.557 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.8167614936828613
Epoch: 63, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.501 Vali Acc: 0.867 Test Loss: 0.501 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866662).  Saving model ...
Epoch: 64 cost time: 1.5261845588684082
Epoch: 64, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.563 Vali Acc: 0.867 Test Loss: 0.563 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.582414150238037
Epoch: 65, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.560 Vali Acc: 0.861 Test Loss: 0.560 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.6709918975830078
Epoch: 66, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.507 Vali Acc: 0.867 Test Loss: 0.507 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 1.6853299140930176
Epoch: 67, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.503 Vali Acc: 0.867 Test Loss: 0.503 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 1.667865514755249
Epoch: 68, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.527 Vali Acc: 0.861 Test Loss: 0.527 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 1.547806978225708
Epoch: 69, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.558 Vali Acc: 0.856 Test Loss: 0.558 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 1.7193927764892578
Epoch: 70, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.608 Vali Acc: 0.856 Test Loss: 0.608 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 1.6465654373168945
Epoch: 71, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.566 Vali Acc: 0.861 Test Loss: 0.566 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 1.8094162940979004
Epoch: 72, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.586 Vali Acc: 0.872 Test Loss: 0.586 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872216).  Saving model ...
Epoch: 73 cost time: 1.5737171173095703
Epoch: 73, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.552 Vali Acc: 0.856 Test Loss: 0.552 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.7132370471954346
Epoch: 74, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.559 Vali Acc: 0.878 Test Loss: 0.559 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877772).  Saving model ...
Epoch: 75 cost time: 1.5806353092193604
Epoch: 75, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.585 Vali Acc: 0.861 Test Loss: 0.585 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 2.165400981903076
Epoch: 76, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.575 Vali Acc: 0.878 Test Loss: 0.575 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 2.161792755126953
Epoch: 77, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.567 Vali Acc: 0.872 Test Loss: 0.567 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 1.8835270404815674
Epoch: 78, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.539 Vali Acc: 0.878 Test Loss: 0.539 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 79 cost time: 1.7216544151306152
Epoch: 79, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.560 Vali Acc: 0.867 Test Loss: 0.560 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 1.8082447052001953
Epoch: 80, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.558 Vali Acc: 0.872 Test Loss: 0.558 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 1.7889068126678467
Epoch: 81, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.555 Vali Acc: 0.867 Test Loss: 0.555 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 1.621410846710205
Epoch: 82, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.596 Vali Acc: 0.861 Test Loss: 0.596 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 2.0714571475982666
Epoch: 83, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.586 Vali Acc: 0.872 Test Loss: 0.586 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 1.4384183883666992
Epoch: 84, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.594 Vali Acc: 0.861 Test Loss: 0.594 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 2.1433186531066895
Epoch: 85, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.526 Vali Acc: 0.872 Test Loss: 0.526 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 86 cost time: 1.7127370834350586
Epoch: 86, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.554 Vali Acc: 0.878 Test Loss: 0.554 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 87 cost time: 1.6524581909179688
Epoch: 87, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.545 Vali Acc: 0.883 Test Loss: 0.545 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883328).  Saving model ...
Epoch: 88 cost time: 1.6208069324493408
Epoch: 88, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.546 Vali Acc: 0.883 Test Loss: 0.546 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 1.5623350143432617
Epoch: 89, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.566 Vali Acc: 0.878 Test Loss: 0.566 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 1.5046546459197998
Epoch: 90, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.604 Vali Acc: 0.850 Test Loss: 0.604 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 1.6175734996795654
Epoch: 91, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.624 Vali Acc: 0.861 Test Loss: 0.624 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 92 cost time: 1.6030795574188232
Epoch: 92, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.607 Vali Acc: 0.878 Test Loss: 0.607 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 93 cost time: 1.679724931716919
Epoch: 93, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.573 Vali Acc: 0.878 Test Loss: 0.573 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 94 cost time: 1.5953350067138672
Epoch: 94, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.581 Vali Acc: 0.872 Test Loss: 0.581 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 95 cost time: 1.6399550437927246
Epoch: 95, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.582 Vali Acc: 0.872 Test Loss: 0.582 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 96 cost time: 1.8249850273132324
Epoch: 96, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.603 Vali Acc: 0.878 Test Loss: 0.603 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 97 cost time: 1.8155879974365234
Epoch: 97, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.582 Vali Acc: 0.872 Test Loss: 0.582 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 183615
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6534671783447266
Epoch: 1, Steps: 12 | Train Loss: 2.877 Vali Loss: 2.819 Vali Acc: 0.050 Test Loss: 2.819 Test Acc: 0.050
Validation loss decreased (inf --> -0.049972).  Saving model ...
Epoch: 2 cost time: 1.5028102397918701
Epoch: 2, Steps: 12 | Train Loss: 2.864 Vali Loss: 2.743 Vali Acc: 0.056 Test Loss: 2.743 Test Acc: 0.056
Validation loss decreased (-0.049972 --> -0.055528).  Saving model ...
Epoch: 3 cost time: 1.6872260570526123
Epoch: 3, Steps: 12 | Train Loss: 2.799 Vali Loss: 2.678 Vali Acc: 0.117 Test Loss: 2.678 Test Acc: 0.117
Validation loss decreased (-0.055528 --> -0.116640).  Saving model ...
Epoch: 4 cost time: 1.7815840244293213
Epoch: 4, Steps: 12 | Train Loss: 2.703 Vali Loss: 2.633 Vali Acc: 0.133 Test Loss: 2.633 Test Acc: 0.133
Validation loss decreased (-0.116640 --> -0.133307).  Saving model ...
Epoch: 5 cost time: 1.8281199932098389
Epoch: 5, Steps: 12 | Train Loss: 2.601 Vali Loss: 2.582 Vali Acc: 0.183 Test Loss: 2.582 Test Acc: 0.183
Validation loss decreased (-0.133307 --> -0.183308).  Saving model ...
Epoch: 6 cost time: 1.6142911911010742
Epoch: 6, Steps: 12 | Train Loss: 2.582 Vali Loss: 2.525 Vali Acc: 0.256 Test Loss: 2.525 Test Acc: 0.256
Validation loss decreased (-0.183308 --> -0.255530).  Saving model ...
Epoch: 7 cost time: 1.4556968212127686
Epoch: 7, Steps: 12 | Train Loss: 2.529 Vali Loss: 2.461 Vali Acc: 0.311 Test Loss: 2.461 Test Acc: 0.311
Validation loss decreased (-0.255530 --> -0.311086).  Saving model ...
Epoch: 8 cost time: 1.572253704071045
Epoch: 8, Steps: 12 | Train Loss: 2.453 Vali Loss: 2.383 Vali Acc: 0.356 Test Loss: 2.383 Test Acc: 0.356
Validation loss decreased (-0.311086 --> -0.355532).  Saving model ...
Epoch: 9 cost time: 1.609722375869751
Epoch: 9, Steps: 12 | Train Loss: 2.354 Vali Loss: 2.297 Vali Acc: 0.350 Test Loss: 2.297 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5735459327697754
Epoch: 10, Steps: 12 | Train Loss: 2.215 Vali Loss: 2.227 Vali Acc: 0.350 Test Loss: 2.227 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6676578521728516
Epoch: 11, Steps: 12 | Train Loss: 2.131 Vali Loss: 2.117 Vali Acc: 0.400 Test Loss: 2.117 Test Acc: 0.400
Validation loss decreased (-0.355532 --> -0.399979).  Saving model ...
Epoch: 12 cost time: 1.8450651168823242
Epoch: 12, Steps: 12 | Train Loss: 2.035 Vali Loss: 2.018 Vali Acc: 0.483 Test Loss: 2.018 Test Acc: 0.483
Validation loss decreased (-0.399979 --> -0.483313).  Saving model ...
Epoch: 13 cost time: 1.9230260848999023
Epoch: 13, Steps: 12 | Train Loss: 1.952 Vali Loss: 1.950 Vali Acc: 0.500 Test Loss: 1.950 Test Acc: 0.500
Validation loss decreased (-0.483313 --> -0.499981).  Saving model ...
Epoch: 14 cost time: 1.867412805557251
Epoch: 14, Steps: 12 | Train Loss: 1.859 Vali Loss: 1.880 Vali Acc: 0.528 Test Loss: 1.880 Test Acc: 0.528
Validation loss decreased (-0.499981 --> -0.527759).  Saving model ...
Epoch: 15 cost time: 1.514359951019287
Epoch: 15, Steps: 12 | Train Loss: 1.768 Vali Loss: 1.800 Vali Acc: 0.583 Test Loss: 1.800 Test Acc: 0.583
Validation loss decreased (-0.527759 --> -0.583315).  Saving model ...
Epoch: 16 cost time: 1.8475570678710938
Epoch: 16, Steps: 12 | Train Loss: 1.684 Vali Loss: 1.728 Vali Acc: 0.628 Test Loss: 1.728 Test Acc: 0.628
Validation loss decreased (-0.583315 --> -0.627761).  Saving model ...
Epoch: 17 cost time: 1.7658379077911377
Epoch: 17, Steps: 12 | Train Loss: 1.607 Vali Loss: 1.667 Vali Acc: 0.606 Test Loss: 1.667 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7826876640319824
Epoch: 18, Steps: 12 | Train Loss: 1.544 Vali Loss: 1.607 Vali Acc: 0.611 Test Loss: 1.607 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4035325050354004
Epoch: 19, Steps: 12 | Train Loss: 1.502 Vali Loss: 1.532 Vali Acc: 0.622 Test Loss: 1.532 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5579702854156494
Epoch: 20, Steps: 12 | Train Loss: 1.404 Vali Loss: 1.447 Vali Acc: 0.628 Test Loss: 1.447 Test Acc: 0.628
Validation loss decreased (-0.627761 --> -0.627763).  Saving model ...
Epoch: 21 cost time: 2.045016288757324
Epoch: 21, Steps: 12 | Train Loss: 1.349 Vali Loss: 1.380 Vali Acc: 0.683 Test Loss: 1.380 Test Acc: 0.683
Validation loss decreased (-0.627763 --> -0.683320).  Saving model ...
Epoch: 22 cost time: 1.6745948791503906
Epoch: 22, Steps: 12 | Train Loss: 1.303 Vali Loss: 1.335 Vali Acc: 0.672 Test Loss: 1.335 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5961649417877197
Epoch: 23, Steps: 12 | Train Loss: 1.177 Vali Loss: 1.275 Vali Acc: 0.683 Test Loss: 1.275 Test Acc: 0.683
Validation loss decreased (-0.683320 --> -0.683321).  Saving model ...
Epoch: 24 cost time: 1.6167759895324707
Epoch: 24, Steps: 12 | Train Loss: 1.150 Vali Loss: 1.219 Vali Acc: 0.717 Test Loss: 1.219 Test Acc: 0.717
Validation loss decreased (-0.683321 --> -0.716654).  Saving model ...
Epoch: 25 cost time: 1.8806772232055664
Epoch: 25, Steps: 12 | Train Loss: 1.049 Vali Loss: 1.155 Vali Acc: 0.717 Test Loss: 1.155 Test Acc: 0.717
Validation loss decreased (-0.716654 --> -0.716655).  Saving model ...
Epoch: 26 cost time: 1.6375572681427002
Epoch: 26, Steps: 12 | Train Loss: 1.053 Vali Loss: 1.110 Vali Acc: 0.744 Test Loss: 1.110 Test Acc: 0.744
Validation loss decreased (-0.716655 --> -0.744433).  Saving model ...
Epoch: 27 cost time: 1.6007285118103027
Epoch: 27, Steps: 12 | Train Loss: 0.996 Vali Loss: 1.054 Vali Acc: 0.783 Test Loss: 1.054 Test Acc: 0.783
Validation loss decreased (-0.744433 --> -0.783323).  Saving model ...
Epoch: 28 cost time: 1.635239601135254
Epoch: 28, Steps: 12 | Train Loss: 0.916 Vali Loss: 1.011 Vali Acc: 0.750 Test Loss: 1.011 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.613534927368164
Epoch: 29, Steps: 12 | Train Loss: 0.827 Vali Loss: 0.967 Vali Acc: 0.783 Test Loss: 0.967 Test Acc: 0.783
Validation loss decreased (-0.783323 --> -0.783324).  Saving model ...
Epoch: 30 cost time: 1.5108325481414795
Epoch: 30, Steps: 12 | Train Loss: 0.802 Vali Loss: 0.928 Vali Acc: 0.794 Test Loss: 0.928 Test Acc: 0.794
Validation loss decreased (-0.783324 --> -0.794435).  Saving model ...
Epoch: 31 cost time: 1.4496700763702393
Epoch: 31, Steps: 12 | Train Loss: 0.772 Vali Loss: 0.893 Vali Acc: 0.789 Test Loss: 0.893 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.5009338855743408
Epoch: 32, Steps: 12 | Train Loss: 0.742 Vali Loss: 0.860 Vali Acc: 0.789 Test Loss: 0.860 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.6792819499969482
Epoch: 33, Steps: 12 | Train Loss: 0.704 Vali Loss: 0.825 Vali Acc: 0.789 Test Loss: 0.825 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.5801100730895996
Epoch: 34, Steps: 12 | Train Loss: 0.644 Vali Loss: 0.775 Vali Acc: 0.806 Test Loss: 0.775 Test Acc: 0.806
Validation loss decreased (-0.794435 --> -0.805548).  Saving model ...
Epoch: 35 cost time: 1.7981469631195068
Epoch: 35, Steps: 12 | Train Loss: 0.599 Vali Loss: 0.747 Vali Acc: 0.817 Test Loss: 0.747 Test Acc: 0.817
Validation loss decreased (-0.805548 --> -0.816659).  Saving model ...
Epoch: 36 cost time: 1.549988031387329
Epoch: 36, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.739 Vali Acc: 0.806 Test Loss: 0.739 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.570678949356079
Epoch: 37, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.727 Vali Acc: 0.817 Test Loss: 0.727 Test Acc: 0.817
Validation loss decreased (-0.816659 --> -0.816659).  Saving model ...
Epoch: 38 cost time: 1.4484164714813232
Epoch: 38, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.677 Vali Acc: 0.817 Test Loss: 0.677 Test Acc: 0.817
Validation loss decreased (-0.816659 --> -0.816660).  Saving model ...
Epoch: 39 cost time: 1.9029395580291748
Epoch: 39, Steps: 12 | Train Loss: 0.495 Vali Loss: 0.663 Vali Acc: 0.811 Test Loss: 0.663 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.5210447311401367
Epoch: 40, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.641 Vali Acc: 0.817 Test Loss: 0.641 Test Acc: 0.817
Validation loss decreased (-0.816660 --> -0.816660).  Saving model ...
Epoch: 41 cost time: 1.6580312252044678
Epoch: 41, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.600 Vali Acc: 0.839 Test Loss: 0.600 Test Acc: 0.839
Validation loss decreased (-0.816660 --> -0.838883).  Saving model ...
Epoch: 42 cost time: 1.6600379943847656
Epoch: 42, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.589 Vali Acc: 0.856 Test Loss: 0.589 Test Acc: 0.856
Validation loss decreased (-0.838883 --> -0.855550).  Saving model ...
Epoch: 43 cost time: 1.666626214981079
Epoch: 43, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.595 Vali Acc: 0.822 Test Loss: 0.595 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.6266629695892334
Epoch: 44, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.608 Vali Acc: 0.856 Test Loss: 0.608 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.6218469142913818
Epoch: 45, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.579 Vali Acc: 0.828 Test Loss: 0.579 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.5744781494140625
Epoch: 46, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.582 Vali Acc: 0.833 Test Loss: 0.582 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.4753403663635254
Epoch: 47, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.589 Vali Acc: 0.822 Test Loss: 0.589 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.636697769165039
Epoch: 48, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.563 Vali Acc: 0.850 Test Loss: 0.563 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.793614387512207
Epoch: 49, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.516 Vali Acc: 0.850 Test Loss: 0.516 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.7335360050201416
Epoch: 50, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.531 Vali Acc: 0.839 Test Loss: 0.531 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.9684906005859375
Epoch: 51, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.534 Vali Acc: 0.861 Test Loss: 0.534 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 52 cost time: 1.884702205657959
Epoch: 52, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.504 Vali Acc: 0.844 Test Loss: 0.504 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.6741502285003662
Epoch: 53, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.515 Vali Acc: 0.861 Test Loss: 0.515 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 54 cost time: 1.8896088600158691
Epoch: 54, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.519 Vali Acc: 0.833 Test Loss: 0.519 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.8729934692382812
Epoch: 55, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.499 Vali Acc: 0.856 Test Loss: 0.499 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.6835479736328125
Epoch: 56, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.509 Vali Acc: 0.856 Test Loss: 0.509 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.9985222816467285
Epoch: 57, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.495 Vali Acc: 0.850 Test Loss: 0.495 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.5705933570861816
Epoch: 58, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.487 Vali Acc: 0.861 Test Loss: 0.487 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 59 cost time: 1.911437749862671
Epoch: 59, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.512 Vali Acc: 0.856 Test Loss: 0.512 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.8920888900756836
Epoch: 60, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.479 Vali Acc: 0.856 Test Loss: 0.479 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.9665765762329102
Epoch: 61, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.503 Vali Acc: 0.872 Test Loss: 0.503 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 62 cost time: 1.8320326805114746
Epoch: 62, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.505 Vali Acc: 0.861 Test Loss: 0.505 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.9037950038909912
Epoch: 63, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.499 Vali Acc: 0.883 Test Loss: 0.499 Test Acc: 0.883
Validation loss decreased (-0.872217 --> -0.883328).  Saving model ...
Epoch: 64 cost time: 2.3806509971618652
Epoch: 64, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.534 Vali Acc: 0.833 Test Loss: 0.534 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.7387187480926514
Epoch: 65, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.543 Vali Acc: 0.856 Test Loss: 0.543 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.755847454071045
Epoch: 66, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.547 Vali Acc: 0.833 Test Loss: 0.547 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 1.6894299983978271
Epoch: 67, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.503 Vali Acc: 0.856 Test Loss: 0.503 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 1.654773235321045
Epoch: 68, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.503 Vali Acc: 0.856 Test Loss: 0.503 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 1.9368727207183838
Epoch: 69, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.492 Vali Acc: 0.844 Test Loss: 0.492 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 1.7334325313568115
Epoch: 70, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.496 Vali Acc: 0.850 Test Loss: 0.496 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 1.8697984218597412
Epoch: 71, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.492 Vali Acc: 0.872 Test Loss: 0.492 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 1.7625069618225098
Epoch: 72, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.478 Vali Acc: 0.867 Test Loss: 0.478 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 1.8030283451080322
Epoch: 73, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.521 Vali Acc: 0.872 Test Loss: 0.521 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 183391
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9074509143829346
Epoch: 1, Steps: 12 | Train Loss: 2.930 Vali Loss: 2.805 Vali Acc: 0.061 Test Loss: 2.805 Test Acc: 0.061
Validation loss decreased (inf --> -0.061083).  Saving model ...
Epoch: 2 cost time: 1.636962652206421
Epoch: 2, Steps: 12 | Train Loss: 2.834 Vali Loss: 2.747 Vali Acc: 0.056 Test Loss: 2.747 Test Acc: 0.056
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8138985633850098
Epoch: 3, Steps: 12 | Train Loss: 2.770 Vali Loss: 2.684 Vali Acc: 0.100 Test Loss: 2.684 Test Acc: 0.100
Validation loss decreased (-0.061083 --> -0.099973).  Saving model ...
Epoch: 4 cost time: 1.8191475868225098
Epoch: 4, Steps: 12 | Train Loss: 2.731 Vali Loss: 2.633 Vali Acc: 0.156 Test Loss: 2.633 Test Acc: 0.156
Validation loss decreased (-0.099973 --> -0.155529).  Saving model ...
Epoch: 5 cost time: 1.8987243175506592
Epoch: 5, Steps: 12 | Train Loss: 2.677 Vali Loss: 2.589 Vali Acc: 0.161 Test Loss: 2.589 Test Acc: 0.161
Validation loss decreased (-0.155529 --> -0.161085).  Saving model ...
Epoch: 6 cost time: 2.0275189876556396
Epoch: 6, Steps: 12 | Train Loss: 2.613 Vali Loss: 2.537 Vali Acc: 0.244 Test Loss: 2.537 Test Acc: 0.244
Validation loss decreased (-0.161085 --> -0.244419).  Saving model ...
Epoch: 7 cost time: 2.0463485717773438
Epoch: 7, Steps: 12 | Train Loss: 2.572 Vali Loss: 2.463 Vali Acc: 0.244 Test Loss: 2.463 Test Acc: 0.244
Validation loss decreased (-0.244419 --> -0.244420).  Saving model ...
Epoch: 8 cost time: 1.7999169826507568
Epoch: 8, Steps: 12 | Train Loss: 2.445 Vali Loss: 2.366 Vali Acc: 0.239 Test Loss: 2.366 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8907709121704102
Epoch: 9, Steps: 12 | Train Loss: 2.335 Vali Loss: 2.262 Vali Acc: 0.322 Test Loss: 2.262 Test Acc: 0.322
Validation loss decreased (-0.244420 --> -0.322200).  Saving model ...
Epoch: 10 cost time: 1.7721302509307861
Epoch: 10, Steps: 12 | Train Loss: 2.221 Vali Loss: 2.170 Vali Acc: 0.367 Test Loss: 2.170 Test Acc: 0.367
Validation loss decreased (-0.322200 --> -0.366645).  Saving model ...
Epoch: 11 cost time: 1.6772329807281494
Epoch: 11, Steps: 12 | Train Loss: 2.115 Vali Loss: 2.079 Vali Acc: 0.417 Test Loss: 2.079 Test Acc: 0.417
Validation loss decreased (-0.366645 --> -0.416646).  Saving model ...
Epoch: 12 cost time: 1.6479158401489258
Epoch: 12, Steps: 12 | Train Loss: 1.995 Vali Loss: 2.007 Vali Acc: 0.456 Test Loss: 2.007 Test Acc: 0.456
Validation loss decreased (-0.416646 --> -0.455535).  Saving model ...
Epoch: 13 cost time: 1.6044538021087646
Epoch: 13, Steps: 12 | Train Loss: 1.882 Vali Loss: 1.913 Vali Acc: 0.472 Test Loss: 1.913 Test Acc: 0.472
Validation loss decreased (-0.455535 --> -0.472203).  Saving model ...
Epoch: 14 cost time: 2.3050942420959473
Epoch: 14, Steps: 12 | Train Loss: 1.763 Vali Loss: 1.843 Vali Acc: 0.522 Test Loss: 1.843 Test Acc: 0.522
Validation loss decreased (-0.472203 --> -0.522204).  Saving model ...
Epoch: 15 cost time: 2.1727004051208496
Epoch: 15, Steps: 12 | Train Loss: 1.748 Vali Loss: 1.771 Vali Acc: 0.589 Test Loss: 1.771 Test Acc: 0.589
Validation loss decreased (-0.522204 --> -0.588871).  Saving model ...
Epoch: 16 cost time: 2.1567728519439697
Epoch: 16, Steps: 12 | Train Loss: 1.648 Vali Loss: 1.705 Vali Acc: 0.556 Test Loss: 1.705 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8330605030059814
Epoch: 17, Steps: 12 | Train Loss: 1.566 Vali Loss: 1.626 Vali Acc: 0.622 Test Loss: 1.626 Test Acc: 0.622
Validation loss decreased (-0.588871 --> -0.622206).  Saving model ...
Epoch: 18 cost time: 1.9372310638427734
Epoch: 18, Steps: 12 | Train Loss: 1.513 Vali Loss: 1.568 Vali Acc: 0.650 Test Loss: 1.568 Test Acc: 0.650
Validation loss decreased (-0.622206 --> -0.649984).  Saving model ...
Epoch: 19 cost time: 1.8108906745910645
Epoch: 19, Steps: 12 | Train Loss: 1.393 Vali Loss: 1.506 Vali Acc: 0.650 Test Loss: 1.506 Test Acc: 0.650
Validation loss decreased (-0.649984 --> -0.649985).  Saving model ...
Epoch: 20 cost time: 2.186737537384033
Epoch: 20, Steps: 12 | Train Loss: 1.355 Vali Loss: 1.462 Vali Acc: 0.661 Test Loss: 1.462 Test Acc: 0.661
Validation loss decreased (-0.649985 --> -0.661096).  Saving model ...
Epoch: 21 cost time: 1.9219400882720947
Epoch: 21, Steps: 12 | Train Loss: 1.292 Vali Loss: 1.370 Vali Acc: 0.700 Test Loss: 1.370 Test Acc: 0.700
Validation loss decreased (-0.661096 --> -0.699986).  Saving model ...
Epoch: 22 cost time: 1.7696843147277832
Epoch: 22, Steps: 12 | Train Loss: 1.154 Vali Loss: 1.332 Vali Acc: 0.706 Test Loss: 1.332 Test Acc: 0.706
Validation loss decreased (-0.699986 --> -0.705542).  Saving model ...
Epoch: 23 cost time: 1.688368320465088
Epoch: 23, Steps: 12 | Train Loss: 1.150 Vali Loss: 1.262 Vali Acc: 0.706 Test Loss: 1.262 Test Acc: 0.706
Validation loss decreased (-0.705542 --> -0.705543).  Saving model ...
Epoch: 24 cost time: 1.7058119773864746
Epoch: 24, Steps: 12 | Train Loss: 1.113 Vali Loss: 1.211 Vali Acc: 0.706 Test Loss: 1.211 Test Acc: 0.706
Validation loss decreased (-0.705543 --> -0.705543).  Saving model ...
Epoch: 25 cost time: 1.7933475971221924
Epoch: 25, Steps: 12 | Train Loss: 1.059 Vali Loss: 1.150 Vali Acc: 0.717 Test Loss: 1.150 Test Acc: 0.717
Validation loss decreased (-0.705543 --> -0.716655).  Saving model ...
Epoch: 26 cost time: 1.7294094562530518
Epoch: 26, Steps: 12 | Train Loss: 0.975 Vali Loss: 1.117 Vali Acc: 0.728 Test Loss: 1.117 Test Acc: 0.728
Validation loss decreased (-0.716655 --> -0.727767).  Saving model ...
Epoch: 27 cost time: 1.6390154361724854
Epoch: 27, Steps: 12 | Train Loss: 0.933 Vali Loss: 1.057 Vali Acc: 0.744 Test Loss: 1.057 Test Acc: 0.744
Validation loss decreased (-0.727767 --> -0.744434).  Saving model ...
Epoch: 28 cost time: 1.7707901000976562
Epoch: 28, Steps: 12 | Train Loss: 0.874 Vali Loss: 0.999 Vali Acc: 0.789 Test Loss: 0.999 Test Acc: 0.789
Validation loss decreased (-0.744434 --> -0.788879).  Saving model ...
Epoch: 29 cost time: 1.8100776672363281
Epoch: 29, Steps: 12 | Train Loss: 0.840 Vali Loss: 0.971 Vali Acc: 0.761 Test Loss: 0.971 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.8350112438201904
Epoch: 30, Steps: 12 | Train Loss: 0.859 Vali Loss: 0.921 Vali Acc: 0.778 Test Loss: 0.921 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.8408451080322266
Epoch: 31, Steps: 12 | Train Loss: 0.718 Vali Loss: 0.879 Vali Acc: 0.778 Test Loss: 0.879 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.7853364944458008
Epoch: 32, Steps: 12 | Train Loss: 0.711 Vali Loss: 0.849 Vali Acc: 0.794 Test Loss: 0.849 Test Acc: 0.794
Validation loss decreased (-0.788879 --> -0.794436).  Saving model ...
Epoch: 33 cost time: 1.8473222255706787
Epoch: 33, Steps: 12 | Train Loss: 0.655 Vali Loss: 0.829 Vali Acc: 0.783 Test Loss: 0.829 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.669668197631836
Epoch: 34, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.776 Vali Acc: 0.800 Test Loss: 0.776 Test Acc: 0.800
Validation loss decreased (-0.794436 --> -0.799992).  Saving model ...
Epoch: 35 cost time: 1.759216547012329
Epoch: 35, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.755 Vali Acc: 0.806 Test Loss: 0.755 Test Acc: 0.806
Validation loss decreased (-0.799992 --> -0.805548).  Saving model ...
Epoch: 36 cost time: 1.7755253314971924
Epoch: 36, Steps: 12 | Train Loss: 0.582 Vali Loss: 0.725 Vali Acc: 0.811 Test Loss: 0.725 Test Acc: 0.811
Validation loss decreased (-0.805548 --> -0.811104).  Saving model ...
Epoch: 37 cost time: 1.7300500869750977
Epoch: 37, Steps: 12 | Train Loss: 0.547 Vali Loss: 0.708 Vali Acc: 0.800 Test Loss: 0.708 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.717587947845459
Epoch: 38, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.683 Vali Acc: 0.817 Test Loss: 0.683 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816660).  Saving model ...
Epoch: 39 cost time: 1.763141393661499
Epoch: 39, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.648 Vali Acc: 0.833 Test Loss: 0.648 Test Acc: 0.833
Validation loss decreased (-0.816660 --> -0.833327).  Saving model ...
Epoch: 40 cost time: 1.8675713539123535
Epoch: 40, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.659 Vali Acc: 0.833 Test Loss: 0.659 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.902167797088623
Epoch: 41, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.625 Vali Acc: 0.833 Test Loss: 0.625 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 42 cost time: 1.839627742767334
Epoch: 42, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.604 Vali Acc: 0.833 Test Loss: 0.604 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 43 cost time: 1.8959968090057373
Epoch: 43, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.586 Vali Acc: 0.844 Test Loss: 0.586 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844439).  Saving model ...
Epoch: 44 cost time: 1.6013522148132324
Epoch: 44, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.594 Vali Acc: 0.828 Test Loss: 0.594 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.892298936843872
Epoch: 45, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.562 Vali Acc: 0.844 Test Loss: 0.562 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 46 cost time: 1.865203619003296
Epoch: 46, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.542 Vali Acc: 0.856 Test Loss: 0.542 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 47 cost time: 1.7777886390686035
Epoch: 47, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.532 Vali Acc: 0.844 Test Loss: 0.532 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.9042763710021973
Epoch: 48, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.516 Vali Acc: 0.850 Test Loss: 0.516 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.9138169288635254
Epoch: 49, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.503 Vali Acc: 0.861 Test Loss: 0.503 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 50 cost time: 2.3351657390594482
Epoch: 50, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.504 Vali Acc: 0.856 Test Loss: 0.504 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.7832865715026855
Epoch: 51, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.500 Vali Acc: 0.861 Test Loss: 0.500 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 52 cost time: 1.7049739360809326
Epoch: 52, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.518 Vali Acc: 0.861 Test Loss: 0.518 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.9318647384643555
Epoch: 53, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.482 Vali Acc: 0.872 Test Loss: 0.482 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 54 cost time: 1.8824079036712646
Epoch: 54, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.446 Vali Acc: 0.878 Test Loss: 0.446 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 55 cost time: 1.917238712310791
Epoch: 55, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.487 Vali Acc: 0.856 Test Loss: 0.487 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.8809564113616943
Epoch: 56, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.480 Vali Acc: 0.872 Test Loss: 0.480 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.6766626834869385
Epoch: 57, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.467 Vali Acc: 0.861 Test Loss: 0.467 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.8503577709197998
Epoch: 58, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.457 Vali Acc: 0.872 Test Loss: 0.457 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 2.020707607269287
Epoch: 59, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.439 Vali Acc: 0.883 Test Loss: 0.439 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883329).  Saving model ...
Epoch: 60 cost time: 1.7989392280578613
Epoch: 60, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.473 Vali Acc: 0.872 Test Loss: 0.473 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 2.078115224838257
Epoch: 61, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.446 Vali Acc: 0.878 Test Loss: 0.446 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 2.1603176593780518
Epoch: 62, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.474 Vali Acc: 0.867 Test Loss: 0.474 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.7986915111541748
Epoch: 63, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.451 Vali Acc: 0.867 Test Loss: 0.451 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.821277141571045
Epoch: 64, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.458 Vali Acc: 0.878 Test Loss: 0.458 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.6659281253814697
Epoch: 65, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.465 Vali Acc: 0.872 Test Loss: 0.465 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 1.9848322868347168
Epoch: 66, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.466 Vali Acc: 0.872 Test Loss: 0.466 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 1.8781580924987793
Epoch: 67, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.468 Vali Acc: 0.861 Test Loss: 0.468 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 1.7098019123077393
Epoch: 68, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.463 Vali Acc: 0.878 Test Loss: 0.463 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 1.7027561664581299
Epoch: 69, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.462 Vali Acc: 0.872 Test Loss: 0.462 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 183167
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.1578099727630615
Epoch: 1, Steps: 12 | Train Loss: 2.898 Vali Loss: 2.848 Vali Acc: 0.050 Test Loss: 2.848 Test Acc: 0.050
Validation loss decreased (inf --> -0.049972).  Saving model ...
Epoch: 2 cost time: 1.8432552814483643
Epoch: 2, Steps: 12 | Train Loss: 2.833 Vali Loss: 2.769 Vali Acc: 0.050 Test Loss: 2.769 Test Acc: 0.050
Validation loss decreased (-0.049972 --> -0.049972).  Saving model ...
Epoch: 3 cost time: 1.7205657958984375
Epoch: 3, Steps: 12 | Train Loss: 2.743 Vali Loss: 2.702 Vali Acc: 0.089 Test Loss: 2.702 Test Acc: 0.089
Validation loss decreased (-0.049972 --> -0.088862).  Saving model ...
Epoch: 4 cost time: 1.5781354904174805
Epoch: 4, Steps: 12 | Train Loss: 2.695 Vali Loss: 2.646 Vali Acc: 0.133 Test Loss: 2.646 Test Acc: 0.133
Validation loss decreased (-0.088862 --> -0.133307).  Saving model ...
Epoch: 5 cost time: 1.9036939144134521
Epoch: 5, Steps: 12 | Train Loss: 2.658 Vali Loss: 2.598 Vali Acc: 0.150 Test Loss: 2.598 Test Acc: 0.150
Validation loss decreased (-0.133307 --> -0.149974).  Saving model ...
Epoch: 6 cost time: 2.1662845611572266
Epoch: 6, Steps: 12 | Train Loss: 2.584 Vali Loss: 2.555 Vali Acc: 0.206 Test Loss: 2.555 Test Acc: 0.206
Validation loss decreased (-0.149974 --> -0.205530).  Saving model ...
Epoch: 7 cost time: 2.0930957794189453
Epoch: 7, Steps: 12 | Train Loss: 2.508 Vali Loss: 2.479 Vali Acc: 0.239 Test Loss: 2.479 Test Acc: 0.239
Validation loss decreased (-0.205530 --> -0.238864).  Saving model ...
Epoch: 8 cost time: 1.9209744930267334
Epoch: 8, Steps: 12 | Train Loss: 2.361 Vali Loss: 2.399 Vali Acc: 0.328 Test Loss: 2.399 Test Acc: 0.328
Validation loss decreased (-0.238864 --> -0.327754).  Saving model ...
Epoch: 9 cost time: 1.9330453872680664
Epoch: 9, Steps: 12 | Train Loss: 2.309 Vali Loss: 2.315 Vali Acc: 0.378 Test Loss: 2.315 Test Acc: 0.378
Validation loss decreased (-0.327754 --> -0.377755).  Saving model ...
Epoch: 10 cost time: 1.7851567268371582
Epoch: 10, Steps: 12 | Train Loss: 2.203 Vali Loss: 2.218 Vali Acc: 0.422 Test Loss: 2.218 Test Acc: 0.422
Validation loss decreased (-0.377755 --> -0.422200).  Saving model ...
Epoch: 11 cost time: 2.363816499710083
Epoch: 11, Steps: 12 | Train Loss: 2.074 Vali Loss: 2.123 Vali Acc: 0.456 Test Loss: 2.123 Test Acc: 0.456
Validation loss decreased (-0.422200 --> -0.455534).  Saving model ...
Epoch: 12 cost time: 2.530942678451538
Epoch: 12, Steps: 12 | Train Loss: 1.967 Vali Loss: 2.029 Vali Acc: 0.489 Test Loss: 2.029 Test Acc: 0.489
Validation loss decreased (-0.455534 --> -0.488869).  Saving model ...
Epoch: 13 cost time: 1.8421719074249268
Epoch: 13, Steps: 12 | Train Loss: 1.832 Vali Loss: 1.944 Vali Acc: 0.539 Test Loss: 1.944 Test Acc: 0.539
Validation loss decreased (-0.488869 --> -0.538869).  Saving model ...
Epoch: 14 cost time: 1.9299063682556152
Epoch: 14, Steps: 12 | Train Loss: 1.766 Vali Loss: 1.855 Vali Acc: 0.544 Test Loss: 1.855 Test Acc: 0.544
Validation loss decreased (-0.538869 --> -0.544426).  Saving model ...
Epoch: 15 cost time: 1.7980985641479492
Epoch: 15, Steps: 12 | Train Loss: 1.645 Vali Loss: 1.791 Vali Acc: 0.561 Test Loss: 1.791 Test Acc: 0.561
Validation loss decreased (-0.544426 --> -0.561093).  Saving model ...
Epoch: 16 cost time: 1.8195645809173584
Epoch: 16, Steps: 12 | Train Loss: 1.548 Vali Loss: 1.710 Vali Acc: 0.594 Test Loss: 1.710 Test Acc: 0.594
Validation loss decreased (-0.561093 --> -0.594427).  Saving model ...
Epoch: 17 cost time: 1.9989094734191895
Epoch: 17, Steps: 12 | Train Loss: 1.523 Vali Loss: 1.637 Vali Acc: 0.594 Test Loss: 1.637 Test Acc: 0.594
Validation loss decreased (-0.594427 --> -0.594428).  Saving model ...
Epoch: 18 cost time: 2.0449416637420654
Epoch: 18, Steps: 12 | Train Loss: 1.432 Vali Loss: 1.549 Vali Acc: 0.600 Test Loss: 1.549 Test Acc: 0.600
Validation loss decreased (-0.594428 --> -0.599985).  Saving model ...
Epoch: 19 cost time: 2.0446860790252686
Epoch: 19, Steps: 12 | Train Loss: 1.345 Vali Loss: 1.487 Vali Acc: 0.683 Test Loss: 1.487 Test Acc: 0.683
Validation loss decreased (-0.599985 --> -0.683318).  Saving model ...
Epoch: 20 cost time: 1.6491329669952393
Epoch: 20, Steps: 12 | Train Loss: 1.340 Vali Loss: 1.430 Vali Acc: 0.672 Test Loss: 1.430 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.3047096729278564
Epoch: 21, Steps: 12 | Train Loss: 1.199 Vali Loss: 1.373 Vali Acc: 0.694 Test Loss: 1.373 Test Acc: 0.694
Validation loss decreased (-0.683318 --> -0.694431).  Saving model ...
Epoch: 22 cost time: 2.0007030963897705
Epoch: 22, Steps: 12 | Train Loss: 1.209 Vali Loss: 1.318 Vali Acc: 0.700 Test Loss: 1.318 Test Acc: 0.700
Validation loss decreased (-0.694431 --> -0.699987).  Saving model ...
Epoch: 23 cost time: 1.9106829166412354
Epoch: 23, Steps: 12 | Train Loss: 1.147 Vali Loss: 1.264 Vali Acc: 0.689 Test Loss: 1.264 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8027031421661377
Epoch: 24, Steps: 12 | Train Loss: 1.033 Vali Loss: 1.211 Vali Acc: 0.711 Test Loss: 1.211 Test Acc: 0.711
Validation loss decreased (-0.699987 --> -0.711099).  Saving model ...
Epoch: 25 cost time: 1.9627549648284912
Epoch: 25, Steps: 12 | Train Loss: 1.068 Vali Loss: 1.159 Vali Acc: 0.717 Test Loss: 1.159 Test Acc: 0.717
Validation loss decreased (-0.711099 --> -0.716655).  Saving model ...
Epoch: 26 cost time: 2.221792697906494
Epoch: 26, Steps: 12 | Train Loss: 0.972 Vali Loss: 1.123 Vali Acc: 0.717 Test Loss: 1.123 Test Acc: 0.717
Validation loss decreased (-0.716655 --> -0.716655).  Saving model ...
Epoch: 27 cost time: 2.277596950531006
Epoch: 27, Steps: 12 | Train Loss: 0.942 Vali Loss: 1.097 Vali Acc: 0.728 Test Loss: 1.097 Test Acc: 0.728
Validation loss decreased (-0.716655 --> -0.727767).  Saving model ...
Epoch: 28 cost time: 1.9727578163146973
Epoch: 28, Steps: 12 | Train Loss: 0.900 Vali Loss: 1.026 Vali Acc: 0.733 Test Loss: 1.026 Test Acc: 0.733
Validation loss decreased (-0.727767 --> -0.733323).  Saving model ...
Epoch: 29 cost time: 1.7714359760284424
Epoch: 29, Steps: 12 | Train Loss: 0.811 Vali Loss: 1.004 Vali Acc: 0.722 Test Loss: 1.004 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.973999261856079
Epoch: 30, Steps: 12 | Train Loss: 0.760 Vali Loss: 0.944 Vali Acc: 0.761 Test Loss: 0.944 Test Acc: 0.761
Validation loss decreased (-0.733323 --> -0.761102).  Saving model ...
Epoch: 31 cost time: 2.1895668506622314
Epoch: 31, Steps: 12 | Train Loss: 0.746 Vali Loss: 0.905 Vali Acc: 0.750 Test Loss: 0.905 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.2048563957214355
Epoch: 32, Steps: 12 | Train Loss: 0.675 Vali Loss: 0.871 Vali Acc: 0.772 Test Loss: 0.871 Test Acc: 0.772
Validation loss decreased (-0.761102 --> -0.772214).  Saving model ...
Epoch: 33 cost time: 2.448110818862915
Epoch: 33, Steps: 12 | Train Loss: 0.659 Vali Loss: 0.833 Vali Acc: 0.794 Test Loss: 0.833 Test Acc: 0.794
Validation loss decreased (-0.772214 --> -0.794436).  Saving model ...
Epoch: 34 cost time: 1.5185215473175049
Epoch: 34, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.828 Vali Acc: 0.783 Test Loss: 0.828 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.815824031829834
Epoch: 35, Steps: 12 | Train Loss: 0.603 Vali Loss: 0.773 Vali Acc: 0.789 Test Loss: 0.773 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.1409237384796143
Epoch: 36, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.766 Vali Acc: 0.811 Test Loss: 0.766 Test Acc: 0.811
Validation loss decreased (-0.794436 --> -0.811103).  Saving model ...
Epoch: 37 cost time: 1.8190388679504395
Epoch: 37, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.734 Vali Acc: 0.822 Test Loss: 0.734 Test Acc: 0.822
Validation loss decreased (-0.811103 --> -0.822215).  Saving model ...
Epoch: 38 cost time: 1.8962368965148926
Epoch: 38, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.722 Vali Acc: 0.783 Test Loss: 0.722 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.9933903217315674
Epoch: 39, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.695 Vali Acc: 0.794 Test Loss: 0.695 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.8851134777069092
Epoch: 40, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.654 Vali Acc: 0.828 Test Loss: 0.654 Test Acc: 0.828
Validation loss decreased (-0.822215 --> -0.827771).  Saving model ...
Epoch: 41 cost time: 1.8733317852020264
Epoch: 41, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.656 Vali Acc: 0.806 Test Loss: 0.656 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.7328484058380127
Epoch: 42, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.624 Vali Acc: 0.828 Test Loss: 0.624 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827772).  Saving model ...
Epoch: 43 cost time: 1.647557020187378
Epoch: 43, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.622 Vali Acc: 0.833 Test Loss: 0.622 Test Acc: 0.833
Validation loss decreased (-0.827772 --> -0.833327).  Saving model ...
Epoch: 44 cost time: 2.122039318084717
Epoch: 44, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.618 Vali Acc: 0.828 Test Loss: 0.618 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.832406759262085
Epoch: 45, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.566 Vali Acc: 0.856 Test Loss: 0.566 Test Acc: 0.856
Validation loss decreased (-0.833327 --> -0.855550).  Saving model ...
Epoch: 46 cost time: 1.917123556137085
Epoch: 46, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.603 Vali Acc: 0.828 Test Loss: 0.603 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.0691888332366943
Epoch: 47, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.568 Vali Acc: 0.822 Test Loss: 0.568 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 2.0117592811584473
Epoch: 48, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.563 Vali Acc: 0.844 Test Loss: 0.563 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 2.0035769939422607
Epoch: 49, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.560 Vali Acc: 0.844 Test Loss: 0.560 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 2.1038427352905273
Epoch: 50, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.539 Vali Acc: 0.844 Test Loss: 0.539 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 2.0343210697174072
Epoch: 51, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.527 Vali Acc: 0.839 Test Loss: 0.527 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 2.108315944671631
Epoch: 52, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.563 Vali Acc: 0.817 Test Loss: 0.563 Test Acc: 0.817
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.9802792072296143
Epoch: 53, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.553 Vali Acc: 0.822 Test Loss: 0.553 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.8994140625
Epoch: 54, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.9633276462554932
Epoch: 55, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.563 Vali Acc: 0.811 Test Loss: 0.563 Test Acc: 0.811
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 182943
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2334442138671875
Epoch: 1, Steps: 12 | Train Loss: 2.841 Vali Loss: 2.606 Vali Acc: 0.167 Test Loss: 2.606 Test Acc: 0.167
Validation loss decreased (inf --> -0.166641).  Saving model ...
Epoch: 2 cost time: 1.259382724761963
Epoch: 2, Steps: 12 | Train Loss: 2.525 Vali Loss: 2.284 Vali Acc: 0.389 Test Loss: 2.284 Test Acc: 0.389
Validation loss decreased (-0.166641 --> -0.388866).  Saving model ...
Epoch: 3 cost time: 1.446413278579712
Epoch: 3, Steps: 12 | Train Loss: 2.112 Vali Loss: 1.897 Vali Acc: 0.506 Test Loss: 1.897 Test Acc: 0.506
Validation loss decreased (-0.388866 --> -0.505537).  Saving model ...
Epoch: 4 cost time: 1.557478904724121
Epoch: 4, Steps: 12 | Train Loss: 1.658 Vali Loss: 1.605 Vali Acc: 0.556 Test Loss: 1.605 Test Acc: 0.556
Validation loss decreased (-0.505537 --> -0.555540).  Saving model ...
Epoch: 5 cost time: 1.61476469039917
Epoch: 5, Steps: 12 | Train Loss: 1.426 Vali Loss: 1.380 Vali Acc: 0.606 Test Loss: 1.380 Test Acc: 0.606
Validation loss decreased (-0.555540 --> -0.605542).  Saving model ...
Epoch: 6 cost time: 1.270005464553833
Epoch: 6, Steps: 12 | Train Loss: 1.106 Vali Loss: 1.195 Vali Acc: 0.622 Test Loss: 1.195 Test Acc: 0.622
Validation loss decreased (-0.605542 --> -0.622210).  Saving model ...
Epoch: 7 cost time: 1.3314566612243652
Epoch: 7, Steps: 12 | Train Loss: 0.896 Vali Loss: 1.030 Vali Acc: 0.717 Test Loss: 1.030 Test Acc: 0.717
Validation loss decreased (-0.622210 --> -0.716656).  Saving model ...
Epoch: 8 cost time: 1.1495015621185303
Epoch: 8, Steps: 12 | Train Loss: 0.690 Vali Loss: 0.886 Vali Acc: 0.711 Test Loss: 0.886 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4978456497192383
Epoch: 9, Steps: 12 | Train Loss: 0.612 Vali Loss: 0.776 Vali Acc: 0.783 Test Loss: 0.776 Test Acc: 0.783
Validation loss decreased (-0.716656 --> -0.783326).  Saving model ...
Epoch: 10 cost time: 1.4959263801574707
Epoch: 10, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.767 Vali Acc: 0.767 Test Loss: 0.767 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5032665729522705
Epoch: 11, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.665 Vali Acc: 0.833 Test Loss: 0.665 Test Acc: 0.833
Validation loss decreased (-0.783326 --> -0.833327).  Saving model ...
Epoch: 12 cost time: 1.5431149005889893
Epoch: 12, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.596 Vali Acc: 0.839 Test Loss: 0.596 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 13 cost time: 1.1802935600280762
Epoch: 13, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.543 Vali Acc: 0.839 Test Loss: 0.543 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 14 cost time: 1.2665629386901855
Epoch: 14, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.579 Vali Acc: 0.867 Test Loss: 0.579 Test Acc: 0.867
Validation loss decreased (-0.838883 --> -0.866661).  Saving model ...
Epoch: 15 cost time: 1.106990098953247
Epoch: 15, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.615 Vali Acc: 0.806 Test Loss: 0.615 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1580359935760498
Epoch: 16, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.598 Vali Acc: 0.867 Test Loss: 0.598 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3526597023010254
Epoch: 17, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.638 Vali Acc: 0.856 Test Loss: 0.638 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3408010005950928
Epoch: 18, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.542 Vali Acc: 0.850 Test Loss: 0.542 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.202589988708496
Epoch: 19, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.613 Vali Acc: 0.867 Test Loss: 0.613 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3435649871826172
Epoch: 20, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.676 Vali Acc: 0.839 Test Loss: 0.676 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.4121167659759521
Epoch: 21, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.586 Vali Acc: 0.861 Test Loss: 0.586 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1869306564331055
Epoch: 22, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.509 Vali Acc: 0.867 Test Loss: 0.509 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866662).  Saving model ...
Epoch: 23 cost time: 1.1880624294281006
Epoch: 23, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.637 Vali Acc: 0.878 Test Loss: 0.637 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877771).  Saving model ...
Epoch: 24 cost time: 1.3473565578460693
Epoch: 24, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.595 Vali Acc: 0.872 Test Loss: 0.595 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.589599609375
Epoch: 25, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.660 Vali Acc: 0.861 Test Loss: 0.660 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3507051467895508
Epoch: 26, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.635 Vali Acc: 0.856 Test Loss: 0.635 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.3683662414550781
Epoch: 27, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.669 Vali Acc: 0.878 Test Loss: 0.669 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.4607746601104736
Epoch: 28, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.685 Vali Acc: 0.878 Test Loss: 0.685 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.427220106124878
Epoch: 29, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.697 Vali Acc: 0.878 Test Loss: 0.697 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.2815606594085693
Epoch: 30, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.755 Vali Acc: 0.861 Test Loss: 0.755 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.3203966617584229
Epoch: 31, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.720 Vali Acc: 0.861 Test Loss: 0.720 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.2942323684692383
Epoch: 32, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.712 Vali Acc: 0.861 Test Loss: 0.712 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.6591157913208008
Epoch: 33, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.729 Vali Acc: 0.856 Test Loss: 0.729 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 7942963
model size : 35.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.642219305038452
Epoch: 1, Steps: 12 | Train Loss: 2.774 Vali Loss: 2.610 Vali Acc: 0.156 Test Loss: 2.610 Test Acc: 0.156
Validation loss decreased (inf --> -0.155529).  Saving model ...
Epoch: 2 cost time: 2.0629000663757324
Epoch: 2, Steps: 12 | Train Loss: 2.476 Vali Loss: 2.315 Vali Acc: 0.294 Test Loss: 2.315 Test Acc: 0.294
Validation loss decreased (-0.155529 --> -0.294421).  Saving model ...
Epoch: 3 cost time: 1.8246831893920898
Epoch: 3, Steps: 12 | Train Loss: 2.146 Vali Loss: 1.997 Vali Acc: 0.494 Test Loss: 1.997 Test Acc: 0.494
Validation loss decreased (-0.294421 --> -0.494424).  Saving model ...
Epoch: 4 cost time: 1.9059500694274902
Epoch: 4, Steps: 12 | Train Loss: 1.729 Vali Loss: 1.648 Vali Acc: 0.528 Test Loss: 1.648 Test Acc: 0.528
Validation loss decreased (-0.494424 --> -0.527761).  Saving model ...
Epoch: 5 cost time: 1.534339427947998
Epoch: 5, Steps: 12 | Train Loss: 1.373 Vali Loss: 1.398 Vali Acc: 0.572 Test Loss: 1.398 Test Acc: 0.572
Validation loss decreased (-0.527761 --> -0.572208).  Saving model ...
Epoch: 6 cost time: 1.6961116790771484
Epoch: 6, Steps: 12 | Train Loss: 1.137 Vali Loss: 1.226 Vali Acc: 0.650 Test Loss: 1.226 Test Acc: 0.650
Validation loss decreased (-0.572208 --> -0.649988).  Saving model ...
Epoch: 7 cost time: 1.8885204792022705
Epoch: 7, Steps: 12 | Train Loss: 0.933 Vali Loss: 0.992 Vali Acc: 0.672 Test Loss: 0.992 Test Acc: 0.672
Validation loss decreased (-0.649988 --> -0.672212).  Saving model ...
Epoch: 8 cost time: 1.3150880336761475
Epoch: 8, Steps: 12 | Train Loss: 0.753 Vali Loss: 0.974 Vali Acc: 0.678 Test Loss: 0.974 Test Acc: 0.678
Validation loss decreased (-0.672212 --> -0.677768).  Saving model ...
Epoch: 9 cost time: 1.6340703964233398
Epoch: 9, Steps: 12 | Train Loss: 0.668 Vali Loss: 0.809 Vali Acc: 0.756 Test Loss: 0.809 Test Acc: 0.756
Validation loss decreased (-0.677768 --> -0.755547).  Saving model ...
Epoch: 10 cost time: 1.3760039806365967
Epoch: 10, Steps: 12 | Train Loss: 0.576 Vali Loss: 0.742 Vali Acc: 0.756 Test Loss: 0.742 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755548).  Saving model ...
Epoch: 11 cost time: 1.7109594345092773
Epoch: 11, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.687 Vali Acc: 0.794 Test Loss: 0.687 Test Acc: 0.794
Validation loss decreased (-0.755548 --> -0.794438).  Saving model ...
Epoch: 12 cost time: 1.7662038803100586
Epoch: 12, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.697 Vali Acc: 0.778 Test Loss: 0.697 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.68943452835083
Epoch: 13, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.565 Vali Acc: 0.822 Test Loss: 0.565 Test Acc: 0.822
Validation loss decreased (-0.794438 --> -0.822217).  Saving model ...
Epoch: 14 cost time: 1.3978018760681152
Epoch: 14, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.514 Vali Acc: 0.839 Test Loss: 0.514 Test Acc: 0.839
Validation loss decreased (-0.822217 --> -0.838884).  Saving model ...
Epoch: 15 cost time: 1.7180185317993164
Epoch: 15, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.758 Vali Acc: 0.767 Test Loss: 0.758 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4047129154205322
Epoch: 16, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.563 Vali Acc: 0.822 Test Loss: 0.563 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5236730575561523
Epoch: 17, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.499 Vali Acc: 0.867 Test Loss: 0.499 Test Acc: 0.867
Validation loss decreased (-0.838884 --> -0.866662).  Saving model ...
Epoch: 18 cost time: 1.6750152111053467
Epoch: 18, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.669 Vali Acc: 0.833 Test Loss: 0.669 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5485990047454834
Epoch: 19, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.554 Vali Acc: 0.867 Test Loss: 0.554 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5373432636260986
Epoch: 20, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.510 Vali Acc: 0.850 Test Loss: 0.510 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6358304023742676
Epoch: 21, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.612 Vali Acc: 0.878 Test Loss: 0.612 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877772).  Saving model ...
Epoch: 22 cost time: 1.4192602634429932
Epoch: 22, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.565 Vali Acc: 0.889 Test Loss: 0.565 Test Acc: 0.889
Validation loss decreased (-0.877772 --> -0.888883).  Saving model ...
Epoch: 23 cost time: 1.4808783531188965
Epoch: 23, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.596 Vali Acc: 0.883 Test Loss: 0.596 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5696485042572021
Epoch: 24, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.562 Vali Acc: 0.867 Test Loss: 0.562 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6583950519561768
Epoch: 25, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.606 Vali Acc: 0.861 Test Loss: 0.606 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6453499794006348
Epoch: 26, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.589 Vali Acc: 0.872 Test Loss: 0.589 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.7423415184020996
Epoch: 27, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.591 Vali Acc: 0.878 Test Loss: 0.591 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.1822450160980225
Epoch: 28, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.581 Vali Acc: 0.883 Test Loss: 0.581 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.7916626930236816
Epoch: 29, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.599 Vali Acc: 0.878 Test Loss: 0.599 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.0164074897766113
Epoch: 30, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.572 Vali Acc: 0.883 Test Loss: 0.572 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.4803054332733154
Epoch: 31, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.581 Vali Acc: 0.889 Test Loss: 0.581 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.4751014709472656
Epoch: 32, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.594 Vali Acc: 0.878 Test Loss: 0.594 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 7941427
model size : 35.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.388002395629883
Epoch: 1, Steps: 12 | Train Loss: 2.836 Vali Loss: 2.625 Vali Acc: 0.100 Test Loss: 2.625 Test Acc: 0.100
Validation loss decreased (inf --> -0.099974).  Saving model ...
Epoch: 2 cost time: 1.5039119720458984
Epoch: 2, Steps: 12 | Train Loss: 2.585 Vali Loss: 2.332 Vali Acc: 0.383 Test Loss: 2.332 Test Acc: 0.383
Validation loss decreased (-0.099974 --> -0.383310).  Saving model ...
Epoch: 3 cost time: 1.538219928741455
Epoch: 3, Steps: 12 | Train Loss: 2.120 Vali Loss: 1.933 Vali Acc: 0.500 Test Loss: 1.933 Test Acc: 0.500
Validation loss decreased (-0.383310 --> -0.499981).  Saving model ...
Epoch: 4 cost time: 1.8476331233978271
Epoch: 4, Steps: 12 | Train Loss: 1.733 Vali Loss: 1.642 Vali Acc: 0.522 Test Loss: 1.642 Test Acc: 0.522
Validation loss decreased (-0.499981 --> -0.522206).  Saving model ...
Epoch: 5 cost time: 1.6263048648834229
Epoch: 5, Steps: 12 | Train Loss: 1.396 Vali Loss: 1.434 Vali Acc: 0.561 Test Loss: 1.434 Test Acc: 0.561
Validation loss decreased (-0.522206 --> -0.561097).  Saving model ...
Epoch: 6 cost time: 1.534872055053711
Epoch: 6, Steps: 12 | Train Loss: 1.082 Vali Loss: 1.247 Vali Acc: 0.633 Test Loss: 1.247 Test Acc: 0.633
Validation loss decreased (-0.561097 --> -0.633321).  Saving model ...
Epoch: 7 cost time: 1.5002806186676025
Epoch: 7, Steps: 12 | Train Loss: 0.924 Vali Loss: 1.100 Vali Acc: 0.589 Test Loss: 1.100 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.654942512512207
Epoch: 8, Steps: 12 | Train Loss: 0.758 Vali Loss: 0.936 Vali Acc: 0.706 Test Loss: 0.936 Test Acc: 0.706
Validation loss decreased (-0.633321 --> -0.705546).  Saving model ...
Epoch: 9 cost time: 1.3939871788024902
Epoch: 9, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.789 Vali Acc: 0.772 Test Loss: 0.789 Test Acc: 0.772
Validation loss decreased (-0.705546 --> -0.772214).  Saving model ...
Epoch: 10 cost time: 1.5097956657409668
Epoch: 10, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.910 Vali Acc: 0.717 Test Loss: 0.910 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5322303771972656
Epoch: 11, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.685 Vali Acc: 0.789 Test Loss: 0.685 Test Acc: 0.789
Validation loss decreased (-0.772214 --> -0.788882).  Saving model ...
Epoch: 12 cost time: 1.2943115234375
Epoch: 12, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.638 Vali Acc: 0.839 Test Loss: 0.638 Test Acc: 0.839
Validation loss decreased (-0.788882 --> -0.838883).  Saving model ...
Epoch: 13 cost time: 1.3240973949432373
Epoch: 13, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.569 Vali Acc: 0.817 Test Loss: 0.569 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.690657615661621
Epoch: 14, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.642 Vali Acc: 0.811 Test Loss: 0.642 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6159908771514893
Epoch: 15, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.502 Vali Acc: 0.844 Test Loss: 0.502 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 16 cost time: 1.7744696140289307
Epoch: 16, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.511 Vali Acc: 0.889 Test Loss: 0.511 Test Acc: 0.889
Validation loss decreased (-0.844439 --> -0.888884).  Saving model ...
Epoch: 17 cost time: 1.5394439697265625
Epoch: 17, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.525 Vali Acc: 0.889 Test Loss: 0.525 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4982337951660156
Epoch: 18, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.538 Vali Acc: 0.872 Test Loss: 0.538 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3945250511169434
Epoch: 19, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.622 Vali Acc: 0.856 Test Loss: 0.622 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4788222312927246
Epoch: 20, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.561 Vali Acc: 0.861 Test Loss: 0.561 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.9036319255828857
Epoch: 21, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.590 Vali Acc: 0.861 Test Loss: 0.590 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.5888762474060059
Epoch: 22, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.561 Vali Acc: 0.872 Test Loss: 0.561 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.7539904117584229
Epoch: 23, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.652 Vali Acc: 0.867 Test Loss: 0.652 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.2455718517303467
Epoch: 24, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.559 Vali Acc: 0.878 Test Loss: 0.559 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.5903522968292236
Epoch: 25, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.613 Vali Acc: 0.867 Test Loss: 0.613 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.480536699295044
Epoch: 26, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.628 Vali Acc: 0.867 Test Loss: 0.628 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 7939891
model size : 35.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.351747035980225
Epoch: 1, Steps: 12 | Train Loss: 2.856 Vali Loss: 2.637 Vali Acc: 0.100 Test Loss: 2.637 Test Acc: 0.100
Validation loss decreased (inf --> -0.099974).  Saving model ...
Epoch: 2 cost time: 1.4561045169830322
Epoch: 2, Steps: 12 | Train Loss: 2.540 Vali Loss: 2.320 Vali Acc: 0.361 Test Loss: 2.320 Test Acc: 0.361
Validation loss decreased (-0.099974 --> -0.361088).  Saving model ...
Epoch: 3 cost time: 1.4628028869628906
Epoch: 3, Steps: 12 | Train Loss: 2.195 Vali Loss: 1.964 Vali Acc: 0.517 Test Loss: 1.964 Test Acc: 0.517
Validation loss decreased (-0.361088 --> -0.516647).  Saving model ...
Epoch: 4 cost time: 1.5672142505645752
Epoch: 4, Steps: 12 | Train Loss: 1.669 Vali Loss: 1.666 Vali Acc: 0.533 Test Loss: 1.666 Test Acc: 0.533
Validation loss decreased (-0.516647 --> -0.533317).  Saving model ...
Epoch: 5 cost time: 1.4806663990020752
Epoch: 5, Steps: 12 | Train Loss: 1.335 Vali Loss: 1.423 Vali Acc: 0.589 Test Loss: 1.423 Test Acc: 0.589
Validation loss decreased (-0.533317 --> -0.588875).  Saving model ...
Epoch: 6 cost time: 1.4644205570220947
Epoch: 6, Steps: 12 | Train Loss: 1.162 Vali Loss: 1.180 Vali Acc: 0.650 Test Loss: 1.180 Test Acc: 0.650
Validation loss decreased (-0.588875 --> -0.649988).  Saving model ...
Epoch: 7 cost time: 1.2890331745147705
Epoch: 7, Steps: 12 | Train Loss: 0.996 Vali Loss: 1.060 Vali Acc: 0.656 Test Loss: 1.060 Test Acc: 0.656
Validation loss decreased (-0.649988 --> -0.655545).  Saving model ...
Epoch: 8 cost time: 1.2720978260040283
Epoch: 8, Steps: 12 | Train Loss: 0.838 Vali Loss: 0.937 Vali Acc: 0.733 Test Loss: 0.937 Test Acc: 0.733
Validation loss decreased (-0.655545 --> -0.733324).  Saving model ...
Epoch: 9 cost time: 1.3203191757202148
Epoch: 9, Steps: 12 | Train Loss: 0.684 Vali Loss: 1.003 Vali Acc: 0.672 Test Loss: 1.003 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4830939769744873
Epoch: 10, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.701 Vali Acc: 0.794 Test Loss: 0.701 Test Acc: 0.794
Validation loss decreased (-0.733324 --> -0.794437).  Saving model ...
Epoch: 11 cost time: 1.5349147319793701
Epoch: 11, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.640 Vali Acc: 0.811 Test Loss: 0.640 Test Acc: 0.811
Validation loss decreased (-0.794437 --> -0.811105).  Saving model ...
Epoch: 12 cost time: 1.5784566402435303
Epoch: 12, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.786 Vali Acc: 0.756 Test Loss: 0.786 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.532027006149292
Epoch: 13, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.582 Vali Acc: 0.822 Test Loss: 0.582 Test Acc: 0.822
Validation loss decreased (-0.811105 --> -0.822216).  Saving model ...
Epoch: 14 cost time: 1.3417954444885254
Epoch: 14, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.632 Vali Acc: 0.817 Test Loss: 0.632 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6023516654968262
Epoch: 15, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.633 Vali Acc: 0.856 Test Loss: 0.633 Test Acc: 0.856
Validation loss decreased (-0.822216 --> -0.855549).  Saving model ...
Epoch: 16 cost time: 1.6363627910614014
Epoch: 16, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.563 Vali Acc: 0.878 Test Loss: 0.563 Test Acc: 0.878
Validation loss decreased (-0.855549 --> -0.877772).  Saving model ...
Epoch: 17 cost time: 1.4622595310211182
Epoch: 17, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.636 Vali Acc: 0.839 Test Loss: 0.636 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6082677841186523
Epoch: 18, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.553 Vali Acc: 0.850 Test Loss: 0.553 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6123871803283691
Epoch: 19, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.673 Vali Acc: 0.850 Test Loss: 0.673 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3152673244476318
Epoch: 20, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.543 Vali Acc: 0.844 Test Loss: 0.543 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.437859058380127
Epoch: 21, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.671 Vali Acc: 0.867 Test Loss: 0.671 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.4221878051757812
Epoch: 22, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.612 Vali Acc: 0.867 Test Loss: 0.612 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.92478346824646
Epoch: 23, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.563 Vali Acc: 0.867 Test Loss: 0.563 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.438950538635254
Epoch: 24, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.574 Vali Acc: 0.872 Test Loss: 0.574 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.7975349426269531
Epoch: 25, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.745 Vali Acc: 0.833 Test Loss: 0.745 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.2533495426177979
Epoch: 26, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.767 Vali Acc: 0.822 Test Loss: 0.767 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 7938355
model size : 35.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1773712635040283
Epoch: 1, Steps: 12 | Train Loss: 2.858 Vali Loss: 2.635 Vali Acc: 0.133 Test Loss: 2.635 Test Acc: 0.133
Validation loss decreased (inf --> -0.133307).  Saving model ...
Epoch: 2 cost time: 1.3869388103485107
Epoch: 2, Steps: 12 | Train Loss: 2.580 Vali Loss: 2.353 Vali Acc: 0.356 Test Loss: 2.353 Test Acc: 0.356
Validation loss decreased (-0.133307 --> -0.355532).  Saving model ...
Epoch: 3 cost time: 1.41758394241333
Epoch: 3, Steps: 12 | Train Loss: 2.269 Vali Loss: 2.028 Vali Acc: 0.483 Test Loss: 2.028 Test Acc: 0.483
Validation loss decreased (-0.355532 --> -0.483313).  Saving model ...
Epoch: 4 cost time: 1.4472253322601318
Epoch: 4, Steps: 12 | Train Loss: 1.824 Vali Loss: 1.716 Vali Acc: 0.544 Test Loss: 1.716 Test Acc: 0.544
Validation loss decreased (-0.483313 --> -0.544427).  Saving model ...
Epoch: 5 cost time: 1.9341719150543213
Epoch: 5, Steps: 12 | Train Loss: 1.538 Vali Loss: 1.428 Vali Acc: 0.617 Test Loss: 1.428 Test Acc: 0.617
Validation loss decreased (-0.544427 --> -0.616652).  Saving model ...
Epoch: 6 cost time: 1.6801631450653076
Epoch: 6, Steps: 12 | Train Loss: 1.272 Vali Loss: 1.304 Vali Acc: 0.589 Test Loss: 1.304 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4744412899017334
Epoch: 7, Steps: 12 | Train Loss: 1.013 Vali Loss: 1.077 Vali Acc: 0.617 Test Loss: 1.077 Test Acc: 0.617
Validation loss decreased (-0.616652 --> -0.616656).  Saving model ...
Epoch: 8 cost time: 1.5175254344940186
Epoch: 8, Steps: 12 | Train Loss: 0.763 Vali Loss: 0.992 Vali Acc: 0.700 Test Loss: 0.992 Test Acc: 0.700
Validation loss decreased (-0.616656 --> -0.699990).  Saving model ...
Epoch: 9 cost time: 1.274381160736084
Epoch: 9, Steps: 12 | Train Loss: 0.608 Vali Loss: 0.873 Vali Acc: 0.711 Test Loss: 0.873 Test Acc: 0.711
Validation loss decreased (-0.699990 --> -0.711102).  Saving model ...
Epoch: 10 cost time: 1.492525577545166
Epoch: 10, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.872 Vali Acc: 0.706 Test Loss: 0.872 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3834760189056396
Epoch: 11, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.774 Vali Acc: 0.761 Test Loss: 0.774 Test Acc: 0.761
Validation loss decreased (-0.711102 --> -0.761103).  Saving model ...
Epoch: 12 cost time: 1.293882131576538
Epoch: 12, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.719 Vali Acc: 0.783 Test Loss: 0.719 Test Acc: 0.783
Validation loss decreased (-0.761103 --> -0.783326).  Saving model ...
Epoch: 13 cost time: 1.8680458068847656
Epoch: 13, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.684 Vali Acc: 0.772 Test Loss: 0.684 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.547072410583496
Epoch: 14, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.701 Vali Acc: 0.811 Test Loss: 0.701 Test Acc: 0.811
Validation loss decreased (-0.783326 --> -0.811104).  Saving model ...
Epoch: 15 cost time: 1.3494679927825928
Epoch: 15, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.606 Vali Acc: 0.839 Test Loss: 0.606 Test Acc: 0.839
Validation loss decreased (-0.811104 --> -0.838883).  Saving model ...
Epoch: 16 cost time: 1.2980835437774658
Epoch: 16, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.589 Vali Acc: 0.833 Test Loss: 0.589 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.677382469177246
Epoch: 17, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.661 Vali Acc: 0.839 Test Loss: 0.661 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6400277614593506
Epoch: 18, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.633 Vali Acc: 0.856 Test Loss: 0.633 Test Acc: 0.856
Validation loss decreased (-0.838883 --> -0.855549).  Saving model ...
Epoch: 19 cost time: 1.4736037254333496
Epoch: 19, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.601 Vali Acc: 0.878 Test Loss: 0.601 Test Acc: 0.878
Validation loss decreased (-0.855549 --> -0.877772).  Saving model ...
Epoch: 20 cost time: 1.3273043632507324
Epoch: 20, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.554 Vali Acc: 0.872 Test Loss: 0.554 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3286950588226318
Epoch: 21, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.604 Vali Acc: 0.844 Test Loss: 0.604 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2571144104003906
Epoch: 22, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.581 Vali Acc: 0.850 Test Loss: 0.581 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.6100692749023438
Epoch: 23, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.625 Vali Acc: 0.856 Test Loss: 0.625 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.61983060836792
Epoch: 24, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.569 Vali Acc: 0.878 Test Loss: 0.569 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 25 cost time: 1.3517415523529053
Epoch: 25, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.619 Vali Acc: 0.861 Test Loss: 0.619 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5160582065582275
Epoch: 26, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.644 Vali Acc: 0.861 Test Loss: 0.644 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.4764437675476074
Epoch: 27, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.649 Vali Acc: 0.844 Test Loss: 0.649 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.246427297592163
Epoch: 28, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.694 Vali Acc: 0.867 Test Loss: 0.694 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.5515570640563965
Epoch: 29, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.643 Vali Acc: 0.833 Test Loss: 0.643 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.3360168933868408
Epoch: 30, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.718 Vali Acc: 0.856 Test Loss: 0.718 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.5876994132995605
Epoch: 31, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.697 Vali Acc: 0.861 Test Loss: 0.697 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.5078635215759277
Epoch: 32, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.667 Vali Acc: 0.844 Test Loss: 0.667 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.422961950302124
Epoch: 33, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.676 Vali Acc: 0.867 Test Loss: 0.676 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.410813570022583
Epoch: 34, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.723 Vali Acc: 0.861 Test Loss: 0.723 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 6629683
model size : 30.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5778908729553223
Epoch: 1, Steps: 12 | Train Loss: 2.853 Vali Loss: 2.578 Vali Acc: 0.172 Test Loss: 2.578 Test Acc: 0.172
Validation loss decreased (inf --> -0.172196).  Saving model ...
Epoch: 2 cost time: 1.7212915420532227
Epoch: 2, Steps: 12 | Train Loss: 2.542 Vali Loss: 2.306 Vali Acc: 0.389 Test Loss: 2.306 Test Acc: 0.389
Validation loss decreased (-0.172196 --> -0.388866).  Saving model ...
Epoch: 3 cost time: 1.791480302810669
Epoch: 3, Steps: 12 | Train Loss: 2.219 Vali Loss: 1.990 Vali Acc: 0.528 Test Loss: 1.990 Test Acc: 0.528
Validation loss decreased (-0.388866 --> -0.527758).  Saving model ...
Epoch: 4 cost time: 1.4678013324737549
Epoch: 4, Steps: 12 | Train Loss: 1.743 Vali Loss: 1.695 Vali Acc: 0.589 Test Loss: 1.695 Test Acc: 0.589
Validation loss decreased (-0.527758 --> -0.588872).  Saving model ...
Epoch: 5 cost time: 1.5179405212402344
Epoch: 5, Steps: 12 | Train Loss: 1.440 Vali Loss: 1.451 Vali Acc: 0.583 Test Loss: 1.451 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5969939231872559
Epoch: 6, Steps: 12 | Train Loss: 1.131 Vali Loss: 1.254 Vali Acc: 0.600 Test Loss: 1.254 Test Acc: 0.600
Validation loss decreased (-0.588872 --> -0.599987).  Saving model ...
Epoch: 7 cost time: 1.8013663291931152
Epoch: 7, Steps: 12 | Train Loss: 0.999 Vali Loss: 1.101 Vali Acc: 0.672 Test Loss: 1.101 Test Acc: 0.672
Validation loss decreased (-0.599987 --> -0.672211).  Saving model ...
Epoch: 8 cost time: 1.4909946918487549
Epoch: 8, Steps: 12 | Train Loss: 0.829 Vali Loss: 1.006 Vali Acc: 0.683 Test Loss: 1.006 Test Acc: 0.683
Validation loss decreased (-0.672211 --> -0.683323).  Saving model ...
Epoch: 9 cost time: 1.8007497787475586
Epoch: 9, Steps: 12 | Train Loss: 0.703 Vali Loss: 0.941 Vali Acc: 0.694 Test Loss: 0.941 Test Acc: 0.694
Validation loss decreased (-0.683323 --> -0.694435).  Saving model ...
Epoch: 10 cost time: 1.8475615978240967
Epoch: 10, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.799 Vali Acc: 0.772 Test Loss: 0.799 Test Acc: 0.772
Validation loss decreased (-0.694435 --> -0.772214).  Saving model ...
Epoch: 11 cost time: 1.95029616355896
Epoch: 11, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.769 Vali Acc: 0.728 Test Loss: 0.769 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.805298089981079
Epoch: 12, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.661 Vali Acc: 0.828 Test Loss: 0.661 Test Acc: 0.828
Validation loss decreased (-0.772214 --> -0.827771).  Saving model ...
Epoch: 13 cost time: 1.9945712089538574
Epoch: 13, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.621 Vali Acc: 0.828 Test Loss: 0.621 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827772).  Saving model ...
Epoch: 14 cost time: 1.6423909664154053
Epoch: 14, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.581 Vali Acc: 0.867 Test Loss: 0.581 Test Acc: 0.867
Validation loss decreased (-0.827772 --> -0.866661).  Saving model ...
Epoch: 15 cost time: 1.3771469593048096
Epoch: 15, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.609 Vali Acc: 0.861 Test Loss: 0.609 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.844496488571167
Epoch: 16, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.558 Vali Acc: 0.861 Test Loss: 0.558 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9142508506774902
Epoch: 17, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.639 Vali Acc: 0.844 Test Loss: 0.639 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6269657611846924
Epoch: 18, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.557 Vali Acc: 0.872 Test Loss: 0.557 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 19 cost time: 1.5956220626831055
Epoch: 19, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.573 Vali Acc: 0.889 Test Loss: 0.573 Test Acc: 0.889
Validation loss decreased (-0.872217 --> -0.888883).  Saving model ...
Epoch: 20 cost time: 1.5074098110198975
Epoch: 20, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.530 Vali Acc: 0.883 Test Loss: 0.530 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7267425060272217
Epoch: 21, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.571 Vali Acc: 0.872 Test Loss: 0.571 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8178915977478027
Epoch: 22, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.635 Vali Acc: 0.861 Test Loss: 0.635 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.6368000507354736
Epoch: 23, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.569 Vali Acc: 0.878 Test Loss: 0.569 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.647735834121704
Epoch: 24, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.614 Vali Acc: 0.861 Test Loss: 0.614 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.5366270542144775
Epoch: 25, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.649 Vali Acc: 0.850 Test Loss: 0.649 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.6512575149536133
Epoch: 26, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.780 Vali Acc: 0.844 Test Loss: 0.780 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.3559575080871582
Epoch: 27, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.594 Vali Acc: 0.867 Test Loss: 0.594 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.757021188735962
Epoch: 28, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.584 Vali Acc: 0.872 Test Loss: 0.584 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.6973633766174316
Epoch: 29, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.660 Vali Acc: 0.878 Test Loss: 0.660 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 6628147
model size : 30.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.464068651199341
Epoch: 1, Steps: 12 | Train Loss: 2.858 Vali Loss: 2.650 Vali Acc: 0.156 Test Loss: 2.650 Test Acc: 0.156
Validation loss decreased (inf --> -0.155529).  Saving model ...
Epoch: 2 cost time: 1.4715206623077393
Epoch: 2, Steps: 12 | Train Loss: 2.574 Vali Loss: 2.385 Vali Acc: 0.317 Test Loss: 2.385 Test Acc: 0.317
Validation loss decreased (-0.155529 --> -0.316643).  Saving model ...
Epoch: 3 cost time: 1.2231473922729492
Epoch: 3, Steps: 12 | Train Loss: 2.182 Vali Loss: 2.045 Vali Acc: 0.461 Test Loss: 2.045 Test Acc: 0.461
Validation loss decreased (-0.316643 --> -0.461091).  Saving model ...
Epoch: 4 cost time: 1.2771937847137451
Epoch: 4, Steps: 12 | Train Loss: 1.830 Vali Loss: 1.717 Vali Acc: 0.500 Test Loss: 1.717 Test Acc: 0.500
Validation loss decreased (-0.461091 --> -0.499983).  Saving model ...
Epoch: 5 cost time: 1.447690486907959
Epoch: 5, Steps: 12 | Train Loss: 1.464 Vali Loss: 1.457 Vali Acc: 0.561 Test Loss: 1.457 Test Acc: 0.561
Validation loss decreased (-0.499983 --> -0.561097).  Saving model ...
Epoch: 6 cost time: 1.4218964576721191
Epoch: 6, Steps: 12 | Train Loss: 1.279 Vali Loss: 1.220 Vali Acc: 0.628 Test Loss: 1.220 Test Acc: 0.628
Validation loss decreased (-0.561097 --> -0.627766).  Saving model ...
Epoch: 7 cost time: 1.4203202724456787
Epoch: 7, Steps: 12 | Train Loss: 1.017 Vali Loss: 1.105 Vali Acc: 0.622 Test Loss: 1.105 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5815660953521729
Epoch: 8, Steps: 12 | Train Loss: 0.853 Vali Loss: 0.908 Vali Acc: 0.700 Test Loss: 0.908 Test Acc: 0.700
Validation loss decreased (-0.627766 --> -0.699991).  Saving model ...
Epoch: 9 cost time: 1.764838695526123
Epoch: 9, Steps: 12 | Train Loss: 0.644 Vali Loss: 0.788 Vali Acc: 0.744 Test Loss: 0.788 Test Acc: 0.744
Validation loss decreased (-0.699991 --> -0.744437).  Saving model ...
Epoch: 10 cost time: 1.3554232120513916
Epoch: 10, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.727 Vali Acc: 0.767 Test Loss: 0.727 Test Acc: 0.767
Validation loss decreased (-0.744437 --> -0.766659).  Saving model ...
Epoch: 11 cost time: 1.6053671836853027
Epoch: 11, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.690 Vali Acc: 0.767 Test Loss: 0.690 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766660).  Saving model ...
Epoch: 12 cost time: 1.636564016342163
Epoch: 12, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.700 Vali Acc: 0.794 Test Loss: 0.700 Test Acc: 0.794
Validation loss decreased (-0.766660 --> -0.794437).  Saving model ...
Epoch: 13 cost time: 1.5687668323516846
Epoch: 13, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.583 Vali Acc: 0.811 Test Loss: 0.583 Test Acc: 0.811
Validation loss decreased (-0.794437 --> -0.811105).  Saving model ...
Epoch: 14 cost time: 1.358891248703003
Epoch: 14, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.543 Vali Acc: 0.839 Test Loss: 0.543 Test Acc: 0.839
Validation loss decreased (-0.811105 --> -0.838883).  Saving model ...
Epoch: 15 cost time: 1.86940336227417
Epoch: 15, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.510 Vali Acc: 0.861 Test Loss: 0.510 Test Acc: 0.861
Validation loss decreased (-0.838883 --> -0.861106).  Saving model ...
Epoch: 16 cost time: 1.993311882019043
Epoch: 16, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.467 Vali Acc: 0.856 Test Loss: 0.467 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7194318771362305
Epoch: 17, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.477 Vali Acc: 0.872 Test Loss: 0.477 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 18 cost time: 1.542207956314087
Epoch: 18, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.527 Vali Acc: 0.833 Test Loss: 0.527 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.493743896484375
Epoch: 19, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.554 Vali Acc: 0.833 Test Loss: 0.554 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4728071689605713
Epoch: 20, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.646 Vali Acc: 0.817 Test Loss: 0.646 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.616222858428955
Epoch: 21, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.601 Vali Acc: 0.844 Test Loss: 0.601 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.3471393585205078
Epoch: 22, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.534 Vali Acc: 0.878 Test Loss: 0.534 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 23 cost time: 1.3982009887695312
Epoch: 23, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.550 Vali Acc: 0.872 Test Loss: 0.550 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.404456377029419
Epoch: 24, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.504 Vali Acc: 0.894 Test Loss: 0.504 Test Acc: 0.894
Validation loss decreased (-0.877772 --> -0.894439).  Saving model ...
Epoch: 25 cost time: 1.8594021797180176
Epoch: 25, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.555 Vali Acc: 0.883 Test Loss: 0.555 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2256035804748535
Epoch: 26, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.561 Vali Acc: 0.856 Test Loss: 0.561 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.6219468116760254
Epoch: 27, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.528 Vali Acc: 0.878 Test Loss: 0.528 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.6497089862823486
Epoch: 28, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.527 Vali Acc: 0.883 Test Loss: 0.527 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.7971398830413818
Epoch: 29, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.527 Vali Acc: 0.878 Test Loss: 0.527 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.955991506576538
Epoch: 30, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.537 Vali Acc: 0.883 Test Loss: 0.537 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.6944224834442139
Epoch: 31, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.548 Vali Acc: 0.894 Test Loss: 0.548 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.675809383392334
Epoch: 32, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.580 Vali Acc: 0.872 Test Loss: 0.580 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.6885242462158203
Epoch: 33, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.555 Vali Acc: 0.894 Test Loss: 0.555 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.0355544090270996
Epoch: 34, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.552 Vali Acc: 0.883 Test Loss: 0.552 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 6626611
model size : 30.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.860846996307373
Epoch: 1, Steps: 12 | Train Loss: 2.902 Vali Loss: 2.735 Vali Acc: 0.078 Test Loss: 2.735 Test Acc: 0.078
Validation loss decreased (inf --> -0.077750).  Saving model ...
Epoch: 2 cost time: 1.540236473083496
Epoch: 2, Steps: 12 | Train Loss: 2.670 Vali Loss: 2.464 Vali Acc: 0.267 Test Loss: 2.464 Test Acc: 0.267
Validation loss decreased (-0.077750 --> -0.266642).  Saving model ...
Epoch: 3 cost time: 1.3061959743499756
Epoch: 3, Steps: 12 | Train Loss: 2.310 Vali Loss: 2.088 Vali Acc: 0.472 Test Loss: 2.088 Test Acc: 0.472
Validation loss decreased (-0.266642 --> -0.472201).  Saving model ...
Epoch: 4 cost time: 1.4823694229125977
Epoch: 4, Steps: 12 | Train Loss: 1.936 Vali Loss: 1.796 Vali Acc: 0.528 Test Loss: 1.796 Test Acc: 0.528
Validation loss decreased (-0.472201 --> -0.527760).  Saving model ...
Epoch: 5 cost time: 1.4428858757019043
Epoch: 5, Steps: 12 | Train Loss: 1.511 Vali Loss: 1.491 Vali Acc: 0.578 Test Loss: 1.491 Test Acc: 0.578
Validation loss decreased (-0.527760 --> -0.577763).  Saving model ...
Epoch: 6 cost time: 1.9638714790344238
Epoch: 6, Steps: 12 | Train Loss: 1.186 Vali Loss: 1.286 Vali Acc: 0.611 Test Loss: 1.286 Test Acc: 0.611
Validation loss decreased (-0.577763 --> -0.611098).  Saving model ...
Epoch: 7 cost time: 1.6064341068267822
Epoch: 7, Steps: 12 | Train Loss: 1.003 Vali Loss: 1.152 Vali Acc: 0.644 Test Loss: 1.152 Test Acc: 0.644
Validation loss decreased (-0.611098 --> -0.644433).  Saving model ...
Epoch: 8 cost time: 1.4791195392608643
Epoch: 8, Steps: 12 | Train Loss: 0.831 Vali Loss: 1.014 Vali Acc: 0.700 Test Loss: 1.014 Test Acc: 0.700
Validation loss decreased (-0.644433 --> -0.699990).  Saving model ...
Epoch: 9 cost time: 1.5783534049987793
Epoch: 9, Steps: 12 | Train Loss: 0.723 Vali Loss: 1.029 Vali Acc: 0.650 Test Loss: 1.029 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.424027681350708
Epoch: 10, Steps: 12 | Train Loss: 0.576 Vali Loss: 0.861 Vali Acc: 0.717 Test Loss: 0.861 Test Acc: 0.717
Validation loss decreased (-0.699990 --> -0.716658).  Saving model ...
Epoch: 11 cost time: 2.060941696166992
Epoch: 11, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.712 Vali Acc: 0.772 Test Loss: 0.712 Test Acc: 0.772
Validation loss decreased (-0.716658 --> -0.772215).  Saving model ...
Epoch: 12 cost time: 1.6951625347137451
Epoch: 12, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.818 Vali Acc: 0.744 Test Loss: 0.818 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6191751956939697
Epoch: 13, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.690 Vali Acc: 0.828 Test Loss: 0.690 Test Acc: 0.828
Validation loss decreased (-0.772215 --> -0.827771).  Saving model ...
Epoch: 14 cost time: 1.576131820678711
Epoch: 14, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.561 Vali Acc: 0.833 Test Loss: 0.561 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833328).  Saving model ...
Epoch: 15 cost time: 1.6720116138458252
Epoch: 15, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.626 Vali Acc: 0.811 Test Loss: 0.626 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.562044620513916
Epoch: 16, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.478 Vali Acc: 0.867 Test Loss: 0.478 Test Acc: 0.867
Validation loss decreased (-0.833328 --> -0.866662).  Saving model ...
Epoch: 17 cost time: 1.529991626739502
Epoch: 17, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.472 Vali Acc: 0.856 Test Loss: 0.472 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7414860725402832
Epoch: 18, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.540 Vali Acc: 0.861 Test Loss: 0.540 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6272282600402832
Epoch: 19, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.541 Vali Acc: 0.878 Test Loss: 0.541 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877772).  Saving model ...
Epoch: 20 cost time: 1.54390287399292
Epoch: 20, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.570 Vali Acc: 0.872 Test Loss: 0.570 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7193429470062256
Epoch: 21, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.508 Vali Acc: 0.889 Test Loss: 0.508 Test Acc: 0.889
Validation loss decreased (-0.877772 --> -0.888884).  Saving model ...
Epoch: 22 cost time: 1.495434045791626
Epoch: 22, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.579 Vali Acc: 0.867 Test Loss: 0.579 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8135080337524414
Epoch: 23, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.549 Vali Acc: 0.883 Test Loss: 0.549 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.949336051940918
Epoch: 24, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.502 Vali Acc: 0.883 Test Loss: 0.502 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.7473571300506592
Epoch: 25, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.656 Vali Acc: 0.828 Test Loss: 0.656 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.6577343940734863
Epoch: 26, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.761 Vali Acc: 0.839 Test Loss: 0.761 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.4538631439208984
Epoch: 27, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.626 Vali Acc: 0.839 Test Loss: 0.626 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.54258394241333
Epoch: 28, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.550 Vali Acc: 0.867 Test Loss: 0.550 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.684056043624878
Epoch: 29, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.669 Vali Acc: 0.850 Test Loss: 0.669 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.4558844566345215
Epoch: 30, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.627 Vali Acc: 0.856 Test Loss: 0.627 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.4869649410247803
Epoch: 31, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.733 Vali Acc: 0.839 Test Loss: 0.733 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 6625075
model size : 30.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7001585960388184
Epoch: 1, Steps: 12 | Train Loss: 2.905 Vali Loss: 2.672 Vali Acc: 0.122 Test Loss: 2.672 Test Acc: 0.122
Validation loss decreased (inf --> -0.122196).  Saving model ...
Epoch: 2 cost time: 1.414829969406128
Epoch: 2, Steps: 12 | Train Loss: 2.606 Vali Loss: 2.408 Vali Acc: 0.306 Test Loss: 2.408 Test Acc: 0.306
Validation loss decreased (-0.122196 --> -0.305531).  Saving model ...
Epoch: 3 cost time: 1.5239572525024414
Epoch: 3, Steps: 12 | Train Loss: 2.292 Vali Loss: 2.140 Vali Acc: 0.450 Test Loss: 2.140 Test Acc: 0.450
Validation loss decreased (-0.305531 --> -0.449979).  Saving model ...
Epoch: 4 cost time: 1.5901861190795898
Epoch: 4, Steps: 12 | Train Loss: 1.941 Vali Loss: 1.752 Vali Acc: 0.550 Test Loss: 1.752 Test Acc: 0.550
Validation loss decreased (-0.449979 --> -0.549982).  Saving model ...
Epoch: 5 cost time: 1.4950025081634521
Epoch: 5, Steps: 12 | Train Loss: 1.567 Vali Loss: 1.499 Vali Acc: 0.594 Test Loss: 1.499 Test Acc: 0.594
Validation loss decreased (-0.549982 --> -0.594429).  Saving model ...
Epoch: 6 cost time: 1.5857808589935303
Epoch: 6, Steps: 12 | Train Loss: 1.221 Vali Loss: 1.269 Vali Acc: 0.644 Test Loss: 1.269 Test Acc: 0.644
Validation loss decreased (-0.594429 --> -0.644432).  Saving model ...
Epoch: 7 cost time: 1.6766040325164795
Epoch: 7, Steps: 12 | Train Loss: 1.045 Vali Loss: 1.115 Vali Acc: 0.628 Test Loss: 1.115 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.585913896560669
Epoch: 8, Steps: 12 | Train Loss: 0.822 Vali Loss: 0.988 Vali Acc: 0.717 Test Loss: 0.988 Test Acc: 0.717
Validation loss decreased (-0.644432 --> -0.716657).  Saving model ...
Epoch: 9 cost time: 1.3484327793121338
Epoch: 9, Steps: 12 | Train Loss: 0.718 Vali Loss: 0.897 Vali Acc: 0.711 Test Loss: 0.897 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4958162307739258
Epoch: 10, Steps: 12 | Train Loss: 0.555 Vali Loss: 0.789 Vali Acc: 0.689 Test Loss: 0.789 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3857967853546143
Epoch: 11, Steps: 12 | Train Loss: 0.590 Vali Loss: 0.818 Vali Acc: 0.722 Test Loss: 0.818 Test Acc: 0.722
Validation loss decreased (-0.716657 --> -0.722214).  Saving model ...
Epoch: 12 cost time: 1.4968388080596924
Epoch: 12, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.702 Vali Acc: 0.783 Test Loss: 0.702 Test Acc: 0.783
Validation loss decreased (-0.722214 --> -0.783326).  Saving model ...
Epoch: 13 cost time: 1.5150961875915527
Epoch: 13, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.729 Vali Acc: 0.783 Test Loss: 0.729 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4271373748779297
Epoch: 14, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.592 Vali Acc: 0.850 Test Loss: 0.592 Test Acc: 0.850
Validation loss decreased (-0.783326 --> -0.849994).  Saving model ...
Epoch: 15 cost time: 1.6366653442382812
Epoch: 15, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.584 Vali Acc: 0.839 Test Loss: 0.584 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8442192077636719
Epoch: 16, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.606 Vali Acc: 0.833 Test Loss: 0.606 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5601544380187988
Epoch: 17, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.610 Vali Acc: 0.833 Test Loss: 0.610 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4869720935821533
Epoch: 18, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.540 Vali Acc: 0.867 Test Loss: 0.540 Test Acc: 0.867
Validation loss decreased (-0.849994 --> -0.866661).  Saving model ...
Epoch: 19 cost time: 1.5580239295959473
Epoch: 19, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.546 Vali Acc: 0.872 Test Loss: 0.546 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 20 cost time: 1.6435706615447998
Epoch: 20, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.513 Vali Acc: 0.839 Test Loss: 0.513 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4038670063018799
Epoch: 21, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.628 Vali Acc: 0.839 Test Loss: 0.628 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5171840190887451
Epoch: 22, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.552 Vali Acc: 0.861 Test Loss: 0.552 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5683090686798096
Epoch: 23, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.582 Vali Acc: 0.844 Test Loss: 0.582 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.712916374206543
Epoch: 24, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.465 Vali Acc: 0.878 Test Loss: 0.465 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 25 cost time: 1.5827617645263672
Epoch: 25, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.583 Vali Acc: 0.878 Test Loss: 0.583 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5548884868621826
Epoch: 26, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.550 Vali Acc: 0.889 Test Loss: 0.550 Test Acc: 0.889
Validation loss decreased (-0.877773 --> -0.888883).  Saving model ...
Epoch: 27 cost time: 1.5255711078643799
Epoch: 27, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.568 Vali Acc: 0.878 Test Loss: 0.568 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5571608543395996
Epoch: 28, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.591 Vali Acc: 0.883 Test Loss: 0.591 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7430288791656494
Epoch: 29, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.582 Vali Acc: 0.883 Test Loss: 0.582 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.7669341564178467
Epoch: 30, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.589 Vali Acc: 0.883 Test Loss: 0.589 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.6390087604522705
Epoch: 31, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.571 Vali Acc: 0.889 Test Loss: 0.571 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.5933713912963867
Epoch: 32, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.557 Vali Acc: 0.883 Test Loss: 0.557 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.7169678211212158
Epoch: 33, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.609 Vali Acc: 0.889 Test Loss: 0.609 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.853492021560669
Epoch: 34, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.602 Vali Acc: 0.889 Test Loss: 0.602 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.0847327709198
Epoch: 35, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.584 Vali Acc: 0.894 Test Loss: 0.584 Test Acc: 0.894
Validation loss decreased (-0.888883 --> -0.894439).  Saving model ...
Epoch: 36 cost time: 1.3118438720703125
Epoch: 36, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.581 Vali Acc: 0.894 Test Loss: 0.581 Test Acc: 0.894
Validation loss decreased (-0.894439 --> -0.894439).  Saving model ...
Epoch: 37 cost time: 1.6791009902954102
Epoch: 37, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.585 Vali Acc: 0.894 Test Loss: 0.585 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.5948281288146973
Epoch: 38, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.592 Vali Acc: 0.894 Test Loss: 0.592 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.0373735427856445
Epoch: 39, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.596 Vali Acc: 0.889 Test Loss: 0.596 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.6430041790008545
Epoch: 40, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.768 Vali Acc: 0.867 Test Loss: 0.768 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.4473438262939453
Epoch: 41, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.708 Vali Acc: 0.822 Test Loss: 0.708 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.6247797012329102
Epoch: 42, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.679 Vali Acc: 0.844 Test Loss: 0.679 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.5455570220947266
Epoch: 43, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.690 Vali Acc: 0.844 Test Loss: 0.690 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.4204628467559814
Epoch: 44, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.678 Vali Acc: 0.856 Test Loss: 0.678 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.524634599685669
Epoch: 45, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.876 Vali Acc: 0.822 Test Loss: 0.876 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.4289710521697998
Epoch: 46, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.828 Vali Acc: 0.811 Test Loss: 0.828 Test Acc: 0.811
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 5973043
model size : 27.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2422146797180176
Epoch: 1, Steps: 12 | Train Loss: 2.791 Vali Loss: 2.600 Vali Acc: 0.133 Test Loss: 2.600 Test Acc: 0.133
Validation loss decreased (inf --> -0.133307).  Saving model ...
Epoch: 2 cost time: 1.6075823307037354
Epoch: 2, Steps: 12 | Train Loss: 2.542 Vali Loss: 2.334 Vali Acc: 0.322 Test Loss: 2.334 Test Acc: 0.322
Validation loss decreased (-0.133307 --> -0.322199).  Saving model ...
Epoch: 3 cost time: 1.7042615413665771
Epoch: 3, Steps: 12 | Train Loss: 2.231 Vali Loss: 2.046 Vali Acc: 0.428 Test Loss: 2.046 Test Acc: 0.428
Validation loss decreased (-0.322199 --> -0.427757).  Saving model ...
Epoch: 4 cost time: 1.4437508583068848
Epoch: 4, Steps: 12 | Train Loss: 1.933 Vali Loss: 1.759 Vali Acc: 0.539 Test Loss: 1.759 Test Acc: 0.539
Validation loss decreased (-0.427757 --> -0.538871).  Saving model ...
Epoch: 5 cost time: 1.7844328880310059
Epoch: 5, Steps: 12 | Train Loss: 1.516 Vali Loss: 1.430 Vali Acc: 0.611 Test Loss: 1.430 Test Acc: 0.611
Validation loss decreased (-0.538871 --> -0.611097).  Saving model ...
Epoch: 6 cost time: 1.3668584823608398
Epoch: 6, Steps: 12 | Train Loss: 1.238 Vali Loss: 1.245 Vali Acc: 0.611 Test Loss: 1.245 Test Acc: 0.611
Validation loss decreased (-0.611097 --> -0.611099).  Saving model ...
Epoch: 7 cost time: 1.5959968566894531
Epoch: 7, Steps: 12 | Train Loss: 1.006 Vali Loss: 1.139 Vali Acc: 0.628 Test Loss: 1.139 Test Acc: 0.628
Validation loss decreased (-0.611099 --> -0.627766).  Saving model ...
Epoch: 8 cost time: 1.5756893157958984
Epoch: 8, Steps: 12 | Train Loss: 0.827 Vali Loss: 1.003 Vali Acc: 0.678 Test Loss: 1.003 Test Acc: 0.678
Validation loss decreased (-0.627766 --> -0.677768).  Saving model ...
Epoch: 9 cost time: 1.4668376445770264
Epoch: 9, Steps: 12 | Train Loss: 0.670 Vali Loss: 0.851 Vali Acc: 0.761 Test Loss: 0.851 Test Acc: 0.761
Validation loss decreased (-0.677768 --> -0.761103).  Saving model ...
Epoch: 10 cost time: 1.3862011432647705
Epoch: 10, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.777 Vali Acc: 0.756 Test Loss: 0.777 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3317804336547852
Epoch: 11, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.695 Vali Acc: 0.817 Test Loss: 0.695 Test Acc: 0.817
Validation loss decreased (-0.761103 --> -0.816660).  Saving model ...
Epoch: 12 cost time: 1.388763427734375
Epoch: 12, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.741 Vali Acc: 0.772 Test Loss: 0.741 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.371211290359497
Epoch: 13, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.609 Vali Acc: 0.822 Test Loss: 0.609 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 14 cost time: 1.6764798164367676
Epoch: 14, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.685 Vali Acc: 0.806 Test Loss: 0.685 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3925867080688477
Epoch: 15, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.586 Vali Acc: 0.828 Test Loss: 0.586 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827772).  Saving model ...
Epoch: 16 cost time: 1.3766202926635742
Epoch: 16, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.686 Vali Acc: 0.833 Test Loss: 0.686 Test Acc: 0.833
Validation loss decreased (-0.827772 --> -0.833326).  Saving model ...
Epoch: 17 cost time: 1.398531436920166
Epoch: 17, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.703 Vali Acc: 0.867 Test Loss: 0.703 Test Acc: 0.867
Validation loss decreased (-0.833326 --> -0.866660).  Saving model ...
Epoch: 18 cost time: 1.452362298965454
Epoch: 18, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.551 Vali Acc: 0.856 Test Loss: 0.551 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.303556203842163
Epoch: 19, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.533 Vali Acc: 0.861 Test Loss: 0.533 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4284374713897705
Epoch: 20, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.623 Vali Acc: 0.856 Test Loss: 0.623 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.325364351272583
Epoch: 21, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.580 Vali Acc: 0.861 Test Loss: 0.580 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6622960567474365
Epoch: 22, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.578 Vali Acc: 0.856 Test Loss: 0.578 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.3430659770965576
Epoch: 23, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.675 Vali Acc: 0.867 Test Loss: 0.675 Test Acc: 0.867
Validation loss decreased (-0.866660 --> -0.866660).  Saving model ...
Epoch: 24 cost time: 1.3056259155273438
Epoch: 24, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.721 Vali Acc: 0.867 Test Loss: 0.721 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5193424224853516
Epoch: 25, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.682 Vali Acc: 0.833 Test Loss: 0.682 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.356485366821289
Epoch: 26, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.568 Vali Acc: 0.878 Test Loss: 0.568 Test Acc: 0.878
Validation loss decreased (-0.866660 --> -0.877772).  Saving model ...
Epoch: 27 cost time: 1.6443402767181396
Epoch: 27, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.580 Vali Acc: 0.867 Test Loss: 0.580 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4563422203063965
Epoch: 28, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.550 Vali Acc: 0.839 Test Loss: 0.550 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.4795329570770264
Epoch: 29, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.721 Vali Acc: 0.828 Test Loss: 0.721 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4799349308013916
Epoch: 30, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.679 Vali Acc: 0.856 Test Loss: 0.679 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.5566010475158691
Epoch: 31, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.677 Vali Acc: 0.856 Test Loss: 0.677 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.7133474349975586
Epoch: 32, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.705 Vali Acc: 0.839 Test Loss: 0.705 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.5651814937591553
Epoch: 33, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.681 Vali Acc: 0.878 Test Loss: 0.681 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.7881157398223877
Epoch: 34, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.762 Vali Acc: 0.828 Test Loss: 0.762 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.4012916088104248
Epoch: 35, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.567 Vali Acc: 0.856 Test Loss: 0.567 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.645704984664917
Epoch: 36, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.618 Vali Acc: 0.867 Test Loss: 0.618 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 5971507
model size : 27.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.519631862640381
Epoch: 1, Steps: 12 | Train Loss: 2.867 Vali Loss: 2.687 Vali Acc: 0.111 Test Loss: 2.687 Test Acc: 0.111
Validation loss decreased (inf --> -0.111084).  Saving model ...
Epoch: 2 cost time: 1.5655186176300049
Epoch: 2, Steps: 12 | Train Loss: 2.559 Vali Loss: 2.403 Vali Acc: 0.256 Test Loss: 2.403 Test Acc: 0.256
Validation loss decreased (-0.111084 --> -0.255532).  Saving model ...
Epoch: 3 cost time: 1.5408258438110352
Epoch: 3, Steps: 12 | Train Loss: 2.219 Vali Loss: 2.101 Vali Acc: 0.444 Test Loss: 2.101 Test Acc: 0.444
Validation loss decreased (-0.255532 --> -0.444423).  Saving model ...
Epoch: 4 cost time: 1.3503634929656982
Epoch: 4, Steps: 12 | Train Loss: 1.875 Vali Loss: 1.753 Vali Acc: 0.533 Test Loss: 1.753 Test Acc: 0.533
Validation loss decreased (-0.444423 --> -0.533316).  Saving model ...
Epoch: 5 cost time: 1.4673333168029785
Epoch: 5, Steps: 12 | Train Loss: 1.496 Vali Loss: 1.509 Vali Acc: 0.572 Test Loss: 1.509 Test Acc: 0.572
Validation loss decreased (-0.533316 --> -0.572207).  Saving model ...
Epoch: 6 cost time: 1.3425729274749756
Epoch: 6, Steps: 12 | Train Loss: 1.202 Vali Loss: 1.294 Vali Acc: 0.628 Test Loss: 1.294 Test Acc: 0.628
Validation loss decreased (-0.572207 --> -0.627765).  Saving model ...
Epoch: 7 cost time: 1.3817129135131836
Epoch: 7, Steps: 12 | Train Loss: 1.018 Vali Loss: 1.096 Vali Acc: 0.661 Test Loss: 1.096 Test Acc: 0.661
Validation loss decreased (-0.627765 --> -0.661100).  Saving model ...
Epoch: 8 cost time: 1.3755505084991455
Epoch: 8, Steps: 12 | Train Loss: 0.838 Vali Loss: 1.037 Vali Acc: 0.711 Test Loss: 1.037 Test Acc: 0.711
Validation loss decreased (-0.661100 --> -0.711101).  Saving model ...
Epoch: 9 cost time: 1.554863452911377
Epoch: 9, Steps: 12 | Train Loss: 0.714 Vali Loss: 0.890 Vali Acc: 0.717 Test Loss: 0.890 Test Acc: 0.717
Validation loss decreased (-0.711101 --> -0.716658).  Saving model ...
Epoch: 10 cost time: 1.4754173755645752
Epoch: 10, Steps: 12 | Train Loss: 0.582 Vali Loss: 0.814 Vali Acc: 0.722 Test Loss: 0.814 Test Acc: 0.722
Validation loss decreased (-0.716658 --> -0.722214).  Saving model ...
Epoch: 11 cost time: 1.517552375793457
Epoch: 11, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.735 Vali Acc: 0.794 Test Loss: 0.735 Test Acc: 0.794
Validation loss decreased (-0.722214 --> -0.794437).  Saving model ...
Epoch: 12 cost time: 1.529256820678711
Epoch: 12, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.672 Vali Acc: 0.783 Test Loss: 0.672 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.403085470199585
Epoch: 13, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.744 Vali Acc: 0.728 Test Loss: 0.744 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2752318382263184
Epoch: 14, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.604 Vali Acc: 0.828 Test Loss: 0.604 Test Acc: 0.828
Validation loss decreased (-0.794437 --> -0.827772).  Saving model ...
Epoch: 15 cost time: 1.3633954524993896
Epoch: 15, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.616 Vali Acc: 0.811 Test Loss: 0.616 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5142536163330078
Epoch: 16, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.564 Vali Acc: 0.856 Test Loss: 0.564 Test Acc: 0.856
Validation loss decreased (-0.827772 --> -0.855550).  Saving model ...
Epoch: 17 cost time: 1.3255541324615479
Epoch: 17, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.594 Vali Acc: 0.867 Test Loss: 0.594 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 18 cost time: 1.6396675109863281
Epoch: 18, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.531 Vali Acc: 0.850 Test Loss: 0.531 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5532410144805908
Epoch: 19, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.571 Vali Acc: 0.872 Test Loss: 0.571 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 20 cost time: 1.6303730010986328
Epoch: 20, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.555 Vali Acc: 0.861 Test Loss: 0.555 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.540783405303955
Epoch: 21, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.548 Vali Acc: 0.872 Test Loss: 0.548 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 22 cost time: 1.8489534854888916
Epoch: 22, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.541 Vali Acc: 0.872 Test Loss: 0.541 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 23 cost time: 1.5094568729400635
Epoch: 23, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.632 Vali Acc: 0.856 Test Loss: 0.632 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4015767574310303
Epoch: 24, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.645 Vali Acc: 0.856 Test Loss: 0.645 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.7033014297485352
Epoch: 25, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.677 Vali Acc: 0.867 Test Loss: 0.677 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3600378036499023
Epoch: 26, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.688 Vali Acc: 0.856 Test Loss: 0.688 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.275801658630371
Epoch: 27, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.690 Vali Acc: 0.867 Test Loss: 0.690 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.451200008392334
Epoch: 28, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.625 Vali Acc: 0.889 Test Loss: 0.625 Test Acc: 0.889
Validation loss decreased (-0.872217 --> -0.888883).  Saving model ...
Epoch: 29 cost time: 1.3949384689331055
Epoch: 29, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.638 Vali Acc: 0.883 Test Loss: 0.638 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.6165790557861328
Epoch: 30, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.675 Vali Acc: 0.867 Test Loss: 0.675 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.5000135898590088
Epoch: 31, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.772 Vali Acc: 0.856 Test Loss: 0.772 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.5339665412902832
Epoch: 32, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.775 Vali Acc: 0.861 Test Loss: 0.775 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.3609423637390137
Epoch: 33, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.679 Vali Acc: 0.878 Test Loss: 0.679 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.4088873863220215
Epoch: 34, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.711 Vali Acc: 0.867 Test Loss: 0.711 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.5896472930908203
Epoch: 35, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.794 Vali Acc: 0.856 Test Loss: 0.794 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.236574411392212
Epoch: 36, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.708 Vali Acc: 0.850 Test Loss: 0.708 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.4407298564910889
Epoch: 37, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.732 Vali Acc: 0.867 Test Loss: 0.732 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.7837879657745361
Epoch: 38, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.652 Vali Acc: 0.872 Test Loss: 0.652 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 5969971
model size : 27.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.438375949859619
Epoch: 1, Steps: 12 | Train Loss: 2.828 Vali Loss: 2.669 Vali Acc: 0.150 Test Loss: 2.669 Test Acc: 0.150
Validation loss decreased (inf --> -0.149973).  Saving model ...
Epoch: 2 cost time: 1.6298840045928955
Epoch: 2, Steps: 12 | Train Loss: 2.622 Vali Loss: 2.378 Vali Acc: 0.367 Test Loss: 2.378 Test Acc: 0.367
Validation loss decreased (-0.149973 --> -0.366643).  Saving model ...
Epoch: 3 cost time: 1.3599870204925537
Epoch: 3, Steps: 12 | Train Loss: 2.290 Vali Loss: 2.105 Vali Acc: 0.461 Test Loss: 2.105 Test Acc: 0.461
Validation loss decreased (-0.366643 --> -0.461090).  Saving model ...
Epoch: 4 cost time: 1.698988676071167
Epoch: 4, Steps: 12 | Train Loss: 1.961 Vali Loss: 1.787 Vali Acc: 0.483 Test Loss: 1.787 Test Acc: 0.483
Validation loss decreased (-0.461090 --> -0.483315).  Saving model ...
Epoch: 5 cost time: 1.2154910564422607
Epoch: 5, Steps: 12 | Train Loss: 1.486 Vali Loss: 1.515 Vali Acc: 0.544 Test Loss: 1.515 Test Acc: 0.544
Validation loss decreased (-0.483315 --> -0.544429).  Saving model ...
Epoch: 6 cost time: 1.7382545471191406
Epoch: 6, Steps: 12 | Train Loss: 1.288 Vali Loss: 1.360 Vali Acc: 0.589 Test Loss: 1.360 Test Acc: 0.589
Validation loss decreased (-0.544429 --> -0.588875).  Saving model ...
Epoch: 7 cost time: 1.63698410987854
Epoch: 7, Steps: 12 | Train Loss: 1.083 Vali Loss: 1.150 Vali Acc: 0.622 Test Loss: 1.150 Test Acc: 0.622
Validation loss decreased (-0.588875 --> -0.622211).  Saving model ...
Epoch: 8 cost time: 1.416539192199707
Epoch: 8, Steps: 12 | Train Loss: 0.840 Vali Loss: 1.072 Vali Acc: 0.633 Test Loss: 1.072 Test Acc: 0.633
Validation loss decreased (-0.622211 --> -0.633323).  Saving model ...
Epoch: 9 cost time: 1.701054573059082
Epoch: 9, Steps: 12 | Train Loss: 0.671 Vali Loss: 0.940 Vali Acc: 0.711 Test Loss: 0.940 Test Acc: 0.711
Validation loss decreased (-0.633323 --> -0.711102).  Saving model ...
Epoch: 10 cost time: 1.4409091472625732
Epoch: 10, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.829 Vali Acc: 0.711 Test Loss: 0.829 Test Acc: 0.711
Validation loss decreased (-0.711102 --> -0.711103).  Saving model ...
Epoch: 11 cost time: 1.8774466514587402
Epoch: 11, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.782 Vali Acc: 0.756 Test Loss: 0.782 Test Acc: 0.756
Validation loss decreased (-0.711103 --> -0.755548).  Saving model ...
Epoch: 12 cost time: 1.599696159362793
Epoch: 12, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.681 Vali Acc: 0.772 Test Loss: 0.681 Test Acc: 0.772
Validation loss decreased (-0.755548 --> -0.772215).  Saving model ...
Epoch: 13 cost time: 1.6605167388916016
Epoch: 13, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.699 Vali Acc: 0.800 Test Loss: 0.699 Test Acc: 0.800
Validation loss decreased (-0.772215 --> -0.799993).  Saving model ...
Epoch: 14 cost time: 1.653313159942627
Epoch: 14, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.639 Vali Acc: 0.811 Test Loss: 0.639 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811105).  Saving model ...
Epoch: 15 cost time: 1.631223201751709
Epoch: 15, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.539 Vali Acc: 0.850 Test Loss: 0.539 Test Acc: 0.850
Validation loss decreased (-0.811105 --> -0.849995).  Saving model ...
Epoch: 16 cost time: 1.5748836994171143
Epoch: 16, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.598 Vali Acc: 0.839 Test Loss: 0.598 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7107303142547607
Epoch: 17, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.510 Vali Acc: 0.861 Test Loss: 0.510 Test Acc: 0.861
Validation loss decreased (-0.849995 --> -0.861106).  Saving model ...
Epoch: 18 cost time: 2.3745179176330566
Epoch: 18, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.540 Vali Acc: 0.889 Test Loss: 0.540 Test Acc: 0.889
Validation loss decreased (-0.861106 --> -0.888883).  Saving model ...
Epoch: 19 cost time: 1.88393235206604
Epoch: 19, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.599 Vali Acc: 0.844 Test Loss: 0.599 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5744903087615967
Epoch: 20, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.762 Vali Acc: 0.850 Test Loss: 0.762 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.455359935760498
Epoch: 21, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.643 Vali Acc: 0.856 Test Loss: 0.643 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.535938024520874
Epoch: 22, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.618 Vali Acc: 0.861 Test Loss: 0.618 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.514472246170044
Epoch: 23, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.733 Vali Acc: 0.822 Test Loss: 0.733 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.4554474353790283
Epoch: 24, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.587 Vali Acc: 0.856 Test Loss: 0.587 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.6007332801818848
Epoch: 25, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.600 Vali Acc: 0.883 Test Loss: 0.600 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.5553545951843262
Epoch: 26, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.558 Vali Acc: 0.889 Test Loss: 0.558 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.7653977870941162
Epoch: 27, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.723 Vali Acc: 0.861 Test Loss: 0.723 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.4813919067382812
Epoch: 28, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.695 Vali Acc: 0.867 Test Loss: 0.695 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 5968435
model size : 27.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3070034980773926
Epoch: 1, Steps: 12 | Train Loss: 2.724 Vali Loss: 2.600 Vali Acc: 0.189 Test Loss: 2.600 Test Acc: 0.189
Validation loss decreased (inf --> -0.188863).  Saving model ...
Epoch: 2 cost time: 1.3344430923461914
Epoch: 2, Steps: 12 | Train Loss: 2.508 Vali Loss: 2.370 Vali Acc: 0.333 Test Loss: 2.370 Test Acc: 0.333
Validation loss decreased (-0.188863 --> -0.333310).  Saving model ...
Epoch: 3 cost time: 1.395017147064209
Epoch: 3, Steps: 12 | Train Loss: 2.246 Vali Loss: 2.103 Vali Acc: 0.456 Test Loss: 2.103 Test Acc: 0.456
Validation loss decreased (-0.333310 --> -0.455535).  Saving model ...
Epoch: 4 cost time: 1.4161529541015625
Epoch: 4, Steps: 12 | Train Loss: 1.881 Vali Loss: 1.761 Vali Acc: 0.506 Test Loss: 1.761 Test Acc: 0.506
Validation loss decreased (-0.455535 --> -0.505538).  Saving model ...
Epoch: 5 cost time: 1.6419296264648438
Epoch: 5, Steps: 12 | Train Loss: 1.539 Vali Loss: 1.570 Vali Acc: 0.517 Test Loss: 1.570 Test Acc: 0.517
Validation loss decreased (-0.505538 --> -0.516651).  Saving model ...
Epoch: 6 cost time: 1.7419283390045166
Epoch: 6, Steps: 12 | Train Loss: 1.242 Vali Loss: 1.320 Vali Acc: 0.611 Test Loss: 1.320 Test Acc: 0.611
Validation loss decreased (-0.516651 --> -0.611098).  Saving model ...
Epoch: 7 cost time: 1.476696491241455
Epoch: 7, Steps: 12 | Train Loss: 1.149 Vali Loss: 1.163 Vali Acc: 0.622 Test Loss: 1.163 Test Acc: 0.622
Validation loss decreased (-0.611098 --> -0.622211).  Saving model ...
Epoch: 8 cost time: 1.5706875324249268
Epoch: 8, Steps: 12 | Train Loss: 0.864 Vali Loss: 1.060 Vali Acc: 0.683 Test Loss: 1.060 Test Acc: 0.683
Validation loss decreased (-0.622211 --> -0.683323).  Saving model ...
Epoch: 9 cost time: 1.4160497188568115
Epoch: 9, Steps: 12 | Train Loss: 0.814 Vali Loss: 1.015 Vali Acc: 0.661 Test Loss: 1.015 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4787986278533936
Epoch: 10, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.853 Vali Acc: 0.717 Test Loss: 0.853 Test Acc: 0.717
Validation loss decreased (-0.683323 --> -0.716658).  Saving model ...
Epoch: 11 cost time: 1.3025872707366943
Epoch: 11, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.833 Vali Acc: 0.756 Test Loss: 0.833 Test Acc: 0.756
Validation loss decreased (-0.716658 --> -0.755547).  Saving model ...
Epoch: 12 cost time: 1.714003086090088
Epoch: 12, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.716 Vali Acc: 0.778 Test Loss: 0.716 Test Acc: 0.778
Validation loss decreased (-0.755547 --> -0.777771).  Saving model ...
Epoch: 13 cost time: 1.7740767002105713
Epoch: 13, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.856 Vali Acc: 0.767 Test Loss: 0.856 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6865038871765137
Epoch: 14, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.707 Vali Acc: 0.761 Test Loss: 0.707 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7464311122894287
Epoch: 15, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.693 Vali Acc: 0.856 Test Loss: 0.693 Test Acc: 0.856
Validation loss decreased (-0.777771 --> -0.855549).  Saving model ...
Epoch: 16 cost time: 1.648099422454834
Epoch: 16, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.624 Vali Acc: 0.822 Test Loss: 0.624 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7012348175048828
Epoch: 17, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.622 Vali Acc: 0.850 Test Loss: 0.622 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7780930995941162
Epoch: 18, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.676 Vali Acc: 0.839 Test Loss: 0.676 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.706897258758545
Epoch: 19, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.683 Vali Acc: 0.839 Test Loss: 0.683 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4537715911865234
Epoch: 20, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.711 Vali Acc: 0.839 Test Loss: 0.711 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.7601323127746582
Epoch: 21, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.653 Vali Acc: 0.844 Test Loss: 0.653 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.8067257404327393
Epoch: 22, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.726 Vali Acc: 0.856 Test Loss: 0.726 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.8025057315826416
Epoch: 23, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.697 Vali Acc: 0.856 Test Loss: 0.697 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.027683734893799
Epoch: 24, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.645 Vali Acc: 0.878 Test Loss: 0.645 Test Acc: 0.878
Validation loss decreased (-0.855549 --> -0.877771).  Saving model ...
Epoch: 25 cost time: 1.7566566467285156
Epoch: 25, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.689 Vali Acc: 0.878 Test Loss: 0.689 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8759980201721191
Epoch: 26, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.720 Vali Acc: 0.872 Test Loss: 0.720 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.5770092010498047
Epoch: 27, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.648 Vali Acc: 0.867 Test Loss: 0.648 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.5363948345184326
Epoch: 28, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.701 Vali Acc: 0.872 Test Loss: 0.701 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.7228426933288574
Epoch: 29, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.729 Vali Acc: 0.883 Test Loss: 0.729 Test Acc: 0.883
Validation loss decreased (-0.877771 --> -0.883326).  Saving model ...
Epoch: 30 cost time: 1.95182204246521
Epoch: 30, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.732 Vali Acc: 0.872 Test Loss: 0.732 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.5860018730163574
Epoch: 31, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.708 Vali Acc: 0.883 Test Loss: 0.708 Test Acc: 0.883
Validation loss decreased (-0.883326 --> -0.883326).  Saving model ...
Epoch: 32 cost time: 1.5266499519348145
Epoch: 32, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.695 Vali Acc: 0.883 Test Loss: 0.695 Test Acc: 0.883
Validation loss decreased (-0.883326 --> -0.883326).  Saving model ...
Epoch: 33 cost time: 1.6891140937805176
Epoch: 33, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.712 Vali Acc: 0.883 Test Loss: 0.712 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.7625963687896729
Epoch: 34, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.717 Vali Acc: 0.883 Test Loss: 0.717 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.8148157596588135
Epoch: 35, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.719 Vali Acc: 0.883 Test Loss: 0.719 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.0933024883270264
Epoch: 36, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.720 Vali Acc: 0.872 Test Loss: 0.720 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.0214943885803223
Epoch: 37, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.716 Vali Acc: 0.872 Test Loss: 0.716 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.8726537227630615
Epoch: 38, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.721 Vali Acc: 0.883 Test Loss: 0.721 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.7338805198669434
Epoch: 39, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.720 Vali Acc: 0.883 Test Loss: 0.720 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.7549221515655518
Epoch: 40, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.717 Vali Acc: 0.883 Test Loss: 0.717 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.5418949127197266
Epoch: 41, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.702 Vali Acc: 0.878 Test Loss: 0.702 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.8799521923065186
Epoch: 42, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.704 Vali Acc: 0.867 Test Loss: 0.704 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 5644723
model size : 26.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0855748653411865
Epoch: 1, Steps: 12 | Train Loss: 2.936 Vali Loss: 2.673 Vali Acc: 0.100 Test Loss: 2.673 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 1.3658215999603271
Epoch: 2, Steps: 12 | Train Loss: 2.605 Vali Loss: 2.401 Vali Acc: 0.350 Test Loss: 2.401 Test Acc: 0.350
Validation loss decreased (-0.099973 --> -0.349976).  Saving model ...
Epoch: 3 cost time: 1.2909584045410156
Epoch: 3, Steps: 12 | Train Loss: 2.262 Vali Loss: 2.116 Vali Acc: 0.422 Test Loss: 2.116 Test Acc: 0.422
Validation loss decreased (-0.349976 --> -0.422201).  Saving model ...
Epoch: 4 cost time: 1.385322093963623
Epoch: 4, Steps: 12 | Train Loss: 1.868 Vali Loss: 1.798 Vali Acc: 0.544 Test Loss: 1.798 Test Acc: 0.544
Validation loss decreased (-0.422201 --> -0.544426).  Saving model ...
Epoch: 5 cost time: 1.4560422897338867
Epoch: 5, Steps: 12 | Train Loss: 1.572 Vali Loss: 1.573 Vali Acc: 0.533 Test Loss: 1.573 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6457924842834473
Epoch: 6, Steps: 12 | Train Loss: 1.257 Vali Loss: 1.334 Vali Acc: 0.594 Test Loss: 1.334 Test Acc: 0.594
Validation loss decreased (-0.544426 --> -0.594431).  Saving model ...
Epoch: 7 cost time: 1.3385887145996094
Epoch: 7, Steps: 12 | Train Loss: 1.100 Vali Loss: 1.182 Vali Acc: 0.617 Test Loss: 1.182 Test Acc: 0.617
Validation loss decreased (-0.594431 --> -0.616655).  Saving model ...
Epoch: 8 cost time: 1.3544697761535645
Epoch: 8, Steps: 12 | Train Loss: 0.860 Vali Loss: 1.132 Vali Acc: 0.644 Test Loss: 1.132 Test Acc: 0.644
Validation loss decreased (-0.616655 --> -0.644433).  Saving model ...
Epoch: 9 cost time: 1.614790916442871
Epoch: 9, Steps: 12 | Train Loss: 0.783 Vali Loss: 0.980 Vali Acc: 0.694 Test Loss: 0.980 Test Acc: 0.694
Validation loss decreased (-0.644433 --> -0.694435).  Saving model ...
Epoch: 10 cost time: 1.3595352172851562
Epoch: 10, Steps: 12 | Train Loss: 0.622 Vali Loss: 0.852 Vali Acc: 0.761 Test Loss: 0.852 Test Acc: 0.761
Validation loss decreased (-0.694435 --> -0.761103).  Saving model ...
Epoch: 11 cost time: 1.5623970031738281
Epoch: 11, Steps: 12 | Train Loss: 0.510 Vali Loss: 0.846 Vali Acc: 0.700 Test Loss: 0.846 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4320569038391113
Epoch: 12, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.802 Vali Acc: 0.711 Test Loss: 0.802 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.313302755355835
Epoch: 13, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.690 Vali Acc: 0.789 Test Loss: 0.690 Test Acc: 0.789
Validation loss decreased (-0.761103 --> -0.788882).  Saving model ...
Epoch: 14 cost time: 1.2773468494415283
Epoch: 14, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.602 Vali Acc: 0.833 Test Loss: 0.602 Test Acc: 0.833
Validation loss decreased (-0.788882 --> -0.833327).  Saving model ...
Epoch: 15 cost time: 1.5095903873443604
Epoch: 15, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.618 Vali Acc: 0.850 Test Loss: 0.618 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849994).  Saving model ...
Epoch: 16 cost time: 1.5662200450897217
Epoch: 16, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.525 Vali Acc: 0.861 Test Loss: 0.525 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861106).  Saving model ...
Epoch: 17 cost time: 1.4889206886291504
Epoch: 17, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.587 Vali Acc: 0.861 Test Loss: 0.587 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4381260871887207
Epoch: 18, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.514 Vali Acc: 0.867 Test Loss: 0.514 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866662).  Saving model ...
Epoch: 19 cost time: 1.3407387733459473
Epoch: 19, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.632 Vali Acc: 0.844 Test Loss: 0.632 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5274803638458252
Epoch: 20, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.574 Vali Acc: 0.844 Test Loss: 0.574 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5736658573150635
Epoch: 21, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.650 Vali Acc: 0.872 Test Loss: 0.650 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872216).  Saving model ...
Epoch: 22 cost time: 1.3632595539093018
Epoch: 22, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.623 Vali Acc: 0.867 Test Loss: 0.623 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7126424312591553
Epoch: 23, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.609 Vali Acc: 0.878 Test Loss: 0.609 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877772).  Saving model ...
Epoch: 24 cost time: 1.3902266025543213
Epoch: 24, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.571 Vali Acc: 0.883 Test Loss: 0.571 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883328).  Saving model ...
Epoch: 25 cost time: 1.3483819961547852
Epoch: 25, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.639 Vali Acc: 0.889 Test Loss: 0.639 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888883).  Saving model ...
Epoch: 26 cost time: 1.4463844299316406
Epoch: 26, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.614 Vali Acc: 0.867 Test Loss: 0.614 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.514573335647583
Epoch: 27, Steps: 12 | Train Loss: 0.064 Vali Loss: 1.043 Vali Acc: 0.800 Test Loss: 1.043 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2793173789978027
Epoch: 28, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.550 Vali Acc: 0.867 Test Loss: 0.550 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.5770092010498047
Epoch: 29, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.826 Vali Acc: 0.822 Test Loss: 0.826 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.3034062385559082
Epoch: 30, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.561 Vali Acc: 0.883 Test Loss: 0.561 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.4398736953735352
Epoch: 31, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.667 Vali Acc: 0.867 Test Loss: 0.667 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.4014880657196045
Epoch: 32, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.695 Vali Acc: 0.861 Test Loss: 0.695 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.9642066955566406
Epoch: 33, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.727 Vali Acc: 0.889 Test Loss: 0.727 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.5096690654754639
Epoch: 34, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.723 Vali Acc: 0.894 Test Loss: 0.723 Test Acc: 0.894
Validation loss decreased (-0.888883 --> -0.894437).  Saving model ...
Epoch: 35 cost time: 1.3131709098815918
Epoch: 35, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.694 Vali Acc: 0.889 Test Loss: 0.694 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.5473065376281738
Epoch: 36, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.691 Vali Acc: 0.889 Test Loss: 0.691 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.2900397777557373
Epoch: 37, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.693 Vali Acc: 0.894 Test Loss: 0.693 Test Acc: 0.894
Validation loss decreased (-0.894437 --> -0.894438).  Saving model ...
Epoch: 38 cost time: 1.619368076324463
Epoch: 38, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.696 Vali Acc: 0.894 Test Loss: 0.696 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.627166509628296
Epoch: 39, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.685 Vali Acc: 0.894 Test Loss: 0.685 Test Acc: 0.894
Validation loss decreased (-0.894438 --> -0.894438).  Saving model ...
Epoch: 40 cost time: 1.5064947605133057
Epoch: 40, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.683 Vali Acc: 0.894 Test Loss: 0.683 Test Acc: 0.894
Validation loss decreased (-0.894438 --> -0.894438).  Saving model ...
Epoch: 41 cost time: 1.3770835399627686
Epoch: 41, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.685 Vali Acc: 0.894 Test Loss: 0.685 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.6472382545471191
Epoch: 42, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.690 Vali Acc: 0.894 Test Loss: 0.690 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.2869713306427002
Epoch: 43, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.686 Vali Acc: 0.894 Test Loss: 0.686 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.3231465816497803
Epoch: 44, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.684 Vali Acc: 0.894 Test Loss: 0.684 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.8642938137054443
Epoch: 45, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.687 Vali Acc: 0.889 Test Loss: 0.687 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.6535871028900146
Epoch: 46, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.699 Vali Acc: 0.889 Test Loss: 0.699 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.4358360767364502
Epoch: 47, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.712 Vali Acc: 0.894 Test Loss: 0.712 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.4440042972564697
Epoch: 48, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.710 Vali Acc: 0.894 Test Loss: 0.710 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.6384174823760986
Epoch: 49, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.706 Vali Acc: 0.889 Test Loss: 0.706 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.3867132663726807
Epoch: 50, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.708 Vali Acc: 0.889 Test Loss: 0.708 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 5643187
model size : 26.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.329005479812622
Epoch: 1, Steps: 12 | Train Loss: 2.860 Vali Loss: 2.685 Vali Acc: 0.106 Test Loss: 2.685 Test Acc: 0.106
Validation loss decreased (inf --> -0.105529).  Saving model ...
Epoch: 2 cost time: 1.3143117427825928
Epoch: 2, Steps: 12 | Train Loss: 2.622 Vali Loss: 2.406 Vali Acc: 0.244 Test Loss: 2.406 Test Acc: 0.244
Validation loss decreased (-0.105529 --> -0.244420).  Saving model ...
Epoch: 3 cost time: 1.4834089279174805
Epoch: 3, Steps: 12 | Train Loss: 2.331 Vali Loss: 2.119 Vali Acc: 0.439 Test Loss: 2.119 Test Acc: 0.439
Validation loss decreased (-0.244420 --> -0.438868).  Saving model ...
Epoch: 4 cost time: 1.192467451095581
Epoch: 4, Steps: 12 | Train Loss: 1.968 Vali Loss: 1.794 Vali Acc: 0.500 Test Loss: 1.794 Test Acc: 0.500
Validation loss decreased (-0.438868 --> -0.499982).  Saving model ...
Epoch: 5 cost time: 1.6456835269927979
Epoch: 5, Steps: 12 | Train Loss: 1.643 Vali Loss: 1.535 Vali Acc: 0.544 Test Loss: 1.535 Test Acc: 0.544
Validation loss decreased (-0.499982 --> -0.544429).  Saving model ...
Epoch: 6 cost time: 1.482158899307251
Epoch: 6, Steps: 12 | Train Loss: 1.300 Vali Loss: 1.357 Vali Acc: 0.533 Test Loss: 1.357 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2619729042053223
Epoch: 7, Steps: 12 | Train Loss: 1.112 Vali Loss: 1.200 Vali Acc: 0.572 Test Loss: 1.200 Test Acc: 0.572
Validation loss decreased (-0.544429 --> -0.572210).  Saving model ...
Epoch: 8 cost time: 1.482306957244873
Epoch: 8, Steps: 12 | Train Loss: 1.004 Vali Loss: 1.039 Vali Acc: 0.633 Test Loss: 1.039 Test Acc: 0.633
Validation loss decreased (-0.572210 --> -0.633323).  Saving model ...
Epoch: 9 cost time: 1.3697125911712646
Epoch: 9, Steps: 12 | Train Loss: 0.781 Vali Loss: 0.913 Vali Acc: 0.683 Test Loss: 0.913 Test Acc: 0.683
Validation loss decreased (-0.633323 --> -0.683324).  Saving model ...
Epoch: 10 cost time: 1.3956074714660645
Epoch: 10, Steps: 12 | Train Loss: 0.629 Vali Loss: 0.881 Vali Acc: 0.683 Test Loss: 0.881 Test Acc: 0.683
Validation loss decreased (-0.683324 --> -0.683325).  Saving model ...
Epoch: 11 cost time: 1.344459056854248
Epoch: 11, Steps: 12 | Train Loss: 0.534 Vali Loss: 0.832 Vali Acc: 0.733 Test Loss: 0.832 Test Acc: 0.733
Validation loss decreased (-0.683325 --> -0.733325).  Saving model ...
Epoch: 12 cost time: 1.4127202033996582
Epoch: 12, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.696 Vali Acc: 0.772 Test Loss: 0.696 Test Acc: 0.772
Validation loss decreased (-0.733325 --> -0.772215).  Saving model ...
Epoch: 13 cost time: 1.4416720867156982
Epoch: 13, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.680 Vali Acc: 0.789 Test Loss: 0.680 Test Acc: 0.789
Validation loss decreased (-0.772215 --> -0.788882).  Saving model ...
Epoch: 14 cost time: 1.4893279075622559
Epoch: 14, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.634 Vali Acc: 0.817 Test Loss: 0.634 Test Acc: 0.817
Validation loss decreased (-0.788882 --> -0.816660).  Saving model ...
Epoch: 15 cost time: 1.4975025653839111
Epoch: 15, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.636 Vali Acc: 0.828 Test Loss: 0.636 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827771).  Saving model ...
Epoch: 16 cost time: 1.3452823162078857
Epoch: 16, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.604 Vali Acc: 0.839 Test Loss: 0.604 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838883).  Saving model ...
Epoch: 17 cost time: 1.5151090621948242
Epoch: 17, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.604 Vali Acc: 0.856 Test Loss: 0.604 Test Acc: 0.856
Validation loss decreased (-0.838883 --> -0.855550).  Saving model ...
Epoch: 18 cost time: 1.3300588130950928
Epoch: 18, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.618 Vali Acc: 0.861 Test Loss: 0.618 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 19 cost time: 1.7014045715332031
Epoch: 19, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.561 Vali Acc: 0.889 Test Loss: 0.561 Test Acc: 0.889
Validation loss decreased (-0.861105 --> -0.888883).  Saving model ...
Epoch: 20 cost time: 1.8021223545074463
Epoch: 20, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.659 Vali Acc: 0.856 Test Loss: 0.659 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3658440113067627
Epoch: 21, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.645 Vali Acc: 0.828 Test Loss: 0.645 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4110112190246582
Epoch: 22, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.742 Vali Acc: 0.828 Test Loss: 0.742 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4055814743041992
Epoch: 23, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.651 Vali Acc: 0.850 Test Loss: 0.651 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.37894606590271
Epoch: 24, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.737 Vali Acc: 0.833 Test Loss: 0.737 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.7302868366241455
Epoch: 25, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.641 Vali Acc: 0.867 Test Loss: 0.641 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.4069464206695557
Epoch: 26, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.716 Vali Acc: 0.861 Test Loss: 0.716 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.4840426445007324
Epoch: 27, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.790 Vali Acc: 0.856 Test Loss: 0.790 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.2369139194488525
Epoch: 28, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.792 Vali Acc: 0.861 Test Loss: 0.792 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.651289463043213
Epoch: 29, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.793 Vali Acc: 0.844 Test Loss: 0.793 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 5641651
model size : 26.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.55607533454895
Epoch: 1, Steps: 12 | Train Loss: 2.736 Vali Loss: 2.666 Vali Acc: 0.206 Test Loss: 2.666 Test Acc: 0.206
Validation loss decreased (inf --> -0.205529).  Saving model ...
Epoch: 2 cost time: 1.2830829620361328
Epoch: 2, Steps: 12 | Train Loss: 2.541 Vali Loss: 2.406 Vali Acc: 0.339 Test Loss: 2.406 Test Acc: 0.339
Validation loss decreased (-0.205529 --> -0.338865).  Saving model ...
Epoch: 3 cost time: 1.623236894607544
Epoch: 3, Steps: 12 | Train Loss: 2.196 Vali Loss: 2.109 Vali Acc: 0.450 Test Loss: 2.109 Test Acc: 0.450
Validation loss decreased (-0.338865 --> -0.449979).  Saving model ...
Epoch: 4 cost time: 1.7843866348266602
Epoch: 4, Steps: 12 | Train Loss: 1.898 Vali Loss: 1.750 Vali Acc: 0.561 Test Loss: 1.750 Test Acc: 0.561
Validation loss decreased (-0.449979 --> -0.561094).  Saving model ...
Epoch: 5 cost time: 1.78324556350708
Epoch: 5, Steps: 12 | Train Loss: 1.502 Vali Loss: 1.512 Vali Acc: 0.550 Test Loss: 1.512 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7368040084838867
Epoch: 6, Steps: 12 | Train Loss: 1.322 Vali Loss: 1.302 Vali Acc: 0.600 Test Loss: 1.302 Test Acc: 0.600
Validation loss decreased (-0.561094 --> -0.599987).  Saving model ...
Epoch: 7 cost time: 1.6667709350585938
Epoch: 7, Steps: 12 | Train Loss: 1.057 Vali Loss: 1.183 Vali Acc: 0.600 Test Loss: 1.183 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599988).  Saving model ...
Epoch: 8 cost time: 1.344285011291504
Epoch: 8, Steps: 12 | Train Loss: 0.899 Vali Loss: 1.069 Vali Acc: 0.678 Test Loss: 1.069 Test Acc: 0.678
Validation loss decreased (-0.599988 --> -0.677767).  Saving model ...
Epoch: 9 cost time: 1.5621964931488037
Epoch: 9, Steps: 12 | Train Loss: 0.723 Vali Loss: 0.917 Vali Acc: 0.694 Test Loss: 0.917 Test Acc: 0.694
Validation loss decreased (-0.677767 --> -0.694435).  Saving model ...
Epoch: 10 cost time: 1.3723318576812744
Epoch: 10, Steps: 12 | Train Loss: 0.600 Vali Loss: 0.906 Vali Acc: 0.711 Test Loss: 0.906 Test Acc: 0.711
Validation loss decreased (-0.694435 --> -0.711102).  Saving model ...
Epoch: 11 cost time: 1.4170258045196533
Epoch: 11, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.737 Vali Acc: 0.767 Test Loss: 0.737 Test Acc: 0.767
Validation loss decreased (-0.711102 --> -0.766659).  Saving model ...
Epoch: 12 cost time: 1.453939437866211
Epoch: 12, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.741 Vali Acc: 0.783 Test Loss: 0.741 Test Acc: 0.783
Validation loss decreased (-0.766659 --> -0.783326).  Saving model ...
Epoch: 13 cost time: 1.5076463222503662
Epoch: 13, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.693 Vali Acc: 0.794 Test Loss: 0.693 Test Acc: 0.794
Validation loss decreased (-0.783326 --> -0.794438).  Saving model ...
Epoch: 14 cost time: 1.477776288986206
Epoch: 14, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.630 Vali Acc: 0.822 Test Loss: 0.630 Test Acc: 0.822
Validation loss decreased (-0.794438 --> -0.822216).  Saving model ...
Epoch: 15 cost time: 1.2973198890686035
Epoch: 15, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.642 Vali Acc: 0.828 Test Loss: 0.642 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827771).  Saving model ...
Epoch: 16 cost time: 1.3997783660888672
Epoch: 16, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.545 Vali Acc: 0.844 Test Loss: 0.545 Test Acc: 0.844
Validation loss decreased (-0.827771 --> -0.844439).  Saving model ...
Epoch: 17 cost time: 1.588766098022461
Epoch: 17, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.658 Vali Acc: 0.828 Test Loss: 0.658 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4789009094238281
Epoch: 18, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.644 Vali Acc: 0.856 Test Loss: 0.644 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855549).  Saving model ...
Epoch: 19 cost time: 1.4540519714355469
Epoch: 19, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.670 Vali Acc: 0.844 Test Loss: 0.670 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.472665548324585
Epoch: 20, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.572 Vali Acc: 0.872 Test Loss: 0.572 Test Acc: 0.872
Validation loss decreased (-0.855549 --> -0.872216).  Saving model ...
Epoch: 21 cost time: 1.177030324935913
Epoch: 21, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.642 Vali Acc: 0.894 Test Loss: 0.642 Test Acc: 0.894
Validation loss decreased (-0.872216 --> -0.894438).  Saving model ...
Epoch: 22 cost time: 1.5407636165618896
Epoch: 22, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.604 Vali Acc: 0.878 Test Loss: 0.604 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3747546672821045
Epoch: 23, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.638 Vali Acc: 0.878 Test Loss: 0.638 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6417837142944336
Epoch: 24, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.737 Vali Acc: 0.856 Test Loss: 0.737 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.4246883392333984
Epoch: 25, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.651 Vali Acc: 0.839 Test Loss: 0.651 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.462003231048584
Epoch: 26, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.646 Vali Acc: 0.872 Test Loss: 0.646 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.407900333404541
Epoch: 27, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.630 Vali Acc: 0.867 Test Loss: 0.630 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.7988061904907227
Epoch: 28, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.600 Vali Acc: 0.883 Test Loss: 0.600 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.5453402996063232
Epoch: 29, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.747 Vali Acc: 0.861 Test Loss: 0.747 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.704843282699585
Epoch: 30, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.682 Vali Acc: 0.872 Test Loss: 0.682 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.7042417526245117
Epoch: 31, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.651 Vali Acc: 0.872 Test Loss: 0.651 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 5640115
model size : 26.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5610597133636475
Epoch: 1, Steps: 12 | Train Loss: 2.880 Vali Loss: 2.729 Vali Acc: 0.033 Test Loss: 2.729 Test Acc: 0.033
Validation loss decreased (inf --> -0.033306).  Saving model ...
Epoch: 2 cost time: 1.414215326309204
Epoch: 2, Steps: 12 | Train Loss: 2.654 Vali Loss: 2.529 Vali Acc: 0.217 Test Loss: 2.529 Test Acc: 0.217
Validation loss decreased (-0.033306 --> -0.216641).  Saving model ...
Epoch: 3 cost time: 1.3754103183746338
Epoch: 3, Steps: 12 | Train Loss: 2.458 Vali Loss: 2.330 Vali Acc: 0.417 Test Loss: 2.330 Test Acc: 0.417
Validation loss decreased (-0.216641 --> -0.416643).  Saving model ...
Epoch: 4 cost time: 1.5030975341796875
Epoch: 4, Steps: 12 | Train Loss: 2.250 Vali Loss: 2.119 Vali Acc: 0.489 Test Loss: 2.119 Test Acc: 0.489
Validation loss decreased (-0.416643 --> -0.488868).  Saving model ...
Epoch: 5 cost time: 1.4032564163208008
Epoch: 5, Steps: 12 | Train Loss: 1.956 Vali Loss: 1.862 Vali Acc: 0.539 Test Loss: 1.862 Test Acc: 0.539
Validation loss decreased (-0.488868 --> -0.538870).  Saving model ...
Epoch: 6 cost time: 1.4721314907073975
Epoch: 6, Steps: 12 | Train Loss: 1.611 Vali Loss: 1.650 Vali Acc: 0.561 Test Loss: 1.650 Test Acc: 0.561
Validation loss decreased (-0.538870 --> -0.561095).  Saving model ...
Epoch: 7 cost time: 1.5425333976745605
Epoch: 7, Steps: 12 | Train Loss: 1.421 Vali Loss: 1.420 Vali Acc: 0.611 Test Loss: 1.420 Test Acc: 0.611
Validation loss decreased (-0.561095 --> -0.611097).  Saving model ...
Epoch: 8 cost time: 1.3941888809204102
Epoch: 8, Steps: 12 | Train Loss: 1.208 Vali Loss: 1.252 Vali Acc: 0.644 Test Loss: 1.252 Test Acc: 0.644
Validation loss decreased (-0.611097 --> -0.644432).  Saving model ...
Epoch: 9 cost time: 1.525439977645874
Epoch: 9, Steps: 12 | Train Loss: 1.008 Vali Loss: 1.122 Vali Acc: 0.689 Test Loss: 1.122 Test Acc: 0.689
Validation loss decreased (-0.644432 --> -0.688878).  Saving model ...
Epoch: 10 cost time: 1.4548535346984863
Epoch: 10, Steps: 12 | Train Loss: 0.851 Vali Loss: 0.966 Vali Acc: 0.739 Test Loss: 0.966 Test Acc: 0.739
Validation loss decreased (-0.688878 --> -0.738879).  Saving model ...
Epoch: 11 cost time: 1.2779757976531982
Epoch: 11, Steps: 12 | Train Loss: 0.779 Vali Loss: 0.880 Vali Acc: 0.756 Test Loss: 0.880 Test Acc: 0.756
Validation loss decreased (-0.738879 --> -0.755547).  Saving model ...
Epoch: 12 cost time: 1.4057135581970215
Epoch: 12, Steps: 12 | Train Loss: 0.627 Vali Loss: 0.846 Vali Acc: 0.717 Test Loss: 0.846 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4039499759674072
Epoch: 13, Steps: 12 | Train Loss: 0.633 Vali Loss: 0.772 Vali Acc: 0.750 Test Loss: 0.772 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4413738250732422
Epoch: 14, Steps: 12 | Train Loss: 0.518 Vali Loss: 0.673 Vali Acc: 0.806 Test Loss: 0.673 Test Acc: 0.806
Validation loss decreased (-0.755547 --> -0.805549).  Saving model ...
Epoch: 15 cost time: 1.3700530529022217
Epoch: 15, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.624 Vali Acc: 0.833 Test Loss: 0.624 Test Acc: 0.833
Validation loss decreased (-0.805549 --> -0.833327).  Saving model ...
Epoch: 16 cost time: 1.4960684776306152
Epoch: 16, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.568 Vali Acc: 0.839 Test Loss: 0.568 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 17 cost time: 1.2293477058410645
Epoch: 17, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.517 Vali Acc: 0.856 Test Loss: 0.517 Test Acc: 0.856
Validation loss decreased (-0.838883 --> -0.855550).  Saving model ...
Epoch: 18 cost time: 1.487642526626587
Epoch: 18, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.476 Vali Acc: 0.872 Test Loss: 0.476 Test Acc: 0.872
Validation loss decreased (-0.855550 --> -0.872217).  Saving model ...
Epoch: 19 cost time: 1.4148931503295898
Epoch: 19, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.525 Vali Acc: 0.861 Test Loss: 0.525 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5352399349212646
Epoch: 20, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.524 Vali Acc: 0.861 Test Loss: 0.524 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5281310081481934
Epoch: 21, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.482 Vali Acc: 0.867 Test Loss: 0.482 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6213698387145996
Epoch: 22, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.479 Vali Acc: 0.872 Test Loss: 0.479 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3584322929382324
Epoch: 23, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.464 Vali Acc: 0.900 Test Loss: 0.464 Test Acc: 0.900
Validation loss decreased (-0.872217 --> -0.899995).  Saving model ...
Epoch: 24 cost time: 1.5145015716552734
Epoch: 24, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.467 Vali Acc: 0.889 Test Loss: 0.467 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4491775035858154
Epoch: 25, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.464 Vali Acc: 0.889 Test Loss: 0.464 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4663121700286865
Epoch: 26, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.436 Vali Acc: 0.894 Test Loss: 0.436 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.6508488655090332
Epoch: 27, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.413 Vali Acc: 0.894 Test Loss: 0.413 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.5076978206634521
Epoch: 28, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.494 Vali Acc: 0.894 Test Loss: 0.494 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.5794758796691895
Epoch: 29, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.431 Vali Acc: 0.883 Test Loss: 0.431 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.4634380340576172
Epoch: 30, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.469 Vali Acc: 0.900 Test Loss: 0.469 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.352278470993042
Epoch: 31, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.454 Vali Acc: 0.900 Test Loss: 0.454 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 32 cost time: 1.5385894775390625
Epoch: 32, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.455 Vali Acc: 0.906 Test Loss: 0.455 Test Acc: 0.906
Validation loss decreased (-0.899995 --> -0.905551).  Saving model ...
Epoch: 33 cost time: 1.3654773235321045
Epoch: 33, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.458 Vali Acc: 0.900 Test Loss: 0.458 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.5130515098571777
Epoch: 34, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.466 Vali Acc: 0.894 Test Loss: 0.466 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.328115701675415
Epoch: 35, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.484 Vali Acc: 0.878 Test Loss: 0.484 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.3491127490997314
Epoch: 36, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.471 Vali Acc: 0.900 Test Loss: 0.471 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.3328378200531006
Epoch: 37, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.479 Vali Acc: 0.900 Test Loss: 0.479 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.2924399375915527
Epoch: 38, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.473 Vali Acc: 0.889 Test Loss: 0.473 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.3019013404846191
Epoch: 39, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.517 Vali Acc: 0.878 Test Loss: 0.517 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.3134739398956299
Epoch: 40, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.492 Vali Acc: 0.894 Test Loss: 0.492 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.3947887420654297
Epoch: 41, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.513 Vali Acc: 0.894 Test Loss: 0.513 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.2005853652954102
Epoch: 42, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.506 Vali Acc: 0.900 Test Loss: 0.506 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 2663347
model size : 12.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8272809982299805
Epoch: 1, Steps: 12 | Train Loss: 2.816 Vali Loss: 2.674 Vali Acc: 0.072 Test Loss: 2.674 Test Acc: 0.072
Validation loss decreased (inf --> -0.072195).  Saving model ...
Epoch: 2 cost time: 1.7543601989746094
Epoch: 2, Steps: 12 | Train Loss: 2.744 Vali Loss: 2.510 Vali Acc: 0.250 Test Loss: 2.510 Test Acc: 0.250
Validation loss decreased (-0.072195 --> -0.249975).  Saving model ...
Epoch: 3 cost time: 1.4453904628753662
Epoch: 3, Steps: 12 | Train Loss: 2.475 Vali Loss: 2.321 Vali Acc: 0.372 Test Loss: 2.321 Test Acc: 0.372
Validation loss decreased (-0.249975 --> -0.372199).  Saving model ...
Epoch: 4 cost time: 1.7588927745819092
Epoch: 4, Steps: 12 | Train Loss: 2.187 Vali Loss: 2.077 Vali Acc: 0.439 Test Loss: 2.077 Test Acc: 0.439
Validation loss decreased (-0.372199 --> -0.438868).  Saving model ...
Epoch: 5 cost time: 1.4844906330108643
Epoch: 5, Steps: 12 | Train Loss: 1.854 Vali Loss: 1.821 Vali Acc: 0.517 Test Loss: 1.821 Test Acc: 0.517
Validation loss decreased (-0.438868 --> -0.516648).  Saving model ...
Epoch: 6 cost time: 1.3527250289916992
Epoch: 6, Steps: 12 | Train Loss: 1.625 Vali Loss: 1.590 Vali Acc: 0.567 Test Loss: 1.590 Test Acc: 0.567
Validation loss decreased (-0.516648 --> -0.566651).  Saving model ...
Epoch: 7 cost time: 1.3591618537902832
Epoch: 7, Steps: 12 | Train Loss: 1.317 Vali Loss: 1.390 Vali Acc: 0.589 Test Loss: 1.390 Test Acc: 0.589
Validation loss decreased (-0.566651 --> -0.588875).  Saving model ...
Epoch: 8 cost time: 1.44252347946167
Epoch: 8, Steps: 12 | Train Loss: 1.121 Vali Loss: 1.251 Vali Acc: 0.628 Test Loss: 1.251 Test Acc: 0.628
Validation loss decreased (-0.588875 --> -0.627765).  Saving model ...
Epoch: 9 cost time: 1.2531623840332031
Epoch: 9, Steps: 12 | Train Loss: 0.983 Vali Loss: 1.103 Vali Acc: 0.667 Test Loss: 1.103 Test Acc: 0.667
Validation loss decreased (-0.627765 --> -0.666656).  Saving model ...
Epoch: 10 cost time: 1.543888807296753
Epoch: 10, Steps: 12 | Train Loss: 0.865 Vali Loss: 0.969 Vali Acc: 0.728 Test Loss: 0.969 Test Acc: 0.728
Validation loss decreased (-0.666656 --> -0.727768).  Saving model ...
Epoch: 11 cost time: 1.3391127586364746
Epoch: 11, Steps: 12 | Train Loss: 0.774 Vali Loss: 0.930 Vali Acc: 0.711 Test Loss: 0.930 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3411104679107666
Epoch: 12, Steps: 12 | Train Loss: 0.670 Vali Loss: 0.889 Vali Acc: 0.711 Test Loss: 0.889 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2631409168243408
Epoch: 13, Steps: 12 | Train Loss: 0.600 Vali Loss: 0.746 Vali Acc: 0.806 Test Loss: 0.746 Test Acc: 0.806
Validation loss decreased (-0.727768 --> -0.805548).  Saving model ...
Epoch: 14 cost time: 1.3057246208190918
Epoch: 14, Steps: 12 | Train Loss: 0.475 Vali Loss: 0.675 Vali Acc: 0.817 Test Loss: 0.675 Test Acc: 0.817
Validation loss decreased (-0.805548 --> -0.816660).  Saving model ...
Epoch: 15 cost time: 1.2806529998779297
Epoch: 15, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.591 Vali Acc: 0.844 Test Loss: 0.591 Test Acc: 0.844
Validation loss decreased (-0.816660 --> -0.844439).  Saving model ...
Epoch: 16 cost time: 1.4798016548156738
Epoch: 16, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.598 Vali Acc: 0.828 Test Loss: 0.598 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3855724334716797
Epoch: 17, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.568 Vali Acc: 0.817 Test Loss: 0.568 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3363537788391113
Epoch: 18, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.582 Vali Acc: 0.861 Test Loss: 0.582 Test Acc: 0.861
Validation loss decreased (-0.844439 --> -0.861105).  Saving model ...
Epoch: 19 cost time: 1.455610990524292
Epoch: 19, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.479 Vali Acc: 0.867 Test Loss: 0.479 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866662).  Saving model ...
Epoch: 20 cost time: 1.348940134048462
Epoch: 20, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.570 Vali Acc: 0.850 Test Loss: 0.570 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4897196292877197
Epoch: 21, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.506 Vali Acc: 0.878 Test Loss: 0.506 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877773).  Saving model ...
Epoch: 22 cost time: 1.2669124603271484
Epoch: 22, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.473 Vali Acc: 0.872 Test Loss: 0.473 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5648126602172852
Epoch: 23, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.475 Vali Acc: 0.861 Test Loss: 0.475 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3159515857696533
Epoch: 24, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.519 Vali Acc: 0.856 Test Loss: 0.519 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5712978839874268
Epoch: 25, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.509 Vali Acc: 0.861 Test Loss: 0.509 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.3796606063842773
Epoch: 26, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.535 Vali Acc: 0.867 Test Loss: 0.535 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.334977626800537
Epoch: 27, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.485 Vali Acc: 0.872 Test Loss: 0.485 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2868366241455078
Epoch: 28, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.524 Vali Acc: 0.894 Test Loss: 0.524 Test Acc: 0.894
Validation loss decreased (-0.877773 --> -0.894439).  Saving model ...
Epoch: 29 cost time: 1.509847640991211
Epoch: 29, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.496 Vali Acc: 0.878 Test Loss: 0.496 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3036425113677979
Epoch: 30, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.485 Vali Acc: 0.889 Test Loss: 0.485 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.421135425567627
Epoch: 31, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.525 Vali Acc: 0.878 Test Loss: 0.525 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.3297441005706787
Epoch: 32, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.511 Vali Acc: 0.894 Test Loss: 0.511 Test Acc: 0.894
Validation loss decreased (-0.894439 --> -0.894439).  Saving model ...
Epoch: 33 cost time: 1.1663599014282227
Epoch: 33, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.512 Vali Acc: 0.872 Test Loss: 0.512 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.153869390487671
Epoch: 34, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.520 Vali Acc: 0.889 Test Loss: 0.520 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.3736817836761475
Epoch: 35, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.541 Vali Acc: 0.872 Test Loss: 0.541 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.2660012245178223
Epoch: 36, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.573 Vali Acc: 0.861 Test Loss: 0.573 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.3531906604766846
Epoch: 37, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.535 Vali Acc: 0.883 Test Loss: 0.535 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.4781596660614014
Epoch: 38, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.516 Vali Acc: 0.894 Test Loss: 0.516 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.4522068500518799
Epoch: 39, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.526 Vali Acc: 0.894 Test Loss: 0.526 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.3637025356292725
Epoch: 40, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.534 Vali Acc: 0.894 Test Loss: 0.534 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.4803073406219482
Epoch: 41, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.527 Vali Acc: 0.894 Test Loss: 0.527 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.472623348236084
Epoch: 42, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.537 Vali Acc: 0.894 Test Loss: 0.537 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 2662579
model size : 12.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.374809503555298
Epoch: 1, Steps: 12 | Train Loss: 2.799 Vali Loss: 2.697 Vali Acc: 0.056 Test Loss: 2.697 Test Acc: 0.056
Validation loss decreased (inf --> -0.055529).  Saving model ...
Epoch: 2 cost time: 1.5214388370513916
Epoch: 2, Steps: 12 | Train Loss: 2.670 Vali Loss: 2.538 Vali Acc: 0.200 Test Loss: 2.538 Test Acc: 0.200
Validation loss decreased (-0.055529 --> -0.199975).  Saving model ...
Epoch: 3 cost time: 1.3706510066986084
Epoch: 3, Steps: 12 | Train Loss: 2.435 Vali Loss: 2.326 Vali Acc: 0.344 Test Loss: 2.326 Test Acc: 0.344
Validation loss decreased (-0.199975 --> -0.344421).  Saving model ...
Epoch: 4 cost time: 1.6208550930023193
Epoch: 4, Steps: 12 | Train Loss: 2.167 Vali Loss: 2.092 Vali Acc: 0.450 Test Loss: 2.092 Test Acc: 0.450
Validation loss decreased (-0.344421 --> -0.449979).  Saving model ...
Epoch: 5 cost time: 1.2273807525634766
Epoch: 5, Steps: 12 | Train Loss: 1.875 Vali Loss: 1.863 Vali Acc: 0.556 Test Loss: 1.863 Test Acc: 0.556
Validation loss decreased (-0.449979 --> -0.555537).  Saving model ...
Epoch: 6 cost time: 1.2801477909088135
Epoch: 6, Steps: 12 | Train Loss: 1.586 Vali Loss: 1.619 Vali Acc: 0.589 Test Loss: 1.619 Test Acc: 0.589
Validation loss decreased (-0.555537 --> -0.588873).  Saving model ...
Epoch: 7 cost time: 1.5522065162658691
Epoch: 7, Steps: 12 | Train Loss: 1.381 Vali Loss: 1.410 Vali Acc: 0.628 Test Loss: 1.410 Test Acc: 0.628
Validation loss decreased (-0.588873 --> -0.627764).  Saving model ...
Epoch: 8 cost time: 1.2088797092437744
Epoch: 8, Steps: 12 | Train Loss: 1.223 Vali Loss: 1.260 Vali Acc: 0.672 Test Loss: 1.260 Test Acc: 0.672
Validation loss decreased (-0.627764 --> -0.672210).  Saving model ...
Epoch: 9 cost time: 1.220644235610962
Epoch: 9, Steps: 12 | Train Loss: 0.974 Vali Loss: 1.099 Vali Acc: 0.683 Test Loss: 1.099 Test Acc: 0.683
Validation loss decreased (-0.672210 --> -0.683322).  Saving model ...
Epoch: 10 cost time: 1.355609655380249
Epoch: 10, Steps: 12 | Train Loss: 0.871 Vali Loss: 1.024 Vali Acc: 0.728 Test Loss: 1.024 Test Acc: 0.728
Validation loss decreased (-0.683322 --> -0.727768).  Saving model ...
Epoch: 11 cost time: 1.2827262878417969
Epoch: 11, Steps: 12 | Train Loss: 0.746 Vali Loss: 0.905 Vali Acc: 0.750 Test Loss: 0.905 Test Acc: 0.750
Validation loss decreased (-0.727768 --> -0.749991).  Saving model ...
Epoch: 12 cost time: 1.5522911548614502
Epoch: 12, Steps: 12 | Train Loss: 0.613 Vali Loss: 0.812 Vali Acc: 0.767 Test Loss: 0.812 Test Acc: 0.767
Validation loss decreased (-0.749991 --> -0.766659).  Saving model ...
Epoch: 13 cost time: 1.5338752269744873
Epoch: 13, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.733 Vali Acc: 0.806 Test Loss: 0.733 Test Acc: 0.806
Validation loss decreased (-0.766659 --> -0.805548).  Saving model ...
Epoch: 14 cost time: 1.3524248600006104
Epoch: 14, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.718 Vali Acc: 0.783 Test Loss: 0.718 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.473405122756958
Epoch: 15, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.640 Vali Acc: 0.828 Test Loss: 0.640 Test Acc: 0.828
Validation loss decreased (-0.805548 --> -0.827771).  Saving model ...
Epoch: 16 cost time: 1.5042610168457031
Epoch: 16, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.634 Vali Acc: 0.806 Test Loss: 0.634 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4785070419311523
Epoch: 17, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.579 Vali Acc: 0.850 Test Loss: 0.579 Test Acc: 0.850
Validation loss decreased (-0.827771 --> -0.849994).  Saving model ...
Epoch: 18 cost time: 1.1809415817260742
Epoch: 18, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.554 Vali Acc: 0.839 Test Loss: 0.554 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3733079433441162
Epoch: 19, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.453 Vali Acc: 0.850 Test Loss: 0.453 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 20 cost time: 1.5132396221160889
Epoch: 20, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.480 Vali Acc: 0.878 Test Loss: 0.480 Test Acc: 0.878
Validation loss decreased (-0.849995 --> -0.877773).  Saving model ...
Epoch: 21 cost time: 1.376192569732666
Epoch: 21, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.445 Vali Acc: 0.872 Test Loss: 0.445 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3798315525054932
Epoch: 22, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.466 Vali Acc: 0.872 Test Loss: 0.466 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.484438419342041
Epoch: 23, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.457 Vali Acc: 0.889 Test Loss: 0.457 Test Acc: 0.889
Validation loss decreased (-0.877773 --> -0.888884).  Saving model ...
Epoch: 24 cost time: 1.3888957500457764
Epoch: 24, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.475 Vali Acc: 0.878 Test Loss: 0.475 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1771974563598633
Epoch: 25, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.469 Vali Acc: 0.883 Test Loss: 0.469 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4066441059112549
Epoch: 26, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.434 Vali Acc: 0.894 Test Loss: 0.434 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894440).  Saving model ...
Epoch: 27 cost time: 1.2271134853363037
Epoch: 27, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.505 Vali Acc: 0.883 Test Loss: 0.505 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4611480236053467
Epoch: 28, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.461 Vali Acc: 0.878 Test Loss: 0.461 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.613295316696167
Epoch: 29, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.436 Vali Acc: 0.900 Test Loss: 0.436 Test Acc: 0.900
Validation loss decreased (-0.894440 --> -0.899996).  Saving model ...
Epoch: 30 cost time: 1.3537778854370117
Epoch: 30, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.456 Vali Acc: 0.894 Test Loss: 0.456 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3692407608032227
Epoch: 31, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.434 Vali Acc: 0.900 Test Loss: 0.434 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 32 cost time: 1.641010046005249
Epoch: 32, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.488 Vali Acc: 0.894 Test Loss: 0.488 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2676606178283691
Epoch: 33, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.458 Vali Acc: 0.894 Test Loss: 0.458 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.4861187934875488
Epoch: 34, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.512 Vali Acc: 0.894 Test Loss: 0.512 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.3462300300598145
Epoch: 35, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.538 Vali Acc: 0.878 Test Loss: 0.538 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.3944127559661865
Epoch: 36, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.524 Vali Acc: 0.878 Test Loss: 0.524 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.4478895664215088
Epoch: 37, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.502 Vali Acc: 0.883 Test Loss: 0.502 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.4937047958374023
Epoch: 38, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.516 Vali Acc: 0.894 Test Loss: 0.516 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.4688529968261719
Epoch: 39, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.567 Vali Acc: 0.900 Test Loss: 0.567 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.610187292098999
Epoch: 40, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.495 Vali Acc: 0.900 Test Loss: 0.495 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.420079231262207
Epoch: 41, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.511 Vali Acc: 0.900 Test Loss: 0.511 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 2661811
model size : 12.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.795222759246826
Epoch: 1, Steps: 12 | Train Loss: 2.801 Vali Loss: 2.732 Vali Acc: 0.128 Test Loss: 2.732 Test Acc: 0.128
Validation loss decreased (inf --> -0.127750).  Saving model ...
Epoch: 2 cost time: 1.3998615741729736
Epoch: 2, Steps: 12 | Train Loss: 2.585 Vali Loss: 2.535 Vali Acc: 0.189 Test Loss: 2.535 Test Acc: 0.189
Validation loss decreased (-0.127750 --> -0.188864).  Saving model ...
Epoch: 3 cost time: 1.3503546714782715
Epoch: 3, Steps: 12 | Train Loss: 2.401 Vali Loss: 2.320 Vali Acc: 0.350 Test Loss: 2.320 Test Acc: 0.350
Validation loss decreased (-0.188864 --> -0.349977).  Saving model ...
Epoch: 4 cost time: 1.6007018089294434
Epoch: 4, Steps: 12 | Train Loss: 2.172 Vali Loss: 2.101 Vali Acc: 0.456 Test Loss: 2.101 Test Acc: 0.456
Validation loss decreased (-0.349977 --> -0.455535).  Saving model ...
Epoch: 5 cost time: 1.4027070999145508
Epoch: 5, Steps: 12 | Train Loss: 1.846 Vali Loss: 1.818 Vali Acc: 0.550 Test Loss: 1.818 Test Acc: 0.550
Validation loss decreased (-0.455535 --> -0.549982).  Saving model ...
Epoch: 6 cost time: 1.3851754665374756
Epoch: 6, Steps: 12 | Train Loss: 1.554 Vali Loss: 1.596 Vali Acc: 0.594 Test Loss: 1.596 Test Acc: 0.594
Validation loss decreased (-0.549982 --> -0.594428).  Saving model ...
Epoch: 7 cost time: 1.3453261852264404
Epoch: 7, Steps: 12 | Train Loss: 1.305 Vali Loss: 1.404 Vali Acc: 0.611 Test Loss: 1.404 Test Acc: 0.611
Validation loss decreased (-0.594428 --> -0.611097).  Saving model ...
Epoch: 8 cost time: 1.5760200023651123
Epoch: 8, Steps: 12 | Train Loss: 1.168 Vali Loss: 1.253 Vali Acc: 0.650 Test Loss: 1.253 Test Acc: 0.650
Validation loss decreased (-0.611097 --> -0.649987).  Saving model ...
Epoch: 9 cost time: 1.2501146793365479
Epoch: 9, Steps: 12 | Train Loss: 0.925 Vali Loss: 1.118 Vali Acc: 0.633 Test Loss: 1.118 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6777064800262451
Epoch: 10, Steps: 12 | Train Loss: 0.864 Vali Loss: 0.941 Vali Acc: 0.706 Test Loss: 0.941 Test Acc: 0.706
Validation loss decreased (-0.649987 --> -0.705546).  Saving model ...
Epoch: 11 cost time: 1.3347454071044922
Epoch: 11, Steps: 12 | Train Loss: 0.685 Vali Loss: 0.872 Vali Acc: 0.722 Test Loss: 0.872 Test Acc: 0.722
Validation loss decreased (-0.705546 --> -0.722214).  Saving model ...
Epoch: 12 cost time: 1.4710619449615479
Epoch: 12, Steps: 12 | Train Loss: 0.617 Vali Loss: 0.802 Vali Acc: 0.794 Test Loss: 0.802 Test Acc: 0.794
Validation loss decreased (-0.722214 --> -0.794436).  Saving model ...
Epoch: 13 cost time: 1.400803804397583
Epoch: 13, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.724 Vali Acc: 0.794 Test Loss: 0.724 Test Acc: 0.794
Validation loss decreased (-0.794436 --> -0.794437).  Saving model ...
Epoch: 14 cost time: 1.8198268413543701
Epoch: 14, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.689 Vali Acc: 0.783 Test Loss: 0.689 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4648187160491943
Epoch: 15, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.569 Vali Acc: 0.822 Test Loss: 0.569 Test Acc: 0.822
Validation loss decreased (-0.794437 --> -0.822217).  Saving model ...
Epoch: 16 cost time: 1.3024709224700928
Epoch: 16, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.631 Vali Acc: 0.839 Test Loss: 0.631 Test Acc: 0.839
Validation loss decreased (-0.822217 --> -0.838883).  Saving model ...
Epoch: 17 cost time: 1.391603946685791
Epoch: 17, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.510 Vali Acc: 0.867 Test Loss: 0.510 Test Acc: 0.867
Validation loss decreased (-0.838883 --> -0.866662).  Saving model ...
Epoch: 18 cost time: 1.2985024452209473
Epoch: 18, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.547 Vali Acc: 0.850 Test Loss: 0.547 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4473762512207031
Epoch: 19, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.465 Vali Acc: 0.861 Test Loss: 0.465 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.577460527420044
Epoch: 20, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.466 Vali Acc: 0.867 Test Loss: 0.466 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 21 cost time: 1.5239851474761963
Epoch: 21, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.550 Vali Acc: 0.844 Test Loss: 0.550 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4572651386260986
Epoch: 22, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.505 Vali Acc: 0.878 Test Loss: 0.505 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877773).  Saving model ...
Epoch: 23 cost time: 1.4420740604400635
Epoch: 23, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.498 Vali Acc: 0.878 Test Loss: 0.498 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 24 cost time: 1.8181569576263428
Epoch: 24, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.476 Vali Acc: 0.861 Test Loss: 0.476 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4294524192810059
Epoch: 25, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.505 Vali Acc: 0.883 Test Loss: 0.505 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883328).  Saving model ...
Epoch: 26 cost time: 1.8159222602844238
Epoch: 26, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.473 Vali Acc: 0.883 Test Loss: 0.473 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883329).  Saving model ...
Epoch: 27 cost time: 1.2644190788269043
Epoch: 27, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.475 Vali Acc: 0.894 Test Loss: 0.475 Test Acc: 0.894
Validation loss decreased (-0.883329 --> -0.894440).  Saving model ...
Epoch: 28 cost time: 1.2252693176269531
Epoch: 28, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.456 Vali Acc: 0.883 Test Loss: 0.456 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.651648998260498
Epoch: 29, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.500 Vali Acc: 0.889 Test Loss: 0.500 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.6406266689300537
Epoch: 30, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.493 Vali Acc: 0.894 Test Loss: 0.493 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.5698869228363037
Epoch: 31, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.518 Vali Acc: 0.878 Test Loss: 0.518 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.3733155727386475
Epoch: 32, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.514 Vali Acc: 0.889 Test Loss: 0.514 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.6459014415740967
Epoch: 33, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.524 Vali Acc: 0.883 Test Loss: 0.524 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.340721607208252
Epoch: 34, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.546 Vali Acc: 0.894 Test Loss: 0.546 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.3708412647247314
Epoch: 35, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.498 Vali Acc: 0.867 Test Loss: 0.498 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.3471438884735107
Epoch: 36, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.537 Vali Acc: 0.894 Test Loss: 0.537 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.309532880783081
Epoch: 37, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.547 Vali Acc: 0.856 Test Loss: 0.547 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 2661043
model size : 12.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.675260066986084
Epoch: 1, Steps: 12 | Train Loss: 2.824 Vali Loss: 2.673 Vali Acc: 0.067 Test Loss: 2.673 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 1.6034014225006104
Epoch: 2, Steps: 12 | Train Loss: 2.665 Vali Loss: 2.582 Vali Acc: 0.178 Test Loss: 2.582 Test Acc: 0.178
Validation loss decreased (-0.066640 --> -0.177752).  Saving model ...
Epoch: 3 cost time: 1.5999541282653809
Epoch: 3, Steps: 12 | Train Loss: 2.476 Vali Loss: 2.367 Vali Acc: 0.339 Test Loss: 2.367 Test Acc: 0.339
Validation loss decreased (-0.177752 --> -0.338865).  Saving model ...
Epoch: 4 cost time: 1.7122743129730225
Epoch: 4, Steps: 12 | Train Loss: 2.283 Vali Loss: 2.161 Vali Acc: 0.467 Test Loss: 2.161 Test Acc: 0.467
Validation loss decreased (-0.338865 --> -0.466645).  Saving model ...
Epoch: 5 cost time: 1.657651424407959
Epoch: 5, Steps: 12 | Train Loss: 1.951 Vali Loss: 1.943 Vali Acc: 0.500 Test Loss: 1.943 Test Acc: 0.500
Validation loss decreased (-0.466645 --> -0.499981).  Saving model ...
Epoch: 6 cost time: 1.6241822242736816
Epoch: 6, Steps: 12 | Train Loss: 1.710 Vali Loss: 1.730 Vali Acc: 0.544 Test Loss: 1.730 Test Acc: 0.544
Validation loss decreased (-0.499981 --> -0.544427).  Saving model ...
Epoch: 7 cost time: 1.4965858459472656
Epoch: 7, Steps: 12 | Train Loss: 1.471 Vali Loss: 1.512 Vali Acc: 0.594 Test Loss: 1.512 Test Acc: 0.594
Validation loss decreased (-0.544427 --> -0.594429).  Saving model ...
Epoch: 8 cost time: 1.4842219352722168
Epoch: 8, Steps: 12 | Train Loss: 1.314 Vali Loss: 1.367 Vali Acc: 0.600 Test Loss: 1.367 Test Acc: 0.600
Validation loss decreased (-0.594429 --> -0.599986).  Saving model ...
Epoch: 9 cost time: 1.3501427173614502
Epoch: 9, Steps: 12 | Train Loss: 1.094 Vali Loss: 1.226 Vali Acc: 0.633 Test Loss: 1.226 Test Acc: 0.633
Validation loss decreased (-0.599986 --> -0.633321).  Saving model ...
Epoch: 10 cost time: 1.7777776718139648
Epoch: 10, Steps: 12 | Train Loss: 1.019 Vali Loss: 1.120 Vali Acc: 0.667 Test Loss: 1.120 Test Acc: 0.667
Validation loss decreased (-0.633321 --> -0.666655).  Saving model ...
Epoch: 11 cost time: 1.610649585723877
Epoch: 11, Steps: 12 | Train Loss: 0.841 Vali Loss: 1.058 Vali Acc: 0.722 Test Loss: 1.058 Test Acc: 0.722
Validation loss decreased (-0.666655 --> -0.722212).  Saving model ...
Epoch: 12 cost time: 1.5876555442810059
Epoch: 12, Steps: 12 | Train Loss: 0.747 Vali Loss: 0.944 Vali Acc: 0.722 Test Loss: 0.944 Test Acc: 0.722
Validation loss decreased (-0.722212 --> -0.722213).  Saving model ...
Epoch: 13 cost time: 1.4557874202728271
Epoch: 13, Steps: 12 | Train Loss: 0.676 Vali Loss: 0.861 Vali Acc: 0.756 Test Loss: 0.861 Test Acc: 0.756
Validation loss decreased (-0.722213 --> -0.755547).  Saving model ...
Epoch: 14 cost time: 1.4031846523284912
Epoch: 14, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.796 Vali Acc: 0.767 Test Loss: 0.796 Test Acc: 0.767
Validation loss decreased (-0.755547 --> -0.766659).  Saving model ...
Epoch: 15 cost time: 1.6064479351043701
Epoch: 15, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.738 Vali Acc: 0.789 Test Loss: 0.738 Test Acc: 0.789
Validation loss decreased (-0.766659 --> -0.788882).  Saving model ...
Epoch: 16 cost time: 2.0422465801239014
Epoch: 16, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.676 Vali Acc: 0.789 Test Loss: 0.676 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 17 cost time: 1.7953224182128906
Epoch: 17, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.628 Vali Acc: 0.817 Test Loss: 0.628 Test Acc: 0.817
Validation loss decreased (-0.788882 --> -0.816660).  Saving model ...
Epoch: 18 cost time: 1.894836664199829
Epoch: 18, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.639 Vali Acc: 0.833 Test Loss: 0.639 Test Acc: 0.833
Validation loss decreased (-0.816660 --> -0.833327).  Saving model ...
Epoch: 19 cost time: 1.4580636024475098
Epoch: 19, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.553 Vali Acc: 0.850 Test Loss: 0.553 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849994).  Saving model ...
Epoch: 20 cost time: 1.6482658386230469
Epoch: 20, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.530 Vali Acc: 0.844 Test Loss: 0.530 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8643391132354736
Epoch: 21, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.516 Vali Acc: 0.861 Test Loss: 0.516 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861106).  Saving model ...
Epoch: 22 cost time: 1.778294563293457
Epoch: 22, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.511 Vali Acc: 0.861 Test Loss: 0.511 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 23 cost time: 1.6852717399597168
Epoch: 23, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.503 Vali Acc: 0.883 Test Loss: 0.503 Test Acc: 0.883
Validation loss decreased (-0.861106 --> -0.883328).  Saving model ...
Epoch: 24 cost time: 1.266129493713379
Epoch: 24, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.463 Vali Acc: 0.867 Test Loss: 0.463 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6130890846252441
Epoch: 25, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.516 Vali Acc: 0.894 Test Loss: 0.516 Test Acc: 0.894
Validation loss decreased (-0.883328 --> -0.894439).  Saving model ...
Epoch: 26 cost time: 1.5818979740142822
Epoch: 26, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.452 Vali Acc: 0.878 Test Loss: 0.452 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.9600789546966553
Epoch: 27, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.474 Vali Acc: 0.889 Test Loss: 0.474 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.888204574584961
Epoch: 28, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.503 Vali Acc: 0.889 Test Loss: 0.503 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.4156944751739502
Epoch: 29, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.498 Vali Acc: 0.883 Test Loss: 0.498 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.6288959980010986
Epoch: 30, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.471 Vali Acc: 0.878 Test Loss: 0.471 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.703582763671875
Epoch: 31, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.498 Vali Acc: 0.900 Test Loss: 0.498 Test Acc: 0.900
Validation loss decreased (-0.894439 --> -0.899995).  Saving model ...
Epoch: 32 cost time: 1.6249470710754395
Epoch: 32, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.507 Vali Acc: 0.889 Test Loss: 0.507 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.876798391342163
Epoch: 33, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.512 Vali Acc: 0.889 Test Loss: 0.512 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.994530439376831
Epoch: 34, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.498 Vali Acc: 0.894 Test Loss: 0.498 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.7473201751708984
Epoch: 35, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.515 Vali Acc: 0.889 Test Loss: 0.515 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.6395587921142578
Epoch: 36, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.513 Vali Acc: 0.900 Test Loss: 0.513 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.606804370880127
Epoch: 37, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.495 Vali Acc: 0.894 Test Loss: 0.495 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.74013090133667
Epoch: 38, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.524 Vali Acc: 0.889 Test Loss: 0.524 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.6557376384735107
Epoch: 39, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.542 Vali Acc: 0.894 Test Loss: 0.542 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.706451416015625
Epoch: 40, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.536 Vali Acc: 0.894 Test Loss: 0.536 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.4262042045593262
Epoch: 41, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.549 Vali Acc: 0.889 Test Loss: 0.549 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 2005427
model size : 10.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.733363389968872
Epoch: 1, Steps: 12 | Train Loss: 2.823 Vali Loss: 2.729 Vali Acc: 0.100 Test Loss: 2.729 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 1.4650635719299316
Epoch: 2, Steps: 12 | Train Loss: 2.656 Vali Loss: 2.566 Vali Acc: 0.200 Test Loss: 2.566 Test Acc: 0.200
Validation loss decreased (-0.099973 --> -0.199974).  Saving model ...
Epoch: 3 cost time: 1.705460786819458
Epoch: 3, Steps: 12 | Train Loss: 2.469 Vali Loss: 2.401 Vali Acc: 0.233 Test Loss: 2.401 Test Acc: 0.233
Validation loss decreased (-0.199974 --> -0.233309).  Saving model ...
Epoch: 4 cost time: 1.5271081924438477
Epoch: 4, Steps: 12 | Train Loss: 2.243 Vali Loss: 2.184 Vali Acc: 0.422 Test Loss: 2.184 Test Acc: 0.422
Validation loss decreased (-0.233309 --> -0.422200).  Saving model ...
Epoch: 5 cost time: 1.49623703956604
Epoch: 5, Steps: 12 | Train Loss: 2.004 Vali Loss: 1.957 Vali Acc: 0.461 Test Loss: 1.957 Test Acc: 0.461
Validation loss decreased (-0.422200 --> -0.461092).  Saving model ...
Epoch: 6 cost time: 1.592212438583374
Epoch: 6, Steps: 12 | Train Loss: 1.726 Vali Loss: 1.756 Vali Acc: 0.489 Test Loss: 1.756 Test Acc: 0.489
Validation loss decreased (-0.461092 --> -0.488871).  Saving model ...
Epoch: 7 cost time: 1.3246254920959473
Epoch: 7, Steps: 12 | Train Loss: 1.477 Vali Loss: 1.504 Vali Acc: 0.578 Test Loss: 1.504 Test Acc: 0.578
Validation loss decreased (-0.488871 --> -0.577763).  Saving model ...
Epoch: 8 cost time: 1.5098347663879395
Epoch: 8, Steps: 12 | Train Loss: 1.269 Vali Loss: 1.333 Vali Acc: 0.628 Test Loss: 1.333 Test Acc: 0.628
Validation loss decreased (-0.577763 --> -0.627764).  Saving model ...
Epoch: 9 cost time: 1.6999313831329346
Epoch: 9, Steps: 12 | Train Loss: 1.087 Vali Loss: 1.157 Vali Acc: 0.672 Test Loss: 1.157 Test Acc: 0.672
Validation loss decreased (-0.627764 --> -0.672211).  Saving model ...
Epoch: 10 cost time: 1.6095190048217773
Epoch: 10, Steps: 12 | Train Loss: 0.885 Vali Loss: 1.058 Vali Acc: 0.733 Test Loss: 1.058 Test Acc: 0.733
Validation loss decreased (-0.672211 --> -0.733323).  Saving model ...
Epoch: 11 cost time: 1.4548430442810059
Epoch: 11, Steps: 12 | Train Loss: 0.773 Vali Loss: 0.960 Vali Acc: 0.756 Test Loss: 0.960 Test Acc: 0.756
Validation loss decreased (-0.733323 --> -0.755546).  Saving model ...
Epoch: 12 cost time: 1.4276490211486816
Epoch: 12, Steps: 12 | Train Loss: 0.685 Vali Loss: 0.843 Vali Acc: 0.733 Test Loss: 0.843 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5531468391418457
Epoch: 13, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.788 Vali Acc: 0.756 Test Loss: 0.788 Test Acc: 0.756
Validation loss decreased (-0.755546 --> -0.755548).  Saving model ...
Epoch: 14 cost time: 1.4971375465393066
Epoch: 14, Steps: 12 | Train Loss: 0.518 Vali Loss: 0.696 Vali Acc: 0.800 Test Loss: 0.696 Test Acc: 0.800
Validation loss decreased (-0.755548 --> -0.799993).  Saving model ...
Epoch: 15 cost time: 1.3816533088684082
Epoch: 15, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.678 Vali Acc: 0.817 Test Loss: 0.678 Test Acc: 0.817
Validation loss decreased (-0.799993 --> -0.816660).  Saving model ...
Epoch: 16 cost time: 1.5642569065093994
Epoch: 16, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.608 Vali Acc: 0.861 Test Loss: 0.608 Test Acc: 0.861
Validation loss decreased (-0.816660 --> -0.861105).  Saving model ...
Epoch: 17 cost time: 1.3452870845794678
Epoch: 17, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.607 Vali Acc: 0.828 Test Loss: 0.607 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.591745376586914
Epoch: 18, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.510 Vali Acc: 0.856 Test Loss: 0.510 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.522554636001587
Epoch: 19, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.503 Vali Acc: 0.867 Test Loss: 0.503 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866662).  Saving model ...
Epoch: 20 cost time: 1.7628612518310547
Epoch: 20, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.467 Vali Acc: 0.867 Test Loss: 0.467 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 21 cost time: 1.576890468597412
Epoch: 21, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.485 Vali Acc: 0.878 Test Loss: 0.485 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877773).  Saving model ...
Epoch: 22 cost time: 1.4866671562194824
Epoch: 22, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.444 Vali Acc: 0.883 Test Loss: 0.444 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883329).  Saving model ...
Epoch: 23 cost time: 1.5738153457641602
Epoch: 23, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.486 Vali Acc: 0.872 Test Loss: 0.486 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9519526958465576
Epoch: 24, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.494 Vali Acc: 0.878 Test Loss: 0.494 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6882541179656982
Epoch: 25, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.465 Vali Acc: 0.878 Test Loss: 0.465 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.4289748668670654
Epoch: 26, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.518 Vali Acc: 0.878 Test Loss: 0.518 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.7345068454742432
Epoch: 27, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.460 Vali Acc: 0.883 Test Loss: 0.460 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.694810152053833
Epoch: 28, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.464 Vali Acc: 0.872 Test Loss: 0.464 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.6650855541229248
Epoch: 29, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.452 Vali Acc: 0.872 Test Loss: 0.452 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.6114404201507568
Epoch: 30, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.512 Vali Acc: 0.883 Test Loss: 0.512 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.6062369346618652
Epoch: 31, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.461 Vali Acc: 0.889 Test Loss: 0.461 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888884).  Saving model ...
Epoch: 32 cost time: 2.0078978538513184
Epoch: 32, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.517 Vali Acc: 0.889 Test Loss: 0.517 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.657869577407837
Epoch: 33, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.547 Vali Acc: 0.878 Test Loss: 0.547 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.5228970050811768
Epoch: 34, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.522 Vali Acc: 0.889 Test Loss: 0.522 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.3706345558166504
Epoch: 35, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.533 Vali Acc: 0.889 Test Loss: 0.533 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.3933942317962646
Epoch: 36, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.495 Vali Acc: 0.883 Test Loss: 0.495 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.40431809425354
Epoch: 37, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.489 Vali Acc: 0.889 Test Loss: 0.489 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.4302515983581543
Epoch: 38, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.505 Vali Acc: 0.878 Test Loss: 0.505 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.5211181640625
Epoch: 39, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.519 Vali Acc: 0.889 Test Loss: 0.519 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.6185729503631592
Epoch: 40, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.511 Vali Acc: 0.889 Test Loss: 0.511 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.1888296604156494
Epoch: 41, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.527 Vali Acc: 0.878 Test Loss: 0.527 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 2004659
model size : 10.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5774645805358887
Epoch: 1, Steps: 12 | Train Loss: 2.839 Vali Loss: 2.699 Vali Acc: 0.050 Test Loss: 2.699 Test Acc: 0.050
Validation loss decreased (inf --> -0.049973).  Saving model ...
Epoch: 2 cost time: 1.605564832687378
Epoch: 2, Steps: 12 | Train Loss: 2.653 Vali Loss: 2.552 Vali Acc: 0.206 Test Loss: 2.552 Test Acc: 0.206
Validation loss decreased (-0.049973 --> -0.205530).  Saving model ...
Epoch: 3 cost time: 1.5093634128570557
Epoch: 3, Steps: 12 | Train Loss: 2.454 Vali Loss: 2.355 Vali Acc: 0.356 Test Loss: 2.355 Test Acc: 0.356
Validation loss decreased (-0.205530 --> -0.355532).  Saving model ...
Epoch: 4 cost time: 2.0977814197540283
Epoch: 4, Steps: 12 | Train Loss: 2.202 Vali Loss: 2.129 Vali Acc: 0.439 Test Loss: 2.129 Test Acc: 0.439
Validation loss decreased (-0.355532 --> -0.438868).  Saving model ...
Epoch: 5 cost time: 1.5500004291534424
Epoch: 5, Steps: 12 | Train Loss: 1.918 Vali Loss: 1.866 Vali Acc: 0.511 Test Loss: 1.866 Test Acc: 0.511
Validation loss decreased (-0.438868 --> -0.511092).  Saving model ...
Epoch: 6 cost time: 1.6820321083068848
Epoch: 6, Steps: 12 | Train Loss: 1.652 Vali Loss: 1.674 Vali Acc: 0.522 Test Loss: 1.674 Test Acc: 0.522
Validation loss decreased (-0.511092 --> -0.522205).  Saving model ...
Epoch: 7 cost time: 1.7923588752746582
Epoch: 7, Steps: 12 | Train Loss: 1.455 Vali Loss: 1.482 Vali Acc: 0.600 Test Loss: 1.482 Test Acc: 0.600
Validation loss decreased (-0.522205 --> -0.599985).  Saving model ...
Epoch: 8 cost time: 1.7154059410095215
Epoch: 8, Steps: 12 | Train Loss: 1.244 Vali Loss: 1.365 Vali Acc: 0.639 Test Loss: 1.365 Test Acc: 0.639
Validation loss decreased (-0.599985 --> -0.638875).  Saving model ...
Epoch: 9 cost time: 1.5719358921051025
Epoch: 9, Steps: 12 | Train Loss: 1.058 Vali Loss: 1.201 Vali Acc: 0.672 Test Loss: 1.201 Test Acc: 0.672
Validation loss decreased (-0.638875 --> -0.672210).  Saving model ...
Epoch: 10 cost time: 1.4728367328643799
Epoch: 10, Steps: 12 | Train Loss: 0.950 Vali Loss: 1.090 Vali Acc: 0.678 Test Loss: 1.090 Test Acc: 0.678
Validation loss decreased (-0.672210 --> -0.677767).  Saving model ...
Epoch: 11 cost time: 1.5662024021148682
Epoch: 11, Steps: 12 | Train Loss: 0.932 Vali Loss: 0.970 Vali Acc: 0.728 Test Loss: 0.970 Test Acc: 0.728
Validation loss decreased (-0.677767 --> -0.727768).  Saving model ...
Epoch: 12 cost time: 1.5905661582946777
Epoch: 12, Steps: 12 | Train Loss: 0.776 Vali Loss: 0.960 Vali Acc: 0.683 Test Loss: 0.960 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3171796798706055
Epoch: 13, Steps: 12 | Train Loss: 0.680 Vali Loss: 0.817 Vali Acc: 0.756 Test Loss: 0.817 Test Acc: 0.756
Validation loss decreased (-0.727768 --> -0.755547).  Saving model ...
Epoch: 14 cost time: 1.5182034969329834
Epoch: 14, Steps: 12 | Train Loss: 0.590 Vali Loss: 0.748 Vali Acc: 0.778 Test Loss: 0.748 Test Acc: 0.778
Validation loss decreased (-0.755547 --> -0.777770).  Saving model ...
Epoch: 15 cost time: 1.7827849388122559
Epoch: 15, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.663 Vali Acc: 0.817 Test Loss: 0.663 Test Acc: 0.817
Validation loss decreased (-0.777770 --> -0.816660).  Saving model ...
Epoch: 16 cost time: 1.6873180866241455
Epoch: 16, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.622 Vali Acc: 0.817 Test Loss: 0.622 Test Acc: 0.817
Validation loss decreased (-0.816660 --> -0.816660).  Saving model ...
Epoch: 17 cost time: 1.610431432723999
Epoch: 17, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.574 Vali Acc: 0.844 Test Loss: 0.574 Test Acc: 0.844
Validation loss decreased (-0.816660 --> -0.844439).  Saving model ...
Epoch: 18 cost time: 1.5416615009307861
Epoch: 18, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.568 Vali Acc: 0.833 Test Loss: 0.568 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.471566915512085
Epoch: 19, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.497 Vali Acc: 0.850 Test Loss: 0.497 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849995).  Saving model ...
Epoch: 20 cost time: 1.4391005039215088
Epoch: 20, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.495 Vali Acc: 0.850 Test Loss: 0.495 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 21 cost time: 1.433018684387207
Epoch: 21, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.503 Vali Acc: 0.850 Test Loss: 0.503 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6573991775512695
Epoch: 22, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.468 Vali Acc: 0.861 Test Loss: 0.468 Test Acc: 0.861
Validation loss decreased (-0.849995 --> -0.861106).  Saving model ...
Epoch: 23 cost time: 1.532987356185913
Epoch: 23, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.485 Vali Acc: 0.872 Test Loss: 0.485 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 24 cost time: 1.5603597164154053
Epoch: 24, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.435 Vali Acc: 0.872 Test Loss: 0.435 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872218).  Saving model ...
Epoch: 25 cost time: 1.6373374462127686
Epoch: 25, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.452 Vali Acc: 0.883 Test Loss: 0.452 Test Acc: 0.883
Validation loss decreased (-0.872218 --> -0.883329).  Saving model ...
Epoch: 26 cost time: 1.3964526653289795
Epoch: 26, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.490 Vali Acc: 0.883 Test Loss: 0.490 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4977517127990723
Epoch: 27, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.455 Vali Acc: 0.872 Test Loss: 0.455 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.9015324115753174
Epoch: 28, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.490 Vali Acc: 0.894 Test Loss: 0.490 Test Acc: 0.894
Validation loss decreased (-0.883329 --> -0.894440).  Saving model ...
Epoch: 29 cost time: 1.5581169128417969
Epoch: 29, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.516 Vali Acc: 0.878 Test Loss: 0.516 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.6238579750061035
Epoch: 30, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.574 Vali Acc: 0.878 Test Loss: 0.574 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.549677848815918
Epoch: 31, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.493 Vali Acc: 0.867 Test Loss: 0.493 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.3780946731567383
Epoch: 32, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.543 Vali Acc: 0.889 Test Loss: 0.543 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.5203845500946045
Epoch: 33, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.508 Vali Acc: 0.883 Test Loss: 0.508 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.5189213752746582
Epoch: 34, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.525 Vali Acc: 0.883 Test Loss: 0.525 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.9049665927886963
Epoch: 35, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.522 Vali Acc: 0.883 Test Loss: 0.522 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.3219211101531982
Epoch: 36, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.545 Vali Acc: 0.889 Test Loss: 0.545 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.5788519382476807
Epoch: 37, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.556 Vali Acc: 0.883 Test Loss: 0.556 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.3544540405273438
Epoch: 38, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.528 Vali Acc: 0.878 Test Loss: 0.528 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 2003891
model size : 10.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.708737373352051
Epoch: 1, Steps: 12 | Train Loss: 2.834 Vali Loss: 2.694 Vali Acc: 0.094 Test Loss: 2.694 Test Acc: 0.094
Validation loss decreased (inf --> -0.094417).  Saving model ...
Epoch: 2 cost time: 1.4568734169006348
Epoch: 2, Steps: 12 | Train Loss: 2.622 Vali Loss: 2.555 Vali Acc: 0.222 Test Loss: 2.555 Test Acc: 0.222
Validation loss decreased (-0.094417 --> -0.222197).  Saving model ...
Epoch: 3 cost time: 1.240727424621582
Epoch: 3, Steps: 12 | Train Loss: 2.496 Vali Loss: 2.392 Vali Acc: 0.356 Test Loss: 2.392 Test Acc: 0.356
Validation loss decreased (-0.222197 --> -0.355532).  Saving model ...
Epoch: 4 cost time: 1.2031798362731934
Epoch: 4, Steps: 12 | Train Loss: 2.268 Vali Loss: 2.203 Vali Acc: 0.417 Test Loss: 2.203 Test Acc: 0.417
Validation loss decreased (-0.355532 --> -0.416645).  Saving model ...
Epoch: 5 cost time: 1.3617658615112305
Epoch: 5, Steps: 12 | Train Loss: 2.020 Vali Loss: 1.961 Vali Acc: 0.483 Test Loss: 1.961 Test Acc: 0.483
Validation loss decreased (-0.416645 --> -0.483314).  Saving model ...
Epoch: 6 cost time: 1.5280516147613525
Epoch: 6, Steps: 12 | Train Loss: 1.788 Vali Loss: 1.751 Vali Acc: 0.567 Test Loss: 1.751 Test Acc: 0.567
Validation loss decreased (-0.483314 --> -0.566649).  Saving model ...
Epoch: 7 cost time: 1.557218074798584
Epoch: 7, Steps: 12 | Train Loss: 1.511 Vali Loss: 1.545 Vali Acc: 0.578 Test Loss: 1.545 Test Acc: 0.578
Validation loss decreased (-0.566649 --> -0.577762).  Saving model ...
Epoch: 8 cost time: 1.289151906967163
Epoch: 8, Steps: 12 | Train Loss: 1.354 Vali Loss: 1.360 Vali Acc: 0.622 Test Loss: 1.360 Test Acc: 0.622
Validation loss decreased (-0.577762 --> -0.622209).  Saving model ...
Epoch: 9 cost time: 1.26554536819458
Epoch: 9, Steps: 12 | Train Loss: 1.155 Vali Loss: 1.214 Vali Acc: 0.633 Test Loss: 1.214 Test Acc: 0.633
Validation loss decreased (-0.622209 --> -0.633321).  Saving model ...
Epoch: 10 cost time: 1.292267084121704
Epoch: 10, Steps: 12 | Train Loss: 1.001 Vali Loss: 1.106 Vali Acc: 0.672 Test Loss: 1.106 Test Acc: 0.672
Validation loss decreased (-0.633321 --> -0.672211).  Saving model ...
Epoch: 11 cost time: 1.2617807388305664
Epoch: 11, Steps: 12 | Train Loss: 0.857 Vali Loss: 1.016 Vali Acc: 0.706 Test Loss: 1.016 Test Acc: 0.706
Validation loss decreased (-0.672211 --> -0.705545).  Saving model ...
Epoch: 12 cost time: 1.495344638824463
Epoch: 12, Steps: 12 | Train Loss: 0.707 Vali Loss: 0.889 Vali Acc: 0.739 Test Loss: 0.889 Test Acc: 0.739
Validation loss decreased (-0.705545 --> -0.738880).  Saving model ...
Epoch: 13 cost time: 1.213057518005371
Epoch: 13, Steps: 12 | Train Loss: 0.698 Vali Loss: 0.836 Vali Acc: 0.744 Test Loss: 0.836 Test Acc: 0.744
Validation loss decreased (-0.738880 --> -0.744436).  Saving model ...
Epoch: 14 cost time: 1.2618045806884766
Epoch: 14, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.762 Vali Acc: 0.800 Test Loss: 0.762 Test Acc: 0.800
Validation loss decreased (-0.744436 --> -0.799992).  Saving model ...
Epoch: 15 cost time: 1.4741997718811035
Epoch: 15, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.697 Vali Acc: 0.811 Test Loss: 0.697 Test Acc: 0.811
Validation loss decreased (-0.799992 --> -0.811104).  Saving model ...
Epoch: 16 cost time: 1.795532464981079
Epoch: 16, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.639 Vali Acc: 0.828 Test Loss: 0.639 Test Acc: 0.828
Validation loss decreased (-0.811104 --> -0.827771).  Saving model ...
Epoch: 17 cost time: 1.6941394805908203
Epoch: 17, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.614 Vali Acc: 0.839 Test Loss: 0.614 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838883).  Saving model ...
Epoch: 18 cost time: 1.2018518447875977
Epoch: 18, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.586 Vali Acc: 0.850 Test Loss: 0.586 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 19 cost time: 1.6297838687896729
Epoch: 19, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.503 Vali Acc: 0.867 Test Loss: 0.503 Test Acc: 0.867
Validation loss decreased (-0.849994 --> -0.866662).  Saving model ...
Epoch: 20 cost time: 1.272864818572998
Epoch: 20, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.511 Vali Acc: 0.878 Test Loss: 0.511 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877773).  Saving model ...
Epoch: 21 cost time: 1.4711506366729736
Epoch: 21, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.497 Vali Acc: 0.872 Test Loss: 0.497 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2181735038757324
Epoch: 22, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.499 Vali Acc: 0.889 Test Loss: 0.499 Test Acc: 0.889
Validation loss decreased (-0.877773 --> -0.888884).  Saving model ...
Epoch: 23 cost time: 1.3266921043395996
Epoch: 23, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.470 Vali Acc: 0.872 Test Loss: 0.470 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.382082462310791
Epoch: 24, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.456 Vali Acc: 0.878 Test Loss: 0.456 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4254422187805176
Epoch: 25, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.565 Vali Acc: 0.889 Test Loss: 0.565 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3770115375518799
Epoch: 26, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.457 Vali Acc: 0.883 Test Loss: 0.457 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.4157557487487793
Epoch: 27, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.474 Vali Acc: 0.878 Test Loss: 0.474 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.3858954906463623
Epoch: 28, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.505 Vali Acc: 0.878 Test Loss: 0.505 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.3327248096466064
Epoch: 29, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.482 Vali Acc: 0.883 Test Loss: 0.482 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.3988287448883057
Epoch: 30, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.524 Vali Acc: 0.883 Test Loss: 0.524 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.5345704555511475
Epoch: 31, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.473 Vali Acc: 0.883 Test Loss: 0.473 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.4422309398651123
Epoch: 32, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.551 Vali Acc: 0.883 Test Loss: 0.551 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 2003123
model size : 10.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0133461952209473
Epoch: 1, Steps: 12 | Train Loss: 2.822 Vali Loss: 2.741 Vali Acc: 0.067 Test Loss: 2.741 Test Acc: 0.067
Validation loss decreased (inf --> -0.066639).  Saving model ...
Epoch: 2 cost time: 1.5639228820800781
Epoch: 2, Steps: 12 | Train Loss: 2.692 Vali Loss: 2.578 Vali Acc: 0.178 Test Loss: 2.578 Test Acc: 0.178
Validation loss decreased (-0.066639 --> -0.177752).  Saving model ...
Epoch: 3 cost time: 1.5991778373718262
Epoch: 3, Steps: 12 | Train Loss: 2.579 Vali Loss: 2.442 Vali Acc: 0.272 Test Loss: 2.442 Test Acc: 0.272
Validation loss decreased (-0.177752 --> -0.272198).  Saving model ...
Epoch: 4 cost time: 1.638176679611206
Epoch: 4, Steps: 12 | Train Loss: 2.353 Vali Loss: 2.267 Vali Acc: 0.356 Test Loss: 2.267 Test Acc: 0.356
Validation loss decreased (-0.272198 --> -0.355533).  Saving model ...
Epoch: 5 cost time: 1.3935048580169678
Epoch: 5, Steps: 12 | Train Loss: 2.124 Vali Loss: 2.059 Vali Acc: 0.422 Test Loss: 2.059 Test Acc: 0.422
Validation loss decreased (-0.355533 --> -0.422202).  Saving model ...
Epoch: 6 cost time: 1.3896543979644775
Epoch: 6, Steps: 12 | Train Loss: 1.876 Vali Loss: 1.866 Vali Acc: 0.550 Test Loss: 1.866 Test Acc: 0.550
Validation loss decreased (-0.422202 --> -0.549981).  Saving model ...
Epoch: 7 cost time: 1.3566792011260986
Epoch: 7, Steps: 12 | Train Loss: 1.594 Vali Loss: 1.647 Vali Acc: 0.594 Test Loss: 1.647 Test Acc: 0.594
Validation loss decreased (-0.549981 --> -0.594428).  Saving model ...
Epoch: 8 cost time: 1.4037837982177734
Epoch: 8, Steps: 12 | Train Loss: 1.402 Vali Loss: 1.460 Vali Acc: 0.589 Test Loss: 1.460 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3683502674102783
Epoch: 9, Steps: 12 | Train Loss: 1.246 Vali Loss: 1.309 Vali Acc: 0.650 Test Loss: 1.309 Test Acc: 0.650
Validation loss decreased (-0.594428 --> -0.649987).  Saving model ...
Epoch: 10 cost time: 1.3301467895507812
Epoch: 10, Steps: 12 | Train Loss: 1.069 Vali Loss: 1.186 Vali Acc: 0.639 Test Loss: 1.186 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.246222734451294
Epoch: 11, Steps: 12 | Train Loss: 0.951 Vali Loss: 1.079 Vali Acc: 0.672 Test Loss: 1.079 Test Acc: 0.672
Validation loss decreased (-0.649987 --> -0.672211).  Saving model ...
Epoch: 12 cost time: 1.1838107109069824
Epoch: 12, Steps: 12 | Train Loss: 0.907 Vali Loss: 1.014 Vali Acc: 0.706 Test Loss: 1.014 Test Acc: 0.706
Validation loss decreased (-0.672211 --> -0.705545).  Saving model ...
Epoch: 13 cost time: 1.501305341720581
Epoch: 13, Steps: 12 | Train Loss: 0.732 Vali Loss: 0.881 Vali Acc: 0.739 Test Loss: 0.881 Test Acc: 0.739
Validation loss decreased (-0.705545 --> -0.738880).  Saving model ...
Epoch: 14 cost time: 1.293497085571289
Epoch: 14, Steps: 12 | Train Loss: 0.593 Vali Loss: 0.863 Vali Acc: 0.694 Test Loss: 0.863 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3056912422180176
Epoch: 15, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.750 Vali Acc: 0.767 Test Loss: 0.750 Test Acc: 0.767
Validation loss decreased (-0.738880 --> -0.766659).  Saving model ...
Epoch: 16 cost time: 1.4709839820861816
Epoch: 16, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.736 Vali Acc: 0.767 Test Loss: 0.736 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766659).  Saving model ...
Epoch: 17 cost time: 1.3912475109100342
Epoch: 17, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.686 Vali Acc: 0.794 Test Loss: 0.686 Test Acc: 0.794
Validation loss decreased (-0.766659 --> -0.794438).  Saving model ...
Epoch: 18 cost time: 1.4336504936218262
Epoch: 18, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.623 Vali Acc: 0.828 Test Loss: 0.623 Test Acc: 0.828
Validation loss decreased (-0.794438 --> -0.827772).  Saving model ...
Epoch: 19 cost time: 1.3539936542510986
Epoch: 19, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.628 Vali Acc: 0.806 Test Loss: 0.628 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2479994297027588
Epoch: 20, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.558 Vali Acc: 0.861 Test Loss: 0.558 Test Acc: 0.861
Validation loss decreased (-0.827772 --> -0.861106).  Saving model ...
Epoch: 21 cost time: 1.2187731266021729
Epoch: 21, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.525 Vali Acc: 0.856 Test Loss: 0.525 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2251136302947998
Epoch: 22, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.518 Vali Acc: 0.872 Test Loss: 0.518 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 23 cost time: 1.2376830577850342
Epoch: 23, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.499 Vali Acc: 0.867 Test Loss: 0.499 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6303074359893799
Epoch: 24, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.518 Vali Acc: 0.878 Test Loss: 0.518 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 25 cost time: 1.26057767868042
Epoch: 25, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.485 Vali Acc: 0.872 Test Loss: 0.485 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4442899227142334
Epoch: 26, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.510 Vali Acc: 0.872 Test Loss: 0.510 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.4258129596710205
Epoch: 27, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.461 Vali Acc: 0.861 Test Loss: 0.461 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.4578747749328613
Epoch: 28, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.482 Vali Acc: 0.883 Test Loss: 0.482 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883329).  Saving model ...
Epoch: 29 cost time: 1.5154342651367188
Epoch: 29, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.522 Vali Acc: 0.861 Test Loss: 0.522 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4372179508209229
Epoch: 30, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.472 Vali Acc: 0.867 Test Loss: 0.472 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.4645590782165527
Epoch: 31, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.592 Vali Acc: 0.856 Test Loss: 0.592 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.4683420658111572
Epoch: 32, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.539 Vali Acc: 0.878 Test Loss: 0.539 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.2115540504455566
Epoch: 33, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.534 Vali Acc: 0.861 Test Loss: 0.534 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.6273956298828125
Epoch: 34, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.594 Vali Acc: 0.878 Test Loss: 0.594 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.3942046165466309
Epoch: 35, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.513 Vali Acc: 0.883 Test Loss: 0.513 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.3167967796325684
Epoch: 36, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.490 Vali Acc: 0.883 Test Loss: 0.490 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.4548723697662354
Epoch: 37, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.509 Vali Acc: 0.867 Test Loss: 0.509 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.6637835502624512
Epoch: 38, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.483 Vali Acc: 0.889 Test Loss: 0.483 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888884).  Saving model ...
Epoch: 39 cost time: 1.5855896472930908
Epoch: 39, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.518 Vali Acc: 0.894 Test Loss: 0.518 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894439).  Saving model ...
Epoch: 40 cost time: 1.3637688159942627
Epoch: 40, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.536 Vali Acc: 0.889 Test Loss: 0.536 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.4279770851135254
Epoch: 41, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.531 Vali Acc: 0.894 Test Loss: 0.531 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.2870216369628906
Epoch: 42, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.511 Vali Acc: 0.894 Test Loss: 0.511 Test Acc: 0.894
Validation loss decreased (-0.894439 --> -0.894439).  Saving model ...
Epoch: 43 cost time: 1.4946181774139404
Epoch: 43, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.553 Vali Acc: 0.883 Test Loss: 0.553 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.7867648601531982
Epoch: 44, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.568 Vali Acc: 0.883 Test Loss: 0.568 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.3497285842895508
Epoch: 45, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.518 Vali Acc: 0.894 Test Loss: 0.518 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.3820819854736328
Epoch: 46, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.586 Vali Acc: 0.867 Test Loss: 0.586 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.4404807090759277
Epoch: 47, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.571 Vali Acc: 0.867 Test Loss: 0.571 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.4628841876983643
Epoch: 48, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.549 Vali Acc: 0.889 Test Loss: 0.549 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.6717705726623535
Epoch: 49, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.542 Vali Acc: 0.883 Test Loss: 0.542 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.3668317794799805
Epoch: 50, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.551 Vali Acc: 0.889 Test Loss: 0.551 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.5528864860534668
Epoch: 51, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.575 Vali Acc: 0.883 Test Loss: 0.575 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.376582145690918
Epoch: 52, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.585 Vali Acc: 0.889 Test Loss: 0.585 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 1676467
model size : 8.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3562045097351074
Epoch: 1, Steps: 12 | Train Loss: 2.801 Vali Loss: 2.753 Vali Acc: 0.022 Test Loss: 2.753 Test Acc: 0.022
Validation loss decreased (inf --> -0.022195).  Saving model ...
Epoch: 2 cost time: 1.232093095779419
Epoch: 2, Steps: 12 | Train Loss: 2.701 Vali Loss: 2.626 Vali Acc: 0.122 Test Loss: 2.626 Test Acc: 0.122
Validation loss decreased (-0.022195 --> -0.122196).  Saving model ...
Epoch: 3 cost time: 1.2219469547271729
Epoch: 3, Steps: 12 | Train Loss: 2.591 Vali Loss: 2.494 Vali Acc: 0.278 Test Loss: 2.494 Test Acc: 0.278
Validation loss decreased (-0.122196 --> -0.277753).  Saving model ...
Epoch: 4 cost time: 1.5245521068572998
Epoch: 4, Steps: 12 | Train Loss: 2.386 Vali Loss: 2.277 Vali Acc: 0.428 Test Loss: 2.277 Test Acc: 0.428
Validation loss decreased (-0.277753 --> -0.427755).  Saving model ...
Epoch: 5 cost time: 1.2991523742675781
Epoch: 5, Steps: 12 | Train Loss: 2.133 Vali Loss: 2.088 Vali Acc: 0.483 Test Loss: 2.088 Test Acc: 0.483
Validation loss decreased (-0.427755 --> -0.483312).  Saving model ...
Epoch: 6 cost time: 1.6124494075775146
Epoch: 6, Steps: 12 | Train Loss: 1.864 Vali Loss: 1.878 Vali Acc: 0.533 Test Loss: 1.878 Test Acc: 0.533
Validation loss decreased (-0.483312 --> -0.533315).  Saving model ...
Epoch: 7 cost time: 1.321390151977539
Epoch: 7, Steps: 12 | Train Loss: 1.644 Vali Loss: 1.634 Vali Acc: 0.561 Test Loss: 1.634 Test Acc: 0.561
Validation loss decreased (-0.533315 --> -0.561095).  Saving model ...
Epoch: 8 cost time: 1.502915859222412
Epoch: 8, Steps: 12 | Train Loss: 1.406 Vali Loss: 1.449 Vali Acc: 0.589 Test Loss: 1.449 Test Acc: 0.589
Validation loss decreased (-0.561095 --> -0.588874).  Saving model ...
Epoch: 9 cost time: 1.4451978206634521
Epoch: 9, Steps: 12 | Train Loss: 1.209 Vali Loss: 1.313 Vali Acc: 0.661 Test Loss: 1.313 Test Acc: 0.661
Validation loss decreased (-0.588874 --> -0.661098).  Saving model ...
Epoch: 10 cost time: 1.4851012229919434
Epoch: 10, Steps: 12 | Train Loss: 1.062 Vali Loss: 1.185 Vali Acc: 0.661 Test Loss: 1.185 Test Acc: 0.661
Validation loss decreased (-0.661098 --> -0.661099).  Saving model ...
Epoch: 11 cost time: 1.4119911193847656
Epoch: 11, Steps: 12 | Train Loss: 0.956 Vali Loss: 1.066 Vali Acc: 0.711 Test Loss: 1.066 Test Acc: 0.711
Validation loss decreased (-0.661099 --> -0.711100).  Saving model ...
Epoch: 12 cost time: 1.6965274810791016
Epoch: 12, Steps: 12 | Train Loss: 0.795 Vali Loss: 0.986 Vali Acc: 0.694 Test Loss: 0.986 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4861679077148438
Epoch: 13, Steps: 12 | Train Loss: 0.725 Vali Loss: 0.891 Vali Acc: 0.739 Test Loss: 0.891 Test Acc: 0.739
Validation loss decreased (-0.711100 --> -0.738880).  Saving model ...
Epoch: 14 cost time: 1.3034462928771973
Epoch: 14, Steps: 12 | Train Loss: 0.639 Vali Loss: 0.865 Vali Acc: 0.772 Test Loss: 0.865 Test Acc: 0.772
Validation loss decreased (-0.738880 --> -0.772214).  Saving model ...
Epoch: 15 cost time: 1.5060491561889648
Epoch: 15, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.787 Vali Acc: 0.778 Test Loss: 0.787 Test Acc: 0.778
Validation loss decreased (-0.772214 --> -0.777770).  Saving model ...
Epoch: 16 cost time: 1.5500357151031494
Epoch: 16, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.743 Vali Acc: 0.806 Test Loss: 0.743 Test Acc: 0.806
Validation loss decreased (-0.777770 --> -0.805548).  Saving model ...
Epoch: 17 cost time: 1.3538806438446045
Epoch: 17, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.713 Vali Acc: 0.811 Test Loss: 0.713 Test Acc: 0.811
Validation loss decreased (-0.805548 --> -0.811104).  Saving model ...
Epoch: 18 cost time: 1.559727668762207
Epoch: 18, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.708 Vali Acc: 0.794 Test Loss: 0.708 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3697144985198975
Epoch: 19, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.629 Vali Acc: 0.822 Test Loss: 0.629 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822216).  Saving model ...
Epoch: 20 cost time: 1.342175006866455
Epoch: 20, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.592 Vali Acc: 0.839 Test Loss: 0.592 Test Acc: 0.839
Validation loss decreased (-0.822216 --> -0.838883).  Saving model ...
Epoch: 21 cost time: 1.2601265907287598
Epoch: 21, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.517 Vali Acc: 0.856 Test Loss: 0.517 Test Acc: 0.856
Validation loss decreased (-0.838883 --> -0.855550).  Saving model ...
Epoch: 22 cost time: 1.389232873916626
Epoch: 22, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.502 Vali Acc: 0.861 Test Loss: 0.502 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 23 cost time: 1.271491527557373
Epoch: 23, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.544 Vali Acc: 0.872 Test Loss: 0.544 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 24 cost time: 1.373718500137329
Epoch: 24, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.502 Vali Acc: 0.861 Test Loss: 0.502 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3775591850280762
Epoch: 25, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.484 Vali Acc: 0.872 Test Loss: 0.484 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 26 cost time: 1.4622764587402344
Epoch: 26, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.522 Vali Acc: 0.883 Test Loss: 0.522 Test Acc: 0.883
Validation loss decreased (-0.872217 --> -0.883328).  Saving model ...
Epoch: 27 cost time: 1.4409496784210205
Epoch: 27, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.528 Vali Acc: 0.867 Test Loss: 0.528 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.469236135482788
Epoch: 28, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.509 Vali Acc: 0.872 Test Loss: 0.509 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.4638564586639404
Epoch: 29, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.545 Vali Acc: 0.889 Test Loss: 0.545 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888883).  Saving model ...
Epoch: 30 cost time: 1.3611981868743896
Epoch: 30, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.536 Vali Acc: 0.867 Test Loss: 0.536 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.429502010345459
Epoch: 31, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.535 Vali Acc: 0.889 Test Loss: 0.535 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888884).  Saving model ...
Epoch: 32 cost time: 1.3503704071044922
Epoch: 32, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.553 Vali Acc: 0.878 Test Loss: 0.553 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.5212922096252441
Epoch: 33, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.566 Vali Acc: 0.883 Test Loss: 0.566 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.721198320388794
Epoch: 34, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.560 Vali Acc: 0.878 Test Loss: 0.560 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.5616271495819092
Epoch: 35, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.581 Vali Acc: 0.894 Test Loss: 0.581 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894439).  Saving model ...
Epoch: 36 cost time: 1.4897994995117188
Epoch: 36, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.539 Vali Acc: 0.889 Test Loss: 0.539 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2846057415008545
Epoch: 37, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.595 Vali Acc: 0.889 Test Loss: 0.595 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.3585829734802246
Epoch: 38, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.582 Vali Acc: 0.894 Test Loss: 0.582 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.2799477577209473
Epoch: 39, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.573 Vali Acc: 0.872 Test Loss: 0.573 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.3451910018920898
Epoch: 40, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.581 Vali Acc: 0.906 Test Loss: 0.581 Test Acc: 0.906
Validation loss decreased (-0.894439 --> -0.905550).  Saving model ...
Epoch: 41 cost time: 1.3065321445465088
Epoch: 41, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.579 Vali Acc: 0.889 Test Loss: 0.579 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.42014479637146
Epoch: 42, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.648 Vali Acc: 0.878 Test Loss: 0.648 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.6179604530334473
Epoch: 43, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.570 Vali Acc: 0.883 Test Loss: 0.570 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.5290517807006836
Epoch: 44, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.589 Vali Acc: 0.894 Test Loss: 0.589 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.2605769634246826
Epoch: 45, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.610 Vali Acc: 0.883 Test Loss: 0.610 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.54756760597229
Epoch: 46, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.622 Vali Acc: 0.878 Test Loss: 0.622 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.3249423503875732
Epoch: 47, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.733 Vali Acc: 0.872 Test Loss: 0.733 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.458848476409912
Epoch: 48, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.702 Vali Acc: 0.861 Test Loss: 0.702 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.5484628677368164
Epoch: 49, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.641 Vali Acc: 0.861 Test Loss: 0.641 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.4420280456542969
Epoch: 50, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.682 Vali Acc: 0.878 Test Loss: 0.682 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 1675699
model size : 8.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7227988243103027
Epoch: 1, Steps: 12 | Train Loss: 2.830 Vali Loss: 2.699 Vali Acc: 0.089 Test Loss: 2.699 Test Acc: 0.089
Validation loss decreased (inf --> -0.088862).  Saving model ...
Epoch: 2 cost time: 1.7749581336975098
Epoch: 2, Steps: 12 | Train Loss: 2.677 Vali Loss: 2.546 Vali Acc: 0.278 Test Loss: 2.546 Test Acc: 0.278
Validation loss decreased (-0.088862 --> -0.277752).  Saving model ...
Epoch: 3 cost time: 1.8951992988586426
Epoch: 3, Steps: 12 | Train Loss: 2.489 Vali Loss: 2.393 Vali Acc: 0.333 Test Loss: 2.393 Test Acc: 0.333
Validation loss decreased (-0.277752 --> -0.333309).  Saving model ...
Epoch: 4 cost time: 1.3704071044921875
Epoch: 4, Steps: 12 | Train Loss: 2.271 Vali Loss: 2.204 Vali Acc: 0.400 Test Loss: 2.204 Test Acc: 0.400
Validation loss decreased (-0.333309 --> -0.399978).  Saving model ...
Epoch: 5 cost time: 1.3422045707702637
Epoch: 5, Steps: 12 | Train Loss: 2.022 Vali Loss: 1.957 Vali Acc: 0.522 Test Loss: 1.957 Test Acc: 0.522
Validation loss decreased (-0.399978 --> -0.522203).  Saving model ...
Epoch: 6 cost time: 1.6651196479797363
Epoch: 6, Steps: 12 | Train Loss: 1.752 Vali Loss: 1.756 Vali Acc: 0.472 Test Loss: 1.756 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.101689577102661
Epoch: 7, Steps: 12 | Train Loss: 1.548 Vali Loss: 1.591 Vali Acc: 0.578 Test Loss: 1.591 Test Acc: 0.578
Validation loss decreased (-0.522203 --> -0.577762).  Saving model ...
Epoch: 8 cost time: 1.3101515769958496
Epoch: 8, Steps: 12 | Train Loss: 1.374 Vali Loss: 1.426 Vali Acc: 0.606 Test Loss: 1.426 Test Acc: 0.606
Validation loss decreased (-0.577762 --> -0.605541).  Saving model ...
Epoch: 9 cost time: 1.1858248710632324
Epoch: 9, Steps: 12 | Train Loss: 1.205 Vali Loss: 1.302 Vali Acc: 0.644 Test Loss: 1.302 Test Acc: 0.644
Validation loss decreased (-0.605541 --> -0.644431).  Saving model ...
Epoch: 10 cost time: 1.3269119262695312
Epoch: 10, Steps: 12 | Train Loss: 1.062 Vali Loss: 1.166 Vali Acc: 0.661 Test Loss: 1.166 Test Acc: 0.661
Validation loss decreased (-0.644431 --> -0.661099).  Saving model ...
Epoch: 11 cost time: 1.340852975845337
Epoch: 11, Steps: 12 | Train Loss: 0.953 Vali Loss: 1.063 Vali Acc: 0.700 Test Loss: 1.063 Test Acc: 0.700
Validation loss decreased (-0.661099 --> -0.699989).  Saving model ...
Epoch: 12 cost time: 1.4520587921142578
Epoch: 12, Steps: 12 | Train Loss: 0.802 Vali Loss: 0.983 Vali Acc: 0.739 Test Loss: 0.983 Test Acc: 0.739
Validation loss decreased (-0.699989 --> -0.738879).  Saving model ...
Epoch: 13 cost time: 1.330338478088379
Epoch: 13, Steps: 12 | Train Loss: 0.745 Vali Loss: 0.901 Vali Acc: 0.711 Test Loss: 0.901 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.398747205734253
Epoch: 14, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.852 Vali Acc: 0.739 Test Loss: 0.852 Test Acc: 0.739
Validation loss decreased (-0.738879 --> -0.738880).  Saving model ...
Epoch: 15 cost time: 1.3825151920318604
Epoch: 15, Steps: 12 | Train Loss: 0.590 Vali Loss: 0.776 Vali Acc: 0.728 Test Loss: 0.776 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3012607097625732
Epoch: 16, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.698 Vali Acc: 0.761 Test Loss: 0.698 Test Acc: 0.761
Validation loss decreased (-0.738880 --> -0.761104).  Saving model ...
Epoch: 17 cost time: 1.5518052577972412
Epoch: 17, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.661 Vali Acc: 0.772 Test Loss: 0.661 Test Acc: 0.772
Validation loss decreased (-0.761104 --> -0.772216).  Saving model ...
Epoch: 18 cost time: 1.5141756534576416
Epoch: 18, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.637 Vali Acc: 0.806 Test Loss: 0.637 Test Acc: 0.806
Validation loss decreased (-0.772216 --> -0.805549).  Saving model ...
Epoch: 19 cost time: 1.4740257263183594
Epoch: 19, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.567 Vali Acc: 0.833 Test Loss: 0.567 Test Acc: 0.833
Validation loss decreased (-0.805549 --> -0.833328).  Saving model ...
Epoch: 20 cost time: 1.6008141040802002
Epoch: 20, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.521 Vali Acc: 0.861 Test Loss: 0.521 Test Acc: 0.861
Validation loss decreased (-0.833328 --> -0.861106).  Saving model ...
Epoch: 21 cost time: 1.581141710281372
Epoch: 21, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.518 Vali Acc: 0.867 Test Loss: 0.518 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 22 cost time: 1.4137921333312988
Epoch: 22, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.494 Vali Acc: 0.856 Test Loss: 0.494 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4413461685180664
Epoch: 23, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.514 Vali Acc: 0.850 Test Loss: 0.514 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7827720642089844
Epoch: 24, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.479 Vali Acc: 0.883 Test Loss: 0.479 Test Acc: 0.883
Validation loss decreased (-0.866661 --> -0.883329).  Saving model ...
Epoch: 25 cost time: 1.5184555053710938
Epoch: 25, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.446 Vali Acc: 0.872 Test Loss: 0.446 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6278858184814453
Epoch: 26, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.488 Vali Acc: 0.883 Test Loss: 0.488 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.5831470489501953
Epoch: 27, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.492 Vali Acc: 0.850 Test Loss: 0.492 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.3474173545837402
Epoch: 28, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.561 Vali Acc: 0.822 Test Loss: 0.561 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.4867243766784668
Epoch: 29, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.473 Vali Acc: 0.861 Test Loss: 0.473 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.5666327476501465
Epoch: 30, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.634 Vali Acc: 0.839 Test Loss: 0.634 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.0937623977661133
Epoch: 31, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.455 Vali Acc: 0.872 Test Loss: 0.455 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.903862476348877
Epoch: 32, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.464 Vali Acc: 0.883 Test Loss: 0.464 Test Acc: 0.883
Validation loss decreased (-0.883329 --> -0.883329).  Saving model ...
Epoch: 33 cost time: 1.9070816040039062
Epoch: 33, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.475 Vali Acc: 0.872 Test Loss: 0.475 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.8251445293426514
Epoch: 34, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.491 Vali Acc: 0.889 Test Loss: 0.491 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888884).  Saving model ...
Epoch: 35 cost time: 1.4816522598266602
Epoch: 35, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.482 Vali Acc: 0.872 Test Loss: 0.482 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.5633914470672607
Epoch: 36, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.486 Vali Acc: 0.883 Test Loss: 0.486 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.6293246746063232
Epoch: 37, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.509 Vali Acc: 0.878 Test Loss: 0.509 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.4646620750427246
Epoch: 38, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.504 Vali Acc: 0.878 Test Loss: 0.504 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.5934550762176514
Epoch: 39, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.500 Vali Acc: 0.889 Test Loss: 0.500 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.7027170658111572
Epoch: 40, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.573 Vali Acc: 0.878 Test Loss: 0.573 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.4958081245422363
Epoch: 41, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.612 Vali Acc: 0.856 Test Loss: 0.612 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.3597073554992676
Epoch: 42, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.547 Vali Acc: 0.872 Test Loss: 0.547 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.535804033279419
Epoch: 43, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.534 Vali Acc: 0.872 Test Loss: 0.534 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.9193534851074219
Epoch: 44, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.499 Vali Acc: 0.872 Test Loss: 0.499 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 1674931
model size : 8.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.343177556991577
Epoch: 1, Steps: 12 | Train Loss: 2.979 Vali Loss: 2.888 Vali Acc: 0.039 Test Loss: 2.888 Test Acc: 0.039
Validation loss decreased (inf --> -0.038860).  Saving model ...
Epoch: 2 cost time: 1.2303879261016846
Epoch: 2, Steps: 12 | Train Loss: 2.788 Vali Loss: 2.705 Vali Acc: 0.117 Test Loss: 2.705 Test Acc: 0.117
Validation loss decreased (-0.038860 --> -0.116640).  Saving model ...
Epoch: 3 cost time: 1.5165469646453857
Epoch: 3, Steps: 12 | Train Loss: 2.655 Vali Loss: 2.544 Vali Acc: 0.261 Test Loss: 2.544 Test Acc: 0.261
Validation loss decreased (-0.116640 --> -0.261086).  Saving model ...
Epoch: 4 cost time: 1.885486125946045
Epoch: 4, Steps: 12 | Train Loss: 2.476 Vali Loss: 2.367 Vali Acc: 0.344 Test Loss: 2.367 Test Acc: 0.344
Validation loss decreased (-0.261086 --> -0.344421).  Saving model ...
Epoch: 5 cost time: 1.3280797004699707
Epoch: 5, Steps: 12 | Train Loss: 2.212 Vali Loss: 2.143 Vali Acc: 0.506 Test Loss: 2.143 Test Acc: 0.506
Validation loss decreased (-0.344421 --> -0.505534).  Saving model ...
Epoch: 6 cost time: 1.5356998443603516
Epoch: 6, Steps: 12 | Train Loss: 1.943 Vali Loss: 1.912 Vali Acc: 0.528 Test Loss: 1.912 Test Acc: 0.528
Validation loss decreased (-0.505534 --> -0.527759).  Saving model ...
Epoch: 7 cost time: 1.4384641647338867
Epoch: 7, Steps: 12 | Train Loss: 1.654 Vali Loss: 1.674 Vali Acc: 0.556 Test Loss: 1.674 Test Acc: 0.556
Validation loss decreased (-0.527759 --> -0.555539).  Saving model ...
Epoch: 8 cost time: 1.4552452564239502
Epoch: 8, Steps: 12 | Train Loss: 1.514 Vali Loss: 1.469 Vali Acc: 0.606 Test Loss: 1.469 Test Acc: 0.606
Validation loss decreased (-0.555539 --> -0.605541).  Saving model ...
Epoch: 9 cost time: 1.5463554859161377
Epoch: 9, Steps: 12 | Train Loss: 1.233 Vali Loss: 1.310 Vali Acc: 0.656 Test Loss: 1.310 Test Acc: 0.656
Validation loss decreased (-0.605541 --> -0.655542).  Saving model ...
Epoch: 10 cost time: 1.189070224761963
Epoch: 10, Steps: 12 | Train Loss: 1.095 Vali Loss: 1.215 Vali Acc: 0.633 Test Loss: 1.215 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6774661540985107
Epoch: 11, Steps: 12 | Train Loss: 0.926 Vali Loss: 1.085 Vali Acc: 0.661 Test Loss: 1.085 Test Acc: 0.661
Validation loss decreased (-0.655542 --> -0.661100).  Saving model ...
Epoch: 12 cost time: 1.4437673091888428
Epoch: 12, Steps: 12 | Train Loss: 0.814 Vali Loss: 0.957 Vali Acc: 0.683 Test Loss: 0.957 Test Acc: 0.683
Validation loss decreased (-0.661100 --> -0.683324).  Saving model ...
Epoch: 13 cost time: 1.9557082653045654
Epoch: 13, Steps: 12 | Train Loss: 0.755 Vali Loss: 0.891 Vali Acc: 0.717 Test Loss: 0.891 Test Acc: 0.717
Validation loss decreased (-0.683324 --> -0.716658).  Saving model ...
Epoch: 14 cost time: 1.401888370513916
Epoch: 14, Steps: 12 | Train Loss: 0.633 Vali Loss: 0.792 Vali Acc: 0.767 Test Loss: 0.792 Test Acc: 0.767
Validation loss decreased (-0.716658 --> -0.766659).  Saving model ...
Epoch: 15 cost time: 1.191826343536377
Epoch: 15, Steps: 12 | Train Loss: 0.556 Vali Loss: 0.765 Vali Acc: 0.778 Test Loss: 0.765 Test Acc: 0.778
Validation loss decreased (-0.766659 --> -0.777770).  Saving model ...
Epoch: 16 cost time: 1.150592565536499
Epoch: 16, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.687 Vali Acc: 0.789 Test Loss: 0.687 Test Acc: 0.789
Validation loss decreased (-0.777770 --> -0.788882).  Saving model ...
Epoch: 17 cost time: 2.118696928024292
Epoch: 17, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.649 Vali Acc: 0.811 Test Loss: 0.649 Test Acc: 0.811
Validation loss decreased (-0.788882 --> -0.811105).  Saving model ...
Epoch: 18 cost time: 1.4041047096252441
Epoch: 18, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.631 Vali Acc: 0.806 Test Loss: 0.631 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5377066135406494
Epoch: 19, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.573 Vali Acc: 0.817 Test Loss: 0.573 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816661).  Saving model ...
Epoch: 20 cost time: 1.5488579273223877
Epoch: 20, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.508 Vali Acc: 0.856 Test Loss: 0.508 Test Acc: 0.856
Validation loss decreased (-0.816661 --> -0.855550).  Saving model ...
Epoch: 21 cost time: 1.7776002883911133
Epoch: 21, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.473 Vali Acc: 0.867 Test Loss: 0.473 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866662).  Saving model ...
Epoch: 22 cost time: 1.5466482639312744
Epoch: 22, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.533 Vali Acc: 0.844 Test Loss: 0.533 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9467484951019287
Epoch: 23, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.501 Vali Acc: 0.878 Test Loss: 0.501 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877773).  Saving model ...
Epoch: 24 cost time: 1.507652997970581
Epoch: 24, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.454 Vali Acc: 0.872 Test Loss: 0.454 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4841206073760986
Epoch: 25, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.459 Vali Acc: 0.883 Test Loss: 0.459 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883329).  Saving model ...
Epoch: 26 cost time: 1.8847005367279053
Epoch: 26, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.465 Vali Acc: 0.883 Test Loss: 0.465 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7383925914764404
Epoch: 27, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.476 Vali Acc: 0.894 Test Loss: 0.476 Test Acc: 0.894
Validation loss decreased (-0.883329 --> -0.894440).  Saving model ...
Epoch: 28 cost time: 1.7898385524749756
Epoch: 28, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.495 Vali Acc: 0.894 Test Loss: 0.495 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.8859224319458008
Epoch: 29, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.499 Vali Acc: 0.883 Test Loss: 0.499 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.6961519718170166
Epoch: 30, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.536 Vali Acc: 0.867 Test Loss: 0.536 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.7244837284088135
Epoch: 31, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.526 Vali Acc: 0.861 Test Loss: 0.526 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.8979864120483398
Epoch: 32, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.538 Vali Acc: 0.894 Test Loss: 0.538 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.5814414024353027
Epoch: 33, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.499 Vali Acc: 0.878 Test Loss: 0.499 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.7302353382110596
Epoch: 34, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.518 Vali Acc: 0.867 Test Loss: 0.518 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.8066222667694092
Epoch: 35, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.493 Vali Acc: 0.894 Test Loss: 0.493 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.691925287246704
Epoch: 36, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.568 Vali Acc: 0.878 Test Loss: 0.568 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.6390571594238281
Epoch: 37, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.528 Vali Acc: 0.883 Test Loss: 0.528 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 1674163
model size : 8.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.553441286087036
Epoch: 1, Steps: 12 | Train Loss: 2.851 Vali Loss: 2.693 Vali Acc: 0.139 Test Loss: 2.693 Test Acc: 0.139
Validation loss decreased (inf --> -0.138862).  Saving model ...
Epoch: 2 cost time: 1.3779387474060059
Epoch: 2, Steps: 12 | Train Loss: 2.659 Vali Loss: 2.570 Vali Acc: 0.211 Test Loss: 2.570 Test Acc: 0.211
Validation loss decreased (-0.138862 --> -0.211085).  Saving model ...
Epoch: 3 cost time: 1.3483555316925049
Epoch: 3, Steps: 12 | Train Loss: 2.520 Vali Loss: 2.436 Vali Acc: 0.300 Test Loss: 2.436 Test Acc: 0.300
Validation loss decreased (-0.211085 --> -0.299976).  Saving model ...
Epoch: 4 cost time: 1.4188780784606934
Epoch: 4, Steps: 12 | Train Loss: 2.334 Vali Loss: 2.281 Vali Acc: 0.389 Test Loss: 2.281 Test Acc: 0.389
Validation loss decreased (-0.299976 --> -0.388866).  Saving model ...
Epoch: 5 cost time: 1.3386898040771484
Epoch: 5, Steps: 12 | Train Loss: 2.099 Vali Loss: 2.077 Vali Acc: 0.478 Test Loss: 2.077 Test Acc: 0.478
Validation loss decreased (-0.388866 --> -0.477757).  Saving model ...
Epoch: 6 cost time: 1.8022642135620117
Epoch: 6, Steps: 12 | Train Loss: 1.874 Vali Loss: 1.896 Vali Acc: 0.578 Test Loss: 1.896 Test Acc: 0.578
Validation loss decreased (-0.477757 --> -0.577759).  Saving model ...
Epoch: 7 cost time: 1.7486209869384766
Epoch: 7, Steps: 12 | Train Loss: 1.632 Vali Loss: 1.702 Vali Acc: 0.572 Test Loss: 1.702 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8675248622894287
Epoch: 8, Steps: 12 | Train Loss: 1.465 Vali Loss: 1.537 Vali Acc: 0.600 Test Loss: 1.537 Test Acc: 0.600
Validation loss decreased (-0.577759 --> -0.599985).  Saving model ...
Epoch: 9 cost time: 1.4718434810638428
Epoch: 9, Steps: 12 | Train Loss: 1.253 Vali Loss: 1.392 Vali Acc: 0.633 Test Loss: 1.392 Test Acc: 0.633
Validation loss decreased (-0.599985 --> -0.633319).  Saving model ...
Epoch: 10 cost time: 1.6214025020599365
Epoch: 10, Steps: 12 | Train Loss: 1.142 Vali Loss: 1.229 Vali Acc: 0.656 Test Loss: 1.229 Test Acc: 0.656
Validation loss decreased (-0.633319 --> -0.655543).  Saving model ...
Epoch: 11 cost time: 1.372497320175171
Epoch: 11, Steps: 12 | Train Loss: 0.996 Vali Loss: 1.149 Vali Acc: 0.667 Test Loss: 1.149 Test Acc: 0.667
Validation loss decreased (-0.655543 --> -0.666655).  Saving model ...
Epoch: 12 cost time: 1.8068780899047852
Epoch: 12, Steps: 12 | Train Loss: 0.904 Vali Loss: 1.069 Vali Acc: 0.678 Test Loss: 1.069 Test Acc: 0.678
Validation loss decreased (-0.666655 --> -0.677767).  Saving model ...
Epoch: 13 cost time: 1.4769742488861084
Epoch: 13, Steps: 12 | Train Loss: 0.801 Vali Loss: 1.043 Vali Acc: 0.689 Test Loss: 1.043 Test Acc: 0.689
Validation loss decreased (-0.677767 --> -0.688878).  Saving model ...
Epoch: 14 cost time: 1.8355200290679932
Epoch: 14, Steps: 12 | Train Loss: 0.712 Vali Loss: 0.901 Vali Acc: 0.750 Test Loss: 0.901 Test Acc: 0.750
Validation loss decreased (-0.688878 --> -0.749991).  Saving model ...
Epoch: 15 cost time: 1.486351490020752
Epoch: 15, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.822 Vali Acc: 0.739 Test Loss: 0.822 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.56172513961792
Epoch: 16, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.777 Vali Acc: 0.772 Test Loss: 0.777 Test Acc: 0.772
Validation loss decreased (-0.749991 --> -0.772214).  Saving model ...
Epoch: 17 cost time: 1.9553298950195312
Epoch: 17, Steps: 12 | Train Loss: 0.559 Vali Loss: 0.750 Vali Acc: 0.756 Test Loss: 0.750 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.765296220779419
Epoch: 18, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.641 Vali Acc: 0.806 Test Loss: 0.641 Test Acc: 0.806
Validation loss decreased (-0.772214 --> -0.805549).  Saving model ...
Epoch: 19 cost time: 2.1791234016418457
Epoch: 19, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.627 Vali Acc: 0.828 Test Loss: 0.627 Test Acc: 0.828
Validation loss decreased (-0.805549 --> -0.827772).  Saving model ...
Epoch: 20 cost time: 1.8241353034973145
Epoch: 20, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.570 Vali Acc: 0.828 Test Loss: 0.570 Test Acc: 0.828
Validation loss decreased (-0.827772 --> -0.827772).  Saving model ...
Epoch: 21 cost time: 1.5944709777832031
Epoch: 21, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.522 Vali Acc: 0.867 Test Loss: 0.522 Test Acc: 0.867
Validation loss decreased (-0.827772 --> -0.866661).  Saving model ...
Epoch: 22 cost time: 1.4344432353973389
Epoch: 22, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.558 Vali Acc: 0.861 Test Loss: 0.558 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.518848180770874
Epoch: 23, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.535 Vali Acc: 0.867 Test Loss: 0.535 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.738586664199829
Epoch: 24, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.530 Vali Acc: 0.861 Test Loss: 0.530 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.7338871955871582
Epoch: 25, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.530 Vali Acc: 0.878 Test Loss: 0.530 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877772).  Saving model ...
Epoch: 26 cost time: 2.094895839691162
Epoch: 26, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.497 Vali Acc: 0.878 Test Loss: 0.497 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877773).  Saving model ...
Epoch: 27 cost time: 1.427682876586914
Epoch: 27, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.525 Vali Acc: 0.856 Test Loss: 0.525 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3372347354888916
Epoch: 28, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.548 Vali Acc: 0.856 Test Loss: 0.548 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3019635677337646
Epoch: 29, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.479 Vali Acc: 0.878 Test Loss: 0.479 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 30 cost time: 1.4435312747955322
Epoch: 30, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.519 Vali Acc: 0.894 Test Loss: 0.519 Test Acc: 0.894
Validation loss decreased (-0.877773 --> -0.894439).  Saving model ...
Epoch: 31 cost time: 1.4876787662506104
Epoch: 31, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.498 Vali Acc: 0.872 Test Loss: 0.498 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.9126861095428467
Epoch: 32, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.511 Vali Acc: 0.883 Test Loss: 0.511 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.7703430652618408
Epoch: 33, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.604 Vali Acc: 0.844 Test Loss: 0.604 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.5703659057617188
Epoch: 34, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.593 Vali Acc: 0.861 Test Loss: 0.593 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.3725929260253906
Epoch: 35, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.617 Vali Acc: 0.872 Test Loss: 0.617 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.7235805988311768
Epoch: 36, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.554 Vali Acc: 0.867 Test Loss: 0.554 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.5063230991363525
Epoch: 37, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.556 Vali Acc: 0.883 Test Loss: 0.556 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.4857497215270996
Epoch: 38, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.550 Vali Acc: 0.889 Test Loss: 0.550 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.3484537601470947
Epoch: 39, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.540 Vali Acc: 0.889 Test Loss: 0.540 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.3988847732543945
Epoch: 40, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.531 Vali Acc: 0.889 Test Loss: 0.531 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 1511987
model size : 8.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9819090366363525
Epoch: 1, Steps: 12 | Train Loss: 2.920 Vali Loss: 2.804 Vali Acc: 0.083 Test Loss: 2.804 Test Acc: 0.083
Validation loss decreased (inf --> -0.083305).  Saving model ...
Epoch: 2 cost time: 2.0927894115448
Epoch: 2, Steps: 12 | Train Loss: 2.760 Vali Loss: 2.659 Vali Acc: 0.111 Test Loss: 2.659 Test Acc: 0.111
Validation loss decreased (-0.083305 --> -0.111085).  Saving model ...
Epoch: 3 cost time: 1.325042486190796
Epoch: 3, Steps: 12 | Train Loss: 2.665 Vali Loss: 2.540 Vali Acc: 0.189 Test Loss: 2.540 Test Acc: 0.189
Validation loss decreased (-0.111085 --> -0.188863).  Saving model ...
Epoch: 4 cost time: 1.4368066787719727
Epoch: 4, Steps: 12 | Train Loss: 2.440 Vali Loss: 2.392 Vali Acc: 0.328 Test Loss: 2.392 Test Acc: 0.328
Validation loss decreased (-0.188863 --> -0.327754).  Saving model ...
Epoch: 5 cost time: 1.5742261409759521
Epoch: 5, Steps: 12 | Train Loss: 2.267 Vali Loss: 2.225 Vali Acc: 0.394 Test Loss: 2.225 Test Acc: 0.394
Validation loss decreased (-0.327754 --> -0.394422).  Saving model ...
Epoch: 6 cost time: 1.4874134063720703
Epoch: 6, Steps: 12 | Train Loss: 2.021 Vali Loss: 2.018 Vali Acc: 0.411 Test Loss: 2.018 Test Acc: 0.411
Validation loss decreased (-0.394422 --> -0.411091).  Saving model ...
Epoch: 7 cost time: 1.4311506748199463
Epoch: 7, Steps: 12 | Train Loss: 1.803 Vali Loss: 1.822 Vali Acc: 0.544 Test Loss: 1.822 Test Acc: 0.544
Validation loss decreased (-0.411091 --> -0.544426).  Saving model ...
Epoch: 8 cost time: 1.417367935180664
Epoch: 8, Steps: 12 | Train Loss: 1.564 Vali Loss: 1.617 Vali Acc: 0.539 Test Loss: 1.617 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6830105781555176
Epoch: 9, Steps: 12 | Train Loss: 1.297 Vali Loss: 1.397 Vali Acc: 0.639 Test Loss: 1.397 Test Acc: 0.639
Validation loss decreased (-0.544426 --> -0.638875).  Saving model ...
Epoch: 10 cost time: 1.472533941268921
Epoch: 10, Steps: 12 | Train Loss: 1.159 Vali Loss: 1.255 Vali Acc: 0.622 Test Loss: 1.255 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.542809247970581
Epoch: 11, Steps: 12 | Train Loss: 0.961 Vali Loss: 1.112 Vali Acc: 0.706 Test Loss: 1.112 Test Acc: 0.706
Validation loss decreased (-0.638875 --> -0.705544).  Saving model ...
Epoch: 12 cost time: 1.4651875495910645
Epoch: 12, Steps: 12 | Train Loss: 0.867 Vali Loss: 1.028 Vali Acc: 0.717 Test Loss: 1.028 Test Acc: 0.717
Validation loss decreased (-0.705544 --> -0.716656).  Saving model ...
Epoch: 13 cost time: 1.2670040130615234
Epoch: 13, Steps: 12 | Train Loss: 0.742 Vali Loss: 0.986 Vali Acc: 0.756 Test Loss: 0.986 Test Acc: 0.756
Validation loss decreased (-0.716656 --> -0.755546).  Saving model ...
Epoch: 14 cost time: 1.219236135482788
Epoch: 14, Steps: 12 | Train Loss: 0.726 Vali Loss: 0.918 Vali Acc: 0.728 Test Loss: 0.918 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5284957885742188
Epoch: 15, Steps: 12 | Train Loss: 0.575 Vali Loss: 0.848 Vali Acc: 0.750 Test Loss: 0.848 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8912379741668701
Epoch: 16, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.736 Vali Acc: 0.767 Test Loss: 0.736 Test Acc: 0.767
Validation loss decreased (-0.755546 --> -0.766659).  Saving model ...
Epoch: 17 cost time: 1.445244312286377
Epoch: 17, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.691 Vali Acc: 0.772 Test Loss: 0.691 Test Acc: 0.772
Validation loss decreased (-0.766659 --> -0.772215).  Saving model ...
Epoch: 18 cost time: 1.2185349464416504
Epoch: 18, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.690 Vali Acc: 0.778 Test Loss: 0.690 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777771).  Saving model ...
Epoch: 19 cost time: 1.4248046875
Epoch: 19, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.591 Vali Acc: 0.828 Test Loss: 0.591 Test Acc: 0.828
Validation loss decreased (-0.777771 --> -0.827772).  Saving model ...
Epoch: 20 cost time: 1.4139862060546875
Epoch: 20, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.557 Vali Acc: 0.839 Test Loss: 0.557 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838883).  Saving model ...
Epoch: 21 cost time: 1.2872076034545898
Epoch: 21, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.632 Vali Acc: 0.789 Test Loss: 0.632 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4820432662963867
Epoch: 22, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.510 Vali Acc: 0.867 Test Loss: 0.510 Test Acc: 0.867
Validation loss decreased (-0.838883 --> -0.866662).  Saving model ...
Epoch: 23 cost time: 1.2880430221557617
Epoch: 23, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.509 Vali Acc: 0.872 Test Loss: 0.509 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872217).  Saving model ...
Epoch: 24 cost time: 1.3313179016113281
Epoch: 24, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.482 Vali Acc: 0.867 Test Loss: 0.482 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3409409523010254
Epoch: 25, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.456 Vali Acc: 0.889 Test Loss: 0.456 Test Acc: 0.889
Validation loss decreased (-0.872217 --> -0.888884).  Saving model ...
Epoch: 26 cost time: 1.393965482711792
Epoch: 26, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.505 Vali Acc: 0.889 Test Loss: 0.505 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4743969440460205
Epoch: 27, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.466 Vali Acc: 0.894 Test Loss: 0.466 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894440).  Saving model ...
Epoch: 28 cost time: 1.2600042819976807
Epoch: 28, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.526 Vali Acc: 0.872 Test Loss: 0.526 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.455127239227295
Epoch: 29, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.527 Vali Acc: 0.889 Test Loss: 0.527 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.5141828060150146
Epoch: 30, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.512 Vali Acc: 0.872 Test Loss: 0.512 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.731266975402832
Epoch: 31, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.550 Vali Acc: 0.878 Test Loss: 0.550 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.2444357872009277
Epoch: 32, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.588 Vali Acc: 0.856 Test Loss: 0.588 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.3279545307159424
Epoch: 33, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.614 Vali Acc: 0.861 Test Loss: 0.614 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.464651346206665
Epoch: 34, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.540 Vali Acc: 0.883 Test Loss: 0.540 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.7079272270202637
Epoch: 35, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.536 Vali Acc: 0.883 Test Loss: 0.536 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.6261506080627441
Epoch: 36, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.587 Vali Acc: 0.883 Test Loss: 0.587 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.3573946952819824
Epoch: 37, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.574 Vali Acc: 0.883 Test Loss: 0.574 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 1511219
model size : 8.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.30649995803833
Epoch: 1, Steps: 12 | Train Loss: 2.862 Vali Loss: 2.775 Vali Acc: 0.122 Test Loss: 2.775 Test Acc: 0.122
Validation loss decreased (inf --> -0.122194).  Saving model ...
Epoch: 2 cost time: 1.2429943084716797
Epoch: 2, Steps: 12 | Train Loss: 2.756 Vali Loss: 2.666 Vali Acc: 0.183 Test Loss: 2.666 Test Acc: 0.183
Validation loss decreased (-0.122194 --> -0.183307).  Saving model ...
Epoch: 3 cost time: 1.5467662811279297
Epoch: 3, Steps: 12 | Train Loss: 2.627 Vali Loss: 2.541 Vali Acc: 0.289 Test Loss: 2.541 Test Acc: 0.289
Validation loss decreased (-0.183307 --> -0.288863).  Saving model ...
Epoch: 4 cost time: 1.669952630996704
Epoch: 4, Steps: 12 | Train Loss: 2.482 Vali Loss: 2.368 Vali Acc: 0.350 Test Loss: 2.368 Test Acc: 0.350
Validation loss decreased (-0.288863 --> -0.349976).  Saving model ...
Epoch: 5 cost time: 1.5159354209899902
Epoch: 5, Steps: 12 | Train Loss: 2.203 Vali Loss: 2.162 Vali Acc: 0.506 Test Loss: 2.162 Test Acc: 0.506
Validation loss decreased (-0.349976 --> -0.505534).  Saving model ...
Epoch: 6 cost time: 1.5176877975463867
Epoch: 6, Steps: 12 | Train Loss: 2.005 Vali Loss: 1.925 Vali Acc: 0.500 Test Loss: 1.925 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3495543003082275
Epoch: 7, Steps: 12 | Train Loss: 1.733 Vali Loss: 1.697 Vali Acc: 0.572 Test Loss: 1.697 Test Acc: 0.572
Validation loss decreased (-0.505534 --> -0.572205).  Saving model ...
Epoch: 8 cost time: 1.3367822170257568
Epoch: 8, Steps: 12 | Train Loss: 1.543 Vali Loss: 1.499 Vali Acc: 0.583 Test Loss: 1.499 Test Acc: 0.583
Validation loss decreased (-0.572205 --> -0.583318).  Saving model ...
Epoch: 9 cost time: 1.359867811203003
Epoch: 9, Steps: 12 | Train Loss: 1.280 Vali Loss: 1.324 Vali Acc: 0.667 Test Loss: 1.324 Test Acc: 0.667
Validation loss decreased (-0.583318 --> -0.666653).  Saving model ...
Epoch: 10 cost time: 1.484067678451538
Epoch: 10, Steps: 12 | Train Loss: 1.117 Vali Loss: 1.187 Vali Acc: 0.656 Test Loss: 1.187 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7606003284454346
Epoch: 11, Steps: 12 | Train Loss: 0.942 Vali Loss: 1.057 Vali Acc: 0.700 Test Loss: 1.057 Test Acc: 0.700
Validation loss decreased (-0.666653 --> -0.699989).  Saving model ...
Epoch: 12 cost time: 1.3615050315856934
Epoch: 12, Steps: 12 | Train Loss: 0.839 Vali Loss: 0.960 Vali Acc: 0.722 Test Loss: 0.960 Test Acc: 0.722
Validation loss decreased (-0.699989 --> -0.722213).  Saving model ...
Epoch: 13 cost time: 1.2569735050201416
Epoch: 13, Steps: 12 | Train Loss: 0.766 Vali Loss: 0.923 Vali Acc: 0.722 Test Loss: 0.923 Test Acc: 0.722
Validation loss decreased (-0.722213 --> -0.722213).  Saving model ...
Epoch: 14 cost time: 1.4498252868652344
Epoch: 14, Steps: 12 | Train Loss: 0.689 Vali Loss: 0.848 Vali Acc: 0.700 Test Loss: 0.848 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7041730880737305
Epoch: 15, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.767 Vali Acc: 0.750 Test Loss: 0.767 Test Acc: 0.750
Validation loss decreased (-0.722213 --> -0.749992).  Saving model ...
Epoch: 16 cost time: 1.478771686553955
Epoch: 16, Steps: 12 | Train Loss: 0.530 Vali Loss: 0.741 Vali Acc: 0.772 Test Loss: 0.741 Test Acc: 0.772
Validation loss decreased (-0.749992 --> -0.772215).  Saving model ...
Epoch: 17 cost time: 1.3934998512268066
Epoch: 17, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.649 Vali Acc: 0.800 Test Loss: 0.649 Test Acc: 0.800
Validation loss decreased (-0.772215 --> -0.799994).  Saving model ...
Epoch: 18 cost time: 1.5179097652435303
Epoch: 18, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.652 Vali Acc: 0.811 Test Loss: 0.652 Test Acc: 0.811
Validation loss decreased (-0.799994 --> -0.811105).  Saving model ...
Epoch: 19 cost time: 1.593045711517334
Epoch: 19, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.558 Vali Acc: 0.850 Test Loss: 0.558 Test Acc: 0.850
Validation loss decreased (-0.811105 --> -0.849994).  Saving model ...
Epoch: 20 cost time: 1.4125912189483643
Epoch: 20, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.555 Vali Acc: 0.872 Test Loss: 0.555 Test Acc: 0.872
Validation loss decreased (-0.849994 --> -0.872217).  Saving model ...
Epoch: 21 cost time: 1.6050078868865967
Epoch: 21, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.547 Vali Acc: 0.844 Test Loss: 0.547 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7069921493530273
Epoch: 22, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.513 Vali Acc: 0.861 Test Loss: 0.513 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.67608642578125
Epoch: 23, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.529 Vali Acc: 0.872 Test Loss: 0.529 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 24 cost time: 1.3417863845825195
Epoch: 24, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.522 Vali Acc: 0.872 Test Loss: 0.522 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 25 cost time: 1.4740426540374756
Epoch: 25, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.456 Vali Acc: 0.878 Test Loss: 0.456 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 26 cost time: 1.4316072463989258
Epoch: 26, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.467 Vali Acc: 0.894 Test Loss: 0.467 Test Acc: 0.894
Validation loss decreased (-0.877773 --> -0.894440).  Saving model ...
Epoch: 27 cost time: 1.378173828125
Epoch: 27, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.500 Vali Acc: 0.867 Test Loss: 0.500 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5808660984039307
Epoch: 28, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.488 Vali Acc: 0.872 Test Loss: 0.488 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3622548580169678
Epoch: 29, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.513 Vali Acc: 0.867 Test Loss: 0.513 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.5689520835876465
Epoch: 30, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.528 Vali Acc: 0.856 Test Loss: 0.528 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.5291407108306885
Epoch: 31, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.529 Vali Acc: 0.844 Test Loss: 0.529 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.426934003829956
Epoch: 32, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.562 Vali Acc: 0.856 Test Loss: 0.562 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.6360337734222412
Epoch: 33, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.535 Vali Acc: 0.872 Test Loss: 0.535 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.59275484085083
Epoch: 34, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.542 Vali Acc: 0.872 Test Loss: 0.542 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.5238289833068848
Epoch: 35, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.560 Vali Acc: 0.872 Test Loss: 0.560 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.3200573921203613
Epoch: 36, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.531 Vali Acc: 0.872 Test Loss: 0.531 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 1510451
model size : 8.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3441028594970703
Epoch: 1, Steps: 12 | Train Loss: 2.887 Vali Loss: 2.746 Vali Acc: 0.111 Test Loss: 2.746 Test Acc: 0.111
Validation loss decreased (inf --> -0.111084).  Saving model ...
Epoch: 2 cost time: 1.468013048171997
Epoch: 2, Steps: 12 | Train Loss: 2.647 Vali Loss: 2.563 Vali Acc: 0.261 Test Loss: 2.563 Test Acc: 0.261
Validation loss decreased (-0.111084 --> -0.261085).  Saving model ...
Epoch: 3 cost time: 1.3950915336608887
Epoch: 3, Steps: 12 | Train Loss: 2.534 Vali Loss: 2.425 Vali Acc: 0.300 Test Loss: 2.425 Test Acc: 0.300
Validation loss decreased (-0.261085 --> -0.299976).  Saving model ...
Epoch: 4 cost time: 1.2318737506866455
Epoch: 4, Steps: 12 | Train Loss: 2.366 Vali Loss: 2.268 Vali Acc: 0.383 Test Loss: 2.268 Test Acc: 0.383
Validation loss decreased (-0.299976 --> -0.383311).  Saving model ...
Epoch: 5 cost time: 1.3493845462799072
Epoch: 5, Steps: 12 | Train Loss: 2.149 Vali Loss: 2.077 Vali Acc: 0.483 Test Loss: 2.077 Test Acc: 0.483
Validation loss decreased (-0.383311 --> -0.483313).  Saving model ...
Epoch: 6 cost time: 1.898017406463623
Epoch: 6, Steps: 12 | Train Loss: 1.929 Vali Loss: 1.845 Vali Acc: 0.556 Test Loss: 1.845 Test Acc: 0.556
Validation loss decreased (-0.483313 --> -0.555537).  Saving model ...
Epoch: 7 cost time: 1.751333475112915
Epoch: 7, Steps: 12 | Train Loss: 1.627 Vali Loss: 1.643 Vali Acc: 0.567 Test Loss: 1.643 Test Acc: 0.567
Validation loss decreased (-0.555537 --> -0.566650).  Saving model ...
Epoch: 8 cost time: 1.736762285232544
Epoch: 8, Steps: 12 | Train Loss: 1.493 Vali Loss: 1.489 Vali Acc: 0.556 Test Loss: 1.489 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5910975933074951
Epoch: 9, Steps: 12 | Train Loss: 1.347 Vali Loss: 1.321 Vali Acc: 0.617 Test Loss: 1.321 Test Acc: 0.617
Validation loss decreased (-0.566650 --> -0.616653).  Saving model ...
Epoch: 10 cost time: 1.3927595615386963
Epoch: 10, Steps: 12 | Train Loss: 1.132 Vali Loss: 1.187 Vali Acc: 0.639 Test Loss: 1.187 Test Acc: 0.639
Validation loss decreased (-0.616653 --> -0.638877).  Saving model ...
Epoch: 11 cost time: 1.3119614124298096
Epoch: 11, Steps: 12 | Train Loss: 0.972 Vali Loss: 1.111 Vali Acc: 0.661 Test Loss: 1.111 Test Acc: 0.661
Validation loss decreased (-0.638877 --> -0.661100).  Saving model ...
Epoch: 12 cost time: 2.0380640029907227
Epoch: 12, Steps: 12 | Train Loss: 0.807 Vali Loss: 0.993 Vali Acc: 0.694 Test Loss: 0.993 Test Acc: 0.694
Validation loss decreased (-0.661100 --> -0.694435).  Saving model ...
Epoch: 13 cost time: 1.4523954391479492
Epoch: 13, Steps: 12 | Train Loss: 0.728 Vali Loss: 0.910 Vali Acc: 0.739 Test Loss: 0.910 Test Acc: 0.739
Validation loss decreased (-0.694435 --> -0.738880).  Saving model ...
Epoch: 14 cost time: 1.5365960597991943
Epoch: 14, Steps: 12 | Train Loss: 0.666 Vali Loss: 0.830 Vali Acc: 0.767 Test Loss: 0.830 Test Acc: 0.767
Validation loss decreased (-0.738880 --> -0.766658).  Saving model ...
Epoch: 15 cost time: 1.3383400440216064
Epoch: 15, Steps: 12 | Train Loss: 0.584 Vali Loss: 0.739 Vali Acc: 0.789 Test Loss: 0.739 Test Acc: 0.789
Validation loss decreased (-0.766658 --> -0.788881).  Saving model ...
Epoch: 16 cost time: 1.2740375995635986
Epoch: 16, Steps: 12 | Train Loss: 0.563 Vali Loss: 0.693 Vali Acc: 0.789 Test Loss: 0.693 Test Acc: 0.789
Validation loss decreased (-0.788881 --> -0.788882).  Saving model ...
Epoch: 17 cost time: 1.4024531841278076
Epoch: 17, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.664 Vali Acc: 0.800 Test Loss: 0.664 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799993).  Saving model ...
Epoch: 18 cost time: 1.3787455558776855
Epoch: 18, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.601 Vali Acc: 0.828 Test Loss: 0.601 Test Acc: 0.828
Validation loss decreased (-0.799993 --> -0.827772).  Saving model ...
Epoch: 19 cost time: 1.5465564727783203
Epoch: 19, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.596 Vali Acc: 0.833 Test Loss: 0.596 Test Acc: 0.833
Validation loss decreased (-0.827772 --> -0.833327).  Saving model ...
Epoch: 20 cost time: 1.556133508682251
Epoch: 20, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.556 Vali Acc: 0.844 Test Loss: 0.556 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844439).  Saving model ...
Epoch: 21 cost time: 1.3856136798858643
Epoch: 21, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.549 Vali Acc: 0.844 Test Loss: 0.549 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 22 cost time: 1.284726619720459
Epoch: 22, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.499 Vali Acc: 0.878 Test Loss: 0.499 Test Acc: 0.878
Validation loss decreased (-0.844439 --> -0.877773).  Saving model ...
Epoch: 23 cost time: 1.499635934829712
Epoch: 23, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.517 Vali Acc: 0.872 Test Loss: 0.517 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6927759647369385
Epoch: 24, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.512 Vali Acc: 0.872 Test Loss: 0.512 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.5644686222076416
Epoch: 25, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.518 Vali Acc: 0.883 Test Loss: 0.518 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883328).  Saving model ...
Epoch: 26 cost time: 1.5875811576843262
Epoch: 26, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.603 Vali Acc: 0.828 Test Loss: 0.603 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.545128583908081
Epoch: 27, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.569 Vali Acc: 0.867 Test Loss: 0.569 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.598012924194336
Epoch: 28, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.553 Vali Acc: 0.861 Test Loss: 0.553 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.6075806617736816
Epoch: 29, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.493 Vali Acc: 0.878 Test Loss: 0.493 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.502201795578003
Epoch: 30, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.530 Vali Acc: 0.889 Test Loss: 0.530 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888884).  Saving model ...
Epoch: 31 cost time: 1.7678358554840088
Epoch: 31, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.492 Vali Acc: 0.878 Test Loss: 0.492 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.7002308368682861
Epoch: 32, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.522 Vali Acc: 0.878 Test Loss: 0.522 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.6975512504577637
Epoch: 33, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.560 Vali Acc: 0.872 Test Loss: 0.560 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.468275785446167
Epoch: 34, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.529 Vali Acc: 0.883 Test Loss: 0.529 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.3484220504760742
Epoch: 35, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.549 Vali Acc: 0.878 Test Loss: 0.549 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.614549160003662
Epoch: 36, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.581 Vali Acc: 0.850 Test Loss: 0.581 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.8093481063842773
Epoch: 37, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.698 Vali Acc: 0.828 Test Loss: 0.698 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.3667209148406982
Epoch: 38, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.582 Vali Acc: 0.839 Test Loss: 0.582 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.5774075984954834
Epoch: 39, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.602 Vali Acc: 0.872 Test Loss: 0.602 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.386251449584961
Epoch: 40, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.589 Vali Acc: 0.867 Test Loss: 0.589 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 1509683
model size : 8.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.983832359313965
Epoch: 1, Steps: 12 | Train Loss: 2.946 Vali Loss: 2.791 Vali Acc: 0.094 Test Loss: 2.791 Test Acc: 0.094
Validation loss decreased (inf --> -0.094417).  Saving model ...
Epoch: 2 cost time: 1.3972856998443604
Epoch: 2, Steps: 12 | Train Loss: 2.772 Vali Loss: 2.630 Vali Acc: 0.122 Test Loss: 2.630 Test Acc: 0.122
Validation loss decreased (-0.094417 --> -0.122196).  Saving model ...
Epoch: 3 cost time: 1.371659517288208
Epoch: 3, Steps: 12 | Train Loss: 2.615 Vali Loss: 2.537 Vali Acc: 0.217 Test Loss: 2.537 Test Acc: 0.217
Validation loss decreased (-0.122196 --> -0.216641).  Saving model ...
Epoch: 4 cost time: 1.7042229175567627
Epoch: 4, Steps: 12 | Train Loss: 2.494 Vali Loss: 2.414 Vali Acc: 0.339 Test Loss: 2.414 Test Acc: 0.339
Validation loss decreased (-0.216641 --> -0.338865).  Saving model ...
Epoch: 5 cost time: 1.339890956878662
Epoch: 5, Steps: 12 | Train Loss: 2.245 Vali Loss: 2.217 Vali Acc: 0.428 Test Loss: 2.217 Test Acc: 0.428
Validation loss decreased (-0.338865 --> -0.427756).  Saving model ...
Epoch: 6 cost time: 1.5917482376098633
Epoch: 6, Steps: 12 | Train Loss: 2.018 Vali Loss: 2.003 Vali Acc: 0.461 Test Loss: 2.003 Test Acc: 0.461
Validation loss decreased (-0.427756 --> -0.461091).  Saving model ...
Epoch: 7 cost time: 1.5409257411956787
Epoch: 7, Steps: 12 | Train Loss: 1.757 Vali Loss: 1.800 Vali Acc: 0.494 Test Loss: 1.800 Test Acc: 0.494
Validation loss decreased (-0.461091 --> -0.494426).  Saving model ...
Epoch: 8 cost time: 1.5050079822540283
Epoch: 8, Steps: 12 | Train Loss: 1.535 Vali Loss: 1.569 Vali Acc: 0.617 Test Loss: 1.569 Test Acc: 0.617
Validation loss decreased (-0.494426 --> -0.616651).  Saving model ...
Epoch: 9 cost time: 1.2900347709655762
Epoch: 9, Steps: 12 | Train Loss: 1.403 Vali Loss: 1.435 Vali Acc: 0.650 Test Loss: 1.435 Test Acc: 0.650
Validation loss decreased (-0.616651 --> -0.649986).  Saving model ...
Epoch: 10 cost time: 1.9293205738067627
Epoch: 10, Steps: 12 | Train Loss: 1.228 Vali Loss: 1.293 Vali Acc: 0.689 Test Loss: 1.293 Test Acc: 0.689
Validation loss decreased (-0.649986 --> -0.688876).  Saving model ...
Epoch: 11 cost time: 1.5208675861358643
Epoch: 11, Steps: 12 | Train Loss: 1.124 Vali Loss: 1.165 Vali Acc: 0.700 Test Loss: 1.165 Test Acc: 0.700
Validation loss decreased (-0.688876 --> -0.699988).  Saving model ...
Epoch: 12 cost time: 1.4769022464752197
Epoch: 12, Steps: 12 | Train Loss: 0.999 Vali Loss: 1.056 Vali Acc: 0.750 Test Loss: 1.056 Test Acc: 0.750
Validation loss decreased (-0.699988 --> -0.749989).  Saving model ...
Epoch: 13 cost time: 1.4380226135253906
Epoch: 13, Steps: 12 | Train Loss: 0.843 Vali Loss: 0.954 Vali Acc: 0.767 Test Loss: 0.954 Test Acc: 0.767
Validation loss decreased (-0.749989 --> -0.766657).  Saving model ...
Epoch: 14 cost time: 1.6179604530334473
Epoch: 14, Steps: 12 | Train Loss: 0.805 Vali Loss: 0.903 Vali Acc: 0.767 Test Loss: 0.903 Test Acc: 0.767
Validation loss decreased (-0.766657 --> -0.766658).  Saving model ...
Epoch: 15 cost time: 1.3419218063354492
Epoch: 15, Steps: 12 | Train Loss: 0.681 Vali Loss: 0.806 Vali Acc: 0.800 Test Loss: 0.806 Test Acc: 0.800
Validation loss decreased (-0.766658 --> -0.799992).  Saving model ...
Epoch: 16 cost time: 1.7092783451080322
Epoch: 16, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.753 Vali Acc: 0.806 Test Loss: 0.753 Test Acc: 0.806
Validation loss decreased (-0.799992 --> -0.805548).  Saving model ...
Epoch: 17 cost time: 1.6985156536102295
Epoch: 17, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.704 Vali Acc: 0.817 Test Loss: 0.704 Test Acc: 0.817
Validation loss decreased (-0.805548 --> -0.816660).  Saving model ...
Epoch: 18 cost time: 1.3988852500915527
Epoch: 18, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.668 Vali Acc: 0.817 Test Loss: 0.668 Test Acc: 0.817
Validation loss decreased (-0.816660 --> -0.816660).  Saving model ...
Epoch: 19 cost time: 1.6594762802124023
Epoch: 19, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.611 Vali Acc: 0.822 Test Loss: 0.611 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 20 cost time: 1.9000041484832764
Epoch: 20, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.616 Vali Acc: 0.833 Test Loss: 0.616 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833327).  Saving model ...
Epoch: 21 cost time: 1.5940439701080322
Epoch: 21, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.597 Vali Acc: 0.844 Test Loss: 0.597 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844438).  Saving model ...
Epoch: 22 cost time: 1.3961372375488281
Epoch: 22, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.549 Vali Acc: 0.839 Test Loss: 0.549 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.617816686630249
Epoch: 23, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.511 Vali Acc: 0.867 Test Loss: 0.511 Test Acc: 0.867
Validation loss decreased (-0.844438 --> -0.866662).  Saving model ...
Epoch: 24 cost time: 1.3059308528900146
Epoch: 24, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.522 Vali Acc: 0.861 Test Loss: 0.522 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3381786346435547
Epoch: 25, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.501 Vali Acc: 0.850 Test Loss: 0.501 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.8587589263916016
Epoch: 26, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.477 Vali Acc: 0.872 Test Loss: 0.477 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872217).  Saving model ...
Epoch: 27 cost time: 1.7163546085357666
Epoch: 27, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.471 Vali Acc: 0.861 Test Loss: 0.471 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.9230155944824219
Epoch: 28, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.448 Vali Acc: 0.878 Test Loss: 0.448 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 29 cost time: 1.5106916427612305
Epoch: 29, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.444 Vali Acc: 0.883 Test Loss: 0.444 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883329).  Saving model ...
Epoch: 30 cost time: 1.50624418258667
Epoch: 30, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.438 Vali Acc: 0.883 Test Loss: 0.438 Test Acc: 0.883
Validation loss decreased (-0.883329 --> -0.883329).  Saving model ...
Epoch: 31 cost time: 1.295027256011963
Epoch: 31, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.441 Vali Acc: 0.872 Test Loss: 0.441 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.5617671012878418
Epoch: 32, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.438 Vali Acc: 0.889 Test Loss: 0.438 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888885).  Saving model ...
Epoch: 33 cost time: 1.3083984851837158
Epoch: 33, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.442 Vali Acc: 0.878 Test Loss: 0.442 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2798514366149902
Epoch: 34, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.442 Vali Acc: 0.872 Test Loss: 0.442 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.3994166851043701
Epoch: 35, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.445 Vali Acc: 0.867 Test Loss: 0.445 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.4554352760314941
Epoch: 36, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.419 Vali Acc: 0.894 Test Loss: 0.419 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894440).  Saving model ...
Epoch: 37 cost time: 1.5025207996368408
Epoch: 37, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.436 Vali Acc: 0.878 Test Loss: 0.436 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.3087358474731445
Epoch: 38, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.500 Vali Acc: 0.867 Test Loss: 0.500 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.291494369506836
Epoch: 39, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.418 Vali Acc: 0.878 Test Loss: 0.418 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.6811790466308594
Epoch: 40, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.408 Vali Acc: 0.900 Test Loss: 0.408 Test Acc: 0.900
Validation loss decreased (-0.894440 --> -0.899996).  Saving model ...
Epoch: 41 cost time: 1.7551920413970947
Epoch: 41, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.431 Vali Acc: 0.900 Test Loss: 0.431 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.63950514793396
Epoch: 42, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.416 Vali Acc: 0.894 Test Loss: 0.416 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.462644100189209
Epoch: 43, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.398 Vali Acc: 0.900 Test Loss: 0.398 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 44 cost time: 1.4489333629608154
Epoch: 44, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.426 Vali Acc: 0.894 Test Loss: 0.426 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.9037623405456543
Epoch: 45, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.454 Vali Acc: 0.894 Test Loss: 0.454 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.78261137008667
Epoch: 46, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.433 Vali Acc: 0.889 Test Loss: 0.433 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.3439700603485107
Epoch: 47, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.434 Vali Acc: 0.872 Test Loss: 0.434 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.5291709899902344
Epoch: 48, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.441 Vali Acc: 0.894 Test Loss: 0.441 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.651071310043335
Epoch: 49, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.428 Vali Acc: 0.889 Test Loss: 0.428 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.6641454696655273
Epoch: 50, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.463 Vali Acc: 0.878 Test Loss: 0.463 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.640899419784546
Epoch: 51, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.486 Vali Acc: 0.867 Test Loss: 0.486 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.6774773597717285
Epoch: 52, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.470 Vali Acc: 0.889 Test Loss: 0.470 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.4879193305969238
Epoch: 53, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.474 Vali Acc: 0.894 Test Loss: 0.474 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 1006579
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0377612113952637
Epoch: 1, Steps: 12 | Train Loss: 2.858 Vali Loss: 2.817 Vali Acc: 0.072 Test Loss: 2.817 Test Acc: 0.072
Validation loss decreased (inf --> -0.072194).  Saving model ...
Epoch: 2 cost time: 1.227874994277954
Epoch: 2, Steps: 12 | Train Loss: 2.710 Vali Loss: 2.655 Vali Acc: 0.167 Test Loss: 2.655 Test Acc: 0.167
Validation loss decreased (-0.072194 --> -0.166640).  Saving model ...
Epoch: 3 cost time: 1.6426305770874023
Epoch: 3, Steps: 12 | Train Loss: 2.590 Vali Loss: 2.520 Vali Acc: 0.217 Test Loss: 2.520 Test Acc: 0.217
Validation loss decreased (-0.166640 --> -0.216641).  Saving model ...
Epoch: 4 cost time: 1.2861309051513672
Epoch: 4, Steps: 12 | Train Loss: 2.388 Vali Loss: 2.368 Vali Acc: 0.283 Test Loss: 2.368 Test Acc: 0.283
Validation loss decreased (-0.216641 --> -0.283310).  Saving model ...
Epoch: 5 cost time: 1.1907155513763428
Epoch: 5, Steps: 12 | Train Loss: 2.173 Vali Loss: 2.191 Vali Acc: 0.372 Test Loss: 2.191 Test Acc: 0.372
Validation loss decreased (-0.283310 --> -0.372200).  Saving model ...
Epoch: 6 cost time: 1.3679516315460205
Epoch: 6, Steps: 12 | Train Loss: 1.944 Vali Loss: 1.983 Vali Acc: 0.467 Test Loss: 1.983 Test Acc: 0.467
Validation loss decreased (-0.372200 --> -0.466647).  Saving model ...
Epoch: 7 cost time: 1.4964382648468018
Epoch: 7, Steps: 12 | Train Loss: 1.758 Vali Loss: 1.825 Vali Acc: 0.528 Test Loss: 1.825 Test Acc: 0.528
Validation loss decreased (-0.466647 --> -0.527760).  Saving model ...
Epoch: 8 cost time: 1.4262406826019287
Epoch: 8, Steps: 12 | Train Loss: 1.621 Vali Loss: 1.645 Vali Acc: 0.561 Test Loss: 1.645 Test Acc: 0.561
Validation loss decreased (-0.527760 --> -0.561095).  Saving model ...
Epoch: 9 cost time: 1.5516316890716553
Epoch: 9, Steps: 12 | Train Loss: 1.425 Vali Loss: 1.481 Vali Acc: 0.617 Test Loss: 1.481 Test Acc: 0.617
Validation loss decreased (-0.561095 --> -0.616652).  Saving model ...
Epoch: 10 cost time: 1.4831922054290771
Epoch: 10, Steps: 12 | Train Loss: 1.264 Vali Loss: 1.309 Vali Acc: 0.678 Test Loss: 1.309 Test Acc: 0.678
Validation loss decreased (-0.616652 --> -0.677765).  Saving model ...
Epoch: 11 cost time: 1.3899664878845215
Epoch: 11, Steps: 12 | Train Loss: 1.109 Vali Loss: 1.196 Vali Acc: 0.706 Test Loss: 1.196 Test Acc: 0.706
Validation loss decreased (-0.677765 --> -0.705544).  Saving model ...
Epoch: 12 cost time: 1.3819077014923096
Epoch: 12, Steps: 12 | Train Loss: 0.932 Vali Loss: 1.086 Vali Acc: 0.717 Test Loss: 1.086 Test Acc: 0.717
Validation loss decreased (-0.705544 --> -0.716656).  Saving model ...
Epoch: 13 cost time: 1.3268425464630127
Epoch: 13, Steps: 12 | Train Loss: 0.950 Vali Loss: 1.008 Vali Acc: 0.722 Test Loss: 1.008 Test Acc: 0.722
Validation loss decreased (-0.716656 --> -0.722212).  Saving model ...
Epoch: 14 cost time: 1.263256549835205
Epoch: 14, Steps: 12 | Train Loss: 0.765 Vali Loss: 0.892 Vali Acc: 0.756 Test Loss: 0.892 Test Acc: 0.756
Validation loss decreased (-0.722212 --> -0.755547).  Saving model ...
Epoch: 15 cost time: 1.1777620315551758
Epoch: 15, Steps: 12 | Train Loss: 0.664 Vali Loss: 0.804 Vali Acc: 0.800 Test Loss: 0.804 Test Acc: 0.800
Validation loss decreased (-0.755547 --> -0.799992).  Saving model ...
Epoch: 16 cost time: 1.4460532665252686
Epoch: 16, Steps: 12 | Train Loss: 0.618 Vali Loss: 0.781 Vali Acc: 0.800 Test Loss: 0.781 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 17 cost time: 1.5498850345611572
Epoch: 17, Steps: 12 | Train Loss: 0.530 Vali Loss: 0.677 Vali Acc: 0.833 Test Loss: 0.677 Test Acc: 0.833
Validation loss decreased (-0.799992 --> -0.833327).  Saving model ...
Epoch: 18 cost time: 1.7319684028625488
Epoch: 18, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.657 Vali Acc: 0.800 Test Loss: 0.657 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4019808769226074
Epoch: 19, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.634 Vali Acc: 0.828 Test Loss: 0.634 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.275860071182251
Epoch: 20, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.580 Vali Acc: 0.828 Test Loss: 0.580 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3084437847137451
Epoch: 21, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.532 Vali Acc: 0.833 Test Loss: 0.532 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833328).  Saving model ...
Epoch: 22 cost time: 1.3148620128631592
Epoch: 22, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.539 Vali Acc: 0.833 Test Loss: 0.539 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.625960350036621
Epoch: 23, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.504 Vali Acc: 0.844 Test Loss: 0.504 Test Acc: 0.844
Validation loss decreased (-0.833328 --> -0.844439).  Saving model ...
Epoch: 24 cost time: 1.3911120891571045
Epoch: 24, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.493 Vali Acc: 0.844 Test Loss: 0.493 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844440).  Saving model ...
Epoch: 25 cost time: 1.574270486831665
Epoch: 25, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.480 Vali Acc: 0.867 Test Loss: 0.480 Test Acc: 0.867
Validation loss decreased (-0.844440 --> -0.866662).  Saving model ...
Epoch: 26 cost time: 1.7280426025390625
Epoch: 26, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.461 Vali Acc: 0.867 Test Loss: 0.461 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 27 cost time: 1.4384112358093262
Epoch: 27, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.447 Vali Acc: 0.867 Test Loss: 0.447 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 28 cost time: 1.4428768157958984
Epoch: 28, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.413 Vali Acc: 0.889 Test Loss: 0.413 Test Acc: 0.889
Validation loss decreased (-0.866662 --> -0.888885).  Saving model ...
Epoch: 29 cost time: 1.3866446018218994
Epoch: 29, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.406 Vali Acc: 0.889 Test Loss: 0.406 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 30 cost time: 1.3446755409240723
Epoch: 30, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.407 Vali Acc: 0.878 Test Loss: 0.407 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2748279571533203
Epoch: 31, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.429 Vali Acc: 0.889 Test Loss: 0.429 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.6144886016845703
Epoch: 32, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.423 Vali Acc: 0.889 Test Loss: 0.423 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.2845396995544434
Epoch: 33, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.416 Vali Acc: 0.900 Test Loss: 0.416 Test Acc: 0.900
Validation loss decreased (-0.888885 --> -0.899996).  Saving model ...
Epoch: 34 cost time: 1.3950245380401611
Epoch: 34, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.422 Vali Acc: 0.906 Test Loss: 0.422 Test Acc: 0.906
Validation loss decreased (-0.899996 --> -0.905551).  Saving model ...
Epoch: 35 cost time: 1.427893877029419
Epoch: 35, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.372 Vali Acc: 0.894 Test Loss: 0.372 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.4084513187408447
Epoch: 36, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.444 Vali Acc: 0.894 Test Loss: 0.444 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.4210619926452637
Epoch: 37, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.404 Vali Acc: 0.883 Test Loss: 0.404 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.3527789115905762
Epoch: 38, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.407 Vali Acc: 0.900 Test Loss: 0.407 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.5109848976135254
Epoch: 39, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.409 Vali Acc: 0.889 Test Loss: 0.409 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.308661699295044
Epoch: 40, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.396 Vali Acc: 0.911 Test Loss: 0.396 Test Acc: 0.911
Validation loss decreased (-0.905551 --> -0.911107).  Saving model ...
Epoch: 41 cost time: 1.5146043300628662
Epoch: 41, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.401 Vali Acc: 0.883 Test Loss: 0.401 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.5985004901885986
Epoch: 42, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.418 Vali Acc: 0.894 Test Loss: 0.418 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.43599271774292
Epoch: 43, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.451 Vali Acc: 0.878 Test Loss: 0.451 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.449005126953125
Epoch: 44, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.459 Vali Acc: 0.878 Test Loss: 0.459 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.3324174880981445
Epoch: 45, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.426 Vali Acc: 0.883 Test Loss: 0.426 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.2717061042785645
Epoch: 46, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.429 Vali Acc: 0.889 Test Loss: 0.429 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.8258516788482666
Epoch: 47, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.371 Vali Acc: 0.894 Test Loss: 0.371 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.6078920364379883
Epoch: 48, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.430 Vali Acc: 0.894 Test Loss: 0.430 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.381767988204956
Epoch: 49, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.443 Vali Acc: 0.889 Test Loss: 0.443 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.4472451210021973
Epoch: 50, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.433 Vali Acc: 0.883 Test Loss: 0.433 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 1006195
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9444310665130615
Epoch: 1, Steps: 12 | Train Loss: 2.834 Vali Loss: 2.669 Vali Acc: 0.128 Test Loss: 2.669 Test Acc: 0.128
Validation loss decreased (inf --> -0.127751).  Saving model ...
Epoch: 2 cost time: 1.6558806896209717
Epoch: 2, Steps: 12 | Train Loss: 2.706 Vali Loss: 2.527 Vali Acc: 0.211 Test Loss: 2.527 Test Acc: 0.211
Validation loss decreased (-0.127751 --> -0.211086).  Saving model ...
Epoch: 3 cost time: 1.7367627620697021
Epoch: 3, Steps: 12 | Train Loss: 2.539 Vali Loss: 2.402 Vali Acc: 0.339 Test Loss: 2.402 Test Acc: 0.339
Validation loss decreased (-0.211086 --> -0.338865).  Saving model ...
Epoch: 4 cost time: 1.3672752380371094
Epoch: 4, Steps: 12 | Train Loss: 2.368 Vali Loss: 2.240 Vali Acc: 0.433 Test Loss: 2.240 Test Acc: 0.433
Validation loss decreased (-0.338865 --> -0.433311).  Saving model ...
Epoch: 5 cost time: 1.2509644031524658
Epoch: 5, Steps: 12 | Train Loss: 2.182 Vali Loss: 2.047 Vali Acc: 0.472 Test Loss: 2.047 Test Acc: 0.472
Validation loss decreased (-0.433311 --> -0.472202).  Saving model ...
Epoch: 6 cost time: 1.3717122077941895
Epoch: 6, Steps: 12 | Train Loss: 1.876 Vali Loss: 1.860 Vali Acc: 0.533 Test Loss: 1.860 Test Acc: 0.533
Validation loss decreased (-0.472202 --> -0.533315).  Saving model ...
Epoch: 7 cost time: 1.225325107574463
Epoch: 7, Steps: 12 | Train Loss: 1.637 Vali Loss: 1.695 Vali Acc: 0.578 Test Loss: 1.695 Test Acc: 0.578
Validation loss decreased (-0.533315 --> -0.577761).  Saving model ...
Epoch: 8 cost time: 1.708583116531372
Epoch: 8, Steps: 12 | Train Loss: 1.515 Vali Loss: 1.552 Vali Acc: 0.572 Test Loss: 1.552 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4856958389282227
Epoch: 9, Steps: 12 | Train Loss: 1.319 Vali Loss: 1.404 Vali Acc: 0.650 Test Loss: 1.404 Test Acc: 0.650
Validation loss decreased (-0.577761 --> -0.649986).  Saving model ...
Epoch: 10 cost time: 1.520695447921753
Epoch: 10, Steps: 12 | Train Loss: 1.250 Vali Loss: 1.294 Vali Acc: 0.644 Test Loss: 1.294 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7346506118774414
Epoch: 11, Steps: 12 | Train Loss: 1.123 Vali Loss: 1.194 Vali Acc: 0.683 Test Loss: 1.194 Test Acc: 0.683
Validation loss decreased (-0.649986 --> -0.683321).  Saving model ...
Epoch: 12 cost time: 1.379612684249878
Epoch: 12, Steps: 12 | Train Loss: 0.978 Vali Loss: 1.088 Vali Acc: 0.700 Test Loss: 1.088 Test Acc: 0.700
Validation loss decreased (-0.683321 --> -0.699989).  Saving model ...
Epoch: 13 cost time: 1.6356329917907715
Epoch: 13, Steps: 12 | Train Loss: 0.907 Vali Loss: 0.982 Vali Acc: 0.744 Test Loss: 0.982 Test Acc: 0.744
Validation loss decreased (-0.699989 --> -0.744435).  Saving model ...
Epoch: 14 cost time: 1.6109812259674072
Epoch: 14, Steps: 12 | Train Loss: 0.815 Vali Loss: 0.924 Vali Acc: 0.744 Test Loss: 0.924 Test Acc: 0.744
Validation loss decreased (-0.744435 --> -0.744435).  Saving model ...
Epoch: 15 cost time: 1.360609769821167
Epoch: 15, Steps: 12 | Train Loss: 0.715 Vali Loss: 0.845 Vali Acc: 0.756 Test Loss: 0.845 Test Acc: 0.756
Validation loss decreased (-0.744435 --> -0.755547).  Saving model ...
Epoch: 16 cost time: 1.494474172592163
Epoch: 16, Steps: 12 | Train Loss: 0.595 Vali Loss: 0.763 Vali Acc: 0.811 Test Loss: 0.763 Test Acc: 0.811
Validation loss decreased (-0.755547 --> -0.811103).  Saving model ...
Epoch: 17 cost time: 1.9461278915405273
Epoch: 17, Steps: 12 | Train Loss: 0.564 Vali Loss: 0.720 Vali Acc: 0.806 Test Loss: 0.720 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8819317817687988
Epoch: 18, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.633 Vali Acc: 0.822 Test Loss: 0.633 Test Acc: 0.822
Validation loss decreased (-0.811103 --> -0.822216).  Saving model ...
Epoch: 19 cost time: 1.3119277954101562
Epoch: 19, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.595 Vali Acc: 0.811 Test Loss: 0.595 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.396392822265625
Epoch: 20, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.596 Vali Acc: 0.839 Test Loss: 0.596 Test Acc: 0.839
Validation loss decreased (-0.822216 --> -0.838883).  Saving model ...
Epoch: 21 cost time: 1.5416014194488525
Epoch: 21, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.559 Vali Acc: 0.844 Test Loss: 0.559 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 22 cost time: 1.613901138305664
Epoch: 22, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.566 Vali Acc: 0.839 Test Loss: 0.566 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8678016662597656
Epoch: 23, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.476 Vali Acc: 0.856 Test Loss: 0.476 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855551).  Saving model ...
Epoch: 24 cost time: 1.541576623916626
Epoch: 24, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.511 Vali Acc: 0.828 Test Loss: 0.511 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.566873550415039
Epoch: 25, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.482 Vali Acc: 0.856 Test Loss: 0.482 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4256439208984375
Epoch: 26, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.490 Vali Acc: 0.844 Test Loss: 0.490 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.9756698608398438
Epoch: 27, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.451 Vali Acc: 0.872 Test Loss: 0.451 Test Acc: 0.872
Validation loss decreased (-0.855551 --> -0.872218).  Saving model ...
Epoch: 28 cost time: 1.6858787536621094
Epoch: 28, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.461 Vali Acc: 0.867 Test Loss: 0.461 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.677340030670166
Epoch: 29, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.450 Vali Acc: 0.861 Test Loss: 0.450 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.7072832584381104
Epoch: 30, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.440 Vali Acc: 0.872 Test Loss: 0.440 Test Acc: 0.872
Validation loss decreased (-0.872218 --> -0.872218).  Saving model ...
Epoch: 31 cost time: 1.5450751781463623
Epoch: 31, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.459 Vali Acc: 0.856 Test Loss: 0.459 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.5270118713378906
Epoch: 32, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.454 Vali Acc: 0.850 Test Loss: 0.454 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.5373339653015137
Epoch: 33, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.463 Vali Acc: 0.867 Test Loss: 0.463 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.5050585269927979
Epoch: 34, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.426 Vali Acc: 0.867 Test Loss: 0.426 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.4408695697784424
Epoch: 35, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.452 Vali Acc: 0.872 Test Loss: 0.452 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.542086124420166
Epoch: 36, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.452 Vali Acc: 0.872 Test Loss: 0.452 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.271740198135376
Epoch: 37, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.406 Vali Acc: 0.872 Test Loss: 0.406 Test Acc: 0.872
Validation loss decreased (-0.872218 --> -0.872218).  Saving model ...
Epoch: 38 cost time: 1.4936835765838623
Epoch: 38, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.431 Vali Acc: 0.883 Test Loss: 0.431 Test Acc: 0.883
Validation loss decreased (-0.872218 --> -0.883329).  Saving model ...
Epoch: 39 cost time: 1.3662896156311035
Epoch: 39, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.436 Vali Acc: 0.883 Test Loss: 0.436 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.4907748699188232
Epoch: 40, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.458 Vali Acc: 0.878 Test Loss: 0.458 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.4887664318084717
Epoch: 41, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.453 Vali Acc: 0.867 Test Loss: 0.453 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.6331861019134521
Epoch: 42, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.486 Vali Acc: 0.889 Test Loss: 0.486 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888884).  Saving model ...
Epoch: 43 cost time: 1.7493844032287598
Epoch: 43, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.448 Vali Acc: 0.883 Test Loss: 0.448 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.416349172592163
Epoch: 44, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.452 Vali Acc: 0.878 Test Loss: 0.452 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.4029967784881592
Epoch: 45, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.463 Vali Acc: 0.894 Test Loss: 0.463 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894440).  Saving model ...
Epoch: 46 cost time: 1.334280014038086
Epoch: 46, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.469 Vali Acc: 0.889 Test Loss: 0.469 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.2813599109649658
Epoch: 47, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.464 Vali Acc: 0.883 Test Loss: 0.464 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.4985496997833252
Epoch: 48, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.460 Vali Acc: 0.894 Test Loss: 0.460 Test Acc: 0.894
Validation loss decreased (-0.894440 --> -0.894440).  Saving model ...
Epoch: 49 cost time: 1.1617417335510254
Epoch: 49, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.477 Vali Acc: 0.894 Test Loss: 0.477 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.566896677017212
Epoch: 50, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.461 Vali Acc: 0.889 Test Loss: 0.461 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.4141182899475098
Epoch: 51, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.457 Vali Acc: 0.894 Test Loss: 0.457 Test Acc: 0.894
Validation loss decreased (-0.894440 --> -0.894440).  Saving model ...
Epoch: 52 cost time: 1.4180994033813477
Epoch: 52, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.468 Vali Acc: 0.894 Test Loss: 0.468 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.5421833992004395
Epoch: 53, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.496 Vali Acc: 0.878 Test Loss: 0.496 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.5456490516662598
Epoch: 54, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.482 Vali Acc: 0.889 Test Loss: 0.482 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.5811984539031982
Epoch: 55, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.492 Vali Acc: 0.889 Test Loss: 0.492 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.38801908493042
Epoch: 56, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.443 Vali Acc: 0.889 Test Loss: 0.443 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.5376002788543701
Epoch: 57, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.495 Vali Acc: 0.878 Test Loss: 0.495 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.6353669166564941
Epoch: 58, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.550 Vali Acc: 0.883 Test Loss: 0.550 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 1.6249241828918457
Epoch: 59, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.472 Vali Acc: 0.889 Test Loss: 0.472 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 1.4286584854125977
Epoch: 60, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.568 Vali Acc: 0.850 Test Loss: 0.568 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 1.7534253597259521
Epoch: 61, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.476 Vali Acc: 0.872 Test Loss: 0.476 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 1005811
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0037851333618164
Epoch: 1, Steps: 12 | Train Loss: 2.851 Vali Loss: 2.721 Vali Acc: 0.122 Test Loss: 2.721 Test Acc: 0.122
Validation loss decreased (inf --> -0.122195).  Saving model ...
Epoch: 2 cost time: 1.4597060680389404
Epoch: 2, Steps: 12 | Train Loss: 2.729 Vali Loss: 2.581 Vali Acc: 0.150 Test Loss: 2.581 Test Acc: 0.150
Validation loss decreased (-0.122195 --> -0.149974).  Saving model ...
Epoch: 3 cost time: 1.2919726371765137
Epoch: 3, Steps: 12 | Train Loss: 2.602 Vali Loss: 2.479 Vali Acc: 0.239 Test Loss: 2.479 Test Acc: 0.239
Validation loss decreased (-0.149974 --> -0.238864).  Saving model ...
Epoch: 4 cost time: 1.346898078918457
Epoch: 4, Steps: 12 | Train Loss: 2.478 Vali Loss: 2.337 Vali Acc: 0.333 Test Loss: 2.337 Test Acc: 0.333
Validation loss decreased (-0.238864 --> -0.333310).  Saving model ...
Epoch: 5 cost time: 1.5121288299560547
Epoch: 5, Steps: 12 | Train Loss: 2.264 Vali Loss: 2.185 Vali Acc: 0.422 Test Loss: 2.185 Test Acc: 0.422
Validation loss decreased (-0.333310 --> -0.422200).  Saving model ...
Epoch: 6 cost time: 1.3644890785217285
Epoch: 6, Steps: 12 | Train Loss: 2.050 Vali Loss: 2.012 Vali Acc: 0.472 Test Loss: 2.012 Test Acc: 0.472
Validation loss decreased (-0.422200 --> -0.472202).  Saving model ...
Epoch: 7 cost time: 1.408888339996338
Epoch: 7, Steps: 12 | Train Loss: 1.852 Vali Loss: 1.837 Vali Acc: 0.556 Test Loss: 1.837 Test Acc: 0.556
Validation loss decreased (-0.472202 --> -0.555537).  Saving model ...
Epoch: 8 cost time: 1.1666593551635742
Epoch: 8, Steps: 12 | Train Loss: 1.682 Vali Loss: 1.672 Vali Acc: 0.589 Test Loss: 1.672 Test Acc: 0.589
Validation loss decreased (-0.555537 --> -0.588872).  Saving model ...
Epoch: 9 cost time: 1.1991488933563232
Epoch: 9, Steps: 12 | Train Loss: 1.477 Vali Loss: 1.526 Vali Acc: 0.639 Test Loss: 1.526 Test Acc: 0.639
Validation loss decreased (-0.588872 --> -0.638874).  Saving model ...
Epoch: 10 cost time: 1.2022862434387207
Epoch: 10, Steps: 12 | Train Loss: 1.336 Vali Loss: 1.391 Vali Acc: 0.644 Test Loss: 1.391 Test Acc: 0.644
Validation loss decreased (-0.638874 --> -0.644431).  Saving model ...
Epoch: 11 cost time: 1.5336732864379883
Epoch: 11, Steps: 12 | Train Loss: 1.139 Vali Loss: 1.296 Vali Acc: 0.667 Test Loss: 1.296 Test Acc: 0.667
Validation loss decreased (-0.644431 --> -0.666654).  Saving model ...
Epoch: 12 cost time: 1.5796911716461182
Epoch: 12, Steps: 12 | Train Loss: 1.034 Vali Loss: 1.162 Vali Acc: 0.678 Test Loss: 1.162 Test Acc: 0.678
Validation loss decreased (-0.666654 --> -0.677766).  Saving model ...
Epoch: 13 cost time: 1.2830848693847656
Epoch: 13, Steps: 12 | Train Loss: 0.933 Vali Loss: 1.068 Vali Acc: 0.700 Test Loss: 1.068 Test Acc: 0.700
Validation loss decreased (-0.677766 --> -0.699989).  Saving model ...
Epoch: 14 cost time: 1.4616107940673828
Epoch: 14, Steps: 12 | Train Loss: 0.831 Vali Loss: 0.962 Vali Acc: 0.767 Test Loss: 0.962 Test Acc: 0.767
Validation loss decreased (-0.699989 --> -0.766657).  Saving model ...
Epoch: 15 cost time: 1.6793901920318604
Epoch: 15, Steps: 12 | Train Loss: 0.700 Vali Loss: 0.873 Vali Acc: 0.783 Test Loss: 0.873 Test Acc: 0.783
Validation loss decreased (-0.766657 --> -0.783325).  Saving model ...
Epoch: 16 cost time: 1.16922926902771
Epoch: 16, Steps: 12 | Train Loss: 0.629 Vali Loss: 0.823 Vali Acc: 0.806 Test Loss: 0.823 Test Acc: 0.806
Validation loss decreased (-0.783325 --> -0.805547).  Saving model ...
Epoch: 17 cost time: 1.2912120819091797
Epoch: 17, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.757 Vali Acc: 0.811 Test Loss: 0.757 Test Acc: 0.811
Validation loss decreased (-0.805547 --> -0.811104).  Saving model ...
Epoch: 18 cost time: 1.1823034286499023
Epoch: 18, Steps: 12 | Train Loss: 0.473 Vali Loss: 0.672 Vali Acc: 0.822 Test Loss: 0.672 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822216).  Saving model ...
Epoch: 19 cost time: 1.6048545837402344
Epoch: 19, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.626 Vali Acc: 0.817 Test Loss: 0.626 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4412238597869873
Epoch: 20, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.608 Vali Acc: 0.833 Test Loss: 0.608 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833327).  Saving model ...
Epoch: 21 cost time: 1.5212516784667969
Epoch: 21, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.560 Vali Acc: 0.839 Test Loss: 0.560 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 22 cost time: 1.1757495403289795
Epoch: 22, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.520 Vali Acc: 0.861 Test Loss: 0.520 Test Acc: 0.861
Validation loss decreased (-0.838883 --> -0.861106).  Saving model ...
Epoch: 23 cost time: 1.5166010856628418
Epoch: 23, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.499 Vali Acc: 0.856 Test Loss: 0.499 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3684613704681396
Epoch: 24, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.485 Vali Acc: 0.867 Test Loss: 0.485 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866662).  Saving model ...
Epoch: 25 cost time: 1.2987234592437744
Epoch: 25, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.474 Vali Acc: 0.861 Test Loss: 0.474 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4453239440917969
Epoch: 26, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.462 Vali Acc: 0.867 Test Loss: 0.462 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 27 cost time: 1.299513578414917
Epoch: 27, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.494 Vali Acc: 0.861 Test Loss: 0.494 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3021233081817627
Epoch: 28, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.471 Vali Acc: 0.872 Test Loss: 0.471 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872218).  Saving model ...
Epoch: 29 cost time: 1.425302505493164
Epoch: 29, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.462 Vali Acc: 0.872 Test Loss: 0.462 Test Acc: 0.872
Validation loss decreased (-0.872218 --> -0.872218).  Saving model ...
Epoch: 30 cost time: 1.4799623489379883
Epoch: 30, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.458 Vali Acc: 0.861 Test Loss: 0.458 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2972242832183838
Epoch: 31, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.464 Vali Acc: 0.867 Test Loss: 0.464 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3491754531860352
Epoch: 32, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.451 Vali Acc: 0.889 Test Loss: 0.451 Test Acc: 0.889
Validation loss decreased (-0.872218 --> -0.888884).  Saving model ...
Epoch: 33 cost time: 1.184345006942749
Epoch: 33, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.431 Vali Acc: 0.867 Test Loss: 0.431 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.7104125022888184
Epoch: 34, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.437 Vali Acc: 0.878 Test Loss: 0.437 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.4866976737976074
Epoch: 35, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.437 Vali Acc: 0.878 Test Loss: 0.437 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.388679027557373
Epoch: 36, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.429 Vali Acc: 0.883 Test Loss: 0.429 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.3288793563842773
Epoch: 37, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.419 Vali Acc: 0.889 Test Loss: 0.419 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 38 cost time: 1.269909143447876
Epoch: 38, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.463 Vali Acc: 0.906 Test Loss: 0.463 Test Acc: 0.906
Validation loss decreased (-0.888885 --> -0.905551).  Saving model ...
Epoch: 39 cost time: 1.4728832244873047
Epoch: 39, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.423 Vali Acc: 0.889 Test Loss: 0.423 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.490675449371338
Epoch: 40, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.428 Vali Acc: 0.889 Test Loss: 0.428 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.6055593490600586
Epoch: 41, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.485 Vali Acc: 0.878 Test Loss: 0.485 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.349555253982544
Epoch: 42, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.500 Vali Acc: 0.867 Test Loss: 0.500 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.5805916786193848
Epoch: 43, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.453 Vali Acc: 0.889 Test Loss: 0.453 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.4179620742797852
Epoch: 44, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.457 Vali Acc: 0.878 Test Loss: 0.457 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.4363465309143066
Epoch: 45, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.452 Vali Acc: 0.906 Test Loss: 0.452 Test Acc: 0.906
Validation loss decreased (-0.905551 --> -0.905551).  Saving model ...
Epoch: 46 cost time: 1.4712979793548584
Epoch: 46, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.471 Vali Acc: 0.894 Test Loss: 0.471 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.3997256755828857
Epoch: 47, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.456 Vali Acc: 0.894 Test Loss: 0.456 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.7831363677978516
Epoch: 48, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.461 Vali Acc: 0.889 Test Loss: 0.461 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.4971485137939453
Epoch: 49, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.447 Vali Acc: 0.906 Test Loss: 0.447 Test Acc: 0.906
Validation loss decreased (-0.905551 --> -0.905551).  Saving model ...
Epoch: 50 cost time: 1.5977025032043457
Epoch: 50, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.444 Vali Acc: 0.900 Test Loss: 0.444 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.6826863288879395
Epoch: 51, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.453 Vali Acc: 0.906 Test Loss: 0.453 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.513953447341919
Epoch: 52, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.470 Vali Acc: 0.889 Test Loss: 0.470 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.492734670639038
Epoch: 53, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.472 Vali Acc: 0.894 Test Loss: 0.472 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.623046875
Epoch: 54, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.491 Vali Acc: 0.894 Test Loss: 0.491 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.8474540710449219
Epoch: 55, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.534 Vali Acc: 0.878 Test Loss: 0.534 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.617630958557129
Epoch: 56, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.481 Vali Acc: 0.900 Test Loss: 0.481 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.167365312576294
Epoch: 57, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.447 Vali Acc: 0.889 Test Loss: 0.447 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.5238115787506104
Epoch: 58, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.463 Vali Acc: 0.894 Test Loss: 0.463 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.657379150390625
Epoch: 59, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.458 Vali Acc: 0.894 Test Loss: 0.458 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 1005427
model size : 5.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4362120628356934
Epoch: 1, Steps: 12 | Train Loss: 2.813 Vali Loss: 2.794 Vali Acc: 0.094 Test Loss: 2.794 Test Acc: 0.094
Validation loss decreased (inf --> -0.094417).  Saving model ...
Epoch: 2 cost time: 1.7928776741027832
Epoch: 2, Steps: 12 | Train Loss: 2.701 Vali Loss: 2.665 Vali Acc: 0.161 Test Loss: 2.665 Test Acc: 0.161
Validation loss decreased (-0.094417 --> -0.161084).  Saving model ...
Epoch: 3 cost time: 1.3625507354736328
Epoch: 3, Steps: 12 | Train Loss: 2.609 Vali Loss: 2.570 Vali Acc: 0.267 Test Loss: 2.570 Test Acc: 0.267
Validation loss decreased (-0.161084 --> -0.266641).  Saving model ...
Epoch: 4 cost time: 1.6277995109558105
Epoch: 4, Steps: 12 | Train Loss: 2.535 Vali Loss: 2.462 Vali Acc: 0.339 Test Loss: 2.462 Test Acc: 0.339
Validation loss decreased (-0.266641 --> -0.338864).  Saving model ...
Epoch: 5 cost time: 1.3826050758361816
Epoch: 5, Steps: 12 | Train Loss: 2.404 Vali Loss: 2.339 Vali Acc: 0.372 Test Loss: 2.339 Test Acc: 0.372
Validation loss decreased (-0.338864 --> -0.372199).  Saving model ...
Epoch: 6 cost time: 1.7608649730682373
Epoch: 6, Steps: 12 | Train Loss: 2.211 Vali Loss: 2.172 Vali Acc: 0.433 Test Loss: 2.172 Test Acc: 0.433
Validation loss decreased (-0.372199 --> -0.433312).  Saving model ...
Epoch: 7 cost time: 1.4247386455535889
Epoch: 7, Steps: 12 | Train Loss: 2.025 Vali Loss: 1.974 Vali Acc: 0.528 Test Loss: 1.974 Test Acc: 0.528
Validation loss decreased (-0.433312 --> -0.527758).  Saving model ...
Epoch: 8 cost time: 1.780601978302002
Epoch: 8, Steps: 12 | Train Loss: 1.804 Vali Loss: 1.806 Vali Acc: 0.578 Test Loss: 1.806 Test Acc: 0.578
Validation loss decreased (-0.527758 --> -0.577760).  Saving model ...
Epoch: 9 cost time: 1.4520633220672607
Epoch: 9, Steps: 12 | Train Loss: 1.609 Vali Loss: 1.661 Vali Acc: 0.589 Test Loss: 1.661 Test Acc: 0.589
Validation loss decreased (-0.577760 --> -0.588872).  Saving model ...
Epoch: 10 cost time: 1.4907596111297607
Epoch: 10, Steps: 12 | Train Loss: 1.476 Vali Loss: 1.516 Vali Acc: 0.606 Test Loss: 1.516 Test Acc: 0.606
Validation loss decreased (-0.588872 --> -0.605540).  Saving model ...
Epoch: 11 cost time: 1.5699033737182617
Epoch: 11, Steps: 12 | Train Loss: 1.288 Vali Loss: 1.390 Vali Acc: 0.639 Test Loss: 1.390 Test Acc: 0.639
Validation loss decreased (-0.605540 --> -0.638875).  Saving model ...
Epoch: 12 cost time: 1.763648271560669
Epoch: 12, Steps: 12 | Train Loss: 1.215 Vali Loss: 1.290 Vali Acc: 0.611 Test Loss: 1.290 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.47526216506958
Epoch: 13, Steps: 12 | Train Loss: 1.057 Vali Loss: 1.168 Vali Acc: 0.683 Test Loss: 1.168 Test Acc: 0.683
Validation loss decreased (-0.638875 --> -0.683322).  Saving model ...
Epoch: 14 cost time: 1.622338056564331
Epoch: 14, Steps: 12 | Train Loss: 0.937 Vali Loss: 1.068 Vali Acc: 0.722 Test Loss: 1.068 Test Acc: 0.722
Validation loss decreased (-0.683322 --> -0.722212).  Saving model ...
Epoch: 15 cost time: 1.5636296272277832
Epoch: 15, Steps: 12 | Train Loss: 0.949 Vali Loss: 0.992 Vali Acc: 0.728 Test Loss: 0.992 Test Acc: 0.728
Validation loss decreased (-0.722212 --> -0.727768).  Saving model ...
Epoch: 16 cost time: 1.961766242980957
Epoch: 16, Steps: 12 | Train Loss: 0.762 Vali Loss: 0.923 Vali Acc: 0.772 Test Loss: 0.923 Test Acc: 0.772
Validation loss decreased (-0.727768 --> -0.772213).  Saving model ...
Epoch: 17 cost time: 1.6063573360443115
Epoch: 17, Steps: 12 | Train Loss: 0.693 Vali Loss: 0.828 Vali Acc: 0.761 Test Loss: 0.828 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.843681812286377
Epoch: 18, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.792 Vali Acc: 0.789 Test Loss: 0.792 Test Acc: 0.789
Validation loss decreased (-0.772213 --> -0.788881).  Saving model ...
Epoch: 19 cost time: 1.3631153106689453
Epoch: 19, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.756 Vali Acc: 0.800 Test Loss: 0.756 Test Acc: 0.800
Validation loss decreased (-0.788881 --> -0.799992).  Saving model ...
Epoch: 20 cost time: 1.6556520462036133
Epoch: 20, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.673 Vali Acc: 0.811 Test Loss: 0.673 Test Acc: 0.811
Validation loss decreased (-0.799992 --> -0.811104).  Saving model ...
Epoch: 21 cost time: 1.4969861507415771
Epoch: 21, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.633 Vali Acc: 0.839 Test Loss: 0.633 Test Acc: 0.839
Validation loss decreased (-0.811104 --> -0.838883).  Saving model ...
Epoch: 22 cost time: 1.5173263549804688
Epoch: 22, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.597 Vali Acc: 0.839 Test Loss: 0.597 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 23 cost time: 1.326958179473877
Epoch: 23, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.561 Vali Acc: 0.856 Test Loss: 0.561 Test Acc: 0.856
Validation loss decreased (-0.838883 --> -0.855550).  Saving model ...
Epoch: 24 cost time: 1.3061435222625732
Epoch: 24, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.549 Vali Acc: 0.867 Test Loss: 0.549 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 25 cost time: 1.483917474746704
Epoch: 25, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.520 Vali Acc: 0.861 Test Loss: 0.520 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5074329376220703
Epoch: 26, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.539 Vali Acc: 0.861 Test Loss: 0.539 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3157882690429688
Epoch: 27, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.479 Vali Acc: 0.867 Test Loss: 0.479 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866662).  Saving model ...
Epoch: 28 cost time: 1.9212863445281982
Epoch: 28, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.490 Vali Acc: 0.883 Test Loss: 0.490 Test Acc: 0.883
Validation loss decreased (-0.866662 --> -0.883328).  Saving model ...
Epoch: 29 cost time: 1.4512341022491455
Epoch: 29, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.495 Vali Acc: 0.856 Test Loss: 0.495 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.513838768005371
Epoch: 30, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.472 Vali Acc: 0.867 Test Loss: 0.472 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.3068170547485352
Epoch: 31, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.480 Vali Acc: 0.883 Test Loss: 0.480 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883329).  Saving model ...
Epoch: 32 cost time: 1.4245266914367676
Epoch: 32, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.510 Vali Acc: 0.883 Test Loss: 0.510 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.5335943698883057
Epoch: 33, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.465 Vali Acc: 0.878 Test Loss: 0.465 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.7588684558868408
Epoch: 34, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.467 Vali Acc: 0.872 Test Loss: 0.467 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.7443857192993164
Epoch: 35, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.454 Vali Acc: 0.889 Test Loss: 0.454 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888884).  Saving model ...
Epoch: 36 cost time: 1.3925139904022217
Epoch: 36, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.455 Vali Acc: 0.889 Test Loss: 0.455 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.674560785293579
Epoch: 37, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.467 Vali Acc: 0.889 Test Loss: 0.467 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.6719048023223877
Epoch: 38, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.458 Vali Acc: 0.889 Test Loss: 0.458 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.5117061138153076
Epoch: 39, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.462 Vali Acc: 0.894 Test Loss: 0.462 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894440).  Saving model ...
Epoch: 40 cost time: 1.4237051010131836
Epoch: 40, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.462 Vali Acc: 0.894 Test Loss: 0.462 Test Acc: 0.894
Validation loss decreased (-0.894440 --> -0.894440).  Saving model ...
Epoch: 41 cost time: 1.3786089420318604
Epoch: 41, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.481 Vali Acc: 0.867 Test Loss: 0.481 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.4647774696350098
Epoch: 42, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.553 Vali Acc: 0.878 Test Loss: 0.553 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.5090625286102295
Epoch: 43, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.504 Vali Acc: 0.889 Test Loss: 0.504 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.2771127223968506
Epoch: 44, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.497 Vali Acc: 0.894 Test Loss: 0.497 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.4172096252441406
Epoch: 45, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.473 Vali Acc: 0.878 Test Loss: 0.473 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.628645896911621
Epoch: 46, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.498 Vali Acc: 0.894 Test Loss: 0.498 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.3923218250274658
Epoch: 47, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.471 Vali Acc: 0.894 Test Loss: 0.471 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.260868787765503
Epoch: 48, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.484 Vali Acc: 0.889 Test Loss: 0.484 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.3783986568450928
Epoch: 49, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.494 Vali Acc: 0.889 Test Loss: 0.494 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.4801223278045654
Epoch: 50, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.488 Vali Acc: 0.889 Test Loss: 0.488 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 676339
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.416041851043701
Epoch: 1, Steps: 12 | Train Loss: 2.821 Vali Loss: 2.741 Vali Acc: 0.072 Test Loss: 2.741 Test Acc: 0.072
Validation loss decreased (inf --> -0.072195).  Saving model ...
Epoch: 2 cost time: 1.4750385284423828
Epoch: 2, Steps: 12 | Train Loss: 2.697 Vali Loss: 2.639 Vali Acc: 0.150 Test Loss: 2.639 Test Acc: 0.150
Validation loss decreased (-0.072195 --> -0.149974).  Saving model ...
Epoch: 3 cost time: 1.9591073989868164
Epoch: 3, Steps: 12 | Train Loss: 2.599 Vali Loss: 2.540 Vali Acc: 0.189 Test Loss: 2.540 Test Acc: 0.189
Validation loss decreased (-0.149974 --> -0.188863).  Saving model ...
Epoch: 4 cost time: 1.5633456707000732
Epoch: 4, Steps: 12 | Train Loss: 2.500 Vali Loss: 2.426 Vali Acc: 0.222 Test Loss: 2.426 Test Acc: 0.222
Validation loss decreased (-0.188863 --> -0.222198).  Saving model ...
Epoch: 5 cost time: 1.6793911457061768
Epoch: 5, Steps: 12 | Train Loss: 2.316 Vali Loss: 2.274 Vali Acc: 0.339 Test Loss: 2.274 Test Acc: 0.339
Validation loss decreased (-0.222198 --> -0.338866).  Saving model ...
Epoch: 6 cost time: 1.5907018184661865
Epoch: 6, Steps: 12 | Train Loss: 2.133 Vali Loss: 2.107 Vali Acc: 0.428 Test Loss: 2.107 Test Acc: 0.428
Validation loss decreased (-0.338866 --> -0.427757).  Saving model ...
Epoch: 7 cost time: 1.5944623947143555
Epoch: 7, Steps: 12 | Train Loss: 1.949 Vali Loss: 1.965 Vali Acc: 0.456 Test Loss: 1.965 Test Acc: 0.456
Validation loss decreased (-0.427757 --> -0.455536).  Saving model ...
Epoch: 8 cost time: 1.695669174194336
Epoch: 8, Steps: 12 | Train Loss: 1.778 Vali Loss: 1.831 Vali Acc: 0.494 Test Loss: 1.831 Test Acc: 0.494
Validation loss decreased (-0.455536 --> -0.494426).  Saving model ...
Epoch: 9 cost time: 1.7392289638519287
Epoch: 9, Steps: 12 | Train Loss: 1.628 Vali Loss: 1.694 Vali Acc: 0.539 Test Loss: 1.694 Test Acc: 0.539
Validation loss decreased (-0.494426 --> -0.538872).  Saving model ...
Epoch: 10 cost time: 1.4055407047271729
Epoch: 10, Steps: 12 | Train Loss: 1.479 Vali Loss: 1.544 Vali Acc: 0.583 Test Loss: 1.544 Test Acc: 0.583
Validation loss decreased (-0.538872 --> -0.583318).  Saving model ...
Epoch: 11 cost time: 1.464961290359497
Epoch: 11, Steps: 12 | Train Loss: 1.285 Vali Loss: 1.421 Vali Acc: 0.594 Test Loss: 1.421 Test Acc: 0.594
Validation loss decreased (-0.583318 --> -0.594430).  Saving model ...
Epoch: 12 cost time: 1.5574896335601807
Epoch: 12, Steps: 12 | Train Loss: 1.202 Vali Loss: 1.312 Vali Acc: 0.628 Test Loss: 1.312 Test Acc: 0.628
Validation loss decreased (-0.594430 --> -0.627765).  Saving model ...
Epoch: 13 cost time: 1.629969835281372
Epoch: 13, Steps: 12 | Train Loss: 1.005 Vali Loss: 1.195 Vali Acc: 0.683 Test Loss: 1.195 Test Acc: 0.683
Validation loss decreased (-0.627765 --> -0.683321).  Saving model ...
Epoch: 14 cost time: 1.4881987571716309
Epoch: 14, Steps: 12 | Train Loss: 0.963 Vali Loss: 1.104 Vali Acc: 0.689 Test Loss: 1.104 Test Acc: 0.689
Validation loss decreased (-0.683321 --> -0.688878).  Saving model ...
Epoch: 15 cost time: 1.5687010288238525
Epoch: 15, Steps: 12 | Train Loss: 0.906 Vali Loss: 1.038 Vali Acc: 0.717 Test Loss: 1.038 Test Acc: 0.717
Validation loss decreased (-0.688878 --> -0.716656).  Saving model ...
Epoch: 16 cost time: 1.594346284866333
Epoch: 16, Steps: 12 | Train Loss: 0.847 Vali Loss: 0.948 Vali Acc: 0.728 Test Loss: 0.948 Test Acc: 0.728
Validation loss decreased (-0.716656 --> -0.727768).  Saving model ...
Epoch: 17 cost time: 1.4441602230072021
Epoch: 17, Steps: 12 | Train Loss: 0.779 Vali Loss: 0.888 Vali Acc: 0.756 Test Loss: 0.888 Test Acc: 0.756
Validation loss decreased (-0.727768 --> -0.755547).  Saving model ...
Epoch: 18 cost time: 1.558030128479004
Epoch: 18, Steps: 12 | Train Loss: 0.655 Vali Loss: 0.815 Vali Acc: 0.794 Test Loss: 0.815 Test Acc: 0.794
Validation loss decreased (-0.755547 --> -0.794436).  Saving model ...
Epoch: 19 cost time: 1.7430651187896729
Epoch: 19, Steps: 12 | Train Loss: 0.592 Vali Loss: 0.756 Vali Acc: 0.817 Test Loss: 0.756 Test Acc: 0.817
Validation loss decreased (-0.794436 --> -0.816659).  Saving model ...
Epoch: 20 cost time: 1.4898958206176758
Epoch: 20, Steps: 12 | Train Loss: 0.534 Vali Loss: 0.701 Vali Acc: 0.811 Test Loss: 0.701 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3071351051330566
Epoch: 21, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.637 Vali Acc: 0.822 Test Loss: 0.637 Test Acc: 0.822
Validation loss decreased (-0.816659 --> -0.822216).  Saving model ...
Epoch: 22 cost time: 1.3060283660888672
Epoch: 22, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.621 Vali Acc: 0.822 Test Loss: 0.621 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 23 cost time: 1.7148656845092773
Epoch: 23, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.576 Vali Acc: 0.850 Test Loss: 0.576 Test Acc: 0.850
Validation loss decreased (-0.822216 --> -0.849994).  Saving model ...
Epoch: 24 cost time: 1.5651941299438477
Epoch: 24, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.556 Vali Acc: 0.856 Test Loss: 0.556 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 25 cost time: 1.3503029346466064
Epoch: 25, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.533 Vali Acc: 0.850 Test Loss: 0.533 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.427272081375122
Epoch: 26, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.523 Vali Acc: 0.856 Test Loss: 0.523 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 27 cost time: 1.769329309463501
Epoch: 27, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.517 Vali Acc: 0.872 Test Loss: 0.517 Test Acc: 0.872
Validation loss decreased (-0.855550 --> -0.872217).  Saving model ...
Epoch: 28 cost time: 1.3611631393432617
Epoch: 28, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.491 Vali Acc: 0.856 Test Loss: 0.491 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.633946418762207
Epoch: 29, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.478 Vali Acc: 0.872 Test Loss: 0.478 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 30 cost time: 1.402660846710205
Epoch: 30, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.469 Vali Acc: 0.867 Test Loss: 0.469 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.6175713539123535
Epoch: 31, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.474 Vali Acc: 0.861 Test Loss: 0.474 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.6740500926971436
Epoch: 32, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.462 Vali Acc: 0.889 Test Loss: 0.462 Test Acc: 0.889
Validation loss decreased (-0.872217 --> -0.888884).  Saving model ...
Epoch: 33 cost time: 1.5974225997924805
Epoch: 33, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.484 Vali Acc: 0.867 Test Loss: 0.484 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.4051556587219238
Epoch: 34, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.473 Vali Acc: 0.883 Test Loss: 0.473 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.4633405208587646
Epoch: 35, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.477 Vali Acc: 0.878 Test Loss: 0.477 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.7610843181610107
Epoch: 36, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.493 Vali Acc: 0.889 Test Loss: 0.493 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.7703044414520264
Epoch: 37, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.450 Vali Acc: 0.878 Test Loss: 0.450 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.4281249046325684
Epoch: 38, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.515 Vali Acc: 0.872 Test Loss: 0.515 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.3365204334259033
Epoch: 39, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.455 Vali Acc: 0.889 Test Loss: 0.455 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 40 cost time: 1.520056962966919
Epoch: 40, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.461 Vali Acc: 0.883 Test Loss: 0.461 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.589080572128296
Epoch: 41, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.446 Vali Acc: 0.889 Test Loss: 0.446 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 42 cost time: 1.4740421772003174
Epoch: 42, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.564 Vali Acc: 0.883 Test Loss: 0.564 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.7519421577453613
Epoch: 43, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.476 Vali Acc: 0.878 Test Loss: 0.476 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.6320126056671143
Epoch: 44, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.511 Vali Acc: 0.878 Test Loss: 0.511 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.9215290546417236
Epoch: 45, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.474 Vali Acc: 0.900 Test Loss: 0.474 Test Acc: 0.900
Validation loss decreased (-0.888884 --> -0.899995).  Saving model ...
Epoch: 46 cost time: 1.4972679615020752
Epoch: 46, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.471 Vali Acc: 0.883 Test Loss: 0.471 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.4880096912384033
Epoch: 47, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.511 Vali Acc: 0.894 Test Loss: 0.511 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.5727241039276123
Epoch: 48, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.486 Vali Acc: 0.900 Test Loss: 0.486 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.34879469871521
Epoch: 49, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.488 Vali Acc: 0.878 Test Loss: 0.488 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.736222267150879
Epoch: 50, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.510 Vali Acc: 0.894 Test Loss: 0.510 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.5518465042114258
Epoch: 51, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.538 Vali Acc: 0.889 Test Loss: 0.538 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.7266716957092285
Epoch: 52, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.496 Vali Acc: 0.883 Test Loss: 0.496 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.6632609367370605
Epoch: 53, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.504 Vali Acc: 0.906 Test Loss: 0.504 Test Acc: 0.906
Validation loss decreased (-0.899995 --> -0.905551).  Saving model ...
Epoch: 54 cost time: 1.3806593418121338
Epoch: 54, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.488 Vali Acc: 0.900 Test Loss: 0.488 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.9050955772399902
Epoch: 55, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.477 Vali Acc: 0.900 Test Loss: 0.477 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.6210336685180664
Epoch: 56, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.530 Vali Acc: 0.894 Test Loss: 0.530 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.7371199131011963
Epoch: 57, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.521 Vali Acc: 0.900 Test Loss: 0.521 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.7664830684661865
Epoch: 58, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.526 Vali Acc: 0.900 Test Loss: 0.526 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.454056739807129
Epoch: 59, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.545 Vali Acc: 0.894 Test Loss: 0.545 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.4302024841308594
Epoch: 60, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.533 Vali Acc: 0.900 Test Loss: 0.533 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.4502079486846924
Epoch: 61, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.517 Vali Acc: 0.894 Test Loss: 0.517 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 1.6183927059173584
Epoch: 62, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.545 Vali Acc: 0.883 Test Loss: 0.545 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 2.051658868789673
Epoch: 63, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.538 Vali Acc: 0.889 Test Loss: 0.538 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 675955
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.095454216003418
Epoch: 1, Steps: 12 | Train Loss: 2.789 Vali Loss: 2.776 Vali Acc: 0.050 Test Loss: 2.776 Test Acc: 0.050
Validation loss decreased (inf --> -0.049972).  Saving model ...
Epoch: 2 cost time: 1.5456695556640625
Epoch: 2, Steps: 12 | Train Loss: 2.715 Vali Loss: 2.648 Vali Acc: 0.094 Test Loss: 2.648 Test Acc: 0.094
Validation loss decreased (-0.049972 --> -0.094418).  Saving model ...
Epoch: 3 cost time: 1.5846526622772217
Epoch: 3, Steps: 12 | Train Loss: 2.619 Vali Loss: 2.548 Vali Acc: 0.233 Test Loss: 2.548 Test Acc: 0.233
Validation loss decreased (-0.094418 --> -0.233308).  Saving model ...
Epoch: 4 cost time: 1.4880692958831787
Epoch: 4, Steps: 12 | Train Loss: 2.450 Vali Loss: 2.431 Vali Acc: 0.328 Test Loss: 2.431 Test Acc: 0.328
Validation loss decreased (-0.233308 --> -0.327753).  Saving model ...
Epoch: 5 cost time: 1.5497140884399414
Epoch: 5, Steps: 12 | Train Loss: 2.331 Vali Loss: 2.314 Vali Acc: 0.378 Test Loss: 2.314 Test Acc: 0.378
Validation loss decreased (-0.327753 --> -0.377755).  Saving model ...
Epoch: 6 cost time: 1.6334433555603027
Epoch: 6, Steps: 12 | Train Loss: 2.169 Vali Loss: 2.171 Vali Acc: 0.433 Test Loss: 2.171 Test Acc: 0.433
Validation loss decreased (-0.377755 --> -0.433312).  Saving model ...
Epoch: 7 cost time: 1.4665305614471436
Epoch: 7, Steps: 12 | Train Loss: 2.005 Vali Loss: 2.019 Vali Acc: 0.517 Test Loss: 2.019 Test Acc: 0.517
Validation loss decreased (-0.433312 --> -0.516646).  Saving model ...
Epoch: 8 cost time: 1.4519617557525635
Epoch: 8, Steps: 12 | Train Loss: 1.812 Vali Loss: 1.878 Vali Acc: 0.539 Test Loss: 1.878 Test Acc: 0.539
Validation loss decreased (-0.516646 --> -0.538870).  Saving model ...
Epoch: 9 cost time: 1.4084453582763672
Epoch: 9, Steps: 12 | Train Loss: 1.685 Vali Loss: 1.732 Vali Acc: 0.556 Test Loss: 1.732 Test Acc: 0.556
Validation loss decreased (-0.538870 --> -0.555538).  Saving model ...
Epoch: 10 cost time: 1.5380172729492188
Epoch: 10, Steps: 12 | Train Loss: 1.463 Vali Loss: 1.590 Vali Acc: 0.572 Test Loss: 1.590 Test Acc: 0.572
Validation loss decreased (-0.555538 --> -0.572206).  Saving model ...
Epoch: 11 cost time: 1.516157865524292
Epoch: 11, Steps: 12 | Train Loss: 1.322 Vali Loss: 1.452 Vali Acc: 0.617 Test Loss: 1.452 Test Acc: 0.617
Validation loss decreased (-0.572206 --> -0.616652).  Saving model ...
Epoch: 12 cost time: 1.4186160564422607
Epoch: 12, Steps: 12 | Train Loss: 1.191 Vali Loss: 1.324 Vali Acc: 0.650 Test Loss: 1.324 Test Acc: 0.650
Validation loss decreased (-0.616652 --> -0.649987).  Saving model ...
Epoch: 13 cost time: 1.2593321800231934
Epoch: 13, Steps: 12 | Train Loss: 1.095 Vali Loss: 1.226 Vali Acc: 0.672 Test Loss: 1.226 Test Acc: 0.672
Validation loss decreased (-0.649987 --> -0.672210).  Saving model ...
Epoch: 14 cost time: 1.4262325763702393
Epoch: 14, Steps: 12 | Train Loss: 0.970 Vali Loss: 1.140 Vali Acc: 0.728 Test Loss: 1.140 Test Acc: 0.728
Validation loss decreased (-0.672210 --> -0.727766).  Saving model ...
Epoch: 15 cost time: 1.6472032070159912
Epoch: 15, Steps: 12 | Train Loss: 0.878 Vali Loss: 1.005 Vali Acc: 0.739 Test Loss: 1.005 Test Acc: 0.739
Validation loss decreased (-0.727766 --> -0.738879).  Saving model ...
Epoch: 16 cost time: 1.991335391998291
Epoch: 16, Steps: 12 | Train Loss: 0.775 Vali Loss: 0.930 Vali Acc: 0.750 Test Loss: 0.930 Test Acc: 0.750
Validation loss decreased (-0.738879 --> -0.749991).  Saving model ...
Epoch: 17 cost time: 1.3754844665527344
Epoch: 17, Steps: 12 | Train Loss: 0.694 Vali Loss: 0.860 Vali Acc: 0.778 Test Loss: 0.860 Test Acc: 0.778
Validation loss decreased (-0.749991 --> -0.777769).  Saving model ...
Epoch: 18 cost time: 1.459683895111084
Epoch: 18, Steps: 12 | Train Loss: 0.675 Vali Loss: 0.825 Vali Acc: 0.778 Test Loss: 0.825 Test Acc: 0.778
Validation loss decreased (-0.777769 --> -0.777770).  Saving model ...
Epoch: 19 cost time: 1.3939592838287354
Epoch: 19, Steps: 12 | Train Loss: 0.590 Vali Loss: 0.752 Vali Acc: 0.806 Test Loss: 0.752 Test Acc: 0.806
Validation loss decreased (-0.777770 --> -0.805548).  Saving model ...
Epoch: 20 cost time: 1.4560253620147705
Epoch: 20, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.697 Vali Acc: 0.822 Test Loss: 0.697 Test Acc: 0.822
Validation loss decreased (-0.805548 --> -0.822215).  Saving model ...
Epoch: 21 cost time: 1.4564778804779053
Epoch: 21, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.637 Vali Acc: 0.839 Test Loss: 0.637 Test Acc: 0.839
Validation loss decreased (-0.822215 --> -0.838883).  Saving model ...
Epoch: 22 cost time: 1.6702661514282227
Epoch: 22, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.627 Vali Acc: 0.828 Test Loss: 0.627 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6493535041809082
Epoch: 23, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.577 Vali Acc: 0.856 Test Loss: 0.577 Test Acc: 0.856
Validation loss decreased (-0.838883 --> -0.855550).  Saving model ...
Epoch: 24 cost time: 1.6700341701507568
Epoch: 24, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.553 Vali Acc: 0.867 Test Loss: 0.553 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 25 cost time: 1.4558007717132568
Epoch: 25, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.521 Vali Acc: 0.867 Test Loss: 0.521 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 26 cost time: 1.6727685928344727
Epoch: 26, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.512 Vali Acc: 0.861 Test Loss: 0.512 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.500040054321289
Epoch: 27, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.484 Vali Acc: 0.883 Test Loss: 0.484 Test Acc: 0.883
Validation loss decreased (-0.866661 --> -0.883328).  Saving model ...
Epoch: 28 cost time: 1.6978893280029297
Epoch: 28, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.447 Vali Acc: 0.878 Test Loss: 0.447 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7491154670715332
Epoch: 29, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.446 Vali Acc: 0.883 Test Loss: 0.446 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883329).  Saving model ...
Epoch: 30 cost time: 1.5452497005462646
Epoch: 30, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.432 Vali Acc: 0.878 Test Loss: 0.432 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.272369384765625
Epoch: 31, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.430 Vali Acc: 0.883 Test Loss: 0.430 Test Acc: 0.883
Validation loss decreased (-0.883329 --> -0.883329).  Saving model ...
Epoch: 32 cost time: 1.6235895156860352
Epoch: 32, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.439 Vali Acc: 0.883 Test Loss: 0.439 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2316124439239502
Epoch: 33, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.438 Vali Acc: 0.883 Test Loss: 0.438 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.3279435634613037
Epoch: 34, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.432 Vali Acc: 0.906 Test Loss: 0.432 Test Acc: 0.906
Validation loss decreased (-0.883329 --> -0.905551).  Saving model ...
Epoch: 35 cost time: 1.60768723487854
Epoch: 35, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.421 Vali Acc: 0.883 Test Loss: 0.421 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.4396593570709229
Epoch: 36, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.453 Vali Acc: 0.894 Test Loss: 0.453 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.4389009475708008
Epoch: 37, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.430 Vali Acc: 0.900 Test Loss: 0.430 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.3328070640563965
Epoch: 38, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.433 Vali Acc: 0.906 Test Loss: 0.433 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.3612263202667236
Epoch: 39, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.425 Vali Acc: 0.894 Test Loss: 0.425 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.5932042598724365
Epoch: 40, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.421 Vali Acc: 0.900 Test Loss: 0.421 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.8906242847442627
Epoch: 41, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.446 Vali Acc: 0.889 Test Loss: 0.446 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.5478951930999756
Epoch: 42, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.428 Vali Acc: 0.900 Test Loss: 0.428 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.4697010517120361
Epoch: 43, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.418 Vali Acc: 0.894 Test Loss: 0.418 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.637986660003662
Epoch: 44, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.415 Vali Acc: 0.900 Test Loss: 0.415 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 675571
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2287726402282715
Epoch: 1, Steps: 12 | Train Loss: 2.852 Vali Loss: 2.856 Vali Acc: 0.083 Test Loss: 2.856 Test Acc: 0.083
Validation loss decreased (inf --> -0.083305).  Saving model ...
Epoch: 2 cost time: 1.369302749633789
Epoch: 2, Steps: 12 | Train Loss: 2.758 Vali Loss: 2.716 Vali Acc: 0.128 Test Loss: 2.716 Test Acc: 0.128
Validation loss decreased (-0.083305 --> -0.127751).  Saving model ...
Epoch: 3 cost time: 1.5197288990020752
Epoch: 3, Steps: 12 | Train Loss: 2.650 Vali Loss: 2.614 Vali Acc: 0.233 Test Loss: 2.614 Test Acc: 0.233
Validation loss decreased (-0.127751 --> -0.233307).  Saving model ...
Epoch: 4 cost time: 1.3516464233398438
Epoch: 4, Steps: 12 | Train Loss: 2.547 Vali Loss: 2.509 Vali Acc: 0.306 Test Loss: 2.509 Test Acc: 0.306
Validation loss decreased (-0.233307 --> -0.305530).  Saving model ...
Epoch: 5 cost time: 1.3356049060821533
Epoch: 5, Steps: 12 | Train Loss: 2.382 Vali Loss: 2.383 Vali Acc: 0.311 Test Loss: 2.383 Test Acc: 0.311
Validation loss decreased (-0.305530 --> -0.311087).  Saving model ...
Epoch: 6 cost time: 1.5158605575561523
Epoch: 6, Steps: 12 | Train Loss: 2.260 Vali Loss: 2.226 Vali Acc: 0.339 Test Loss: 2.226 Test Acc: 0.339
Validation loss decreased (-0.311087 --> -0.338867).  Saving model ...
Epoch: 7 cost time: 1.2114312648773193
Epoch: 7, Steps: 12 | Train Loss: 2.039 Vali Loss: 2.039 Vali Acc: 0.422 Test Loss: 2.039 Test Acc: 0.422
Validation loss decreased (-0.338867 --> -0.422202).  Saving model ...
Epoch: 8 cost time: 1.7565674781799316
Epoch: 8, Steps: 12 | Train Loss: 1.855 Vali Loss: 1.844 Vali Acc: 0.494 Test Loss: 1.844 Test Acc: 0.494
Validation loss decreased (-0.422202 --> -0.494426).  Saving model ...
Epoch: 9 cost time: 1.4510433673858643
Epoch: 9, Steps: 12 | Train Loss: 1.644 Vali Loss: 1.685 Vali Acc: 0.522 Test Loss: 1.685 Test Acc: 0.522
Validation loss decreased (-0.494426 --> -0.522205).  Saving model ...
Epoch: 10 cost time: 1.336557388305664
Epoch: 10, Steps: 12 | Train Loss: 1.457 Vali Loss: 1.544 Vali Acc: 0.589 Test Loss: 1.544 Test Acc: 0.589
Validation loss decreased (-0.522205 --> -0.588873).  Saving model ...
Epoch: 11 cost time: 1.2642812728881836
Epoch: 11, Steps: 12 | Train Loss: 1.320 Vali Loss: 1.401 Vali Acc: 0.628 Test Loss: 1.401 Test Acc: 0.628
Validation loss decreased (-0.588873 --> -0.627764).  Saving model ...
Epoch: 12 cost time: 1.3986480236053467
Epoch: 12, Steps: 12 | Train Loss: 1.215 Vali Loss: 1.299 Vali Acc: 0.656 Test Loss: 1.299 Test Acc: 0.656
Validation loss decreased (-0.627764 --> -0.655543).  Saving model ...
Epoch: 13 cost time: 1.388672113418579
Epoch: 13, Steps: 12 | Train Loss: 1.082 Vali Loss: 1.200 Vali Acc: 0.667 Test Loss: 1.200 Test Acc: 0.667
Validation loss decreased (-0.655543 --> -0.666655).  Saving model ...
Epoch: 14 cost time: 1.2930951118469238
Epoch: 14, Steps: 12 | Train Loss: 0.981 Vali Loss: 1.112 Vali Acc: 0.706 Test Loss: 1.112 Test Acc: 0.706
Validation loss decreased (-0.666655 --> -0.705544).  Saving model ...
Epoch: 15 cost time: 1.47255277633667
Epoch: 15, Steps: 12 | Train Loss: 0.891 Vali Loss: 1.036 Vali Acc: 0.711 Test Loss: 1.036 Test Acc: 0.711
Validation loss decreased (-0.705544 --> -0.711101).  Saving model ...
Epoch: 16 cost time: 1.4118824005126953
Epoch: 16, Steps: 12 | Train Loss: 0.821 Vali Loss: 0.987 Vali Acc: 0.739 Test Loss: 0.987 Test Acc: 0.739
Validation loss decreased (-0.711101 --> -0.738879).  Saving model ...
Epoch: 17 cost time: 1.295278549194336
Epoch: 17, Steps: 12 | Train Loss: 0.705 Vali Loss: 0.901 Vali Acc: 0.761 Test Loss: 0.901 Test Acc: 0.761
Validation loss decreased (-0.738879 --> -0.761102).  Saving model ...
Epoch: 18 cost time: 1.345566987991333
Epoch: 18, Steps: 12 | Train Loss: 0.640 Vali Loss: 0.799 Vali Acc: 0.772 Test Loss: 0.799 Test Acc: 0.772
Validation loss decreased (-0.761102 --> -0.772214).  Saving model ...
Epoch: 19 cost time: 1.3008298873901367
Epoch: 19, Steps: 12 | Train Loss: 0.575 Vali Loss: 0.783 Vali Acc: 0.783 Test Loss: 0.783 Test Acc: 0.783
Validation loss decreased (-0.772214 --> -0.783326).  Saving model ...
Epoch: 20 cost time: 1.195706844329834
Epoch: 20, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.692 Vali Acc: 0.800 Test Loss: 0.692 Test Acc: 0.800
Validation loss decreased (-0.783326 --> -0.799993).  Saving model ...
Epoch: 21 cost time: 1.4183034896850586
Epoch: 21, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.662 Vali Acc: 0.811 Test Loss: 0.662 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811104).  Saving model ...
Epoch: 22 cost time: 1.4617972373962402
Epoch: 22, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.637 Vali Acc: 0.789 Test Loss: 0.637 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4572014808654785
Epoch: 23, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.597 Vali Acc: 0.828 Test Loss: 0.597 Test Acc: 0.828
Validation loss decreased (-0.811104 --> -0.827772).  Saving model ...
Epoch: 24 cost time: 1.3460826873779297
Epoch: 24, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.607 Vali Acc: 0.822 Test Loss: 0.607 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3221282958984375
Epoch: 25, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.535 Vali Acc: 0.844 Test Loss: 0.535 Test Acc: 0.844
Validation loss decreased (-0.827772 --> -0.844439).  Saving model ...
Epoch: 26 cost time: 1.2717640399932861
Epoch: 26, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.537 Vali Acc: 0.856 Test Loss: 0.537 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 27 cost time: 1.7847373485565186
Epoch: 27, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.494 Vali Acc: 0.856 Test Loss: 0.494 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855551).  Saving model ...
Epoch: 28 cost time: 1.5303452014923096
Epoch: 28, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.472 Vali Acc: 0.861 Test Loss: 0.472 Test Acc: 0.861
Validation loss decreased (-0.855551 --> -0.861106).  Saving model ...
Epoch: 29 cost time: 1.5768649578094482
Epoch: 29, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.480 Vali Acc: 0.872 Test Loss: 0.480 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 30 cost time: 1.4215068817138672
Epoch: 30, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.448 Vali Acc: 0.867 Test Loss: 0.448 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.48972487449646
Epoch: 31, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.451 Vali Acc: 0.856 Test Loss: 0.451 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.5359845161437988
Epoch: 32, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.453 Vali Acc: 0.878 Test Loss: 0.453 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 33 cost time: 1.3645741939544678
Epoch: 33, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.462 Vali Acc: 0.878 Test Loss: 0.462 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3422536849975586
Epoch: 34, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.421 Vali Acc: 0.878 Test Loss: 0.421 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877774).  Saving model ...
Epoch: 35 cost time: 1.3662354946136475
Epoch: 35, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.467 Vali Acc: 0.889 Test Loss: 0.467 Test Acc: 0.889
Validation loss decreased (-0.877774 --> -0.888884).  Saving model ...
Epoch: 36 cost time: 1.3077549934387207
Epoch: 36, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.430 Vali Acc: 0.883 Test Loss: 0.430 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2781739234924316
Epoch: 37, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.438 Vali Acc: 0.867 Test Loss: 0.438 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.3571033477783203
Epoch: 38, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.455 Vali Acc: 0.889 Test Loss: 0.455 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 39 cost time: 1.277529001235962
Epoch: 39, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.461 Vali Acc: 0.889 Test Loss: 0.461 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.3937177658081055
Epoch: 40, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.412 Vali Acc: 0.889 Test Loss: 0.412 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 41 cost time: 1.312192678451538
Epoch: 41, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.425 Vali Acc: 0.906 Test Loss: 0.425 Test Acc: 0.906
Validation loss decreased (-0.888885 --> -0.905551).  Saving model ...
Epoch: 42 cost time: 1.3184092044830322
Epoch: 42, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.483 Vali Acc: 0.894 Test Loss: 0.483 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.189274549484253
Epoch: 43, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.464 Vali Acc: 0.889 Test Loss: 0.464 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.604386568069458
Epoch: 44, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.443 Vali Acc: 0.889 Test Loss: 0.443 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.2698941230773926
Epoch: 45, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.449 Vali Acc: 0.900 Test Loss: 0.449 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.6018238067626953
Epoch: 46, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.464 Vali Acc: 0.906 Test Loss: 0.464 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.4475798606872559
Epoch: 47, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.439 Vali Acc: 0.906 Test Loss: 0.439 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.5785887241363525
Epoch: 48, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.439 Vali Acc: 0.900 Test Loss: 0.439 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.4539029598236084
Epoch: 49, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.436 Vali Acc: 0.900 Test Loss: 0.436 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.38979172706604
Epoch: 50, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.461 Vali Acc: 0.894 Test Loss: 0.461 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.3047173023223877
Epoch: 51, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.453 Vali Acc: 0.900 Test Loss: 0.453 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 675187
model size : 3.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.74090838432312
Epoch: 1, Steps: 12 | Train Loss: 2.855 Vali Loss: 2.733 Vali Acc: 0.122 Test Loss: 2.733 Test Acc: 0.122
Validation loss decreased (inf --> -0.122195).  Saving model ...
Epoch: 2 cost time: 1.8044514656066895
Epoch: 2, Steps: 12 | Train Loss: 2.699 Vali Loss: 2.595 Vali Acc: 0.206 Test Loss: 2.595 Test Acc: 0.206
Validation loss decreased (-0.122195 --> -0.205530).  Saving model ...
Epoch: 3 cost time: 1.567399263381958
Epoch: 3, Steps: 12 | Train Loss: 2.631 Vali Loss: 2.493 Vali Acc: 0.289 Test Loss: 2.493 Test Acc: 0.289
Validation loss decreased (-0.205530 --> -0.288864).  Saving model ...
Epoch: 4 cost time: 1.401628017425537
Epoch: 4, Steps: 12 | Train Loss: 2.462 Vali Loss: 2.384 Vali Acc: 0.283 Test Loss: 2.384 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.440382480621338
Epoch: 5, Steps: 12 | Train Loss: 2.338 Vali Loss: 2.249 Vali Acc: 0.378 Test Loss: 2.249 Test Acc: 0.378
Validation loss decreased (-0.288864 --> -0.377755).  Saving model ...
Epoch: 6 cost time: 1.2718505859375
Epoch: 6, Steps: 12 | Train Loss: 2.142 Vali Loss: 2.095 Vali Acc: 0.461 Test Loss: 2.095 Test Acc: 0.461
Validation loss decreased (-0.377755 --> -0.461090).  Saving model ...
Epoch: 7 cost time: 1.378113031387329
Epoch: 7, Steps: 12 | Train Loss: 1.959 Vali Loss: 1.945 Vali Acc: 0.483 Test Loss: 1.945 Test Acc: 0.483
Validation loss decreased (-0.461090 --> -0.483314).  Saving model ...
Epoch: 8 cost time: 1.3908910751342773
Epoch: 8, Steps: 12 | Train Loss: 1.787 Vali Loss: 1.808 Vali Acc: 0.511 Test Loss: 1.808 Test Acc: 0.511
Validation loss decreased (-0.483314 --> -0.511093).  Saving model ...
Epoch: 9 cost time: 1.2968380451202393
Epoch: 9, Steps: 12 | Train Loss: 1.711 Vali Loss: 1.683 Vali Acc: 0.528 Test Loss: 1.683 Test Acc: 0.528
Validation loss decreased (-0.511093 --> -0.527761).  Saving model ...
Epoch: 10 cost time: 1.5660438537597656
Epoch: 10, Steps: 12 | Train Loss: 1.454 Vali Loss: 1.562 Vali Acc: 0.533 Test Loss: 1.562 Test Acc: 0.533
Validation loss decreased (-0.527761 --> -0.533318).  Saving model ...
Epoch: 11 cost time: 1.5242960453033447
Epoch: 11, Steps: 12 | Train Loss: 1.319 Vali Loss: 1.456 Vali Acc: 0.589 Test Loss: 1.456 Test Acc: 0.589
Validation loss decreased (-0.533318 --> -0.588874).  Saving model ...
Epoch: 12 cost time: 1.4183738231658936
Epoch: 12, Steps: 12 | Train Loss: 1.218 Vali Loss: 1.359 Vali Acc: 0.594 Test Loss: 1.359 Test Acc: 0.594
Validation loss decreased (-0.588874 --> -0.594431).  Saving model ...
Epoch: 13 cost time: 1.469240427017212
Epoch: 13, Steps: 12 | Train Loss: 1.125 Vali Loss: 1.249 Vali Acc: 0.650 Test Loss: 1.249 Test Acc: 0.650
Validation loss decreased (-0.594431 --> -0.649988).  Saving model ...
Epoch: 14 cost time: 1.5643389225006104
Epoch: 14, Steps: 12 | Train Loss: 1.061 Vali Loss: 1.157 Vali Acc: 0.672 Test Loss: 1.157 Test Acc: 0.672
Validation loss decreased (-0.649988 --> -0.672211).  Saving model ...
Epoch: 15 cost time: 1.4931902885437012
Epoch: 15, Steps: 12 | Train Loss: 0.955 Vali Loss: 1.091 Vali Acc: 0.644 Test Loss: 1.091 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7224228382110596
Epoch: 16, Steps: 12 | Train Loss: 0.817 Vali Loss: 0.989 Vali Acc: 0.728 Test Loss: 0.989 Test Acc: 0.728
Validation loss decreased (-0.672211 --> -0.727768).  Saving model ...
Epoch: 17 cost time: 1.2103064060211182
Epoch: 17, Steps: 12 | Train Loss: 0.724 Vali Loss: 0.908 Vali Acc: 0.728 Test Loss: 0.908 Test Acc: 0.728
Validation loss decreased (-0.727768 --> -0.727769).  Saving model ...
Epoch: 18 cost time: 1.1596100330352783
Epoch: 18, Steps: 12 | Train Loss: 0.669 Vali Loss: 0.838 Vali Acc: 0.733 Test Loss: 0.838 Test Acc: 0.733
Validation loss decreased (-0.727769 --> -0.733325).  Saving model ...
Epoch: 19 cost time: 1.2946412563323975
Epoch: 19, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.815 Vali Acc: 0.756 Test Loss: 0.815 Test Acc: 0.756
Validation loss decreased (-0.733325 --> -0.755547).  Saving model ...
Epoch: 20 cost time: 1.410139560699463
Epoch: 20, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.753 Vali Acc: 0.772 Test Loss: 0.753 Test Acc: 0.772
Validation loss decreased (-0.755547 --> -0.772215).  Saving model ...
Epoch: 21 cost time: 1.4968781471252441
Epoch: 21, Steps: 12 | Train Loss: 0.535 Vali Loss: 0.726 Vali Acc: 0.783 Test Loss: 0.726 Test Acc: 0.783
Validation loss decreased (-0.772215 --> -0.783326).  Saving model ...
Epoch: 22 cost time: 1.588972806930542
Epoch: 22, Steps: 12 | Train Loss: 0.520 Vali Loss: 0.688 Vali Acc: 0.794 Test Loss: 0.688 Test Acc: 0.794
Validation loss decreased (-0.783326 --> -0.794438).  Saving model ...
Epoch: 23 cost time: 1.439743995666504
Epoch: 23, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.634 Vali Acc: 0.828 Test Loss: 0.634 Test Acc: 0.828
Validation loss decreased (-0.794438 --> -0.827771).  Saving model ...
Epoch: 24 cost time: 1.3322267532348633
Epoch: 24, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.611 Vali Acc: 0.811 Test Loss: 0.611 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3340229988098145
Epoch: 25, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.602 Vali Acc: 0.822 Test Loss: 0.602 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3294808864593506
Epoch: 26, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.549 Vali Acc: 0.811 Test Loss: 0.549 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.6148626804351807
Epoch: 27, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.545 Vali Acc: 0.833 Test Loss: 0.545 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833328).  Saving model ...
Epoch: 28 cost time: 1.3492522239685059
Epoch: 28, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.521 Vali Acc: 0.828 Test Loss: 0.521 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4405550956726074
Epoch: 29, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.517 Vali Acc: 0.844 Test Loss: 0.517 Test Acc: 0.844
Validation loss decreased (-0.833328 --> -0.844439).  Saving model ...
Epoch: 30 cost time: 1.4300179481506348
Epoch: 30, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.494 Vali Acc: 0.844 Test Loss: 0.494 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844440).  Saving model ...
Epoch: 31 cost time: 1.4844377040863037
Epoch: 31, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.491 Vali Acc: 0.867 Test Loss: 0.491 Test Acc: 0.867
Validation loss decreased (-0.844440 --> -0.866662).  Saving model ...
Epoch: 32 cost time: 1.2201550006866455
Epoch: 32, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.483 Vali Acc: 0.861 Test Loss: 0.483 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.4191370010375977
Epoch: 33, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.445 Vali Acc: 0.883 Test Loss: 0.445 Test Acc: 0.883
Validation loss decreased (-0.866662 --> -0.883329).  Saving model ...
Epoch: 34 cost time: 1.2604382038116455
Epoch: 34, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.479 Vali Acc: 0.883 Test Loss: 0.479 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.3688099384307861
Epoch: 35, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.477 Vali Acc: 0.856 Test Loss: 0.477 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.5794970989227295
Epoch: 36, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.462 Vali Acc: 0.867 Test Loss: 0.462 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.4680700302124023
Epoch: 37, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.478 Vali Acc: 0.867 Test Loss: 0.478 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.2050549983978271
Epoch: 38, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.502 Vali Acc: 0.861 Test Loss: 0.502 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.4701032638549805
Epoch: 39, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.449 Vali Acc: 0.872 Test Loss: 0.449 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.2742881774902344
Epoch: 40, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.520 Vali Acc: 0.828 Test Loss: 0.520 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.4528777599334717
Epoch: 41, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.455 Vali Acc: 0.867 Test Loss: 0.455 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.9362101554870605
Epoch: 42, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.461 Vali Acc: 0.883 Test Loss: 0.461 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.8676249980926514
Epoch: 43, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.448 Vali Acc: 0.867 Test Loss: 0.448 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 511219
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.217942237854004
Epoch: 1, Steps: 12 | Train Loss: 2.832 Vali Loss: 2.808 Vali Acc: 0.061 Test Loss: 2.808 Test Acc: 0.061
Validation loss decreased (inf --> -0.061083).  Saving model ...
Epoch: 2 cost time: 1.4848923683166504
Epoch: 2, Steps: 12 | Train Loss: 2.760 Vali Loss: 2.710 Vali Acc: 0.083 Test Loss: 2.710 Test Acc: 0.083
Validation loss decreased (-0.061083 --> -0.083306).  Saving model ...
Epoch: 3 cost time: 1.6313247680664062
Epoch: 3, Steps: 12 | Train Loss: 2.695 Vali Loss: 2.627 Vali Acc: 0.100 Test Loss: 2.627 Test Acc: 0.100
Validation loss decreased (-0.083306 --> -0.099974).  Saving model ...
Epoch: 4 cost time: 1.2793769836425781
Epoch: 4, Steps: 12 | Train Loss: 2.579 Vali Loss: 2.535 Vali Acc: 0.206 Test Loss: 2.535 Test Acc: 0.206
Validation loss decreased (-0.099974 --> -0.205530).  Saving model ...
Epoch: 5 cost time: 1.1521565914154053
Epoch: 5, Steps: 12 | Train Loss: 2.492 Vali Loss: 2.441 Vali Acc: 0.294 Test Loss: 2.441 Test Acc: 0.294
Validation loss decreased (-0.205530 --> -0.294420).  Saving model ...
Epoch: 6 cost time: 1.3835604190826416
Epoch: 6, Steps: 12 | Train Loss: 2.322 Vali Loss: 2.309 Vali Acc: 0.356 Test Loss: 2.309 Test Acc: 0.356
Validation loss decreased (-0.294420 --> -0.355532).  Saving model ...
Epoch: 7 cost time: 1.630504846572876
Epoch: 7, Steps: 12 | Train Loss: 2.175 Vali Loss: 2.161 Vali Acc: 0.461 Test Loss: 2.161 Test Acc: 0.461
Validation loss decreased (-0.355532 --> -0.461090).  Saving model ...
Epoch: 8 cost time: 1.5025882720947266
Epoch: 8, Steps: 12 | Train Loss: 2.007 Vali Loss: 2.021 Vali Acc: 0.472 Test Loss: 2.021 Test Acc: 0.472
Validation loss decreased (-0.461090 --> -0.472202).  Saving model ...
Epoch: 9 cost time: 1.4168219566345215
Epoch: 9, Steps: 12 | Train Loss: 1.759 Vali Loss: 1.873 Vali Acc: 0.533 Test Loss: 1.873 Test Acc: 0.533
Validation loss decreased (-0.472202 --> -0.533315).  Saving model ...
Epoch: 10 cost time: 1.4170658588409424
Epoch: 10, Steps: 12 | Train Loss: 1.592 Vali Loss: 1.720 Vali Acc: 0.556 Test Loss: 1.720 Test Acc: 0.556
Validation loss decreased (-0.533315 --> -0.555538).  Saving model ...
Epoch: 11 cost time: 1.2849197387695312
Epoch: 11, Steps: 12 | Train Loss: 1.465 Vali Loss: 1.602 Vali Acc: 0.600 Test Loss: 1.602 Test Acc: 0.600
Validation loss decreased (-0.555538 --> -0.599984).  Saving model ...
Epoch: 12 cost time: 1.3105366230010986
Epoch: 12, Steps: 12 | Train Loss: 1.327 Vali Loss: 1.486 Vali Acc: 0.589 Test Loss: 1.486 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.287705421447754
Epoch: 13, Steps: 12 | Train Loss: 1.233 Vali Loss: 1.381 Vali Acc: 0.644 Test Loss: 1.381 Test Acc: 0.644
Validation loss decreased (-0.599984 --> -0.644431).  Saving model ...
Epoch: 14 cost time: 1.2416958808898926
Epoch: 14, Steps: 12 | Train Loss: 1.154 Vali Loss: 1.266 Vali Acc: 0.650 Test Loss: 1.266 Test Acc: 0.650
Validation loss decreased (-0.644431 --> -0.649987).  Saving model ...
Epoch: 15 cost time: 1.4189198017120361
Epoch: 15, Steps: 12 | Train Loss: 0.985 Vali Loss: 1.186 Vali Acc: 0.683 Test Loss: 1.186 Test Acc: 0.683
Validation loss decreased (-0.649987 --> -0.683321).  Saving model ...
Epoch: 16 cost time: 1.2238125801086426
Epoch: 16, Steps: 12 | Train Loss: 0.924 Vali Loss: 1.115 Vali Acc: 0.717 Test Loss: 1.115 Test Acc: 0.717
Validation loss decreased (-0.683321 --> -0.716656).  Saving model ...
Epoch: 17 cost time: 1.3250033855438232
Epoch: 17, Steps: 12 | Train Loss: 0.859 Vali Loss: 1.023 Vali Acc: 0.706 Test Loss: 1.023 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5036861896514893
Epoch: 18, Steps: 12 | Train Loss: 0.747 Vali Loss: 0.967 Vali Acc: 0.756 Test Loss: 0.967 Test Acc: 0.756
Validation loss decreased (-0.716656 --> -0.755546).  Saving model ...
Epoch: 19 cost time: 1.4234073162078857
Epoch: 19, Steps: 12 | Train Loss: 0.671 Vali Loss: 0.890 Vali Acc: 0.739 Test Loss: 0.890 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2662701606750488
Epoch: 20, Steps: 12 | Train Loss: 0.618 Vali Loss: 0.829 Vali Acc: 0.756 Test Loss: 0.829 Test Acc: 0.756
Validation loss decreased (-0.755546 --> -0.755547).  Saving model ...
Epoch: 21 cost time: 1.1936964988708496
Epoch: 21, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.799 Vali Acc: 0.767 Test Loss: 0.799 Test Acc: 0.767
Validation loss decreased (-0.755547 --> -0.766659).  Saving model ...
Epoch: 22 cost time: 1.274559736251831
Epoch: 22, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.717 Vali Acc: 0.806 Test Loss: 0.717 Test Acc: 0.806
Validation loss decreased (-0.766659 --> -0.805548).  Saving model ...
Epoch: 23 cost time: 1.2932941913604736
Epoch: 23, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.698 Vali Acc: 0.783 Test Loss: 0.698 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5474073886871338
Epoch: 24, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.660 Vali Acc: 0.822 Test Loss: 0.660 Test Acc: 0.822
Validation loss decreased (-0.805548 --> -0.822216).  Saving model ...
Epoch: 25 cost time: 1.3976249694824219
Epoch: 25, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.642 Vali Acc: 0.839 Test Loss: 0.642 Test Acc: 0.839
Validation loss decreased (-0.822216 --> -0.838882).  Saving model ...
Epoch: 26 cost time: 1.3411569595336914
Epoch: 26, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.591 Vali Acc: 0.839 Test Loss: 0.591 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838883).  Saving model ...
Epoch: 27 cost time: 1.4117002487182617
Epoch: 27, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.550 Vali Acc: 0.850 Test Loss: 0.550 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849995).  Saving model ...
Epoch: 28 cost time: 1.3219480514526367
Epoch: 28, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.533 Vali Acc: 0.861 Test Loss: 0.533 Test Acc: 0.861
Validation loss decreased (-0.849995 --> -0.861106).  Saving model ...
Epoch: 29 cost time: 1.3385391235351562
Epoch: 29, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.529 Vali Acc: 0.861 Test Loss: 0.529 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 30 cost time: 1.4050171375274658
Epoch: 30, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.498 Vali Acc: 0.856 Test Loss: 0.498 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4852190017700195
Epoch: 31, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.466 Vali Acc: 0.878 Test Loss: 0.466 Test Acc: 0.878
Validation loss decreased (-0.861106 --> -0.877773).  Saving model ...
Epoch: 32 cost time: 1.337249517440796
Epoch: 32, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.478 Vali Acc: 0.872 Test Loss: 0.478 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.521578073501587
Epoch: 33, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.488 Vali Acc: 0.872 Test Loss: 0.488 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.4106931686401367
Epoch: 34, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.477 Vali Acc: 0.861 Test Loss: 0.477 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.2668635845184326
Epoch: 35, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.475 Vali Acc: 0.856 Test Loss: 0.475 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.4670448303222656
Epoch: 36, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.494 Vali Acc: 0.878 Test Loss: 0.494 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.3826429843902588
Epoch: 37, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.470 Vali Acc: 0.872 Test Loss: 0.470 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.1768507957458496
Epoch: 38, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.478 Vali Acc: 0.889 Test Loss: 0.478 Test Acc: 0.889
Validation loss decreased (-0.877773 --> -0.888884).  Saving model ...
Epoch: 39 cost time: 1.3873844146728516
Epoch: 39, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.473 Vali Acc: 0.867 Test Loss: 0.473 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.4501428604125977
Epoch: 40, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.464 Vali Acc: 0.872 Test Loss: 0.464 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.358351707458496
Epoch: 41, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.465 Vali Acc: 0.878 Test Loss: 0.465 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.425793170928955
Epoch: 42, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.440 Vali Acc: 0.889 Test Loss: 0.440 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 43 cost time: 1.3973956108093262
Epoch: 43, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.447 Vali Acc: 0.900 Test Loss: 0.447 Test Acc: 0.900
Validation loss decreased (-0.888884 --> -0.899996).  Saving model ...
Epoch: 44 cost time: 1.4718263149261475
Epoch: 44, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.439 Vali Acc: 0.894 Test Loss: 0.439 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.4283688068389893
Epoch: 45, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.469 Vali Acc: 0.883 Test Loss: 0.469 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.587329626083374
Epoch: 46, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.442 Vali Acc: 0.883 Test Loss: 0.442 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.3571174144744873
Epoch: 47, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.447 Vali Acc: 0.889 Test Loss: 0.447 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.6614091396331787
Epoch: 48, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.472 Vali Acc: 0.883 Test Loss: 0.472 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.5401055812835693
Epoch: 49, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.475 Vali Acc: 0.883 Test Loss: 0.475 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.5327813625335693
Epoch: 50, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.460 Vali Acc: 0.900 Test Loss: 0.460 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.1975657939910889
Epoch: 51, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.468 Vali Acc: 0.894 Test Loss: 0.468 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.2528696060180664
Epoch: 52, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.481 Vali Acc: 0.894 Test Loss: 0.481 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.326554298400879
Epoch: 53, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.491 Vali Acc: 0.878 Test Loss: 0.491 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 510835
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0287959575653076
Epoch: 1, Steps: 12 | Train Loss: 2.880 Vali Loss: 2.843 Vali Acc: 0.067 Test Loss: 2.843 Test Acc: 0.067
Validation loss decreased (inf --> -0.066638).  Saving model ...
Epoch: 2 cost time: 1.2387783527374268
Epoch: 2, Steps: 12 | Train Loss: 2.757 Vali Loss: 2.709 Vali Acc: 0.117 Test Loss: 2.709 Test Acc: 0.117
Validation loss decreased (-0.066638 --> -0.116640).  Saving model ...
Epoch: 3 cost time: 1.579723834991455
Epoch: 3, Steps: 12 | Train Loss: 2.691 Vali Loss: 2.601 Vali Acc: 0.206 Test Loss: 2.601 Test Acc: 0.206
Validation loss decreased (-0.116640 --> -0.205530).  Saving model ...
Epoch: 4 cost time: 1.4546403884887695
Epoch: 4, Steps: 12 | Train Loss: 2.546 Vali Loss: 2.497 Vali Acc: 0.350 Test Loss: 2.497 Test Acc: 0.350
Validation loss decreased (-0.205530 --> -0.349975).  Saving model ...
Epoch: 5 cost time: 1.2405054569244385
Epoch: 5, Steps: 12 | Train Loss: 2.378 Vali Loss: 2.376 Vali Acc: 0.450 Test Loss: 2.376 Test Acc: 0.450
Validation loss decreased (-0.349975 --> -0.449976).  Saving model ...
Epoch: 6 cost time: 1.458204746246338
Epoch: 6, Steps: 12 | Train Loss: 2.231 Vali Loss: 2.231 Vali Acc: 0.439 Test Loss: 2.231 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6017229557037354
Epoch: 7, Steps: 12 | Train Loss: 2.080 Vali Loss: 2.069 Vali Acc: 0.500 Test Loss: 2.069 Test Acc: 0.500
Validation loss decreased (-0.449976 --> -0.499979).  Saving model ...
Epoch: 8 cost time: 1.384709358215332
Epoch: 8, Steps: 12 | Train Loss: 1.848 Vali Loss: 1.902 Vali Acc: 0.517 Test Loss: 1.902 Test Acc: 0.517
Validation loss decreased (-0.499979 --> -0.516648).  Saving model ...
Epoch: 9 cost time: 1.453955888748169
Epoch: 9, Steps: 12 | Train Loss: 1.728 Vali Loss: 1.762 Vali Acc: 0.539 Test Loss: 1.762 Test Acc: 0.539
Validation loss decreased (-0.516648 --> -0.538871).  Saving model ...
Epoch: 10 cost time: 1.5668971538543701
Epoch: 10, Steps: 12 | Train Loss: 1.560 Vali Loss: 1.623 Vali Acc: 0.600 Test Loss: 1.623 Test Acc: 0.600
Validation loss decreased (-0.538871 --> -0.599984).  Saving model ...
Epoch: 11 cost time: 1.369431495666504
Epoch: 11, Steps: 12 | Train Loss: 1.376 Vali Loss: 1.509 Vali Acc: 0.622 Test Loss: 1.509 Test Acc: 0.622
Validation loss decreased (-0.599984 --> -0.622207).  Saving model ...
Epoch: 12 cost time: 1.3398246765136719
Epoch: 12, Steps: 12 | Train Loss: 1.221 Vali Loss: 1.384 Vali Acc: 0.617 Test Loss: 1.384 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7369370460510254
Epoch: 13, Steps: 12 | Train Loss: 1.165 Vali Loss: 1.289 Vali Acc: 0.661 Test Loss: 1.289 Test Acc: 0.661
Validation loss decreased (-0.622207 --> -0.661098).  Saving model ...
Epoch: 14 cost time: 1.280637502670288
Epoch: 14, Steps: 12 | Train Loss: 1.043 Vali Loss: 1.201 Vali Acc: 0.667 Test Loss: 1.201 Test Acc: 0.667
Validation loss decreased (-0.661098 --> -0.666655).  Saving model ...
Epoch: 15 cost time: 1.6456084251403809
Epoch: 15, Steps: 12 | Train Loss: 0.966 Vali Loss: 1.130 Vali Acc: 0.706 Test Loss: 1.130 Test Acc: 0.706
Validation loss decreased (-0.666655 --> -0.705544).  Saving model ...
Epoch: 16 cost time: 1.5694255828857422
Epoch: 16, Steps: 12 | Train Loss: 0.871 Vali Loss: 1.051 Vali Acc: 0.722 Test Loss: 1.051 Test Acc: 0.722
Validation loss decreased (-0.705544 --> -0.722212).  Saving model ...
Epoch: 17 cost time: 1.4599931240081787
Epoch: 17, Steps: 12 | Train Loss: 0.819 Vali Loss: 0.982 Vali Acc: 0.733 Test Loss: 0.982 Test Acc: 0.733
Validation loss decreased (-0.722212 --> -0.733324).  Saving model ...
Epoch: 18 cost time: 1.347198486328125
Epoch: 18, Steps: 12 | Train Loss: 0.719 Vali Loss: 0.956 Vali Acc: 0.733 Test Loss: 0.956 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 19 cost time: 1.2887370586395264
Epoch: 19, Steps: 12 | Train Loss: 0.688 Vali Loss: 0.902 Vali Acc: 0.756 Test Loss: 0.902 Test Acc: 0.756
Validation loss decreased (-0.733324 --> -0.755547).  Saving model ...
Epoch: 20 cost time: 1.355098009109497
Epoch: 20, Steps: 12 | Train Loss: 0.604 Vali Loss: 0.842 Vali Acc: 0.767 Test Loss: 0.842 Test Acc: 0.767
Validation loss decreased (-0.755547 --> -0.766658).  Saving model ...
Epoch: 21 cost time: 1.6691200733184814
Epoch: 21, Steps: 12 | Train Loss: 0.575 Vali Loss: 0.818 Vali Acc: 0.817 Test Loss: 0.818 Test Acc: 0.817
Validation loss decreased (-0.766658 --> -0.816658).  Saving model ...
Epoch: 22 cost time: 1.4543826580047607
Epoch: 22, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.759 Vali Acc: 0.811 Test Loss: 0.759 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3477842807769775
Epoch: 23, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.712 Vali Acc: 0.822 Test Loss: 0.712 Test Acc: 0.822
Validation loss decreased (-0.816658 --> -0.822215).  Saving model ...
Epoch: 24 cost time: 1.5672051906585693
Epoch: 24, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.673 Vali Acc: 0.833 Test Loss: 0.673 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833327).  Saving model ...
Epoch: 25 cost time: 1.5311026573181152
Epoch: 25, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.624 Vali Acc: 0.828 Test Loss: 0.624 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3330323696136475
Epoch: 26, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.617 Vali Acc: 0.833 Test Loss: 0.617 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 27 cost time: 1.4430136680603027
Epoch: 27, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.580 Vali Acc: 0.833 Test Loss: 0.580 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833328).  Saving model ...
Epoch: 28 cost time: 1.350903034210205
Epoch: 28, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.580 Vali Acc: 0.833 Test Loss: 0.580 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.384629726409912
Epoch: 29, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.557 Vali Acc: 0.861 Test Loss: 0.557 Test Acc: 0.861
Validation loss decreased (-0.833328 --> -0.861106).  Saving model ...
Epoch: 30 cost time: 1.5241055488586426
Epoch: 30, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.519 Vali Acc: 0.861 Test Loss: 0.519 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 31 cost time: 1.32558012008667
Epoch: 31, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.499 Vali Acc: 0.867 Test Loss: 0.499 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866662).  Saving model ...
Epoch: 32 cost time: 1.3374419212341309
Epoch: 32, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.506 Vali Acc: 0.856 Test Loss: 0.506 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.4044277667999268
Epoch: 33, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.476 Vali Acc: 0.872 Test Loss: 0.476 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872217).  Saving model ...
Epoch: 34 cost time: 1.386120080947876
Epoch: 34, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.501 Vali Acc: 0.867 Test Loss: 0.501 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.3772614002227783
Epoch: 35, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.468 Vali Acc: 0.872 Test Loss: 0.468 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872218).  Saving model ...
Epoch: 36 cost time: 1.273167610168457
Epoch: 36, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.481 Vali Acc: 0.878 Test Loss: 0.481 Test Acc: 0.878
Validation loss decreased (-0.872218 --> -0.877773).  Saving model ...
Epoch: 37 cost time: 1.3341741561889648
Epoch: 37, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.464 Vali Acc: 0.883 Test Loss: 0.464 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883329).  Saving model ...
Epoch: 38 cost time: 1.397390365600586
Epoch: 38, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.481 Vali Acc: 0.878 Test Loss: 0.481 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.2110908031463623
Epoch: 39, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.485 Vali Acc: 0.889 Test Loss: 0.485 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888884).  Saving model ...
Epoch: 40 cost time: 1.4229028224945068
Epoch: 40, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.459 Vali Acc: 0.883 Test Loss: 0.459 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.4473302364349365
Epoch: 41, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.455 Vali Acc: 0.894 Test Loss: 0.455 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894440).  Saving model ...
Epoch: 42 cost time: 1.3427352905273438
Epoch: 42, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.507 Vali Acc: 0.883 Test Loss: 0.507 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.4989635944366455
Epoch: 43, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.459 Vali Acc: 0.878 Test Loss: 0.459 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.5176565647125244
Epoch: 44, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.513 Vali Acc: 0.867 Test Loss: 0.513 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.5173730850219727
Epoch: 45, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.511 Vali Acc: 0.878 Test Loss: 0.511 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.3723337650299072
Epoch: 46, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.454 Vali Acc: 0.878 Test Loss: 0.454 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.6628928184509277
Epoch: 47, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.505 Vali Acc: 0.889 Test Loss: 0.505 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.304154634475708
Epoch: 48, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.510 Vali Acc: 0.883 Test Loss: 0.510 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.5155537128448486
Epoch: 49, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.494 Vali Acc: 0.878 Test Loss: 0.494 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.4176616668701172
Epoch: 50, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.465 Vali Acc: 0.883 Test Loss: 0.465 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.3287792205810547
Epoch: 51, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.519 Vali Acc: 0.878 Test Loss: 0.519 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 510451
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5984907150268555
Epoch: 1, Steps: 12 | Train Loss: 2.889 Vali Loss: 2.858 Vali Acc: 0.067 Test Loss: 2.858 Test Acc: 0.067
Validation loss decreased (inf --> -0.066638).  Saving model ...
Epoch: 2 cost time: 1.4258534908294678
Epoch: 2, Steps: 12 | Train Loss: 2.812 Vali Loss: 2.745 Vali Acc: 0.061 Test Loss: 2.745 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5152771472930908
Epoch: 3, Steps: 12 | Train Loss: 2.671 Vali Loss: 2.662 Vali Acc: 0.117 Test Loss: 2.662 Test Acc: 0.117
Validation loss decreased (-0.066638 --> -0.116640).  Saving model ...
Epoch: 4 cost time: 1.1761953830718994
Epoch: 4, Steps: 12 | Train Loss: 2.627 Vali Loss: 2.589 Vali Acc: 0.139 Test Loss: 2.589 Test Acc: 0.139
Validation loss decreased (-0.116640 --> -0.138863).  Saving model ...
Epoch: 5 cost time: 1.1455931663513184
Epoch: 5, Steps: 12 | Train Loss: 2.537 Vali Loss: 2.509 Vali Acc: 0.367 Test Loss: 2.509 Test Acc: 0.367
Validation loss decreased (-0.138863 --> -0.366642).  Saving model ...
Epoch: 6 cost time: 1.5731608867645264
Epoch: 6, Steps: 12 | Train Loss: 2.360 Vali Loss: 2.382 Vali Acc: 0.433 Test Loss: 2.382 Test Acc: 0.433
Validation loss decreased (-0.366642 --> -0.433310).  Saving model ...
Epoch: 7 cost time: 1.5885140895843506
Epoch: 7, Steps: 12 | Train Loss: 2.246 Vali Loss: 2.245 Vali Acc: 0.461 Test Loss: 2.245 Test Acc: 0.461
Validation loss decreased (-0.433310 --> -0.461089).  Saving model ...
Epoch: 8 cost time: 1.3275392055511475
Epoch: 8, Steps: 12 | Train Loss: 1.998 Vali Loss: 2.084 Vali Acc: 0.494 Test Loss: 2.084 Test Acc: 0.494
Validation loss decreased (-0.461089 --> -0.494424).  Saving model ...
Epoch: 9 cost time: 1.3519995212554932
Epoch: 9, Steps: 12 | Train Loss: 1.816 Vali Loss: 1.896 Vali Acc: 0.511 Test Loss: 1.896 Test Acc: 0.511
Validation loss decreased (-0.494424 --> -0.511092).  Saving model ...
Epoch: 10 cost time: 1.3906385898590088
Epoch: 10, Steps: 12 | Train Loss: 1.658 Vali Loss: 1.735 Vali Acc: 0.556 Test Loss: 1.735 Test Acc: 0.556
Validation loss decreased (-0.511092 --> -0.555538).  Saving model ...
Epoch: 11 cost time: 1.494217872619629
Epoch: 11, Steps: 12 | Train Loss: 1.478 Vali Loss: 1.583 Vali Acc: 0.572 Test Loss: 1.583 Test Acc: 0.572
Validation loss decreased (-0.555538 --> -0.572206).  Saving model ...
Epoch: 12 cost time: 1.1743817329406738
Epoch: 12, Steps: 12 | Train Loss: 1.375 Vali Loss: 1.466 Vali Acc: 0.617 Test Loss: 1.466 Test Acc: 0.617
Validation loss decreased (-0.572206 --> -0.616652).  Saving model ...
Epoch: 13 cost time: 1.5366137027740479
Epoch: 13, Steps: 12 | Train Loss: 1.236 Vali Loss: 1.350 Vali Acc: 0.606 Test Loss: 1.350 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6827764511108398
Epoch: 14, Steps: 12 | Train Loss: 1.162 Vali Loss: 1.253 Vali Acc: 0.633 Test Loss: 1.253 Test Acc: 0.633
Validation loss decreased (-0.616652 --> -0.633321).  Saving model ...
Epoch: 15 cost time: 1.8916847705841064
Epoch: 15, Steps: 12 | Train Loss: 0.996 Vali Loss: 1.166 Vali Acc: 0.717 Test Loss: 1.166 Test Acc: 0.717
Validation loss decreased (-0.633321 --> -0.716655).  Saving model ...
Epoch: 16 cost time: 1.49692964553833
Epoch: 16, Steps: 12 | Train Loss: 1.051 Vali Loss: 1.079 Vali Acc: 0.683 Test Loss: 1.079 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.639887809753418
Epoch: 17, Steps: 12 | Train Loss: 0.921 Vali Loss: 1.027 Vali Acc: 0.733 Test Loss: 1.027 Test Acc: 0.733
Validation loss decreased (-0.716655 --> -0.733323).  Saving model ...
Epoch: 18 cost time: 1.4463188648223877
Epoch: 18, Steps: 12 | Train Loss: 0.800 Vali Loss: 0.963 Vali Acc: 0.750 Test Loss: 0.963 Test Acc: 0.750
Validation loss decreased (-0.733323 --> -0.749990).  Saving model ...
Epoch: 19 cost time: 1.4164865016937256
Epoch: 19, Steps: 12 | Train Loss: 0.753 Vali Loss: 0.894 Vali Acc: 0.739 Test Loss: 0.894 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4190125465393066
Epoch: 20, Steps: 12 | Train Loss: 0.685 Vali Loss: 0.852 Vali Acc: 0.744 Test Loss: 0.852 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5887439250946045
Epoch: 21, Steps: 12 | Train Loss: 0.664 Vali Loss: 0.802 Vali Acc: 0.761 Test Loss: 0.802 Test Acc: 0.761
Validation loss decreased (-0.749990 --> -0.761103).  Saving model ...
Epoch: 22 cost time: 1.6319873332977295
Epoch: 22, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.758 Vali Acc: 0.772 Test Loss: 0.758 Test Acc: 0.772
Validation loss decreased (-0.761103 --> -0.772215).  Saving model ...
Epoch: 23 cost time: 1.5004298686981201
Epoch: 23, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.700 Vali Acc: 0.789 Test Loss: 0.700 Test Acc: 0.789
Validation loss decreased (-0.772215 --> -0.788882).  Saving model ...
Epoch: 24 cost time: 1.271113395690918
Epoch: 24, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.712 Vali Acc: 0.800 Test Loss: 0.712 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799993).  Saving model ...
Epoch: 25 cost time: 1.2226731777191162
Epoch: 25, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.645 Vali Acc: 0.817 Test Loss: 0.645 Test Acc: 0.817
Validation loss decreased (-0.799993 --> -0.816660).  Saving model ...
Epoch: 26 cost time: 1.305166244506836
Epoch: 26, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.602 Vali Acc: 0.850 Test Loss: 0.602 Test Acc: 0.850
Validation loss decreased (-0.816660 --> -0.849994).  Saving model ...
Epoch: 27 cost time: 1.4583218097686768
Epoch: 27, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.581 Vali Acc: 0.850 Test Loss: 0.581 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 28 cost time: 1.7128639221191406
Epoch: 28, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.541 Vali Acc: 0.856 Test Loss: 0.541 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 29 cost time: 1.0730254650115967
Epoch: 29, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.519 Vali Acc: 0.856 Test Loss: 0.519 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 30 cost time: 1.3381524085998535
Epoch: 30, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.508 Vali Acc: 0.867 Test Loss: 0.508 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866662).  Saving model ...
Epoch: 31 cost time: 1.1670482158660889
Epoch: 31, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.492 Vali Acc: 0.861 Test Loss: 0.492 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.5348355770111084
Epoch: 32, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.499 Vali Acc: 0.878 Test Loss: 0.499 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877773).  Saving model ...
Epoch: 33 cost time: 1.4276058673858643
Epoch: 33, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.481 Vali Acc: 0.867 Test Loss: 0.481 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.534238576889038
Epoch: 34, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.422 Vali Acc: 0.878 Test Loss: 0.422 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877774).  Saving model ...
Epoch: 35 cost time: 1.463343620300293
Epoch: 35, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.426 Vali Acc: 0.883 Test Loss: 0.426 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883329).  Saving model ...
Epoch: 36 cost time: 1.2534470558166504
Epoch: 36, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.393 Vali Acc: 0.883 Test Loss: 0.393 Test Acc: 0.883
Validation loss decreased (-0.883329 --> -0.883329).  Saving model ...
Epoch: 37 cost time: 1.3281991481781006
Epoch: 37, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.436 Vali Acc: 0.872 Test Loss: 0.436 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.3878440856933594
Epoch: 38, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.424 Vali Acc: 0.883 Test Loss: 0.424 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.3930840492248535
Epoch: 39, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.406 Vali Acc: 0.878 Test Loss: 0.406 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.2716038227081299
Epoch: 40, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.449 Vali Acc: 0.883 Test Loss: 0.449 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.4259474277496338
Epoch: 41, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.412 Vali Acc: 0.883 Test Loss: 0.412 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.6453979015350342
Epoch: 42, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.415 Vali Acc: 0.883 Test Loss: 0.415 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.242760181427002
Epoch: 43, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.396 Vali Acc: 0.894 Test Loss: 0.396 Test Acc: 0.894
Validation loss decreased (-0.883329 --> -0.894440).  Saving model ...
Epoch: 44 cost time: 1.3628201484680176
Epoch: 44, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.400 Vali Acc: 0.889 Test Loss: 0.400 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.7007641792297363
Epoch: 45, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.455 Vali Acc: 0.878 Test Loss: 0.455 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.4993548393249512
Epoch: 46, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.451 Vali Acc: 0.889 Test Loss: 0.451 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.6560912132263184
Epoch: 47, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.393 Vali Acc: 0.900 Test Loss: 0.393 Test Acc: 0.900
Validation loss decreased (-0.894440 --> -0.899996).  Saving model ...
Epoch: 48 cost time: 1.3694207668304443
Epoch: 48, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.388 Vali Acc: 0.894 Test Loss: 0.388 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.7693190574645996
Epoch: 49, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.401 Vali Acc: 0.889 Test Loss: 0.401 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.6225512027740479
Epoch: 50, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.446 Vali Acc: 0.883 Test Loss: 0.446 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.4656219482421875
Epoch: 51, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.439 Vali Acc: 0.889 Test Loss: 0.439 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.641434907913208
Epoch: 52, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.416 Vali Acc: 0.889 Test Loss: 0.416 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.4906818866729736
Epoch: 53, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.464 Vali Acc: 0.889 Test Loss: 0.464 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.4831740856170654
Epoch: 54, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.450 Vali Acc: 0.867 Test Loss: 0.450 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.4917430877685547
Epoch: 55, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.458 Vali Acc: 0.872 Test Loss: 0.458 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.2970213890075684
Epoch: 56, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.447 Vali Acc: 0.878 Test Loss: 0.447 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 1.5110437870025635
Epoch: 57, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.429 Vali Acc: 0.867 Test Loss: 0.429 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 510067
model size : 3.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8816089630126953
Epoch: 1, Steps: 12 | Train Loss: 2.904 Vali Loss: 2.792 Vali Acc: 0.078 Test Loss: 2.792 Test Acc: 0.078
Validation loss decreased (inf --> -0.077750).  Saving model ...
Epoch: 2 cost time: 1.3178677558898926
Epoch: 2, Steps: 12 | Train Loss: 2.823 Vali Loss: 2.701 Vali Acc: 0.083 Test Loss: 2.701 Test Acc: 0.083
Validation loss decreased (-0.077750 --> -0.083306).  Saving model ...
Epoch: 3 cost time: 1.326728105545044
Epoch: 3, Steps: 12 | Train Loss: 2.714 Vali Loss: 2.630 Vali Acc: 0.078 Test Loss: 2.630 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7041089534759521
Epoch: 4, Steps: 12 | Train Loss: 2.653 Vali Loss: 2.561 Vali Acc: 0.211 Test Loss: 2.561 Test Acc: 0.211
Validation loss decreased (-0.083306 --> -0.211086).  Saving model ...
Epoch: 5 cost time: 1.460890293121338
Epoch: 5, Steps: 12 | Train Loss: 2.530 Vali Loss: 2.476 Vali Acc: 0.344 Test Loss: 2.476 Test Acc: 0.344
Validation loss decreased (-0.211086 --> -0.344420).  Saving model ...
Epoch: 6 cost time: 1.457777976989746
Epoch: 6, Steps: 12 | Train Loss: 2.500 Vali Loss: 2.378 Vali Acc: 0.417 Test Loss: 2.378 Test Acc: 0.417
Validation loss decreased (-0.344420 --> -0.416643).  Saving model ...
Epoch: 7 cost time: 1.228682518005371
Epoch: 7, Steps: 12 | Train Loss: 2.328 Vali Loss: 2.262 Vali Acc: 0.367 Test Loss: 2.262 Test Acc: 0.367
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3587679862976074
Epoch: 8, Steps: 12 | Train Loss: 2.204 Vali Loss: 2.120 Vali Acc: 0.494 Test Loss: 2.120 Test Acc: 0.494
Validation loss decreased (-0.416643 --> -0.494423).  Saving model ...
Epoch: 9 cost time: 1.493441104888916
Epoch: 9, Steps: 12 | Train Loss: 1.959 Vali Loss: 1.967 Vali Acc: 0.522 Test Loss: 1.967 Test Acc: 0.522
Validation loss decreased (-0.494423 --> -0.522203).  Saving model ...
Epoch: 10 cost time: 1.900315284729004
Epoch: 10, Steps: 12 | Train Loss: 1.849 Vali Loss: 1.838 Vali Acc: 0.578 Test Loss: 1.838 Test Acc: 0.578
Validation loss decreased (-0.522203 --> -0.577759).  Saving model ...
Epoch: 11 cost time: 1.4961023330688477
Epoch: 11, Steps: 12 | Train Loss: 1.648 Vali Loss: 1.688 Vali Acc: 0.606 Test Loss: 1.688 Test Acc: 0.606
Validation loss decreased (-0.577759 --> -0.605539).  Saving model ...
Epoch: 12 cost time: 1.3351943492889404
Epoch: 12, Steps: 12 | Train Loss: 1.524 Vali Loss: 1.546 Vali Acc: 0.617 Test Loss: 1.546 Test Acc: 0.617
Validation loss decreased (-0.605539 --> -0.616651).  Saving model ...
Epoch: 13 cost time: 1.3529789447784424
Epoch: 13, Steps: 12 | Train Loss: 1.382 Vali Loss: 1.429 Vali Acc: 0.633 Test Loss: 1.429 Test Acc: 0.633
Validation loss decreased (-0.616651 --> -0.633319).  Saving model ...
Epoch: 14 cost time: 1.4394581317901611
Epoch: 14, Steps: 12 | Train Loss: 1.178 Vali Loss: 1.300 Vali Acc: 0.633 Test Loss: 1.300 Test Acc: 0.633
Validation loss decreased (-0.633319 --> -0.633320).  Saving model ...
Epoch: 15 cost time: 1.4810171127319336
Epoch: 15, Steps: 12 | Train Loss: 1.180 Vali Loss: 1.216 Vali Acc: 0.694 Test Loss: 1.216 Test Acc: 0.694
Validation loss decreased (-0.633320 --> -0.694432).  Saving model ...
Epoch: 16 cost time: 1.2867310047149658
Epoch: 16, Steps: 12 | Train Loss: 1.041 Vali Loss: 1.111 Vali Acc: 0.706 Test Loss: 1.111 Test Acc: 0.706
Validation loss decreased (-0.694432 --> -0.705544).  Saving model ...
Epoch: 17 cost time: 1.6448757648468018
Epoch: 17, Steps: 12 | Train Loss: 0.927 Vali Loss: 1.023 Vali Acc: 0.728 Test Loss: 1.023 Test Acc: 0.728
Validation loss decreased (-0.705544 --> -0.727768).  Saving model ...
Epoch: 18 cost time: 1.5332307815551758
Epoch: 18, Steps: 12 | Train Loss: 0.813 Vali Loss: 0.958 Vali Acc: 0.733 Test Loss: 0.958 Test Acc: 0.733
Validation loss decreased (-0.727768 --> -0.733324).  Saving model ...
Epoch: 19 cost time: 1.8068578243255615
Epoch: 19, Steps: 12 | Train Loss: 0.729 Vali Loss: 0.869 Vali Acc: 0.756 Test Loss: 0.869 Test Acc: 0.756
Validation loss decreased (-0.733324 --> -0.755547).  Saving model ...
Epoch: 20 cost time: 1.6701347827911377
Epoch: 20, Steps: 12 | Train Loss: 0.663 Vali Loss: 0.835 Vali Acc: 0.756 Test Loss: 0.835 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755547).  Saving model ...
Epoch: 21 cost time: 1.4749267101287842
Epoch: 21, Steps: 12 | Train Loss: 0.646 Vali Loss: 0.806 Vali Acc: 0.761 Test Loss: 0.806 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761103).  Saving model ...
Epoch: 22 cost time: 1.3431389331817627
Epoch: 22, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.741 Vali Acc: 0.789 Test Loss: 0.741 Test Acc: 0.789
Validation loss decreased (-0.761103 --> -0.788881).  Saving model ...
Epoch: 23 cost time: 1.33355712890625
Epoch: 23, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.689 Vali Acc: 0.806 Test Loss: 0.689 Test Acc: 0.806
Validation loss decreased (-0.788881 --> -0.805549).  Saving model ...
Epoch: 24 cost time: 1.3103632926940918
Epoch: 24, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.678 Vali Acc: 0.822 Test Loss: 0.678 Test Acc: 0.822
Validation loss decreased (-0.805549 --> -0.822215).  Saving model ...
Epoch: 25 cost time: 1.2785985469818115
Epoch: 25, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.632 Vali Acc: 0.833 Test Loss: 0.632 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833327).  Saving model ...
Epoch: 26 cost time: 1.6661818027496338
Epoch: 26, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.609 Vali Acc: 0.828 Test Loss: 0.609 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5766947269439697
Epoch: 27, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.565 Vali Acc: 0.850 Test Loss: 0.565 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849994).  Saving model ...
Epoch: 28 cost time: 1.2355072498321533
Epoch: 28, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.596 Vali Acc: 0.833 Test Loss: 0.596 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5636355876922607
Epoch: 29, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.556 Vali Acc: 0.833 Test Loss: 0.556 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4664077758789062
Epoch: 30, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.520 Vali Acc: 0.856 Test Loss: 0.520 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 31 cost time: 1.6052899360656738
Epoch: 31, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.499 Vali Acc: 0.872 Test Loss: 0.499 Test Acc: 0.872
Validation loss decreased (-0.855550 --> -0.872217).  Saving model ...
Epoch: 32 cost time: 1.4670445919036865
Epoch: 32, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.530 Vali Acc: 0.872 Test Loss: 0.530 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.425100326538086
Epoch: 33, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.503 Vali Acc: 0.878 Test Loss: 0.503 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 34 cost time: 1.2509198188781738
Epoch: 34, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.491 Vali Acc: 0.872 Test Loss: 0.491 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2736139297485352
Epoch: 35, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.490 Vali Acc: 0.872 Test Loss: 0.490 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.444565773010254
Epoch: 36, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.456 Vali Acc: 0.861 Test Loss: 0.456 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.589970350265503
Epoch: 37, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.492 Vali Acc: 0.872 Test Loss: 0.492 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.8245582580566406
Epoch: 38, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.518 Vali Acc: 0.889 Test Loss: 0.518 Test Acc: 0.889
Validation loss decreased (-0.877773 --> -0.888884).  Saving model ...
Epoch: 39 cost time: 1.6161372661590576
Epoch: 39, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.461 Vali Acc: 0.889 Test Loss: 0.461 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 40 cost time: 1.5766921043395996
Epoch: 40, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.442 Vali Acc: 0.894 Test Loss: 0.442 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894440).  Saving model ...
Epoch: 41 cost time: 1.5226256847381592
Epoch: 41, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.514 Vali Acc: 0.889 Test Loss: 0.514 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.3585221767425537
Epoch: 42, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.480 Vali Acc: 0.872 Test Loss: 0.480 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.3393230438232422
Epoch: 43, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.480 Vali Acc: 0.856 Test Loss: 0.480 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.793302059173584
Epoch: 44, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.507 Vali Acc: 0.883 Test Loss: 0.507 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.7197799682617188
Epoch: 45, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.466 Vali Acc: 0.889 Test Loss: 0.466 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.8820781707763672
Epoch: 46, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.441 Vali Acc: 0.883 Test Loss: 0.441 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.6794931888580322
Epoch: 47, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.484 Vali Acc: 0.894 Test Loss: 0.484 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.4222619533538818
Epoch: 48, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.457 Vali Acc: 0.894 Test Loss: 0.457 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.5273189544677734
Epoch: 49, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.484 Vali Acc: 0.878 Test Loss: 0.484 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.391810655593872
Epoch: 50, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.489 Vali Acc: 0.889 Test Loss: 0.489 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 428659
model size : 2.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.336406707763672
Epoch: 1, Steps: 12 | Train Loss: 2.813 Vali Loss: 2.828 Vali Acc: 0.078 Test Loss: 2.828 Test Acc: 0.078
Validation loss decreased (inf --> -0.077750).  Saving model ...
Epoch: 2 cost time: 1.7755558490753174
Epoch: 2, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.728 Vali Acc: 0.111 Test Loss: 2.728 Test Acc: 0.111
Validation loss decreased (-0.077750 --> -0.111084).  Saving model ...
Epoch: 3 cost time: 1.5281357765197754
Epoch: 3, Steps: 12 | Train Loss: 2.712 Vali Loss: 2.643 Vali Acc: 0.194 Test Loss: 2.643 Test Acc: 0.194
Validation loss decreased (-0.111084 --> -0.194418).  Saving model ...
Epoch: 4 cost time: 1.4626684188842773
Epoch: 4, Steps: 12 | Train Loss: 2.569 Vali Loss: 2.564 Vali Acc: 0.222 Test Loss: 2.564 Test Acc: 0.222
Validation loss decreased (-0.194418 --> -0.222197).  Saving model ...
Epoch: 5 cost time: 1.4801156520843506
Epoch: 5, Steps: 12 | Train Loss: 2.476 Vali Loss: 2.473 Vali Acc: 0.294 Test Loss: 2.473 Test Acc: 0.294
Validation loss decreased (-0.222197 --> -0.294420).  Saving model ...
Epoch: 6 cost time: 1.5331332683563232
Epoch: 6, Steps: 12 | Train Loss: 2.356 Vali Loss: 2.387 Vali Acc: 0.383 Test Loss: 2.387 Test Acc: 0.383
Validation loss decreased (-0.294420 --> -0.383309).  Saving model ...
Epoch: 7 cost time: 1.4788999557495117
Epoch: 7, Steps: 12 | Train Loss: 2.262 Vali Loss: 2.272 Vali Acc: 0.344 Test Loss: 2.272 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.43953537940979
Epoch: 8, Steps: 12 | Train Loss: 2.102 Vali Loss: 2.139 Vali Acc: 0.483 Test Loss: 2.139 Test Acc: 0.483
Validation loss decreased (-0.383309 --> -0.483312).  Saving model ...
Epoch: 9 cost time: 1.38392972946167
Epoch: 9, Steps: 12 | Train Loss: 1.943 Vali Loss: 1.971 Vali Acc: 0.483 Test Loss: 1.971 Test Acc: 0.483
Validation loss decreased (-0.483312 --> -0.483314).  Saving model ...
Epoch: 10 cost time: 1.3713936805725098
Epoch: 10, Steps: 12 | Train Loss: 1.719 Vali Loss: 1.812 Vali Acc: 0.567 Test Loss: 1.812 Test Acc: 0.567
Validation loss decreased (-0.483314 --> -0.566649).  Saving model ...
Epoch: 11 cost time: 1.3283240795135498
Epoch: 11, Steps: 12 | Train Loss: 1.560 Vali Loss: 1.687 Vali Acc: 0.628 Test Loss: 1.687 Test Acc: 0.628
Validation loss decreased (-0.566649 --> -0.627761).  Saving model ...
Epoch: 12 cost time: 1.5579698085784912
Epoch: 12, Steps: 12 | Train Loss: 1.496 Vali Loss: 1.563 Vali Acc: 0.611 Test Loss: 1.563 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.391425609588623
Epoch: 13, Steps: 12 | Train Loss: 1.319 Vali Loss: 1.430 Vali Acc: 0.606 Test Loss: 1.430 Test Acc: 0.606
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.711836338043213
Epoch: 14, Steps: 12 | Train Loss: 1.186 Vali Loss: 1.323 Vali Acc: 0.678 Test Loss: 1.323 Test Acc: 0.678
Validation loss decreased (-0.627761 --> -0.677765).  Saving model ...
Epoch: 15 cost time: 1.4853527545928955
Epoch: 15, Steps: 12 | Train Loss: 1.169 Vali Loss: 1.236 Vali Acc: 0.694 Test Loss: 1.236 Test Acc: 0.694
Validation loss decreased (-0.677765 --> -0.694432).  Saving model ...
Epoch: 16 cost time: 1.390362024307251
Epoch: 16, Steps: 12 | Train Loss: 0.969 Vali Loss: 1.122 Vali Acc: 0.694 Test Loss: 1.122 Test Acc: 0.694
Validation loss decreased (-0.694432 --> -0.694433).  Saving model ...
Epoch: 17 cost time: 1.6370556354522705
Epoch: 17, Steps: 12 | Train Loss: 0.918 Vali Loss: 1.061 Vali Acc: 0.733 Test Loss: 1.061 Test Acc: 0.733
Validation loss decreased (-0.694433 --> -0.733323).  Saving model ...
Epoch: 18 cost time: 1.7087531089782715
Epoch: 18, Steps: 12 | Train Loss: 0.831 Vali Loss: 0.990 Vali Acc: 0.750 Test Loss: 0.990 Test Acc: 0.750
Validation loss decreased (-0.733323 --> -0.749990).  Saving model ...
Epoch: 19 cost time: 1.3616321086883545
Epoch: 19, Steps: 12 | Train Loss: 0.741 Vali Loss: 0.939 Vali Acc: 0.750 Test Loss: 0.939 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 20 cost time: 1.4686074256896973
Epoch: 20, Steps: 12 | Train Loss: 0.681 Vali Loss: 0.889 Vali Acc: 0.772 Test Loss: 0.889 Test Acc: 0.772
Validation loss decreased (-0.749991 --> -0.772213).  Saving model ...
Epoch: 21 cost time: 1.4275169372558594
Epoch: 21, Steps: 12 | Train Loss: 0.670 Vali Loss: 0.835 Vali Acc: 0.783 Test Loss: 0.835 Test Acc: 0.783
Validation loss decreased (-0.772213 --> -0.783325).  Saving model ...
Epoch: 22 cost time: 1.490476131439209
Epoch: 22, Steps: 12 | Train Loss: 0.589 Vali Loss: 0.786 Vali Acc: 0.794 Test Loss: 0.786 Test Acc: 0.794
Validation loss decreased (-0.783325 --> -0.794437).  Saving model ...
Epoch: 23 cost time: 1.4940500259399414
Epoch: 23, Steps: 12 | Train Loss: 0.617 Vali Loss: 0.726 Vali Acc: 0.789 Test Loss: 0.726 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3893284797668457
Epoch: 24, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.717 Vali Acc: 0.811 Test Loss: 0.717 Test Acc: 0.811
Validation loss decreased (-0.794437 --> -0.811104).  Saving model ...
Epoch: 25 cost time: 1.3343486785888672
Epoch: 25, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.663 Vali Acc: 0.822 Test Loss: 0.663 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822216).  Saving model ...
Epoch: 26 cost time: 1.8206002712249756
Epoch: 26, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.642 Vali Acc: 0.822 Test Loss: 0.642 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 27 cost time: 1.6087396144866943
Epoch: 27, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.602 Vali Acc: 0.839 Test Loss: 0.602 Test Acc: 0.839
Validation loss decreased (-0.822216 --> -0.838883).  Saving model ...
Epoch: 28 cost time: 1.5027060508728027
Epoch: 28, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.579 Vali Acc: 0.850 Test Loss: 0.579 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 29 cost time: 1.4347209930419922
Epoch: 29, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.586 Vali Acc: 0.856 Test Loss: 0.586 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 30 cost time: 1.3423607349395752
Epoch: 30, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.524 Vali Acc: 0.861 Test Loss: 0.524 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 31 cost time: 1.6925268173217773
Epoch: 31, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.526 Vali Acc: 0.872 Test Loss: 0.526 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 32 cost time: 1.4509758949279785
Epoch: 32, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.525 Vali Acc: 0.856 Test Loss: 0.525 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.257289171218872
Epoch: 33, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.476 Vali Acc: 0.861 Test Loss: 0.476 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.7656075954437256
Epoch: 34, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.491 Vali Acc: 0.867 Test Loss: 0.491 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.6955444812774658
Epoch: 35, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.486 Vali Acc: 0.878 Test Loss: 0.486 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 36 cost time: 1.5164368152618408
Epoch: 36, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.467 Vali Acc: 0.867 Test Loss: 0.467 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.5201470851898193
Epoch: 37, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.473 Vali Acc: 0.867 Test Loss: 0.473 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.6522409915924072
Epoch: 38, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.469 Vali Acc: 0.889 Test Loss: 0.469 Test Acc: 0.889
Validation loss decreased (-0.877773 --> -0.888884).  Saving model ...
Epoch: 39 cost time: 1.596116065979004
Epoch: 39, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.474 Vali Acc: 0.861 Test Loss: 0.474 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.680295705795288
Epoch: 40, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.450 Vali Acc: 0.878 Test Loss: 0.450 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.6085858345031738
Epoch: 41, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.455 Vali Acc: 0.883 Test Loss: 0.455 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.5806152820587158
Epoch: 42, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.441 Vali Acc: 0.878 Test Loss: 0.441 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.466465711593628
Epoch: 43, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.448 Vali Acc: 0.883 Test Loss: 0.448 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.5704734325408936
Epoch: 44, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.473 Vali Acc: 0.878 Test Loss: 0.473 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.3555421829223633
Epoch: 45, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.442 Vali Acc: 0.872 Test Loss: 0.442 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.5287280082702637
Epoch: 46, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.454 Vali Acc: 0.889 Test Loss: 0.454 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 47 cost time: 1.358114242553711
Epoch: 47, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.450 Vali Acc: 0.872 Test Loss: 0.450 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.744417428970337
Epoch: 48, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.515 Vali Acc: 0.867 Test Loss: 0.515 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.5270962715148926
Epoch: 49, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.497 Vali Acc: 0.850 Test Loss: 0.497 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.3236744403839111
Epoch: 50, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.515 Vali Acc: 0.878 Test Loss: 0.515 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.4350647926330566
Epoch: 51, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.457 Vali Acc: 0.872 Test Loss: 0.457 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.466968297958374
Epoch: 52, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.461 Vali Acc: 0.878 Test Loss: 0.461 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.6190457344055176
Epoch: 53, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.479 Vali Acc: 0.861 Test Loss: 0.479 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.5208232402801514
Epoch: 54, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.457 Vali Acc: 0.878 Test Loss: 0.457 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.435779333114624
Epoch: 55, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.483 Vali Acc: 0.883 Test Loss: 0.483 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.2166662216186523
Epoch: 56, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.492 Vali Acc: 0.883 Test Loss: 0.492 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 428275
model size : 2.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.840278148651123
Epoch: 1, Steps: 12 | Train Loss: 2.857 Vali Loss: 2.739 Vali Acc: 0.044 Test Loss: 2.739 Test Acc: 0.044
Validation loss decreased (inf --> -0.044417).  Saving model ...
Epoch: 2 cost time: 1.2729318141937256
Epoch: 2, Steps: 12 | Train Loss: 2.764 Vali Loss: 2.652 Vali Acc: 0.144 Test Loss: 2.652 Test Acc: 0.144
Validation loss decreased (-0.044417 --> -0.144418).  Saving model ...
Epoch: 3 cost time: 1.3593485355377197
Epoch: 3, Steps: 12 | Train Loss: 2.732 Vali Loss: 2.587 Vali Acc: 0.206 Test Loss: 2.587 Test Acc: 0.206
Validation loss decreased (-0.144418 --> -0.205530).  Saving model ...
Epoch: 4 cost time: 1.3261549472808838
Epoch: 4, Steps: 12 | Train Loss: 2.611 Vali Loss: 2.504 Vali Acc: 0.328 Test Loss: 2.504 Test Acc: 0.328
Validation loss decreased (-0.205530 --> -0.327753).  Saving model ...
Epoch: 5 cost time: 1.3139727115631104
Epoch: 5, Steps: 12 | Train Loss: 2.540 Vali Loss: 2.413 Vali Acc: 0.367 Test Loss: 2.413 Test Acc: 0.367
Validation loss decreased (-0.327753 --> -0.366643).  Saving model ...
Epoch: 6 cost time: 1.288825511932373
Epoch: 6, Steps: 12 | Train Loss: 2.417 Vali Loss: 2.312 Vali Acc: 0.422 Test Loss: 2.312 Test Acc: 0.422
Validation loss decreased (-0.366643 --> -0.422199).  Saving model ...
Epoch: 7 cost time: 1.260848045349121
Epoch: 7, Steps: 12 | Train Loss: 2.319 Vali Loss: 2.191 Vali Acc: 0.439 Test Loss: 2.191 Test Acc: 0.439
Validation loss decreased (-0.422199 --> -0.438867).  Saving model ...
Epoch: 8 cost time: 1.315880537033081
Epoch: 8, Steps: 12 | Train Loss: 2.169 Vali Loss: 2.040 Vali Acc: 0.511 Test Loss: 2.040 Test Acc: 0.511
Validation loss decreased (-0.438867 --> -0.511091).  Saving model ...
Epoch: 9 cost time: 1.1378607749938965
Epoch: 9, Steps: 12 | Train Loss: 2.000 Vali Loss: 1.903 Vali Acc: 0.556 Test Loss: 1.903 Test Acc: 0.556
Validation loss decreased (-0.511091 --> -0.555537).  Saving model ...
Epoch: 10 cost time: 1.4174151420593262
Epoch: 10, Steps: 12 | Train Loss: 1.774 Vali Loss: 1.752 Vali Acc: 0.578 Test Loss: 1.752 Test Acc: 0.578
Validation loss decreased (-0.555537 --> -0.577760).  Saving model ...
Epoch: 11 cost time: 1.3476083278656006
Epoch: 11, Steps: 12 | Train Loss: 1.627 Vali Loss: 1.612 Vali Acc: 0.633 Test Loss: 1.612 Test Acc: 0.633
Validation loss decreased (-0.577760 --> -0.633317).  Saving model ...
Epoch: 12 cost time: 1.502016305923462
Epoch: 12, Steps: 12 | Train Loss: 1.492 Vali Loss: 1.494 Vali Acc: 0.639 Test Loss: 1.494 Test Acc: 0.639
Validation loss decreased (-0.633317 --> -0.638874).  Saving model ...
Epoch: 13 cost time: 1.4743895530700684
Epoch: 13, Steps: 12 | Train Loss: 1.384 Vali Loss: 1.389 Vali Acc: 0.633 Test Loss: 1.389 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4692301750183105
Epoch: 14, Steps: 12 | Train Loss: 1.198 Vali Loss: 1.276 Vali Acc: 0.694 Test Loss: 1.276 Test Acc: 0.694
Validation loss decreased (-0.638874 --> -0.694432).  Saving model ...
Epoch: 15 cost time: 1.4719083309173584
Epoch: 15, Steps: 12 | Train Loss: 1.108 Vali Loss: 1.193 Vali Acc: 0.694 Test Loss: 1.193 Test Acc: 0.694
Validation loss decreased (-0.694432 --> -0.694433).  Saving model ...
Epoch: 16 cost time: 1.523926019668579
Epoch: 16, Steps: 12 | Train Loss: 1.022 Vali Loss: 1.114 Vali Acc: 0.700 Test Loss: 1.114 Test Acc: 0.700
Validation loss decreased (-0.694433 --> -0.699989).  Saving model ...
Epoch: 17 cost time: 1.6206028461456299
Epoch: 17, Steps: 12 | Train Loss: 0.884 Vali Loss: 1.038 Vali Acc: 0.733 Test Loss: 1.038 Test Acc: 0.733
Validation loss decreased (-0.699989 --> -0.733323).  Saving model ...
Epoch: 18 cost time: 1.618513584136963
Epoch: 18, Steps: 12 | Train Loss: 0.823 Vali Loss: 0.999 Vali Acc: 0.733 Test Loss: 0.999 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 19 cost time: 1.3673408031463623
Epoch: 19, Steps: 12 | Train Loss: 0.752 Vali Loss: 0.937 Vali Acc: 0.728 Test Loss: 0.937 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5920493602752686
Epoch: 20, Steps: 12 | Train Loss: 0.678 Vali Loss: 0.859 Vali Acc: 0.744 Test Loss: 0.859 Test Acc: 0.744
Validation loss decreased (-0.733323 --> -0.744436).  Saving model ...
Epoch: 21 cost time: 1.7862811088562012
Epoch: 21, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.808 Vali Acc: 0.789 Test Loss: 0.808 Test Acc: 0.789
Validation loss decreased (-0.744436 --> -0.788881).  Saving model ...
Epoch: 22 cost time: 1.6539454460144043
Epoch: 22, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.765 Vali Acc: 0.811 Test Loss: 0.765 Test Acc: 0.811
Validation loss decreased (-0.788881 --> -0.811103).  Saving model ...
Epoch: 23 cost time: 1.4418458938598633
Epoch: 23, Steps: 12 | Train Loss: 0.545 Vali Loss: 0.697 Vali Acc: 0.817 Test Loss: 0.697 Test Acc: 0.817
Validation loss decreased (-0.811103 --> -0.816660).  Saving model ...
Epoch: 24 cost time: 1.4393644332885742
Epoch: 24, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.686 Vali Acc: 0.822 Test Loss: 0.686 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822215).  Saving model ...
Epoch: 25 cost time: 1.400935173034668
Epoch: 25, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.610 Vali Acc: 0.828 Test Loss: 0.610 Test Acc: 0.828
Validation loss decreased (-0.822215 --> -0.827772).  Saving model ...
Epoch: 26 cost time: 1.5423767566680908
Epoch: 26, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.610 Vali Acc: 0.828 Test Loss: 0.610 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.699885606765747
Epoch: 27, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.560 Vali Acc: 0.844 Test Loss: 0.560 Test Acc: 0.844
Validation loss decreased (-0.827772 --> -0.844439).  Saving model ...
Epoch: 28 cost time: 1.5085339546203613
Epoch: 28, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.531 Vali Acc: 0.844 Test Loss: 0.531 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 29 cost time: 1.659451961517334
Epoch: 29, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.532 Vali Acc: 0.850 Test Loss: 0.532 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849995).  Saving model ...
Epoch: 30 cost time: 1.1022765636444092
Epoch: 30, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.515 Vali Acc: 0.872 Test Loss: 0.515 Test Acc: 0.872
Validation loss decreased (-0.849995 --> -0.872217).  Saving model ...
Epoch: 31 cost time: 1.6000604629516602
Epoch: 31, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.490 Vali Acc: 0.856 Test Loss: 0.490 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.3959531784057617
Epoch: 32, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.454 Vali Acc: 0.867 Test Loss: 0.454 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.330887794494629
Epoch: 33, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.451 Vali Acc: 0.856 Test Loss: 0.451 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.7088263034820557
Epoch: 34, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.451 Vali Acc: 0.872 Test Loss: 0.451 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872218).  Saving model ...
Epoch: 35 cost time: 1.4502925872802734
Epoch: 35, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.442 Vali Acc: 0.867 Test Loss: 0.442 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.605116844177246
Epoch: 36, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.433 Vali Acc: 0.850 Test Loss: 0.433 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.4203875064849854
Epoch: 37, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.455 Vali Acc: 0.878 Test Loss: 0.455 Test Acc: 0.878
Validation loss decreased (-0.872218 --> -0.877773).  Saving model ...
Epoch: 38 cost time: 1.2082860469818115
Epoch: 38, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.440 Vali Acc: 0.867 Test Loss: 0.440 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.5186092853546143
Epoch: 39, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.431 Vali Acc: 0.878 Test Loss: 0.431 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 40 cost time: 1.448211908340454
Epoch: 40, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.401 Vali Acc: 0.878 Test Loss: 0.401 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877774).  Saving model ...
Epoch: 41 cost time: 1.5511231422424316
Epoch: 41, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.440 Vali Acc: 0.878 Test Loss: 0.440 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.121603012084961
Epoch: 42, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.404 Vali Acc: 0.889 Test Loss: 0.404 Test Acc: 0.889
Validation loss decreased (-0.877774 --> -0.888885).  Saving model ...
Epoch: 43 cost time: 1.6431734561920166
Epoch: 43, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.430 Vali Acc: 0.878 Test Loss: 0.430 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.6419386863708496
Epoch: 44, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.391 Vali Acc: 0.889 Test Loss: 0.391 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 45 cost time: 1.5327355861663818
Epoch: 45, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.403 Vali Acc: 0.889 Test Loss: 0.403 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.6914360523223877
Epoch: 46, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.508 Vali Acc: 0.867 Test Loss: 0.508 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.6224777698516846
Epoch: 47, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.427 Vali Acc: 0.889 Test Loss: 0.427 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.5846500396728516
Epoch: 48, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.436 Vali Acc: 0.894 Test Loss: 0.436 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894440).  Saving model ...
Epoch: 49 cost time: 1.528677225112915
Epoch: 49, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.450 Vali Acc: 0.872 Test Loss: 0.450 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.626513957977295
Epoch: 50, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.409 Vali Acc: 0.889 Test Loss: 0.409 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.791635274887085
Epoch: 51, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.445 Vali Acc: 0.883 Test Loss: 0.445 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.530923843383789
Epoch: 52, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.412 Vali Acc: 0.889 Test Loss: 0.412 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.6673734188079834
Epoch: 53, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.430 Vali Acc: 0.878 Test Loss: 0.430 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.3346209526062012
Epoch: 54, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.469 Vali Acc: 0.894 Test Loss: 0.469 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.7794437408447266
Epoch: 55, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.406 Vali Acc: 0.900 Test Loss: 0.406 Test Acc: 0.900
Validation loss decreased (-0.894440 --> -0.899996).  Saving model ...
Epoch: 56 cost time: 1.4143316745758057
Epoch: 56, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.466 Vali Acc: 0.878 Test Loss: 0.466 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.4965510368347168
Epoch: 57, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.427 Vali Acc: 0.894 Test Loss: 0.427 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.4544403553009033
Epoch: 58, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.432 Vali Acc: 0.878 Test Loss: 0.432 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.5693063735961914
Epoch: 59, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.488 Vali Acc: 0.883 Test Loss: 0.488 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.526820421218872
Epoch: 60, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.463 Vali Acc: 0.894 Test Loss: 0.463 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.4857749938964844
Epoch: 61, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.421 Vali Acc: 0.894 Test Loss: 0.421 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.5220799446105957
Epoch: 62, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.428 Vali Acc: 0.894 Test Loss: 0.428 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 1.5022597312927246
Epoch: 63, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.434 Vali Acc: 0.889 Test Loss: 0.434 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 1.363070011138916
Epoch: 64, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.579 Vali Acc: 0.839 Test Loss: 0.579 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 1.5115249156951904
Epoch: 65, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.536 Vali Acc: 0.872 Test Loss: 0.536 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 427891
model size : 2.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.969141960144043
Epoch: 1, Steps: 12 | Train Loss: 2.891 Vali Loss: 2.816 Vali Acc: 0.078 Test Loss: 2.816 Test Acc: 0.078
Validation loss decreased (inf --> -0.077750).  Saving model ...
Epoch: 2 cost time: 1.2072248458862305
Epoch: 2, Steps: 12 | Train Loss: 2.815 Vali Loss: 2.736 Vali Acc: 0.083 Test Loss: 2.736 Test Acc: 0.083
Validation loss decreased (-0.077750 --> -0.083306).  Saving model ...
Epoch: 3 cost time: 1.2642171382904053
Epoch: 3, Steps: 12 | Train Loss: 2.737 Vali Loss: 2.662 Vali Acc: 0.150 Test Loss: 2.662 Test Acc: 0.150
Validation loss decreased (-0.083306 --> -0.149973).  Saving model ...
Epoch: 4 cost time: 1.5435352325439453
Epoch: 4, Steps: 12 | Train Loss: 2.654 Vali Loss: 2.586 Vali Acc: 0.250 Test Loss: 2.586 Test Acc: 0.250
Validation loss decreased (-0.149973 --> -0.249974).  Saving model ...
Epoch: 5 cost time: 1.4543077945709229
Epoch: 5, Steps: 12 | Train Loss: 2.567 Vali Loss: 2.493 Vali Acc: 0.350 Test Loss: 2.493 Test Acc: 0.350
Validation loss decreased (-0.249974 --> -0.349975).  Saving model ...
Epoch: 6 cost time: 1.1853587627410889
Epoch: 6, Steps: 12 | Train Loss: 2.440 Vali Loss: 2.380 Vali Acc: 0.394 Test Loss: 2.380 Test Acc: 0.394
Validation loss decreased (-0.349975 --> -0.394421).  Saving model ...
Epoch: 7 cost time: 1.2552883625030518
Epoch: 7, Steps: 12 | Train Loss: 2.319 Vali Loss: 2.250 Vali Acc: 0.456 Test Loss: 2.250 Test Acc: 0.456
Validation loss decreased (-0.394421 --> -0.455533).  Saving model ...
Epoch: 8 cost time: 1.2231371402740479
Epoch: 8, Steps: 12 | Train Loss: 2.123 Vali Loss: 2.098 Vali Acc: 0.567 Test Loss: 2.098 Test Acc: 0.567
Validation loss decreased (-0.455533 --> -0.566646).  Saving model ...
Epoch: 9 cost time: 1.206390619277954
Epoch: 9, Steps: 12 | Train Loss: 1.935 Vali Loss: 1.934 Vali Acc: 0.556 Test Loss: 1.934 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.318532943725586
Epoch: 10, Steps: 12 | Train Loss: 1.763 Vali Loss: 1.778 Vali Acc: 0.578 Test Loss: 1.778 Test Acc: 0.578
Validation loss decreased (-0.566646 --> -0.577760).  Saving model ...
Epoch: 11 cost time: 1.7445168495178223
Epoch: 11, Steps: 12 | Train Loss: 1.615 Vali Loss: 1.638 Vali Acc: 0.600 Test Loss: 1.638 Test Acc: 0.600
Validation loss decreased (-0.577760 --> -0.599984).  Saving model ...
Epoch: 12 cost time: 1.4032750129699707
Epoch: 12, Steps: 12 | Train Loss: 1.478 Vali Loss: 1.512 Vali Acc: 0.611 Test Loss: 1.512 Test Acc: 0.611
Validation loss decreased (-0.599984 --> -0.611096).  Saving model ...
Epoch: 13 cost time: 1.4249513149261475
Epoch: 13, Steps: 12 | Train Loss: 1.293 Vali Loss: 1.395 Vali Acc: 0.650 Test Loss: 1.395 Test Acc: 0.650
Validation loss decreased (-0.611096 --> -0.649986).  Saving model ...
Epoch: 14 cost time: 1.317561149597168
Epoch: 14, Steps: 12 | Train Loss: 1.218 Vali Loss: 1.297 Vali Acc: 0.617 Test Loss: 1.297 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.415649652481079
Epoch: 15, Steps: 12 | Train Loss: 1.077 Vali Loss: 1.186 Vali Acc: 0.683 Test Loss: 1.186 Test Acc: 0.683
Validation loss decreased (-0.649986 --> -0.683321).  Saving model ...
Epoch: 16 cost time: 1.248889446258545
Epoch: 16, Steps: 12 | Train Loss: 0.986 Vali Loss: 1.130 Vali Acc: 0.711 Test Loss: 1.130 Test Acc: 0.711
Validation loss decreased (-0.683321 --> -0.711100).  Saving model ...
Epoch: 17 cost time: 1.3283438682556152
Epoch: 17, Steps: 12 | Train Loss: 0.933 Vali Loss: 1.059 Vali Acc: 0.722 Test Loss: 1.059 Test Acc: 0.722
Validation loss decreased (-0.711100 --> -0.722212).  Saving model ...
Epoch: 18 cost time: 1.1754014492034912
Epoch: 18, Steps: 12 | Train Loss: 0.841 Vali Loss: 0.989 Vali Acc: 0.694 Test Loss: 0.989 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4059813022613525
Epoch: 19, Steps: 12 | Train Loss: 0.786 Vali Loss: 0.923 Vali Acc: 0.744 Test Loss: 0.923 Test Acc: 0.744
Validation loss decreased (-0.722212 --> -0.744435).  Saving model ...
Epoch: 20 cost time: 1.3176720142364502
Epoch: 20, Steps: 12 | Train Loss: 0.760 Vali Loss: 0.888 Vali Acc: 0.744 Test Loss: 0.888 Test Acc: 0.744
Validation loss decreased (-0.744435 --> -0.744436).  Saving model ...
Epoch: 21 cost time: 2.005790948867798
Epoch: 21, Steps: 12 | Train Loss: 0.638 Vali Loss: 0.814 Vali Acc: 0.778 Test Loss: 0.814 Test Acc: 0.778
Validation loss decreased (-0.744436 --> -0.777770).  Saving model ...
Epoch: 22 cost time: 1.3168585300445557
Epoch: 22, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.778 Vali Acc: 0.772 Test Loss: 0.778 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4632339477539062
Epoch: 23, Steps: 12 | Train Loss: 0.511 Vali Loss: 0.724 Vali Acc: 0.794 Test Loss: 0.724 Test Acc: 0.794
Validation loss decreased (-0.777770 --> -0.794437).  Saving model ...
Epoch: 24 cost time: 1.3777329921722412
Epoch: 24, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.717 Vali Acc: 0.811 Test Loss: 0.717 Test Acc: 0.811
Validation loss decreased (-0.794437 --> -0.811104).  Saving model ...
Epoch: 25 cost time: 1.4213042259216309
Epoch: 25, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.662 Vali Acc: 0.817 Test Loss: 0.662 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816660).  Saving model ...
Epoch: 26 cost time: 1.3766825199127197
Epoch: 26, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.649 Vali Acc: 0.822 Test Loss: 0.649 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 27 cost time: 1.3575379848480225
Epoch: 27, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.603 Vali Acc: 0.839 Test Loss: 0.603 Test Acc: 0.839
Validation loss decreased (-0.822216 --> -0.838883).  Saving model ...
Epoch: 28 cost time: 1.3631365299224854
Epoch: 28, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.590 Vali Acc: 0.844 Test Loss: 0.590 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 29 cost time: 1.1057064533233643
Epoch: 29, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.575 Vali Acc: 0.856 Test Loss: 0.575 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 30 cost time: 1.3754644393920898
Epoch: 30, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.547 Vali Acc: 0.856 Test Loss: 0.547 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 31 cost time: 1.7613580226898193
Epoch: 31, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.532 Vali Acc: 0.861 Test Loss: 0.532 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 32 cost time: 1.456709861755371
Epoch: 32, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.518 Vali Acc: 0.861 Test Loss: 0.518 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 33 cost time: 1.1745948791503906
Epoch: 33, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.515 Vali Acc: 0.856 Test Loss: 0.515 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1856334209442139
Epoch: 34, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.506 Vali Acc: 0.861 Test Loss: 0.506 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 35 cost time: 1.180361270904541
Epoch: 35, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.505 Vali Acc: 0.861 Test Loss: 0.505 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 36 cost time: 1.1661772727966309
Epoch: 36, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.518 Vali Acc: 0.850 Test Loss: 0.518 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2392048835754395
Epoch: 37, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.500 Vali Acc: 0.889 Test Loss: 0.500 Test Acc: 0.889
Validation loss decreased (-0.861106 --> -0.888884).  Saving model ...
Epoch: 38 cost time: 1.276918649673462
Epoch: 38, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.465 Vali Acc: 0.878 Test Loss: 0.465 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.2178215980529785
Epoch: 39, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.486 Vali Acc: 0.883 Test Loss: 0.486 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.2581703662872314
Epoch: 40, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.496 Vali Acc: 0.889 Test Loss: 0.496 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 41 cost time: 1.378803014755249
Epoch: 41, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.507 Vali Acc: 0.867 Test Loss: 0.507 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.4749925136566162
Epoch: 42, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.493 Vali Acc: 0.889 Test Loss: 0.493 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 43 cost time: 1.359955072402954
Epoch: 43, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.483 Vali Acc: 0.867 Test Loss: 0.483 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.3153033256530762
Epoch: 44, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.470 Vali Acc: 0.894 Test Loss: 0.470 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894440).  Saving model ...
Epoch: 45 cost time: 1.3086299896240234
Epoch: 45, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.436 Vali Acc: 0.894 Test Loss: 0.436 Test Acc: 0.894
Validation loss decreased (-0.894440 --> -0.894440).  Saving model ...
Epoch: 46 cost time: 1.3122689723968506
Epoch: 46, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.465 Vali Acc: 0.900 Test Loss: 0.465 Test Acc: 0.900
Validation loss decreased (-0.894440 --> -0.899995).  Saving model ...
Epoch: 47 cost time: 1.271101474761963
Epoch: 47, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.456 Vali Acc: 0.900 Test Loss: 0.456 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 48 cost time: 1.1700973510742188
Epoch: 48, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.451 Vali Acc: 0.900 Test Loss: 0.451 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 49 cost time: 1.3846745491027832
Epoch: 49, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.468 Vali Acc: 0.900 Test Loss: 0.468 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.124769926071167
Epoch: 50, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.537 Vali Acc: 0.900 Test Loss: 0.537 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.3332934379577637
Epoch: 51, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.516 Vali Acc: 0.900 Test Loss: 0.516 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.3367714881896973
Epoch: 52, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.493 Vali Acc: 0.900 Test Loss: 0.493 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.3694438934326172
Epoch: 53, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.495 Vali Acc: 0.900 Test Loss: 0.495 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.3934993743896484
Epoch: 54, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.502 Vali Acc: 0.894 Test Loss: 0.502 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.3321611881256104
Epoch: 55, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.480 Vali Acc: 0.900 Test Loss: 0.480 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.4437384605407715
Epoch: 56, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.476 Vali Acc: 0.900 Test Loss: 0.476 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.2688252925872803
Epoch: 57, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.472 Vali Acc: 0.900 Test Loss: 0.472 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 1.6385552883148193
Epoch: 58, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.486 Vali Acc: 0.894 Test Loss: 0.486 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 427507
model size : 2.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.110543966293335
Epoch: 1, Steps: 12 | Train Loss: 2.838 Vali Loss: 2.778 Vali Acc: 0.028 Test Loss: 2.778 Test Acc: 0.028
Validation loss decreased (inf --> -0.027750).  Saving model ...
Epoch: 2 cost time: 1.2528836727142334
Epoch: 2, Steps: 12 | Train Loss: 2.772 Vali Loss: 2.707 Vali Acc: 0.067 Test Loss: 2.707 Test Acc: 0.067
Validation loss decreased (-0.027750 --> -0.066640).  Saving model ...
Epoch: 3 cost time: 1.1700384616851807
Epoch: 3, Steps: 12 | Train Loss: 2.668 Vali Loss: 2.646 Vali Acc: 0.078 Test Loss: 2.646 Test Acc: 0.078
Validation loss decreased (-0.066640 --> -0.077751).  Saving model ...
Epoch: 4 cost time: 1.5969488620758057
Epoch: 4, Steps: 12 | Train Loss: 2.643 Vali Loss: 2.568 Vali Acc: 0.183 Test Loss: 2.568 Test Acc: 0.183
Validation loss decreased (-0.077751 --> -0.183308).  Saving model ...
Epoch: 5 cost time: 1.1231582164764404
Epoch: 5, Steps: 12 | Train Loss: 2.492 Vali Loss: 2.471 Vali Acc: 0.222 Test Loss: 2.471 Test Acc: 0.222
Validation loss decreased (-0.183308 --> -0.222198).  Saving model ...
Epoch: 6 cost time: 1.1303222179412842
Epoch: 6, Steps: 12 | Train Loss: 2.382 Vali Loss: 2.350 Vali Acc: 0.344 Test Loss: 2.350 Test Acc: 0.344
Validation loss decreased (-0.222198 --> -0.344421).  Saving model ...
Epoch: 7 cost time: 1.2977607250213623
Epoch: 7, Steps: 12 | Train Loss: 2.223 Vali Loss: 2.211 Vali Acc: 0.378 Test Loss: 2.211 Test Acc: 0.378
Validation loss decreased (-0.344421 --> -0.377756).  Saving model ...
Epoch: 8 cost time: 1.3576006889343262
Epoch: 8, Steps: 12 | Train Loss: 2.111 Vali Loss: 2.081 Vali Acc: 0.444 Test Loss: 2.081 Test Acc: 0.444
Validation loss decreased (-0.377756 --> -0.444424).  Saving model ...
Epoch: 9 cost time: 1.422123670578003
Epoch: 9, Steps: 12 | Train Loss: 2.025 Vali Loss: 1.952 Vali Acc: 0.494 Test Loss: 1.952 Test Acc: 0.494
Validation loss decreased (-0.444424 --> -0.494425).  Saving model ...
Epoch: 10 cost time: 1.2146000862121582
Epoch: 10, Steps: 12 | Train Loss: 1.845 Vali Loss: 1.836 Vali Acc: 0.539 Test Loss: 1.836 Test Acc: 0.539
Validation loss decreased (-0.494425 --> -0.538871).  Saving model ...
Epoch: 11 cost time: 1.2146201133728027
Epoch: 11, Steps: 12 | Train Loss: 1.719 Vali Loss: 1.714 Vali Acc: 0.561 Test Loss: 1.714 Test Acc: 0.561
Validation loss decreased (-0.538871 --> -0.561094).  Saving model ...
Epoch: 12 cost time: 1.2119526863098145
Epoch: 12, Steps: 12 | Train Loss: 1.581 Vali Loss: 1.623 Vali Acc: 0.600 Test Loss: 1.623 Test Acc: 0.600
Validation loss decreased (-0.561094 --> -0.599984).  Saving model ...
Epoch: 13 cost time: 1.0834834575653076
Epoch: 13, Steps: 12 | Train Loss: 1.503 Vali Loss: 1.523 Vali Acc: 0.622 Test Loss: 1.523 Test Acc: 0.622
Validation loss decreased (-0.599984 --> -0.622207).  Saving model ...
Epoch: 14 cost time: 1.214148998260498
Epoch: 14, Steps: 12 | Train Loss: 1.425 Vali Loss: 1.440 Vali Acc: 0.639 Test Loss: 1.440 Test Acc: 0.639
Validation loss decreased (-0.622207 --> -0.638874).  Saving model ...
Epoch: 15 cost time: 1.2181155681610107
Epoch: 15, Steps: 12 | Train Loss: 1.313 Vali Loss: 1.340 Vali Acc: 0.661 Test Loss: 1.340 Test Acc: 0.661
Validation loss decreased (-0.638874 --> -0.661098).  Saving model ...
Epoch: 16 cost time: 1.2173748016357422
Epoch: 16, Steps: 12 | Train Loss: 1.209 Vali Loss: 1.272 Vali Acc: 0.700 Test Loss: 1.272 Test Acc: 0.700
Validation loss decreased (-0.661098 --> -0.699987).  Saving model ...
Epoch: 17 cost time: 1.302751064300537
Epoch: 17, Steps: 12 | Train Loss: 1.125 Vali Loss: 1.199 Vali Acc: 0.689 Test Loss: 1.199 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3952124118804932
Epoch: 18, Steps: 12 | Train Loss: 1.037 Vali Loss: 1.138 Vali Acc: 0.733 Test Loss: 1.138 Test Acc: 0.733
Validation loss decreased (-0.699987 --> -0.733322).  Saving model ...
Epoch: 19 cost time: 1.268416404724121
Epoch: 19, Steps: 12 | Train Loss: 0.992 Vali Loss: 1.103 Vali Acc: 0.706 Test Loss: 1.103 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2536630630493164
Epoch: 20, Steps: 12 | Train Loss: 0.885 Vali Loss: 1.021 Vali Acc: 0.756 Test Loss: 1.021 Test Acc: 0.756
Validation loss decreased (-0.733322 --> -0.755545).  Saving model ...
Epoch: 21 cost time: 1.1871888637542725
Epoch: 21, Steps: 12 | Train Loss: 0.870 Vali Loss: 0.938 Vali Acc: 0.772 Test Loss: 0.938 Test Acc: 0.772
Validation loss decreased (-0.755545 --> -0.772213).  Saving model ...
Epoch: 22 cost time: 1.1842339038848877
Epoch: 22, Steps: 12 | Train Loss: 0.762 Vali Loss: 0.881 Vali Acc: 0.778 Test Loss: 0.881 Test Acc: 0.778
Validation loss decreased (-0.772213 --> -0.777769).  Saving model ...
Epoch: 23 cost time: 1.2001311779022217
Epoch: 23, Steps: 12 | Train Loss: 0.687 Vali Loss: 0.837 Vali Acc: 0.794 Test Loss: 0.837 Test Acc: 0.794
Validation loss decreased (-0.777769 --> -0.794436).  Saving model ...
Epoch: 24 cost time: 1.2051208019256592
Epoch: 24, Steps: 12 | Train Loss: 0.681 Vali Loss: 0.797 Vali Acc: 0.789 Test Loss: 0.797 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5319838523864746
Epoch: 25, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.760 Vali Acc: 0.789 Test Loss: 0.760 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3382606506347656
Epoch: 26, Steps: 12 | Train Loss: 0.571 Vali Loss: 0.719 Vali Acc: 0.806 Test Loss: 0.719 Test Acc: 0.806
Validation loss decreased (-0.794436 --> -0.805548).  Saving model ...
Epoch: 27 cost time: 1.2262253761291504
Epoch: 27, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.683 Vali Acc: 0.811 Test Loss: 0.683 Test Acc: 0.811
Validation loss decreased (-0.805548 --> -0.811104).  Saving model ...
Epoch: 28 cost time: 1.5217664241790771
Epoch: 28, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.636 Vali Acc: 0.811 Test Loss: 0.636 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811105).  Saving model ...
Epoch: 29 cost time: 1.221071481704712
Epoch: 29, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.625 Vali Acc: 0.817 Test Loss: 0.625 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816660).  Saving model ...
Epoch: 30 cost time: 1.3331665992736816
Epoch: 30, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.614 Vali Acc: 0.822 Test Loss: 0.614 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 31 cost time: 1.4003479480743408
Epoch: 31, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.597 Vali Acc: 0.817 Test Loss: 0.597 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1510262489318848
Epoch: 32, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.562 Vali Acc: 0.811 Test Loss: 0.562 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.3106689453125
Epoch: 33, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.528 Vali Acc: 0.839 Test Loss: 0.528 Test Acc: 0.839
Validation loss decreased (-0.822216 --> -0.838884).  Saving model ...
Epoch: 34 cost time: 1.2067008018493652
Epoch: 34, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.528 Vali Acc: 0.856 Test Loss: 0.528 Test Acc: 0.856
Validation loss decreased (-0.838884 --> -0.855550).  Saving model ...
Epoch: 35 cost time: 1.4372336864471436
Epoch: 35, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.512 Vali Acc: 0.828 Test Loss: 0.512 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.3841180801391602
Epoch: 36, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.509 Vali Acc: 0.850 Test Loss: 0.509 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.4271595478057861
Epoch: 37, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.483 Vali Acc: 0.856 Test Loss: 0.483 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855551).  Saving model ...
Epoch: 38 cost time: 1.3354907035827637
Epoch: 38, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.447 Vali Acc: 0.878 Test Loss: 0.447 Test Acc: 0.878
Validation loss decreased (-0.855551 --> -0.877773).  Saving model ...
Epoch: 39 cost time: 1.2822904586791992
Epoch: 39, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.455 Vali Acc: 0.856 Test Loss: 0.455 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1691973209381104
Epoch: 40, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.447 Vali Acc: 0.867 Test Loss: 0.447 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.077181100845337
Epoch: 41, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.421 Vali Acc: 0.878 Test Loss: 0.421 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877774).  Saving model ...
Epoch: 42 cost time: 1.1706106662750244
Epoch: 42, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.431 Vali Acc: 0.872 Test Loss: 0.431 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.226522445678711
Epoch: 43, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.434 Vali Acc: 0.883 Test Loss: 0.434 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883329).  Saving model ...
Epoch: 44 cost time: 1.216118574142456
Epoch: 44, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.436 Vali Acc: 0.861 Test Loss: 0.436 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.3594532012939453
Epoch: 45, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.441 Vali Acc: 0.872 Test Loss: 0.441 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.292130470275879
Epoch: 46, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.395 Vali Acc: 0.883 Test Loss: 0.395 Test Acc: 0.883
Validation loss decreased (-0.883329 --> -0.883329).  Saving model ...
Epoch: 47 cost time: 1.4744205474853516
Epoch: 47, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.464 Vali Acc: 0.889 Test Loss: 0.464 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888884).  Saving model ...
Epoch: 48 cost time: 1.3029632568359375
Epoch: 48, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.421 Vali Acc: 0.861 Test Loss: 0.421 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.5897042751312256
Epoch: 49, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.373 Vali Acc: 0.883 Test Loss: 0.373 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.1878063678741455
Epoch: 50, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.404 Vali Acc: 0.883 Test Loss: 0.404 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.4278171062469482
Epoch: 51, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.395 Vali Acc: 0.889 Test Loss: 0.395 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 52 cost time: 1.243133544921875
Epoch: 52, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.380 Vali Acc: 0.894 Test Loss: 0.380 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894441).  Saving model ...
Epoch: 53 cost time: 1.366654872894287
Epoch: 53, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.410 Vali Acc: 0.894 Test Loss: 0.410 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.4282073974609375
Epoch: 54, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.428 Vali Acc: 0.867 Test Loss: 0.428 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.665071725845337
Epoch: 55, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.429 Vali Acc: 0.889 Test Loss: 0.429 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.3985693454742432
Epoch: 56, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.379 Vali Acc: 0.883 Test Loss: 0.379 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.554473876953125
Epoch: 57, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.442 Vali Acc: 0.883 Test Loss: 0.442 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.524623155593872
Epoch: 58, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.394 Vali Acc: 0.883 Test Loss: 0.394 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.4737908840179443
Epoch: 59, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.384 Vali Acc: 0.889 Test Loss: 0.384 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 1.3389832973480225
Epoch: 60, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.385 Vali Acc: 0.900 Test Loss: 0.385 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899996).  Saving model ...
Epoch: 61 cost time: 1.2793679237365723
Epoch: 61, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.391 Vali Acc: 0.889 Test Loss: 0.391 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.3604745864868164
Epoch: 62, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.428 Vali Acc: 0.894 Test Loss: 0.428 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.2090249061584473
Epoch: 63, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.396 Vali Acc: 0.889 Test Loss: 0.396 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.1920316219329834
Epoch: 64, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.435 Vali Acc: 0.894 Test Loss: 0.435 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 1.4777231216430664
Epoch: 65, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.409 Vali Acc: 0.894 Test Loss: 0.409 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 1.4459173679351807
Epoch: 66, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.386 Vali Acc: 0.900 Test Loss: 0.386 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 1.1630065441131592
Epoch: 67, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.378 Vali Acc: 0.911 Test Loss: 0.378 Test Acc: 0.911
Validation loss decreased (-0.899996 --> -0.911107).  Saving model ...
Epoch: 68 cost time: 1.3101403713226318
Epoch: 68, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.428 Vali Acc: 0.889 Test Loss: 0.428 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.3761036396026611
Epoch: 69, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.408 Vali Acc: 0.883 Test Loss: 0.408 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.2217535972595215
Epoch: 70, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.382 Vali Acc: 0.894 Test Loss: 0.382 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.2187831401824951
Epoch: 71, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.401 Vali Acc: 0.900 Test Loss: 0.401 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 1.283130168914795
Epoch: 72, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.424 Vali Acc: 0.889 Test Loss: 0.424 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 1.1922955513000488
Epoch: 73, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.393 Vali Acc: 0.911 Test Loss: 0.393 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 1.2805149555206299
Epoch: 74, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.379 Vali Acc: 0.900 Test Loss: 0.379 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 1.223125696182251
Epoch: 75, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.438 Vali Acc: 0.883 Test Loss: 0.438 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 1.4843509197235107
Epoch: 76, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.394 Vali Acc: 0.906 Test Loss: 0.394 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 1.1758103370666504
Epoch: 77, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.432 Vali Acc: 0.894 Test Loss: 0.432 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 423955
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1473031044006348
Epoch: 1, Steps: 12 | Train Loss: 2.815 Vali Loss: 2.723 Vali Acc: 0.111 Test Loss: 2.723 Test Acc: 0.111
Validation loss decreased (inf --> -0.111084).  Saving model ...
Epoch: 2 cost time: 1.2629799842834473
Epoch: 2, Steps: 12 | Train Loss: 2.692 Vali Loss: 2.637 Vali Acc: 0.183 Test Loss: 2.637 Test Acc: 0.183
Validation loss decreased (-0.111084 --> -0.183307).  Saving model ...
Epoch: 3 cost time: 1.2630980014801025
Epoch: 3, Steps: 12 | Train Loss: 2.640 Vali Loss: 2.574 Vali Acc: 0.211 Test Loss: 2.574 Test Acc: 0.211
Validation loss decreased (-0.183307 --> -0.211085).  Saving model ...
Epoch: 4 cost time: 1.3073022365570068
Epoch: 4, Steps: 12 | Train Loss: 2.519 Vali Loss: 2.497 Vali Acc: 0.156 Test Loss: 2.497 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2992534637451172
Epoch: 5, Steps: 12 | Train Loss: 2.453 Vali Loss: 2.415 Vali Acc: 0.278 Test Loss: 2.415 Test Acc: 0.278
Validation loss decreased (-0.211085 --> -0.277754).  Saving model ...
Epoch: 6 cost time: 1.704232931137085
Epoch: 6, Steps: 12 | Train Loss: 2.355 Vali Loss: 2.314 Vali Acc: 0.317 Test Loss: 2.314 Test Acc: 0.317
Validation loss decreased (-0.277754 --> -0.316644).  Saving model ...
Epoch: 7 cost time: 1.4003486633300781
Epoch: 7, Steps: 12 | Train Loss: 2.238 Vali Loss: 2.205 Vali Acc: 0.422 Test Loss: 2.205 Test Acc: 0.422
Validation loss decreased (-0.316644 --> -0.422200).  Saving model ...
Epoch: 8 cost time: 1.3168797492980957
Epoch: 8, Steps: 12 | Train Loss: 2.041 Vali Loss: 2.094 Vali Acc: 0.433 Test Loss: 2.094 Test Acc: 0.433
Validation loss decreased (-0.422200 --> -0.433312).  Saving model ...
Epoch: 9 cost time: 1.3985662460327148
Epoch: 9, Steps: 12 | Train Loss: 1.900 Vali Loss: 2.001 Vali Acc: 0.456 Test Loss: 2.001 Test Acc: 0.456
Validation loss decreased (-0.433312 --> -0.455536).  Saving model ...
Epoch: 10 cost time: 1.5347232818603516
Epoch: 10, Steps: 12 | Train Loss: 1.809 Vali Loss: 1.895 Vali Acc: 0.494 Test Loss: 1.895 Test Acc: 0.494
Validation loss decreased (-0.455536 --> -0.494425).  Saving model ...
Epoch: 11 cost time: 1.4051003456115723
Epoch: 11, Steps: 12 | Train Loss: 1.694 Vali Loss: 1.791 Vali Acc: 0.533 Test Loss: 1.791 Test Acc: 0.533
Validation loss decreased (-0.494425 --> -0.533315).  Saving model ...
Epoch: 12 cost time: 1.6014997959136963
Epoch: 12, Steps: 12 | Train Loss: 1.602 Vali Loss: 1.696 Vali Acc: 0.544 Test Loss: 1.696 Test Acc: 0.544
Validation loss decreased (-0.533315 --> -0.544427).  Saving model ...
Epoch: 13 cost time: 1.4028613567352295
Epoch: 13, Steps: 12 | Train Loss: 1.463 Vali Loss: 1.603 Vali Acc: 0.617 Test Loss: 1.603 Test Acc: 0.617
Validation loss decreased (-0.544427 --> -0.616651).  Saving model ...
Epoch: 14 cost time: 1.2687110900878906
Epoch: 14, Steps: 12 | Train Loss: 1.410 Vali Loss: 1.514 Vali Acc: 0.617 Test Loss: 1.514 Test Acc: 0.617
Validation loss decreased (-0.616651 --> -0.616652).  Saving model ...
Epoch: 15 cost time: 1.3854248523712158
Epoch: 15, Steps: 12 | Train Loss: 1.307 Vali Loss: 1.410 Vali Acc: 0.628 Test Loss: 1.410 Test Acc: 0.628
Validation loss decreased (-0.616652 --> -0.627764).  Saving model ...
Epoch: 16 cost time: 1.2745323181152344
Epoch: 16, Steps: 12 | Train Loss: 1.211 Vali Loss: 1.334 Vali Acc: 0.633 Test Loss: 1.334 Test Acc: 0.633
Validation loss decreased (-0.627764 --> -0.633320).  Saving model ...
Epoch: 17 cost time: 1.1121745109558105
Epoch: 17, Steps: 12 | Train Loss: 1.164 Vali Loss: 1.246 Vali Acc: 0.733 Test Loss: 1.246 Test Acc: 0.733
Validation loss decreased (-0.633320 --> -0.733321).  Saving model ...
Epoch: 18 cost time: 1.1521751880645752
Epoch: 18, Steps: 12 | Train Loss: 1.034 Vali Loss: 1.179 Vali Acc: 0.711 Test Loss: 1.179 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3828582763671875
Epoch: 19, Steps: 12 | Train Loss: 1.002 Vali Loss: 1.124 Vali Acc: 0.728 Test Loss: 1.124 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.180626392364502
Epoch: 20, Steps: 12 | Train Loss: 0.949 Vali Loss: 1.040 Vali Acc: 0.739 Test Loss: 1.040 Test Acc: 0.739
Validation loss decreased (-0.733321 --> -0.738878).  Saving model ...
Epoch: 21 cost time: 1.2659320831298828
Epoch: 21, Steps: 12 | Train Loss: 0.809 Vali Loss: 0.961 Vali Acc: 0.750 Test Loss: 0.961 Test Acc: 0.750
Validation loss decreased (-0.738878 --> -0.749990).  Saving model ...
Epoch: 22 cost time: 1.1512844562530518
Epoch: 22, Steps: 12 | Train Loss: 0.772 Vali Loss: 0.941 Vali Acc: 0.767 Test Loss: 0.941 Test Acc: 0.767
Validation loss decreased (-0.749990 --> -0.766657).  Saving model ...
Epoch: 23 cost time: 1.2761077880859375
Epoch: 23, Steps: 12 | Train Loss: 0.746 Vali Loss: 0.879 Vali Acc: 0.789 Test Loss: 0.879 Test Acc: 0.789
Validation loss decreased (-0.766657 --> -0.788880).  Saving model ...
Epoch: 24 cost time: 1.1812093257904053
Epoch: 24, Steps: 12 | Train Loss: 0.685 Vali Loss: 0.823 Vali Acc: 0.789 Test Loss: 0.823 Test Acc: 0.789
Validation loss decreased (-0.788880 --> -0.788881).  Saving model ...
Epoch: 25 cost time: 1.1914331912994385
Epoch: 25, Steps: 12 | Train Loss: 0.617 Vali Loss: 0.790 Vali Acc: 0.811 Test Loss: 0.790 Test Acc: 0.811
Validation loss decreased (-0.788881 --> -0.811103).  Saving model ...
Epoch: 26 cost time: 1.2655761241912842
Epoch: 26, Steps: 12 | Train Loss: 0.575 Vali Loss: 0.737 Vali Acc: 0.806 Test Loss: 0.737 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2789311408996582
Epoch: 27, Steps: 12 | Train Loss: 0.531 Vali Loss: 0.724 Vali Acc: 0.806 Test Loss: 0.724 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1896178722381592
Epoch: 28, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.683 Vali Acc: 0.828 Test Loss: 0.683 Test Acc: 0.828
Validation loss decreased (-0.811103 --> -0.827771).  Saving model ...
Epoch: 29 cost time: 1.3687162399291992
Epoch: 29, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.655 Vali Acc: 0.839 Test Loss: 0.655 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838882).  Saving model ...
Epoch: 30 cost time: 1.2804982662200928
Epoch: 30, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.639 Vali Acc: 0.806 Test Loss: 0.639 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3199748992919922
Epoch: 31, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.646 Vali Acc: 0.822 Test Loss: 0.646 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3624441623687744
Epoch: 32, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.630 Vali Acc: 0.822 Test Loss: 0.630 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.3545899391174316
Epoch: 33, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.574 Vali Acc: 0.844 Test Loss: 0.574 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844439).  Saving model ...
Epoch: 34 cost time: 1.2394275665283203
Epoch: 34, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.559 Vali Acc: 0.861 Test Loss: 0.559 Test Acc: 0.861
Validation loss decreased (-0.844439 --> -0.861106).  Saving model ...
Epoch: 35 cost time: 1.243513584136963
Epoch: 35, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.550 Vali Acc: 0.878 Test Loss: 0.550 Test Acc: 0.878
Validation loss decreased (-0.861106 --> -0.877772).  Saving model ...
Epoch: 36 cost time: 1.2335331439971924
Epoch: 36, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.526 Vali Acc: 0.861 Test Loss: 0.526 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2717642784118652
Epoch: 37, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.504 Vali Acc: 0.850 Test Loss: 0.504 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.3424880504608154
Epoch: 38, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.546 Vali Acc: 0.878 Test Loss: 0.546 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 39 cost time: 1.2904374599456787
Epoch: 39, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.524 Vali Acc: 0.856 Test Loss: 0.524 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.4594619274139404
Epoch: 40, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.497 Vali Acc: 0.861 Test Loss: 0.497 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.3164029121398926
Epoch: 41, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.504 Vali Acc: 0.872 Test Loss: 0.504 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.2889940738677979
Epoch: 42, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.497 Vali Acc: 0.856 Test Loss: 0.497 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.5045573711395264
Epoch: 43, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.497 Vali Acc: 0.889 Test Loss: 0.497 Test Acc: 0.889
Validation loss decreased (-0.877772 --> -0.888884).  Saving model ...
Epoch: 44 cost time: 1.3767940998077393
Epoch: 44, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.486 Vali Acc: 0.861 Test Loss: 0.486 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.3909225463867188
Epoch: 45, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.480 Vali Acc: 0.878 Test Loss: 0.480 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.7315940856933594
Epoch: 46, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.497 Vali Acc: 0.883 Test Loss: 0.497 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.280756950378418
Epoch: 47, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.485 Vali Acc: 0.894 Test Loss: 0.485 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894440).  Saving model ...
Epoch: 48 cost time: 1.2558629512786865
Epoch: 48, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.472 Vali Acc: 0.883 Test Loss: 0.472 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.2370481491088867
Epoch: 49, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.477 Vali Acc: 0.900 Test Loss: 0.477 Test Acc: 0.900
Validation loss decreased (-0.894440 --> -0.899995).  Saving model ...
Epoch: 50 cost time: 1.130420446395874
Epoch: 50, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.469 Vali Acc: 0.878 Test Loss: 0.469 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.4140198230743408
Epoch: 51, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.462 Vali Acc: 0.889 Test Loss: 0.462 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.254535436630249
Epoch: 52, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.443 Vali Acc: 0.878 Test Loss: 0.443 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.3949589729309082
Epoch: 53, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.480 Vali Acc: 0.878 Test Loss: 0.480 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.4726691246032715
Epoch: 54, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.458 Vali Acc: 0.883 Test Loss: 0.458 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.3508968353271484
Epoch: 55, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.468 Vali Acc: 0.883 Test Loss: 0.468 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.3268711566925049
Epoch: 56, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.451 Vali Acc: 0.878 Test Loss: 0.451 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.36769437789917
Epoch: 57, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.509 Vali Acc: 0.894 Test Loss: 0.509 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.2927367687225342
Epoch: 58, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.462 Vali Acc: 0.894 Test Loss: 0.462 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.321340560913086
Epoch: 59, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.463 Vali Acc: 0.889 Test Loss: 0.463 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 423763
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4489123821258545
Epoch: 1, Steps: 12 | Train Loss: 2.785 Vali Loss: 2.772 Vali Acc: 0.078 Test Loss: 2.772 Test Acc: 0.078
Validation loss decreased (inf --> -0.077750).  Saving model ...
Epoch: 2 cost time: 1.5802581310272217
Epoch: 2, Steps: 12 | Train Loss: 2.715 Vali Loss: 2.670 Vali Acc: 0.078 Test Loss: 2.670 Test Acc: 0.078
Validation loss decreased (-0.077750 --> -0.077751).  Saving model ...
Epoch: 3 cost time: 1.5164437294006348
Epoch: 3, Steps: 12 | Train Loss: 2.597 Vali Loss: 2.611 Vali Acc: 0.133 Test Loss: 2.611 Test Acc: 0.133
Validation loss decreased (-0.077751 --> -0.133307).  Saving model ...
Epoch: 4 cost time: 1.7284293174743652
Epoch: 4, Steps: 12 | Train Loss: 2.534 Vali Loss: 2.530 Vali Acc: 0.261 Test Loss: 2.530 Test Acc: 0.261
Validation loss decreased (-0.133307 --> -0.261086).  Saving model ...
Epoch: 5 cost time: 1.361358642578125
Epoch: 5, Steps: 12 | Train Loss: 2.506 Vali Loss: 2.428 Vali Acc: 0.289 Test Loss: 2.428 Test Acc: 0.289
Validation loss decreased (-0.261086 --> -0.288865).  Saving model ...
Epoch: 6 cost time: 1.4676694869995117
Epoch: 6, Steps: 12 | Train Loss: 2.335 Vali Loss: 2.314 Vali Acc: 0.333 Test Loss: 2.314 Test Acc: 0.333
Validation loss decreased (-0.288865 --> -0.333310).  Saving model ...
Epoch: 7 cost time: 1.4723284244537354
Epoch: 7, Steps: 12 | Train Loss: 2.210 Vali Loss: 2.176 Vali Acc: 0.428 Test Loss: 2.176 Test Acc: 0.428
Validation loss decreased (-0.333310 --> -0.427756).  Saving model ...
Epoch: 8 cost time: 1.619230031967163
Epoch: 8, Steps: 12 | Train Loss: 2.064 Vali Loss: 2.049 Vali Acc: 0.539 Test Loss: 2.049 Test Acc: 0.539
Validation loss decreased (-0.427756 --> -0.538868).  Saving model ...
Epoch: 9 cost time: 1.387831687927246
Epoch: 9, Steps: 12 | Train Loss: 1.934 Vali Loss: 1.944 Vali Acc: 0.533 Test Loss: 1.944 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.452155590057373
Epoch: 10, Steps: 12 | Train Loss: 1.794 Vali Loss: 1.819 Vali Acc: 0.572 Test Loss: 1.819 Test Acc: 0.572
Validation loss decreased (-0.538868 --> -0.572204).  Saving model ...
Epoch: 11 cost time: 1.7179689407348633
Epoch: 11, Steps: 12 | Train Loss: 1.633 Vali Loss: 1.724 Vali Acc: 0.550 Test Loss: 1.724 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2614843845367432
Epoch: 12, Steps: 12 | Train Loss: 1.542 Vali Loss: 1.618 Vali Acc: 0.589 Test Loss: 1.618 Test Acc: 0.589
Validation loss decreased (-0.572204 --> -0.588873).  Saving model ...
Epoch: 13 cost time: 1.5230553150177002
Epoch: 13, Steps: 12 | Train Loss: 1.451 Vali Loss: 1.526 Vali Acc: 0.617 Test Loss: 1.526 Test Acc: 0.617
Validation loss decreased (-0.588873 --> -0.616651).  Saving model ...
Epoch: 14 cost time: 1.4867639541625977
Epoch: 14, Steps: 12 | Train Loss: 1.347 Vali Loss: 1.436 Vali Acc: 0.622 Test Loss: 1.436 Test Acc: 0.622
Validation loss decreased (-0.616651 --> -0.622208).  Saving model ...
Epoch: 15 cost time: 1.4454631805419922
Epoch: 15, Steps: 12 | Train Loss: 1.241 Vali Loss: 1.332 Vali Acc: 0.633 Test Loss: 1.332 Test Acc: 0.633
Validation loss decreased (-0.622208 --> -0.633320).  Saving model ...
Epoch: 16 cost time: 1.533350944519043
Epoch: 16, Steps: 12 | Train Loss: 1.193 Vali Loss: 1.280 Vali Acc: 0.650 Test Loss: 1.280 Test Acc: 0.650
Validation loss decreased (-0.633320 --> -0.649987).  Saving model ...
Epoch: 17 cost time: 1.5881192684173584
Epoch: 17, Steps: 12 | Train Loss: 1.150 Vali Loss: 1.198 Vali Acc: 0.706 Test Loss: 1.198 Test Acc: 0.706
Validation loss decreased (-0.649987 --> -0.705544).  Saving model ...
Epoch: 18 cost time: 1.5124633312225342
Epoch: 18, Steps: 12 | Train Loss: 1.011 Vali Loss: 1.113 Vali Acc: 0.706 Test Loss: 1.113 Test Acc: 0.706
Validation loss decreased (-0.705544 --> -0.705544).  Saving model ...
Epoch: 19 cost time: 1.566394567489624
Epoch: 19, Steps: 12 | Train Loss: 0.964 Vali Loss: 1.048 Vali Acc: 0.778 Test Loss: 1.048 Test Acc: 0.778
Validation loss decreased (-0.705544 --> -0.777767).  Saving model ...
Epoch: 20 cost time: 1.5319023132324219
Epoch: 20, Steps: 12 | Train Loss: 0.852 Vali Loss: 0.999 Vali Acc: 0.761 Test Loss: 0.999 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8361053466796875
Epoch: 21, Steps: 12 | Train Loss: 0.842 Vali Loss: 0.933 Vali Acc: 0.772 Test Loss: 0.933 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5036962032318115
Epoch: 22, Steps: 12 | Train Loss: 0.757 Vali Loss: 0.874 Vali Acc: 0.783 Test Loss: 0.874 Test Acc: 0.783
Validation loss decreased (-0.777767 --> -0.783325).  Saving model ...
Epoch: 23 cost time: 1.4835844039916992
Epoch: 23, Steps: 12 | Train Loss: 0.728 Vali Loss: 0.851 Vali Acc: 0.794 Test Loss: 0.851 Test Acc: 0.794
Validation loss decreased (-0.783325 --> -0.794436).  Saving model ...
Epoch: 24 cost time: 1.7017922401428223
Epoch: 24, Steps: 12 | Train Loss: 0.684 Vali Loss: 0.802 Vali Acc: 0.811 Test Loss: 0.802 Test Acc: 0.811
Validation loss decreased (-0.794436 --> -0.811103).  Saving model ...
Epoch: 25 cost time: 1.615562915802002
Epoch: 25, Steps: 12 | Train Loss: 0.650 Vali Loss: 0.780 Vali Acc: 0.811 Test Loss: 0.780 Test Acc: 0.811
Validation loss decreased (-0.811103 --> -0.811103).  Saving model ...
Epoch: 26 cost time: 1.4328317642211914
Epoch: 26, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.764 Vali Acc: 0.811 Test Loss: 0.764 Test Acc: 0.811
Validation loss decreased (-0.811103 --> -0.811103).  Saving model ...
Epoch: 27 cost time: 1.3425452709197998
Epoch: 27, Steps: 12 | Train Loss: 0.531 Vali Loss: 0.715 Vali Acc: 0.811 Test Loss: 0.715 Test Acc: 0.811
Validation loss decreased (-0.811103 --> -0.811104).  Saving model ...
Epoch: 28 cost time: 1.2497494220733643
Epoch: 28, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.684 Vali Acc: 0.839 Test Loss: 0.684 Test Acc: 0.839
Validation loss decreased (-0.811104 --> -0.838882).  Saving model ...
Epoch: 29 cost time: 1.463188886642456
Epoch: 29, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.662 Vali Acc: 0.822 Test Loss: 0.662 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.723914623260498
Epoch: 30, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.631 Vali Acc: 0.822 Test Loss: 0.631 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.5890405178070068
Epoch: 31, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.600 Vali Acc: 0.839 Test Loss: 0.600 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838883).  Saving model ...
Epoch: 32 cost time: 1.5108473300933838
Epoch: 32, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.615 Vali Acc: 0.850 Test Loss: 0.615 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 33 cost time: 1.695413589477539
Epoch: 33, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.620 Vali Acc: 0.828 Test Loss: 0.620 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.4640419483184814
Epoch: 34, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.549 Vali Acc: 0.850 Test Loss: 0.549 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 35 cost time: 1.4547147750854492
Epoch: 35, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.555 Vali Acc: 0.856 Test Loss: 0.555 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855550).  Saving model ...
Epoch: 36 cost time: 1.3985016345977783
Epoch: 36, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.558 Vali Acc: 0.844 Test Loss: 0.558 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.5867533683776855
Epoch: 37, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.533 Vali Acc: 0.850 Test Loss: 0.533 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.4917609691619873
Epoch: 38, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.534 Vali Acc: 0.872 Test Loss: 0.534 Test Acc: 0.872
Validation loss decreased (-0.855550 --> -0.872217).  Saving model ...
Epoch: 39 cost time: 1.4473981857299805
Epoch: 39, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.502 Vali Acc: 0.856 Test Loss: 0.502 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.6651968955993652
Epoch: 40, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.491 Vali Acc: 0.856 Test Loss: 0.491 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.3266351222991943
Epoch: 41, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.514 Vali Acc: 0.856 Test Loss: 0.514 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.4928946495056152
Epoch: 42, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.493 Vali Acc: 0.867 Test Loss: 0.493 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.5514609813690186
Epoch: 43, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.491 Vali Acc: 0.861 Test Loss: 0.491 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.603881597518921
Epoch: 44, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.481 Vali Acc: 0.850 Test Loss: 0.481 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.4792823791503906
Epoch: 45, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.465 Vali Acc: 0.878 Test Loss: 0.465 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 46 cost time: 1.4248530864715576
Epoch: 46, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.441 Vali Acc: 0.872 Test Loss: 0.441 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.45375657081604
Epoch: 47, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.446 Vali Acc: 0.883 Test Loss: 0.446 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883329).  Saving model ...
Epoch: 48 cost time: 1.2963037490844727
Epoch: 48, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.425 Vali Acc: 0.872 Test Loss: 0.425 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.2496600151062012
Epoch: 49, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.456 Vali Acc: 0.872 Test Loss: 0.456 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.923771619796753
Epoch: 50, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.449 Vali Acc: 0.872 Test Loss: 0.449 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.4220468997955322
Epoch: 51, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.463 Vali Acc: 0.883 Test Loss: 0.463 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.528754711151123
Epoch: 52, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.462 Vali Acc: 0.867 Test Loss: 0.462 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.4084782600402832
Epoch: 53, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.457 Vali Acc: 0.872 Test Loss: 0.457 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.3007769584655762
Epoch: 54, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.470 Vali Acc: 0.867 Test Loss: 0.470 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.4923570156097412
Epoch: 55, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.502 Vali Acc: 0.872 Test Loss: 0.502 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.4786405563354492
Epoch: 56, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.451 Vali Acc: 0.867 Test Loss: 0.451 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 1.511789321899414
Epoch: 57, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.522 Vali Acc: 0.867 Test Loss: 0.522 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 423571
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.258223056793213
Epoch: 1, Steps: 12 | Train Loss: 2.817 Vali Loss: 2.765 Vali Acc: 0.022 Test Loss: 2.765 Test Acc: 0.022
Validation loss decreased (inf --> -0.022195).  Saving model ...
Epoch: 2 cost time: 1.4610466957092285
Epoch: 2, Steps: 12 | Train Loss: 2.715 Vali Loss: 2.675 Vali Acc: 0.056 Test Loss: 2.675 Test Acc: 0.056
Validation loss decreased (-0.022195 --> -0.055529).  Saving model ...
Epoch: 3 cost time: 1.2293822765350342
Epoch: 3, Steps: 12 | Train Loss: 2.664 Vali Loss: 2.590 Vali Acc: 0.178 Test Loss: 2.590 Test Acc: 0.178
Validation loss decreased (-0.055529 --> -0.177752).  Saving model ...
Epoch: 4 cost time: 1.4022231101989746
Epoch: 4, Steps: 12 | Train Loss: 2.534 Vali Loss: 2.508 Vali Acc: 0.283 Test Loss: 2.508 Test Acc: 0.283
Validation loss decreased (-0.177752 --> -0.283308).  Saving model ...
Epoch: 5 cost time: 1.2683160305023193
Epoch: 5, Steps: 12 | Train Loss: 2.455 Vali Loss: 2.399 Vali Acc: 0.361 Test Loss: 2.399 Test Acc: 0.361
Validation loss decreased (-0.283308 --> -0.361087).  Saving model ...
Epoch: 6 cost time: 1.2435243129730225
Epoch: 6, Steps: 12 | Train Loss: 2.336 Vali Loss: 2.271 Vali Acc: 0.422 Test Loss: 2.271 Test Acc: 0.422
Validation loss decreased (-0.361087 --> -0.422200).  Saving model ...
Epoch: 7 cost time: 1.1827747821807861
Epoch: 7, Steps: 12 | Train Loss: 2.183 Vali Loss: 2.151 Vali Acc: 0.406 Test Loss: 2.151 Test Acc: 0.406
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2956280708312988
Epoch: 8, Steps: 12 | Train Loss: 2.017 Vali Loss: 2.032 Vali Acc: 0.450 Test Loss: 2.032 Test Acc: 0.450
Validation loss decreased (-0.422200 --> -0.449980).  Saving model ...
Epoch: 9 cost time: 1.247093677520752
Epoch: 9, Steps: 12 | Train Loss: 1.904 Vali Loss: 1.900 Vali Acc: 0.494 Test Loss: 1.900 Test Acc: 0.494
Validation loss decreased (-0.449980 --> -0.494425).  Saving model ...
Epoch: 10 cost time: 1.3077235221862793
Epoch: 10, Steps: 12 | Train Loss: 1.719 Vali Loss: 1.786 Vali Acc: 0.533 Test Loss: 1.786 Test Acc: 0.533
Validation loss decreased (-0.494425 --> -0.533315).  Saving model ...
Epoch: 11 cost time: 1.1969056129455566
Epoch: 11, Steps: 12 | Train Loss: 1.682 Vali Loss: 1.677 Vali Acc: 0.539 Test Loss: 1.677 Test Acc: 0.539
Validation loss decreased (-0.533315 --> -0.538872).  Saving model ...
Epoch: 12 cost time: 1.2361726760864258
Epoch: 12, Steps: 12 | Train Loss: 1.534 Vali Loss: 1.576 Vali Acc: 0.578 Test Loss: 1.576 Test Acc: 0.578
Validation loss decreased (-0.538872 --> -0.577762).  Saving model ...
Epoch: 13 cost time: 1.2336158752441406
Epoch: 13, Steps: 12 | Train Loss: 1.370 Vali Loss: 1.470 Vali Acc: 0.594 Test Loss: 1.470 Test Acc: 0.594
Validation loss decreased (-0.577762 --> -0.594430).  Saving model ...
Epoch: 14 cost time: 1.2500152587890625
Epoch: 14, Steps: 12 | Train Loss: 1.289 Vali Loss: 1.374 Vali Acc: 0.611 Test Loss: 1.374 Test Acc: 0.611
Validation loss decreased (-0.594430 --> -0.611097).  Saving model ...
Epoch: 15 cost time: 1.1689186096191406
Epoch: 15, Steps: 12 | Train Loss: 1.198 Vali Loss: 1.293 Vali Acc: 0.617 Test Loss: 1.293 Test Acc: 0.617
Validation loss decreased (-0.611097 --> -0.616654).  Saving model ...
Epoch: 16 cost time: 1.4745573997497559
Epoch: 16, Steps: 12 | Train Loss: 1.153 Vali Loss: 1.259 Vali Acc: 0.633 Test Loss: 1.259 Test Acc: 0.633
Validation loss decreased (-0.616654 --> -0.633321).  Saving model ...
Epoch: 17 cost time: 1.3217849731445312
Epoch: 17, Steps: 12 | Train Loss: 1.068 Vali Loss: 1.142 Vali Acc: 0.667 Test Loss: 1.142 Test Acc: 0.667
Validation loss decreased (-0.633321 --> -0.666655).  Saving model ...
Epoch: 18 cost time: 1.3164129257202148
Epoch: 18, Steps: 12 | Train Loss: 0.957 Vali Loss: 1.089 Vali Acc: 0.700 Test Loss: 1.089 Test Acc: 0.700
Validation loss decreased (-0.666655 --> -0.699989).  Saving model ...
Epoch: 19 cost time: 1.2358083724975586
Epoch: 19, Steps: 12 | Train Loss: 0.948 Vali Loss: 1.035 Vali Acc: 0.750 Test Loss: 1.035 Test Acc: 0.750
Validation loss decreased (-0.699989 --> -0.749990).  Saving model ...
Epoch: 20 cost time: 1.2051355838775635
Epoch: 20, Steps: 12 | Train Loss: 0.823 Vali Loss: 0.965 Vali Acc: 0.744 Test Loss: 0.965 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2118406295776367
Epoch: 21, Steps: 12 | Train Loss: 0.793 Vali Loss: 0.935 Vali Acc: 0.744 Test Loss: 0.935 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2461838722229004
Epoch: 22, Steps: 12 | Train Loss: 0.716 Vali Loss: 0.858 Vali Acc: 0.772 Test Loss: 0.858 Test Acc: 0.772
Validation loss decreased (-0.749990 --> -0.772214).  Saving model ...
Epoch: 23 cost time: 1.1497468948364258
Epoch: 23, Steps: 12 | Train Loss: 0.716 Vali Loss: 0.836 Vali Acc: 0.761 Test Loss: 0.836 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.314204454421997
Epoch: 24, Steps: 12 | Train Loss: 0.661 Vali Loss: 0.777 Vali Acc: 0.783 Test Loss: 0.777 Test Acc: 0.783
Validation loss decreased (-0.772214 --> -0.783326).  Saving model ...
Epoch: 25 cost time: 1.3522465229034424
Epoch: 25, Steps: 12 | Train Loss: 0.626 Vali Loss: 0.741 Vali Acc: 0.811 Test Loss: 0.741 Test Acc: 0.811
Validation loss decreased (-0.783326 --> -0.811104).  Saving model ...
Epoch: 26 cost time: 1.2108511924743652
Epoch: 26, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.705 Vali Acc: 0.811 Test Loss: 0.705 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 27 cost time: 1.3482117652893066
Epoch: 27, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.683 Vali Acc: 0.817 Test Loss: 0.683 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816660).  Saving model ...
Epoch: 28 cost time: 1.2546887397766113
Epoch: 28, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.632 Vali Acc: 0.822 Test Loss: 0.632 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 29 cost time: 1.0959579944610596
Epoch: 29, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.642 Vali Acc: 0.806 Test Loss: 0.642 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4889533519744873
Epoch: 30, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.598 Vali Acc: 0.817 Test Loss: 0.598 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1980571746826172
Epoch: 31, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.566 Vali Acc: 0.828 Test Loss: 0.566 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827772).  Saving model ...
Epoch: 32 cost time: 1.2084429264068604
Epoch: 32, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.550 Vali Acc: 0.844 Test Loss: 0.550 Test Acc: 0.844
Validation loss decreased (-0.827772 --> -0.844439).  Saving model ...
Epoch: 33 cost time: 1.3045876026153564
Epoch: 33, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.536 Vali Acc: 0.844 Test Loss: 0.536 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 34 cost time: 1.1085424423217773
Epoch: 34, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.524 Vali Acc: 0.839 Test Loss: 0.524 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.3258075714111328
Epoch: 35, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.502 Vali Acc: 0.867 Test Loss: 0.502 Test Acc: 0.867
Validation loss decreased (-0.844439 --> -0.866662).  Saving model ...
Epoch: 36 cost time: 1.2214019298553467
Epoch: 36, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1972568035125732
Epoch: 37, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.507 Vali Acc: 0.867 Test Loss: 0.507 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.528303861618042
Epoch: 38, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.519 Vali Acc: 0.844 Test Loss: 0.519 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.2533068656921387
Epoch: 39, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.450 Vali Acc: 0.872 Test Loss: 0.450 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872218).  Saving model ...
Epoch: 40 cost time: 1.2039968967437744
Epoch: 40, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.496 Vali Acc: 0.872 Test Loss: 0.496 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.273024082183838
Epoch: 41, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.448 Vali Acc: 0.883 Test Loss: 0.448 Test Acc: 0.883
Validation loss decreased (-0.872218 --> -0.883329).  Saving model ...
Epoch: 42 cost time: 1.3986022472381592
Epoch: 42, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.454 Vali Acc: 0.878 Test Loss: 0.454 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1775262355804443
Epoch: 43, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.459 Vali Acc: 0.889 Test Loss: 0.459 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888884).  Saving model ...
Epoch: 44 cost time: 1.2735626697540283
Epoch: 44, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.432 Vali Acc: 0.883 Test Loss: 0.432 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.2582149505615234
Epoch: 45, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.457 Vali Acc: 0.911 Test Loss: 0.457 Test Acc: 0.911
Validation loss decreased (-0.888884 --> -0.911107).  Saving model ...
Epoch: 46 cost time: 1.6518497467041016
Epoch: 46, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.444 Vali Acc: 0.861 Test Loss: 0.444 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.51143479347229
Epoch: 47, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.443 Vali Acc: 0.894 Test Loss: 0.443 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.2266831398010254
Epoch: 48, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.440 Vali Acc: 0.889 Test Loss: 0.440 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.3347489833831787
Epoch: 49, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.465 Vali Acc: 0.861 Test Loss: 0.465 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.2639520168304443
Epoch: 50, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.457 Vali Acc: 0.889 Test Loss: 0.457 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.2151944637298584
Epoch: 51, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.441 Vali Acc: 0.894 Test Loss: 0.441 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.4907546043395996
Epoch: 52, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.426 Vali Acc: 0.894 Test Loss: 0.426 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.3088533878326416
Epoch: 53, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.422 Vali Acc: 0.906 Test Loss: 0.422 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.2584424018859863
Epoch: 54, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.422 Vali Acc: 0.906 Test Loss: 0.422 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.3833386898040771
Epoch: 55, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.426 Vali Acc: 0.911 Test Loss: 0.426 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 56 cost time: 1.3907151222229004
Epoch: 56, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.452 Vali Acc: 0.878 Test Loss: 0.452 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.2487916946411133
Epoch: 57, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.438 Vali Acc: 0.900 Test Loss: 0.438 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.4278011322021484
Epoch: 58, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.428 Vali Acc: 0.889 Test Loss: 0.428 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.106656551361084
Epoch: 59, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.406 Vali Acc: 0.906 Test Loss: 0.406 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.180858850479126
Epoch: 60, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.397 Vali Acc: 0.911 Test Loss: 0.397 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 61 cost time: 1.211148738861084
Epoch: 61, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.484 Vali Acc: 0.894 Test Loss: 0.484 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.5186676979064941
Epoch: 62, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.420 Vali Acc: 0.900 Test Loss: 0.420 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.5216681957244873
Epoch: 63, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.435 Vali Acc: 0.894 Test Loss: 0.435 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.1202592849731445
Epoch: 64, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.408 Vali Acc: 0.906 Test Loss: 0.408 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 1.1897854804992676
Epoch: 65, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.394 Vali Acc: 0.917 Test Loss: 0.394 Test Acc: 0.917
Validation loss decreased (-0.911107 --> -0.916663).  Saving model ...
Epoch: 66 cost time: 1.1364388465881348
Epoch: 66, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.466 Vali Acc: 0.883 Test Loss: 0.466 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.3450572490692139
Epoch: 67, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.425 Vali Acc: 0.878 Test Loss: 0.425 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.379439115524292
Epoch: 68, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.422 Vali Acc: 0.878 Test Loss: 0.422 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.2440977096557617
Epoch: 69, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.453 Vali Acc: 0.867 Test Loss: 0.453 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.4458138942718506
Epoch: 70, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.442 Vali Acc: 0.906 Test Loss: 0.442 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.269773006439209
Epoch: 71, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.479 Vali Acc: 0.889 Test Loss: 0.479 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 1.3773868083953857
Epoch: 72, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.434 Vali Acc: 0.906 Test Loss: 0.434 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 1.2454724311828613
Epoch: 73, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.459 Vali Acc: 0.906 Test Loss: 0.459 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 1.3512849807739258
Epoch: 74, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.484 Vali Acc: 0.889 Test Loss: 0.484 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 1.467411756515503
Epoch: 75, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.507 Vali Acc: 0.878 Test Loss: 0.507 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 423379
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2002265453338623
Epoch: 1, Steps: 12 | Train Loss: 2.998 Vali Loss: 2.857 Vali Acc: 0.056 Test Loss: 2.857 Test Acc: 0.056
Validation loss decreased (inf --> -0.055527).  Saving model ...
Epoch: 2 cost time: 1.3394365310668945
Epoch: 2, Steps: 12 | Train Loss: 2.840 Vali Loss: 2.756 Vali Acc: 0.056 Test Loss: 2.756 Test Acc: 0.056
Validation loss decreased (-0.055527 --> -0.055528).  Saving model ...
Epoch: 3 cost time: 1.5795154571533203
Epoch: 3, Steps: 12 | Train Loss: 2.760 Vali Loss: 2.672 Vali Acc: 0.089 Test Loss: 2.672 Test Acc: 0.089
Validation loss decreased (-0.055528 --> -0.088862).  Saving model ...
Epoch: 4 cost time: 1.215914011001587
Epoch: 4, Steps: 12 | Train Loss: 2.670 Vali Loss: 2.608 Vali Acc: 0.161 Test Loss: 2.608 Test Acc: 0.161
Validation loss decreased (-0.088862 --> -0.161085).  Saving model ...
Epoch: 5 cost time: 1.2169733047485352
Epoch: 5, Steps: 12 | Train Loss: 2.578 Vali Loss: 2.552 Vali Acc: 0.183 Test Loss: 2.552 Test Acc: 0.183
Validation loss decreased (-0.161085 --> -0.183308).  Saving model ...
Epoch: 6 cost time: 1.4280338287353516
Epoch: 6, Steps: 12 | Train Loss: 2.565 Vali Loss: 2.483 Vali Acc: 0.256 Test Loss: 2.483 Test Acc: 0.256
Validation loss decreased (-0.183308 --> -0.255531).  Saving model ...
Epoch: 7 cost time: 1.5007069110870361
Epoch: 7, Steps: 12 | Train Loss: 2.476 Vali Loss: 2.411 Vali Acc: 0.350 Test Loss: 2.411 Test Acc: 0.350
Validation loss decreased (-0.255531 --> -0.349976).  Saving model ...
Epoch: 8 cost time: 1.5856132507324219
Epoch: 8, Steps: 12 | Train Loss: 2.369 Vali Loss: 2.322 Vali Acc: 0.333 Test Loss: 2.322 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5853610038757324
Epoch: 9, Steps: 12 | Train Loss: 2.210 Vali Loss: 2.226 Vali Acc: 0.383 Test Loss: 2.226 Test Acc: 0.383
Validation loss decreased (-0.349976 --> -0.383311).  Saving model ...
Epoch: 10 cost time: 1.677598237991333
Epoch: 10, Steps: 12 | Train Loss: 2.141 Vali Loss: 2.134 Vali Acc: 0.444 Test Loss: 2.134 Test Acc: 0.444
Validation loss decreased (-0.383311 --> -0.444423).  Saving model ...
Epoch: 11 cost time: 1.3767740726470947
Epoch: 11, Steps: 12 | Train Loss: 2.027 Vali Loss: 2.032 Vali Acc: 0.517 Test Loss: 2.032 Test Acc: 0.517
Validation loss decreased (-0.444423 --> -0.516646).  Saving model ...
Epoch: 12 cost time: 1.3410046100616455
Epoch: 12, Steps: 12 | Train Loss: 1.890 Vali Loss: 1.924 Vali Acc: 0.511 Test Loss: 1.924 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4932148456573486
Epoch: 13, Steps: 12 | Train Loss: 1.772 Vali Loss: 1.820 Vali Acc: 0.578 Test Loss: 1.820 Test Acc: 0.578
Validation loss decreased (-0.516646 --> -0.577760).  Saving model ...
Epoch: 14 cost time: 1.3271071910858154
Epoch: 14, Steps: 12 | Train Loss: 1.654 Vali Loss: 1.740 Vali Acc: 0.594 Test Loss: 1.740 Test Acc: 0.594
Validation loss decreased (-0.577760 --> -0.594427).  Saving model ...
Epoch: 15 cost time: 1.4568519592285156
Epoch: 15, Steps: 12 | Train Loss: 1.551 Vali Loss: 1.643 Vali Acc: 0.600 Test Loss: 1.643 Test Acc: 0.600
Validation loss decreased (-0.594427 --> -0.599984).  Saving model ...
Epoch: 16 cost time: 1.3038392066955566
Epoch: 16, Steps: 12 | Train Loss: 1.472 Vali Loss: 1.552 Vali Acc: 0.644 Test Loss: 1.552 Test Acc: 0.644
Validation loss decreased (-0.599984 --> -0.644429).  Saving model ...
Epoch: 17 cost time: 1.4705443382263184
Epoch: 17, Steps: 12 | Train Loss: 1.429 Vali Loss: 1.474 Vali Acc: 0.656 Test Loss: 1.474 Test Acc: 0.656
Validation loss decreased (-0.644429 --> -0.655541).  Saving model ...
Epoch: 18 cost time: 1.293503761291504
Epoch: 18, Steps: 12 | Train Loss: 1.284 Vali Loss: 1.415 Vali Acc: 0.672 Test Loss: 1.415 Test Acc: 0.672
Validation loss decreased (-0.655541 --> -0.672208).  Saving model ...
Epoch: 19 cost time: 1.2425498962402344
Epoch: 19, Steps: 12 | Train Loss: 1.231 Vali Loss: 1.350 Vali Acc: 0.667 Test Loss: 1.350 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2919821739196777
Epoch: 20, Steps: 12 | Train Loss: 1.203 Vali Loss: 1.291 Vali Acc: 0.683 Test Loss: 1.291 Test Acc: 0.683
Validation loss decreased (-0.672208 --> -0.683320).  Saving model ...
Epoch: 21 cost time: 1.5011436939239502
Epoch: 21, Steps: 12 | Train Loss: 1.095 Vali Loss: 1.239 Vali Acc: 0.683 Test Loss: 1.239 Test Acc: 0.683
Validation loss decreased (-0.683320 --> -0.683321).  Saving model ...
Epoch: 22 cost time: 1.4081580638885498
Epoch: 22, Steps: 12 | Train Loss: 0.996 Vali Loss: 1.166 Vali Acc: 0.717 Test Loss: 1.166 Test Acc: 0.717
Validation loss decreased (-0.683321 --> -0.716655).  Saving model ...
Epoch: 23 cost time: 1.2415707111358643
Epoch: 23, Steps: 12 | Train Loss: 0.970 Vali Loss: 1.105 Vali Acc: 0.728 Test Loss: 1.105 Test Acc: 0.728
Validation loss decreased (-0.716655 --> -0.727767).  Saving model ...
Epoch: 24 cost time: 1.3147187232971191
Epoch: 24, Steps: 12 | Train Loss: 0.883 Vali Loss: 1.064 Vali Acc: 0.733 Test Loss: 1.064 Test Acc: 0.733
Validation loss decreased (-0.727767 --> -0.733323).  Saving model ...
Epoch: 25 cost time: 1.3927125930786133
Epoch: 25, Steps: 12 | Train Loss: 0.851 Vali Loss: 1.014 Vali Acc: 0.750 Test Loss: 1.014 Test Acc: 0.750
Validation loss decreased (-0.733323 --> -0.749990).  Saving model ...
Epoch: 26 cost time: 1.784797191619873
Epoch: 26, Steps: 12 | Train Loss: 0.801 Vali Loss: 0.958 Vali Acc: 0.761 Test Loss: 0.958 Test Acc: 0.761
Validation loss decreased (-0.749990 --> -0.761102).  Saving model ...
Epoch: 27 cost time: 1.3462233543395996
Epoch: 27, Steps: 12 | Train Loss: 0.745 Vali Loss: 0.907 Vali Acc: 0.761 Test Loss: 0.907 Test Acc: 0.761
Validation loss decreased (-0.761102 --> -0.761102).  Saving model ...
Epoch: 28 cost time: 1.821803331375122
Epoch: 28, Steps: 12 | Train Loss: 0.686 Vali Loss: 0.887 Vali Acc: 0.761 Test Loss: 0.887 Test Acc: 0.761
Validation loss decreased (-0.761102 --> -0.761102).  Saving model ...
Epoch: 29 cost time: 1.685593605041504
Epoch: 29, Steps: 12 | Train Loss: 0.614 Vali Loss: 0.855 Vali Acc: 0.767 Test Loss: 0.855 Test Acc: 0.767
Validation loss decreased (-0.761102 --> -0.766658).  Saving model ...
Epoch: 30 cost time: 1.3092458248138428
Epoch: 30, Steps: 12 | Train Loss: 0.592 Vali Loss: 0.829 Vali Acc: 0.767 Test Loss: 0.829 Test Acc: 0.767
Validation loss decreased (-0.766658 --> -0.766658).  Saving model ...
Epoch: 31 cost time: 1.5450739860534668
Epoch: 31, Steps: 12 | Train Loss: 0.590 Vali Loss: 0.799 Vali Acc: 0.783 Test Loss: 0.799 Test Acc: 0.783
Validation loss decreased (-0.766658 --> -0.783325).  Saving model ...
Epoch: 32 cost time: 1.4666194915771484
Epoch: 32, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.769 Vali Acc: 0.794 Test Loss: 0.769 Test Acc: 0.794
Validation loss decreased (-0.783325 --> -0.794437).  Saving model ...
Epoch: 33 cost time: 1.8107366561889648
Epoch: 33, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.727 Vali Acc: 0.806 Test Loss: 0.727 Test Acc: 0.806
Validation loss decreased (-0.794437 --> -0.805548).  Saving model ...
Epoch: 34 cost time: 1.892432451248169
Epoch: 34, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.703 Vali Acc: 0.806 Test Loss: 0.703 Test Acc: 0.806
Validation loss decreased (-0.805548 --> -0.805549).  Saving model ...
Epoch: 35 cost time: 1.7374074459075928
Epoch: 35, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.669 Vali Acc: 0.817 Test Loss: 0.669 Test Acc: 0.817
Validation loss decreased (-0.805549 --> -0.816660).  Saving model ...
Epoch: 36 cost time: 1.520524024963379
Epoch: 36, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.643 Vali Acc: 0.811 Test Loss: 0.643 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.8342421054840088
Epoch: 37, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.634 Vali Acc: 0.839 Test Loss: 0.634 Test Acc: 0.839
Validation loss decreased (-0.816660 --> -0.838883).  Saving model ...
Epoch: 38 cost time: 1.4813041687011719
Epoch: 38, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.598 Vali Acc: 0.828 Test Loss: 0.598 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.6685130596160889
Epoch: 39, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.570 Vali Acc: 0.850 Test Loss: 0.570 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 40 cost time: 1.6759297847747803
Epoch: 40, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.566 Vali Acc: 0.833 Test Loss: 0.566 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.7340953350067139
Epoch: 41, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.562 Vali Acc: 0.839 Test Loss: 0.562 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.6700503826141357
Epoch: 42, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.547 Vali Acc: 0.844 Test Loss: 0.547 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.7069923877716064
Epoch: 43, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.521 Vali Acc: 0.850 Test Loss: 0.521 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 44 cost time: 1.5354218482971191
Epoch: 44, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.503 Vali Acc: 0.856 Test Loss: 0.503 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855551).  Saving model ...
Epoch: 45 cost time: 1.477128028869629
Epoch: 45, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.520 Vali Acc: 0.833 Test Loss: 0.520 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.8223075866699219
Epoch: 46, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.490 Vali Acc: 0.867 Test Loss: 0.490 Test Acc: 0.867
Validation loss decreased (-0.855551 --> -0.866662).  Saving model ...
Epoch: 47 cost time: 1.3550915718078613
Epoch: 47, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.487 Vali Acc: 0.856 Test Loss: 0.487 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.2036213874816895
Epoch: 48, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.485 Vali Acc: 0.878 Test Loss: 0.485 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877773).  Saving model ...
Epoch: 49 cost time: 1.0997755527496338
Epoch: 49, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.485 Vali Acc: 0.872 Test Loss: 0.485 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.5788495540618896
Epoch: 50, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.463 Vali Acc: 0.867 Test Loss: 0.463 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.3461673259735107
Epoch: 51, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.460 Vali Acc: 0.872 Test Loss: 0.460 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.5945451259613037
Epoch: 52, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.459 Vali Acc: 0.878 Test Loss: 0.459 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 53 cost time: 1.4851343631744385
Epoch: 53, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.435 Vali Acc: 0.867 Test Loss: 0.435 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.775890827178955
Epoch: 54, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.453 Vali Acc: 0.867 Test Loss: 0.453 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.697962999343872
Epoch: 55, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.440 Vali Acc: 0.878 Test Loss: 0.440 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 56 cost time: 1.3287181854248047
Epoch: 56, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.440 Vali Acc: 0.872 Test Loss: 0.440 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.4285805225372314
Epoch: 57, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.439 Vali Acc: 0.872 Test Loss: 0.439 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.6749792098999023
Epoch: 58, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.432 Vali Acc: 0.872 Test Loss: 0.432 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.7995131015777588
Epoch: 59, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.425 Vali Acc: 0.878 Test Loss: 0.425 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877774).  Saving model ...
Epoch: 60 cost time: 1.690293788909912
Epoch: 60, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.452 Vali Acc: 0.878 Test Loss: 0.452 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.7856793403625488
Epoch: 61, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.461 Vali Acc: 0.856 Test Loss: 0.461 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.4338111877441406
Epoch: 62, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.435 Vali Acc: 0.878 Test Loss: 0.435 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.4560537338256836
Epoch: 63, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.437 Vali Acc: 0.889 Test Loss: 0.437 Test Acc: 0.889
Validation loss decreased (-0.877774 --> -0.888885).  Saving model ...
Epoch: 64 cost time: 1.7002089023590088
Epoch: 64, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.443 Vali Acc: 0.867 Test Loss: 0.443 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.5622634887695312
Epoch: 65, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.444 Vali Acc: 0.878 Test Loss: 0.444 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.611140251159668
Epoch: 66, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.459 Vali Acc: 0.883 Test Loss: 0.459 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 1.4507713317871094
Epoch: 67, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.466 Vali Acc: 0.878 Test Loss: 0.466 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 1.407681941986084
Epoch: 68, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.457 Vali Acc: 0.883 Test Loss: 0.457 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 1.4516942501068115
Epoch: 69, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.452 Vali Acc: 0.883 Test Loss: 0.452 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 1.3974542617797852
Epoch: 70, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.465 Vali Acc: 0.889 Test Loss: 0.465 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 1.4147207736968994
Epoch: 71, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.428 Vali Acc: 0.878 Test Loss: 0.428 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 1.671116828918457
Epoch: 72, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.447 Vali Acc: 0.872 Test Loss: 0.447 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 1.7989203929901123
Epoch: 73, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.469 Vali Acc: 0.867 Test Loss: 0.469 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 257555
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.79754900932312
Epoch: 1, Steps: 12 | Train Loss: 2.944 Vali Loss: 2.830 Vali Acc: 0.067 Test Loss: 2.830 Test Acc: 0.067
Validation loss decreased (inf --> -0.066638).  Saving model ...
Epoch: 2 cost time: 1.450364351272583
Epoch: 2, Steps: 12 | Train Loss: 2.838 Vali Loss: 2.715 Vali Acc: 0.061 Test Loss: 2.715 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5048856735229492
Epoch: 3, Steps: 12 | Train Loss: 2.733 Vali Loss: 2.640 Vali Acc: 0.144 Test Loss: 2.640 Test Acc: 0.144
Validation loss decreased (-0.066638 --> -0.144418).  Saving model ...
Epoch: 4 cost time: 1.529590129852295
Epoch: 4, Steps: 12 | Train Loss: 2.641 Vali Loss: 2.578 Vali Acc: 0.189 Test Loss: 2.578 Test Acc: 0.189
Validation loss decreased (-0.144418 --> -0.188863).  Saving model ...
Epoch: 5 cost time: 1.350916862487793
Epoch: 5, Steps: 12 | Train Loss: 2.593 Vali Loss: 2.499 Vali Acc: 0.183 Test Loss: 2.499 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.696953535079956
Epoch: 6, Steps: 12 | Train Loss: 2.466 Vali Loss: 2.412 Vali Acc: 0.217 Test Loss: 2.412 Test Acc: 0.217
Validation loss decreased (-0.188863 --> -0.216643).  Saving model ...
Epoch: 7 cost time: 1.1835675239562988
Epoch: 7, Steps: 12 | Train Loss: 2.393 Vali Loss: 2.313 Vali Acc: 0.289 Test Loss: 2.313 Test Acc: 0.289
Validation loss decreased (-0.216643 --> -0.288866).  Saving model ...
Epoch: 8 cost time: 1.153031826019287
Epoch: 8, Steps: 12 | Train Loss: 2.274 Vali Loss: 2.206 Vali Acc: 0.389 Test Loss: 2.206 Test Acc: 0.389
Validation loss decreased (-0.288866 --> -0.388867).  Saving model ...
Epoch: 9 cost time: 1.6244585514068604
Epoch: 9, Steps: 12 | Train Loss: 2.149 Vali Loss: 2.110 Vali Acc: 0.417 Test Loss: 2.110 Test Acc: 0.417
Validation loss decreased (-0.388867 --> -0.416646).  Saving model ...
Epoch: 10 cost time: 1.254608154296875
Epoch: 10, Steps: 12 | Train Loss: 2.036 Vali Loss: 2.007 Vali Acc: 0.483 Test Loss: 2.007 Test Acc: 0.483
Validation loss decreased (-0.416646 --> -0.483313).  Saving model ...
Epoch: 11 cost time: 1.2669730186462402
Epoch: 11, Steps: 12 | Train Loss: 1.896 Vali Loss: 1.902 Vali Acc: 0.517 Test Loss: 1.902 Test Acc: 0.517
Validation loss decreased (-0.483313 --> -0.516648).  Saving model ...
Epoch: 12 cost time: 1.3727455139160156
Epoch: 12, Steps: 12 | Train Loss: 1.809 Vali Loss: 1.790 Vali Acc: 0.567 Test Loss: 1.790 Test Acc: 0.567
Validation loss decreased (-0.516648 --> -0.566649).  Saving model ...
Epoch: 13 cost time: 1.4600145816802979
Epoch: 13, Steps: 12 | Train Loss: 1.692 Vali Loss: 1.693 Vali Acc: 0.583 Test Loss: 1.693 Test Acc: 0.583
Validation loss decreased (-0.566649 --> -0.583316).  Saving model ...
Epoch: 14 cost time: 1.322728157043457
Epoch: 14, Steps: 12 | Train Loss: 1.538 Vali Loss: 1.601 Vali Acc: 0.617 Test Loss: 1.601 Test Acc: 0.617
Validation loss decreased (-0.583316 --> -0.616651).  Saving model ...
Epoch: 15 cost time: 1.3000693321228027
Epoch: 15, Steps: 12 | Train Loss: 1.448 Vali Loss: 1.489 Vali Acc: 0.644 Test Loss: 1.489 Test Acc: 0.644
Validation loss decreased (-0.616651 --> -0.644430).  Saving model ...
Epoch: 16 cost time: 1.2740318775177002
Epoch: 16, Steps: 12 | Train Loss: 1.317 Vali Loss: 1.407 Vali Acc: 0.694 Test Loss: 1.407 Test Acc: 0.694
Validation loss decreased (-0.644430 --> -0.694430).  Saving model ...
Epoch: 17 cost time: 1.3136558532714844
Epoch: 17, Steps: 12 | Train Loss: 1.256 Vali Loss: 1.329 Vali Acc: 0.694 Test Loss: 1.329 Test Acc: 0.694
Validation loss decreased (-0.694430 --> -0.694431).  Saving model ...
Epoch: 18 cost time: 1.5090751647949219
Epoch: 18, Steps: 12 | Train Loss: 1.154 Vali Loss: 1.256 Vali Acc: 0.733 Test Loss: 1.256 Test Acc: 0.733
Validation loss decreased (-0.694431 --> -0.733321).  Saving model ...
Epoch: 19 cost time: 1.2209484577178955
Epoch: 19, Steps: 12 | Train Loss: 1.067 Vali Loss: 1.183 Vali Acc: 0.728 Test Loss: 1.183 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3511507511138916
Epoch: 20, Steps: 12 | Train Loss: 1.001 Vali Loss: 1.114 Vali Acc: 0.750 Test Loss: 1.114 Test Acc: 0.750
Validation loss decreased (-0.733321 --> -0.749989).  Saving model ...
Epoch: 21 cost time: 1.3128583431243896
Epoch: 21, Steps: 12 | Train Loss: 0.911 Vali Loss: 1.054 Vali Acc: 0.772 Test Loss: 1.054 Test Acc: 0.772
Validation loss decreased (-0.749989 --> -0.772212).  Saving model ...
Epoch: 22 cost time: 1.3732776641845703
Epoch: 22, Steps: 12 | Train Loss: 0.884 Vali Loss: 1.002 Vali Acc: 0.783 Test Loss: 1.002 Test Acc: 0.783
Validation loss decreased (-0.772212 --> -0.783323).  Saving model ...
Epoch: 23 cost time: 1.3385403156280518
Epoch: 23, Steps: 12 | Train Loss: 0.808 Vali Loss: 0.943 Vali Acc: 0.783 Test Loss: 0.943 Test Acc: 0.783
Validation loss decreased (-0.783323 --> -0.783324).  Saving model ...
Epoch: 24 cost time: 1.4282872676849365
Epoch: 24, Steps: 12 | Train Loss: 0.818 Vali Loss: 0.909 Vali Acc: 0.794 Test Loss: 0.909 Test Acc: 0.794
Validation loss decreased (-0.783324 --> -0.794435).  Saving model ...
Epoch: 25 cost time: 1.244415283203125
Epoch: 25, Steps: 12 | Train Loss: 0.714 Vali Loss: 0.851 Vali Acc: 0.794 Test Loss: 0.851 Test Acc: 0.794
Validation loss decreased (-0.794435 --> -0.794436).  Saving model ...
Epoch: 26 cost time: 1.5968575477600098
Epoch: 26, Steps: 12 | Train Loss: 0.688 Vali Loss: 0.817 Vali Acc: 0.806 Test Loss: 0.817 Test Acc: 0.806
Validation loss decreased (-0.794436 --> -0.805547).  Saving model ...
Epoch: 27 cost time: 1.491546392440796
Epoch: 27, Steps: 12 | Train Loss: 0.635 Vali Loss: 0.788 Vali Acc: 0.817 Test Loss: 0.788 Test Acc: 0.817
Validation loss decreased (-0.805547 --> -0.816659).  Saving model ...
Epoch: 28 cost time: 1.2504692077636719
Epoch: 28, Steps: 12 | Train Loss: 0.600 Vali Loss: 0.758 Vali Acc: 0.806 Test Loss: 0.758 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7658004760742188
Epoch: 29, Steps: 12 | Train Loss: 0.577 Vali Loss: 0.712 Vali Acc: 0.817 Test Loss: 0.712 Test Acc: 0.817
Validation loss decreased (-0.816659 --> -0.816660).  Saving model ...
Epoch: 30 cost time: 1.3568775653839111
Epoch: 30, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.680 Vali Acc: 0.822 Test Loss: 0.680 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822215).  Saving model ...
Epoch: 31 cost time: 1.2425358295440674
Epoch: 31, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.681 Vali Acc: 0.822 Test Loss: 0.681 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.295701026916504
Epoch: 32, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.625 Vali Acc: 0.839 Test Loss: 0.625 Test Acc: 0.839
Validation loss decreased (-0.822215 --> -0.838883).  Saving model ...
Epoch: 33 cost time: 1.3945317268371582
Epoch: 33, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.622 Vali Acc: 0.828 Test Loss: 0.622 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.4549877643585205
Epoch: 34, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.611 Vali Acc: 0.817 Test Loss: 0.611 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.5257885456085205
Epoch: 35, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.605 Vali Acc: 0.817 Test Loss: 0.605 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.2597172260284424
Epoch: 36, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.574 Vali Acc: 0.833 Test Loss: 0.574 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.267052412033081
Epoch: 37, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.574 Vali Acc: 0.833 Test Loss: 0.574 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.2329113483428955
Epoch: 38, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.547 Vali Acc: 0.844 Test Loss: 0.547 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 39 cost time: 1.3541839122772217
Epoch: 39, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.553 Vali Acc: 0.833 Test Loss: 0.553 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.4345698356628418
Epoch: 40, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.548 Vali Acc: 0.839 Test Loss: 0.548 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.6463329792022705
Epoch: 41, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.505 Vali Acc: 0.839 Test Loss: 0.505 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.517099380493164
Epoch: 42, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.529 Vali Acc: 0.833 Test Loss: 0.529 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.4920432567596436
Epoch: 43, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.503 Vali Acc: 0.839 Test Loss: 0.503 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.5609800815582275
Epoch: 44, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.515 Vali Acc: 0.856 Test Loss: 0.515 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 45 cost time: 1.754910945892334
Epoch: 45, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.477 Vali Acc: 0.872 Test Loss: 0.477 Test Acc: 0.872
Validation loss decreased (-0.855550 --> -0.872217).  Saving model ...
Epoch: 46 cost time: 1.6602814197540283
Epoch: 46, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.467 Vali Acc: 0.867 Test Loss: 0.467 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.610121488571167
Epoch: 47, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.478 Vali Acc: 0.861 Test Loss: 0.478 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.295384168624878
Epoch: 48, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.474 Vali Acc: 0.856 Test Loss: 0.474 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.3011839389801025
Epoch: 49, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.466 Vali Acc: 0.867 Test Loss: 0.466 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.4550602436065674
Epoch: 50, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.486 Vali Acc: 0.867 Test Loss: 0.486 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.6502254009246826
Epoch: 51, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.466 Vali Acc: 0.872 Test Loss: 0.466 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872218).  Saving model ...
Epoch: 52 cost time: 1.7127718925476074
Epoch: 52, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.440 Vali Acc: 0.878 Test Loss: 0.440 Test Acc: 0.878
Validation loss decreased (-0.872218 --> -0.877773).  Saving model ...
Epoch: 53 cost time: 1.435119867324829
Epoch: 53, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.454 Vali Acc: 0.878 Test Loss: 0.454 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.409665822982788
Epoch: 54, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.463 Vali Acc: 0.861 Test Loss: 0.463 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.0936973094940186
Epoch: 55, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.479 Vali Acc: 0.878 Test Loss: 0.479 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.4066131114959717
Epoch: 56, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.480 Vali Acc: 0.867 Test Loss: 0.480 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.512594223022461
Epoch: 57, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.426 Vali Acc: 0.878 Test Loss: 0.426 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877774).  Saving model ...
Epoch: 58 cost time: 1.4711425304412842
Epoch: 58, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.476 Vali Acc: 0.867 Test Loss: 0.476 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.4887380599975586
Epoch: 59, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.458 Vali Acc: 0.867 Test Loss: 0.458 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.382734775543213
Epoch: 60, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.439 Vali Acc: 0.889 Test Loss: 0.439 Test Acc: 0.889
Validation loss decreased (-0.877774 --> -0.888885).  Saving model ...
Epoch: 61 cost time: 1.1858830451965332
Epoch: 61, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.461 Vali Acc: 0.883 Test Loss: 0.461 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.3940727710723877
Epoch: 62, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.444 Vali Acc: 0.883 Test Loss: 0.444 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.3181853294372559
Epoch: 63, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.455 Vali Acc: 0.894 Test Loss: 0.455 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894440).  Saving model ...
Epoch: 64 cost time: 1.3596537113189697
Epoch: 64, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.453 Vali Acc: 0.889 Test Loss: 0.453 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.3332927227020264
Epoch: 65, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.442 Vali Acc: 0.889 Test Loss: 0.442 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.448960542678833
Epoch: 66, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.480 Vali Acc: 0.861 Test Loss: 0.480 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 1.4825866222381592
Epoch: 67, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.459 Vali Acc: 0.867 Test Loss: 0.459 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 1.290128231048584
Epoch: 68, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.461 Vali Acc: 0.878 Test Loss: 0.461 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 1.7483572959899902
Epoch: 69, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.505 Vali Acc: 0.867 Test Loss: 0.505 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 1.615781545639038
Epoch: 70, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.463 Vali Acc: 0.861 Test Loss: 0.463 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 1.5992002487182617
Epoch: 71, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.463 Vali Acc: 0.894 Test Loss: 0.463 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 1.6909723281860352
Epoch: 72, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.493 Vali Acc: 0.889 Test Loss: 0.493 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 1.4086437225341797
Epoch: 73, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.447 Vali Acc: 0.883 Test Loss: 0.447 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 257363
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.931429386138916
Epoch: 1, Steps: 12 | Train Loss: 2.873 Vali Loss: 2.762 Vali Acc: 0.050 Test Loss: 2.762 Test Acc: 0.050
Validation loss decreased (inf --> -0.049972).  Saving model ...
Epoch: 2 cost time: 1.4408042430877686
Epoch: 2, Steps: 12 | Train Loss: 2.806 Vali Loss: 2.676 Vali Acc: 0.078 Test Loss: 2.676 Test Acc: 0.078
Validation loss decreased (-0.049972 --> -0.077751).  Saving model ...
Epoch: 3 cost time: 1.2817704677581787
Epoch: 3, Steps: 12 | Train Loss: 2.657 Vali Loss: 2.594 Vali Acc: 0.161 Test Loss: 2.594 Test Acc: 0.161
Validation loss decreased (-0.077751 --> -0.161085).  Saving model ...
Epoch: 4 cost time: 1.305835485458374
Epoch: 4, Steps: 12 | Train Loss: 2.607 Vali Loss: 2.521 Vali Acc: 0.239 Test Loss: 2.521 Test Acc: 0.239
Validation loss decreased (-0.161085 --> -0.238864).  Saving model ...
Epoch: 5 cost time: 1.1924502849578857
Epoch: 5, Steps: 12 | Train Loss: 2.516 Vali Loss: 2.443 Vali Acc: 0.328 Test Loss: 2.443 Test Acc: 0.328
Validation loss decreased (-0.238864 --> -0.327753).  Saving model ...
Epoch: 6 cost time: 1.3942406177520752
Epoch: 6, Steps: 12 | Train Loss: 2.458 Vali Loss: 2.348 Vali Acc: 0.339 Test Loss: 2.348 Test Acc: 0.339
Validation loss decreased (-0.327753 --> -0.338865).  Saving model ...
Epoch: 7 cost time: 1.1891417503356934
Epoch: 7, Steps: 12 | Train Loss: 2.354 Vali Loss: 2.234 Vali Acc: 0.406 Test Loss: 2.234 Test Acc: 0.406
Validation loss decreased (-0.338865 --> -0.405533).  Saving model ...
Epoch: 8 cost time: 1.45601224899292
Epoch: 8, Steps: 12 | Train Loss: 2.258 Vali Loss: 2.108 Vali Acc: 0.461 Test Loss: 2.108 Test Acc: 0.461
Validation loss decreased (-0.405533 --> -0.461090).  Saving model ...
Epoch: 9 cost time: 1.254603624343872
Epoch: 9, Steps: 12 | Train Loss: 2.072 Vali Loss: 1.971 Vali Acc: 0.500 Test Loss: 1.971 Test Acc: 0.500
Validation loss decreased (-0.461090 --> -0.499980).  Saving model ...
Epoch: 10 cost time: 1.383310079574585
Epoch: 10, Steps: 12 | Train Loss: 1.944 Vali Loss: 1.856 Vali Acc: 0.511 Test Loss: 1.856 Test Acc: 0.511
Validation loss decreased (-0.499980 --> -0.511093).  Saving model ...
Epoch: 11 cost time: 1.397223949432373
Epoch: 11, Steps: 12 | Train Loss: 1.802 Vali Loss: 1.753 Vali Acc: 0.528 Test Loss: 1.753 Test Acc: 0.528
Validation loss decreased (-0.511093 --> -0.527760).  Saving model ...
Epoch: 12 cost time: 1.125392198562622
Epoch: 12, Steps: 12 | Train Loss: 1.646 Vali Loss: 1.662 Vali Acc: 0.522 Test Loss: 1.662 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4448306560516357
Epoch: 13, Steps: 12 | Train Loss: 1.571 Vali Loss: 1.563 Vali Acc: 0.606 Test Loss: 1.563 Test Acc: 0.606
Validation loss decreased (-0.527760 --> -0.605540).  Saving model ...
Epoch: 14 cost time: 1.5259535312652588
Epoch: 14, Steps: 12 | Train Loss: 1.454 Vali Loss: 1.485 Vali Acc: 0.583 Test Loss: 1.485 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3575758934020996
Epoch: 15, Steps: 12 | Train Loss: 1.433 Vali Loss: 1.415 Vali Acc: 0.644 Test Loss: 1.415 Test Acc: 0.644
Validation loss decreased (-0.605540 --> -0.644430).  Saving model ...
Epoch: 16 cost time: 1.3525097370147705
Epoch: 16, Steps: 12 | Train Loss: 1.342 Vali Loss: 1.362 Vali Acc: 0.628 Test Loss: 1.362 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2652556896209717
Epoch: 17, Steps: 12 | Train Loss: 1.206 Vali Loss: 1.302 Vali Acc: 0.656 Test Loss: 1.302 Test Acc: 0.656
Validation loss decreased (-0.644430 --> -0.655543).  Saving model ...
Epoch: 18 cost time: 1.470308780670166
Epoch: 18, Steps: 12 | Train Loss: 1.109 Vali Loss: 1.249 Vali Acc: 0.661 Test Loss: 1.249 Test Acc: 0.661
Validation loss decreased (-0.655543 --> -0.661099).  Saving model ...
Epoch: 19 cost time: 1.5435376167297363
Epoch: 19, Steps: 12 | Train Loss: 1.086 Vali Loss: 1.196 Vali Acc: 0.667 Test Loss: 1.196 Test Acc: 0.667
Validation loss decreased (-0.661099 --> -0.666655).  Saving model ...
Epoch: 20 cost time: 1.609076738357544
Epoch: 20, Steps: 12 | Train Loss: 1.011 Vali Loss: 1.134 Vali Acc: 0.700 Test Loss: 1.134 Test Acc: 0.700
Validation loss decreased (-0.666655 --> -0.699989).  Saving model ...
Epoch: 21 cost time: 1.5321345329284668
Epoch: 21, Steps: 12 | Train Loss: 0.965 Vali Loss: 1.089 Vali Acc: 0.700 Test Loss: 1.089 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 22 cost time: 1.3738806247711182
Epoch: 22, Steps: 12 | Train Loss: 0.872 Vali Loss: 1.056 Vali Acc: 0.706 Test Loss: 1.056 Test Acc: 0.706
Validation loss decreased (-0.699989 --> -0.705545).  Saving model ...
Epoch: 23 cost time: 1.297433853149414
Epoch: 23, Steps: 12 | Train Loss: 0.839 Vali Loss: 1.026 Vali Acc: 0.700 Test Loss: 1.026 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3041892051696777
Epoch: 24, Steps: 12 | Train Loss: 0.803 Vali Loss: 0.969 Vali Acc: 0.750 Test Loss: 0.969 Test Acc: 0.750
Validation loss decreased (-0.705545 --> -0.749990).  Saving model ...
Epoch: 25 cost time: 1.3496997356414795
Epoch: 25, Steps: 12 | Train Loss: 0.769 Vali Loss: 0.971 Vali Acc: 0.728 Test Loss: 0.971 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3191492557525635
Epoch: 26, Steps: 12 | Train Loss: 0.680 Vali Loss: 0.876 Vali Acc: 0.744 Test Loss: 0.876 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.6649415493011475
Epoch: 27, Steps: 12 | Train Loss: 0.660 Vali Loss: 0.852 Vali Acc: 0.756 Test Loss: 0.852 Test Acc: 0.756
Validation loss decreased (-0.749990 --> -0.755547).  Saving model ...
Epoch: 28 cost time: 1.3813505172729492
Epoch: 28, Steps: 12 | Train Loss: 0.589 Vali Loss: 0.824 Vali Acc: 0.761 Test Loss: 0.824 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761103).  Saving model ...
Epoch: 29 cost time: 1.4910006523132324
Epoch: 29, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.788 Vali Acc: 0.761 Test Loss: 0.788 Test Acc: 0.761
Validation loss decreased (-0.761103 --> -0.761103).  Saving model ...
Epoch: 30 cost time: 1.577707290649414
Epoch: 30, Steps: 12 | Train Loss: 0.534 Vali Loss: 0.788 Vali Acc: 0.761 Test Loss: 0.788 Test Acc: 0.761
Validation loss decreased (-0.761103 --> -0.761103).  Saving model ...
Epoch: 31 cost time: 1.3569979667663574
Epoch: 31, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.722 Vali Acc: 0.789 Test Loss: 0.722 Test Acc: 0.789
Validation loss decreased (-0.761103 --> -0.788882).  Saving model ...
Epoch: 32 cost time: 1.503175973892212
Epoch: 32, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.689 Vali Acc: 0.794 Test Loss: 0.689 Test Acc: 0.794
Validation loss decreased (-0.788882 --> -0.794438).  Saving model ...
Epoch: 33 cost time: 1.6052093505859375
Epoch: 33, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.701 Vali Acc: 0.789 Test Loss: 0.701 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.479250192642212
Epoch: 34, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.657 Vali Acc: 0.800 Test Loss: 0.657 Test Acc: 0.800
Validation loss decreased (-0.794438 --> -0.799993).  Saving model ...
Epoch: 35 cost time: 1.5273842811584473
Epoch: 35, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.644 Vali Acc: 0.828 Test Loss: 0.644 Test Acc: 0.828
Validation loss decreased (-0.799993 --> -0.827771).  Saving model ...
Epoch: 36 cost time: 1.5731244087219238
Epoch: 36, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.627 Vali Acc: 0.806 Test Loss: 0.627 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.510376214981079
Epoch: 37, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.610 Vali Acc: 0.806 Test Loss: 0.610 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.5134918689727783
Epoch: 38, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.590 Vali Acc: 0.822 Test Loss: 0.590 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.4622893333435059
Epoch: 39, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.574 Vali Acc: 0.817 Test Loss: 0.574 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.5667123794555664
Epoch: 40, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.538 Vali Acc: 0.839 Test Loss: 0.538 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838884).  Saving model ...
Epoch: 41 cost time: 1.5769023895263672
Epoch: 41, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.563 Vali Acc: 0.828 Test Loss: 0.563 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.5111424922943115
Epoch: 42, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.513 Vali Acc: 0.844 Test Loss: 0.513 Test Acc: 0.844
Validation loss decreased (-0.838884 --> -0.844439).  Saving model ...
Epoch: 43 cost time: 1.3565726280212402
Epoch: 43, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.529 Vali Acc: 0.850 Test Loss: 0.529 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849995).  Saving model ...
Epoch: 44 cost time: 1.186509132385254
Epoch: 44, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.556 Vali Acc: 0.850 Test Loss: 0.556 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.22902250289917
Epoch: 45, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.513 Vali Acc: 0.844 Test Loss: 0.513 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.1751480102539062
Epoch: 46, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.522 Vali Acc: 0.844 Test Loss: 0.522 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.6066439151763916
Epoch: 47, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.507 Vali Acc: 0.844 Test Loss: 0.507 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.3524198532104492
Epoch: 48, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.517 Vali Acc: 0.850 Test Loss: 0.517 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 49 cost time: 1.5223500728607178
Epoch: 49, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.496 Vali Acc: 0.856 Test Loss: 0.496 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855551).  Saving model ...
Epoch: 50 cost time: 1.2071993350982666
Epoch: 50, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.507 Vali Acc: 0.867 Test Loss: 0.507 Test Acc: 0.867
Validation loss decreased (-0.855551 --> -0.866662).  Saving model ...
Epoch: 51 cost time: 1.3498210906982422
Epoch: 51, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.471 Vali Acc: 0.856 Test Loss: 0.471 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.136282205581665
Epoch: 52, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.489 Vali Acc: 0.856 Test Loss: 0.489 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.3454480171203613
Epoch: 53, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.449 Vali Acc: 0.872 Test Loss: 0.449 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872218).  Saving model ...
Epoch: 54 cost time: 1.1877686977386475
Epoch: 54, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.453 Vali Acc: 0.872 Test Loss: 0.453 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.4351518154144287
Epoch: 55, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.512 Vali Acc: 0.856 Test Loss: 0.512 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.2252542972564697
Epoch: 56, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.439 Vali Acc: 0.867 Test Loss: 0.439 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.1761422157287598
Epoch: 57, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.430 Vali Acc: 0.878 Test Loss: 0.430 Test Acc: 0.878
Validation loss decreased (-0.872218 --> -0.877773).  Saving model ...
Epoch: 58 cost time: 1.2684884071350098
Epoch: 58, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.462 Vali Acc: 0.867 Test Loss: 0.462 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.2234563827514648
Epoch: 59, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.457 Vali Acc: 0.872 Test Loss: 0.457 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.446643590927124
Epoch: 60, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.458 Vali Acc: 0.878 Test Loss: 0.458 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.3093230724334717
Epoch: 61, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.454 Vali Acc: 0.867 Test Loss: 0.454 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.3283302783966064
Epoch: 62, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.488 Vali Acc: 0.861 Test Loss: 0.488 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.4126408100128174
Epoch: 63, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.461 Vali Acc: 0.867 Test Loss: 0.461 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.3591935634613037
Epoch: 64, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.468 Vali Acc: 0.872 Test Loss: 0.468 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 1.274216651916504
Epoch: 65, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.454 Vali Acc: 0.872 Test Loss: 0.454 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 1.1927719116210938
Epoch: 66, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.510 Vali Acc: 0.861 Test Loss: 0.510 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 1.2770438194274902
Epoch: 67, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.462 Vali Acc: 0.878 Test Loss: 0.462 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 257171
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7825164794921875
Epoch: 1, Steps: 12 | Train Loss: 2.939 Vali Loss: 2.823 Vali Acc: 0.044 Test Loss: 2.823 Test Acc: 0.044
Validation loss decreased (inf --> -0.044416).  Saving model ...
Epoch: 2 cost time: 1.5809509754180908
Epoch: 2, Steps: 12 | Train Loss: 2.838 Vali Loss: 2.740 Vali Acc: 0.039 Test Loss: 2.740 Test Acc: 0.039
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.294893503189087
Epoch: 3, Steps: 12 | Train Loss: 2.764 Vali Loss: 2.674 Vali Acc: 0.094 Test Loss: 2.674 Test Acc: 0.094
Validation loss decreased (-0.044416 --> -0.094418).  Saving model ...
Epoch: 4 cost time: 1.401116132736206
Epoch: 4, Steps: 12 | Train Loss: 2.670 Vali Loss: 2.629 Vali Acc: 0.156 Test Loss: 2.629 Test Acc: 0.156
Validation loss decreased (-0.094418 --> -0.155529).  Saving model ...
Epoch: 5 cost time: 1.0923528671264648
Epoch: 5, Steps: 12 | Train Loss: 2.590 Vali Loss: 2.585 Vali Acc: 0.261 Test Loss: 2.585 Test Acc: 0.261
Validation loss decreased (-0.155529 --> -0.261085).  Saving model ...
Epoch: 6 cost time: 1.2197613716125488
Epoch: 6, Steps: 12 | Train Loss: 2.532 Vali Loss: 2.523 Vali Acc: 0.300 Test Loss: 2.523 Test Acc: 0.300
Validation loss decreased (-0.261085 --> -0.299975).  Saving model ...
Epoch: 7 cost time: 1.301854133605957
Epoch: 7, Steps: 12 | Train Loss: 2.479 Vali Loss: 2.439 Vali Acc: 0.356 Test Loss: 2.439 Test Acc: 0.356
Validation loss decreased (-0.299975 --> -0.355531).  Saving model ...
Epoch: 8 cost time: 1.2502362728118896
Epoch: 8, Steps: 12 | Train Loss: 2.335 Vali Loss: 2.335 Vali Acc: 0.422 Test Loss: 2.335 Test Acc: 0.422
Validation loss decreased (-0.355531 --> -0.422199).  Saving model ...
Epoch: 9 cost time: 1.275266170501709
Epoch: 9, Steps: 12 | Train Loss: 2.201 Vali Loss: 2.251 Vali Acc: 0.456 Test Loss: 2.251 Test Acc: 0.456
Validation loss decreased (-0.422199 --> -0.455533).  Saving model ...
Epoch: 10 cost time: 1.235537052154541
Epoch: 10, Steps: 12 | Train Loss: 2.090 Vali Loss: 2.144 Vali Acc: 0.461 Test Loss: 2.144 Test Acc: 0.461
Validation loss decreased (-0.455533 --> -0.461090).  Saving model ...
Epoch: 11 cost time: 1.3839449882507324
Epoch: 11, Steps: 12 | Train Loss: 1.995 Vali Loss: 2.040 Vali Acc: 0.483 Test Loss: 2.040 Test Acc: 0.483
Validation loss decreased (-0.461090 --> -0.483313).  Saving model ...
Epoch: 12 cost time: 1.2800843715667725
Epoch: 12, Steps: 12 | Train Loss: 1.825 Vali Loss: 1.945 Vali Acc: 0.494 Test Loss: 1.945 Test Acc: 0.494
Validation loss decreased (-0.483313 --> -0.494425).  Saving model ...
Epoch: 13 cost time: 1.5748894214630127
Epoch: 13, Steps: 12 | Train Loss: 1.750 Vali Loss: 1.846 Vali Acc: 0.522 Test Loss: 1.846 Test Acc: 0.522
Validation loss decreased (-0.494425 --> -0.522204).  Saving model ...
Epoch: 14 cost time: 1.104823112487793
Epoch: 14, Steps: 12 | Train Loss: 1.617 Vali Loss: 1.755 Vali Acc: 0.544 Test Loss: 1.755 Test Acc: 0.544
Validation loss decreased (-0.522204 --> -0.544427).  Saving model ...
Epoch: 15 cost time: 1.218555212020874
Epoch: 15, Steps: 12 | Train Loss: 1.497 Vali Loss: 1.641 Vali Acc: 0.583 Test Loss: 1.641 Test Acc: 0.583
Validation loss decreased (-0.544427 --> -0.583317).  Saving model ...
Epoch: 16 cost time: 1.1762993335723877
Epoch: 16, Steps: 12 | Train Loss: 1.412 Vali Loss: 1.554 Vali Acc: 0.589 Test Loss: 1.554 Test Acc: 0.589
Validation loss decreased (-0.583317 --> -0.588873).  Saving model ...
Epoch: 17 cost time: 1.2865872383117676
Epoch: 17, Steps: 12 | Train Loss: 1.319 Vali Loss: 1.469 Vali Acc: 0.583 Test Loss: 1.469 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5697808265686035
Epoch: 18, Steps: 12 | Train Loss: 1.199 Vali Loss: 1.377 Vali Acc: 0.617 Test Loss: 1.377 Test Acc: 0.617
Validation loss decreased (-0.588873 --> -0.616653).  Saving model ...
Epoch: 19 cost time: 1.4861631393432617
Epoch: 19, Steps: 12 | Train Loss: 1.150 Vali Loss: 1.303 Vali Acc: 0.650 Test Loss: 1.303 Test Acc: 0.650
Validation loss decreased (-0.616653 --> -0.649987).  Saving model ...
Epoch: 20 cost time: 1.3212597370147705
Epoch: 20, Steps: 12 | Train Loss: 1.073 Vali Loss: 1.217 Vali Acc: 0.672 Test Loss: 1.217 Test Acc: 0.672
Validation loss decreased (-0.649987 --> -0.672210).  Saving model ...
Epoch: 21 cost time: 1.4029126167297363
Epoch: 21, Steps: 12 | Train Loss: 0.991 Vali Loss: 1.176 Vali Acc: 0.683 Test Loss: 1.176 Test Acc: 0.683
Validation loss decreased (-0.672210 --> -0.683322).  Saving model ...
Epoch: 22 cost time: 1.363356113433838
Epoch: 22, Steps: 12 | Train Loss: 0.982 Vali Loss: 1.092 Vali Acc: 0.733 Test Loss: 1.092 Test Acc: 0.733
Validation loss decreased (-0.683322 --> -0.733322).  Saving model ...
Epoch: 23 cost time: 1.2371928691864014
Epoch: 23, Steps: 12 | Train Loss: 0.907 Vali Loss: 1.046 Vali Acc: 0.717 Test Loss: 1.046 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4467780590057373
Epoch: 24, Steps: 12 | Train Loss: 0.868 Vali Loss: 1.003 Vali Acc: 0.739 Test Loss: 1.003 Test Acc: 0.739
Validation loss decreased (-0.733322 --> -0.738879).  Saving model ...
Epoch: 25 cost time: 1.2860090732574463
Epoch: 25, Steps: 12 | Train Loss: 0.770 Vali Loss: 0.960 Vali Acc: 0.739 Test Loss: 0.960 Test Acc: 0.739
Validation loss decreased (-0.738879 --> -0.738879).  Saving model ...
Epoch: 26 cost time: 1.3781940937042236
Epoch: 26, Steps: 12 | Train Loss: 0.730 Vali Loss: 0.951 Vali Acc: 0.767 Test Loss: 0.951 Test Acc: 0.767
Validation loss decreased (-0.738879 --> -0.766657).  Saving model ...
Epoch: 27 cost time: 1.4629883766174316
Epoch: 27, Steps: 12 | Train Loss: 0.730 Vali Loss: 0.886 Vali Acc: 0.744 Test Loss: 0.886 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1100573539733887
Epoch: 28, Steps: 12 | Train Loss: 0.684 Vali Loss: 0.854 Vali Acc: 0.783 Test Loss: 0.854 Test Acc: 0.783
Validation loss decreased (-0.766657 --> -0.783325).  Saving model ...
Epoch: 29 cost time: 1.2067196369171143
Epoch: 29, Steps: 12 | Train Loss: 0.662 Vali Loss: 0.816 Vali Acc: 0.761 Test Loss: 0.816 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.140869140625
Epoch: 30, Steps: 12 | Train Loss: 0.599 Vali Loss: 0.801 Vali Acc: 0.783 Test Loss: 0.801 Test Acc: 0.783
Validation loss decreased (-0.783325 --> -0.783325).  Saving model ...
Epoch: 31 cost time: 1.2826321125030518
Epoch: 31, Steps: 12 | Train Loss: 0.564 Vali Loss: 0.760 Vali Acc: 0.783 Test Loss: 0.760 Test Acc: 0.783
Validation loss decreased (-0.783325 --> -0.783326).  Saving model ...
Epoch: 32 cost time: 1.2728614807128906
Epoch: 32, Steps: 12 | Train Loss: 0.538 Vali Loss: 0.751 Vali Acc: 0.783 Test Loss: 0.751 Test Acc: 0.783
Validation loss decreased (-0.783326 --> -0.783326).  Saving model ...
Epoch: 33 cost time: 1.3320667743682861
Epoch: 33, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.710 Vali Acc: 0.783 Test Loss: 0.710 Test Acc: 0.783
Validation loss decreased (-0.783326 --> -0.783326).  Saving model ...
Epoch: 34 cost time: 1.1643826961517334
Epoch: 34, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.704 Vali Acc: 0.833 Test Loss: 0.704 Test Acc: 0.833
Validation loss decreased (-0.783326 --> -0.833326).  Saving model ...
Epoch: 35 cost time: 1.145690679550171
Epoch: 35, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.680 Vali Acc: 0.789 Test Loss: 0.680 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.3539366722106934
Epoch: 36, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.646 Vali Acc: 0.822 Test Loss: 0.646 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.3584520816802979
Epoch: 37, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.624 Vali Acc: 0.817 Test Loss: 0.624 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.198448896408081
Epoch: 38, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.631 Vali Acc: 0.828 Test Loss: 0.631 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.1754226684570312
Epoch: 39, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.623 Vali Acc: 0.822 Test Loss: 0.623 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.2660839557647705
Epoch: 40, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.578 Vali Acc: 0.839 Test Loss: 0.578 Test Acc: 0.839
Validation loss decreased (-0.833326 --> -0.838883).  Saving model ...
Epoch: 41 cost time: 1.3318836688995361
Epoch: 41, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.606 Vali Acc: 0.833 Test Loss: 0.606 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.373779296875
Epoch: 42, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.565 Vali Acc: 0.833 Test Loss: 0.565 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.2620275020599365
Epoch: 43, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.559 Vali Acc: 0.839 Test Loss: 0.559 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 44 cost time: 1.1616990566253662
Epoch: 44, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.522 Vali Acc: 0.833 Test Loss: 0.522 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.2610702514648438
Epoch: 45, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.541 Vali Acc: 0.844 Test Loss: 0.541 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 46 cost time: 1.4118340015411377
Epoch: 46, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.541 Vali Acc: 0.839 Test Loss: 0.541 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.4846301078796387
Epoch: 47, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.544 Vali Acc: 0.844 Test Loss: 0.544 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.196375846862793
Epoch: 48, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.533 Vali Acc: 0.861 Test Loss: 0.533 Test Acc: 0.861
Validation loss decreased (-0.844439 --> -0.861106).  Saving model ...
Epoch: 49 cost time: 1.3169505596160889
Epoch: 49, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.527 Vali Acc: 0.844 Test Loss: 0.527 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.2289137840270996
Epoch: 50, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.530 Vali Acc: 0.844 Test Loss: 0.530 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.2398960590362549
Epoch: 51, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.504 Vali Acc: 0.856 Test Loss: 0.504 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.247143268585205
Epoch: 52, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.491 Vali Acc: 0.861 Test Loss: 0.491 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 53 cost time: 1.1350977420806885
Epoch: 53, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.526 Vali Acc: 0.850 Test Loss: 0.526 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.2572038173675537
Epoch: 54, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.526 Vali Acc: 0.861 Test Loss: 0.526 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.2325212955474854
Epoch: 55, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.492 Vali Acc: 0.850 Test Loss: 0.492 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.1713860034942627
Epoch: 56, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.486 Vali Acc: 0.856 Test Loss: 0.486 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.3837051391601562
Epoch: 57, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.508 Vali Acc: 0.867 Test Loss: 0.508 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866662).  Saving model ...
Epoch: 58 cost time: 1.2195286750793457
Epoch: 58, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.498 Vali Acc: 0.861 Test Loss: 0.498 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.244225025177002
Epoch: 59, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.505 Vali Acc: 0.872 Test Loss: 0.505 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872217).  Saving model ...
Epoch: 60 cost time: 1.276338815689087
Epoch: 60, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.483 Vali Acc: 0.878 Test Loss: 0.483 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 61 cost time: 1.4637715816497803
Epoch: 61, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.501 Vali Acc: 0.872 Test Loss: 0.501 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.4778599739074707
Epoch: 62, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.504 Vali Acc: 0.872 Test Loss: 0.504 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.2019407749176025
Epoch: 63, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.493 Vali Acc: 0.856 Test Loss: 0.493 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.309673547744751
Epoch: 64, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.443 Vali Acc: 0.867 Test Loss: 0.443 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 1.1879823207855225
Epoch: 65, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.509 Vali Acc: 0.867 Test Loss: 0.509 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 1.2698943614959717
Epoch: 66, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.508 Vali Acc: 0.883 Test Loss: 0.508 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883328).  Saving model ...
Epoch: 67 cost time: 1.1874353885650635
Epoch: 67, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.499 Vali Acc: 0.856 Test Loss: 0.499 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.3254120349884033
Epoch: 68, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.501 Vali Acc: 0.878 Test Loss: 0.501 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.159836769104004
Epoch: 69, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.458 Vali Acc: 0.861 Test Loss: 0.458 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 1.299189805984497
Epoch: 70, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.491 Vali Acc: 0.889 Test Loss: 0.491 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888884).  Saving model ...
Epoch: 71 cost time: 1.328564167022705
Epoch: 71, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.506 Vali Acc: 0.889 Test Loss: 0.506 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.4755566120147705
Epoch: 72, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.497 Vali Acc: 0.878 Test Loss: 0.497 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.2780921459197998
Epoch: 73, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.481 Vali Acc: 0.894 Test Loss: 0.481 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894440).  Saving model ...
Epoch: 74 cost time: 1.2972135543823242
Epoch: 74, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.479 Vali Acc: 0.883 Test Loss: 0.479 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.1805706024169922
Epoch: 75, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.503 Vali Acc: 0.883 Test Loss: 0.503 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 1.2109699249267578
Epoch: 76, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.505 Vali Acc: 0.878 Test Loss: 0.505 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 1.3045737743377686
Epoch: 77, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.506 Vali Acc: 0.867 Test Loss: 0.506 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 1.3162007331848145
Epoch: 78, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.509 Vali Acc: 0.867 Test Loss: 0.509 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 1.5839638710021973
Epoch: 79, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.553 Vali Acc: 0.861 Test Loss: 0.553 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 1.595400333404541
Epoch: 80, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.469 Vali Acc: 0.867 Test Loss: 0.469 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 1.373300313949585
Epoch: 81, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.478 Vali Acc: 0.889 Test Loss: 0.478 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 1.3157463073730469
Epoch: 82, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.545 Vali Acc: 0.878 Test Loss: 0.545 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 1.6598374843597412
Epoch: 83, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.501 Vali Acc: 0.861 Test Loss: 0.501 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 256979
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.753699779510498
Epoch: 1, Steps: 12 | Train Loss: 2.819 Vali Loss: 2.787 Vali Acc: 0.072 Test Loss: 2.787 Test Acc: 0.072
Validation loss decreased (inf --> -0.072194).  Saving model ...
Epoch: 2 cost time: 1.6511528491973877
Epoch: 2, Steps: 12 | Train Loss: 2.777 Vali Loss: 2.712 Vali Acc: 0.106 Test Loss: 2.712 Test Acc: 0.106
Validation loss decreased (-0.072194 --> -0.105528).  Saving model ...
Epoch: 3 cost time: 1.3712029457092285
Epoch: 3, Steps: 12 | Train Loss: 2.715 Vali Loss: 2.644 Vali Acc: 0.150 Test Loss: 2.644 Test Acc: 0.150
Validation loss decreased (-0.105528 --> -0.149974).  Saving model ...
Epoch: 4 cost time: 1.2916693687438965
Epoch: 4, Steps: 12 | Train Loss: 2.623 Vali Loss: 2.585 Vali Acc: 0.144 Test Loss: 2.585 Test Acc: 0.144
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4031498432159424
Epoch: 5, Steps: 12 | Train Loss: 2.575 Vali Loss: 2.532 Vali Acc: 0.228 Test Loss: 2.532 Test Acc: 0.228
Validation loss decreased (-0.149974 --> -0.227752).  Saving model ...
Epoch: 6 cost time: 1.7902045249938965
Epoch: 6, Steps: 12 | Train Loss: 2.547 Vali Loss: 2.472 Vali Acc: 0.261 Test Loss: 2.472 Test Acc: 0.261
Validation loss decreased (-0.227752 --> -0.261086).  Saving model ...
Epoch: 7 cost time: 1.6121652126312256
Epoch: 7, Steps: 12 | Train Loss: 2.454 Vali Loss: 2.388 Vali Acc: 0.283 Test Loss: 2.388 Test Acc: 0.283
Validation loss decreased (-0.261086 --> -0.283309).  Saving model ...
Epoch: 8 cost time: 1.8418641090393066
Epoch: 8, Steps: 12 | Train Loss: 2.354 Vali Loss: 2.301 Vali Acc: 0.350 Test Loss: 2.301 Test Acc: 0.350
Validation loss decreased (-0.283309 --> -0.349977).  Saving model ...
Epoch: 9 cost time: 1.3169403076171875
Epoch: 9, Steps: 12 | Train Loss: 2.248 Vali Loss: 2.205 Vali Acc: 0.389 Test Loss: 2.205 Test Acc: 0.389
Validation loss decreased (-0.349977 --> -0.388867).  Saving model ...
Epoch: 10 cost time: 1.3420655727386475
Epoch: 10, Steps: 12 | Train Loss: 2.159 Vali Loss: 2.092 Vali Acc: 0.444 Test Loss: 2.092 Test Acc: 0.444
Validation loss decreased (-0.388867 --> -0.444424).  Saving model ...
Epoch: 11 cost time: 1.3607749938964844
Epoch: 11, Steps: 12 | Train Loss: 2.014 Vali Loss: 1.988 Vali Acc: 0.461 Test Loss: 1.988 Test Acc: 0.461
Validation loss decreased (-0.444424 --> -0.461091).  Saving model ...
Epoch: 12 cost time: 1.4425950050354004
Epoch: 12, Steps: 12 | Train Loss: 1.914 Vali Loss: 1.891 Vali Acc: 0.506 Test Loss: 1.891 Test Acc: 0.506
Validation loss decreased (-0.461091 --> -0.505537).  Saving model ...
Epoch: 13 cost time: 1.2629871368408203
Epoch: 13, Steps: 12 | Train Loss: 1.839 Vali Loss: 1.798 Vali Acc: 0.506 Test Loss: 1.798 Test Acc: 0.506
Validation loss decreased (-0.505537 --> -0.505538).  Saving model ...
Epoch: 14 cost time: 1.3859248161315918
Epoch: 14, Steps: 12 | Train Loss: 1.641 Vali Loss: 1.692 Vali Acc: 0.539 Test Loss: 1.692 Test Acc: 0.539
Validation loss decreased (-0.505538 --> -0.538872).  Saving model ...
Epoch: 15 cost time: 1.5105009078979492
Epoch: 15, Steps: 12 | Train Loss: 1.525 Vali Loss: 1.599 Vali Acc: 0.567 Test Loss: 1.599 Test Acc: 0.567
Validation loss decreased (-0.538872 --> -0.566651).  Saving model ...
Epoch: 16 cost time: 1.67974853515625
Epoch: 16, Steps: 12 | Train Loss: 1.493 Vali Loss: 1.530 Vali Acc: 0.594 Test Loss: 1.530 Test Acc: 0.594
Validation loss decreased (-0.566651 --> -0.594429).  Saving model ...
Epoch: 17 cost time: 1.8385932445526123
Epoch: 17, Steps: 12 | Train Loss: 1.373 Vali Loss: 1.438 Vali Acc: 0.628 Test Loss: 1.438 Test Acc: 0.628
Validation loss decreased (-0.594429 --> -0.627763).  Saving model ...
Epoch: 18 cost time: 1.285393238067627
Epoch: 18, Steps: 12 | Train Loss: 1.258 Vali Loss: 1.365 Vali Acc: 0.628 Test Loss: 1.365 Test Acc: 0.628
Validation loss decreased (-0.627763 --> -0.627764).  Saving model ...
Epoch: 19 cost time: 1.4080836772918701
Epoch: 19, Steps: 12 | Train Loss: 1.223 Vali Loss: 1.297 Vali Acc: 0.650 Test Loss: 1.297 Test Acc: 0.650
Validation loss decreased (-0.627764 --> -0.649987).  Saving model ...
Epoch: 20 cost time: 1.4152495861053467
Epoch: 20, Steps: 12 | Train Loss: 1.157 Vali Loss: 1.232 Vali Acc: 0.650 Test Loss: 1.232 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649988).  Saving model ...
Epoch: 21 cost time: 1.3702166080474854
Epoch: 21, Steps: 12 | Train Loss: 1.065 Vali Loss: 1.172 Vali Acc: 0.711 Test Loss: 1.172 Test Acc: 0.711
Validation loss decreased (-0.649988 --> -0.711099).  Saving model ...
Epoch: 22 cost time: 1.5265753269195557
Epoch: 22, Steps: 12 | Train Loss: 0.979 Vali Loss: 1.122 Vali Acc: 0.711 Test Loss: 1.122 Test Acc: 0.711
Validation loss decreased (-0.711099 --> -0.711100).  Saving model ...
Epoch: 23 cost time: 1.5214567184448242
Epoch: 23, Steps: 12 | Train Loss: 0.955 Vali Loss: 1.067 Vali Acc: 0.700 Test Loss: 1.067 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5647914409637451
Epoch: 24, Steps: 12 | Train Loss: 0.952 Vali Loss: 1.024 Vali Acc: 0.733 Test Loss: 1.024 Test Acc: 0.733
Validation loss decreased (-0.711100 --> -0.733323).  Saving model ...
Epoch: 25 cost time: 1.2669174671173096
Epoch: 25, Steps: 12 | Train Loss: 0.851 Vali Loss: 0.964 Vali Acc: 0.728 Test Loss: 0.964 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4447708129882812
Epoch: 26, Steps: 12 | Train Loss: 0.790 Vali Loss: 0.945 Vali Acc: 0.744 Test Loss: 0.945 Test Acc: 0.744
Validation loss decreased (-0.733323 --> -0.744435).  Saving model ...
Epoch: 27 cost time: 1.4001219272613525
Epoch: 27, Steps: 12 | Train Loss: 0.764 Vali Loss: 0.906 Vali Acc: 0.739 Test Loss: 0.906 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4680044651031494
Epoch: 28, Steps: 12 | Train Loss: 0.720 Vali Loss: 0.875 Vali Acc: 0.733 Test Loss: 0.875 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5611894130706787
Epoch: 29, Steps: 12 | Train Loss: 0.650 Vali Loss: 0.837 Vali Acc: 0.778 Test Loss: 0.837 Test Acc: 0.778
Validation loss decreased (-0.744435 --> -0.777769).  Saving model ...
Epoch: 30 cost time: 1.8253326416015625
Epoch: 30, Steps: 12 | Train Loss: 0.617 Vali Loss: 0.803 Vali Acc: 0.772 Test Loss: 0.803 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.6790063381195068
Epoch: 31, Steps: 12 | Train Loss: 0.627 Vali Loss: 0.787 Vali Acc: 0.767 Test Loss: 0.787 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.4874606132507324
Epoch: 32, Steps: 12 | Train Loss: 0.543 Vali Loss: 0.750 Vali Acc: 0.761 Test Loss: 0.750 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.3407504558563232
Epoch: 33, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.736 Vali Acc: 0.789 Test Loss: 0.736 Test Acc: 0.789
Validation loss decreased (-0.777769 --> -0.788882).  Saving model ...
Epoch: 34 cost time: 1.417236566543579
Epoch: 34, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.721 Vali Acc: 0.794 Test Loss: 0.721 Test Acc: 0.794
Validation loss decreased (-0.788882 --> -0.794437).  Saving model ...
Epoch: 35 cost time: 1.6961174011230469
Epoch: 35, Steps: 12 | Train Loss: 0.440 Vali Loss: 0.681 Vali Acc: 0.789 Test Loss: 0.681 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.6910676956176758
Epoch: 36, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.661 Vali Acc: 0.789 Test Loss: 0.661 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.6477737426757812
Epoch: 37, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.661 Vali Acc: 0.794 Test Loss: 0.661 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794438).  Saving model ...
Epoch: 38 cost time: 1.6873643398284912
Epoch: 38, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.637 Vali Acc: 0.778 Test Loss: 0.637 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.4081315994262695
Epoch: 39, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.612 Vali Acc: 0.806 Test Loss: 0.612 Test Acc: 0.806
Validation loss decreased (-0.794438 --> -0.805549).  Saving model ...
Epoch: 40 cost time: 1.4260694980621338
Epoch: 40, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.616 Vali Acc: 0.811 Test Loss: 0.616 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811105).  Saving model ...
Epoch: 41 cost time: 1.3615612983703613
Epoch: 41, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.578 Vali Acc: 0.822 Test Loss: 0.578 Test Acc: 0.822
Validation loss decreased (-0.811105 --> -0.822216).  Saving model ...
Epoch: 42 cost time: 1.398099422454834
Epoch: 42, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.582 Vali Acc: 0.811 Test Loss: 0.582 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.342005729675293
Epoch: 43, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.551 Vali Acc: 0.822 Test Loss: 0.551 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822217).  Saving model ...
Epoch: 44 cost time: 1.5370736122131348
Epoch: 44, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.548 Vali Acc: 0.844 Test Loss: 0.548 Test Acc: 0.844
Validation loss decreased (-0.822217 --> -0.844439).  Saving model ...
Epoch: 45 cost time: 1.725933313369751
Epoch: 45, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.561 Vali Acc: 0.822 Test Loss: 0.561 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.6590807437896729
Epoch: 46, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.541 Vali Acc: 0.822 Test Loss: 0.541 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.5385291576385498
Epoch: 47, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.540 Vali Acc: 0.833 Test Loss: 0.540 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.5105080604553223
Epoch: 48, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.524 Vali Acc: 0.828 Test Loss: 0.524 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.5251789093017578
Epoch: 49, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.516 Vali Acc: 0.850 Test Loss: 0.516 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849995).  Saving model ...
Epoch: 50 cost time: 1.4538884162902832
Epoch: 50, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.505 Vali Acc: 0.828 Test Loss: 0.505 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.5853986740112305
Epoch: 51, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.508 Vali Acc: 0.833 Test Loss: 0.508 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.8965606689453125
Epoch: 52, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.495 Vali Acc: 0.844 Test Loss: 0.495 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.6201519966125488
Epoch: 53, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.486 Vali Acc: 0.850 Test Loss: 0.486 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 54 cost time: 1.654268741607666
Epoch: 54, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.478 Vali Acc: 0.839 Test Loss: 0.478 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.1728322505950928
Epoch: 55, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.500 Vali Acc: 0.828 Test Loss: 0.500 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.287099838256836
Epoch: 56, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.482 Vali Acc: 0.839 Test Loss: 0.482 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.4488930702209473
Epoch: 57, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.460 Vali Acc: 0.856 Test Loss: 0.460 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855551).  Saving model ...
Epoch: 58 cost time: 1.442133903503418
Epoch: 58, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.479 Vali Acc: 0.844 Test Loss: 0.479 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.3366718292236328
Epoch: 59, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.465 Vali Acc: 0.844 Test Loss: 0.465 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.3902201652526855
Epoch: 60, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.480 Vali Acc: 0.856 Test Loss: 0.480 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.608471393585205
Epoch: 61, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.464 Vali Acc: 0.839 Test Loss: 0.464 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.473405122756958
Epoch: 62, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.472 Vali Acc: 0.850 Test Loss: 0.472 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.6730570793151855
Epoch: 63, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.461 Vali Acc: 0.850 Test Loss: 0.461 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.4927623271942139
Epoch: 64, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.444 Vali Acc: 0.856 Test Loss: 0.444 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 65 cost time: 1.586653470993042
Epoch: 65, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.429 Vali Acc: 0.878 Test Loss: 0.429 Test Acc: 0.878
Validation loss decreased (-0.855551 --> -0.877773).  Saving model ...
Epoch: 66 cost time: 1.414931058883667
Epoch: 66, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.448 Vali Acc: 0.867 Test Loss: 0.448 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.597360372543335
Epoch: 67, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.475 Vali Acc: 0.856 Test Loss: 0.475 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.5248839855194092
Epoch: 68, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.456 Vali Acc: 0.861 Test Loss: 0.456 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.8061344623565674
Epoch: 69, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.438 Vali Acc: 0.872 Test Loss: 0.438 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.6203317642211914
Epoch: 70, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.428 Vali Acc: 0.872 Test Loss: 0.428 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.867356300354004
Epoch: 71, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.436 Vali Acc: 0.872 Test Loss: 0.436 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 1.879335641860962
Epoch: 72, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.481 Vali Acc: 0.878 Test Loss: 0.481 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 1.5876762866973877
Epoch: 73, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.429 Vali Acc: 0.878 Test Loss: 0.429 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 74 cost time: 1.615964412689209
Epoch: 74, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.440 Vali Acc: 0.878 Test Loss: 0.440 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.9640066623687744
Epoch: 75, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.441 Vali Acc: 0.878 Test Loss: 0.441 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 1.8947324752807617
Epoch: 76, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.472 Vali Acc: 0.872 Test Loss: 0.472 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 1.8199677467346191
Epoch: 77, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.434 Vali Acc: 0.878 Test Loss: 0.434 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 1.8826613426208496
Epoch: 78, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.473 Vali Acc: 0.872 Test Loss: 0.473 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 1.6271376609802246
Epoch: 79, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.471 Vali Acc: 0.883 Test Loss: 0.471 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883329).  Saving model ...
Epoch: 80 cost time: 1.683187484741211
Epoch: 80, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.454 Vali Acc: 0.883 Test Loss: 0.454 Test Acc: 0.883
Validation loss decreased (-0.883329 --> -0.883329).  Saving model ...
Epoch: 81 cost time: 1.5800650119781494
Epoch: 81, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.453 Vali Acc: 0.878 Test Loss: 0.453 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 1.5165750980377197
Epoch: 82, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.439 Vali Acc: 0.878 Test Loss: 0.439 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 1.5273504257202148
Epoch: 83, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.430 Vali Acc: 0.878 Test Loss: 0.430 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 1.5595602989196777
Epoch: 84, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.443 Vali Acc: 0.878 Test Loss: 0.443 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 1.5617928504943848
Epoch: 85, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.473 Vali Acc: 0.872 Test Loss: 0.473 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 1.5499064922332764
Epoch: 86, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.458 Vali Acc: 0.872 Test Loss: 0.458 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 1.4384520053863525
Epoch: 87, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.426 Vali Acc: 0.894 Test Loss: 0.426 Test Acc: 0.894
Validation loss decreased (-0.883329 --> -0.894440).  Saving model ...
Epoch: 88 cost time: 1.68467116355896
Epoch: 88, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.462 Vali Acc: 0.878 Test Loss: 0.462 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 1.6633548736572266
Epoch: 89, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.473 Vali Acc: 0.878 Test Loss: 0.473 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 1.7674014568328857
Epoch: 90, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.447 Vali Acc: 0.883 Test Loss: 0.447 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 1.7001221179962158
Epoch: 91, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.471 Vali Acc: 0.889 Test Loss: 0.471 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 92 cost time: 1.8199551105499268
Epoch: 92, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.523 Vali Acc: 0.872 Test Loss: 0.523 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 93 cost time: 1.5709784030914307
Epoch: 93, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.439 Vali Acc: 0.872 Test Loss: 0.439 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 94 cost time: 1.487264633178711
Epoch: 94, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.468 Vali Acc: 0.883 Test Loss: 0.468 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 95 cost time: 1.798501968383789
Epoch: 95, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.479 Vali Acc: 0.867 Test Loss: 0.479 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 96 cost time: 1.314685344696045
Epoch: 96, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.465 Vali Acc: 0.872 Test Loss: 0.465 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 97 cost time: 1.531113862991333
Epoch: 97, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.459 Vali Acc: 0.889 Test Loss: 0.459 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 174355
model size : 1.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.250283718109131
Epoch: 1, Steps: 12 | Train Loss: 3.032 Vali Loss: 2.927 Vali Acc: 0.106 Test Loss: 2.927 Test Acc: 0.106
Validation loss decreased (inf --> -0.105526).  Saving model ...
Epoch: 2 cost time: 1.3200271129608154
Epoch: 2, Steps: 12 | Train Loss: 2.890 Vali Loss: 2.818 Vali Acc: 0.111 Test Loss: 2.818 Test Acc: 0.111
Validation loss decreased (-0.105526 --> -0.111083).  Saving model ...
Epoch: 3 cost time: 1.4899487495422363
Epoch: 3, Steps: 12 | Train Loss: 2.766 Vali Loss: 2.728 Vali Acc: 0.122 Test Loss: 2.728 Test Acc: 0.122
Validation loss decreased (-0.111083 --> -0.122195).  Saving model ...
Epoch: 4 cost time: 1.1736118793487549
Epoch: 4, Steps: 12 | Train Loss: 2.679 Vali Loss: 2.664 Vali Acc: 0.161 Test Loss: 2.664 Test Acc: 0.161
Validation loss decreased (-0.122195 --> -0.161084).  Saving model ...
Epoch: 5 cost time: 1.3904342651367188
Epoch: 5, Steps: 12 | Train Loss: 2.628 Vali Loss: 2.609 Vali Acc: 0.172 Test Loss: 2.609 Test Acc: 0.172
Validation loss decreased (-0.161084 --> -0.172196).  Saving model ...
Epoch: 6 cost time: 1.1333184242248535
Epoch: 6, Steps: 12 | Train Loss: 2.580 Vali Loss: 2.558 Vali Acc: 0.239 Test Loss: 2.558 Test Acc: 0.239
Validation loss decreased (-0.172196 --> -0.238863).  Saving model ...
Epoch: 7 cost time: 1.3912570476531982
Epoch: 7, Steps: 12 | Train Loss: 2.528 Vali Loss: 2.503 Vali Acc: 0.267 Test Loss: 2.503 Test Acc: 0.267
Validation loss decreased (-0.238863 --> -0.266642).  Saving model ...
Epoch: 8 cost time: 1.277491569519043
Epoch: 8, Steps: 12 | Train Loss: 2.404 Vali Loss: 2.436 Vali Acc: 0.272 Test Loss: 2.436 Test Acc: 0.272
Validation loss decreased (-0.266642 --> -0.272198).  Saving model ...
Epoch: 9 cost time: 1.468501091003418
Epoch: 9, Steps: 12 | Train Loss: 2.342 Vali Loss: 2.357 Vali Acc: 0.272 Test Loss: 2.357 Test Acc: 0.272
Validation loss decreased (-0.272198 --> -0.272199).  Saving model ...
Epoch: 10 cost time: 1.3030705451965332
Epoch: 10, Steps: 12 | Train Loss: 2.245 Vali Loss: 2.272 Vali Acc: 0.322 Test Loss: 2.272 Test Acc: 0.322
Validation loss decreased (-0.272199 --> -0.322200).  Saving model ...
Epoch: 11 cost time: 1.1650886535644531
Epoch: 11, Steps: 12 | Train Loss: 2.111 Vali Loss: 2.179 Vali Acc: 0.378 Test Loss: 2.179 Test Acc: 0.378
Validation loss decreased (-0.322200 --> -0.377756).  Saving model ...
Epoch: 12 cost time: 1.4080123901367188
Epoch: 12, Steps: 12 | Train Loss: 1.987 Vali Loss: 2.087 Vali Acc: 0.406 Test Loss: 2.087 Test Acc: 0.406
Validation loss decreased (-0.377756 --> -0.405535).  Saving model ...
Epoch: 13 cost time: 1.2347748279571533
Epoch: 13, Steps: 12 | Train Loss: 1.880 Vali Loss: 1.989 Vali Acc: 0.489 Test Loss: 1.989 Test Acc: 0.489
Validation loss decreased (-0.405535 --> -0.488869).  Saving model ...
Epoch: 14 cost time: 1.2732963562011719
Epoch: 14, Steps: 12 | Train Loss: 1.781 Vali Loss: 1.891 Vali Acc: 0.517 Test Loss: 1.891 Test Acc: 0.517
Validation loss decreased (-0.488869 --> -0.516648).  Saving model ...
Epoch: 15 cost time: 1.320504903793335
Epoch: 15, Steps: 12 | Train Loss: 1.658 Vali Loss: 1.793 Vali Acc: 0.522 Test Loss: 1.793 Test Acc: 0.522
Validation loss decreased (-0.516648 --> -0.522204).  Saving model ...
Epoch: 16 cost time: 1.363027811050415
Epoch: 16, Steps: 12 | Train Loss: 1.633 Vali Loss: 1.699 Vali Acc: 0.589 Test Loss: 1.699 Test Acc: 0.589
Validation loss decreased (-0.522204 --> -0.588872).  Saving model ...
Epoch: 17 cost time: 1.5138442516326904
Epoch: 17, Steps: 12 | Train Loss: 1.512 Vali Loss: 1.628 Vali Acc: 0.561 Test Loss: 1.628 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3503248691558838
Epoch: 18, Steps: 12 | Train Loss: 1.391 Vali Loss: 1.543 Vali Acc: 0.594 Test Loss: 1.543 Test Acc: 0.594
Validation loss decreased (-0.588872 --> -0.594429).  Saving model ...
Epoch: 19 cost time: 1.3956854343414307
Epoch: 19, Steps: 12 | Train Loss: 1.345 Vali Loss: 1.472 Vali Acc: 0.628 Test Loss: 1.472 Test Acc: 0.628
Validation loss decreased (-0.594429 --> -0.627763).  Saving model ...
Epoch: 20 cost time: 1.35965895652771
Epoch: 20, Steps: 12 | Train Loss: 1.277 Vali Loss: 1.402 Vali Acc: 0.644 Test Loss: 1.402 Test Acc: 0.644
Validation loss decreased (-0.627763 --> -0.644430).  Saving model ...
Epoch: 21 cost time: 1.272653341293335
Epoch: 21, Steps: 12 | Train Loss: 1.177 Vali Loss: 1.331 Vali Acc: 0.633 Test Loss: 1.331 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.292661190032959
Epoch: 22, Steps: 12 | Train Loss: 1.126 Vali Loss: 1.271 Vali Acc: 0.683 Test Loss: 1.271 Test Acc: 0.683
Validation loss decreased (-0.644430 --> -0.683321).  Saving model ...
Epoch: 23 cost time: 1.3020293712615967
Epoch: 23, Steps: 12 | Train Loss: 1.061 Vali Loss: 1.196 Vali Acc: 0.706 Test Loss: 1.196 Test Acc: 0.706
Validation loss decreased (-0.683321 --> -0.705544).  Saving model ...
Epoch: 24 cost time: 1.2172060012817383
Epoch: 24, Steps: 12 | Train Loss: 0.986 Vali Loss: 1.129 Vali Acc: 0.711 Test Loss: 1.129 Test Acc: 0.711
Validation loss decreased (-0.705544 --> -0.711100).  Saving model ...
Epoch: 25 cost time: 1.2354967594146729
Epoch: 25, Steps: 12 | Train Loss: 0.947 Vali Loss: 1.094 Vali Acc: 0.733 Test Loss: 1.094 Test Acc: 0.733
Validation loss decreased (-0.711100 --> -0.733322).  Saving model ...
Epoch: 26 cost time: 1.1523714065551758
Epoch: 26, Steps: 12 | Train Loss: 0.870 Vali Loss: 1.041 Vali Acc: 0.733 Test Loss: 1.041 Test Acc: 0.733
Validation loss decreased (-0.733322 --> -0.733323).  Saving model ...
Epoch: 27 cost time: 1.4009809494018555
Epoch: 27, Steps: 12 | Train Loss: 0.826 Vali Loss: 0.979 Vali Acc: 0.733 Test Loss: 0.979 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733324).  Saving model ...
Epoch: 28 cost time: 1.4128601551055908
Epoch: 28, Steps: 12 | Train Loss: 0.789 Vali Loss: 0.927 Vali Acc: 0.756 Test Loss: 0.927 Test Acc: 0.756
Validation loss decreased (-0.733324 --> -0.755546).  Saving model ...
Epoch: 29 cost time: 1.1549272537231445
Epoch: 29, Steps: 12 | Train Loss: 0.702 Vali Loss: 0.884 Vali Acc: 0.744 Test Loss: 0.884 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2088329792022705
Epoch: 30, Steps: 12 | Train Loss: 0.658 Vali Loss: 0.845 Vali Acc: 0.778 Test Loss: 0.845 Test Acc: 0.778
Validation loss decreased (-0.755546 --> -0.777769).  Saving model ...
Epoch: 31 cost time: 1.3274047374725342
Epoch: 31, Steps: 12 | Train Loss: 0.622 Vali Loss: 0.795 Vali Acc: 0.778 Test Loss: 0.795 Test Acc: 0.778
Validation loss decreased (-0.777769 --> -0.777770).  Saving model ...
Epoch: 32 cost time: 1.1277132034301758
Epoch: 32, Steps: 12 | Train Loss: 0.559 Vali Loss: 0.762 Vali Acc: 0.800 Test Loss: 0.762 Test Acc: 0.800
Validation loss decreased (-0.777770 --> -0.799992).  Saving model ...
Epoch: 33 cost time: 1.466421365737915
Epoch: 33, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.726 Vali Acc: 0.789 Test Loss: 0.726 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.208357334136963
Epoch: 34, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.692 Vali Acc: 0.800 Test Loss: 0.692 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 35 cost time: 1.3253355026245117
Epoch: 35, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.676 Vali Acc: 0.811 Test Loss: 0.676 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811104).  Saving model ...
Epoch: 36 cost time: 1.349686861038208
Epoch: 36, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.639 Vali Acc: 0.806 Test Loss: 0.639 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.3289473056793213
Epoch: 37, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.622 Vali Acc: 0.817 Test Loss: 0.622 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816660).  Saving model ...
Epoch: 38 cost time: 1.2763030529022217
Epoch: 38, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.606 Vali Acc: 0.822 Test Loss: 0.606 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 39 cost time: 1.6704022884368896
Epoch: 39, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.592 Vali Acc: 0.811 Test Loss: 0.592 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.071195125579834
Epoch: 40, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.550 Vali Acc: 0.833 Test Loss: 0.550 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833328).  Saving model ...
Epoch: 41 cost time: 1.1956329345703125
Epoch: 41, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.533 Vali Acc: 0.828 Test Loss: 0.533 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1096389293670654
Epoch: 42, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.503 Vali Acc: 0.833 Test Loss: 0.503 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 43 cost time: 1.2150309085845947
Epoch: 43, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.497 Vali Acc: 0.839 Test Loss: 0.497 Test Acc: 0.839
Validation loss decreased (-0.833328 --> -0.838884).  Saving model ...
Epoch: 44 cost time: 1.1936976909637451
Epoch: 44, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.512 Vali Acc: 0.850 Test Loss: 0.512 Test Acc: 0.850
Validation loss decreased (-0.838884 --> -0.849995).  Saving model ...
Epoch: 45 cost time: 1.4089303016662598
Epoch: 45, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.501 Vali Acc: 0.850 Test Loss: 0.501 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 46 cost time: 1.2997703552246094
Epoch: 46, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.460 Vali Acc: 0.872 Test Loss: 0.460 Test Acc: 0.872
Validation loss decreased (-0.849995 --> -0.872218).  Saving model ...
Epoch: 47 cost time: 1.3858497142791748
Epoch: 47, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.459 Vali Acc: 0.867 Test Loss: 0.459 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.6800217628479004
Epoch: 48, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.445 Vali Acc: 0.861 Test Loss: 0.445 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.4900543689727783
Epoch: 49, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.448 Vali Acc: 0.850 Test Loss: 0.448 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.2794408798217773
Epoch: 50, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.459 Vali Acc: 0.856 Test Loss: 0.459 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.2786085605621338
Epoch: 51, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.443 Vali Acc: 0.856 Test Loss: 0.443 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.6132237911224365
Epoch: 52, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.413 Vali Acc: 0.872 Test Loss: 0.413 Test Acc: 0.872
Validation loss decreased (-0.872218 --> -0.872218).  Saving model ...
Epoch: 53 cost time: 1.3093957901000977
Epoch: 53, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.422 Vali Acc: 0.872 Test Loss: 0.422 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.2037510871887207
Epoch: 54, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.422 Vali Acc: 0.861 Test Loss: 0.422 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.5891094207763672
Epoch: 55, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.415 Vali Acc: 0.872 Test Loss: 0.415 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.4256534576416016
Epoch: 56, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.395 Vali Acc: 0.872 Test Loss: 0.395 Test Acc: 0.872
Validation loss decreased (-0.872218 --> -0.872218).  Saving model ...
Epoch: 57 cost time: 1.6297123432159424
Epoch: 57, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.420 Vali Acc: 0.878 Test Loss: 0.420 Test Acc: 0.878
Validation loss decreased (-0.872218 --> -0.877774).  Saving model ...
Epoch: 58 cost time: 1.3403186798095703
Epoch: 58, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.400 Vali Acc: 0.883 Test Loss: 0.400 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883329).  Saving model ...
Epoch: 59 cost time: 1.3100619316101074
Epoch: 59, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.406 Vali Acc: 0.872 Test Loss: 0.406 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.5000090599060059
Epoch: 60, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.381 Vali Acc: 0.878 Test Loss: 0.381 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.4014499187469482
Epoch: 61, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.400 Vali Acc: 0.883 Test Loss: 0.400 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.2497434616088867
Epoch: 62, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.405 Vali Acc: 0.883 Test Loss: 0.405 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.383873462677002
Epoch: 63, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.403 Vali Acc: 0.889 Test Loss: 0.403 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888885).  Saving model ...
Epoch: 64 cost time: 1.4435124397277832
Epoch: 64, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.422 Vali Acc: 0.883 Test Loss: 0.422 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.5026628971099854
Epoch: 65, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.397 Vali Acc: 0.878 Test Loss: 0.397 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.6955885887145996
Epoch: 66, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.412 Vali Acc: 0.872 Test Loss: 0.412 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 1.5315887928009033
Epoch: 67, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.385 Vali Acc: 0.878 Test Loss: 0.385 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 1.3682668209075928
Epoch: 68, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.412 Vali Acc: 0.878 Test Loss: 0.412 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 1.3473873138427734
Epoch: 69, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.400 Vali Acc: 0.883 Test Loss: 0.400 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 1.2797987461090088
Epoch: 70, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.386 Vali Acc: 0.889 Test Loss: 0.386 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 71 cost time: 1.5797600746154785
Epoch: 71, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.409 Vali Acc: 0.878 Test Loss: 0.409 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.345001220703125
Epoch: 72, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.391 Vali Acc: 0.889 Test Loss: 0.391 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.2354896068572998
Epoch: 73, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.403 Vali Acc: 0.883 Test Loss: 0.403 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 1.343902587890625
Epoch: 74, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.392 Vali Acc: 0.872 Test Loss: 0.392 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 1.4389445781707764
Epoch: 75, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.384 Vali Acc: 0.878 Test Loss: 0.384 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 1.501645803451538
Epoch: 76, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.410 Vali Acc: 0.872 Test Loss: 0.410 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 1.2780494689941406
Epoch: 77, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.415 Vali Acc: 0.867 Test Loss: 0.415 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 1.2939403057098389
Epoch: 78, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.403 Vali Acc: 0.883 Test Loss: 0.403 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 1.4222652912139893
Epoch: 79, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.439 Vali Acc: 0.883 Test Loss: 0.439 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 80 cost time: 1.2738642692565918
Epoch: 80, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.419 Vali Acc: 0.872 Test Loss: 0.419 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 174163
model size : 1.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.162548780441284
Epoch: 1, Steps: 12 | Train Loss: 2.901 Vali Loss: 2.814 Vali Acc: 0.072 Test Loss: 2.814 Test Acc: 0.072
Validation loss decreased (inf --> -0.072194).  Saving model ...
Epoch: 2 cost time: 1.2496049404144287
Epoch: 2, Steps: 12 | Train Loss: 2.832 Vali Loss: 2.734 Vali Acc: 0.089 Test Loss: 2.734 Test Acc: 0.089
Validation loss decreased (-0.072194 --> -0.088862).  Saving model ...
Epoch: 3 cost time: 1.2929577827453613
Epoch: 3, Steps: 12 | Train Loss: 2.736 Vali Loss: 2.671 Vali Acc: 0.111 Test Loss: 2.671 Test Acc: 0.111
Validation loss decreased (-0.088862 --> -0.111084).  Saving model ...
Epoch: 4 cost time: 1.1027462482452393
Epoch: 4, Steps: 12 | Train Loss: 2.697 Vali Loss: 2.627 Vali Acc: 0.172 Test Loss: 2.627 Test Acc: 0.172
Validation loss decreased (-0.111084 --> -0.172196).  Saving model ...
Epoch: 5 cost time: 1.4360404014587402
Epoch: 5, Steps: 12 | Train Loss: 2.596 Vali Loss: 2.589 Vali Acc: 0.189 Test Loss: 2.589 Test Acc: 0.189
Validation loss decreased (-0.172196 --> -0.188863).  Saving model ...
Epoch: 6 cost time: 1.2913429737091064
Epoch: 6, Steps: 12 | Train Loss: 2.545 Vali Loss: 2.543 Vali Acc: 0.267 Test Loss: 2.543 Test Acc: 0.267
Validation loss decreased (-0.188863 --> -0.266641).  Saving model ...
Epoch: 7 cost time: 1.3124361038208008
Epoch: 7, Steps: 12 | Train Loss: 2.490 Vali Loss: 2.486 Vali Acc: 0.333 Test Loss: 2.486 Test Acc: 0.333
Validation loss decreased (-0.266641 --> -0.333308).  Saving model ...
Epoch: 8 cost time: 1.19478178024292
Epoch: 8, Steps: 12 | Train Loss: 2.429 Vali Loss: 2.413 Vali Acc: 0.378 Test Loss: 2.413 Test Acc: 0.378
Validation loss decreased (-0.333308 --> -0.377754).  Saving model ...
Epoch: 9 cost time: 1.190399408340454
Epoch: 9, Steps: 12 | Train Loss: 2.294 Vali Loss: 2.330 Vali Acc: 0.383 Test Loss: 2.330 Test Acc: 0.383
Validation loss decreased (-0.377754 --> -0.383310).  Saving model ...
Epoch: 10 cost time: 1.0935895442962646
Epoch: 10, Steps: 12 | Train Loss: 2.192 Vali Loss: 2.233 Vali Acc: 0.406 Test Loss: 2.233 Test Acc: 0.406
Validation loss decreased (-0.383310 --> -0.405533).  Saving model ...
Epoch: 11 cost time: 1.1824936866760254
Epoch: 11, Steps: 12 | Train Loss: 2.026 Vali Loss: 2.123 Vali Acc: 0.450 Test Loss: 2.123 Test Acc: 0.450
Validation loss decreased (-0.405533 --> -0.449979).  Saving model ...
Epoch: 12 cost time: 1.2120165824890137
Epoch: 12, Steps: 12 | Train Loss: 1.999 Vali Loss: 2.031 Vali Acc: 0.494 Test Loss: 2.031 Test Acc: 0.494
Validation loss decreased (-0.449979 --> -0.494424).  Saving model ...
Epoch: 13 cost time: 1.3206593990325928
Epoch: 13, Steps: 12 | Train Loss: 1.847 Vali Loss: 1.934 Vali Acc: 0.522 Test Loss: 1.934 Test Acc: 0.522
Validation loss decreased (-0.494424 --> -0.522203).  Saving model ...
Epoch: 14 cost time: 1.2035226821899414
Epoch: 14, Steps: 12 | Train Loss: 1.726 Vali Loss: 1.832 Vali Acc: 0.556 Test Loss: 1.832 Test Acc: 0.556
Validation loss decreased (-0.522203 --> -0.555537).  Saving model ...
Epoch: 15 cost time: 1.3935332298278809
Epoch: 15, Steps: 12 | Train Loss: 1.653 Vali Loss: 1.753 Vali Acc: 0.550 Test Loss: 1.753 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3359897136688232
Epoch: 16, Steps: 12 | Train Loss: 1.522 Vali Loss: 1.677 Vali Acc: 0.550 Test Loss: 1.677 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4104804992675781
Epoch: 17, Steps: 12 | Train Loss: 1.413 Vali Loss: 1.591 Vali Acc: 0.572 Test Loss: 1.591 Test Acc: 0.572
Validation loss decreased (-0.555537 --> -0.572206).  Saving model ...
Epoch: 18 cost time: 1.3454313278198242
Epoch: 18, Steps: 12 | Train Loss: 1.339 Vali Loss: 1.511 Vali Acc: 0.589 Test Loss: 1.511 Test Acc: 0.589
Validation loss decreased (-0.572206 --> -0.588874).  Saving model ...
Epoch: 19 cost time: 1.3434476852416992
Epoch: 19, Steps: 12 | Train Loss: 1.296 Vali Loss: 1.434 Vali Acc: 0.583 Test Loss: 1.434 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3570005893707275
Epoch: 20, Steps: 12 | Train Loss: 1.216 Vali Loss: 1.349 Vali Acc: 0.622 Test Loss: 1.349 Test Acc: 0.622
Validation loss decreased (-0.588874 --> -0.622209).  Saving model ...
Epoch: 21 cost time: 1.3972735404968262
Epoch: 21, Steps: 12 | Train Loss: 1.118 Vali Loss: 1.290 Vali Acc: 0.633 Test Loss: 1.290 Test Acc: 0.633
Validation loss decreased (-0.622209 --> -0.633320).  Saving model ...
Epoch: 22 cost time: 1.325798749923706
Epoch: 22, Steps: 12 | Train Loss: 1.075 Vali Loss: 1.225 Vali Acc: 0.644 Test Loss: 1.225 Test Acc: 0.644
Validation loss decreased (-0.633320 --> -0.644432).  Saving model ...
Epoch: 23 cost time: 1.2139902114868164
Epoch: 23, Steps: 12 | Train Loss: 0.998 Vali Loss: 1.162 Vali Acc: 0.678 Test Loss: 1.162 Test Acc: 0.678
Validation loss decreased (-0.644432 --> -0.677766).  Saving model ...
Epoch: 24 cost time: 1.4594409465789795
Epoch: 24, Steps: 12 | Train Loss: 0.940 Vali Loss: 1.101 Vali Acc: 0.700 Test Loss: 1.101 Test Acc: 0.700
Validation loss decreased (-0.677766 --> -0.699989).  Saving model ...
Epoch: 25 cost time: 1.3986077308654785
Epoch: 25, Steps: 12 | Train Loss: 0.898 Vali Loss: 1.044 Vali Acc: 0.722 Test Loss: 1.044 Test Acc: 0.722
Validation loss decreased (-0.699989 --> -0.722212).  Saving model ...
Epoch: 26 cost time: 1.4352715015411377
Epoch: 26, Steps: 12 | Train Loss: 0.846 Vali Loss: 0.970 Vali Acc: 0.756 Test Loss: 0.970 Test Acc: 0.756
Validation loss decreased (-0.722212 --> -0.755546).  Saving model ...
Epoch: 27 cost time: 1.3174855709075928
Epoch: 27, Steps: 12 | Train Loss: 0.798 Vali Loss: 0.965 Vali Acc: 0.756 Test Loss: 0.965 Test Acc: 0.756
Validation loss decreased (-0.755546 --> -0.755546).  Saving model ...
Epoch: 28 cost time: 1.4434709548950195
Epoch: 28, Steps: 12 | Train Loss: 0.726 Vali Loss: 0.878 Vali Acc: 0.783 Test Loss: 0.878 Test Acc: 0.783
Validation loss decreased (-0.755546 --> -0.783325).  Saving model ...
Epoch: 29 cost time: 1.1683611869812012
Epoch: 29, Steps: 12 | Train Loss: 0.678 Vali Loss: 0.847 Vali Acc: 0.811 Test Loss: 0.847 Test Acc: 0.811
Validation loss decreased (-0.783325 --> -0.811103).  Saving model ...
Epoch: 30 cost time: 1.2475059032440186
Epoch: 30, Steps: 12 | Train Loss: 0.640 Vali Loss: 0.849 Vali Acc: 0.789 Test Loss: 0.849 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0966038703918457
Epoch: 31, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.798 Vali Acc: 0.789 Test Loss: 0.798 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.4156250953674316
Epoch: 32, Steps: 12 | Train Loss: 0.562 Vali Loss: 0.752 Vali Acc: 0.811 Test Loss: 0.752 Test Acc: 0.811
Validation loss decreased (-0.811103 --> -0.811104).  Saving model ...
Epoch: 33 cost time: 1.1412937641143799
Epoch: 33, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.737 Vali Acc: 0.828 Test Loss: 0.737 Test Acc: 0.828
Validation loss decreased (-0.811104 --> -0.827770).  Saving model ...
Epoch: 34 cost time: 1.4149065017700195
Epoch: 34, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.685 Vali Acc: 0.817 Test Loss: 0.685 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2204439640045166
Epoch: 35, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.718 Vali Acc: 0.800 Test Loss: 0.718 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2206099033355713
Epoch: 36, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.644 Vali Acc: 0.828 Test Loss: 0.644 Test Acc: 0.828
Validation loss decreased (-0.827770 --> -0.827771).  Saving model ...
Epoch: 37 cost time: 1.2823376655578613
Epoch: 37, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.627 Vali Acc: 0.839 Test Loss: 0.627 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838883).  Saving model ...
Epoch: 38 cost time: 1.1225593090057373
Epoch: 38, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.586 Vali Acc: 0.856 Test Loss: 0.586 Test Acc: 0.856
Validation loss decreased (-0.838883 --> -0.855550).  Saving model ...
Epoch: 39 cost time: 1.3605000972747803
Epoch: 39, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.627 Vali Acc: 0.844 Test Loss: 0.627 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.3643171787261963
Epoch: 40, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.596 Vali Acc: 0.850 Test Loss: 0.596 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.2594666481018066
Epoch: 41, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.578 Vali Acc: 0.861 Test Loss: 0.578 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 42 cost time: 1.4601173400878906
Epoch: 42, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.556 Vali Acc: 0.844 Test Loss: 0.556 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.2946083545684814
Epoch: 43, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.547 Vali Acc: 0.839 Test Loss: 0.547 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.3431808948516846
Epoch: 44, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.554 Vali Acc: 0.867 Test Loss: 0.554 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 45 cost time: 1.3078889846801758
Epoch: 45, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.535 Vali Acc: 0.867 Test Loss: 0.535 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 46 cost time: 1.1259922981262207
Epoch: 46, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.518 Vali Acc: 0.867 Test Loss: 0.518 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 47 cost time: 1.7373719215393066
Epoch: 47, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.475 Vali Acc: 0.856 Test Loss: 0.475 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.2275280952453613
Epoch: 48, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.526 Vali Acc: 0.850 Test Loss: 0.526 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.2422311305999756
Epoch: 49, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.489 Vali Acc: 0.850 Test Loss: 0.489 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.2980151176452637
Epoch: 50, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.469 Vali Acc: 0.861 Test Loss: 0.469 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.3181922435760498
Epoch: 51, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.475 Vali Acc: 0.861 Test Loss: 0.475 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.1805427074432373
Epoch: 52, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.428 Vali Acc: 0.861 Test Loss: 0.428 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.335209608078003
Epoch: 53, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.442 Vali Acc: 0.861 Test Loss: 0.442 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.3116552829742432
Epoch: 54, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.482 Vali Acc: 0.861 Test Loss: 0.482 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.2180719375610352
Epoch: 55, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.471 Vali Acc: 0.878 Test Loss: 0.471 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877773).  Saving model ...
Epoch: 56 cost time: 1.1648695468902588
Epoch: 56, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.453 Vali Acc: 0.867 Test Loss: 0.453 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.1212258338928223
Epoch: 57, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.450 Vali Acc: 0.878 Test Loss: 0.450 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 58 cost time: 1.1648602485656738
Epoch: 58, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.476 Vali Acc: 0.867 Test Loss: 0.476 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.2494335174560547
Epoch: 59, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.471 Vali Acc: 0.861 Test Loss: 0.471 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.2756435871124268
Epoch: 60, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.442 Vali Acc: 0.878 Test Loss: 0.442 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 61 cost time: 1.1578240394592285
Epoch: 61, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.470 Vali Acc: 0.867 Test Loss: 0.470 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.3548266887664795
Epoch: 62, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.473 Vali Acc: 0.867 Test Loss: 0.473 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.3105380535125732
Epoch: 63, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.484 Vali Acc: 0.872 Test Loss: 0.484 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.4213733673095703
Epoch: 64, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.470 Vali Acc: 0.861 Test Loss: 0.470 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 1.379082441329956
Epoch: 65, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.436 Vali Acc: 0.883 Test Loss: 0.436 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883329).  Saving model ...
Epoch: 66 cost time: 1.2908375263214111
Epoch: 66, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.478 Vali Acc: 0.878 Test Loss: 0.478 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.3134474754333496
Epoch: 67, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.494 Vali Acc: 0.867 Test Loss: 0.494 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.161515712738037
Epoch: 68, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.486 Vali Acc: 0.878 Test Loss: 0.486 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.253258228302002
Epoch: 69, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.524 Vali Acc: 0.867 Test Loss: 0.524 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.203322410583496
Epoch: 70, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.501 Vali Acc: 0.872 Test Loss: 0.501 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.3908987045288086
Epoch: 71, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.511 Vali Acc: 0.878 Test Loss: 0.511 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 1.2331364154815674
Epoch: 72, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.493 Vali Acc: 0.867 Test Loss: 0.493 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 1.302502155303955
Epoch: 73, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.467 Vali Acc: 0.861 Test Loss: 0.467 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 1.3120837211608887
Epoch: 74, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.509 Vali Acc: 0.861 Test Loss: 0.509 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 1.046802282333374
Epoch: 75, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.505 Vali Acc: 0.878 Test Loss: 0.505 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 173971
model size : 1.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7563343048095703
Epoch: 1, Steps: 12 | Train Loss: 2.848 Vali Loss: 2.790 Vali Acc: 0.133 Test Loss: 2.790 Test Acc: 0.133
Validation loss decreased (inf --> -0.133305).  Saving model ...
Epoch: 2 cost time: 1.147486686706543
Epoch: 2, Steps: 12 | Train Loss: 2.787 Vali Loss: 2.720 Vali Acc: 0.128 Test Loss: 2.720 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1534950733184814
Epoch: 3, Steps: 12 | Train Loss: 2.721 Vali Loss: 2.660 Vali Acc: 0.133 Test Loss: 2.660 Test Acc: 0.133
Validation loss decreased (-0.133305 --> -0.133307).  Saving model ...
Epoch: 4 cost time: 1.3133718967437744
Epoch: 4, Steps: 12 | Train Loss: 2.711 Vali Loss: 2.618 Vali Acc: 0.206 Test Loss: 2.618 Test Acc: 0.206
Validation loss decreased (-0.133307 --> -0.205529).  Saving model ...
Epoch: 5 cost time: 1.2938528060913086
Epoch: 5, Steps: 12 | Train Loss: 2.658 Vali Loss: 2.582 Vali Acc: 0.228 Test Loss: 2.582 Test Acc: 0.228
Validation loss decreased (-0.205529 --> -0.227752).  Saving model ...
Epoch: 6 cost time: 1.2751774787902832
Epoch: 6, Steps: 12 | Train Loss: 2.584 Vali Loss: 2.536 Vali Acc: 0.239 Test Loss: 2.536 Test Acc: 0.239
Validation loss decreased (-0.227752 --> -0.238864).  Saving model ...
Epoch: 7 cost time: 1.3507583141326904
Epoch: 7, Steps: 12 | Train Loss: 2.556 Vali Loss: 2.488 Vali Acc: 0.289 Test Loss: 2.488 Test Acc: 0.289
Validation loss decreased (-0.238864 --> -0.288864).  Saving model ...
Epoch: 8 cost time: 1.2937564849853516
Epoch: 8, Steps: 12 | Train Loss: 2.481 Vali Loss: 2.432 Vali Acc: 0.339 Test Loss: 2.432 Test Acc: 0.339
Validation loss decreased (-0.288864 --> -0.338865).  Saving model ...
Epoch: 9 cost time: 1.1294560432434082
Epoch: 9, Steps: 12 | Train Loss: 2.467 Vali Loss: 2.353 Vali Acc: 0.339 Test Loss: 2.353 Test Acc: 0.339
Validation loss decreased (-0.338865 --> -0.338865).  Saving model ...
Epoch: 10 cost time: 1.0882532596588135
Epoch: 10, Steps: 12 | Train Loss: 2.291 Vali Loss: 2.273 Vali Acc: 0.372 Test Loss: 2.273 Test Acc: 0.372
Validation loss decreased (-0.338865 --> -0.372199).  Saving model ...
Epoch: 11 cost time: 1.1260383129119873
Epoch: 11, Steps: 12 | Train Loss: 2.213 Vali Loss: 2.180 Vali Acc: 0.400 Test Loss: 2.180 Test Acc: 0.400
Validation loss decreased (-0.372199 --> -0.399978).  Saving model ...
Epoch: 12 cost time: 1.3370981216430664
Epoch: 12, Steps: 12 | Train Loss: 2.098 Vali Loss: 2.067 Vali Acc: 0.428 Test Loss: 2.067 Test Acc: 0.428
Validation loss decreased (-0.399978 --> -0.427757).  Saving model ...
Epoch: 13 cost time: 1.1606619358062744
Epoch: 13, Steps: 12 | Train Loss: 1.986 Vali Loss: 1.963 Vali Acc: 0.500 Test Loss: 1.963 Test Acc: 0.500
Validation loss decreased (-0.427757 --> -0.499980).  Saving model ...
Epoch: 14 cost time: 1.2451603412628174
Epoch: 14, Steps: 12 | Train Loss: 1.853 Vali Loss: 1.860 Vali Acc: 0.533 Test Loss: 1.860 Test Acc: 0.533
Validation loss decreased (-0.499980 --> -0.533315).  Saving model ...
Epoch: 15 cost time: 1.272172212600708
Epoch: 15, Steps: 12 | Train Loss: 1.694 Vali Loss: 1.759 Vali Acc: 0.578 Test Loss: 1.759 Test Acc: 0.578
Validation loss decreased (-0.533315 --> -0.577760).  Saving model ...
Epoch: 16 cost time: 1.2703540325164795
Epoch: 16, Steps: 12 | Train Loss: 1.590 Vali Loss: 1.669 Vali Acc: 0.628 Test Loss: 1.669 Test Acc: 0.628
Validation loss decreased (-0.577760 --> -0.627761).  Saving model ...
Epoch: 17 cost time: 1.178900957107544
Epoch: 17, Steps: 12 | Train Loss: 1.504 Vali Loss: 1.565 Vali Acc: 0.639 Test Loss: 1.565 Test Acc: 0.639
Validation loss decreased (-0.627761 --> -0.638873).  Saving model ...
Epoch: 18 cost time: 1.1812281608581543
Epoch: 18, Steps: 12 | Train Loss: 1.397 Vali Loss: 1.473 Vali Acc: 0.661 Test Loss: 1.473 Test Acc: 0.661
Validation loss decreased (-0.638873 --> -0.661096).  Saving model ...
Epoch: 19 cost time: 1.0709497928619385
Epoch: 19, Steps: 12 | Train Loss: 1.310 Vali Loss: 1.393 Vali Acc: 0.678 Test Loss: 1.393 Test Acc: 0.678
Validation loss decreased (-0.661096 --> -0.677764).  Saving model ...
Epoch: 20 cost time: 1.1466467380523682
Epoch: 20, Steps: 12 | Train Loss: 1.213 Vali Loss: 1.306 Vali Acc: 0.672 Test Loss: 1.306 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4397859573364258
Epoch: 21, Steps: 12 | Train Loss: 1.106 Vali Loss: 1.236 Vali Acc: 0.694 Test Loss: 1.236 Test Acc: 0.694
Validation loss decreased (-0.677764 --> -0.694432).  Saving model ...
Epoch: 22 cost time: 1.2980399131774902
Epoch: 22, Steps: 12 | Train Loss: 1.038 Vali Loss: 1.179 Vali Acc: 0.706 Test Loss: 1.179 Test Acc: 0.706
Validation loss decreased (-0.694432 --> -0.705544).  Saving model ...
Epoch: 23 cost time: 1.28450608253479
Epoch: 23, Steps: 12 | Train Loss: 0.980 Vali Loss: 1.120 Vali Acc: 0.717 Test Loss: 1.120 Test Acc: 0.717
Validation loss decreased (-0.705544 --> -0.716655).  Saving model ...
Epoch: 24 cost time: 1.2467076778411865
Epoch: 24, Steps: 12 | Train Loss: 0.923 Vali Loss: 1.073 Vali Acc: 0.722 Test Loss: 1.073 Test Acc: 0.722
Validation loss decreased (-0.716655 --> -0.722211).  Saving model ...
Epoch: 25 cost time: 1.1459555625915527
Epoch: 25, Steps: 12 | Train Loss: 0.873 Vali Loss: 1.006 Vali Acc: 0.728 Test Loss: 1.006 Test Acc: 0.728
Validation loss decreased (-0.722211 --> -0.727768).  Saving model ...
Epoch: 26 cost time: 1.106252908706665
Epoch: 26, Steps: 12 | Train Loss: 0.842 Vali Loss: 0.955 Vali Acc: 0.722 Test Loss: 0.955 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3298859596252441
Epoch: 27, Steps: 12 | Train Loss: 0.772 Vali Loss: 0.912 Vali Acc: 0.744 Test Loss: 0.912 Test Acc: 0.744
Validation loss decreased (-0.727768 --> -0.744435).  Saving model ...
Epoch: 28 cost time: 1.1219103336334229
Epoch: 28, Steps: 12 | Train Loss: 0.683 Vali Loss: 0.868 Vali Acc: 0.772 Test Loss: 0.868 Test Acc: 0.772
Validation loss decreased (-0.744435 --> -0.772214).  Saving model ...
Epoch: 29 cost time: 1.2887482643127441
Epoch: 29, Steps: 12 | Train Loss: 0.652 Vali Loss: 0.838 Vali Acc: 0.772 Test Loss: 0.838 Test Acc: 0.772
Validation loss decreased (-0.772214 --> -0.772214).  Saving model ...
Epoch: 30 cost time: 1.1081831455230713
Epoch: 30, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.824 Vali Acc: 0.772 Test Loss: 0.824 Test Acc: 0.772
Validation loss decreased (-0.772214 --> -0.772214).  Saving model ...
Epoch: 31 cost time: 1.3267860412597656
Epoch: 31, Steps: 12 | Train Loss: 0.612 Vali Loss: 0.769 Vali Acc: 0.794 Test Loss: 0.769 Test Acc: 0.794
Validation loss decreased (-0.772214 --> -0.794437).  Saving model ...
Epoch: 32 cost time: 1.2209875583648682
Epoch: 32, Steps: 12 | Train Loss: 0.592 Vali Loss: 0.757 Vali Acc: 0.778 Test Loss: 0.757 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1107382774353027
Epoch: 33, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.721 Vali Acc: 0.794 Test Loss: 0.721 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794437).  Saving model ...
Epoch: 34 cost time: 1.119917631149292
Epoch: 34, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.725 Vali Acc: 0.783 Test Loss: 0.725 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0684425830841064
Epoch: 35, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.673 Vali Acc: 0.794 Test Loss: 0.673 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794438).  Saving model ...
Epoch: 36 cost time: 1.037336826324463
Epoch: 36, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.658 Vali Acc: 0.811 Test Loss: 0.658 Test Acc: 0.811
Validation loss decreased (-0.794438 --> -0.811105).  Saving model ...
Epoch: 37 cost time: 1.1642885208129883
Epoch: 37, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.648 Vali Acc: 0.794 Test Loss: 0.648 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.2708728313446045
Epoch: 38, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.624 Vali Acc: 0.806 Test Loss: 0.624 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.221898078918457
Epoch: 39, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.596 Vali Acc: 0.828 Test Loss: 0.596 Test Acc: 0.828
Validation loss decreased (-0.811105 --> -0.827772).  Saving model ...
Epoch: 40 cost time: 1.4391887187957764
Epoch: 40, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.580 Vali Acc: 0.828 Test Loss: 0.580 Test Acc: 0.828
Validation loss decreased (-0.827772 --> -0.827772).  Saving model ...
Epoch: 41 cost time: 1.211068868637085
Epoch: 41, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.575 Vali Acc: 0.833 Test Loss: 0.575 Test Acc: 0.833
Validation loss decreased (-0.827772 --> -0.833328).  Saving model ...
Epoch: 42 cost time: 1.2878072261810303
Epoch: 42, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.561 Vali Acc: 0.850 Test Loss: 0.561 Test Acc: 0.850
Validation loss decreased (-0.833328 --> -0.849994).  Saving model ...
Epoch: 43 cost time: 1.1346962451934814
Epoch: 43, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.553 Vali Acc: 0.828 Test Loss: 0.553 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.3304808139801025
Epoch: 44, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.534 Vali Acc: 0.828 Test Loss: 0.534 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.1675095558166504
Epoch: 45, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.527 Vali Acc: 0.872 Test Loss: 0.527 Test Acc: 0.872
Validation loss decreased (-0.849994 --> -0.872217).  Saving model ...
Epoch: 46 cost time: 1.3086843490600586
Epoch: 46, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.548 Vali Acc: 0.822 Test Loss: 0.548 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.4430334568023682
Epoch: 47, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.518 Vali Acc: 0.839 Test Loss: 0.518 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.1719861030578613
Epoch: 48, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.504 Vali Acc: 0.867 Test Loss: 0.504 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.0187597274780273
Epoch: 49, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.500 Vali Acc: 0.839 Test Loss: 0.500 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.3092055320739746
Epoch: 50, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.502 Vali Acc: 0.850 Test Loss: 0.502 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.282940149307251
Epoch: 51, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.486 Vali Acc: 0.856 Test Loss: 0.486 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.128830909729004
Epoch: 52, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.465 Vali Acc: 0.856 Test Loss: 0.465 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.2628397941589355
Epoch: 53, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.492 Vali Acc: 0.856 Test Loss: 0.492 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.1698918342590332
Epoch: 54, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.467 Vali Acc: 0.867 Test Loss: 0.467 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.2175965309143066
Epoch: 55, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.474 Vali Acc: 0.861 Test Loss: 0.474 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 173779
model size : 1.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7146034240722656
Epoch: 1, Steps: 12 | Train Loss: 2.803 Vali Loss: 2.767 Vali Acc: 0.111 Test Loss: 2.767 Test Acc: 0.111
Validation loss decreased (inf --> -0.111083).  Saving model ...
Epoch: 2 cost time: 1.2305011749267578
Epoch: 2, Steps: 12 | Train Loss: 2.789 Vali Loss: 2.728 Vali Acc: 0.089 Test Loss: 2.728 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2558701038360596
Epoch: 3, Steps: 12 | Train Loss: 2.744 Vali Loss: 2.687 Vali Acc: 0.117 Test Loss: 2.687 Test Acc: 0.117
Validation loss decreased (-0.111083 --> -0.116640).  Saving model ...
Epoch: 4 cost time: 1.493309497833252
Epoch: 4, Steps: 12 | Train Loss: 2.652 Vali Loss: 2.644 Vali Acc: 0.139 Test Loss: 2.644 Test Acc: 0.139
Validation loss decreased (-0.116640 --> -0.138862).  Saving model ...
Epoch: 5 cost time: 1.213439702987671
Epoch: 5, Steps: 12 | Train Loss: 2.631 Vali Loss: 2.602 Vali Acc: 0.167 Test Loss: 2.602 Test Acc: 0.167
Validation loss decreased (-0.138862 --> -0.166641).  Saving model ...
Epoch: 6 cost time: 1.3376107215881348
Epoch: 6, Steps: 12 | Train Loss: 2.610 Vali Loss: 2.561 Vali Acc: 0.172 Test Loss: 2.561 Test Acc: 0.172
Validation loss decreased (-0.166641 --> -0.172197).  Saving model ...
Epoch: 7 cost time: 1.563817024230957
Epoch: 7, Steps: 12 | Train Loss: 2.500 Vali Loss: 2.508 Vali Acc: 0.233 Test Loss: 2.508 Test Acc: 0.233
Validation loss decreased (-0.172197 --> -0.233308).  Saving model ...
Epoch: 8 cost time: 1.296281099319458
Epoch: 8, Steps: 12 | Train Loss: 2.434 Vali Loss: 2.447 Vali Acc: 0.317 Test Loss: 2.447 Test Acc: 0.317
Validation loss decreased (-0.233308 --> -0.316642).  Saving model ...
Epoch: 9 cost time: 1.9034173488616943
Epoch: 9, Steps: 12 | Train Loss: 2.344 Vali Loss: 2.381 Vali Acc: 0.333 Test Loss: 2.381 Test Acc: 0.333
Validation loss decreased (-0.316642 --> -0.333310).  Saving model ...
Epoch: 10 cost time: 1.3631887435913086
Epoch: 10, Steps: 12 | Train Loss: 2.287 Vali Loss: 2.308 Vali Acc: 0.372 Test Loss: 2.308 Test Acc: 0.372
Validation loss decreased (-0.333310 --> -0.372199).  Saving model ...
Epoch: 11 cost time: 1.2911128997802734
Epoch: 11, Steps: 12 | Train Loss: 2.199 Vali Loss: 2.232 Vali Acc: 0.389 Test Loss: 2.232 Test Acc: 0.389
Validation loss decreased (-0.372199 --> -0.388867).  Saving model ...
Epoch: 12 cost time: 1.1545591354370117
Epoch: 12, Steps: 12 | Train Loss: 2.090 Vali Loss: 2.155 Vali Acc: 0.439 Test Loss: 2.155 Test Acc: 0.439
Validation loss decreased (-0.388867 --> -0.438867).  Saving model ...
Epoch: 13 cost time: 1.2979178428649902
Epoch: 13, Steps: 12 | Train Loss: 2.000 Vali Loss: 2.072 Vali Acc: 0.439 Test Loss: 2.072 Test Acc: 0.439
Validation loss decreased (-0.438867 --> -0.438868).  Saving model ...
Epoch: 14 cost time: 1.3239500522613525
Epoch: 14, Steps: 12 | Train Loss: 1.941 Vali Loss: 1.997 Vali Acc: 0.500 Test Loss: 1.997 Test Acc: 0.500
Validation loss decreased (-0.438868 --> -0.499980).  Saving model ...
Epoch: 15 cost time: 1.1783058643341064
Epoch: 15, Steps: 12 | Train Loss: 1.785 Vali Loss: 1.910 Vali Acc: 0.483 Test Loss: 1.910 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3521783351898193
Epoch: 16, Steps: 12 | Train Loss: 1.733 Vali Loss: 1.827 Vali Acc: 0.511 Test Loss: 1.827 Test Acc: 0.511
Validation loss decreased (-0.499980 --> -0.511093).  Saving model ...
Epoch: 17 cost time: 1.3540072441101074
Epoch: 17, Steps: 12 | Train Loss: 1.631 Vali Loss: 1.760 Vali Acc: 0.528 Test Loss: 1.760 Test Acc: 0.528
Validation loss decreased (-0.511093 --> -0.527760).  Saving model ...
Epoch: 18 cost time: 1.1369822025299072
Epoch: 18, Steps: 12 | Train Loss: 1.520 Vali Loss: 1.671 Vali Acc: 0.550 Test Loss: 1.671 Test Acc: 0.550
Validation loss decreased (-0.527760 --> -0.549983).  Saving model ...
Epoch: 19 cost time: 1.306365728378296
Epoch: 19, Steps: 12 | Train Loss: 1.449 Vali Loss: 1.589 Vali Acc: 0.567 Test Loss: 1.589 Test Acc: 0.567
Validation loss decreased (-0.549983 --> -0.566651).  Saving model ...
Epoch: 20 cost time: 1.0664443969726562
Epoch: 20, Steps: 12 | Train Loss: 1.368 Vali Loss: 1.535 Vali Acc: 0.567 Test Loss: 1.535 Test Acc: 0.567
Validation loss decreased (-0.566651 --> -0.566651).  Saving model ...
Epoch: 21 cost time: 1.3765678405761719
Epoch: 21, Steps: 12 | Train Loss: 1.341 Vali Loss: 1.459 Vali Acc: 0.561 Test Loss: 1.459 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2225196361541748
Epoch: 22, Steps: 12 | Train Loss: 1.206 Vali Loss: 1.397 Vali Acc: 0.594 Test Loss: 1.397 Test Acc: 0.594
Validation loss decreased (-0.566651 --> -0.594430).  Saving model ...
Epoch: 23 cost time: 1.1313819885253906
Epoch: 23, Steps: 12 | Train Loss: 1.194 Vali Loss: 1.338 Vali Acc: 0.628 Test Loss: 1.338 Test Acc: 0.628
Validation loss decreased (-0.594430 --> -0.627764).  Saving model ...
Epoch: 24 cost time: 1.2625582218170166
Epoch: 24, Steps: 12 | Train Loss: 1.084 Vali Loss: 1.303 Vali Acc: 0.611 Test Loss: 1.303 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2110073566436768
Epoch: 25, Steps: 12 | Train Loss: 1.068 Vali Loss: 1.242 Vali Acc: 0.644 Test Loss: 1.242 Test Acc: 0.644
Validation loss decreased (-0.627764 --> -0.644432).  Saving model ...
Epoch: 26 cost time: 1.443769931793213
Epoch: 26, Steps: 12 | Train Loss: 1.066 Vali Loss: 1.182 Vali Acc: 0.639 Test Loss: 1.182 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3527390956878662
Epoch: 27, Steps: 12 | Train Loss: 0.971 Vali Loss: 1.136 Vali Acc: 0.644 Test Loss: 1.136 Test Acc: 0.644
Validation loss decreased (-0.644432 --> -0.644433).  Saving model ...
Epoch: 28 cost time: 1.5019068717956543
Epoch: 28, Steps: 12 | Train Loss: 0.924 Vali Loss: 1.075 Vali Acc: 0.667 Test Loss: 1.075 Test Acc: 0.667
Validation loss decreased (-0.644433 --> -0.666656).  Saving model ...
Epoch: 29 cost time: 1.4473869800567627
Epoch: 29, Steps: 12 | Train Loss: 0.822 Vali Loss: 1.023 Vali Acc: 0.683 Test Loss: 1.023 Test Acc: 0.683
Validation loss decreased (-0.666656 --> -0.683323).  Saving model ...
Epoch: 30 cost time: 1.6667609214782715
Epoch: 30, Steps: 12 | Train Loss: 0.784 Vali Loss: 0.979 Vali Acc: 0.706 Test Loss: 0.979 Test Acc: 0.706
Validation loss decreased (-0.683323 --> -0.705546).  Saving model ...
Epoch: 31 cost time: 1.3524696826934814
Epoch: 31, Steps: 12 | Train Loss: 0.764 Vali Loss: 0.928 Vali Acc: 0.717 Test Loss: 0.928 Test Acc: 0.717
Validation loss decreased (-0.705546 --> -0.716657).  Saving model ...
Epoch: 32 cost time: 1.4001595973968506
Epoch: 32, Steps: 12 | Train Loss: 0.699 Vali Loss: 0.894 Vali Acc: 0.739 Test Loss: 0.894 Test Acc: 0.739
Validation loss decreased (-0.716657 --> -0.738880).  Saving model ...
Epoch: 33 cost time: 1.3933689594268799
Epoch: 33, Steps: 12 | Train Loss: 0.677 Vali Loss: 0.834 Vali Acc: 0.744 Test Loss: 0.834 Test Acc: 0.744
Validation loss decreased (-0.738880 --> -0.744436).  Saving model ...
Epoch: 34 cost time: 1.3251922130584717
Epoch: 34, Steps: 12 | Train Loss: 0.629 Vali Loss: 0.796 Vali Acc: 0.767 Test Loss: 0.796 Test Acc: 0.767
Validation loss decreased (-0.744436 --> -0.766659).  Saving model ...
Epoch: 35 cost time: 1.5344908237457275
Epoch: 35, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.756 Vali Acc: 0.800 Test Loss: 0.756 Test Acc: 0.800
Validation loss decreased (-0.766659 --> -0.799992).  Saving model ...
Epoch: 36 cost time: 1.3473663330078125
Epoch: 36, Steps: 12 | Train Loss: 0.531 Vali Loss: 0.711 Vali Acc: 0.811 Test Loss: 0.711 Test Acc: 0.811
Validation loss decreased (-0.799992 --> -0.811104).  Saving model ...
Epoch: 37 cost time: 1.575080156326294
Epoch: 37, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.684 Vali Acc: 0.794 Test Loss: 0.684 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.3452517986297607
Epoch: 38, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.675 Vali Acc: 0.828 Test Loss: 0.675 Test Acc: 0.828
Validation loss decreased (-0.811104 --> -0.827771).  Saving model ...
Epoch: 39 cost time: 1.340264081954956
Epoch: 39, Steps: 12 | Train Loss: 0.440 Vali Loss: 0.651 Vali Acc: 0.844 Test Loss: 0.651 Test Acc: 0.844
Validation loss decreased (-0.827771 --> -0.844438).  Saving model ...
Epoch: 40 cost time: 1.299515962600708
Epoch: 40, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.620 Vali Acc: 0.817 Test Loss: 0.620 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.5940561294555664
Epoch: 41, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.587 Vali Acc: 0.817 Test Loss: 0.587 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.438457727432251
Epoch: 42, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.582 Vali Acc: 0.822 Test Loss: 0.582 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.1901628971099854
Epoch: 43, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.592 Vali Acc: 0.839 Test Loss: 0.592 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.6083381175994873
Epoch: 44, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.551 Vali Acc: 0.833 Test Loss: 0.551 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.0998213291168213
Epoch: 45, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.561 Vali Acc: 0.844 Test Loss: 0.561 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844439).  Saving model ...
Epoch: 46 cost time: 1.3556020259857178
Epoch: 46, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.518 Vali Acc: 0.856 Test Loss: 0.518 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 47 cost time: 1.2585678100585938
Epoch: 47, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.517 Vali Acc: 0.850 Test Loss: 0.517 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.229935884475708
Epoch: 48, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.496 Vali Acc: 0.856 Test Loss: 0.496 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855551).  Saving model ...
Epoch: 49 cost time: 1.339125394821167
Epoch: 49, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.485 Vali Acc: 0.856 Test Loss: 0.485 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 50 cost time: 1.4112052917480469
Epoch: 50, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.481 Vali Acc: 0.861 Test Loss: 0.481 Test Acc: 0.861
Validation loss decreased (-0.855551 --> -0.861106).  Saving model ...
Epoch: 51 cost time: 1.1707673072814941
Epoch: 51, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.500 Vali Acc: 0.839 Test Loss: 0.500 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.2054333686828613
Epoch: 52, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.497 Vali Acc: 0.850 Test Loss: 0.497 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.2701735496520996
Epoch: 53, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.539 Vali Acc: 0.844 Test Loss: 0.539 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.2419512271881104
Epoch: 54, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.497 Vali Acc: 0.850 Test Loss: 0.497 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.1203892230987549
Epoch: 55, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.460 Vali Acc: 0.878 Test Loss: 0.460 Test Acc: 0.878
Validation loss decreased (-0.861106 --> -0.877773).  Saving model ...
Epoch: 56 cost time: 1.463392972946167
Epoch: 56, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.479 Vali Acc: 0.856 Test Loss: 0.479 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.1633553504943848
Epoch: 57, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.487 Vali Acc: 0.856 Test Loss: 0.487 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.419032335281372
Epoch: 58, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.479 Vali Acc: 0.856 Test Loss: 0.479 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.5327301025390625
Epoch: 59, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.436 Vali Acc: 0.867 Test Loss: 0.436 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.2529268264770508
Epoch: 60, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.464 Vali Acc: 0.856 Test Loss: 0.464 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.0747435092926025
Epoch: 61, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.464 Vali Acc: 0.861 Test Loss: 0.464 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.2306346893310547
Epoch: 62, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.460 Vali Acc: 0.872 Test Loss: 0.460 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 1.3213460445404053
Epoch: 63, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.465 Vali Acc: 0.867 Test Loss: 0.465 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 1.5641345977783203
Epoch: 64, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.450 Vali Acc: 0.856 Test Loss: 0.450 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 1.5712740421295166
Epoch: 65, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.458 Vali Acc: 0.878 Test Loss: 0.458 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 66 cost time: 1.3366739749908447
Epoch: 66, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.454 Vali Acc: 0.850 Test Loss: 0.454 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.6090033054351807
Epoch: 67, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.469 Vali Acc: 0.878 Test Loss: 0.469 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.1538641452789307
Epoch: 68, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.485 Vali Acc: 0.867 Test Loss: 0.485 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.321864366531372
Epoch: 69, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.496 Vali Acc: 0.878 Test Loss: 0.496 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.3724219799041748
Epoch: 70, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.496 Vali Acc: 0.861 Test Loss: 0.496 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.37253737449646
Epoch: 71, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.494 Vali Acc: 0.861 Test Loss: 0.494 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 1.4010264873504639
Epoch: 72, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.453 Vali Acc: 0.883 Test Loss: 0.453 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883329).  Saving model ...
Epoch: 73 cost time: 1.4201598167419434
Epoch: 73, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.465 Vali Acc: 0.883 Test Loss: 0.465 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.538311243057251
Epoch: 74, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.488 Vali Acc: 0.867 Test Loss: 0.488 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 1.2343668937683105
Epoch: 75, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.489 Vali Acc: 0.906 Test Loss: 0.489 Test Acc: 0.906
Validation loss decreased (-0.883329 --> -0.905551).  Saving model ...
Epoch: 76 cost time: 1.3389091491699219
Epoch: 76, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.487 Vali Acc: 0.894 Test Loss: 0.487 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 1.1453993320465088
Epoch: 77, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.482 Vali Acc: 0.878 Test Loss: 0.482 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 1.324977159500122
Epoch: 78, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.457 Vali Acc: 0.872 Test Loss: 0.457 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 1.42787766456604
Epoch: 79, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.450 Vali Acc: 0.878 Test Loss: 0.450 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 1.3272199630737305
Epoch: 80, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.477 Vali Acc: 0.867 Test Loss: 0.477 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 1.464599847793579
Epoch: 81, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.483 Vali Acc: 0.878 Test Loss: 0.483 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 1.1978166103363037
Epoch: 82, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.453 Vali Acc: 0.883 Test Loss: 0.453 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 1.1051571369171143
Epoch: 83, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.526 Vali Acc: 0.856 Test Loss: 0.526 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 1.3916783332824707
Epoch: 84, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.528 Vali Acc: 0.872 Test Loss: 0.528 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 85 cost time: 1.3031883239746094
Epoch: 85, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.474 Vali Acc: 0.889 Test Loss: 0.474 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 132755
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7026166915893555
Epoch: 1, Steps: 12 | Train Loss: 2.922 Vali Loss: 2.924 Vali Acc: 0.022 Test Loss: 2.924 Test Acc: 0.022
Validation loss decreased (inf --> -0.022193).  Saving model ...
Epoch: 2 cost time: 1.2740850448608398
Epoch: 2, Steps: 12 | Train Loss: 2.834 Vali Loss: 2.858 Vali Acc: 0.028 Test Loss: 2.858 Test Acc: 0.028
Validation loss decreased (-0.022193 --> -0.027749).  Saving model ...
Epoch: 3 cost time: 1.2685997486114502
Epoch: 3, Steps: 12 | Train Loss: 2.800 Vali Loss: 2.793 Vali Acc: 0.044 Test Loss: 2.793 Test Acc: 0.044
Validation loss decreased (-0.027749 --> -0.044417).  Saving model ...
Epoch: 4 cost time: 1.2482366561889648
Epoch: 4, Steps: 12 | Train Loss: 2.739 Vali Loss: 2.742 Vali Acc: 0.050 Test Loss: 2.742 Test Acc: 0.050
Validation loss decreased (-0.044417 --> -0.049973).  Saving model ...
Epoch: 5 cost time: 1.1720004081726074
Epoch: 5, Steps: 12 | Train Loss: 2.682 Vali Loss: 2.698 Vali Acc: 0.078 Test Loss: 2.698 Test Acc: 0.078
Validation loss decreased (-0.049973 --> -0.077751).  Saving model ...
Epoch: 6 cost time: 1.1497600078582764
Epoch: 6, Steps: 12 | Train Loss: 2.667 Vali Loss: 2.653 Vali Acc: 0.117 Test Loss: 2.653 Test Acc: 0.117
Validation loss decreased (-0.077751 --> -0.116640).  Saving model ...
Epoch: 7 cost time: 1.0987374782562256
Epoch: 7, Steps: 12 | Train Loss: 2.608 Vali Loss: 2.607 Vali Acc: 0.194 Test Loss: 2.607 Test Acc: 0.194
Validation loss decreased (-0.116640 --> -0.194418).  Saving model ...
Epoch: 8 cost time: 1.1448404788970947
Epoch: 8, Steps: 12 | Train Loss: 2.535 Vali Loss: 2.541 Vali Acc: 0.239 Test Loss: 2.541 Test Acc: 0.239
Validation loss decreased (-0.194418 --> -0.238863).  Saving model ...
Epoch: 9 cost time: 1.1541800498962402
Epoch: 9, Steps: 12 | Train Loss: 2.455 Vali Loss: 2.476 Vali Acc: 0.261 Test Loss: 2.476 Test Acc: 0.261
Validation loss decreased (-0.238863 --> -0.261086).  Saving model ...
Epoch: 10 cost time: 1.170175313949585
Epoch: 10, Steps: 12 | Train Loss: 2.371 Vali Loss: 2.404 Vali Acc: 0.350 Test Loss: 2.404 Test Acc: 0.350
Validation loss decreased (-0.261086 --> -0.349976).  Saving model ...
Epoch: 11 cost time: 1.1917932033538818
Epoch: 11, Steps: 12 | Train Loss: 2.282 Vali Loss: 2.327 Vali Acc: 0.411 Test Loss: 2.327 Test Acc: 0.411
Validation loss decreased (-0.349976 --> -0.411088).  Saving model ...
Epoch: 12 cost time: 1.1483967304229736
Epoch: 12, Steps: 12 | Train Loss: 2.192 Vali Loss: 2.238 Vali Acc: 0.422 Test Loss: 2.238 Test Acc: 0.422
Validation loss decreased (-0.411088 --> -0.422200).  Saving model ...
Epoch: 13 cost time: 1.2565524578094482
Epoch: 13, Steps: 12 | Train Loss: 2.080 Vali Loss: 2.144 Vali Acc: 0.444 Test Loss: 2.144 Test Acc: 0.444
Validation loss decreased (-0.422200 --> -0.444423).  Saving model ...
Epoch: 14 cost time: 1.1861233711242676
Epoch: 14, Steps: 12 | Train Loss: 1.935 Vali Loss: 2.028 Vali Acc: 0.467 Test Loss: 2.028 Test Acc: 0.467
Validation loss decreased (-0.444423 --> -0.466646).  Saving model ...
Epoch: 15 cost time: 1.259772777557373
Epoch: 15, Steps: 12 | Train Loss: 1.897 Vali Loss: 1.925 Vali Acc: 0.461 Test Loss: 1.925 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2286438941955566
Epoch: 16, Steps: 12 | Train Loss: 1.753 Vali Loss: 1.811 Vali Acc: 0.511 Test Loss: 1.811 Test Acc: 0.511
Validation loss decreased (-0.466646 --> -0.511093).  Saving model ...
Epoch: 17 cost time: 1.143735647201538
Epoch: 17, Steps: 12 | Train Loss: 1.623 Vali Loss: 1.725 Vali Acc: 0.533 Test Loss: 1.725 Test Acc: 0.533
Validation loss decreased (-0.511093 --> -0.533316).  Saving model ...
Epoch: 18 cost time: 1.088573694229126
Epoch: 18, Steps: 12 | Train Loss: 1.514 Vali Loss: 1.625 Vali Acc: 0.583 Test Loss: 1.625 Test Acc: 0.583
Validation loss decreased (-0.533316 --> -0.583317).  Saving model ...
Epoch: 19 cost time: 1.2607176303863525
Epoch: 19, Steps: 12 | Train Loss: 1.432 Vali Loss: 1.541 Vali Acc: 0.600 Test Loss: 1.541 Test Acc: 0.600
Validation loss decreased (-0.583317 --> -0.599985).  Saving model ...
Epoch: 20 cost time: 1.3605716228485107
Epoch: 20, Steps: 12 | Train Loss: 1.332 Vali Loss: 1.453 Vali Acc: 0.644 Test Loss: 1.453 Test Acc: 0.644
Validation loss decreased (-0.599985 --> -0.644430).  Saving model ...
Epoch: 21 cost time: 1.1874408721923828
Epoch: 21, Steps: 12 | Train Loss: 1.267 Vali Loss: 1.390 Vali Acc: 0.661 Test Loss: 1.390 Test Acc: 0.661
Validation loss decreased (-0.644430 --> -0.661097).  Saving model ...
Epoch: 22 cost time: 1.2419307231903076
Epoch: 22, Steps: 12 | Train Loss: 1.217 Vali Loss: 1.332 Vali Acc: 0.650 Test Loss: 1.332 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3678524494171143
Epoch: 23, Steps: 12 | Train Loss: 1.087 Vali Loss: 1.267 Vali Acc: 0.683 Test Loss: 1.267 Test Acc: 0.683
Validation loss decreased (-0.661097 --> -0.683321).  Saving model ...
Epoch: 24 cost time: 1.3587884902954102
Epoch: 24, Steps: 12 | Train Loss: 1.052 Vali Loss: 1.226 Vali Acc: 0.678 Test Loss: 1.226 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2379779815673828
Epoch: 25, Steps: 12 | Train Loss: 1.044 Vali Loss: 1.172 Vali Acc: 0.667 Test Loss: 1.172 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2663607597351074
Epoch: 26, Steps: 12 | Train Loss: 0.978 Vali Loss: 1.120 Vali Acc: 0.683 Test Loss: 1.120 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683322).  Saving model ...
Epoch: 27 cost time: 1.1782658100128174
Epoch: 27, Steps: 12 | Train Loss: 0.949 Vali Loss: 1.072 Vali Acc: 0.689 Test Loss: 1.072 Test Acc: 0.689
Validation loss decreased (-0.683322 --> -0.688878).  Saving model ...
Epoch: 28 cost time: 1.2245819568634033
Epoch: 28, Steps: 12 | Train Loss: 0.911 Vali Loss: 1.015 Vali Acc: 0.722 Test Loss: 1.015 Test Acc: 0.722
Validation loss decreased (-0.688878 --> -0.722212).  Saving model ...
Epoch: 29 cost time: 1.1669378280639648
Epoch: 29, Steps: 12 | Train Loss: 0.788 Vali Loss: 0.975 Vali Acc: 0.733 Test Loss: 0.975 Test Acc: 0.733
Validation loss decreased (-0.722212 --> -0.733324).  Saving model ...
Epoch: 30 cost time: 1.390122890472412
Epoch: 30, Steps: 12 | Train Loss: 0.745 Vali Loss: 0.962 Vali Acc: 0.728 Test Loss: 0.962 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.230764627456665
Epoch: 31, Steps: 12 | Train Loss: 0.733 Vali Loss: 0.891 Vali Acc: 0.750 Test Loss: 0.891 Test Acc: 0.750
Validation loss decreased (-0.733324 --> -0.749991).  Saving model ...
Epoch: 32 cost time: 1.3246989250183105
Epoch: 32, Steps: 12 | Train Loss: 0.685 Vali Loss: 0.870 Vali Acc: 0.761 Test Loss: 0.870 Test Acc: 0.761
Validation loss decreased (-0.749991 --> -0.761102).  Saving model ...
Epoch: 33 cost time: 1.3642706871032715
Epoch: 33, Steps: 12 | Train Loss: 0.677 Vali Loss: 0.824 Vali Acc: 0.783 Test Loss: 0.824 Test Acc: 0.783
Validation loss decreased (-0.761102 --> -0.783325).  Saving model ...
Epoch: 34 cost time: 1.2195944786071777
Epoch: 34, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.817 Vali Acc: 0.767 Test Loss: 0.817 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0657541751861572
Epoch: 35, Steps: 12 | Train Loss: 0.608 Vali Loss: 0.762 Vali Acc: 0.794 Test Loss: 0.762 Test Acc: 0.794
Validation loss decreased (-0.783325 --> -0.794437).  Saving model ...
Epoch: 36 cost time: 1.2768921852111816
Epoch: 36, Steps: 12 | Train Loss: 0.552 Vali Loss: 0.757 Vali Acc: 0.800 Test Loss: 0.757 Test Acc: 0.800
Validation loss decreased (-0.794437 --> -0.799992).  Saving model ...
Epoch: 37 cost time: 1.2037618160247803
Epoch: 37, Steps: 12 | Train Loss: 0.545 Vali Loss: 0.722 Vali Acc: 0.789 Test Loss: 0.722 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.3231256008148193
Epoch: 38, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.693 Vali Acc: 0.811 Test Loss: 0.693 Test Acc: 0.811
Validation loss decreased (-0.799992 --> -0.811104).  Saving model ...
Epoch: 39 cost time: 1.1772215366363525
Epoch: 39, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.683 Vali Acc: 0.789 Test Loss: 0.683 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.417968988418579
Epoch: 40, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.665 Vali Acc: 0.800 Test Loss: 0.665 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.302854299545288
Epoch: 41, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.640 Vali Acc: 0.817 Test Loss: 0.640 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816660).  Saving model ...
Epoch: 42 cost time: 1.4576709270477295
Epoch: 42, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.604 Vali Acc: 0.811 Test Loss: 0.604 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1563339233398438
Epoch: 43, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.578 Vali Acc: 0.833 Test Loss: 0.578 Test Acc: 0.833
Validation loss decreased (-0.816660 --> -0.833328).  Saving model ...
Epoch: 44 cost time: 1.2704133987426758
Epoch: 44, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.569 Vali Acc: 0.811 Test Loss: 0.569 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.252368688583374
Epoch: 45, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.548 Vali Acc: 0.822 Test Loss: 0.548 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.1618499755859375
Epoch: 46, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.552 Vali Acc: 0.833 Test Loss: 0.552 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 47 cost time: 1.0546259880065918
Epoch: 47, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.528 Vali Acc: 0.839 Test Loss: 0.528 Test Acc: 0.839
Validation loss decreased (-0.833328 --> -0.838884).  Saving model ...
Epoch: 48 cost time: 1.2037217617034912
Epoch: 48, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.524 Vali Acc: 0.833 Test Loss: 0.524 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.2944650650024414
Epoch: 49, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.516 Vali Acc: 0.850 Test Loss: 0.516 Test Acc: 0.850
Validation loss decreased (-0.838884 --> -0.849995).  Saving model ...
Epoch: 50 cost time: 1.1692018508911133
Epoch: 50, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.499 Vali Acc: 0.839 Test Loss: 0.499 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.2331695556640625
Epoch: 51, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.488 Vali Acc: 0.833 Test Loss: 0.488 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.275416612625122
Epoch: 52, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.481 Vali Acc: 0.850 Test Loss: 0.481 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 53 cost time: 1.2279164791107178
Epoch: 53, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.491 Vali Acc: 0.850 Test Loss: 0.491 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.4678113460540771
Epoch: 54, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.454 Vali Acc: 0.844 Test Loss: 0.454 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.2135179042816162
Epoch: 55, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.443 Vali Acc: 0.844 Test Loss: 0.443 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.2122325897216797
Epoch: 56, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.472 Vali Acc: 0.850 Test Loss: 0.472 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 57 cost time: 1.2469663619995117
Epoch: 57, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.452 Vali Acc: 0.867 Test Loss: 0.452 Test Acc: 0.867
Validation loss decreased (-0.849995 --> -0.866662).  Saving model ...
Epoch: 58 cost time: 1.2167119979858398
Epoch: 58, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.440 Vali Acc: 0.850 Test Loss: 0.440 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.1112267971038818
Epoch: 59, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.458 Vali Acc: 0.856 Test Loss: 0.458 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.2153706550598145
Epoch: 60, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.433 Vali Acc: 0.867 Test Loss: 0.433 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 61 cost time: 1.5703444480895996
Epoch: 61, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.425 Vali Acc: 0.872 Test Loss: 0.425 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872218).  Saving model ...
Epoch: 62 cost time: 1.1535520553588867
Epoch: 62, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.470 Vali Acc: 0.861 Test Loss: 0.470 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.0606834888458252
Epoch: 63, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.453 Vali Acc: 0.867 Test Loss: 0.453 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.3267886638641357
Epoch: 64, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.429 Vali Acc: 0.867 Test Loss: 0.429 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 1.4728705883026123
Epoch: 65, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.432 Vali Acc: 0.861 Test Loss: 0.432 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.9669866561889648
Epoch: 66, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.443 Vali Acc: 0.867 Test Loss: 0.443 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 1.1313879489898682
Epoch: 67, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.432 Vali Acc: 0.872 Test Loss: 0.432 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 1.1060266494750977
Epoch: 68, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.437 Vali Acc: 0.861 Test Loss: 0.437 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 1.2341055870056152
Epoch: 69, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.471 Vali Acc: 0.883 Test Loss: 0.471 Test Acc: 0.883
Validation loss decreased (-0.872218 --> -0.883329).  Saving model ...
Epoch: 70 cost time: 1.138073444366455
Epoch: 70, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.439 Vali Acc: 0.883 Test Loss: 0.439 Test Acc: 0.883
Validation loss decreased (-0.883329 --> -0.883329).  Saving model ...
Epoch: 71 cost time: 1.4622719287872314
Epoch: 71, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.449 Vali Acc: 0.878 Test Loss: 0.449 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.2375125885009766
Epoch: 72, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.437 Vali Acc: 0.872 Test Loss: 0.437 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.1988465785980225
Epoch: 73, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.418 Vali Acc: 0.867 Test Loss: 0.418 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 1.202777624130249
Epoch: 74, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.427 Vali Acc: 0.856 Test Loss: 0.427 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 1.1819467544555664
Epoch: 75, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.450 Vali Acc: 0.878 Test Loss: 0.450 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 1.1979825496673584
Epoch: 76, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.452 Vali Acc: 0.872 Test Loss: 0.452 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 1.2294251918792725
Epoch: 77, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.464 Vali Acc: 0.872 Test Loss: 0.464 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 1.2085602283477783
Epoch: 78, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.452 Vali Acc: 0.861 Test Loss: 0.452 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 1.1951651573181152
Epoch: 79, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.429 Vali Acc: 0.878 Test Loss: 0.429 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 80 cost time: 1.3103933334350586
Epoch: 80, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.434 Vali Acc: 0.894 Test Loss: 0.434 Test Acc: 0.894
Validation loss decreased (-0.883329 --> -0.894440).  Saving model ...
Epoch: 81 cost time: 1.3302719593048096
Epoch: 81, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.438 Vali Acc: 0.883 Test Loss: 0.438 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 1.1812286376953125
Epoch: 82, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.435 Vali Acc: 0.872 Test Loss: 0.435 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 1.1868302822113037
Epoch: 83, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.439 Vali Acc: 0.883 Test Loss: 0.439 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 1.2003533840179443
Epoch: 84, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.440 Vali Acc: 0.883 Test Loss: 0.440 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 1.2467126846313477
Epoch: 85, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.448 Vali Acc: 0.883 Test Loss: 0.448 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 1.3555097579956055
Epoch: 86, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.458 Vali Acc: 0.872 Test Loss: 0.458 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 1.2202401161193848
Epoch: 87, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.464 Vali Acc: 0.894 Test Loss: 0.464 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 1.281520128250122
Epoch: 88, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.458 Vali Acc: 0.889 Test Loss: 0.458 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 89 cost time: 1.1958465576171875
Epoch: 89, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.458 Vali Acc: 0.883 Test Loss: 0.458 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 90 cost time: 1.1484360694885254
Epoch: 90, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.469 Vali Acc: 0.878 Test Loss: 0.469 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 132563
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9274518489837646
Epoch: 1, Steps: 12 | Train Loss: 2.982 Vali Loss: 2.889 Vali Acc: 0.056 Test Loss: 2.889 Test Acc: 0.056
Validation loss decreased (inf --> -0.055527).  Saving model ...
Epoch: 2 cost time: 1.3005285263061523
Epoch: 2, Steps: 12 | Train Loss: 2.905 Vali Loss: 2.796 Vali Acc: 0.061 Test Loss: 2.796 Test Acc: 0.061
Validation loss decreased (-0.055527 --> -0.061083).  Saving model ...
Epoch: 3 cost time: 1.2992079257965088
Epoch: 3, Steps: 12 | Train Loss: 2.780 Vali Loss: 2.715 Vali Acc: 0.089 Test Loss: 2.715 Test Acc: 0.089
Validation loss decreased (-0.061083 --> -0.088862).  Saving model ...
Epoch: 4 cost time: 1.6617600917816162
Epoch: 4, Steps: 12 | Train Loss: 2.725 Vali Loss: 2.647 Vali Acc: 0.178 Test Loss: 2.647 Test Acc: 0.178
Validation loss decreased (-0.088862 --> -0.177751).  Saving model ...
Epoch: 5 cost time: 1.1719756126403809
Epoch: 5, Steps: 12 | Train Loss: 2.670 Vali Loss: 2.593 Vali Acc: 0.211 Test Loss: 2.593 Test Acc: 0.211
Validation loss decreased (-0.177751 --> -0.211085).  Saving model ...
Epoch: 6 cost time: 1.294579029083252
Epoch: 6, Steps: 12 | Train Loss: 2.608 Vali Loss: 2.536 Vali Acc: 0.311 Test Loss: 2.536 Test Acc: 0.311
Validation loss decreased (-0.211085 --> -0.311086).  Saving model ...
Epoch: 7 cost time: 1.1475534439086914
Epoch: 7, Steps: 12 | Train Loss: 2.583 Vali Loss: 2.480 Vali Acc: 0.328 Test Loss: 2.480 Test Acc: 0.328
Validation loss decreased (-0.311086 --> -0.327753).  Saving model ...
Epoch: 8 cost time: 1.4677855968475342
Epoch: 8, Steps: 12 | Train Loss: 2.455 Vali Loss: 2.405 Vali Acc: 0.400 Test Loss: 2.405 Test Acc: 0.400
Validation loss decreased (-0.327753 --> -0.399976).  Saving model ...
Epoch: 9 cost time: 1.1757380962371826
Epoch: 9, Steps: 12 | Train Loss: 2.414 Vali Loss: 2.328 Vali Acc: 0.444 Test Loss: 2.328 Test Acc: 0.444
Validation loss decreased (-0.399976 --> -0.444421).  Saving model ...
Epoch: 10 cost time: 1.257228136062622
Epoch: 10, Steps: 12 | Train Loss: 2.321 Vali Loss: 2.239 Vali Acc: 0.472 Test Loss: 2.239 Test Acc: 0.472
Validation loss decreased (-0.444421 --> -0.472200).  Saving model ...
Epoch: 11 cost time: 1.606626272201538
Epoch: 11, Steps: 12 | Train Loss: 2.204 Vali Loss: 2.147 Vali Acc: 0.528 Test Loss: 2.147 Test Acc: 0.528
Validation loss decreased (-0.472200 --> -0.527756).  Saving model ...
Epoch: 12 cost time: 1.3134851455688477
Epoch: 12, Steps: 12 | Train Loss: 2.069 Vali Loss: 2.050 Vali Acc: 0.600 Test Loss: 2.050 Test Acc: 0.600
Validation loss decreased (-0.527756 --> -0.599980).  Saving model ...
Epoch: 13 cost time: 1.240196704864502
Epoch: 13, Steps: 12 | Train Loss: 1.982 Vali Loss: 1.934 Vali Acc: 0.594 Test Loss: 1.934 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1420447826385498
Epoch: 14, Steps: 12 | Train Loss: 1.860 Vali Loss: 1.841 Vali Acc: 0.611 Test Loss: 1.841 Test Acc: 0.611
Validation loss decreased (-0.599980 --> -0.611093).  Saving model ...
Epoch: 15 cost time: 1.36568021774292
Epoch: 15, Steps: 12 | Train Loss: 1.734 Vali Loss: 1.748 Vali Acc: 0.606 Test Loss: 1.748 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2571320533752441
Epoch: 16, Steps: 12 | Train Loss: 1.649 Vali Loss: 1.661 Vali Acc: 0.633 Test Loss: 1.661 Test Acc: 0.633
Validation loss decreased (-0.611093 --> -0.633317).  Saving model ...
Epoch: 17 cost time: 1.2130610942840576
Epoch: 17, Steps: 12 | Train Loss: 1.563 Vali Loss: 1.589 Vali Acc: 0.628 Test Loss: 1.589 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2778303623199463
Epoch: 18, Steps: 12 | Train Loss: 1.500 Vali Loss: 1.508 Vali Acc: 0.661 Test Loss: 1.508 Test Acc: 0.661
Validation loss decreased (-0.633317 --> -0.661096).  Saving model ...
Epoch: 19 cost time: 1.1108012199401855
Epoch: 19, Steps: 12 | Train Loss: 1.367 Vali Loss: 1.450 Vali Acc: 0.628 Test Loss: 1.450 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.321352481842041
Epoch: 20, Steps: 12 | Train Loss: 1.280 Vali Loss: 1.384 Vali Acc: 0.656 Test Loss: 1.384 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1106507778167725
Epoch: 21, Steps: 12 | Train Loss: 1.192 Vali Loss: 1.318 Vali Acc: 0.661 Test Loss: 1.318 Test Acc: 0.661
Validation loss decreased (-0.661096 --> -0.661098).  Saving model ...
Epoch: 22 cost time: 1.1946518421173096
Epoch: 22, Steps: 12 | Train Loss: 1.168 Vali Loss: 1.279 Vali Acc: 0.667 Test Loss: 1.279 Test Acc: 0.667
Validation loss decreased (-0.661098 --> -0.666654).  Saving model ...
Epoch: 23 cost time: 1.1815481185913086
Epoch: 23, Steps: 12 | Train Loss: 1.043 Vali Loss: 1.224 Vali Acc: 0.672 Test Loss: 1.224 Test Acc: 0.672
Validation loss decreased (-0.666654 --> -0.672210).  Saving model ...
Epoch: 24 cost time: 1.4622716903686523
Epoch: 24, Steps: 12 | Train Loss: 1.043 Vali Loss: 1.165 Vali Acc: 0.672 Test Loss: 1.165 Test Acc: 0.672
Validation loss decreased (-0.672210 --> -0.672211).  Saving model ...
Epoch: 25 cost time: 1.2160584926605225
Epoch: 25, Steps: 12 | Train Loss: 1.003 Vali Loss: 1.120 Vali Acc: 0.689 Test Loss: 1.120 Test Acc: 0.689
Validation loss decreased (-0.672211 --> -0.688878).  Saving model ...
Epoch: 26 cost time: 1.264197587966919
Epoch: 26, Steps: 12 | Train Loss: 0.947 Vali Loss: 1.078 Vali Acc: 0.700 Test Loss: 1.078 Test Acc: 0.700
Validation loss decreased (-0.688878 --> -0.699989).  Saving model ...
Epoch: 27 cost time: 1.1080849170684814
Epoch: 27, Steps: 12 | Train Loss: 0.892 Vali Loss: 1.045 Vali Acc: 0.689 Test Loss: 1.045 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2359280586242676
Epoch: 28, Steps: 12 | Train Loss: 0.871 Vali Loss: 0.999 Vali Acc: 0.706 Test Loss: 0.999 Test Acc: 0.706
Validation loss decreased (-0.699989 --> -0.705546).  Saving model ...
Epoch: 29 cost time: 1.3517045974731445
Epoch: 29, Steps: 12 | Train Loss: 0.827 Vali Loss: 0.978 Vali Acc: 0.689 Test Loss: 0.978 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5007643699645996
Epoch: 30, Steps: 12 | Train Loss: 0.815 Vali Loss: 0.939 Vali Acc: 0.717 Test Loss: 0.939 Test Acc: 0.717
Validation loss decreased (-0.705546 --> -0.716657).  Saving model ...
Epoch: 31 cost time: 1.2206757068634033
Epoch: 31, Steps: 12 | Train Loss: 0.726 Vali Loss: 0.893 Vali Acc: 0.728 Test Loss: 0.893 Test Acc: 0.728
Validation loss decreased (-0.716657 --> -0.727769).  Saving model ...
Epoch: 32 cost time: 1.2640793323516846
Epoch: 32, Steps: 12 | Train Loss: 0.720 Vali Loss: 0.849 Vali Acc: 0.717 Test Loss: 0.849 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2903289794921875
Epoch: 33, Steps: 12 | Train Loss: 0.663 Vali Loss: 0.839 Vali Acc: 0.744 Test Loss: 0.839 Test Acc: 0.744
Validation loss decreased (-0.727769 --> -0.744436).  Saving model ...
Epoch: 34 cost time: 1.1202774047851562
Epoch: 34, Steps: 12 | Train Loss: 0.605 Vali Loss: 0.810 Vali Acc: 0.744 Test Loss: 0.810 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744436).  Saving model ...
Epoch: 35 cost time: 1.1753883361816406
Epoch: 35, Steps: 12 | Train Loss: 0.570 Vali Loss: 0.781 Vali Acc: 0.739 Test Loss: 0.781 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0796215534210205
Epoch: 36, Steps: 12 | Train Loss: 0.552 Vali Loss: 0.784 Vali Acc: 0.739 Test Loss: 0.784 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.1198177337646484
Epoch: 37, Steps: 12 | Train Loss: 0.555 Vali Loss: 0.748 Vali Acc: 0.767 Test Loss: 0.748 Test Acc: 0.767
Validation loss decreased (-0.744436 --> -0.766659).  Saving model ...
Epoch: 38 cost time: 1.1627769470214844
Epoch: 38, Steps: 12 | Train Loss: 0.496 Vali Loss: 0.699 Vali Acc: 0.761 Test Loss: 0.699 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.6680045127868652
Epoch: 39, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.692 Vali Acc: 0.767 Test Loss: 0.692 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766660).  Saving model ...
Epoch: 40 cost time: 1.3240153789520264
Epoch: 40, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.660 Vali Acc: 0.778 Test Loss: 0.660 Test Acc: 0.778
Validation loss decreased (-0.766660 --> -0.777771).  Saving model ...
Epoch: 41 cost time: 1.2370669841766357
Epoch: 41, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.672 Vali Acc: 0.783 Test Loss: 0.672 Test Acc: 0.783
Validation loss decreased (-0.777771 --> -0.783327).  Saving model ...
Epoch: 42 cost time: 1.225522756576538
Epoch: 42, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.646 Vali Acc: 0.800 Test Loss: 0.646 Test Acc: 0.800
Validation loss decreased (-0.783327 --> -0.799994).  Saving model ...
Epoch: 43 cost time: 1.3099191188812256
Epoch: 43, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.606 Vali Acc: 0.817 Test Loss: 0.606 Test Acc: 0.817
Validation loss decreased (-0.799994 --> -0.816661).  Saving model ...
Epoch: 44 cost time: 1.2029035091400146
Epoch: 44, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.602 Vali Acc: 0.817 Test Loss: 0.602 Test Acc: 0.817
Validation loss decreased (-0.816661 --> -0.816661).  Saving model ...
Epoch: 45 cost time: 1.615257740020752
Epoch: 45, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.567 Vali Acc: 0.828 Test Loss: 0.567 Test Acc: 0.828
Validation loss decreased (-0.816661 --> -0.827772).  Saving model ...
Epoch: 46 cost time: 1.29915452003479
Epoch: 46, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.580 Vali Acc: 0.839 Test Loss: 0.580 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838883).  Saving model ...
Epoch: 47 cost time: 1.2222445011138916
Epoch: 47, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.541 Vali Acc: 0.839 Test Loss: 0.541 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 48 cost time: 1.219440221786499
Epoch: 48, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.530 Vali Acc: 0.850 Test Loss: 0.530 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849995).  Saving model ...
Epoch: 49 cost time: 1.2648425102233887
Epoch: 49, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.550 Vali Acc: 0.839 Test Loss: 0.550 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.426177740097046
Epoch: 50, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.520 Vali Acc: 0.844 Test Loss: 0.520 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.188551902770996
Epoch: 51, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.503 Vali Acc: 0.861 Test Loss: 0.503 Test Acc: 0.861
Validation loss decreased (-0.849995 --> -0.861106).  Saving model ...
Epoch: 52 cost time: 1.2320497035980225
Epoch: 52, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.511 Vali Acc: 0.861 Test Loss: 0.511 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.2012004852294922
Epoch: 53, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.490 Vali Acc: 0.867 Test Loss: 0.490 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866662).  Saving model ...
Epoch: 54 cost time: 1.2908031940460205
Epoch: 54, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.497 Vali Acc: 0.867 Test Loss: 0.497 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.436330795288086
Epoch: 55, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.488 Vali Acc: 0.861 Test Loss: 0.488 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.2954764366149902
Epoch: 56, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.471 Vali Acc: 0.867 Test Loss: 0.471 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 57 cost time: 1.2096502780914307
Epoch: 57, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.479 Vali Acc: 0.872 Test Loss: 0.479 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872217).  Saving model ...
Epoch: 58 cost time: 1.2782506942749023
Epoch: 58, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.487 Vali Acc: 0.861 Test Loss: 0.487 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.3185181617736816
Epoch: 59, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.490 Vali Acc: 0.872 Test Loss: 0.490 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.1145436763763428
Epoch: 60, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.500 Vali Acc: 0.872 Test Loss: 0.500 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.461172103881836
Epoch: 61, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.456 Vali Acc: 0.872 Test Loss: 0.456 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872218).  Saving model ...
Epoch: 62 cost time: 1.3455636501312256
Epoch: 62, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.466 Vali Acc: 0.872 Test Loss: 0.466 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.2641706466674805
Epoch: 63, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.469 Vali Acc: 0.878 Test Loss: 0.469 Test Acc: 0.878
Validation loss decreased (-0.872218 --> -0.877773).  Saving model ...
Epoch: 64 cost time: 1.1389141082763672
Epoch: 64, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.450 Vali Acc: 0.889 Test Loss: 0.450 Test Acc: 0.889
Validation loss decreased (-0.877773 --> -0.888884).  Saving model ...
Epoch: 65 cost time: 1.2564046382904053
Epoch: 65, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.453 Vali Acc: 0.878 Test Loss: 0.453 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.2482922077178955
Epoch: 66, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.445 Vali Acc: 0.878 Test Loss: 0.445 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.1703705787658691
Epoch: 67, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.479 Vali Acc: 0.872 Test Loss: 0.479 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 1.4659745693206787
Epoch: 68, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.493 Vali Acc: 0.883 Test Loss: 0.493 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 1.2882795333862305
Epoch: 69, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.481 Vali Acc: 0.878 Test Loss: 0.481 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 1.2826895713806152
Epoch: 70, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.456 Vali Acc: 0.894 Test Loss: 0.456 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894440).  Saving model ...
Epoch: 71 cost time: 1.1656441688537598
Epoch: 71, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.452 Vali Acc: 0.883 Test Loss: 0.452 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.13246750831604
Epoch: 72, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.488 Vali Acc: 0.878 Test Loss: 0.488 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.16925048828125
Epoch: 73, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.492 Vali Acc: 0.883 Test Loss: 0.492 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 1.1209444999694824
Epoch: 74, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.500 Vali Acc: 0.889 Test Loss: 0.500 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 1.4812610149383545
Epoch: 75, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.474 Vali Acc: 0.889 Test Loss: 0.474 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 1.4299688339233398
Epoch: 76, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.472 Vali Acc: 0.878 Test Loss: 0.472 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 1.420961618423462
Epoch: 77, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.499 Vali Acc: 0.889 Test Loss: 0.499 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 1.329420804977417
Epoch: 78, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.464 Vali Acc: 0.894 Test Loss: 0.464 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 1.2304084300994873
Epoch: 79, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.496 Vali Acc: 0.878 Test Loss: 0.496 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 80 cost time: 1.284820795059204
Epoch: 80, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.521 Vali Acc: 0.883 Test Loss: 0.521 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 132371
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.78153657913208
Epoch: 1, Steps: 12 | Train Loss: 2.915 Vali Loss: 2.876 Vali Acc: 0.039 Test Loss: 2.876 Test Acc: 0.039
Validation loss decreased (inf --> -0.038860).  Saving model ...
Epoch: 2 cost time: 1.1671538352966309
Epoch: 2, Steps: 12 | Train Loss: 2.857 Vali Loss: 2.815 Vali Acc: 0.050 Test Loss: 2.815 Test Acc: 0.050
Validation loss decreased (-0.038860 --> -0.049972).  Saving model ...
Epoch: 3 cost time: 1.4614217281341553
Epoch: 3, Steps: 12 | Train Loss: 2.799 Vali Loss: 2.760 Vali Acc: 0.056 Test Loss: 2.760 Test Acc: 0.056
Validation loss decreased (-0.049972 --> -0.055528).  Saving model ...
Epoch: 4 cost time: 1.1478214263916016
Epoch: 4, Steps: 12 | Train Loss: 2.724 Vali Loss: 2.703 Vali Acc: 0.078 Test Loss: 2.703 Test Acc: 0.078
Validation loss decreased (-0.055528 --> -0.077751).  Saving model ...
Epoch: 5 cost time: 1.1271131038665771
Epoch: 5, Steps: 12 | Train Loss: 2.697 Vali Loss: 2.655 Vali Acc: 0.133 Test Loss: 2.655 Test Acc: 0.133
Validation loss decreased (-0.077751 --> -0.133307).  Saving model ...
Epoch: 6 cost time: 1.0900490283966064
Epoch: 6, Steps: 12 | Train Loss: 2.663 Vali Loss: 2.605 Vali Acc: 0.189 Test Loss: 2.605 Test Acc: 0.189
Validation loss decreased (-0.133307 --> -0.188863).  Saving model ...
Epoch: 7 cost time: 1.153615951538086
Epoch: 7, Steps: 12 | Train Loss: 2.568 Vali Loss: 2.558 Vali Acc: 0.217 Test Loss: 2.558 Test Acc: 0.217
Validation loss decreased (-0.188863 --> -0.216641).  Saving model ...
Epoch: 8 cost time: 1.2317118644714355
Epoch: 8, Steps: 12 | Train Loss: 2.549 Vali Loss: 2.497 Vali Acc: 0.278 Test Loss: 2.497 Test Acc: 0.278
Validation loss decreased (-0.216641 --> -0.277753).  Saving model ...
Epoch: 9 cost time: 1.092432975769043
Epoch: 9, Steps: 12 | Train Loss: 2.485 Vali Loss: 2.423 Vali Acc: 0.272 Test Loss: 2.423 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1197385787963867
Epoch: 10, Steps: 12 | Train Loss: 2.366 Vali Loss: 2.350 Vali Acc: 0.311 Test Loss: 2.350 Test Acc: 0.311
Validation loss decreased (-0.277753 --> -0.311088).  Saving model ...
Epoch: 11 cost time: 1.2516276836395264
Epoch: 11, Steps: 12 | Train Loss: 2.297 Vali Loss: 2.264 Vali Acc: 0.394 Test Loss: 2.264 Test Acc: 0.394
Validation loss decreased (-0.311088 --> -0.394422).  Saving model ...
Epoch: 12 cost time: 1.3059749603271484
Epoch: 12, Steps: 12 | Train Loss: 2.214 Vali Loss: 2.164 Vali Acc: 0.422 Test Loss: 2.164 Test Acc: 0.422
Validation loss decreased (-0.394422 --> -0.422201).  Saving model ...
Epoch: 13 cost time: 1.2463688850402832
Epoch: 13, Steps: 12 | Train Loss: 2.090 Vali Loss: 2.059 Vali Acc: 0.444 Test Loss: 2.059 Test Acc: 0.444
Validation loss decreased (-0.422201 --> -0.444424).  Saving model ...
Epoch: 14 cost time: 1.1070888042449951
Epoch: 14, Steps: 12 | Train Loss: 1.938 Vali Loss: 1.975 Vali Acc: 0.456 Test Loss: 1.975 Test Acc: 0.456
Validation loss decreased (-0.444424 --> -0.455536).  Saving model ...
Epoch: 15 cost time: 1.1649255752563477
Epoch: 15, Steps: 12 | Train Loss: 1.869 Vali Loss: 1.881 Vali Acc: 0.511 Test Loss: 1.881 Test Acc: 0.511
Validation loss decreased (-0.455536 --> -0.511092).  Saving model ...
Epoch: 16 cost time: 1.1764514446258545
Epoch: 16, Steps: 12 | Train Loss: 1.778 Vali Loss: 1.789 Vali Acc: 0.567 Test Loss: 1.789 Test Acc: 0.567
Validation loss decreased (-0.511092 --> -0.566649).  Saving model ...
Epoch: 17 cost time: 1.2212209701538086
Epoch: 17, Steps: 12 | Train Loss: 1.663 Vali Loss: 1.693 Vali Acc: 0.611 Test Loss: 1.693 Test Acc: 0.611
Validation loss decreased (-0.566649 --> -0.611094).  Saving model ...
Epoch: 18 cost time: 1.3301374912261963
Epoch: 18, Steps: 12 | Train Loss: 1.596 Vali Loss: 1.619 Vali Acc: 0.611 Test Loss: 1.619 Test Acc: 0.611
Validation loss decreased (-0.611094 --> -0.611095).  Saving model ...
Epoch: 19 cost time: 1.198883056640625
Epoch: 19, Steps: 12 | Train Loss: 1.417 Vali Loss: 1.537 Vali Acc: 0.622 Test Loss: 1.537 Test Acc: 0.622
Validation loss decreased (-0.611095 --> -0.622207).  Saving model ...
Epoch: 20 cost time: 1.3198015689849854
Epoch: 20, Steps: 12 | Train Loss: 1.409 Vali Loss: 1.464 Vali Acc: 0.622 Test Loss: 1.464 Test Acc: 0.622
Validation loss decreased (-0.622207 --> -0.622208).  Saving model ...
Epoch: 21 cost time: 1.4771029949188232
Epoch: 21, Steps: 12 | Train Loss: 1.276 Vali Loss: 1.393 Vali Acc: 0.639 Test Loss: 1.393 Test Acc: 0.639
Validation loss decreased (-0.622208 --> -0.638875).  Saving model ...
Epoch: 22 cost time: 1.330380916595459
Epoch: 22, Steps: 12 | Train Loss: 1.166 Vali Loss: 1.318 Vali Acc: 0.661 Test Loss: 1.318 Test Acc: 0.661
Validation loss decreased (-0.638875 --> -0.661098).  Saving model ...
Epoch: 23 cost time: 1.1596715450286865
Epoch: 23, Steps: 12 | Train Loss: 1.144 Vali Loss: 1.266 Vali Acc: 0.694 Test Loss: 1.266 Test Acc: 0.694
Validation loss decreased (-0.661098 --> -0.694432).  Saving model ...
Epoch: 24 cost time: 1.41776442527771
Epoch: 24, Steps: 12 | Train Loss: 1.052 Vali Loss: 1.186 Vali Acc: 0.700 Test Loss: 1.186 Test Acc: 0.700
Validation loss decreased (-0.694432 --> -0.699988).  Saving model ...
Epoch: 25 cost time: 1.260040521621704
Epoch: 25, Steps: 12 | Train Loss: 0.975 Vali Loss: 1.137 Vali Acc: 0.700 Test Loss: 1.137 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699989).  Saving model ...
Epoch: 26 cost time: 1.382310390472412
Epoch: 26, Steps: 12 | Train Loss: 0.902 Vali Loss: 1.081 Vali Acc: 0.722 Test Loss: 1.081 Test Acc: 0.722
Validation loss decreased (-0.699989 --> -0.722211).  Saving model ...
Epoch: 27 cost time: 1.3277020454406738
Epoch: 27, Steps: 12 | Train Loss: 0.858 Vali Loss: 1.043 Vali Acc: 0.706 Test Loss: 1.043 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4980061054229736
Epoch: 28, Steps: 12 | Train Loss: 0.803 Vali Loss: 1.000 Vali Acc: 0.722 Test Loss: 1.000 Test Acc: 0.722
Validation loss decreased (-0.722211 --> -0.722212).  Saving model ...
Epoch: 29 cost time: 1.2715418338775635
Epoch: 29, Steps: 12 | Train Loss: 0.743 Vali Loss: 0.954 Vali Acc: 0.744 Test Loss: 0.954 Test Acc: 0.744
Validation loss decreased (-0.722212 --> -0.744435).  Saving model ...
Epoch: 30 cost time: 1.1853210926055908
Epoch: 30, Steps: 12 | Train Loss: 0.685 Vali Loss: 0.907 Vali Acc: 0.739 Test Loss: 0.907 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2308297157287598
Epoch: 31, Steps: 12 | Train Loss: 0.673 Vali Loss: 0.866 Vali Acc: 0.756 Test Loss: 0.866 Test Acc: 0.756
Validation loss decreased (-0.744435 --> -0.755547).  Saving model ...
Epoch: 32 cost time: 1.2273576259613037
Epoch: 32, Steps: 12 | Train Loss: 0.593 Vali Loss: 0.817 Vali Acc: 0.767 Test Loss: 0.817 Test Acc: 0.767
Validation loss decreased (-0.755547 --> -0.766658).  Saving model ...
Epoch: 33 cost time: 1.3393492698669434
Epoch: 33, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.791 Vali Acc: 0.783 Test Loss: 0.791 Test Acc: 0.783
Validation loss decreased (-0.766658 --> -0.783325).  Saving model ...
Epoch: 34 cost time: 1.20804762840271
Epoch: 34, Steps: 12 | Train Loss: 0.517 Vali Loss: 0.757 Vali Acc: 0.783 Test Loss: 0.757 Test Acc: 0.783
Validation loss decreased (-0.783325 --> -0.783326).  Saving model ...
Epoch: 35 cost time: 1.1226856708526611
Epoch: 35, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.736 Vali Acc: 0.789 Test Loss: 0.736 Test Acc: 0.789
Validation loss decreased (-0.783326 --> -0.788882).  Saving model ...
Epoch: 36 cost time: 1.1123032569885254
Epoch: 36, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.712 Vali Acc: 0.817 Test Loss: 0.712 Test Acc: 0.817
Validation loss decreased (-0.788882 --> -0.816660).  Saving model ...
Epoch: 37 cost time: 1.1378624439239502
Epoch: 37, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.676 Vali Acc: 0.800 Test Loss: 0.676 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.2146544456481934
Epoch: 38, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.655 Vali Acc: 0.822 Test Loss: 0.655 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 39 cost time: 1.3097312450408936
Epoch: 39, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.644 Vali Acc: 0.822 Test Loss: 0.644 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 40 cost time: 1.2261011600494385
Epoch: 40, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.633 Vali Acc: 0.811 Test Loss: 0.633 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.3199727535247803
Epoch: 41, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.607 Vali Acc: 0.822 Test Loss: 0.607 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 42 cost time: 1.257810115814209
Epoch: 42, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.588 Vali Acc: 0.822 Test Loss: 0.588 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 43 cost time: 1.1103577613830566
Epoch: 43, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.569 Vali Acc: 0.833 Test Loss: 0.569 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833328).  Saving model ...
Epoch: 44 cost time: 1.2839720249176025
Epoch: 44, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.563 Vali Acc: 0.828 Test Loss: 0.563 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.2793123722076416
Epoch: 45, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.567 Vali Acc: 0.833 Test Loss: 0.567 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 46 cost time: 1.6273243427276611
Epoch: 46, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.536 Vali Acc: 0.833 Test Loss: 0.536 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 47 cost time: 1.252861738204956
Epoch: 47, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.535 Vali Acc: 0.833 Test Loss: 0.535 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 48 cost time: 1.425429344177246
Epoch: 48, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.540 Vali Acc: 0.828 Test Loss: 0.540 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.2614414691925049
Epoch: 49, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.535 Vali Acc: 0.844 Test Loss: 0.535 Test Acc: 0.844
Validation loss decreased (-0.833328 --> -0.844439).  Saving model ...
Epoch: 50 cost time: 1.41371488571167
Epoch: 50, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.525 Vali Acc: 0.828 Test Loss: 0.525 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.0989887714385986
Epoch: 51, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.517 Vali Acc: 0.844 Test Loss: 0.517 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 52 cost time: 1.58026123046875
Epoch: 52, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.513 Vali Acc: 0.833 Test Loss: 0.513 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.2203195095062256
Epoch: 53, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.481 Vali Acc: 0.844 Test Loss: 0.481 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844440).  Saving model ...
Epoch: 54 cost time: 1.2810873985290527
Epoch: 54, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.495 Vali Acc: 0.844 Test Loss: 0.495 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.2109663486480713
Epoch: 55, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.481 Vali Acc: 0.850 Test Loss: 0.481 Test Acc: 0.850
Validation loss decreased (-0.844440 --> -0.849995).  Saving model ...
Epoch: 56 cost time: 1.170868158340454
Epoch: 56, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.448 Vali Acc: 0.850 Test Loss: 0.448 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849996).  Saving model ...
Epoch: 57 cost time: 1.3214259147644043
Epoch: 57, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.470 Vali Acc: 0.844 Test Loss: 0.470 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.427934169769287
Epoch: 58, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.481 Vali Acc: 0.856 Test Loss: 0.481 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855551).  Saving model ...
Epoch: 59 cost time: 1.0662493705749512
Epoch: 59, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.480 Vali Acc: 0.839 Test Loss: 0.480 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.1430518627166748
Epoch: 60, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.486 Vali Acc: 0.850 Test Loss: 0.486 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.182352066040039
Epoch: 61, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.469 Vali Acc: 0.867 Test Loss: 0.469 Test Acc: 0.867
Validation loss decreased (-0.855551 --> -0.866662).  Saving model ...
Epoch: 62 cost time: 1.1787388324737549
Epoch: 62, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.463 Vali Acc: 0.861 Test Loss: 0.463 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.2684564590454102
Epoch: 63, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.457 Vali Acc: 0.867 Test Loss: 0.457 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 64 cost time: 1.110276222229004
Epoch: 64, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.470 Vali Acc: 0.850 Test Loss: 0.470 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.1875202655792236
Epoch: 65, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.461 Vali Acc: 0.867 Test Loss: 0.461 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.3124308586120605
Epoch: 66, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.451 Vali Acc: 0.867 Test Loss: 0.451 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 67 cost time: 1.330733060836792
Epoch: 67, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.473 Vali Acc: 0.850 Test Loss: 0.473 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.2934911251068115
Epoch: 68, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.481 Vali Acc: 0.861 Test Loss: 0.481 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.1350505352020264
Epoch: 69, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.470 Vali Acc: 0.878 Test Loss: 0.470 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877773).  Saving model ...
Epoch: 70 cost time: 1.2710061073303223
Epoch: 70, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.457 Vali Acc: 0.856 Test Loss: 0.457 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.155379056930542
Epoch: 71, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.438 Vali Acc: 0.872 Test Loss: 0.438 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 1.165410041809082
Epoch: 72, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.458 Vali Acc: 0.872 Test Loss: 0.458 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 1.0478579998016357
Epoch: 73, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.470 Vali Acc: 0.878 Test Loss: 0.470 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 1.4552664756774902
Epoch: 74, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.468 Vali Acc: 0.872 Test Loss: 0.468 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 1.215336561203003
Epoch: 75, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.488 Vali Acc: 0.872 Test Loss: 0.488 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 1.1509592533111572
Epoch: 76, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.506 Vali Acc: 0.878 Test Loss: 0.506 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 1.3086953163146973
Epoch: 77, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.462 Vali Acc: 0.872 Test Loss: 0.462 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 1.6659419536590576
Epoch: 78, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.466 Vali Acc: 0.867 Test Loss: 0.466 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 79 cost time: 1.324507236480713
Epoch: 79, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.456 Vali Acc: 0.861 Test Loss: 0.456 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 132179
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9840266704559326
Epoch: 1, Steps: 12 | Train Loss: 2.932 Vali Loss: 2.747 Vali Acc: 0.039 Test Loss: 2.747 Test Acc: 0.039
Validation loss decreased (inf --> -0.038861).  Saving model ...
Epoch: 2 cost time: 1.1480517387390137
Epoch: 2, Steps: 12 | Train Loss: 2.692 Vali Loss: 2.544 Vali Acc: 0.194 Test Loss: 2.544 Test Acc: 0.194
Validation loss decreased (-0.038861 --> -0.194419).  Saving model ...
Epoch: 3 cost time: 0.906653881072998
Epoch: 3, Steps: 12 | Train Loss: 2.455 Vali Loss: 2.250 Vali Acc: 0.417 Test Loss: 2.250 Test Acc: 0.417
Validation loss decreased (-0.194419 --> -0.416644).  Saving model ...
Epoch: 4 cost time: 1.0629582405090332
Epoch: 4, Steps: 12 | Train Loss: 2.104 Vali Loss: 1.959 Vali Acc: 0.511 Test Loss: 1.959 Test Acc: 0.511
Validation loss decreased (-0.416644 --> -0.511092).  Saving model ...
Epoch: 5 cost time: 1.1052725315093994
Epoch: 5, Steps: 12 | Train Loss: 1.790 Vali Loss: 1.709 Vali Acc: 0.561 Test Loss: 1.709 Test Acc: 0.561
Validation loss decreased (-0.511092 --> -0.561094).  Saving model ...
Epoch: 6 cost time: 1.1560444831848145
Epoch: 6, Steps: 12 | Train Loss: 1.455 Vali Loss: 1.446 Vali Acc: 0.606 Test Loss: 1.446 Test Acc: 0.606
Validation loss decreased (-0.561094 --> -0.605541).  Saving model ...
Epoch: 7 cost time: 1.1546955108642578
Epoch: 7, Steps: 12 | Train Loss: 1.237 Vali Loss: 1.293 Vali Acc: 0.589 Test Loss: 1.293 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9741489887237549
Epoch: 8, Steps: 12 | Train Loss: 1.101 Vali Loss: 1.115 Vali Acc: 0.622 Test Loss: 1.115 Test Acc: 0.622
Validation loss decreased (-0.605541 --> -0.622211).  Saving model ...
Epoch: 9 cost time: 1.0376510620117188
Epoch: 9, Steps: 12 | Train Loss: 0.818 Vali Loss: 1.028 Vali Acc: 0.672 Test Loss: 1.028 Test Acc: 0.672
Validation loss decreased (-0.622211 --> -0.672212).  Saving model ...
Epoch: 10 cost time: 1.1834003925323486
Epoch: 10, Steps: 12 | Train Loss: 0.724 Vali Loss: 0.888 Vali Acc: 0.689 Test Loss: 0.888 Test Acc: 0.689
Validation loss decreased (-0.672212 --> -0.688880).  Saving model ...
Epoch: 11 cost time: 1.3728413581848145
Epoch: 11, Steps: 12 | Train Loss: 0.552 Vali Loss: 0.799 Vali Acc: 0.756 Test Loss: 0.799 Test Acc: 0.756
Validation loss decreased (-0.688880 --> -0.755548).  Saving model ...
Epoch: 12 cost time: 1.3169207572937012
Epoch: 12, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.730 Vali Acc: 0.756 Test Loss: 0.730 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 13 cost time: 1.059427261352539
Epoch: 13, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.801 Vali Acc: 0.772 Test Loss: 0.801 Test Acc: 0.772
Validation loss decreased (-0.755548 --> -0.772214).  Saving model ...
Epoch: 14 cost time: 1.0749201774597168
Epoch: 14, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.709 Vali Acc: 0.767 Test Loss: 0.709 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0313122272491455
Epoch: 15, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.694 Vali Acc: 0.844 Test Loss: 0.694 Test Acc: 0.844
Validation loss decreased (-0.772214 --> -0.844438).  Saving model ...
Epoch: 16 cost time: 1.0251471996307373
Epoch: 16, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.620 Vali Acc: 0.817 Test Loss: 0.620 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.147193193435669
Epoch: 17, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.641 Vali Acc: 0.822 Test Loss: 0.641 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9411592483520508
Epoch: 18, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.626 Vali Acc: 0.844 Test Loss: 0.626 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 19 cost time: 1.0174129009246826
Epoch: 19, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.605 Vali Acc: 0.844 Test Loss: 0.605 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 20 cost time: 1.363692045211792
Epoch: 20, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.627 Vali Acc: 0.850 Test Loss: 0.627 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 21 cost time: 1.2981681823730469
Epoch: 21, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.667 Vali Acc: 0.861 Test Loss: 0.667 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861104).  Saving model ...
Epoch: 22 cost time: 1.1869428157806396
Epoch: 22, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.743 Vali Acc: 0.850 Test Loss: 0.743 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0945556163787842
Epoch: 23, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.658 Vali Acc: 0.850 Test Loss: 0.658 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0370609760284424
Epoch: 24, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.749 Vali Acc: 0.828 Test Loss: 0.749 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0527989864349365
Epoch: 25, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.683 Vali Acc: 0.844 Test Loss: 0.683 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.0946693420410156
Epoch: 26, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.793 Vali Acc: 0.828 Test Loss: 0.793 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.1147339344024658
Epoch: 27, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.660 Vali Acc: 0.867 Test Loss: 0.660 Test Acc: 0.867
Validation loss decreased (-0.861104 --> -0.866660).  Saving model ...
Epoch: 28 cost time: 1.1755402088165283
Epoch: 28, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.751 Vali Acc: 0.856 Test Loss: 0.751 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0652227401733398
Epoch: 29, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.754 Vali Acc: 0.833 Test Loss: 0.754 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0148916244506836
Epoch: 30, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.727 Vali Acc: 0.856 Test Loss: 0.727 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1301305294036865
Epoch: 31, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.717 Vali Acc: 0.861 Test Loss: 0.717 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.0182137489318848
Epoch: 32, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.706 Vali Acc: 0.861 Test Loss: 0.706 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.0082859992980957
Epoch: 33, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.693 Vali Acc: 0.861 Test Loss: 0.693 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.0080783367156982
Epoch: 34, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.725 Vali Acc: 0.867 Test Loss: 0.725 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.0752334594726562
Epoch: 35, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.694 Vali Acc: 0.867 Test Loss: 0.694 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.9104259014129639
Epoch: 36, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.696 Vali Acc: 0.861 Test Loss: 0.696 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.1758451461791992
Epoch: 37, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.707 Vali Acc: 0.861 Test Loss: 0.707 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 4790311
model size : 23.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8795480728149414
Epoch: 1, Steps: 12 | Train Loss: 2.873 Vali Loss: 2.679 Vali Acc: 0.094 Test Loss: 2.679 Test Acc: 0.094
Validation loss decreased (inf --> -0.094418).  Saving model ...
Epoch: 2 cost time: 1.1755554676055908
Epoch: 2, Steps: 12 | Train Loss: 2.659 Vali Loss: 2.484 Vali Acc: 0.244 Test Loss: 2.484 Test Acc: 0.244
Validation loss decreased (-0.094418 --> -0.244420).  Saving model ...
Epoch: 3 cost time: 0.9901590347290039
Epoch: 3, Steps: 12 | Train Loss: 2.403 Vali Loss: 2.201 Vali Acc: 0.444 Test Loss: 2.201 Test Acc: 0.444
Validation loss decreased (-0.244420 --> -0.444422).  Saving model ...
Epoch: 4 cost time: 0.9703905582427979
Epoch: 4, Steps: 12 | Train Loss: 2.063 Vali Loss: 1.949 Vali Acc: 0.494 Test Loss: 1.949 Test Acc: 0.494
Validation loss decreased (-0.444422 --> -0.494425).  Saving model ...
Epoch: 5 cost time: 0.9851140975952148
Epoch: 5, Steps: 12 | Train Loss: 1.757 Vali Loss: 1.696 Vali Acc: 0.533 Test Loss: 1.696 Test Acc: 0.533
Validation loss decreased (-0.494425 --> -0.533316).  Saving model ...
Epoch: 6 cost time: 1.0452122688293457
Epoch: 6, Steps: 12 | Train Loss: 1.419 Vali Loss: 1.478 Vali Acc: 0.556 Test Loss: 1.478 Test Acc: 0.556
Validation loss decreased (-0.533316 --> -0.555541).  Saving model ...
Epoch: 7 cost time: 0.8727459907531738
Epoch: 7, Steps: 12 | Train Loss: 1.158 Vali Loss: 1.286 Vali Acc: 0.589 Test Loss: 1.286 Test Acc: 0.589
Validation loss decreased (-0.555541 --> -0.588876).  Saving model ...
Epoch: 8 cost time: 0.8220577239990234
Epoch: 8, Steps: 12 | Train Loss: 0.919 Vali Loss: 1.114 Vali Acc: 0.611 Test Loss: 1.114 Test Acc: 0.611
Validation loss decreased (-0.588876 --> -0.611100).  Saving model ...
Epoch: 9 cost time: 0.7660882472991943
Epoch: 9, Steps: 12 | Train Loss: 0.781 Vali Loss: 0.969 Vali Acc: 0.650 Test Loss: 0.969 Test Acc: 0.650
Validation loss decreased (-0.611100 --> -0.649990).  Saving model ...
Epoch: 10 cost time: 0.9427406787872314
Epoch: 10, Steps: 12 | Train Loss: 0.625 Vali Loss: 0.938 Vali Acc: 0.689 Test Loss: 0.938 Test Acc: 0.689
Validation loss decreased (-0.649990 --> -0.688880).  Saving model ...
Epoch: 11 cost time: 1.0548021793365479
Epoch: 11, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.743 Vali Acc: 0.744 Test Loss: 0.743 Test Acc: 0.744
Validation loss decreased (-0.688880 --> -0.744437).  Saving model ...
Epoch: 12 cost time: 1.2063696384429932
Epoch: 12, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.771 Vali Acc: 0.750 Test Loss: 0.771 Test Acc: 0.750
Validation loss decreased (-0.744437 --> -0.749992).  Saving model ...
Epoch: 13 cost time: 1.10640549659729
Epoch: 13, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.772 Vali Acc: 0.761 Test Loss: 0.772 Test Acc: 0.761
Validation loss decreased (-0.749992 --> -0.761103).  Saving model ...
Epoch: 14 cost time: 0.9651196002960205
Epoch: 14, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.651 Vali Acc: 0.817 Test Loss: 0.651 Test Acc: 0.817
Validation loss decreased (-0.761103 --> -0.816660).  Saving model ...
Epoch: 15 cost time: 0.9570283889770508
Epoch: 15, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.614 Vali Acc: 0.833 Test Loss: 0.614 Test Acc: 0.833
Validation loss decreased (-0.816660 --> -0.833327).  Saving model ...
Epoch: 16 cost time: 0.916301965713501
Epoch: 16, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.623 Vali Acc: 0.856 Test Loss: 0.623 Test Acc: 0.856
Validation loss decreased (-0.833327 --> -0.855549).  Saving model ...
Epoch: 17 cost time: 0.923358678817749
Epoch: 17, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.608 Vali Acc: 0.839 Test Loss: 0.608 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.065229892730713
Epoch: 18, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.651 Vali Acc: 0.817 Test Loss: 0.651 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9380199909210205
Epoch: 19, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.744 Vali Acc: 0.833 Test Loss: 0.744 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0207037925720215
Epoch: 20, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.623 Vali Acc: 0.828 Test Loss: 0.623 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0343329906463623
Epoch: 21, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.730 Vali Acc: 0.844 Test Loss: 0.730 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9157071113586426
Epoch: 22, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.743 Vali Acc: 0.811 Test Loss: 0.743 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8637385368347168
Epoch: 23, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.764 Vali Acc: 0.850 Test Loss: 0.764 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.079707384109497
Epoch: 24, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.753 Vali Acc: 0.850 Test Loss: 0.753 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.080113410949707
Epoch: 25, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.683 Vali Acc: 0.833 Test Loss: 0.683 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.9718472957611084
Epoch: 26, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.738 Vali Acc: 0.839 Test Loss: 0.738 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 4789287
model size : 23.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5096192359924316
Epoch: 1, Steps: 12 | Train Loss: 2.850 Vali Loss: 2.677 Vali Acc: 0.133 Test Loss: 2.677 Test Acc: 0.133
Validation loss decreased (inf --> -0.133307).  Saving model ...
Epoch: 2 cost time: 0.9326677322387695
Epoch: 2, Steps: 12 | Train Loss: 2.596 Vali Loss: 2.449 Vali Acc: 0.272 Test Loss: 2.449 Test Acc: 0.272
Validation loss decreased (-0.133307 --> -0.272198).  Saving model ...
Epoch: 3 cost time: 0.9318399429321289
Epoch: 3, Steps: 12 | Train Loss: 2.349 Vali Loss: 2.194 Vali Acc: 0.411 Test Loss: 2.194 Test Acc: 0.411
Validation loss decreased (-0.272198 --> -0.411089).  Saving model ...
Epoch: 4 cost time: 0.9074220657348633
Epoch: 4, Steps: 12 | Train Loss: 1.973 Vali Loss: 1.927 Vali Acc: 0.461 Test Loss: 1.927 Test Acc: 0.461
Validation loss decreased (-0.411089 --> -0.461092).  Saving model ...
Epoch: 5 cost time: 1.055417776107788
Epoch: 5, Steps: 12 | Train Loss: 1.671 Vali Loss: 1.684 Vali Acc: 0.578 Test Loss: 1.684 Test Acc: 0.578
Validation loss decreased (-0.461092 --> -0.577761).  Saving model ...
Epoch: 6 cost time: 0.930931806564331
Epoch: 6, Steps: 12 | Train Loss: 1.405 Vali Loss: 1.432 Vali Acc: 0.567 Test Loss: 1.432 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9785172939300537
Epoch: 7, Steps: 12 | Train Loss: 1.176 Vali Loss: 1.239 Vali Acc: 0.600 Test Loss: 1.239 Test Acc: 0.600
Validation loss decreased (-0.577761 --> -0.599988).  Saving model ...
Epoch: 8 cost time: 0.9744551181793213
Epoch: 8, Steps: 12 | Train Loss: 0.957 Vali Loss: 1.080 Vali Acc: 0.611 Test Loss: 1.080 Test Acc: 0.611
Validation loss decreased (-0.599988 --> -0.611100).  Saving model ...
Epoch: 9 cost time: 0.9241166114807129
Epoch: 9, Steps: 12 | Train Loss: 0.760 Vali Loss: 0.949 Vali Acc: 0.683 Test Loss: 0.949 Test Acc: 0.683
Validation loss decreased (-0.611100 --> -0.683324).  Saving model ...
Epoch: 10 cost time: 1.024125337600708
Epoch: 10, Steps: 12 | Train Loss: 0.629 Vali Loss: 0.880 Vali Acc: 0.689 Test Loss: 0.880 Test Acc: 0.689
Validation loss decreased (-0.683324 --> -0.688880).  Saving model ...
Epoch: 11 cost time: 0.9331440925598145
Epoch: 11, Steps: 12 | Train Loss: 0.518 Vali Loss: 0.768 Vali Acc: 0.739 Test Loss: 0.768 Test Acc: 0.739
Validation loss decreased (-0.688880 --> -0.738881).  Saving model ...
Epoch: 12 cost time: 0.9210948944091797
Epoch: 12, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.744 Vali Acc: 0.756 Test Loss: 0.744 Test Acc: 0.756
Validation loss decreased (-0.738881 --> -0.755548).  Saving model ...
Epoch: 13 cost time: 0.9808275699615479
Epoch: 13, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.780 Vali Acc: 0.733 Test Loss: 0.780 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0129082202911377
Epoch: 14, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.748 Vali Acc: 0.767 Test Loss: 0.748 Test Acc: 0.767
Validation loss decreased (-0.755548 --> -0.766659).  Saving model ...
Epoch: 15 cost time: 0.925457239151001
Epoch: 15, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.663 Vali Acc: 0.811 Test Loss: 0.663 Test Acc: 0.811
Validation loss decreased (-0.766659 --> -0.811104).  Saving model ...
Epoch: 16 cost time: 0.9023714065551758
Epoch: 16, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.684 Vali Acc: 0.822 Test Loss: 0.684 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822215).  Saving model ...
Epoch: 17 cost time: 0.8374767303466797
Epoch: 17, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.667 Vali Acc: 0.822 Test Loss: 0.667 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822216).  Saving model ...
Epoch: 18 cost time: 1.1893513202667236
Epoch: 18, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.603 Vali Acc: 0.850 Test Loss: 0.603 Test Acc: 0.850
Validation loss decreased (-0.822216 --> -0.849994).  Saving model ...
Epoch: 19 cost time: 1.2305858135223389
Epoch: 19, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.691 Vali Acc: 0.839 Test Loss: 0.691 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9389622211456299
Epoch: 20, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.586 Vali Acc: 0.867 Test Loss: 0.586 Test Acc: 0.867
Validation loss decreased (-0.849994 --> -0.866661).  Saving model ...
Epoch: 21 cost time: 1.0675048828125
Epoch: 21, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.737 Vali Acc: 0.839 Test Loss: 0.737 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9841792583465576
Epoch: 22, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.640 Vali Acc: 0.856 Test Loss: 0.640 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.153568983078003
Epoch: 23, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.793 Vali Acc: 0.828 Test Loss: 0.793 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1039471626281738
Epoch: 24, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.666 Vali Acc: 0.844 Test Loss: 0.666 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0346522331237793
Epoch: 25, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.885 Vali Acc: 0.811 Test Loss: 0.885 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0577423572540283
Epoch: 26, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.650 Vali Acc: 0.833 Test Loss: 0.650 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9892239570617676
Epoch: 27, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.704 Vali Acc: 0.844 Test Loss: 0.704 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.029151439666748
Epoch: 28, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.650 Vali Acc: 0.861 Test Loss: 0.650 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.0272924900054932
Epoch: 29, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.708 Vali Acc: 0.856 Test Loss: 0.708 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2265369892120361
Epoch: 30, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.676 Vali Acc: 0.850 Test Loss: 0.676 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 4788263
model size : 23.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.936728000640869
Epoch: 1, Steps: 12 | Train Loss: 2.825 Vali Loss: 2.697 Vali Acc: 0.061 Test Loss: 2.697 Test Acc: 0.061
Validation loss decreased (inf --> -0.061084).  Saving model ...
Epoch: 2 cost time: 1.0467419624328613
Epoch: 2, Steps: 12 | Train Loss: 2.658 Vali Loss: 2.472 Vali Acc: 0.211 Test Loss: 2.472 Test Acc: 0.211
Validation loss decreased (-0.061084 --> -0.211086).  Saving model ...
Epoch: 3 cost time: 0.9436438083648682
Epoch: 3, Steps: 12 | Train Loss: 2.345 Vali Loss: 2.215 Vali Acc: 0.411 Test Loss: 2.215 Test Acc: 0.411
Validation loss decreased (-0.211086 --> -0.411089).  Saving model ...
Epoch: 4 cost time: 1.1745376586914062
Epoch: 4, Steps: 12 | Train Loss: 2.004 Vali Loss: 1.925 Vali Acc: 0.522 Test Loss: 1.925 Test Acc: 0.522
Validation loss decreased (-0.411089 --> -0.522203).  Saving model ...
Epoch: 5 cost time: 1.0494349002838135
Epoch: 5, Steps: 12 | Train Loss: 1.717 Vali Loss: 1.631 Vali Acc: 0.578 Test Loss: 1.631 Test Acc: 0.578
Validation loss decreased (-0.522203 --> -0.577761).  Saving model ...
Epoch: 6 cost time: 1.1160666942596436
Epoch: 6, Steps: 12 | Train Loss: 1.395 Vali Loss: 1.406 Vali Acc: 0.600 Test Loss: 1.406 Test Acc: 0.600
Validation loss decreased (-0.577761 --> -0.599986).  Saving model ...
Epoch: 7 cost time: 1.078476905822754
Epoch: 7, Steps: 12 | Train Loss: 1.126 Vali Loss: 1.204 Vali Acc: 0.600 Test Loss: 1.204 Test Acc: 0.600
Validation loss decreased (-0.599986 --> -0.599988).  Saving model ...
Epoch: 8 cost time: 0.9529030323028564
Epoch: 8, Steps: 12 | Train Loss: 0.997 Vali Loss: 1.070 Vali Acc: 0.628 Test Loss: 1.070 Test Acc: 0.628
Validation loss decreased (-0.599988 --> -0.627767).  Saving model ...
Epoch: 9 cost time: 1.1238632202148438
Epoch: 9, Steps: 12 | Train Loss: 0.753 Vali Loss: 0.971 Vali Acc: 0.650 Test Loss: 0.971 Test Acc: 0.650
Validation loss decreased (-0.627767 --> -0.649990).  Saving model ...
Epoch: 10 cost time: 0.8926057815551758
Epoch: 10, Steps: 12 | Train Loss: 0.684 Vali Loss: 0.944 Vali Acc: 0.672 Test Loss: 0.944 Test Acc: 0.672
Validation loss decreased (-0.649990 --> -0.672213).  Saving model ...
Epoch: 11 cost time: 1.0064549446105957
Epoch: 11, Steps: 12 | Train Loss: 0.571 Vali Loss: 0.857 Vali Acc: 0.694 Test Loss: 0.857 Test Acc: 0.694
Validation loss decreased (-0.672213 --> -0.694436).  Saving model ...
Epoch: 12 cost time: 0.8708643913269043
Epoch: 12, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.786 Vali Acc: 0.722 Test Loss: 0.786 Test Acc: 0.722
Validation loss decreased (-0.694436 --> -0.722214).  Saving model ...
Epoch: 13 cost time: 0.9370911121368408
Epoch: 13, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.716 Vali Acc: 0.728 Test Loss: 0.716 Test Acc: 0.728
Validation loss decreased (-0.722214 --> -0.727771).  Saving model ...
Epoch: 14 cost time: 0.9006116390228271
Epoch: 14, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.827 Vali Acc: 0.750 Test Loss: 0.827 Test Acc: 0.750
Validation loss decreased (-0.727771 --> -0.749992).  Saving model ...
Epoch: 15 cost time: 0.9322352409362793
Epoch: 15, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.677 Vali Acc: 0.800 Test Loss: 0.677 Test Acc: 0.800
Validation loss decreased (-0.749992 --> -0.799993).  Saving model ...
Epoch: 16 cost time: 0.9091525077819824
Epoch: 16, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.677 Vali Acc: 0.783 Test Loss: 0.677 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9923677444458008
Epoch: 17, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.712 Vali Acc: 0.811 Test Loss: 0.712 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811104).  Saving model ...
Epoch: 18 cost time: 0.9833402633666992
Epoch: 18, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.680 Vali Acc: 0.822 Test Loss: 0.680 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822215).  Saving model ...
Epoch: 19 cost time: 1.1105661392211914
Epoch: 19, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.724 Vali Acc: 0.822 Test Loss: 0.724 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1492671966552734
Epoch: 20, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.723 Vali Acc: 0.828 Test Loss: 0.723 Test Acc: 0.828
Validation loss decreased (-0.822215 --> -0.827771).  Saving model ...
Epoch: 21 cost time: 1.0100064277648926
Epoch: 21, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.694 Vali Acc: 0.839 Test Loss: 0.694 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838882).  Saving model ...
Epoch: 22 cost time: 0.9976294040679932
Epoch: 22, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.717 Vali Acc: 0.850 Test Loss: 0.717 Test Acc: 0.850
Validation loss decreased (-0.838882 --> -0.849993).  Saving model ...
Epoch: 23 cost time: 0.9674692153930664
Epoch: 23, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.692 Vali Acc: 0.844 Test Loss: 0.692 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1291682720184326
Epoch: 24, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.699 Vali Acc: 0.844 Test Loss: 0.699 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1434385776519775
Epoch: 25, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.690 Vali Acc: 0.867 Test Loss: 0.690 Test Acc: 0.867
Validation loss decreased (-0.849993 --> -0.866660).  Saving model ...
Epoch: 26 cost time: 1.1921415328979492
Epoch: 26, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.773 Vali Acc: 0.856 Test Loss: 0.773 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1900994777679443
Epoch: 27, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.762 Vali Acc: 0.828 Test Loss: 0.762 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.181135892868042
Epoch: 28, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.743 Vali Acc: 0.856 Test Loss: 0.743 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0564727783203125
Epoch: 29, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.751 Vali Acc: 0.844 Test Loss: 0.751 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.3817086219787598
Epoch: 30, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.773 Vali Acc: 0.856 Test Loss: 0.773 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.2300052642822266
Epoch: 31, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.776 Vali Acc: 0.856 Test Loss: 0.776 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.0683512687683105
Epoch: 32, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.775 Vali Acc: 0.861 Test Loss: 0.775 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.9900035858154297
Epoch: 33, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.793 Vali Acc: 0.861 Test Loss: 0.793 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.3577964305877686
Epoch: 34, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.803 Vali Acc: 0.856 Test Loss: 0.803 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.0603375434875488
Epoch: 35, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.807 Vali Acc: 0.856 Test Loss: 0.807 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 4787239
model size : 23.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8629724979400635
Epoch: 1, Steps: 12 | Train Loss: 2.882 Vali Loss: 2.659 Vali Acc: 0.072 Test Loss: 2.659 Test Acc: 0.072
Validation loss decreased (inf --> -0.072196).  Saving model ...
Epoch: 2 cost time: 0.8092315196990967
Epoch: 2, Steps: 12 | Train Loss: 2.660 Vali Loss: 2.478 Vali Acc: 0.233 Test Loss: 2.478 Test Acc: 0.233
Validation loss decreased (-0.072196 --> -0.233309).  Saving model ...
Epoch: 3 cost time: 0.9156100749969482
Epoch: 3, Steps: 12 | Train Loss: 2.426 Vali Loss: 2.250 Vali Acc: 0.378 Test Loss: 2.250 Test Acc: 0.378
Validation loss decreased (-0.233309 --> -0.377755).  Saving model ...
Epoch: 4 cost time: 0.8617053031921387
Epoch: 4, Steps: 12 | Train Loss: 2.133 Vali Loss: 1.977 Vali Acc: 0.467 Test Loss: 1.977 Test Acc: 0.467
Validation loss decreased (-0.377755 --> -0.466647).  Saving model ...
Epoch: 5 cost time: 1.049070119857788
Epoch: 5, Steps: 12 | Train Loss: 1.825 Vali Loss: 1.735 Vali Acc: 0.539 Test Loss: 1.735 Test Acc: 0.539
Validation loss decreased (-0.466647 --> -0.538872).  Saving model ...
Epoch: 6 cost time: 0.9228682518005371
Epoch: 6, Steps: 12 | Train Loss: 1.512 Vali Loss: 1.522 Vali Acc: 0.594 Test Loss: 1.522 Test Acc: 0.594
Validation loss decreased (-0.538872 --> -0.594429).  Saving model ...
Epoch: 7 cost time: 0.9659242630004883
Epoch: 7, Steps: 12 | Train Loss: 1.287 Vali Loss: 1.322 Vali Acc: 0.589 Test Loss: 1.322 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9268193244934082
Epoch: 8, Steps: 12 | Train Loss: 1.104 Vali Loss: 1.222 Vali Acc: 0.611 Test Loss: 1.222 Test Acc: 0.611
Validation loss decreased (-0.594429 --> -0.611099).  Saving model ...
Epoch: 9 cost time: 1.026869297027588
Epoch: 9, Steps: 12 | Train Loss: 0.845 Vali Loss: 1.044 Vali Acc: 0.633 Test Loss: 1.044 Test Acc: 0.633
Validation loss decreased (-0.611099 --> -0.633323).  Saving model ...
Epoch: 10 cost time: 1.113058090209961
Epoch: 10, Steps: 12 | Train Loss: 0.706 Vali Loss: 0.899 Vali Acc: 0.683 Test Loss: 0.899 Test Acc: 0.683
Validation loss decreased (-0.633323 --> -0.683324).  Saving model ...
Epoch: 11 cost time: 0.9460721015930176
Epoch: 11, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.798 Vali Acc: 0.767 Test Loss: 0.798 Test Acc: 0.767
Validation loss decreased (-0.683324 --> -0.766659).  Saving model ...
Epoch: 12 cost time: 0.8807580471038818
Epoch: 12, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.745 Vali Acc: 0.711 Test Loss: 0.745 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0257604122161865
Epoch: 13, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.689 Vali Acc: 0.750 Test Loss: 0.689 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1644978523254395
Epoch: 14, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.625 Vali Acc: 0.783 Test Loss: 0.625 Test Acc: 0.783
Validation loss decreased (-0.766659 --> -0.783327).  Saving model ...
Epoch: 15 cost time: 1.0683743953704834
Epoch: 15, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.712 Vali Acc: 0.783 Test Loss: 0.712 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9460222721099854
Epoch: 16, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.662 Vali Acc: 0.783 Test Loss: 0.662 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9252240657806396
Epoch: 17, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.673 Vali Acc: 0.811 Test Loss: 0.673 Test Acc: 0.811
Validation loss decreased (-0.783327 --> -0.811104).  Saving model ...
Epoch: 18 cost time: 0.8068408966064453
Epoch: 18, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.600 Vali Acc: 0.822 Test Loss: 0.600 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822216).  Saving model ...
Epoch: 19 cost time: 0.9045417308807373
Epoch: 19, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.663 Vali Acc: 0.822 Test Loss: 0.663 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8387157917022705
Epoch: 20, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.693 Vali Acc: 0.811 Test Loss: 0.693 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0094213485717773
Epoch: 21, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.598 Vali Acc: 0.839 Test Loss: 0.598 Test Acc: 0.839
Validation loss decreased (-0.822216 --> -0.838883).  Saving model ...
Epoch: 22 cost time: 0.8749232292175293
Epoch: 22, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.632 Vali Acc: 0.850 Test Loss: 0.632 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 23 cost time: 0.8952760696411133
Epoch: 23, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.679 Vali Acc: 0.844 Test Loss: 0.679 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9393224716186523
Epoch: 24, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.775 Vali Acc: 0.844 Test Loss: 0.775 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9050571918487549
Epoch: 25, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.707 Vali Acc: 0.844 Test Loss: 0.707 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8894658088684082
Epoch: 26, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.658 Vali Acc: 0.844 Test Loss: 0.658 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9772863388061523
Epoch: 27, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.781 Vali Acc: 0.839 Test Loss: 0.781 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.890953540802002
Epoch: 28, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.718 Vali Acc: 0.839 Test Loss: 0.718 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0403811931610107
Epoch: 29, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.826 Vali Acc: 0.833 Test Loss: 0.826 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.0922214984893799
Epoch: 30, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.804 Vali Acc: 0.833 Test Loss: 0.804 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.8978879451751709
Epoch: 31, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.786 Vali Acc: 0.789 Test Loss: 0.786 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.1568188667297363
Epoch: 32, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.797 Vali Acc: 0.817 Test Loss: 0.797 Test Acc: 0.817
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.85
model parameter : 4002343
model size : 20.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.643434762954712
Epoch: 1, Steps: 12 | Train Loss: 2.809 Vali Loss: 2.667 Vali Acc: 0.122 Test Loss: 2.667 Test Acc: 0.122
Validation loss decreased (inf --> -0.122196).  Saving model ...
Epoch: 2 cost time: 0.9466891288757324
Epoch: 2, Steps: 12 | Train Loss: 2.644 Vali Loss: 2.487 Vali Acc: 0.261 Test Loss: 2.487 Test Acc: 0.261
Validation loss decreased (-0.122196 --> -0.261086).  Saving model ...
Epoch: 3 cost time: 1.0066661834716797
Epoch: 3, Steps: 12 | Train Loss: 2.367 Vali Loss: 2.246 Vali Acc: 0.367 Test Loss: 2.246 Test Acc: 0.367
Validation loss decreased (-0.261086 --> -0.366644).  Saving model ...
Epoch: 4 cost time: 1.058903455734253
Epoch: 4, Steps: 12 | Train Loss: 2.108 Vali Loss: 1.990 Vali Acc: 0.472 Test Loss: 1.990 Test Acc: 0.472
Validation loss decreased (-0.366644 --> -0.472202).  Saving model ...
Epoch: 5 cost time: 0.8615055084228516
Epoch: 5, Steps: 12 | Train Loss: 1.784 Vali Loss: 1.753 Vali Acc: 0.506 Test Loss: 1.753 Test Acc: 0.506
Validation loss decreased (-0.472202 --> -0.505538).  Saving model ...
Epoch: 6 cost time: 0.9730219841003418
Epoch: 6, Steps: 12 | Train Loss: 1.568 Vali Loss: 1.510 Vali Acc: 0.594 Test Loss: 1.510 Test Acc: 0.594
Validation loss decreased (-0.505538 --> -0.594429).  Saving model ...
Epoch: 7 cost time: 0.924452543258667
Epoch: 7, Steps: 12 | Train Loss: 1.279 Vali Loss: 1.330 Vali Acc: 0.567 Test Loss: 1.330 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8602805137634277
Epoch: 8, Steps: 12 | Train Loss: 1.086 Vali Loss: 1.176 Vali Acc: 0.617 Test Loss: 1.176 Test Acc: 0.617
Validation loss decreased (-0.594429 --> -0.616655).  Saving model ...
Epoch: 9 cost time: 0.7425551414489746
Epoch: 9, Steps: 12 | Train Loss: 0.950 Vali Loss: 1.054 Vali Acc: 0.622 Test Loss: 1.054 Test Acc: 0.622
Validation loss decreased (-0.616655 --> -0.622212).  Saving model ...
Epoch: 10 cost time: 0.9720363616943359
Epoch: 10, Steps: 12 | Train Loss: 0.752 Vali Loss: 0.988 Vali Acc: 0.650 Test Loss: 0.988 Test Acc: 0.650
Validation loss decreased (-0.622212 --> -0.649990).  Saving model ...
Epoch: 11 cost time: 0.9561219215393066
Epoch: 11, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.866 Vali Acc: 0.689 Test Loss: 0.866 Test Acc: 0.689
Validation loss decreased (-0.649990 --> -0.688880).  Saving model ...
Epoch: 12 cost time: 0.9479906558990479
Epoch: 12, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.828 Vali Acc: 0.733 Test Loss: 0.828 Test Acc: 0.733
Validation loss decreased (-0.688880 --> -0.733325).  Saving model ...
Epoch: 13 cost time: 0.9391763210296631
Epoch: 13, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.735 Vali Acc: 0.750 Test Loss: 0.735 Test Acc: 0.750
Validation loss decreased (-0.733325 --> -0.749993).  Saving model ...
Epoch: 14 cost time: 1.1642498970031738
Epoch: 14, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.788 Vali Acc: 0.761 Test Loss: 0.788 Test Acc: 0.761
Validation loss decreased (-0.749993 --> -0.761103).  Saving model ...
Epoch: 15 cost time: 0.9591703414916992
Epoch: 15, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.659 Vali Acc: 0.794 Test Loss: 0.659 Test Acc: 0.794
Validation loss decreased (-0.761103 --> -0.794438).  Saving model ...
Epoch: 16 cost time: 0.9591083526611328
Epoch: 16, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.642 Vali Acc: 0.806 Test Loss: 0.642 Test Acc: 0.806
Validation loss decreased (-0.794438 --> -0.805549).  Saving model ...
Epoch: 17 cost time: 0.7560298442840576
Epoch: 17, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.673 Vali Acc: 0.806 Test Loss: 0.673 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.953057050704956
Epoch: 18, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.759 Vali Acc: 0.817 Test Loss: 0.759 Test Acc: 0.817
Validation loss decreased (-0.805549 --> -0.816659).  Saving model ...
Epoch: 19 cost time: 0.8762447834014893
Epoch: 19, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.635 Vali Acc: 0.828 Test Loss: 0.635 Test Acc: 0.828
Validation loss decreased (-0.816659 --> -0.827771).  Saving model ...
Epoch: 20 cost time: 0.9432346820831299
Epoch: 20, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.710 Vali Acc: 0.867 Test Loss: 0.710 Test Acc: 0.867
Validation loss decreased (-0.827771 --> -0.866660).  Saving model ...
Epoch: 21 cost time: 0.9182267189025879
Epoch: 21, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.646 Vali Acc: 0.839 Test Loss: 0.646 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0481986999511719
Epoch: 22, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.722 Vali Acc: 0.850 Test Loss: 0.722 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1614422798156738
Epoch: 23, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.748 Vali Acc: 0.833 Test Loss: 0.748 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1609165668487549
Epoch: 24, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.749 Vali Acc: 0.844 Test Loss: 0.749 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0710783004760742
Epoch: 25, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.707 Vali Acc: 0.839 Test Loss: 0.707 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0285484790802002
Epoch: 26, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.733 Vali Acc: 0.861 Test Loss: 0.733 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.978243350982666
Epoch: 27, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.690 Vali Acc: 0.867 Test Loss: 0.690 Test Acc: 0.867
Validation loss decreased (-0.866660 --> -0.866660).  Saving model ...
Epoch: 28 cost time: 0.9223806858062744
Epoch: 28, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.696 Vali Acc: 0.856 Test Loss: 0.696 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0494108200073242
Epoch: 29, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.736 Vali Acc: 0.861 Test Loss: 0.736 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8709561824798584
Epoch: 30, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.721 Vali Acc: 0.867 Test Loss: 0.721 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8905808925628662
Epoch: 31, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.714 Vali Acc: 0.867 Test Loss: 0.714 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9570553302764893
Epoch: 32, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.747 Vali Acc: 0.872 Test Loss: 0.747 Test Acc: 0.872
Validation loss decreased (-0.866660 --> -0.872215).  Saving model ...
Epoch: 33 cost time: 1.042769432067871
Epoch: 33, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.763 Vali Acc: 0.850 Test Loss: 0.763 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8930652141571045
Epoch: 34, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.808 Vali Acc: 0.850 Test Loss: 0.808 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9143714904785156
Epoch: 35, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.915 Vali Acc: 0.822 Test Loss: 0.915 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.1215295791625977
Epoch: 36, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.777 Vali Acc: 0.856 Test Loss: 0.777 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.121354103088379
Epoch: 37, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.996 Vali Acc: 0.806 Test Loss: 0.996 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.1622350215911865
Epoch: 38, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.842 Vali Acc: 0.839 Test Loss: 0.842 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.0770325660705566
Epoch: 39, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.857 Vali Acc: 0.833 Test Loss: 0.857 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.079857587814331
Epoch: 40, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.963 Vali Acc: 0.833 Test Loss: 0.963 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.9122343063354492
Epoch: 41, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.840 Vali Acc: 0.861 Test Loss: 0.840 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.0511844158172607
Epoch: 42, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.871 Vali Acc: 0.856 Test Loss: 0.871 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 4001319
model size : 20.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8783419132232666
Epoch: 1, Steps: 12 | Train Loss: 2.803 Vali Loss: 2.707 Vali Acc: 0.128 Test Loss: 2.707 Test Acc: 0.128
Validation loss decreased (inf --> -0.127751).  Saving model ...
Epoch: 2 cost time: 1.0480008125305176
Epoch: 2, Steps: 12 | Train Loss: 2.631 Vali Loss: 2.506 Vali Acc: 0.267 Test Loss: 2.506 Test Acc: 0.267
Validation loss decreased (-0.127751 --> -0.266642).  Saving model ...
Epoch: 3 cost time: 1.1545231342315674
Epoch: 3, Steps: 12 | Train Loss: 2.354 Vali Loss: 2.263 Vali Acc: 0.411 Test Loss: 2.263 Test Acc: 0.411
Validation loss decreased (-0.266642 --> -0.411088).  Saving model ...
Epoch: 4 cost time: 0.9927871227264404
Epoch: 4, Steps: 12 | Train Loss: 2.076 Vali Loss: 2.009 Vali Acc: 0.472 Test Loss: 2.009 Test Acc: 0.472
Validation loss decreased (-0.411088 --> -0.472202).  Saving model ...
Epoch: 5 cost time: 0.9663574695587158
Epoch: 5, Steps: 12 | Train Loss: 1.739 Vali Loss: 1.745 Vali Acc: 0.556 Test Loss: 1.745 Test Acc: 0.556
Validation loss decreased (-0.472202 --> -0.555538).  Saving model ...
Epoch: 6 cost time: 0.9788565635681152
Epoch: 6, Steps: 12 | Train Loss: 1.468 Vali Loss: 1.526 Vali Acc: 0.561 Test Loss: 1.526 Test Acc: 0.561
Validation loss decreased (-0.555538 --> -0.561096).  Saving model ...
Epoch: 7 cost time: 1.3090128898620605
Epoch: 7, Steps: 12 | Train Loss: 1.228 Vali Loss: 1.332 Vali Acc: 0.611 Test Loss: 1.332 Test Acc: 0.611
Validation loss decreased (-0.561096 --> -0.611098).  Saving model ...
Epoch: 8 cost time: 0.9241211414337158
Epoch: 8, Steps: 12 | Train Loss: 1.016 Vali Loss: 1.142 Vali Acc: 0.633 Test Loss: 1.142 Test Acc: 0.633
Validation loss decreased (-0.611098 --> -0.633322).  Saving model ...
Epoch: 9 cost time: 1.0422580242156982
Epoch: 9, Steps: 12 | Train Loss: 0.856 Vali Loss: 1.019 Vali Acc: 0.683 Test Loss: 1.019 Test Acc: 0.683
Validation loss decreased (-0.633322 --> -0.683323).  Saving model ...
Epoch: 10 cost time: 1.1596424579620361
Epoch: 10, Steps: 12 | Train Loss: 0.725 Vali Loss: 0.898 Vali Acc: 0.694 Test Loss: 0.898 Test Acc: 0.694
Validation loss decreased (-0.683323 --> -0.694435).  Saving model ...
Epoch: 11 cost time: 0.836198091506958
Epoch: 11, Steps: 12 | Train Loss: 0.587 Vali Loss: 0.849 Vali Acc: 0.733 Test Loss: 0.849 Test Acc: 0.733
Validation loss decreased (-0.694435 --> -0.733325).  Saving model ...
Epoch: 12 cost time: 1.0051853656768799
Epoch: 12, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.747 Vali Acc: 0.750 Test Loss: 0.747 Test Acc: 0.750
Validation loss decreased (-0.733325 --> -0.749993).  Saving model ...
Epoch: 13 cost time: 0.990628719329834
Epoch: 13, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.751 Vali Acc: 0.789 Test Loss: 0.751 Test Acc: 0.789
Validation loss decreased (-0.749993 --> -0.788881).  Saving model ...
Epoch: 14 cost time: 0.9449117183685303
Epoch: 14, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.666 Vali Acc: 0.778 Test Loss: 0.666 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1488142013549805
Epoch: 15, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.654 Vali Acc: 0.789 Test Loss: 0.654 Test Acc: 0.789
Validation loss decreased (-0.788881 --> -0.788882).  Saving model ...
Epoch: 16 cost time: 1.0888700485229492
Epoch: 16, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.598 Vali Acc: 0.833 Test Loss: 0.598 Test Acc: 0.833
Validation loss decreased (-0.788882 --> -0.833327).  Saving model ...
Epoch: 17 cost time: 1.0631461143493652
Epoch: 17, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.695 Vali Acc: 0.856 Test Loss: 0.695 Test Acc: 0.856
Validation loss decreased (-0.833327 --> -0.855549).  Saving model ...
Epoch: 18 cost time: 1.1214756965637207
Epoch: 18, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.566 Vali Acc: 0.839 Test Loss: 0.566 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0520708560943604
Epoch: 19, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.597 Vali Acc: 0.839 Test Loss: 0.597 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9693751335144043
Epoch: 20, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.583 Vali Acc: 0.856 Test Loss: 0.583 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855550).  Saving model ...
Epoch: 21 cost time: 0.7845761775970459
Epoch: 21, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.622 Vali Acc: 0.856 Test Loss: 0.622 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9022064208984375
Epoch: 22, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.660 Vali Acc: 0.833 Test Loss: 0.660 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9646892547607422
Epoch: 23, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.611 Vali Acc: 0.867 Test Loss: 0.611 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 24 cost time: 0.9874961376190186
Epoch: 24, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.721 Vali Acc: 0.839 Test Loss: 0.721 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9595000743865967
Epoch: 25, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.661 Vali Acc: 0.844 Test Loss: 0.661 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0517933368682861
Epoch: 26, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.772 Vali Acc: 0.850 Test Loss: 0.772 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.014282464981079
Epoch: 27, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.636 Vali Acc: 0.861 Test Loss: 0.636 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0323374271392822
Epoch: 28, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.695 Vali Acc: 0.833 Test Loss: 0.695 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9268710613250732
Epoch: 29, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.594 Vali Acc: 0.861 Test Loss: 0.594 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.8954477310180664
Epoch: 30, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.723 Vali Acc: 0.867 Test Loss: 0.723 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.930225133895874
Epoch: 31, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.729 Vali Acc: 0.839 Test Loss: 0.729 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.9577398300170898
Epoch: 32, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.745 Vali Acc: 0.856 Test Loss: 0.745 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9783766269683838
Epoch: 33, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.669 Vali Acc: 0.856 Test Loss: 0.669 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 4000295
model size : 20.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.359530448913574
Epoch: 1, Steps: 12 | Train Loss: 2.826 Vali Loss: 2.675 Vali Acc: 0.067 Test Loss: 2.675 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 1.1299054622650146
Epoch: 2, Steps: 12 | Train Loss: 2.600 Vali Loss: 2.473 Vali Acc: 0.233 Test Loss: 2.473 Test Acc: 0.233
Validation loss decreased (-0.066640 --> -0.233309).  Saving model ...
Epoch: 3 cost time: 1.132899522781372
Epoch: 3, Steps: 12 | Train Loss: 2.376 Vali Loss: 2.224 Vali Acc: 0.428 Test Loss: 2.224 Test Acc: 0.428
Validation loss decreased (-0.233309 --> -0.427756).  Saving model ...
Epoch: 4 cost time: 1.078883409500122
Epoch: 4, Steps: 12 | Train Loss: 2.078 Vali Loss: 1.983 Vali Acc: 0.500 Test Loss: 1.983 Test Acc: 0.500
Validation loss decreased (-0.427756 --> -0.499980).  Saving model ...
Epoch: 5 cost time: 1.103668451309204
Epoch: 5, Steps: 12 | Train Loss: 1.788 Vali Loss: 1.729 Vali Acc: 0.550 Test Loss: 1.729 Test Acc: 0.550
Validation loss decreased (-0.499980 --> -0.549983).  Saving model ...
Epoch: 6 cost time: 1.1061322689056396
Epoch: 6, Steps: 12 | Train Loss: 1.481 Vali Loss: 1.534 Vali Acc: 0.606 Test Loss: 1.534 Test Acc: 0.606
Validation loss decreased (-0.549983 --> -0.605540).  Saving model ...
Epoch: 7 cost time: 0.8287203311920166
Epoch: 7, Steps: 12 | Train Loss: 1.315 Vali Loss: 1.313 Vali Acc: 0.600 Test Loss: 1.313 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.956463098526001
Epoch: 8, Steps: 12 | Train Loss: 1.062 Vali Loss: 1.165 Vali Acc: 0.639 Test Loss: 1.165 Test Acc: 0.639
Validation loss decreased (-0.605540 --> -0.638877).  Saving model ...
Epoch: 9 cost time: 1.2111303806304932
Epoch: 9, Steps: 12 | Train Loss: 0.940 Vali Loss: 1.047 Vali Acc: 0.617 Test Loss: 1.047 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9845981597900391
Epoch: 10, Steps: 12 | Train Loss: 0.879 Vali Loss: 0.963 Vali Acc: 0.656 Test Loss: 0.963 Test Acc: 0.656
Validation loss decreased (-0.638877 --> -0.655546).  Saving model ...
Epoch: 11 cost time: 0.9648399353027344
Epoch: 11, Steps: 12 | Train Loss: 0.643 Vali Loss: 0.852 Vali Acc: 0.706 Test Loss: 0.852 Test Acc: 0.706
Validation loss decreased (-0.655546 --> -0.705547).  Saving model ...
Epoch: 12 cost time: 0.8580360412597656
Epoch: 12, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.829 Vali Acc: 0.717 Test Loss: 0.829 Test Acc: 0.717
Validation loss decreased (-0.705547 --> -0.716658).  Saving model ...
Epoch: 13 cost time: 0.9132251739501953
Epoch: 13, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.795 Vali Acc: 0.739 Test Loss: 0.795 Test Acc: 0.739
Validation loss decreased (-0.716658 --> -0.738881).  Saving model ...
Epoch: 14 cost time: 1.0277612209320068
Epoch: 14, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.677 Vali Acc: 0.772 Test Loss: 0.677 Test Acc: 0.772
Validation loss decreased (-0.738881 --> -0.772215).  Saving model ...
Epoch: 15 cost time: 0.8931200504302979
Epoch: 15, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.709 Vali Acc: 0.800 Test Loss: 0.709 Test Acc: 0.800
Validation loss decreased (-0.772215 --> -0.799993).  Saving model ...
Epoch: 16 cost time: 1.0983099937438965
Epoch: 16, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.637 Vali Acc: 0.817 Test Loss: 0.637 Test Acc: 0.817
Validation loss decreased (-0.799993 --> -0.816660).  Saving model ...
Epoch: 17 cost time: 1.0295076370239258
Epoch: 17, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.721 Vali Acc: 0.800 Test Loss: 0.721 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9129738807678223
Epoch: 18, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.759 Vali Acc: 0.806 Test Loss: 0.759 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0675156116485596
Epoch: 19, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.653 Vali Acc: 0.811 Test Loss: 0.653 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.07789945602417
Epoch: 20, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.658 Vali Acc: 0.839 Test Loss: 0.658 Test Acc: 0.839
Validation loss decreased (-0.816660 --> -0.838882).  Saving model ...
Epoch: 21 cost time: 0.8512241840362549
Epoch: 21, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.662 Vali Acc: 0.822 Test Loss: 0.662 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8865289688110352
Epoch: 22, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.687 Vali Acc: 0.833 Test Loss: 0.687 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1048297882080078
Epoch: 23, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.754 Vali Acc: 0.817 Test Loss: 0.754 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1620557308197021
Epoch: 24, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.700 Vali Acc: 0.817 Test Loss: 0.700 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1828057765960693
Epoch: 25, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.782 Vali Acc: 0.839 Test Loss: 0.782 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2136220932006836
Epoch: 26, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.730 Vali Acc: 0.844 Test Loss: 0.730 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844437).  Saving model ...
Epoch: 27 cost time: 0.9584646224975586
Epoch: 27, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.739 Vali Acc: 0.867 Test Loss: 0.739 Test Acc: 0.867
Validation loss decreased (-0.844437 --> -0.866659).  Saving model ...
Epoch: 28 cost time: 1.0086860656738281
Epoch: 28, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.715 Vali Acc: 0.856 Test Loss: 0.715 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7731492519378662
Epoch: 29, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.764 Vali Acc: 0.867 Test Loss: 0.764 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0763709545135498
Epoch: 30, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.729 Vali Acc: 0.872 Test Loss: 0.729 Test Acc: 0.872
Validation loss decreased (-0.866659 --> -0.872215).  Saving model ...
Epoch: 31 cost time: 0.9587042331695557
Epoch: 31, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.729 Vali Acc: 0.872 Test Loss: 0.729 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8764669895172119
Epoch: 32, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.725 Vali Acc: 0.872 Test Loss: 0.725 Test Acc: 0.872
Validation loss decreased (-0.872215 --> -0.872215).  Saving model ...
Epoch: 33 cost time: 1.0839941501617432
Epoch: 33, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.756 Vali Acc: 0.872 Test Loss: 0.756 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8424577713012695
Epoch: 34, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.765 Vali Acc: 0.878 Test Loss: 0.765 Test Acc: 0.878
Validation loss decreased (-0.872215 --> -0.877770).  Saving model ...
Epoch: 35 cost time: 0.8481793403625488
Epoch: 35, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.769 Vali Acc: 0.883 Test Loss: 0.769 Test Acc: 0.883
Validation loss decreased (-0.877770 --> -0.883326).  Saving model ...
Epoch: 36 cost time: 0.8183267116546631
Epoch: 36, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.773 Vali Acc: 0.883 Test Loss: 0.773 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8698067665100098
Epoch: 37, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.774 Vali Acc: 0.878 Test Loss: 0.774 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9657423496246338
Epoch: 38, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.763 Vali Acc: 0.883 Test Loss: 0.763 Test Acc: 0.883
Validation loss decreased (-0.883326 --> -0.883326).  Saving model ...
Epoch: 39 cost time: 1.010169267654419
Epoch: 39, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.759 Vali Acc: 0.883 Test Loss: 0.759 Test Acc: 0.883
Validation loss decreased (-0.883326 --> -0.883326).  Saving model ...
Epoch: 40 cost time: 1.0955562591552734
Epoch: 40, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.762 Vali Acc: 0.878 Test Loss: 0.762 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.945345401763916
Epoch: 41, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.770 Vali Acc: 0.878 Test Loss: 0.770 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9758889675140381
Epoch: 42, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.761 Vali Acc: 0.872 Test Loss: 0.761 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.0316946506500244
Epoch: 43, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.761 Vali Acc: 0.872 Test Loss: 0.761 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.8807094097137451
Epoch: 44, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.768 Vali Acc: 0.883 Test Loss: 0.768 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.9156718254089355
Epoch: 45, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.801 Vali Acc: 0.867 Test Loss: 0.801 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.0044400691986084
Epoch: 46, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.801 Vali Acc: 0.867 Test Loss: 0.801 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.9534909725189209
Epoch: 47, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.797 Vali Acc: 0.878 Test Loss: 0.797 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.0654101371765137
Epoch: 48, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.805 Vali Acc: 0.872 Test Loss: 0.805 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.0222573280334473
Epoch: 49, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.812 Vali Acc: 0.872 Test Loss: 0.812 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 3999271
model size : 20.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7310962677001953
Epoch: 1, Steps: 12 | Train Loss: 2.830 Vali Loss: 2.704 Vali Acc: 0.100 Test Loss: 2.704 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 0.8184010982513428
Epoch: 2, Steps: 12 | Train Loss: 2.718 Vali Loss: 2.531 Vali Acc: 0.222 Test Loss: 2.531 Test Acc: 0.222
Validation loss decreased (-0.099973 --> -0.222197).  Saving model ...
Epoch: 3 cost time: 0.9509387016296387
Epoch: 3, Steps: 12 | Train Loss: 2.458 Vali Loss: 2.319 Vali Acc: 0.417 Test Loss: 2.319 Test Acc: 0.417
Validation loss decreased (-0.222197 --> -0.416643).  Saving model ...
Epoch: 4 cost time: 1.083465576171875
Epoch: 4, Steps: 12 | Train Loss: 2.222 Vali Loss: 2.072 Vali Acc: 0.500 Test Loss: 2.072 Test Acc: 0.500
Validation loss decreased (-0.416643 --> -0.499979).  Saving model ...
Epoch: 5 cost time: 1.0058114528656006
Epoch: 5, Steps: 12 | Train Loss: 1.908 Vali Loss: 1.859 Vali Acc: 0.506 Test Loss: 1.859 Test Acc: 0.506
Validation loss decreased (-0.499979 --> -0.505537).  Saving model ...
Epoch: 6 cost time: 0.9394717216491699
Epoch: 6, Steps: 12 | Train Loss: 1.604 Vali Loss: 1.598 Vali Acc: 0.583 Test Loss: 1.598 Test Acc: 0.583
Validation loss decreased (-0.505537 --> -0.583317).  Saving model ...
Epoch: 7 cost time: 1.0739483833312988
Epoch: 7, Steps: 12 | Train Loss: 1.425 Vali Loss: 1.448 Vali Acc: 0.578 Test Loss: 1.448 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.016017198562622
Epoch: 8, Steps: 12 | Train Loss: 1.117 Vali Loss: 1.239 Vali Acc: 0.622 Test Loss: 1.239 Test Acc: 0.622
Validation loss decreased (-0.583317 --> -0.622210).  Saving model ...
Epoch: 9 cost time: 0.8675863742828369
Epoch: 9, Steps: 12 | Train Loss: 0.944 Vali Loss: 1.135 Vali Acc: 0.628 Test Loss: 1.135 Test Acc: 0.628
Validation loss decreased (-0.622210 --> -0.627766).  Saving model ...
Epoch: 10 cost time: 0.8619101047515869
Epoch: 10, Steps: 12 | Train Loss: 0.855 Vali Loss: 1.018 Vali Acc: 0.656 Test Loss: 1.018 Test Acc: 0.656
Validation loss decreased (-0.627766 --> -0.655545).  Saving model ...
Epoch: 11 cost time: 0.8610734939575195
Epoch: 11, Steps: 12 | Train Loss: 0.700 Vali Loss: 0.923 Vali Acc: 0.706 Test Loss: 0.923 Test Acc: 0.706
Validation loss decreased (-0.655545 --> -0.705546).  Saving model ...
Epoch: 12 cost time: 0.955345630645752
Epoch: 12, Steps: 12 | Train Loss: 0.566 Vali Loss: 0.835 Vali Acc: 0.689 Test Loss: 0.835 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1384692192077637
Epoch: 13, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.844 Vali Acc: 0.733 Test Loss: 0.844 Test Acc: 0.733
Validation loss decreased (-0.705546 --> -0.733325).  Saving model ...
Epoch: 14 cost time: 1.0591702461242676
Epoch: 14, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.709 Vali Acc: 0.767 Test Loss: 0.709 Test Acc: 0.767
Validation loss decreased (-0.733325 --> -0.766660).  Saving model ...
Epoch: 15 cost time: 0.975175142288208
Epoch: 15, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.695 Vali Acc: 0.822 Test Loss: 0.695 Test Acc: 0.822
Validation loss decreased (-0.766660 --> -0.822215).  Saving model ...
Epoch: 16 cost time: 1.0000712871551514
Epoch: 16, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.660 Vali Acc: 0.800 Test Loss: 0.660 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1777384281158447
Epoch: 17, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.692 Vali Acc: 0.794 Test Loss: 0.692 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.848829984664917
Epoch: 18, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.562 Vali Acc: 0.861 Test Loss: 0.562 Test Acc: 0.861
Validation loss decreased (-0.822215 --> -0.861105).  Saving model ...
Epoch: 19 cost time: 1.0853495597839355
Epoch: 19, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.589 Vali Acc: 0.850 Test Loss: 0.589 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.911980390548706
Epoch: 20, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.655 Vali Acc: 0.833 Test Loss: 0.655 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.125636339187622
Epoch: 21, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.646 Vali Acc: 0.872 Test Loss: 0.646 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872216).  Saving model ...
Epoch: 22 cost time: 0.9833126068115234
Epoch: 22, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.685 Vali Acc: 0.856 Test Loss: 0.685 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.057783842086792
Epoch: 23, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.674 Vali Acc: 0.856 Test Loss: 0.674 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.034022569656372
Epoch: 24, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.674 Vali Acc: 0.867 Test Loss: 0.674 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1499803066253662
Epoch: 25, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.750 Vali Acc: 0.850 Test Loss: 0.750 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9021427631378174
Epoch: 26, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.760 Vali Acc: 0.850 Test Loss: 0.760 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.045785665512085
Epoch: 27, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.689 Vali Acc: 0.867 Test Loss: 0.689 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.043363332748413
Epoch: 28, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.785 Vali Acc: 0.844 Test Loss: 0.785 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.9196183681488037
Epoch: 29, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.770 Vali Acc: 0.867 Test Loss: 0.770 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.924340009689331
Epoch: 30, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.795 Vali Acc: 0.861 Test Loss: 0.795 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.1024994850158691
Epoch: 31, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.810 Vali Acc: 0.867 Test Loss: 0.810 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 3608359
model size : 18.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.708226442337036
Epoch: 1, Steps: 12 | Train Loss: 2.845 Vali Loss: 2.718 Vali Acc: 0.167 Test Loss: 2.718 Test Acc: 0.167
Validation loss decreased (inf --> -0.166639).  Saving model ...
Epoch: 2 cost time: 1.0692753791809082
Epoch: 2, Steps: 12 | Train Loss: 2.602 Vali Loss: 2.522 Vali Acc: 0.172 Test Loss: 2.522 Test Acc: 0.172
Validation loss decreased (-0.166639 --> -0.172197).  Saving model ...
Epoch: 3 cost time: 1.2206530570983887
Epoch: 3, Steps: 12 | Train Loss: 2.339 Vali Loss: 2.273 Vali Acc: 0.433 Test Loss: 2.273 Test Acc: 0.433
Validation loss decreased (-0.172197 --> -0.433311).  Saving model ...
Epoch: 4 cost time: 1.1261956691741943
Epoch: 4, Steps: 12 | Train Loss: 2.069 Vali Loss: 2.071 Vali Acc: 0.439 Test Loss: 2.071 Test Acc: 0.439
Validation loss decreased (-0.433311 --> -0.438868).  Saving model ...
Epoch: 5 cost time: 1.1368529796600342
Epoch: 5, Steps: 12 | Train Loss: 1.820 Vali Loss: 1.834 Vali Acc: 0.556 Test Loss: 1.834 Test Acc: 0.556
Validation loss decreased (-0.438868 --> -0.555537).  Saving model ...
Epoch: 6 cost time: 1.0980658531188965
Epoch: 6, Steps: 12 | Train Loss: 1.606 Vali Loss: 1.613 Vali Acc: 0.533 Test Loss: 1.613 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3947405815124512
Epoch: 7, Steps: 12 | Train Loss: 1.303 Vali Loss: 1.390 Vali Acc: 0.633 Test Loss: 1.390 Test Acc: 0.633
Validation loss decreased (-0.555537 --> -0.633319).  Saving model ...
Epoch: 8 cost time: 1.3625712394714355
Epoch: 8, Steps: 12 | Train Loss: 1.101 Vali Loss: 1.208 Vali Acc: 0.633 Test Loss: 1.208 Test Acc: 0.633
Validation loss decreased (-0.633319 --> -0.633321).  Saving model ...
Epoch: 9 cost time: 1.2033064365386963
Epoch: 9, Steps: 12 | Train Loss: 0.959 Vali Loss: 1.070 Vali Acc: 0.661 Test Loss: 1.070 Test Acc: 0.661
Validation loss decreased (-0.633321 --> -0.661100).  Saving model ...
Epoch: 10 cost time: 1.161125898361206
Epoch: 10, Steps: 12 | Train Loss: 0.737 Vali Loss: 0.958 Vali Acc: 0.706 Test Loss: 0.958 Test Acc: 0.706
Validation loss decreased (-0.661100 --> -0.705546).  Saving model ...
Epoch: 11 cost time: 1.0984992980957031
Epoch: 11, Steps: 12 | Train Loss: 0.587 Vali Loss: 0.863 Vali Acc: 0.706 Test Loss: 0.863 Test Acc: 0.706
Validation loss decreased (-0.705546 --> -0.705547).  Saving model ...
Epoch: 12 cost time: 1.0831091403961182
Epoch: 12, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.774 Vali Acc: 0.772 Test Loss: 0.774 Test Acc: 0.772
Validation loss decreased (-0.705547 --> -0.772214).  Saving model ...
Epoch: 13 cost time: 1.1128911972045898
Epoch: 13, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.757 Vali Acc: 0.728 Test Loss: 0.757 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.145888328552246
Epoch: 14, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.713 Vali Acc: 0.811 Test Loss: 0.713 Test Acc: 0.811
Validation loss decreased (-0.772214 --> -0.811104).  Saving model ...
Epoch: 15 cost time: 1.1765551567077637
Epoch: 15, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.679 Vali Acc: 0.789 Test Loss: 0.679 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0594937801361084
Epoch: 16, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.697 Vali Acc: 0.789 Test Loss: 0.697 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.000152587890625
Epoch: 17, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.610 Vali Acc: 0.844 Test Loss: 0.610 Test Acc: 0.844
Validation loss decreased (-0.811104 --> -0.844438).  Saving model ...
Epoch: 18 cost time: 1.0083320140838623
Epoch: 18, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.612 Vali Acc: 0.833 Test Loss: 0.612 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0049760341644287
Epoch: 19, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.584 Vali Acc: 0.856 Test Loss: 0.584 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855550).  Saving model ...
Epoch: 20 cost time: 1.1376116275787354
Epoch: 20, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.639 Vali Acc: 0.839 Test Loss: 0.639 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0992333889007568
Epoch: 21, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.641 Vali Acc: 0.861 Test Loss: 0.641 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 22 cost time: 1.0191116333007812
Epoch: 22, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.662 Vali Acc: 0.867 Test Loss: 0.662 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866660).  Saving model ...
Epoch: 23 cost time: 1.549443006515503
Epoch: 23, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.640 Vali Acc: 0.856 Test Loss: 0.640 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0692174434661865
Epoch: 24, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.734 Vali Acc: 0.850 Test Loss: 0.734 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1302604675292969
Epoch: 25, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.688 Vali Acc: 0.861 Test Loss: 0.688 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0333786010742188
Epoch: 26, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.737 Vali Acc: 0.867 Test Loss: 0.737 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9537098407745361
Epoch: 27, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.769 Vali Acc: 0.850 Test Loss: 0.769 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9248361587524414
Epoch: 28, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.763 Vali Acc: 0.833 Test Loss: 0.763 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9086043834686279
Epoch: 29, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.756 Vali Acc: 0.861 Test Loss: 0.756 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.1875224113464355
Epoch: 30, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.770 Vali Acc: 0.856 Test Loss: 0.770 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.979799747467041
Epoch: 31, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.738 Vali Acc: 0.867 Test Loss: 0.738 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.0721776485443115
Epoch: 32, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.709 Vali Acc: 0.867 Test Loss: 0.709 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 3607335
model size : 18.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4724106788635254
Epoch: 1, Steps: 12 | Train Loss: 2.768 Vali Loss: 2.680 Vali Acc: 0.061 Test Loss: 2.680 Test Acc: 0.061
Validation loss decreased (inf --> -0.061084).  Saving model ...
Epoch: 2 cost time: 1.1417608261108398
Epoch: 2, Steps: 12 | Train Loss: 2.577 Vali Loss: 2.478 Vali Acc: 0.272 Test Loss: 2.478 Test Acc: 0.272
Validation loss decreased (-0.061084 --> -0.272197).  Saving model ...
Epoch: 3 cost time: 0.8682968616485596
Epoch: 3, Steps: 12 | Train Loss: 2.333 Vali Loss: 2.266 Vali Acc: 0.383 Test Loss: 2.266 Test Acc: 0.383
Validation loss decreased (-0.272197 --> -0.383311).  Saving model ...
Epoch: 4 cost time: 1.0499975681304932
Epoch: 4, Steps: 12 | Train Loss: 2.067 Vali Loss: 2.030 Vali Acc: 0.439 Test Loss: 2.030 Test Acc: 0.439
Validation loss decreased (-0.383311 --> -0.438869).  Saving model ...
Epoch: 5 cost time: 1.020066261291504
Epoch: 5, Steps: 12 | Train Loss: 1.788 Vali Loss: 1.800 Vali Acc: 0.539 Test Loss: 1.800 Test Acc: 0.539
Validation loss decreased (-0.438869 --> -0.538871).  Saving model ...
Epoch: 6 cost time: 0.9552087783813477
Epoch: 6, Steps: 12 | Train Loss: 1.516 Vali Loss: 1.592 Vali Acc: 0.567 Test Loss: 1.592 Test Acc: 0.567
Validation loss decreased (-0.538871 --> -0.566651).  Saving model ...
Epoch: 7 cost time: 0.99664306640625
Epoch: 7, Steps: 12 | Train Loss: 1.330 Vali Loss: 1.354 Vali Acc: 0.583 Test Loss: 1.354 Test Acc: 0.583
Validation loss decreased (-0.566651 --> -0.583320).  Saving model ...
Epoch: 8 cost time: 1.0207912921905518
Epoch: 8, Steps: 12 | Train Loss: 1.130 Vali Loss: 1.183 Vali Acc: 0.656 Test Loss: 1.183 Test Acc: 0.656
Validation loss decreased (-0.583320 --> -0.655544).  Saving model ...
Epoch: 9 cost time: 0.961071252822876
Epoch: 9, Steps: 12 | Train Loss: 0.873 Vali Loss: 1.087 Vali Acc: 0.639 Test Loss: 1.087 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8257150650024414
Epoch: 10, Steps: 12 | Train Loss: 0.721 Vali Loss: 0.950 Vali Acc: 0.722 Test Loss: 0.950 Test Acc: 0.722
Validation loss decreased (-0.655544 --> -0.722213).  Saving model ...
Epoch: 11 cost time: 0.8484506607055664
Epoch: 11, Steps: 12 | Train Loss: 0.637 Vali Loss: 0.891 Vali Acc: 0.694 Test Loss: 0.891 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4176647663116455
Epoch: 12, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.775 Vali Acc: 0.761 Test Loss: 0.775 Test Acc: 0.761
Validation loss decreased (-0.722213 --> -0.761103).  Saving model ...
Epoch: 13 cost time: 1.0202198028564453
Epoch: 13, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.728 Vali Acc: 0.750 Test Loss: 0.728 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.969965934753418
Epoch: 14, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.657 Vali Acc: 0.811 Test Loss: 0.657 Test Acc: 0.811
Validation loss decreased (-0.761103 --> -0.811105).  Saving model ...
Epoch: 15 cost time: 1.022965908050537
Epoch: 15, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.672 Vali Acc: 0.778 Test Loss: 0.672 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2282347679138184
Epoch: 16, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.588 Vali Acc: 0.806 Test Loss: 0.588 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9280006885528564
Epoch: 17, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.552 Vali Acc: 0.833 Test Loss: 0.552 Test Acc: 0.833
Validation loss decreased (-0.811105 --> -0.833328).  Saving model ...
Epoch: 18 cost time: 0.9692111015319824
Epoch: 18, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.636 Vali Acc: 0.828 Test Loss: 0.636 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9370031356811523
Epoch: 19, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.685 Vali Acc: 0.811 Test Loss: 0.685 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0891022682189941
Epoch: 20, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.626 Vali Acc: 0.817 Test Loss: 0.626 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.112487554550171
Epoch: 21, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.602 Vali Acc: 0.833 Test Loss: 0.602 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.923816442489624
Epoch: 22, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.644 Vali Acc: 0.833 Test Loss: 0.644 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9648699760437012
Epoch: 23, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.606 Vali Acc: 0.861 Test Loss: 0.606 Test Acc: 0.861
Validation loss decreased (-0.833328 --> -0.861105).  Saving model ...
Epoch: 24 cost time: 0.9961452484130859
Epoch: 24, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.606 Vali Acc: 0.872 Test Loss: 0.606 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872216).  Saving model ...
Epoch: 25 cost time: 1.0167462825775146
Epoch: 25, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.667 Vali Acc: 0.867 Test Loss: 0.667 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0851194858551025
Epoch: 26, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.651 Vali Acc: 0.850 Test Loss: 0.651 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.020082712173462
Epoch: 27, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.669 Vali Acc: 0.856 Test Loss: 0.669 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9503331184387207
Epoch: 28, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.665 Vali Acc: 0.844 Test Loss: 0.665 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8219585418701172
Epoch: 29, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.744 Vali Acc: 0.844 Test Loss: 0.744 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9370291233062744
Epoch: 30, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.699 Vali Acc: 0.867 Test Loss: 0.699 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.8876633644104004
Epoch: 31, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.702 Vali Acc: 0.861 Test Loss: 0.702 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.080232858657837
Epoch: 32, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.672 Vali Acc: 0.850 Test Loss: 0.672 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.0360982418060303
Epoch: 33, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.641 Vali Acc: 0.850 Test Loss: 0.641 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.9243755340576172
Epoch: 34, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.695 Vali Acc: 0.856 Test Loss: 0.695 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 3606311
model size : 18.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6008689403533936
Epoch: 1, Steps: 12 | Train Loss: 2.867 Vali Loss: 2.693 Vali Acc: 0.033 Test Loss: 2.693 Test Acc: 0.033
Validation loss decreased (inf --> -0.033306).  Saving model ...
Epoch: 2 cost time: 0.9040737152099609
Epoch: 2, Steps: 12 | Train Loss: 2.587 Vali Loss: 2.526 Vali Acc: 0.222 Test Loss: 2.526 Test Acc: 0.222
Validation loss decreased (-0.033306 --> -0.222197).  Saving model ...
Epoch: 3 cost time: 1.0206470489501953
Epoch: 3, Steps: 12 | Train Loss: 2.392 Vali Loss: 2.265 Vali Acc: 0.383 Test Loss: 2.265 Test Acc: 0.383
Validation loss decreased (-0.222197 --> -0.383311).  Saving model ...
Epoch: 4 cost time: 1.0971026420593262
Epoch: 4, Steps: 12 | Train Loss: 2.118 Vali Loss: 2.025 Vali Acc: 0.472 Test Loss: 2.025 Test Acc: 0.472
Validation loss decreased (-0.383311 --> -0.472202).  Saving model ...
Epoch: 5 cost time: 1.0345299243927002
Epoch: 5, Steps: 12 | Train Loss: 1.825 Vali Loss: 1.787 Vali Acc: 0.567 Test Loss: 1.787 Test Acc: 0.567
Validation loss decreased (-0.472202 --> -0.566649).  Saving model ...
Epoch: 6 cost time: 1.049056053161621
Epoch: 6, Steps: 12 | Train Loss: 1.524 Vali Loss: 1.519 Vali Acc: 0.611 Test Loss: 1.519 Test Acc: 0.611
Validation loss decreased (-0.566649 --> -0.611096).  Saving model ...
Epoch: 7 cost time: 1.0204894542694092
Epoch: 7, Steps: 12 | Train Loss: 1.317 Vali Loss: 1.317 Vali Acc: 0.628 Test Loss: 1.317 Test Acc: 0.628
Validation loss decreased (-0.611096 --> -0.627765).  Saving model ...
Epoch: 8 cost time: 1.168039083480835
Epoch: 8, Steps: 12 | Train Loss: 1.106 Vali Loss: 1.133 Vali Acc: 0.672 Test Loss: 1.133 Test Acc: 0.672
Validation loss decreased (-0.627765 --> -0.672211).  Saving model ...
Epoch: 9 cost time: 0.8734931945800781
Epoch: 9, Steps: 12 | Train Loss: 0.874 Vali Loss: 1.031 Vali Acc: 0.661 Test Loss: 1.031 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8938744068145752
Epoch: 10, Steps: 12 | Train Loss: 0.752 Vali Loss: 0.918 Vali Acc: 0.717 Test Loss: 0.918 Test Acc: 0.717
Validation loss decreased (-0.672211 --> -0.716657).  Saving model ...
Epoch: 11 cost time: 0.9147894382476807
Epoch: 11, Steps: 12 | Train Loss: 0.608 Vali Loss: 0.893 Vali Acc: 0.722 Test Loss: 0.893 Test Acc: 0.722
Validation loss decreased (-0.716657 --> -0.722213).  Saving model ...
Epoch: 12 cost time: 1.0508837699890137
Epoch: 12, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.809 Vali Acc: 0.739 Test Loss: 0.809 Test Acc: 0.739
Validation loss decreased (-0.722213 --> -0.738881).  Saving model ...
Epoch: 13 cost time: 0.9605119228363037
Epoch: 13, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.748 Vali Acc: 0.761 Test Loss: 0.748 Test Acc: 0.761
Validation loss decreased (-0.738881 --> -0.761104).  Saving model ...
Epoch: 14 cost time: 1.0125997066497803
Epoch: 14, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.729 Vali Acc: 0.817 Test Loss: 0.729 Test Acc: 0.817
Validation loss decreased (-0.761104 --> -0.816659).  Saving model ...
Epoch: 15 cost time: 1.1761589050292969
Epoch: 15, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.677 Vali Acc: 0.811 Test Loss: 0.677 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0794284343719482
Epoch: 16, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.627 Vali Acc: 0.828 Test Loss: 0.627 Test Acc: 0.828
Validation loss decreased (-0.816659 --> -0.827772).  Saving model ...
Epoch: 17 cost time: 0.9677700996398926
Epoch: 17, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.631 Vali Acc: 0.861 Test Loss: 0.631 Test Acc: 0.861
Validation loss decreased (-0.827772 --> -0.861105).  Saving model ...
Epoch: 18 cost time: 0.9274816513061523
Epoch: 18, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.591 Vali Acc: 0.828 Test Loss: 0.591 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0091578960418701
Epoch: 19, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.575 Vali Acc: 0.844 Test Loss: 0.575 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1075639724731445
Epoch: 20, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.699 Vali Acc: 0.822 Test Loss: 0.699 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0251200199127197
Epoch: 21, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.568 Vali Acc: 0.856 Test Loss: 0.568 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.211153268814087
Epoch: 22, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.596 Vali Acc: 0.878 Test Loss: 0.596 Test Acc: 0.878
Validation loss decreased (-0.861105 --> -0.877772).  Saving model ...
Epoch: 23 cost time: 0.9874165058135986
Epoch: 23, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.586 Vali Acc: 0.872 Test Loss: 0.586 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.001438856124878
Epoch: 24, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.624 Vali Acc: 0.872 Test Loss: 0.624 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.993004322052002
Epoch: 25, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.613 Vali Acc: 0.867 Test Loss: 0.613 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.1121084690093994
Epoch: 26, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.577 Vali Acc: 0.889 Test Loss: 0.577 Test Acc: 0.889
Validation loss decreased (-0.877772 --> -0.888883).  Saving model ...
Epoch: 27 cost time: 1.0290186405181885
Epoch: 27, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.602 Vali Acc: 0.883 Test Loss: 0.602 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0627598762512207
Epoch: 28, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.615 Vali Acc: 0.872 Test Loss: 0.615 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.156869888305664
Epoch: 29, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.573 Vali Acc: 0.878 Test Loss: 0.573 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.1546440124511719
Epoch: 30, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.587 Vali Acc: 0.878 Test Loss: 0.587 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9410836696624756
Epoch: 31, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.635 Vali Acc: 0.872 Test Loss: 0.635 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.1641654968261719
Epoch: 32, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.641 Vali Acc: 0.861 Test Loss: 0.641 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.059720516204834
Epoch: 33, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.594 Vali Acc: 0.867 Test Loss: 0.594 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.047957181930542
Epoch: 34, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.579 Vali Acc: 0.883 Test Loss: 0.579 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.15749192237854
Epoch: 35, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.559 Vali Acc: 0.878 Test Loss: 0.559 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.1016111373901367
Epoch: 36, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.581 Vali Acc: 0.878 Test Loss: 0.581 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 3605287
model size : 18.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5246903896331787
Epoch: 1, Steps: 12 | Train Loss: 2.847 Vali Loss: 2.771 Vali Acc: 0.056 Test Loss: 2.771 Test Acc: 0.056
Validation loss decreased (inf --> -0.055528).  Saving model ...
Epoch: 2 cost time: 1.018711805343628
Epoch: 2, Steps: 12 | Train Loss: 2.653 Vali Loss: 2.620 Vali Acc: 0.150 Test Loss: 2.620 Test Acc: 0.150
Validation loss decreased (-0.055528 --> -0.149974).  Saving model ...
Epoch: 3 cost time: 1.0186424255371094
Epoch: 3, Steps: 12 | Train Loss: 2.426 Vali Loss: 2.365 Vali Acc: 0.367 Test Loss: 2.365 Test Acc: 0.367
Validation loss decreased (-0.149974 --> -0.366643).  Saving model ...
Epoch: 4 cost time: 1.013906478881836
Epoch: 4, Steps: 12 | Train Loss: 2.187 Vali Loss: 2.130 Vali Acc: 0.478 Test Loss: 2.130 Test Acc: 0.478
Validation loss decreased (-0.366643 --> -0.477756).  Saving model ...
Epoch: 5 cost time: 0.9561135768890381
Epoch: 5, Steps: 12 | Train Loss: 1.894 Vali Loss: 1.879 Vali Acc: 0.517 Test Loss: 1.879 Test Acc: 0.517
Validation loss decreased (-0.477756 --> -0.516648).  Saving model ...
Epoch: 6 cost time: 0.8956503868103027
Epoch: 6, Steps: 12 | Train Loss: 1.576 Vali Loss: 1.613 Vali Acc: 0.522 Test Loss: 1.613 Test Acc: 0.522
Validation loss decreased (-0.516648 --> -0.522206).  Saving model ...
Epoch: 7 cost time: 0.9461252689361572
Epoch: 7, Steps: 12 | Train Loss: 1.363 Vali Loss: 1.415 Vali Acc: 0.589 Test Loss: 1.415 Test Acc: 0.589
Validation loss decreased (-0.522206 --> -0.588875).  Saving model ...
Epoch: 8 cost time: 1.0430808067321777
Epoch: 8, Steps: 12 | Train Loss: 1.111 Vali Loss: 1.243 Vali Acc: 0.606 Test Loss: 1.243 Test Acc: 0.606
Validation loss decreased (-0.588875 --> -0.605543).  Saving model ...
Epoch: 9 cost time: 1.0178096294403076
Epoch: 9, Steps: 12 | Train Loss: 1.029 Vali Loss: 1.113 Vali Acc: 0.644 Test Loss: 1.113 Test Acc: 0.644
Validation loss decreased (-0.605543 --> -0.644433).  Saving model ...
Epoch: 10 cost time: 1.0783114433288574
Epoch: 10, Steps: 12 | Train Loss: 0.821 Vali Loss: 1.017 Vali Acc: 0.694 Test Loss: 1.017 Test Acc: 0.694
Validation loss decreased (-0.644433 --> -0.694434).  Saving model ...
Epoch: 11 cost time: 1.1511356830596924
Epoch: 11, Steps: 12 | Train Loss: 0.740 Vali Loss: 0.903 Vali Acc: 0.689 Test Loss: 0.903 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.116565227508545
Epoch: 12, Steps: 12 | Train Loss: 0.597 Vali Loss: 0.859 Vali Acc: 0.711 Test Loss: 0.859 Test Acc: 0.711
Validation loss decreased (-0.694434 --> -0.711103).  Saving model ...
Epoch: 13 cost time: 1.0647716522216797
Epoch: 13, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.771 Vali Acc: 0.744 Test Loss: 0.771 Test Acc: 0.744
Validation loss decreased (-0.711103 --> -0.744437).  Saving model ...
Epoch: 14 cost time: 1.1068906784057617
Epoch: 14, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.812 Vali Acc: 0.739 Test Loss: 0.812 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.214888572692871
Epoch: 15, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.637 Vali Acc: 0.822 Test Loss: 0.637 Test Acc: 0.822
Validation loss decreased (-0.744437 --> -0.822216).  Saving model ...
Epoch: 16 cost time: 0.9761719703674316
Epoch: 16, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.645 Vali Acc: 0.822 Test Loss: 0.645 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0376560688018799
Epoch: 17, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.575 Vali Acc: 0.856 Test Loss: 0.575 Test Acc: 0.856
Validation loss decreased (-0.822216 --> -0.855550).  Saving model ...
Epoch: 18 cost time: 1.0812110900878906
Epoch: 18, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.614 Vali Acc: 0.867 Test Loss: 0.614 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 19 cost time: 1.0297143459320068
Epoch: 19, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.676 Vali Acc: 0.833 Test Loss: 0.676 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1604554653167725
Epoch: 20, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.627 Vali Acc: 0.844 Test Loss: 0.627 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9619128704071045
Epoch: 21, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.684 Vali Acc: 0.856 Test Loss: 0.684 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0681672096252441
Epoch: 22, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.651 Vali Acc: 0.850 Test Loss: 0.651 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0630683898925781
Epoch: 23, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.716 Vali Acc: 0.850 Test Loss: 0.716 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0389890670776367
Epoch: 24, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.598 Vali Acc: 0.839 Test Loss: 0.598 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0538055896759033
Epoch: 25, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.847 Vali Acc: 0.839 Test Loss: 0.847 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9741196632385254
Epoch: 26, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.758 Vali Acc: 0.861 Test Loss: 0.758 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9301342964172363
Epoch: 27, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.783 Vali Acc: 0.844 Test Loss: 0.783 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9130523204803467
Epoch: 28, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.790 Vali Acc: 0.850 Test Loss: 0.790 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 3411367
model size : 17.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.414462089538574
Epoch: 1, Steps: 12 | Train Loss: 2.865 Vali Loss: 2.726 Vali Acc: 0.111 Test Loss: 2.726 Test Acc: 0.111
Validation loss decreased (inf --> -0.111084).  Saving model ...
Epoch: 2 cost time: 0.9991297721862793
Epoch: 2, Steps: 12 | Train Loss: 2.661 Vali Loss: 2.535 Vali Acc: 0.222 Test Loss: 2.535 Test Acc: 0.222
Validation loss decreased (-0.111084 --> -0.222197).  Saving model ...
Epoch: 3 cost time: 1.1295442581176758
Epoch: 3, Steps: 12 | Train Loss: 2.411 Vali Loss: 2.321 Vali Acc: 0.383 Test Loss: 2.321 Test Acc: 0.383
Validation loss decreased (-0.222197 --> -0.383310).  Saving model ...
Epoch: 4 cost time: 1.2384212017059326
Epoch: 4, Steps: 12 | Train Loss: 2.148 Vali Loss: 2.093 Vali Acc: 0.456 Test Loss: 2.093 Test Acc: 0.456
Validation loss decreased (-0.383310 --> -0.455535).  Saving model ...
Epoch: 5 cost time: 0.9371800422668457
Epoch: 5, Steps: 12 | Train Loss: 1.860 Vali Loss: 1.809 Vali Acc: 0.550 Test Loss: 1.809 Test Acc: 0.550
Validation loss decreased (-0.455535 --> -0.549982).  Saving model ...
Epoch: 6 cost time: 0.8805515766143799
Epoch: 6, Steps: 12 | Train Loss: 1.556 Vali Loss: 1.556 Vali Acc: 0.594 Test Loss: 1.556 Test Acc: 0.594
Validation loss decreased (-0.549982 --> -0.594429).  Saving model ...
Epoch: 7 cost time: 0.964512825012207
Epoch: 7, Steps: 12 | Train Loss: 1.333 Vali Loss: 1.349 Vali Acc: 0.617 Test Loss: 1.349 Test Acc: 0.617
Validation loss decreased (-0.594429 --> -0.616653).  Saving model ...
Epoch: 8 cost time: 0.989473819732666
Epoch: 8, Steps: 12 | Train Loss: 1.043 Vali Loss: 1.203 Vali Acc: 0.639 Test Loss: 1.203 Test Acc: 0.639
Validation loss decreased (-0.616653 --> -0.638877).  Saving model ...
Epoch: 9 cost time: 0.9621362686157227
Epoch: 9, Steps: 12 | Train Loss: 0.879 Vali Loss: 1.060 Vali Acc: 0.639 Test Loss: 1.060 Test Acc: 0.639
Validation loss decreased (-0.638877 --> -0.638878).  Saving model ...
Epoch: 10 cost time: 1.089773178100586
Epoch: 10, Steps: 12 | Train Loss: 0.782 Vali Loss: 0.956 Vali Acc: 0.700 Test Loss: 0.956 Test Acc: 0.700
Validation loss decreased (-0.638878 --> -0.699990).  Saving model ...
Epoch: 11 cost time: 1.134779453277588
Epoch: 11, Steps: 12 | Train Loss: 0.636 Vali Loss: 0.878 Vali Acc: 0.733 Test Loss: 0.878 Test Acc: 0.733
Validation loss decreased (-0.699990 --> -0.733325).  Saving model ...
Epoch: 12 cost time: 0.9599330425262451
Epoch: 12, Steps: 12 | Train Loss: 0.577 Vali Loss: 0.826 Vali Acc: 0.706 Test Loss: 0.826 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0548133850097656
Epoch: 13, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.689 Vali Acc: 0.806 Test Loss: 0.689 Test Acc: 0.806
Validation loss decreased (-0.733325 --> -0.805549).  Saving model ...
Epoch: 14 cost time: 0.8292741775512695
Epoch: 14, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.656 Vali Acc: 0.772 Test Loss: 0.656 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9682111740112305
Epoch: 15, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.692 Vali Acc: 0.806 Test Loss: 0.692 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.124621868133545
Epoch: 16, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.697 Vali Acc: 0.822 Test Loss: 0.697 Test Acc: 0.822
Validation loss decreased (-0.805549 --> -0.822215).  Saving model ...
Epoch: 17 cost time: 0.9808218479156494
Epoch: 17, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.667 Vali Acc: 0.822 Test Loss: 0.667 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822216).  Saving model ...
Epoch: 18 cost time: 1.0097031593322754
Epoch: 18, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.671 Vali Acc: 0.817 Test Loss: 0.671 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0145354270935059
Epoch: 19, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.736 Vali Acc: 0.828 Test Loss: 0.736 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827770).  Saving model ...
Epoch: 20 cost time: 1.0965931415557861
Epoch: 20, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.693 Vali Acc: 0.833 Test Loss: 0.693 Test Acc: 0.833
Validation loss decreased (-0.827770 --> -0.833326).  Saving model ...
Epoch: 21 cost time: 1.0976624488830566
Epoch: 21, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.649 Vali Acc: 0.850 Test Loss: 0.649 Test Acc: 0.850
Validation loss decreased (-0.833326 --> -0.849994).  Saving model ...
Epoch: 22 cost time: 0.9717249870300293
Epoch: 22, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.691 Vali Acc: 0.861 Test Loss: 0.691 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861104).  Saving model ...
Epoch: 23 cost time: 0.8479611873626709
Epoch: 23, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.718 Vali Acc: 0.839 Test Loss: 0.718 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.953913688659668
Epoch: 24, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.753 Vali Acc: 0.844 Test Loss: 0.753 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9910593032836914
Epoch: 25, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.776 Vali Acc: 0.839 Test Loss: 0.776 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9690148830413818
Epoch: 26, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.721 Vali Acc: 0.856 Test Loss: 0.721 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.026292085647583
Epoch: 27, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.728 Vali Acc: 0.861 Test Loss: 0.728 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.0696709156036377
Epoch: 28, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.751 Vali Acc: 0.856 Test Loss: 0.751 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0866320133209229
Epoch: 29, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.803 Vali Acc: 0.856 Test Loss: 0.803 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.001084804534912
Epoch: 30, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.813 Vali Acc: 0.839 Test Loss: 0.813 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.8924951553344727
Epoch: 31, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.871 Vali Acc: 0.844 Test Loss: 0.871 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.0006427764892578
Epoch: 32, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.934 Vali Acc: 0.828 Test Loss: 0.934 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 3410343
model size : 17.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.752316474914551
Epoch: 1, Steps: 12 | Train Loss: 2.883 Vali Loss: 2.658 Vali Acc: 0.089 Test Loss: 2.658 Test Acc: 0.089
Validation loss decreased (inf --> -0.088862).  Saving model ...
Epoch: 2 cost time: 1.0780961513519287
Epoch: 2, Steps: 12 | Train Loss: 2.671 Vali Loss: 2.484 Vali Acc: 0.322 Test Loss: 2.484 Test Acc: 0.322
Validation loss decreased (-0.088862 --> -0.322197).  Saving model ...
Epoch: 3 cost time: 1.5379962921142578
Epoch: 3, Steps: 12 | Train Loss: 2.453 Vali Loss: 2.260 Vali Acc: 0.411 Test Loss: 2.260 Test Acc: 0.411
Validation loss decreased (-0.322197 --> -0.411089).  Saving model ...
Epoch: 4 cost time: 1.0511808395385742
Epoch: 4, Steps: 12 | Train Loss: 2.165 Vali Loss: 2.019 Vali Acc: 0.494 Test Loss: 2.019 Test Acc: 0.494
Validation loss decreased (-0.411089 --> -0.494424).  Saving model ...
Epoch: 5 cost time: 0.8774664402008057
Epoch: 5, Steps: 12 | Train Loss: 1.871 Vali Loss: 1.794 Vali Acc: 0.544 Test Loss: 1.794 Test Acc: 0.544
Validation loss decreased (-0.494424 --> -0.544427).  Saving model ...
Epoch: 6 cost time: 0.8906381130218506
Epoch: 6, Steps: 12 | Train Loss: 1.586 Vali Loss: 1.551 Vali Acc: 0.561 Test Loss: 1.551 Test Acc: 0.561
Validation loss decreased (-0.544427 --> -0.561096).  Saving model ...
Epoch: 7 cost time: 1.1384775638580322
Epoch: 7, Steps: 12 | Train Loss: 1.358 Vali Loss: 1.383 Vali Acc: 0.622 Test Loss: 1.383 Test Acc: 0.622
Validation loss decreased (-0.561096 --> -0.622208).  Saving model ...
Epoch: 8 cost time: 1.1461012363433838
Epoch: 8, Steps: 12 | Train Loss: 1.173 Vali Loss: 1.215 Vali Acc: 0.606 Test Loss: 1.215 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1935539245605469
Epoch: 9, Steps: 12 | Train Loss: 0.937 Vali Loss: 1.063 Vali Acc: 0.661 Test Loss: 1.063 Test Acc: 0.661
Validation loss decreased (-0.622208 --> -0.661100).  Saving model ...
Epoch: 10 cost time: 0.9220266342163086
Epoch: 10, Steps: 12 | Train Loss: 0.761 Vali Loss: 0.954 Vali Acc: 0.722 Test Loss: 0.954 Test Acc: 0.722
Validation loss decreased (-0.661100 --> -0.722213).  Saving model ...
Epoch: 11 cost time: 1.0497305393218994
Epoch: 11, Steps: 12 | Train Loss: 0.618 Vali Loss: 0.859 Vali Acc: 0.711 Test Loss: 0.859 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3208820819854736
Epoch: 12, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.761 Vali Acc: 0.772 Test Loss: 0.761 Test Acc: 0.772
Validation loss decreased (-0.722213 --> -0.772215).  Saving model ...
Epoch: 13 cost time: 1.3161892890930176
Epoch: 13, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.680 Vali Acc: 0.800 Test Loss: 0.680 Test Acc: 0.800
Validation loss decreased (-0.772215 --> -0.799993).  Saving model ...
Epoch: 14 cost time: 1.2668848037719727
Epoch: 14, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.667 Vali Acc: 0.772 Test Loss: 0.667 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0719454288482666
Epoch: 15, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.612 Vali Acc: 0.833 Test Loss: 0.612 Test Acc: 0.833
Validation loss decreased (-0.799993 --> -0.833327).  Saving model ...
Epoch: 16 cost time: 1.0900800228118896
Epoch: 16, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.609 Vali Acc: 0.856 Test Loss: 0.609 Test Acc: 0.856
Validation loss decreased (-0.833327 --> -0.855549).  Saving model ...
Epoch: 17 cost time: 1.0451486110687256
Epoch: 17, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.625 Vali Acc: 0.839 Test Loss: 0.625 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0745823383331299
Epoch: 18, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.569 Vali Acc: 0.839 Test Loss: 0.569 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9550924301147461
Epoch: 19, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.654 Vali Acc: 0.811 Test Loss: 0.654 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1304209232330322
Epoch: 20, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.579 Vali Acc: 0.867 Test Loss: 0.579 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866661).  Saving model ...
Epoch: 21 cost time: 1.2937469482421875
Epoch: 21, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.660 Vali Acc: 0.844 Test Loss: 0.660 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4385106563568115
Epoch: 22, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.698 Vali Acc: 0.867 Test Loss: 0.698 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5333139896392822
Epoch: 23, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.676 Vali Acc: 0.850 Test Loss: 0.676 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1609809398651123
Epoch: 24, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.650 Vali Acc: 0.861 Test Loss: 0.650 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.958587646484375
Epoch: 25, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.645 Vali Acc: 0.867 Test Loss: 0.645 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2302210330963135
Epoch: 26, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.714 Vali Acc: 0.856 Test Loss: 0.714 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.361419439315796
Epoch: 27, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.756 Vali Acc: 0.867 Test Loss: 0.756 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.3865008354187012
Epoch: 28, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.742 Vali Acc: 0.856 Test Loss: 0.742 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.2269442081451416
Epoch: 29, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.698 Vali Acc: 0.867 Test Loss: 0.698 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.0627171993255615
Epoch: 30, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.725 Vali Acc: 0.867 Test Loss: 0.725 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 3409319
model size : 17.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7776100635528564
Epoch: 1, Steps: 12 | Train Loss: 2.919 Vali Loss: 2.789 Vali Acc: 0.061 Test Loss: 2.789 Test Acc: 0.061
Validation loss decreased (inf --> -0.061083).  Saving model ...
Epoch: 2 cost time: 1.0479891300201416
Epoch: 2, Steps: 12 | Train Loss: 2.695 Vali Loss: 2.569 Vali Acc: 0.172 Test Loss: 2.569 Test Acc: 0.172
Validation loss decreased (-0.061083 --> -0.172197).  Saving model ...
Epoch: 3 cost time: 0.8815641403198242
Epoch: 3, Steps: 12 | Train Loss: 2.507 Vali Loss: 2.346 Vali Acc: 0.417 Test Loss: 2.346 Test Acc: 0.417
Validation loss decreased (-0.172197 --> -0.416643).  Saving model ...
Epoch: 4 cost time: 1.0324528217315674
Epoch: 4, Steps: 12 | Train Loss: 2.242 Vali Loss: 2.110 Vali Acc: 0.439 Test Loss: 2.110 Test Acc: 0.439
Validation loss decreased (-0.416643 --> -0.438868).  Saving model ...
Epoch: 5 cost time: 1.0173554420471191
Epoch: 5, Steps: 12 | Train Loss: 1.978 Vali Loss: 1.873 Vali Acc: 0.572 Test Loss: 1.873 Test Acc: 0.572
Validation loss decreased (-0.438868 --> -0.572203).  Saving model ...
Epoch: 6 cost time: 0.9165198802947998
Epoch: 6, Steps: 12 | Train Loss: 1.619 Vali Loss: 1.619 Vali Acc: 0.567 Test Loss: 1.619 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0265390872955322
Epoch: 7, Steps: 12 | Train Loss: 1.390 Vali Loss: 1.378 Vali Acc: 0.622 Test Loss: 1.378 Test Acc: 0.622
Validation loss decreased (-0.572203 --> -0.622208).  Saving model ...
Epoch: 8 cost time: 0.999645471572876
Epoch: 8, Steps: 12 | Train Loss: 1.141 Vali Loss: 1.220 Vali Acc: 0.600 Test Loss: 1.220 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.163722276687622
Epoch: 9, Steps: 12 | Train Loss: 1.033 Vali Loss: 1.100 Vali Acc: 0.656 Test Loss: 1.100 Test Acc: 0.656
Validation loss decreased (-0.622208 --> -0.655545).  Saving model ...
Epoch: 10 cost time: 0.927140474319458
Epoch: 10, Steps: 12 | Train Loss: 0.781 Vali Loss: 1.032 Vali Acc: 0.639 Test Loss: 1.032 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9305834770202637
Epoch: 11, Steps: 12 | Train Loss: 0.637 Vali Loss: 0.861 Vali Acc: 0.722 Test Loss: 0.861 Test Acc: 0.722
Validation loss decreased (-0.655545 --> -0.722214).  Saving model ...
Epoch: 12 cost time: 0.9898638725280762
Epoch: 12, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.806 Vali Acc: 0.717 Test Loss: 0.806 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2216713428497314
Epoch: 13, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.722 Vali Acc: 0.750 Test Loss: 0.722 Test Acc: 0.750
Validation loss decreased (-0.722214 --> -0.749993).  Saving model ...
Epoch: 14 cost time: 1.0866386890411377
Epoch: 14, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.690 Vali Acc: 0.744 Test Loss: 0.690 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.226797342300415
Epoch: 15, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.713 Vali Acc: 0.733 Test Loss: 0.713 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0077929496765137
Epoch: 16, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.620 Vali Acc: 0.794 Test Loss: 0.620 Test Acc: 0.794
Validation loss decreased (-0.749993 --> -0.794438).  Saving model ...
Epoch: 17 cost time: 1.0906152725219727
Epoch: 17, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.673 Vali Acc: 0.767 Test Loss: 0.673 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9365241527557373
Epoch: 18, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.585 Vali Acc: 0.839 Test Loss: 0.585 Test Acc: 0.839
Validation loss decreased (-0.794438 --> -0.838883).  Saving model ...
Epoch: 19 cost time: 1.1014325618743896
Epoch: 19, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.663 Vali Acc: 0.806 Test Loss: 0.663 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.94950270652771
Epoch: 20, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.602 Vali Acc: 0.828 Test Loss: 0.602 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.023129940032959
Epoch: 21, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.685 Vali Acc: 0.817 Test Loss: 0.685 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1814239025115967
Epoch: 22, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.594 Vali Acc: 0.833 Test Loss: 0.594 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2346038818359375
Epoch: 23, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.631 Vali Acc: 0.856 Test Loss: 0.631 Test Acc: 0.856
Validation loss decreased (-0.838883 --> -0.855549).  Saving model ...
Epoch: 24 cost time: 1.0293200016021729
Epoch: 24, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.604 Vali Acc: 0.850 Test Loss: 0.604 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0433380603790283
Epoch: 25, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.699 Vali Acc: 0.850 Test Loss: 0.699 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9768602848052979
Epoch: 26, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.688 Vali Acc: 0.828 Test Loss: 0.688 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9486227035522461
Epoch: 27, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.624 Vali Acc: 0.861 Test Loss: 0.624 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 28 cost time: 1.0124976634979248
Epoch: 28, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.629 Vali Acc: 0.861 Test Loss: 0.629 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0352208614349365
Epoch: 29, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.753 Vali Acc: 0.833 Test Loss: 0.753 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9576120376586914
Epoch: 30, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.704 Vali Acc: 0.856 Test Loss: 0.704 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.0175368785858154
Epoch: 31, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.759 Vali Acc: 0.861 Test Loss: 0.759 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8869259357452393
Epoch: 32, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.698 Vali Acc: 0.872 Test Loss: 0.698 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872215).  Saving model ...
Epoch: 33 cost time: 1.2129199504852295
Epoch: 33, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.703 Vali Acc: 0.850 Test Loss: 0.703 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0960605144500732
Epoch: 34, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.784 Vali Acc: 0.867 Test Loss: 0.784 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0140070915222168
Epoch: 35, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.847 Vali Acc: 0.878 Test Loss: 0.847 Test Acc: 0.878
Validation loss decreased (-0.872215 --> -0.877769).  Saving model ...
Epoch: 36 cost time: 0.8924026489257812
Epoch: 36, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.821 Vali Acc: 0.822 Test Loss: 0.821 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9307081699371338
Epoch: 37, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.865 Vali Acc: 0.861 Test Loss: 0.865 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.0644047260284424
Epoch: 38, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.672 Vali Acc: 0.861 Test Loss: 0.672 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.040517807006836
Epoch: 39, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.764 Vali Acc: 0.850 Test Loss: 0.764 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.0038268566131592
Epoch: 40, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.765 Vali Acc: 0.856 Test Loss: 0.765 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.8565452098846436
Epoch: 41, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.698 Vali Acc: 0.856 Test Loss: 0.698 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.8251214027404785
Epoch: 42, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.695 Vali Acc: 0.872 Test Loss: 0.695 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.0587115287780762
Epoch: 43, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.680 Vali Acc: 0.889 Test Loss: 0.680 Test Acc: 0.889
Validation loss decreased (-0.877769 --> -0.888882).  Saving model ...
Epoch: 44 cost time: 1.009087324142456
Epoch: 44, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.689 Vali Acc: 0.883 Test Loss: 0.689 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.9964978694915771
Epoch: 45, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.693 Vali Acc: 0.872 Test Loss: 0.693 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.0726604461669922
Epoch: 46, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.760 Vali Acc: 0.867 Test Loss: 0.760 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.0002331733703613
Epoch: 47, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.850 Vali Acc: 0.850 Test Loss: 0.850 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.791924238204956
Epoch: 48, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.778 Vali Acc: 0.856 Test Loss: 0.778 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.9443707466125488
Epoch: 49, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.766 Vali Acc: 0.867 Test Loss: 0.766 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.8374872207641602
Epoch: 50, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.759 Vali Acc: 0.872 Test Loss: 0.759 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.8603460788726807
Epoch: 51, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.783 Vali Acc: 0.872 Test Loss: 0.783 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.037106990814209
Epoch: 52, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.782 Vali Acc: 0.878 Test Loss: 0.782 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.9697544574737549
Epoch: 53, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.769 Vali Acc: 0.878 Test Loss: 0.769 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 3408295
model size : 17.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.511277914047241
Epoch: 1, Steps: 12 | Train Loss: 2.927 Vali Loss: 2.782 Vali Acc: 0.067 Test Loss: 2.782 Test Acc: 0.067
Validation loss decreased (inf --> -0.066639).  Saving model ...
Epoch: 2 cost time: 1.0579922199249268
Epoch: 2, Steps: 12 | Train Loss: 2.677 Vali Loss: 2.580 Vali Acc: 0.111 Test Loss: 2.580 Test Acc: 0.111
Validation loss decreased (-0.066639 --> -0.111085).  Saving model ...
Epoch: 3 cost time: 1.0868794918060303
Epoch: 3, Steps: 12 | Train Loss: 2.591 Vali Loss: 2.437 Vali Acc: 0.239 Test Loss: 2.437 Test Acc: 0.239
Validation loss decreased (-0.111085 --> -0.238865).  Saving model ...
Epoch: 4 cost time: 0.773353099822998
Epoch: 4, Steps: 12 | Train Loss: 2.384 Vali Loss: 2.279 Vali Acc: 0.450 Test Loss: 2.279 Test Acc: 0.450
Validation loss decreased (-0.238865 --> -0.449977).  Saving model ...
Epoch: 5 cost time: 0.917212724685669
Epoch: 5, Steps: 12 | Train Loss: 2.163 Vali Loss: 2.106 Vali Acc: 0.411 Test Loss: 2.106 Test Acc: 0.411
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9786388874053955
Epoch: 6, Steps: 12 | Train Loss: 1.982 Vali Loss: 1.921 Vali Acc: 0.544 Test Loss: 1.921 Test Acc: 0.544
Validation loss decreased (-0.449977 --> -0.544425).  Saving model ...
Epoch: 7 cost time: 0.8852612972259521
Epoch: 7, Steps: 12 | Train Loss: 1.710 Vali Loss: 1.737 Vali Acc: 0.600 Test Loss: 1.737 Test Acc: 0.600
Validation loss decreased (-0.544425 --> -0.599983).  Saving model ...
Epoch: 8 cost time: 0.8918416500091553
Epoch: 8, Steps: 12 | Train Loss: 1.477 Vali Loss: 1.568 Vali Acc: 0.594 Test Loss: 1.568 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8877966403961182
Epoch: 9, Steps: 12 | Train Loss: 1.324 Vali Loss: 1.427 Vali Acc: 0.606 Test Loss: 1.427 Test Acc: 0.606
Validation loss decreased (-0.599983 --> -0.605541).  Saving model ...
Epoch: 10 cost time: 0.9557418823242188
Epoch: 10, Steps: 12 | Train Loss: 1.106 Vali Loss: 1.292 Vali Acc: 0.644 Test Loss: 1.292 Test Acc: 0.644
Validation loss decreased (-0.605541 --> -0.644432).  Saving model ...
Epoch: 11 cost time: 0.8490445613861084
Epoch: 11, Steps: 12 | Train Loss: 0.985 Vali Loss: 1.176 Vali Acc: 0.606 Test Loss: 1.176 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9560220241546631
Epoch: 12, Steps: 12 | Train Loss: 0.885 Vali Loss: 1.061 Vali Acc: 0.717 Test Loss: 1.061 Test Acc: 0.717
Validation loss decreased (-0.644432 --> -0.716656).  Saving model ...
Epoch: 13 cost time: 0.8798251152038574
Epoch: 13, Steps: 12 | Train Loss: 0.798 Vali Loss: 1.013 Vali Acc: 0.667 Test Loss: 1.013 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9338140487670898
Epoch: 14, Steps: 12 | Train Loss: 0.728 Vali Loss: 0.920 Vali Acc: 0.717 Test Loss: 0.920 Test Acc: 0.717
Validation loss decreased (-0.716656 --> -0.716657).  Saving model ...
Epoch: 15 cost time: 1.0502681732177734
Epoch: 15, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.813 Vali Acc: 0.744 Test Loss: 0.813 Test Acc: 0.744
Validation loss decreased (-0.716657 --> -0.744436).  Saving model ...
Epoch: 16 cost time: 1.0132155418395996
Epoch: 16, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.752 Vali Acc: 0.800 Test Loss: 0.752 Test Acc: 0.800
Validation loss decreased (-0.744436 --> -0.799992).  Saving model ...
Epoch: 17 cost time: 1.0211150646209717
Epoch: 17, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.721 Vali Acc: 0.750 Test Loss: 0.721 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9383401870727539
Epoch: 18, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.639 Vali Acc: 0.794 Test Loss: 0.639 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9511950016021729
Epoch: 19, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.606 Vali Acc: 0.800 Test Loss: 0.606 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799994).  Saving model ...
Epoch: 20 cost time: 0.9323647022247314
Epoch: 20, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.646 Vali Acc: 0.817 Test Loss: 0.646 Test Acc: 0.817
Validation loss decreased (-0.799994 --> -0.816660).  Saving model ...
Epoch: 21 cost time: 0.9623861312866211
Epoch: 21, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.543 Vali Acc: 0.844 Test Loss: 0.543 Test Acc: 0.844
Validation loss decreased (-0.816660 --> -0.844439).  Saving model ...
Epoch: 22 cost time: 0.9430012702941895
Epoch: 22, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.558 Vali Acc: 0.856 Test Loss: 0.558 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 23 cost time: 0.9852735996246338
Epoch: 23, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.585 Vali Acc: 0.867 Test Loss: 0.585 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 24 cost time: 0.8287131786346436
Epoch: 24, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.527 Vali Acc: 0.861 Test Loss: 0.527 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9499268531799316
Epoch: 25, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.517 Vali Acc: 0.856 Test Loss: 0.517 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8297476768493652
Epoch: 26, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.494 Vali Acc: 0.872 Test Loss: 0.494 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 27 cost time: 0.835707426071167
Epoch: 27, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.477 Vali Acc: 0.861 Test Loss: 0.477 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0479142665863037
Epoch: 28, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.516 Vali Acc: 0.883 Test Loss: 0.516 Test Acc: 0.883
Validation loss decreased (-0.872217 --> -0.883328).  Saving model ...
Epoch: 29 cost time: 0.8428001403808594
Epoch: 29, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.496 Vali Acc: 0.844 Test Loss: 0.496 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9723718166351318
Epoch: 30, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.502 Vali Acc: 0.867 Test Loss: 0.502 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9095027446746826
Epoch: 31, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.506 Vali Acc: 0.867 Test Loss: 0.506 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8602132797241211
Epoch: 32, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.533 Vali Acc: 0.889 Test Loss: 0.533 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888884).  Saving model ...
Epoch: 33 cost time: 0.9250369071960449
Epoch: 33, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.513 Vali Acc: 0.844 Test Loss: 0.513 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9674992561340332
Epoch: 34, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.528 Vali Acc: 0.878 Test Loss: 0.528 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9692931175231934
Epoch: 35, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.507 Vali Acc: 0.844 Test Loss: 0.507 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.9678781032562256
Epoch: 36, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.522 Vali Acc: 0.883 Test Loss: 0.522 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.9207515716552734
Epoch: 37, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.498 Vali Acc: 0.867 Test Loss: 0.498 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.9426982402801514
Epoch: 38, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.494 Vali Acc: 0.878 Test Loss: 0.494 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.9525625705718994
Epoch: 39, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.541 Vali Acc: 0.878 Test Loss: 0.541 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.0105929374694824
Epoch: 40, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.537 Vali Acc: 0.878 Test Loss: 0.537 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.8763973712921143
Epoch: 41, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.529 Vali Acc: 0.878 Test Loss: 0.529 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.9709532260894775
Epoch: 42, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.544 Vali Acc: 0.872 Test Loss: 0.544 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 1610279
model size : 8.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4609503746032715
Epoch: 1, Steps: 12 | Train Loss: 2.978 Vali Loss: 2.851 Vali Acc: 0.100 Test Loss: 2.851 Test Acc: 0.100
Validation loss decreased (inf --> -0.099971).  Saving model ...
Epoch: 2 cost time: 0.9261715412139893
Epoch: 2, Steps: 12 | Train Loss: 2.752 Vali Loss: 2.660 Vali Acc: 0.106 Test Loss: 2.660 Test Acc: 0.106
Validation loss decreased (-0.099971 --> -0.105529).  Saving model ...
Epoch: 3 cost time: 1.0259253978729248
Epoch: 3, Steps: 12 | Train Loss: 2.602 Vali Loss: 2.507 Vali Acc: 0.194 Test Loss: 2.507 Test Acc: 0.194
Validation loss decreased (-0.105529 --> -0.194419).  Saving model ...
Epoch: 4 cost time: 0.9992291927337646
Epoch: 4, Steps: 12 | Train Loss: 2.406 Vali Loss: 2.338 Vali Acc: 0.394 Test Loss: 2.338 Test Acc: 0.394
Validation loss decreased (-0.194419 --> -0.394421).  Saving model ...
Epoch: 5 cost time: 0.8677804470062256
Epoch: 5, Steps: 12 | Train Loss: 2.212 Vali Loss: 2.178 Vali Acc: 0.456 Test Loss: 2.178 Test Acc: 0.456
Validation loss decreased (-0.394421 --> -0.455534).  Saving model ...
Epoch: 6 cost time: 0.9705791473388672
Epoch: 6, Steps: 12 | Train Loss: 1.973 Vali Loss: 1.986 Vali Acc: 0.483 Test Loss: 1.986 Test Acc: 0.483
Validation loss decreased (-0.455534 --> -0.483313).  Saving model ...
Epoch: 7 cost time: 0.9310746192932129
Epoch: 7, Steps: 12 | Train Loss: 1.807 Vali Loss: 1.816 Vali Acc: 0.550 Test Loss: 1.816 Test Acc: 0.550
Validation loss decreased (-0.483313 --> -0.549982).  Saving model ...
Epoch: 8 cost time: 1.0799155235290527
Epoch: 8, Steps: 12 | Train Loss: 1.616 Vali Loss: 1.643 Vali Acc: 0.572 Test Loss: 1.643 Test Acc: 0.572
Validation loss decreased (-0.549982 --> -0.572206).  Saving model ...
Epoch: 9 cost time: 0.7696092128753662
Epoch: 9, Steps: 12 | Train Loss: 1.319 Vali Loss: 1.427 Vali Acc: 0.600 Test Loss: 1.427 Test Acc: 0.600
Validation loss decreased (-0.572206 --> -0.599986).  Saving model ...
Epoch: 10 cost time: 0.9749245643615723
Epoch: 10, Steps: 12 | Train Loss: 1.222 Vali Loss: 1.279 Vali Acc: 0.594 Test Loss: 1.279 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9629151821136475
Epoch: 11, Steps: 12 | Train Loss: 1.039 Vali Loss: 1.165 Vali Acc: 0.633 Test Loss: 1.165 Test Acc: 0.633
Validation loss decreased (-0.599986 --> -0.633322).  Saving model ...
Epoch: 12 cost time: 0.8937690258026123
Epoch: 12, Steps: 12 | Train Loss: 0.841 Vali Loss: 1.058 Vali Acc: 0.644 Test Loss: 1.058 Test Acc: 0.644
Validation loss decreased (-0.633322 --> -0.644434).  Saving model ...
Epoch: 13 cost time: 0.9698057174682617
Epoch: 13, Steps: 12 | Train Loss: 0.753 Vali Loss: 0.975 Vali Acc: 0.733 Test Loss: 0.975 Test Acc: 0.733
Validation loss decreased (-0.644434 --> -0.733324).  Saving model ...
Epoch: 14 cost time: 0.7661352157592773
Epoch: 14, Steps: 12 | Train Loss: 0.683 Vali Loss: 0.868 Vali Acc: 0.717 Test Loss: 0.868 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.904343843460083
Epoch: 15, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.813 Vali Acc: 0.750 Test Loss: 0.813 Test Acc: 0.750
Validation loss decreased (-0.733324 --> -0.749992).  Saving model ...
Epoch: 16 cost time: 0.85652756690979
Epoch: 16, Steps: 12 | Train Loss: 0.554 Vali Loss: 0.749 Vali Acc: 0.772 Test Loss: 0.749 Test Acc: 0.772
Validation loss decreased (-0.749992 --> -0.772215).  Saving model ...
Epoch: 17 cost time: 0.9097394943237305
Epoch: 17, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.718 Vali Acc: 0.789 Test Loss: 0.718 Test Acc: 0.789
Validation loss decreased (-0.772215 --> -0.788882).  Saving model ...
Epoch: 18 cost time: 1.1300938129425049
Epoch: 18, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.634 Vali Acc: 0.800 Test Loss: 0.634 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799994).  Saving model ...
Epoch: 19 cost time: 1.0227653980255127
Epoch: 19, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.596 Vali Acc: 0.844 Test Loss: 0.596 Test Acc: 0.844
Validation loss decreased (-0.799994 --> -0.844438).  Saving model ...
Epoch: 20 cost time: 0.9469864368438721
Epoch: 20, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.556 Vali Acc: 0.844 Test Loss: 0.556 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844439).  Saving model ...
Epoch: 21 cost time: 1.0293238162994385
Epoch: 21, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.574 Vali Acc: 0.844 Test Loss: 0.574 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9709594249725342
Epoch: 22, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.539 Vali Acc: 0.872 Test Loss: 0.539 Test Acc: 0.872
Validation loss decreased (-0.844439 --> -0.872217).  Saving model ...
Epoch: 23 cost time: 0.8251802921295166
Epoch: 23, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.557 Vali Acc: 0.850 Test Loss: 0.557 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9607038497924805
Epoch: 24, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.513 Vali Acc: 0.867 Test Loss: 0.513 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9751265048980713
Epoch: 25, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.511 Vali Acc: 0.861 Test Loss: 0.511 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.1006238460540771
Epoch: 26, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.547 Vali Acc: 0.889 Test Loss: 0.547 Test Acc: 0.889
Validation loss decreased (-0.872217 --> -0.888883).  Saving model ...
Epoch: 27 cost time: 0.9891462326049805
Epoch: 27, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.465 Vali Acc: 0.883 Test Loss: 0.465 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.937870979309082
Epoch: 28, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.508 Vali Acc: 0.889 Test Loss: 0.508 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888884).  Saving model ...
Epoch: 29 cost time: 0.9170916080474854
Epoch: 29, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.480 Vali Acc: 0.900 Test Loss: 0.480 Test Acc: 0.900
Validation loss decreased (-0.888884 --> -0.899995).  Saving model ...
Epoch: 30 cost time: 0.8894577026367188
Epoch: 30, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.552 Vali Acc: 0.883 Test Loss: 0.552 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8896148204803467
Epoch: 31, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.484 Vali Acc: 0.889 Test Loss: 0.484 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9589354991912842
Epoch: 32, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.518 Vali Acc: 0.894 Test Loss: 0.518 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0538790225982666
Epoch: 33, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.497 Vali Acc: 0.894 Test Loss: 0.497 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8123085498809814
Epoch: 34, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.524 Vali Acc: 0.861 Test Loss: 0.524 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.0522184371948242
Epoch: 35, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.598 Vali Acc: 0.878 Test Loss: 0.598 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.9512274265289307
Epoch: 36, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.532 Vali Acc: 0.872 Test Loss: 0.532 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.0324480533599854
Epoch: 37, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.501 Vali Acc: 0.883 Test Loss: 0.501 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.0425100326538086
Epoch: 38, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.593 Vali Acc: 0.889 Test Loss: 0.593 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.9981427192687988
Epoch: 39, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.531 Vali Acc: 0.883 Test Loss: 0.531 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 1609767
model size : 8.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.64150071144104
Epoch: 1, Steps: 12 | Train Loss: 2.837 Vali Loss: 2.732 Vali Acc: 0.083 Test Loss: 2.732 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 1.134502649307251
Epoch: 2, Steps: 12 | Train Loss: 2.646 Vali Loss: 2.569 Vali Acc: 0.222 Test Loss: 2.569 Test Acc: 0.222
Validation loss decreased (-0.083306 --> -0.222197).  Saving model ...
Epoch: 3 cost time: 1.0220975875854492
Epoch: 3, Steps: 12 | Train Loss: 2.521 Vali Loss: 2.458 Vali Acc: 0.289 Test Loss: 2.458 Test Acc: 0.289
Validation loss decreased (-0.222197 --> -0.288864).  Saving model ...
Epoch: 4 cost time: 1.0389719009399414
Epoch: 4, Steps: 12 | Train Loss: 2.320 Vali Loss: 2.281 Vali Acc: 0.378 Test Loss: 2.281 Test Acc: 0.378
Validation loss decreased (-0.288864 --> -0.377755).  Saving model ...
Epoch: 5 cost time: 1.069939136505127
Epoch: 5, Steps: 12 | Train Loss: 2.116 Vali Loss: 2.134 Vali Acc: 0.433 Test Loss: 2.134 Test Acc: 0.433
Validation loss decreased (-0.377755 --> -0.433312).  Saving model ...
Epoch: 6 cost time: 1.0378592014312744
Epoch: 6, Steps: 12 | Train Loss: 1.915 Vali Loss: 1.933 Vali Acc: 0.511 Test Loss: 1.933 Test Acc: 0.511
Validation loss decreased (-0.433312 --> -0.511092).  Saving model ...
Epoch: 7 cost time: 1.0228157043457031
Epoch: 7, Steps: 12 | Train Loss: 1.655 Vali Loss: 1.739 Vali Acc: 0.550 Test Loss: 1.739 Test Acc: 0.550
Validation loss decreased (-0.511092 --> -0.549983).  Saving model ...
Epoch: 8 cost time: 0.9137494564056396
Epoch: 8, Steps: 12 | Train Loss: 1.491 Vali Loss: 1.549 Vali Acc: 0.561 Test Loss: 1.549 Test Acc: 0.561
Validation loss decreased (-0.549983 --> -0.561096).  Saving model ...
Epoch: 9 cost time: 1.106496810913086
Epoch: 9, Steps: 12 | Train Loss: 1.237 Vali Loss: 1.368 Vali Acc: 0.606 Test Loss: 1.368 Test Acc: 0.606
Validation loss decreased (-0.561096 --> -0.605542).  Saving model ...
Epoch: 10 cost time: 1.1145830154418945
Epoch: 10, Steps: 12 | Train Loss: 1.088 Vali Loss: 1.234 Vali Acc: 0.639 Test Loss: 1.234 Test Acc: 0.639
Validation loss decreased (-0.605542 --> -0.638877).  Saving model ...
Epoch: 11 cost time: 0.8495495319366455
Epoch: 11, Steps: 12 | Train Loss: 0.928 Vali Loss: 1.095 Vali Acc: 0.694 Test Loss: 1.095 Test Acc: 0.694
Validation loss decreased (-0.638877 --> -0.694433).  Saving model ...
Epoch: 12 cost time: 1.0310633182525635
Epoch: 12, Steps: 12 | Train Loss: 0.806 Vali Loss: 0.969 Vali Acc: 0.689 Test Loss: 0.969 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2366797924041748
Epoch: 13, Steps: 12 | Train Loss: 0.717 Vali Loss: 0.879 Vali Acc: 0.750 Test Loss: 0.879 Test Acc: 0.750
Validation loss decreased (-0.694433 --> -0.749991).  Saving model ...
Epoch: 14 cost time: 0.9526007175445557
Epoch: 14, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.814 Vali Acc: 0.739 Test Loss: 0.814 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0823614597320557
Epoch: 15, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.754 Vali Acc: 0.778 Test Loss: 0.754 Test Acc: 0.778
Validation loss decreased (-0.749991 --> -0.777770).  Saving model ...
Epoch: 16 cost time: 0.9053421020507812
Epoch: 16, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.711 Vali Acc: 0.811 Test Loss: 0.711 Test Acc: 0.811
Validation loss decreased (-0.777770 --> -0.811104).  Saving model ...
Epoch: 17 cost time: 1.122251272201538
Epoch: 17, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.665 Vali Acc: 0.817 Test Loss: 0.665 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816660).  Saving model ...
Epoch: 18 cost time: 1.2625823020935059
Epoch: 18, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.648 Vali Acc: 0.811 Test Loss: 0.648 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1861941814422607
Epoch: 19, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.632 Vali Acc: 0.822 Test Loss: 0.632 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 20 cost time: 0.9784042835235596
Epoch: 20, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.634 Vali Acc: 0.811 Test Loss: 0.634 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0393989086151123
Epoch: 21, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.580 Vali Acc: 0.850 Test Loss: 0.580 Test Acc: 0.850
Validation loss decreased (-0.822216 --> -0.849994).  Saving model ...
Epoch: 22 cost time: 1.0135221481323242
Epoch: 22, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.587 Vali Acc: 0.867 Test Loss: 0.587 Test Acc: 0.867
Validation loss decreased (-0.849994 --> -0.866661).  Saving model ...
Epoch: 23 cost time: 1.0414974689483643
Epoch: 23, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.564 Vali Acc: 0.850 Test Loss: 0.564 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0290703773498535
Epoch: 24, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.564 Vali Acc: 0.872 Test Loss: 0.564 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 25 cost time: 1.1569085121154785
Epoch: 25, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.530 Vali Acc: 0.872 Test Loss: 0.530 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 26 cost time: 0.8256781101226807
Epoch: 26, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.555 Vali Acc: 0.867 Test Loss: 0.555 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9194331169128418
Epoch: 27, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.543 Vali Acc: 0.878 Test Loss: 0.543 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 28 cost time: 0.8313510417938232
Epoch: 28, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.541 Vali Acc: 0.883 Test Loss: 0.541 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883328).  Saving model ...
Epoch: 29 cost time: 0.8805184364318848
Epoch: 29, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.552 Vali Acc: 0.872 Test Loss: 0.552 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9574506282806396
Epoch: 30, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.549 Vali Acc: 0.883 Test Loss: 0.549 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9685049057006836
Epoch: 31, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.570 Vali Acc: 0.878 Test Loss: 0.570 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9124190807342529
Epoch: 32, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.524 Vali Acc: 0.883 Test Loss: 0.524 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883328).  Saving model ...
Epoch: 33 cost time: 0.9247872829437256
Epoch: 33, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.531 Vali Acc: 0.883 Test Loss: 0.531 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0046484470367432
Epoch: 34, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.555 Vali Acc: 0.883 Test Loss: 0.555 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9920310974121094
Epoch: 35, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.524 Vali Acc: 0.889 Test Loss: 0.524 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888884).  Saving model ...
Epoch: 36 cost time: 0.8985621929168701
Epoch: 36, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.555 Vali Acc: 0.867 Test Loss: 0.555 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9743301868438721
Epoch: 37, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.666 Vali Acc: 0.867 Test Loss: 0.666 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9350996017456055
Epoch: 38, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.607 Vali Acc: 0.872 Test Loss: 0.607 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.156994104385376
Epoch: 39, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.528 Vali Acc: 0.889 Test Loss: 0.528 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.1759564876556396
Epoch: 40, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.579 Vali Acc: 0.872 Test Loss: 0.579 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.0288705825805664
Epoch: 41, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.585 Vali Acc: 0.856 Test Loss: 0.585 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.04386568069458
Epoch: 42, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.570 Vali Acc: 0.878 Test Loss: 0.570 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.1197714805603027
Epoch: 43, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.599 Vali Acc: 0.839 Test Loss: 0.599 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.100538969039917
Epoch: 44, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.546 Vali Acc: 0.883 Test Loss: 0.546 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.2760286331176758
Epoch: 45, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.553 Vali Acc: 0.883 Test Loss: 0.553 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 1609255
model size : 8.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4544732570648193
Epoch: 1, Steps: 12 | Train Loss: 2.879 Vali Loss: 2.738 Vali Acc: 0.122 Test Loss: 2.738 Test Acc: 0.122
Validation loss decreased (inf --> -0.122195).  Saving model ...
Epoch: 2 cost time: 0.8301942348480225
Epoch: 2, Steps: 12 | Train Loss: 2.689 Vali Loss: 2.587 Vali Acc: 0.139 Test Loss: 2.587 Test Acc: 0.139
Validation loss decreased (-0.122195 --> -0.138863).  Saving model ...
Epoch: 3 cost time: 1.0313303470611572
Epoch: 3, Steps: 12 | Train Loss: 2.543 Vali Loss: 2.458 Vali Acc: 0.261 Test Loss: 2.458 Test Acc: 0.261
Validation loss decreased (-0.138863 --> -0.261087).  Saving model ...
Epoch: 4 cost time: 0.9778294563293457
Epoch: 4, Steps: 12 | Train Loss: 2.341 Vali Loss: 2.266 Vali Acc: 0.400 Test Loss: 2.266 Test Acc: 0.400
Validation loss decreased (-0.261087 --> -0.399977).  Saving model ...
Epoch: 5 cost time: 1.0367012023925781
Epoch: 5, Steps: 12 | Train Loss: 2.197 Vali Loss: 2.076 Vali Acc: 0.500 Test Loss: 2.076 Test Acc: 0.500
Validation loss decreased (-0.399977 --> -0.499979).  Saving model ...
Epoch: 6 cost time: 1.0964031219482422
Epoch: 6, Steps: 12 | Train Loss: 1.944 Vali Loss: 1.891 Vali Acc: 0.533 Test Loss: 1.891 Test Acc: 0.533
Validation loss decreased (-0.499979 --> -0.533314).  Saving model ...
Epoch: 7 cost time: 0.9053082466125488
Epoch: 7, Steps: 12 | Train Loss: 1.733 Vali Loss: 1.684 Vali Acc: 0.617 Test Loss: 1.684 Test Acc: 0.617
Validation loss decreased (-0.533314 --> -0.616650).  Saving model ...
Epoch: 8 cost time: 1.1021347045898438
Epoch: 8, Steps: 12 | Train Loss: 1.497 Vali Loss: 1.513 Vali Acc: 0.594 Test Loss: 1.513 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9175515174865723
Epoch: 9, Steps: 12 | Train Loss: 1.285 Vali Loss: 1.375 Vali Acc: 0.617 Test Loss: 1.375 Test Acc: 0.617
Validation loss decreased (-0.616650 --> -0.616653).  Saving model ...
Epoch: 10 cost time: 1.0304646492004395
Epoch: 10, Steps: 12 | Train Loss: 1.144 Vali Loss: 1.223 Vali Acc: 0.650 Test Loss: 1.223 Test Acc: 0.650
Validation loss decreased (-0.616653 --> -0.649988).  Saving model ...
Epoch: 11 cost time: 0.8484282493591309
Epoch: 11, Steps: 12 | Train Loss: 1.004 Vali Loss: 1.127 Vali Acc: 0.611 Test Loss: 1.127 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9171285629272461
Epoch: 12, Steps: 12 | Train Loss: 0.873 Vali Loss: 1.014 Vali Acc: 0.689 Test Loss: 1.014 Test Acc: 0.689
Validation loss decreased (-0.649988 --> -0.688879).  Saving model ...
Epoch: 13 cost time: 1.1867167949676514
Epoch: 13, Steps: 12 | Train Loss: 0.714 Vali Loss: 0.950 Vali Acc: 0.706 Test Loss: 0.950 Test Acc: 0.706
Validation loss decreased (-0.688879 --> -0.705546).  Saving model ...
Epoch: 14 cost time: 1.0218408107757568
Epoch: 14, Steps: 12 | Train Loss: 0.698 Vali Loss: 0.873 Vali Acc: 0.750 Test Loss: 0.873 Test Acc: 0.750
Validation loss decreased (-0.705546 --> -0.749991).  Saving model ...
Epoch: 15 cost time: 0.9867236614227295
Epoch: 15, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.810 Vali Acc: 0.722 Test Loss: 0.810 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9742796421051025
Epoch: 16, Steps: 12 | Train Loss: 0.495 Vali Loss: 0.747 Vali Acc: 0.806 Test Loss: 0.747 Test Acc: 0.806
Validation loss decreased (-0.749991 --> -0.805548).  Saving model ...
Epoch: 17 cost time: 0.8866462707519531
Epoch: 17, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.693 Vali Acc: 0.772 Test Loss: 0.693 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8445088863372803
Epoch: 18, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.671 Vali Acc: 0.800 Test Loss: 0.671 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0053350925445557
Epoch: 19, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.662 Vali Acc: 0.806 Test Loss: 0.662 Test Acc: 0.806
Validation loss decreased (-0.805548 --> -0.805549).  Saving model ...
Epoch: 20 cost time: 1.024181842803955
Epoch: 20, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.646 Vali Acc: 0.839 Test Loss: 0.646 Test Acc: 0.839
Validation loss decreased (-0.805549 --> -0.838882).  Saving model ...
Epoch: 21 cost time: 0.9509892463684082
Epoch: 21, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.589 Vali Acc: 0.811 Test Loss: 0.589 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0216403007507324
Epoch: 22, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.549 Vali Acc: 0.861 Test Loss: 0.549 Test Acc: 0.861
Validation loss decreased (-0.838882 --> -0.861106).  Saving model ...
Epoch: 23 cost time: 0.9631428718566895
Epoch: 23, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.607 Vali Acc: 0.850 Test Loss: 0.607 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1341862678527832
Epoch: 24, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.581 Vali Acc: 0.856 Test Loss: 0.581 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9786403179168701
Epoch: 25, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.551 Vali Acc: 0.844 Test Loss: 0.551 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9670395851135254
Epoch: 26, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.561 Vali Acc: 0.878 Test Loss: 0.561 Test Acc: 0.878
Validation loss decreased (-0.861106 --> -0.877772).  Saving model ...
Epoch: 27 cost time: 0.819955587387085
Epoch: 27, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.577 Vali Acc: 0.872 Test Loss: 0.577 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9043588638305664
Epoch: 28, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.501 Vali Acc: 0.889 Test Loss: 0.501 Test Acc: 0.889
Validation loss decreased (-0.877772 --> -0.888884).  Saving model ...
Epoch: 29 cost time: 0.9600131511688232
Epoch: 29, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.507 Vali Acc: 0.878 Test Loss: 0.507 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0490777492523193
Epoch: 30, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.588 Vali Acc: 0.861 Test Loss: 0.588 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9476566314697266
Epoch: 31, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.525 Vali Acc: 0.872 Test Loss: 0.525 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9799854755401611
Epoch: 32, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.605 Vali Acc: 0.856 Test Loss: 0.605 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.0517663955688477
Epoch: 33, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.566 Vali Acc: 0.889 Test Loss: 0.566 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.9786646366119385
Epoch: 34, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.519 Vali Acc: 0.861 Test Loss: 0.519 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.9920549392700195
Epoch: 35, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.557 Vali Acc: 0.872 Test Loss: 0.557 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.0302188396453857
Epoch: 36, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.572 Vali Acc: 0.883 Test Loss: 0.572 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.1534843444824219
Epoch: 37, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.549 Vali Acc: 0.900 Test Loss: 0.549 Test Acc: 0.900
Validation loss decreased (-0.888884 --> -0.899995).  Saving model ...
Epoch: 38 cost time: 1.3534128665924072
Epoch: 38, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.563 Vali Acc: 0.872 Test Loss: 0.563 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0080556869506836
Epoch: 39, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.570 Vali Acc: 0.883 Test Loss: 0.570 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1689436435699463
Epoch: 40, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.581 Vali Acc: 0.900 Test Loss: 0.581 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.0858688354492188
Epoch: 41, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.555 Vali Acc: 0.889 Test Loss: 0.555 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.9957942962646484
Epoch: 42, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.591 Vali Acc: 0.889 Test Loss: 0.591 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.9857871532440186
Epoch: 43, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.608 Vali Acc: 0.883 Test Loss: 0.608 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.0966405868530273
Epoch: 44, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.597 Vali Acc: 0.894 Test Loss: 0.597 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.981804609298706
Epoch: 45, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.589 Vali Acc: 0.894 Test Loss: 0.589 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.1671490669250488
Epoch: 46, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.593 Vali Acc: 0.900 Test Loss: 0.593 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.287595510482788
Epoch: 47, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.604 Vali Acc: 0.889 Test Loss: 0.604 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 1608743
model size : 8.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.82305645942688
Epoch: 1, Steps: 12 | Train Loss: 2.820 Vali Loss: 2.718 Vali Acc: 0.072 Test Loss: 2.718 Test Acc: 0.072
Validation loss decreased (inf --> -0.072195).  Saving model ...
Epoch: 2 cost time: 1.1653587818145752
Epoch: 2, Steps: 12 | Train Loss: 2.699 Vali Loss: 2.599 Vali Acc: 0.189 Test Loss: 2.599 Test Acc: 0.189
Validation loss decreased (-0.072195 --> -0.188863).  Saving model ...
Epoch: 3 cost time: 0.9873523712158203
Epoch: 3, Steps: 12 | Train Loss: 2.595 Vali Loss: 2.488 Vali Acc: 0.256 Test Loss: 2.488 Test Acc: 0.256
Validation loss decreased (-0.188863 --> -0.255531).  Saving model ...
Epoch: 4 cost time: 0.9169723987579346
Epoch: 4, Steps: 12 | Train Loss: 2.395 Vali Loss: 2.331 Vali Acc: 0.383 Test Loss: 2.331 Test Acc: 0.383
Validation loss decreased (-0.255531 --> -0.383310).  Saving model ...
Epoch: 5 cost time: 0.9915180206298828
Epoch: 5, Steps: 12 | Train Loss: 2.248 Vali Loss: 2.164 Vali Acc: 0.483 Test Loss: 2.164 Test Acc: 0.483
Validation loss decreased (-0.383310 --> -0.483312).  Saving model ...
Epoch: 6 cost time: 1.0028367042541504
Epoch: 6, Steps: 12 | Train Loss: 2.028 Vali Loss: 1.987 Vali Acc: 0.556 Test Loss: 1.987 Test Acc: 0.556
Validation loss decreased (-0.483312 --> -0.555536).  Saving model ...
Epoch: 7 cost time: 0.8761858940124512
Epoch: 7, Steps: 12 | Train Loss: 1.808 Vali Loss: 1.803 Vali Acc: 0.522 Test Loss: 1.803 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9446711540222168
Epoch: 8, Steps: 12 | Train Loss: 1.611 Vali Loss: 1.649 Vali Acc: 0.583 Test Loss: 1.649 Test Acc: 0.583
Validation loss decreased (-0.555536 --> -0.583317).  Saving model ...
Epoch: 9 cost time: 0.9271836280822754
Epoch: 9, Steps: 12 | Train Loss: 1.404 Vali Loss: 1.476 Vali Acc: 0.572 Test Loss: 1.476 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8987157344818115
Epoch: 10, Steps: 12 | Train Loss: 1.306 Vali Loss: 1.367 Vali Acc: 0.589 Test Loss: 1.367 Test Acc: 0.589
Validation loss decreased (-0.583317 --> -0.588875).  Saving model ...
Epoch: 11 cost time: 0.9564523696899414
Epoch: 11, Steps: 12 | Train Loss: 1.102 Vali Loss: 1.236 Vali Acc: 0.628 Test Loss: 1.236 Test Acc: 0.628
Validation loss decreased (-0.588875 --> -0.627765).  Saving model ...
Epoch: 12 cost time: 1.0435094833374023
Epoch: 12, Steps: 12 | Train Loss: 0.971 Vali Loss: 1.111 Vali Acc: 0.622 Test Loss: 1.111 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9046809673309326
Epoch: 13, Steps: 12 | Train Loss: 0.797 Vali Loss: 0.996 Vali Acc: 0.661 Test Loss: 0.996 Test Acc: 0.661
Validation loss decreased (-0.627765 --> -0.661101).  Saving model ...
Epoch: 14 cost time: 0.9769864082336426
Epoch: 14, Steps: 12 | Train Loss: 0.730 Vali Loss: 0.912 Vali Acc: 0.733 Test Loss: 0.912 Test Acc: 0.733
Validation loss decreased (-0.661101 --> -0.733324).  Saving model ...
Epoch: 15 cost time: 0.995384693145752
Epoch: 15, Steps: 12 | Train Loss: 0.617 Vali Loss: 0.885 Vali Acc: 0.717 Test Loss: 0.885 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0154118537902832
Epoch: 16, Steps: 12 | Train Loss: 0.568 Vali Loss: 0.825 Vali Acc: 0.744 Test Loss: 0.825 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744436).  Saving model ...
Epoch: 17 cost time: 0.9450085163116455
Epoch: 17, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.759 Vali Acc: 0.756 Test Loss: 0.759 Test Acc: 0.756
Validation loss decreased (-0.744436 --> -0.755548).  Saving model ...
Epoch: 18 cost time: 1.0563385486602783
Epoch: 18, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.705 Vali Acc: 0.822 Test Loss: 0.705 Test Acc: 0.822
Validation loss decreased (-0.755548 --> -0.822215).  Saving model ...
Epoch: 19 cost time: 1.1049535274505615
Epoch: 19, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.692 Vali Acc: 0.794 Test Loss: 0.692 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1576764583587646
Epoch: 20, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.643 Vali Acc: 0.844 Test Loss: 0.643 Test Acc: 0.844
Validation loss decreased (-0.822215 --> -0.844438).  Saving model ...
Epoch: 21 cost time: 1.079099178314209
Epoch: 21, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.667 Vali Acc: 0.822 Test Loss: 0.667 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.816861629486084
Epoch: 22, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.606 Vali Acc: 0.839 Test Loss: 0.606 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8802924156188965
Epoch: 23, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.616 Vali Acc: 0.872 Test Loss: 0.616 Test Acc: 0.872
Validation loss decreased (-0.844438 --> -0.872216).  Saving model ...
Epoch: 24 cost time: 0.8334841728210449
Epoch: 24, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.591 Vali Acc: 0.828 Test Loss: 0.591 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8602359294891357
Epoch: 25, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.584 Vali Acc: 0.850 Test Loss: 0.584 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2649269104003906
Epoch: 26, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.567 Vali Acc: 0.856 Test Loss: 0.567 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9294126033782959
Epoch: 27, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.549 Vali Acc: 0.861 Test Loss: 0.549 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.184213638305664
Epoch: 28, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.557 Vali Acc: 0.861 Test Loss: 0.557 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.033686876296997
Epoch: 29, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.588 Vali Acc: 0.867 Test Loss: 0.588 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.992659330368042
Epoch: 30, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.550 Vali Acc: 0.883 Test Loss: 0.550 Test Acc: 0.883
Validation loss decreased (-0.872216 --> -0.883328).  Saving model ...
Epoch: 31 cost time: 0.9369432926177979
Epoch: 31, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.538 Vali Acc: 0.878 Test Loss: 0.538 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9459290504455566
Epoch: 32, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.535 Vali Acc: 0.867 Test Loss: 0.535 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9024531841278076
Epoch: 33, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.558 Vali Acc: 0.878 Test Loss: 0.558 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0074141025543213
Epoch: 34, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.565 Vali Acc: 0.867 Test Loss: 0.565 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.894869327545166
Epoch: 35, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.597 Vali Acc: 0.872 Test Loss: 0.597 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.9538021087646484
Epoch: 36, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.576 Vali Acc: 0.889 Test Loss: 0.576 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888883).  Saving model ...
Epoch: 37 cost time: 0.9259426593780518
Epoch: 37, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.601 Vali Acc: 0.900 Test Loss: 0.601 Test Acc: 0.900
Validation loss decreased (-0.888883 --> -0.899994).  Saving model ...
Epoch: 38 cost time: 1.0052614212036133
Epoch: 38, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.632 Vali Acc: 0.867 Test Loss: 0.632 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9823417663574219
Epoch: 39, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.630 Vali Acc: 0.883 Test Loss: 0.630 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9993865489959717
Epoch: 40, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.594 Vali Acc: 0.889 Test Loss: 0.594 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.9196178913116455
Epoch: 41, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.631 Vali Acc: 0.867 Test Loss: 0.631 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.0082006454467773
Epoch: 42, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.618 Vali Acc: 0.878 Test Loss: 0.618 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.9436917304992676
Epoch: 43, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.624 Vali Acc: 0.883 Test Loss: 0.624 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.2230958938598633
Epoch: 44, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.677 Vali Acc: 0.878 Test Loss: 0.677 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.1496849060058594
Epoch: 45, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.632 Vali Acc: 0.878 Test Loss: 0.632 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.1060843467712402
Epoch: 46, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.615 Vali Acc: 0.878 Test Loss: 0.615 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.9833705425262451
Epoch: 47, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.623 Vali Acc: 0.878 Test Loss: 0.623 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 1215527
model size : 7.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7637484073638916
Epoch: 1, Steps: 12 | Train Loss: 2.871 Vali Loss: 2.764 Vali Acc: 0.200 Test Loss: 2.764 Test Acc: 0.200
Validation loss decreased (inf --> -0.199972).  Saving model ...
Epoch: 2 cost time: 0.9706964492797852
Epoch: 2, Steps: 12 | Train Loss: 2.728 Vali Loss: 2.632 Vali Acc: 0.217 Test Loss: 2.632 Test Acc: 0.217
Validation loss decreased (-0.199972 --> -0.216640).  Saving model ...
Epoch: 3 cost time: 0.9592752456665039
Epoch: 3, Steps: 12 | Train Loss: 2.616 Vali Loss: 2.511 Vali Acc: 0.333 Test Loss: 2.511 Test Acc: 0.333
Validation loss decreased (-0.216640 --> -0.333308).  Saving model ...
Epoch: 4 cost time: 0.8015174865722656
Epoch: 4, Steps: 12 | Train Loss: 2.453 Vali Loss: 2.366 Vali Acc: 0.328 Test Loss: 2.366 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0265536308288574
Epoch: 5, Steps: 12 | Train Loss: 2.256 Vali Loss: 2.200 Vali Acc: 0.433 Test Loss: 2.200 Test Acc: 0.433
Validation loss decreased (-0.333308 --> -0.433311).  Saving model ...
Epoch: 6 cost time: 0.8289239406585693
Epoch: 6, Steps: 12 | Train Loss: 2.042 Vali Loss: 2.025 Vali Acc: 0.472 Test Loss: 2.025 Test Acc: 0.472
Validation loss decreased (-0.433311 --> -0.472202).  Saving model ...
Epoch: 7 cost time: 0.9078750610351562
Epoch: 7, Steps: 12 | Train Loss: 1.876 Vali Loss: 1.827 Vali Acc: 0.550 Test Loss: 1.827 Test Acc: 0.550
Validation loss decreased (-0.472202 --> -0.549982).  Saving model ...
Epoch: 8 cost time: 1.0959155559539795
Epoch: 8, Steps: 12 | Train Loss: 1.718 Vali Loss: 1.656 Vali Acc: 0.578 Test Loss: 1.656 Test Acc: 0.578
Validation loss decreased (-0.549982 --> -0.577761).  Saving model ...
Epoch: 9 cost time: 0.8652541637420654
Epoch: 9, Steps: 12 | Train Loss: 1.476 Vali Loss: 1.516 Vali Acc: 0.589 Test Loss: 1.516 Test Acc: 0.589
Validation loss decreased (-0.577761 --> -0.588874).  Saving model ...
Epoch: 10 cost time: 0.9076504707336426
Epoch: 10, Steps: 12 | Train Loss: 1.310 Vali Loss: 1.349 Vali Acc: 0.594 Test Loss: 1.349 Test Acc: 0.594
Validation loss decreased (-0.588874 --> -0.594431).  Saving model ...
Epoch: 11 cost time: 0.9745111465454102
Epoch: 11, Steps: 12 | Train Loss: 1.093 Vali Loss: 1.219 Vali Acc: 0.611 Test Loss: 1.219 Test Acc: 0.611
Validation loss decreased (-0.594431 --> -0.611099).  Saving model ...
Epoch: 12 cost time: 0.9562256336212158
Epoch: 12, Steps: 12 | Train Loss: 0.953 Vali Loss: 1.124 Vali Acc: 0.633 Test Loss: 1.124 Test Acc: 0.633
Validation loss decreased (-0.611099 --> -0.633322).  Saving model ...
Epoch: 13 cost time: 0.9802649021148682
Epoch: 13, Steps: 12 | Train Loss: 0.851 Vali Loss: 1.023 Vali Acc: 0.678 Test Loss: 1.023 Test Acc: 0.678
Validation loss decreased (-0.633322 --> -0.677768).  Saving model ...
Epoch: 14 cost time: 0.956294059753418
Epoch: 14, Steps: 12 | Train Loss: 0.717 Vali Loss: 0.906 Vali Acc: 0.667 Test Loss: 0.906 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9451191425323486
Epoch: 15, Steps: 12 | Train Loss: 0.648 Vali Loss: 0.844 Vali Acc: 0.739 Test Loss: 0.844 Test Acc: 0.739
Validation loss decreased (-0.677768 --> -0.738880).  Saving model ...
Epoch: 16 cost time: 1.0000364780426025
Epoch: 16, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.793 Vali Acc: 0.728 Test Loss: 0.793 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9659008979797363
Epoch: 17, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.730 Vali Acc: 0.778 Test Loss: 0.730 Test Acc: 0.778
Validation loss decreased (-0.738880 --> -0.777770).  Saving model ...
Epoch: 18 cost time: 1.0685606002807617
Epoch: 18, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.694 Vali Acc: 0.789 Test Loss: 0.694 Test Acc: 0.789
Validation loss decreased (-0.777770 --> -0.788882).  Saving model ...
Epoch: 19 cost time: 0.897477388381958
Epoch: 19, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.679 Vali Acc: 0.800 Test Loss: 0.679 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799993).  Saving model ...
Epoch: 20 cost time: 1.008080005645752
Epoch: 20, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.626 Vali Acc: 0.817 Test Loss: 0.626 Test Acc: 0.817
Validation loss decreased (-0.799993 --> -0.816660).  Saving model ...
Epoch: 21 cost time: 0.8403944969177246
Epoch: 21, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.612 Vali Acc: 0.822 Test Loss: 0.612 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 22 cost time: 0.9159674644470215
Epoch: 22, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.581 Vali Acc: 0.822 Test Loss: 0.581 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 23 cost time: 0.8539531230926514
Epoch: 23, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.562 Vali Acc: 0.839 Test Loss: 0.562 Test Acc: 0.839
Validation loss decreased (-0.822216 --> -0.838883).  Saving model ...
Epoch: 24 cost time: 0.8848164081573486
Epoch: 24, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.565 Vali Acc: 0.833 Test Loss: 0.565 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2062366008758545
Epoch: 25, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.594 Vali Acc: 0.822 Test Loss: 0.594 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9855268001556396
Epoch: 26, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.562 Vali Acc: 0.861 Test Loss: 0.562 Test Acc: 0.861
Validation loss decreased (-0.838883 --> -0.861105).  Saving model ...
Epoch: 27 cost time: 0.8908088207244873
Epoch: 27, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.543 Vali Acc: 0.861 Test Loss: 0.543 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861106).  Saving model ...
Epoch: 28 cost time: 1.1673994064331055
Epoch: 28, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.556 Vali Acc: 0.856 Test Loss: 0.556 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0574300289154053
Epoch: 29, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.603 Vali Acc: 0.889 Test Loss: 0.603 Test Acc: 0.889
Validation loss decreased (-0.861106 --> -0.888883).  Saving model ...
Epoch: 30 cost time: 0.9249453544616699
Epoch: 30, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.564 Vali Acc: 0.883 Test Loss: 0.564 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7795805931091309
Epoch: 31, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.581 Vali Acc: 0.878 Test Loss: 0.581 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0895030498504639
Epoch: 32, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.584 Vali Acc: 0.867 Test Loss: 0.584 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1304409503936768
Epoch: 33, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.611 Vali Acc: 0.856 Test Loss: 0.611 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.2479174137115479
Epoch: 34, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.589 Vali Acc: 0.872 Test Loss: 0.589 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.983177900314331
Epoch: 35, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.584 Vali Acc: 0.872 Test Loss: 0.584 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.1528863906860352
Epoch: 36, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.605 Vali Acc: 0.872 Test Loss: 0.605 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.137645959854126
Epoch: 37, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.604 Vali Acc: 0.872 Test Loss: 0.604 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.0885422229766846
Epoch: 38, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.610 Vali Acc: 0.878 Test Loss: 0.610 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.982621431350708
Epoch: 39, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.620 Vali Acc: 0.861 Test Loss: 0.620 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 1215015
model size : 7.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.722151279449463
Epoch: 1, Steps: 12 | Train Loss: 2.835 Vali Loss: 2.708 Vali Acc: 0.089 Test Loss: 2.708 Test Acc: 0.089
Validation loss decreased (inf --> -0.088862).  Saving model ...
Epoch: 2 cost time: 0.9087166786193848
Epoch: 2, Steps: 12 | Train Loss: 2.701 Vali Loss: 2.559 Vali Acc: 0.178 Test Loss: 2.559 Test Acc: 0.178
Validation loss decreased (-0.088862 --> -0.177752).  Saving model ...
Epoch: 3 cost time: 1.0142107009887695
Epoch: 3, Steps: 12 | Train Loss: 2.543 Vali Loss: 2.429 Vali Acc: 0.344 Test Loss: 2.429 Test Acc: 0.344
Validation loss decreased (-0.177752 --> -0.344420).  Saving model ...
Epoch: 4 cost time: 1.065098762512207
Epoch: 4, Steps: 12 | Train Loss: 2.358 Vali Loss: 2.293 Vali Acc: 0.494 Test Loss: 2.293 Test Acc: 0.494
Validation loss decreased (-0.344420 --> -0.494422).  Saving model ...
Epoch: 5 cost time: 1.0313568115234375
Epoch: 5, Steps: 12 | Train Loss: 2.220 Vali Loss: 2.131 Vali Acc: 0.556 Test Loss: 2.131 Test Acc: 0.556
Validation loss decreased (-0.494422 --> -0.555534).  Saving model ...
Epoch: 6 cost time: 0.8842439651489258
Epoch: 6, Steps: 12 | Train Loss: 1.990 Vali Loss: 1.968 Vali Acc: 0.528 Test Loss: 1.968 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0024874210357666
Epoch: 7, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.784 Vali Acc: 0.628 Test Loss: 1.784 Test Acc: 0.628
Validation loss decreased (-0.555534 --> -0.627760).  Saving model ...
Epoch: 8 cost time: 1.0705583095550537
Epoch: 8, Steps: 12 | Train Loss: 1.583 Vali Loss: 1.617 Vali Acc: 0.611 Test Loss: 1.617 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9311549663543701
Epoch: 9, Steps: 12 | Train Loss: 1.357 Vali Loss: 1.472 Vali Acc: 0.656 Test Loss: 1.472 Test Acc: 0.656
Validation loss decreased (-0.627760 --> -0.655541).  Saving model ...
Epoch: 10 cost time: 0.7592105865478516
Epoch: 10, Steps: 12 | Train Loss: 1.189 Vali Loss: 1.315 Vali Acc: 0.639 Test Loss: 1.315 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.982558012008667
Epoch: 11, Steps: 12 | Train Loss: 1.044 Vali Loss: 1.205 Vali Acc: 0.661 Test Loss: 1.205 Test Acc: 0.661
Validation loss decreased (-0.655541 --> -0.661099).  Saving model ...
Epoch: 12 cost time: 1.0048837661743164
Epoch: 12, Steps: 12 | Train Loss: 0.891 Vali Loss: 1.107 Vali Acc: 0.678 Test Loss: 1.107 Test Acc: 0.678
Validation loss decreased (-0.661099 --> -0.677767).  Saving model ...
Epoch: 13 cost time: 1.0704014301300049
Epoch: 13, Steps: 12 | Train Loss: 0.865 Vali Loss: 1.034 Vali Acc: 0.706 Test Loss: 1.034 Test Acc: 0.706
Validation loss decreased (-0.677767 --> -0.705545).  Saving model ...
Epoch: 14 cost time: 0.9775335788726807
Epoch: 14, Steps: 12 | Train Loss: 0.711 Vali Loss: 0.959 Vali Acc: 0.722 Test Loss: 0.959 Test Acc: 0.722
Validation loss decreased (-0.705545 --> -0.722213).  Saving model ...
Epoch: 15 cost time: 0.9807283878326416
Epoch: 15, Steps: 12 | Train Loss: 0.608 Vali Loss: 0.900 Vali Acc: 0.756 Test Loss: 0.900 Test Acc: 0.756
Validation loss decreased (-0.722213 --> -0.755547).  Saving model ...
Epoch: 16 cost time: 0.8107666969299316
Epoch: 16, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.840 Vali Acc: 0.728 Test Loss: 0.840 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.006899356842041
Epoch: 17, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.741 Vali Acc: 0.806 Test Loss: 0.741 Test Acc: 0.806
Validation loss decreased (-0.755547 --> -0.805548).  Saving model ...
Epoch: 18 cost time: 0.9862422943115234
Epoch: 18, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.732 Vali Acc: 0.811 Test Loss: 0.732 Test Acc: 0.811
Validation loss decreased (-0.805548 --> -0.811104).  Saving model ...
Epoch: 19 cost time: 1.0483877658843994
Epoch: 19, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.679 Vali Acc: 0.822 Test Loss: 0.679 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822215).  Saving model ...
Epoch: 20 cost time: 0.8191781044006348
Epoch: 20, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.652 Vali Acc: 0.861 Test Loss: 0.652 Test Acc: 0.861
Validation loss decreased (-0.822215 --> -0.861105).  Saving model ...
Epoch: 21 cost time: 1.0967473983764648
Epoch: 21, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.647 Vali Acc: 0.833 Test Loss: 0.647 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9893772602081299
Epoch: 22, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.612 Vali Acc: 0.861 Test Loss: 0.612 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 23 cost time: 0.9155468940734863
Epoch: 23, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.609 Vali Acc: 0.867 Test Loss: 0.609 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 24 cost time: 0.9167180061340332
Epoch: 24, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.550 Vali Acc: 0.872 Test Loss: 0.550 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 25 cost time: 0.9267032146453857
Epoch: 25, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.537 Vali Acc: 0.883 Test Loss: 0.537 Test Acc: 0.883
Validation loss decreased (-0.872217 --> -0.883328).  Saving model ...
Epoch: 26 cost time: 1.1435604095458984
Epoch: 26, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.583 Vali Acc: 0.878 Test Loss: 0.583 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1653265953063965
Epoch: 27, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.553 Vali Acc: 0.878 Test Loss: 0.553 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0272417068481445
Epoch: 28, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.540 Vali Acc: 0.878 Test Loss: 0.540 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9099955558776855
Epoch: 29, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.552 Vali Acc: 0.889 Test Loss: 0.552 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888883).  Saving model ...
Epoch: 30 cost time: 0.8524878025054932
Epoch: 30, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.569 Vali Acc: 0.889 Test Loss: 0.569 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0498895645141602
Epoch: 31, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.528 Vali Acc: 0.867 Test Loss: 0.528 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8775861263275146
Epoch: 32, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.570 Vali Acc: 0.889 Test Loss: 0.570 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8297429084777832
Epoch: 33, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.564 Vali Acc: 0.867 Test Loss: 0.564 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.0057415962219238
Epoch: 34, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.549 Vali Acc: 0.883 Test Loss: 0.549 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.041344165802002
Epoch: 35, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.593 Vali Acc: 0.878 Test Loss: 0.593 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.9150261878967285
Epoch: 36, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.551 Vali Acc: 0.883 Test Loss: 0.551 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.0959653854370117
Epoch: 37, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.584 Vali Acc: 0.883 Test Loss: 0.584 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.2242891788482666
Epoch: 38, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.586 Vali Acc: 0.878 Test Loss: 0.586 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.0814106464385986
Epoch: 39, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.571 Vali Acc: 0.894 Test Loss: 0.571 Test Acc: 0.894
Validation loss decreased (-0.888883 --> -0.894439).  Saving model ...
Epoch: 40 cost time: 1.117353916168213
Epoch: 40, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.636 Vali Acc: 0.894 Test Loss: 0.636 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.149536371231079
Epoch: 41, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.597 Vali Acc: 0.894 Test Loss: 0.597 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9544026851654053
Epoch: 42, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.613 Vali Acc: 0.889 Test Loss: 0.613 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8970777988433838
Epoch: 43, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.599 Vali Acc: 0.883 Test Loss: 0.599 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.9724197387695312
Epoch: 44, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.595 Vali Acc: 0.889 Test Loss: 0.595 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.0341575145721436
Epoch: 45, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.615 Vali Acc: 0.889 Test Loss: 0.615 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.0403416156768799
Epoch: 46, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.648 Vali Acc: 0.889 Test Loss: 0.648 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.9276325702667236
Epoch: 47, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.637 Vali Acc: 0.872 Test Loss: 0.637 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.0163986682891846
Epoch: 48, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.616 Vali Acc: 0.872 Test Loss: 0.616 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.214784860610962
Epoch: 49, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.613 Vali Acc: 0.883 Test Loss: 0.613 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 1214503
model size : 7.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3319876194000244
Epoch: 1, Steps: 12 | Train Loss: 3.001 Vali Loss: 2.789 Vali Acc: 0.044 Test Loss: 2.789 Test Acc: 0.044
Validation loss decreased (inf --> -0.044417).  Saving model ...
Epoch: 2 cost time: 1.0818092823028564
Epoch: 2, Steps: 12 | Train Loss: 2.754 Vali Loss: 2.640 Vali Acc: 0.111 Test Loss: 2.640 Test Acc: 0.111
Validation loss decreased (-0.044417 --> -0.111085).  Saving model ...
Epoch: 3 cost time: 0.9136230945587158
Epoch: 3, Steps: 12 | Train Loss: 2.665 Vali Loss: 2.525 Vali Acc: 0.217 Test Loss: 2.525 Test Acc: 0.217
Validation loss decreased (-0.111085 --> -0.216641).  Saving model ...
Epoch: 4 cost time: 0.982450008392334
Epoch: 4, Steps: 12 | Train Loss: 2.492 Vali Loss: 2.396 Vali Acc: 0.378 Test Loss: 2.396 Test Acc: 0.378
Validation loss decreased (-0.216641 --> -0.377754).  Saving model ...
Epoch: 5 cost time: 1.0100157260894775
Epoch: 5, Steps: 12 | Train Loss: 2.386 Vali Loss: 2.246 Vali Acc: 0.394 Test Loss: 2.246 Test Acc: 0.394
Validation loss decreased (-0.377754 --> -0.394422).  Saving model ...
Epoch: 6 cost time: 0.8983840942382812
Epoch: 6, Steps: 12 | Train Loss: 2.178 Vali Loss: 2.042 Vali Acc: 0.478 Test Loss: 2.042 Test Acc: 0.478
Validation loss decreased (-0.394422 --> -0.477757).  Saving model ...
Epoch: 7 cost time: 0.9532012939453125
Epoch: 7, Steps: 12 | Train Loss: 1.933 Vali Loss: 1.860 Vali Acc: 0.544 Test Loss: 1.860 Test Acc: 0.544
Validation loss decreased (-0.477757 --> -0.544426).  Saving model ...
Epoch: 8 cost time: 0.9500901699066162
Epoch: 8, Steps: 12 | Train Loss: 1.710 Vali Loss: 1.669 Vali Acc: 0.533 Test Loss: 1.669 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1843101978302002
Epoch: 9, Steps: 12 | Train Loss: 1.458 Vali Loss: 1.515 Vali Acc: 0.544 Test Loss: 1.515 Test Acc: 0.544
Validation loss decreased (-0.544426 --> -0.544429).  Saving model ...
Epoch: 10 cost time: 0.9936513900756836
Epoch: 10, Steps: 12 | Train Loss: 1.305 Vali Loss: 1.340 Vali Acc: 0.622 Test Loss: 1.340 Test Acc: 0.622
Validation loss decreased (-0.544429 --> -0.622209).  Saving model ...
Epoch: 11 cost time: 0.863525390625
Epoch: 11, Steps: 12 | Train Loss: 1.132 Vali Loss: 1.218 Vali Acc: 0.628 Test Loss: 1.218 Test Acc: 0.628
Validation loss decreased (-0.622209 --> -0.627766).  Saving model ...
Epoch: 12 cost time: 0.8531363010406494
Epoch: 12, Steps: 12 | Train Loss: 1.013 Vali Loss: 1.135 Vali Acc: 0.672 Test Loss: 1.135 Test Acc: 0.672
Validation loss decreased (-0.627766 --> -0.672211).  Saving model ...
Epoch: 13 cost time: 1.0249829292297363
Epoch: 13, Steps: 12 | Train Loss: 0.828 Vali Loss: 1.023 Vali Acc: 0.711 Test Loss: 1.023 Test Acc: 0.711
Validation loss decreased (-0.672211 --> -0.711101).  Saving model ...
Epoch: 14 cost time: 1.088855266571045
Epoch: 14, Steps: 12 | Train Loss: 0.719 Vali Loss: 0.942 Vali Acc: 0.739 Test Loss: 0.942 Test Acc: 0.739
Validation loss decreased (-0.711101 --> -0.738879).  Saving model ...
Epoch: 15 cost time: 1.1565542221069336
Epoch: 15, Steps: 12 | Train Loss: 0.582 Vali Loss: 0.859 Vali Acc: 0.739 Test Loss: 0.859 Test Acc: 0.739
Validation loss decreased (-0.738879 --> -0.738880).  Saving model ...
Epoch: 16 cost time: 1.0211753845214844
Epoch: 16, Steps: 12 | Train Loss: 0.556 Vali Loss: 0.837 Vali Acc: 0.772 Test Loss: 0.837 Test Acc: 0.772
Validation loss decreased (-0.738880 --> -0.772214).  Saving model ...
Epoch: 17 cost time: 0.9850149154663086
Epoch: 17, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.747 Vali Acc: 0.789 Test Loss: 0.747 Test Acc: 0.789
Validation loss decreased (-0.772214 --> -0.788881).  Saving model ...
Epoch: 18 cost time: 1.056373119354248
Epoch: 18, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.689 Vali Acc: 0.800 Test Loss: 0.689 Test Acc: 0.800
Validation loss decreased (-0.788881 --> -0.799993).  Saving model ...
Epoch: 19 cost time: 1.0419502258300781
Epoch: 19, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.660 Vali Acc: 0.811 Test Loss: 0.660 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811105).  Saving model ...
Epoch: 20 cost time: 1.0909936428070068
Epoch: 20, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.652 Vali Acc: 0.833 Test Loss: 0.652 Test Acc: 0.833
Validation loss decreased (-0.811105 --> -0.833327).  Saving model ...
Epoch: 21 cost time: 1.0683555603027344
Epoch: 21, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.615 Vali Acc: 0.844 Test Loss: 0.615 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844438).  Saving model ...
Epoch: 22 cost time: 1.1026010513305664
Epoch: 22, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.634 Vali Acc: 0.850 Test Loss: 0.634 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 23 cost time: 1.0010044574737549
Epoch: 23, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.549 Vali Acc: 0.861 Test Loss: 0.549 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861106).  Saving model ...
Epoch: 24 cost time: 1.0114924907684326
Epoch: 24, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.575 Vali Acc: 0.872 Test Loss: 0.575 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872216).  Saving model ...
Epoch: 25 cost time: 0.8774988651275635
Epoch: 25, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.547 Vali Acc: 0.867 Test Loss: 0.547 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.084303617477417
Epoch: 26, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.521 Vali Acc: 0.883 Test Loss: 0.521 Test Acc: 0.883
Validation loss decreased (-0.872216 --> -0.883328).  Saving model ...
Epoch: 27 cost time: 0.9616978168487549
Epoch: 27, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.515 Vali Acc: 0.878 Test Loss: 0.515 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0272915363311768
Epoch: 28, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.497 Vali Acc: 0.883 Test Loss: 0.497 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883328).  Saving model ...
Epoch: 29 cost time: 1.0502369403839111
Epoch: 29, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.516 Vali Acc: 0.872 Test Loss: 0.516 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8451273441314697
Epoch: 30, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.514 Vali Acc: 0.889 Test Loss: 0.514 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888884).  Saving model ...
Epoch: 31 cost time: 0.8750870227813721
Epoch: 31, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.513 Vali Acc: 0.867 Test Loss: 0.513 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9873137474060059
Epoch: 32, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.487 Vali Acc: 0.894 Test Loss: 0.487 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894440).  Saving model ...
Epoch: 33 cost time: 0.9638879299163818
Epoch: 33, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.535 Vali Acc: 0.894 Test Loss: 0.535 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9042959213256836
Epoch: 34, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.511 Vali Acc: 0.894 Test Loss: 0.511 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.913733959197998
Epoch: 35, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.499 Vali Acc: 0.894 Test Loss: 0.499 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8951778411865234
Epoch: 36, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.592 Vali Acc: 0.883 Test Loss: 0.592 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.9889953136444092
Epoch: 37, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.576 Vali Acc: 0.867 Test Loss: 0.576 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.0050570964813232
Epoch: 38, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.521 Vali Acc: 0.883 Test Loss: 0.521 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.009044885635376
Epoch: 39, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.586 Vali Acc: 0.867 Test Loss: 0.586 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.8681144714355469
Epoch: 40, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.556 Vali Acc: 0.889 Test Loss: 0.556 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.9801714420318604
Epoch: 41, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.548 Vali Acc: 0.894 Test Loss: 0.548 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.203376054763794
Epoch: 42, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.561 Vali Acc: 0.889 Test Loss: 0.561 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 1213991
model size : 7.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3556134700775146
Epoch: 1, Steps: 12 | Train Loss: 2.863 Vali Loss: 2.804 Vali Acc: 0.050 Test Loss: 2.804 Test Acc: 0.050
Validation loss decreased (inf --> -0.049972).  Saving model ...
Epoch: 2 cost time: 1.0380275249481201
Epoch: 2, Steps: 12 | Train Loss: 2.694 Vali Loss: 2.652 Vali Acc: 0.144 Test Loss: 2.652 Test Acc: 0.144
Validation loss decreased (-0.049972 --> -0.144418).  Saving model ...
Epoch: 3 cost time: 0.852135419845581
Epoch: 3, Steps: 12 | Train Loss: 2.553 Vali Loss: 2.536 Vali Acc: 0.222 Test Loss: 2.536 Test Acc: 0.222
Validation loss decreased (-0.144418 --> -0.222197).  Saving model ...
Epoch: 4 cost time: 0.9288649559020996
Epoch: 4, Steps: 12 | Train Loss: 2.450 Vali Loss: 2.405 Vali Acc: 0.306 Test Loss: 2.405 Test Acc: 0.306
Validation loss decreased (-0.222197 --> -0.305532).  Saving model ...
Epoch: 5 cost time: 0.8852980136871338
Epoch: 5, Steps: 12 | Train Loss: 2.257 Vali Loss: 2.253 Vali Acc: 0.411 Test Loss: 2.253 Test Acc: 0.411
Validation loss decreased (-0.305532 --> -0.411089).  Saving model ...
Epoch: 6 cost time: 0.9225513935089111
Epoch: 6, Steps: 12 | Train Loss: 2.079 Vali Loss: 2.081 Vali Acc: 0.444 Test Loss: 2.081 Test Acc: 0.444
Validation loss decreased (-0.411089 --> -0.444424).  Saving model ...
Epoch: 7 cost time: 0.9172496795654297
Epoch: 7, Steps: 12 | Train Loss: 1.861 Vali Loss: 1.920 Vali Acc: 0.517 Test Loss: 1.920 Test Acc: 0.517
Validation loss decreased (-0.444424 --> -0.516647).  Saving model ...
Epoch: 8 cost time: 0.9961614608764648
Epoch: 8, Steps: 12 | Train Loss: 1.676 Vali Loss: 1.727 Vali Acc: 0.561 Test Loss: 1.727 Test Acc: 0.561
Validation loss decreased (-0.516647 --> -0.561094).  Saving model ...
Epoch: 9 cost time: 0.9588243961334229
Epoch: 9, Steps: 12 | Train Loss: 1.481 Vali Loss: 1.569 Vali Acc: 0.572 Test Loss: 1.569 Test Acc: 0.572
Validation loss decreased (-0.561094 --> -0.572207).  Saving model ...
Epoch: 10 cost time: 0.7989418506622314
Epoch: 10, Steps: 12 | Train Loss: 1.300 Vali Loss: 1.436 Vali Acc: 0.589 Test Loss: 1.436 Test Acc: 0.589
Validation loss decreased (-0.572207 --> -0.588875).  Saving model ...
Epoch: 11 cost time: 0.7886710166931152
Epoch: 11, Steps: 12 | Train Loss: 1.140 Vali Loss: 1.273 Vali Acc: 0.633 Test Loss: 1.273 Test Acc: 0.633
Validation loss decreased (-0.588875 --> -0.633321).  Saving model ...
Epoch: 12 cost time: 0.8093819618225098
Epoch: 12, Steps: 12 | Train Loss: 1.040 Vali Loss: 1.164 Vali Acc: 0.656 Test Loss: 1.164 Test Acc: 0.656
Validation loss decreased (-0.633321 --> -0.655544).  Saving model ...
Epoch: 13 cost time: 1.1087062358856201
Epoch: 13, Steps: 12 | Train Loss: 0.933 Vali Loss: 1.071 Vali Acc: 0.667 Test Loss: 1.071 Test Acc: 0.667
Validation loss decreased (-0.655544 --> -0.666656).  Saving model ...
Epoch: 14 cost time: 0.8037588596343994
Epoch: 14, Steps: 12 | Train Loss: 0.762 Vali Loss: 0.980 Vali Acc: 0.683 Test Loss: 0.980 Test Acc: 0.683
Validation loss decreased (-0.666656 --> -0.683324).  Saving model ...
Epoch: 15 cost time: 0.8228509426116943
Epoch: 15, Steps: 12 | Train Loss: 0.705 Vali Loss: 0.926 Vali Acc: 0.711 Test Loss: 0.926 Test Acc: 0.711
Validation loss decreased (-0.683324 --> -0.711102).  Saving model ...
Epoch: 16 cost time: 0.8976712226867676
Epoch: 16, Steps: 12 | Train Loss: 0.587 Vali Loss: 0.875 Vali Acc: 0.711 Test Loss: 0.875 Test Acc: 0.711
Validation loss decreased (-0.711102 --> -0.711102).  Saving model ...
Epoch: 17 cost time: 0.9154446125030518
Epoch: 17, Steps: 12 | Train Loss: 0.555 Vali Loss: 0.825 Vali Acc: 0.728 Test Loss: 0.825 Test Acc: 0.728
Validation loss decreased (-0.711102 --> -0.727770).  Saving model ...
Epoch: 18 cost time: 0.9333930015563965
Epoch: 18, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.803 Vali Acc: 0.744 Test Loss: 0.803 Test Acc: 0.744
Validation loss decreased (-0.727770 --> -0.744436).  Saving model ...
Epoch: 19 cost time: 0.9791238307952881
Epoch: 19, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.759 Vali Acc: 0.783 Test Loss: 0.759 Test Acc: 0.783
Validation loss decreased (-0.744436 --> -0.783326).  Saving model ...
Epoch: 20 cost time: 0.8205888271331787
Epoch: 20, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.719 Vali Acc: 0.772 Test Loss: 0.719 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9354343414306641
Epoch: 21, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.681 Vali Acc: 0.800 Test Loss: 0.681 Test Acc: 0.800
Validation loss decreased (-0.783326 --> -0.799993).  Saving model ...
Epoch: 22 cost time: 0.9065556526184082
Epoch: 22, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.705 Vali Acc: 0.789 Test Loss: 0.705 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9539258480072021
Epoch: 23, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.684 Vali Acc: 0.811 Test Loss: 0.684 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811104).  Saving model ...
Epoch: 24 cost time: 0.992218017578125
Epoch: 24, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.634 Vali Acc: 0.806 Test Loss: 0.634 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.108337640762329
Epoch: 25, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.588 Vali Acc: 0.833 Test Loss: 0.588 Test Acc: 0.833
Validation loss decreased (-0.811104 --> -0.833327).  Saving model ...
Epoch: 26 cost time: 0.9614317417144775
Epoch: 26, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.607 Vali Acc: 0.833 Test Loss: 0.607 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0168390274047852
Epoch: 27, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.618 Vali Acc: 0.822 Test Loss: 0.618 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9407010078430176
Epoch: 28, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.603 Vali Acc: 0.839 Test Loss: 0.603 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 29 cost time: 0.9848487377166748
Epoch: 29, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.601 Vali Acc: 0.839 Test Loss: 0.601 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 30 cost time: 0.9602181911468506
Epoch: 30, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.653 Vali Acc: 0.839 Test Loss: 0.653 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8861589431762695
Epoch: 31, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.626 Vali Acc: 0.844 Test Loss: 0.626 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844438).  Saving model ...
Epoch: 32 cost time: 1.0105249881744385
Epoch: 32, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.633 Vali Acc: 0.833 Test Loss: 0.633 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.084533929824829
Epoch: 33, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.641 Vali Acc: 0.839 Test Loss: 0.641 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1211223602294922
Epoch: 34, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.649 Vali Acc: 0.844 Test Loss: 0.649 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.0524013042449951
Epoch: 35, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.673 Vali Acc: 0.856 Test Loss: 0.673 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855549).  Saving model ...
Epoch: 36 cost time: 1.0782856941223145
Epoch: 36, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.631 Vali Acc: 0.850 Test Loss: 0.631 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9901478290557861
Epoch: 37, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.628 Vali Acc: 0.844 Test Loss: 0.628 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9608073234558105
Epoch: 38, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.701 Vali Acc: 0.850 Test Loss: 0.701 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.973181962966919
Epoch: 39, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.637 Vali Acc: 0.850 Test Loss: 0.637 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.097135305404663
Epoch: 40, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.625 Vali Acc: 0.861 Test Loss: 0.625 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 41 cost time: 0.907738208770752
Epoch: 41, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.660 Vali Acc: 0.850 Test Loss: 0.660 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0174663066864014
Epoch: 42, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.657 Vali Acc: 0.867 Test Loss: 0.657 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866660).  Saving model ...
Epoch: 43 cost time: 1.0582096576690674
Epoch: 43, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.666 Vali Acc: 0.867 Test Loss: 0.666 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8282997608184814
Epoch: 44, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.656 Vali Acc: 0.867 Test Loss: 0.656 Test Acc: 0.867
Validation loss decreased (-0.866660 --> -0.866660).  Saving model ...
Epoch: 45 cost time: 1.0550503730773926
Epoch: 45, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.660 Vali Acc: 0.878 Test Loss: 0.660 Test Acc: 0.878
Validation loss decreased (-0.866660 --> -0.877771).  Saving model ...
Epoch: 46 cost time: 0.936539888381958
Epoch: 46, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.679 Vali Acc: 0.856 Test Loss: 0.679 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.1307883262634277
Epoch: 47, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.674 Vali Acc: 0.867 Test Loss: 0.674 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.9056711196899414
Epoch: 48, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.698 Vali Acc: 0.872 Test Loss: 0.698 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.1693141460418701
Epoch: 49, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.744 Vali Acc: 0.856 Test Loss: 0.744 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.0914490222930908
Epoch: 50, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.730 Vali Acc: 0.867 Test Loss: 0.730 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.9527950286865234
Epoch: 51, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.714 Vali Acc: 0.844 Test Loss: 0.714 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.170172929763794
Epoch: 52, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.718 Vali Acc: 0.872 Test Loss: 0.718 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.9202239513397217
Epoch: 53, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.708 Vali Acc: 0.883 Test Loss: 0.708 Test Acc: 0.883
Validation loss decreased (-0.877771 --> -0.883326).  Saving model ...
Epoch: 54 cost time: 0.8807392120361328
Epoch: 54, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.695 Vali Acc: 0.861 Test Loss: 0.695 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.012681007385254
Epoch: 55, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.720 Vali Acc: 0.872 Test Loss: 0.720 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.198650598526001
Epoch: 56, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.787 Vali Acc: 0.861 Test Loss: 0.787 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.9985535144805908
Epoch: 57, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.857 Vali Acc: 0.822 Test Loss: 0.857 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.0410358905792236
Epoch: 58, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.702 Vali Acc: 0.867 Test Loss: 0.702 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.9993977546691895
Epoch: 59, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.782 Vali Acc: 0.839 Test Loss: 0.782 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.8372697830200195
Epoch: 60, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.760 Vali Acc: 0.850 Test Loss: 0.760 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 0.9566247463226318
Epoch: 61, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.708 Vali Acc: 0.828 Test Loss: 0.708 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 0.9684913158416748
Epoch: 62, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.743 Vali Acc: 0.850 Test Loss: 0.743 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 1.2286341190338135
Epoch: 63, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.735 Vali Acc: 0.861 Test Loss: 0.735 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 1018151
model size : 6.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6864092350006104
Epoch: 1, Steps: 12 | Train Loss: 2.768 Vali Loss: 2.680 Vali Acc: 0.156 Test Loss: 2.680 Test Acc: 0.156
Validation loss decreased (inf --> -0.155529).  Saving model ...
Epoch: 2 cost time: 0.8798553943634033
Epoch: 2, Steps: 12 | Train Loss: 2.640 Vali Loss: 2.574 Vali Acc: 0.194 Test Loss: 2.574 Test Acc: 0.194
Validation loss decreased (-0.155529 --> -0.194419).  Saving model ...
Epoch: 3 cost time: 0.8836648464202881
Epoch: 3, Steps: 12 | Train Loss: 2.499 Vali Loss: 2.457 Vali Acc: 0.278 Test Loss: 2.457 Test Acc: 0.278
Validation loss decreased (-0.194419 --> -0.277753).  Saving model ...
Epoch: 4 cost time: 0.956843376159668
Epoch: 4, Steps: 12 | Train Loss: 2.346 Vali Loss: 2.330 Vali Acc: 0.383 Test Loss: 2.330 Test Acc: 0.383
Validation loss decreased (-0.277753 --> -0.383310).  Saving model ...
Epoch: 5 cost time: 0.9767889976501465
Epoch: 5, Steps: 12 | Train Loss: 2.229 Vali Loss: 2.191 Vali Acc: 0.428 Test Loss: 2.191 Test Acc: 0.428
Validation loss decreased (-0.383310 --> -0.427756).  Saving model ...
Epoch: 6 cost time: 0.9457969665527344
Epoch: 6, Steps: 12 | Train Loss: 2.046 Vali Loss: 2.040 Vali Acc: 0.506 Test Loss: 2.040 Test Acc: 0.506
Validation loss decreased (-0.427756 --> -0.505535).  Saving model ...
Epoch: 7 cost time: 0.8759050369262695
Epoch: 7, Steps: 12 | Train Loss: 1.908 Vali Loss: 1.895 Vali Acc: 0.494 Test Loss: 1.895 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9619417190551758
Epoch: 8, Steps: 12 | Train Loss: 1.627 Vali Loss: 1.734 Vali Acc: 0.583 Test Loss: 1.734 Test Acc: 0.583
Validation loss decreased (-0.505535 --> -0.583316).  Saving model ...
Epoch: 9 cost time: 0.8693480491638184
Epoch: 9, Steps: 12 | Train Loss: 1.491 Vali Loss: 1.597 Vali Acc: 0.594 Test Loss: 1.597 Test Acc: 0.594
Validation loss decreased (-0.583316 --> -0.594428).  Saving model ...
Epoch: 10 cost time: 0.906867504119873
Epoch: 10, Steps: 12 | Train Loss: 1.287 Vali Loss: 1.472 Vali Acc: 0.567 Test Loss: 1.472 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9639256000518799
Epoch: 11, Steps: 12 | Train Loss: 1.171 Vali Loss: 1.334 Vali Acc: 0.617 Test Loss: 1.334 Test Acc: 0.617
Validation loss decreased (-0.594428 --> -0.616653).  Saving model ...
Epoch: 12 cost time: 0.8897836208343506
Epoch: 12, Steps: 12 | Train Loss: 1.084 Vali Loss: 1.225 Vali Acc: 0.617 Test Loss: 1.225 Test Acc: 0.617
Validation loss decreased (-0.616653 --> -0.616654).  Saving model ...
Epoch: 13 cost time: 0.9430804252624512
Epoch: 13, Steps: 12 | Train Loss: 0.905 Vali Loss: 1.106 Vali Acc: 0.628 Test Loss: 1.106 Test Acc: 0.628
Validation loss decreased (-0.616654 --> -0.627767).  Saving model ...
Epoch: 14 cost time: 0.8905360698699951
Epoch: 14, Steps: 12 | Train Loss: 0.841 Vali Loss: 1.049 Vali Acc: 0.650 Test Loss: 1.049 Test Acc: 0.650
Validation loss decreased (-0.627767 --> -0.649990).  Saving model ...
Epoch: 15 cost time: 0.9182717800140381
Epoch: 15, Steps: 12 | Train Loss: 0.740 Vali Loss: 0.976 Vali Acc: 0.706 Test Loss: 0.976 Test Acc: 0.706
Validation loss decreased (-0.649990 --> -0.705546).  Saving model ...
Epoch: 16 cost time: 0.970017671585083
Epoch: 16, Steps: 12 | Train Loss: 0.606 Vali Loss: 0.907 Vali Acc: 0.711 Test Loss: 0.907 Test Acc: 0.711
Validation loss decreased (-0.705546 --> -0.711102).  Saving model ...
Epoch: 17 cost time: 0.8674352169036865
Epoch: 17, Steps: 12 | Train Loss: 0.596 Vali Loss: 0.835 Vali Acc: 0.728 Test Loss: 0.835 Test Acc: 0.728
Validation loss decreased (-0.711102 --> -0.727769).  Saving model ...
Epoch: 18 cost time: 0.8517494201660156
Epoch: 18, Steps: 12 | Train Loss: 0.500 Vali Loss: 0.786 Vali Acc: 0.767 Test Loss: 0.786 Test Acc: 0.767
Validation loss decreased (-0.727769 --> -0.766659).  Saving model ...
Epoch: 19 cost time: 0.9231932163238525
Epoch: 19, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.775 Vali Acc: 0.744 Test Loss: 0.775 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0025618076324463
Epoch: 20, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.671 Vali Acc: 0.783 Test Loss: 0.671 Test Acc: 0.783
Validation loss decreased (-0.766659 --> -0.783327).  Saving model ...
Epoch: 21 cost time: 0.9680407047271729
Epoch: 21, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.685 Vali Acc: 0.789 Test Loss: 0.685 Test Acc: 0.789
Validation loss decreased (-0.783327 --> -0.788882).  Saving model ...
Epoch: 22 cost time: 0.8403246402740479
Epoch: 22, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.670 Vali Acc: 0.817 Test Loss: 0.670 Test Acc: 0.817
Validation loss decreased (-0.788882 --> -0.816660).  Saving model ...
Epoch: 23 cost time: 1.0625216960906982
Epoch: 23, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.638 Vali Acc: 0.822 Test Loss: 0.638 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 24 cost time: 0.9422919750213623
Epoch: 24, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.642 Vali Acc: 0.822 Test Loss: 0.642 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.794243335723877
Epoch: 25, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.686 Vali Acc: 0.794 Test Loss: 0.686 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.864962100982666
Epoch: 26, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.688 Vali Acc: 0.794 Test Loss: 0.688 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7947583198547363
Epoch: 27, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.587 Vali Acc: 0.839 Test Loss: 0.587 Test Acc: 0.839
Validation loss decreased (-0.822216 --> -0.838883).  Saving model ...
Epoch: 28 cost time: 0.9384617805480957
Epoch: 28, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.613 Vali Acc: 0.839 Test Loss: 0.613 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0297565460205078
Epoch: 29, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.654 Vali Acc: 0.839 Test Loss: 0.654 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9437563419342041
Epoch: 30, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.609 Vali Acc: 0.850 Test Loss: 0.609 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 31 cost time: 0.9818277359008789
Epoch: 31, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.622 Vali Acc: 0.861 Test Loss: 0.622 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 32 cost time: 1.060002326965332
Epoch: 32, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.600 Vali Acc: 0.850 Test Loss: 0.600 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9887747764587402
Epoch: 33, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.639 Vali Acc: 0.844 Test Loss: 0.639 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9571044445037842
Epoch: 34, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.725 Vali Acc: 0.850 Test Loss: 0.725 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8191399574279785
Epoch: 35, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.589 Vali Acc: 0.861 Test Loss: 0.589 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 36 cost time: 0.8075971603393555
Epoch: 36, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.671 Vali Acc: 0.850 Test Loss: 0.671 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0369431972503662
Epoch: 37, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.619 Vali Acc: 0.850 Test Loss: 0.619 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.869373083114624
Epoch: 38, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.678 Vali Acc: 0.850 Test Loss: 0.678 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9984791278839111
Epoch: 39, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.690 Vali Acc: 0.861 Test Loss: 0.690 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.8536789417266846
Epoch: 40, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.649 Vali Acc: 0.867 Test Loss: 0.649 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866660).  Saving model ...
Epoch: 41 cost time: 1.0497665405273438
Epoch: 41, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.635 Vali Acc: 0.850 Test Loss: 0.635 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0313317775726318
Epoch: 42, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.627 Vali Acc: 0.872 Test Loss: 0.627 Test Acc: 0.872
Validation loss decreased (-0.866660 --> -0.872216).  Saving model ...
Epoch: 43 cost time: 0.9051938056945801
Epoch: 43, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.688 Vali Acc: 0.867 Test Loss: 0.688 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9952538013458252
Epoch: 44, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.684 Vali Acc: 0.861 Test Loss: 0.684 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.956770658493042
Epoch: 45, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.689 Vali Acc: 0.861 Test Loss: 0.689 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.9339878559112549
Epoch: 46, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.701 Vali Acc: 0.861 Test Loss: 0.701 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.8812685012817383
Epoch: 47, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.718 Vali Acc: 0.850 Test Loss: 0.718 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.951678991317749
Epoch: 48, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.778 Vali Acc: 0.844 Test Loss: 0.778 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.0359020233154297
Epoch: 49, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.701 Vali Acc: 0.861 Test Loss: 0.701 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.0462183952331543
Epoch: 50, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.672 Vali Acc: 0.867 Test Loss: 0.672 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.8739056587219238
Epoch: 51, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.680 Vali Acc: 0.861 Test Loss: 0.680 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.0206925868988037
Epoch: 52, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.684 Vali Acc: 0.861 Test Loss: 0.684 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 1017639
model size : 6.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.770008087158203
Epoch: 1, Steps: 12 | Train Loss: 2.969 Vali Loss: 2.785 Vali Acc: 0.011 Test Loss: 2.785 Test Acc: 0.011
Validation loss decreased (inf --> -0.011083).  Saving model ...
Epoch: 2 cost time: 1.0191326141357422
Epoch: 2, Steps: 12 | Train Loss: 2.770 Vali Loss: 2.673 Vali Acc: 0.156 Test Loss: 2.673 Test Acc: 0.156
Validation loss decreased (-0.011083 --> -0.155529).  Saving model ...
Epoch: 3 cost time: 0.877084493637085
Epoch: 3, Steps: 12 | Train Loss: 2.653 Vali Loss: 2.557 Vali Acc: 0.211 Test Loss: 2.557 Test Acc: 0.211
Validation loss decreased (-0.155529 --> -0.211086).  Saving model ...
Epoch: 4 cost time: 0.9925360679626465
Epoch: 4, Steps: 12 | Train Loss: 2.498 Vali Loss: 2.424 Vali Acc: 0.372 Test Loss: 2.424 Test Acc: 0.372
Validation loss decreased (-0.211086 --> -0.372198).  Saving model ...
Epoch: 5 cost time: 0.9564609527587891
Epoch: 5, Steps: 12 | Train Loss: 2.302 Vali Loss: 2.257 Vali Acc: 0.372 Test Loss: 2.257 Test Acc: 0.372
Validation loss decreased (-0.372198 --> -0.372200).  Saving model ...
Epoch: 6 cost time: 1.1743783950805664
Epoch: 6, Steps: 12 | Train Loss: 2.217 Vali Loss: 2.099 Vali Acc: 0.489 Test Loss: 2.099 Test Acc: 0.489
Validation loss decreased (-0.372200 --> -0.488868).  Saving model ...
Epoch: 7 cost time: 1.0160436630249023
Epoch: 7, Steps: 12 | Train Loss: 1.921 Vali Loss: 1.934 Vali Acc: 0.550 Test Loss: 1.934 Test Acc: 0.550
Validation loss decreased (-0.488868 --> -0.549981).  Saving model ...
Epoch: 8 cost time: 1.0170550346374512
Epoch: 8, Steps: 12 | Train Loss: 1.733 Vali Loss: 1.767 Vali Acc: 0.556 Test Loss: 1.767 Test Acc: 0.556
Validation loss decreased (-0.549981 --> -0.555538).  Saving model ...
Epoch: 9 cost time: 0.9875433444976807
Epoch: 9, Steps: 12 | Train Loss: 1.527 Vali Loss: 1.590 Vali Acc: 0.550 Test Loss: 1.590 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0500907897949219
Epoch: 10, Steps: 12 | Train Loss: 1.304 Vali Loss: 1.441 Vali Acc: 0.589 Test Loss: 1.441 Test Acc: 0.589
Validation loss decreased (-0.555538 --> -0.588874).  Saving model ...
Epoch: 11 cost time: 0.9884047508239746
Epoch: 11, Steps: 12 | Train Loss: 1.137 Vali Loss: 1.318 Vali Acc: 0.622 Test Loss: 1.318 Test Acc: 0.622
Validation loss decreased (-0.588874 --> -0.622209).  Saving model ...
Epoch: 12 cost time: 1.0410096645355225
Epoch: 12, Steps: 12 | Train Loss: 1.131 Vali Loss: 1.256 Vali Acc: 0.656 Test Loss: 1.256 Test Acc: 0.656
Validation loss decreased (-0.622209 --> -0.655543).  Saving model ...
Epoch: 13 cost time: 1.0107910633087158
Epoch: 13, Steps: 12 | Train Loss: 0.911 Vali Loss: 1.126 Vali Acc: 0.617 Test Loss: 1.126 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9598484039306641
Epoch: 14, Steps: 12 | Train Loss: 0.797 Vali Loss: 1.028 Vali Acc: 0.678 Test Loss: 1.028 Test Acc: 0.678
Validation loss decreased (-0.655543 --> -0.677767).  Saving model ...
Epoch: 15 cost time: 1.0013954639434814
Epoch: 15, Steps: 12 | Train Loss: 0.709 Vali Loss: 0.965 Vali Acc: 0.728 Test Loss: 0.965 Test Acc: 0.728
Validation loss decreased (-0.677767 --> -0.727768).  Saving model ...
Epoch: 16 cost time: 0.9244117736816406
Epoch: 16, Steps: 12 | Train Loss: 0.608 Vali Loss: 0.861 Vali Acc: 0.728 Test Loss: 0.861 Test Acc: 0.728
Validation loss decreased (-0.727768 --> -0.727769).  Saving model ...
Epoch: 17 cost time: 1.2520642280578613
Epoch: 17, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.878 Vali Acc: 0.706 Test Loss: 0.878 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1982665061950684
Epoch: 18, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.773 Vali Acc: 0.767 Test Loss: 0.773 Test Acc: 0.767
Validation loss decreased (-0.727769 --> -0.766659).  Saving model ...
Epoch: 19 cost time: 1.1066107749938965
Epoch: 19, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.745 Vali Acc: 0.794 Test Loss: 0.745 Test Acc: 0.794
Validation loss decreased (-0.766659 --> -0.794437).  Saving model ...
Epoch: 20 cost time: 1.073106050491333
Epoch: 20, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.708 Vali Acc: 0.794 Test Loss: 0.708 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794437).  Saving model ...
Epoch: 21 cost time: 1.1768543720245361
Epoch: 21, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.671 Vali Acc: 0.794 Test Loss: 0.671 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794438).  Saving model ...
Epoch: 22 cost time: 1.0052578449249268
Epoch: 22, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.661 Vali Acc: 0.794 Test Loss: 0.661 Test Acc: 0.794
Validation loss decreased (-0.794438 --> -0.794438).  Saving model ...
Epoch: 23 cost time: 1.0875670909881592
Epoch: 23, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.650 Vali Acc: 0.828 Test Loss: 0.650 Test Acc: 0.828
Validation loss decreased (-0.794438 --> -0.827771).  Saving model ...
Epoch: 24 cost time: 0.9585671424865723
Epoch: 24, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.671 Vali Acc: 0.806 Test Loss: 0.671 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0200834274291992
Epoch: 25, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.700 Vali Acc: 0.828 Test Loss: 0.700 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0770869255065918
Epoch: 26, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.617 Vali Acc: 0.833 Test Loss: 0.617 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 27 cost time: 1.2221674919128418
Epoch: 27, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.683 Vali Acc: 0.822 Test Loss: 0.683 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.982823371887207
Epoch: 28, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.660 Vali Acc: 0.839 Test Loss: 0.660 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838882).  Saving model ...
Epoch: 29 cost time: 1.0502958297729492
Epoch: 29, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.648 Vali Acc: 0.839 Test Loss: 0.648 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838882).  Saving model ...
Epoch: 30 cost time: 0.9495747089385986
Epoch: 30, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.654 Vali Acc: 0.867 Test Loss: 0.654 Test Acc: 0.867
Validation loss decreased (-0.838882 --> -0.866660).  Saving model ...
Epoch: 31 cost time: 0.9819295406341553
Epoch: 31, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.661 Vali Acc: 0.861 Test Loss: 0.661 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.895068883895874
Epoch: 32, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.688 Vali Acc: 0.856 Test Loss: 0.688 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9326107501983643
Epoch: 33, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.671 Vali Acc: 0.856 Test Loss: 0.671 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9611632823944092
Epoch: 34, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.685 Vali Acc: 0.844 Test Loss: 0.685 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.0995118618011475
Epoch: 35, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.676 Vali Acc: 0.844 Test Loss: 0.676 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.9918584823608398
Epoch: 36, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.645 Vali Acc: 0.833 Test Loss: 0.645 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.9995989799499512
Epoch: 37, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.643 Vali Acc: 0.850 Test Loss: 0.643 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.9765274524688721
Epoch: 38, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.736 Vali Acc: 0.850 Test Loss: 0.736 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.9611034393310547
Epoch: 39, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.737 Vali Acc: 0.861 Test Loss: 0.737 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.012826681137085
Epoch: 40, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.709 Vali Acc: 0.844 Test Loss: 0.709 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 1017127
model size : 6.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4141860008239746
Epoch: 1, Steps: 12 | Train Loss: 2.827 Vali Loss: 2.719 Vali Acc: 0.078 Test Loss: 2.719 Test Acc: 0.078
Validation loss decreased (inf --> -0.077751).  Saving model ...
Epoch: 2 cost time: 0.9880104064941406
Epoch: 2, Steps: 12 | Train Loss: 2.731 Vali Loss: 2.606 Vali Acc: 0.128 Test Loss: 2.606 Test Acc: 0.128
Validation loss decreased (-0.077751 --> -0.127752).  Saving model ...
Epoch: 3 cost time: 1.0295515060424805
Epoch: 3, Steps: 12 | Train Loss: 2.602 Vali Loss: 2.495 Vali Acc: 0.217 Test Loss: 2.495 Test Acc: 0.217
Validation loss decreased (-0.127752 --> -0.216642).  Saving model ...
Epoch: 4 cost time: 0.9526686668395996
Epoch: 4, Steps: 12 | Train Loss: 2.403 Vali Loss: 2.362 Vali Acc: 0.344 Test Loss: 2.362 Test Acc: 0.344
Validation loss decreased (-0.216642 --> -0.344421).  Saving model ...
Epoch: 5 cost time: 0.7799282073974609
Epoch: 5, Steps: 12 | Train Loss: 2.343 Vali Loss: 2.201 Vali Acc: 0.400 Test Loss: 2.201 Test Acc: 0.400
Validation loss decreased (-0.344421 --> -0.399978).  Saving model ...
Epoch: 6 cost time: 0.844569206237793
Epoch: 6, Steps: 12 | Train Loss: 2.097 Vali Loss: 2.036 Vali Acc: 0.517 Test Loss: 2.036 Test Acc: 0.517
Validation loss decreased (-0.399978 --> -0.516646).  Saving model ...
Epoch: 7 cost time: 0.8209123611450195
Epoch: 7, Steps: 12 | Train Loss: 1.894 Vali Loss: 1.867 Vali Acc: 0.550 Test Loss: 1.867 Test Acc: 0.550
Validation loss decreased (-0.516646 --> -0.549981).  Saving model ...
Epoch: 8 cost time: 1.1855242252349854
Epoch: 8, Steps: 12 | Train Loss: 1.691 Vali Loss: 1.703 Vali Acc: 0.583 Test Loss: 1.703 Test Acc: 0.583
Validation loss decreased (-0.549981 --> -0.583316).  Saving model ...
Epoch: 9 cost time: 0.9481761455535889
Epoch: 9, Steps: 12 | Train Loss: 1.451 Vali Loss: 1.535 Vali Acc: 0.594 Test Loss: 1.535 Test Acc: 0.594
Validation loss decreased (-0.583316 --> -0.594429).  Saving model ...
Epoch: 10 cost time: 1.2785019874572754
Epoch: 10, Steps: 12 | Train Loss: 1.293 Vali Loss: 1.425 Vali Acc: 0.567 Test Loss: 1.425 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0800442695617676
Epoch: 11, Steps: 12 | Train Loss: 1.161 Vali Loss: 1.291 Vali Acc: 0.589 Test Loss: 1.291 Test Acc: 0.589
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9378485679626465
Epoch: 12, Steps: 12 | Train Loss: 1.052 Vali Loss: 1.197 Vali Acc: 0.617 Test Loss: 1.197 Test Acc: 0.617
Validation loss decreased (-0.594429 --> -0.616655).  Saving model ...
Epoch: 13 cost time: 0.8046865463256836
Epoch: 13, Steps: 12 | Train Loss: 0.927 Vali Loss: 1.088 Vali Acc: 0.639 Test Loss: 1.088 Test Acc: 0.639
Validation loss decreased (-0.616655 --> -0.638878).  Saving model ...
Epoch: 14 cost time: 0.95578932762146
Epoch: 14, Steps: 12 | Train Loss: 0.822 Vali Loss: 1.001 Vali Acc: 0.706 Test Loss: 1.001 Test Acc: 0.706
Validation loss decreased (-0.638878 --> -0.705546).  Saving model ...
Epoch: 15 cost time: 0.9002294540405273
Epoch: 15, Steps: 12 | Train Loss: 0.765 Vali Loss: 0.928 Vali Acc: 0.672 Test Loss: 0.928 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8743493556976318
Epoch: 16, Steps: 12 | Train Loss: 0.654 Vali Loss: 0.897 Vali Acc: 0.711 Test Loss: 0.897 Test Acc: 0.711
Validation loss decreased (-0.705546 --> -0.711102).  Saving model ...
Epoch: 17 cost time: 0.8795104026794434
Epoch: 17, Steps: 12 | Train Loss: 0.595 Vali Loss: 0.834 Vali Acc: 0.733 Test Loss: 0.834 Test Acc: 0.733
Validation loss decreased (-0.711102 --> -0.733325).  Saving model ...
Epoch: 18 cost time: 1.0291295051574707
Epoch: 18, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.754 Vali Acc: 0.756 Test Loss: 0.754 Test Acc: 0.756
Validation loss decreased (-0.733325 --> -0.755548).  Saving model ...
Epoch: 19 cost time: 0.9850544929504395
Epoch: 19, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.716 Vali Acc: 0.783 Test Loss: 0.716 Test Acc: 0.783
Validation loss decreased (-0.755548 --> -0.783326).  Saving model ...
Epoch: 20 cost time: 0.8882997035980225
Epoch: 20, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.692 Vali Acc: 0.772 Test Loss: 0.692 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0596370697021484
Epoch: 21, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.654 Vali Acc: 0.811 Test Loss: 0.654 Test Acc: 0.811
Validation loss decreased (-0.783326 --> -0.811105).  Saving model ...
Epoch: 22 cost time: 1.193516731262207
Epoch: 22, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.618 Vali Acc: 0.811 Test Loss: 0.618 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 23 cost time: 1.0752222537994385
Epoch: 23, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.595 Vali Acc: 0.839 Test Loss: 0.595 Test Acc: 0.839
Validation loss decreased (-0.811105 --> -0.838883).  Saving model ...
Epoch: 24 cost time: 1.0460596084594727
Epoch: 24, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.590 Vali Acc: 0.822 Test Loss: 0.590 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1246840953826904
Epoch: 25, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.601 Vali Acc: 0.856 Test Loss: 0.601 Test Acc: 0.856
Validation loss decreased (-0.838883 --> -0.855550).  Saving model ...
Epoch: 26 cost time: 0.9793167114257812
Epoch: 26, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.526 Vali Acc: 0.856 Test Loss: 0.526 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 27 cost time: 0.9648952484130859
Epoch: 27, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.524 Vali Acc: 0.861 Test Loss: 0.524 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 28 cost time: 1.0432846546173096
Epoch: 28, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.520 Vali Acc: 0.867 Test Loss: 0.520 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 29 cost time: 1.0577208995819092
Epoch: 29, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.516 Vali Acc: 0.889 Test Loss: 0.516 Test Acc: 0.889
Validation loss decreased (-0.866661 --> -0.888884).  Saving model ...
Epoch: 30 cost time: 1.0663201808929443
Epoch: 30, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.518 Vali Acc: 0.889 Test Loss: 0.518 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1233537197113037
Epoch: 31, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.540 Vali Acc: 0.861 Test Loss: 0.540 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.133760929107666
Epoch: 32, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.577 Vali Acc: 0.867 Test Loss: 0.577 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9344320297241211
Epoch: 33, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.592 Vali Acc: 0.856 Test Loss: 0.592 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.964533805847168
Epoch: 34, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.568 Vali Acc: 0.867 Test Loss: 0.568 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.8939042091369629
Epoch: 35, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.531 Vali Acc: 0.889 Test Loss: 0.531 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.0691745281219482
Epoch: 36, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.564 Vali Acc: 0.861 Test Loss: 0.564 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.9226152896881104
Epoch: 37, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.581 Vali Acc: 0.883 Test Loss: 0.581 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.9766180515289307
Epoch: 38, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.569 Vali Acc: 0.883 Test Loss: 0.569 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.8833212852478027
Epoch: 39, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.615 Vali Acc: 0.861 Test Loss: 0.615 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 1016615
model size : 6.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4513044357299805
Epoch: 1, Steps: 12 | Train Loss: 2.816 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 1.000169038772583
Epoch: 2, Steps: 12 | Train Loss: 2.703 Vali Loss: 2.590 Vali Acc: 0.144 Test Loss: 2.590 Test Acc: 0.144
Validation loss decreased (-0.066640 --> -0.144419).  Saving model ...
Epoch: 3 cost time: 0.9338560104370117
Epoch: 3, Steps: 12 | Train Loss: 2.595 Vali Loss: 2.479 Vali Acc: 0.211 Test Loss: 2.479 Test Acc: 0.211
Validation loss decreased (-0.144419 --> -0.211086).  Saving model ...
Epoch: 4 cost time: 0.8748176097869873
Epoch: 4, Steps: 12 | Train Loss: 2.427 Vali Loss: 2.376 Vali Acc: 0.289 Test Loss: 2.376 Test Acc: 0.289
Validation loss decreased (-0.211086 --> -0.288865).  Saving model ...
Epoch: 5 cost time: 0.853553295135498
Epoch: 5, Steps: 12 | Train Loss: 2.359 Vali Loss: 2.230 Vali Acc: 0.389 Test Loss: 2.230 Test Acc: 0.389
Validation loss decreased (-0.288865 --> -0.388867).  Saving model ...
Epoch: 6 cost time: 0.8788149356842041
Epoch: 6, Steps: 12 | Train Loss: 2.167 Vali Loss: 2.090 Vali Acc: 0.478 Test Loss: 2.090 Test Acc: 0.478
Validation loss decreased (-0.388867 --> -0.477757).  Saving model ...
Epoch: 7 cost time: 0.8833892345428467
Epoch: 7, Steps: 12 | Train Loss: 1.971 Vali Loss: 1.924 Vali Acc: 0.544 Test Loss: 1.924 Test Acc: 0.544
Validation loss decreased (-0.477757 --> -0.544425).  Saving model ...
Epoch: 8 cost time: 0.9615457057952881
Epoch: 8, Steps: 12 | Train Loss: 1.790 Vali Loss: 1.757 Vali Acc: 0.583 Test Loss: 1.757 Test Acc: 0.583
Validation loss decreased (-0.544425 --> -0.583316).  Saving model ...
Epoch: 9 cost time: 0.8491919040679932
Epoch: 9, Steps: 12 | Train Loss: 1.626 Vali Loss: 1.581 Vali Acc: 0.611 Test Loss: 1.581 Test Acc: 0.611
Validation loss decreased (-0.583316 --> -0.611095).  Saving model ...
Epoch: 10 cost time: 1.0276737213134766
Epoch: 10, Steps: 12 | Train Loss: 1.439 Vali Loss: 1.433 Vali Acc: 0.606 Test Loss: 1.433 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9479501247406006
Epoch: 11, Steps: 12 | Train Loss: 1.192 Vali Loss: 1.312 Vali Acc: 0.617 Test Loss: 1.312 Test Acc: 0.617
Validation loss decreased (-0.611095 --> -0.616654).  Saving model ...
Epoch: 12 cost time: 0.878298282623291
Epoch: 12, Steps: 12 | Train Loss: 1.110 Vali Loss: 1.212 Vali Acc: 0.678 Test Loss: 1.212 Test Acc: 0.678
Validation loss decreased (-0.616654 --> -0.677766).  Saving model ...
Epoch: 13 cost time: 1.097353458404541
Epoch: 13, Steps: 12 | Train Loss: 0.946 Vali Loss: 1.123 Vali Acc: 0.628 Test Loss: 1.123 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9082896709442139
Epoch: 14, Steps: 12 | Train Loss: 0.800 Vali Loss: 0.996 Vali Acc: 0.683 Test Loss: 0.996 Test Acc: 0.683
Validation loss decreased (-0.677766 --> -0.683323).  Saving model ...
Epoch: 15 cost time: 0.9531803131103516
Epoch: 15, Steps: 12 | Train Loss: 0.696 Vali Loss: 0.948 Vali Acc: 0.722 Test Loss: 0.948 Test Acc: 0.722
Validation loss decreased (-0.683323 --> -0.722213).  Saving model ...
Epoch: 16 cost time: 1.0467133522033691
Epoch: 16, Steps: 12 | Train Loss: 0.640 Vali Loss: 0.884 Vali Acc: 0.733 Test Loss: 0.884 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733324).  Saving model ...
Epoch: 17 cost time: 0.819286584854126
Epoch: 17, Steps: 12 | Train Loss: 0.554 Vali Loss: 0.795 Vali Acc: 0.744 Test Loss: 0.795 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744436).  Saving model ...
Epoch: 18 cost time: 0.8866927623748779
Epoch: 18, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.762 Vali Acc: 0.778 Test Loss: 0.762 Test Acc: 0.778
Validation loss decreased (-0.744436 --> -0.777770).  Saving model ...
Epoch: 19 cost time: 0.9355485439300537
Epoch: 19, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.712 Vali Acc: 0.800 Test Loss: 0.712 Test Acc: 0.800
Validation loss decreased (-0.777770 --> -0.799993).  Saving model ...
Epoch: 20 cost time: 0.9549214839935303
Epoch: 20, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.669 Vali Acc: 0.817 Test Loss: 0.669 Test Acc: 0.817
Validation loss decreased (-0.799993 --> -0.816660).  Saving model ...
Epoch: 21 cost time: 1.0636200904846191
Epoch: 21, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.624 Vali Acc: 0.811 Test Loss: 0.624 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9113421440124512
Epoch: 22, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.601 Vali Acc: 0.839 Test Loss: 0.601 Test Acc: 0.839
Validation loss decreased (-0.816660 --> -0.838883).  Saving model ...
Epoch: 23 cost time: 0.847219705581665
Epoch: 23, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.586 Vali Acc: 0.861 Test Loss: 0.586 Test Acc: 0.861
Validation loss decreased (-0.838883 --> -0.861105).  Saving model ...
Epoch: 24 cost time: 0.9402236938476562
Epoch: 24, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.564 Vali Acc: 0.844 Test Loss: 0.564 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1293785572052002
Epoch: 25, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.555 Vali Acc: 0.856 Test Loss: 0.555 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8688585758209229
Epoch: 26, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.546 Vali Acc: 0.867 Test Loss: 0.546 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 27 cost time: 0.9392035007476807
Epoch: 27, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.556 Vali Acc: 0.867 Test Loss: 0.556 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9765264987945557
Epoch: 28, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.564 Vali Acc: 0.872 Test Loss: 0.564 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 29 cost time: 0.861940860748291
Epoch: 29, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.557 Vali Acc: 0.872 Test Loss: 0.557 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 30 cost time: 1.086329698562622
Epoch: 30, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.554 Vali Acc: 0.867 Test Loss: 0.554 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8958468437194824
Epoch: 31, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.563 Vali Acc: 0.867 Test Loss: 0.563 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0038871765136719
Epoch: 32, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.568 Vali Acc: 0.872 Test Loss: 0.568 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9974799156188965
Epoch: 33, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.609 Vali Acc: 0.872 Test Loss: 0.609 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9088585376739502
Epoch: 34, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.586 Vali Acc: 0.872 Test Loss: 0.586 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9678709506988525
Epoch: 35, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.560 Vali Acc: 0.878 Test Loss: 0.560 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 36 cost time: 1.1057722568511963
Epoch: 36, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.599 Vali Acc: 0.867 Test Loss: 0.599 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9216179847717285
Epoch: 37, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.596 Vali Acc: 0.867 Test Loss: 0.596 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.895805835723877
Epoch: 38, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.627 Vali Acc: 0.867 Test Loss: 0.627 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.1198902130126953
Epoch: 39, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.589 Vali Acc: 0.878 Test Loss: 0.589 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.8814191818237305
Epoch: 40, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.624 Vali Acc: 0.872 Test Loss: 0.624 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.9859514236450195
Epoch: 41, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.640 Vali Acc: 0.883 Test Loss: 0.640 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883327).  Saving model ...
Epoch: 42 cost time: 0.9279994964599609
Epoch: 42, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.633 Vali Acc: 0.878 Test Loss: 0.633 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0531561374664307
Epoch: 43, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.651 Vali Acc: 0.878 Test Loss: 0.651 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.9505007266998291
Epoch: 44, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.672 Vali Acc: 0.872 Test Loss: 0.672 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.9467422962188721
Epoch: 45, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.656 Vali Acc: 0.878 Test Loss: 0.656 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.939702033996582
Epoch: 46, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.645 Vali Acc: 0.883 Test Loss: 0.645 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.9737060070037842
Epoch: 47, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.703 Vali Acc: 0.872 Test Loss: 0.703 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.015244960784912
Epoch: 48, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.700 Vali Acc: 0.861 Test Loss: 0.700 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.932183027267456
Epoch: 49, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.637 Vali Acc: 0.872 Test Loss: 0.637 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.102271318435669
Epoch: 50, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.739 Vali Acc: 0.867 Test Loss: 0.739 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.2714202404022217
Epoch: 51, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.691 Vali Acc: 0.878 Test Loss: 0.691 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 919463
model size : 6.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.112628698348999
Epoch: 1, Steps: 12 | Train Loss: 2.856 Vali Loss: 2.722 Vali Acc: 0.094 Test Loss: 2.722 Test Acc: 0.094
Validation loss decreased (inf --> -0.094417).  Saving model ...
Epoch: 2 cost time: 1.065321683883667
Epoch: 2, Steps: 12 | Train Loss: 2.722 Vali Loss: 2.594 Vali Acc: 0.189 Test Loss: 2.594 Test Acc: 0.189
Validation loss decreased (-0.094417 --> -0.188863).  Saving model ...
Epoch: 3 cost time: 1.053642749786377
Epoch: 3, Steps: 12 | Train Loss: 2.619 Vali Loss: 2.488 Vali Acc: 0.239 Test Loss: 2.488 Test Acc: 0.239
Validation loss decreased (-0.188863 --> -0.238864).  Saving model ...
Epoch: 4 cost time: 1.0773353576660156
Epoch: 4, Steps: 12 | Train Loss: 2.430 Vali Loss: 2.365 Vali Acc: 0.383 Test Loss: 2.365 Test Acc: 0.383
Validation loss decreased (-0.238864 --> -0.383310).  Saving model ...
Epoch: 5 cost time: 1.383765697479248
Epoch: 5, Steps: 12 | Train Loss: 2.348 Vali Loss: 2.233 Vali Acc: 0.411 Test Loss: 2.233 Test Acc: 0.411
Validation loss decreased (-0.383310 --> -0.411089).  Saving model ...
Epoch: 6 cost time: 1.239851474761963
Epoch: 6, Steps: 12 | Train Loss: 2.174 Vali Loss: 2.097 Vali Acc: 0.483 Test Loss: 2.097 Test Acc: 0.483
Validation loss decreased (-0.411089 --> -0.483312).  Saving model ...
Epoch: 7 cost time: 1.2230193614959717
Epoch: 7, Steps: 12 | Train Loss: 1.989 Vali Loss: 1.932 Vali Acc: 0.556 Test Loss: 1.932 Test Acc: 0.556
Validation loss decreased (-0.483312 --> -0.555536).  Saving model ...
Epoch: 8 cost time: 1.2008624076843262
Epoch: 8, Steps: 12 | Train Loss: 1.796 Vali Loss: 1.745 Vali Acc: 0.556 Test Loss: 1.745 Test Acc: 0.556
Validation loss decreased (-0.555536 --> -0.555538).  Saving model ...
Epoch: 9 cost time: 1.2847168445587158
Epoch: 9, Steps: 12 | Train Loss: 1.573 Vali Loss: 1.604 Vali Acc: 0.622 Test Loss: 1.604 Test Acc: 0.622
Validation loss decreased (-0.555538 --> -0.622206).  Saving model ...
Epoch: 10 cost time: 1.0654256343841553
Epoch: 10, Steps: 12 | Train Loss: 1.372 Vali Loss: 1.470 Vali Acc: 0.633 Test Loss: 1.470 Test Acc: 0.633
Validation loss decreased (-0.622206 --> -0.633319).  Saving model ...
Epoch: 11 cost time: 1.1000034809112549
Epoch: 11, Steps: 12 | Train Loss: 1.259 Vali Loss: 1.351 Vali Acc: 0.628 Test Loss: 1.351 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8849308490753174
Epoch: 12, Steps: 12 | Train Loss: 1.035 Vali Loss: 1.222 Vali Acc: 0.622 Test Loss: 1.222 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9669625759124756
Epoch: 13, Steps: 12 | Train Loss: 0.907 Vali Loss: 1.128 Vali Acc: 0.667 Test Loss: 1.128 Test Acc: 0.667
Validation loss decreased (-0.633319 --> -0.666655).  Saving model ...
Epoch: 14 cost time: 1.0820324420928955
Epoch: 14, Steps: 12 | Train Loss: 0.801 Vali Loss: 1.034 Vali Acc: 0.694 Test Loss: 1.034 Test Acc: 0.694
Validation loss decreased (-0.666655 --> -0.694434).  Saving model ...
Epoch: 15 cost time: 1.1148920059204102
Epoch: 15, Steps: 12 | Train Loss: 0.705 Vali Loss: 0.952 Vali Acc: 0.739 Test Loss: 0.952 Test Acc: 0.739
Validation loss decreased (-0.694434 --> -0.738879).  Saving model ...
Epoch: 16 cost time: 1.0711147785186768
Epoch: 16, Steps: 12 | Train Loss: 0.640 Vali Loss: 0.872 Vali Acc: 0.728 Test Loss: 0.872 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.994117259979248
Epoch: 17, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.810 Vali Acc: 0.767 Test Loss: 0.810 Test Acc: 0.767
Validation loss decreased (-0.738879 --> -0.766659).  Saving model ...
Epoch: 18 cost time: 0.9667572975158691
Epoch: 18, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.787 Vali Acc: 0.783 Test Loss: 0.787 Test Acc: 0.783
Validation loss decreased (-0.766659 --> -0.783325).  Saving model ...
Epoch: 19 cost time: 1.321347951889038
Epoch: 19, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.764 Vali Acc: 0.767 Test Loss: 0.764 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0007429122924805
Epoch: 20, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.703 Vali Acc: 0.817 Test Loss: 0.703 Test Acc: 0.817
Validation loss decreased (-0.783325 --> -0.816660).  Saving model ...
Epoch: 21 cost time: 1.092188835144043
Epoch: 21, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.694 Vali Acc: 0.806 Test Loss: 0.694 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0122525691986084
Epoch: 22, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.711 Vali Acc: 0.811 Test Loss: 0.711 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9806826114654541
Epoch: 23, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.662 Vali Acc: 0.839 Test Loss: 0.662 Test Acc: 0.839
Validation loss decreased (-0.816660 --> -0.838882).  Saving model ...
Epoch: 24 cost time: 0.9856343269348145
Epoch: 24, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.645 Vali Acc: 0.856 Test Loss: 0.645 Test Acc: 0.856
Validation loss decreased (-0.838882 --> -0.855549).  Saving model ...
Epoch: 25 cost time: 1.1853234767913818
Epoch: 25, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.594 Vali Acc: 0.844 Test Loss: 0.594 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9797585010528564
Epoch: 26, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.590 Vali Acc: 0.844 Test Loss: 0.590 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1878712177276611
Epoch: 27, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.610 Vali Acc: 0.839 Test Loss: 0.610 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.170985221862793
Epoch: 28, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.619 Vali Acc: 0.828 Test Loss: 0.619 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1054506301879883
Epoch: 29, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.589 Vali Acc: 0.822 Test Loss: 0.589 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.1892411708831787
Epoch: 30, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.596 Vali Acc: 0.856 Test Loss: 0.596 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855550).  Saving model ...
Epoch: 31 cost time: 0.9262642860412598
Epoch: 31, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.584 Vali Acc: 0.867 Test Loss: 0.584 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 32 cost time: 0.950927734375
Epoch: 32, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.611 Vali Acc: 0.861 Test Loss: 0.611 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0706593990325928
Epoch: 33, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.615 Vali Acc: 0.861 Test Loss: 0.615 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1731548309326172
Epoch: 34, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.606 Vali Acc: 0.867 Test Loss: 0.606 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.1439311504364014
Epoch: 35, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.593 Vali Acc: 0.861 Test Loss: 0.593 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.1345620155334473
Epoch: 36, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.623 Vali Acc: 0.872 Test Loss: 0.623 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 37 cost time: 1.117173433303833
Epoch: 37, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.649 Vali Acc: 0.872 Test Loss: 0.649 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9879238605499268
Epoch: 38, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.652 Vali Acc: 0.872 Test Loss: 0.652 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.2999494075775146
Epoch: 39, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.632 Vali Acc: 0.872 Test Loss: 0.632 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.0396389961242676
Epoch: 40, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.651 Vali Acc: 0.872 Test Loss: 0.651 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.9765667915344238
Epoch: 41, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.722 Vali Acc: 0.850 Test Loss: 0.722 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.0851061344146729
Epoch: 42, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.659 Vali Acc: 0.867 Test Loss: 0.659 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.3100414276123047
Epoch: 43, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.666 Vali Acc: 0.872 Test Loss: 0.666 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.8779292106628418
Epoch: 44, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.668 Vali Acc: 0.867 Test Loss: 0.668 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.198333501815796
Epoch: 45, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.701 Vali Acc: 0.872 Test Loss: 0.701 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.0939459800720215
Epoch: 46, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.648 Vali Acc: 0.872 Test Loss: 0.648 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 918951
model size : 6.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7889420986175537
Epoch: 1, Steps: 12 | Train Loss: 2.847 Vali Loss: 2.788 Vali Acc: 0.094 Test Loss: 2.788 Test Acc: 0.094
Validation loss decreased (inf --> -0.094417).  Saving model ...
Epoch: 2 cost time: 0.9431226253509521
Epoch: 2, Steps: 12 | Train Loss: 2.722 Vali Loss: 2.682 Vali Acc: 0.128 Test Loss: 2.682 Test Acc: 0.128
Validation loss decreased (-0.094417 --> -0.127751).  Saving model ...
Epoch: 3 cost time: 0.931429386138916
Epoch: 3, Steps: 12 | Train Loss: 2.599 Vali Loss: 2.572 Vali Acc: 0.206 Test Loss: 2.572 Test Acc: 0.206
Validation loss decreased (-0.127751 --> -0.205530).  Saving model ...
Epoch: 4 cost time: 1.0316650867462158
Epoch: 4, Steps: 12 | Train Loss: 2.478 Vali Loss: 2.457 Vali Acc: 0.294 Test Loss: 2.457 Test Acc: 0.294
Validation loss decreased (-0.205530 --> -0.294420).  Saving model ...
Epoch: 5 cost time: 1.0912024974822998
Epoch: 5, Steps: 12 | Train Loss: 2.342 Vali Loss: 2.318 Vali Acc: 0.394 Test Loss: 2.318 Test Acc: 0.394
Validation loss decreased (-0.294420 --> -0.394421).  Saving model ...
Epoch: 6 cost time: 0.9477720260620117
Epoch: 6, Steps: 12 | Train Loss: 2.194 Vali Loss: 2.165 Vali Acc: 0.422 Test Loss: 2.165 Test Acc: 0.422
Validation loss decreased (-0.394421 --> -0.422201).  Saving model ...
Epoch: 7 cost time: 1.1666033267974854
Epoch: 7, Steps: 12 | Train Loss: 1.995 Vali Loss: 1.998 Vali Acc: 0.483 Test Loss: 1.998 Test Acc: 0.483
Validation loss decreased (-0.422201 --> -0.483313).  Saving model ...
Epoch: 8 cost time: 1.0580470561981201
Epoch: 8, Steps: 12 | Train Loss: 1.752 Vali Loss: 1.810 Vali Acc: 0.544 Test Loss: 1.810 Test Acc: 0.544
Validation loss decreased (-0.483313 --> -0.544426).  Saving model ...
Epoch: 9 cost time: 1.0760607719421387
Epoch: 9, Steps: 12 | Train Loss: 1.572 Vali Loss: 1.645 Vali Acc: 0.583 Test Loss: 1.645 Test Acc: 0.583
Validation loss decreased (-0.544426 --> -0.583317).  Saving model ...
Epoch: 10 cost time: 0.8767743110656738
Epoch: 10, Steps: 12 | Train Loss: 1.405 Vali Loss: 1.493 Vali Acc: 0.567 Test Loss: 1.493 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9540119171142578
Epoch: 11, Steps: 12 | Train Loss: 1.169 Vali Loss: 1.347 Vali Acc: 0.606 Test Loss: 1.347 Test Acc: 0.606
Validation loss decreased (-0.583317 --> -0.605542).  Saving model ...
Epoch: 12 cost time: 0.8106884956359863
Epoch: 12, Steps: 12 | Train Loss: 1.099 Vali Loss: 1.200 Vali Acc: 0.644 Test Loss: 1.200 Test Acc: 0.644
Validation loss decreased (-0.605542 --> -0.644432).  Saving model ...
Epoch: 13 cost time: 0.786116361618042
Epoch: 13, Steps: 12 | Train Loss: 0.893 Vali Loss: 1.091 Vali Acc: 0.672 Test Loss: 1.091 Test Acc: 0.672
Validation loss decreased (-0.644432 --> -0.672211).  Saving model ...
Epoch: 14 cost time: 0.8792943954467773
Epoch: 14, Steps: 12 | Train Loss: 0.807 Vali Loss: 1.013 Vali Acc: 0.706 Test Loss: 1.013 Test Acc: 0.706
Validation loss decreased (-0.672211 --> -0.705545).  Saving model ...
Epoch: 15 cost time: 0.842170238494873
Epoch: 15, Steps: 12 | Train Loss: 0.751 Vali Loss: 0.962 Vali Acc: 0.733 Test Loss: 0.962 Test Acc: 0.733
Validation loss decreased (-0.705545 --> -0.733324).  Saving model ...
Epoch: 16 cost time: 0.9928421974182129
Epoch: 16, Steps: 12 | Train Loss: 0.636 Vali Loss: 0.891 Vali Acc: 0.739 Test Loss: 0.891 Test Acc: 0.739
Validation loss decreased (-0.733324 --> -0.738880).  Saving model ...
Epoch: 17 cost time: 1.1068353652954102
Epoch: 17, Steps: 12 | Train Loss: 0.543 Vali Loss: 0.868 Vali Acc: 0.689 Test Loss: 0.868 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9996275901794434
Epoch: 18, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.800 Vali Acc: 0.761 Test Loss: 0.800 Test Acc: 0.761
Validation loss decreased (-0.738880 --> -0.761103).  Saving model ...
Epoch: 19 cost time: 0.9731459617614746
Epoch: 19, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.756 Vali Acc: 0.761 Test Loss: 0.756 Test Acc: 0.761
Validation loss decreased (-0.761103 --> -0.761104).  Saving model ...
Epoch: 20 cost time: 1.0289874076843262
Epoch: 20, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.726 Vali Acc: 0.789 Test Loss: 0.726 Test Acc: 0.789
Validation loss decreased (-0.761104 --> -0.788882).  Saving model ...
Epoch: 21 cost time: 1.0641388893127441
Epoch: 21, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.748 Vali Acc: 0.772 Test Loss: 0.748 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9415431022644043
Epoch: 22, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.700 Vali Acc: 0.806 Test Loss: 0.700 Test Acc: 0.806
Validation loss decreased (-0.788882 --> -0.805549).  Saving model ...
Epoch: 23 cost time: 0.971550703048706
Epoch: 23, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.674 Vali Acc: 0.811 Test Loss: 0.674 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811104).  Saving model ...
Epoch: 24 cost time: 1.0062108039855957
Epoch: 24, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.688 Vali Acc: 0.811 Test Loss: 0.688 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9648170471191406
Epoch: 25, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.612 Vali Acc: 0.833 Test Loss: 0.612 Test Acc: 0.833
Validation loss decreased (-0.811104 --> -0.833327).  Saving model ...
Epoch: 26 cost time: 1.2324085235595703
Epoch: 26, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.660 Vali Acc: 0.822 Test Loss: 0.660 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1184430122375488
Epoch: 27, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.641 Vali Acc: 0.833 Test Loss: 0.641 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.147524118423462
Epoch: 28, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.634 Vali Acc: 0.828 Test Loss: 0.634 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1922247409820557
Epoch: 29, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.637 Vali Acc: 0.850 Test Loss: 0.637 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849994).  Saving model ...
Epoch: 30 cost time: 1.107908010482788
Epoch: 30, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.665 Vali Acc: 0.850 Test Loss: 0.665 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.082601547241211
Epoch: 31, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.623 Vali Acc: 0.850 Test Loss: 0.623 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 32 cost time: 0.8639552593231201
Epoch: 32, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.687 Vali Acc: 0.844 Test Loss: 0.687 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8723292350769043
Epoch: 33, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.664 Vali Acc: 0.844 Test Loss: 0.664 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1642775535583496
Epoch: 34, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.725 Vali Acc: 0.833 Test Loss: 0.725 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.0517957210540771
Epoch: 35, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.664 Vali Acc: 0.839 Test Loss: 0.664 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.1778740882873535
Epoch: 36, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.584 Vali Acc: 0.850 Test Loss: 0.584 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 37 cost time: 0.8503913879394531
Epoch: 37, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.642 Vali Acc: 0.850 Test Loss: 0.642 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.2005410194396973
Epoch: 38, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.689 Vali Acc: 0.856 Test Loss: 0.689 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 39 cost time: 1.0296952724456787
Epoch: 39, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.697 Vali Acc: 0.856 Test Loss: 0.697 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.99810791015625
Epoch: 40, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.684 Vali Acc: 0.839 Test Loss: 0.684 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.179084062576294
Epoch: 41, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.708 Vali Acc: 0.833 Test Loss: 0.708 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.0630970001220703
Epoch: 42, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.712 Vali Acc: 0.844 Test Loss: 0.712 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.1548521518707275
Epoch: 43, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.680 Vali Acc: 0.856 Test Loss: 0.680 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855549).  Saving model ...
Epoch: 44 cost time: 0.9941222667694092
Epoch: 44, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.765 Vali Acc: 0.850 Test Loss: 0.765 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.142993688583374
Epoch: 45, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.775 Vali Acc: 0.850 Test Loss: 0.775 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.296351671218872
Epoch: 46, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.727 Vali Acc: 0.839 Test Loss: 0.727 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.459890365600586
Epoch: 47, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.719 Vali Acc: 0.839 Test Loss: 0.719 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.2865493297576904
Epoch: 48, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.793 Vali Acc: 0.828 Test Loss: 0.793 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.2789075374603271
Epoch: 49, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.773 Vali Acc: 0.844 Test Loss: 0.773 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.081986427307129
Epoch: 50, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.746 Vali Acc: 0.844 Test Loss: 0.746 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.0622997283935547
Epoch: 51, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.713 Vali Acc: 0.844 Test Loss: 0.713 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.152649164199829
Epoch: 52, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.730 Vali Acc: 0.850 Test Loss: 0.730 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.0403966903686523
Epoch: 53, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.770 Vali Acc: 0.850 Test Loss: 0.770 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 918439
model size : 6.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.565756320953369
Epoch: 1, Steps: 12 | Train Loss: 2.799 Vali Loss: 2.756 Vali Acc: 0.039 Test Loss: 2.756 Test Acc: 0.039
Validation loss decreased (inf --> -0.038861).  Saving model ...
Epoch: 2 cost time: 0.8474903106689453
Epoch: 2, Steps: 12 | Train Loss: 2.703 Vali Loss: 2.644 Vali Acc: 0.083 Test Loss: 2.644 Test Acc: 0.083
Validation loss decreased (-0.038861 --> -0.083307).  Saving model ...
Epoch: 3 cost time: 0.9490025043487549
Epoch: 3, Steps: 12 | Train Loss: 2.606 Vali Loss: 2.535 Vali Acc: 0.250 Test Loss: 2.535 Test Acc: 0.250
Validation loss decreased (-0.083307 --> -0.249975).  Saving model ...
Epoch: 4 cost time: 0.8279409408569336
Epoch: 4, Steps: 12 | Train Loss: 2.474 Vali Loss: 2.419 Vali Acc: 0.361 Test Loss: 2.419 Test Acc: 0.361
Validation loss decreased (-0.249975 --> -0.361087).  Saving model ...
Epoch: 5 cost time: 0.9583389759063721
Epoch: 5, Steps: 12 | Train Loss: 2.294 Vali Loss: 2.290 Vali Acc: 0.456 Test Loss: 2.290 Test Acc: 0.456
Validation loss decreased (-0.361087 --> -0.455533).  Saving model ...
Epoch: 6 cost time: 1.010981798171997
Epoch: 6, Steps: 12 | Train Loss: 2.139 Vali Loss: 2.129 Vali Acc: 0.478 Test Loss: 2.129 Test Acc: 0.478
Validation loss decreased (-0.455533 --> -0.477756).  Saving model ...
Epoch: 7 cost time: 0.9192910194396973
Epoch: 7, Steps: 12 | Train Loss: 1.938 Vali Loss: 1.969 Vali Acc: 0.533 Test Loss: 1.969 Test Acc: 0.533
Validation loss decreased (-0.477756 --> -0.533314).  Saving model ...
Epoch: 8 cost time: 0.9649271965026855
Epoch: 8, Steps: 12 | Train Loss: 1.784 Vali Loss: 1.802 Vali Acc: 0.556 Test Loss: 1.802 Test Acc: 0.556
Validation loss decreased (-0.533314 --> -0.555538).  Saving model ...
Epoch: 9 cost time: 0.8982198238372803
Epoch: 9, Steps: 12 | Train Loss: 1.548 Vali Loss: 1.634 Vali Acc: 0.583 Test Loss: 1.634 Test Acc: 0.583
Validation loss decreased (-0.555538 --> -0.583317).  Saving model ...
Epoch: 10 cost time: 0.9161477088928223
Epoch: 10, Steps: 12 | Train Loss: 1.389 Vali Loss: 1.480 Vali Acc: 0.600 Test Loss: 1.480 Test Acc: 0.600
Validation loss decreased (-0.583317 --> -0.599985).  Saving model ...
Epoch: 11 cost time: 0.8948075771331787
Epoch: 11, Steps: 12 | Train Loss: 1.251 Vali Loss: 1.329 Vali Acc: 0.606 Test Loss: 1.329 Test Acc: 0.606
Validation loss decreased (-0.599985 --> -0.605542).  Saving model ...
Epoch: 12 cost time: 0.9092772006988525
Epoch: 12, Steps: 12 | Train Loss: 1.084 Vali Loss: 1.212 Vali Acc: 0.628 Test Loss: 1.212 Test Acc: 0.628
Validation loss decreased (-0.605542 --> -0.627766).  Saving model ...
Epoch: 13 cost time: 0.9744067192077637
Epoch: 13, Steps: 12 | Train Loss: 0.916 Vali Loss: 1.132 Vali Acc: 0.661 Test Loss: 1.132 Test Acc: 0.661
Validation loss decreased (-0.627766 --> -0.661100).  Saving model ...
Epoch: 14 cost time: 0.9362504482269287
Epoch: 14, Steps: 12 | Train Loss: 0.861 Vali Loss: 1.031 Vali Acc: 0.678 Test Loss: 1.031 Test Acc: 0.678
Validation loss decreased (-0.661100 --> -0.677767).  Saving model ...
Epoch: 15 cost time: 0.92942214012146
Epoch: 15, Steps: 12 | Train Loss: 0.746 Vali Loss: 0.980 Vali Acc: 0.694 Test Loss: 0.980 Test Acc: 0.694
Validation loss decreased (-0.677767 --> -0.694435).  Saving model ...
Epoch: 16 cost time: 0.8605437278747559
Epoch: 16, Steps: 12 | Train Loss: 0.640 Vali Loss: 0.891 Vali Acc: 0.733 Test Loss: 0.891 Test Acc: 0.733
Validation loss decreased (-0.694435 --> -0.733324).  Saving model ...
Epoch: 17 cost time: 0.8818657398223877
Epoch: 17, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.862 Vali Acc: 0.722 Test Loss: 0.862 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0026402473449707
Epoch: 18, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.794 Vali Acc: 0.739 Test Loss: 0.794 Test Acc: 0.739
Validation loss decreased (-0.733324 --> -0.738881).  Saving model ...
Epoch: 19 cost time: 0.9504814147949219
Epoch: 19, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.782 Vali Acc: 0.767 Test Loss: 0.782 Test Acc: 0.767
Validation loss decreased (-0.738881 --> -0.766659).  Saving model ...
Epoch: 20 cost time: 0.9515879154205322
Epoch: 20, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.731 Vali Acc: 0.778 Test Loss: 0.731 Test Acc: 0.778
Validation loss decreased (-0.766659 --> -0.777770).  Saving model ...
Epoch: 21 cost time: 0.9771585464477539
Epoch: 21, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.703 Vali Acc: 0.767 Test Loss: 0.703 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8781774044036865
Epoch: 22, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.666 Vali Acc: 0.800 Test Loss: 0.666 Test Acc: 0.800
Validation loss decreased (-0.777770 --> -0.799993).  Saving model ...
Epoch: 23 cost time: 0.9608564376831055
Epoch: 23, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.658 Vali Acc: 0.811 Test Loss: 0.658 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811105).  Saving model ...
Epoch: 24 cost time: 0.9525651931762695
Epoch: 24, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.647 Vali Acc: 0.800 Test Loss: 0.647 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.380695104598999
Epoch: 25, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.635 Vali Acc: 0.811 Test Loss: 0.635 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 26 cost time: 0.8925297260284424
Epoch: 26, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.661 Vali Acc: 0.811 Test Loss: 0.661 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9936079978942871
Epoch: 27, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.575 Vali Acc: 0.833 Test Loss: 0.575 Test Acc: 0.833
Validation loss decreased (-0.811105 --> -0.833328).  Saving model ...
Epoch: 28 cost time: 0.9794232845306396
Epoch: 28, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.655 Vali Acc: 0.806 Test Loss: 0.655 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0731675624847412
Epoch: 29, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.648 Vali Acc: 0.828 Test Loss: 0.648 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1028892993927002
Epoch: 30, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.623 Vali Acc: 0.856 Test Loss: 0.623 Test Acc: 0.856
Validation loss decreased (-0.833328 --> -0.855549).  Saving model ...
Epoch: 31 cost time: 1.194880723953247
Epoch: 31, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.641 Vali Acc: 0.833 Test Loss: 0.641 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0187218189239502
Epoch: 32, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.657 Vali Acc: 0.822 Test Loss: 0.657 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8561975955963135
Epoch: 33, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.655 Vali Acc: 0.839 Test Loss: 0.655 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.1910581588745117
Epoch: 34, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.659 Vali Acc: 0.850 Test Loss: 0.659 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.3125457763671875
Epoch: 35, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.665 Vali Acc: 0.850 Test Loss: 0.665 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.1028006076812744
Epoch: 36, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.648 Vali Acc: 0.839 Test Loss: 0.648 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.0131728649139404
Epoch: 37, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.661 Vali Acc: 0.850 Test Loss: 0.661 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.9668700695037842
Epoch: 38, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.675 Vali Acc: 0.856 Test Loss: 0.675 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.9247877597808838
Epoch: 39, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.698 Vali Acc: 0.833 Test Loss: 0.698 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.9035894870758057
Epoch: 40, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.692 Vali Acc: 0.861 Test Loss: 0.692 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861104).  Saving model ...
Epoch: 41 cost time: 0.8436188697814941
Epoch: 41, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.801 Vali Acc: 0.844 Test Loss: 0.801 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9320147037506104
Epoch: 42, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.740 Vali Acc: 0.828 Test Loss: 0.740 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.9387106895446777
Epoch: 43, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.757 Vali Acc: 0.839 Test Loss: 0.757 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.0496530532836914
Epoch: 44, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.855 Vali Acc: 0.822 Test Loss: 0.855 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.7980012893676758
Epoch: 45, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.804 Vali Acc: 0.833 Test Loss: 0.804 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.8545689582824707
Epoch: 46, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.765 Vali Acc: 0.844 Test Loss: 0.765 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.1749660968780518
Epoch: 47, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.748 Vali Acc: 0.856 Test Loss: 0.748 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.8050034046173096
Epoch: 48, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.761 Vali Acc: 0.850 Test Loss: 0.761 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.0883324146270752
Epoch: 49, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.717 Vali Acc: 0.867 Test Loss: 0.717 Test Acc: 0.867
Validation loss decreased (-0.861104 --> -0.866659).  Saving model ...
Epoch: 50 cost time: 1.0739202499389648
Epoch: 50, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.711 Vali Acc: 0.861 Test Loss: 0.711 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.8848733901977539
Epoch: 51, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.736 Vali Acc: 0.861 Test Loss: 0.736 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.0039865970611572
Epoch: 52, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.715 Vali Acc: 0.850 Test Loss: 0.715 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.8666548728942871
Epoch: 53, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.722 Vali Acc: 0.861 Test Loss: 0.722 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.899972677230835
Epoch: 54, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.755 Vali Acc: 0.856 Test Loss: 0.755 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.9678730964660645
Epoch: 55, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.765 Vali Acc: 0.861 Test Loss: 0.765 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.0017108917236328
Epoch: 56, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.755 Vali Acc: 0.850 Test Loss: 0.755 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.9896585941314697
Epoch: 57, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.748 Vali Acc: 0.856 Test Loss: 0.748 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.0820786952972412
Epoch: 58, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.749 Vali Acc: 0.856 Test Loss: 0.749 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.0719358921051025
Epoch: 59, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.771 Vali Acc: 0.856 Test Loss: 0.771 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 917927
model size : 6.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5478672981262207
Epoch: 1, Steps: 12 | Train Loss: 2.868 Vali Loss: 2.790 Vali Acc: 0.089 Test Loss: 2.790 Test Acc: 0.089
Validation loss decreased (inf --> -0.088861).  Saving model ...
Epoch: 2 cost time: 1.0212109088897705
Epoch: 2, Steps: 12 | Train Loss: 2.722 Vali Loss: 2.662 Vali Acc: 0.122 Test Loss: 2.662 Test Acc: 0.122
Validation loss decreased (-0.088861 --> -0.122196).  Saving model ...
Epoch: 3 cost time: 0.8525817394256592
Epoch: 3, Steps: 12 | Train Loss: 2.614 Vali Loss: 2.577 Vali Acc: 0.222 Test Loss: 2.577 Test Acc: 0.222
Validation loss decreased (-0.122196 --> -0.222196).  Saving model ...
Epoch: 4 cost time: 0.9880766868591309
Epoch: 4, Steps: 12 | Train Loss: 2.513 Vali Loss: 2.486 Vali Acc: 0.256 Test Loss: 2.486 Test Acc: 0.256
Validation loss decreased (-0.222196 --> -0.255531).  Saving model ...
Epoch: 5 cost time: 1.038792610168457
Epoch: 5, Steps: 12 | Train Loss: 2.371 Vali Loss: 2.362 Vali Acc: 0.350 Test Loss: 2.362 Test Acc: 0.350
Validation loss decreased (-0.255531 --> -0.349976).  Saving model ...
Epoch: 6 cost time: 0.8240880966186523
Epoch: 6, Steps: 12 | Train Loss: 2.226 Vali Loss: 2.224 Vali Acc: 0.411 Test Loss: 2.224 Test Acc: 0.411
Validation loss decreased (-0.349976 --> -0.411089).  Saving model ...
Epoch: 7 cost time: 0.8829832077026367
Epoch: 7, Steps: 12 | Train Loss: 2.093 Vali Loss: 2.092 Vali Acc: 0.478 Test Loss: 2.092 Test Acc: 0.478
Validation loss decreased (-0.411089 --> -0.477757).  Saving model ...
Epoch: 8 cost time: 0.9959321022033691
Epoch: 8, Steps: 12 | Train Loss: 1.881 Vali Loss: 1.933 Vali Acc: 0.522 Test Loss: 1.933 Test Acc: 0.522
Validation loss decreased (-0.477757 --> -0.522203).  Saving model ...
Epoch: 9 cost time: 0.8462910652160645
Epoch: 9, Steps: 12 | Train Loss: 1.678 Vali Loss: 1.786 Vali Acc: 0.533 Test Loss: 1.786 Test Acc: 0.533
Validation loss decreased (-0.522203 --> -0.533315).  Saving model ...
Epoch: 10 cost time: 0.9314303398132324
Epoch: 10, Steps: 12 | Train Loss: 1.538 Vali Loss: 1.675 Vali Acc: 0.539 Test Loss: 1.675 Test Acc: 0.539
Validation loss decreased (-0.533315 --> -0.538872).  Saving model ...
Epoch: 11 cost time: 0.8529806137084961
Epoch: 11, Steps: 12 | Train Loss: 1.378 Vali Loss: 1.573 Vali Acc: 0.528 Test Loss: 1.573 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.045917272567749
Epoch: 12, Steps: 12 | Train Loss: 1.252 Vali Loss: 1.447 Vali Acc: 0.594 Test Loss: 1.447 Test Acc: 0.594
Validation loss decreased (-0.538872 --> -0.594430).  Saving model ...
Epoch: 13 cost time: 0.7861075401306152
Epoch: 13, Steps: 12 | Train Loss: 1.185 Vali Loss: 1.354 Vali Acc: 0.583 Test Loss: 1.354 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9249913692474365
Epoch: 14, Steps: 12 | Train Loss: 1.010 Vali Loss: 1.248 Vali Acc: 0.622 Test Loss: 1.248 Test Acc: 0.622
Validation loss decreased (-0.594430 --> -0.622210).  Saving model ...
Epoch: 15 cost time: 0.9553267955780029
Epoch: 15, Steps: 12 | Train Loss: 0.900 Vali Loss: 1.154 Vali Acc: 0.639 Test Loss: 1.154 Test Acc: 0.639
Validation loss decreased (-0.622210 --> -0.638877).  Saving model ...
Epoch: 16 cost time: 0.8810789585113525
Epoch: 16, Steps: 12 | Train Loss: 0.839 Vali Loss: 1.085 Vali Acc: 0.694 Test Loss: 1.085 Test Acc: 0.694
Validation loss decreased (-0.638877 --> -0.694434).  Saving model ...
Epoch: 17 cost time: 1.0937690734863281
Epoch: 17, Steps: 12 | Train Loss: 0.764 Vali Loss: 1.017 Vali Acc: 0.672 Test Loss: 1.017 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8799376487731934
Epoch: 18, Steps: 12 | Train Loss: 0.722 Vali Loss: 0.971 Vali Acc: 0.717 Test Loss: 0.971 Test Acc: 0.717
Validation loss decreased (-0.694434 --> -0.716657).  Saving model ...
Epoch: 19 cost time: 1.2247035503387451
Epoch: 19, Steps: 12 | Train Loss: 0.660 Vali Loss: 0.910 Vali Acc: 0.739 Test Loss: 0.910 Test Acc: 0.739
Validation loss decreased (-0.716657 --> -0.738880).  Saving model ...
Epoch: 20 cost time: 0.9222724437713623
Epoch: 20, Steps: 12 | Train Loss: 0.592 Vali Loss: 0.880 Vali Acc: 0.728 Test Loss: 0.880 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9961507320404053
Epoch: 21, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.841 Vali Acc: 0.733 Test Loss: 0.841 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0834617614746094
Epoch: 22, Steps: 12 | Train Loss: 0.475 Vali Loss: 0.836 Vali Acc: 0.739 Test Loss: 0.836 Test Acc: 0.739
Validation loss decreased (-0.738880 --> -0.738881).  Saving model ...
Epoch: 23 cost time: 0.906024694442749
Epoch: 23, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.767 Vali Acc: 0.750 Test Loss: 0.767 Test Acc: 0.750
Validation loss decreased (-0.738881 --> -0.749992).  Saving model ...
Epoch: 24 cost time: 0.8600964546203613
Epoch: 24, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.731 Vali Acc: 0.772 Test Loss: 0.731 Test Acc: 0.772
Validation loss decreased (-0.749992 --> -0.772215).  Saving model ...
Epoch: 25 cost time: 0.8926091194152832
Epoch: 25, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.723 Vali Acc: 0.783 Test Loss: 0.723 Test Acc: 0.783
Validation loss decreased (-0.772215 --> -0.783326).  Saving model ...
Epoch: 26 cost time: 0.8349754810333252
Epoch: 26, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.680 Vali Acc: 0.794 Test Loss: 0.680 Test Acc: 0.794
Validation loss decreased (-0.783326 --> -0.794438).  Saving model ...
Epoch: 27 cost time: 0.9322900772094727
Epoch: 27, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.651 Vali Acc: 0.806 Test Loss: 0.651 Test Acc: 0.806
Validation loss decreased (-0.794438 --> -0.805549).  Saving model ...
Epoch: 28 cost time: 1.067265272140503
Epoch: 28, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.621 Vali Acc: 0.822 Test Loss: 0.621 Test Acc: 0.822
Validation loss decreased (-0.805549 --> -0.822216).  Saving model ...
Epoch: 29 cost time: 0.8688430786132812
Epoch: 29, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.600 Vali Acc: 0.806 Test Loss: 0.600 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.039086103439331
Epoch: 30, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.585 Vali Acc: 0.828 Test Loss: 0.585 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827772).  Saving model ...
Epoch: 31 cost time: 0.8490791320800781
Epoch: 31, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.594 Vali Acc: 0.850 Test Loss: 0.594 Test Acc: 0.850
Validation loss decreased (-0.827772 --> -0.849994).  Saving model ...
Epoch: 32 cost time: 0.9411790370941162
Epoch: 32, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.562 Vali Acc: 0.833 Test Loss: 0.562 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2074687480926514
Epoch: 33, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.560 Vali Acc: 0.811 Test Loss: 0.560 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8808584213256836
Epoch: 34, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.542 Vali Acc: 0.839 Test Loss: 0.542 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.935758113861084
Epoch: 35, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.532 Vali Acc: 0.850 Test Loss: 0.532 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 36 cost time: 1.2258939743041992
Epoch: 36, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.498 Vali Acc: 0.844 Test Loss: 0.498 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9357731342315674
Epoch: 37, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.514 Vali Acc: 0.872 Test Loss: 0.514 Test Acc: 0.872
Validation loss decreased (-0.849995 --> -0.872217).  Saving model ...
Epoch: 38 cost time: 1.0179827213287354
Epoch: 38, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.510 Vali Acc: 0.867 Test Loss: 0.510 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.910703182220459
Epoch: 39, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.519 Vali Acc: 0.872 Test Loss: 0.519 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.0013906955718994
Epoch: 40, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.505 Vali Acc: 0.872 Test Loss: 0.505 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 41 cost time: 0.894810676574707
Epoch: 41, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.513 Vali Acc: 0.867 Test Loss: 0.513 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9298610687255859
Epoch: 42, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.520 Vali Acc: 0.878 Test Loss: 0.520 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 43 cost time: 0.7989921569824219
Epoch: 43, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.519 Vali Acc: 0.867 Test Loss: 0.519 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8291008472442627
Epoch: 44, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.482 Vali Acc: 0.872 Test Loss: 0.482 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.0585846900939941
Epoch: 45, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.520 Vali Acc: 0.872 Test Loss: 0.520 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.982274055480957
Epoch: 46, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.517 Vali Acc: 0.867 Test Loss: 0.517 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.8772313594818115
Epoch: 47, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.477 Vali Acc: 0.883 Test Loss: 0.477 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883329).  Saving model ...
Epoch: 48 cost time: 0.8949918746948242
Epoch: 48, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.507 Vali Acc: 0.889 Test Loss: 0.507 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888884).  Saving model ...
Epoch: 49 cost time: 0.9289655685424805
Epoch: 49, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.524 Vali Acc: 0.878 Test Loss: 0.524 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.0266425609588623
Epoch: 50, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.558 Vali Acc: 0.872 Test Loss: 0.558 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.9592578411102295
Epoch: 51, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.530 Vali Acc: 0.878 Test Loss: 0.530 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.9318068027496338
Epoch: 52, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.503 Vali Acc: 0.878 Test Loss: 0.503 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.042020559310913
Epoch: 53, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.537 Vali Acc: 0.867 Test Loss: 0.537 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.9522950649261475
Epoch: 54, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.519 Vali Acc: 0.889 Test Loss: 0.519 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.0279581546783447
Epoch: 55, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.504 Vali Acc: 0.883 Test Loss: 0.504 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.9944963455200195
Epoch: 56, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.521 Vali Acc: 0.883 Test Loss: 0.521 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.8218672275543213
Epoch: 57, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.533 Vali Acc: 0.883 Test Loss: 0.533 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.8876540660858154
Epoch: 58, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.518 Vali Acc: 0.878 Test Loss: 0.518 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 610087
model size : 3.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.635175943374634
Epoch: 1, Steps: 12 | Train Loss: 2.870 Vali Loss: 2.804 Vali Acc: 0.061 Test Loss: 2.804 Test Acc: 0.061
Validation loss decreased (inf --> -0.061083).  Saving model ...
Epoch: 2 cost time: 0.931499719619751
Epoch: 2, Steps: 12 | Train Loss: 2.721 Vali Loss: 2.668 Vali Acc: 0.144 Test Loss: 2.668 Test Acc: 0.144
Validation loss decreased (-0.061083 --> -0.144418).  Saving model ...
Epoch: 3 cost time: 0.8414664268493652
Epoch: 3, Steps: 12 | Train Loss: 2.610 Vali Loss: 2.558 Vali Acc: 0.228 Test Loss: 2.558 Test Acc: 0.228
Validation loss decreased (-0.144418 --> -0.227752).  Saving model ...
Epoch: 4 cost time: 0.9284830093383789
Epoch: 4, Steps: 12 | Train Loss: 2.470 Vali Loss: 2.450 Vali Acc: 0.306 Test Loss: 2.450 Test Acc: 0.306
Validation loss decreased (-0.227752 --> -0.305531).  Saving model ...
Epoch: 5 cost time: 0.8948507308959961
Epoch: 5, Steps: 12 | Train Loss: 2.369 Vali Loss: 2.328 Vali Acc: 0.389 Test Loss: 2.328 Test Acc: 0.389
Validation loss decreased (-0.305531 --> -0.388866).  Saving model ...
Epoch: 6 cost time: 0.8252325057983398
Epoch: 6, Steps: 12 | Train Loss: 2.202 Vali Loss: 2.185 Vali Acc: 0.406 Test Loss: 2.185 Test Acc: 0.406
Validation loss decreased (-0.388866 --> -0.405534).  Saving model ...
Epoch: 7 cost time: 0.9827151298522949
Epoch: 7, Steps: 12 | Train Loss: 2.028 Vali Loss: 2.040 Vali Acc: 0.494 Test Loss: 2.040 Test Acc: 0.494
Validation loss decreased (-0.405534 --> -0.494424).  Saving model ...
Epoch: 8 cost time: 1.0514967441558838
Epoch: 8, Steps: 12 | Train Loss: 1.865 Vali Loss: 1.889 Vali Acc: 0.550 Test Loss: 1.889 Test Acc: 0.550
Validation loss decreased (-0.494424 --> -0.549981).  Saving model ...
Epoch: 9 cost time: 0.9333391189575195
Epoch: 9, Steps: 12 | Train Loss: 1.680 Vali Loss: 1.749 Vali Acc: 0.528 Test Loss: 1.749 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9598526954650879
Epoch: 10, Steps: 12 | Train Loss: 1.527 Vali Loss: 1.623 Vali Acc: 0.544 Test Loss: 1.623 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0017869472503662
Epoch: 11, Steps: 12 | Train Loss: 1.400 Vali Loss: 1.496 Vali Acc: 0.594 Test Loss: 1.496 Test Acc: 0.594
Validation loss decreased (-0.549981 --> -0.594429).  Saving model ...
Epoch: 12 cost time: 0.9543261528015137
Epoch: 12, Steps: 12 | Train Loss: 1.192 Vali Loss: 1.389 Vali Acc: 0.589 Test Loss: 1.389 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8262097835540771
Epoch: 13, Steps: 12 | Train Loss: 1.134 Vali Loss: 1.310 Vali Acc: 0.633 Test Loss: 1.310 Test Acc: 0.633
Validation loss decreased (-0.594429 --> -0.633320).  Saving model ...
Epoch: 14 cost time: 1.1048061847686768
Epoch: 14, Steps: 12 | Train Loss: 0.995 Vali Loss: 1.211 Vali Acc: 0.639 Test Loss: 1.211 Test Acc: 0.639
Validation loss decreased (-0.633320 --> -0.638877).  Saving model ...
Epoch: 15 cost time: 1.1520111560821533
Epoch: 15, Steps: 12 | Train Loss: 0.918 Vali Loss: 1.126 Vali Acc: 0.683 Test Loss: 1.126 Test Acc: 0.683
Validation loss decreased (-0.638877 --> -0.683322).  Saving model ...
Epoch: 16 cost time: 0.8975014686584473
Epoch: 16, Steps: 12 | Train Loss: 0.797 Vali Loss: 1.061 Vali Acc: 0.667 Test Loss: 1.061 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9982635974884033
Epoch: 17, Steps: 12 | Train Loss: 0.726 Vali Loss: 0.993 Vali Acc: 0.689 Test Loss: 0.993 Test Acc: 0.689
Validation loss decreased (-0.683322 --> -0.688879).  Saving model ...
Epoch: 18 cost time: 1.1926286220550537
Epoch: 18, Steps: 12 | Train Loss: 0.666 Vali Loss: 0.939 Vali Acc: 0.722 Test Loss: 0.939 Test Acc: 0.722
Validation loss decreased (-0.688879 --> -0.722213).  Saving model ...
Epoch: 19 cost time: 1.1385157108306885
Epoch: 19, Steps: 12 | Train Loss: 0.644 Vali Loss: 0.882 Vali Acc: 0.733 Test Loss: 0.882 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733325).  Saving model ...
Epoch: 20 cost time: 0.9225993156433105
Epoch: 20, Steps: 12 | Train Loss: 0.556 Vali Loss: 0.836 Vali Acc: 0.750 Test Loss: 0.836 Test Acc: 0.750
Validation loss decreased (-0.733325 --> -0.749992).  Saving model ...
Epoch: 21 cost time: 0.8379902839660645
Epoch: 21, Steps: 12 | Train Loss: 0.547 Vali Loss: 0.814 Vali Acc: 0.750 Test Loss: 0.814 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 22 cost time: 0.8806867599487305
Epoch: 22, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.774 Vali Acc: 0.761 Test Loss: 0.774 Test Acc: 0.761
Validation loss decreased (-0.749992 --> -0.761103).  Saving model ...
Epoch: 23 cost time: 0.9514670372009277
Epoch: 23, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.768 Vali Acc: 0.750 Test Loss: 0.768 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1132586002349854
Epoch: 24, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.713 Vali Acc: 0.811 Test Loss: 0.713 Test Acc: 0.811
Validation loss decreased (-0.761103 --> -0.811104).  Saving model ...
Epoch: 25 cost time: 0.9362931251525879
Epoch: 25, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.703 Vali Acc: 0.794 Test Loss: 0.703 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1833412647247314
Epoch: 26, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.664 Vali Acc: 0.794 Test Loss: 0.664 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0063095092773438
Epoch: 27, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.678 Vali Acc: 0.806 Test Loss: 0.678 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9225747585296631
Epoch: 28, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.658 Vali Acc: 0.806 Test Loss: 0.658 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9974100589752197
Epoch: 29, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.633 Vali Acc: 0.833 Test Loss: 0.633 Test Acc: 0.833
Validation loss decreased (-0.811104 --> -0.833327).  Saving model ...
Epoch: 30 cost time: 0.887082576751709
Epoch: 30, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.633 Vali Acc: 0.833 Test Loss: 0.633 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0625922679901123
Epoch: 31, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.593 Vali Acc: 0.839 Test Loss: 0.593 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 32 cost time: 0.9695453643798828
Epoch: 32, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.579 Vali Acc: 0.839 Test Loss: 0.579 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 33 cost time: 1.0512032508850098
Epoch: 33, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.564 Vali Acc: 0.844 Test Loss: 0.564 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 34 cost time: 1.000373125076294
Epoch: 34, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.577 Vali Acc: 0.839 Test Loss: 0.577 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0059585571289062
Epoch: 35, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.587 Vali Acc: 0.839 Test Loss: 0.587 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9539382457733154
Epoch: 36, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.588 Vali Acc: 0.872 Test Loss: 0.588 Test Acc: 0.872
Validation loss decreased (-0.844439 --> -0.872216).  Saving model ...
Epoch: 37 cost time: 0.9681501388549805
Epoch: 37, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.531 Vali Acc: 0.856 Test Loss: 0.531 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0223517417907715
Epoch: 38, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.561 Vali Acc: 0.856 Test Loss: 0.561 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.9051618576049805
Epoch: 39, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.578 Vali Acc: 0.850 Test Loss: 0.578 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.8989396095275879
Epoch: 40, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.579 Vali Acc: 0.872 Test Loss: 0.579 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872216).  Saving model ...
Epoch: 41 cost time: 1.0725815296173096
Epoch: 41, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.582 Vali Acc: 0.856 Test Loss: 0.582 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1563589572906494
Epoch: 42, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.556 Vali Acc: 0.867 Test Loss: 0.556 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.9846599102020264
Epoch: 43, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.561 Vali Acc: 0.878 Test Loss: 0.561 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877772).  Saving model ...
Epoch: 44 cost time: 0.8947756290435791
Epoch: 44, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.545 Vali Acc: 0.872 Test Loss: 0.545 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.0082454681396484
Epoch: 45, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.553 Vali Acc: 0.872 Test Loss: 0.553 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.0676467418670654
Epoch: 46, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.544 Vali Acc: 0.883 Test Loss: 0.544 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883328).  Saving model ...
Epoch: 47 cost time: 0.9224700927734375
Epoch: 47, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.524 Vali Acc: 0.872 Test Loss: 0.524 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.045748233795166
Epoch: 48, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.531 Vali Acc: 0.878 Test Loss: 0.531 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.0565125942230225
Epoch: 49, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.541 Vali Acc: 0.883 Test Loss: 0.541 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883328).  Saving model ...
Epoch: 50 cost time: 0.8190274238586426
Epoch: 50, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.566 Vali Acc: 0.883 Test Loss: 0.566 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.0215859413146973
Epoch: 51, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.551 Vali Acc: 0.878 Test Loss: 0.551 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.9536607265472412
Epoch: 52, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.551 Vali Acc: 0.872 Test Loss: 0.551 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.9737539291381836
Epoch: 53, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.596 Vali Acc: 0.872 Test Loss: 0.596 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.0421490669250488
Epoch: 54, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.638 Vali Acc: 0.872 Test Loss: 0.638 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.1378271579742432
Epoch: 55, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.586 Vali Acc: 0.850 Test Loss: 0.586 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.0281455516815186
Epoch: 56, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.588 Vali Acc: 0.872 Test Loss: 0.588 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.9439425468444824
Epoch: 57, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.572 Vali Acc: 0.883 Test Loss: 0.572 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.0354764461517334
Epoch: 58, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.599 Vali Acc: 0.867 Test Loss: 0.599 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.2094340324401855
Epoch: 59, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.582 Vali Acc: 0.867 Test Loss: 0.582 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 609831
model size : 3.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8346364498138428
Epoch: 1, Steps: 12 | Train Loss: 2.889 Vali Loss: 2.774 Vali Acc: 0.061 Test Loss: 2.774 Test Acc: 0.061
Validation loss decreased (inf --> -0.061083).  Saving model ...
Epoch: 2 cost time: 0.8854541778564453
Epoch: 2, Steps: 12 | Train Loss: 2.761 Vali Loss: 2.643 Vali Acc: 0.061 Test Loss: 2.643 Test Acc: 0.061
Validation loss decreased (-0.061083 --> -0.061085).  Saving model ...
Epoch: 3 cost time: 1.0896191596984863
Epoch: 3, Steps: 12 | Train Loss: 2.614 Vali Loss: 2.525 Vali Acc: 0.211 Test Loss: 2.525 Test Acc: 0.211
Validation loss decreased (-0.061085 --> -0.211086).  Saving model ...
Epoch: 4 cost time: 0.8951311111450195
Epoch: 4, Steps: 12 | Train Loss: 2.485 Vali Loss: 2.419 Vali Acc: 0.294 Test Loss: 2.419 Test Acc: 0.294
Validation loss decreased (-0.211086 --> -0.294420).  Saving model ...
Epoch: 5 cost time: 0.9852795600891113
Epoch: 5, Steps: 12 | Train Loss: 2.332 Vali Loss: 2.280 Vali Acc: 0.422 Test Loss: 2.280 Test Acc: 0.422
Validation loss decreased (-0.294420 --> -0.422199).  Saving model ...
Epoch: 6 cost time: 1.085090160369873
Epoch: 6, Steps: 12 | Train Loss: 2.179 Vali Loss: 2.130 Vali Acc: 0.489 Test Loss: 2.130 Test Acc: 0.489
Validation loss decreased (-0.422199 --> -0.488868).  Saving model ...
Epoch: 7 cost time: 1.0000488758087158
Epoch: 7, Steps: 12 | Train Loss: 2.056 Vali Loss: 1.978 Vali Acc: 0.556 Test Loss: 1.978 Test Acc: 0.556
Validation loss decreased (-0.488868 --> -0.555536).  Saving model ...
Epoch: 8 cost time: 1.1384644508361816
Epoch: 8, Steps: 12 | Train Loss: 1.820 Vali Loss: 1.828 Vali Acc: 0.556 Test Loss: 1.828 Test Acc: 0.556
Validation loss decreased (-0.555536 --> -0.555537).  Saving model ...
Epoch: 9 cost time: 0.9768295288085938
Epoch: 9, Steps: 12 | Train Loss: 1.642 Vali Loss: 1.698 Vali Acc: 0.589 Test Loss: 1.698 Test Acc: 0.589
Validation loss decreased (-0.555537 --> -0.588872).  Saving model ...
Epoch: 10 cost time: 1.0223109722137451
Epoch: 10, Steps: 12 | Train Loss: 1.499 Vali Loss: 1.582 Vali Acc: 0.572 Test Loss: 1.582 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0721943378448486
Epoch: 11, Steps: 12 | Train Loss: 1.350 Vali Loss: 1.490 Vali Acc: 0.617 Test Loss: 1.490 Test Acc: 0.617
Validation loss decreased (-0.588872 --> -0.616652).  Saving model ...
Epoch: 12 cost time: 1.1452662944793701
Epoch: 12, Steps: 12 | Train Loss: 1.237 Vali Loss: 1.364 Vali Acc: 0.650 Test Loss: 1.364 Test Acc: 0.650
Validation loss decreased (-0.616652 --> -0.649986).  Saving model ...
Epoch: 13 cost time: 1.025585651397705
Epoch: 13, Steps: 12 | Train Loss: 1.104 Vali Loss: 1.264 Vali Acc: 0.639 Test Loss: 1.264 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0083327293395996
Epoch: 14, Steps: 12 | Train Loss: 0.957 Vali Loss: 1.180 Vali Acc: 0.678 Test Loss: 1.180 Test Acc: 0.678
Validation loss decreased (-0.649986 --> -0.677766).  Saving model ...
Epoch: 15 cost time: 0.8080999851226807
Epoch: 15, Steps: 12 | Train Loss: 0.906 Vali Loss: 1.096 Vali Acc: 0.656 Test Loss: 1.096 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.006117582321167
Epoch: 16, Steps: 12 | Train Loss: 0.851 Vali Loss: 1.015 Vali Acc: 0.683 Test Loss: 1.015 Test Acc: 0.683
Validation loss decreased (-0.677766 --> -0.683323).  Saving model ...
Epoch: 17 cost time: 1.0820491313934326
Epoch: 17, Steps: 12 | Train Loss: 0.727 Vali Loss: 0.965 Vali Acc: 0.706 Test Loss: 0.965 Test Acc: 0.706
Validation loss decreased (-0.683323 --> -0.705546).  Saving model ...
Epoch: 18 cost time: 0.9413611888885498
Epoch: 18, Steps: 12 | Train Loss: 0.746 Vali Loss: 0.909 Vali Acc: 0.733 Test Loss: 0.909 Test Acc: 0.733
Validation loss decreased (-0.705546 --> -0.733324).  Saving model ...
Epoch: 19 cost time: 1.167691946029663
Epoch: 19, Steps: 12 | Train Loss: 0.613 Vali Loss: 0.858 Vali Acc: 0.783 Test Loss: 0.858 Test Acc: 0.783
Validation loss decreased (-0.733324 --> -0.783325).  Saving model ...
Epoch: 20 cost time: 1.233410120010376
Epoch: 20, Steps: 12 | Train Loss: 0.594 Vali Loss: 0.821 Vali Acc: 0.767 Test Loss: 0.821 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9992859363555908
Epoch: 21, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.750 Vali Acc: 0.789 Test Loss: 0.750 Test Acc: 0.789
Validation loss decreased (-0.783325 --> -0.788881).  Saving model ...
Epoch: 22 cost time: 0.8957626819610596
Epoch: 22, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.744 Vali Acc: 0.783 Test Loss: 0.744 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9886834621429443
Epoch: 23, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.706 Vali Acc: 0.794 Test Loss: 0.706 Test Acc: 0.794
Validation loss decreased (-0.788881 --> -0.794437).  Saving model ...
Epoch: 24 cost time: 1.109940528869629
Epoch: 24, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.647 Vali Acc: 0.789 Test Loss: 0.647 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9460878372192383
Epoch: 25, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.628 Vali Acc: 0.817 Test Loss: 0.628 Test Acc: 0.817
Validation loss decreased (-0.794437 --> -0.816660).  Saving model ...
Epoch: 26 cost time: 0.9041793346405029
Epoch: 26, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.611 Vali Acc: 0.817 Test Loss: 0.611 Test Acc: 0.817
Validation loss decreased (-0.816660 --> -0.816661).  Saving model ...
Epoch: 27 cost time: 0.9271817207336426
Epoch: 27, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.605 Vali Acc: 0.861 Test Loss: 0.605 Test Acc: 0.861
Validation loss decreased (-0.816661 --> -0.861105).  Saving model ...
Epoch: 28 cost time: 0.9548087120056152
Epoch: 28, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.551 Vali Acc: 0.844 Test Loss: 0.551 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9848282337188721
Epoch: 29, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.544 Vali Acc: 0.850 Test Loss: 0.544 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.004791021347046
Epoch: 30, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.533 Vali Acc: 0.861 Test Loss: 0.533 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861106).  Saving model ...
Epoch: 31 cost time: 0.8771049976348877
Epoch: 31, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.516 Vali Acc: 0.856 Test Loss: 0.516 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9601902961730957
Epoch: 32, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.577 Vali Acc: 0.867 Test Loss: 0.577 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 33 cost time: 0.8603055477142334
Epoch: 33, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.531 Vali Acc: 0.861 Test Loss: 0.531 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9998805522918701
Epoch: 34, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.514 Vali Acc: 0.867 Test Loss: 0.514 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866662).  Saving model ...
Epoch: 35 cost time: 0.9931430816650391
Epoch: 35, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.521 Vali Acc: 0.867 Test Loss: 0.521 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8731780052185059
Epoch: 36, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.506 Vali Acc: 0.850 Test Loss: 0.506 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9405045509338379
Epoch: 37, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.516 Vali Acc: 0.872 Test Loss: 0.516 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872217).  Saving model ...
Epoch: 38 cost time: 0.9638597965240479
Epoch: 38, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.505 Vali Acc: 0.861 Test Loss: 0.505 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.1051585674285889
Epoch: 39, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.531 Vali Acc: 0.872 Test Loss: 0.531 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9592835903167725
Epoch: 40, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.510 Vali Acc: 0.867 Test Loss: 0.510 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.9703385829925537
Epoch: 41, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.534 Vali Acc: 0.872 Test Loss: 0.534 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.9573533535003662
Epoch: 42, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.536 Vali Acc: 0.872 Test Loss: 0.536 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.006831169128418
Epoch: 43, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.516 Vali Acc: 0.883 Test Loss: 0.516 Test Acc: 0.883
Validation loss decreased (-0.872217 --> -0.883328).  Saving model ...
Epoch: 44 cost time: 1.0799658298492432
Epoch: 44, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.494 Vali Acc: 0.878 Test Loss: 0.494 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8931119441986084
Epoch: 45, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.518 Vali Acc: 0.861 Test Loss: 0.518 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.101752519607544
Epoch: 46, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.531 Vali Acc: 0.861 Test Loss: 0.531 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.0140886306762695
Epoch: 47, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.517 Vali Acc: 0.872 Test Loss: 0.517 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.8981289863586426
Epoch: 48, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.545 Vali Acc: 0.872 Test Loss: 0.545 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.0081615447998047
Epoch: 49, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.526 Vali Acc: 0.844 Test Loss: 0.526 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.0831000804901123
Epoch: 50, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.560 Vali Acc: 0.856 Test Loss: 0.560 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.082129716873169
Epoch: 51, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.534 Vali Acc: 0.878 Test Loss: 0.534 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.1410787105560303
Epoch: 52, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.562 Vali Acc: 0.872 Test Loss: 0.562 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.9766600131988525
Epoch: 53, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.523 Vali Acc: 0.878 Test Loss: 0.523 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 609575
model size : 3.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8768224716186523
Epoch: 1, Steps: 12 | Train Loss: 2.867 Vali Loss: 2.798 Vali Acc: 0.122 Test Loss: 2.798 Test Acc: 0.122
Validation loss decreased (inf --> -0.122194).  Saving model ...
Epoch: 2 cost time: 0.8718166351318359
Epoch: 2, Steps: 12 | Train Loss: 2.789 Vali Loss: 2.676 Vali Acc: 0.200 Test Loss: 2.676 Test Acc: 0.200
Validation loss decreased (-0.122194 --> -0.199973).  Saving model ...
Epoch: 3 cost time: 0.895521879196167
Epoch: 3, Steps: 12 | Train Loss: 2.646 Vali Loss: 2.568 Vali Acc: 0.289 Test Loss: 2.568 Test Acc: 0.289
Validation loss decreased (-0.199973 --> -0.288863).  Saving model ...
Epoch: 4 cost time: 0.9532470703125
Epoch: 4, Steps: 12 | Train Loss: 2.534 Vali Loss: 2.451 Vali Acc: 0.289 Test Loss: 2.451 Test Acc: 0.289
Validation loss decreased (-0.288863 --> -0.288864).  Saving model ...
Epoch: 5 cost time: 0.7892069816589355
Epoch: 5, Steps: 12 | Train Loss: 2.404 Vali Loss: 2.342 Vali Acc: 0.328 Test Loss: 2.342 Test Acc: 0.328
Validation loss decreased (-0.288864 --> -0.327754).  Saving model ...
Epoch: 6 cost time: 1.1493167877197266
Epoch: 6, Steps: 12 | Train Loss: 2.262 Vali Loss: 2.221 Vali Acc: 0.406 Test Loss: 2.221 Test Acc: 0.406
Validation loss decreased (-0.327754 --> -0.405533).  Saving model ...
Epoch: 7 cost time: 1.0017504692077637
Epoch: 7, Steps: 12 | Train Loss: 2.084 Vali Loss: 2.070 Vali Acc: 0.444 Test Loss: 2.070 Test Acc: 0.444
Validation loss decreased (-0.405533 --> -0.444424).  Saving model ...
Epoch: 8 cost time: 1.1238138675689697
Epoch: 8, Steps: 12 | Train Loss: 1.891 Vali Loss: 1.907 Vali Acc: 0.483 Test Loss: 1.907 Test Acc: 0.483
Validation loss decreased (-0.444424 --> -0.483314).  Saving model ...
Epoch: 9 cost time: 0.9519011974334717
Epoch: 9, Steps: 12 | Train Loss: 1.700 Vali Loss: 1.767 Vali Acc: 0.528 Test Loss: 1.767 Test Acc: 0.528
Validation loss decreased (-0.483314 --> -0.527760).  Saving model ...
Epoch: 10 cost time: 0.9010541439056396
Epoch: 10, Steps: 12 | Train Loss: 1.624 Vali Loss: 1.653 Vali Acc: 0.533 Test Loss: 1.653 Test Acc: 0.533
Validation loss decreased (-0.527760 --> -0.533317).  Saving model ...
Epoch: 11 cost time: 0.8501052856445312
Epoch: 11, Steps: 12 | Train Loss: 1.468 Vali Loss: 1.547 Vali Acc: 0.550 Test Loss: 1.547 Test Acc: 0.550
Validation loss decreased (-0.533317 --> -0.549985).  Saving model ...
Epoch: 12 cost time: 1.133514165878296
Epoch: 12, Steps: 12 | Train Loss: 1.278 Vali Loss: 1.417 Vali Acc: 0.583 Test Loss: 1.417 Test Acc: 0.583
Validation loss decreased (-0.549985 --> -0.583319).  Saving model ...
Epoch: 13 cost time: 1.0867233276367188
Epoch: 13, Steps: 12 | Train Loss: 1.114 Vali Loss: 1.335 Vali Acc: 0.600 Test Loss: 1.335 Test Acc: 0.600
Validation loss decreased (-0.583319 --> -0.599987).  Saving model ...
Epoch: 14 cost time: 1.0778248310089111
Epoch: 14, Steps: 12 | Train Loss: 1.044 Vali Loss: 1.231 Vali Acc: 0.644 Test Loss: 1.231 Test Acc: 0.644
Validation loss decreased (-0.599987 --> -0.644432).  Saving model ...
Epoch: 15 cost time: 1.0305356979370117
Epoch: 15, Steps: 12 | Train Loss: 0.945 Vali Loss: 1.155 Vali Acc: 0.644 Test Loss: 1.155 Test Acc: 0.644
Validation loss decreased (-0.644432 --> -0.644433).  Saving model ...
Epoch: 16 cost time: 0.8897304534912109
Epoch: 16, Steps: 12 | Train Loss: 0.939 Vali Loss: 1.072 Vali Acc: 0.683 Test Loss: 1.072 Test Acc: 0.683
Validation loss decreased (-0.644433 --> -0.683323).  Saving model ...
Epoch: 17 cost time: 1.0345189571380615
Epoch: 17, Steps: 12 | Train Loss: 0.745 Vali Loss: 0.997 Vali Acc: 0.700 Test Loss: 0.997 Test Acc: 0.700
Validation loss decreased (-0.683323 --> -0.699990).  Saving model ...
Epoch: 18 cost time: 0.8813576698303223
Epoch: 18, Steps: 12 | Train Loss: 0.722 Vali Loss: 0.949 Vali Acc: 0.700 Test Loss: 0.949 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699991).  Saving model ...
Epoch: 19 cost time: 1.037609338760376
Epoch: 19, Steps: 12 | Train Loss: 0.577 Vali Loss: 0.902 Vali Acc: 0.722 Test Loss: 0.902 Test Acc: 0.722
Validation loss decreased (-0.699991 --> -0.722213).  Saving model ...
Epoch: 20 cost time: 1.0669918060302734
Epoch: 20, Steps: 12 | Train Loss: 0.570 Vali Loss: 0.849 Vali Acc: 0.744 Test Loss: 0.849 Test Acc: 0.744
Validation loss decreased (-0.722213 --> -0.744436).  Saving model ...
Epoch: 21 cost time: 1.1106901168823242
Epoch: 21, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.822 Vali Acc: 0.756 Test Loss: 0.822 Test Acc: 0.756
Validation loss decreased (-0.744436 --> -0.755547).  Saving model ...
Epoch: 22 cost time: 0.9694583415985107
Epoch: 22, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.797 Vali Acc: 0.756 Test Loss: 0.797 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755548).  Saving model ...
Epoch: 23 cost time: 1.2685606479644775
Epoch: 23, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.777 Vali Acc: 0.756 Test Loss: 0.777 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 24 cost time: 1.2595324516296387
Epoch: 24, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.746 Vali Acc: 0.772 Test Loss: 0.746 Test Acc: 0.772
Validation loss decreased (-0.755548 --> -0.772215).  Saving model ...
Epoch: 25 cost time: 1.25357985496521
Epoch: 25, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.734 Vali Acc: 0.800 Test Loss: 0.734 Test Acc: 0.800
Validation loss decreased (-0.772215 --> -0.799993).  Saving model ...
Epoch: 26 cost time: 1.1554241180419922
Epoch: 26, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.694 Vali Acc: 0.794 Test Loss: 0.694 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.189363718032837
Epoch: 27, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.657 Vali Acc: 0.806 Test Loss: 0.657 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805549).  Saving model ...
Epoch: 28 cost time: 1.0758206844329834
Epoch: 28, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.658 Vali Acc: 0.828 Test Loss: 0.658 Test Acc: 0.828
Validation loss decreased (-0.805549 --> -0.827771).  Saving model ...
Epoch: 29 cost time: 0.9502291679382324
Epoch: 29, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.623 Vali Acc: 0.833 Test Loss: 0.623 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 30 cost time: 1.2079746723175049
Epoch: 30, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.645 Vali Acc: 0.833 Test Loss: 0.645 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4210879802703857
Epoch: 31, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.624 Vali Acc: 0.828 Test Loss: 0.624 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1472277641296387
Epoch: 32, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.634 Vali Acc: 0.856 Test Loss: 0.634 Test Acc: 0.856
Validation loss decreased (-0.833327 --> -0.855549).  Saving model ...
Epoch: 33 cost time: 1.2261192798614502
Epoch: 33, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.588 Vali Acc: 0.844 Test Loss: 0.588 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.256481409072876
Epoch: 34, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.634 Vali Acc: 0.850 Test Loss: 0.634 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.3756227493286133
Epoch: 35, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.608 Vali Acc: 0.844 Test Loss: 0.608 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.1851201057434082
Epoch: 36, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.553 Vali Acc: 0.856 Test Loss: 0.553 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855550).  Saving model ...
Epoch: 37 cost time: 1.1707324981689453
Epoch: 37, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.572 Vali Acc: 0.856 Test Loss: 0.572 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1466965675354004
Epoch: 38, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.537 Vali Acc: 0.856 Test Loss: 0.537 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 39 cost time: 1.1161315441131592
Epoch: 39, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.548 Vali Acc: 0.867 Test Loss: 0.548 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 40 cost time: 1.3093245029449463
Epoch: 40, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.546 Vali Acc: 0.867 Test Loss: 0.546 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 41 cost time: 1.1917264461517334
Epoch: 41, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.572 Vali Acc: 0.844 Test Loss: 0.572 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0633001327514648
Epoch: 42, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.576 Vali Acc: 0.867 Test Loss: 0.576 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.208174705505371
Epoch: 43, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.584 Vali Acc: 0.867 Test Loss: 0.584 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.2682623863220215
Epoch: 44, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.574 Vali Acc: 0.878 Test Loss: 0.574 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877772).  Saving model ...
Epoch: 45 cost time: 1.0663537979125977
Epoch: 45, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.588 Vali Acc: 0.883 Test Loss: 0.588 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883327).  Saving model ...
Epoch: 46 cost time: 1.3099725246429443
Epoch: 46, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.561 Vali Acc: 0.867 Test Loss: 0.561 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9761962890625
Epoch: 47, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.587 Vali Acc: 0.878 Test Loss: 0.587 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.0717132091522217
Epoch: 48, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.586 Vali Acc: 0.867 Test Loss: 0.586 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.187192440032959
Epoch: 49, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.596 Vali Acc: 0.872 Test Loss: 0.596 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.9708433151245117
Epoch: 50, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.583 Vali Acc: 0.867 Test Loss: 0.583 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.0425825119018555
Epoch: 51, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.585 Vali Acc: 0.856 Test Loss: 0.585 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.0365064144134521
Epoch: 52, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.604 Vali Acc: 0.878 Test Loss: 0.604 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.0383093357086182
Epoch: 53, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.600 Vali Acc: 0.872 Test Loss: 0.600 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.10433030128479
Epoch: 54, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.616 Vali Acc: 0.867 Test Loss: 0.616 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.2117457389831543
Epoch: 55, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.621 Vali Acc: 0.867 Test Loss: 0.621 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 609319
model size : 3.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.773270606994629
Epoch: 1, Steps: 12 | Train Loss: 2.932 Vali Loss: 2.887 Vali Acc: 0.078 Test Loss: 2.887 Test Acc: 0.078
Validation loss decreased (inf --> -0.077749).  Saving model ...
Epoch: 2 cost time: 1.0148236751556396
Epoch: 2, Steps: 12 | Train Loss: 2.842 Vali Loss: 2.759 Vali Acc: 0.100 Test Loss: 2.759 Test Acc: 0.100
Validation loss decreased (-0.077749 --> -0.099972).  Saving model ...
Epoch: 3 cost time: 0.8056426048278809
Epoch: 3, Steps: 12 | Train Loss: 2.728 Vali Loss: 2.654 Vali Acc: 0.133 Test Loss: 2.654 Test Acc: 0.133
Validation loss decreased (-0.099972 --> -0.133307).  Saving model ...
Epoch: 4 cost time: 0.9334311485290527
Epoch: 4, Steps: 12 | Train Loss: 2.635 Vali Loss: 2.562 Vali Acc: 0.194 Test Loss: 2.562 Test Acc: 0.194
Validation loss decreased (-0.133307 --> -0.194419).  Saving model ...
Epoch: 5 cost time: 0.8872802257537842
Epoch: 5, Steps: 12 | Train Loss: 2.522 Vali Loss: 2.474 Vali Acc: 0.228 Test Loss: 2.474 Test Acc: 0.228
Validation loss decreased (-0.194419 --> -0.227753).  Saving model ...
Epoch: 6 cost time: 0.8819355964660645
Epoch: 6, Steps: 12 | Train Loss: 2.419 Vali Loss: 2.369 Vali Acc: 0.417 Test Loss: 2.369 Test Acc: 0.417
Validation loss decreased (-0.227753 --> -0.416643).  Saving model ...
Epoch: 7 cost time: 0.95387864112854
Epoch: 7, Steps: 12 | Train Loss: 2.270 Vali Loss: 2.248 Vali Acc: 0.450 Test Loss: 2.248 Test Acc: 0.450
Validation loss decreased (-0.416643 --> -0.449978).  Saving model ...
Epoch: 8 cost time: 0.9102597236633301
Epoch: 8, Steps: 12 | Train Loss: 2.160 Vali Loss: 2.119 Vali Acc: 0.456 Test Loss: 2.119 Test Acc: 0.456
Validation loss decreased (-0.449978 --> -0.455534).  Saving model ...
Epoch: 9 cost time: 0.9139530658721924
Epoch: 9, Steps: 12 | Train Loss: 1.973 Vali Loss: 1.989 Vali Acc: 0.533 Test Loss: 1.989 Test Acc: 0.533
Validation loss decreased (-0.455534 --> -0.533313).  Saving model ...
Epoch: 10 cost time: 0.888819694519043
Epoch: 10, Steps: 12 | Train Loss: 1.739 Vali Loss: 1.831 Vali Acc: 0.528 Test Loss: 1.831 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8576738834381104
Epoch: 11, Steps: 12 | Train Loss: 1.579 Vali Loss: 1.707 Vali Acc: 0.578 Test Loss: 1.707 Test Acc: 0.578
Validation loss decreased (-0.533313 --> -0.577761).  Saving model ...
Epoch: 12 cost time: 0.8069467544555664
Epoch: 12, Steps: 12 | Train Loss: 1.407 Vali Loss: 1.575 Vali Acc: 0.589 Test Loss: 1.575 Test Acc: 0.589
Validation loss decreased (-0.577761 --> -0.588873).  Saving model ...
Epoch: 13 cost time: 0.84165358543396
Epoch: 13, Steps: 12 | Train Loss: 1.293 Vali Loss: 1.465 Vali Acc: 0.589 Test Loss: 1.465 Test Acc: 0.589
Validation loss decreased (-0.588873 --> -0.588874).  Saving model ...
Epoch: 14 cost time: 0.9644742012023926
Epoch: 14, Steps: 12 | Train Loss: 1.172 Vali Loss: 1.367 Vali Acc: 0.578 Test Loss: 1.367 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0017070770263672
Epoch: 15, Steps: 12 | Train Loss: 1.073 Vali Loss: 1.271 Vali Acc: 0.633 Test Loss: 1.271 Test Acc: 0.633
Validation loss decreased (-0.588874 --> -0.633321).  Saving model ...
Epoch: 16 cost time: 0.8563833236694336
Epoch: 16, Steps: 12 | Train Loss: 0.976 Vali Loss: 1.172 Vali Acc: 0.617 Test Loss: 1.172 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8513424396514893
Epoch: 17, Steps: 12 | Train Loss: 0.871 Vali Loss: 1.099 Vali Acc: 0.639 Test Loss: 1.099 Test Acc: 0.639
Validation loss decreased (-0.633321 --> -0.638878).  Saving model ...
Epoch: 18 cost time: 1.0032777786254883
Epoch: 18, Steps: 12 | Train Loss: 0.755 Vali Loss: 1.059 Vali Acc: 0.661 Test Loss: 1.059 Test Acc: 0.661
Validation loss decreased (-0.638878 --> -0.661101).  Saving model ...
Epoch: 19 cost time: 0.8911194801330566
Epoch: 19, Steps: 12 | Train Loss: 0.743 Vali Loss: 1.004 Vali Acc: 0.694 Test Loss: 1.004 Test Acc: 0.694
Validation loss decreased (-0.661101 --> -0.694434).  Saving model ...
Epoch: 20 cost time: 0.8136157989501953
Epoch: 20, Steps: 12 | Train Loss: 0.618 Vali Loss: 0.936 Vali Acc: 0.711 Test Loss: 0.936 Test Acc: 0.711
Validation loss decreased (-0.694434 --> -0.711102).  Saving model ...
Epoch: 21 cost time: 0.9139935970306396
Epoch: 21, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.882 Vali Acc: 0.717 Test Loss: 0.882 Test Acc: 0.717
Validation loss decreased (-0.711102 --> -0.716658).  Saving model ...
Epoch: 22 cost time: 1.0614309310913086
Epoch: 22, Steps: 12 | Train Loss: 0.562 Vali Loss: 0.861 Vali Acc: 0.722 Test Loss: 0.861 Test Acc: 0.722
Validation loss decreased (-0.716658 --> -0.722214).  Saving model ...
Epoch: 23 cost time: 0.9644229412078857
Epoch: 23, Steps: 12 | Train Loss: 0.538 Vali Loss: 0.815 Vali Acc: 0.744 Test Loss: 0.815 Test Acc: 0.744
Validation loss decreased (-0.722214 --> -0.744436).  Saving model ...
Epoch: 24 cost time: 0.9357054233551025
Epoch: 24, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.801 Vali Acc: 0.717 Test Loss: 0.801 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9334063529968262
Epoch: 25, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.757 Vali Acc: 0.783 Test Loss: 0.757 Test Acc: 0.783
Validation loss decreased (-0.744436 --> -0.783326).  Saving model ...
Epoch: 26 cost time: 0.8589341640472412
Epoch: 26, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.736 Vali Acc: 0.789 Test Loss: 0.736 Test Acc: 0.789
Validation loss decreased (-0.783326 --> -0.788882).  Saving model ...
Epoch: 27 cost time: 0.7815854549407959
Epoch: 27, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.701 Vali Acc: 0.778 Test Loss: 0.701 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0105137825012207
Epoch: 28, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.684 Vali Acc: 0.800 Test Loss: 0.684 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799993).  Saving model ...
Epoch: 29 cost time: 0.9297666549682617
Epoch: 29, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.691 Vali Acc: 0.806 Test Loss: 0.691 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805549).  Saving model ...
Epoch: 30 cost time: 0.7411248683929443
Epoch: 30, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.657 Vali Acc: 0.800 Test Loss: 0.657 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7610430717468262
Epoch: 31, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.648 Vali Acc: 0.811 Test Loss: 0.648 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811105).  Saving model ...
Epoch: 32 cost time: 0.9024591445922852
Epoch: 32, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.632 Vali Acc: 0.817 Test Loss: 0.632 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816660).  Saving model ...
Epoch: 33 cost time: 0.8218729496002197
Epoch: 33, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.615 Vali Acc: 0.817 Test Loss: 0.615 Test Acc: 0.817
Validation loss decreased (-0.816660 --> -0.816661).  Saving model ...
Epoch: 34 cost time: 0.9239771366119385
Epoch: 34, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.581 Vali Acc: 0.844 Test Loss: 0.581 Test Acc: 0.844
Validation loss decreased (-0.816661 --> -0.844439).  Saving model ...
Epoch: 35 cost time: 0.7705898284912109
Epoch: 35, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.610 Vali Acc: 0.844 Test Loss: 0.610 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7696995735168457
Epoch: 36, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.598 Vali Acc: 0.844 Test Loss: 0.598 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9504783153533936
Epoch: 37, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.573 Vali Acc: 0.850 Test Loss: 0.573 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849994).  Saving model ...
Epoch: 38 cost time: 0.8672316074371338
Epoch: 38, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.571 Vali Acc: 0.850 Test Loss: 0.571 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 39 cost time: 0.8069448471069336
Epoch: 39, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.567 Vali Acc: 0.867 Test Loss: 0.567 Test Acc: 0.867
Validation loss decreased (-0.849994 --> -0.866661).  Saving model ...
Epoch: 40 cost time: 0.9134516716003418
Epoch: 40, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.549 Vali Acc: 0.872 Test Loss: 0.549 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 41 cost time: 0.9050636291503906
Epoch: 41, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.620 Vali Acc: 0.856 Test Loss: 0.620 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9648492336273193
Epoch: 42, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.569 Vali Acc: 0.856 Test Loss: 0.569 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.8632779121398926
Epoch: 43, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.570 Vali Acc: 0.861 Test Loss: 0.570 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.9213588237762451
Epoch: 44, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.572 Vali Acc: 0.850 Test Loss: 0.572 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.882418155670166
Epoch: 45, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.588 Vali Acc: 0.867 Test Loss: 0.588 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.084869623184204
Epoch: 46, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.612 Vali Acc: 0.872 Test Loss: 0.612 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.9988844394683838
Epoch: 47, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.596 Vali Acc: 0.878 Test Loss: 0.596 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 48 cost time: 0.8974640369415283
Epoch: 48, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.588 Vali Acc: 0.867 Test Loss: 0.588 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.9591169357299805
Epoch: 49, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.573 Vali Acc: 0.872 Test Loss: 0.573 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.0994524955749512
Epoch: 50, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.591 Vali Acc: 0.872 Test Loss: 0.591 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.9798882007598877
Epoch: 51, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.575 Vali Acc: 0.878 Test Loss: 0.575 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 52 cost time: 0.9318695068359375
Epoch: 52, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.603 Vali Acc: 0.861 Test Loss: 0.603 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.9258918762207031
Epoch: 53, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.659 Vali Acc: 0.867 Test Loss: 0.659 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.9030342102050781
Epoch: 54, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.650 Vali Acc: 0.861 Test Loss: 0.650 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.890514612197876
Epoch: 55, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.604 Vali Acc: 0.878 Test Loss: 0.604 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.9518835544586182
Epoch: 56, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.577 Vali Acc: 0.878 Test Loss: 0.577 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.001971960067749
Epoch: 57, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.596 Vali Acc: 0.878 Test Loss: 0.596 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.9412336349487305
Epoch: 58, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.601 Vali Acc: 0.872 Test Loss: 0.601 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.9436161518096924
Epoch: 59, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.614 Vali Acc: 0.867 Test Loss: 0.614 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 1.0097880363464355
Epoch: 60, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.578 Vali Acc: 0.878 Test Loss: 0.578 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 1.1290686130523682
Epoch: 61, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.571 Vali Acc: 0.883 Test Loss: 0.571 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883328).  Saving model ...
Epoch: 62 cost time: 0.8661696910858154
Epoch: 62, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.613 Vali Acc: 0.872 Test Loss: 0.613 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.9804530143737793
Epoch: 63, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.609 Vali Acc: 0.872 Test Loss: 0.609 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.124492883682251
Epoch: 64, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.625 Vali Acc: 0.878 Test Loss: 0.625 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 1.138199806213379
Epoch: 65, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.624 Vali Acc: 0.878 Test Loss: 0.624 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.8301935195922852
Epoch: 66, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.604 Vali Acc: 0.878 Test Loss: 0.604 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 0.9746661186218262
Epoch: 67, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.600 Vali Acc: 0.878 Test Loss: 0.600 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 1.2899999618530273
Epoch: 68, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.617 Vali Acc: 0.878 Test Loss: 0.617 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 1.2556748390197754
Epoch: 69, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.616 Vali Acc: 0.883 Test Loss: 0.616 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 0.9697413444519043
Epoch: 70, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.622 Vali Acc: 0.883 Test Loss: 0.622 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 0.9694766998291016
Epoch: 71, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.627 Vali Acc: 0.883 Test Loss: 0.627 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 411943
model size : 2.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6370110511779785
Epoch: 1, Steps: 12 | Train Loss: 2.820 Vali Loss: 2.825 Vali Acc: 0.050 Test Loss: 2.825 Test Acc: 0.050
Validation loss decreased (inf --> -0.049972).  Saving model ...
Epoch: 2 cost time: 1.1571226119995117
Epoch: 2, Steps: 12 | Train Loss: 2.807 Vali Loss: 2.710 Vali Acc: 0.111 Test Loss: 2.710 Test Acc: 0.111
Validation loss decreased (-0.049972 --> -0.111084).  Saving model ...
Epoch: 3 cost time: 1.0401434898376465
Epoch: 3, Steps: 12 | Train Loss: 2.697 Vali Loss: 2.597 Vali Acc: 0.211 Test Loss: 2.597 Test Acc: 0.211
Validation loss decreased (-0.111084 --> -0.211085).  Saving model ...
Epoch: 4 cost time: 1.0829107761383057
Epoch: 4, Steps: 12 | Train Loss: 2.563 Vali Loss: 2.499 Vali Acc: 0.333 Test Loss: 2.499 Test Acc: 0.333
Validation loss decreased (-0.211085 --> -0.333308).  Saving model ...
Epoch: 5 cost time: 0.9757387638092041
Epoch: 5, Steps: 12 | Train Loss: 2.452 Vali Loss: 2.400 Vali Acc: 0.367 Test Loss: 2.400 Test Acc: 0.367
Validation loss decreased (-0.333308 --> -0.366643).  Saving model ...
Epoch: 6 cost time: 1.069749355316162
Epoch: 6, Steps: 12 | Train Loss: 2.364 Vali Loss: 2.300 Vali Acc: 0.422 Test Loss: 2.300 Test Acc: 0.422
Validation loss decreased (-0.366643 --> -0.422199).  Saving model ...
Epoch: 7 cost time: 1.0031929016113281
Epoch: 7, Steps: 12 | Train Loss: 2.211 Vali Loss: 2.183 Vali Acc: 0.528 Test Loss: 2.183 Test Acc: 0.528
Validation loss decreased (-0.422199 --> -0.527756).  Saving model ...
Epoch: 8 cost time: 0.9670312404632568
Epoch: 8, Steps: 12 | Train Loss: 2.086 Vali Loss: 2.055 Vali Acc: 0.511 Test Loss: 2.055 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9519212245941162
Epoch: 9, Steps: 12 | Train Loss: 1.891 Vali Loss: 1.931 Vali Acc: 0.556 Test Loss: 1.931 Test Acc: 0.556
Validation loss decreased (-0.527756 --> -0.555536).  Saving model ...
Epoch: 10 cost time: 1.1266098022460938
Epoch: 10, Steps: 12 | Train Loss: 1.728 Vali Loss: 1.796 Vali Acc: 0.567 Test Loss: 1.796 Test Acc: 0.567
Validation loss decreased (-0.555536 --> -0.566649).  Saving model ...
Epoch: 11 cost time: 1.2405846118927002
Epoch: 11, Steps: 12 | Train Loss: 1.602 Vali Loss: 1.652 Vali Acc: 0.606 Test Loss: 1.652 Test Acc: 0.606
Validation loss decreased (-0.566649 --> -0.605539).  Saving model ...
Epoch: 12 cost time: 1.0526587963104248
Epoch: 12, Steps: 12 | Train Loss: 1.388 Vali Loss: 1.540 Vali Acc: 0.600 Test Loss: 1.540 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2413363456726074
Epoch: 13, Steps: 12 | Train Loss: 1.264 Vali Loss: 1.441 Vali Acc: 0.617 Test Loss: 1.441 Test Acc: 0.617
Validation loss decreased (-0.605539 --> -0.616652).  Saving model ...
Epoch: 14 cost time: 1.0726876258850098
Epoch: 14, Steps: 12 | Train Loss: 1.248 Vali Loss: 1.352 Vali Acc: 0.589 Test Loss: 1.352 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0747711658477783
Epoch: 15, Steps: 12 | Train Loss: 1.067 Vali Loss: 1.248 Vali Acc: 0.661 Test Loss: 1.248 Test Acc: 0.661
Validation loss decreased (-0.616652 --> -0.661099).  Saving model ...
Epoch: 16 cost time: 1.2838213443756104
Epoch: 16, Steps: 12 | Train Loss: 0.931 Vali Loss: 1.174 Vali Acc: 0.650 Test Loss: 1.174 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0486729145050049
Epoch: 17, Steps: 12 | Train Loss: 0.912 Vali Loss: 1.120 Vali Acc: 0.644 Test Loss: 1.120 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1042351722717285
Epoch: 18, Steps: 12 | Train Loss: 0.835 Vali Loss: 1.024 Vali Acc: 0.722 Test Loss: 1.024 Test Acc: 0.722
Validation loss decreased (-0.661099 --> -0.722212).  Saving model ...
Epoch: 19 cost time: 0.9865853786468506
Epoch: 19, Steps: 12 | Train Loss: 0.749 Vali Loss: 0.974 Vali Acc: 0.728 Test Loss: 0.974 Test Acc: 0.728
Validation loss decreased (-0.722212 --> -0.727768).  Saving model ...
Epoch: 20 cost time: 1.10304856300354
Epoch: 20, Steps: 12 | Train Loss: 0.643 Vali Loss: 0.917 Vali Acc: 0.756 Test Loss: 0.917 Test Acc: 0.756
Validation loss decreased (-0.727768 --> -0.755546).  Saving model ...
Epoch: 21 cost time: 1.0264356136322021
Epoch: 21, Steps: 12 | Train Loss: 0.594 Vali Loss: 0.867 Vali Acc: 0.767 Test Loss: 0.867 Test Acc: 0.767
Validation loss decreased (-0.755546 --> -0.766658).  Saving model ...
Epoch: 22 cost time: 1.0933465957641602
Epoch: 22, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.813 Vali Acc: 0.783 Test Loss: 0.813 Test Acc: 0.783
Validation loss decreased (-0.766658 --> -0.783325).  Saving model ...
Epoch: 23 cost time: 0.9503819942474365
Epoch: 23, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.781 Vali Acc: 0.794 Test Loss: 0.781 Test Acc: 0.794
Validation loss decreased (-0.783325 --> -0.794437).  Saving model ...
Epoch: 24 cost time: 1.147810459136963
Epoch: 24, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.768 Vali Acc: 0.789 Test Loss: 0.768 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2999083995819092
Epoch: 25, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.722 Vali Acc: 0.817 Test Loss: 0.722 Test Acc: 0.817
Validation loss decreased (-0.794437 --> -0.816659).  Saving model ...
Epoch: 26 cost time: 1.0343928337097168
Epoch: 26, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.702 Vali Acc: 0.811 Test Loss: 0.702 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1177964210510254
Epoch: 27, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.671 Vali Acc: 0.828 Test Loss: 0.671 Test Acc: 0.828
Validation loss decreased (-0.816659 --> -0.827771).  Saving model ...
Epoch: 28 cost time: 1.0000238418579102
Epoch: 28, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.653 Vali Acc: 0.817 Test Loss: 0.653 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1327402591705322
Epoch: 29, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.638 Vali Acc: 0.822 Test Loss: 0.638 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1052417755126953
Epoch: 30, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.595 Vali Acc: 0.850 Test Loss: 0.595 Test Acc: 0.850
Validation loss decreased (-0.827771 --> -0.849994).  Saving model ...
Epoch: 31 cost time: 1.028496265411377
Epoch: 31, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.594 Vali Acc: 0.856 Test Loss: 0.594 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 32 cost time: 1.1818182468414307
Epoch: 32, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.587 Vali Acc: 0.856 Test Loss: 0.587 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 33 cost time: 1.082031011581421
Epoch: 33, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.574 Vali Acc: 0.856 Test Loss: 0.574 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 34 cost time: 1.1893925666809082
Epoch: 34, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.566 Vali Acc: 0.867 Test Loss: 0.566 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 35 cost time: 1.1571834087371826
Epoch: 35, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.559 Vali Acc: 0.878 Test Loss: 0.559 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877772).  Saving model ...
Epoch: 36 cost time: 1.1529016494750977
Epoch: 36, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.547 Vali Acc: 0.878 Test Loss: 0.547 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 37 cost time: 0.928722620010376
Epoch: 37, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.535 Vali Acc: 0.883 Test Loss: 0.535 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883328).  Saving model ...
Epoch: 38 cost time: 1.2420475482940674
Epoch: 38, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.528 Vali Acc: 0.883 Test Loss: 0.528 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883328).  Saving model ...
Epoch: 39 cost time: 1.1571552753448486
Epoch: 39, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.530 Vali Acc: 0.872 Test Loss: 0.530 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0686225891113281
Epoch: 40, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.519 Vali Acc: 0.878 Test Loss: 0.519 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.1835942268371582
Epoch: 41, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.529 Vali Acc: 0.894 Test Loss: 0.529 Test Acc: 0.894
Validation loss decreased (-0.883328 --> -0.894439).  Saving model ...
Epoch: 42 cost time: 1.0752794742584229
Epoch: 42, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.512 Vali Acc: 0.883 Test Loss: 0.512 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9510138034820557
Epoch: 43, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.543 Vali Acc: 0.889 Test Loss: 0.543 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0178444385528564
Epoch: 44, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.509 Vali Acc: 0.900 Test Loss: 0.509 Test Acc: 0.900
Validation loss decreased (-0.894439 --> -0.899995).  Saving model ...
Epoch: 45 cost time: 1.0387680530548096
Epoch: 45, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.535 Vali Acc: 0.900 Test Loss: 0.535 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.0508723258972168
Epoch: 46, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.552 Vali Acc: 0.883 Test Loss: 0.552 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.068333625793457
Epoch: 47, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.515 Vali Acc: 0.900 Test Loss: 0.515 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.0135102272033691
Epoch: 48, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.509 Vali Acc: 0.900 Test Loss: 0.509 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.9310004711151123
Epoch: 49, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.584 Vali Acc: 0.906 Test Loss: 0.584 Test Acc: 0.906
Validation loss decreased (-0.899995 --> -0.905550).  Saving model ...
Epoch: 50 cost time: 1.0921862125396729
Epoch: 50, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.559 Vali Acc: 0.900 Test Loss: 0.559 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.1391167640686035
Epoch: 51, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.547 Vali Acc: 0.894 Test Loss: 0.547 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.3586030006408691
Epoch: 52, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.553 Vali Acc: 0.900 Test Loss: 0.553 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.15299654006958
Epoch: 53, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.537 Vali Acc: 0.894 Test Loss: 0.537 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.1305396556854248
Epoch: 54, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.579 Vali Acc: 0.883 Test Loss: 0.579 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.1939606666564941
Epoch: 55, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.586 Vali Acc: 0.878 Test Loss: 0.586 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.1866111755371094
Epoch: 56, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.576 Vali Acc: 0.889 Test Loss: 0.576 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.177851676940918
Epoch: 57, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.552 Vali Acc: 0.889 Test Loss: 0.552 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.1138625144958496
Epoch: 58, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.550 Vali Acc: 0.900 Test Loss: 0.550 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.06758451461792
Epoch: 59, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.566 Vali Acc: 0.900 Test Loss: 0.566 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 411687
model size : 2.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5808582305908203
Epoch: 1, Steps: 12 | Train Loss: 2.986 Vali Loss: 2.854 Vali Acc: 0.044 Test Loss: 2.854 Test Acc: 0.044
Validation loss decreased (inf --> -0.044416).  Saving model ...
Epoch: 2 cost time: 0.9139723777770996
Epoch: 2, Steps: 12 | Train Loss: 2.798 Vali Loss: 2.726 Vali Acc: 0.106 Test Loss: 2.726 Test Acc: 0.106
Validation loss decreased (-0.044416 --> -0.105528).  Saving model ...
Epoch: 3 cost time: 0.8818178176879883
Epoch: 3, Steps: 12 | Train Loss: 2.681 Vali Loss: 2.624 Vali Acc: 0.117 Test Loss: 2.624 Test Acc: 0.117
Validation loss decreased (-0.105528 --> -0.116640).  Saving model ...
Epoch: 4 cost time: 0.8725249767303467
Epoch: 4, Steps: 12 | Train Loss: 2.550 Vali Loss: 2.526 Vali Acc: 0.311 Test Loss: 2.526 Test Acc: 0.311
Validation loss decreased (-0.116640 --> -0.311086).  Saving model ...
Epoch: 5 cost time: 0.9901218414306641
Epoch: 5, Steps: 12 | Train Loss: 2.441 Vali Loss: 2.421 Vali Acc: 0.394 Test Loss: 2.421 Test Acc: 0.394
Validation loss decreased (-0.311086 --> -0.394420).  Saving model ...
Epoch: 6 cost time: 0.9785947799682617
Epoch: 6, Steps: 12 | Train Loss: 2.304 Vali Loss: 2.307 Vali Acc: 0.439 Test Loss: 2.307 Test Acc: 0.439
Validation loss decreased (-0.394420 --> -0.438866).  Saving model ...
Epoch: 7 cost time: 0.9551830291748047
Epoch: 7, Steps: 12 | Train Loss: 2.145 Vali Loss: 2.176 Vali Acc: 0.483 Test Loss: 2.176 Test Acc: 0.483
Validation loss decreased (-0.438866 --> -0.483312).  Saving model ...
Epoch: 8 cost time: 0.9271388053894043
Epoch: 8, Steps: 12 | Train Loss: 1.993 Vali Loss: 2.031 Vali Acc: 0.489 Test Loss: 2.031 Test Acc: 0.489
Validation loss decreased (-0.483312 --> -0.488869).  Saving model ...
Epoch: 9 cost time: 0.9251868724822998
Epoch: 9, Steps: 12 | Train Loss: 1.869 Vali Loss: 1.894 Vali Acc: 0.533 Test Loss: 1.894 Test Acc: 0.533
Validation loss decreased (-0.488869 --> -0.533314).  Saving model ...
Epoch: 10 cost time: 0.9070107936859131
Epoch: 10, Steps: 12 | Train Loss: 1.627 Vali Loss: 1.757 Vali Acc: 0.511 Test Loss: 1.757 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9919381141662598
Epoch: 11, Steps: 12 | Train Loss: 1.482 Vali Loss: 1.634 Vali Acc: 0.544 Test Loss: 1.634 Test Acc: 0.544
Validation loss decreased (-0.533314 --> -0.544428).  Saving model ...
Epoch: 12 cost time: 1.124372959136963
Epoch: 12, Steps: 12 | Train Loss: 1.263 Vali Loss: 1.517 Vali Acc: 0.578 Test Loss: 1.517 Test Acc: 0.578
Validation loss decreased (-0.544428 --> -0.577763).  Saving model ...
Epoch: 13 cost time: 0.8931922912597656
Epoch: 13, Steps: 12 | Train Loss: 1.281 Vali Loss: 1.414 Vali Acc: 0.589 Test Loss: 1.414 Test Acc: 0.589
Validation loss decreased (-0.577763 --> -0.588875).  Saving model ...
Epoch: 14 cost time: 0.9142763614654541
Epoch: 14, Steps: 12 | Train Loss: 1.115 Vali Loss: 1.286 Vali Acc: 0.656 Test Loss: 1.286 Test Acc: 0.656
Validation loss decreased (-0.588875 --> -0.655543).  Saving model ...
Epoch: 15 cost time: 1.139173984527588
Epoch: 15, Steps: 12 | Train Loss: 1.003 Vali Loss: 1.204 Vali Acc: 0.656 Test Loss: 1.204 Test Acc: 0.656
Validation loss decreased (-0.655543 --> -0.655544).  Saving model ...
Epoch: 16 cost time: 0.9869570732116699
Epoch: 16, Steps: 12 | Train Loss: 0.902 Vali Loss: 1.128 Vali Acc: 0.672 Test Loss: 1.128 Test Acc: 0.672
Validation loss decreased (-0.655544 --> -0.672211).  Saving model ...
Epoch: 17 cost time: 0.984351634979248
Epoch: 17, Steps: 12 | Train Loss: 0.869 Vali Loss: 1.065 Vali Acc: 0.678 Test Loss: 1.065 Test Acc: 0.678
Validation loss decreased (-0.672211 --> -0.677767).  Saving model ...
Epoch: 18 cost time: 0.9770004749298096
Epoch: 18, Steps: 12 | Train Loss: 0.799 Vali Loss: 1.021 Vali Acc: 0.683 Test Loss: 1.021 Test Acc: 0.683
Validation loss decreased (-0.677767 --> -0.683323).  Saving model ...
Epoch: 19 cost time: 0.9617118835449219
Epoch: 19, Steps: 12 | Train Loss: 0.702 Vali Loss: 0.961 Vali Acc: 0.706 Test Loss: 0.961 Test Acc: 0.706
Validation loss decreased (-0.683323 --> -0.705546).  Saving model ...
Epoch: 20 cost time: 0.865957498550415
Epoch: 20, Steps: 12 | Train Loss: 0.663 Vali Loss: 0.937 Vali Acc: 0.711 Test Loss: 0.937 Test Acc: 0.711
Validation loss decreased (-0.705546 --> -0.711102).  Saving model ...
Epoch: 21 cost time: 0.9741184711456299
Epoch: 21, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.880 Vali Acc: 0.733 Test Loss: 0.880 Test Acc: 0.733
Validation loss decreased (-0.711102 --> -0.733325).  Saving model ...
Epoch: 22 cost time: 1.0423228740692139
Epoch: 22, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.844 Vali Acc: 0.739 Test Loss: 0.844 Test Acc: 0.739
Validation loss decreased (-0.733325 --> -0.738880).  Saving model ...
Epoch: 23 cost time: 0.8517889976501465
Epoch: 23, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.822 Vali Acc: 0.733 Test Loss: 0.822 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9775693416595459
Epoch: 24, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.789 Vali Acc: 0.750 Test Loss: 0.789 Test Acc: 0.750
Validation loss decreased (-0.738880 --> -0.749992).  Saving model ...
Epoch: 25 cost time: 0.9310472011566162
Epoch: 25, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.783 Vali Acc: 0.778 Test Loss: 0.783 Test Acc: 0.778
Validation loss decreased (-0.749992 --> -0.777770).  Saving model ...
Epoch: 26 cost time: 0.9573225975036621
Epoch: 26, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.748 Vali Acc: 0.800 Test Loss: 0.748 Test Acc: 0.800
Validation loss decreased (-0.777770 --> -0.799993).  Saving model ...
Epoch: 27 cost time: 0.9139773845672607
Epoch: 27, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.733 Vali Acc: 0.806 Test Loss: 0.733 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805548).  Saving model ...
Epoch: 28 cost time: 0.9791405200958252
Epoch: 28, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.712 Vali Acc: 0.794 Test Loss: 0.712 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9695096015930176
Epoch: 29, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.698 Vali Acc: 0.794 Test Loss: 0.698 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9453351497650146
Epoch: 30, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.662 Vali Acc: 0.822 Test Loss: 0.662 Test Acc: 0.822
Validation loss decreased (-0.805548 --> -0.822216).  Saving model ...
Epoch: 31 cost time: 1.0141117572784424
Epoch: 31, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.649 Vali Acc: 0.817 Test Loss: 0.649 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9980902671813965
Epoch: 32, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.635 Vali Acc: 0.839 Test Loss: 0.635 Test Acc: 0.839
Validation loss decreased (-0.822216 --> -0.838883).  Saving model ...
Epoch: 33 cost time: 1.0087242126464844
Epoch: 33, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.650 Vali Acc: 0.833 Test Loss: 0.650 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1643309593200684
Epoch: 34, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.639 Vali Acc: 0.828 Test Loss: 0.639 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9297096729278564
Epoch: 35, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.631 Vali Acc: 0.833 Test Loss: 0.631 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.9645688533782959
Epoch: 36, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.618 Vali Acc: 0.856 Test Loss: 0.618 Test Acc: 0.856
Validation loss decreased (-0.838883 --> -0.855549).  Saving model ...
Epoch: 37 cost time: 0.8951220512390137
Epoch: 37, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.612 Vali Acc: 0.861 Test Loss: 0.612 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 38 cost time: 1.0046918392181396
Epoch: 38, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.602 Vali Acc: 0.867 Test Loss: 0.602 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 39 cost time: 0.9797317981719971
Epoch: 39, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.611 Vali Acc: 0.867 Test Loss: 0.611 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8758096694946289
Epoch: 40, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.607 Vali Acc: 0.861 Test Loss: 0.607 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9342868328094482
Epoch: 41, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.616 Vali Acc: 0.872 Test Loss: 0.616 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 42 cost time: 1.0307416915893555
Epoch: 42, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.599 Vali Acc: 0.872 Test Loss: 0.599 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872216).  Saving model ...
Epoch: 43 cost time: 1.0148506164550781
Epoch: 43, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.631 Vali Acc: 0.861 Test Loss: 0.631 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.0971331596374512
Epoch: 44, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.603 Vali Acc: 0.867 Test Loss: 0.603 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.9993391036987305
Epoch: 45, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.628 Vali Acc: 0.872 Test Loss: 0.628 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.878136157989502
Epoch: 46, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.626 Vali Acc: 0.867 Test Loss: 0.626 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.9059877395629883
Epoch: 47, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.619 Vali Acc: 0.872 Test Loss: 0.619 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.8550877571105957
Epoch: 48, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.642 Vali Acc: 0.867 Test Loss: 0.642 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.087895393371582
Epoch: 49, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.626 Vali Acc: 0.883 Test Loss: 0.626 Test Acc: 0.883
Validation loss decreased (-0.872216 --> -0.883327).  Saving model ...
Epoch: 50 cost time: 0.9412922859191895
Epoch: 50, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.604 Vali Acc: 0.883 Test Loss: 0.604 Test Acc: 0.883
Validation loss decreased (-0.883327 --> -0.883327).  Saving model ...
Epoch: 51 cost time: 0.8506641387939453
Epoch: 51, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.633 Vali Acc: 0.878 Test Loss: 0.633 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.9099862575531006
Epoch: 52, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.660 Vali Acc: 0.883 Test Loss: 0.660 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.9338724613189697
Epoch: 53, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.674 Vali Acc: 0.878 Test Loss: 0.674 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.0310356616973877
Epoch: 54, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.666 Vali Acc: 0.878 Test Loss: 0.666 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.1042871475219727
Epoch: 55, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.666 Vali Acc: 0.867 Test Loss: 0.666 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.0126042366027832
Epoch: 56, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.660 Vali Acc: 0.889 Test Loss: 0.660 Test Acc: 0.889
Validation loss decreased (-0.883327 --> -0.888882).  Saving model ...
Epoch: 57 cost time: 0.9901692867279053
Epoch: 57, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.666 Vali Acc: 0.878 Test Loss: 0.666 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.9341318607330322
Epoch: 58, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.644 Vali Acc: 0.889 Test Loss: 0.644 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888882).  Saving model ...
Epoch: 59 cost time: 0.9056968688964844
Epoch: 59, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.624 Vali Acc: 0.889 Test Loss: 0.624 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888883).  Saving model ...
Epoch: 60 cost time: 1.0107626914978027
Epoch: 60, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.631 Vali Acc: 0.889 Test Loss: 0.631 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.9695346355438232
Epoch: 61, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.645 Vali Acc: 0.889 Test Loss: 0.645 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.906836748123169
Epoch: 62, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.649 Vali Acc: 0.889 Test Loss: 0.649 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.9406082630157471
Epoch: 63, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.675 Vali Acc: 0.883 Test Loss: 0.675 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.9741899967193604
Epoch: 64, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.665 Vali Acc: 0.883 Test Loss: 0.665 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.156013011932373
Epoch: 65, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.720 Vali Acc: 0.878 Test Loss: 0.720 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 1.0358638763427734
Epoch: 66, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.688 Vali Acc: 0.872 Test Loss: 0.688 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 1.0652790069580078
Epoch: 67, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.661 Vali Acc: 0.889 Test Loss: 0.661 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 0.9300920963287354
Epoch: 68, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.679 Vali Acc: 0.889 Test Loss: 0.679 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 0.9623675346374512
Epoch: 69, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.689 Vali Acc: 0.894 Test Loss: 0.689 Test Acc: 0.894
Validation loss decreased (-0.888883 --> -0.894438).  Saving model ...
Epoch: 70 cost time: 1.0015337467193604
Epoch: 70, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.682 Vali Acc: 0.889 Test Loss: 0.682 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.0170750617980957
Epoch: 71, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.693 Vali Acc: 0.889 Test Loss: 0.693 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.9863817691802979
Epoch: 72, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.702 Vali Acc: 0.900 Test Loss: 0.702 Test Acc: 0.900
Validation loss decreased (-0.894438 --> -0.899993).  Saving model ...
Epoch: 73 cost time: 1.1939051151275635
Epoch: 73, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.703 Vali Acc: 0.883 Test Loss: 0.703 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.9986903667449951
Epoch: 74, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.679 Vali Acc: 0.900 Test Loss: 0.679 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 75 cost time: 0.8644261360168457
Epoch: 75, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.713 Vali Acc: 0.883 Test Loss: 0.713 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.9990484714508057
Epoch: 76, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.734 Vali Acc: 0.872 Test Loss: 0.734 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 1.0003552436828613
Epoch: 77, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.707 Vali Acc: 0.883 Test Loss: 0.707 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 0.9457995891571045
Epoch: 78, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.699 Vali Acc: 0.889 Test Loss: 0.699 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 1.00593900680542
Epoch: 79, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.696 Vali Acc: 0.889 Test Loss: 0.696 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 1.101414680480957
Epoch: 80, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.674 Vali Acc: 0.883 Test Loss: 0.674 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 1.1662654876708984
Epoch: 81, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.711 Vali Acc: 0.889 Test Loss: 0.711 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 1.123687744140625
Epoch: 82, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.719 Vali Acc: 0.889 Test Loss: 0.719 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 83 cost time: 1.0434515476226807
Epoch: 83, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.708 Vali Acc: 0.889 Test Loss: 0.708 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 84 cost time: 0.8220162391662598
Epoch: 84, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.721 Vali Acc: 0.883 Test Loss: 0.721 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 411431
model size : 2.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4886648654937744
Epoch: 1, Steps: 12 | Train Loss: 2.936 Vali Loss: 2.850 Vali Acc: 0.061 Test Loss: 2.850 Test Acc: 0.061
Validation loss decreased (inf --> -0.061083).  Saving model ...
Epoch: 2 cost time: 1.0271451473236084
Epoch: 2, Steps: 12 | Train Loss: 2.822 Vali Loss: 2.712 Vali Acc: 0.089 Test Loss: 2.712 Test Acc: 0.089
Validation loss decreased (-0.061083 --> -0.088862).  Saving model ...
Epoch: 3 cost time: 0.9430069923400879
Epoch: 3, Steps: 12 | Train Loss: 2.705 Vali Loss: 2.595 Vali Acc: 0.133 Test Loss: 2.595 Test Acc: 0.133
Validation loss decreased (-0.088862 --> -0.133307).  Saving model ...
Epoch: 4 cost time: 1.0632469654083252
Epoch: 4, Steps: 12 | Train Loss: 2.588 Vali Loss: 2.494 Vali Acc: 0.289 Test Loss: 2.494 Test Acc: 0.289
Validation loss decreased (-0.133307 --> -0.288864).  Saving model ...
Epoch: 5 cost time: 0.8075351715087891
Epoch: 5, Steps: 12 | Train Loss: 2.448 Vali Loss: 2.394 Vali Acc: 0.417 Test Loss: 2.394 Test Acc: 0.417
Validation loss decreased (-0.288864 --> -0.416643).  Saving model ...
Epoch: 6 cost time: 1.1724724769592285
Epoch: 6, Steps: 12 | Train Loss: 2.300 Vali Loss: 2.285 Vali Acc: 0.439 Test Loss: 2.285 Test Acc: 0.439
Validation loss decreased (-0.416643 --> -0.438866).  Saving model ...
Epoch: 7 cost time: 0.8877134323120117
Epoch: 7, Steps: 12 | Train Loss: 2.176 Vali Loss: 2.163 Vali Acc: 0.422 Test Loss: 2.163 Test Acc: 0.422
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.109520673751831
Epoch: 8, Steps: 12 | Train Loss: 2.019 Vali Loss: 2.036 Vali Acc: 0.544 Test Loss: 2.036 Test Acc: 0.544
Validation loss decreased (-0.438866 --> -0.544424).  Saving model ...
Epoch: 9 cost time: 1.0177843570709229
Epoch: 9, Steps: 12 | Train Loss: 1.884 Vali Loss: 1.900 Vali Acc: 0.528 Test Loss: 1.900 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8433117866516113
Epoch: 10, Steps: 12 | Train Loss: 1.685 Vali Loss: 1.764 Vali Acc: 0.522 Test Loss: 1.764 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1042373180389404
Epoch: 11, Steps: 12 | Train Loss: 1.566 Vali Loss: 1.652 Vali Acc: 0.533 Test Loss: 1.652 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7867312431335449
Epoch: 12, Steps: 12 | Train Loss: 1.429 Vali Loss: 1.547 Vali Acc: 0.550 Test Loss: 1.547 Test Acc: 0.550
Validation loss decreased (-0.544424 --> -0.549985).  Saving model ...
Epoch: 13 cost time: 0.954209566116333
Epoch: 13, Steps: 12 | Train Loss: 1.273 Vali Loss: 1.459 Vali Acc: 0.567 Test Loss: 1.459 Test Acc: 0.567
Validation loss decreased (-0.549985 --> -0.566652).  Saving model ...
Epoch: 14 cost time: 0.8577523231506348
Epoch: 14, Steps: 12 | Train Loss: 1.171 Vali Loss: 1.376 Vali Acc: 0.611 Test Loss: 1.376 Test Acc: 0.611
Validation loss decreased (-0.566652 --> -0.611097).  Saving model ...
Epoch: 15 cost time: 0.910977840423584
Epoch: 15, Steps: 12 | Train Loss: 1.074 Vali Loss: 1.287 Vali Acc: 0.611 Test Loss: 1.287 Test Acc: 0.611
Validation loss decreased (-0.611097 --> -0.611098).  Saving model ...
Epoch: 16 cost time: 0.8600552082061768
Epoch: 16, Steps: 12 | Train Loss: 0.995 Vali Loss: 1.212 Vali Acc: 0.633 Test Loss: 1.212 Test Acc: 0.633
Validation loss decreased (-0.611098 --> -0.633321).  Saving model ...
Epoch: 17 cost time: 1.08510160446167
Epoch: 17, Steps: 12 | Train Loss: 0.871 Vali Loss: 1.137 Vali Acc: 0.633 Test Loss: 1.137 Test Acc: 0.633
Validation loss decreased (-0.633321 --> -0.633322).  Saving model ...
Epoch: 18 cost time: 1.0907199382781982
Epoch: 18, Steps: 12 | Train Loss: 0.838 Vali Loss: 1.081 Vali Acc: 0.661 Test Loss: 1.081 Test Acc: 0.661
Validation loss decreased (-0.633322 --> -0.661100).  Saving model ...
Epoch: 19 cost time: 1.1045324802398682
Epoch: 19, Steps: 12 | Train Loss: 0.781 Vali Loss: 1.014 Vali Acc: 0.689 Test Loss: 1.014 Test Acc: 0.689
Validation loss decreased (-0.661100 --> -0.688879).  Saving model ...
Epoch: 20 cost time: 0.8804373741149902
Epoch: 20, Steps: 12 | Train Loss: 0.692 Vali Loss: 0.962 Vali Acc: 0.722 Test Loss: 0.962 Test Acc: 0.722
Validation loss decreased (-0.688879 --> -0.722213).  Saving model ...
Epoch: 21 cost time: 0.8214201927185059
Epoch: 21, Steps: 12 | Train Loss: 0.703 Vali Loss: 0.907 Vali Acc: 0.733 Test Loss: 0.907 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733324).  Saving model ...
Epoch: 22 cost time: 0.9323103427886963
Epoch: 22, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.870 Vali Acc: 0.744 Test Loss: 0.870 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744436).  Saving model ...
Epoch: 23 cost time: 0.8493204116821289
Epoch: 23, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.832 Vali Acc: 0.750 Test Loss: 0.832 Test Acc: 0.750
Validation loss decreased (-0.744436 --> -0.749992).  Saving model ...
Epoch: 24 cost time: 0.8961384296417236
Epoch: 24, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.799 Vali Acc: 0.750 Test Loss: 0.799 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 25 cost time: 0.8956575393676758
Epoch: 25, Steps: 12 | Train Loss: 0.529 Vali Loss: 0.791 Vali Acc: 0.750 Test Loss: 0.791 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 26 cost time: 0.8261756896972656
Epoch: 26, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.731 Vali Acc: 0.783 Test Loss: 0.731 Test Acc: 0.783
Validation loss decreased (-0.749992 --> -0.783326).  Saving model ...
Epoch: 27 cost time: 0.8635647296905518
Epoch: 27, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.708 Vali Acc: 0.778 Test Loss: 0.708 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7839469909667969
Epoch: 28, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.689 Vali Acc: 0.783 Test Loss: 0.689 Test Acc: 0.783
Validation loss decreased (-0.783326 --> -0.783326).  Saving model ...
Epoch: 29 cost time: 1.1027908325195312
Epoch: 29, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.679 Vali Acc: 0.789 Test Loss: 0.679 Test Acc: 0.789
Validation loss decreased (-0.783326 --> -0.788882).  Saving model ...
Epoch: 30 cost time: 0.7971997261047363
Epoch: 30, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.638 Vali Acc: 0.789 Test Loss: 0.638 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788883).  Saving model ...
Epoch: 31 cost time: 0.8650202751159668
Epoch: 31, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.618 Vali Acc: 0.794 Test Loss: 0.618 Test Acc: 0.794
Validation loss decreased (-0.788883 --> -0.794438).  Saving model ...
Epoch: 32 cost time: 0.8146367073059082
Epoch: 32, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.633 Vali Acc: 0.806 Test Loss: 0.633 Test Acc: 0.806
Validation loss decreased (-0.794438 --> -0.805549).  Saving model ...
Epoch: 33 cost time: 1.0034408569335938
Epoch: 33, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.615 Vali Acc: 0.811 Test Loss: 0.615 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811105).  Saving model ...
Epoch: 34 cost time: 0.9900703430175781
Epoch: 34, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.591 Vali Acc: 0.833 Test Loss: 0.591 Test Acc: 0.833
Validation loss decreased (-0.811105 --> -0.833327).  Saving model ...
Epoch: 35 cost time: 0.894263744354248
Epoch: 35, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.576 Vali Acc: 0.822 Test Loss: 0.576 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8258347511291504
Epoch: 36, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.592 Vali Acc: 0.817 Test Loss: 0.592 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8835465908050537
Epoch: 37, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.563 Vali Acc: 0.867 Test Loss: 0.563 Test Acc: 0.867
Validation loss decreased (-0.833327 --> -0.866661).  Saving model ...
Epoch: 38 cost time: 0.9045917987823486
Epoch: 38, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.573 Vali Acc: 0.844 Test Loss: 0.573 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8836026191711426
Epoch: 39, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.564 Vali Acc: 0.850 Test Loss: 0.564 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8864309787750244
Epoch: 40, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.547 Vali Acc: 0.867 Test Loss: 0.547 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 41 cost time: 0.9143581390380859
Epoch: 41, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.568 Vali Acc: 0.861 Test Loss: 0.568 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9270071983337402
Epoch: 42, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.578 Vali Acc: 0.856 Test Loss: 0.578 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.9762091636657715
Epoch: 43, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.547 Vali Acc: 0.867 Test Loss: 0.547 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.001704216003418
Epoch: 44, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.559 Vali Acc: 0.856 Test Loss: 0.559 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.9141745567321777
Epoch: 45, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.567 Vali Acc: 0.861 Test Loss: 0.567 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.9870996475219727
Epoch: 46, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.559 Vali Acc: 0.844 Test Loss: 0.559 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.9081611633300781
Epoch: 47, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.556 Vali Acc: 0.867 Test Loss: 0.556 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.0554850101470947
Epoch: 48, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.566 Vali Acc: 0.861 Test Loss: 0.566 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.1602389812469482
Epoch: 49, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.562 Vali Acc: 0.872 Test Loss: 0.562 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 50 cost time: 1.0760245323181152
Epoch: 50, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.561 Vali Acc: 0.872 Test Loss: 0.561 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 51 cost time: 1.0090396404266357
Epoch: 51, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.554 Vali Acc: 0.872 Test Loss: 0.554 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 52 cost time: 0.8244502544403076
Epoch: 52, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.619 Vali Acc: 0.872 Test Loss: 0.619 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.0352168083190918
Epoch: 53, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.623 Vali Acc: 0.856 Test Loss: 0.623 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.8990294933319092
Epoch: 54, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.574 Vali Acc: 0.872 Test Loss: 0.574 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.9701287746429443
Epoch: 55, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.575 Vali Acc: 0.867 Test Loss: 0.575 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.9202253818511963
Epoch: 56, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.559 Vali Acc: 0.878 Test Loss: 0.559 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 57 cost time: 0.8631291389465332
Epoch: 57, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.579 Vali Acc: 0.872 Test Loss: 0.579 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.8450534343719482
Epoch: 58, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.619 Vali Acc: 0.867 Test Loss: 0.619 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.9069452285766602
Epoch: 59, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.605 Vali Acc: 0.867 Test Loss: 0.605 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.7860329151153564
Epoch: 60, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.618 Vali Acc: 0.867 Test Loss: 0.618 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.7938997745513916
Epoch: 61, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.610 Vali Acc: 0.861 Test Loss: 0.610 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.0861780643463135
Epoch: 62, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.643 Vali Acc: 0.878 Test Loss: 0.643 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.8936440944671631
Epoch: 63, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.642 Vali Acc: 0.861 Test Loss: 0.642 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 0.87760329246521
Epoch: 64, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.645 Vali Acc: 0.867 Test Loss: 0.645 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 0.9008476734161377
Epoch: 65, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.601 Vali Acc: 0.878 Test Loss: 0.601 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 0.7634351253509521
Epoch: 66, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.596 Vali Acc: 0.872 Test Loss: 0.596 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 411175
model size : 2.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5027661323547363
Epoch: 1, Steps: 12 | Train Loss: 2.848 Vali Loss: 2.780 Vali Acc: 0.044 Test Loss: 2.780 Test Acc: 0.044
Validation loss decreased (inf --> -0.044417).  Saving model ...
Epoch: 2 cost time: 0.9539809226989746
Epoch: 2, Steps: 12 | Train Loss: 2.790 Vali Loss: 2.701 Vali Acc: 0.050 Test Loss: 2.701 Test Acc: 0.050
Validation loss decreased (-0.044417 --> -0.049973).  Saving model ...
Epoch: 3 cost time: 0.9670271873474121
Epoch: 3, Steps: 12 | Train Loss: 2.691 Vali Loss: 2.618 Vali Acc: 0.139 Test Loss: 2.618 Test Acc: 0.139
Validation loss decreased (-0.049973 --> -0.138863).  Saving model ...
Epoch: 4 cost time: 0.9556858539581299
Epoch: 4, Steps: 12 | Train Loss: 2.570 Vali Loss: 2.533 Vali Acc: 0.178 Test Loss: 2.533 Test Acc: 0.178
Validation loss decreased (-0.138863 --> -0.177752).  Saving model ...
Epoch: 5 cost time: 1.0995688438415527
Epoch: 5, Steps: 12 | Train Loss: 2.502 Vali Loss: 2.451 Vali Acc: 0.256 Test Loss: 2.451 Test Acc: 0.256
Validation loss decreased (-0.177752 --> -0.255531).  Saving model ...
Epoch: 6 cost time: 0.8516058921813965
Epoch: 6, Steps: 12 | Train Loss: 2.386 Vali Loss: 2.354 Vali Acc: 0.306 Test Loss: 2.354 Test Acc: 0.306
Validation loss decreased (-0.255531 --> -0.305532).  Saving model ...
Epoch: 7 cost time: 0.9605228900909424
Epoch: 7, Steps: 12 | Train Loss: 2.280 Vali Loss: 2.258 Vali Acc: 0.439 Test Loss: 2.258 Test Acc: 0.439
Validation loss decreased (-0.305532 --> -0.438866).  Saving model ...
Epoch: 8 cost time: 0.8730185031890869
Epoch: 8, Steps: 12 | Train Loss: 2.158 Vali Loss: 2.126 Vali Acc: 0.472 Test Loss: 2.126 Test Acc: 0.472
Validation loss decreased (-0.438866 --> -0.472201).  Saving model ...
Epoch: 9 cost time: 0.92441725730896
Epoch: 9, Steps: 12 | Train Loss: 2.030 Vali Loss: 2.006 Vali Acc: 0.494 Test Loss: 2.006 Test Acc: 0.494
Validation loss decreased (-0.472201 --> -0.494424).  Saving model ...
Epoch: 10 cost time: 1.047593593597412
Epoch: 10, Steps: 12 | Train Loss: 1.817 Vali Loss: 1.865 Vali Acc: 0.544 Test Loss: 1.865 Test Acc: 0.544
Validation loss decreased (-0.494424 --> -0.544426).  Saving model ...
Epoch: 11 cost time: 0.9916417598724365
Epoch: 11, Steps: 12 | Train Loss: 1.665 Vali Loss: 1.729 Vali Acc: 0.561 Test Loss: 1.729 Test Acc: 0.561
Validation loss decreased (-0.544426 --> -0.561094).  Saving model ...
Epoch: 12 cost time: 0.999337911605835
Epoch: 12, Steps: 12 | Train Loss: 1.487 Vali Loss: 1.629 Vali Acc: 0.556 Test Loss: 1.629 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0920517444610596
Epoch: 13, Steps: 12 | Train Loss: 1.342 Vali Loss: 1.518 Vali Acc: 0.594 Test Loss: 1.518 Test Acc: 0.594
Validation loss decreased (-0.561094 --> -0.594429).  Saving model ...
Epoch: 14 cost time: 0.9352922439575195
Epoch: 14, Steps: 12 | Train Loss: 1.279 Vali Loss: 1.421 Vali Acc: 0.617 Test Loss: 1.421 Test Acc: 0.617
Validation loss decreased (-0.594429 --> -0.616652).  Saving model ...
Epoch: 15 cost time: 0.9984095096588135
Epoch: 15, Steps: 12 | Train Loss: 1.148 Vali Loss: 1.342 Vali Acc: 0.594 Test Loss: 1.342 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.944359302520752
Epoch: 16, Steps: 12 | Train Loss: 1.027 Vali Loss: 1.254 Vali Acc: 0.606 Test Loss: 1.254 Test Acc: 0.606
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1989569664001465
Epoch: 17, Steps: 12 | Train Loss: 0.948 Vali Loss: 1.156 Vali Acc: 0.633 Test Loss: 1.156 Test Acc: 0.633
Validation loss decreased (-0.616652 --> -0.633322).  Saving model ...
Epoch: 18 cost time: 1.0916790962219238
Epoch: 18, Steps: 12 | Train Loss: 0.872 Vali Loss: 1.111 Vali Acc: 0.678 Test Loss: 1.111 Test Acc: 0.678
Validation loss decreased (-0.633322 --> -0.677767).  Saving model ...
Epoch: 19 cost time: 0.9758458137512207
Epoch: 19, Steps: 12 | Train Loss: 0.788 Vali Loss: 1.022 Vali Acc: 0.672 Test Loss: 1.022 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2215805053710938
Epoch: 20, Steps: 12 | Train Loss: 0.731 Vali Loss: 0.974 Vali Acc: 0.706 Test Loss: 0.974 Test Acc: 0.706
Validation loss decreased (-0.677767 --> -0.705546).  Saving model ...
Epoch: 21 cost time: 0.9819319248199463
Epoch: 21, Steps: 12 | Train Loss: 0.613 Vali Loss: 0.922 Vali Acc: 0.711 Test Loss: 0.922 Test Acc: 0.711
Validation loss decreased (-0.705546 --> -0.711102).  Saving model ...
Epoch: 22 cost time: 1.0042338371276855
Epoch: 22, Steps: 12 | Train Loss: 0.594 Vali Loss: 0.883 Vali Acc: 0.728 Test Loss: 0.883 Test Acc: 0.728
Validation loss decreased (-0.711102 --> -0.727769).  Saving model ...
Epoch: 23 cost time: 0.9351944923400879
Epoch: 23, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.867 Vali Acc: 0.739 Test Loss: 0.867 Test Acc: 0.739
Validation loss decreased (-0.727769 --> -0.738880).  Saving model ...
Epoch: 24 cost time: 1.2297422885894775
Epoch: 24, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.830 Vali Acc: 0.750 Test Loss: 0.830 Test Acc: 0.750
Validation loss decreased (-0.738880 --> -0.749992).  Saving model ...
Epoch: 25 cost time: 0.9268858432769775
Epoch: 25, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.803 Vali Acc: 0.750 Test Loss: 0.803 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 26 cost time: 1.1290924549102783
Epoch: 26, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.776 Vali Acc: 0.750 Test Loss: 0.776 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 27 cost time: 1.174431324005127
Epoch: 27, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.752 Vali Acc: 0.767 Test Loss: 0.752 Test Acc: 0.767
Validation loss decreased (-0.749992 --> -0.766659).  Saving model ...
Epoch: 28 cost time: 1.2613215446472168
Epoch: 28, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.749 Vali Acc: 0.783 Test Loss: 0.749 Test Acc: 0.783
Validation loss decreased (-0.766659 --> -0.783326).  Saving model ...
Epoch: 29 cost time: 0.963172435760498
Epoch: 29, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.707 Vali Acc: 0.789 Test Loss: 0.707 Test Acc: 0.789
Validation loss decreased (-0.783326 --> -0.788882).  Saving model ...
Epoch: 30 cost time: 1.2673842906951904
Epoch: 30, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.706 Vali Acc: 0.794 Test Loss: 0.706 Test Acc: 0.794
Validation loss decreased (-0.788882 --> -0.794437).  Saving model ...
Epoch: 31 cost time: 0.9596130847930908
Epoch: 31, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.670 Vali Acc: 0.789 Test Loss: 0.670 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9645731449127197
Epoch: 32, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.679 Vali Acc: 0.794 Test Loss: 0.679 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794438).  Saving model ...
Epoch: 33 cost time: 1.0279197692871094
Epoch: 33, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.669 Vali Acc: 0.806 Test Loss: 0.669 Test Acc: 0.806
Validation loss decreased (-0.794438 --> -0.805549).  Saving model ...
Epoch: 34 cost time: 1.0249652862548828
Epoch: 34, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.646 Vali Acc: 0.806 Test Loss: 0.646 Test Acc: 0.806
Validation loss decreased (-0.805549 --> -0.805549).  Saving model ...
Epoch: 35 cost time: 1.1551618576049805
Epoch: 35, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.651 Vali Acc: 0.800 Test Loss: 0.651 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8836302757263184
Epoch: 36, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.624 Vali Acc: 0.806 Test Loss: 0.624 Test Acc: 0.806
Validation loss decreased (-0.805549 --> -0.805549).  Saving model ...
Epoch: 37 cost time: 0.9367742538452148
Epoch: 37, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.624 Vali Acc: 0.811 Test Loss: 0.624 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811105).  Saving model ...
Epoch: 38 cost time: 1.0783672332763672
Epoch: 38, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.627 Vali Acc: 0.828 Test Loss: 0.627 Test Acc: 0.828
Validation loss decreased (-0.811105 --> -0.827772).  Saving model ...
Epoch: 39 cost time: 0.9105856418609619
Epoch: 39, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.618 Vali Acc: 0.833 Test Loss: 0.618 Test Acc: 0.833
Validation loss decreased (-0.827772 --> -0.833327).  Saving model ...
Epoch: 40 cost time: 1.003887414932251
Epoch: 40, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.613 Vali Acc: 0.833 Test Loss: 0.613 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 41 cost time: 1.0599687099456787
Epoch: 41, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.606 Vali Acc: 0.828 Test Loss: 0.606 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.124418020248413
Epoch: 42, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.606 Vali Acc: 0.822 Test Loss: 0.606 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.0052502155303955
Epoch: 43, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.590 Vali Acc: 0.833 Test Loss: 0.590 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 44 cost time: 1.2223896980285645
Epoch: 44, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.584 Vali Acc: 0.839 Test Loss: 0.584 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 45 cost time: 1.1099848747253418
Epoch: 45, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.591 Vali Acc: 0.833 Test Loss: 0.591 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.0942230224609375
Epoch: 46, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.600 Vali Acc: 0.828 Test Loss: 0.600 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.9569950103759766
Epoch: 47, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.581 Vali Acc: 0.839 Test Loss: 0.581 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 48 cost time: 1.155839443206787
Epoch: 48, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.607 Vali Acc: 0.828 Test Loss: 0.607 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.009953498840332
Epoch: 49, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.583 Vali Acc: 0.856 Test Loss: 0.583 Test Acc: 0.856
Validation loss decreased (-0.838883 --> -0.855550).  Saving model ...
Epoch: 50 cost time: 0.9899404048919678
Epoch: 50, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.583 Vali Acc: 0.839 Test Loss: 0.583 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.9539799690246582
Epoch: 51, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.628 Vali Acc: 0.828 Test Loss: 0.628 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.8698930740356445
Epoch: 52, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.605 Vali Acc: 0.844 Test Loss: 0.605 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.0346496105194092
Epoch: 53, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.574 Vali Acc: 0.850 Test Loss: 0.574 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.9900410175323486
Epoch: 54, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.586 Vali Acc: 0.839 Test Loss: 0.586 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.9163894653320312
Epoch: 55, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.589 Vali Acc: 0.844 Test Loss: 0.589 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.9791483879089355
Epoch: 56, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.633 Vali Acc: 0.850 Test Loss: 0.633 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.8315386772155762
Epoch: 57, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.597 Vali Acc: 0.850 Test Loss: 0.597 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 0.923443078994751
Epoch: 58, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.587 Vali Acc: 0.839 Test Loss: 0.587 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.0794575214385986
Epoch: 59, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.586 Vali Acc: 0.861 Test Loss: 0.586 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 60 cost time: 1.4584605693817139
Epoch: 60, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.583 Vali Acc: 0.861 Test Loss: 0.583 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 61 cost time: 1.1648974418640137
Epoch: 61, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.599 Vali Acc: 0.850 Test Loss: 0.599 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.1816182136535645
Epoch: 62, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.597 Vali Acc: 0.856 Test Loss: 0.597 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.9820358753204346
Epoch: 63, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.587 Vali Acc: 0.850 Test Loss: 0.587 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.0310266017913818
Epoch: 64, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.603 Vali Acc: 0.861 Test Loss: 0.603 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 1.070188045501709
Epoch: 65, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.609 Vali Acc: 0.861 Test Loss: 0.609 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 1.1380949020385742
Epoch: 66, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.599 Vali Acc: 0.861 Test Loss: 0.599 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 0.9246892929077148
Epoch: 67, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.612 Vali Acc: 0.867 Test Loss: 0.612 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 68 cost time: 0.8903858661651611
Epoch: 68, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.610 Vali Acc: 0.850 Test Loss: 0.610 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.1253480911254883
Epoch: 69, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.604 Vali Acc: 0.856 Test Loss: 0.604 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.9305765628814697
Epoch: 70, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.610 Vali Acc: 0.861 Test Loss: 0.610 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.9593892097473145
Epoch: 71, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.622 Vali Acc: 0.856 Test Loss: 0.622 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.9317338466644287
Epoch: 72, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.617 Vali Acc: 0.861 Test Loss: 0.617 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 1.0076749324798584
Epoch: 73, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.627 Vali Acc: 0.861 Test Loss: 0.627 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 1.0140905380249023
Epoch: 74, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.620 Vali Acc: 0.861 Test Loss: 0.620 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 0.9291250705718994
Epoch: 75, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.612 Vali Acc: 0.850 Test Loss: 0.612 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 0.9023518562316895
Epoch: 76, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.619 Vali Acc: 0.856 Test Loss: 0.619 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 1.0102064609527588
Epoch: 77, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.632 Vali Acc: 0.856 Test Loss: 0.632 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 312871
model size : 2.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7515792846679688
Epoch: 1, Steps: 12 | Train Loss: 2.908 Vali Loss: 2.920 Vali Acc: 0.089 Test Loss: 2.920 Test Acc: 0.089
Validation loss decreased (inf --> -0.088860).  Saving model ...
Epoch: 2 cost time: 0.9593298435211182
Epoch: 2, Steps: 12 | Train Loss: 2.819 Vali Loss: 2.815 Vali Acc: 0.078 Test Loss: 2.815 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9983766078948975
Epoch: 3, Steps: 12 | Train Loss: 2.774 Vali Loss: 2.719 Vali Acc: 0.133 Test Loss: 2.719 Test Acc: 0.133
Validation loss decreased (-0.088860 --> -0.133306).  Saving model ...
Epoch: 4 cost time: 1.0192499160766602
Epoch: 4, Steps: 12 | Train Loss: 2.680 Vali Loss: 2.632 Vali Acc: 0.183 Test Loss: 2.632 Test Acc: 0.183
Validation loss decreased (-0.133306 --> -0.183307).  Saving model ...
Epoch: 5 cost time: 0.8388972282409668
Epoch: 5, Steps: 12 | Train Loss: 2.567 Vali Loss: 2.552 Vali Acc: 0.161 Test Loss: 2.552 Test Acc: 0.161
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0875828266143799
Epoch: 6, Steps: 12 | Train Loss: 2.449 Vali Loss: 2.467 Vali Acc: 0.289 Test Loss: 2.467 Test Acc: 0.289
Validation loss decreased (-0.183307 --> -0.288864).  Saving model ...
Epoch: 7 cost time: 0.9905989170074463
Epoch: 7, Steps: 12 | Train Loss: 2.381 Vali Loss: 2.376 Vali Acc: 0.372 Test Loss: 2.376 Test Acc: 0.372
Validation loss decreased (-0.288864 --> -0.372198).  Saving model ...
Epoch: 8 cost time: 1.1956892013549805
Epoch: 8, Steps: 12 | Train Loss: 2.255 Vali Loss: 2.272 Vali Acc: 0.417 Test Loss: 2.272 Test Acc: 0.417
Validation loss decreased (-0.372198 --> -0.416644).  Saving model ...
Epoch: 9 cost time: 0.9891624450683594
Epoch: 9, Steps: 12 | Train Loss: 2.092 Vali Loss: 2.140 Vali Acc: 0.483 Test Loss: 2.140 Test Acc: 0.483
Validation loss decreased (-0.416644 --> -0.483312).  Saving model ...
Epoch: 10 cost time: 0.9142985343933105
Epoch: 10, Steps: 12 | Train Loss: 1.917 Vali Loss: 2.008 Vali Acc: 0.511 Test Loss: 2.008 Test Acc: 0.511
Validation loss decreased (-0.483312 --> -0.511091).  Saving model ...
Epoch: 11 cost time: 1.2041449546813965
Epoch: 11, Steps: 12 | Train Loss: 1.677 Vali Loss: 1.869 Vali Acc: 0.561 Test Loss: 1.869 Test Acc: 0.561
Validation loss decreased (-0.511091 --> -0.561092).  Saving model ...
Epoch: 12 cost time: 0.9660205841064453
Epoch: 12, Steps: 12 | Train Loss: 1.554 Vali Loss: 1.736 Vali Acc: 0.539 Test Loss: 1.736 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9965755939483643
Epoch: 13, Steps: 12 | Train Loss: 1.436 Vali Loss: 1.624 Vali Acc: 0.583 Test Loss: 1.624 Test Acc: 0.583
Validation loss decreased (-0.561092 --> -0.583317).  Saving model ...
Epoch: 14 cost time: 0.9757637977600098
Epoch: 14, Steps: 12 | Train Loss: 1.284 Vali Loss: 1.497 Vali Acc: 0.606 Test Loss: 1.497 Test Acc: 0.606
Validation loss decreased (-0.583317 --> -0.605541).  Saving model ...
Epoch: 15 cost time: 0.9440350532531738
Epoch: 15, Steps: 12 | Train Loss: 1.200 Vali Loss: 1.411 Vali Acc: 0.594 Test Loss: 1.411 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.197606086730957
Epoch: 16, Steps: 12 | Train Loss: 1.076 Vali Loss: 1.340 Vali Acc: 0.606 Test Loss: 1.340 Test Acc: 0.606
Validation loss decreased (-0.605541 --> -0.605542).  Saving model ...
Epoch: 17 cost time: 1.0661156177520752
Epoch: 17, Steps: 12 | Train Loss: 0.995 Vali Loss: 1.268 Vali Acc: 0.661 Test Loss: 1.268 Test Acc: 0.661
Validation loss decreased (-0.605542 --> -0.661098).  Saving model ...
Epoch: 18 cost time: 1.082387924194336
Epoch: 18, Steps: 12 | Train Loss: 0.951 Vali Loss: 1.180 Vali Acc: 0.644 Test Loss: 1.180 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3937005996704102
Epoch: 19, Steps: 12 | Train Loss: 0.850 Vali Loss: 1.119 Vali Acc: 0.650 Test Loss: 1.119 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9872274398803711
Epoch: 20, Steps: 12 | Train Loss: 0.765 Vali Loss: 1.071 Vali Acc: 0.706 Test Loss: 1.071 Test Acc: 0.706
Validation loss decreased (-0.661098 --> -0.705545).  Saving model ...
Epoch: 21 cost time: 1.0431241989135742
Epoch: 21, Steps: 12 | Train Loss: 0.763 Vali Loss: 1.015 Vali Acc: 0.700 Test Loss: 1.015 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0031087398529053
Epoch: 22, Steps: 12 | Train Loss: 0.641 Vali Loss: 0.965 Vali Acc: 0.728 Test Loss: 0.965 Test Acc: 0.728
Validation loss decreased (-0.705545 --> -0.727768).  Saving model ...
Epoch: 23 cost time: 0.9504930973052979
Epoch: 23, Steps: 12 | Train Loss: 0.590 Vali Loss: 0.927 Vali Acc: 0.722 Test Loss: 0.927 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9000775814056396
Epoch: 24, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.898 Vali Acc: 0.733 Test Loss: 0.898 Test Acc: 0.733
Validation loss decreased (-0.727768 --> -0.733324).  Saving model ...
Epoch: 25 cost time: 1.042745590209961
Epoch: 25, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.871 Vali Acc: 0.744 Test Loss: 0.871 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744436).  Saving model ...
Epoch: 26 cost time: 0.8582046031951904
Epoch: 26, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.827 Vali Acc: 0.761 Test Loss: 0.827 Test Acc: 0.761
Validation loss decreased (-0.744436 --> -0.761103).  Saving model ...
Epoch: 27 cost time: 0.9388387203216553
Epoch: 27, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.798 Vali Acc: 0.767 Test Loss: 0.798 Test Acc: 0.767
Validation loss decreased (-0.761103 --> -0.766659).  Saving model ...
Epoch: 28 cost time: 0.8582165241241455
Epoch: 28, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.787 Vali Acc: 0.772 Test Loss: 0.787 Test Acc: 0.772
Validation loss decreased (-0.766659 --> -0.772214).  Saving model ...
Epoch: 29 cost time: 0.8032634258270264
Epoch: 29, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.753 Vali Acc: 0.794 Test Loss: 0.753 Test Acc: 0.794
Validation loss decreased (-0.772214 --> -0.794437).  Saving model ...
Epoch: 30 cost time: 0.8922793865203857
Epoch: 30, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.760 Vali Acc: 0.800 Test Loss: 0.760 Test Acc: 0.800
Validation loss decreased (-0.794437 --> -0.799992).  Saving model ...
Epoch: 31 cost time: 0.8892600536346436
Epoch: 31, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.737 Vali Acc: 0.800 Test Loss: 0.737 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 32 cost time: 0.8770608901977539
Epoch: 32, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.708 Vali Acc: 0.811 Test Loss: 0.708 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811104).  Saving model ...
Epoch: 33 cost time: 1.0934345722198486
Epoch: 33, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.666 Vali Acc: 0.822 Test Loss: 0.666 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822216).  Saving model ...
Epoch: 34 cost time: 0.9338195323944092
Epoch: 34, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.696 Vali Acc: 0.800 Test Loss: 0.696 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8969948291778564
Epoch: 35, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.659 Vali Acc: 0.817 Test Loss: 0.659 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.1862671375274658
Epoch: 36, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.654 Vali Acc: 0.844 Test Loss: 0.654 Test Acc: 0.844
Validation loss decreased (-0.822216 --> -0.844438).  Saving model ...
Epoch: 37 cost time: 0.8677637577056885
Epoch: 37, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.658 Vali Acc: 0.833 Test Loss: 0.658 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.952782154083252
Epoch: 38, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.628 Vali Acc: 0.856 Test Loss: 0.628 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855549).  Saving model ...
Epoch: 39 cost time: 0.8764781951904297
Epoch: 39, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.656 Vali Acc: 0.822 Test Loss: 0.656 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.897557258605957
Epoch: 40, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.645 Vali Acc: 0.850 Test Loss: 0.645 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.8385457992553711
Epoch: 41, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.614 Vali Acc: 0.850 Test Loss: 0.614 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.0497851371765137
Epoch: 42, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.645 Vali Acc: 0.844 Test Loss: 0.645 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.1628773212432861
Epoch: 43, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.586 Vali Acc: 0.856 Test Loss: 0.586 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855550).  Saving model ...
Epoch: 44 cost time: 1.1723642349243164
Epoch: 44, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.637 Vali Acc: 0.856 Test Loss: 0.637 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.0362164974212646
Epoch: 45, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.604 Vali Acc: 0.872 Test Loss: 0.604 Test Acc: 0.872
Validation loss decreased (-0.855550 --> -0.872216).  Saving model ...
Epoch: 46 cost time: 1.0187830924987793
Epoch: 46, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.592 Vali Acc: 0.872 Test Loss: 0.592 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872216).  Saving model ...
Epoch: 47 cost time: 0.8428871631622314
Epoch: 47, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.618 Vali Acc: 0.872 Test Loss: 0.618 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8419630527496338
Epoch: 48, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.616 Vali Acc: 0.856 Test Loss: 0.616 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.997957706451416
Epoch: 49, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.598 Vali Acc: 0.872 Test Loss: 0.598 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.9784190654754639
Epoch: 50, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.604 Vali Acc: 0.883 Test Loss: 0.604 Test Acc: 0.883
Validation loss decreased (-0.872216 --> -0.883327).  Saving model ...
Epoch: 51 cost time: 0.9180948734283447
Epoch: 51, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.605 Vali Acc: 0.878 Test Loss: 0.605 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.0774321556091309
Epoch: 52, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.612 Vali Acc: 0.872 Test Loss: 0.612 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.9758286476135254
Epoch: 53, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.630 Vali Acc: 0.867 Test Loss: 0.630 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.9894018173217773
Epoch: 54, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.625 Vali Acc: 0.878 Test Loss: 0.625 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.9372742176055908
Epoch: 55, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.645 Vali Acc: 0.878 Test Loss: 0.645 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.0078518390655518
Epoch: 56, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.631 Vali Acc: 0.878 Test Loss: 0.631 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.9342985153198242
Epoch: 57, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.620 Vali Acc: 0.872 Test Loss: 0.620 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.9138150215148926
Epoch: 58, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.607 Vali Acc: 0.883 Test Loss: 0.607 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.8818681240081787
Epoch: 59, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.649 Vali Acc: 0.878 Test Loss: 0.649 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.1299564838409424
Epoch: 60, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.642 Vali Acc: 0.878 Test Loss: 0.642 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 312615
model size : 2.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.482461929321289
Epoch: 1, Steps: 12 | Train Loss: 2.836 Vali Loss: 2.758 Vali Acc: 0.039 Test Loss: 2.758 Test Acc: 0.039
Validation loss decreased (inf --> -0.038861).  Saving model ...
Epoch: 2 cost time: 0.9766955375671387
Epoch: 2, Steps: 12 | Train Loss: 2.797 Vali Loss: 2.682 Vali Acc: 0.050 Test Loss: 2.682 Test Acc: 0.050
Validation loss decreased (-0.038861 --> -0.049973).  Saving model ...
Epoch: 3 cost time: 0.9559323787689209
Epoch: 3, Steps: 12 | Train Loss: 2.677 Vali Loss: 2.604 Vali Acc: 0.178 Test Loss: 2.604 Test Acc: 0.178
Validation loss decreased (-0.049973 --> -0.177752).  Saving model ...
Epoch: 4 cost time: 0.8157720565795898
Epoch: 4, Steps: 12 | Train Loss: 2.570 Vali Loss: 2.523 Vali Acc: 0.272 Test Loss: 2.523 Test Acc: 0.272
Validation loss decreased (-0.177752 --> -0.272197).  Saving model ...
Epoch: 5 cost time: 0.8772752285003662
Epoch: 5, Steps: 12 | Train Loss: 2.495 Vali Loss: 2.437 Vali Acc: 0.367 Test Loss: 2.437 Test Acc: 0.367
Validation loss decreased (-0.272197 --> -0.366642).  Saving model ...
Epoch: 6 cost time: 0.9427270889282227
Epoch: 6, Steps: 12 | Train Loss: 2.381 Vali Loss: 2.339 Vali Acc: 0.400 Test Loss: 2.339 Test Acc: 0.400
Validation loss decreased (-0.366642 --> -0.399977).  Saving model ...
Epoch: 7 cost time: 0.7504618167877197
Epoch: 7, Steps: 12 | Train Loss: 2.263 Vali Loss: 2.233 Vali Acc: 0.489 Test Loss: 2.233 Test Acc: 0.489
Validation loss decreased (-0.399977 --> -0.488867).  Saving model ...
Epoch: 8 cost time: 0.8465933799743652
Epoch: 8, Steps: 12 | Train Loss: 2.117 Vali Loss: 2.114 Vali Acc: 0.494 Test Loss: 2.114 Test Acc: 0.494
Validation loss decreased (-0.488867 --> -0.494423).  Saving model ...
Epoch: 9 cost time: 0.8196308612823486
Epoch: 9, Steps: 12 | Train Loss: 1.957 Vali Loss: 1.987 Vali Acc: 0.539 Test Loss: 1.987 Test Acc: 0.539
Validation loss decreased (-0.494423 --> -0.538869).  Saving model ...
Epoch: 10 cost time: 0.829425573348999
Epoch: 10, Steps: 12 | Train Loss: 1.809 Vali Loss: 1.847 Vali Acc: 0.600 Test Loss: 1.847 Test Acc: 0.600
Validation loss decreased (-0.538869 --> -0.599982).  Saving model ...
Epoch: 11 cost time: 0.983046293258667
Epoch: 11, Steps: 12 | Train Loss: 1.643 Vali Loss: 1.715 Vali Acc: 0.600 Test Loss: 1.715 Test Acc: 0.600
Validation loss decreased (-0.599982 --> -0.599983).  Saving model ...
Epoch: 12 cost time: 0.8705911636352539
Epoch: 12, Steps: 12 | Train Loss: 1.491 Vali Loss: 1.583 Vali Acc: 0.622 Test Loss: 1.583 Test Acc: 0.622
Validation loss decreased (-0.599983 --> -0.622206).  Saving model ...
Epoch: 13 cost time: 0.9459614753723145
Epoch: 13, Steps: 12 | Train Loss: 1.354 Vali Loss: 1.485 Vali Acc: 0.622 Test Loss: 1.485 Test Acc: 0.622
Validation loss decreased (-0.622206 --> -0.622207).  Saving model ...
Epoch: 14 cost time: 1.0041399002075195
Epoch: 14, Steps: 12 | Train Loss: 1.229 Vali Loss: 1.372 Vali Acc: 0.628 Test Loss: 1.372 Test Acc: 0.628
Validation loss decreased (-0.622207 --> -0.627764).  Saving model ...
Epoch: 15 cost time: 0.840111494064331
Epoch: 15, Steps: 12 | Train Loss: 1.088 Vali Loss: 1.279 Vali Acc: 0.656 Test Loss: 1.279 Test Acc: 0.656
Validation loss decreased (-0.627764 --> -0.655543).  Saving model ...
Epoch: 16 cost time: 0.9277617931365967
Epoch: 16, Steps: 12 | Train Loss: 1.013 Vali Loss: 1.201 Vali Acc: 0.644 Test Loss: 1.201 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9500925540924072
Epoch: 17, Steps: 12 | Train Loss: 0.910 Vali Loss: 1.117 Vali Acc: 0.639 Test Loss: 1.117 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7761948108673096
Epoch: 18, Steps: 12 | Train Loss: 0.854 Vali Loss: 1.046 Vali Acc: 0.706 Test Loss: 1.046 Test Acc: 0.706
Validation loss decreased (-0.655543 --> -0.705545).  Saving model ...
Epoch: 19 cost time: 0.7944607734680176
Epoch: 19, Steps: 12 | Train Loss: 0.791 Vali Loss: 0.996 Vali Acc: 0.728 Test Loss: 0.996 Test Acc: 0.728
Validation loss decreased (-0.705545 --> -0.727768).  Saving model ...
Epoch: 20 cost time: 0.9253244400024414
Epoch: 20, Steps: 12 | Train Loss: 0.708 Vali Loss: 0.924 Vali Acc: 0.717 Test Loss: 0.924 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.869351863861084
Epoch: 21, Steps: 12 | Train Loss: 0.669 Vali Loss: 0.883 Vali Acc: 0.733 Test Loss: 0.883 Test Acc: 0.733
Validation loss decreased (-0.727768 --> -0.733325).  Saving model ...
Epoch: 22 cost time: 1.0507733821868896
Epoch: 22, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.860 Vali Acc: 0.733 Test Loss: 0.860 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733325).  Saving model ...
Epoch: 23 cost time: 0.963493824005127
Epoch: 23, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.814 Vali Acc: 0.750 Test Loss: 0.814 Test Acc: 0.750
Validation loss decreased (-0.733325 --> -0.749992).  Saving model ...
Epoch: 24 cost time: 1.1969997882843018
Epoch: 24, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.790 Vali Acc: 0.761 Test Loss: 0.790 Test Acc: 0.761
Validation loss decreased (-0.749992 --> -0.761103).  Saving model ...
Epoch: 25 cost time: 0.9188942909240723
Epoch: 25, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.730 Vali Acc: 0.811 Test Loss: 0.730 Test Acc: 0.811
Validation loss decreased (-0.761103 --> -0.811104).  Saving model ...
Epoch: 26 cost time: 0.8226559162139893
Epoch: 26, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.715 Vali Acc: 0.811 Test Loss: 0.715 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 27 cost time: 0.8113231658935547
Epoch: 27, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.713 Vali Acc: 0.806 Test Loss: 0.713 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8699793815612793
Epoch: 28, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.694 Vali Acc: 0.794 Test Loss: 0.694 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9106044769287109
Epoch: 29, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.682 Vali Acc: 0.828 Test Loss: 0.682 Test Acc: 0.828
Validation loss decreased (-0.811104 --> -0.827771).  Saving model ...
Epoch: 30 cost time: 0.9928548336029053
Epoch: 30, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.642 Vali Acc: 0.839 Test Loss: 0.642 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838882).  Saving model ...
Epoch: 31 cost time: 0.9647095203399658
Epoch: 31, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.621 Vali Acc: 0.833 Test Loss: 0.621 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.880695104598999
Epoch: 32, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.632 Vali Acc: 0.844 Test Loss: 0.632 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844438).  Saving model ...
Epoch: 33 cost time: 0.9471728801727295
Epoch: 33, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.612 Vali Acc: 0.844 Test Loss: 0.612 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 34 cost time: 0.8280813694000244
Epoch: 34, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.598 Vali Acc: 0.844 Test Loss: 0.598 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 35 cost time: 0.7199742794036865
Epoch: 35, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.574 Vali Acc: 0.850 Test Loss: 0.574 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 36 cost time: 0.7826006412506104
Epoch: 36, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.592 Vali Acc: 0.850 Test Loss: 0.592 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8131546974182129
Epoch: 37, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.552 Vali Acc: 0.856 Test Loss: 0.552 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 38 cost time: 0.8325068950653076
Epoch: 38, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.572 Vali Acc: 0.856 Test Loss: 0.572 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9599831104278564
Epoch: 39, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.585 Vali Acc: 0.861 Test Loss: 0.585 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 40 cost time: 1.0514698028564453
Epoch: 40, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.547 Vali Acc: 0.867 Test Loss: 0.547 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 41 cost time: 0.9514985084533691
Epoch: 41, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.563 Vali Acc: 0.856 Test Loss: 0.563 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9526646137237549
Epoch: 42, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.544 Vali Acc: 0.872 Test Loss: 0.544 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 43 cost time: 0.938607931137085
Epoch: 43, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.550 Vali Acc: 0.878 Test Loss: 0.550 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 44 cost time: 0.7916483879089355
Epoch: 44, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.523 Vali Acc: 0.878 Test Loss: 0.523 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877773).  Saving model ...
Epoch: 45 cost time: 1.0132274627685547
Epoch: 45, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.553 Vali Acc: 0.867 Test Loss: 0.553 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7902820110321045
Epoch: 46, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.582 Vali Acc: 0.861 Test Loss: 0.582 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.7880234718322754
Epoch: 47, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.566 Vali Acc: 0.867 Test Loss: 0.566 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.9592263698577881
Epoch: 48, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.565 Vali Acc: 0.867 Test Loss: 0.565 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.0353655815124512
Epoch: 49, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.564 Vali Acc: 0.883 Test Loss: 0.564 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883328).  Saving model ...
Epoch: 50 cost time: 1.0013055801391602
Epoch: 50, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.552 Vali Acc: 0.883 Test Loss: 0.552 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883328).  Saving model ...
Epoch: 51 cost time: 0.837486743927002
Epoch: 51, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.600 Vali Acc: 0.872 Test Loss: 0.600 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.8084979057312012
Epoch: 52, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.576 Vali Acc: 0.878 Test Loss: 0.576 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.7576837539672852
Epoch: 53, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.581 Vali Acc: 0.878 Test Loss: 0.581 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.9477553367614746
Epoch: 54, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.608 Vali Acc: 0.878 Test Loss: 0.608 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.7460231781005859
Epoch: 55, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.595 Vali Acc: 0.883 Test Loss: 0.595 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.7609834671020508
Epoch: 56, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.575 Vali Acc: 0.867 Test Loss: 0.575 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.8209030628204346
Epoch: 57, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.571 Vali Acc: 0.883 Test Loss: 0.571 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.788031816482544
Epoch: 58, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.542 Vali Acc: 0.883 Test Loss: 0.542 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883328).  Saving model ...
Epoch: 59 cost time: 0.8043918609619141
Epoch: 59, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.623 Vali Acc: 0.867 Test Loss: 0.623 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.800595760345459
Epoch: 60, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.594 Vali Acc: 0.889 Test Loss: 0.594 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888883).  Saving model ...
Epoch: 61 cost time: 0.8095247745513916
Epoch: 61, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.554 Vali Acc: 0.883 Test Loss: 0.554 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.8470945358276367
Epoch: 62, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.586 Vali Acc: 0.878 Test Loss: 0.586 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.8010663986206055
Epoch: 63, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.572 Vali Acc: 0.878 Test Loss: 0.572 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.8127462863922119
Epoch: 64, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.571 Vali Acc: 0.883 Test Loss: 0.571 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.8289675712585449
Epoch: 65, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.609 Vali Acc: 0.872 Test Loss: 0.609 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.8767728805541992
Epoch: 66, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.603 Vali Acc: 0.883 Test Loss: 0.603 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 0.8415188789367676
Epoch: 67, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.585 Vali Acc: 0.883 Test Loss: 0.585 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 0.7329270839691162
Epoch: 68, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.637 Vali Acc: 0.861 Test Loss: 0.637 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 1.0461020469665527
Epoch: 69, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.638 Vali Acc: 0.878 Test Loss: 0.638 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 0.9545416831970215
Epoch: 70, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.627 Vali Acc: 0.883 Test Loss: 0.627 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 312359
model size : 2.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4395439624786377
Epoch: 1, Steps: 12 | Train Loss: 2.834 Vali Loss: 2.838 Vali Acc: 0.067 Test Loss: 2.838 Test Acc: 0.067
Validation loss decreased (inf --> -0.066638).  Saving model ...
Epoch: 2 cost time: 0.8811922073364258
Epoch: 2, Steps: 12 | Train Loss: 2.759 Vali Loss: 2.762 Vali Acc: 0.072 Test Loss: 2.762 Test Acc: 0.072
Validation loss decreased (-0.066638 --> -0.072195).  Saving model ...
Epoch: 3 cost time: 0.8452770709991455
Epoch: 3, Steps: 12 | Train Loss: 2.726 Vali Loss: 2.695 Vali Acc: 0.122 Test Loss: 2.695 Test Acc: 0.122
Validation loss decreased (-0.072195 --> -0.122195).  Saving model ...
Epoch: 4 cost time: 0.8945581912994385
Epoch: 4, Steps: 12 | Train Loss: 2.621 Vali Loss: 2.625 Vali Acc: 0.217 Test Loss: 2.625 Test Acc: 0.217
Validation loss decreased (-0.122195 --> -0.216640).  Saving model ...
Epoch: 5 cost time: 0.7964704036712646
Epoch: 5, Steps: 12 | Train Loss: 2.513 Vali Loss: 2.550 Vali Acc: 0.261 Test Loss: 2.550 Test Acc: 0.261
Validation loss decreased (-0.216640 --> -0.261086).  Saving model ...
Epoch: 6 cost time: 0.7847409248352051
Epoch: 6, Steps: 12 | Train Loss: 2.391 Vali Loss: 2.463 Vali Acc: 0.283 Test Loss: 2.463 Test Acc: 0.283
Validation loss decreased (-0.261086 --> -0.283309).  Saving model ...
Epoch: 7 cost time: 0.9092509746551514
Epoch: 7, Steps: 12 | Train Loss: 2.338 Vali Loss: 2.359 Vali Acc: 0.372 Test Loss: 2.359 Test Acc: 0.372
Validation loss decreased (-0.283309 --> -0.372199).  Saving model ...
Epoch: 8 cost time: 0.8166146278381348
Epoch: 8, Steps: 12 | Train Loss: 2.220 Vali Loss: 2.237 Vali Acc: 0.472 Test Loss: 2.237 Test Acc: 0.472
Validation loss decreased (-0.372199 --> -0.472200).  Saving model ...
Epoch: 9 cost time: 0.8737049102783203
Epoch: 9, Steps: 12 | Train Loss: 2.027 Vali Loss: 2.122 Vali Acc: 0.500 Test Loss: 2.122 Test Acc: 0.500
Validation loss decreased (-0.472200 --> -0.499979).  Saving model ...
Epoch: 10 cost time: 0.8966400623321533
Epoch: 10, Steps: 12 | Train Loss: 1.894 Vali Loss: 1.989 Vali Acc: 0.544 Test Loss: 1.989 Test Acc: 0.544
Validation loss decreased (-0.499979 --> -0.544425).  Saving model ...
Epoch: 11 cost time: 0.8362066745758057
Epoch: 11, Steps: 12 | Train Loss: 1.766 Vali Loss: 1.867 Vali Acc: 0.561 Test Loss: 1.867 Test Acc: 0.561
Validation loss decreased (-0.544425 --> -0.561092).  Saving model ...
Epoch: 12 cost time: 0.8514282703399658
Epoch: 12, Steps: 12 | Train Loss: 1.610 Vali Loss: 1.751 Vali Acc: 0.550 Test Loss: 1.751 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9029765129089355
Epoch: 13, Steps: 12 | Train Loss: 1.446 Vali Loss: 1.605 Vali Acc: 0.594 Test Loss: 1.605 Test Acc: 0.594
Validation loss decreased (-0.561092 --> -0.594428).  Saving model ...
Epoch: 14 cost time: 0.8246963024139404
Epoch: 14, Steps: 12 | Train Loss: 1.301 Vali Loss: 1.493 Vali Acc: 0.600 Test Loss: 1.493 Test Acc: 0.600
Validation loss decreased (-0.594428 --> -0.599985).  Saving model ...
Epoch: 15 cost time: 0.8301839828491211
Epoch: 15, Steps: 12 | Train Loss: 1.163 Vali Loss: 1.396 Vali Acc: 0.606 Test Loss: 1.396 Test Acc: 0.606
Validation loss decreased (-0.599985 --> -0.605542).  Saving model ...
Epoch: 16 cost time: 0.9320619106292725
Epoch: 16, Steps: 12 | Train Loss: 1.066 Vali Loss: 1.289 Vali Acc: 0.628 Test Loss: 1.289 Test Acc: 0.628
Validation loss decreased (-0.605542 --> -0.627765).  Saving model ...
Epoch: 17 cost time: 0.9503777027130127
Epoch: 17, Steps: 12 | Train Loss: 0.959 Vali Loss: 1.198 Vali Acc: 0.633 Test Loss: 1.198 Test Acc: 0.633
Validation loss decreased (-0.627765 --> -0.633321).  Saving model ...
Epoch: 18 cost time: 0.9671518802642822
Epoch: 18, Steps: 12 | Train Loss: 0.875 Vali Loss: 1.119 Vali Acc: 0.694 Test Loss: 1.119 Test Acc: 0.694
Validation loss decreased (-0.633321 --> -0.694433).  Saving model ...
Epoch: 19 cost time: 0.9276304244995117
Epoch: 19, Steps: 12 | Train Loss: 0.828 Vali Loss: 1.045 Vali Acc: 0.689 Test Loss: 1.045 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0456154346466064
Epoch: 20, Steps: 12 | Train Loss: 0.714 Vali Loss: 0.987 Vali Acc: 0.706 Test Loss: 0.987 Test Acc: 0.706
Validation loss decreased (-0.694433 --> -0.705546).  Saving model ...
Epoch: 21 cost time: 0.9985396862030029
Epoch: 21, Steps: 12 | Train Loss: 0.671 Vali Loss: 0.929 Vali Acc: 0.706 Test Loss: 0.929 Test Acc: 0.706
Validation loss decreased (-0.705546 --> -0.705546).  Saving model ...
Epoch: 22 cost time: 1.080589771270752
Epoch: 22, Steps: 12 | Train Loss: 0.574 Vali Loss: 0.891 Vali Acc: 0.711 Test Loss: 0.891 Test Acc: 0.711
Validation loss decreased (-0.705546 --> -0.711102).  Saving model ...
Epoch: 23 cost time: 0.9044439792633057
Epoch: 23, Steps: 12 | Train Loss: 0.541 Vali Loss: 0.849 Vali Acc: 0.744 Test Loss: 0.849 Test Acc: 0.744
Validation loss decreased (-0.711102 --> -0.744436).  Saving model ...
Epoch: 24 cost time: 0.8210957050323486
Epoch: 24, Steps: 12 | Train Loss: 0.534 Vali Loss: 0.807 Vali Acc: 0.772 Test Loss: 0.807 Test Acc: 0.772
Validation loss decreased (-0.744436 --> -0.772214).  Saving model ...
Epoch: 25 cost time: 0.9706878662109375
Epoch: 25, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.784 Vali Acc: 0.761 Test Loss: 0.784 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8286104202270508
Epoch: 26, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.767 Vali Acc: 0.778 Test Loss: 0.767 Test Acc: 0.778
Validation loss decreased (-0.772214 --> -0.777770).  Saving model ...
Epoch: 27 cost time: 1.0924909114837646
Epoch: 27, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.730 Vali Acc: 0.778 Test Loss: 0.730 Test Acc: 0.778
Validation loss decreased (-0.777770 --> -0.777770).  Saving model ...
Epoch: 28 cost time: 1.0053725242614746
Epoch: 28, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.711 Vali Acc: 0.800 Test Loss: 0.711 Test Acc: 0.800
Validation loss decreased (-0.777770 --> -0.799993).  Saving model ...
Epoch: 29 cost time: 0.9086112976074219
Epoch: 29, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.665 Vali Acc: 0.800 Test Loss: 0.665 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 30 cost time: 0.9303159713745117
Epoch: 30, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.662 Vali Acc: 0.811 Test Loss: 0.662 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811104).  Saving model ...
Epoch: 31 cost time: 0.9965817928314209
Epoch: 31, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.632 Vali Acc: 0.833 Test Loss: 0.632 Test Acc: 0.833
Validation loss decreased (-0.811104 --> -0.833327).  Saving model ...
Epoch: 32 cost time: 0.907442569732666
Epoch: 32, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.644 Vali Acc: 0.844 Test Loss: 0.644 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844438).  Saving model ...
Epoch: 33 cost time: 0.9187924861907959
Epoch: 33, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.581 Vali Acc: 0.856 Test Loss: 0.581 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855550).  Saving model ...
Epoch: 34 cost time: 0.9751009941101074
Epoch: 34, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.620 Vali Acc: 0.817 Test Loss: 0.620 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9418239593505859
Epoch: 35, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.589 Vali Acc: 0.850 Test Loss: 0.589 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.871100664138794
Epoch: 36, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.584 Vali Acc: 0.850 Test Loss: 0.584 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9344291687011719
Epoch: 37, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.571 Vali Acc: 0.850 Test Loss: 0.571 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.1197178363800049
Epoch: 38, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.557 Vali Acc: 0.894 Test Loss: 0.557 Test Acc: 0.894
Validation loss decreased (-0.855550 --> -0.894439).  Saving model ...
Epoch: 39 cost time: 0.8488974571228027
Epoch: 39, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.560 Vali Acc: 0.856 Test Loss: 0.560 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.01029372215271
Epoch: 40, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.578 Vali Acc: 0.850 Test Loss: 0.578 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9883372783660889
Epoch: 41, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.570 Vali Acc: 0.867 Test Loss: 0.570 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.9098515510559082
Epoch: 42, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.548 Vali Acc: 0.883 Test Loss: 0.548 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.8241183757781982
Epoch: 43, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.560 Vali Acc: 0.878 Test Loss: 0.560 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.9309041500091553
Epoch: 44, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.561 Vali Acc: 0.867 Test Loss: 0.561 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.9308617115020752
Epoch: 45, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.557 Vali Acc: 0.872 Test Loss: 0.557 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.0133106708526611
Epoch: 46, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.592 Vali Acc: 0.872 Test Loss: 0.592 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.964677095413208
Epoch: 47, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.603 Vali Acc: 0.850 Test Loss: 0.603 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.9146773815155029
Epoch: 48, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.591 Vali Acc: 0.889 Test Loss: 0.591 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 312103
model size : 2.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4598309993743896
Epoch: 1, Steps: 12 | Train Loss: 2.769 Vali Loss: 2.730 Vali Acc: 0.100 Test Loss: 2.730 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 0.9786539077758789
Epoch: 2, Steps: 12 | Train Loss: 2.735 Vali Loss: 2.670 Vali Acc: 0.122 Test Loss: 2.670 Test Acc: 0.122
Validation loss decreased (-0.099973 --> -0.122196).  Saving model ...
Epoch: 3 cost time: 0.9869546890258789
Epoch: 3, Steps: 12 | Train Loss: 2.650 Vali Loss: 2.611 Vali Acc: 0.144 Test Loss: 2.611 Test Acc: 0.144
Validation loss decreased (-0.122196 --> -0.144418).  Saving model ...
Epoch: 4 cost time: 0.9618136882781982
Epoch: 4, Steps: 12 | Train Loss: 2.562 Vali Loss: 2.546 Vali Acc: 0.189 Test Loss: 2.546 Test Acc: 0.189
Validation loss decreased (-0.144418 --> -0.188863).  Saving model ...
Epoch: 5 cost time: 0.7740082740783691
Epoch: 5, Steps: 12 | Train Loss: 2.441 Vali Loss: 2.467 Vali Acc: 0.283 Test Loss: 2.467 Test Acc: 0.283
Validation loss decreased (-0.188863 --> -0.283309).  Saving model ...
Epoch: 6 cost time: 0.9684481620788574
Epoch: 6, Steps: 12 | Train Loss: 2.361 Vali Loss: 2.381 Vali Acc: 0.350 Test Loss: 2.381 Test Acc: 0.350
Validation loss decreased (-0.283309 --> -0.349976).  Saving model ...
Epoch: 7 cost time: 0.8799049854278564
Epoch: 7, Steps: 12 | Train Loss: 2.294 Vali Loss: 2.284 Vali Acc: 0.383 Test Loss: 2.284 Test Acc: 0.383
Validation loss decreased (-0.349976 --> -0.383310).  Saving model ...
Epoch: 8 cost time: 0.8309292793273926
Epoch: 8, Steps: 12 | Train Loss: 2.135 Vali Loss: 2.175 Vali Acc: 0.444 Test Loss: 2.175 Test Acc: 0.444
Validation loss decreased (-0.383310 --> -0.444423).  Saving model ...
Epoch: 9 cost time: 0.8570156097412109
Epoch: 9, Steps: 12 | Train Loss: 2.004 Vali Loss: 2.069 Vali Acc: 0.472 Test Loss: 2.069 Test Acc: 0.472
Validation loss decreased (-0.444423 --> -0.472202).  Saving model ...
Epoch: 10 cost time: 0.9027185440063477
Epoch: 10, Steps: 12 | Train Loss: 1.871 Vali Loss: 1.950 Vali Acc: 0.533 Test Loss: 1.950 Test Acc: 0.533
Validation loss decreased (-0.472202 --> -0.533314).  Saving model ...
Epoch: 11 cost time: 0.9942467212677002
Epoch: 11, Steps: 12 | Train Loss: 1.768 Vali Loss: 1.834 Vali Acc: 0.567 Test Loss: 1.834 Test Acc: 0.567
Validation loss decreased (-0.533314 --> -0.566648).  Saving model ...
Epoch: 12 cost time: 0.8579654693603516
Epoch: 12, Steps: 12 | Train Loss: 1.612 Vali Loss: 1.726 Vali Acc: 0.556 Test Loss: 1.726 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9303817749023438
Epoch: 13, Steps: 12 | Train Loss: 1.475 Vali Loss: 1.626 Vali Acc: 0.567 Test Loss: 1.626 Test Acc: 0.567
Validation loss decreased (-0.566648 --> -0.566650).  Saving model ...
Epoch: 14 cost time: 0.9691190719604492
Epoch: 14, Steps: 12 | Train Loss: 1.326 Vali Loss: 1.516 Vali Acc: 0.622 Test Loss: 1.516 Test Acc: 0.622
Validation loss decreased (-0.566650 --> -0.622207).  Saving model ...
Epoch: 15 cost time: 0.8406951427459717
Epoch: 15, Steps: 12 | Train Loss: 1.234 Vali Loss: 1.423 Vali Acc: 0.583 Test Loss: 1.423 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9169270992279053
Epoch: 16, Steps: 12 | Train Loss: 1.120 Vali Loss: 1.321 Vali Acc: 0.622 Test Loss: 1.321 Test Acc: 0.622
Validation loss decreased (-0.622207 --> -0.622209).  Saving model ...
Epoch: 17 cost time: 0.742896556854248
Epoch: 17, Steps: 12 | Train Loss: 1.006 Vali Loss: 1.247 Vali Acc: 0.633 Test Loss: 1.247 Test Acc: 0.633
Validation loss decreased (-0.622209 --> -0.633321).  Saving model ...
Epoch: 18 cost time: 0.8444180488586426
Epoch: 18, Steps: 12 | Train Loss: 0.916 Vali Loss: 1.169 Vali Acc: 0.639 Test Loss: 1.169 Test Acc: 0.639
Validation loss decreased (-0.633321 --> -0.638877).  Saving model ...
Epoch: 19 cost time: 0.772097110748291
Epoch: 19, Steps: 12 | Train Loss: 0.851 Vali Loss: 1.135 Vali Acc: 0.633 Test Loss: 1.135 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8525190353393555
Epoch: 20, Steps: 12 | Train Loss: 0.798 Vali Loss: 1.070 Vali Acc: 0.672 Test Loss: 1.070 Test Acc: 0.672
Validation loss decreased (-0.638877 --> -0.672212).  Saving model ...
Epoch: 21 cost time: 0.8156991004943848
Epoch: 21, Steps: 12 | Train Loss: 0.682 Vali Loss: 1.039 Vali Acc: 0.683 Test Loss: 1.039 Test Acc: 0.683
Validation loss decreased (-0.672212 --> -0.683323).  Saving model ...
Epoch: 22 cost time: 0.8630802631378174
Epoch: 22, Steps: 12 | Train Loss: 0.708 Vali Loss: 0.986 Vali Acc: 0.700 Test Loss: 0.986 Test Acc: 0.700
Validation loss decreased (-0.683323 --> -0.699990).  Saving model ...
Epoch: 23 cost time: 0.8987753391265869
Epoch: 23, Steps: 12 | Train Loss: 0.644 Vali Loss: 0.932 Vali Acc: 0.717 Test Loss: 0.932 Test Acc: 0.717
Validation loss decreased (-0.699990 --> -0.716657).  Saving model ...
Epoch: 24 cost time: 0.7729275226593018
Epoch: 24, Steps: 12 | Train Loss: 0.624 Vali Loss: 0.917 Vali Acc: 0.722 Test Loss: 0.917 Test Acc: 0.722
Validation loss decreased (-0.716657 --> -0.722213).  Saving model ...
Epoch: 25 cost time: 0.912322998046875
Epoch: 25, Steps: 12 | Train Loss: 0.587 Vali Loss: 0.884 Vali Acc: 0.722 Test Loss: 0.884 Test Acc: 0.722
Validation loss decreased (-0.722213 --> -0.722213).  Saving model ...
Epoch: 26 cost time: 0.8002140522003174
Epoch: 26, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.842 Vali Acc: 0.733 Test Loss: 0.842 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733325).  Saving model ...
Epoch: 27 cost time: 0.8221080303192139
Epoch: 27, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.818 Vali Acc: 0.744 Test Loss: 0.818 Test Acc: 0.744
Validation loss decreased (-0.733325 --> -0.744436).  Saving model ...
Epoch: 28 cost time: 0.8838591575622559
Epoch: 28, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.802 Vali Acc: 0.739 Test Loss: 0.802 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7775521278381348
Epoch: 29, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.756 Vali Acc: 0.750 Test Loss: 0.756 Test Acc: 0.750
Validation loss decreased (-0.744436 --> -0.749992).  Saving model ...
Epoch: 30 cost time: 0.9895508289337158
Epoch: 30, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.746 Vali Acc: 0.767 Test Loss: 0.746 Test Acc: 0.767
Validation loss decreased (-0.749992 --> -0.766659).  Saving model ...
Epoch: 31 cost time: 0.8860688209533691
Epoch: 31, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.719 Vali Acc: 0.772 Test Loss: 0.719 Test Acc: 0.772
Validation loss decreased (-0.766659 --> -0.772215).  Saving model ...
Epoch: 32 cost time: 0.9373490810394287
Epoch: 32, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.726 Vali Acc: 0.783 Test Loss: 0.726 Test Acc: 0.783
Validation loss decreased (-0.772215 --> -0.783326).  Saving model ...
Epoch: 33 cost time: 0.869330883026123
Epoch: 33, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.715 Vali Acc: 0.789 Test Loss: 0.715 Test Acc: 0.789
Validation loss decreased (-0.783326 --> -0.788882).  Saving model ...
Epoch: 34 cost time: 0.909111499786377
Epoch: 34, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.700 Vali Acc: 0.789 Test Loss: 0.700 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 35 cost time: 0.9814229011535645
Epoch: 35, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.681 Vali Acc: 0.822 Test Loss: 0.681 Test Acc: 0.822
Validation loss decreased (-0.788882 --> -0.822215).  Saving model ...
Epoch: 36 cost time: 0.8528032302856445
Epoch: 36, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.695 Vali Acc: 0.789 Test Loss: 0.695 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7791893482208252
Epoch: 37, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.694 Vali Acc: 0.811 Test Loss: 0.694 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9721353054046631
Epoch: 38, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.692 Vali Acc: 0.794 Test Loss: 0.692 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.8068363666534424
Epoch: 39, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.673 Vali Acc: 0.817 Test Loss: 0.673 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.032726526260376
Epoch: 40, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.648 Vali Acc: 0.811 Test Loss: 0.648 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.8798112869262695
Epoch: 41, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.635 Vali Acc: 0.833 Test Loss: 0.635 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833327).  Saving model ...
Epoch: 42 cost time: 0.8292841911315918
Epoch: 42, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.681 Vali Acc: 0.828 Test Loss: 0.681 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8519532680511475
Epoch: 43, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.645 Vali Acc: 0.822 Test Loss: 0.645 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.8468964099884033
Epoch: 44, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.661 Vali Acc: 0.811 Test Loss: 0.661 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.7994556427001953
Epoch: 45, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.625 Vali Acc: 0.850 Test Loss: 0.625 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849994).  Saving model ...
Epoch: 46 cost time: 0.8665904998779297
Epoch: 46, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.609 Vali Acc: 0.850 Test Loss: 0.609 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 47 cost time: 0.9030725955963135
Epoch: 47, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.637 Vali Acc: 0.850 Test Loss: 0.637 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8493249416351318
Epoch: 48, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.638 Vali Acc: 0.850 Test Loss: 0.638 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.8022561073303223
Epoch: 49, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.645 Vali Acc: 0.839 Test Loss: 0.645 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.8073139190673828
Epoch: 50, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.656 Vali Acc: 0.844 Test Loss: 0.656 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.8626153469085693
Epoch: 51, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.650 Vali Acc: 0.844 Test Loss: 0.650 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.7809674739837646
Epoch: 52, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.667 Vali Acc: 0.839 Test Loss: 0.667 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.9147021770477295
Epoch: 53, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.656 Vali Acc: 0.844 Test Loss: 0.656 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.8824114799499512
Epoch: 54, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.676 Vali Acc: 0.850 Test Loss: 0.676 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.8199689388275146
Epoch: 55, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.669 Vali Acc: 0.856 Test Loss: 0.669 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 56 cost time: 0.6914689540863037
Epoch: 56, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.648 Vali Acc: 0.861 Test Loss: 0.648 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 57 cost time: 0.8368144035339355
Epoch: 57, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.645 Vali Acc: 0.861 Test Loss: 0.645 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 58 cost time: 0.857933759689331
Epoch: 58, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.671 Vali Acc: 0.844 Test Loss: 0.671 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.0151591300964355
Epoch: 59, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.644 Vali Acc: 0.861 Test Loss: 0.644 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 60 cost time: 0.918942928314209
Epoch: 60, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.652 Vali Acc: 0.872 Test Loss: 0.652 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872216).  Saving model ...
Epoch: 61 cost time: 0.7375240325927734
Epoch: 61, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.656 Vali Acc: 0.856 Test Loss: 0.656 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.7067537307739258
Epoch: 62, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.667 Vali Acc: 0.861 Test Loss: 0.667 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.7390744686126709
Epoch: 63, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.677 Vali Acc: 0.867 Test Loss: 0.677 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.7962539196014404
Epoch: 64, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.654 Vali Acc: 0.861 Test Loss: 0.654 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.9031774997711182
Epoch: 65, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.647 Vali Acc: 0.872 Test Loss: 0.647 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872216).  Saving model ...
Epoch: 66 cost time: 0.7641735076904297
Epoch: 66, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.652 Vali Acc: 0.872 Test Loss: 0.652 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.9250938892364502
Epoch: 67, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.675 Vali Acc: 0.861 Test Loss: 0.675 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.8553483486175537
Epoch: 68, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.666 Vali Acc: 0.867 Test Loss: 0.666 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.7688050270080566
Epoch: 69, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.679 Vali Acc: 0.867 Test Loss: 0.679 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.8190174102783203
Epoch: 70, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.677 Vali Acc: 0.861 Test Loss: 0.677 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.7913422584533691
Epoch: 71, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.661 Vali Acc: 0.872 Test Loss: 0.661 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 0.8296566009521484
Epoch: 72, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.684 Vali Acc: 0.867 Test Loss: 0.684 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 0.7473526000976562
Epoch: 73, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.673 Vali Acc: 0.867 Test Loss: 0.673 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 0.8280274868011475
Epoch: 74, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.666 Vali Acc: 0.867 Test Loss: 0.666 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 0.9505143165588379
Epoch: 75, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.674 Vali Acc: 0.861 Test Loss: 0.674 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 263335
model size : 2.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.452049493789673
Epoch: 1, Steps: 12 | Train Loss: 2.920 Vali Loss: 2.840 Vali Acc: 0.050 Test Loss: 2.840 Test Acc: 0.050
Validation loss decreased (inf --> -0.049972).  Saving model ...
Epoch: 2 cost time: 1.004270315170288
Epoch: 2, Steps: 12 | Train Loss: 2.831 Vali Loss: 2.721 Vali Acc: 0.106 Test Loss: 2.721 Test Acc: 0.106
Validation loss decreased (-0.049972 --> -0.105528).  Saving model ...
Epoch: 3 cost time: 1.0245940685272217
Epoch: 3, Steps: 12 | Train Loss: 2.716 Vali Loss: 2.623 Vali Acc: 0.211 Test Loss: 2.623 Test Acc: 0.211
Validation loss decreased (-0.105528 --> -0.211085).  Saving model ...
Epoch: 4 cost time: 0.9494071006774902
Epoch: 4, Steps: 12 | Train Loss: 2.588 Vali Loss: 2.543 Vali Acc: 0.300 Test Loss: 2.543 Test Acc: 0.300
Validation loss decreased (-0.211085 --> -0.299975).  Saving model ...
Epoch: 5 cost time: 0.9132039546966553
Epoch: 5, Steps: 12 | Train Loss: 2.483 Vali Loss: 2.461 Vali Acc: 0.344 Test Loss: 2.461 Test Acc: 0.344
Validation loss decreased (-0.299975 --> -0.344420).  Saving model ...
Epoch: 6 cost time: 0.8409097194671631
Epoch: 6, Steps: 12 | Train Loss: 2.407 Vali Loss: 2.374 Vali Acc: 0.400 Test Loss: 2.374 Test Acc: 0.400
Validation loss decreased (-0.344420 --> -0.399976).  Saving model ...
Epoch: 7 cost time: 0.8905303478240967
Epoch: 7, Steps: 12 | Train Loss: 2.341 Vali Loss: 2.277 Vali Acc: 0.450 Test Loss: 2.277 Test Acc: 0.450
Validation loss decreased (-0.399976 --> -0.449977).  Saving model ...
Epoch: 8 cost time: 1.0933806896209717
Epoch: 8, Steps: 12 | Train Loss: 2.160 Vali Loss: 2.172 Vali Acc: 0.483 Test Loss: 2.172 Test Acc: 0.483
Validation loss decreased (-0.449977 --> -0.483312).  Saving model ...
Epoch: 9 cost time: 0.9700272083282471
Epoch: 9, Steps: 12 | Train Loss: 2.029 Vali Loss: 2.050 Vali Acc: 0.511 Test Loss: 2.050 Test Acc: 0.511
Validation loss decreased (-0.483312 --> -0.511091).  Saving model ...
Epoch: 10 cost time: 0.900871992111206
Epoch: 10, Steps: 12 | Train Loss: 1.917 Vali Loss: 1.940 Vali Acc: 0.528 Test Loss: 1.940 Test Acc: 0.528
Validation loss decreased (-0.511091 --> -0.527758).  Saving model ...
Epoch: 11 cost time: 0.8208053112030029
Epoch: 11, Steps: 12 | Train Loss: 1.734 Vali Loss: 1.818 Vali Acc: 0.550 Test Loss: 1.818 Test Acc: 0.550
Validation loss decreased (-0.527758 --> -0.549982).  Saving model ...
Epoch: 12 cost time: 0.9988412857055664
Epoch: 12, Steps: 12 | Train Loss: 1.604 Vali Loss: 1.712 Vali Acc: 0.550 Test Loss: 1.712 Test Acc: 0.550
Validation loss decreased (-0.549982 --> -0.549983).  Saving model ...
Epoch: 13 cost time: 0.8332452774047852
Epoch: 13, Steps: 12 | Train Loss: 1.446 Vali Loss: 1.596 Vali Acc: 0.578 Test Loss: 1.596 Test Acc: 0.578
Validation loss decreased (-0.549983 --> -0.577762).  Saving model ...
Epoch: 14 cost time: 0.9748175144195557
Epoch: 14, Steps: 12 | Train Loss: 1.282 Vali Loss: 1.493 Vali Acc: 0.600 Test Loss: 1.493 Test Acc: 0.600
Validation loss decreased (-0.577762 --> -0.599985).  Saving model ...
Epoch: 15 cost time: 0.8900153636932373
Epoch: 15, Steps: 12 | Train Loss: 1.216 Vali Loss: 1.406 Vali Acc: 0.606 Test Loss: 1.406 Test Acc: 0.606
Validation loss decreased (-0.599985 --> -0.605541).  Saving model ...
Epoch: 16 cost time: 0.8903191089630127
Epoch: 16, Steps: 12 | Train Loss: 1.085 Vali Loss: 1.337 Vali Acc: 0.611 Test Loss: 1.337 Test Acc: 0.611
Validation loss decreased (-0.605541 --> -0.611098).  Saving model ...
Epoch: 17 cost time: 0.8633790016174316
Epoch: 17, Steps: 12 | Train Loss: 1.049 Vali Loss: 1.266 Vali Acc: 0.656 Test Loss: 1.266 Test Acc: 0.656
Validation loss decreased (-0.611098 --> -0.655543).  Saving model ...
Epoch: 18 cost time: 0.817357063293457
Epoch: 18, Steps: 12 | Train Loss: 0.922 Vali Loss: 1.193 Vali Acc: 0.672 Test Loss: 1.193 Test Acc: 0.672
Validation loss decreased (-0.655543 --> -0.672210).  Saving model ...
Epoch: 19 cost time: 0.7980976104736328
Epoch: 19, Steps: 12 | Train Loss: 0.859 Vali Loss: 1.118 Vali Acc: 0.644 Test Loss: 1.118 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9722578525543213
Epoch: 20, Steps: 12 | Train Loss: 0.910 Vali Loss: 1.056 Vali Acc: 0.694 Test Loss: 1.056 Test Acc: 0.694
Validation loss decreased (-0.672210 --> -0.694434).  Saving model ...
Epoch: 21 cost time: 0.9699411392211914
Epoch: 21, Steps: 12 | Train Loss: 0.707 Vali Loss: 1.013 Vali Acc: 0.711 Test Loss: 1.013 Test Acc: 0.711
Validation loss decreased (-0.694434 --> -0.711101).  Saving model ...
Epoch: 22 cost time: 0.9146826267242432
Epoch: 22, Steps: 12 | Train Loss: 0.668 Vali Loss: 0.971 Vali Acc: 0.717 Test Loss: 0.971 Test Acc: 0.717
Validation loss decreased (-0.711101 --> -0.716657).  Saving model ...
Epoch: 23 cost time: 0.8785197734832764
Epoch: 23, Steps: 12 | Train Loss: 0.649 Vali Loss: 0.926 Vali Acc: 0.722 Test Loss: 0.926 Test Acc: 0.722
Validation loss decreased (-0.716657 --> -0.722213).  Saving model ...
Epoch: 24 cost time: 0.8736128807067871
Epoch: 24, Steps: 12 | Train Loss: 0.600 Vali Loss: 0.883 Vali Acc: 0.750 Test Loss: 0.883 Test Acc: 0.750
Validation loss decreased (-0.722213 --> -0.749991).  Saving model ...
Epoch: 25 cost time: 0.9334022998809814
Epoch: 25, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.859 Vali Acc: 0.733 Test Loss: 0.859 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9810183048248291
Epoch: 26, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.816 Vali Acc: 0.744 Test Loss: 0.816 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9317677021026611
Epoch: 27, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.790 Vali Acc: 0.756 Test Loss: 0.790 Test Acc: 0.756
Validation loss decreased (-0.749991 --> -0.755548).  Saving model ...
Epoch: 28 cost time: 0.9419198036193848
Epoch: 28, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.763 Vali Acc: 0.789 Test Loss: 0.763 Test Acc: 0.789
Validation loss decreased (-0.755548 --> -0.788881).  Saving model ...
Epoch: 29 cost time: 0.7785985469818115
Epoch: 29, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.742 Vali Acc: 0.783 Test Loss: 0.742 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8482739925384521
Epoch: 30, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.717 Vali Acc: 0.806 Test Loss: 0.717 Test Acc: 0.806
Validation loss decreased (-0.788881 --> -0.805548).  Saving model ...
Epoch: 31 cost time: 0.8583791255950928
Epoch: 31, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.692 Vali Acc: 0.811 Test Loss: 0.692 Test Acc: 0.811
Validation loss decreased (-0.805548 --> -0.811104).  Saving model ...
Epoch: 32 cost time: 0.8905365467071533
Epoch: 32, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.671 Vali Acc: 0.806 Test Loss: 0.671 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9199156761169434
Epoch: 33, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.665 Vali Acc: 0.811 Test Loss: 0.665 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 34 cost time: 0.8273530006408691
Epoch: 34, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.674 Vali Acc: 0.800 Test Loss: 0.674 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.83333420753479
Epoch: 35, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.643 Vali Acc: 0.828 Test Loss: 0.643 Test Acc: 0.828
Validation loss decreased (-0.811104 --> -0.827771).  Saving model ...
Epoch: 36 cost time: 0.8348367214202881
Epoch: 36, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.649 Vali Acc: 0.844 Test Loss: 0.649 Test Acc: 0.844
Validation loss decreased (-0.827771 --> -0.844438).  Saving model ...
Epoch: 37 cost time: 0.9136207103729248
Epoch: 37, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.622 Vali Acc: 0.844 Test Loss: 0.622 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 38 cost time: 0.9971065521240234
Epoch: 38, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.589 Vali Acc: 0.833 Test Loss: 0.589 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8960657119750977
Epoch: 39, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.595 Vali Acc: 0.856 Test Loss: 0.595 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855550).  Saving model ...
Epoch: 40 cost time: 0.8531713485717773
Epoch: 40, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.608 Vali Acc: 0.850 Test Loss: 0.608 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8251571655273438
Epoch: 41, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.603 Vali Acc: 0.867 Test Loss: 0.603 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 42 cost time: 0.8445687294006348
Epoch: 42, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.603 Vali Acc: 0.867 Test Loss: 0.603 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 43 cost time: 0.8141942024230957
Epoch: 43, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.616 Vali Acc: 0.867 Test Loss: 0.616 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9297740459442139
Epoch: 44, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.597 Vali Acc: 0.867 Test Loss: 0.597 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 45 cost time: 0.8423755168914795
Epoch: 45, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.621 Vali Acc: 0.861 Test Loss: 0.621 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.045203685760498
Epoch: 46, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.622 Vali Acc: 0.872 Test Loss: 0.622 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 47 cost time: 0.7940552234649658
Epoch: 47, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.617 Vali Acc: 0.872 Test Loss: 0.617 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872216).  Saving model ...
Epoch: 48 cost time: 0.8881776332855225
Epoch: 48, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.613 Vali Acc: 0.872 Test Loss: 0.613 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872216).  Saving model ...
Epoch: 49 cost time: 0.7868800163269043
Epoch: 49, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.611 Vali Acc: 0.861 Test Loss: 0.611 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.0670430660247803
Epoch: 50, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.616 Vali Acc: 0.867 Test Loss: 0.616 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.8029730319976807
Epoch: 51, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.658 Vali Acc: 0.872 Test Loss: 0.658 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.8884472846984863
Epoch: 52, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.642 Vali Acc: 0.878 Test Loss: 0.642 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877771).  Saving model ...
Epoch: 53 cost time: 0.7848615646362305
Epoch: 53, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.660 Vali Acc: 0.861 Test Loss: 0.660 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.8377151489257812
Epoch: 54, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.642 Vali Acc: 0.883 Test Loss: 0.642 Test Acc: 0.883
Validation loss decreased (-0.877771 --> -0.883327).  Saving model ...
Epoch: 55 cost time: 0.8127641677856445
Epoch: 55, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.624 Vali Acc: 0.878 Test Loss: 0.624 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.808194637298584
Epoch: 56, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.644 Vali Acc: 0.889 Test Loss: 0.644 Test Acc: 0.889
Validation loss decreased (-0.883327 --> -0.888882).  Saving model ...
Epoch: 57 cost time: 0.8743431568145752
Epoch: 57, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.663 Vali Acc: 0.878 Test Loss: 0.663 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.8926198482513428
Epoch: 58, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.686 Vali Acc: 0.861 Test Loss: 0.686 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.0214612483978271
Epoch: 59, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.663 Vali Acc: 0.872 Test Loss: 0.663 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.9618878364562988
Epoch: 60, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.691 Vali Acc: 0.867 Test Loss: 0.691 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.8754072189331055
Epoch: 61, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.673 Vali Acc: 0.883 Test Loss: 0.673 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.0592517852783203
Epoch: 62, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.672 Vali Acc: 0.883 Test Loss: 0.672 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.9623699188232422
Epoch: 63, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.660 Vali Acc: 0.883 Test Loss: 0.660 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 0.8691005706787109
Epoch: 64, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.657 Vali Acc: 0.883 Test Loss: 0.657 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 0.970146656036377
Epoch: 65, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.683 Vali Acc: 0.872 Test Loss: 0.683 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 0.7854104042053223
Epoch: 66, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.718 Vali Acc: 0.883 Test Loss: 0.718 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 263079
model size : 2.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6073410511016846
Epoch: 1, Steps: 12 | Train Loss: 2.836 Vali Loss: 2.798 Vali Acc: 0.056 Test Loss: 2.798 Test Acc: 0.056
Validation loss decreased (inf --> -0.055528).  Saving model ...
Epoch: 2 cost time: 0.8025884628295898
Epoch: 2, Steps: 12 | Train Loss: 2.760 Vali Loss: 2.697 Vali Acc: 0.033 Test Loss: 2.697 Test Acc: 0.033
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9019193649291992
Epoch: 3, Steps: 12 | Train Loss: 2.650 Vali Loss: 2.601 Vali Acc: 0.156 Test Loss: 2.601 Test Acc: 0.156
Validation loss decreased (-0.055528 --> -0.155530).  Saving model ...
Epoch: 4 cost time: 0.8461525440216064
Epoch: 4, Steps: 12 | Train Loss: 2.566 Vali Loss: 2.514 Vali Acc: 0.283 Test Loss: 2.514 Test Acc: 0.283
Validation loss decreased (-0.155530 --> -0.283308).  Saving model ...
Epoch: 5 cost time: 0.8527333736419678
Epoch: 5, Steps: 12 | Train Loss: 2.452 Vali Loss: 2.430 Vali Acc: 0.328 Test Loss: 2.430 Test Acc: 0.328
Validation loss decreased (-0.283308 --> -0.327753).  Saving model ...
Epoch: 6 cost time: 0.8675229549407959
Epoch: 6, Steps: 12 | Train Loss: 2.377 Vali Loss: 2.333 Vali Acc: 0.411 Test Loss: 2.333 Test Acc: 0.411
Validation loss decreased (-0.327753 --> -0.411088).  Saving model ...
Epoch: 7 cost time: 0.9522044658660889
Epoch: 7, Steps: 12 | Train Loss: 2.258 Vali Loss: 2.215 Vali Acc: 0.478 Test Loss: 2.215 Test Acc: 0.478
Validation loss decreased (-0.411088 --> -0.477756).  Saving model ...
Epoch: 8 cost time: 0.8586559295654297
Epoch: 8, Steps: 12 | Train Loss: 2.140 Vali Loss: 2.094 Vali Acc: 0.528 Test Loss: 2.094 Test Acc: 0.528
Validation loss decreased (-0.477756 --> -0.527757).  Saving model ...
Epoch: 9 cost time: 0.8491384983062744
Epoch: 9, Steps: 12 | Train Loss: 1.937 Vali Loss: 1.962 Vali Acc: 0.544 Test Loss: 1.962 Test Acc: 0.544
Validation loss decreased (-0.527757 --> -0.544425).  Saving model ...
Epoch: 10 cost time: 0.9727907180786133
Epoch: 10, Steps: 12 | Train Loss: 1.832 Vali Loss: 1.832 Vali Acc: 0.589 Test Loss: 1.832 Test Acc: 0.589
Validation loss decreased (-0.544425 --> -0.588871).  Saving model ...
Epoch: 11 cost time: 0.8107268810272217
Epoch: 11, Steps: 12 | Train Loss: 1.664 Vali Loss: 1.712 Vali Acc: 0.594 Test Loss: 1.712 Test Acc: 0.594
Validation loss decreased (-0.588871 --> -0.594427).  Saving model ...
Epoch: 12 cost time: 0.8457996845245361
Epoch: 12, Steps: 12 | Train Loss: 1.501 Vali Loss: 1.593 Vali Acc: 0.656 Test Loss: 1.593 Test Acc: 0.656
Validation loss decreased (-0.594427 --> -0.655540).  Saving model ...
Epoch: 13 cost time: 0.78603196144104
Epoch: 13, Steps: 12 | Train Loss: 1.353 Vali Loss: 1.477 Vali Acc: 0.617 Test Loss: 1.477 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8429267406463623
Epoch: 14, Steps: 12 | Train Loss: 1.260 Vali Loss: 1.375 Vali Acc: 0.633 Test Loss: 1.375 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.848257303237915
Epoch: 15, Steps: 12 | Train Loss: 1.129 Vali Loss: 1.286 Vali Acc: 0.661 Test Loss: 1.286 Test Acc: 0.661
Validation loss decreased (-0.655540 --> -0.661098).  Saving model ...
Epoch: 16 cost time: 0.763953685760498
Epoch: 16, Steps: 12 | Train Loss: 1.053 Vali Loss: 1.197 Vali Acc: 0.667 Test Loss: 1.197 Test Acc: 0.667
Validation loss decreased (-0.661098 --> -0.666655).  Saving model ...
Epoch: 17 cost time: 0.8171126842498779
Epoch: 17, Steps: 12 | Train Loss: 0.960 Vali Loss: 1.124 Vali Acc: 0.683 Test Loss: 1.124 Test Acc: 0.683
Validation loss decreased (-0.666655 --> -0.683322).  Saving model ...
Epoch: 18 cost time: 0.9258689880371094
Epoch: 18, Steps: 12 | Train Loss: 0.877 Vali Loss: 1.059 Vali Acc: 0.722 Test Loss: 1.059 Test Acc: 0.722
Validation loss decreased (-0.683322 --> -0.722212).  Saving model ...
Epoch: 19 cost time: 0.8329217433929443
Epoch: 19, Steps: 12 | Train Loss: 0.773 Vali Loss: 0.996 Vali Acc: 0.706 Test Loss: 0.996 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8876495361328125
Epoch: 20, Steps: 12 | Train Loss: 0.705 Vali Loss: 0.949 Vali Acc: 0.717 Test Loss: 0.949 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.767827033996582
Epoch: 21, Steps: 12 | Train Loss: 0.631 Vali Loss: 0.908 Vali Acc: 0.728 Test Loss: 0.908 Test Acc: 0.728
Validation loss decreased (-0.722212 --> -0.727769).  Saving model ...
Epoch: 22 cost time: 0.7739918231964111
Epoch: 22, Steps: 12 | Train Loss: 0.593 Vali Loss: 0.859 Vali Acc: 0.756 Test Loss: 0.859 Test Acc: 0.756
Validation loss decreased (-0.727769 --> -0.755547).  Saving model ...
Epoch: 23 cost time: 0.8298764228820801
Epoch: 23, Steps: 12 | Train Loss: 0.535 Vali Loss: 0.828 Vali Acc: 0.767 Test Loss: 0.828 Test Acc: 0.767
Validation loss decreased (-0.755547 --> -0.766658).  Saving model ...
Epoch: 24 cost time: 0.916637659072876
Epoch: 24, Steps: 12 | Train Loss: 0.475 Vali Loss: 0.789 Vali Acc: 0.756 Test Loss: 0.789 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2848050594329834
Epoch: 25, Steps: 12 | Train Loss: 0.517 Vali Loss: 0.753 Vali Acc: 0.761 Test Loss: 0.753 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.891937255859375
Epoch: 26, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.734 Vali Acc: 0.806 Test Loss: 0.734 Test Acc: 0.806
Validation loss decreased (-0.766658 --> -0.805548).  Saving model ...
Epoch: 27 cost time: 0.964658260345459
Epoch: 27, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.719 Vali Acc: 0.783 Test Loss: 0.719 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8945348262786865
Epoch: 28, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.680 Vali Acc: 0.800 Test Loss: 0.680 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9645533561706543
Epoch: 29, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.657 Vali Acc: 0.806 Test Loss: 0.657 Test Acc: 0.806
Validation loss decreased (-0.805548 --> -0.805549).  Saving model ...
Epoch: 30 cost time: 0.8783965110778809
Epoch: 30, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.661 Vali Acc: 0.817 Test Loss: 0.661 Test Acc: 0.817
Validation loss decreased (-0.805549 --> -0.816660).  Saving model ...
Epoch: 31 cost time: 0.8053898811340332
Epoch: 31, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.636 Vali Acc: 0.806 Test Loss: 0.636 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8846850395202637
Epoch: 32, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.610 Vali Acc: 0.839 Test Loss: 0.610 Test Acc: 0.839
Validation loss decreased (-0.816660 --> -0.838883).  Saving model ...
Epoch: 33 cost time: 0.9130260944366455
Epoch: 33, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.584 Vali Acc: 0.806 Test Loss: 0.584 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9179372787475586
Epoch: 34, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.589 Vali Acc: 0.844 Test Loss: 0.589 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 35 cost time: 0.8591248989105225
Epoch: 35, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.577 Vali Acc: 0.833 Test Loss: 0.577 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9648220539093018
Epoch: 36, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.577 Vali Acc: 0.817 Test Loss: 0.577 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8126134872436523
Epoch: 37, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.567 Vali Acc: 0.850 Test Loss: 0.567 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849994).  Saving model ...
Epoch: 38 cost time: 0.7639062404632568
Epoch: 38, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.553 Vali Acc: 0.822 Test Loss: 0.553 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9066269397735596
Epoch: 39, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.560 Vali Acc: 0.844 Test Loss: 0.560 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8522758483886719
Epoch: 40, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.527 Vali Acc: 0.850 Test Loss: 0.527 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 41 cost time: 0.9039735794067383
Epoch: 41, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.523 Vali Acc: 0.850 Test Loss: 0.523 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 42 cost time: 0.9060132503509521
Epoch: 42, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8070487976074219
Epoch: 43, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.556 Vali Acc: 0.850 Test Loss: 0.556 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.8781187534332275
Epoch: 44, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.534 Vali Acc: 0.861 Test Loss: 0.534 Test Acc: 0.861
Validation loss decreased (-0.849995 --> -0.861106).  Saving model ...
Epoch: 45 cost time: 0.9891300201416016
Epoch: 45, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.535 Vali Acc: 0.856 Test Loss: 0.535 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.9588320255279541
Epoch: 46, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.563 Vali Acc: 0.856 Test Loss: 0.563 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.911492109298706
Epoch: 47, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.584 Vali Acc: 0.856 Test Loss: 0.584 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.0380604267120361
Epoch: 48, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.541 Vali Acc: 0.872 Test Loss: 0.541 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 49 cost time: 0.9771718978881836
Epoch: 49, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.531 Vali Acc: 0.850 Test Loss: 0.531 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.946113109588623
Epoch: 50, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.578 Vali Acc: 0.878 Test Loss: 0.578 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 51 cost time: 1.1083693504333496
Epoch: 51, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.549 Vali Acc: 0.861 Test Loss: 0.549 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.2145159244537354
Epoch: 52, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.556 Vali Acc: 0.883 Test Loss: 0.556 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883328).  Saving model ...
Epoch: 53 cost time: 1.046534776687622
Epoch: 53, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.508 Vali Acc: 0.872 Test Loss: 0.508 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.8460323810577393
Epoch: 54, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.579 Vali Acc: 0.867 Test Loss: 0.579 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.9413840770721436
Epoch: 55, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.585 Vali Acc: 0.878 Test Loss: 0.585 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.8698511123657227
Epoch: 56, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.557 Vali Acc: 0.872 Test Loss: 0.557 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.9300041198730469
Epoch: 57, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.583 Vali Acc: 0.883 Test Loss: 0.583 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.0581603050231934
Epoch: 58, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.604 Vali Acc: 0.872 Test Loss: 0.604 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.8352491855621338
Epoch: 59, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.589 Vali Acc: 0.878 Test Loss: 0.589 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.8422305583953857
Epoch: 60, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.565 Vali Acc: 0.883 Test Loss: 0.565 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.956073522567749
Epoch: 61, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.590 Vali Acc: 0.861 Test Loss: 0.590 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 1.0696139335632324
Epoch: 62, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.578 Vali Acc: 0.861 Test Loss: 0.578 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 262823
model size : 2.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3697822093963623
Epoch: 1, Steps: 12 | Train Loss: 3.035 Vali Loss: 2.936 Vali Acc: 0.067 Test Loss: 2.936 Test Acc: 0.067
Validation loss decreased (inf --> -0.066637).  Saving model ...
Epoch: 2 cost time: 0.877037763595581
Epoch: 2, Steps: 12 | Train Loss: 2.897 Vali Loss: 2.809 Vali Acc: 0.050 Test Loss: 2.809 Test Acc: 0.050
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8331985473632812
Epoch: 3, Steps: 12 | Train Loss: 2.810 Vali Loss: 2.700 Vali Acc: 0.039 Test Loss: 2.700 Test Acc: 0.039
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8635869026184082
Epoch: 4, Steps: 12 | Train Loss: 2.667 Vali Loss: 2.616 Vali Acc: 0.117 Test Loss: 2.616 Test Acc: 0.117
Validation loss decreased (-0.066637 --> -0.116641).  Saving model ...
Epoch: 5 cost time: 0.8493599891662598
Epoch: 5, Steps: 12 | Train Loss: 2.571 Vali Loss: 2.533 Vali Acc: 0.228 Test Loss: 2.533 Test Acc: 0.228
Validation loss decreased (-0.116641 --> -0.227752).  Saving model ...
Epoch: 6 cost time: 0.8957946300506592
Epoch: 6, Steps: 12 | Train Loss: 2.479 Vali Loss: 2.450 Vali Acc: 0.283 Test Loss: 2.450 Test Acc: 0.283
Validation loss decreased (-0.227752 --> -0.283309).  Saving model ...
Epoch: 7 cost time: 0.7900452613830566
Epoch: 7, Steps: 12 | Train Loss: 2.384 Vali Loss: 2.350 Vali Acc: 0.422 Test Loss: 2.350 Test Acc: 0.422
Validation loss decreased (-0.283309 --> -0.422199).  Saving model ...
Epoch: 8 cost time: 0.792395830154419
Epoch: 8, Steps: 12 | Train Loss: 2.274 Vali Loss: 2.244 Vali Acc: 0.500 Test Loss: 2.244 Test Acc: 0.500
Validation loss decreased (-0.422199 --> -0.499978).  Saving model ...
Epoch: 9 cost time: 0.9105069637298584
Epoch: 9, Steps: 12 | Train Loss: 2.134 Vali Loss: 2.129 Vali Acc: 0.539 Test Loss: 2.129 Test Acc: 0.539
Validation loss decreased (-0.499978 --> -0.538868).  Saving model ...
Epoch: 10 cost time: 0.8745131492614746
Epoch: 10, Steps: 12 | Train Loss: 1.991 Vali Loss: 1.984 Vali Acc: 0.550 Test Loss: 1.984 Test Acc: 0.550
Validation loss decreased (-0.538868 --> -0.549980).  Saving model ...
Epoch: 11 cost time: 0.7929625511169434
Epoch: 11, Steps: 12 | Train Loss: 1.838 Vali Loss: 1.867 Vali Acc: 0.572 Test Loss: 1.867 Test Acc: 0.572
Validation loss decreased (-0.549980 --> -0.572204).  Saving model ...
Epoch: 12 cost time: 0.816521406173706
Epoch: 12, Steps: 12 | Train Loss: 1.662 Vali Loss: 1.749 Vali Acc: 0.617 Test Loss: 1.749 Test Acc: 0.617
Validation loss decreased (-0.572204 --> -0.616649).  Saving model ...
Epoch: 13 cost time: 0.860504150390625
Epoch: 13, Steps: 12 | Train Loss: 1.493 Vali Loss: 1.628 Vali Acc: 0.611 Test Loss: 1.628 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7842576503753662
Epoch: 14, Steps: 12 | Train Loss: 1.353 Vali Loss: 1.526 Vali Acc: 0.628 Test Loss: 1.526 Test Acc: 0.628
Validation loss decreased (-0.616649 --> -0.627763).  Saving model ...
Epoch: 15 cost time: 0.9480128288269043
Epoch: 15, Steps: 12 | Train Loss: 1.338 Vali Loss: 1.428 Vali Acc: 0.628 Test Loss: 1.428 Test Acc: 0.628
Validation loss decreased (-0.627763 --> -0.627763).  Saving model ...
Epoch: 16 cost time: 0.9031987190246582
Epoch: 16, Steps: 12 | Train Loss: 1.176 Vali Loss: 1.335 Vali Acc: 0.628 Test Loss: 1.335 Test Acc: 0.628
Validation loss decreased (-0.627763 --> -0.627764).  Saving model ...
Epoch: 17 cost time: 0.834383487701416
Epoch: 17, Steps: 12 | Train Loss: 1.132 Vali Loss: 1.252 Vali Acc: 0.639 Test Loss: 1.252 Test Acc: 0.639
Validation loss decreased (-0.627764 --> -0.638876).  Saving model ...
Epoch: 18 cost time: 0.844581127166748
Epoch: 18, Steps: 12 | Train Loss: 0.972 Vali Loss: 1.173 Vali Acc: 0.633 Test Loss: 1.173 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9367475509643555
Epoch: 19, Steps: 12 | Train Loss: 0.856 Vali Loss: 1.102 Vali Acc: 0.650 Test Loss: 1.102 Test Acc: 0.650
Validation loss decreased (-0.638876 --> -0.649989).  Saving model ...
Epoch: 20 cost time: 0.9099879264831543
Epoch: 20, Steps: 12 | Train Loss: 0.791 Vali Loss: 1.043 Vali Acc: 0.672 Test Loss: 1.043 Test Acc: 0.672
Validation loss decreased (-0.649989 --> -0.672212).  Saving model ...
Epoch: 21 cost time: 0.8894805908203125
Epoch: 21, Steps: 12 | Train Loss: 0.739 Vali Loss: 0.984 Vali Acc: 0.722 Test Loss: 0.984 Test Acc: 0.722
Validation loss decreased (-0.672212 --> -0.722212).  Saving model ...
Epoch: 22 cost time: 0.9540567398071289
Epoch: 22, Steps: 12 | Train Loss: 0.664 Vali Loss: 0.936 Vali Acc: 0.717 Test Loss: 0.936 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8906629085540771
Epoch: 23, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.872 Vali Acc: 0.756 Test Loss: 0.872 Test Acc: 0.756
Validation loss decreased (-0.722212 --> -0.755547).  Saving model ...
Epoch: 24 cost time: 0.8670036792755127
Epoch: 24, Steps: 12 | Train Loss: 0.590 Vali Loss: 0.812 Vali Acc: 0.767 Test Loss: 0.812 Test Acc: 0.767
Validation loss decreased (-0.755547 --> -0.766659).  Saving model ...
Epoch: 25 cost time: 0.8434500694274902
Epoch: 25, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.792 Vali Acc: 0.789 Test Loss: 0.792 Test Acc: 0.789
Validation loss decreased (-0.766659 --> -0.788881).  Saving model ...
Epoch: 26 cost time: 0.8501217365264893
Epoch: 26, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.782 Vali Acc: 0.783 Test Loss: 0.782 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9335534572601318
Epoch: 27, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.733 Vali Acc: 0.800 Test Loss: 0.733 Test Acc: 0.800
Validation loss decreased (-0.788881 --> -0.799993).  Saving model ...
Epoch: 28 cost time: 0.8831942081451416
Epoch: 28, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.717 Vali Acc: 0.800 Test Loss: 0.717 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 29 cost time: 0.7965810298919678
Epoch: 29, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.683 Vali Acc: 0.806 Test Loss: 0.683 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805549).  Saving model ...
Epoch: 30 cost time: 0.8529806137084961
Epoch: 30, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.660 Vali Acc: 0.806 Test Loss: 0.660 Test Acc: 0.806
Validation loss decreased (-0.805549 --> -0.805549).  Saving model ...
Epoch: 31 cost time: 0.8880341053009033
Epoch: 31, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.650 Vali Acc: 0.833 Test Loss: 0.650 Test Acc: 0.833
Validation loss decreased (-0.805549 --> -0.833327).  Saving model ...
Epoch: 32 cost time: 0.9210977554321289
Epoch: 32, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.619 Vali Acc: 0.828 Test Loss: 0.619 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8273255825042725
Epoch: 33, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.610 Vali Acc: 0.839 Test Loss: 0.610 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 34 cost time: 0.8109116554260254
Epoch: 34, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.599 Vali Acc: 0.844 Test Loss: 0.599 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844438).  Saving model ...
Epoch: 35 cost time: 0.9220461845397949
Epoch: 35, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.593 Vali Acc: 0.856 Test Loss: 0.593 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855550).  Saving model ...
Epoch: 36 cost time: 0.8300931453704834
Epoch: 36, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.594 Vali Acc: 0.850 Test Loss: 0.594 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8514649868011475
Epoch: 37, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.595 Vali Acc: 0.850 Test Loss: 0.595 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8351538181304932
Epoch: 38, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.576 Vali Acc: 0.856 Test Loss: 0.576 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 39 cost time: 0.7342061996459961
Epoch: 39, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.586 Vali Acc: 0.850 Test Loss: 0.586 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9062514305114746
Epoch: 40, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.576 Vali Acc: 0.872 Test Loss: 0.576 Test Acc: 0.872
Validation loss decreased (-0.855550 --> -0.872216).  Saving model ...
Epoch: 41 cost time: 0.7582433223724365
Epoch: 41, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.550 Vali Acc: 0.856 Test Loss: 0.550 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9045226573944092
Epoch: 42, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.567 Vali Acc: 0.844 Test Loss: 0.567 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.896726131439209
Epoch: 43, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.556 Vali Acc: 0.856 Test Loss: 0.556 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.8989706039428711
Epoch: 44, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.581 Vali Acc: 0.867 Test Loss: 0.581 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.8698546886444092
Epoch: 45, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.543 Vali Acc: 0.856 Test Loss: 0.543 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.8732142448425293
Epoch: 46, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.566 Vali Acc: 0.861 Test Loss: 0.566 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.9163715839385986
Epoch: 47, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.565 Vali Acc: 0.861 Test Loss: 0.565 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.8308391571044922
Epoch: 48, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.555 Vali Acc: 0.861 Test Loss: 0.555 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.8244640827178955
Epoch: 49, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.570 Vali Acc: 0.872 Test Loss: 0.570 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872217).  Saving model ...
Epoch: 50 cost time: 0.7990283966064453
Epoch: 50, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.589 Vali Acc: 0.867 Test Loss: 0.589 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.7660913467407227
Epoch: 51, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.601 Vali Acc: 0.867 Test Loss: 0.601 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.8063507080078125
Epoch: 52, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.574 Vali Acc: 0.872 Test Loss: 0.574 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.8040907382965088
Epoch: 53, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.547 Vali Acc: 0.861 Test Loss: 0.547 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.8049709796905518
Epoch: 54, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.572 Vali Acc: 0.878 Test Loss: 0.572 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 55 cost time: 0.829303503036499
Epoch: 55, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.567 Vali Acc: 0.861 Test Loss: 0.567 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.7981505393981934
Epoch: 56, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.598 Vali Acc: 0.861 Test Loss: 0.598 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.8512880802154541
Epoch: 57, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.603 Vali Acc: 0.867 Test Loss: 0.603 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.823394775390625
Epoch: 58, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.574 Vali Acc: 0.878 Test Loss: 0.574 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.8312056064605713
Epoch: 59, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.531 Vali Acc: 0.883 Test Loss: 0.531 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883328).  Saving model ...
Epoch: 60 cost time: 0.9629926681518555
Epoch: 60, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.556 Vali Acc: 0.867 Test Loss: 0.556 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.7804174423217773
Epoch: 61, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.589 Vali Acc: 0.861 Test Loss: 0.589 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.8602395057678223
Epoch: 62, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.598 Vali Acc: 0.872 Test Loss: 0.598 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.8700895309448242
Epoch: 63, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.604 Vali Acc: 0.867 Test Loss: 0.604 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.866905927658081
Epoch: 64, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.609 Vali Acc: 0.861 Test Loss: 0.609 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 0.854292631149292
Epoch: 65, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.607 Vali Acc: 0.878 Test Loss: 0.607 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 1.0227019786834717
Epoch: 66, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.626 Vali Acc: 0.878 Test Loss: 0.626 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 0.8522872924804688
Epoch: 67, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.651 Vali Acc: 0.878 Test Loss: 0.651 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 1.0908513069152832
Epoch: 68, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.627 Vali Acc: 0.872 Test Loss: 0.627 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 0.8617794513702393
Epoch: 69, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.628 Vali Acc: 0.872 Test Loss: 0.628 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 262567
model size : 2.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.536158323287964
Epoch: 1, Steps: 12 | Train Loss: 2.851 Vali Loss: 2.783 Vali Acc: 0.061 Test Loss: 2.783 Test Acc: 0.061
Validation loss decreased (inf --> -0.061083).  Saving model ...
Epoch: 2 cost time: 0.9514853954315186
Epoch: 2, Steps: 12 | Train Loss: 2.788 Vali Loss: 2.719 Vali Acc: 0.083 Test Loss: 2.719 Test Acc: 0.083
Validation loss decreased (-0.061083 --> -0.083306).  Saving model ...
Epoch: 3 cost time: 0.8818917274475098
Epoch: 3, Steps: 12 | Train Loss: 2.737 Vali Loss: 2.668 Vali Acc: 0.128 Test Loss: 2.668 Test Acc: 0.128
Validation loss decreased (-0.083306 --> -0.127751).  Saving model ...
Epoch: 4 cost time: 0.8191609382629395
Epoch: 4, Steps: 12 | Train Loss: 2.633 Vali Loss: 2.608 Vali Acc: 0.200 Test Loss: 2.608 Test Acc: 0.200
Validation loss decreased (-0.127751 --> -0.199974).  Saving model ...
Epoch: 5 cost time: 0.7676045894622803
Epoch: 5, Steps: 12 | Train Loss: 2.585 Vali Loss: 2.543 Vali Acc: 0.278 Test Loss: 2.543 Test Acc: 0.278
Validation loss decreased (-0.199974 --> -0.277752).  Saving model ...
Epoch: 6 cost time: 0.7551212310791016
Epoch: 6, Steps: 12 | Train Loss: 2.504 Vali Loss: 2.468 Vali Acc: 0.356 Test Loss: 2.468 Test Acc: 0.356
Validation loss decreased (-0.277752 --> -0.355531).  Saving model ...
Epoch: 7 cost time: 0.8661949634552002
Epoch: 7, Steps: 12 | Train Loss: 2.397 Vali Loss: 2.385 Vali Acc: 0.400 Test Loss: 2.385 Test Acc: 0.400
Validation loss decreased (-0.355531 --> -0.399976).  Saving model ...
Epoch: 8 cost time: 0.7523176670074463
Epoch: 8, Steps: 12 | Train Loss: 2.280 Vali Loss: 2.285 Vali Acc: 0.467 Test Loss: 2.285 Test Acc: 0.467
Validation loss decreased (-0.399976 --> -0.466644).  Saving model ...
Epoch: 9 cost time: 0.8240146636962891
Epoch: 9, Steps: 12 | Train Loss: 2.149 Vali Loss: 2.178 Vali Acc: 0.467 Test Loss: 2.178 Test Acc: 0.467
Validation loss decreased (-0.466644 --> -0.466645).  Saving model ...
Epoch: 10 cost time: 1.004131555557251
Epoch: 10, Steps: 12 | Train Loss: 2.038 Vali Loss: 2.063 Vali Acc: 0.489 Test Loss: 2.063 Test Acc: 0.489
Validation loss decreased (-0.466645 --> -0.488868).  Saving model ...
Epoch: 11 cost time: 0.858346700668335
Epoch: 11, Steps: 12 | Train Loss: 1.842 Vali Loss: 1.941 Vali Acc: 0.500 Test Loss: 1.941 Test Acc: 0.500
Validation loss decreased (-0.488868 --> -0.499981).  Saving model ...
Epoch: 12 cost time: 0.8499653339385986
Epoch: 12, Steps: 12 | Train Loss: 1.747 Vali Loss: 1.830 Vali Acc: 0.544 Test Loss: 1.830 Test Acc: 0.544
Validation loss decreased (-0.499981 --> -0.544426).  Saving model ...
Epoch: 13 cost time: 0.8644351959228516
Epoch: 13, Steps: 12 | Train Loss: 1.613 Vali Loss: 1.731 Vali Acc: 0.539 Test Loss: 1.731 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7617185115814209
Epoch: 14, Steps: 12 | Train Loss: 1.490 Vali Loss: 1.639 Vali Acc: 0.561 Test Loss: 1.639 Test Acc: 0.561
Validation loss decreased (-0.544426 --> -0.561095).  Saving model ...
Epoch: 15 cost time: 0.7587125301361084
Epoch: 15, Steps: 12 | Train Loss: 1.356 Vali Loss: 1.549 Vali Acc: 0.556 Test Loss: 1.549 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7382383346557617
Epoch: 16, Steps: 12 | Train Loss: 1.301 Vali Loss: 1.478 Vali Acc: 0.611 Test Loss: 1.478 Test Acc: 0.611
Validation loss decreased (-0.561095 --> -0.611096).  Saving model ...
Epoch: 17 cost time: 0.7331798076629639
Epoch: 17, Steps: 12 | Train Loss: 1.210 Vali Loss: 1.419 Vali Acc: 0.594 Test Loss: 1.419 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7840242385864258
Epoch: 18, Steps: 12 | Train Loss: 1.113 Vali Loss: 1.340 Vali Acc: 0.600 Test Loss: 1.340 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8104312419891357
Epoch: 19, Steps: 12 | Train Loss: 1.029 Vali Loss: 1.273 Vali Acc: 0.633 Test Loss: 1.273 Test Acc: 0.633
Validation loss decreased (-0.611096 --> -0.633321).  Saving model ...
Epoch: 20 cost time: 0.7901227474212646
Epoch: 20, Steps: 12 | Train Loss: 1.013 Vali Loss: 1.215 Vali Acc: 0.639 Test Loss: 1.215 Test Acc: 0.639
Validation loss decreased (-0.633321 --> -0.638877).  Saving model ...
Epoch: 21 cost time: 0.8983368873596191
Epoch: 21, Steps: 12 | Train Loss: 0.992 Vali Loss: 1.144 Vali Acc: 0.639 Test Loss: 1.144 Test Acc: 0.639
Validation loss decreased (-0.638877 --> -0.638877).  Saving model ...
Epoch: 22 cost time: 0.827017068862915
Epoch: 22, Steps: 12 | Train Loss: 0.910 Vali Loss: 1.113 Vali Acc: 0.650 Test Loss: 1.113 Test Acc: 0.650
Validation loss decreased (-0.638877 --> -0.649989).  Saving model ...
Epoch: 23 cost time: 0.871394157409668
Epoch: 23, Steps: 12 | Train Loss: 0.808 Vali Loss: 1.062 Vali Acc: 0.694 Test Loss: 1.062 Test Acc: 0.694
Validation loss decreased (-0.649989 --> -0.694434).  Saving model ...
Epoch: 24 cost time: 0.8214869499206543
Epoch: 24, Steps: 12 | Train Loss: 0.800 Vali Loss: 1.019 Vali Acc: 0.694 Test Loss: 1.019 Test Acc: 0.694
Validation loss decreased (-0.694434 --> -0.694434).  Saving model ...
Epoch: 25 cost time: 0.8387734889984131
Epoch: 25, Steps: 12 | Train Loss: 0.767 Vali Loss: 0.980 Vali Acc: 0.717 Test Loss: 0.980 Test Acc: 0.717
Validation loss decreased (-0.694434 --> -0.716657).  Saving model ...
Epoch: 26 cost time: 0.8468403816223145
Epoch: 26, Steps: 12 | Train Loss: 0.713 Vali Loss: 0.936 Vali Acc: 0.700 Test Loss: 0.936 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.909527063369751
Epoch: 27, Steps: 12 | Train Loss: 0.641 Vali Loss: 0.892 Vali Acc: 0.711 Test Loss: 0.892 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.954277753829956
Epoch: 28, Steps: 12 | Train Loss: 0.653 Vali Loss: 0.868 Vali Acc: 0.739 Test Loss: 0.868 Test Acc: 0.739
Validation loss decreased (-0.716657 --> -0.738880).  Saving model ...
Epoch: 29 cost time: 0.939551591873169
Epoch: 29, Steps: 12 | Train Loss: 0.604 Vali Loss: 0.838 Vali Acc: 0.717 Test Loss: 0.838 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9847912788391113
Epoch: 30, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.805 Vali Acc: 0.728 Test Loss: 0.805 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8197743892669678
Epoch: 31, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.772 Vali Acc: 0.750 Test Loss: 0.772 Test Acc: 0.750
Validation loss decreased (-0.738880 --> -0.749992).  Saving model ...
Epoch: 32 cost time: 0.8754453659057617
Epoch: 32, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.754 Vali Acc: 0.783 Test Loss: 0.754 Test Acc: 0.783
Validation loss decreased (-0.749992 --> -0.783326).  Saving model ...
Epoch: 33 cost time: 0.8133325576782227
Epoch: 33, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.716 Vali Acc: 0.767 Test Loss: 0.716 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9051384925842285
Epoch: 34, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.717 Vali Acc: 0.750 Test Loss: 0.717 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8278896808624268
Epoch: 35, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.676 Vali Acc: 0.783 Test Loss: 0.676 Test Acc: 0.783
Validation loss decreased (-0.783326 --> -0.783327).  Saving model ...
Epoch: 36 cost time: 0.77764892578125
Epoch: 36, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.646 Vali Acc: 0.789 Test Loss: 0.646 Test Acc: 0.789
Validation loss decreased (-0.783327 --> -0.788882).  Saving model ...
Epoch: 37 cost time: 0.892258882522583
Epoch: 37, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.607 Vali Acc: 0.811 Test Loss: 0.607 Test Acc: 0.811
Validation loss decreased (-0.788882 --> -0.811105).  Saving model ...
Epoch: 38 cost time: 0.9319930076599121
Epoch: 38, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.588 Vali Acc: 0.822 Test Loss: 0.588 Test Acc: 0.822
Validation loss decreased (-0.811105 --> -0.822216).  Saving model ...
Epoch: 39 cost time: 0.9005835056304932
Epoch: 39, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.600 Vali Acc: 0.833 Test Loss: 0.600 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833327).  Saving model ...
Epoch: 40 cost time: 0.8279597759246826
Epoch: 40, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.564 Vali Acc: 0.811 Test Loss: 0.564 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.853168249130249
Epoch: 41, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.548 Vali Acc: 0.822 Test Loss: 0.548 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.887298583984375
Epoch: 42, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.546 Vali Acc: 0.850 Test Loss: 0.546 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849995).  Saving model ...
Epoch: 43 cost time: 0.7809004783630371
Epoch: 43, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.554 Vali Acc: 0.856 Test Loss: 0.554 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855550).  Saving model ...
Epoch: 44 cost time: 0.9065923690795898
Epoch: 44, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.530 Vali Acc: 0.839 Test Loss: 0.530 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.9745512008666992
Epoch: 45, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.533 Vali Acc: 0.861 Test Loss: 0.533 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 46 cost time: 0.9864895343780518
Epoch: 46, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.528 Vali Acc: 0.861 Test Loss: 0.528 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 47 cost time: 0.8258867263793945
Epoch: 47, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.516 Vali Acc: 0.867 Test Loss: 0.516 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866662).  Saving model ...
Epoch: 48 cost time: 0.906691312789917
Epoch: 48, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.473 Vali Acc: 0.883 Test Loss: 0.473 Test Acc: 0.883
Validation loss decreased (-0.866662 --> -0.883329).  Saving model ...
Epoch: 49 cost time: 0.8834521770477295
Epoch: 49, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.490 Vali Acc: 0.883 Test Loss: 0.490 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.855379581451416
Epoch: 50, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.479 Vali Acc: 0.883 Test Loss: 0.479 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.8458797931671143
Epoch: 51, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.500 Vali Acc: 0.883 Test Loss: 0.500 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.8384411334991455
Epoch: 52, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.493 Vali Acc: 0.883 Test Loss: 0.493 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.7387495040893555
Epoch: 53, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.461 Vali Acc: 0.883 Test Loss: 0.461 Test Acc: 0.883
Validation loss decreased (-0.883329 --> -0.883329).  Saving model ...
Epoch: 54 cost time: 0.8908095359802246
Epoch: 54, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.464 Vali Acc: 0.872 Test Loss: 0.464 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.8362348079681396
Epoch: 55, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.443 Vali Acc: 0.878 Test Loss: 0.443 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.8105671405792236
Epoch: 56, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.473 Vali Acc: 0.883 Test Loss: 0.473 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.8179638385772705
Epoch: 57, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.475 Vali Acc: 0.889 Test Loss: 0.475 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888884).  Saving model ...
Epoch: 58 cost time: 0.814673662185669
Epoch: 58, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.467 Vali Acc: 0.878 Test Loss: 0.467 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.7937214374542236
Epoch: 59, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.464 Vali Acc: 0.878 Test Loss: 0.464 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.8576905727386475
Epoch: 60, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.494 Vali Acc: 0.878 Test Loss: 0.494 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.8643093109130859
Epoch: 61, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.438 Vali Acc: 0.889 Test Loss: 0.438 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 62 cost time: 0.8449716567993164
Epoch: 62, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.440 Vali Acc: 0.894 Test Loss: 0.440 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894440).  Saving model ...
Epoch: 63 cost time: 0.8480813503265381
Epoch: 63, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.473 Vali Acc: 0.878 Test Loss: 0.473 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.8047497272491455
Epoch: 64, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.463 Vali Acc: 0.894 Test Loss: 0.463 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.8877675533294678
Epoch: 65, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.451 Vali Acc: 0.894 Test Loss: 0.451 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.7924878597259521
Epoch: 66, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.435 Vali Acc: 0.900 Test Loss: 0.435 Test Acc: 0.900
Validation loss decreased (-0.894440 --> -0.899996).  Saving model ...
Epoch: 67 cost time: 0.843742847442627
Epoch: 67, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.464 Vali Acc: 0.900 Test Loss: 0.464 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.8086709976196289
Epoch: 68, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.430 Vali Acc: 0.894 Test Loss: 0.430 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.8488523960113525
Epoch: 69, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.451 Vali Acc: 0.894 Test Loss: 0.451 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.9455878734588623
Epoch: 70, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.492 Vali Acc: 0.889 Test Loss: 0.492 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.8641250133514404
Epoch: 71, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.495 Vali Acc: 0.889 Test Loss: 0.495 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.7611336708068848
Epoch: 72, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.468 Vali Acc: 0.894 Test Loss: 0.468 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.8777022361755371
Epoch: 73, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.483 Vali Acc: 0.900 Test Loss: 0.483 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 0.9039280414581299
Epoch: 74, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.478 Vali Acc: 0.894 Test Loss: 0.478 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 0.9565520286560059
Epoch: 75, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.514 Vali Acc: 0.883 Test Loss: 0.514 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 0.8686120510101318
Epoch: 76, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.498 Vali Acc: 0.872 Test Loss: 0.498 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 257447
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.566981792449951
Epoch: 1, Steps: 12 | Train Loss: 2.885 Vali Loss: 2.845 Vali Acc: 0.100 Test Loss: 2.845 Test Acc: 0.100
Validation loss decreased (inf --> -0.099972).  Saving model ...
Epoch: 2 cost time: 0.9315268993377686
Epoch: 2, Steps: 12 | Train Loss: 2.881 Vali Loss: 2.771 Vali Acc: 0.100 Test Loss: 2.771 Test Acc: 0.100
Validation loss decreased (-0.099972 --> -0.099972).  Saving model ...
Epoch: 3 cost time: 0.743058443069458
Epoch: 3, Steps: 12 | Train Loss: 2.764 Vali Loss: 2.703 Vali Acc: 0.117 Test Loss: 2.703 Test Acc: 0.117
Validation loss decreased (-0.099972 --> -0.116640).  Saving model ...
Epoch: 4 cost time: 0.9666581153869629
Epoch: 4, Steps: 12 | Train Loss: 2.655 Vali Loss: 2.652 Vali Acc: 0.150 Test Loss: 2.652 Test Acc: 0.150
Validation loss decreased (-0.116640 --> -0.149973).  Saving model ...
Epoch: 5 cost time: 0.8819658756256104
Epoch: 5, Steps: 12 | Train Loss: 2.642 Vali Loss: 2.590 Vali Acc: 0.217 Test Loss: 2.590 Test Acc: 0.217
Validation loss decreased (-0.149973 --> -0.216641).  Saving model ...
Epoch: 6 cost time: 1.0146386623382568
Epoch: 6, Steps: 12 | Train Loss: 2.511 Vali Loss: 2.533 Vali Acc: 0.289 Test Loss: 2.533 Test Acc: 0.289
Validation loss decreased (-0.216641 --> -0.288864).  Saving model ...
Epoch: 7 cost time: 0.9307012557983398
Epoch: 7, Steps: 12 | Train Loss: 2.485 Vali Loss: 2.458 Vali Acc: 0.328 Test Loss: 2.458 Test Acc: 0.328
Validation loss decreased (-0.288864 --> -0.327753).  Saving model ...
Epoch: 8 cost time: 0.8750321865081787
Epoch: 8, Steps: 12 | Train Loss: 2.399 Vali Loss: 2.370 Vali Acc: 0.361 Test Loss: 2.370 Test Acc: 0.361
Validation loss decreased (-0.327753 --> -0.361087).  Saving model ...
Epoch: 9 cost time: 0.7938029766082764
Epoch: 9, Steps: 12 | Train Loss: 2.282 Vali Loss: 2.274 Vali Acc: 0.433 Test Loss: 2.274 Test Acc: 0.433
Validation loss decreased (-0.361087 --> -0.433311).  Saving model ...
Epoch: 10 cost time: 0.7718555927276611
Epoch: 10, Steps: 12 | Train Loss: 2.134 Vali Loss: 2.172 Vali Acc: 0.478 Test Loss: 2.172 Test Acc: 0.478
Validation loss decreased (-0.433311 --> -0.477756).  Saving model ...
Epoch: 11 cost time: 0.8366177082061768
Epoch: 11, Steps: 12 | Train Loss: 2.060 Vali Loss: 2.063 Vali Acc: 0.522 Test Loss: 2.063 Test Acc: 0.522
Validation loss decreased (-0.477756 --> -0.522202).  Saving model ...
Epoch: 12 cost time: 0.9069797992706299
Epoch: 12, Steps: 12 | Train Loss: 1.865 Vali Loss: 1.952 Vali Acc: 0.528 Test Loss: 1.952 Test Acc: 0.528
Validation loss decreased (-0.522202 --> -0.527758).  Saving model ...
Epoch: 13 cost time: 0.9546811580657959
Epoch: 13, Steps: 12 | Train Loss: 1.760 Vali Loss: 1.820 Vali Acc: 0.533 Test Loss: 1.820 Test Acc: 0.533
Validation loss decreased (-0.527758 --> -0.533315).  Saving model ...
Epoch: 14 cost time: 1.0158543586730957
Epoch: 14, Steps: 12 | Train Loss: 1.613 Vali Loss: 1.711 Vali Acc: 0.572 Test Loss: 1.711 Test Acc: 0.572
Validation loss decreased (-0.533315 --> -0.572205).  Saving model ...
Epoch: 15 cost time: 0.9457099437713623
Epoch: 15, Steps: 12 | Train Loss: 1.471 Vali Loss: 1.626 Vali Acc: 0.567 Test Loss: 1.626 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8520207405090332
Epoch: 16, Steps: 12 | Train Loss: 1.375 Vali Loss: 1.530 Vali Acc: 0.567 Test Loss: 1.530 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1279914379119873
Epoch: 17, Steps: 12 | Train Loss: 1.258 Vali Loss: 1.447 Vali Acc: 0.583 Test Loss: 1.447 Test Acc: 0.583
Validation loss decreased (-0.572205 --> -0.583319).  Saving model ...
Epoch: 18 cost time: 0.9036526679992676
Epoch: 18, Steps: 12 | Train Loss: 1.163 Vali Loss: 1.363 Vali Acc: 0.606 Test Loss: 1.363 Test Acc: 0.606
Validation loss decreased (-0.583319 --> -0.605542).  Saving model ...
Epoch: 19 cost time: 0.9182767868041992
Epoch: 19, Steps: 12 | Train Loss: 1.146 Vali Loss: 1.282 Vali Acc: 0.606 Test Loss: 1.282 Test Acc: 0.606
Validation loss decreased (-0.605542 --> -0.605543).  Saving model ...
Epoch: 20 cost time: 0.9185009002685547
Epoch: 20, Steps: 12 | Train Loss: 1.108 Vali Loss: 1.199 Vali Acc: 0.622 Test Loss: 1.199 Test Acc: 0.622
Validation loss decreased (-0.605543 --> -0.622210).  Saving model ...
Epoch: 21 cost time: 0.8368804454803467
Epoch: 21, Steps: 12 | Train Loss: 0.950 Vali Loss: 1.135 Vali Acc: 0.628 Test Loss: 1.135 Test Acc: 0.628
Validation loss decreased (-0.622210 --> -0.627766).  Saving model ...
Epoch: 22 cost time: 0.8247246742248535
Epoch: 22, Steps: 12 | Train Loss: 0.924 Vali Loss: 1.057 Vali Acc: 0.689 Test Loss: 1.057 Test Acc: 0.689
Validation loss decreased (-0.627766 --> -0.688878).  Saving model ...
Epoch: 23 cost time: 0.8375999927520752
Epoch: 23, Steps: 12 | Train Loss: 0.873 Vali Loss: 1.011 Vali Acc: 0.678 Test Loss: 1.011 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8942313194274902
Epoch: 24, Steps: 12 | Train Loss: 0.766 Vali Loss: 0.959 Vali Acc: 0.711 Test Loss: 0.959 Test Acc: 0.711
Validation loss decreased (-0.688878 --> -0.711102).  Saving model ...
Epoch: 25 cost time: 0.8487043380737305
Epoch: 25, Steps: 12 | Train Loss: 0.736 Vali Loss: 0.911 Vali Acc: 0.750 Test Loss: 0.911 Test Acc: 0.750
Validation loss decreased (-0.711102 --> -0.749991).  Saving model ...
Epoch: 26 cost time: 0.8697237968444824
Epoch: 26, Steps: 12 | Train Loss: 0.701 Vali Loss: 0.873 Vali Acc: 0.744 Test Loss: 0.873 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7938416004180908
Epoch: 27, Steps: 12 | Train Loss: 0.704 Vali Loss: 0.832 Vali Acc: 0.761 Test Loss: 0.832 Test Acc: 0.761
Validation loss decreased (-0.749991 --> -0.761103).  Saving model ...
Epoch: 28 cost time: 0.9237797260284424
Epoch: 28, Steps: 12 | Train Loss: 0.646 Vali Loss: 0.807 Vali Acc: 0.761 Test Loss: 0.807 Test Acc: 0.761
Validation loss decreased (-0.761103 --> -0.761103).  Saving model ...
Epoch: 29 cost time: 0.9128208160400391
Epoch: 29, Steps: 12 | Train Loss: 0.573 Vali Loss: 0.787 Vali Acc: 0.772 Test Loss: 0.787 Test Acc: 0.772
Validation loss decreased (-0.761103 --> -0.772214).  Saving model ...
Epoch: 30 cost time: 0.8581995964050293
Epoch: 30, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.743 Vali Acc: 0.772 Test Loss: 0.743 Test Acc: 0.772
Validation loss decreased (-0.772214 --> -0.772215).  Saving model ...
Epoch: 31 cost time: 0.8307595252990723
Epoch: 31, Steps: 12 | Train Loss: 0.495 Vali Loss: 0.717 Vali Acc: 0.806 Test Loss: 0.717 Test Acc: 0.806
Validation loss decreased (-0.772215 --> -0.805548).  Saving model ...
Epoch: 32 cost time: 0.8727381229400635
Epoch: 32, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.695 Vali Acc: 0.783 Test Loss: 0.695 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8152122497558594
Epoch: 33, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.683 Vali Acc: 0.806 Test Loss: 0.683 Test Acc: 0.806
Validation loss decreased (-0.805548 --> -0.805549).  Saving model ...
Epoch: 34 cost time: 0.8530824184417725
Epoch: 34, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.662 Vali Acc: 0.817 Test Loss: 0.662 Test Acc: 0.817
Validation loss decreased (-0.805549 --> -0.816660).  Saving model ...
Epoch: 35 cost time: 0.829146146774292
Epoch: 35, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.634 Vali Acc: 0.828 Test Loss: 0.634 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827771).  Saving model ...
Epoch: 36 cost time: 0.8861203193664551
Epoch: 36, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.639 Vali Acc: 0.822 Test Loss: 0.639 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7579488754272461
Epoch: 37, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.595 Vali Acc: 0.833 Test Loss: 0.595 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 38 cost time: 1.056732416152954
Epoch: 38, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.583 Vali Acc: 0.828 Test Loss: 0.583 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0504415035247803
Epoch: 39, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.558 Vali Acc: 0.828 Test Loss: 0.558 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.0458285808563232
Epoch: 40, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.580 Vali Acc: 0.828 Test Loss: 0.580 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.0829577445983887
Epoch: 41, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.577 Vali Acc: 0.833 Test Loss: 0.577 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833328).  Saving model ...
Epoch: 42 cost time: 0.8653490543365479
Epoch: 42, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.555 Vali Acc: 0.856 Test Loss: 0.555 Test Acc: 0.856
Validation loss decreased (-0.833328 --> -0.855550).  Saving model ...
Epoch: 43 cost time: 0.8719708919525146
Epoch: 43, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.558 Vali Acc: 0.861 Test Loss: 0.558 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 44 cost time: 1.0876476764678955
Epoch: 44, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.552 Vali Acc: 0.856 Test Loss: 0.552 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8946080207824707
Epoch: 45, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.532 Vali Acc: 0.861 Test Loss: 0.532 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 46 cost time: 0.903214693069458
Epoch: 46, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.563 Vali Acc: 0.867 Test Loss: 0.563 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 47 cost time: 0.849513053894043
Epoch: 47, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.544 Vali Acc: 0.872 Test Loss: 0.544 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 48 cost time: 0.8418605327606201
Epoch: 48, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.514 Vali Acc: 0.856 Test Loss: 0.514 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8112940788269043
Epoch: 49, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.523 Vali Acc: 0.861 Test Loss: 0.523 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.9660277366638184
Epoch: 50, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.540 Vali Acc: 0.872 Test Loss: 0.540 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 51 cost time: 0.8380312919616699
Epoch: 51, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.495 Vali Acc: 0.867 Test Loss: 0.495 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.8576486110687256
Epoch: 52, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.496 Vali Acc: 0.861 Test Loss: 0.496 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.9500231742858887
Epoch: 53, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.501 Vali Acc: 0.878 Test Loss: 0.501 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 54 cost time: 0.8069298267364502
Epoch: 54, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.517 Vali Acc: 0.867 Test Loss: 0.517 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.744060754776001
Epoch: 55, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.547 Vali Acc: 0.861 Test Loss: 0.547 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.7642238140106201
Epoch: 56, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.517 Vali Acc: 0.878 Test Loss: 0.517 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.8563015460968018
Epoch: 57, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.496 Vali Acc: 0.883 Test Loss: 0.496 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883328).  Saving model ...
Epoch: 58 cost time: 0.7413418292999268
Epoch: 58, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.508 Vali Acc: 0.872 Test Loss: 0.508 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.8332116603851318
Epoch: 59, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.536 Vali Acc: 0.861 Test Loss: 0.536 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.8289120197296143
Epoch: 60, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.527 Vali Acc: 0.889 Test Loss: 0.527 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888884).  Saving model ...
Epoch: 61 cost time: 0.8599984645843506
Epoch: 61, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.532 Vali Acc: 0.878 Test Loss: 0.532 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.0375633239746094
Epoch: 62, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.522 Vali Acc: 0.889 Test Loss: 0.522 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 63 cost time: 1.0068950653076172
Epoch: 63, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.530 Vali Acc: 0.883 Test Loss: 0.530 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.9574098587036133
Epoch: 64, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.505 Vali Acc: 0.867 Test Loss: 0.505 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.8627955913543701
Epoch: 65, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.559 Vali Acc: 0.867 Test Loss: 0.559 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.106710433959961
Epoch: 66, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.515 Vali Acc: 0.883 Test Loss: 0.515 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.9184186458587646
Epoch: 67, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.529 Vali Acc: 0.867 Test Loss: 0.529 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 1.0881643295288086
Epoch: 68, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.542 Vali Acc: 0.894 Test Loss: 0.542 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894439).  Saving model ...
Epoch: 69 cost time: 1.0658814907073975
Epoch: 69, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.523 Vali Acc: 0.883 Test Loss: 0.523 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.8322756290435791
Epoch: 70, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.530 Vali Acc: 0.883 Test Loss: 0.530 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 1.0811419486999512
Epoch: 71, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.520 Vali Acc: 0.883 Test Loss: 0.520 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.8519198894500732
Epoch: 72, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.517 Vali Acc: 0.878 Test Loss: 0.517 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 1.1533315181732178
Epoch: 73, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.536 Vali Acc: 0.878 Test Loss: 0.536 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 1.0598556995391846
Epoch: 74, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.544 Vali Acc: 0.894 Test Loss: 0.544 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 0.9115016460418701
Epoch: 75, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.541 Vali Acc: 0.894 Test Loss: 0.541 Test Acc: 0.894
Validation loss decreased (-0.894439 --> -0.894439).  Saving model ...
Epoch: 76 cost time: 0.8517873287200928
Epoch: 76, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.529 Vali Acc: 0.894 Test Loss: 0.529 Test Acc: 0.894
Validation loss decreased (-0.894439 --> -0.894439).  Saving model ...
Epoch: 77 cost time: 0.8439879417419434
Epoch: 77, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.532 Vali Acc: 0.894 Test Loss: 0.532 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.7939107418060303
Epoch: 78, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.538 Vali Acc: 0.894 Test Loss: 0.538 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 0.8912687301635742
Epoch: 79, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.536 Vali Acc: 0.883 Test Loss: 0.536 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 0.9009463787078857
Epoch: 80, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.563 Vali Acc: 0.878 Test Loss: 0.563 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 1.0775220394134521
Epoch: 81, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.586 Vali Acc: 0.878 Test Loss: 0.586 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 0.933434247970581
Epoch: 82, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.582 Vali Acc: 0.883 Test Loss: 0.582 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 83 cost time: 0.9770541191101074
Epoch: 83, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.567 Vali Acc: 0.883 Test Loss: 0.567 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 84 cost time: 0.82403564453125
Epoch: 84, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.559 Vali Acc: 0.900 Test Loss: 0.559 Test Acc: 0.900
Validation loss decreased (-0.894439 --> -0.899994).  Saving model ...
Epoch: 85 cost time: 0.9512159824371338
Epoch: 85, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.594 Vali Acc: 0.900 Test Loss: 0.594 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 0.954840898513794
Epoch: 86, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.584 Vali Acc: 0.894 Test Loss: 0.584 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 1.0312573909759521
Epoch: 87, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.572 Vali Acc: 0.872 Test Loss: 0.572 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 0.9990477561950684
Epoch: 88, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.586 Vali Acc: 0.894 Test Loss: 0.586 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 1.0628142356872559
Epoch: 89, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.602 Vali Acc: 0.883 Test Loss: 0.602 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 1.0437533855438232
Epoch: 90, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.592 Vali Acc: 0.878 Test Loss: 0.592 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 91 cost time: 0.9786615371704102
Epoch: 91, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.587 Vali Acc: 0.883 Test Loss: 0.587 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 92 cost time: 1.0722548961639404
Epoch: 92, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.602 Vali Acc: 0.883 Test Loss: 0.602 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 93 cost time: 0.7927553653717041
Epoch: 93, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.558 Vali Acc: 0.889 Test Loss: 0.558 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 94 cost time: 0.8550691604614258
Epoch: 94, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.536 Vali Acc: 0.894 Test Loss: 0.536 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 257319
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2695963382720947
Epoch: 1, Steps: 12 | Train Loss: 2.786 Vali Loss: 2.806 Vali Acc: 0.094 Test Loss: 2.806 Test Acc: 0.094
Validation loss decreased (inf --> -0.094416).  Saving model ...
Epoch: 2 cost time: 0.7913689613342285
Epoch: 2, Steps: 12 | Train Loss: 2.795 Vali Loss: 2.739 Vali Acc: 0.083 Test Loss: 2.739 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7020530700683594
Epoch: 3, Steps: 12 | Train Loss: 2.739 Vali Loss: 2.673 Vali Acc: 0.106 Test Loss: 2.673 Test Acc: 0.106
Validation loss decreased (-0.094416 --> -0.105529).  Saving model ...
Epoch: 4 cost time: 0.847822904586792
Epoch: 4, Steps: 12 | Train Loss: 2.661 Vali Loss: 2.609 Vali Acc: 0.156 Test Loss: 2.609 Test Acc: 0.156
Validation loss decreased (-0.105529 --> -0.155529).  Saving model ...
Epoch: 5 cost time: 0.950505256652832
Epoch: 5, Steps: 12 | Train Loss: 2.583 Vali Loss: 2.555 Vali Acc: 0.178 Test Loss: 2.555 Test Acc: 0.178
Validation loss decreased (-0.155529 --> -0.177752).  Saving model ...
Epoch: 6 cost time: 0.8387176990509033
Epoch: 6, Steps: 12 | Train Loss: 2.496 Vali Loss: 2.503 Vali Acc: 0.267 Test Loss: 2.503 Test Acc: 0.267
Validation loss decreased (-0.177752 --> -0.266642).  Saving model ...
Epoch: 7 cost time: 0.810985803604126
Epoch: 7, Steps: 12 | Train Loss: 2.493 Vali Loss: 2.440 Vali Acc: 0.244 Test Loss: 2.440 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8471677303314209
Epoch: 8, Steps: 12 | Train Loss: 2.355 Vali Loss: 2.358 Vali Acc: 0.311 Test Loss: 2.358 Test Acc: 0.311
Validation loss decreased (-0.266642 --> -0.311088).  Saving model ...
Epoch: 9 cost time: 0.8668489456176758
Epoch: 9, Steps: 12 | Train Loss: 2.278 Vali Loss: 2.272 Vali Acc: 0.378 Test Loss: 2.272 Test Acc: 0.378
Validation loss decreased (-0.311088 --> -0.377755).  Saving model ...
Epoch: 10 cost time: 0.8657491207122803
Epoch: 10, Steps: 12 | Train Loss: 2.139 Vali Loss: 2.169 Vali Acc: 0.422 Test Loss: 2.169 Test Acc: 0.422
Validation loss decreased (-0.377755 --> -0.422201).  Saving model ...
Epoch: 11 cost time: 0.7911167144775391
Epoch: 11, Steps: 12 | Train Loss: 2.053 Vali Loss: 2.076 Vali Acc: 0.483 Test Loss: 2.076 Test Acc: 0.483
Validation loss decreased (-0.422201 --> -0.483313).  Saving model ...
Epoch: 12 cost time: 0.8046927452087402
Epoch: 12, Steps: 12 | Train Loss: 1.911 Vali Loss: 1.953 Vali Acc: 0.483 Test Loss: 1.953 Test Acc: 0.483
Validation loss decreased (-0.483313 --> -0.483314).  Saving model ...
Epoch: 13 cost time: 0.8923037052154541
Epoch: 13, Steps: 12 | Train Loss: 1.759 Vali Loss: 1.854 Vali Acc: 0.500 Test Loss: 1.854 Test Acc: 0.500
Validation loss decreased (-0.483314 --> -0.499981).  Saving model ...
Epoch: 14 cost time: 0.8131759166717529
Epoch: 14, Steps: 12 | Train Loss: 1.643 Vali Loss: 1.766 Vali Acc: 0.528 Test Loss: 1.766 Test Acc: 0.528
Validation loss decreased (-0.499981 --> -0.527760).  Saving model ...
Epoch: 15 cost time: 0.8570401668548584
Epoch: 15, Steps: 12 | Train Loss: 1.561 Vali Loss: 1.671 Vali Acc: 0.522 Test Loss: 1.671 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9061503410339355
Epoch: 16, Steps: 12 | Train Loss: 1.393 Vali Loss: 1.581 Vali Acc: 0.556 Test Loss: 1.581 Test Acc: 0.556
Validation loss decreased (-0.527760 --> -0.555540).  Saving model ...
Epoch: 17 cost time: 0.8911833763122559
Epoch: 17, Steps: 12 | Train Loss: 1.292 Vali Loss: 1.498 Vali Acc: 0.567 Test Loss: 1.498 Test Acc: 0.567
Validation loss decreased (-0.555540 --> -0.566652).  Saving model ...
Epoch: 18 cost time: 0.8513362407684326
Epoch: 18, Steps: 12 | Train Loss: 1.226 Vali Loss: 1.436 Vali Acc: 0.589 Test Loss: 1.436 Test Acc: 0.589
Validation loss decreased (-0.566652 --> -0.588875).  Saving model ...
Epoch: 19 cost time: 0.7969958782196045
Epoch: 19, Steps: 12 | Train Loss: 1.118 Vali Loss: 1.351 Vali Acc: 0.600 Test Loss: 1.351 Test Acc: 0.600
Validation loss decreased (-0.588875 --> -0.599986).  Saving model ...
Epoch: 20 cost time: 0.8223834037780762
Epoch: 20, Steps: 12 | Train Loss: 1.054 Vali Loss: 1.290 Vali Acc: 0.639 Test Loss: 1.290 Test Acc: 0.639
Validation loss decreased (-0.599986 --> -0.638876).  Saving model ...
Epoch: 21 cost time: 0.7401933670043945
Epoch: 21, Steps: 12 | Train Loss: 1.052 Vali Loss: 1.207 Vali Acc: 0.644 Test Loss: 1.207 Test Acc: 0.644
Validation loss decreased (-0.638876 --> -0.644432).  Saving model ...
Epoch: 22 cost time: 0.9011118412017822
Epoch: 22, Steps: 12 | Train Loss: 0.968 Vali Loss: 1.159 Vali Acc: 0.656 Test Loss: 1.159 Test Acc: 0.656
Validation loss decreased (-0.644432 --> -0.655544).  Saving model ...
Epoch: 23 cost time: 0.7869133949279785
Epoch: 23, Steps: 12 | Train Loss: 0.887 Vali Loss: 1.086 Vali Acc: 0.678 Test Loss: 1.086 Test Acc: 0.678
Validation loss decreased (-0.655544 --> -0.677767).  Saving model ...
Epoch: 24 cost time: 0.8267905712127686
Epoch: 24, Steps: 12 | Train Loss: 0.850 Vali Loss: 1.045 Vali Acc: 0.672 Test Loss: 1.045 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9428596496582031
Epoch: 25, Steps: 12 | Train Loss: 0.788 Vali Loss: 0.989 Vali Acc: 0.722 Test Loss: 0.989 Test Acc: 0.722
Validation loss decreased (-0.677767 --> -0.722212).  Saving model ...
Epoch: 26 cost time: 0.934502124786377
Epoch: 26, Steps: 12 | Train Loss: 0.739 Vali Loss: 0.966 Vali Acc: 0.717 Test Loss: 0.966 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9780526161193848
Epoch: 27, Steps: 12 | Train Loss: 0.675 Vali Loss: 0.923 Vali Acc: 0.728 Test Loss: 0.923 Test Acc: 0.728
Validation loss decreased (-0.722212 --> -0.727769).  Saving model ...
Epoch: 28 cost time: 0.9185869693756104
Epoch: 28, Steps: 12 | Train Loss: 0.650 Vali Loss: 0.880 Vali Acc: 0.728 Test Loss: 0.880 Test Acc: 0.728
Validation loss decreased (-0.727769 --> -0.727769).  Saving model ...
Epoch: 29 cost time: 0.8128254413604736
Epoch: 29, Steps: 12 | Train Loss: 0.620 Vali Loss: 0.828 Vali Acc: 0.750 Test Loss: 0.828 Test Acc: 0.750
Validation loss decreased (-0.727769 --> -0.749992).  Saving model ...
Epoch: 30 cost time: 0.7762141227722168
Epoch: 30, Steps: 12 | Train Loss: 0.582 Vali Loss: 0.814 Vali Acc: 0.767 Test Loss: 0.814 Test Acc: 0.767
Validation loss decreased (-0.749992 --> -0.766659).  Saving model ...
Epoch: 31 cost time: 0.7318737506866455
Epoch: 31, Steps: 12 | Train Loss: 0.511 Vali Loss: 0.780 Vali Acc: 0.756 Test Loss: 0.780 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7914102077484131
Epoch: 32, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.758 Vali Acc: 0.772 Test Loss: 0.758 Test Acc: 0.772
Validation loss decreased (-0.766659 --> -0.772215).  Saving model ...
Epoch: 33 cost time: 0.8206183910369873
Epoch: 33, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.727 Vali Acc: 0.772 Test Loss: 0.727 Test Acc: 0.772
Validation loss decreased (-0.772215 --> -0.772215).  Saving model ...
Epoch: 34 cost time: 1.007922649383545
Epoch: 34, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.711 Vali Acc: 0.794 Test Loss: 0.711 Test Acc: 0.794
Validation loss decreased (-0.772215 --> -0.794437).  Saving model ...
Epoch: 35 cost time: 1.0537357330322266
Epoch: 35, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.678 Vali Acc: 0.789 Test Loss: 0.678 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8760151863098145
Epoch: 36, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.653 Vali Acc: 0.794 Test Loss: 0.653 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794438).  Saving model ...
Epoch: 37 cost time: 0.844306230545044
Epoch: 37, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.606 Vali Acc: 0.794 Test Loss: 0.606 Test Acc: 0.794
Validation loss decreased (-0.794438 --> -0.794438).  Saving model ...
Epoch: 38 cost time: 0.886538028717041
Epoch: 38, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.613 Vali Acc: 0.806 Test Loss: 0.613 Test Acc: 0.806
Validation loss decreased (-0.794438 --> -0.805549).  Saving model ...
Epoch: 39 cost time: 0.7948548793792725
Epoch: 39, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.605 Vali Acc: 0.800 Test Loss: 0.605 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7778363227844238
Epoch: 40, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.594 Vali Acc: 0.806 Test Loss: 0.594 Test Acc: 0.806
Validation loss decreased (-0.805549 --> -0.805550).  Saving model ...
Epoch: 41 cost time: 0.8278913497924805
Epoch: 41, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.579 Vali Acc: 0.828 Test Loss: 0.579 Test Acc: 0.828
Validation loss decreased (-0.805550 --> -0.827772).  Saving model ...
Epoch: 42 cost time: 0.7219643592834473
Epoch: 42, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.573 Vali Acc: 0.828 Test Loss: 0.573 Test Acc: 0.828
Validation loss decreased (-0.827772 --> -0.827772).  Saving model ...
Epoch: 43 cost time: 0.837609052658081
Epoch: 43, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.551 Vali Acc: 0.828 Test Loss: 0.551 Test Acc: 0.828
Validation loss decreased (-0.827772 --> -0.827772).  Saving model ...
Epoch: 44 cost time: 0.9650745391845703
Epoch: 44, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.549 Vali Acc: 0.833 Test Loss: 0.549 Test Acc: 0.833
Validation loss decreased (-0.827772 --> -0.833328).  Saving model ...
Epoch: 45 cost time: 0.8308343887329102
Epoch: 45, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.558 Vali Acc: 0.828 Test Loss: 0.558 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8251590728759766
Epoch: 46, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.558 Vali Acc: 0.822 Test Loss: 0.558 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.9809093475341797
Epoch: 47, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.522 Vali Acc: 0.850 Test Loss: 0.522 Test Acc: 0.850
Validation loss decreased (-0.833328 --> -0.849995).  Saving model ...
Epoch: 48 cost time: 0.6655483245849609
Epoch: 48, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.542 Vali Acc: 0.850 Test Loss: 0.542 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.9306480884552002
Epoch: 49, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.543 Vali Acc: 0.833 Test Loss: 0.543 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.8490302562713623
Epoch: 50, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.526 Vali Acc: 0.850 Test Loss: 0.526 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.9061417579650879
Epoch: 51, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.538 Vali Acc: 0.844 Test Loss: 0.538 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.9189431667327881
Epoch: 52, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.546 Vali Acc: 0.850 Test Loss: 0.546 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.8145632743835449
Epoch: 53, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.510 Vali Acc: 0.856 Test Loss: 0.510 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855550).  Saving model ...
Epoch: 54 cost time: 0.8781347274780273
Epoch: 54, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.514 Vali Acc: 0.861 Test Loss: 0.514 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 55 cost time: 0.776414155960083
Epoch: 55, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.525 Vali Acc: 0.856 Test Loss: 0.525 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.8391988277435303
Epoch: 56, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.512 Vali Acc: 0.856 Test Loss: 0.512 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.8305437564849854
Epoch: 57, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.517 Vali Acc: 0.867 Test Loss: 0.517 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 58 cost time: 0.7008190155029297
Epoch: 58, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.516 Vali Acc: 0.856 Test Loss: 0.516 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.7246212959289551
Epoch: 59, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.529 Vali Acc: 0.867 Test Loss: 0.529 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.8926718235015869
Epoch: 60, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.506 Vali Acc: 0.861 Test Loss: 0.506 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.8485801219940186
Epoch: 61, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.505 Vali Acc: 0.867 Test Loss: 0.505 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866662).  Saving model ...
Epoch: 62 cost time: 1.0543112754821777
Epoch: 62, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.518 Vali Acc: 0.878 Test Loss: 0.518 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877773).  Saving model ...
Epoch: 63 cost time: 0.9117951393127441
Epoch: 63, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.539 Vali Acc: 0.878 Test Loss: 0.539 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.8027029037475586
Epoch: 64, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.531 Vali Acc: 0.883 Test Loss: 0.531 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883328).  Saving model ...
Epoch: 65 cost time: 0.8654575347900391
Epoch: 65, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.531 Vali Acc: 0.861 Test Loss: 0.531 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.8804266452789307
Epoch: 66, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.545 Vali Acc: 0.872 Test Loss: 0.545 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.7623498439788818
Epoch: 67, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.536 Vali Acc: 0.878 Test Loss: 0.536 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.7907788753509521
Epoch: 68, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.506 Vali Acc: 0.867 Test Loss: 0.506 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 0.866722583770752
Epoch: 69, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.561 Vali Acc: 0.850 Test Loss: 0.561 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 0.8420939445495605
Epoch: 70, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.524 Vali Acc: 0.867 Test Loss: 0.524 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 0.8847031593322754
Epoch: 71, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.548 Vali Acc: 0.867 Test Loss: 0.548 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 0.9575119018554688
Epoch: 72, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.528 Vali Acc: 0.872 Test Loss: 0.528 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 0.8429138660430908
Epoch: 73, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.539 Vali Acc: 0.867 Test Loss: 0.539 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 0.8752586841583252
Epoch: 74, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.565 Vali Acc: 0.867 Test Loss: 0.565 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 257191
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.371755361557007
Epoch: 1, Steps: 12 | Train Loss: 2.809 Vali Loss: 2.773 Vali Acc: 0.022 Test Loss: 2.773 Test Acc: 0.022
Validation loss decreased (inf --> -0.022194).  Saving model ...
Epoch: 2 cost time: 0.7501072883605957
Epoch: 2, Steps: 12 | Train Loss: 2.739 Vali Loss: 2.703 Vali Acc: 0.017 Test Loss: 2.703 Test Acc: 0.017
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7174928188323975
Epoch: 3, Steps: 12 | Train Loss: 2.699 Vali Loss: 2.634 Vali Acc: 0.083 Test Loss: 2.634 Test Acc: 0.083
Validation loss decreased (-0.022194 --> -0.083307).  Saving model ...
Epoch: 4 cost time: 0.7555809020996094
Epoch: 4, Steps: 12 | Train Loss: 2.632 Vali Loss: 2.577 Vali Acc: 0.161 Test Loss: 2.577 Test Acc: 0.161
Validation loss decreased (-0.083307 --> -0.161085).  Saving model ...
Epoch: 5 cost time: 0.8504750728607178
Epoch: 5, Steps: 12 | Train Loss: 2.573 Vali Loss: 2.522 Vali Acc: 0.211 Test Loss: 2.522 Test Acc: 0.211
Validation loss decreased (-0.161085 --> -0.211086).  Saving model ...
Epoch: 6 cost time: 0.797438383102417
Epoch: 6, Steps: 12 | Train Loss: 2.510 Vali Loss: 2.468 Vali Acc: 0.256 Test Loss: 2.468 Test Acc: 0.256
Validation loss decreased (-0.211086 --> -0.255531).  Saving model ...
Epoch: 7 cost time: 0.8214619159698486
Epoch: 7, Steps: 12 | Train Loss: 2.468 Vali Loss: 2.405 Vali Acc: 0.306 Test Loss: 2.405 Test Acc: 0.306
Validation loss decreased (-0.255531 --> -0.305532).  Saving model ...
Epoch: 8 cost time: 0.8788962364196777
Epoch: 8, Steps: 12 | Train Loss: 2.311 Vali Loss: 2.319 Vali Acc: 0.406 Test Loss: 2.319 Test Acc: 0.406
Validation loss decreased (-0.305532 --> -0.405532).  Saving model ...
Epoch: 9 cost time: 0.9374532699584961
Epoch: 9, Steps: 12 | Train Loss: 2.245 Vali Loss: 2.223 Vali Acc: 0.422 Test Loss: 2.223 Test Acc: 0.422
Validation loss decreased (-0.405532 --> -0.422200).  Saving model ...
Epoch: 10 cost time: 0.8887567520141602
Epoch: 10, Steps: 12 | Train Loss: 2.101 Vali Loss: 2.113 Vali Acc: 0.478 Test Loss: 2.113 Test Acc: 0.478
Validation loss decreased (-0.422200 --> -0.477757).  Saving model ...
Epoch: 11 cost time: 0.9679174423217773
Epoch: 11, Steps: 12 | Train Loss: 1.956 Vali Loss: 2.009 Vali Acc: 0.483 Test Loss: 2.009 Test Acc: 0.483
Validation loss decreased (-0.477757 --> -0.483313).  Saving model ...
Epoch: 12 cost time: 0.807823896408081
Epoch: 12, Steps: 12 | Train Loss: 1.787 Vali Loss: 1.897 Vali Acc: 0.533 Test Loss: 1.897 Test Acc: 0.533
Validation loss decreased (-0.483313 --> -0.533314).  Saving model ...
Epoch: 13 cost time: 0.7346718311309814
Epoch: 13, Steps: 12 | Train Loss: 1.702 Vali Loss: 1.781 Vali Acc: 0.522 Test Loss: 1.781 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8373384475708008
Epoch: 14, Steps: 12 | Train Loss: 1.556 Vali Loss: 1.688 Vali Acc: 0.556 Test Loss: 1.688 Test Acc: 0.556
Validation loss decreased (-0.533314 --> -0.555539).  Saving model ...
Epoch: 15 cost time: 0.8654561042785645
Epoch: 15, Steps: 12 | Train Loss: 1.457 Vali Loss: 1.599 Vali Acc: 0.550 Test Loss: 1.599 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9657361507415771
Epoch: 16, Steps: 12 | Train Loss: 1.380 Vali Loss: 1.506 Vali Acc: 0.589 Test Loss: 1.506 Test Acc: 0.589
Validation loss decreased (-0.555539 --> -0.588874).  Saving model ...
Epoch: 17 cost time: 0.7954466342926025
Epoch: 17, Steps: 12 | Train Loss: 1.290 Vali Loss: 1.419 Vali Acc: 0.600 Test Loss: 1.419 Test Acc: 0.600
Validation loss decreased (-0.588874 --> -0.599986).  Saving model ...
Epoch: 18 cost time: 0.7883012294769287
Epoch: 18, Steps: 12 | Train Loss: 1.167 Vali Loss: 1.349 Vali Acc: 0.628 Test Loss: 1.349 Test Acc: 0.628
Validation loss decreased (-0.599986 --> -0.627764).  Saving model ...
Epoch: 19 cost time: 0.8353433609008789
Epoch: 19, Steps: 12 | Train Loss: 1.100 Vali Loss: 1.280 Vali Acc: 0.622 Test Loss: 1.280 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8412940502166748
Epoch: 20, Steps: 12 | Train Loss: 1.010 Vali Loss: 1.203 Vali Acc: 0.633 Test Loss: 1.203 Test Acc: 0.633
Validation loss decreased (-0.627764 --> -0.633321).  Saving model ...
Epoch: 21 cost time: 0.9302425384521484
Epoch: 21, Steps: 12 | Train Loss: 0.922 Vali Loss: 1.156 Vali Acc: 0.672 Test Loss: 1.156 Test Acc: 0.672
Validation loss decreased (-0.633321 --> -0.672211).  Saving model ...
Epoch: 22 cost time: 0.7987704277038574
Epoch: 22, Steps: 12 | Train Loss: 0.922 Vali Loss: 1.111 Vali Acc: 0.661 Test Loss: 1.111 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8684115409851074
Epoch: 23, Steps: 12 | Train Loss: 0.831 Vali Loss: 1.053 Vali Acc: 0.689 Test Loss: 1.053 Test Acc: 0.689
Validation loss decreased (-0.672211 --> -0.688878).  Saving model ...
Epoch: 24 cost time: 0.9196672439575195
Epoch: 24, Steps: 12 | Train Loss: 0.815 Vali Loss: 0.994 Vali Acc: 0.700 Test Loss: 0.994 Test Acc: 0.700
Validation loss decreased (-0.688878 --> -0.699990).  Saving model ...
Epoch: 25 cost time: 0.8832433223724365
Epoch: 25, Steps: 12 | Train Loss: 0.761 Vali Loss: 0.949 Vali Acc: 0.711 Test Loss: 0.949 Test Acc: 0.711
Validation loss decreased (-0.699990 --> -0.711102).  Saving model ...
Epoch: 26 cost time: 0.8264114856719971
Epoch: 26, Steps: 12 | Train Loss: 0.729 Vali Loss: 0.906 Vali Acc: 0.744 Test Loss: 0.906 Test Acc: 0.744
Validation loss decreased (-0.711102 --> -0.744435).  Saving model ...
Epoch: 27 cost time: 0.8813228607177734
Epoch: 27, Steps: 12 | Train Loss: 0.624 Vali Loss: 0.883 Vali Acc: 0.750 Test Loss: 0.883 Test Acc: 0.750
Validation loss decreased (-0.744435 --> -0.749991).  Saving model ...
Epoch: 28 cost time: 0.903773307800293
Epoch: 28, Steps: 12 | Train Loss: 0.643 Vali Loss: 0.819 Vali Acc: 0.772 Test Loss: 0.819 Test Acc: 0.772
Validation loss decreased (-0.749991 --> -0.772214).  Saving model ...
Epoch: 29 cost time: 0.894554853439331
Epoch: 29, Steps: 12 | Train Loss: 0.556 Vali Loss: 0.807 Vali Acc: 0.761 Test Loss: 0.807 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9036502838134766
Epoch: 30, Steps: 12 | Train Loss: 0.587 Vali Loss: 0.785 Vali Acc: 0.789 Test Loss: 0.785 Test Acc: 0.789
Validation loss decreased (-0.772214 --> -0.788881).  Saving model ...
Epoch: 31 cost time: 0.8601274490356445
Epoch: 31, Steps: 12 | Train Loss: 0.531 Vali Loss: 0.738 Vali Acc: 0.772 Test Loss: 0.738 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0584635734558105
Epoch: 32, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.737 Vali Acc: 0.783 Test Loss: 0.737 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8903331756591797
Epoch: 33, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.698 Vali Acc: 0.794 Test Loss: 0.698 Test Acc: 0.794
Validation loss decreased (-0.788881 --> -0.794437).  Saving model ...
Epoch: 34 cost time: 0.874147891998291
Epoch: 34, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.698 Vali Acc: 0.794 Test Loss: 0.698 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8443019390106201
Epoch: 35, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.657 Vali Acc: 0.800 Test Loss: 0.657 Test Acc: 0.800
Validation loss decreased (-0.794437 --> -0.799993).  Saving model ...
Epoch: 36 cost time: 1.1195917129516602
Epoch: 36, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.648 Vali Acc: 0.822 Test Loss: 0.648 Test Acc: 0.822
Validation loss decreased (-0.799993 --> -0.822216).  Saving model ...
Epoch: 37 cost time: 0.8411037921905518
Epoch: 37, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.616 Vali Acc: 0.822 Test Loss: 0.616 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 38 cost time: 0.9563248157501221
Epoch: 38, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.603 Vali Acc: 0.839 Test Loss: 0.603 Test Acc: 0.839
Validation loss decreased (-0.822216 --> -0.838883).  Saving model ...
Epoch: 39 cost time: 0.8525588512420654
Epoch: 39, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.593 Vali Acc: 0.833 Test Loss: 0.593 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8097944259643555
Epoch: 40, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.596 Vali Acc: 0.839 Test Loss: 0.596 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 41 cost time: 0.7993724346160889
Epoch: 41, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.553 Vali Acc: 0.828 Test Loss: 0.553 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8793699741363525
Epoch: 42, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.582 Vali Acc: 0.833 Test Loss: 0.582 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.8337488174438477
Epoch: 43, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.563 Vali Acc: 0.839 Test Loss: 0.563 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 44 cost time: 0.8671748638153076
Epoch: 44, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.565 Vali Acc: 0.839 Test Loss: 0.565 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8915998935699463
Epoch: 45, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.561 Vali Acc: 0.844 Test Loss: 0.561 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 46 cost time: 0.9699864387512207
Epoch: 46, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.543 Vali Acc: 0.861 Test Loss: 0.543 Test Acc: 0.861
Validation loss decreased (-0.844439 --> -0.861106).  Saving model ...
Epoch: 47 cost time: 0.820758581161499
Epoch: 47, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.552 Vali Acc: 0.856 Test Loss: 0.552 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8421094417572021
Epoch: 48, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.529 Vali Acc: 0.861 Test Loss: 0.529 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 49 cost time: 0.8462562561035156
Epoch: 49, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.532 Vali Acc: 0.867 Test Loss: 0.532 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 50 cost time: 0.8174788951873779
Epoch: 50, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.533 Vali Acc: 0.850 Test Loss: 0.533 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.8163330554962158
Epoch: 51, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.499 Vali Acc: 0.861 Test Loss: 0.499 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.8631963729858398
Epoch: 52, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.492 Vali Acc: 0.861 Test Loss: 0.492 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.7444186210632324
Epoch: 53, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.513 Vali Acc: 0.844 Test Loss: 0.513 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.8085887432098389
Epoch: 54, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.502 Vali Acc: 0.867 Test Loss: 0.502 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866662).  Saving model ...
Epoch: 55 cost time: 0.9100830554962158
Epoch: 55, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.521 Vali Acc: 0.878 Test Loss: 0.521 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877773).  Saving model ...
Epoch: 56 cost time: 0.8181915283203125
Epoch: 56, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.528 Vali Acc: 0.867 Test Loss: 0.528 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.858971357345581
Epoch: 57, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.514 Vali Acc: 0.867 Test Loss: 0.514 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.7893104553222656
Epoch: 58, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.500 Vali Acc: 0.861 Test Loss: 0.500 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.8323943614959717
Epoch: 59, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.529 Vali Acc: 0.867 Test Loss: 0.529 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.9708037376403809
Epoch: 60, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.503 Vali Acc: 0.872 Test Loss: 0.503 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.7840602397918701
Epoch: 61, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.515 Vali Acc: 0.861 Test Loss: 0.515 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.8439888954162598
Epoch: 62, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.516 Vali Acc: 0.861 Test Loss: 0.516 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.8130221366882324
Epoch: 63, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.512 Vali Acc: 0.861 Test Loss: 0.512 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.8640949726104736
Epoch: 64, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.523 Vali Acc: 0.872 Test Loss: 0.523 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 0.940187931060791
Epoch: 65, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.540 Vali Acc: 0.867 Test Loss: 0.540 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 257063
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.214179277420044
Epoch: 1, Steps: 12 | Train Loss: 2.843 Vali Loss: 2.827 Vali Acc: 0.106 Test Loss: 2.827 Test Acc: 0.106
Validation loss decreased (inf --> -0.105527).  Saving model ...
Epoch: 2 cost time: 0.879828929901123
Epoch: 2, Steps: 12 | Train Loss: 2.760 Vali Loss: 2.749 Vali Acc: 0.106 Test Loss: 2.749 Test Acc: 0.106
Validation loss decreased (-0.105527 --> -0.105528).  Saving model ...
Epoch: 3 cost time: 0.7228085994720459
Epoch: 3, Steps: 12 | Train Loss: 2.698 Vali Loss: 2.676 Vali Acc: 0.089 Test Loss: 2.676 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.796393632888794
Epoch: 4, Steps: 12 | Train Loss: 2.643 Vali Loss: 2.614 Vali Acc: 0.111 Test Loss: 2.614 Test Acc: 0.111
Validation loss decreased (-0.105528 --> -0.111085).  Saving model ...
Epoch: 5 cost time: 0.7066583633422852
Epoch: 5, Steps: 12 | Train Loss: 2.569 Vali Loss: 2.549 Vali Acc: 0.194 Test Loss: 2.549 Test Acc: 0.194
Validation loss decreased (-0.111085 --> -0.194419).  Saving model ...
Epoch: 6 cost time: 0.7217047214508057
Epoch: 6, Steps: 12 | Train Loss: 2.465 Vali Loss: 2.478 Vali Acc: 0.300 Test Loss: 2.478 Test Acc: 0.300
Validation loss decreased (-0.194419 --> -0.299975).  Saving model ...
Epoch: 7 cost time: 0.8421320915222168
Epoch: 7, Steps: 12 | Train Loss: 2.395 Vali Loss: 2.401 Vali Acc: 0.333 Test Loss: 2.401 Test Acc: 0.333
Validation loss decreased (-0.299975 --> -0.333309).  Saving model ...
Epoch: 8 cost time: 0.716252326965332
Epoch: 8, Steps: 12 | Train Loss: 2.295 Vali Loss: 2.317 Vali Acc: 0.383 Test Loss: 2.317 Test Acc: 0.383
Validation loss decreased (-0.333309 --> -0.383310).  Saving model ...
Epoch: 9 cost time: 0.7705295085906982
Epoch: 9, Steps: 12 | Train Loss: 2.229 Vali Loss: 2.237 Vali Acc: 0.367 Test Loss: 2.237 Test Acc: 0.367
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9971251487731934
Epoch: 10, Steps: 12 | Train Loss: 2.125 Vali Loss: 2.142 Vali Acc: 0.444 Test Loss: 2.142 Test Acc: 0.444
Validation loss decreased (-0.383310 --> -0.444423).  Saving model ...
Epoch: 11 cost time: 0.913672685623169
Epoch: 11, Steps: 12 | Train Loss: 1.980 Vali Loss: 2.047 Vali Acc: 0.494 Test Loss: 2.047 Test Acc: 0.494
Validation loss decreased (-0.444423 --> -0.494424).  Saving model ...
Epoch: 12 cost time: 0.8019726276397705
Epoch: 12, Steps: 12 | Train Loss: 1.940 Vali Loss: 1.955 Vali Acc: 0.511 Test Loss: 1.955 Test Acc: 0.511
Validation loss decreased (-0.494424 --> -0.511092).  Saving model ...
Epoch: 13 cost time: 0.8575448989868164
Epoch: 13, Steps: 12 | Train Loss: 1.790 Vali Loss: 1.862 Vali Acc: 0.539 Test Loss: 1.862 Test Acc: 0.539
Validation loss decreased (-0.511092 --> -0.538870).  Saving model ...
Epoch: 14 cost time: 0.7576322555541992
Epoch: 14, Steps: 12 | Train Loss: 1.706 Vali Loss: 1.782 Vali Acc: 0.572 Test Loss: 1.782 Test Acc: 0.572
Validation loss decreased (-0.538870 --> -0.572204).  Saving model ...
Epoch: 15 cost time: 0.9505569934844971
Epoch: 15, Steps: 12 | Train Loss: 1.581 Vali Loss: 1.694 Vali Acc: 0.617 Test Loss: 1.694 Test Acc: 0.617
Validation loss decreased (-0.572204 --> -0.616650).  Saving model ...
Epoch: 16 cost time: 0.768740177154541
Epoch: 16, Steps: 12 | Train Loss: 1.492 Vali Loss: 1.616 Vali Acc: 0.606 Test Loss: 1.616 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8353350162506104
Epoch: 17, Steps: 12 | Train Loss: 1.444 Vali Loss: 1.544 Vali Acc: 0.611 Test Loss: 1.544 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7981948852539062
Epoch: 18, Steps: 12 | Train Loss: 1.331 Vali Loss: 1.476 Vali Acc: 0.606 Test Loss: 1.476 Test Acc: 0.606
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7839865684509277
Epoch: 19, Steps: 12 | Train Loss: 1.221 Vali Loss: 1.401 Vali Acc: 0.622 Test Loss: 1.401 Test Acc: 0.622
Validation loss decreased (-0.616650 --> -0.622208).  Saving model ...
Epoch: 20 cost time: 0.791750431060791
Epoch: 20, Steps: 12 | Train Loss: 1.190 Vali Loss: 1.337 Vali Acc: 0.639 Test Loss: 1.337 Test Acc: 0.639
Validation loss decreased (-0.622208 --> -0.638876).  Saving model ...
Epoch: 21 cost time: 0.7810146808624268
Epoch: 21, Steps: 12 | Train Loss: 1.094 Vali Loss: 1.285 Vali Acc: 0.633 Test Loss: 1.285 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8673529624938965
Epoch: 22, Steps: 12 | Train Loss: 0.997 Vali Loss: 1.234 Vali Acc: 0.639 Test Loss: 1.234 Test Acc: 0.639
Validation loss decreased (-0.638876 --> -0.638877).  Saving model ...
Epoch: 23 cost time: 0.7550935745239258
Epoch: 23, Steps: 12 | Train Loss: 0.982 Vali Loss: 1.190 Vali Acc: 0.650 Test Loss: 1.190 Test Acc: 0.650
Validation loss decreased (-0.638877 --> -0.649988).  Saving model ...
Epoch: 24 cost time: 0.7955963611602783
Epoch: 24, Steps: 12 | Train Loss: 0.966 Vali Loss: 1.148 Vali Acc: 0.633 Test Loss: 1.148 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9018182754516602
Epoch: 25, Steps: 12 | Train Loss: 0.944 Vali Loss: 1.098 Vali Acc: 0.672 Test Loss: 1.098 Test Acc: 0.672
Validation loss decreased (-0.649988 --> -0.672211).  Saving model ...
Epoch: 26 cost time: 0.7199666500091553
Epoch: 26, Steps: 12 | Train Loss: 0.851 Vali Loss: 1.058 Vali Acc: 0.678 Test Loss: 1.058 Test Acc: 0.678
Validation loss decreased (-0.672211 --> -0.677767).  Saving model ...
Epoch: 27 cost time: 0.8324322700500488
Epoch: 27, Steps: 12 | Train Loss: 0.831 Vali Loss: 1.030 Vali Acc: 0.694 Test Loss: 1.030 Test Acc: 0.694
Validation loss decreased (-0.677767 --> -0.694434).  Saving model ...
Epoch: 28 cost time: 0.7108426094055176
Epoch: 28, Steps: 12 | Train Loss: 0.745 Vali Loss: 1.001 Vali Acc: 0.683 Test Loss: 1.001 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7185389995574951
Epoch: 29, Steps: 12 | Train Loss: 0.713 Vali Loss: 0.969 Vali Acc: 0.678 Test Loss: 0.969 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8751544952392578
Epoch: 30, Steps: 12 | Train Loss: 0.659 Vali Loss: 0.935 Vali Acc: 0.706 Test Loss: 0.935 Test Acc: 0.706
Validation loss decreased (-0.694434 --> -0.705546).  Saving model ...
Epoch: 31 cost time: 0.6748831272125244
Epoch: 31, Steps: 12 | Train Loss: 0.612 Vali Loss: 0.902 Vali Acc: 0.722 Test Loss: 0.902 Test Acc: 0.722
Validation loss decreased (-0.705546 --> -0.722213).  Saving model ...
Epoch: 32 cost time: 0.8135390281677246
Epoch: 32, Steps: 12 | Train Loss: 0.610 Vali Loss: 0.867 Vali Acc: 0.733 Test Loss: 0.867 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733325).  Saving model ...
Epoch: 33 cost time: 0.7234554290771484
Epoch: 33, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.838 Vali Acc: 0.750 Test Loss: 0.838 Test Acc: 0.750
Validation loss decreased (-0.733325 --> -0.749992).  Saving model ...
Epoch: 34 cost time: 0.8995976448059082
Epoch: 34, Steps: 12 | Train Loss: 0.584 Vali Loss: 0.806 Vali Acc: 0.767 Test Loss: 0.806 Test Acc: 0.767
Validation loss decreased (-0.749992 --> -0.766659).  Saving model ...
Epoch: 35 cost time: 0.7789788246154785
Epoch: 35, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.776 Vali Acc: 0.756 Test Loss: 0.776 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7234554290771484
Epoch: 36, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.742 Vali Acc: 0.789 Test Loss: 0.742 Test Acc: 0.789
Validation loss decreased (-0.766659 --> -0.788881).  Saving model ...
Epoch: 37 cost time: 0.8172218799591064
Epoch: 37, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.703 Vali Acc: 0.794 Test Loss: 0.703 Test Acc: 0.794
Validation loss decreased (-0.788881 --> -0.794437).  Saving model ...
Epoch: 38 cost time: 0.7423532009124756
Epoch: 38, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.706 Vali Acc: 0.806 Test Loss: 0.706 Test Acc: 0.806
Validation loss decreased (-0.794437 --> -0.805548).  Saving model ...
Epoch: 39 cost time: 0.7374789714813232
Epoch: 39, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.678 Vali Acc: 0.822 Test Loss: 0.678 Test Acc: 0.822
Validation loss decreased (-0.805548 --> -0.822215).  Saving model ...
Epoch: 40 cost time: 0.838486909866333
Epoch: 40, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.650 Vali Acc: 0.833 Test Loss: 0.650 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833327).  Saving model ...
Epoch: 41 cost time: 0.9241652488708496
Epoch: 41, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.645 Vali Acc: 0.828 Test Loss: 0.645 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9033939838409424
Epoch: 42, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.637 Vali Acc: 0.806 Test Loss: 0.637 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.8804006576538086
Epoch: 43, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.595 Vali Acc: 0.822 Test Loss: 0.595 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.8338360786437988
Epoch: 44, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.586 Vali Acc: 0.839 Test Loss: 0.586 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 45 cost time: 0.729499101638794
Epoch: 45, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.588 Vali Acc: 0.833 Test Loss: 0.588 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7305216789245605
Epoch: 46, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.580 Vali Acc: 0.850 Test Loss: 0.580 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 47 cost time: 1.0559866428375244
Epoch: 47, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.553 Vali Acc: 0.839 Test Loss: 0.553 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7611753940582275
Epoch: 48, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.522 Vali Acc: 0.833 Test Loss: 0.522 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.753354549407959
Epoch: 49, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.541 Vali Acc: 0.839 Test Loss: 0.541 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.7144479751586914
Epoch: 50, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.559 Vali Acc: 0.861 Test Loss: 0.559 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861106).  Saving model ...
Epoch: 51 cost time: 0.7334749698638916
Epoch: 51, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.523 Vali Acc: 0.844 Test Loss: 0.523 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.7979280948638916
Epoch: 52, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.512 Vali Acc: 0.856 Test Loss: 0.512 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.7883951663970947
Epoch: 53, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.505 Vali Acc: 0.856 Test Loss: 0.505 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.8608078956604004
Epoch: 54, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.505 Vali Acc: 0.850 Test Loss: 0.505 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.9630417823791504
Epoch: 55, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.538 Vali Acc: 0.872 Test Loss: 0.538 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 56 cost time: 0.764113187789917
Epoch: 56, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.540 Vali Acc: 0.867 Test Loss: 0.540 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.742762565612793
Epoch: 57, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.513 Vali Acc: 0.872 Test Loss: 0.513 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 58 cost time: 0.7489669322967529
Epoch: 58, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.523 Vali Acc: 0.867 Test Loss: 0.523 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.719536304473877
Epoch: 59, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.518 Vali Acc: 0.856 Test Loss: 0.518 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.779651403427124
Epoch: 60, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.537 Vali Acc: 0.844 Test Loss: 0.537 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.9192464351654053
Epoch: 61, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.534 Vali Acc: 0.867 Test Loss: 0.534 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.0358166694641113
Epoch: 62, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.509 Vali Acc: 0.839 Test Loss: 0.509 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.8929691314697266
Epoch: 63, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.496 Vali Acc: 0.861 Test Loss: 0.496 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.9866375923156738
Epoch: 64, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.503 Vali Acc: 0.861 Test Loss: 0.503 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.9388206005096436
Epoch: 65, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.508 Vali Acc: 0.856 Test Loss: 0.508 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 0.8333795070648193
Epoch: 66, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.511 Vali Acc: 0.878 Test Loss: 0.511 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 67 cost time: 0.7436399459838867
Epoch: 67, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.7872302532196045
Epoch: 68, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.538 Vali Acc: 0.878 Test Loss: 0.538 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.8533201217651367
Epoch: 69, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.492 Vali Acc: 0.861 Test Loss: 0.492 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.8291177749633789
Epoch: 70, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.484 Vali Acc: 0.861 Test Loss: 0.484 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.8959150314331055
Epoch: 71, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.490 Vali Acc: 0.861 Test Loss: 0.490 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.7960951328277588
Epoch: 72, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.505 Vali Acc: 0.850 Test Loss: 0.505 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.8220210075378418
Epoch: 73, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.498 Vali Acc: 0.867 Test Loss: 0.498 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 0.8276171684265137
Epoch: 74, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.518 Vali Acc: 0.867 Test Loss: 0.518 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 0.8375353813171387
Epoch: 75, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.544 Vali Acc: 0.894 Test Loss: 0.544 Test Acc: 0.894
Validation loss decreased (-0.877773 --> -0.894439).  Saving model ...
Epoch: 76 cost time: 0.8284780979156494
Epoch: 76, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.514 Vali Acc: 0.883 Test Loss: 0.514 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.8254363536834717
Epoch: 77, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.485 Vali Acc: 0.878 Test Loss: 0.485 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 0.8037722110748291
Epoch: 78, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.479 Vali Acc: 0.861 Test Loss: 0.479 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 0.8623769283294678
Epoch: 79, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.509 Vali Acc: 0.872 Test Loss: 0.509 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 0.8661260604858398
Epoch: 80, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.511 Vali Acc: 0.872 Test Loss: 0.511 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 0.8167562484741211
Epoch: 81, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.516 Vali Acc: 0.878 Test Loss: 0.516 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 0.9477448463439941
Epoch: 82, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.497 Vali Acc: 0.872 Test Loss: 0.497 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 0.8543505668640137
Epoch: 83, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.520 Vali Acc: 0.856 Test Loss: 0.520 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 0.856036901473999
Epoch: 84, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.518 Vali Acc: 0.883 Test Loss: 0.518 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 85 cost time: 0.8934690952301025
Epoch: 85, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.506 Vali Acc: 0.872 Test Loss: 0.506 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 157607
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.172593832015991
Epoch: 1, Steps: 12 | Train Loss: 2.941 Vali Loss: 2.851 Vali Acc: 0.078 Test Loss: 2.851 Test Acc: 0.078
Validation loss decreased (inf --> -0.077749).  Saving model ...
Epoch: 2 cost time: 0.9349563121795654
Epoch: 2, Steps: 12 | Train Loss: 2.872 Vali Loss: 2.778 Vali Acc: 0.072 Test Loss: 2.778 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7470602989196777
Epoch: 3, Steps: 12 | Train Loss: 2.815 Vali Loss: 2.712 Vali Acc: 0.067 Test Loss: 2.712 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7998199462890625
Epoch: 4, Steps: 12 | Train Loss: 2.717 Vali Loss: 2.660 Vali Acc: 0.039 Test Loss: 2.660 Test Acc: 0.039
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7557063102722168
Epoch: 5, Steps: 12 | Train Loss: 2.664 Vali Loss: 2.613 Vali Acc: 0.122 Test Loss: 2.613 Test Acc: 0.122
Validation loss decreased (-0.077749 --> -0.122196).  Saving model ...
Epoch: 6 cost time: 0.8207645416259766
Epoch: 6, Steps: 12 | Train Loss: 2.562 Vali Loss: 2.569 Vali Acc: 0.239 Test Loss: 2.569 Test Acc: 0.239
Validation loss decreased (-0.122196 --> -0.238863).  Saving model ...
Epoch: 7 cost time: 0.8300530910491943
Epoch: 7, Steps: 12 | Train Loss: 2.497 Vali Loss: 2.502 Vali Acc: 0.283 Test Loss: 2.502 Test Acc: 0.283
Validation loss decreased (-0.238863 --> -0.283308).  Saving model ...
Epoch: 8 cost time: 0.9496276378631592
Epoch: 8, Steps: 12 | Train Loss: 2.434 Vali Loss: 2.427 Vali Acc: 0.328 Test Loss: 2.427 Test Acc: 0.328
Validation loss decreased (-0.283308 --> -0.327754).  Saving model ...
Epoch: 9 cost time: 0.972994327545166
Epoch: 9, Steps: 12 | Train Loss: 2.333 Vali Loss: 2.341 Vali Acc: 0.361 Test Loss: 2.341 Test Acc: 0.361
Validation loss decreased (-0.327754 --> -0.361088).  Saving model ...
Epoch: 10 cost time: 0.9536900520324707
Epoch: 10, Steps: 12 | Train Loss: 2.260 Vali Loss: 2.248 Vali Acc: 0.450 Test Loss: 2.248 Test Acc: 0.450
Validation loss decreased (-0.361088 --> -0.449978).  Saving model ...
Epoch: 11 cost time: 0.936455488204956
Epoch: 11, Steps: 12 | Train Loss: 2.090 Vali Loss: 2.147 Vali Acc: 0.511 Test Loss: 2.147 Test Acc: 0.511
Validation loss decreased (-0.449978 --> -0.511090).  Saving model ...
Epoch: 12 cost time: 0.917705774307251
Epoch: 12, Steps: 12 | Train Loss: 1.959 Vali Loss: 2.030 Vali Acc: 0.522 Test Loss: 2.030 Test Acc: 0.522
Validation loss decreased (-0.511090 --> -0.522202).  Saving model ...
Epoch: 13 cost time: 0.8956751823425293
Epoch: 13, Steps: 12 | Train Loss: 1.860 Vali Loss: 1.915 Vali Acc: 0.539 Test Loss: 1.915 Test Acc: 0.539
Validation loss decreased (-0.522202 --> -0.538870).  Saving model ...
Epoch: 14 cost time: 0.879913330078125
Epoch: 14, Steps: 12 | Train Loss: 1.725 Vali Loss: 1.800 Vali Acc: 0.550 Test Loss: 1.800 Test Acc: 0.550
Validation loss decreased (-0.538870 --> -0.549982).  Saving model ...
Epoch: 15 cost time: 0.8502001762390137
Epoch: 15, Steps: 12 | Train Loss: 1.583 Vali Loss: 1.706 Vali Acc: 0.550 Test Loss: 1.706 Test Acc: 0.550
Validation loss decreased (-0.549982 --> -0.549983).  Saving model ...
Epoch: 16 cost time: 0.8550770282745361
Epoch: 16, Steps: 12 | Train Loss: 1.461 Vali Loss: 1.607 Vali Acc: 0.583 Test Loss: 1.607 Test Acc: 0.583
Validation loss decreased (-0.549983 --> -0.583317).  Saving model ...
Epoch: 17 cost time: 0.8466439247131348
Epoch: 17, Steps: 12 | Train Loss: 1.379 Vali Loss: 1.520 Vali Acc: 0.600 Test Loss: 1.520 Test Acc: 0.600
Validation loss decreased (-0.583317 --> -0.599985).  Saving model ...
Epoch: 18 cost time: 0.8948924541473389
Epoch: 18, Steps: 12 | Train Loss: 1.268 Vali Loss: 1.436 Vali Acc: 0.611 Test Loss: 1.436 Test Acc: 0.611
Validation loss decreased (-0.599985 --> -0.611097).  Saving model ...
Epoch: 19 cost time: 0.8936903476715088
Epoch: 19, Steps: 12 | Train Loss: 1.295 Vali Loss: 1.360 Vali Acc: 0.633 Test Loss: 1.360 Test Acc: 0.633
Validation loss decreased (-0.611097 --> -0.633320).  Saving model ...
Epoch: 20 cost time: 0.7485194206237793
Epoch: 20, Steps: 12 | Train Loss: 1.089 Vali Loss: 1.297 Vali Acc: 0.639 Test Loss: 1.297 Test Acc: 0.639
Validation loss decreased (-0.633320 --> -0.638876).  Saving model ...
Epoch: 21 cost time: 0.7906327247619629
Epoch: 21, Steps: 12 | Train Loss: 1.065 Vali Loss: 1.242 Vali Acc: 0.644 Test Loss: 1.242 Test Acc: 0.644
Validation loss decreased (-0.638876 --> -0.644432).  Saving model ...
Epoch: 22 cost time: 0.8232014179229736
Epoch: 22, Steps: 12 | Train Loss: 0.990 Vali Loss: 1.176 Vali Acc: 0.661 Test Loss: 1.176 Test Acc: 0.661
Validation loss decreased (-0.644432 --> -0.661099).  Saving model ...
Epoch: 23 cost time: 0.8125531673431396
Epoch: 23, Steps: 12 | Train Loss: 0.978 Vali Loss: 1.130 Vali Acc: 0.667 Test Loss: 1.130 Test Acc: 0.667
Validation loss decreased (-0.661099 --> -0.666655).  Saving model ...
Epoch: 24 cost time: 0.8582618236541748
Epoch: 24, Steps: 12 | Train Loss: 0.914 Vali Loss: 1.083 Vali Acc: 0.683 Test Loss: 1.083 Test Acc: 0.683
Validation loss decreased (-0.666655 --> -0.683323).  Saving model ...
Epoch: 25 cost time: 0.9230268001556396
Epoch: 25, Steps: 12 | Train Loss: 0.840 Vali Loss: 1.045 Vali Acc: 0.694 Test Loss: 1.045 Test Acc: 0.694
Validation loss decreased (-0.683323 --> -0.694434).  Saving model ...
Epoch: 26 cost time: 0.8456478118896484
Epoch: 26, Steps: 12 | Train Loss: 0.789 Vali Loss: 1.003 Vali Acc: 0.722 Test Loss: 1.003 Test Acc: 0.722
Validation loss decreased (-0.694434 --> -0.722212).  Saving model ...
Epoch: 27 cost time: 0.9119305610656738
Epoch: 27, Steps: 12 | Train Loss: 0.738 Vali Loss: 0.973 Vali Acc: 0.728 Test Loss: 0.973 Test Acc: 0.728
Validation loss decreased (-0.722212 --> -0.727768).  Saving model ...
Epoch: 28 cost time: 1.056680679321289
Epoch: 28, Steps: 12 | Train Loss: 0.712 Vali Loss: 0.946 Vali Acc: 0.722 Test Loss: 0.946 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8834741115570068
Epoch: 29, Steps: 12 | Train Loss: 0.683 Vali Loss: 0.924 Vali Acc: 0.717 Test Loss: 0.924 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8944745063781738
Epoch: 30, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.885 Vali Acc: 0.722 Test Loss: 0.885 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.865192174911499
Epoch: 31, Steps: 12 | Train Loss: 0.634 Vali Loss: 0.842 Vali Acc: 0.733 Test Loss: 0.842 Test Acc: 0.733
Validation loss decreased (-0.727768 --> -0.733325).  Saving model ...
Epoch: 32 cost time: 0.8402957916259766
Epoch: 32, Steps: 12 | Train Loss: 0.613 Vali Loss: 0.845 Vali Acc: 0.733 Test Loss: 0.845 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1997153759002686
Epoch: 33, Steps: 12 | Train Loss: 0.572 Vali Loss: 0.837 Vali Acc: 0.739 Test Loss: 0.837 Test Acc: 0.739
Validation loss decreased (-0.733325 --> -0.738881).  Saving model ...
Epoch: 34 cost time: 1.066511869430542
Epoch: 34, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.788 Vali Acc: 0.744 Test Loss: 0.788 Test Acc: 0.744
Validation loss decreased (-0.738881 --> -0.744437).  Saving model ...
Epoch: 35 cost time: 1.06520414352417
Epoch: 35, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.756 Vali Acc: 0.750 Test Loss: 0.756 Test Acc: 0.750
Validation loss decreased (-0.744437 --> -0.749992).  Saving model ...
Epoch: 36 cost time: 1.0259697437286377
Epoch: 36, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.749 Vali Acc: 0.750 Test Loss: 0.749 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749993).  Saving model ...
Epoch: 37 cost time: 1.1686768531799316
Epoch: 37, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.720 Vali Acc: 0.772 Test Loss: 0.720 Test Acc: 0.772
Validation loss decreased (-0.749993 --> -0.772215).  Saving model ...
Epoch: 38 cost time: 0.9701344966888428
Epoch: 38, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.729 Vali Acc: 0.783 Test Loss: 0.729 Test Acc: 0.783
Validation loss decreased (-0.772215 --> -0.783326).  Saving model ...
Epoch: 39 cost time: 1.1490914821624756
Epoch: 39, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.692 Vali Acc: 0.783 Test Loss: 0.692 Test Acc: 0.783
Validation loss decreased (-0.783326 --> -0.783326).  Saving model ...
Epoch: 40 cost time: 0.9525349140167236
Epoch: 40, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.677 Vali Acc: 0.794 Test Loss: 0.677 Test Acc: 0.794
Validation loss decreased (-0.783326 --> -0.794438).  Saving model ...
Epoch: 41 cost time: 0.868544340133667
Epoch: 41, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.667 Vali Acc: 0.800 Test Loss: 0.667 Test Acc: 0.800
Validation loss decreased (-0.794438 --> -0.799993).  Saving model ...
Epoch: 42 cost time: 1.0086169242858887
Epoch: 42, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.642 Vali Acc: 0.783 Test Loss: 0.642 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1006157398223877
Epoch: 43, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.652 Vali Acc: 0.806 Test Loss: 0.652 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805549).  Saving model ...
Epoch: 44 cost time: 1.039313793182373
Epoch: 44, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.631 Vali Acc: 0.811 Test Loss: 0.631 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811105).  Saving model ...
Epoch: 45 cost time: 1.0094647407531738
Epoch: 45, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.603 Vali Acc: 0.839 Test Loss: 0.603 Test Acc: 0.839
Validation loss decreased (-0.811105 --> -0.838883).  Saving model ...
Epoch: 46 cost time: 0.8545100688934326
Epoch: 46, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.599 Vali Acc: 0.828 Test Loss: 0.599 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.8415417671203613
Epoch: 47, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.594 Vali Acc: 0.828 Test Loss: 0.594 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.9125723838806152
Epoch: 48, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.594 Vali Acc: 0.833 Test Loss: 0.594 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.0486507415771484
Epoch: 49, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.569 Vali Acc: 0.839 Test Loss: 0.569 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 50 cost time: 1.0445151329040527
Epoch: 50, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.592 Vali Acc: 0.844 Test Loss: 0.592 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 51 cost time: 1.049410343170166
Epoch: 51, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.592 Vali Acc: 0.861 Test Loss: 0.592 Test Acc: 0.861
Validation loss decreased (-0.844439 --> -0.861105).  Saving model ...
Epoch: 52 cost time: 0.887235164642334
Epoch: 52, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.562 Vali Acc: 0.861 Test Loss: 0.562 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 53 cost time: 0.9795489311218262
Epoch: 53, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.544 Vali Acc: 0.850 Test Loss: 0.544 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.9234085083007812
Epoch: 54, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.545 Vali Acc: 0.867 Test Loss: 0.545 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 55 cost time: 0.8178219795227051
Epoch: 55, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.533 Vali Acc: 0.861 Test Loss: 0.533 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.8554849624633789
Epoch: 56, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.502 Vali Acc: 0.850 Test Loss: 0.502 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.8612475395202637
Epoch: 57, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.549 Vali Acc: 0.856 Test Loss: 0.549 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.7466104030609131
Epoch: 58, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.534 Vali Acc: 0.856 Test Loss: 0.534 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.92771315574646
Epoch: 59, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.503 Vali Acc: 0.850 Test Loss: 0.503 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.8200523853302002
Epoch: 60, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.516 Vali Acc: 0.872 Test Loss: 0.516 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 61 cost time: 0.7995612621307373
Epoch: 61, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.488 Vali Acc: 0.867 Test Loss: 0.488 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.7752230167388916
Epoch: 62, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.495 Vali Acc: 0.883 Test Loss: 0.495 Test Acc: 0.883
Validation loss decreased (-0.872217 --> -0.883328).  Saving model ...
Epoch: 63 cost time: 0.6965169906616211
Epoch: 63, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.494 Vali Acc: 0.867 Test Loss: 0.494 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.7348871231079102
Epoch: 64, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.526 Vali Acc: 0.861 Test Loss: 0.526 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.8646752834320068
Epoch: 65, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.492 Vali Acc: 0.872 Test Loss: 0.492 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.8704309463500977
Epoch: 66, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.571 Vali Acc: 0.861 Test Loss: 0.571 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.7191483974456787
Epoch: 67, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.533 Vali Acc: 0.878 Test Loss: 0.533 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.7370588779449463
Epoch: 68, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.505 Vali Acc: 0.883 Test Loss: 0.505 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 0.8496873378753662
Epoch: 69, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.498 Vali Acc: 0.878 Test Loss: 0.498 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 0.7705574035644531
Epoch: 70, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.478 Vali Acc: 0.867 Test Loss: 0.478 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 0.7857933044433594
Epoch: 71, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.516 Vali Acc: 0.872 Test Loss: 0.516 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 0.7892372608184814
Epoch: 72, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.524 Vali Acc: 0.872 Test Loss: 0.524 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 157479
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.261108636856079
Epoch: 1, Steps: 12 | Train Loss: 2.832 Vali Loss: 2.817 Vali Acc: 0.056 Test Loss: 2.817 Test Acc: 0.056
Validation loss decreased (inf --> -0.055527).  Saving model ...
Epoch: 2 cost time: 0.872262716293335
Epoch: 2, Steps: 12 | Train Loss: 2.818 Vali Loss: 2.747 Vali Acc: 0.061 Test Loss: 2.747 Test Acc: 0.061
Validation loss decreased (-0.055527 --> -0.061084).  Saving model ...
Epoch: 3 cost time: 0.921022891998291
Epoch: 3, Steps: 12 | Train Loss: 2.746 Vali Loss: 2.681 Vali Acc: 0.122 Test Loss: 2.681 Test Acc: 0.122
Validation loss decreased (-0.061084 --> -0.122195).  Saving model ...
Epoch: 4 cost time: 0.8020906448364258
Epoch: 4, Steps: 12 | Train Loss: 2.670 Vali Loss: 2.622 Vali Acc: 0.128 Test Loss: 2.622 Test Acc: 0.128
Validation loss decreased (-0.122195 --> -0.127752).  Saving model ...
Epoch: 5 cost time: 0.9461719989776611
Epoch: 5, Steps: 12 | Train Loss: 2.608 Vali Loss: 2.567 Vali Acc: 0.239 Test Loss: 2.567 Test Acc: 0.239
Validation loss decreased (-0.127752 --> -0.238863).  Saving model ...
Epoch: 6 cost time: 0.9080572128295898
Epoch: 6, Steps: 12 | Train Loss: 2.537 Vali Loss: 2.509 Vali Acc: 0.294 Test Loss: 2.509 Test Acc: 0.294
Validation loss decreased (-0.238863 --> -0.294419).  Saving model ...
Epoch: 7 cost time: 0.8689942359924316
Epoch: 7, Steps: 12 | Train Loss: 2.444 Vali Loss: 2.442 Vali Acc: 0.311 Test Loss: 2.442 Test Acc: 0.311
Validation loss decreased (-0.294419 --> -0.311087).  Saving model ...
Epoch: 8 cost time: 0.9458906650543213
Epoch: 8, Steps: 12 | Train Loss: 2.371 Vali Loss: 2.368 Vali Acc: 0.394 Test Loss: 2.368 Test Acc: 0.394
Validation loss decreased (-0.311087 --> -0.394421).  Saving model ...
Epoch: 9 cost time: 0.843217134475708
Epoch: 9, Steps: 12 | Train Loss: 2.281 Vali Loss: 2.290 Vali Acc: 0.422 Test Loss: 2.290 Test Acc: 0.422
Validation loss decreased (-0.394421 --> -0.422199).  Saving model ...
Epoch: 10 cost time: 0.816035270690918
Epoch: 10, Steps: 12 | Train Loss: 2.154 Vali Loss: 2.196 Vali Acc: 0.428 Test Loss: 2.196 Test Acc: 0.428
Validation loss decreased (-0.422199 --> -0.427756).  Saving model ...
Epoch: 11 cost time: 0.8072788715362549
Epoch: 11, Steps: 12 | Train Loss: 2.049 Vali Loss: 2.100 Vali Acc: 0.456 Test Loss: 2.100 Test Acc: 0.456
Validation loss decreased (-0.427756 --> -0.455535).  Saving model ...
Epoch: 12 cost time: 0.8440036773681641
Epoch: 12, Steps: 12 | Train Loss: 1.928 Vali Loss: 2.004 Vali Acc: 0.500 Test Loss: 2.004 Test Acc: 0.500
Validation loss decreased (-0.455535 --> -0.499980).  Saving model ...
Epoch: 13 cost time: 0.8756392002105713
Epoch: 13, Steps: 12 | Train Loss: 1.842 Vali Loss: 1.900 Vali Acc: 0.528 Test Loss: 1.900 Test Acc: 0.528
Validation loss decreased (-0.499980 --> -0.527759).  Saving model ...
Epoch: 14 cost time: 0.8737611770629883
Epoch: 14, Steps: 12 | Train Loss: 1.703 Vali Loss: 1.806 Vali Acc: 0.539 Test Loss: 1.806 Test Acc: 0.539
Validation loss decreased (-0.527759 --> -0.538871).  Saving model ...
Epoch: 15 cost time: 0.850391149520874
Epoch: 15, Steps: 12 | Train Loss: 1.598 Vali Loss: 1.722 Vali Acc: 0.556 Test Loss: 1.722 Test Acc: 0.556
Validation loss decreased (-0.538871 --> -0.555538).  Saving model ...
Epoch: 16 cost time: 0.8357276916503906
Epoch: 16, Steps: 12 | Train Loss: 1.483 Vali Loss: 1.642 Vali Acc: 0.578 Test Loss: 1.642 Test Acc: 0.578
Validation loss decreased (-0.555538 --> -0.577761).  Saving model ...
Epoch: 17 cost time: 0.7536513805389404
Epoch: 17, Steps: 12 | Train Loss: 1.416 Vali Loss: 1.563 Vali Acc: 0.589 Test Loss: 1.563 Test Acc: 0.589
Validation loss decreased (-0.577761 --> -0.588873).  Saving model ...
Epoch: 18 cost time: 0.8093159198760986
Epoch: 18, Steps: 12 | Train Loss: 1.305 Vali Loss: 1.500 Vali Acc: 0.594 Test Loss: 1.500 Test Acc: 0.594
Validation loss decreased (-0.588873 --> -0.594429).  Saving model ...
Epoch: 19 cost time: 0.841670036315918
Epoch: 19, Steps: 12 | Train Loss: 1.253 Vali Loss: 1.430 Vali Acc: 0.600 Test Loss: 1.430 Test Acc: 0.600
Validation loss decreased (-0.594429 --> -0.599986).  Saving model ...
Epoch: 20 cost time: 0.7878615856170654
Epoch: 20, Steps: 12 | Train Loss: 1.167 Vali Loss: 1.368 Vali Acc: 0.622 Test Loss: 1.368 Test Acc: 0.622
Validation loss decreased (-0.599986 --> -0.622209).  Saving model ...
Epoch: 21 cost time: 0.764833927154541
Epoch: 21, Steps: 12 | Train Loss: 1.045 Vali Loss: 1.313 Vali Acc: 0.639 Test Loss: 1.313 Test Acc: 0.639
Validation loss decreased (-0.622209 --> -0.638876).  Saving model ...
Epoch: 22 cost time: 0.8286867141723633
Epoch: 22, Steps: 12 | Train Loss: 0.988 Vali Loss: 1.248 Vali Acc: 0.644 Test Loss: 1.248 Test Acc: 0.644
Validation loss decreased (-0.638876 --> -0.644432).  Saving model ...
Epoch: 23 cost time: 0.828758955001831
Epoch: 23, Steps: 12 | Train Loss: 1.000 Vali Loss: 1.189 Vali Acc: 0.644 Test Loss: 1.189 Test Acc: 0.644
Validation loss decreased (-0.644432 --> -0.644433).  Saving model ...
Epoch: 24 cost time: 0.7780508995056152
Epoch: 24, Steps: 12 | Train Loss: 0.914 Vali Loss: 1.143 Vali Acc: 0.656 Test Loss: 1.143 Test Acc: 0.656
Validation loss decreased (-0.644433 --> -0.655544).  Saving model ...
Epoch: 25 cost time: 0.9595427513122559
Epoch: 25, Steps: 12 | Train Loss: 0.844 Vali Loss: 1.093 Vali Acc: 0.667 Test Loss: 1.093 Test Acc: 0.667
Validation loss decreased (-0.655544 --> -0.666656).  Saving model ...
Epoch: 26 cost time: 0.9291701316833496
Epoch: 26, Steps: 12 | Train Loss: 0.822 Vali Loss: 1.059 Vali Acc: 0.694 Test Loss: 1.059 Test Acc: 0.694
Validation loss decreased (-0.666656 --> -0.694434).  Saving model ...
Epoch: 27 cost time: 0.9371325969696045
Epoch: 27, Steps: 12 | Train Loss: 0.781 Vali Loss: 1.023 Vali Acc: 0.689 Test Loss: 1.023 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7691466808319092
Epoch: 28, Steps: 12 | Train Loss: 0.703 Vali Loss: 0.992 Vali Acc: 0.706 Test Loss: 0.992 Test Acc: 0.706
Validation loss decreased (-0.694434 --> -0.705546).  Saving model ...
Epoch: 29 cost time: 1.0073635578155518
Epoch: 29, Steps: 12 | Train Loss: 0.701 Vali Loss: 0.949 Vali Acc: 0.722 Test Loss: 0.949 Test Acc: 0.722
Validation loss decreased (-0.705546 --> -0.722213).  Saving model ...
Epoch: 30 cost time: 0.8406891822814941
Epoch: 30, Steps: 12 | Train Loss: 0.654 Vali Loss: 0.921 Vali Acc: 0.733 Test Loss: 0.921 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733324).  Saving model ...
Epoch: 31 cost time: 0.8912618160247803
Epoch: 31, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.898 Vali Acc: 0.728 Test Loss: 0.898 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9058303833007812
Epoch: 32, Steps: 12 | Train Loss: 0.559 Vali Loss: 0.869 Vali Acc: 0.728 Test Loss: 0.869 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8896687030792236
Epoch: 33, Steps: 12 | Train Loss: 0.555 Vali Loss: 0.837 Vali Acc: 0.761 Test Loss: 0.837 Test Acc: 0.761
Validation loss decreased (-0.733324 --> -0.761103).  Saving model ...
Epoch: 34 cost time: 0.8360030651092529
Epoch: 34, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.801 Vali Acc: 0.756 Test Loss: 0.801 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8307561874389648
Epoch: 35, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.777 Vali Acc: 0.750 Test Loss: 0.777 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9023864269256592
Epoch: 36, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.754 Vali Acc: 0.800 Test Loss: 0.754 Test Acc: 0.800
Validation loss decreased (-0.761103 --> -0.799992).  Saving model ...
Epoch: 37 cost time: 0.8801007270812988
Epoch: 37, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.743 Vali Acc: 0.800 Test Loss: 0.743 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 38 cost time: 0.8186235427856445
Epoch: 38, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.699 Vali Acc: 0.806 Test Loss: 0.699 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805549).  Saving model ...
Epoch: 39 cost time: 0.8707904815673828
Epoch: 39, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.693 Vali Acc: 0.794 Test Loss: 0.693 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7864012718200684
Epoch: 40, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.658 Vali Acc: 0.800 Test Loss: 0.658 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.758188009262085
Epoch: 41, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.664 Vali Acc: 0.783 Test Loss: 0.664 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.916837215423584
Epoch: 42, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.637 Vali Acc: 0.806 Test Loss: 0.637 Test Acc: 0.806
Validation loss decreased (-0.805549 --> -0.805549).  Saving model ...
Epoch: 43 cost time: 0.7523515224456787
Epoch: 43, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.624 Vali Acc: 0.822 Test Loss: 0.624 Test Acc: 0.822
Validation loss decreased (-0.805549 --> -0.822216).  Saving model ...
Epoch: 44 cost time: 0.8402044773101807
Epoch: 44, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.613 Vali Acc: 0.811 Test Loss: 0.613 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.7976243495941162
Epoch: 45, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.604 Vali Acc: 0.811 Test Loss: 0.604 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.863882303237915
Epoch: 46, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.595 Vali Acc: 0.828 Test Loss: 0.595 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827772).  Saving model ...
Epoch: 47 cost time: 0.92437744140625
Epoch: 47, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.568 Vali Acc: 0.833 Test Loss: 0.568 Test Acc: 0.833
Validation loss decreased (-0.827772 --> -0.833328).  Saving model ...
Epoch: 48 cost time: 0.7316904067993164
Epoch: 48, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.574 Vali Acc: 0.839 Test Loss: 0.574 Test Acc: 0.839
Validation loss decreased (-0.833328 --> -0.838883).  Saving model ...
Epoch: 49 cost time: 1.067389726638794
Epoch: 49, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.571 Vali Acc: 0.850 Test Loss: 0.571 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 50 cost time: 0.7506489753723145
Epoch: 50, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.543 Vali Acc: 0.861 Test Loss: 0.543 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861106).  Saving model ...
Epoch: 51 cost time: 0.8151233196258545
Epoch: 51, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.539 Vali Acc: 0.850 Test Loss: 0.539 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.8021376132965088
Epoch: 52, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.534 Vali Acc: 0.850 Test Loss: 0.534 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.8446166515350342
Epoch: 53, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.524 Vali Acc: 0.861 Test Loss: 0.524 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 54 cost time: 0.9166872501373291
Epoch: 54, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.507 Vali Acc: 0.867 Test Loss: 0.507 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866662).  Saving model ...
Epoch: 55 cost time: 0.8333451747894287
Epoch: 55, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.517 Vali Acc: 0.872 Test Loss: 0.517 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872217).  Saving model ...
Epoch: 56 cost time: 0.99945068359375
Epoch: 56, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.525 Vali Acc: 0.861 Test Loss: 0.525 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.8012056350708008
Epoch: 57, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.497 Vali Acc: 0.867 Test Loss: 0.497 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.9252476692199707
Epoch: 58, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.485 Vali Acc: 0.867 Test Loss: 0.485 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.751824140548706
Epoch: 59, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.526 Vali Acc: 0.867 Test Loss: 0.526 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.7443437576293945
Epoch: 60, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.508 Vali Acc: 0.856 Test Loss: 0.508 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.7375166416168213
Epoch: 61, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.520 Vali Acc: 0.856 Test Loss: 0.520 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.7362046241760254
Epoch: 62, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.543 Vali Acc: 0.856 Test Loss: 0.543 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.743549108505249
Epoch: 63, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.521 Vali Acc: 0.850 Test Loss: 0.521 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.7284824848175049
Epoch: 64, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.500 Vali Acc: 0.872 Test Loss: 0.500 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 65 cost time: 0.8280017375946045
Epoch: 65, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.496 Vali Acc: 0.861 Test Loss: 0.496 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.9406867027282715
Epoch: 66, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.510 Vali Acc: 0.856 Test Loss: 0.510 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.7468318939208984
Epoch: 67, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.531 Vali Acc: 0.856 Test Loss: 0.531 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.6975417137145996
Epoch: 68, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.479 Vali Acc: 0.861 Test Loss: 0.479 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 0.8119454383850098
Epoch: 69, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.472 Vali Acc: 0.883 Test Loss: 0.472 Test Acc: 0.883
Validation loss decreased (-0.872217 --> -0.883329).  Saving model ...
Epoch: 70 cost time: 0.7287967205047607
Epoch: 70, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.523 Vali Acc: 0.872 Test Loss: 0.523 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.6877491474151611
Epoch: 71, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.498 Vali Acc: 0.878 Test Loss: 0.498 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.8698368072509766
Epoch: 72, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.492 Vali Acc: 0.861 Test Loss: 0.492 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.733424186706543
Epoch: 73, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.500 Vali Acc: 0.867 Test Loss: 0.500 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 0.811875581741333
Epoch: 74, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.512 Vali Acc: 0.867 Test Loss: 0.512 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 1.0237724781036377
Epoch: 75, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.521 Vali Acc: 0.878 Test Loss: 0.521 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 0.9060463905334473
Epoch: 76, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.553 Vali Acc: 0.850 Test Loss: 0.553 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 0.794825553894043
Epoch: 77, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.523 Vali Acc: 0.861 Test Loss: 0.523 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 0.7776322364807129
Epoch: 78, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.527 Vali Acc: 0.872 Test Loss: 0.527 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 79 cost time: 0.8151078224182129
Epoch: 79, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.524 Vali Acc: 0.878 Test Loss: 0.524 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 157351
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.126713514328003
Epoch: 1, Steps: 12 | Train Loss: 2.894 Vali Loss: 2.885 Vali Acc: 0.033 Test Loss: 2.885 Test Acc: 0.033
Validation loss decreased (inf --> -0.033304).  Saving model ...
Epoch: 2 cost time: 0.7444162368774414
Epoch: 2, Steps: 12 | Train Loss: 2.858 Vali Loss: 2.804 Vali Acc: 0.056 Test Loss: 2.804 Test Acc: 0.056
Validation loss decreased (-0.033304 --> -0.055528).  Saving model ...
Epoch: 3 cost time: 0.7883806228637695
Epoch: 3, Steps: 12 | Train Loss: 2.775 Vali Loss: 2.725 Vali Acc: 0.061 Test Loss: 2.725 Test Acc: 0.061
Validation loss decreased (-0.055528 --> -0.061084).  Saving model ...
Epoch: 4 cost time: 0.7981264591217041
Epoch: 4, Steps: 12 | Train Loss: 2.703 Vali Loss: 2.655 Vali Acc: 0.083 Test Loss: 2.655 Test Acc: 0.083
Validation loss decreased (-0.061084 --> -0.083307).  Saving model ...
Epoch: 5 cost time: 0.7443227767944336
Epoch: 5, Steps: 12 | Train Loss: 2.655 Vali Loss: 2.604 Vali Acc: 0.100 Test Loss: 2.604 Test Acc: 0.100
Validation loss decreased (-0.083307 --> -0.099974).  Saving model ...
Epoch: 6 cost time: 0.9921879768371582
Epoch: 6, Steps: 12 | Train Loss: 2.588 Vali Loss: 2.550 Vali Acc: 0.189 Test Loss: 2.550 Test Acc: 0.189
Validation loss decreased (-0.099974 --> -0.188863).  Saving model ...
Epoch: 7 cost time: 0.8492817878723145
Epoch: 7, Steps: 12 | Train Loss: 2.520 Vali Loss: 2.485 Vali Acc: 0.294 Test Loss: 2.485 Test Acc: 0.294
Validation loss decreased (-0.188863 --> -0.294420).  Saving model ...
Epoch: 8 cost time: 0.8322162628173828
Epoch: 8, Steps: 12 | Train Loss: 2.463 Vali Loss: 2.414 Vali Acc: 0.361 Test Loss: 2.414 Test Acc: 0.361
Validation loss decreased (-0.294420 --> -0.361087).  Saving model ...
Epoch: 9 cost time: 0.8807697296142578
Epoch: 9, Steps: 12 | Train Loss: 2.287 Vali Loss: 2.333 Vali Acc: 0.394 Test Loss: 2.333 Test Acc: 0.394
Validation loss decreased (-0.361087 --> -0.394421).  Saving model ...
Epoch: 10 cost time: 0.7995238304138184
Epoch: 10, Steps: 12 | Train Loss: 2.241 Vali Loss: 2.256 Vali Acc: 0.417 Test Loss: 2.256 Test Acc: 0.417
Validation loss decreased (-0.394421 --> -0.416644).  Saving model ...
Epoch: 11 cost time: 0.7330598831176758
Epoch: 11, Steps: 12 | Train Loss: 2.151 Vali Loss: 2.161 Vali Acc: 0.422 Test Loss: 2.161 Test Acc: 0.422
Validation loss decreased (-0.416644 --> -0.422201).  Saving model ...
Epoch: 12 cost time: 0.7799980640411377
Epoch: 12, Steps: 12 | Train Loss: 2.014 Vali Loss: 2.066 Vali Acc: 0.489 Test Loss: 2.066 Test Acc: 0.489
Validation loss decreased (-0.422201 --> -0.488868).  Saving model ...
Epoch: 13 cost time: 0.8534774780273438
Epoch: 13, Steps: 12 | Train Loss: 1.905 Vali Loss: 1.976 Vali Acc: 0.506 Test Loss: 1.976 Test Acc: 0.506
Validation loss decreased (-0.488868 --> -0.505536).  Saving model ...
Epoch: 14 cost time: 0.8917865753173828
Epoch: 14, Steps: 12 | Train Loss: 1.725 Vali Loss: 1.890 Vali Acc: 0.489 Test Loss: 1.890 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.735060453414917
Epoch: 15, Steps: 12 | Train Loss: 1.673 Vali Loss: 1.811 Vali Acc: 0.500 Test Loss: 1.811 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8570306301116943
Epoch: 16, Steps: 12 | Train Loss: 1.648 Vali Loss: 1.724 Vali Acc: 0.506 Test Loss: 1.724 Test Acc: 0.506
Validation loss decreased (-0.505536 --> -0.505538).  Saving model ...
Epoch: 17 cost time: 0.9528026580810547
Epoch: 17, Steps: 12 | Train Loss: 1.441 Vali Loss: 1.644 Vali Acc: 0.517 Test Loss: 1.644 Test Acc: 0.517
Validation loss decreased (-0.505538 --> -0.516650).  Saving model ...
Epoch: 18 cost time: 0.8243844509124756
Epoch: 18, Steps: 12 | Train Loss: 1.342 Vali Loss: 1.578 Vali Acc: 0.506 Test Loss: 1.578 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.958503246307373
Epoch: 19, Steps: 12 | Train Loss: 1.314 Vali Loss: 1.522 Vali Acc: 0.511 Test Loss: 1.522 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8655540943145752
Epoch: 20, Steps: 12 | Train Loss: 1.222 Vali Loss: 1.449 Vali Acc: 0.567 Test Loss: 1.449 Test Acc: 0.567
Validation loss decreased (-0.516650 --> -0.566652).  Saving model ...
Epoch: 21 cost time: 0.7249786853790283
Epoch: 21, Steps: 12 | Train Loss: 1.218 Vali Loss: 1.388 Vali Acc: 0.589 Test Loss: 1.388 Test Acc: 0.589
Validation loss decreased (-0.566652 --> -0.588875).  Saving model ...
Epoch: 22 cost time: 0.714503288269043
Epoch: 22, Steps: 12 | Train Loss: 1.095 Vali Loss: 1.321 Vali Acc: 0.594 Test Loss: 1.321 Test Acc: 0.594
Validation loss decreased (-0.588875 --> -0.594431).  Saving model ...
Epoch: 23 cost time: 0.835479736328125
Epoch: 23, Steps: 12 | Train Loss: 0.996 Vali Loss: 1.270 Vali Acc: 0.611 Test Loss: 1.270 Test Acc: 0.611
Validation loss decreased (-0.594431 --> -0.611098).  Saving model ...
Epoch: 24 cost time: 0.7191951274871826
Epoch: 24, Steps: 12 | Train Loss: 0.994 Vali Loss: 1.214 Vali Acc: 0.622 Test Loss: 1.214 Test Acc: 0.622
Validation loss decreased (-0.611098 --> -0.622210).  Saving model ...
Epoch: 25 cost time: 0.9552431106567383
Epoch: 25, Steps: 12 | Train Loss: 0.979 Vali Loss: 1.175 Vali Acc: 0.628 Test Loss: 1.175 Test Acc: 0.628
Validation loss decreased (-0.622210 --> -0.627766).  Saving model ...
Epoch: 26 cost time: 0.7931933403015137
Epoch: 26, Steps: 12 | Train Loss: 0.871 Vali Loss: 1.109 Vali Acc: 0.650 Test Loss: 1.109 Test Acc: 0.650
Validation loss decreased (-0.627766 --> -0.649989).  Saving model ...
Epoch: 27 cost time: 0.7193455696105957
Epoch: 27, Steps: 12 | Train Loss: 0.830 Vali Loss: 1.075 Vali Acc: 0.678 Test Loss: 1.075 Test Acc: 0.678
Validation loss decreased (-0.649989 --> -0.677767).  Saving model ...
Epoch: 28 cost time: 0.8620991706848145
Epoch: 28, Steps: 12 | Train Loss: 0.805 Vali Loss: 1.049 Vali Acc: 0.667 Test Loss: 1.049 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8006167411804199
Epoch: 29, Steps: 12 | Train Loss: 0.767 Vali Loss: 0.988 Vali Acc: 0.717 Test Loss: 0.988 Test Acc: 0.717
Validation loss decreased (-0.677767 --> -0.716657).  Saving model ...
Epoch: 30 cost time: 0.7604234218597412
Epoch: 30, Steps: 12 | Train Loss: 0.706 Vali Loss: 0.958 Vali Acc: 0.733 Test Loss: 0.958 Test Acc: 0.733
Validation loss decreased (-0.716657 --> -0.733324).  Saving model ...
Epoch: 31 cost time: 0.8076720237731934
Epoch: 31, Steps: 12 | Train Loss: 0.655 Vali Loss: 0.930 Vali Acc: 0.728 Test Loss: 0.930 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7005183696746826
Epoch: 32, Steps: 12 | Train Loss: 0.643 Vali Loss: 0.891 Vali Acc: 0.756 Test Loss: 0.891 Test Acc: 0.756
Validation loss decreased (-0.733324 --> -0.755547).  Saving model ...
Epoch: 33 cost time: 0.793893575668335
Epoch: 33, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.857 Vali Acc: 0.756 Test Loss: 0.857 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755547).  Saving model ...
Epoch: 34 cost time: 0.7253222465515137
Epoch: 34, Steps: 12 | Train Loss: 0.562 Vali Loss: 0.846 Vali Acc: 0.733 Test Loss: 0.846 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.777766227722168
Epoch: 35, Steps: 12 | Train Loss: 0.582 Vali Loss: 0.809 Vali Acc: 0.772 Test Loss: 0.809 Test Acc: 0.772
Validation loss decreased (-0.755547 --> -0.772214).  Saving model ...
Epoch: 36 cost time: 0.8505499362945557
Epoch: 36, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.781 Vali Acc: 0.761 Test Loss: 0.781 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8124861717224121
Epoch: 37, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.762 Vali Acc: 0.772 Test Loss: 0.762 Test Acc: 0.772
Validation loss decreased (-0.772214 --> -0.772215).  Saving model ...
Epoch: 38 cost time: 0.8271775245666504
Epoch: 38, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.725 Vali Acc: 0.806 Test Loss: 0.725 Test Acc: 0.806
Validation loss decreased (-0.772215 --> -0.805548).  Saving model ...
Epoch: 39 cost time: 0.9258403778076172
Epoch: 39, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.695 Vali Acc: 0.789 Test Loss: 0.695 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1345276832580566
Epoch: 40, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.682 Vali Acc: 0.822 Test Loss: 0.682 Test Acc: 0.822
Validation loss decreased (-0.805548 --> -0.822215).  Saving model ...
Epoch: 41 cost time: 0.9792945384979248
Epoch: 41, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.656 Vali Acc: 0.806 Test Loss: 0.656 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0413987636566162
Epoch: 42, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.634 Vali Acc: 0.817 Test Loss: 0.634 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.9339687824249268
Epoch: 43, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.624 Vali Acc: 0.817 Test Loss: 0.624 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.8611912727355957
Epoch: 44, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.613 Vali Acc: 0.822 Test Loss: 0.613 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822216).  Saving model ...
Epoch: 45 cost time: 0.8878233432769775
Epoch: 45, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.593 Vali Acc: 0.822 Test Loss: 0.593 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 46 cost time: 0.9283533096313477
Epoch: 46, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.570 Vali Acc: 0.828 Test Loss: 0.570 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827772).  Saving model ...
Epoch: 47 cost time: 0.8190267086029053
Epoch: 47, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.577 Vali Acc: 0.828 Test Loss: 0.577 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8789713382720947
Epoch: 48, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.580 Vali Acc: 0.822 Test Loss: 0.580 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.8380167484283447
Epoch: 49, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.563 Vali Acc: 0.844 Test Loss: 0.563 Test Acc: 0.844
Validation loss decreased (-0.827772 --> -0.844439).  Saving model ...
Epoch: 50 cost time: 0.809807538986206
Epoch: 50, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.530 Vali Acc: 0.850 Test Loss: 0.530 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849995).  Saving model ...
Epoch: 51 cost time: 0.9276344776153564
Epoch: 51, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.538 Vali Acc: 0.856 Test Loss: 0.538 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855550).  Saving model ...
Epoch: 52 cost time: 0.7821118831634521
Epoch: 52, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.535 Vali Acc: 0.856 Test Loss: 0.535 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 53 cost time: 0.7953705787658691
Epoch: 53, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.549 Vali Acc: 0.833 Test Loss: 0.549 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.7517564296722412
Epoch: 54, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.523 Vali Acc: 0.861 Test Loss: 0.523 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 55 cost time: 0.7933800220489502
Epoch: 55, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.524 Vali Acc: 0.861 Test Loss: 0.524 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.8363282680511475
Epoch: 56, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.515 Vali Acc: 0.861 Test Loss: 0.515 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 57 cost time: 0.9435369968414307
Epoch: 57, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.508 Vali Acc: 0.856 Test Loss: 0.508 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.9004557132720947
Epoch: 58, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.495 Vali Acc: 0.850 Test Loss: 0.495 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.0185458660125732
Epoch: 59, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.496 Vali Acc: 0.861 Test Loss: 0.496 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 60 cost time: 0.8074016571044922
Epoch: 60, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.498 Vali Acc: 0.850 Test Loss: 0.498 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.9325828552246094
Epoch: 61, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.517 Vali Acc: 0.850 Test Loss: 0.517 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.9271430969238281
Epoch: 62, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.503 Vali Acc: 0.872 Test Loss: 0.503 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 63 cost time: 0.7544057369232178
Epoch: 63, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.491 Vali Acc: 0.861 Test Loss: 0.491 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.972332239151001
Epoch: 64, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.509 Vali Acc: 0.867 Test Loss: 0.509 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.9897458553314209
Epoch: 65, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.534 Vali Acc: 0.867 Test Loss: 0.534 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.8058934211730957
Epoch: 66, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.498 Vali Acc: 0.867 Test Loss: 0.498 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.8539330959320068
Epoch: 67, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.477 Vali Acc: 0.861 Test Loss: 0.477 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.9601342678070068
Epoch: 68, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.476 Vali Acc: 0.872 Test Loss: 0.476 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 69 cost time: 0.8458852767944336
Epoch: 69, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.474 Vali Acc: 0.867 Test Loss: 0.474 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.8399019241333008
Epoch: 70, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.503 Vali Acc: 0.883 Test Loss: 0.503 Test Acc: 0.883
Validation loss decreased (-0.872217 --> -0.883328).  Saving model ...
Epoch: 71 cost time: 0.7579989433288574
Epoch: 71, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.523 Vali Acc: 0.872 Test Loss: 0.523 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.7866859436035156
Epoch: 72, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.509 Vali Acc: 0.883 Test Loss: 0.509 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.8205718994140625
Epoch: 73, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.497 Vali Acc: 0.867 Test Loss: 0.497 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.9960801601409912
Epoch: 74, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.481 Vali Acc: 0.883 Test Loss: 0.481 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883329).  Saving model ...
Epoch: 75 cost time: 0.7413628101348877
Epoch: 75, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.533 Vali Acc: 0.872 Test Loss: 0.533 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.8618335723876953
Epoch: 76, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.501 Vali Acc: 0.872 Test Loss: 0.501 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.7402935028076172
Epoch: 77, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.506 Vali Acc: 0.878 Test Loss: 0.506 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 0.8320779800415039
Epoch: 78, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.496 Vali Acc: 0.867 Test Loss: 0.496 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 0.9114470481872559
Epoch: 79, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.495 Vali Acc: 0.878 Test Loss: 0.495 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 0.9006106853485107
Epoch: 80, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.529 Vali Acc: 0.878 Test Loss: 0.529 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 0.8319196701049805
Epoch: 81, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.512 Vali Acc: 0.867 Test Loss: 0.512 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 0.8291704654693604
Epoch: 82, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.529 Vali Acc: 0.883 Test Loss: 0.529 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 83 cost time: 0.7995109558105469
Epoch: 83, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.515 Vali Acc: 0.867 Test Loss: 0.515 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 84 cost time: 0.8149003982543945
Epoch: 84, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.502 Vali Acc: 0.878 Test Loss: 0.502 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 157223
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.494550943374634
Epoch: 1, Steps: 12 | Train Loss: 2.895 Vali Loss: 2.802 Vali Acc: 0.072 Test Loss: 2.802 Test Acc: 0.072
Validation loss decreased (inf --> -0.072194).  Saving model ...
Epoch: 2 cost time: 0.8756821155548096
Epoch: 2, Steps: 12 | Train Loss: 2.812 Vali Loss: 2.746 Vali Acc: 0.089 Test Loss: 2.746 Test Acc: 0.089
Validation loss decreased (-0.072194 --> -0.088861).  Saving model ...
Epoch: 3 cost time: 0.8121438026428223
Epoch: 3, Steps: 12 | Train Loss: 2.775 Vali Loss: 2.692 Vali Acc: 0.161 Test Loss: 2.692 Test Acc: 0.161
Validation loss decreased (-0.088861 --> -0.161084).  Saving model ...
Epoch: 4 cost time: 0.7075779438018799
Epoch: 4, Steps: 12 | Train Loss: 2.672 Vali Loss: 2.646 Vali Acc: 0.189 Test Loss: 2.646 Test Acc: 0.189
Validation loss decreased (-0.161084 --> -0.188862).  Saving model ...
Epoch: 5 cost time: 0.8057692050933838
Epoch: 5, Steps: 12 | Train Loss: 2.581 Vali Loss: 2.596 Vali Acc: 0.222 Test Loss: 2.596 Test Acc: 0.222
Validation loss decreased (-0.188862 --> -0.222196).  Saving model ...
Epoch: 6 cost time: 0.7788786888122559
Epoch: 6, Steps: 12 | Train Loss: 2.564 Vali Loss: 2.540 Vali Acc: 0.300 Test Loss: 2.540 Test Acc: 0.300
Validation loss decreased (-0.222196 --> -0.299975).  Saving model ...
Epoch: 7 cost time: 0.8213891983032227
Epoch: 7, Steps: 12 | Train Loss: 2.463 Vali Loss: 2.477 Vali Acc: 0.361 Test Loss: 2.477 Test Acc: 0.361
Validation loss decreased (-0.299975 --> -0.361086).  Saving model ...
Epoch: 8 cost time: 0.767486572265625
Epoch: 8, Steps: 12 | Train Loss: 2.386 Vali Loss: 2.405 Vali Acc: 0.356 Test Loss: 2.405 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9380543231964111
Epoch: 9, Steps: 12 | Train Loss: 2.309 Vali Loss: 2.323 Vali Acc: 0.378 Test Loss: 2.323 Test Acc: 0.378
Validation loss decreased (-0.361086 --> -0.377755).  Saving model ...
Epoch: 10 cost time: 0.7786531448364258
Epoch: 10, Steps: 12 | Train Loss: 2.189 Vali Loss: 2.236 Vali Acc: 0.389 Test Loss: 2.236 Test Acc: 0.389
Validation loss decreased (-0.377755 --> -0.388867).  Saving model ...
Epoch: 11 cost time: 0.8600738048553467
Epoch: 11, Steps: 12 | Train Loss: 2.081 Vali Loss: 2.143 Vali Acc: 0.406 Test Loss: 2.143 Test Acc: 0.406
Validation loss decreased (-0.388867 --> -0.405534).  Saving model ...
Epoch: 12 cost time: 0.8582260608673096
Epoch: 12, Steps: 12 | Train Loss: 1.970 Vali Loss: 2.056 Vali Acc: 0.417 Test Loss: 2.056 Test Acc: 0.417
Validation loss decreased (-0.405534 --> -0.416646).  Saving model ...
Epoch: 13 cost time: 0.7755086421966553
Epoch: 13, Steps: 12 | Train Loss: 1.824 Vali Loss: 1.959 Vali Acc: 0.428 Test Loss: 1.959 Test Acc: 0.428
Validation loss decreased (-0.416646 --> -0.427758).  Saving model ...
Epoch: 14 cost time: 0.7511634826660156
Epoch: 14, Steps: 12 | Train Loss: 1.679 Vali Loss: 1.872 Vali Acc: 0.467 Test Loss: 1.872 Test Acc: 0.467
Validation loss decreased (-0.427758 --> -0.466648).  Saving model ...
Epoch: 15 cost time: 0.7556838989257812
Epoch: 15, Steps: 12 | Train Loss: 1.618 Vali Loss: 1.786 Vali Acc: 0.500 Test Loss: 1.786 Test Acc: 0.500
Validation loss decreased (-0.466648 --> -0.499982).  Saving model ...
Epoch: 16 cost time: 0.7869300842285156
Epoch: 16, Steps: 12 | Train Loss: 1.554 Vali Loss: 1.714 Vali Acc: 0.522 Test Loss: 1.714 Test Acc: 0.522
Validation loss decreased (-0.499982 --> -0.522205).  Saving model ...
Epoch: 17 cost time: 0.9392776489257812
Epoch: 17, Steps: 12 | Train Loss: 1.428 Vali Loss: 1.637 Vali Acc: 0.528 Test Loss: 1.637 Test Acc: 0.528
Validation loss decreased (-0.522205 --> -0.527761).  Saving model ...
Epoch: 18 cost time: 0.8125455379486084
Epoch: 18, Steps: 12 | Train Loss: 1.325 Vali Loss: 1.576 Vali Acc: 0.539 Test Loss: 1.576 Test Acc: 0.539
Validation loss decreased (-0.527761 --> -0.538873).  Saving model ...
Epoch: 19 cost time: 0.8109052181243896
Epoch: 19, Steps: 12 | Train Loss: 1.189 Vali Loss: 1.499 Vali Acc: 0.567 Test Loss: 1.499 Test Acc: 0.567
Validation loss decreased (-0.538873 --> -0.566652).  Saving model ...
Epoch: 20 cost time: 0.8292672634124756
Epoch: 20, Steps: 12 | Train Loss: 1.165 Vali Loss: 1.441 Vali Acc: 0.572 Test Loss: 1.441 Test Acc: 0.572
Validation loss decreased (-0.566652 --> -0.572208).  Saving model ...
Epoch: 21 cost time: 0.8305156230926514
Epoch: 21, Steps: 12 | Train Loss: 1.107 Vali Loss: 1.382 Vali Acc: 0.583 Test Loss: 1.382 Test Acc: 0.583
Validation loss decreased (-0.572208 --> -0.583320).  Saving model ...
Epoch: 22 cost time: 0.837918758392334
Epoch: 22, Steps: 12 | Train Loss: 1.050 Vali Loss: 1.351 Vali Acc: 0.578 Test Loss: 1.351 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8338503837585449
Epoch: 23, Steps: 12 | Train Loss: 1.004 Vali Loss: 1.301 Vali Acc: 0.583 Test Loss: 1.301 Test Acc: 0.583
Validation loss decreased (-0.583320 --> -0.583320).  Saving model ...
Epoch: 24 cost time: 0.8429934978485107
Epoch: 24, Steps: 12 | Train Loss: 0.970 Vali Loss: 1.261 Vali Acc: 0.583 Test Loss: 1.261 Test Acc: 0.583
Validation loss decreased (-0.583320 --> -0.583321).  Saving model ...
Epoch: 25 cost time: 0.8310215473175049
Epoch: 25, Steps: 12 | Train Loss: 0.910 Vali Loss: 1.209 Vali Acc: 0.628 Test Loss: 1.209 Test Acc: 0.628
Validation loss decreased (-0.583321 --> -0.627766).  Saving model ...
Epoch: 26 cost time: 0.8183145523071289
Epoch: 26, Steps: 12 | Train Loss: 0.881 Vali Loss: 1.181 Vali Acc: 0.606 Test Loss: 1.181 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8009600639343262
Epoch: 27, Steps: 12 | Train Loss: 0.833 Vali Loss: 1.142 Vali Acc: 0.617 Test Loss: 1.142 Test Acc: 0.617
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.796034574508667
Epoch: 28, Steps: 12 | Train Loss: 0.805 Vali Loss: 1.106 Vali Acc: 0.622 Test Loss: 1.106 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.84503173828125
Epoch: 29, Steps: 12 | Train Loss: 0.780 Vali Loss: 1.076 Vali Acc: 0.650 Test Loss: 1.076 Test Acc: 0.650
Validation loss decreased (-0.627766 --> -0.649989).  Saving model ...
Epoch: 30 cost time: 0.8811416625976562
Epoch: 30, Steps: 12 | Train Loss: 0.777 Vali Loss: 1.034 Vali Acc: 0.667 Test Loss: 1.034 Test Acc: 0.667
Validation loss decreased (-0.649989 --> -0.666656).  Saving model ...
Epoch: 31 cost time: 0.6796164512634277
Epoch: 31, Steps: 12 | Train Loss: 0.698 Vali Loss: 0.988 Vali Acc: 0.678 Test Loss: 0.988 Test Acc: 0.678
Validation loss decreased (-0.666656 --> -0.677768).  Saving model ...
Epoch: 32 cost time: 0.7372012138366699
Epoch: 32, Steps: 12 | Train Loss: 0.727 Vali Loss: 0.963 Vali Acc: 0.694 Test Loss: 0.963 Test Acc: 0.694
Validation loss decreased (-0.677768 --> -0.694435).  Saving model ...
Epoch: 33 cost time: 0.8210384845733643
Epoch: 33, Steps: 12 | Train Loss: 0.648 Vali Loss: 0.928 Vali Acc: 0.689 Test Loss: 0.928 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8113884925842285
Epoch: 34, Steps: 12 | Train Loss: 0.604 Vali Loss: 0.919 Vali Acc: 0.711 Test Loss: 0.919 Test Acc: 0.711
Validation loss decreased (-0.694435 --> -0.711102).  Saving model ...
Epoch: 35 cost time: 0.7747917175292969
Epoch: 35, Steps: 12 | Train Loss: 0.571 Vali Loss: 0.886 Vali Acc: 0.706 Test Loss: 0.886 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7788736820220947
Epoch: 36, Steps: 12 | Train Loss: 0.529 Vali Loss: 0.858 Vali Acc: 0.689 Test Loss: 0.858 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8094139099121094
Epoch: 37, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.832 Vali Acc: 0.711 Test Loss: 0.832 Test Acc: 0.711
Validation loss decreased (-0.711102 --> -0.711103).  Saving model ...
Epoch: 38 cost time: 0.7945892810821533
Epoch: 38, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.827 Vali Acc: 0.728 Test Loss: 0.827 Test Acc: 0.728
Validation loss decreased (-0.711103 --> -0.727770).  Saving model ...
Epoch: 39 cost time: 0.715775728225708
Epoch: 39, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.778 Vali Acc: 0.744 Test Loss: 0.778 Test Acc: 0.744
Validation loss decreased (-0.727770 --> -0.744437).  Saving model ...
Epoch: 40 cost time: 0.8636975288391113
Epoch: 40, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.755 Vali Acc: 0.744 Test Loss: 0.755 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744437).  Saving model ...
Epoch: 41 cost time: 0.7534816265106201
Epoch: 41, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.736 Vali Acc: 0.767 Test Loss: 0.736 Test Acc: 0.767
Validation loss decreased (-0.744437 --> -0.766659).  Saving model ...
Epoch: 42 cost time: 0.8907444477081299
Epoch: 42, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.723 Vali Acc: 0.767 Test Loss: 0.723 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766659).  Saving model ...
Epoch: 43 cost time: 0.8355193138122559
Epoch: 43, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.722 Vali Acc: 0.778 Test Loss: 0.722 Test Acc: 0.778
Validation loss decreased (-0.766659 --> -0.777771).  Saving model ...
Epoch: 44 cost time: 0.8822524547576904
Epoch: 44, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.689 Vali Acc: 0.800 Test Loss: 0.689 Test Acc: 0.800
Validation loss decreased (-0.777771 --> -0.799993).  Saving model ...
Epoch: 45 cost time: 0.8131716251373291
Epoch: 45, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.683 Vali Acc: 0.800 Test Loss: 0.683 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 46 cost time: 1.0408377647399902
Epoch: 46, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.652 Vali Acc: 0.800 Test Loss: 0.652 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 47 cost time: 0.8977768421173096
Epoch: 47, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.630 Vali Acc: 0.806 Test Loss: 0.630 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805549).  Saving model ...
Epoch: 48 cost time: 0.7797873020172119
Epoch: 48, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.639 Vali Acc: 0.811 Test Loss: 0.639 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811105).  Saving model ...
Epoch: 49 cost time: 0.7854969501495361
Epoch: 49, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.640 Vali Acc: 0.789 Test Loss: 0.640 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.9519078731536865
Epoch: 50, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.601 Vali Acc: 0.806 Test Loss: 0.601 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.8655240535736084
Epoch: 51, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.589 Vali Acc: 0.794 Test Loss: 0.589 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.7968494892120361
Epoch: 52, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.574 Vali Acc: 0.800 Test Loss: 0.574 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.8388261795043945
Epoch: 53, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.581 Vali Acc: 0.800 Test Loss: 0.581 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.7806496620178223
Epoch: 54, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.549 Vali Acc: 0.811 Test Loss: 0.549 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811106).  Saving model ...
Epoch: 55 cost time: 0.8917489051818848
Epoch: 55, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.523 Vali Acc: 0.811 Test Loss: 0.523 Test Acc: 0.811
Validation loss decreased (-0.811106 --> -0.811106).  Saving model ...
Epoch: 56 cost time: 0.7427964210510254
Epoch: 56, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.538 Vali Acc: 0.822 Test Loss: 0.538 Test Acc: 0.822
Validation loss decreased (-0.811106 --> -0.822217).  Saving model ...
Epoch: 57 cost time: 0.825495719909668
Epoch: 57, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.533 Vali Acc: 0.822 Test Loss: 0.533 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 58 cost time: 0.796715497970581
Epoch: 58, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.528 Vali Acc: 0.828 Test Loss: 0.528 Test Acc: 0.828
Validation loss decreased (-0.822217 --> -0.827772).  Saving model ...
Epoch: 59 cost time: 0.8470370769500732
Epoch: 59, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.528 Vali Acc: 0.822 Test Loss: 0.528 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.7780122756958008
Epoch: 60, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.512 Vali Acc: 0.828 Test Loss: 0.512 Test Acc: 0.828
Validation loss decreased (-0.827772 --> -0.827773).  Saving model ...
Epoch: 61 cost time: 0.7569446563720703
Epoch: 61, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.501 Vali Acc: 0.833 Test Loss: 0.501 Test Acc: 0.833
Validation loss decreased (-0.827773 --> -0.833328).  Saving model ...
Epoch: 62 cost time: 0.7586545944213867
Epoch: 62, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.514 Vali Acc: 0.828 Test Loss: 0.514 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.8880889415740967
Epoch: 63, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.530 Vali Acc: 0.817 Test Loss: 0.530 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.8457095623016357
Epoch: 64, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.521 Vali Acc: 0.833 Test Loss: 0.521 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.7227489948272705
Epoch: 65, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.508 Vali Acc: 0.828 Test Loss: 0.508 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.7516117095947266
Epoch: 66, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.509 Vali Acc: 0.828 Test Loss: 0.509 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 0.7783057689666748
Epoch: 67, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.500 Vali Acc: 0.844 Test Loss: 0.500 Test Acc: 0.844
Validation loss decreased (-0.833328 --> -0.844439).  Saving model ...
Epoch: 68 cost time: 0.7964835166931152
Epoch: 68, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.506 Vali Acc: 0.844 Test Loss: 0.506 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.805687427520752
Epoch: 69, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.482 Vali Acc: 0.828 Test Loss: 0.482 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.8609020709991455
Epoch: 70, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.489 Vali Acc: 0.850 Test Loss: 0.489 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849995).  Saving model ...
Epoch: 71 cost time: 0.7672934532165527
Epoch: 71, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.497 Vali Acc: 0.844 Test Loss: 0.497 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.8484735488891602
Epoch: 72, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.479 Vali Acc: 0.850 Test Loss: 0.479 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 73 cost time: 0.879786491394043
Epoch: 73, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.491 Vali Acc: 0.839 Test Loss: 0.491 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.9284584522247314
Epoch: 74, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.489 Vali Acc: 0.839 Test Loss: 0.489 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.8643732070922852
Epoch: 75, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.501 Vali Acc: 0.856 Test Loss: 0.501 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855551).  Saving model ...
Epoch: 76 cost time: 0.8984546661376953
Epoch: 76, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.474 Vali Acc: 0.861 Test Loss: 0.474 Test Acc: 0.861
Validation loss decreased (-0.855551 --> -0.861106).  Saving model ...
Epoch: 77 cost time: 0.8662009239196777
Epoch: 77, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.496 Vali Acc: 0.856 Test Loss: 0.496 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.9555623531341553
Epoch: 78, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.499 Vali Acc: 0.861 Test Loss: 0.499 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 0.9865357875823975
Epoch: 79, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.489 Vali Acc: 0.861 Test Loss: 0.489 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 0.8130228519439697
Epoch: 80, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.518 Vali Acc: 0.867 Test Loss: 0.518 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 81 cost time: 0.8655345439910889
Epoch: 81, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.508 Vali Acc: 0.867 Test Loss: 0.508 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866662).  Saving model ...
Epoch: 82 cost time: 0.7819845676422119
Epoch: 82, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.493 Vali Acc: 0.850 Test Loss: 0.493 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.8934261798858643
Epoch: 83, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.499 Vali Acc: 0.867 Test Loss: 0.499 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 84 cost time: 0.8464958667755127
Epoch: 84, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.489 Vali Acc: 0.861 Test Loss: 0.489 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 0.9502418041229248
Epoch: 85, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.490 Vali Acc: 0.856 Test Loss: 0.490 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 0.7640185356140137
Epoch: 86, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.505 Vali Acc: 0.872 Test Loss: 0.505 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872217).  Saving model ...
Epoch: 87 cost time: 0.7820572853088379
Epoch: 87, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.516 Vali Acc: 0.856 Test Loss: 0.516 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 0.8213131427764893
Epoch: 88, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.519 Vali Acc: 0.861 Test Loss: 0.519 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 0.7443006038665771
Epoch: 89, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.540 Vali Acc: 0.872 Test Loss: 0.540 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 0.8858401775360107
Epoch: 90, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.499 Vali Acc: 0.867 Test Loss: 0.499 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 91 cost time: 0.8468763828277588
Epoch: 91, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.511 Vali Acc: 0.872 Test Loss: 0.511 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 92 cost time: 0.8942697048187256
Epoch: 92, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.538 Vali Acc: 0.867 Test Loss: 0.538 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 93 cost time: 0.8696866035461426
Epoch: 93, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.536 Vali Acc: 0.861 Test Loss: 0.536 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 94 cost time: 0.9689676761627197
Epoch: 94, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.547 Vali Acc: 0.856 Test Loss: 0.547 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 95 cost time: 0.9008944034576416
Epoch: 95, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.566 Vali Acc: 0.856 Test Loss: 0.566 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 96 cost time: 0.9794461727142334
Epoch: 96, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.544 Vali Acc: 0.867 Test Loss: 0.544 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 107687
model size : 1.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8527469635009766
Epoch: 1, Steps: 12 | Train Loss: 2.934 Vali Loss: 2.829 Vali Acc: 0.067 Test Loss: 2.829 Test Acc: 0.067
Validation loss decreased (inf --> -0.066638).  Saving model ...
Epoch: 2 cost time: 0.8095178604125977
Epoch: 2, Steps: 12 | Train Loss: 2.860 Vali Loss: 2.741 Vali Acc: 0.072 Test Loss: 2.741 Test Acc: 0.072
Validation loss decreased (-0.066638 --> -0.072195).  Saving model ...
Epoch: 3 cost time: 0.8428552150726318
Epoch: 3, Steps: 12 | Train Loss: 2.748 Vali Loss: 2.660 Vali Acc: 0.078 Test Loss: 2.660 Test Acc: 0.078
Validation loss decreased (-0.072195 --> -0.077751).  Saving model ...
Epoch: 4 cost time: 0.8058218955993652
Epoch: 4, Steps: 12 | Train Loss: 2.707 Vali Loss: 2.594 Vali Acc: 0.111 Test Loss: 2.594 Test Acc: 0.111
Validation loss decreased (-0.077751 --> -0.111085).  Saving model ...
Epoch: 5 cost time: 0.7154734134674072
Epoch: 5, Steps: 12 | Train Loss: 2.579 Vali Loss: 2.546 Vali Acc: 0.172 Test Loss: 2.546 Test Acc: 0.172
Validation loss decreased (-0.111085 --> -0.172197).  Saving model ...
Epoch: 6 cost time: 0.7332718372344971
Epoch: 6, Steps: 12 | Train Loss: 2.520 Vali Loss: 2.500 Vali Acc: 0.278 Test Loss: 2.500 Test Acc: 0.278
Validation loss decreased (-0.172197 --> -0.277753).  Saving model ...
Epoch: 7 cost time: 0.6748669147491455
Epoch: 7, Steps: 12 | Train Loss: 2.511 Vali Loss: 2.447 Vali Acc: 0.350 Test Loss: 2.447 Test Acc: 0.350
Validation loss decreased (-0.277753 --> -0.349976).  Saving model ...
Epoch: 8 cost time: 0.7211763858795166
Epoch: 8, Steps: 12 | Train Loss: 2.433 Vali Loss: 2.392 Vali Acc: 0.367 Test Loss: 2.392 Test Acc: 0.367
Validation loss decreased (-0.349976 --> -0.366643).  Saving model ...
Epoch: 9 cost time: 0.740020751953125
Epoch: 9, Steps: 12 | Train Loss: 2.350 Vali Loss: 2.330 Vali Acc: 0.406 Test Loss: 2.330 Test Acc: 0.406
Validation loss decreased (-0.366643 --> -0.405532).  Saving model ...
Epoch: 10 cost time: 0.7679989337921143
Epoch: 10, Steps: 12 | Train Loss: 2.296 Vali Loss: 2.259 Vali Acc: 0.428 Test Loss: 2.259 Test Acc: 0.428
Validation loss decreased (-0.405532 --> -0.427755).  Saving model ...
Epoch: 11 cost time: 0.733543872833252
Epoch: 11, Steps: 12 | Train Loss: 2.197 Vali Loss: 2.189 Vali Acc: 0.422 Test Loss: 2.189 Test Acc: 0.422
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7874741554260254
Epoch: 12, Steps: 12 | Train Loss: 2.094 Vali Loss: 2.116 Vali Acc: 0.444 Test Loss: 2.116 Test Acc: 0.444
Validation loss decreased (-0.427755 --> -0.444423).  Saving model ...
Epoch: 13 cost time: 0.8013849258422852
Epoch: 13, Steps: 12 | Train Loss: 2.033 Vali Loss: 2.044 Vali Acc: 0.461 Test Loss: 2.044 Test Acc: 0.461
Validation loss decreased (-0.444423 --> -0.461091).  Saving model ...
Epoch: 14 cost time: 0.8631362915039062
Epoch: 14, Steps: 12 | Train Loss: 1.917 Vali Loss: 1.961 Vali Acc: 0.506 Test Loss: 1.961 Test Acc: 0.506
Validation loss decreased (-0.461091 --> -0.505536).  Saving model ...
Epoch: 15 cost time: 0.7096545696258545
Epoch: 15, Steps: 12 | Train Loss: 1.796 Vali Loss: 1.884 Vali Acc: 0.489 Test Loss: 1.884 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7574961185455322
Epoch: 16, Steps: 12 | Train Loss: 1.723 Vali Loss: 1.812 Vali Acc: 0.500 Test Loss: 1.812 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7031040191650391
Epoch: 17, Steps: 12 | Train Loss: 1.602 Vali Loss: 1.744 Vali Acc: 0.517 Test Loss: 1.744 Test Acc: 0.517
Validation loss decreased (-0.505536 --> -0.516649).  Saving model ...
Epoch: 18 cost time: 0.7604422569274902
Epoch: 18, Steps: 12 | Train Loss: 1.537 Vali Loss: 1.681 Vali Acc: 0.528 Test Loss: 1.681 Test Acc: 0.528
Validation loss decreased (-0.516649 --> -0.527761).  Saving model ...
Epoch: 19 cost time: 0.8010585308074951
Epoch: 19, Steps: 12 | Train Loss: 1.434 Vali Loss: 1.611 Vali Acc: 0.544 Test Loss: 1.611 Test Acc: 0.544
Validation loss decreased (-0.527761 --> -0.544428).  Saving model ...
Epoch: 20 cost time: 0.716825008392334
Epoch: 20, Steps: 12 | Train Loss: 1.381 Vali Loss: 1.551 Vali Acc: 0.533 Test Loss: 1.551 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8852996826171875
Epoch: 21, Steps: 12 | Train Loss: 1.283 Vali Loss: 1.489 Vali Acc: 0.539 Test Loss: 1.489 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7978601455688477
Epoch: 22, Steps: 12 | Train Loss: 1.237 Vali Loss: 1.437 Vali Acc: 0.567 Test Loss: 1.437 Test Acc: 0.567
Validation loss decreased (-0.544428 --> -0.566652).  Saving model ...
Epoch: 23 cost time: 0.898216724395752
Epoch: 23, Steps: 12 | Train Loss: 1.141 Vali Loss: 1.368 Vali Acc: 0.583 Test Loss: 1.368 Test Acc: 0.583
Validation loss decreased (-0.566652 --> -0.583320).  Saving model ...
Epoch: 24 cost time: 0.7649314403533936
Epoch: 24, Steps: 12 | Train Loss: 1.109 Vali Loss: 1.323 Vali Acc: 0.594 Test Loss: 1.323 Test Acc: 0.594
Validation loss decreased (-0.583320 --> -0.594431).  Saving model ...
Epoch: 25 cost time: 0.7089536190032959
Epoch: 25, Steps: 12 | Train Loss: 1.075 Vali Loss: 1.273 Vali Acc: 0.606 Test Loss: 1.273 Test Acc: 0.606
Validation loss decreased (-0.594431 --> -0.605543).  Saving model ...
Epoch: 26 cost time: 0.6792004108428955
Epoch: 26, Steps: 12 | Train Loss: 0.993 Vali Loss: 1.209 Vali Acc: 0.600 Test Loss: 1.209 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7353515625
Epoch: 27, Steps: 12 | Train Loss: 0.945 Vali Loss: 1.159 Vali Acc: 0.633 Test Loss: 1.159 Test Acc: 0.633
Validation loss decreased (-0.605543 --> -0.633322).  Saving model ...
Epoch: 28 cost time: 0.7469134330749512
Epoch: 28, Steps: 12 | Train Loss: 0.884 Vali Loss: 1.124 Vali Acc: 0.639 Test Loss: 1.124 Test Acc: 0.639
Validation loss decreased (-0.633322 --> -0.638878).  Saving model ...
Epoch: 29 cost time: 0.7807595729827881
Epoch: 29, Steps: 12 | Train Loss: 0.890 Vali Loss: 1.072 Vali Acc: 0.650 Test Loss: 1.072 Test Acc: 0.650
Validation loss decreased (-0.638878 --> -0.649989).  Saving model ...
Epoch: 30 cost time: 0.973029613494873
Epoch: 30, Steps: 12 | Train Loss: 0.749 Vali Loss: 1.026 Vali Acc: 0.667 Test Loss: 1.026 Test Acc: 0.667
Validation loss decreased (-0.649989 --> -0.666656).  Saving model ...
Epoch: 31 cost time: 0.8153812885284424
Epoch: 31, Steps: 12 | Train Loss: 0.765 Vali Loss: 0.976 Vali Acc: 0.689 Test Loss: 0.976 Test Acc: 0.689
Validation loss decreased (-0.666656 --> -0.688879).  Saving model ...
Epoch: 32 cost time: 0.8887856006622314
Epoch: 32, Steps: 12 | Train Loss: 0.745 Vali Loss: 0.933 Vali Acc: 0.694 Test Loss: 0.933 Test Acc: 0.694
Validation loss decreased (-0.688879 --> -0.694435).  Saving model ...
Epoch: 33 cost time: 0.781710147857666
Epoch: 33, Steps: 12 | Train Loss: 0.664 Vali Loss: 0.902 Vali Acc: 0.717 Test Loss: 0.902 Test Acc: 0.717
Validation loss decreased (-0.694435 --> -0.716658).  Saving model ...
Epoch: 34 cost time: 0.7772769927978516
Epoch: 34, Steps: 12 | Train Loss: 0.660 Vali Loss: 0.880 Vali Acc: 0.722 Test Loss: 0.880 Test Acc: 0.722
Validation loss decreased (-0.716658 --> -0.722213).  Saving model ...
Epoch: 35 cost time: 0.7564854621887207
Epoch: 35, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.842 Vali Acc: 0.733 Test Loss: 0.842 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733325).  Saving model ...
Epoch: 36 cost time: 0.8159325122833252
Epoch: 36, Steps: 12 | Train Loss: 0.556 Vali Loss: 0.800 Vali Acc: 0.739 Test Loss: 0.800 Test Acc: 0.739
Validation loss decreased (-0.733325 --> -0.738881).  Saving model ...
Epoch: 37 cost time: 0.7787835597991943
Epoch: 37, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.769 Vali Acc: 0.750 Test Loss: 0.769 Test Acc: 0.750
Validation loss decreased (-0.738881 --> -0.749992).  Saving model ...
Epoch: 38 cost time: 0.9905753135681152
Epoch: 38, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.756 Vali Acc: 0.778 Test Loss: 0.756 Test Acc: 0.778
Validation loss decreased (-0.749992 --> -0.777770).  Saving model ...
Epoch: 39 cost time: 0.9199609756469727
Epoch: 39, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.722 Vali Acc: 0.778 Test Loss: 0.722 Test Acc: 0.778
Validation loss decreased (-0.777770 --> -0.777771).  Saving model ...
Epoch: 40 cost time: 0.7960498332977295
Epoch: 40, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.712 Vali Acc: 0.778 Test Loss: 0.712 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 41 cost time: 0.8919737339019775
Epoch: 41, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.678 Vali Acc: 0.789 Test Loss: 0.678 Test Acc: 0.789
Validation loss decreased (-0.777771 --> -0.788882).  Saving model ...
Epoch: 42 cost time: 0.79494309425354
Epoch: 42, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.674 Vali Acc: 0.761 Test Loss: 0.674 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7562086582183838
Epoch: 43, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.643 Vali Acc: 0.789 Test Loss: 0.643 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 44 cost time: 0.7090907096862793
Epoch: 44, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.632 Vali Acc: 0.817 Test Loss: 0.632 Test Acc: 0.817
Validation loss decreased (-0.788882 --> -0.816660).  Saving model ...
Epoch: 45 cost time: 0.8512313365936279
Epoch: 45, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.621 Vali Acc: 0.817 Test Loss: 0.621 Test Acc: 0.817
Validation loss decreased (-0.816660 --> -0.816660).  Saving model ...
Epoch: 46 cost time: 0.7884824275970459
Epoch: 46, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.613 Vali Acc: 0.806 Test Loss: 0.613 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.7901673316955566
Epoch: 47, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.605 Vali Acc: 0.822 Test Loss: 0.605 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 48 cost time: 0.739865779876709
Epoch: 48, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.581 Vali Acc: 0.822 Test Loss: 0.581 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 49 cost time: 0.7290551662445068
Epoch: 49, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.559 Vali Acc: 0.844 Test Loss: 0.559 Test Acc: 0.844
Validation loss decreased (-0.822216 --> -0.844439).  Saving model ...
Epoch: 50 cost time: 0.8257846832275391
Epoch: 50, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.566 Vali Acc: 0.828 Test Loss: 0.566 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.7488675117492676
Epoch: 51, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.538 Vali Acc: 0.856 Test Loss: 0.538 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 52 cost time: 0.7432544231414795
Epoch: 52, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.550 Vali Acc: 0.822 Test Loss: 0.550 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.7738375663757324
Epoch: 53, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.545 Vali Acc: 0.856 Test Loss: 0.545 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.7201666831970215
Epoch: 54, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.536 Vali Acc: 0.850 Test Loss: 0.536 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.6992263793945312
Epoch: 55, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.534 Vali Acc: 0.856 Test Loss: 0.534 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 56 cost time: 0.6253001689910889
Epoch: 56, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.516 Vali Acc: 0.861 Test Loss: 0.516 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 57 cost time: 0.7404718399047852
Epoch: 57, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.521 Vali Acc: 0.850 Test Loss: 0.521 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.7759153842926025
Epoch: 58, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.510 Vali Acc: 0.856 Test Loss: 0.510 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.7465198040008545
Epoch: 59, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.515 Vali Acc: 0.856 Test Loss: 0.515 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.7774035930633545
Epoch: 60, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.505 Vali Acc: 0.839 Test Loss: 0.505 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.8786466121673584
Epoch: 61, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.493 Vali Acc: 0.867 Test Loss: 0.493 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866662).  Saving model ...
Epoch: 62 cost time: 0.7343053817749023
Epoch: 62, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.498 Vali Acc: 0.850 Test Loss: 0.498 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.8813691139221191
Epoch: 63, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.479 Vali Acc: 0.867 Test Loss: 0.479 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 64 cost time: 0.7949368953704834
Epoch: 64, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.488 Vali Acc: 0.867 Test Loss: 0.488 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.7885310649871826
Epoch: 65, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.485 Vali Acc: 0.867 Test Loss: 0.485 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.797248363494873
Epoch: 66, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.477 Vali Acc: 0.872 Test Loss: 0.477 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872217).  Saving model ...
Epoch: 67 cost time: 0.7830452919006348
Epoch: 67, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.469 Vali Acc: 0.856 Test Loss: 0.469 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.7637526988983154
Epoch: 68, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.476 Vali Acc: 0.872 Test Loss: 0.476 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 69 cost time: 0.8576765060424805
Epoch: 69, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.491 Vali Acc: 0.878 Test Loss: 0.491 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 70 cost time: 0.8678994178771973
Epoch: 70, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.489 Vali Acc: 0.872 Test Loss: 0.489 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.0526139736175537
Epoch: 71, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.488 Vali Acc: 0.883 Test Loss: 0.488 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883328).  Saving model ...
Epoch: 72 cost time: 0.778059720993042
Epoch: 72, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.491 Vali Acc: 0.861 Test Loss: 0.491 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.6989412307739258
Epoch: 73, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.487 Vali Acc: 0.867 Test Loss: 0.487 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.6915667057037354
Epoch: 74, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.490 Vali Acc: 0.867 Test Loss: 0.490 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 0.7457807064056396
Epoch: 75, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.494 Vali Acc: 0.889 Test Loss: 0.494 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888884).  Saving model ...
Epoch: 76 cost time: 0.8303484916687012
Epoch: 76, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.496 Vali Acc: 0.894 Test Loss: 0.496 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894439).  Saving model ...
Epoch: 77 cost time: 0.9730188846588135
Epoch: 77, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.477 Vali Acc: 0.878 Test Loss: 0.477 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.8014111518859863
Epoch: 78, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.486 Vali Acc: 0.883 Test Loss: 0.486 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 0.8890025615692139
Epoch: 79, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.513 Vali Acc: 0.889 Test Loss: 0.513 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 0.8922009468078613
Epoch: 80, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.481 Vali Acc: 0.883 Test Loss: 0.481 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 0.8458709716796875
Epoch: 81, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.495 Vali Acc: 0.889 Test Loss: 0.495 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 0.8586194515228271
Epoch: 82, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.494 Vali Acc: 0.883 Test Loss: 0.494 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 83 cost time: 0.7996847629547119
Epoch: 83, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.481 Vali Acc: 0.883 Test Loss: 0.481 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 84 cost time: 0.8745713233947754
Epoch: 84, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.477 Vali Acc: 0.889 Test Loss: 0.477 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 85 cost time: 0.7844164371490479
Epoch: 85, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.484 Vali Acc: 0.894 Test Loss: 0.484 Test Acc: 0.894
Validation loss decreased (-0.894439 --> -0.894440).  Saving model ...
Epoch: 86 cost time: 0.8064520359039307
Epoch: 86, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.478 Vali Acc: 0.894 Test Loss: 0.478 Test Acc: 0.894
Validation loss decreased (-0.894440 --> -0.894440).  Saving model ...
Epoch: 87 cost time: 0.9192113876342773
Epoch: 87, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.502 Vali Acc: 0.894 Test Loss: 0.502 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 0.7905247211456299
Epoch: 88, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.522 Vali Acc: 0.883 Test Loss: 0.522 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 0.9661052227020264
Epoch: 89, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.501 Vali Acc: 0.883 Test Loss: 0.501 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 0.7747547626495361
Epoch: 90, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.499 Vali Acc: 0.883 Test Loss: 0.499 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 91 cost time: 0.6771895885467529
Epoch: 91, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.519 Vali Acc: 0.900 Test Loss: 0.519 Test Acc: 0.900
Validation loss decreased (-0.894440 --> -0.899995).  Saving model ...
Epoch: 92 cost time: 0.8398916721343994
Epoch: 92, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.513 Vali Acc: 0.889 Test Loss: 0.513 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 0.7602343559265137
Epoch: 93, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.492 Vali Acc: 0.889 Test Loss: 0.492 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 0.7922558784484863
Epoch: 94, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.506 Vali Acc: 0.889 Test Loss: 0.506 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 95 cost time: 0.8843235969543457
Epoch: 95, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.508 Vali Acc: 0.883 Test Loss: 0.508 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 96 cost time: 0.9564018249511719
Epoch: 96, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.521 Vali Acc: 0.894 Test Loss: 0.521 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 97 cost time: 0.8047671318054199
Epoch: 97, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.534 Vali Acc: 0.894 Test Loss: 0.534 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 98 cost time: 0.8178257942199707
Epoch: 98, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.526 Vali Acc: 0.889 Test Loss: 0.526 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 99 cost time: 0.9290082454681396
Epoch: 99, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.517 Vali Acc: 0.894 Test Loss: 0.517 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 100 cost time: 0.7849087715148926
Epoch: 100, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.516 Vali Acc: 0.894 Test Loss: 0.516 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 107559
model size : 1.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6903159618377686
Epoch: 1, Steps: 12 | Train Loss: 2.833 Vali Loss: 2.873 Vali Acc: 0.072 Test Loss: 2.873 Test Acc: 0.072
Validation loss decreased (inf --> -0.072193).  Saving model ...
Epoch: 2 cost time: 0.9969162940979004
Epoch: 2, Steps: 12 | Train Loss: 2.776 Vali Loss: 2.817 Vali Acc: 0.067 Test Loss: 2.817 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9040741920471191
Epoch: 3, Steps: 12 | Train Loss: 2.740 Vali Loss: 2.762 Vali Acc: 0.033 Test Loss: 2.762 Test Acc: 0.033
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9008417129516602
Epoch: 4, Steps: 12 | Train Loss: 2.672 Vali Loss: 2.714 Vali Acc: 0.067 Test Loss: 2.714 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9833323955535889
Epoch: 5, Steps: 12 | Train Loss: 2.590 Vali Loss: 2.669 Vali Acc: 0.106 Test Loss: 2.669 Test Acc: 0.106
Validation loss decreased (-0.072193 --> -0.105529).  Saving model ...
Epoch: 6 cost time: 0.9552812576293945
Epoch: 6, Steps: 12 | Train Loss: 2.537 Vali Loss: 2.624 Vali Acc: 0.189 Test Loss: 2.624 Test Acc: 0.189
Validation loss decreased (-0.105529 --> -0.188863).  Saving model ...
Epoch: 7 cost time: 0.9196145534515381
Epoch: 7, Steps: 12 | Train Loss: 2.498 Vali Loss: 2.567 Vali Acc: 0.244 Test Loss: 2.567 Test Acc: 0.244
Validation loss decreased (-0.188863 --> -0.244419).  Saving model ...
Epoch: 8 cost time: 0.982018232345581
Epoch: 8, Steps: 12 | Train Loss: 2.417 Vali Loss: 2.506 Vali Acc: 0.311 Test Loss: 2.506 Test Acc: 0.311
Validation loss decreased (-0.244419 --> -0.311086).  Saving model ...
Epoch: 9 cost time: 0.9235093593597412
Epoch: 9, Steps: 12 | Train Loss: 2.326 Vali Loss: 2.440 Vali Acc: 0.350 Test Loss: 2.440 Test Acc: 0.350
Validation loss decreased (-0.311086 --> -0.349976).  Saving model ...
Epoch: 10 cost time: 0.8432178497314453
Epoch: 10, Steps: 12 | Train Loss: 2.274 Vali Loss: 2.361 Vali Acc: 0.367 Test Loss: 2.361 Test Acc: 0.367
Validation loss decreased (-0.349976 --> -0.366643).  Saving model ...
Epoch: 11 cost time: 0.8314025402069092
Epoch: 11, Steps: 12 | Train Loss: 2.188 Vali Loss: 2.281 Vali Acc: 0.406 Test Loss: 2.281 Test Acc: 0.406
Validation loss decreased (-0.366643 --> -0.405533).  Saving model ...
Epoch: 12 cost time: 0.8898658752441406
Epoch: 12, Steps: 12 | Train Loss: 2.063 Vali Loss: 2.191 Vali Acc: 0.428 Test Loss: 2.191 Test Acc: 0.428
Validation loss decreased (-0.405533 --> -0.427756).  Saving model ...
Epoch: 13 cost time: 0.8106553554534912
Epoch: 13, Steps: 12 | Train Loss: 1.985 Vali Loss: 2.101 Vali Acc: 0.456 Test Loss: 2.101 Test Acc: 0.456
Validation loss decreased (-0.427756 --> -0.455535).  Saving model ...
Epoch: 14 cost time: 0.7992691993713379
Epoch: 14, Steps: 12 | Train Loss: 1.904 Vali Loss: 2.010 Vali Acc: 0.494 Test Loss: 2.010 Test Acc: 0.494
Validation loss decreased (-0.455535 --> -0.494424).  Saving model ...
Epoch: 15 cost time: 0.8179242610931396
Epoch: 15, Steps: 12 | Train Loss: 1.749 Vali Loss: 1.919 Vali Acc: 0.517 Test Loss: 1.919 Test Acc: 0.517
Validation loss decreased (-0.494424 --> -0.516647).  Saving model ...
Epoch: 16 cost time: 0.9616193771362305
Epoch: 16, Steps: 12 | Train Loss: 1.630 Vali Loss: 1.835 Vali Acc: 0.533 Test Loss: 1.835 Test Acc: 0.533
Validation loss decreased (-0.516647 --> -0.533315).  Saving model ...
Epoch: 17 cost time: 0.8799879550933838
Epoch: 17, Steps: 12 | Train Loss: 1.568 Vali Loss: 1.753 Vali Acc: 0.556 Test Loss: 1.753 Test Acc: 0.556
Validation loss decreased (-0.533315 --> -0.555538).  Saving model ...
Epoch: 18 cost time: 0.8544232845306396
Epoch: 18, Steps: 12 | Train Loss: 1.432 Vali Loss: 1.663 Vali Acc: 0.544 Test Loss: 1.663 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8772931098937988
Epoch: 19, Steps: 12 | Train Loss: 1.389 Vali Loss: 1.587 Vali Acc: 0.572 Test Loss: 1.587 Test Acc: 0.572
Validation loss decreased (-0.555538 --> -0.572206).  Saving model ...
Epoch: 20 cost time: 0.8238706588745117
Epoch: 20, Steps: 12 | Train Loss: 1.329 Vali Loss: 1.519 Vali Acc: 0.567 Test Loss: 1.519 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.801513671875
Epoch: 21, Steps: 12 | Train Loss: 1.195 Vali Loss: 1.459 Vali Acc: 0.589 Test Loss: 1.459 Test Acc: 0.589
Validation loss decreased (-0.572206 --> -0.588874).  Saving model ...
Epoch: 22 cost time: 0.8487884998321533
Epoch: 22, Steps: 12 | Train Loss: 1.132 Vali Loss: 1.399 Vali Acc: 0.583 Test Loss: 1.399 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8876569271087646
Epoch: 23, Steps: 12 | Train Loss: 1.067 Vali Loss: 1.330 Vali Acc: 0.600 Test Loss: 1.330 Test Acc: 0.600
Validation loss decreased (-0.588874 --> -0.599987).  Saving model ...
Epoch: 24 cost time: 0.7957799434661865
Epoch: 24, Steps: 12 | Train Loss: 1.088 Vali Loss: 1.269 Vali Acc: 0.611 Test Loss: 1.269 Test Acc: 0.611
Validation loss decreased (-0.599987 --> -0.611098).  Saving model ...
Epoch: 25 cost time: 0.8707959651947021
Epoch: 25, Steps: 12 | Train Loss: 0.957 Vali Loss: 1.210 Vali Acc: 0.606 Test Loss: 1.210 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.428600788116455
Epoch: 26, Steps: 12 | Train Loss: 0.896 Vali Loss: 1.168 Vali Acc: 0.656 Test Loss: 1.168 Test Acc: 0.656
Validation loss decreased (-0.611098 --> -0.655544).  Saving model ...
Epoch: 27 cost time: 1.0311360359191895
Epoch: 27, Steps: 12 | Train Loss: 0.860 Vali Loss: 1.118 Vali Acc: 0.628 Test Loss: 1.118 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0358307361602783
Epoch: 28, Steps: 12 | Train Loss: 0.816 Vali Loss: 1.075 Vali Acc: 0.650 Test Loss: 1.075 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7993438243865967
Epoch: 29, Steps: 12 | Train Loss: 0.764 Vali Loss: 1.055 Vali Acc: 0.678 Test Loss: 1.055 Test Acc: 0.678
Validation loss decreased (-0.655544 --> -0.677767).  Saving model ...
Epoch: 30 cost time: 0.9060778617858887
Epoch: 30, Steps: 12 | Train Loss: 0.737 Vali Loss: 1.009 Vali Acc: 0.706 Test Loss: 1.009 Test Acc: 0.706
Validation loss decreased (-0.677767 --> -0.705545).  Saving model ...
Epoch: 31 cost time: 0.9969584941864014
Epoch: 31, Steps: 12 | Train Loss: 0.710 Vali Loss: 0.975 Vali Acc: 0.706 Test Loss: 0.975 Test Acc: 0.706
Validation loss decreased (-0.705545 --> -0.705546).  Saving model ...
Epoch: 32 cost time: 0.8351461887359619
Epoch: 32, Steps: 12 | Train Loss: 0.636 Vali Loss: 0.945 Vali Acc: 0.722 Test Loss: 0.945 Test Acc: 0.722
Validation loss decreased (-0.705546 --> -0.722213).  Saving model ...
Epoch: 33 cost time: 0.9464824199676514
Epoch: 33, Steps: 12 | Train Loss: 0.627 Vali Loss: 0.922 Vali Acc: 0.722 Test Loss: 0.922 Test Acc: 0.722
Validation loss decreased (-0.722213 --> -0.722213).  Saving model ...
Epoch: 34 cost time: 0.7284255027770996
Epoch: 34, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.899 Vali Acc: 0.733 Test Loss: 0.899 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733324).  Saving model ...
Epoch: 35 cost time: 0.7729067802429199
Epoch: 35, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.864 Vali Acc: 0.750 Test Loss: 0.864 Test Acc: 0.750
Validation loss decreased (-0.733324 --> -0.749991).  Saving model ...
Epoch: 36 cost time: 0.8818116188049316
Epoch: 36, Steps: 12 | Train Loss: 0.582 Vali Loss: 0.839 Vali Acc: 0.756 Test Loss: 0.839 Test Acc: 0.756
Validation loss decreased (-0.749991 --> -0.755547).  Saving model ...
Epoch: 37 cost time: 0.7034246921539307
Epoch: 37, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.796 Vali Acc: 0.772 Test Loss: 0.796 Test Acc: 0.772
Validation loss decreased (-0.755547 --> -0.772214).  Saving model ...
Epoch: 38 cost time: 0.8058838844299316
Epoch: 38, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.785 Vali Acc: 0.783 Test Loss: 0.785 Test Acc: 0.783
Validation loss decreased (-0.772214 --> -0.783325).  Saving model ...
Epoch: 39 cost time: 0.8926980495452881
Epoch: 39, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.755 Vali Acc: 0.789 Test Loss: 0.755 Test Acc: 0.789
Validation loss decreased (-0.783325 --> -0.788881).  Saving model ...
Epoch: 40 cost time: 0.8331961631774902
Epoch: 40, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.743 Vali Acc: 0.800 Test Loss: 0.743 Test Acc: 0.800
Validation loss decreased (-0.788881 --> -0.799993).  Saving model ...
Epoch: 41 cost time: 0.7915651798248291
Epoch: 41, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.731 Vali Acc: 0.800 Test Loss: 0.731 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 42 cost time: 0.8586962223052979
Epoch: 42, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.687 Vali Acc: 0.800 Test Loss: 0.687 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 43 cost time: 0.862511157989502
Epoch: 43, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.677 Vali Acc: 0.806 Test Loss: 0.677 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805549).  Saving model ...
Epoch: 44 cost time: 0.9566748142242432
Epoch: 44, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.665 Vali Acc: 0.811 Test Loss: 0.665 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811104).  Saving model ...
Epoch: 45 cost time: 0.7977981567382812
Epoch: 45, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.665 Vali Acc: 0.811 Test Loss: 0.665 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8136091232299805
Epoch: 46, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.658 Vali Acc: 0.811 Test Loss: 0.658 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811105).  Saving model ...
Epoch: 47 cost time: 0.8924951553344727
Epoch: 47, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.630 Vali Acc: 0.811 Test Loss: 0.630 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 48 cost time: 1.032301902770996
Epoch: 48, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.606 Vali Acc: 0.822 Test Loss: 0.606 Test Acc: 0.822
Validation loss decreased (-0.811105 --> -0.822216).  Saving model ...
Epoch: 49 cost time: 0.919663667678833
Epoch: 49, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.603 Vali Acc: 0.822 Test Loss: 0.603 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 50 cost time: 0.8994698524475098
Epoch: 50, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.611 Vali Acc: 0.811 Test Loss: 0.611 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.0608360767364502
Epoch: 51, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.598 Vali Acc: 0.817 Test Loss: 0.598 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.7659194469451904
Epoch: 52, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.569 Vali Acc: 0.822 Test Loss: 0.569 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822217).  Saving model ...
Epoch: 53 cost time: 0.786740779876709
Epoch: 53, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.566 Vali Acc: 0.822 Test Loss: 0.566 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 54 cost time: 0.8383872509002686
Epoch: 54, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.583 Vali Acc: 0.833 Test Loss: 0.583 Test Acc: 0.833
Validation loss decreased (-0.822217 --> -0.833328).  Saving model ...
Epoch: 55 cost time: 0.9994897842407227
Epoch: 55, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.563 Vali Acc: 0.839 Test Loss: 0.563 Test Acc: 0.839
Validation loss decreased (-0.833328 --> -0.838883).  Saving model ...
Epoch: 56 cost time: 0.9099993705749512
Epoch: 56, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.559 Vali Acc: 0.828 Test Loss: 0.559 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.7660212516784668
Epoch: 57, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.560 Vali Acc: 0.856 Test Loss: 0.560 Test Acc: 0.856
Validation loss decreased (-0.838883 --> -0.855550).  Saving model ...
Epoch: 58 cost time: 0.8884599208831787
Epoch: 58, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.590 Vali Acc: 0.806 Test Loss: 0.590 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.8331763744354248
Epoch: 59, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.573 Vali Acc: 0.828 Test Loss: 0.573 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.7683806419372559
Epoch: 60, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.547 Vali Acc: 0.850 Test Loss: 0.547 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.8597846031188965
Epoch: 61, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.564 Vali Acc: 0.856 Test Loss: 0.564 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.821051836013794
Epoch: 62, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.538 Vali Acc: 0.839 Test Loss: 0.538 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.8958616256713867
Epoch: 63, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.538 Vali Acc: 0.844 Test Loss: 0.538 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.9205827713012695
Epoch: 64, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.559 Vali Acc: 0.844 Test Loss: 0.559 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.8935468196868896
Epoch: 65, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.573 Vali Acc: 0.839 Test Loss: 0.573 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 0.8174211978912354
Epoch: 66, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.581 Vali Acc: 0.861 Test Loss: 0.581 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 67 cost time: 0.8661000728607178
Epoch: 67, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.556 Vali Acc: 0.850 Test Loss: 0.556 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.8230013847351074
Epoch: 68, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.570 Vali Acc: 0.850 Test Loss: 0.570 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.7514657974243164
Epoch: 69, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.557 Vali Acc: 0.850 Test Loss: 0.557 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.9491395950317383
Epoch: 70, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.572 Vali Acc: 0.856 Test Loss: 0.572 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.9551939964294434
Epoch: 71, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.560 Vali Acc: 0.856 Test Loss: 0.560 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 1.0780174732208252
Epoch: 72, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.558 Vali Acc: 0.856 Test Loss: 0.558 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.8580548763275146
Epoch: 73, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.577 Vali Acc: 0.861 Test Loss: 0.577 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 74 cost time: 1.1737561225891113
Epoch: 74, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.555 Vali Acc: 0.844 Test Loss: 0.555 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.9728260040283203
Epoch: 75, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.567 Vali Acc: 0.833 Test Loss: 0.567 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.9117672443389893
Epoch: 76, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.547 Vali Acc: 0.850 Test Loss: 0.547 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 1.0731709003448486
Epoch: 77, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.554 Vali Acc: 0.850 Test Loss: 0.554 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 0.8700926303863525
Epoch: 78, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.575 Vali Acc: 0.861 Test Loss: 0.575 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 79 cost time: 0.9673941135406494
Epoch: 79, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.583 Vali Acc: 0.861 Test Loss: 0.583 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.9112703800201416
Epoch: 80, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.553 Vali Acc: 0.861 Test Loss: 0.553 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861106).  Saving model ...
Epoch: 81 cost time: 0.857982873916626
Epoch: 81, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.564 Vali Acc: 0.861 Test Loss: 0.564 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.9492053985595703
Epoch: 82, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.568 Vali Acc: 0.850 Test Loss: 0.568 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 0.8101816177368164
Epoch: 83, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.530 Vali Acc: 0.861 Test Loss: 0.530 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 84 cost time: 0.7435023784637451
Epoch: 84, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.557 Vali Acc: 0.872 Test Loss: 0.557 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 85 cost time: 0.7985999584197998
Epoch: 85, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.560 Vali Acc: 0.856 Test Loss: 0.560 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 0.8148171901702881
Epoch: 86, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.544 Vali Acc: 0.856 Test Loss: 0.544 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 0.9280340671539307
Epoch: 87, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.550 Vali Acc: 0.861 Test Loss: 0.550 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 0.8403918743133545
Epoch: 88, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.612 Vali Acc: 0.861 Test Loss: 0.612 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 0.8778185844421387
Epoch: 89, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.605 Vali Acc: 0.872 Test Loss: 0.605 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 0.8249931335449219
Epoch: 90, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.587 Vali Acc: 0.856 Test Loss: 0.587 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 91 cost time: 0.8465471267700195
Epoch: 91, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.581 Vali Acc: 0.861 Test Loss: 0.581 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 92 cost time: 0.829981803894043
Epoch: 92, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.575 Vali Acc: 0.867 Test Loss: 0.575 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 93 cost time: 0.6780197620391846
Epoch: 93, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.582 Vali Acc: 0.867 Test Loss: 0.582 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 94 cost time: 0.7522156238555908
Epoch: 94, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.592 Vali Acc: 0.861 Test Loss: 0.592 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 107431
model size : 1.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.315760374069214
Epoch: 1, Steps: 12 | Train Loss: 2.937 Vali Loss: 2.780 Vali Acc: 0.111 Test Loss: 2.780 Test Acc: 0.111
Validation loss decreased (inf --> -0.111083).  Saving model ...
Epoch: 2 cost time: 0.8676936626434326
Epoch: 2, Steps: 12 | Train Loss: 2.845 Vali Loss: 2.721 Vali Acc: 0.100 Test Loss: 2.721 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7952971458435059
Epoch: 3, Steps: 12 | Train Loss: 2.780 Vali Loss: 2.661 Vali Acc: 0.100 Test Loss: 2.661 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8202619552612305
Epoch: 4, Steps: 12 | Train Loss: 2.694 Vali Loss: 2.607 Vali Acc: 0.117 Test Loss: 2.607 Test Acc: 0.117
Validation loss decreased (-0.111083 --> -0.116641).  Saving model ...
Epoch: 5 cost time: 0.8584597110748291
Epoch: 5, Steps: 12 | Train Loss: 2.630 Vali Loss: 2.566 Vali Acc: 0.167 Test Loss: 2.566 Test Acc: 0.167
Validation loss decreased (-0.116641 --> -0.166641).  Saving model ...
Epoch: 6 cost time: 0.7454838752746582
Epoch: 6, Steps: 12 | Train Loss: 2.561 Vali Loss: 2.517 Vali Acc: 0.211 Test Loss: 2.517 Test Acc: 0.211
Validation loss decreased (-0.166641 --> -0.211086).  Saving model ...
Epoch: 7 cost time: 0.8264017105102539
Epoch: 7, Steps: 12 | Train Loss: 2.485 Vali Loss: 2.474 Vali Acc: 0.283 Test Loss: 2.474 Test Acc: 0.283
Validation loss decreased (-0.211086 --> -0.283309).  Saving model ...
Epoch: 8 cost time: 0.9091064929962158
Epoch: 8, Steps: 12 | Train Loss: 2.433 Vali Loss: 2.414 Vali Acc: 0.278 Test Loss: 2.414 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7781193256378174
Epoch: 9, Steps: 12 | Train Loss: 2.334 Vali Loss: 2.349 Vali Acc: 0.328 Test Loss: 2.349 Test Acc: 0.328
Validation loss decreased (-0.283309 --> -0.327754).  Saving model ...
Epoch: 10 cost time: 0.7847976684570312
Epoch: 10, Steps: 12 | Train Loss: 2.271 Vali Loss: 2.280 Vali Acc: 0.389 Test Loss: 2.280 Test Acc: 0.389
Validation loss decreased (-0.327754 --> -0.388866).  Saving model ...
Epoch: 11 cost time: 0.7436492443084717
Epoch: 11, Steps: 12 | Train Loss: 2.159 Vali Loss: 2.208 Vali Acc: 0.433 Test Loss: 2.208 Test Acc: 0.433
Validation loss decreased (-0.388866 --> -0.433311).  Saving model ...
Epoch: 12 cost time: 0.7778313159942627
Epoch: 12, Steps: 12 | Train Loss: 2.105 Vali Loss: 2.138 Vali Acc: 0.422 Test Loss: 2.138 Test Acc: 0.422
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8017721176147461
Epoch: 13, Steps: 12 | Train Loss: 2.008 Vali Loss: 2.060 Vali Acc: 0.450 Test Loss: 2.060 Test Acc: 0.450
Validation loss decreased (-0.433311 --> -0.449979).  Saving model ...
Epoch: 14 cost time: 0.8238327503204346
Epoch: 14, Steps: 12 | Train Loss: 1.931 Vali Loss: 1.978 Vali Acc: 0.483 Test Loss: 1.978 Test Acc: 0.483
Validation loss decreased (-0.449979 --> -0.483314).  Saving model ...
Epoch: 15 cost time: 0.8023154735565186
Epoch: 15, Steps: 12 | Train Loss: 1.813 Vali Loss: 1.901 Vali Acc: 0.478 Test Loss: 1.901 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8367109298706055
Epoch: 16, Steps: 12 | Train Loss: 1.737 Vali Loss: 1.821 Vali Acc: 0.522 Test Loss: 1.821 Test Acc: 0.522
Validation loss decreased (-0.483314 --> -0.522204).  Saving model ...
Epoch: 17 cost time: 0.740105390548706
Epoch: 17, Steps: 12 | Train Loss: 1.579 Vali Loss: 1.743 Vali Acc: 0.500 Test Loss: 1.743 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8050487041473389
Epoch: 18, Steps: 12 | Train Loss: 1.543 Vali Loss: 1.667 Vali Acc: 0.533 Test Loss: 1.667 Test Acc: 0.533
Validation loss decreased (-0.522204 --> -0.533317).  Saving model ...
Epoch: 19 cost time: 0.8581907749176025
Epoch: 19, Steps: 12 | Train Loss: 1.440 Vali Loss: 1.593 Vali Acc: 0.544 Test Loss: 1.593 Test Acc: 0.544
Validation loss decreased (-0.533317 --> -0.544429).  Saving model ...
Epoch: 20 cost time: 0.7857513427734375
Epoch: 20, Steps: 12 | Train Loss: 1.324 Vali Loss: 1.521 Vali Acc: 0.578 Test Loss: 1.521 Test Acc: 0.578
Validation loss decreased (-0.544429 --> -0.577763).  Saving model ...
Epoch: 21 cost time: 0.7854118347167969
Epoch: 21, Steps: 12 | Train Loss: 1.249 Vali Loss: 1.455 Vali Acc: 0.583 Test Loss: 1.455 Test Acc: 0.583
Validation loss decreased (-0.577763 --> -0.583319).  Saving model ...
Epoch: 22 cost time: 0.7591216564178467
Epoch: 22, Steps: 12 | Train Loss: 1.126 Vali Loss: 1.406 Vali Acc: 0.589 Test Loss: 1.406 Test Acc: 0.589
Validation loss decreased (-0.583319 --> -0.588875).  Saving model ...
Epoch: 23 cost time: 0.7878398895263672
Epoch: 23, Steps: 12 | Train Loss: 1.117 Vali Loss: 1.352 Vali Acc: 0.589 Test Loss: 1.352 Test Acc: 0.589
Validation loss decreased (-0.588875 --> -0.588875).  Saving model ...
Epoch: 24 cost time: 0.9125649929046631
Epoch: 24, Steps: 12 | Train Loss: 1.056 Vali Loss: 1.290 Vali Acc: 0.617 Test Loss: 1.290 Test Acc: 0.617
Validation loss decreased (-0.588875 --> -0.616654).  Saving model ...
Epoch: 25 cost time: 0.8648960590362549
Epoch: 25, Steps: 12 | Train Loss: 0.978 Vali Loss: 1.242 Vali Acc: 0.628 Test Loss: 1.242 Test Acc: 0.628
Validation loss decreased (-0.616654 --> -0.627765).  Saving model ...
Epoch: 26 cost time: 0.8903689384460449
Epoch: 26, Steps: 12 | Train Loss: 0.937 Vali Loss: 1.193 Vali Acc: 0.628 Test Loss: 1.193 Test Acc: 0.628
Validation loss decreased (-0.627765 --> -0.627766).  Saving model ...
Epoch: 27 cost time: 0.7211482524871826
Epoch: 27, Steps: 12 | Train Loss: 0.903 Vali Loss: 1.155 Vali Acc: 0.672 Test Loss: 1.155 Test Acc: 0.672
Validation loss decreased (-0.627766 --> -0.672211).  Saving model ...
Epoch: 28 cost time: 0.7760622501373291
Epoch: 28, Steps: 12 | Train Loss: 0.842 Vali Loss: 1.120 Vali Acc: 0.678 Test Loss: 1.120 Test Acc: 0.678
Validation loss decreased (-0.672211 --> -0.677767).  Saving model ...
Epoch: 29 cost time: 0.9171125888824463
Epoch: 29, Steps: 12 | Train Loss: 0.771 Vali Loss: 1.079 Vali Acc: 0.667 Test Loss: 1.079 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7704555988311768
Epoch: 30, Steps: 12 | Train Loss: 0.793 Vali Loss: 1.050 Vali Acc: 0.678 Test Loss: 1.050 Test Acc: 0.678
Validation loss decreased (-0.677767 --> -0.677767).  Saving model ...
Epoch: 31 cost time: 0.7603225708007812
Epoch: 31, Steps: 12 | Train Loss: 0.714 Vali Loss: 1.023 Vali Acc: 0.672 Test Loss: 1.023 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7889528274536133
Epoch: 32, Steps: 12 | Train Loss: 0.695 Vali Loss: 1.001 Vali Acc: 0.672 Test Loss: 1.001 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8297543525695801
Epoch: 33, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.985 Vali Acc: 0.689 Test Loss: 0.985 Test Acc: 0.689
Validation loss decreased (-0.677767 --> -0.688879).  Saving model ...
Epoch: 34 cost time: 0.7769508361816406
Epoch: 34, Steps: 12 | Train Loss: 0.631 Vali Loss: 0.952 Vali Acc: 0.689 Test Loss: 0.952 Test Acc: 0.689
Validation loss decreased (-0.688879 --> -0.688879).  Saving model ...
Epoch: 35 cost time: 0.7753615379333496
Epoch: 35, Steps: 12 | Train Loss: 0.645 Vali Loss: 0.935 Vali Acc: 0.717 Test Loss: 0.935 Test Acc: 0.717
Validation loss decreased (-0.688879 --> -0.716657).  Saving model ...
Epoch: 36 cost time: 0.7997310161590576
Epoch: 36, Steps: 12 | Train Loss: 0.641 Vali Loss: 0.907 Vali Acc: 0.706 Test Loss: 0.907 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8132553100585938
Epoch: 37, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.887 Vali Acc: 0.728 Test Loss: 0.887 Test Acc: 0.728
Validation loss decreased (-0.716657 --> -0.727769).  Saving model ...
Epoch: 38 cost time: 0.7635409832000732
Epoch: 38, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.868 Vali Acc: 0.722 Test Loss: 0.868 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8134057521820068
Epoch: 39, Steps: 12 | Train Loss: 0.538 Vali Loss: 0.845 Vali Acc: 0.756 Test Loss: 0.845 Test Acc: 0.756
Validation loss decreased (-0.727769 --> -0.755547).  Saving model ...
Epoch: 40 cost time: 0.7956504821777344
Epoch: 40, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.813 Vali Acc: 0.722 Test Loss: 0.813 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7432966232299805
Epoch: 41, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.783 Vali Acc: 0.744 Test Loss: 0.783 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.8771011829376221
Epoch: 42, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.780 Vali Acc: 0.772 Test Loss: 0.780 Test Acc: 0.772
Validation loss decreased (-0.755547 --> -0.772214).  Saving model ...
Epoch: 43 cost time: 0.9273724555969238
Epoch: 43, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.760 Vali Acc: 0.761 Test Loss: 0.760 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9486744403839111
Epoch: 44, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.747 Vali Acc: 0.756 Test Loss: 0.747 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.8128621578216553
Epoch: 45, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.771 Vali Acc: 0.767 Test Loss: 0.771 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.8160719871520996
Epoch: 46, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.726 Vali Acc: 0.794 Test Loss: 0.726 Test Acc: 0.794
Validation loss decreased (-0.772214 --> -0.794437).  Saving model ...
Epoch: 47 cost time: 0.8376939296722412
Epoch: 47, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.713 Vali Acc: 0.772 Test Loss: 0.713 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8187124729156494
Epoch: 48, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.701 Vali Acc: 0.794 Test Loss: 0.701 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794437).  Saving model ...
Epoch: 49 cost time: 1.0433671474456787
Epoch: 49, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.692 Vali Acc: 0.789 Test Loss: 0.692 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.8498172760009766
Epoch: 50, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.681 Vali Acc: 0.806 Test Loss: 0.681 Test Acc: 0.806
Validation loss decreased (-0.794437 --> -0.805549).  Saving model ...
Epoch: 51 cost time: 0.8761584758758545
Epoch: 51, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.666 Vali Acc: 0.800 Test Loss: 0.666 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.8264956474304199
Epoch: 52, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.691 Vali Acc: 0.783 Test Loss: 0.691 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.9703857898712158
Epoch: 53, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.636 Vali Acc: 0.839 Test Loss: 0.636 Test Acc: 0.839
Validation loss decreased (-0.805549 --> -0.838883).  Saving model ...
Epoch: 54 cost time: 0.89463210105896
Epoch: 54, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.637 Vali Acc: 0.817 Test Loss: 0.637 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.8276362419128418
Epoch: 55, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.637 Vali Acc: 0.817 Test Loss: 0.637 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.7494533061981201
Epoch: 56, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.629 Vali Acc: 0.822 Test Loss: 0.629 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.7836945056915283
Epoch: 57, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.622 Vali Acc: 0.811 Test Loss: 0.622 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.8735334873199463
Epoch: 58, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.600 Vali Acc: 0.833 Test Loss: 0.600 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.818253755569458
Epoch: 59, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.610 Vali Acc: 0.856 Test Loss: 0.610 Test Acc: 0.856
Validation loss decreased (-0.838883 --> -0.855549).  Saving model ...
Epoch: 60 cost time: 0.8041591644287109
Epoch: 60, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.607 Vali Acc: 0.844 Test Loss: 0.607 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.9372959136962891
Epoch: 61, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.608 Vali Acc: 0.828 Test Loss: 0.608 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.8840522766113281
Epoch: 62, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.618 Vali Acc: 0.839 Test Loss: 0.618 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.8152973651885986
Epoch: 63, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.624 Vali Acc: 0.850 Test Loss: 0.624 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.7544233798980713
Epoch: 64, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.591 Vali Acc: 0.844 Test Loss: 0.591 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 0.7467625141143799
Epoch: 65, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.610 Vali Acc: 0.856 Test Loss: 0.610 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855549).  Saving model ...
Epoch: 66 cost time: 0.8281638622283936
Epoch: 66, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.618 Vali Acc: 0.861 Test Loss: 0.618 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 67 cost time: 0.7853312492370605
Epoch: 67, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.619 Vali Acc: 0.844 Test Loss: 0.619 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.7670643329620361
Epoch: 68, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.609 Vali Acc: 0.844 Test Loss: 0.609 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.8282556533813477
Epoch: 69, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.618 Vali Acc: 0.856 Test Loss: 0.618 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.803342342376709
Epoch: 70, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.613 Vali Acc: 0.861 Test Loss: 0.613 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 71 cost time: 0.7192015647888184
Epoch: 71, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.580 Vali Acc: 0.850 Test Loss: 0.580 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.8456771373748779
Epoch: 72, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.581 Vali Acc: 0.856 Test Loss: 0.581 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.6826989650726318
Epoch: 73, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.591 Vali Acc: 0.856 Test Loss: 0.591 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.7661335468292236
Epoch: 74, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.604 Vali Acc: 0.872 Test Loss: 0.604 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872216).  Saving model ...
Epoch: 75 cost time: 0.6738605499267578
Epoch: 75, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.604 Vali Acc: 0.861 Test Loss: 0.604 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.804492712020874
Epoch: 76, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.599 Vali Acc: 0.867 Test Loss: 0.599 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.7798666954040527
Epoch: 77, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.601 Vali Acc: 0.867 Test Loss: 0.601 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 0.8363997936248779
Epoch: 78, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.608 Vali Acc: 0.861 Test Loss: 0.608 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 0.773151159286499
Epoch: 79, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.614 Vali Acc: 0.856 Test Loss: 0.614 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 0.7912688255310059
Epoch: 80, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.612 Vali Acc: 0.844 Test Loss: 0.612 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 0.8432483673095703
Epoch: 81, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.622 Vali Acc: 0.844 Test Loss: 0.622 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 0.8905982971191406
Epoch: 82, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.649 Vali Acc: 0.844 Test Loss: 0.649 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 83 cost time: 0.759899377822876
Epoch: 83, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.602 Vali Acc: 0.856 Test Loss: 0.602 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 84 cost time: 0.8184821605682373
Epoch: 84, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.632 Vali Acc: 0.844 Test Loss: 0.632 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 107303
model size : 1.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9620962142944336
Epoch: 1, Steps: 12 | Train Loss: 2.804 Vali Loss: 2.816 Vali Acc: 0.094 Test Loss: 2.816 Test Acc: 0.094
Validation loss decreased (inf --> -0.094416).  Saving model ...
Epoch: 2 cost time: 0.7607817649841309
Epoch: 2, Steps: 12 | Train Loss: 2.780 Vali Loss: 2.763 Vali Acc: 0.106 Test Loss: 2.763 Test Acc: 0.106
Validation loss decreased (-0.094416 --> -0.105528).  Saving model ...
Epoch: 3 cost time: 0.7382872104644775
Epoch: 3, Steps: 12 | Train Loss: 2.723 Vali Loss: 2.703 Vali Acc: 0.111 Test Loss: 2.703 Test Acc: 0.111
Validation loss decreased (-0.105528 --> -0.111084).  Saving model ...
Epoch: 4 cost time: 0.7054259777069092
Epoch: 4, Steps: 12 | Train Loss: 2.642 Vali Loss: 2.639 Vali Acc: 0.144 Test Loss: 2.639 Test Acc: 0.144
Validation loss decreased (-0.111084 --> -0.144418).  Saving model ...
Epoch: 5 cost time: 0.7712101936340332
Epoch: 5, Steps: 12 | Train Loss: 2.613 Vali Loss: 2.583 Vali Acc: 0.161 Test Loss: 2.583 Test Acc: 0.161
Validation loss decreased (-0.144418 --> -0.161085).  Saving model ...
Epoch: 6 cost time: 0.736891508102417
Epoch: 6, Steps: 12 | Train Loss: 2.540 Vali Loss: 2.525 Vali Acc: 0.167 Test Loss: 2.525 Test Acc: 0.167
Validation loss decreased (-0.161085 --> -0.166641).  Saving model ...
Epoch: 7 cost time: 0.8132295608520508
Epoch: 7, Steps: 12 | Train Loss: 2.490 Vali Loss: 2.472 Vali Acc: 0.261 Test Loss: 2.472 Test Acc: 0.261
Validation loss decreased (-0.166641 --> -0.261086).  Saving model ...
Epoch: 8 cost time: 0.8042323589324951
Epoch: 8, Steps: 12 | Train Loss: 2.420 Vali Loss: 2.419 Vali Acc: 0.328 Test Loss: 2.419 Test Acc: 0.328
Validation loss decreased (-0.261086 --> -0.327754).  Saving model ...
Epoch: 9 cost time: 0.7191362380981445
Epoch: 9, Steps: 12 | Train Loss: 2.331 Vali Loss: 2.363 Vali Acc: 0.356 Test Loss: 2.363 Test Acc: 0.356
Validation loss decreased (-0.327754 --> -0.355532).  Saving model ...
Epoch: 10 cost time: 0.9787087440490723
Epoch: 10, Steps: 12 | Train Loss: 2.290 Vali Loss: 2.300 Vali Acc: 0.378 Test Loss: 2.300 Test Acc: 0.378
Validation loss decreased (-0.355532 --> -0.377755).  Saving model ...
Epoch: 11 cost time: 0.7892255783081055
Epoch: 11, Steps: 12 | Train Loss: 2.202 Vali Loss: 2.229 Vali Acc: 0.439 Test Loss: 2.229 Test Acc: 0.439
Validation loss decreased (-0.377755 --> -0.438867).  Saving model ...
Epoch: 12 cost time: 0.7947392463684082
Epoch: 12, Steps: 12 | Train Loss: 2.081 Vali Loss: 2.148 Vali Acc: 0.472 Test Loss: 2.148 Test Acc: 0.472
Validation loss decreased (-0.438867 --> -0.472201).  Saving model ...
Epoch: 13 cost time: 0.8560061454772949
Epoch: 13, Steps: 12 | Train Loss: 2.021 Vali Loss: 2.068 Vali Acc: 0.489 Test Loss: 2.068 Test Acc: 0.489
Validation loss decreased (-0.472201 --> -0.488868).  Saving model ...
Epoch: 14 cost time: 0.8303651809692383
Epoch: 14, Steps: 12 | Train Loss: 1.885 Vali Loss: 1.971 Vali Acc: 0.506 Test Loss: 1.971 Test Acc: 0.506
Validation loss decreased (-0.488868 --> -0.505536).  Saving model ...
Epoch: 15 cost time: 0.7852990627288818
Epoch: 15, Steps: 12 | Train Loss: 1.830 Vali Loss: 1.878 Vali Acc: 0.528 Test Loss: 1.878 Test Acc: 0.528
Validation loss decreased (-0.505536 --> -0.527759).  Saving model ...
Epoch: 16 cost time: 0.8716449737548828
Epoch: 16, Steps: 12 | Train Loss: 1.670 Vali Loss: 1.792 Vali Acc: 0.539 Test Loss: 1.792 Test Acc: 0.539
Validation loss decreased (-0.527759 --> -0.538871).  Saving model ...
Epoch: 17 cost time: 0.750983715057373
Epoch: 17, Steps: 12 | Train Loss: 1.590 Vali Loss: 1.715 Vali Acc: 0.539 Test Loss: 1.715 Test Acc: 0.539
Validation loss decreased (-0.538871 --> -0.538872).  Saving model ...
Epoch: 18 cost time: 0.7326228618621826
Epoch: 18, Steps: 12 | Train Loss: 1.517 Vali Loss: 1.632 Vali Acc: 0.561 Test Loss: 1.632 Test Acc: 0.561
Validation loss decreased (-0.538872 --> -0.561095).  Saving model ...
Epoch: 19 cost time: 0.751136064529419
Epoch: 19, Steps: 12 | Train Loss: 1.392 Vali Loss: 1.553 Vali Acc: 0.572 Test Loss: 1.553 Test Acc: 0.572
Validation loss decreased (-0.561095 --> -0.572207).  Saving model ...
Epoch: 20 cost time: 0.8073420524597168
Epoch: 20, Steps: 12 | Train Loss: 1.307 Vali Loss: 1.481 Vali Acc: 0.578 Test Loss: 1.481 Test Acc: 0.578
Validation loss decreased (-0.572207 --> -0.577763).  Saving model ...
Epoch: 21 cost time: 0.8332500457763672
Epoch: 21, Steps: 12 | Train Loss: 1.268 Vali Loss: 1.411 Vali Acc: 0.583 Test Loss: 1.411 Test Acc: 0.583
Validation loss decreased (-0.577763 --> -0.583319).  Saving model ...
Epoch: 22 cost time: 0.7804975509643555
Epoch: 22, Steps: 12 | Train Loss: 1.167 Vali Loss: 1.352 Vali Acc: 0.606 Test Loss: 1.352 Test Acc: 0.606
Validation loss decreased (-0.583319 --> -0.605542).  Saving model ...
Epoch: 23 cost time: 0.7888307571411133
Epoch: 23, Steps: 12 | Train Loss: 1.108 Vali Loss: 1.296 Vali Acc: 0.628 Test Loss: 1.296 Test Acc: 0.628
Validation loss decreased (-0.605542 --> -0.627765).  Saving model ...
Epoch: 24 cost time: 0.8551175594329834
Epoch: 24, Steps: 12 | Train Loss: 1.092 Vali Loss: 1.254 Vali Acc: 0.622 Test Loss: 1.254 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8119468688964844
Epoch: 25, Steps: 12 | Train Loss: 0.971 Vali Loss: 1.192 Vali Acc: 0.639 Test Loss: 1.192 Test Acc: 0.639
Validation loss decreased (-0.627765 --> -0.638877).  Saving model ...
Epoch: 26 cost time: 0.7050278186798096
Epoch: 26, Steps: 12 | Train Loss: 0.959 Vali Loss: 1.150 Vali Acc: 0.633 Test Loss: 1.150 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7231836318969727
Epoch: 27, Steps: 12 | Train Loss: 0.894 Vali Loss: 1.101 Vali Acc: 0.644 Test Loss: 1.101 Test Acc: 0.644
Validation loss decreased (-0.638877 --> -0.644433).  Saving model ...
Epoch: 28 cost time: 0.747734785079956
Epoch: 28, Steps: 12 | Train Loss: 0.807 Vali Loss: 1.057 Vali Acc: 0.678 Test Loss: 1.057 Test Acc: 0.678
Validation loss decreased (-0.644433 --> -0.677767).  Saving model ...
Epoch: 29 cost time: 0.7821261882781982
Epoch: 29, Steps: 12 | Train Loss: 0.808 Vali Loss: 1.033 Vali Acc: 0.672 Test Loss: 1.033 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8417353630065918
Epoch: 30, Steps: 12 | Train Loss: 0.786 Vali Loss: 0.997 Vali Acc: 0.678 Test Loss: 0.997 Test Acc: 0.678
Validation loss decreased (-0.677767 --> -0.677768).  Saving model ...
Epoch: 31 cost time: 0.7688109874725342
Epoch: 31, Steps: 12 | Train Loss: 0.769 Vali Loss: 0.972 Vali Acc: 0.694 Test Loss: 0.972 Test Acc: 0.694
Validation loss decreased (-0.677768 --> -0.694435).  Saving model ...
Epoch: 32 cost time: 0.7484443187713623
Epoch: 32, Steps: 12 | Train Loss: 0.676 Vali Loss: 0.937 Vali Acc: 0.689 Test Loss: 0.937 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7567362785339355
Epoch: 33, Steps: 12 | Train Loss: 0.664 Vali Loss: 0.912 Vali Acc: 0.700 Test Loss: 0.912 Test Acc: 0.700
Validation loss decreased (-0.694435 --> -0.699991).  Saving model ...
Epoch: 34 cost time: 0.7555994987487793
Epoch: 34, Steps: 12 | Train Loss: 0.596 Vali Loss: 0.871 Vali Acc: 0.711 Test Loss: 0.871 Test Acc: 0.711
Validation loss decreased (-0.699991 --> -0.711102).  Saving model ...
Epoch: 35 cost time: 0.7783198356628418
Epoch: 35, Steps: 12 | Train Loss: 0.545 Vali Loss: 0.863 Vali Acc: 0.717 Test Loss: 0.863 Test Acc: 0.717
Validation loss decreased (-0.711102 --> -0.716658).  Saving model ...
Epoch: 36 cost time: 0.8446838855743408
Epoch: 36, Steps: 12 | Train Loss: 0.576 Vali Loss: 0.843 Vali Acc: 0.717 Test Loss: 0.843 Test Acc: 0.717
Validation loss decreased (-0.716658 --> -0.716658).  Saving model ...
Epoch: 37 cost time: 0.8350331783294678
Epoch: 37, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.809 Vali Acc: 0.700 Test Loss: 0.809 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9248106479644775
Epoch: 38, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.788 Vali Acc: 0.739 Test Loss: 0.788 Test Acc: 0.739
Validation loss decreased (-0.716658 --> -0.738881).  Saving model ...
Epoch: 39 cost time: 0.8270175457000732
Epoch: 39, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.788 Vali Acc: 0.722 Test Loss: 0.788 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8655595779418945
Epoch: 40, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.772 Vali Acc: 0.739 Test Loss: 0.772 Test Acc: 0.739
Validation loss decreased (-0.738881 --> -0.738881).  Saving model ...
Epoch: 41 cost time: 0.8629388809204102
Epoch: 41, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.747 Vali Acc: 0.756 Test Loss: 0.747 Test Acc: 0.756
Validation loss decreased (-0.738881 --> -0.755548).  Saving model ...
Epoch: 42 cost time: 0.8857052326202393
Epoch: 42, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.736 Vali Acc: 0.761 Test Loss: 0.736 Test Acc: 0.761
Validation loss decreased (-0.755548 --> -0.761104).  Saving model ...
Epoch: 43 cost time: 0.8717260360717773
Epoch: 43, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.741 Vali Acc: 0.761 Test Loss: 0.741 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8629131317138672
Epoch: 44, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.713 Vali Acc: 0.767 Test Loss: 0.713 Test Acc: 0.767
Validation loss decreased (-0.761104 --> -0.766660).  Saving model ...
Epoch: 45 cost time: 0.7424707412719727
Epoch: 45, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.704 Vali Acc: 0.789 Test Loss: 0.704 Test Acc: 0.789
Validation loss decreased (-0.766660 --> -0.788882).  Saving model ...
Epoch: 46 cost time: 0.7840778827667236
Epoch: 46, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.699 Vali Acc: 0.783 Test Loss: 0.699 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.8020775318145752
Epoch: 47, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.674 Vali Acc: 0.789 Test Loss: 0.674 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 48 cost time: 0.843956470489502
Epoch: 48, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.665 Vali Acc: 0.789 Test Loss: 0.665 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 49 cost time: 0.8211896419525146
Epoch: 49, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.675 Vali Acc: 0.783 Test Loss: 0.675 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.7764785289764404
Epoch: 50, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.645 Vali Acc: 0.789 Test Loss: 0.645 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 51 cost time: 0.7637109756469727
Epoch: 51, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.642 Vali Acc: 0.794 Test Loss: 0.642 Test Acc: 0.794
Validation loss decreased (-0.788882 --> -0.794438).  Saving model ...
Epoch: 52 cost time: 0.8817462921142578
Epoch: 52, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.641 Vali Acc: 0.806 Test Loss: 0.641 Test Acc: 0.806
Validation loss decreased (-0.794438 --> -0.805549).  Saving model ...
Epoch: 53 cost time: 0.8265624046325684
Epoch: 53, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.658 Vali Acc: 0.800 Test Loss: 0.658 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.8318893909454346
Epoch: 54, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.615 Vali Acc: 0.822 Test Loss: 0.615 Test Acc: 0.822
Validation loss decreased (-0.805549 --> -0.822216).  Saving model ...
Epoch: 55 cost time: 0.7957286834716797
Epoch: 55, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.617 Vali Acc: 0.817 Test Loss: 0.617 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.8871009349822998
Epoch: 56, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.622 Vali Acc: 0.806 Test Loss: 0.622 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.9075396060943604
Epoch: 57, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.612 Vali Acc: 0.822 Test Loss: 0.612 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 58 cost time: 0.783804178237915
Epoch: 58, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.600 Vali Acc: 0.822 Test Loss: 0.600 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 59 cost time: 0.8051137924194336
Epoch: 59, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.624 Vali Acc: 0.822 Test Loss: 0.624 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.8092367649078369
Epoch: 60, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.609 Vali Acc: 0.817 Test Loss: 0.609 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.8062505722045898
Epoch: 61, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.597 Vali Acc: 0.839 Test Loss: 0.597 Test Acc: 0.839
Validation loss decreased (-0.822216 --> -0.838883).  Saving model ...
Epoch: 62 cost time: 0.7582223415374756
Epoch: 62, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.601 Vali Acc: 0.850 Test Loss: 0.601 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 63 cost time: 0.7797484397888184
Epoch: 63, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.605 Vali Acc: 0.839 Test Loss: 0.605 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.7793464660644531
Epoch: 64, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.589 Vali Acc: 0.839 Test Loss: 0.589 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.8160901069641113
Epoch: 65, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.586 Vali Acc: 0.839 Test Loss: 0.586 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.0448217391967773
Epoch: 66, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.591 Vali Acc: 0.844 Test Loss: 0.591 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.8872025012969971
Epoch: 67, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.589 Vali Acc: 0.844 Test Loss: 0.589 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.8272032737731934
Epoch: 68, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.605 Vali Acc: 0.839 Test Loss: 0.605 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 0.7941751480102539
Epoch: 69, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.583 Vali Acc: 0.861 Test Loss: 0.583 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 70 cost time: 0.7899069786071777
Epoch: 70, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.588 Vali Acc: 0.861 Test Loss: 0.588 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.7762000560760498
Epoch: 71, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.600 Vali Acc: 0.856 Test Loss: 0.600 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.80271315574646
Epoch: 72, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.616 Vali Acc: 0.850 Test Loss: 0.616 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.7624013423919678
Epoch: 73, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.622 Vali Acc: 0.856 Test Loss: 0.622 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 0.7786321640014648
Epoch: 74, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.618 Vali Acc: 0.856 Test Loss: 0.618 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 0.789891242980957
Epoch: 75, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.633 Vali Acc: 0.833 Test Loss: 0.633 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 0.7941572666168213
Epoch: 76, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.621 Vali Acc: 0.839 Test Loss: 0.621 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 0.8754808902740479
Epoch: 77, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.630 Vali Acc: 0.850 Test Loss: 0.630 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 0.746483325958252
Epoch: 78, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.645 Vali Acc: 0.839 Test Loss: 0.645 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 79 cost time: 0.7828645706176758
Epoch: 79, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.615 Vali Acc: 0.856 Test Loss: 0.615 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 82727
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2313520908355713
Epoch: 1, Steps: 12 | Train Loss: 2.821 Vali Loss: 2.816 Vali Acc: 0.111 Test Loss: 2.816 Test Acc: 0.111
Validation loss decreased (inf --> -0.111083).  Saving model ...
Epoch: 2 cost time: 0.8490581512451172
Epoch: 2, Steps: 12 | Train Loss: 2.799 Vali Loss: 2.775 Vali Acc: 0.094 Test Loss: 2.775 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8535239696502686
Epoch: 3, Steps: 12 | Train Loss: 2.727 Vali Loss: 2.720 Vali Acc: 0.100 Test Loss: 2.720 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8755388259887695
Epoch: 4, Steps: 12 | Train Loss: 2.697 Vali Loss: 2.673 Vali Acc: 0.128 Test Loss: 2.673 Test Acc: 0.128
Validation loss decreased (-0.111083 --> -0.127751).  Saving model ...
Epoch: 5 cost time: 0.9386637210845947
Epoch: 5, Steps: 12 | Train Loss: 2.645 Vali Loss: 2.625 Vali Acc: 0.144 Test Loss: 2.625 Test Acc: 0.144
Validation loss decreased (-0.127751 --> -0.144418).  Saving model ...
Epoch: 6 cost time: 0.8762071132659912
Epoch: 6, Steps: 12 | Train Loss: 2.576 Vali Loss: 2.580 Vali Acc: 0.189 Test Loss: 2.580 Test Acc: 0.189
Validation loss decreased (-0.144418 --> -0.188863).  Saving model ...
Epoch: 7 cost time: 0.7632637023925781
Epoch: 7, Steps: 12 | Train Loss: 2.511 Vali Loss: 2.537 Vali Acc: 0.256 Test Loss: 2.537 Test Acc: 0.256
Validation loss decreased (-0.188863 --> -0.255530).  Saving model ...
Epoch: 8 cost time: 0.8584372997283936
Epoch: 8, Steps: 12 | Train Loss: 2.480 Vali Loss: 2.490 Vali Acc: 0.283 Test Loss: 2.490 Test Acc: 0.283
Validation loss decreased (-0.255530 --> -0.283308).  Saving model ...
Epoch: 9 cost time: 0.8052184581756592
Epoch: 9, Steps: 12 | Train Loss: 2.391 Vali Loss: 2.436 Vali Acc: 0.350 Test Loss: 2.436 Test Acc: 0.350
Validation loss decreased (-0.283308 --> -0.349976).  Saving model ...
Epoch: 10 cost time: 0.7682890892028809
Epoch: 10, Steps: 12 | Train Loss: 2.324 Vali Loss: 2.373 Vali Acc: 0.344 Test Loss: 2.373 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7311093807220459
Epoch: 11, Steps: 12 | Train Loss: 2.236 Vali Loss: 2.305 Vali Acc: 0.417 Test Loss: 2.305 Test Acc: 0.417
Validation loss decreased (-0.349976 --> -0.416644).  Saving model ...
Epoch: 12 cost time: 0.7117066383361816
Epoch: 12, Steps: 12 | Train Loss: 2.193 Vali Loss: 2.232 Vali Acc: 0.428 Test Loss: 2.232 Test Acc: 0.428
Validation loss decreased (-0.416644 --> -0.427755).  Saving model ...
Epoch: 13 cost time: 0.750499963760376
Epoch: 13, Steps: 12 | Train Loss: 2.030 Vali Loss: 2.157 Vali Acc: 0.461 Test Loss: 2.157 Test Acc: 0.461
Validation loss decreased (-0.427755 --> -0.461090).  Saving model ...
Epoch: 14 cost time: 0.7440073490142822
Epoch: 14, Steps: 12 | Train Loss: 1.933 Vali Loss: 2.070 Vali Acc: 0.494 Test Loss: 2.070 Test Acc: 0.494
Validation loss decreased (-0.461090 --> -0.494424).  Saving model ...
Epoch: 15 cost time: 0.8856287002563477
Epoch: 15, Steps: 12 | Train Loss: 1.884 Vali Loss: 1.989 Vali Acc: 0.511 Test Loss: 1.989 Test Acc: 0.511
Validation loss decreased (-0.494424 --> -0.511091).  Saving model ...
Epoch: 16 cost time: 0.7951247692108154
Epoch: 16, Steps: 12 | Train Loss: 1.769 Vali Loss: 1.911 Vali Acc: 0.511 Test Loss: 1.911 Test Acc: 0.511
Validation loss decreased (-0.511091 --> -0.511092).  Saving model ...
Epoch: 17 cost time: 0.8306527137756348
Epoch: 17, Steps: 12 | Train Loss: 1.640 Vali Loss: 1.832 Vali Acc: 0.550 Test Loss: 1.832 Test Acc: 0.550
Validation loss decreased (-0.511092 --> -0.549982).  Saving model ...
Epoch: 18 cost time: 0.7693257331848145
Epoch: 18, Steps: 12 | Train Loss: 1.540 Vali Loss: 1.756 Vali Acc: 0.544 Test Loss: 1.756 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7731692790985107
Epoch: 19, Steps: 12 | Train Loss: 1.509 Vali Loss: 1.683 Vali Acc: 0.544 Test Loss: 1.683 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8327696323394775
Epoch: 20, Steps: 12 | Train Loss: 1.373 Vali Loss: 1.612 Vali Acc: 0.550 Test Loss: 1.612 Test Acc: 0.550
Validation loss decreased (-0.549982 --> -0.549984).  Saving model ...
Epoch: 21 cost time: 0.8830838203430176
Epoch: 21, Steps: 12 | Train Loss: 1.337 Vali Loss: 1.555 Vali Acc: 0.544 Test Loss: 1.555 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7605576515197754
Epoch: 22, Steps: 12 | Train Loss: 1.180 Vali Loss: 1.489 Vali Acc: 0.561 Test Loss: 1.489 Test Acc: 0.561
Validation loss decreased (-0.549984 --> -0.561096).  Saving model ...
Epoch: 23 cost time: 0.7027969360351562
Epoch: 23, Steps: 12 | Train Loss: 1.152 Vali Loss: 1.422 Vali Acc: 0.583 Test Loss: 1.422 Test Acc: 0.583
Validation loss decreased (-0.561096 --> -0.583319).  Saving model ...
Epoch: 24 cost time: 0.7876787185668945
Epoch: 24, Steps: 12 | Train Loss: 1.093 Vali Loss: 1.365 Vali Acc: 0.578 Test Loss: 1.365 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7768242359161377
Epoch: 25, Steps: 12 | Train Loss: 1.054 Vali Loss: 1.326 Vali Acc: 0.589 Test Loss: 1.326 Test Acc: 0.589
Validation loss decreased (-0.583319 --> -0.588876).  Saving model ...
Epoch: 26 cost time: 0.8475439548492432
Epoch: 26, Steps: 12 | Train Loss: 1.036 Vali Loss: 1.277 Vali Acc: 0.589 Test Loss: 1.277 Test Acc: 0.589
Validation loss decreased (-0.588876 --> -0.588876).  Saving model ...
Epoch: 27 cost time: 0.7798278331756592
Epoch: 27, Steps: 12 | Train Loss: 0.928 Vali Loss: 1.230 Vali Acc: 0.611 Test Loss: 1.230 Test Acc: 0.611
Validation loss decreased (-0.588876 --> -0.611099).  Saving model ...
Epoch: 28 cost time: 0.7249233722686768
Epoch: 28, Steps: 12 | Train Loss: 0.891 Vali Loss: 1.179 Vali Acc: 0.606 Test Loss: 1.179 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6720733642578125
Epoch: 29, Steps: 12 | Train Loss: 0.871 Vali Loss: 1.151 Vali Acc: 0.656 Test Loss: 1.151 Test Acc: 0.656
Validation loss decreased (-0.611099 --> -0.655544).  Saving model ...
Epoch: 30 cost time: 0.8246128559112549
Epoch: 30, Steps: 12 | Train Loss: 0.829 Vali Loss: 1.106 Vali Acc: 0.644 Test Loss: 1.106 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8073844909667969
Epoch: 31, Steps: 12 | Train Loss: 0.792 Vali Loss: 1.075 Vali Acc: 0.650 Test Loss: 1.075 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7770600318908691
Epoch: 32, Steps: 12 | Train Loss: 0.763 Vali Loss: 1.036 Vali Acc: 0.656 Test Loss: 1.036 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655545).  Saving model ...
Epoch: 33 cost time: 0.8070473670959473
Epoch: 33, Steps: 12 | Train Loss: 0.727 Vali Loss: 1.008 Vali Acc: 0.667 Test Loss: 1.008 Test Acc: 0.667
Validation loss decreased (-0.655545 --> -0.666657).  Saving model ...
Epoch: 34 cost time: 0.793198823928833
Epoch: 34, Steps: 12 | Train Loss: 0.689 Vali Loss: 0.986 Vali Acc: 0.656 Test Loss: 0.986 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7993338108062744
Epoch: 35, Steps: 12 | Train Loss: 0.658 Vali Loss: 0.944 Vali Acc: 0.672 Test Loss: 0.944 Test Acc: 0.672
Validation loss decreased (-0.666657 --> -0.672213).  Saving model ...
Epoch: 36 cost time: 0.8217761516571045
Epoch: 36, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.914 Vali Acc: 0.700 Test Loss: 0.914 Test Acc: 0.700
Validation loss decreased (-0.672213 --> -0.699991).  Saving model ...
Epoch: 37 cost time: 0.790351152420044
Epoch: 37, Steps: 12 | Train Loss: 0.648 Vali Loss: 0.889 Vali Acc: 0.689 Test Loss: 0.889 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7972619533538818
Epoch: 38, Steps: 12 | Train Loss: 0.589 Vali Loss: 0.856 Vali Acc: 0.717 Test Loss: 0.856 Test Acc: 0.717
Validation loss decreased (-0.699991 --> -0.716658).  Saving model ...
Epoch: 39 cost time: 0.817833423614502
Epoch: 39, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.848 Vali Acc: 0.739 Test Loss: 0.848 Test Acc: 0.739
Validation loss decreased (-0.716658 --> -0.738880).  Saving model ...
Epoch: 40 cost time: 0.7217724323272705
Epoch: 40, Steps: 12 | Train Loss: 0.555 Vali Loss: 0.834 Vali Acc: 0.750 Test Loss: 0.834 Test Acc: 0.750
Validation loss decreased (-0.738880 --> -0.749992).  Saving model ...
Epoch: 41 cost time: 0.7205440998077393
Epoch: 41, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.786 Vali Acc: 0.778 Test Loss: 0.786 Test Acc: 0.778
Validation loss decreased (-0.749992 --> -0.777770).  Saving model ...
Epoch: 42 cost time: 0.7925233840942383
Epoch: 42, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.766 Vali Acc: 0.772 Test Loss: 0.766 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7351243495941162
Epoch: 43, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.744 Vali Acc: 0.800 Test Loss: 0.744 Test Acc: 0.800
Validation loss decreased (-0.777770 --> -0.799993).  Saving model ...
Epoch: 44 cost time: 0.8861677646636963
Epoch: 44, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.726 Vali Acc: 0.778 Test Loss: 0.726 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.738715410232544
Epoch: 45, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.708 Vali Acc: 0.778 Test Loss: 0.708 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.836937427520752
Epoch: 46, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.680 Vali Acc: 0.806 Test Loss: 0.680 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805549).  Saving model ...
Epoch: 47 cost time: 0.7813167572021484
Epoch: 47, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.676 Vali Acc: 0.800 Test Loss: 0.676 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.6599619388580322
Epoch: 48, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.647 Vali Acc: 0.806 Test Loss: 0.647 Test Acc: 0.806
Validation loss decreased (-0.805549 --> -0.805549).  Saving model ...
Epoch: 49 cost time: 0.7894620895385742
Epoch: 49, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.642 Vali Acc: 0.817 Test Loss: 0.642 Test Acc: 0.817
Validation loss decreased (-0.805549 --> -0.816660).  Saving model ...
Epoch: 50 cost time: 1.0080931186676025
Epoch: 50, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.632 Vali Acc: 0.806 Test Loss: 0.632 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.8042829036712646
Epoch: 51, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.634 Vali Acc: 0.800 Test Loss: 0.634 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.921180009841919
Epoch: 52, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.626 Vali Acc: 0.806 Test Loss: 0.626 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.9620988368988037
Epoch: 53, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.601 Vali Acc: 0.833 Test Loss: 0.601 Test Acc: 0.833
Validation loss decreased (-0.816660 --> -0.833327).  Saving model ...
Epoch: 54 cost time: 0.8757157325744629
Epoch: 54, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.591 Vali Acc: 0.817 Test Loss: 0.591 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.784813642501831
Epoch: 55, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.600 Vali Acc: 0.839 Test Loss: 0.600 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 56 cost time: 0.7991673946380615
Epoch: 56, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.584 Vali Acc: 0.839 Test Loss: 0.584 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 57 cost time: 0.7324991226196289
Epoch: 57, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.568 Vali Acc: 0.844 Test Loss: 0.568 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 58 cost time: 0.7970561981201172
Epoch: 58, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.548 Vali Acc: 0.850 Test Loss: 0.548 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849995).  Saving model ...
Epoch: 59 cost time: 0.8664474487304688
Epoch: 59, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.557 Vali Acc: 0.850 Test Loss: 0.557 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.8310039043426514
Epoch: 60, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.552 Vali Acc: 0.856 Test Loss: 0.552 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855550).  Saving model ...
Epoch: 61 cost time: 0.8616576194763184
Epoch: 61, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.540 Vali Acc: 0.861 Test Loss: 0.540 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 62 cost time: 0.7726624011993408
Epoch: 62, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.550 Vali Acc: 0.861 Test Loss: 0.550 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.819340705871582
Epoch: 63, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.554 Vali Acc: 0.867 Test Loss: 0.554 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 64 cost time: 0.7705478668212891
Epoch: 64, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.559 Vali Acc: 0.867 Test Loss: 0.559 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.7380638122558594
Epoch: 65, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.562 Vali Acc: 0.867 Test Loss: 0.562 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.8118131160736084
Epoch: 66, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.521 Vali Acc: 0.867 Test Loss: 0.521 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 67 cost time: 0.678473949432373
Epoch: 67, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.485 Vali Acc: 0.878 Test Loss: 0.485 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877773).  Saving model ...
Epoch: 68 cost time: 0.6552698612213135
Epoch: 68, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.497 Vali Acc: 0.867 Test Loss: 0.497 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.8681738376617432
Epoch: 69, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.521 Vali Acc: 0.872 Test Loss: 0.521 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.8468184471130371
Epoch: 70, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.506 Vali Acc: 0.878 Test Loss: 0.506 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.898566722869873
Epoch: 71, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.492 Vali Acc: 0.867 Test Loss: 0.492 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.8110349178314209
Epoch: 72, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.527 Vali Acc: 0.861 Test Loss: 0.527 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 0.7961280345916748
Epoch: 73, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.513 Vali Acc: 0.867 Test Loss: 0.513 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 0.8936586380004883
Epoch: 74, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.519 Vali Acc: 0.867 Test Loss: 0.519 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 0.9710352420806885
Epoch: 75, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.539 Vali Acc: 0.878 Test Loss: 0.539 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 0.8012058734893799
Epoch: 76, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.520 Vali Acc: 0.889 Test Loss: 0.520 Test Acc: 0.889
Validation loss decreased (-0.877773 --> -0.888884).  Saving model ...
Epoch: 77 cost time: 0.842886209487915
Epoch: 77, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.549 Vali Acc: 0.883 Test Loss: 0.549 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.7654204368591309
Epoch: 78, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.539 Vali Acc: 0.894 Test Loss: 0.539 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894439).  Saving model ...
Epoch: 79 cost time: 0.8366658687591553
Epoch: 79, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.527 Vali Acc: 0.889 Test Loss: 0.527 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.8121697902679443
Epoch: 80, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.549 Vali Acc: 0.883 Test Loss: 0.549 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 0.8565020561218262
Epoch: 81, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.543 Vali Acc: 0.878 Test Loss: 0.543 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 1.028362512588501
Epoch: 82, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.554 Vali Acc: 0.889 Test Loss: 0.554 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 0.8145949840545654
Epoch: 83, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.563 Vali Acc: 0.883 Test Loss: 0.563 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 0.8442277908325195
Epoch: 84, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.567 Vali Acc: 0.878 Test Loss: 0.567 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 0.7698931694030762
Epoch: 85, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.576 Vali Acc: 0.856 Test Loss: 0.576 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 86 cost time: 0.8040413856506348
Epoch: 86, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.550 Vali Acc: 0.883 Test Loss: 0.550 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 87 cost time: 0.8995599746704102
Epoch: 87, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.539 Vali Acc: 0.878 Test Loss: 0.539 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 88 cost time: 0.9588656425476074
Epoch: 88, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.547 Vali Acc: 0.883 Test Loss: 0.547 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 82599
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1787803173065186
Epoch: 1, Steps: 12 | Train Loss: 2.871 Vali Loss: 2.796 Vali Acc: 0.044 Test Loss: 2.796 Test Acc: 0.044
Validation loss decreased (inf --> -0.044416).  Saving model ...
Epoch: 2 cost time: 0.913170576095581
Epoch: 2, Steps: 12 | Train Loss: 2.854 Vali Loss: 2.748 Vali Acc: 0.022 Test Loss: 2.748 Test Acc: 0.022
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.930098295211792
Epoch: 3, Steps: 12 | Train Loss: 2.759 Vali Loss: 2.689 Vali Acc: 0.039 Test Loss: 2.689 Test Acc: 0.039
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9546732902526855
Epoch: 4, Steps: 12 | Train Loss: 2.712 Vali Loss: 2.641 Vali Acc: 0.050 Test Loss: 2.641 Test Acc: 0.050
Validation loss decreased (-0.044416 --> -0.049974).  Saving model ...
Epoch: 5 cost time: 0.8428075313568115
Epoch: 5, Steps: 12 | Train Loss: 2.678 Vali Loss: 2.593 Vali Acc: 0.111 Test Loss: 2.593 Test Acc: 0.111
Validation loss decreased (-0.049974 --> -0.111085).  Saving model ...
Epoch: 6 cost time: 0.7856085300445557
Epoch: 6, Steps: 12 | Train Loss: 2.604 Vali Loss: 2.552 Vali Acc: 0.189 Test Loss: 2.552 Test Acc: 0.189
Validation loss decreased (-0.111085 --> -0.188863).  Saving model ...
Epoch: 7 cost time: 0.8049778938293457
Epoch: 7, Steps: 12 | Train Loss: 2.564 Vali Loss: 2.508 Vali Acc: 0.256 Test Loss: 2.508 Test Acc: 0.256
Validation loss decreased (-0.188863 --> -0.255530).  Saving model ...
Epoch: 8 cost time: 0.7362439632415771
Epoch: 8, Steps: 12 | Train Loss: 2.491 Vali Loss: 2.457 Vali Acc: 0.289 Test Loss: 2.457 Test Acc: 0.289
Validation loss decreased (-0.255530 --> -0.288864).  Saving model ...
Epoch: 9 cost time: 0.8353536128997803
Epoch: 9, Steps: 12 | Train Loss: 2.430 Vali Loss: 2.399 Vali Acc: 0.350 Test Loss: 2.399 Test Acc: 0.350
Validation loss decreased (-0.288864 --> -0.349976).  Saving model ...
Epoch: 10 cost time: 0.7698349952697754
Epoch: 10, Steps: 12 | Train Loss: 2.317 Vali Loss: 2.336 Vali Acc: 0.367 Test Loss: 2.336 Test Acc: 0.367
Validation loss decreased (-0.349976 --> -0.366643).  Saving model ...
Epoch: 11 cost time: 0.761669397354126
Epoch: 11, Steps: 12 | Train Loss: 2.238 Vali Loss: 2.264 Vali Acc: 0.411 Test Loss: 2.264 Test Acc: 0.411
Validation loss decreased (-0.366643 --> -0.411088).  Saving model ...
Epoch: 12 cost time: 0.7694292068481445
Epoch: 12, Steps: 12 | Train Loss: 2.199 Vali Loss: 2.195 Vali Acc: 0.406 Test Loss: 2.195 Test Acc: 0.406
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8374242782592773
Epoch: 13, Steps: 12 | Train Loss: 2.077 Vali Loss: 2.120 Vali Acc: 0.450 Test Loss: 2.120 Test Acc: 0.450
Validation loss decreased (-0.411088 --> -0.449979).  Saving model ...
Epoch: 14 cost time: 0.863518476486206
Epoch: 14, Steps: 12 | Train Loss: 1.998 Vali Loss: 2.034 Vali Acc: 0.478 Test Loss: 2.034 Test Acc: 0.478
Validation loss decreased (-0.449979 --> -0.477757).  Saving model ...
Epoch: 15 cost time: 0.7633764743804932
Epoch: 15, Steps: 12 | Train Loss: 1.905 Vali Loss: 1.965 Vali Acc: 0.500 Test Loss: 1.965 Test Acc: 0.500
Validation loss decreased (-0.477757 --> -0.499980).  Saving model ...
Epoch: 16 cost time: 0.7683742046356201
Epoch: 16, Steps: 12 | Train Loss: 1.743 Vali Loss: 1.889 Vali Acc: 0.506 Test Loss: 1.889 Test Acc: 0.506
Validation loss decreased (-0.499980 --> -0.505537).  Saving model ...
Epoch: 17 cost time: 0.7033734321594238
Epoch: 17, Steps: 12 | Train Loss: 1.713 Vali Loss: 1.819 Vali Acc: 0.544 Test Loss: 1.819 Test Acc: 0.544
Validation loss decreased (-0.505537 --> -0.544426).  Saving model ...
Epoch: 18 cost time: 0.7667927742004395
Epoch: 18, Steps: 12 | Train Loss: 1.656 Vali Loss: 1.758 Vali Acc: 0.539 Test Loss: 1.758 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8108139038085938
Epoch: 19, Steps: 12 | Train Loss: 1.546 Vali Loss: 1.682 Vali Acc: 0.544 Test Loss: 1.682 Test Acc: 0.544
Validation loss decreased (-0.544426 --> -0.544428).  Saving model ...
Epoch: 20 cost time: 0.7713236808776855
Epoch: 20, Steps: 12 | Train Loss: 1.453 Vali Loss: 1.618 Vali Acc: 0.544 Test Loss: 1.618 Test Acc: 0.544
Validation loss decreased (-0.544428 --> -0.544428).  Saving model ...
Epoch: 21 cost time: 0.7814750671386719
Epoch: 21, Steps: 12 | Train Loss: 1.408 Vali Loss: 1.554 Vali Acc: 0.567 Test Loss: 1.554 Test Acc: 0.567
Validation loss decreased (-0.544428 --> -0.566651).  Saving model ...
Epoch: 22 cost time: 0.88720703125
Epoch: 22, Steps: 12 | Train Loss: 1.300 Vali Loss: 1.489 Vali Acc: 0.567 Test Loss: 1.489 Test Acc: 0.567
Validation loss decreased (-0.566651 --> -0.566652).  Saving model ...
Epoch: 23 cost time: 0.680260181427002
Epoch: 23, Steps: 12 | Train Loss: 1.183 Vali Loss: 1.441 Vali Acc: 0.572 Test Loss: 1.441 Test Acc: 0.572
Validation loss decreased (-0.566652 --> -0.572208).  Saving model ...
Epoch: 24 cost time: 0.7722828388214111
Epoch: 24, Steps: 12 | Train Loss: 1.196 Vali Loss: 1.395 Vali Acc: 0.600 Test Loss: 1.395 Test Acc: 0.600
Validation loss decreased (-0.572208 --> -0.599986).  Saving model ...
Epoch: 25 cost time: 0.848346471786499
Epoch: 25, Steps: 12 | Train Loss: 1.076 Vali Loss: 1.345 Vali Acc: 0.589 Test Loss: 1.345 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9341256618499756
Epoch: 26, Steps: 12 | Train Loss: 1.074 Vali Loss: 1.311 Vali Acc: 0.572 Test Loss: 1.311 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.770637035369873
Epoch: 27, Steps: 12 | Train Loss: 0.994 Vali Loss: 1.272 Vali Acc: 0.600 Test Loss: 1.272 Test Acc: 0.600
Validation loss decreased (-0.599986 --> -0.599987).  Saving model ...
Epoch: 28 cost time: 0.8103744983673096
Epoch: 28, Steps: 12 | Train Loss: 0.965 Vali Loss: 1.231 Vali Acc: 0.600 Test Loss: 1.231 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599988).  Saving model ...
Epoch: 29 cost time: 0.8099973201751709
Epoch: 29, Steps: 12 | Train Loss: 0.895 Vali Loss: 1.196 Vali Acc: 0.594 Test Loss: 1.196 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7523281574249268
Epoch: 30, Steps: 12 | Train Loss: 0.849 Vali Loss: 1.152 Vali Acc: 0.617 Test Loss: 1.152 Test Acc: 0.617
Validation loss decreased (-0.599988 --> -0.616655).  Saving model ...
Epoch: 31 cost time: 0.7740321159362793
Epoch: 31, Steps: 12 | Train Loss: 0.846 Vali Loss: 1.118 Vali Acc: 0.628 Test Loss: 1.118 Test Acc: 0.628
Validation loss decreased (-0.616655 --> -0.627767).  Saving model ...
Epoch: 32 cost time: 0.9010176658630371
Epoch: 32, Steps: 12 | Train Loss: 0.798 Vali Loss: 1.081 Vali Acc: 0.639 Test Loss: 1.081 Test Acc: 0.639
Validation loss decreased (-0.627767 --> -0.638878).  Saving model ...
Epoch: 33 cost time: 0.7052135467529297
Epoch: 33, Steps: 12 | Train Loss: 0.736 Vali Loss: 1.053 Vali Acc: 0.628 Test Loss: 1.053 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0562002658843994
Epoch: 34, Steps: 12 | Train Loss: 0.724 Vali Loss: 1.022 Vali Acc: 0.650 Test Loss: 1.022 Test Acc: 0.650
Validation loss decreased (-0.638878 --> -0.649990).  Saving model ...
Epoch: 35 cost time: 0.7982223033905029
Epoch: 35, Steps: 12 | Train Loss: 0.686 Vali Loss: 0.984 Vali Acc: 0.656 Test Loss: 0.984 Test Acc: 0.656
Validation loss decreased (-0.649990 --> -0.655546).  Saving model ...
Epoch: 36 cost time: 0.7303876876831055
Epoch: 36, Steps: 12 | Train Loss: 0.636 Vali Loss: 0.962 Vali Acc: 0.667 Test Loss: 0.962 Test Acc: 0.667
Validation loss decreased (-0.655546 --> -0.666657).  Saving model ...
Epoch: 37 cost time: 0.9215574264526367
Epoch: 37, Steps: 12 | Train Loss: 0.650 Vali Loss: 0.950 Vali Acc: 0.667 Test Loss: 0.950 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 38 cost time: 0.7985479831695557
Epoch: 38, Steps: 12 | Train Loss: 0.569 Vali Loss: 0.911 Vali Acc: 0.672 Test Loss: 0.911 Test Acc: 0.672
Validation loss decreased (-0.666657 --> -0.672213).  Saving model ...
Epoch: 39 cost time: 0.8561992645263672
Epoch: 39, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.872 Vali Acc: 0.717 Test Loss: 0.872 Test Acc: 0.717
Validation loss decreased (-0.672213 --> -0.716658).  Saving model ...
Epoch: 40 cost time: 0.8515245914459229
Epoch: 40, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.845 Vali Acc: 0.717 Test Loss: 0.845 Test Acc: 0.717
Validation loss decreased (-0.716658 --> -0.716658).  Saving model ...
Epoch: 41 cost time: 0.8412525653839111
Epoch: 41, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.832 Vali Acc: 0.706 Test Loss: 0.832 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9639432430267334
Epoch: 42, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.830 Vali Acc: 0.694 Test Loss: 0.830 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.8117392063140869
Epoch: 43, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.804 Vali Acc: 0.700 Test Loss: 0.804 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.7865169048309326
Epoch: 44, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.764 Vali Acc: 0.744 Test Loss: 0.764 Test Acc: 0.744
Validation loss decreased (-0.716658 --> -0.744437).  Saving model ...
Epoch: 45 cost time: 0.76613450050354
Epoch: 45, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.742 Vali Acc: 0.744 Test Loss: 0.742 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744437).  Saving model ...
Epoch: 46 cost time: 0.7888767719268799
Epoch: 46, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.718 Vali Acc: 0.744 Test Loss: 0.718 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744437).  Saving model ...
Epoch: 47 cost time: 0.8246493339538574
Epoch: 47, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.706 Vali Acc: 0.739 Test Loss: 0.706 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.744471549987793
Epoch: 48, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.676 Vali Acc: 0.772 Test Loss: 0.676 Test Acc: 0.772
Validation loss decreased (-0.744437 --> -0.772215).  Saving model ...
Epoch: 49 cost time: 0.7210433483123779
Epoch: 49, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.668 Vali Acc: 0.772 Test Loss: 0.668 Test Acc: 0.772
Validation loss decreased (-0.772215 --> -0.772216).  Saving model ...
Epoch: 50 cost time: 0.7557940483093262
Epoch: 50, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.638 Vali Acc: 0.772 Test Loss: 0.638 Test Acc: 0.772
Validation loss decreased (-0.772216 --> -0.772216).  Saving model ...
Epoch: 51 cost time: 0.8278689384460449
Epoch: 51, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.627 Vali Acc: 0.778 Test Loss: 0.627 Test Acc: 0.778
Validation loss decreased (-0.772216 --> -0.777772).  Saving model ...
Epoch: 52 cost time: 0.764824628829956
Epoch: 52, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.623 Vali Acc: 0.783 Test Loss: 0.623 Test Acc: 0.783
Validation loss decreased (-0.777772 --> -0.783327).  Saving model ...
Epoch: 53 cost time: 0.6473829746246338
Epoch: 53, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.619 Vali Acc: 0.783 Test Loss: 0.619 Test Acc: 0.783
Validation loss decreased (-0.783327 --> -0.783327).  Saving model ...
Epoch: 54 cost time: 0.7472338676452637
Epoch: 54, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.608 Vali Acc: 0.783 Test Loss: 0.608 Test Acc: 0.783
Validation loss decreased (-0.783327 --> -0.783327).  Saving model ...
Epoch: 55 cost time: 0.7475094795227051
Epoch: 55, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.604 Vali Acc: 0.778 Test Loss: 0.604 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.7908942699432373
Epoch: 56, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.597 Vali Acc: 0.811 Test Loss: 0.597 Test Acc: 0.811
Validation loss decreased (-0.783327 --> -0.811105).  Saving model ...
Epoch: 57 cost time: 0.7524983882904053
Epoch: 57, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.617 Vali Acc: 0.778 Test Loss: 0.617 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.8092288970947266
Epoch: 58, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.578 Vali Acc: 0.806 Test Loss: 0.578 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.7857246398925781
Epoch: 59, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.568 Vali Acc: 0.806 Test Loss: 0.568 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.7421090602874756
Epoch: 60, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.573 Vali Acc: 0.822 Test Loss: 0.573 Test Acc: 0.822
Validation loss decreased (-0.811105 --> -0.822216).  Saving model ...
Epoch: 61 cost time: 0.722614049911499
Epoch: 61, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.572 Vali Acc: 0.806 Test Loss: 0.572 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.7190291881561279
Epoch: 62, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.550 Vali Acc: 0.817 Test Loss: 0.550 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.7270030975341797
Epoch: 63, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.583 Vali Acc: 0.806 Test Loss: 0.583 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.7187681198120117
Epoch: 64, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.592 Vali Acc: 0.817 Test Loss: 0.592 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.7341938018798828
Epoch: 65, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.559 Vali Acc: 0.822 Test Loss: 0.559 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822217).  Saving model ...
Epoch: 66 cost time: 0.8424339294433594
Epoch: 66, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.559 Vali Acc: 0.828 Test Loss: 0.559 Test Acc: 0.828
Validation loss decreased (-0.822217 --> -0.827772).  Saving model ...
Epoch: 67 cost time: 0.8166294097900391
Epoch: 67, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.589 Vali Acc: 0.828 Test Loss: 0.589 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.8695099353790283
Epoch: 68, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.568 Vali Acc: 0.833 Test Loss: 0.568 Test Acc: 0.833
Validation loss decreased (-0.827772 --> -0.833328).  Saving model ...
Epoch: 69 cost time: 0.7995989322662354
Epoch: 69, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.550 Vali Acc: 0.822 Test Loss: 0.550 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.7508444786071777
Epoch: 70, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.555 Vali Acc: 0.817 Test Loss: 0.555 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.839418888092041
Epoch: 71, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.579 Vali Acc: 0.822 Test Loss: 0.579 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.7410130500793457
Epoch: 72, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.551 Vali Acc: 0.844 Test Loss: 0.551 Test Acc: 0.844
Validation loss decreased (-0.833328 --> -0.844439).  Saving model ...
Epoch: 73 cost time: 0.8158249855041504
Epoch: 73, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.546 Vali Acc: 0.850 Test Loss: 0.546 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849995).  Saving model ...
Epoch: 74 cost time: 0.8399486541748047
Epoch: 74, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.565 Vali Acc: 0.828 Test Loss: 0.565 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.772099494934082
Epoch: 75, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.554 Vali Acc: 0.828 Test Loss: 0.554 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.8784902095794678
Epoch: 76, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.551 Vali Acc: 0.828 Test Loss: 0.551 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.8272120952606201
Epoch: 77, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.567 Vali Acc: 0.822 Test Loss: 0.567 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 0.8363685607910156
Epoch: 78, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.566 Vali Acc: 0.833 Test Loss: 0.566 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 0.7851848602294922
Epoch: 79, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.560 Vali Acc: 0.833 Test Loss: 0.560 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 0.7580933570861816
Epoch: 80, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.546 Vali Acc: 0.839 Test Loss: 0.546 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 0.819239616394043
Epoch: 81, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.541 Vali Acc: 0.833 Test Loss: 0.541 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 0.9450860023498535
Epoch: 82, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.551 Vali Acc: 0.828 Test Loss: 0.551 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 0.8340089321136475
Epoch: 83, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.580 Vali Acc: 0.833 Test Loss: 0.580 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.85
model parameter : 82471
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.18318510055542
Epoch: 1, Steps: 12 | Train Loss: 2.869 Vali Loss: 2.851 Vali Acc: 0.078 Test Loss: 2.851 Test Acc: 0.078
Validation loss decreased (inf --> -0.077749).  Saving model ...
Epoch: 2 cost time: 0.8475673198699951
Epoch: 2, Steps: 12 | Train Loss: 2.815 Vali Loss: 2.793 Vali Acc: 0.078 Test Loss: 2.793 Test Acc: 0.078
Validation loss decreased (-0.077749 --> -0.077750).  Saving model ...
Epoch: 3 cost time: 0.7628481388092041
Epoch: 3, Steps: 12 | Train Loss: 2.757 Vali Loss: 2.729 Vali Acc: 0.089 Test Loss: 2.729 Test Acc: 0.089
Validation loss decreased (-0.077750 --> -0.088862).  Saving model ...
Epoch: 4 cost time: 0.7701365947723389
Epoch: 4, Steps: 12 | Train Loss: 2.665 Vali Loss: 2.676 Vali Acc: 0.089 Test Loss: 2.676 Test Acc: 0.089
Validation loss decreased (-0.088862 --> -0.088862).  Saving model ...
Epoch: 5 cost time: 0.6784820556640625
Epoch: 5, Steps: 12 | Train Loss: 2.657 Vali Loss: 2.627 Vali Acc: 0.122 Test Loss: 2.627 Test Acc: 0.122
Validation loss decreased (-0.088862 --> -0.122196).  Saving model ...
Epoch: 6 cost time: 0.8157856464385986
Epoch: 6, Steps: 12 | Train Loss: 2.610 Vali Loss: 2.575 Vali Acc: 0.172 Test Loss: 2.575 Test Acc: 0.172
Validation loss decreased (-0.122196 --> -0.172196).  Saving model ...
Epoch: 7 cost time: 0.7605438232421875
Epoch: 7, Steps: 12 | Train Loss: 2.524 Vali Loss: 2.528 Vali Acc: 0.267 Test Loss: 2.528 Test Acc: 0.267
Validation loss decreased (-0.172196 --> -0.266641).  Saving model ...
Epoch: 8 cost time: 0.7505142688751221
Epoch: 8, Steps: 12 | Train Loss: 2.463 Vali Loss: 2.468 Vali Acc: 0.283 Test Loss: 2.468 Test Acc: 0.283
Validation loss decreased (-0.266641 --> -0.283309).  Saving model ...
Epoch: 9 cost time: 0.744349479675293
Epoch: 9, Steps: 12 | Train Loss: 2.373 Vali Loss: 2.398 Vali Acc: 0.322 Test Loss: 2.398 Test Acc: 0.322
Validation loss decreased (-0.283309 --> -0.322198).  Saving model ...
Epoch: 10 cost time: 0.7775576114654541
Epoch: 10, Steps: 12 | Train Loss: 2.331 Vali Loss: 2.331 Vali Acc: 0.372 Test Loss: 2.331 Test Acc: 0.372
Validation loss decreased (-0.322198 --> -0.372199).  Saving model ...
Epoch: 11 cost time: 0.7522118091583252
Epoch: 11, Steps: 12 | Train Loss: 2.233 Vali Loss: 2.262 Vali Acc: 0.411 Test Loss: 2.262 Test Acc: 0.411
Validation loss decreased (-0.372199 --> -0.411088).  Saving model ...
Epoch: 12 cost time: 0.8169698715209961
Epoch: 12, Steps: 12 | Train Loss: 2.134 Vali Loss: 2.187 Vali Acc: 0.406 Test Loss: 2.187 Test Acc: 0.406
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9534945487976074
Epoch: 13, Steps: 12 | Train Loss: 2.042 Vali Loss: 2.107 Vali Acc: 0.433 Test Loss: 2.107 Test Acc: 0.433
Validation loss decreased (-0.411088 --> -0.433312).  Saving model ...
Epoch: 14 cost time: 0.8809056282043457
Epoch: 14, Steps: 12 | Train Loss: 1.903 Vali Loss: 2.022 Vali Acc: 0.444 Test Loss: 2.022 Test Acc: 0.444
Validation loss decreased (-0.433312 --> -0.444424).  Saving model ...
Epoch: 15 cost time: 0.850914716720581
Epoch: 15, Steps: 12 | Train Loss: 1.836 Vali Loss: 1.933 Vali Acc: 0.489 Test Loss: 1.933 Test Acc: 0.489
Validation loss decreased (-0.444424 --> -0.488870).  Saving model ...
Epoch: 16 cost time: 0.8116309642791748
Epoch: 16, Steps: 12 | Train Loss: 1.734 Vali Loss: 1.854 Vali Acc: 0.489 Test Loss: 1.854 Test Acc: 0.489
Validation loss decreased (-0.488870 --> -0.488870).  Saving model ...
Epoch: 17 cost time: 0.8047027587890625
Epoch: 17, Steps: 12 | Train Loss: 1.585 Vali Loss: 1.766 Vali Acc: 0.517 Test Loss: 1.766 Test Acc: 0.517
Validation loss decreased (-0.488870 --> -0.516649).  Saving model ...
Epoch: 18 cost time: 1.011864423751831
Epoch: 18, Steps: 12 | Train Loss: 1.559 Vali Loss: 1.691 Vali Acc: 0.539 Test Loss: 1.691 Test Acc: 0.539
Validation loss decreased (-0.516649 --> -0.538872).  Saving model ...
Epoch: 19 cost time: 0.9547641277313232
Epoch: 19, Steps: 12 | Train Loss: 1.455 Vali Loss: 1.601 Vali Acc: 0.567 Test Loss: 1.601 Test Acc: 0.567
Validation loss decreased (-0.538872 --> -0.566651).  Saving model ...
Epoch: 20 cost time: 0.8937945365905762
Epoch: 20, Steps: 12 | Train Loss: 1.337 Vali Loss: 1.531 Vali Acc: 0.572 Test Loss: 1.531 Test Acc: 0.572
Validation loss decreased (-0.566651 --> -0.572207).  Saving model ...
Epoch: 21 cost time: 0.8381638526916504
Epoch: 21, Steps: 12 | Train Loss: 1.278 Vali Loss: 1.465 Vali Acc: 0.589 Test Loss: 1.465 Test Acc: 0.589
Validation loss decreased (-0.572207 --> -0.588874).  Saving model ...
Epoch: 22 cost time: 0.9222030639648438
Epoch: 22, Steps: 12 | Train Loss: 1.189 Vali Loss: 1.414 Vali Acc: 0.583 Test Loss: 1.414 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8363683223724365
Epoch: 23, Steps: 12 | Train Loss: 1.181 Vali Loss: 1.349 Vali Acc: 0.611 Test Loss: 1.349 Test Acc: 0.611
Validation loss decreased (-0.588874 --> -0.611098).  Saving model ...
Epoch: 24 cost time: 0.8977546691894531
Epoch: 24, Steps: 12 | Train Loss: 1.078 Vali Loss: 1.288 Vali Acc: 0.628 Test Loss: 1.288 Test Acc: 0.628
Validation loss decreased (-0.611098 --> -0.627765).  Saving model ...
Epoch: 25 cost time: 0.8229701519012451
Epoch: 25, Steps: 12 | Train Loss: 1.034 Vali Loss: 1.236 Vali Acc: 0.628 Test Loss: 1.236 Test Acc: 0.628
Validation loss decreased (-0.627765 --> -0.627765).  Saving model ...
Epoch: 26 cost time: 0.7695450782775879
Epoch: 26, Steps: 12 | Train Loss: 0.939 Vali Loss: 1.191 Vali Acc: 0.633 Test Loss: 1.191 Test Acc: 0.633
Validation loss decreased (-0.627765 --> -0.633321).  Saving model ...
Epoch: 27 cost time: 0.9026353359222412
Epoch: 27, Steps: 12 | Train Loss: 0.910 Vali Loss: 1.132 Vali Acc: 0.661 Test Loss: 1.132 Test Acc: 0.661
Validation loss decreased (-0.633321 --> -0.661100).  Saving model ...
Epoch: 28 cost time: 0.8823058605194092
Epoch: 28, Steps: 12 | Train Loss: 0.907 Vali Loss: 1.092 Vali Acc: 0.678 Test Loss: 1.092 Test Acc: 0.678
Validation loss decreased (-0.661100 --> -0.677767).  Saving model ...
Epoch: 29 cost time: 0.8346707820892334
Epoch: 29, Steps: 12 | Train Loss: 0.820 Vali Loss: 1.057 Vali Acc: 0.683 Test Loss: 1.057 Test Acc: 0.683
Validation loss decreased (-0.677767 --> -0.683323).  Saving model ...
Epoch: 30 cost time: 0.7566797733306885
Epoch: 30, Steps: 12 | Train Loss: 0.764 Vali Loss: 1.009 Vali Acc: 0.689 Test Loss: 1.009 Test Acc: 0.689
Validation loss decreased (-0.683323 --> -0.688879).  Saving model ...
Epoch: 31 cost time: 0.7947468757629395
Epoch: 31, Steps: 12 | Train Loss: 0.766 Vali Loss: 0.984 Vali Acc: 0.694 Test Loss: 0.984 Test Acc: 0.694
Validation loss decreased (-0.688879 --> -0.694435).  Saving model ...
Epoch: 32 cost time: 0.8176665306091309
Epoch: 32, Steps: 12 | Train Loss: 0.684 Vali Loss: 0.938 Vali Acc: 0.700 Test Loss: 0.938 Test Acc: 0.700
Validation loss decreased (-0.694435 --> -0.699991).  Saving model ...
Epoch: 33 cost time: 0.9044308662414551
Epoch: 33, Steps: 12 | Train Loss: 0.664 Vali Loss: 0.911 Vali Acc: 0.700 Test Loss: 0.911 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 34 cost time: 0.8358774185180664
Epoch: 34, Steps: 12 | Train Loss: 0.670 Vali Loss: 0.892 Vali Acc: 0.711 Test Loss: 0.892 Test Acc: 0.711
Validation loss decreased (-0.699991 --> -0.711102).  Saving model ...
Epoch: 35 cost time: 0.8248603343963623
Epoch: 35, Steps: 12 | Train Loss: 0.615 Vali Loss: 0.851 Vali Acc: 0.728 Test Loss: 0.851 Test Acc: 0.728
Validation loss decreased (-0.711102 --> -0.727769).  Saving model ...
Epoch: 36 cost time: 1.0428450107574463
Epoch: 36, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.822 Vali Acc: 0.733 Test Loss: 0.822 Test Acc: 0.733
Validation loss decreased (-0.727769 --> -0.733325).  Saving model ...
Epoch: 37 cost time: 0.7774162292480469
Epoch: 37, Steps: 12 | Train Loss: 0.545 Vali Loss: 0.789 Vali Acc: 0.750 Test Loss: 0.789 Test Acc: 0.750
Validation loss decreased (-0.733325 --> -0.749992).  Saving model ...
Epoch: 38 cost time: 0.8754401206970215
Epoch: 38, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.762 Vali Acc: 0.772 Test Loss: 0.762 Test Acc: 0.772
Validation loss decreased (-0.749992 --> -0.772215).  Saving model ...
Epoch: 39 cost time: 0.8855071067810059
Epoch: 39, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.743 Vali Acc: 0.783 Test Loss: 0.743 Test Acc: 0.783
Validation loss decreased (-0.772215 --> -0.783326).  Saving model ...
Epoch: 40 cost time: 0.8289868831634521
Epoch: 40, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.726 Vali Acc: 0.789 Test Loss: 0.726 Test Acc: 0.789
Validation loss decreased (-0.783326 --> -0.788882).  Saving model ...
Epoch: 41 cost time: 0.7718982696533203
Epoch: 41, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.701 Vali Acc: 0.806 Test Loss: 0.701 Test Acc: 0.806
Validation loss decreased (-0.788882 --> -0.805549).  Saving model ...
Epoch: 42 cost time: 0.9664192199707031
Epoch: 42, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.682 Vali Acc: 0.811 Test Loss: 0.682 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811104).  Saving model ...
Epoch: 43 cost time: 0.9460861682891846
Epoch: 43, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.664 Vali Acc: 0.828 Test Loss: 0.664 Test Acc: 0.828
Validation loss decreased (-0.811104 --> -0.827771).  Saving model ...
Epoch: 44 cost time: 0.8867073059082031
Epoch: 44, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.649 Vali Acc: 0.811 Test Loss: 0.649 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8457815647125244
Epoch: 45, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.630 Vali Acc: 0.822 Test Loss: 0.630 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.9229404926300049
Epoch: 46, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.620 Vali Acc: 0.839 Test Loss: 0.620 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838883).  Saving model ...
Epoch: 47 cost time: 0.8455636501312256
Epoch: 47, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.622 Vali Acc: 0.806 Test Loss: 0.622 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7778463363647461
Epoch: 48, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.605 Vali Acc: 0.822 Test Loss: 0.605 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.7221829891204834
Epoch: 49, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.599 Vali Acc: 0.833 Test Loss: 0.599 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.7710623741149902
Epoch: 50, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.595 Vali Acc: 0.822 Test Loss: 0.595 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.8888349533081055
Epoch: 51, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.584 Vali Acc: 0.822 Test Loss: 0.584 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.8387553691864014
Epoch: 52, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.575 Vali Acc: 0.839 Test Loss: 0.575 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 53 cost time: 0.8574671745300293
Epoch: 53, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.575 Vali Acc: 0.833 Test Loss: 0.575 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.7789628505706787
Epoch: 54, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.565 Vali Acc: 0.833 Test Loss: 0.565 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.7396736145019531
Epoch: 55, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.575 Vali Acc: 0.844 Test Loss: 0.575 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 56 cost time: 0.7886333465576172
Epoch: 56, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.576 Vali Acc: 0.844 Test Loss: 0.576 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.7819192409515381
Epoch: 57, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.559 Vali Acc: 0.839 Test Loss: 0.559 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.7554988861083984
Epoch: 58, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.567 Vali Acc: 0.828 Test Loss: 0.567 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.8544867038726807
Epoch: 59, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.571 Vali Acc: 0.839 Test Loss: 0.571 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.807042121887207
Epoch: 60, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.553 Vali Acc: 0.856 Test Loss: 0.553 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 61 cost time: 1.0150988101959229
Epoch: 61, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.546 Vali Acc: 0.850 Test Loss: 0.546 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.9340667724609375
Epoch: 62, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.494 Vali Acc: 0.850 Test Loss: 0.494 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.9352154731750488
Epoch: 63, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.510 Vali Acc: 0.856 Test Loss: 0.510 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 64 cost time: 0.890779972076416
Epoch: 64, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.519 Vali Acc: 0.856 Test Loss: 0.519 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.9382021427154541
Epoch: 65, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.524 Vali Acc: 0.867 Test Loss: 0.524 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 66 cost time: 0.8257253170013428
Epoch: 66, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.537 Vali Acc: 0.861 Test Loss: 0.537 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.8542001247406006
Epoch: 67, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.534 Vali Acc: 0.856 Test Loss: 0.534 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.9488034248352051
Epoch: 68, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.541 Vali Acc: 0.861 Test Loss: 0.541 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.864342212677002
Epoch: 69, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.531 Vali Acc: 0.878 Test Loss: 0.531 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877772).  Saving model ...
Epoch: 70 cost time: 0.7932822704315186
Epoch: 70, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.529 Vali Acc: 0.872 Test Loss: 0.529 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.9696097373962402
Epoch: 71, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.537 Vali Acc: 0.872 Test Loss: 0.537 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.8371882438659668
Epoch: 72, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.545 Vali Acc: 0.872 Test Loss: 0.545 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.865278959274292
Epoch: 73, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.538 Vali Acc: 0.883 Test Loss: 0.538 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883328).  Saving model ...
Epoch: 74 cost time: 0.8127074241638184
Epoch: 74, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.531 Vali Acc: 0.867 Test Loss: 0.531 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.7588498592376709
Epoch: 75, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.494 Vali Acc: 0.872 Test Loss: 0.494 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.8636505603790283
Epoch: 76, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.523 Vali Acc: 0.867 Test Loss: 0.523 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.7993290424346924
Epoch: 77, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.508 Vali Acc: 0.872 Test Loss: 0.508 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 0.8937351703643799
Epoch: 78, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.540 Vali Acc: 0.872 Test Loss: 0.540 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 0.9933714866638184
Epoch: 79, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.544 Vali Acc: 0.867 Test Loss: 0.544 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 0.9367537498474121
Epoch: 80, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.548 Vali Acc: 0.867 Test Loss: 0.548 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 0.8765451908111572
Epoch: 81, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.541 Vali Acc: 0.856 Test Loss: 0.541 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 0.812319278717041
Epoch: 82, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.523 Vali Acc: 0.856 Test Loss: 0.523 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 0.7755365371704102
Epoch: 83, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.540 Vali Acc: 0.878 Test Loss: 0.540 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_Crossformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 82343
model size : 0.99MB
