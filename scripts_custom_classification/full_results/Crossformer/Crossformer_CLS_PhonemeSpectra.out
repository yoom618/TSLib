Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.2994809
	speed: 0.1968s/iter; left time: 4073.1829s
	iters: 200, epoch: 1 | loss: 3.4489779
	speed: 0.1618s/iter; left time: 3333.7041s
Epoch: 1 cost time: 37.43088626861572
Epoch: 1, Steps: 208 | Train Loss: 3.912 Vali Loss: 3.751 Vali Acc: 0.046 Test Loss: 3.751 Test Acc: 0.046
Validation loss decreased (inf --> -0.046190).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9566586
	speed: 0.4494s/iter; left time: 9210.5086s
	iters: 200, epoch: 2 | loss: 3.7571137
	speed: 0.1615s/iter; left time: 3294.1805s
Epoch: 2 cost time: 34.427313566207886
Epoch: 2, Steps: 208 | Train Loss: 3.755 Vali Loss: 3.675 Vali Acc: 0.050 Test Loss: 3.675 Test Acc: 0.050
Validation loss decreased (-0.046190 --> -0.049769).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.2374890
	speed: 0.4117s/iter; left time: 8351.7232s
	iters: 200, epoch: 3 | loss: 3.2890215
	speed: 0.1668s/iter; left time: 3367.3404s
Epoch: 3 cost time: 33.614991188049316
Epoch: 3, Steps: 208 | Train Loss: 3.612 Vali Loss: 3.565 Vali Acc: 0.054 Test Loss: 3.565 Test Acc: 0.054
Validation loss decreased (-0.049769 --> -0.053946).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3528390
	speed: 0.4405s/iter; left time: 8844.3724s
	iters: 200, epoch: 4 | loss: 3.4474034
	speed: 0.1541s/iter; left time: 3079.3700s
Epoch: 4 cost time: 34.08466362953186
Epoch: 4, Steps: 208 | Train Loss: 3.488 Vali Loss: 3.352 Vali Acc: 0.078 Test Loss: 3.352 Test Acc: 0.078
Validation loss decreased (-0.053946 --> -0.077807).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.4912019
	speed: 0.4306s/iter; left time: 8555.1908s
	iters: 200, epoch: 5 | loss: 3.9335289
	speed: 0.1480s/iter; left time: 2925.7262s
Epoch: 5 cost time: 32.387595415115356
Epoch: 5, Steps: 208 | Train Loss: 3.541 Vali Loss: 3.835 Vali Acc: 0.026 Test Loss: 3.835 Test Acc: 0.026
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 4.1487112
	speed: 0.6345s/iter; left time: 12474.4054s
	iters: 200, epoch: 6 | loss: 3.7083275
	speed: 0.2302s/iter; left time: 4503.7215s
Epoch: 6 cost time: 53.446117877960205
Epoch: 6, Steps: 208 | Train Loss: 3.808 Vali Loss: 3.851 Vali Acc: 0.026 Test Loss: 3.851 Test Acc: 0.026
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 3.8276808
	speed: 0.5703s/iter; left time: 11093.9717s
	iters: 200, epoch: 7 | loss: 3.7194548
	speed: 0.2259s/iter; left time: 4372.6233s
Epoch: 7 cost time: 44.06858015060425
Epoch: 7, Steps: 208 | Train Loss: 3.782 Vali Loss: 3.736 Vali Acc: 0.026 Test Loss: 3.736 Test Acc: 0.026
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 3.9196095
	speed: 0.6093s/iter; left time: 11726.6680s
	iters: 200, epoch: 8 | loss: 3.7097540
	speed: 0.2322s/iter; left time: 4445.1397s
Epoch: 8 cost time: 48.88016080856323
Epoch: 8, Steps: 208 | Train Loss: 3.735 Vali Loss: 3.689 Vali Acc: 0.026 Test Loss: 3.689 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 3.7024903
	speed: 0.5767s/iter; left time: 10979.1449s
	iters: 200, epoch: 9 | loss: 3.8439543
	speed: 0.1877s/iter; left time: 3554.7679s
Epoch: 9 cost time: 44.41283321380615
Epoch: 9, Steps: 208 | Train Loss: 3.703 Vali Loss: 3.695 Vali Acc: 0.026 Test Loss: 3.695 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 3.7059529
	speed: 0.5395s/iter; left time: 10158.5004s
	iters: 200, epoch: 10 | loss: 3.7432711
	speed: 0.2219s/iter; left time: 4155.4263s
Epoch: 10 cost time: 44.55273675918579
Epoch: 10, Steps: 208 | Train Loss: 3.705 Vali Loss: 3.685 Vali Acc: 0.026 Test Loss: 3.685 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 3.6727145
	speed: 0.5820s/iter; left time: 10837.1903s
	iters: 200, epoch: 11 | loss: 3.7698495
	speed: 0.2337s/iter; left time: 4328.4285s
Epoch: 11 cost time: 49.03461408615112
Epoch: 11, Steps: 208 | Train Loss: 3.694 Vali Loss: 3.688 Vali Acc: 0.026 Test Loss: 3.688 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 3.7246695
	speed: 0.6232s/iter; left time: 11474.7798s
	iters: 200, epoch: 12 | loss: 3.6316321
	speed: 0.1773s/iter; left time: 3246.8664s
Epoch: 12 cost time: 43.63801550865173
Epoch: 12, Steps: 208 | Train Loss: 3.697 Vali Loss: 3.684 Vali Acc: 0.026 Test Loss: 3.684 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 3.6777601
	speed: 0.5843s/iter; left time: 10636.7518s
	iters: 200, epoch: 13 | loss: 3.6028297
	speed: 0.2359s/iter; left time: 4271.8138s
Epoch: 13 cost time: 49.104594707489014
Epoch: 13, Steps: 208 | Train Loss: 3.690 Vali Loss: 3.690 Vali Acc: 0.026 Test Loss: 3.690 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 3.7007637
	speed: 0.5751s/iter; left time: 10349.9594s
	iters: 200, epoch: 14 | loss: 3.6729686
	speed: 0.1610s/iter; left time: 2882.2072s
Epoch: 14 cost time: 41.42710852622986
Epoch: 14, Steps: 208 | Train Loss: 3.695 Vali Loss: 3.671 Vali Acc: 0.026 Test Loss: 3.671 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.07784073963614674
model parameter : 14672227
model size : 61.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1815462
	speed: 0.2124s/iter; left time: 4397.5201s
	iters: 200, epoch: 1 | loss: 3.8953254
	speed: 0.1913s/iter; left time: 3940.3900s
Epoch: 1 cost time: 42.540120363235474
Epoch: 1, Steps: 208 | Train Loss: 3.928 Vali Loss: 3.887 Vali Acc: 0.054 Test Loss: 3.887 Test Acc: 0.054
Validation loss decreased (inf --> -0.053644).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.4582696
	speed: 0.4808s/iter; left time: 9853.1261s
	iters: 200, epoch: 2 | loss: 3.2981281
	speed: 0.1836s/iter; left time: 3744.2976s
Epoch: 2 cost time: 36.70197010040283
Epoch: 2, Steps: 208 | Train Loss: 3.803 Vali Loss: 3.761 Vali Acc: 0.046 Test Loss: 3.761 Test Acc: 0.046
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.6645532
	speed: 0.5310s/iter; left time: 10771.0615s
	iters: 200, epoch: 3 | loss: 3.4997168
	speed: 0.2098s/iter; left time: 4234.5176s
Epoch: 3 cost time: 43.96070957183838
Epoch: 3, Steps: 208 | Train Loss: 3.637 Vali Loss: 3.561 Vali Acc: 0.065 Test Loss: 3.561 Test Acc: 0.065
Validation loss decreased (-0.053644 --> -0.064981).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.1086688
	speed: 0.5012s/iter; left time: 10061.9473s
	iters: 200, epoch: 4 | loss: 3.0857346
	speed: 0.1901s/iter; left time: 3797.9131s
Epoch: 4 cost time: 38.758633852005005
Epoch: 4, Steps: 208 | Train Loss: 3.458 Vali Loss: 3.604 Vali Acc: 0.061 Test Loss: 3.604 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.5030611
	speed: 0.5358s/iter; left time: 10646.1281s
	iters: 200, epoch: 5 | loss: 3.8864279
	speed: 0.1939s/iter; left time: 3832.9430s
Epoch: 5 cost time: 41.175267934799194
Epoch: 5, Steps: 208 | Train Loss: 3.603 Vali Loss: 3.874 Vali Acc: 0.026 Test Loss: 3.874 Test Acc: 0.026
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 3.6388545
	speed: 0.5724s/iter; left time: 11254.4559s
	iters: 200, epoch: 6 | loss: 3.6935635
	speed: 0.1648s/iter; left time: 3223.8429s
Epoch: 6 cost time: 39.81073236465454
Epoch: 6, Steps: 208 | Train Loss: 3.808 Vali Loss: 3.773 Vali Acc: 0.026 Test Loss: 3.773 Test Acc: 0.026
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 3.9622159
	speed: 0.5107s/iter; left time: 9933.9038s
	iters: 200, epoch: 7 | loss: 3.6417816
	speed: 0.2170s/iter; left time: 4200.3096s
Epoch: 7 cost time: 45.34923315048218
Epoch: 7, Steps: 208 | Train Loss: 3.770 Vali Loss: 3.711 Vali Acc: 0.026 Test Loss: 3.711 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 3.7571514
	speed: 0.5299s/iter; left time: 10197.8017s
	iters: 200, epoch: 8 | loss: 3.8153844
	speed: 0.1991s/iter; left time: 3812.4847s
Epoch: 8 cost time: 41.700380086898804
Epoch: 8, Steps: 208 | Train Loss: 3.731 Vali Loss: 3.705 Vali Acc: 0.026 Test Loss: 3.705 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 3.6146801
	speed: 0.5270s/iter; left time: 10033.3070s
	iters: 200, epoch: 9 | loss: 3.6759901
	speed: 0.2092s/iter; left time: 3961.2630s
Epoch: 9 cost time: 42.87433218955994
Epoch: 9, Steps: 208 | Train Loss: 3.710 Vali Loss: 3.700 Vali Acc: 0.026 Test Loss: 3.700 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 3.7100465
	speed: 0.5057s/iter; left time: 9521.1614s
	iters: 200, epoch: 10 | loss: 3.7003896
	speed: 0.2017s/iter; left time: 3777.4043s
Epoch: 10 cost time: 38.910797119140625
Epoch: 10, Steps: 208 | Train Loss: 3.701 Vali Loss: 3.694 Vali Acc: 0.026 Test Loss: 3.694 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 3.7456183
	speed: 0.5271s/iter; left time: 9814.8773s
	iters: 200, epoch: 11 | loss: 3.7476544
	speed: 0.1876s/iter; left time: 3473.6166s
Epoch: 11 cost time: 39.5447633266449
Epoch: 11, Steps: 208 | Train Loss: 3.696 Vali Loss: 3.679 Vali Acc: 0.026 Test Loss: 3.679 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 3.6608944
	speed: 0.5055s/iter; left time: 9308.0281s
	iters: 200, epoch: 12 | loss: 3.6535485
	speed: 0.1853s/iter; left time: 3394.1401s
Epoch: 12 cost time: 39.277836322784424
Epoch: 12, Steps: 208 | Train Loss: 3.693 Vali Loss: 3.701 Vali Acc: 0.026 Test Loss: 3.701 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 3.6831183
	speed: 0.5488s/iter; left time: 9990.4896s
	iters: 200, epoch: 13 | loss: 3.6881709
	speed: 0.1607s/iter; left time: 2909.4393s
Epoch: 13 cost time: 39.73411321640015
Epoch: 13, Steps: 208 | Train Loss: 3.697 Vali Loss: 3.685 Vali Acc: 0.026 Test Loss: 3.685 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.06501640322099612
model parameter : 14662755
model size : 61.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5677803
	speed: 0.2312s/iter; left time: 4785.3211s
	iters: 200, epoch: 1 | loss: 3.7653346
	speed: 0.1789s/iter; left time: 3685.5199s
Epoch: 1 cost time: 42.64196467399597
Epoch: 1, Steps: 208 | Train Loss: 3.882 Vali Loss: 3.594 Vali Acc: 0.058 Test Loss: 3.594 Test Acc: 0.058
Validation loss decreased (inf --> -0.057524).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4587698
	speed: 0.5429s/iter; left time: 11125.8701s
	iters: 200, epoch: 2 | loss: 4.1288886
	speed: 0.2095s/iter; left time: 4272.4030s
Epoch: 2 cost time: 44.07976675033569
Epoch: 2, Steps: 208 | Train Loss: 3.732 Vali Loss: 3.677 Vali Acc: 0.057 Test Loss: 3.677 Test Acc: 0.057
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.3640757
	speed: 0.5317s/iter; left time: 10785.5054s
	iters: 200, epoch: 3 | loss: 4.0002041
	speed: 0.1886s/iter; left time: 3807.8463s
Epoch: 3 cost time: 40.923027992248535
Epoch: 3, Steps: 208 | Train Loss: 3.598 Vali Loss: 3.438 Vali Acc: 0.072 Test Loss: 3.438 Test Acc: 0.072
Validation loss decreased (-0.057524 --> -0.071543).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.5781121
	speed: 0.5090s/iter; left time: 10219.0401s
	iters: 200, epoch: 4 | loss: 3.6648259
	speed: 0.2174s/iter; left time: 4342.3044s
Epoch: 4 cost time: 43.872549295425415
Epoch: 4, Steps: 208 | Train Loss: 3.479 Vali Loss: 3.357 Vali Acc: 0.075 Test Loss: 3.357 Test Acc: 0.075
Validation loss decreased (-0.071543 --> -0.075421).  Saving model ...
	iters: 100, epoch: 5 | loss: 4.2361984
	speed: 0.6014s/iter; left time: 11949.7661s
	iters: 200, epoch: 5 | loss: 4.0772533
	speed: 0.2185s/iter; left time: 4319.5616s
Epoch: 5 cost time: 47.856629848480225
Epoch: 5, Steps: 208 | Train Loss: 3.493 Vali Loss: 3.876 Vali Acc: 0.026 Test Loss: 3.876 Test Acc: 0.026
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.8156033
	speed: 0.5491s/iter; left time: 10795.6717s
	iters: 200, epoch: 6 | loss: 3.6866238
	speed: 0.1820s/iter; left time: 3561.0728s
Epoch: 6 cost time: 40.85943937301636
Epoch: 6, Steps: 208 | Train Loss: 3.808 Vali Loss: 3.748 Vali Acc: 0.026 Test Loss: 3.748 Test Acc: 0.026
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 3.6955814
	speed: 0.5237s/iter; left time: 10186.8527s
	iters: 200, epoch: 7 | loss: 3.8228836
	speed: 0.2220s/iter; left time: 4295.8729s
Epoch: 7 cost time: 45.484318017959595
Epoch: 7, Steps: 208 | Train Loss: 3.775 Vali Loss: 3.748 Vali Acc: 0.026 Test Loss: 3.748 Test Acc: 0.026
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 3.7087803
	speed: 0.5209s/iter; left time: 10024.8386s
	iters: 200, epoch: 8 | loss: 3.7595522
	speed: 0.1981s/iter; left time: 3791.9116s
Epoch: 8 cost time: 41.30221652984619
Epoch: 8, Steps: 208 | Train Loss: 3.726 Vali Loss: 3.714 Vali Acc: 0.026 Test Loss: 3.714 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 3.7962120
	speed: 0.5289s/iter; left time: 10068.8954s
	iters: 200, epoch: 9 | loss: 3.6636910
	speed: 0.1714s/iter; left time: 3246.1386s
Epoch: 9 cost time: 38.32945775985718
Epoch: 9, Steps: 208 | Train Loss: 3.707 Vali Loss: 3.715 Vali Acc: 0.026 Test Loss: 3.715 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 3.7326028
	speed: 0.5182s/iter; left time: 9758.0303s
	iters: 200, epoch: 10 | loss: 3.7289417
	speed: 0.1995s/iter; left time: 3735.5917s
Epoch: 10 cost time: 43.02409744262695
Epoch: 10, Steps: 208 | Train Loss: 3.698 Vali Loss: 3.682 Vali Acc: 0.026 Test Loss: 3.682 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 3.7122228
	speed: 0.5588s/iter; left time: 10404.6537s
	iters: 200, epoch: 11 | loss: 3.7217464
	speed: 0.2020s/iter; left time: 3741.8714s
Epoch: 11 cost time: 43.72313404083252
Epoch: 11, Steps: 208 | Train Loss: 3.697 Vali Loss: 3.690 Vali Acc: 0.026 Test Loss: 3.690 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 3.6322036
	speed: 0.4909s/iter; left time: 9038.7376s
	iters: 200, epoch: 12 | loss: 3.8562376
	speed: 0.1537s/iter; left time: 2814.6168s
Epoch: 12 cost time: 34.029468297958374
Epoch: 12, Steps: 208 | Train Loss: 3.694 Vali Loss: 3.684 Vali Acc: 0.026 Test Loss: 3.684 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 3.7470980
	speed: 0.5131s/iter; left time: 9340.3961s
	iters: 200, epoch: 13 | loss: 3.7599931
	speed: 0.1998s/iter; left time: 3617.4243s
Epoch: 13 cost time: 42.270301818847656
Epoch: 13, Steps: 208 | Train Loss: 3.698 Vali Loss: 3.671 Vali Acc: 0.026 Test Loss: 3.671 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 3.6806393
	speed: 0.5486s/iter; left time: 9873.9709s
	iters: 200, epoch: 14 | loss: 3.7008822
	speed: 0.2083s/iter; left time: 3727.2202s
Epoch: 14 cost time: 43.13555383682251
Epoch: 14, Steps: 208 | Train Loss: 3.692 Vali Loss: 3.677 Vali Acc: 0.026 Test Loss: 3.677 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.07545481658216523
model parameter : 14653283
model size : 60.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.4493647
	speed: 0.1870s/iter; left time: 3871.3083s
	iters: 200, epoch: 1 | loss: 3.8613427
	speed: 0.1922s/iter; left time: 3960.0356s
Epoch: 1 cost time: 39.88444423675537
Epoch: 1, Steps: 208 | Train Loss: 3.921 Vali Loss: 3.813 Vali Acc: 0.043 Test Loss: 3.813 Test Acc: 0.043
Validation loss decreased (inf --> -0.042610).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6557784
	speed: 0.5372s/iter; left time: 11008.1576s
	iters: 200, epoch: 2 | loss: 3.4922032
	speed: 0.1909s/iter; left time: 3893.6624s
Epoch: 2 cost time: 41.15709471702576
Epoch: 2, Steps: 208 | Train Loss: 3.742 Vali Loss: 3.665 Vali Acc: 0.046 Test Loss: 3.665 Test Acc: 0.046
Validation loss decreased (-0.042610 --> -0.045892).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7141347
	speed: 0.5234s/iter; left time: 10616.1915s
	iters: 200, epoch: 3 | loss: 3.3923731
	speed: 0.1713s/iter; left time: 3457.0944s
Epoch: 3 cost time: 37.503312826156616
Epoch: 3, Steps: 208 | Train Loss: 3.621 Vali Loss: 3.449 Vali Acc: 0.058 Test Loss: 3.449 Test Acc: 0.058
Validation loss decreased (-0.045892 --> -0.057824).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3368917
	speed: 0.5008s/iter; left time: 10054.8017s
	iters: 200, epoch: 4 | loss: 3.3422213
	speed: 0.1872s/iter; left time: 3740.0291s
Epoch: 4 cost time: 39.25385570526123
Epoch: 4, Steps: 208 | Train Loss: 3.448 Vali Loss: 3.586 Vali Acc: 0.048 Test Loss: 3.586 Test Acc: 0.048
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.7476132
	speed: 0.5161s/iter; left time: 10254.3789s
	iters: 200, epoch: 5 | loss: 3.7289529
	speed: 0.1637s/iter; left time: 3235.3439s
Epoch: 5 cost time: 36.41055393218994
Epoch: 5, Steps: 208 | Train Loss: 3.700 Vali Loss: 3.764 Vali Acc: 0.026 Test Loss: 3.764 Test Acc: 0.026
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 3.8192563
	speed: 0.5179s/iter; left time: 10181.7914s
	iters: 200, epoch: 6 | loss: 3.7022877
	speed: 0.1957s/iter; left time: 3827.2588s
Epoch: 6 cost time: 41.76974582672119
Epoch: 6, Steps: 208 | Train Loss: 3.793 Vali Loss: 3.745 Vali Acc: 0.026 Test Loss: 3.745 Test Acc: 0.026
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 3.7627699
	speed: 0.5006s/iter; left time: 9739.0059s
	iters: 200, epoch: 7 | loss: 3.7040703
	speed: 0.1873s/iter; left time: 3625.4925s
Epoch: 7 cost time: 37.9080114364624
Epoch: 7, Steps: 208 | Train Loss: 3.777 Vali Loss: 4.376 Vali Acc: 0.026 Test Loss: 4.376 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 3.8522604
	speed: 0.5317s/iter; left time: 10233.1303s
	iters: 200, epoch: 8 | loss: 3.8239985
	speed: 0.1689s/iter; left time: 3232.6908s
Epoch: 8 cost time: 37.57856583595276
Epoch: 8, Steps: 208 | Train Loss: 3.998 Vali Loss: 3.786 Vali Acc: 0.026 Test Loss: 3.786 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 3.8373790
	speed: 0.4298s/iter; left time: 8181.9216s
	iters: 200, epoch: 9 | loss: 3.7472868
	speed: 0.1934s/iter; left time: 3662.1796s
Epoch: 9 cost time: 36.740079402923584
Epoch: 9, Steps: 208 | Train Loss: 3.731 Vali Loss: 3.696 Vali Acc: 0.026 Test Loss: 3.696 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 3.7043478
	speed: 0.5050s/iter; left time: 9508.9789s
	iters: 200, epoch: 10 | loss: 3.6538348
	speed: 0.1859s/iter; left time: 3481.6979s
Epoch: 10 cost time: 38.46043562889099
Epoch: 10, Steps: 208 | Train Loss: 3.700 Vali Loss: 3.679 Vali Acc: 0.026 Test Loss: 3.679 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 3.8533995
	speed: 0.4869s/iter; left time: 9066.2317s
	iters: 200, epoch: 11 | loss: 3.6314592
	speed: 0.1582s/iter; left time: 2929.9972s
Epoch: 11 cost time: 33.56140089035034
Epoch: 11, Steps: 208 | Train Loss: 3.697 Vali Loss: 3.688 Vali Acc: 0.026 Test Loss: 3.688 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 3.7300949
	speed: 0.4780s/iter; left time: 8801.4855s
	iters: 200, epoch: 12 | loss: 3.8562160
	speed: 0.1882s/iter; left time: 3446.2098s
Epoch: 12 cost time: 37.546366930007935
Epoch: 12, Steps: 208 | Train Loss: 3.693 Vali Loss: 3.684 Vali Acc: 0.026 Test Loss: 3.684 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 3.7833829
	speed: 0.4858s/iter; left time: 8843.7689s
	iters: 200, epoch: 13 | loss: 3.6977618
	speed: 0.1712s/iter; left time: 3099.1247s
Epoch: 13 cost time: 36.720253705978394
Epoch: 13, Steps: 208 | Train Loss: 3.690 Vali Loss: 3.695 Vali Acc: 0.026 Test Loss: 3.695 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.057858634059051596
model parameter : 14643811
model size : 60.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8315237
	speed: 0.1901s/iter; left time: 3936.1706s
	iters: 200, epoch: 1 | loss: 3.7478614
	speed: 0.1852s/iter; left time: 3816.0298s
Epoch: 1 cost time: 39.48399019241333
Epoch: 1, Steps: 208 | Train Loss: 3.925 Vali Loss: 3.798 Vali Acc: 0.045 Test Loss: 3.798 Test Acc: 0.045
Validation loss decreased (inf --> -0.044996).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6122062
	speed: 0.4963s/iter; left time: 10171.1093s
	iters: 200, epoch: 2 | loss: 3.6874130
	speed: 0.1685s/iter; left time: 3436.6286s
Epoch: 2 cost time: 37.02038764953613
Epoch: 2, Steps: 208 | Train Loss: 3.703 Vali Loss: 3.539 Vali Acc: 0.054 Test Loss: 3.539 Test Acc: 0.054
Validation loss decreased (-0.044996 --> -0.054244).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.0005915
	speed: 0.4841s/iter; left time: 9819.4314s
	iters: 200, epoch: 3 | loss: 3.3690813
	speed: 0.1606s/iter; left time: 3241.3488s
Epoch: 3 cost time: 31.908607244491577
Epoch: 3, Steps: 208 | Train Loss: 3.538 Vali Loss: 3.589 Vali Acc: 0.067 Test Loss: 3.589 Test Acc: 0.067
Validation loss decreased (-0.054244 --> -0.067068).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.9541302
	speed: 0.5403s/iter; left time: 10846.6808s
	iters: 200, epoch: 4 | loss: 3.3637681
	speed: 0.1919s/iter; left time: 3832.9301s
Epoch: 4 cost time: 40.524712562561035
Epoch: 4, Steps: 208 | Train Loss: 3.408 Vali Loss: 3.396 Vali Acc: 0.085 Test Loss: 3.396 Test Acc: 0.085
Validation loss decreased (-0.067068 --> -0.084965).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.6530955
	speed: 0.4715s/iter; left time: 9368.7189s
	iters: 200, epoch: 5 | loss: 3.7096412
	speed: 0.1870s/iter; left time: 3696.4426s
Epoch: 5 cost time: 38.75175642967224
Epoch: 5, Steps: 208 | Train Loss: 3.536 Vali Loss: 3.774 Vali Acc: 0.027 Test Loss: 3.774 Test Acc: 0.027
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.8502541
	speed: 0.5324s/iter; left time: 10468.4348s
	iters: 200, epoch: 6 | loss: 3.8538034
	speed: 0.1875s/iter; left time: 3668.2000s
Epoch: 6 cost time: 39.521512508392334
Epoch: 6, Steps: 208 | Train Loss: 3.800 Vali Loss: 3.736 Vali Acc: 0.026 Test Loss: 3.736 Test Acc: 0.026
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 3.6736104
	speed: 0.5333s/iter; left time: 10375.0239s
	iters: 200, epoch: 7 | loss: 3.7981975
	speed: 0.1667s/iter; left time: 3225.3316s
Epoch: 7 cost time: 36.63481569290161
Epoch: 7, Steps: 208 | Train Loss: 3.768 Vali Loss: 3.787 Vali Acc: 0.026 Test Loss: 3.787 Test Acc: 0.026
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 3.7296016
	speed: 0.4810s/iter; left time: 9256.7475s
	iters: 200, epoch: 8 | loss: 3.7116904
	speed: 0.1893s/iter; left time: 3623.6671s
Epoch: 8 cost time: 38.03659152984619
Epoch: 8, Steps: 208 | Train Loss: 3.729 Vali Loss: 3.721 Vali Acc: 0.026 Test Loss: 3.721 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 3.8577847
	speed: 0.5017s/iter; left time: 9550.3821s
	iters: 200, epoch: 9 | loss: 3.4652538
	speed: 0.1737s/iter; left time: 3289.6360s
Epoch: 9 cost time: 37.61712169647217
Epoch: 9, Steps: 208 | Train Loss: 3.720 Vali Loss: 3.775 Vali Acc: 0.026 Test Loss: 3.775 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 3.7486601
	speed: 0.4967s/iter; left time: 9352.8351s
	iters: 200, epoch: 10 | loss: 3.7541606
	speed: 0.1559s/iter; left time: 2919.2901s
Epoch: 10 cost time: 35.902358055114746
Epoch: 10, Steps: 208 | Train Loss: 3.752 Vali Loss: 3.692 Vali Acc: 0.026 Test Loss: 3.692 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 3.6730840
	speed: 0.5253s/iter; left time: 9781.9073s
	iters: 200, epoch: 11 | loss: 3.6065156
	speed: 0.1808s/iter; left time: 3347.9436s
Epoch: 11 cost time: 39.108922243118286
Epoch: 11, Steps: 208 | Train Loss: 3.706 Vali Loss: 3.699 Vali Acc: 0.026 Test Loss: 3.699 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 3.7203243
	speed: 0.5068s/iter; left time: 9331.6589s
	iters: 200, epoch: 12 | loss: 3.7042799
	speed: 0.1840s/iter; left time: 3370.3120s
Epoch: 12 cost time: 38.02403259277344
Epoch: 12, Steps: 208 | Train Loss: 3.704 Vali Loss: 3.679 Vali Acc: 0.026 Test Loss: 3.679 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 3.7501311
	speed: 0.5136s/iter; left time: 9350.2877s
	iters: 200, epoch: 13 | loss: 3.7047610
	speed: 0.1630s/iter; left time: 2951.0476s
Epoch: 13 cost time: 35.950329065322876
Epoch: 13, Steps: 208 | Train Loss: 3.702 Vali Loss: 3.672 Vali Acc: 0.026 Test Loss: 3.672 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 3.7216744
	speed: 0.4858s/iter; left time: 8742.1360s
	iters: 200, epoch: 14 | loss: 3.6905475
	speed: 0.1720s/iter; left time: 3077.8198s
Epoch: 14 cost time: 36.20030856132507
Epoch: 14, Steps: 208 | Train Loss: 3.693 Vali Loss: 3.689 Vali Acc: 0.026 Test Loss: 3.689 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08499850879809126
model parameter : 12308323
model size : 52.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1518650
	speed: 0.1875s/iter; left time: 3881.5622s
	iters: 200, epoch: 1 | loss: 4.0208178
	speed: 0.1514s/iter; left time: 3118.1178s
Epoch: 1 cost time: 35.423134088516235
Epoch: 1, Steps: 208 | Train Loss: 3.918 Vali Loss: 3.869 Vali Acc: 0.054 Test Loss: 3.869 Test Acc: 0.054
Validation loss decreased (inf --> -0.053943).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3590014
	speed: 0.4736s/iter; left time: 9705.4553s
	iters: 200, epoch: 2 | loss: 4.0822477
	speed: 0.1528s/iter; left time: 3115.4947s
Epoch: 2 cost time: 34.110875844955444
Epoch: 2, Steps: 208 | Train Loss: 3.709 Vali Loss: 3.572 Vali Acc: 0.059 Test Loss: 3.572 Test Acc: 0.059
Validation loss decreased (-0.053943 --> -0.059016).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7108276
	speed: 0.4341s/iter; left time: 8806.7178s
	iters: 200, epoch: 3 | loss: 3.6120284
	speed: 0.1511s/iter; left time: 3050.1850s
Epoch: 3 cost time: 31.838326930999756
Epoch: 3, Steps: 208 | Train Loss: 3.557 Vali Loss: 3.668 Vali Acc: 0.067 Test Loss: 3.668 Test Acc: 0.067
Validation loss decreased (-0.059016 --> -0.067067).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.5799718
	speed: 0.4805s/iter; left time: 9646.8067s
	iters: 200, epoch: 4 | loss: 3.1370404
	speed: 0.1792s/iter; left time: 3579.3773s
Epoch: 4 cost time: 36.991058349609375
Epoch: 4, Steps: 208 | Train Loss: 3.420 Vali Loss: 3.424 Vali Acc: 0.086 Test Loss: 3.424 Test Acc: 0.086
Validation loss decreased (-0.067067 --> -0.085561).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.8043375
	speed: 0.4465s/iter; left time: 8871.6828s
	iters: 200, epoch: 5 | loss: 3.9256015
	speed: 0.1327s/iter; left time: 2622.9301s
Epoch: 5 cost time: 29.569138288497925
Epoch: 5, Steps: 208 | Train Loss: 3.497 Vali Loss: 3.788 Vali Acc: 0.026 Test Loss: 3.788 Test Acc: 0.026
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.7764108
	speed: 0.4623s/iter; left time: 9088.5123s
	iters: 200, epoch: 6 | loss: 3.7252200
	speed: 0.1574s/iter; left time: 3079.7417s
Epoch: 6 cost time: 33.311323404312134
Epoch: 6, Steps: 208 | Train Loss: 3.749 Vali Loss: 3.635 Vali Acc: 0.044 Test Loss: 3.635 Test Acc: 0.044
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 3.6391382
	speed: 0.4260s/iter; left time: 8287.3161s
	iters: 200, epoch: 7 | loss: 3.8279560
	speed: 0.1294s/iter; left time: 2503.6331s
Epoch: 7 cost time: 29.513955116271973
Epoch: 7, Steps: 208 | Train Loss: 3.741 Vali Loss: 3.794 Vali Acc: 0.026 Test Loss: 3.794 Test Acc: 0.026
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 3.5535460
	speed: 0.3953s/iter; left time: 7607.8118s
	iters: 200, epoch: 8 | loss: 3.7717845
	speed: 0.1428s/iter; left time: 2733.1774s
Epoch: 8 cost time: 29.611614227294922
Epoch: 8, Steps: 208 | Train Loss: 3.745 Vali Loss: 3.707 Vali Acc: 0.026 Test Loss: 3.707 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 3.8096325
	speed: 0.3806s/iter; left time: 7244.7051s
	iters: 200, epoch: 9 | loss: 3.7291057
	speed: 0.1273s/iter; left time: 2409.9449s
Epoch: 9 cost time: 27.080671310424805
Epoch: 9, Steps: 208 | Train Loss: 3.710 Vali Loss: 3.720 Vali Acc: 0.026 Test Loss: 3.720 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 3.7414458
	speed: 0.4513s/iter; left time: 8498.4468s
	iters: 200, epoch: 10 | loss: 3.7339218
	speed: 0.1594s/iter; left time: 2986.2616s
Epoch: 10 cost time: 35.01597881317139
Epoch: 10, Steps: 208 | Train Loss: 3.700 Vali Loss: 3.697 Vali Acc: 0.026 Test Loss: 3.697 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 3.6450176
	speed: 0.4563s/iter; left time: 8497.6898s
	iters: 200, epoch: 11 | loss: 3.6882141
	speed: 0.1484s/iter; left time: 2749.2079s
Epoch: 11 cost time: 32.329702854156494
Epoch: 11, Steps: 208 | Train Loss: 3.703 Vali Loss: 3.692 Vali Acc: 0.025 Test Loss: 3.692 Test Acc: 0.025
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 3.7384024
	speed: 0.4402s/iter; left time: 8105.4355s
	iters: 200, epoch: 12 | loss: 3.6274312
	speed: 0.1428s/iter; left time: 2615.4694s
Epoch: 12 cost time: 29.625559329986572
Epoch: 12, Steps: 208 | Train Loss: 3.692 Vali Loss: 3.693 Vali Acc: 0.026 Test Loss: 3.693 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 3.6801803
	speed: 0.4740s/iter; left time: 8628.7911s
	iters: 200, epoch: 13 | loss: 3.7275760
	speed: 0.1518s/iter; left time: 2748.0884s
Epoch: 13 cost time: 33.97980332374573
Epoch: 13, Steps: 208 | Train Loss: 3.696 Vali Loss: 3.695 Vali Acc: 0.026 Test Loss: 3.695 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 3.6970387
	speed: 0.4235s/iter; left time: 7622.2640s
	iters: 200, epoch: 14 | loss: 3.7633400
	speed: 0.1546s/iter; left time: 2766.0759s
Epoch: 14 cost time: 31.500786781311035
Epoch: 14, Steps: 208 | Train Loss: 3.695 Vali Loss: 3.691 Vali Acc: 0.026 Test Loss: 3.691 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08559498956158663
model parameter : 12298851
model size : 51.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.2461491
	speed: 0.1627s/iter; left time: 3367.3013s
	iters: 200, epoch: 1 | loss: 3.4696894
	speed: 0.1495s/iter; left time: 3080.0729s
Epoch: 1 cost time: 32.97597289085388
Epoch: 1, Steps: 208 | Train Loss: 3.941 Vali Loss: 3.852 Vali Acc: 0.038 Test Loss: 3.852 Test Acc: 0.038
Validation loss decreased (inf --> -0.038434).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.2985592
	speed: 0.4775s/iter; left time: 9786.4024s
	iters: 200, epoch: 2 | loss: 3.6870148
	speed: 0.1535s/iter; left time: 3130.8671s
Epoch: 2 cost time: 34.18945026397705
Epoch: 2, Steps: 208 | Train Loss: 3.683 Vali Loss: 3.706 Vali Acc: 0.060 Test Loss: 3.706 Test Acc: 0.060
Validation loss decreased (-0.038434 --> -0.059909).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3444409
	speed: 0.4335s/iter; left time: 8793.4295s
	iters: 200, epoch: 3 | loss: 3.4304981
	speed: 0.1679s/iter; left time: 3389.8040s
Epoch: 3 cost time: 34.30241942405701
Epoch: 3, Steps: 208 | Train Loss: 3.546 Vali Loss: 3.650 Vali Acc: 0.050 Test Loss: 3.650 Test Acc: 0.050
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.3717008
	speed: 0.4689s/iter; left time: 9413.9741s
	iters: 200, epoch: 4 | loss: 3.8273828
	speed: 0.1696s/iter; left time: 3388.1712s
Epoch: 4 cost time: 34.86246156692505
Epoch: 4, Steps: 208 | Train Loss: 3.411 Vali Loss: 3.439 Vali Acc: 0.055 Test Loss: 3.439 Test Acc: 0.055
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 3.4564893
	speed: 0.4300s/iter; left time: 8542.8691s
	iters: 200, epoch: 5 | loss: 3.9064569
	speed: 0.1400s/iter; left time: 2768.0314s
Epoch: 5 cost time: 29.731858491897583
Epoch: 5, Steps: 208 | Train Loss: 3.485 Vali Loss: 3.782 Vali Acc: 0.027 Test Loss: 3.782 Test Acc: 0.027
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 3.7927685
	speed: 0.4409s/iter; left time: 8668.3600s
	iters: 200, epoch: 6 | loss: 3.6986647
	speed: 0.1535s/iter; left time: 3001.8484s
Epoch: 6 cost time: 32.54541993141174
Epoch: 6, Steps: 208 | Train Loss: 3.752 Vali Loss: 3.764 Vali Acc: 0.026 Test Loss: 3.764 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 4.0435786
	speed: 0.4293s/iter; left time: 8351.5869s
	iters: 200, epoch: 7 | loss: 3.9214067
	speed: 0.1508s/iter; left time: 2919.0678s
Epoch: 7 cost time: 31.600500345230103
Epoch: 7, Steps: 208 | Train Loss: 3.775 Vali Loss: 3.734 Vali Acc: 0.026 Test Loss: 3.734 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 3.6609569
	speed: 0.4511s/iter; left time: 8681.3644s
	iters: 200, epoch: 8 | loss: 3.7058177
	speed: 0.1544s/iter; left time: 2955.2248s
Epoch: 8 cost time: 31.8411066532135
Epoch: 8, Steps: 208 | Train Loss: 3.726 Vali Loss: 3.724 Vali Acc: 0.026 Test Loss: 3.724 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 3.8345470
	speed: 0.4892s/iter; left time: 9313.4360s
	iters: 200, epoch: 9 | loss: 3.7931643
	speed: 0.1381s/iter; left time: 2614.2808s
Epoch: 9 cost time: 31.786850929260254
Epoch: 9, Steps: 208 | Train Loss: 3.708 Vali Loss: 3.716 Vali Acc: 0.026 Test Loss: 3.716 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 3.8276565
	speed: 0.4649s/iter; left time: 8754.1758s
	iters: 200, epoch: 10 | loss: 3.5985436
	speed: 0.1450s/iter; left time: 2714.8243s
Epoch: 10 cost time: 31.015541553497314
Epoch: 10, Steps: 208 | Train Loss: 3.704 Vali Loss: 3.680 Vali Acc: 0.026 Test Loss: 3.680 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 3.6400425
	speed: 0.4680s/iter; left time: 8713.7148s
	iters: 200, epoch: 11 | loss: 3.6927841
	speed: 0.1391s/iter; left time: 2576.4226s
Epoch: 11 cost time: 30.947510719299316
Epoch: 11, Steps: 208 | Train Loss: 3.698 Vali Loss: 3.707 Vali Acc: 0.026 Test Loss: 3.707 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 3.6696262
	speed: 0.5142s/iter; left time: 9468.0662s
	iters: 200, epoch: 12 | loss: 3.8725982
	speed: 0.1663s/iter; left time: 3045.1669s
Epoch: 12 cost time: 36.93858242034912
Epoch: 12, Steps: 208 | Train Loss: 3.696 Vali Loss: 3.689 Vali Acc: 0.026 Test Loss: 3.689 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.059946316731285414
model parameter : 12289379
model size : 51.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0339918
	speed: 0.1634s/iter; left time: 3382.3196s
	iters: 200, epoch: 1 | loss: 3.5626807
	speed: 0.1432s/iter; left time: 2949.3892s
Epoch: 1 cost time: 31.850021362304688
Epoch: 1, Steps: 208 | Train Loss: 3.912 Vali Loss: 3.787 Vali Acc: 0.045 Test Loss: 3.787 Test Acc: 0.045
Validation loss decreased (inf --> -0.044996).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.3802452
	speed: 0.4671s/iter; left time: 9571.4306s
	iters: 200, epoch: 2 | loss: 3.6310825
	speed: 0.1628s/iter; left time: 3319.6833s
Epoch: 2 cost time: 34.420326709747314
Epoch: 2, Steps: 208 | Train Loss: 3.710 Vali Loss: 3.668 Vali Acc: 0.056 Test Loss: 3.668 Test Acc: 0.056
Validation loss decreased (-0.044996 --> -0.056331).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6475999
	speed: 0.4863s/iter; left time: 9865.0543s
	iters: 200, epoch: 3 | loss: 3.3288445
	speed: 0.1795s/iter; left time: 3622.9692s
Epoch: 3 cost time: 35.99399924278259
Epoch: 3, Steps: 208 | Train Loss: 3.584 Vali Loss: 3.546 Vali Acc: 0.063 Test Loss: 3.546 Test Acc: 0.063
Validation loss decreased (-0.056331 --> -0.063192).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.0091708
	speed: 0.4925s/iter; left time: 9888.9053s
	iters: 200, epoch: 4 | loss: 2.8675978
	speed: 0.1635s/iter; left time: 3265.9562s
Epoch: 4 cost time: 33.930750608444214
Epoch: 4, Steps: 208 | Train Loss: 3.431 Vali Loss: 3.355 Vali Acc: 0.077 Test Loss: 3.355 Test Acc: 0.077
Validation loss decreased (-0.063192 --> -0.077211).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3377492
	speed: 0.5141s/iter; left time: 10214.1408s
	iters: 200, epoch: 5 | loss: 3.8558168
	speed: 0.1699s/iter; left time: 3357.8143s
Epoch: 5 cost time: 35.75413179397583
Epoch: 5, Steps: 208 | Train Loss: 3.514 Vali Loss: 3.803 Vali Acc: 0.028 Test Loss: 3.803 Test Acc: 0.028
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.9756701
	speed: 0.4783s/iter; left time: 9403.3320s
	iters: 200, epoch: 6 | loss: 3.7285757
	speed: 0.1446s/iter; left time: 2828.7198s
Epoch: 6 cost time: 34.13059902191162
Epoch: 6, Steps: 208 | Train Loss: 3.804 Vali Loss: 3.729 Vali Acc: 0.030 Test Loss: 3.729 Test Acc: 0.030
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 3.5295427
	speed: 0.5014s/iter; left time: 9752.8083s
	iters: 200, epoch: 7 | loss: 3.8130498
	speed: 0.1740s/iter; left time: 3367.8731s
Epoch: 7 cost time: 36.829123735427856
Epoch: 7, Steps: 208 | Train Loss: 3.810 Vali Loss: 3.738 Vali Acc: 0.037 Test Loss: 3.738 Test Acc: 0.037
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 3.9735019
	speed: 0.4776s/iter; left time: 9191.9789s
	iters: 200, epoch: 8 | loss: 3.7889907
	speed: 0.1515s/iter; left time: 2901.4141s
Epoch: 8 cost time: 32.3000054359436
Epoch: 8, Steps: 208 | Train Loss: 3.732 Vali Loss: 3.697 Vali Acc: 0.026 Test Loss: 3.697 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 3.6164825
	speed: 0.4571s/iter; left time: 8702.5252s
	iters: 200, epoch: 9 | loss: 3.7616253
	speed: 0.1576s/iter; left time: 2985.2512s
Epoch: 9 cost time: 34.0901141166687
Epoch: 9, Steps: 208 | Train Loss: 3.709 Vali Loss: 3.681 Vali Acc: 0.026 Test Loss: 3.681 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 3.7164481
	speed: 0.4652s/iter; left time: 8758.4703s
	iters: 200, epoch: 10 | loss: 3.6563768
	speed: 0.1404s/iter; left time: 2629.1864s
Epoch: 10 cost time: 30.658480882644653
Epoch: 10, Steps: 208 | Train Loss: 3.706 Vali Loss: 3.688 Vali Acc: 0.026 Test Loss: 3.688 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 3.7919340
	speed: 0.5208s/iter; left time: 9698.5182s
	iters: 200, epoch: 11 | loss: 3.6250823
	speed: 0.1825s/iter; left time: 3379.6329s
Epoch: 11 cost time: 39.053080320358276
Epoch: 11, Steps: 208 | Train Loss: 3.694 Vali Loss: 3.695 Vali Acc: 0.026 Test Loss: 3.695 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 3.6811767
	speed: 0.4993s/iter; left time: 9193.6735s
	iters: 200, epoch: 12 | loss: 3.7551222
	speed: 0.1612s/iter; left time: 2951.9281s
Epoch: 12 cost time: 33.590848445892334
Epoch: 12, Steps: 208 | Train Loss: 3.698 Vali Loss: 3.684 Vali Acc: 0.026 Test Loss: 3.684 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 3.6881256
	speed: 0.5078s/iter; left time: 9244.8477s
	iters: 200, epoch: 13 | loss: 3.7086978
	speed: 0.1568s/iter; left time: 2837.9844s
Epoch: 13 cost time: 33.70506000518799
Epoch: 13, Steps: 208 | Train Loss: 3.694 Vali Loss: 3.683 Vali Acc: 0.026 Test Loss: 3.683 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 3.5424137
	speed: 0.5091s/iter; left time: 9161.4604s
	iters: 200, epoch: 14 | loss: 3.6778908
	speed: 0.1527s/iter; left time: 2733.3162s
Epoch: 14 cost time: 33.30128622055054
Epoch: 14, Steps: 208 | Train Loss: 3.691 Vali Loss: 3.674 Vali Acc: 0.026 Test Loss: 3.674 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.07724425887265135
model parameter : 12279907
model size : 51.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8047926
	speed: 0.1856s/iter; left time: 3841.5620s
	iters: 200, epoch: 1 | loss: 3.6791172
	speed: 0.1410s/iter; left time: 2903.9891s
Epoch: 1 cost time: 33.99199867248535
Epoch: 1, Steps: 208 | Train Loss: 3.926 Vali Loss: 3.662 Vali Acc: 0.042 Test Loss: 3.662 Test Acc: 0.042
Validation loss decreased (inf --> -0.042314).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9205246
	speed: 0.4478s/iter; left time: 9177.5150s
	iters: 200, epoch: 2 | loss: 3.3281116
	speed: 0.1735s/iter; left time: 3538.8382s
Epoch: 2 cost time: 35.71963047981262
Epoch: 2, Steps: 208 | Train Loss: 3.686 Vali Loss: 3.585 Vali Acc: 0.056 Test Loss: 3.585 Test Acc: 0.056
Validation loss decreased (-0.042314 --> -0.056033).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3522131
	speed: 0.4469s/iter; left time: 9066.2760s
	iters: 200, epoch: 3 | loss: 3.2972808
	speed: 0.1352s/iter; left time: 2728.9357s
Epoch: 3 cost time: 30.458640813827515
Epoch: 3, Steps: 208 | Train Loss: 3.551 Vali Loss: 3.386 Vali Acc: 0.060 Test Loss: 3.386 Test Acc: 0.060
Validation loss decreased (-0.056033 --> -0.059614).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.0647912
	speed: 0.4160s/iter; left time: 8351.3480s
	iters: 200, epoch: 4 | loss: 3.0246181
	speed: 0.1231s/iter; left time: 2458.4326s
Epoch: 4 cost time: 26.784818649291992
Epoch: 4, Steps: 208 | Train Loss: 3.363 Vali Loss: 3.356 Vali Acc: 0.069 Test Loss: 3.356 Test Acc: 0.069
Validation loss decreased (-0.059614 --> -0.069456).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3180499
	speed: 0.4311s/iter; left time: 8565.4808s
	iters: 200, epoch: 5 | loss: 3.6374934
	speed: 0.1489s/iter; left time: 2943.0955s
Epoch: 5 cost time: 30.45577311515808
Epoch: 5, Steps: 208 | Train Loss: 3.487 Vali Loss: 3.785 Vali Acc: 0.027 Test Loss: 3.785 Test Acc: 0.027
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.7304783
	speed: 0.4354s/iter; left time: 8560.3503s
	iters: 200, epoch: 6 | loss: 3.6514201
	speed: 0.1337s/iter; left time: 2615.5571s
Epoch: 6 cost time: 28.31877088546753
Epoch: 6, Steps: 208 | Train Loss: 3.778 Vali Loss: 3.724 Vali Acc: 0.026 Test Loss: 3.724 Test Acc: 0.026
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 3.7035353
	speed: 0.4641s/iter; left time: 9028.8290s
	iters: 200, epoch: 7 | loss: 3.7201715
	speed: 0.1298s/iter; left time: 2511.7573s
Epoch: 7 cost time: 29.642789363861084
Epoch: 7, Steps: 208 | Train Loss: 3.770 Vali Loss: 3.738 Vali Acc: 0.026 Test Loss: 3.738 Test Acc: 0.026
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 3.6925545
	speed: 0.4417s/iter; left time: 8499.9682s
	iters: 200, epoch: 8 | loss: 3.8082590
	speed: 0.1642s/iter; left time: 3144.4833s
Epoch: 8 cost time: 32.536338090896606
Epoch: 8, Steps: 208 | Train Loss: 3.723 Vali Loss: 3.685 Vali Acc: 0.026 Test Loss: 3.685 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 3.7362611
	speed: 0.4944s/iter; left time: 9412.2334s
	iters: 200, epoch: 9 | loss: 3.7236962
	speed: 0.1305s/iter; left time: 2470.7699s
Epoch: 9 cost time: 33.31877017021179
Epoch: 9, Steps: 208 | Train Loss: 3.703 Vali Loss: 3.686 Vali Acc: 0.026 Test Loss: 3.686 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 3.7359581
	speed: 0.4010s/iter; left time: 7551.1947s
	iters: 200, epoch: 10 | loss: 3.6643178
	speed: 0.1199s/iter; left time: 2245.6977s
Epoch: 10 cost time: 25.51478600502014
Epoch: 10, Steps: 208 | Train Loss: 3.714 Vali Loss: 3.687 Vali Acc: 0.026 Test Loss: 3.687 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 3.7006075
	speed: 0.4528s/iter; left time: 8430.7365s
	iters: 200, epoch: 11 | loss: 3.7339227
	speed: 0.1687s/iter; left time: 3123.5839s
Epoch: 11 cost time: 34.87238693237305
Epoch: 11, Steps: 208 | Train Loss: 3.696 Vali Loss: 3.677 Vali Acc: 0.026 Test Loss: 3.677 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 3.7140923
	speed: 0.4479s/iter; left time: 8246.4982s
	iters: 200, epoch: 12 | loss: 3.6845052
	speed: 0.1580s/iter; left time: 2893.3241s
Epoch: 12 cost time: 32.83326172828674
Epoch: 12, Steps: 208 | Train Loss: 3.693 Vali Loss: 3.676 Vali Acc: 0.026 Test Loss: 3.676 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 3.7245951
	speed: 0.4577s/iter; left time: 8331.7052s
	iters: 200, epoch: 13 | loss: 3.6695976
	speed: 0.1315s/iter; left time: 2380.6752s
Epoch: 13 cost time: 31.46443748474121
Epoch: 13, Steps: 208 | Train Loss: 3.691 Vali Loss: 3.673 Vali Acc: 0.026 Test Loss: 3.673 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 3.6542926
	speed: 0.4768s/iter; left time: 8580.7034s
	iters: 200, epoch: 14 | loss: 3.6337652
	speed: 0.1533s/iter; left time: 2744.1934s
Epoch: 14 cost time: 35.48798966407776
Epoch: 14, Steps: 208 | Train Loss: 3.687 Vali Loss: 3.696 Vali Acc: 0.026 Test Loss: 3.696 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.06949000894721145
model parameter : 11126371
model size : 47.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9575086
	speed: 0.1877s/iter; left time: 3884.8585s
	iters: 200, epoch: 1 | loss: 3.6376765
	speed: 0.1272s/iter; left time: 2621.1439s
Epoch: 1 cost time: 32.442920446395874
Epoch: 1, Steps: 208 | Train Loss: 3.904 Vali Loss: 3.806 Vali Acc: 0.040 Test Loss: 3.806 Test Acc: 0.040
Validation loss decreased (inf --> -0.039926).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.3816652
	speed: 0.4615s/iter; left time: 9457.9582s
	iters: 200, epoch: 2 | loss: 4.1211634
	speed: 0.1348s/iter; left time: 2749.8427s
Epoch: 2 cost time: 30.319233417510986
Epoch: 2, Steps: 208 | Train Loss: 3.869 Vali Loss: 3.879 Vali Acc: 0.026 Test Loss: 3.879 Test Acc: 0.026
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.6927915
	speed: 0.4258s/iter; left time: 8636.6054s
	iters: 200, epoch: 3 | loss: 3.7813108
	speed: 0.1284s/iter; left time: 2590.8421s
Epoch: 3 cost time: 29.021560668945312
Epoch: 3, Steps: 208 | Train Loss: 3.933 Vali Loss: 4.016 Vali Acc: 0.026 Test Loss: 4.016 Test Acc: 0.026
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 3.9590511
	speed: 0.4410s/iter; left time: 8854.3084s
	iters: 200, epoch: 4 | loss: 3.9548938
	speed: 0.1509s/iter; left time: 3015.0937s
Epoch: 4 cost time: 32.78107523918152
Epoch: 4, Steps: 208 | Train Loss: 3.884 Vali Loss: 3.802 Vali Acc: 0.026 Test Loss: 3.802 Test Acc: 0.026
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 3.7509613
	speed: 0.4359s/iter; left time: 8660.7309s
	iters: 200, epoch: 5 | loss: 3.9064171
	speed: 0.1273s/iter; left time: 2516.1298s
Epoch: 5 cost time: 27.51891303062439
Epoch: 5, Steps: 208 | Train Loss: 3.852 Vali Loss: 3.896 Vali Acc: 0.026 Test Loss: 3.896 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 3.8384278
	speed: 0.4373s/iter; left time: 8597.9814s
	iters: 200, epoch: 6 | loss: 3.6085763
	speed: 0.1378s/iter; left time: 2696.4158s
Epoch: 6 cost time: 31.080586194992065
Epoch: 6, Steps: 208 | Train Loss: 3.816 Vali Loss: 3.730 Vali Acc: 0.026 Test Loss: 3.730 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 3.7675564
	speed: 0.4186s/iter; left time: 8142.0758s
	iters: 200, epoch: 7 | loss: 3.6643643
	speed: 0.1516s/iter; left time: 2934.7166s
Epoch: 7 cost time: 31.286893606185913
Epoch: 7, Steps: 208 | Train Loss: 3.765 Vali Loss: 3.719 Vali Acc: 0.026 Test Loss: 3.719 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 3.6500392
	speed: 0.4449s/iter; left time: 8562.1414s
	iters: 200, epoch: 8 | loss: 3.6914473
	speed: 0.1379s/iter; left time: 2640.8941s
Epoch: 8 cost time: 28.988330841064453
Epoch: 8, Steps: 208 | Train Loss: 3.721 Vali Loss: 3.696 Vali Acc: 0.025 Test Loss: 3.696 Test Acc: 0.025
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 3.6857178
	speed: 0.4443s/iter; left time: 8458.4876s
	iters: 200, epoch: 9 | loss: 3.6574316
	speed: 0.1433s/iter; left time: 2713.9556s
Epoch: 9 cost time: 30.59621000289917
Epoch: 9, Steps: 208 | Train Loss: 3.699 Vali Loss: 3.824 Vali Acc: 0.026 Test Loss: 3.824 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 3.7048535
	speed: 0.4718s/iter; left time: 8883.9658s
	iters: 200, epoch: 10 | loss: 3.6763527
	speed: 0.1258s/iter; left time: 2356.7532s
Epoch: 10 cost time: 29.507091283798218
Epoch: 10, Steps: 208 | Train Loss: 3.789 Vali Loss: 3.684 Vali Acc: 0.026 Test Loss: 3.684 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 3.7611120
	speed: 0.4391s/iter; left time: 8176.5427s
	iters: 200, epoch: 11 | loss: 3.7598193
	speed: 0.1462s/iter; left time: 2707.8306s
Epoch: 11 cost time: 31.262446403503418
Epoch: 11, Steps: 208 | Train Loss: 3.843 Vali Loss: 3.699 Vali Acc: 0.026 Test Loss: 3.699 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.03996421115419028
model parameter : 11116899
model size : 47.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6675730
	speed: 0.1866s/iter; left time: 3863.0020s
	iters: 200, epoch: 1 | loss: 3.6330748
	speed: 0.1474s/iter; left time: 3036.9514s
Epoch: 1 cost time: 34.85800743103027
Epoch: 1, Steps: 208 | Train Loss: 3.883 Vali Loss: 3.638 Vali Acc: 0.057 Test Loss: 3.638 Test Acc: 0.057
Validation loss decreased (inf --> -0.056629).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5030556
	speed: 0.4424s/iter; left time: 9065.7123s
	iters: 200, epoch: 2 | loss: 3.7311797
	speed: 0.1569s/iter; left time: 3200.3342s
Epoch: 2 cost time: 32.3045437335968
Epoch: 2, Steps: 208 | Train Loss: 3.669 Vali Loss: 3.606 Vali Acc: 0.062 Test Loss: 3.606 Test Acc: 0.062
Validation loss decreased (-0.056629 --> -0.061998).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6052139
	speed: 0.4241s/iter; left time: 8602.1603s
	iters: 200, epoch: 3 | loss: 3.2940812
	speed: 0.1453s/iter; left time: 2932.8885s
Epoch: 3 cost time: 29.804891347885132
Epoch: 3, Steps: 208 | Train Loss: 3.508 Vali Loss: 3.422 Vali Acc: 0.089 Test Loss: 3.422 Test Acc: 0.089
Validation loss decreased (-0.061998 --> -0.089140).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.7697599
	speed: 0.4570s/iter; left time: 9174.6245s
	iters: 200, epoch: 4 | loss: 3.0288057
	speed: 0.1479s/iter; left time: 2955.5247s
Epoch: 4 cost time: 31.04664373397827
Epoch: 4, Steps: 208 | Train Loss: 3.365 Vali Loss: 3.309 Vali Acc: 0.085 Test Loss: 3.309 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.0419321
	speed: 0.4320s/iter; left time: 8582.9389s
	iters: 200, epoch: 5 | loss: 3.6508989
	speed: 0.1290s/iter; left time: 2549.8015s
Epoch: 5 cost time: 29.24873423576355
Epoch: 5, Steps: 208 | Train Loss: 3.370 Vali Loss: 3.679 Vali Acc: 0.033 Test Loss: 3.679 Test Acc: 0.033
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 3.5964093
	speed: 0.4327s/iter; left time: 8507.6070s
	iters: 200, epoch: 6 | loss: 3.8134787
	speed: 0.1389s/iter; left time: 2717.6975s
Epoch: 6 cost time: 28.87461018562317
Epoch: 6, Steps: 208 | Train Loss: 3.771 Vali Loss: 3.757 Vali Acc: 0.026 Test Loss: 3.757 Test Acc: 0.026
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 3.5200355
	speed: 0.4181s/iter; left time: 8132.4028s
	iters: 200, epoch: 7 | loss: 3.7213407
	speed: 0.1379s/iter; left time: 2668.3317s
Epoch: 7 cost time: 28.8130841255188
Epoch: 7, Steps: 208 | Train Loss: 3.766 Vali Loss: 3.752 Vali Acc: 0.026 Test Loss: 3.752 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 3.8397074
	speed: 0.4329s/iter; left time: 8330.7465s
	iters: 200, epoch: 8 | loss: 3.7207296
	speed: 0.1370s/iter; left time: 2622.6976s
Epoch: 8 cost time: 30.397289991378784
Epoch: 8, Steps: 208 | Train Loss: 3.729 Vali Loss: 3.697 Vali Acc: 0.026 Test Loss: 3.697 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 3.7884700
	speed: 0.4138s/iter; left time: 7878.0453s
	iters: 200, epoch: 9 | loss: 3.7633517
	speed: 0.1393s/iter; left time: 2637.6607s
Epoch: 9 cost time: 29.192062377929688
Epoch: 9, Steps: 208 | Train Loss: 3.701 Vali Loss: 3.723 Vali Acc: 0.026 Test Loss: 3.723 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 3.6525393
	speed: 0.4370s/iter; left time: 8227.8082s
	iters: 200, epoch: 10 | loss: 3.6753695
	speed: 0.1462s/iter; left time: 2739.0248s
Epoch: 10 cost time: 30.906757831573486
Epoch: 10, Steps: 208 | Train Loss: 3.698 Vali Loss: 3.680 Vali Acc: 0.026 Test Loss: 3.680 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 3.7529469
	speed: 0.4426s/iter; left time: 8241.3427s
	iters: 200, epoch: 11 | loss: 3.6588039
	speed: 0.1421s/iter; left time: 2631.2632s
Epoch: 11 cost time: 30.38649010658264
Epoch: 11, Steps: 208 | Train Loss: 3.695 Vali Loss: 3.693 Vali Acc: 0.026 Test Loss: 3.693 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 3.6640072
	speed: 0.4456s/iter; left time: 8204.3121s
	iters: 200, epoch: 12 | loss: 3.6396933
	speed: 0.1214s/iter; left time: 2223.8803s
Epoch: 12 cost time: 27.102310180664062
Epoch: 12, Steps: 208 | Train Loss: 3.690 Vali Loss: 3.683 Vali Acc: 0.026 Test Loss: 3.683 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 3.7201862
	speed: 0.4475s/iter; left time: 8147.0378s
	iters: 200, epoch: 13 | loss: 3.6779702
	speed: 0.1563s/iter; left time: 2829.3850s
Epoch: 13 cost time: 33.163910150527954
Epoch: 13, Steps: 208 | Train Loss: 3.695 Vali Loss: 3.688 Vali Acc: 0.026 Test Loss: 3.688 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08917387414255891
model parameter : 11107427
model size : 47.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8303769
	speed: 0.1578s/iter; left time: 3267.1220s
	iters: 200, epoch: 1 | loss: 3.5603044
	speed: 0.1585s/iter; left time: 3265.9929s
Epoch: 1 cost time: 32.85979151725769
Epoch: 1, Steps: 208 | Train Loss: 3.954 Vali Loss: 3.872 Vali Acc: 0.048 Test Loss: 3.872 Test Acc: 0.048
Validation loss decreased (inf --> -0.047680).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5748677
	speed: 0.4855s/iter; left time: 9949.5160s
	iters: 200, epoch: 2 | loss: 3.7490606
	speed: 0.1291s/iter; left time: 2632.3232s
Epoch: 2 cost time: 31.5281765460968
Epoch: 2, Steps: 208 | Train Loss: 3.707 Vali Loss: 3.635 Vali Acc: 0.055 Test Loss: 3.635 Test Acc: 0.055
Validation loss decreased (-0.047680 --> -0.054840).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7834051
	speed: 0.4525s/iter; left time: 9178.2838s
	iters: 200, epoch: 3 | loss: 3.5187554
	speed: 0.1542s/iter; left time: 3112.9874s
Epoch: 3 cost time: 32.743473291397095
Epoch: 3, Steps: 208 | Train Loss: 3.573 Vali Loss: 3.582 Vali Acc: 0.064 Test Loss: 3.582 Test Acc: 0.064
Validation loss decreased (-0.054840 --> -0.063489).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2452025
	speed: 0.4939s/iter; left time: 9916.1805s
	iters: 200, epoch: 4 | loss: 3.9393442
	speed: 0.1510s/iter; left time: 3016.7141s
Epoch: 4 cost time: 33.18332266807556
Epoch: 4, Steps: 208 | Train Loss: 3.590 Vali Loss: 3.944 Vali Acc: 0.026 Test Loss: 3.944 Test Acc: 0.026
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.8665140
	speed: 0.4069s/iter; left time: 8084.0494s
	iters: 200, epoch: 5 | loss: 4.0193505
	speed: 0.1422s/iter; left time: 2811.3747s
Epoch: 5 cost time: 28.800219535827637
Epoch: 5, Steps: 208 | Train Loss: 3.856 Vali Loss: 3.832 Vali Acc: 0.026 Test Loss: 3.832 Test Acc: 0.026
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 3.8476071
	speed: 0.4635s/iter; left time: 9113.7070s
	iters: 200, epoch: 6 | loss: 3.5976999
	speed: 0.1560s/iter; left time: 3051.3490s
Epoch: 6 cost time: 33.58920884132385
Epoch: 6, Steps: 208 | Train Loss: 3.800 Vali Loss: 3.719 Vali Acc: 0.026 Test Loss: 3.719 Test Acc: 0.026
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 3.7985926
	speed: 0.4476s/iter; left time: 8707.3039s
	iters: 200, epoch: 7 | loss: 3.7744017
	speed: 0.1518s/iter; left time: 2937.1876s
Epoch: 7 cost time: 31.89061689376831
Epoch: 7, Steps: 208 | Train Loss: 3.763 Vali Loss: 3.712 Vali Acc: 0.026 Test Loss: 3.712 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 3.7285547
	speed: 0.4736s/iter; left time: 9114.5084s
	iters: 200, epoch: 8 | loss: 3.7756982
	speed: 0.1441s/iter; left time: 2759.6964s
Epoch: 8 cost time: 33.502525091171265
Epoch: 8, Steps: 208 | Train Loss: 3.716 Vali Loss: 3.693 Vali Acc: 0.026 Test Loss: 3.693 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 3.6968236
	speed: 0.4359s/iter; left time: 8297.6092s
	iters: 200, epoch: 9 | loss: 3.5907743
	speed: 0.1474s/iter; left time: 2791.6610s
Epoch: 9 cost time: 30.656426906585693
Epoch: 9, Steps: 208 | Train Loss: 3.706 Vali Loss: 3.702 Vali Acc: 0.026 Test Loss: 3.702 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 3.7260408
	speed: 0.4655s/iter; left time: 8765.6075s
	iters: 200, epoch: 10 | loss: 3.6685891
	speed: 0.1213s/iter; left time: 2271.0945s
Epoch: 10 cost time: 28.381721019744873
Epoch: 10, Steps: 208 | Train Loss: 3.699 Vali Loss: 3.692 Vali Acc: 0.026 Test Loss: 3.692 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 3.7483118
	speed: 0.4083s/iter; left time: 7603.1154s
	iters: 200, epoch: 11 | loss: 3.6296999
	speed: 0.1505s/iter; left time: 2787.9532s
Epoch: 11 cost time: 32.02110743522644
Epoch: 11, Steps: 208 | Train Loss: 3.697 Vali Loss: 3.683 Vali Acc: 0.026 Test Loss: 3.683 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 3.7480631
	speed: 0.4401s/iter; left time: 8102.8832s
	iters: 200, epoch: 12 | loss: 3.6592772
	speed: 0.1519s/iter; left time: 2782.2133s
Epoch: 12 cost time: 31.301864624023438
Epoch: 12, Steps: 208 | Train Loss: 3.692 Vali Loss: 3.684 Vali Acc: 0.026 Test Loss: 3.684 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 3.5944839
	speed: 0.4208s/iter; left time: 7660.6667s
	iters: 200, epoch: 13 | loss: 3.6961188
	speed: 0.1509s/iter; left time: 2731.3395s
Epoch: 13 cost time: 30.457361221313477
Epoch: 13, Steps: 208 | Train Loss: 3.692 Vali Loss: 3.683 Vali Acc: 0.026 Test Loss: 3.683 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.06352520131225768
model parameter : 11097955
model size : 47.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.3273015
	speed: 0.1688s/iter; left time: 3494.8152s
	iters: 200, epoch: 1 | loss: 3.6599669
	speed: 0.1407s/iter; left time: 2898.1817s
Epoch: 1 cost time: 32.23227667808533
Epoch: 1, Steps: 208 | Train Loss: 3.910 Vali Loss: 3.967 Vali Acc: 0.052 Test Loss: 3.967 Test Acc: 0.052
Validation loss decreased (inf --> -0.051854).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4917693
	speed: 0.4651s/iter; left time: 9530.2885s
	iters: 200, epoch: 2 | loss: 3.5273030
	speed: 0.1530s/iter; left time: 3119.2192s
Epoch: 2 cost time: 32.67042875289917
Epoch: 2, Steps: 208 | Train Loss: 3.733 Vali Loss: 3.565 Vali Acc: 0.057 Test Loss: 3.565 Test Acc: 0.057
Validation loss decreased (-0.051854 --> -0.056630).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6488366
	speed: 0.4936s/iter; left time: 10012.5333s
	iters: 200, epoch: 3 | loss: 3.5777254
	speed: 0.1490s/iter; left time: 3008.1188s
Epoch: 3 cost time: 34.39054584503174
Epoch: 3, Steps: 208 | Train Loss: 3.568 Vali Loss: 3.387 Vali Acc: 0.065 Test Loss: 3.387 Test Acc: 0.065
Validation loss decreased (-0.056630 --> -0.064983).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2227981
	speed: 0.5570s/iter; left time: 11183.4508s
	iters: 200, epoch: 4 | loss: 2.8745751
	speed: 0.1781s/iter; left time: 3557.5693s
Epoch: 4 cost time: 39.220765113830566
Epoch: 4, Steps: 208 | Train Loss: 3.409 Vali Loss: 3.378 Vali Acc: 0.082 Test Loss: 3.378 Test Acc: 0.082
Validation loss decreased (-0.064983 --> -0.082281).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.1272721
	speed: 0.5026s/iter; left time: 9985.7094s
	iters: 200, epoch: 5 | loss: 3.0825877
	speed: 0.1649s/iter; left time: 3259.6287s
Epoch: 5 cost time: 33.729055643081665
Epoch: 5, Steps: 208 | Train Loss: 3.343 Vali Loss: 3.479 Vali Acc: 0.059 Test Loss: 3.479 Test Acc: 0.059
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.8607683
	speed: 0.5085s/iter; left time: 9997.8822s
	iters: 200, epoch: 6 | loss: 3.9511018
	speed: 0.1744s/iter; left time: 3411.9035s
Epoch: 6 cost time: 37.713815212249756
Epoch: 6, Steps: 208 | Train Loss: 3.765 Vali Loss: 3.726 Vali Acc: 0.026 Test Loss: 3.726 Test Acc: 0.026
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 4.0573411
	speed: 0.4925s/iter; left time: 9580.3541s
	iters: 200, epoch: 7 | loss: 3.7598276
	speed: 0.1892s/iter; left time: 3661.2877s
Epoch: 7 cost time: 37.127761125564575
Epoch: 7, Steps: 208 | Train Loss: 3.758 Vali Loss: 3.719 Vali Acc: 0.026 Test Loss: 3.719 Test Acc: 0.026
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 3.6614635
	speed: 0.5246s/iter; left time: 10095.8179s
	iters: 200, epoch: 8 | loss: 3.6152043
	speed: 0.1417s/iter; left time: 2712.8292s
Epoch: 8 cost time: 33.70408868789673
Epoch: 8, Steps: 208 | Train Loss: 3.728 Vali Loss: 3.690 Vali Acc: 0.026 Test Loss: 3.690 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 3.6746662
	speed: 0.4936s/iter; left time: 9396.7008s
	iters: 200, epoch: 9 | loss: 3.6955407
	speed: 0.1698s/iter; left time: 3214.6694s
Epoch: 9 cost time: 35.39974236488342
Epoch: 9, Steps: 208 | Train Loss: 3.707 Vali Loss: 3.677 Vali Acc: 0.026 Test Loss: 3.677 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 3.6458964
	speed: 0.5728s/iter; left time: 10784.7099s
	iters: 200, epoch: 10 | loss: 3.6968961
	speed: 0.1867s/iter; left time: 3497.6044s
Epoch: 10 cost time: 41.57496476173401
Epoch: 10, Steps: 208 | Train Loss: 3.691 Vali Loss: 3.681 Vali Acc: 0.026 Test Loss: 3.681 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 3.6755073
	speed: 0.5276s/iter; left time: 9824.8962s
	iters: 200, epoch: 11 | loss: 3.7336457
	speed: 0.1570s/iter; left time: 2907.9290s
Epoch: 11 cost time: 35.85542821884155
Epoch: 11, Steps: 208 | Train Loss: 3.691 Vali Loss: 3.678 Vali Acc: 0.026 Test Loss: 3.678 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 3.7479975
	speed: 0.5500s/iter; left time: 10127.3347s
	iters: 200, epoch: 12 | loss: 3.6221900
	speed: 0.1723s/iter; left time: 3156.1076s
Epoch: 12 cost time: 36.83162879943848
Epoch: 12, Steps: 208 | Train Loss: 3.691 Vali Loss: 3.688 Vali Acc: 0.026 Test Loss: 3.688 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 3.6663220
	speed: 0.5528s/iter; left time: 10063.6838s
	iters: 200, epoch: 13 | loss: 3.6971233
	speed: 0.1813s/iter; left time: 3282.0557s
Epoch: 13 cost time: 38.27796745300293
Epoch: 13, Steps: 208 | Train Loss: 3.687 Vali Loss: 3.686 Vali Acc: 0.026 Test Loss: 3.686 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 3.8373981
	speed: 0.5410s/iter; left time: 9736.7789s
	iters: 200, epoch: 14 | loss: 3.6267147
	speed: 0.1827s/iter; left time: 3269.7700s
Epoch: 14 cost time: 39.12476301193237
Epoch: 14, Steps: 208 | Train Loss: 3.701 Vali Loss: 3.677 Vali Acc: 0.026 Test Loss: 3.677 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08231434536236207
model parameter : 10535395
model size : 45.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.2006426
	speed: 0.1844s/iter; left time: 3816.4437s
	iters: 200, epoch: 1 | loss: 3.4050212
	speed: 0.1486s/iter; left time: 3061.7863s
Epoch: 1 cost time: 34.81937217712402
Epoch: 1, Steps: 208 | Train Loss: 3.914 Vali Loss: 3.798 Vali Acc: 0.032 Test Loss: 3.798 Test Acc: 0.032
Validation loss decreased (inf --> -0.031576).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9417155
	speed: 0.5082s/iter; left time: 10415.1092s
	iters: 200, epoch: 2 | loss: 3.8316731
	speed: 0.1729s/iter; left time: 3525.6313s
Epoch: 2 cost time: 36.71959662437439
Epoch: 2, Steps: 208 | Train Loss: 3.712 Vali Loss: 3.601 Vali Acc: 0.066 Test Loss: 3.601 Test Acc: 0.066
Validation loss decreased (-0.031576 --> -0.066173).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.9205863
	speed: 0.5111s/iter; left time: 10367.4048s
	iters: 200, epoch: 3 | loss: 3.7748094
	speed: 0.1491s/iter; left time: 3010.3813s
Epoch: 3 cost time: 33.65972089767456
Epoch: 3, Steps: 208 | Train Loss: 3.579 Vali Loss: 3.370 Vali Acc: 0.071 Test Loss: 3.370 Test Acc: 0.071
Validation loss decreased (-0.066173 --> -0.070948).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4618368
	speed: 0.4849s/iter; left time: 9735.2602s
	iters: 200, epoch: 4 | loss: 3.4101620
	speed: 0.1650s/iter; left time: 3297.0797s
Epoch: 4 cost time: 34.38986945152283
Epoch: 4, Steps: 208 | Train Loss: 3.400 Vali Loss: 3.427 Vali Acc: 0.075 Test Loss: 3.427 Test Acc: 0.075
Validation loss decreased (-0.070948 --> -0.075122).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3939304
	speed: 0.5010s/iter; left time: 9955.3021s
	iters: 200, epoch: 5 | loss: 3.1504946
	speed: 0.1478s/iter; left time: 2922.8328s
Epoch: 5 cost time: 33.17454481124878
Epoch: 5, Steps: 208 | Train Loss: 3.333 Vali Loss: 3.365 Vali Acc: 0.076 Test Loss: 3.365 Test Acc: 0.076
Validation loss decreased (-0.075122 --> -0.076316).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.9293685
	speed: 0.5015s/iter; left time: 9860.9453s
	iters: 200, epoch: 6 | loss: 3.6548233
	speed: 0.1352s/iter; left time: 2644.5545s
Epoch: 6 cost time: 31.560140132904053
Epoch: 6, Steps: 208 | Train Loss: 3.731 Vali Loss: 3.738 Vali Acc: 0.027 Test Loss: 3.738 Test Acc: 0.027
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.8903303
	speed: 0.4951s/iter; left time: 9630.3552s
	iters: 200, epoch: 7 | loss: 3.7551708
	speed: 0.1629s/iter; left time: 3152.4741s
Epoch: 7 cost time: 33.64775347709656
Epoch: 7, Steps: 208 | Train Loss: 3.761 Vali Loss: 3.739 Vali Acc: 0.026 Test Loss: 3.739 Test Acc: 0.026
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.7041287
	speed: 0.5047s/iter; left time: 9712.6708s
	iters: 200, epoch: 8 | loss: 3.5646410
	speed: 0.1645s/iter; left time: 3148.4604s
Epoch: 8 cost time: 36.618019819259644
Epoch: 8, Steps: 208 | Train Loss: 3.735 Vali Loss: 3.743 Vali Acc: 0.026 Test Loss: 3.743 Test Acc: 0.026
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 3.7972391
	speed: 0.4864s/iter; left time: 9258.8905s
	iters: 200, epoch: 9 | loss: 3.7355661
	speed: 0.1506s/iter; left time: 2851.6964s
Epoch: 9 cost time: 32.07885479927063
Epoch: 9, Steps: 208 | Train Loss: 3.723 Vali Loss: 3.718 Vali Acc: 0.026 Test Loss: 3.718 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 3.8298280
	speed: 0.4344s/iter; left time: 8179.3322s
	iters: 200, epoch: 10 | loss: 3.6916039
	speed: 0.1329s/iter; left time: 2488.4787s
Epoch: 10 cost time: 29.227805376052856
Epoch: 10, Steps: 208 | Train Loss: 3.703 Vali Loss: 3.684 Vali Acc: 0.026 Test Loss: 3.684 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 3.6500580
	speed: 0.4447s/iter; left time: 8280.9280s
	iters: 200, epoch: 11 | loss: 3.6913152
	speed: 0.1562s/iter; left time: 2893.5022s
Epoch: 11 cost time: 33.61612558364868
Epoch: 11, Steps: 208 | Train Loss: 3.700 Vali Loss: 3.676 Vali Acc: 0.026 Test Loss: 3.676 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 3.6961703
	speed: 0.4722s/iter; left time: 8694.2634s
	iters: 200, epoch: 12 | loss: 3.6748505
	speed: 0.1493s/iter; left time: 2733.7655s
Epoch: 12 cost time: 31.518577814102173
Epoch: 12, Steps: 208 | Train Loss: 3.692 Vali Loss: 3.708 Vali Acc: 0.026 Test Loss: 3.708 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 4.1279297
	speed: 0.4631s/iter; left time: 8431.3840s
	iters: 200, epoch: 13 | loss: 3.7517748
	speed: 0.1450s/iter; left time: 2625.1371s
Epoch: 13 cost time: 30.848612070083618
Epoch: 13, Steps: 208 | Train Loss: 4.005 Vali Loss: 3.741 Vali Acc: 0.026 Test Loss: 3.741 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 3.6216173
	speed: 0.4696s/iter; left time: 8451.8369s
	iters: 200, epoch: 14 | loss: 3.6996908
	speed: 0.1285s/iter; left time: 2300.5595s
Epoch: 14 cost time: 31.133463859558105
Epoch: 14, Steps: 208 | Train Loss: 3.714 Vali Loss: 3.684 Vali Acc: 0.026 Test Loss: 3.684 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 3.5768073
	speed: 0.4611s/iter; left time: 8202.0835s
	iters: 200, epoch: 15 | loss: 3.7602818
	speed: 0.1571s/iter; left time: 2779.6958s
Epoch: 15 cost time: 31.636949062347412
Epoch: 15, Steps: 208 | Train Loss: 3.693 Vali Loss: 3.683 Vali Acc: 0.026 Test Loss: 3.683 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.0763495377274083
model parameter : 10525923
model size : 45.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9483478
	speed: 0.1851s/iter; left time: 3831.2613s
	iters: 200, epoch: 1 | loss: 3.7852323
	speed: 0.1458s/iter; left time: 3003.2833s
Epoch: 1 cost time: 34.66743564605713
Epoch: 1, Steps: 208 | Train Loss: 3.971 Vali Loss: 3.870 Vali Acc: 0.035 Test Loss: 3.870 Test Acc: 0.035
Validation loss decreased (inf --> -0.035154).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5170791
	speed: 0.4889s/iter; left time: 10018.5721s
	iters: 200, epoch: 2 | loss: 3.6623902
	speed: 0.1657s/iter; left time: 3379.5322s
Epoch: 2 cost time: 34.690608501434326
Epoch: 2, Steps: 208 | Train Loss: 3.749 Vali Loss: 3.688 Vali Acc: 0.059 Test Loss: 3.688 Test Acc: 0.059
Validation loss decreased (-0.035154 --> -0.059313).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3969836
	speed: 0.4538s/iter; left time: 9204.4396s
	iters: 200, epoch: 3 | loss: 3.3746738
	speed: 0.1501s/iter; left time: 3030.6865s
Epoch: 3 cost time: 29.838584661483765
Epoch: 3, Steps: 208 | Train Loss: 3.571 Vali Loss: 3.474 Vali Acc: 0.067 Test Loss: 3.474 Test Acc: 0.067
Validation loss decreased (-0.059313 --> -0.066473).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3309181
	speed: 0.4767s/iter; left time: 9571.6738s
	iters: 200, epoch: 4 | loss: 3.4840159
	speed: 0.1565s/iter; left time: 3126.1215s
Epoch: 4 cost time: 33.407113790512085
Epoch: 4, Steps: 208 | Train Loss: 3.395 Vali Loss: 3.376 Vali Acc: 0.075 Test Loss: 3.376 Test Acc: 0.075
Validation loss decreased (-0.066473 --> -0.075123).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.0700493
	speed: 0.5444s/iter; left time: 10815.9892s
	iters: 200, epoch: 5 | loss: 3.6942992
	speed: 0.1549s/iter; left time: 3061.7810s
Epoch: 5 cost time: 34.67047476768494
Epoch: 5, Steps: 208 | Train Loss: 3.341 Vali Loss: 3.475 Vali Acc: 0.067 Test Loss: 3.475 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.7127659
	speed: 0.4744s/iter; left time: 9327.3369s
	iters: 200, epoch: 6 | loss: 3.7490957
	speed: 0.1483s/iter; left time: 2901.1251s
Epoch: 6 cost time: 31.416414737701416
Epoch: 6, Steps: 208 | Train Loss: 3.767 Vali Loss: 3.780 Vali Acc: 0.026 Test Loss: 3.780 Test Acc: 0.026
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 3.5875022
	speed: 0.4403s/iter; left time: 8565.8018s
	iters: 200, epoch: 7 | loss: 3.7261944
	speed: 0.1544s/iter; left time: 2987.2793s
Epoch: 7 cost time: 32.44911456108093
Epoch: 7, Steps: 208 | Train Loss: 3.771 Vali Loss: 3.723 Vali Acc: 0.026 Test Loss: 3.723 Test Acc: 0.026
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 3.8181283
	speed: 0.4399s/iter; left time: 8466.0922s
	iters: 200, epoch: 8 | loss: 3.6785166
	speed: 0.1335s/iter; left time: 2555.9091s
Epoch: 8 cost time: 29.08533501625061
Epoch: 8, Steps: 208 | Train Loss: 3.716 Vali Loss: 3.696 Vali Acc: 0.026 Test Loss: 3.696 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 3.7151573
	speed: 0.4622s/iter; left time: 8799.4201s
	iters: 200, epoch: 9 | loss: 3.7341535
	speed: 0.1497s/iter; left time: 2835.5171s
Epoch: 9 cost time: 33.43345928192139
Epoch: 9, Steps: 208 | Train Loss: 3.701 Vali Loss: 3.688 Vali Acc: 0.026 Test Loss: 3.688 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 3.8069251
	speed: 0.4488s/iter; left time: 8450.8211s
	iters: 200, epoch: 10 | loss: 3.6658111
	speed: 0.1543s/iter; left time: 2889.2620s
Epoch: 10 cost time: 32.34647583961487
Epoch: 10, Steps: 208 | Train Loss: 3.705 Vali Loss: 3.679 Vali Acc: 0.026 Test Loss: 3.679 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 3.6767507
	speed: 0.4694s/iter; left time: 8741.5579s
	iters: 200, epoch: 11 | loss: 3.6587844
	speed: 0.1330s/iter; left time: 2463.4273s
Epoch: 11 cost time: 29.03186011314392
Epoch: 11, Steps: 208 | Train Loss: 3.692 Vali Loss: 3.705 Vali Acc: 0.026 Test Loss: 3.705 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 3.6415339
	speed: 0.4533s/iter; left time: 8346.7301s
	iters: 200, epoch: 12 | loss: 3.6686485
	speed: 0.1689s/iter; left time: 3092.9461s
Epoch: 12 cost time: 34.118903160095215
Epoch: 12, Steps: 208 | Train Loss: 3.690 Vali Loss: 3.670 Vali Acc: 0.026 Test Loss: 3.670 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 3.8487136
	speed: 0.4508s/iter; left time: 8207.2317s
	iters: 200, epoch: 13 | loss: 3.6857088
	speed: 0.1429s/iter; left time: 2586.7257s
Epoch: 13 cost time: 30.661457777023315
Epoch: 13, Steps: 208 | Train Loss: 3.695 Vali Loss: 3.671 Vali Acc: 0.026 Test Loss: 3.671 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 3.6718581
	speed: 0.5162s/iter; left time: 9289.3885s
	iters: 200, epoch: 14 | loss: 3.6396143
	speed: 0.1609s/iter; left time: 2880.1992s
Epoch: 14 cost time: 32.634849309921265
Epoch: 14, Steps: 208 | Train Loss: 3.684 Vali Loss: 3.681 Vali Acc: 0.026 Test Loss: 3.681 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.07515657620041753
model parameter : 10516451
model size : 45.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5929773
	speed: 0.2168s/iter; left time: 4487.0229s
	iters: 200, epoch: 1 | loss: 3.6427207
	speed: 0.1744s/iter; left time: 3592.9537s
Epoch: 1 cost time: 40.758041858673096
Epoch: 1, Steps: 208 | Train Loss: 3.912 Vali Loss: 3.731 Vali Acc: 0.051 Test Loss: 3.731 Test Acc: 0.051
Validation loss decreased (inf --> -0.051260).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7813408
	speed: 0.4783s/iter; left time: 9801.6647s
	iters: 200, epoch: 2 | loss: 3.7295234
	speed: 0.1492s/iter; left time: 3043.5690s
Epoch: 2 cost time: 31.263275623321533
Epoch: 2, Steps: 208 | Train Loss: 3.737 Vali Loss: 3.700 Vali Acc: 0.048 Test Loss: 3.700 Test Acc: 0.048
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.0543704
	speed: 0.4698s/iter; left time: 9530.2870s
	iters: 200, epoch: 3 | loss: 3.6276927
	speed: 0.1428s/iter; left time: 2883.1217s
Epoch: 3 cost time: 30.8087375164032
Epoch: 3, Steps: 208 | Train Loss: 3.572 Vali Loss: 3.455 Vali Acc: 0.066 Test Loss: 3.455 Test Acc: 0.066
Validation loss decreased (-0.051260 --> -0.065877).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3662257
	speed: 0.4465s/iter; left time: 8964.8642s
	iters: 200, epoch: 4 | loss: 2.9121757
	speed: 0.1582s/iter; left time: 3160.8700s
Epoch: 4 cost time: 31.45720601081848
Epoch: 4, Steps: 208 | Train Loss: 3.366 Vali Loss: 3.397 Vali Acc: 0.061 Test Loss: 3.397 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.0964344
	speed: 0.4733s/iter; left time: 9403.6725s
	iters: 200, epoch: 5 | loss: 3.8141525
	speed: 0.1454s/iter; left time: 2875.3142s
Epoch: 5 cost time: 31.859612226486206
Epoch: 5, Steps: 208 | Train Loss: 3.476 Vali Loss: 3.830 Vali Acc: 0.026 Test Loss: 3.830 Test Acc: 0.026
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 3.8284311
	speed: 0.4366s/iter; left time: 8584.7993s
	iters: 200, epoch: 6 | loss: 3.7107332
	speed: 0.1440s/iter; left time: 2816.7135s
Epoch: 6 cost time: 30.146987199783325
Epoch: 6, Steps: 208 | Train Loss: 3.793 Vali Loss: 3.756 Vali Acc: 0.026 Test Loss: 3.756 Test Acc: 0.026
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 3.8251710
	speed: 0.4283s/iter; left time: 8331.1017s
	iters: 200, epoch: 7 | loss: 3.6727958
	speed: 0.1402s/iter; left time: 2712.6025s
Epoch: 7 cost time: 29.98380208015442
Epoch: 7, Steps: 208 | Train Loss: 3.745 Vali Loss: 3.726 Vali Acc: 0.026 Test Loss: 3.726 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 3.7450302
	speed: 0.4564s/iter; left time: 8783.0224s
	iters: 200, epoch: 8 | loss: 3.7380118
	speed: 0.1567s/iter; left time: 3000.1577s
Epoch: 8 cost time: 33.958552837371826
Epoch: 8, Steps: 208 | Train Loss: 3.708 Vali Loss: 3.715 Vali Acc: 0.026 Test Loss: 3.715 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 3.7163548
	speed: 0.4387s/iter; left time: 8351.9671s
	iters: 200, epoch: 9 | loss: 3.7953730
	speed: 0.1397s/iter; left time: 2646.0611s
Epoch: 9 cost time: 30.668457746505737
Epoch: 9, Steps: 208 | Train Loss: 3.697 Vali Loss: 3.682 Vali Acc: 0.026 Test Loss: 3.682 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 3.6591091
	speed: 0.4651s/iter; left time: 8757.6721s
	iters: 200, epoch: 10 | loss: 3.7090602
	speed: 0.1382s/iter; left time: 2588.6670s
Epoch: 10 cost time: 29.566009283065796
Epoch: 10, Steps: 208 | Train Loss: 3.693 Vali Loss: 3.677 Vali Acc: 0.026 Test Loss: 3.677 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 3.6948354
	speed: 0.4335s/iter; left time: 8072.6503s
	iters: 200, epoch: 11 | loss: 3.7164457
	speed: 0.1337s/iter; left time: 2476.7136s
Epoch: 11 cost time: 28.686378955841064
Epoch: 11, Steps: 208 | Train Loss: 3.691 Vali Loss: 3.677 Vali Acc: 0.026 Test Loss: 3.677 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 3.6154802
	speed: 0.4406s/iter; left time: 8113.0938s
	iters: 200, epoch: 12 | loss: 3.6473472
	speed: 0.1459s/iter; left time: 2671.3079s
Epoch: 12 cost time: 30.144793033599854
Epoch: 12, Steps: 208 | Train Loss: 3.685 Vali Loss: 3.697 Vali Acc: 0.026 Test Loss: 3.697 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 3.6923103
	speed: 0.4476s/iter; left time: 8148.3527s
	iters: 200, epoch: 13 | loss: 3.6483536
	speed: 0.1348s/iter; left time: 2439.6995s
Epoch: 13 cost time: 29.20250177383423
Epoch: 13, Steps: 208 | Train Loss: 3.686 Vali Loss: 3.670 Vali Acc: 0.025 Test Loss: 3.670 Test Acc: 0.025
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.0659111243662392
model parameter : 10506979
model size : 45.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6957655
	speed: 0.1710s/iter; left time: 3540.5123s
	iters: 200, epoch: 1 | loss: 3.7513771
	speed: 0.1518s/iter; left time: 3128.0020s
Epoch: 1 cost time: 33.64495921134949
Epoch: 1, Steps: 208 | Train Loss: 3.810 Vali Loss: 3.648 Vali Acc: 0.051 Test Loss: 3.648 Test Acc: 0.051
Validation loss decreased (inf --> -0.050664).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2821646
	speed: 0.4717s/iter; left time: 9666.1603s
	iters: 200, epoch: 2 | loss: 3.8360789
	speed: 0.1441s/iter; left time: 2939.4340s
Epoch: 2 cost time: 32.639415979385376
Epoch: 2, Steps: 208 | Train Loss: 3.665 Vali Loss: 3.630 Vali Acc: 0.057 Test Loss: 3.630 Test Acc: 0.057
Validation loss decreased (-0.050664 --> -0.057226).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5350835
	speed: 0.4516s/iter; left time: 9160.5262s
	iters: 200, epoch: 3 | loss: 3.1565487
	speed: 0.1536s/iter; left time: 3100.6202s
Epoch: 3 cost time: 31.3804669380188
Epoch: 3, Steps: 208 | Train Loss: 3.589 Vali Loss: 3.568 Vali Acc: 0.053 Test Loss: 3.568 Test Acc: 0.053
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.2277977
	speed: 0.4496s/iter; left time: 9026.0845s
	iters: 200, epoch: 4 | loss: 3.6349137
	speed: 0.1409s/iter; left time: 2815.6130s
Epoch: 4 cost time: 31.378511667251587
Epoch: 4, Steps: 208 | Train Loss: 3.473 Vali Loss: 3.431 Vali Acc: 0.060 Test Loss: 3.431 Test Acc: 0.060
Validation loss decreased (-0.057226 --> -0.060210).  Saving model ...
	iters: 100, epoch: 5 | loss: 4.0834122
	speed: 0.4819s/iter; left time: 9574.8631s
	iters: 200, epoch: 5 | loss: 3.1378968
	speed: 0.1346s/iter; left time: 2661.3411s
Epoch: 5 cost time: 30.98115563392639
Epoch: 5, Steps: 208 | Train Loss: 3.335 Vali Loss: 3.293 Vali Acc: 0.072 Test Loss: 3.293 Test Acc: 0.072
Validation loss decreased (-0.060210 --> -0.072439).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.3946981
	speed: 0.4714s/iter; left time: 9267.8022s
	iters: 200, epoch: 6 | loss: 3.1948097
	speed: 0.1573s/iter; left time: 3077.1324s
Epoch: 6 cost time: 32.238611698150635
Epoch: 6, Steps: 208 | Train Loss: 3.273 Vali Loss: 3.364 Vali Acc: 0.066 Test Loss: 3.364 Test Acc: 0.066
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.2272551
	speed: 0.4692s/iter; left time: 9127.5079s
	iters: 200, epoch: 7 | loss: 3.2255135
	speed: 0.1430s/iter; left time: 2768.3513s
Epoch: 7 cost time: 31.149901390075684
Epoch: 7, Steps: 208 | Train Loss: 3.313 Vali Loss: 3.261 Vali Acc: 0.081 Test Loss: 3.261 Test Acc: 0.081
Validation loss decreased (-0.072439 --> -0.080492).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.0766270
	speed: 0.4624s/iter; left time: 8899.8235s
	iters: 200, epoch: 8 | loss: 3.0945086
	speed: 0.1238s/iter; left time: 2371.0216s
Epoch: 8 cost time: 28.706797122955322
Epoch: 8, Steps: 208 | Train Loss: 3.331 Vali Loss: 3.359 Vali Acc: 0.068 Test Loss: 3.359 Test Acc: 0.068
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 3.5738823
	speed: 0.4529s/iter; left time: 8621.6449s
	iters: 200, epoch: 9 | loss: 3.6434672
	speed: 0.1461s/iter; left time: 2766.7524s
Epoch: 9 cost time: 30.881386756896973
Epoch: 9, Steps: 208 | Train Loss: 3.586 Vali Loss: 3.552 Vali Acc: 0.048 Test Loss: 3.552 Test Acc: 0.048
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 3.5355277
	speed: 0.4815s/iter; left time: 9066.1860s
	iters: 200, epoch: 10 | loss: 3.6198428
	speed: 0.1456s/iter; left time: 2726.5769s
Epoch: 10 cost time: 32.406169414520264
Epoch: 10, Steps: 208 | Train Loss: 3.618 Vali Loss: 3.703 Vali Acc: 0.026 Test Loss: 3.703 Test Acc: 0.026
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 3.6018920
	speed: 0.4538s/iter; left time: 8449.6564s
	iters: 200, epoch: 11 | loss: 3.6727588
	speed: 0.1468s/iter; left time: 2718.8616s
Epoch: 11 cost time: 30.841426849365234
Epoch: 11, Steps: 208 | Train Loss: 3.699 Vali Loss: 3.678 Vali Acc: 0.026 Test Loss: 3.678 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 3.7676303
	speed: 0.4505s/iter; left time: 8294.6957s
	iters: 200, epoch: 12 | loss: 3.7514641
	speed: 0.1978s/iter; left time: 3622.8055s
Epoch: 12 cost time: 35.94758605957031
Epoch: 12, Steps: 208 | Train Loss: 3.690 Vali Loss: 3.676 Vali Acc: 0.026 Test Loss: 3.676 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 3.6704113
	speed: 0.5802s/iter; left time: 10562.2998s
	iters: 200, epoch: 13 | loss: 3.6738269
	speed: 0.1762s/iter; left time: 3190.4875s
Epoch: 13 cost time: 38.30724263191223
Epoch: 13, Steps: 208 | Train Loss: 3.693 Vali Loss: 3.686 Vali Acc: 0.026 Test Loss: 3.686 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 3.7524576
	speed: 0.5270s/iter; left time: 9484.8913s
	iters: 200, epoch: 14 | loss: 3.6418862
	speed: 0.1614s/iter; left time: 2888.3605s
Epoch: 14 cost time: 34.15888547897339
Epoch: 14, Steps: 208 | Train Loss: 3.685 Vali Loss: 3.682 Vali Acc: 0.026 Test Loss: 3.682 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 3.6663070
	speed: 0.5415s/iter; left time: 9632.0374s
	iters: 200, epoch: 15 | loss: 3.6293514
	speed: 0.1868s/iter; left time: 3304.3127s
Epoch: 15 cost time: 40.09218668937683
Epoch: 15, Steps: 208 | Train Loss: 3.689 Vali Loss: 3.677 Vali Acc: 0.026 Test Loss: 3.677 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 3.7087820
	speed: 0.5324s/iter; left time: 9359.7114s
	iters: 200, epoch: 16 | loss: 3.6834135
	speed: 0.1685s/iter; left time: 2945.5362s
Epoch: 16 cost time: 36.71451115608215
Epoch: 16, Steps: 208 | Train Loss: 3.688 Vali Loss: 3.673 Vali Acc: 0.026 Test Loss: 3.673 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 3.6910369
	speed: 0.5601s/iter; left time: 9730.8316s
	iters: 200, epoch: 17 | loss: 3.7022970
	speed: 0.1542s/iter; left time: 2663.4919s
Epoch: 17 cost time: 35.471572399139404
Epoch: 17, Steps: 208 | Train Loss: 3.686 Vali Loss: 3.686 Vali Acc: 0.026 Test Loss: 3.686 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08052490307187593
model parameter : 4981475
model size : 21.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0169525
	speed: 0.1724s/iter; left time: 3568.9940s
	iters: 200, epoch: 1 | loss: 3.8689640
	speed: 0.1200s/iter; left time: 2471.5573s
Epoch: 1 cost time: 30.36861300468445
Epoch: 1, Steps: 208 | Train Loss: 3.793 Vali Loss: 3.674 Vali Acc: 0.050 Test Loss: 3.674 Test Acc: 0.050
Validation loss decreased (inf --> -0.050068).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5850146
	speed: 0.4424s/iter; left time: 9066.9591s
	iters: 200, epoch: 2 | loss: 3.2181706
	speed: 0.1365s/iter; left time: 2783.8285s
Epoch: 2 cost time: 29.42897653579712
Epoch: 2, Steps: 208 | Train Loss: 3.638 Vali Loss: 3.583 Vali Acc: 0.059 Test Loss: 3.583 Test Acc: 0.059
Validation loss decreased (-0.050068 --> -0.058718).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.0007520
	speed: 0.4493s/iter; left time: 9113.5843s
	iters: 200, epoch: 3 | loss: 3.4210181
	speed: 0.1362s/iter; left time: 2749.7565s
Epoch: 3 cost time: 28.585554361343384
Epoch: 3, Steps: 208 | Train Loss: 3.566 Vali Loss: 3.469 Vali Acc: 0.064 Test Loss: 3.469 Test Acc: 0.064
Validation loss decreased (-0.058718 --> -0.063491).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2882216
	speed: 0.4611s/iter; left time: 9257.9108s
	iters: 200, epoch: 4 | loss: 3.8625000
	speed: 0.1476s/iter; left time: 2947.8408s
Epoch: 4 cost time: 30.300042867660522
Epoch: 4, Steps: 208 | Train Loss: 3.444 Vali Loss: 3.381 Vali Acc: 0.077 Test Loss: 3.381 Test Acc: 0.077
Validation loss decreased (-0.063491 --> -0.076912).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.5263374
	speed: 0.4500s/iter; left time: 8941.0043s
	iters: 200, epoch: 5 | loss: 3.1411498
	speed: 0.1220s/iter; left time: 2412.2694s
Epoch: 5 cost time: 28.847192764282227
Epoch: 5, Steps: 208 | Train Loss: 3.290 Vali Loss: 3.299 Vali Acc: 0.085 Test Loss: 3.299 Test Acc: 0.085
Validation loss decreased (-0.076912 --> -0.084667).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.3559427
	speed: 0.4342s/iter; left time: 8536.0686s
	iters: 200, epoch: 6 | loss: 3.3525717
	speed: 0.1395s/iter; left time: 2729.4627s
Epoch: 6 cost time: 30.215548038482666
Epoch: 6, Steps: 208 | Train Loss: 3.239 Vali Loss: 3.263 Vali Acc: 0.083 Test Loss: 3.263 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.8993967
	speed: 0.4219s/iter; left time: 8206.8834s
	iters: 200, epoch: 7 | loss: 2.9431696
	speed: 0.1309s/iter; left time: 2533.1837s
Epoch: 7 cost time: 27.70965027809143
Epoch: 7, Steps: 208 | Train Loss: 3.209 Vali Loss: 3.299 Vali Acc: 0.094 Test Loss: 3.299 Test Acc: 0.094
Validation loss decreased (-0.084667 --> -0.094211).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.2676055
	speed: 0.4404s/iter; left time: 8474.7169s
	iters: 200, epoch: 8 | loss: 3.8331280
	speed: 0.1325s/iter; left time: 2536.2648s
Epoch: 8 cost time: 28.18549418449402
Epoch: 8, Steps: 208 | Train Loss: 3.296 Vali Loss: 3.526 Vali Acc: 0.047 Test Loss: 3.526 Test Acc: 0.047
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 3.4269607
	speed: 0.4138s/iter; left time: 7877.9593s
	iters: 200, epoch: 9 | loss: 3.5756416
	speed: 0.1332s/iter; left time: 2522.0687s
Epoch: 9 cost time: 27.627336263656616
Epoch: 9, Steps: 208 | Train Loss: 3.522 Vali Loss: 3.577 Vali Acc: 0.054 Test Loss: 3.577 Test Acc: 0.054
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 3.5106876
	speed: 0.4737s/iter; left time: 8919.4221s
	iters: 200, epoch: 10 | loss: 3.5532737
	speed: 0.1509s/iter; left time: 2827.0252s
Epoch: 10 cost time: 31.755080223083496
Epoch: 10, Steps: 208 | Train Loss: 3.614 Vali Loss: 3.690 Vali Acc: 0.026 Test Loss: 3.690 Test Acc: 0.026
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 3.7307734
	speed: 0.5247s/iter; left time: 9770.3833s
	iters: 200, epoch: 11 | loss: 3.6925571
	speed: 0.1717s/iter; left time: 3180.9116s
Epoch: 11 cost time: 37.31591200828552
Epoch: 11, Steps: 208 | Train Loss: 3.708 Vali Loss: 3.687 Vali Acc: 0.026 Test Loss: 3.687 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 3.7446852
	speed: 0.5732s/iter; left time: 10553.6693s
	iters: 200, epoch: 12 | loss: 3.6848471
	speed: 0.1616s/iter; left time: 2959.4361s
Epoch: 12 cost time: 36.831390380859375
Epoch: 12, Steps: 208 | Train Loss: 3.696 Vali Loss: 3.695 Vali Acc: 0.026 Test Loss: 3.695 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 3.6662688
	speed: 0.5706s/iter; left time: 10388.4957s
	iters: 200, epoch: 13 | loss: 3.6611748
	speed: 0.1655s/iter; left time: 2996.9138s
Epoch: 13 cost time: 37.61155581474304
Epoch: 13, Steps: 208 | Train Loss: 3.688 Vali Loss: 3.684 Vali Acc: 0.026 Test Loss: 3.684 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 3.6512678
	speed: 0.5135s/iter; left time: 9241.8111s
	iters: 200, epoch: 14 | loss: 3.6995735
	speed: 0.1486s/iter; left time: 2659.6603s
Epoch: 14 cost time: 33.80769395828247
Epoch: 14, Steps: 208 | Train Loss: 3.688 Vali Loss: 3.679 Vali Acc: 0.026 Test Loss: 3.679 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 3.6739881
	speed: 0.5105s/iter; left time: 9081.2195s
	iters: 200, epoch: 15 | loss: 3.7072821
	speed: 0.1813s/iter; left time: 3207.4087s
Epoch: 15 cost time: 35.790870904922485
Epoch: 15, Steps: 208 | Train Loss: 3.681 Vali Loss: 3.681 Vali Acc: 0.026 Test Loss: 3.681 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 3.7683787
	speed: 0.5453s/iter; left time: 9586.7040s
	iters: 200, epoch: 16 | loss: 3.6334481
	speed: 0.1420s/iter; left time: 2482.7002s
Epoch: 16 cost time: 33.27055287361145
Epoch: 16, Steps: 208 | Train Loss: 3.683 Vali Loss: 3.673 Vali Acc: 0.026 Test Loss: 3.673 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 3.7341070
	speed: 0.4961s/iter; left time: 8618.3991s
	iters: 200, epoch: 17 | loss: 3.6605911
	speed: 0.1725s/iter; left time: 2979.2799s
Epoch: 17 cost time: 34.71024942398071
Epoch: 17, Steps: 208 | Train Loss: 3.679 Vali Loss: 3.685 Vali Acc: 0.026 Test Loss: 3.685 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09424396063226961
model parameter : 4976739
model size : 21.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5389996
	speed: 0.1900s/iter; left time: 3933.5643s
	iters: 200, epoch: 1 | loss: 3.7823424
	speed: 0.1359s/iter; left time: 2800.5858s
Epoch: 1 cost time: 34.099632024765015
Epoch: 1, Steps: 208 | Train Loss: 3.769 Vali Loss: 3.624 Vali Acc: 0.052 Test Loss: 3.624 Test Acc: 0.052
Validation loss decreased (inf --> -0.051858).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7357044
	speed: 0.5004s/iter; left time: 10253.8990s
	iters: 200, epoch: 2 | loss: 3.5053794
	speed: 0.1633s/iter; left time: 3329.8840s
Epoch: 2 cost time: 35.08589029312134
Epoch: 2, Steps: 208 | Train Loss: 3.590 Vali Loss: 3.537 Vali Acc: 0.048 Test Loss: 3.537 Test Acc: 0.048
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.4944944
	speed: 0.4949s/iter; left time: 10039.6602s
	iters: 200, epoch: 3 | loss: 3.5623310
	speed: 0.1749s/iter; left time: 3530.7762s
Epoch: 3 cost time: 34.67510652542114
Epoch: 3, Steps: 208 | Train Loss: 3.531 Vali Loss: 3.484 Vali Acc: 0.056 Test Loss: 3.484 Test Acc: 0.056
Validation loss decreased (-0.051858 --> -0.055736).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3822563
	speed: 0.5480s/iter; left time: 11001.2722s
	iters: 200, epoch: 4 | loss: 3.2941873
	speed: 0.1775s/iter; left time: 3545.6546s
Epoch: 4 cost time: 36.219913482666016
Epoch: 4, Steps: 208 | Train Loss: 3.431 Vali Loss: 3.365 Vali Acc: 0.081 Test Loss: 3.365 Test Acc: 0.081
Validation loss decreased (-0.055736 --> -0.080491).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2099397
	speed: 0.5991s/iter; left time: 11904.0248s
	iters: 200, epoch: 5 | loss: 3.3022242
	speed: 0.1724s/iter; left time: 3408.2017s
Epoch: 5 cost time: 37.24093151092529
Epoch: 5, Steps: 208 | Train Loss: 3.322 Vali Loss: 3.453 Vali Acc: 0.065 Test Loss: 3.453 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.9202070
	speed: 0.5714s/iter; left time: 11235.2740s
	iters: 200, epoch: 6 | loss: 3.3500946
	speed: 0.1658s/iter; left time: 3243.9489s
Epoch: 6 cost time: 36.07490420341492
Epoch: 6, Steps: 208 | Train Loss: 3.263 Vali Loss: 3.196 Vali Acc: 0.095 Test Loss: 3.196 Test Acc: 0.095
Validation loss decreased (-0.080491 --> -0.095405).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.1520436
	speed: 0.5205s/iter; left time: 10125.4944s
	iters: 200, epoch: 7 | loss: 3.8615940
	speed: 0.1692s/iter; left time: 3274.2745s
Epoch: 7 cost time: 34.18875765800476
Epoch: 7, Steps: 208 | Train Loss: 3.239 Vali Loss: 3.314 Vali Acc: 0.075 Test Loss: 3.314 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 3.5457540
	speed: 0.5410s/iter; left time: 10412.3575s
	iters: 200, epoch: 8 | loss: 3.9590993
	speed: 0.1698s/iter; left time: 3250.4844s
Epoch: 8 cost time: 36.52940011024475
Epoch: 8, Steps: 208 | Train Loss: 3.340 Vali Loss: 3.301 Vali Acc: 0.072 Test Loss: 3.301 Test Acc: 0.072
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 3.5711758
	speed: 0.5579s/iter; left time: 10620.1311s
	iters: 200, epoch: 9 | loss: 3.3327968
	speed: 0.1946s/iter; left time: 3685.1547s
Epoch: 9 cost time: 41.53140616416931
Epoch: 9, Steps: 208 | Train Loss: 3.414 Vali Loss: 3.452 Vali Acc: 0.065 Test Loss: 3.452 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 3.4017701
	speed: 0.5273s/iter; left time: 9928.9088s
	iters: 200, epoch: 10 | loss: 3.7905304
	speed: 0.1570s/iter; left time: 2940.6129s
Epoch: 10 cost time: 33.91287851333618
Epoch: 10, Steps: 208 | Train Loss: 3.613 Vali Loss: 3.747 Vali Acc: 0.026 Test Loss: 3.747 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 3.8770607
	speed: 0.5554s/iter; left time: 10342.6531s
	iters: 200, epoch: 11 | loss: 3.6878033
	speed: 0.1790s/iter; left time: 3314.3388s
Epoch: 11 cost time: 36.79713797569275
Epoch: 11, Steps: 208 | Train Loss: 3.695 Vali Loss: 3.704 Vali Acc: 0.026 Test Loss: 3.704 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 3.6294951
	speed: 0.5880s/iter; left time: 10825.9956s
	iters: 200, epoch: 12 | loss: 3.7114995
	speed: 0.1348s/iter; left time: 2467.8059s
Epoch: 12 cost time: 34.47542977333069
Epoch: 12, Steps: 208 | Train Loss: 3.694 Vali Loss: 3.691 Vali Acc: 0.026 Test Loss: 3.691 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 3.6452680
	speed: 0.4874s/iter; left time: 8873.9825s
	iters: 200, epoch: 13 | loss: 3.6468480
	speed: 0.1588s/iter; left time: 2875.8348s
Epoch: 13 cost time: 33.06359267234802
Epoch: 13, Steps: 208 | Train Loss: 3.693 Vali Loss: 3.672 Vali Acc: 0.026 Test Loss: 3.672 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 3.6554012
	speed: 0.5082s/iter; left time: 9145.2364s
	iters: 200, epoch: 14 | loss: 3.8126564
	speed: 0.1505s/iter; left time: 2694.3381s
Epoch: 14 cost time: 34.11030888557434
Epoch: 14, Steps: 208 | Train Loss: 3.684 Vali Loss: 3.671 Vali Acc: 0.026 Test Loss: 3.671 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 3.6576533
	speed: 0.4968s/iter; left time: 8836.7297s
	iters: 200, epoch: 15 | loss: 3.6642735
	speed: 0.1385s/iter; left time: 2449.7903s
Epoch: 15 cost time: 31.114555835723877
Epoch: 15, Steps: 208 | Train Loss: 3.684 Vali Loss: 3.677 Vali Acc: 0.026 Test Loss: 3.677 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 3.7059178
	speed: 0.4950s/iter; left time: 8703.3839s
	iters: 200, epoch: 16 | loss: 3.7707889
	speed: 0.1488s/iter; left time: 2601.5245s
Epoch: 16 cost time: 32.58112335205078
Epoch: 16, Steps: 208 | Train Loss: 3.688 Vali Loss: 3.686 Vali Acc: 0.026 Test Loss: 3.686 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09543692215926036
model parameter : 4972003
model size : 21.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.4978578
	speed: 0.1770s/iter; left time: 3664.9545s
	iters: 200, epoch: 1 | loss: 3.7414565
	speed: 0.1610s/iter; left time: 3316.5273s
Epoch: 1 cost time: 34.77471089363098
Epoch: 1, Steps: 208 | Train Loss: 3.768 Vali Loss: 3.626 Vali Acc: 0.048 Test Loss: 3.626 Test Acc: 0.048
Validation loss decreased (inf --> -0.047980).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9384792
	speed: 0.5316s/iter; left time: 10893.7137s
	iters: 200, epoch: 2 | loss: 3.5718093
	speed: 0.1638s/iter; left time: 3339.9114s
Epoch: 2 cost time: 35.296594858169556
Epoch: 2, Steps: 208 | Train Loss: 3.658 Vali Loss: 3.580 Vali Acc: 0.058 Test Loss: 3.580 Test Acc: 0.058
Validation loss decreased (-0.047980 --> -0.057525).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4843245
	speed: 0.5436s/iter; left time: 11026.5517s
	iters: 200, epoch: 3 | loss: 3.6349392
	speed: 0.1640s/iter; left time: 3310.1085s
Epoch: 3 cost time: 34.731938123703
Epoch: 3, Steps: 208 | Train Loss: 3.539 Vali Loss: 3.481 Vali Acc: 0.052 Test Loss: 3.481 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.8224759
	speed: 0.5052s/iter; left time: 10143.0846s
	iters: 200, epoch: 4 | loss: 3.6193631
	speed: 0.1431s/iter; left time: 2859.0411s
Epoch: 4 cost time: 31.890514373779297
Epoch: 4, Steps: 208 | Train Loss: 3.396 Vali Loss: 3.290 Vali Acc: 0.094 Test Loss: 3.290 Test Acc: 0.094
Validation loss decreased (-0.057525 --> -0.093615).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2430367
	speed: 0.4986s/iter; left time: 9907.3303s
	iters: 200, epoch: 5 | loss: 3.2733405
	speed: 0.1320s/iter; left time: 2610.1231s
Epoch: 5 cost time: 29.860048055648804
Epoch: 5, Steps: 208 | Train Loss: 3.261 Vali Loss: 3.211 Vali Acc: 0.100 Test Loss: 3.211 Test Acc: 0.100
Validation loss decreased (-0.093615 --> -0.099580).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0293314
	speed: 0.4822s/iter; left time: 9481.2919s
	iters: 200, epoch: 6 | loss: 2.7579968
	speed: 0.1593s/iter; left time: 3116.0536s
Epoch: 6 cost time: 33.31062722206116
Epoch: 6, Steps: 208 | Train Loss: 3.230 Vali Loss: 3.291 Vali Acc: 0.086 Test Loss: 3.291 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.4659679
	speed: 0.5211s/iter; left time: 10137.4715s
	iters: 200, epoch: 7 | loss: 3.2738369
	speed: 0.1671s/iter; left time: 3232.9827s
Epoch: 7 cost time: 35.582324266433716
Epoch: 7, Steps: 208 | Train Loss: 3.281 Vali Loss: 3.371 Vali Acc: 0.056 Test Loss: 3.371 Test Acc: 0.056
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.6162109
	speed: 0.5085s/iter; left time: 9786.8738s
	iters: 200, epoch: 8 | loss: 3.2859340
	speed: 0.1632s/iter; left time: 3124.6464s
Epoch: 8 cost time: 34.19418907165527
Epoch: 8, Steps: 208 | Train Loss: 3.291 Vali Loss: 3.812 Vali Acc: 0.036 Test Loss: 3.812 Test Acc: 0.036
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 3.7454243
	speed: 0.5251s/iter; left time: 9995.5703s
	iters: 200, epoch: 9 | loss: 3.7592504
	speed: 0.1727s/iter; left time: 3269.4930s
Epoch: 9 cost time: 36.511062145233154
Epoch: 9, Steps: 208 | Train Loss: 3.720 Vali Loss: 3.715 Vali Acc: 0.026 Test Loss: 3.715 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 3.8376763
	speed: 0.5002s/iter; left time: 9417.8788s
	iters: 200, epoch: 10 | loss: 3.5312457
	speed: 0.1575s/iter; left time: 2949.2550s
Epoch: 10 cost time: 34.77690863609314
Epoch: 10, Steps: 208 | Train Loss: 3.688 Vali Loss: 3.672 Vali Acc: 0.031 Test Loss: 3.672 Test Acc: 0.031
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 3.6187625
	speed: 0.5511s/iter; left time: 10262.6681s
	iters: 200, epoch: 11 | loss: 3.6542218
	speed: 0.1555s/iter; left time: 2879.5219s
Epoch: 11 cost time: 36.230441093444824
Epoch: 11, Steps: 208 | Train Loss: 3.686 Vali Loss: 3.689 Vali Acc: 0.026 Test Loss: 3.689 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 3.6691339
	speed: 0.5155s/iter; left time: 9491.6958s
	iters: 200, epoch: 12 | loss: 3.6747434
	speed: 0.1738s/iter; left time: 3182.0449s
Epoch: 12 cost time: 36.36581897735596
Epoch: 12, Steps: 208 | Train Loss: 3.678 Vali Loss: 3.621 Vali Acc: 0.030 Test Loss: 3.621 Test Acc: 0.030
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 3.8392222
	speed: 0.5110s/iter; left time: 9302.3971s
	iters: 200, epoch: 13 | loss: 3.6028845
	speed: 0.1966s/iter; left time: 3560.3407s
Epoch: 13 cost time: 36.69177603721619
Epoch: 13, Steps: 208 | Train Loss: 3.633 Vali Loss: 3.618 Vali Acc: 0.033 Test Loss: 3.618 Test Acc: 0.033
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 3.7027581
	speed: 0.5208s/iter; left time: 9372.9869s
	iters: 200, epoch: 14 | loss: 3.6735363
	speed: 0.1665s/iter; left time: 2980.0480s
Epoch: 14 cost time: 35.457239866256714
Epoch: 14, Steps: 208 | Train Loss: 3.615 Vali Loss: 3.624 Vali Acc: 0.042 Test Loss: 3.624 Test Acc: 0.042
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 3.7196832
	speed: 0.5045s/iter; left time: 8974.2984s
	iters: 200, epoch: 15 | loss: 3.6330962
	speed: 0.1545s/iter; left time: 2732.2546s
Epoch: 15 cost time: 33.227701902389526
Epoch: 15, Steps: 208 | Train Loss: 3.600 Vali Loss: 3.594 Vali Acc: 0.047 Test Loss: 3.594 Test Acc: 0.047
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09961228750372801
model parameter : 4967267
model size : 21.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.3645132
	speed: 0.1947s/iter; left time: 4031.3576s
	iters: 200, epoch: 1 | loss: 3.4043131
	speed: 0.1686s/iter; left time: 3472.5520s
Epoch: 1 cost time: 37.75939750671387
Epoch: 1, Steps: 208 | Train Loss: 3.815 Vali Loss: 3.605 Vali Acc: 0.053 Test Loss: 3.605 Test Acc: 0.053
Validation loss decreased (inf --> -0.053051).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8045530
	speed: 0.5257s/iter; left time: 10772.5115s
	iters: 200, epoch: 2 | loss: 3.5766704
	speed: 0.1416s/iter; left time: 2887.4961s
Epoch: 2 cost time: 32.75142025947571
Epoch: 2, Steps: 208 | Train Loss: 3.638 Vali Loss: 3.543 Vali Acc: 0.060 Test Loss: 3.543 Test Acc: 0.060
Validation loss decreased (-0.053051 --> -0.059911).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7150915
	speed: 0.4703s/iter; left time: 9540.1699s
	iters: 200, epoch: 3 | loss: 3.4776170
	speed: 0.1496s/iter; left time: 3020.6332s
Epoch: 3 cost time: 32.37006735801697
Epoch: 3, Steps: 208 | Train Loss: 3.555 Vali Loss: 3.514 Vali Acc: 0.067 Test Loss: 3.514 Test Acc: 0.067
Validation loss decreased (-0.059911 --> -0.067069).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3802726
	speed: 0.5135s/iter; left time: 10309.5079s
	iters: 200, epoch: 4 | loss: 3.1450448
	speed: 0.1488s/iter; left time: 2972.3385s
Epoch: 4 cost time: 35.26476860046387
Epoch: 4, Steps: 208 | Train Loss: 3.421 Vali Loss: 3.350 Vali Acc: 0.060 Test Loss: 3.350 Test Acc: 0.060
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.8999729
	speed: 0.4944s/iter; left time: 9822.6205s
	iters: 200, epoch: 5 | loss: 3.4610028
	speed: 0.1662s/iter; left time: 3285.2724s
Epoch: 5 cost time: 34.12690258026123
Epoch: 5, Steps: 208 | Train Loss: 3.293 Vali Loss: 3.194 Vali Acc: 0.082 Test Loss: 3.194 Test Acc: 0.082
Validation loss decreased (-0.067069 --> -0.081984).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.8249161
	speed: 0.4763s/iter; left time: 9363.8561s
	iters: 200, epoch: 6 | loss: 3.5928881
	speed: 0.1403s/iter; left time: 2744.4847s
Epoch: 6 cost time: 29.985004663467407
Epoch: 6, Steps: 208 | Train Loss: 3.158 Vali Loss: 3.202 Vali Acc: 0.084 Test Loss: 3.202 Test Acc: 0.084
Validation loss decreased (-0.081984 --> -0.083774).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.2550435
	speed: 0.4340s/iter; left time: 8442.8385s
	iters: 200, epoch: 7 | loss: 3.1779816
	speed: 0.1464s/iter; left time: 2833.4098s
Epoch: 7 cost time: 31.166521310806274
Epoch: 7, Steps: 208 | Train Loss: 3.138 Vali Loss: 3.346 Vali Acc: 0.085 Test Loss: 3.346 Test Acc: 0.085
Validation loss decreased (-0.083774 --> -0.085263).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.8304229
	speed: 0.4899s/iter; left time: 9428.8045s
	iters: 200, epoch: 8 | loss: 2.8672597
	speed: 0.1586s/iter; left time: 3036.0773s
Epoch: 8 cost time: 34.079838514328
Epoch: 8, Steps: 208 | Train Loss: 3.149 Vali Loss: 3.206 Vali Acc: 0.095 Test Loss: 3.206 Test Acc: 0.095
Validation loss decreased (-0.085263 --> -0.095107).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.1563148
	speed: 0.5600s/iter; left time: 10660.1038s
	iters: 200, epoch: 9 | loss: 3.5212286
	speed: 0.1737s/iter; left time: 3289.6820s
Epoch: 9 cost time: 38.26885485649109
Epoch: 9, Steps: 208 | Train Loss: 3.179 Vali Loss: 3.291 Vali Acc: 0.085 Test Loss: 3.291 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 3.4550505
	speed: 0.5322s/iter; left time: 10020.3199s
	iters: 200, epoch: 10 | loss: 3.2516832
	speed: 0.1750s/iter; left time: 3278.3726s
Epoch: 10 cost time: 37.80738162994385
Epoch: 10, Steps: 208 | Train Loss: 3.322 Vali Loss: 3.398 Vali Acc: 0.068 Test Loss: 3.398 Test Acc: 0.068
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 3.6344030
	speed: 0.4874s/iter; left time: 9075.9034s
	iters: 200, epoch: 11 | loss: 3.5114701
	speed: 0.1680s/iter; left time: 3111.4490s
Epoch: 11 cost time: 34.33295774459839
Epoch: 11, Steps: 208 | Train Loss: 3.544 Vali Loss: 3.591 Vali Acc: 0.041 Test Loss: 3.591 Test Acc: 0.041
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 3.5674224
	speed: 0.5603s/iter; left time: 10317.6530s
	iters: 200, epoch: 12 | loss: 3.7385869
	speed: 0.1616s/iter; left time: 2959.3604s
Epoch: 12 cost time: 36.259450912475586
Epoch: 12, Steps: 208 | Train Loss: 3.618 Vali Loss: 3.696 Vali Acc: 0.026 Test Loss: 3.696 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 3.6564469
	speed: 0.5556s/iter; left time: 10114.4332s
	iters: 200, epoch: 13 | loss: 3.6957214
	speed: 0.1517s/iter; left time: 2745.6892s
Epoch: 13 cost time: 36.09707069396973
Epoch: 13, Steps: 208 | Train Loss: 3.705 Vali Loss: 3.683 Vali Acc: 0.028 Test Loss: 3.683 Test Acc: 0.028
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 3.5834401
	speed: 0.5429s/iter; left time: 9771.1070s
	iters: 200, epoch: 14 | loss: 3.6116059
	speed: 0.1627s/iter; left time: 2911.2280s
Epoch: 14 cost time: 37.25113606452942
Epoch: 14, Steps: 208 | Train Loss: 3.699 Vali Loss: 3.707 Vali Acc: 0.026 Test Loss: 3.707 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 3.6923265
	speed: 0.5074s/iter; left time: 9026.5733s
	iters: 200, epoch: 15 | loss: 3.6898305
	speed: 0.1565s/iter; left time: 2768.4878s
Epoch: 15 cost time: 33.66521191596985
Epoch: 15, Steps: 208 | Train Loss: 3.696 Vali Loss: 3.680 Vali Acc: 0.026 Test Loss: 3.680 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 3.7663412
	speed: 0.5175s/iter; left time: 9098.7419s
	iters: 200, epoch: 16 | loss: 3.6279426
	speed: 0.1687s/iter; left time: 2948.2566s
Epoch: 16 cost time: 35.73779487609863
Epoch: 16, Steps: 208 | Train Loss: 3.687 Vali Loss: 3.681 Vali Acc: 0.026 Test Loss: 3.681 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 3.6888289
	speed: 0.5151s/iter; left time: 8948.9733s
	iters: 200, epoch: 17 | loss: 3.6965542
	speed: 0.1730s/iter; left time: 2987.7793s
Epoch: 17 cost time: 36.69428992271423
Epoch: 17, Steps: 208 | Train Loss: 3.687 Vali Loss: 3.673 Vali Acc: 0.026 Test Loss: 3.673 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 3.6743841
	speed: 0.4703s/iter; left time: 8072.3508s
	iters: 200, epoch: 18 | loss: 3.7060542
	speed: 0.1707s/iter; left time: 2913.8169s
Epoch: 18 cost time: 33.64333128929138
Epoch: 18, Steps: 208 | Train Loss: 3.682 Vali Loss: 3.672 Vali Acc: 0.026 Test Loss: 3.672 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09513868177751268
model parameter : 3797219
model size : 17.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9349728
	speed: 0.1801s/iter; left time: 3728.9550s
	iters: 200, epoch: 1 | loss: 3.5542433
	speed: 0.1757s/iter; left time: 3619.0498s
Epoch: 1 cost time: 37.27770519256592
Epoch: 1, Steps: 208 | Train Loss: 3.781 Vali Loss: 3.813 Vali Acc: 0.050 Test Loss: 3.813 Test Acc: 0.050
Validation loss decreased (inf --> -0.050364).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.1385136
	speed: 0.5830s/iter; left time: 11948.3337s
	iters: 200, epoch: 2 | loss: 3.7559869
	speed: 0.1621s/iter; left time: 3305.6324s
Epoch: 2 cost time: 36.90744185447693
Epoch: 2, Steps: 208 | Train Loss: 3.674 Vali Loss: 3.598 Vali Acc: 0.060 Test Loss: 3.598 Test Acc: 0.060
Validation loss decreased (-0.050364 --> -0.060209).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4150624
	speed: 0.5315s/iter; left time: 10781.8416s
	iters: 200, epoch: 3 | loss: 3.7442009
	speed: 0.1659s/iter; left time: 3348.9381s
Epoch: 3 cost time: 35.932482957839966
Epoch: 3, Steps: 208 | Train Loss: 3.607 Vali Loss: 3.618 Vali Acc: 0.043 Test Loss: 3.618 Test Acc: 0.043
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.8794146
	speed: 0.5466s/iter; left time: 10975.0073s
	iters: 200, epoch: 4 | loss: 3.8685939
	speed: 0.1552s/iter; left time: 3100.6701s
Epoch: 4 cost time: 34.9038724899292
Epoch: 4, Steps: 208 | Train Loss: 3.699 Vali Loss: 3.746 Vali Acc: 0.026 Test Loss: 3.746 Test Acc: 0.026
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 3.6921740
	speed: 0.5166s/iter; left time: 10265.2256s
	iters: 200, epoch: 5 | loss: 3.8204074
	speed: 0.1565s/iter; left time: 3094.2807s
Epoch: 5 cost time: 33.30132842063904
Epoch: 5, Steps: 208 | Train Loss: 3.755 Vali Loss: 3.725 Vali Acc: 0.026 Test Loss: 3.725 Test Acc: 0.026
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 3.6808126
	speed: 0.4908s/iter; left time: 9650.1696s
	iters: 200, epoch: 6 | loss: 3.8395572
	speed: 0.1761s/iter; left time: 3445.5436s
Epoch: 6 cost time: 34.995646476745605
Epoch: 6, Steps: 208 | Train Loss: 3.740 Vali Loss: 3.696 Vali Acc: 0.026 Test Loss: 3.696 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 3.6645355
	speed: 0.5051s/iter; left time: 9825.3333s
	iters: 200, epoch: 7 | loss: 3.6961763
	speed: 0.1418s/iter; left time: 2744.1905s
Epoch: 7 cost time: 31.796475648880005
Epoch: 7, Steps: 208 | Train Loss: 3.722 Vali Loss: 3.692 Vali Acc: 0.026 Test Loss: 3.692 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 3.7296829
	speed: 0.4895s/iter; left time: 9420.0358s
	iters: 200, epoch: 8 | loss: 3.7169111
	speed: 0.1679s/iter; left time: 3213.7752s
Epoch: 8 cost time: 34.25549244880676
Epoch: 8, Steps: 208 | Train Loss: 3.694 Vali Loss: 3.676 Vali Acc: 0.026 Test Loss: 3.676 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 3.6589942
	speed: 0.5619s/iter; left time: 10696.5641s
	iters: 200, epoch: 9 | loss: 3.6663339
	speed: 0.1755s/iter; left time: 3323.4655s
Epoch: 9 cost time: 38.2874596118927
Epoch: 9, Steps: 208 | Train Loss: 3.685 Vali Loss: 3.678 Vali Acc: 0.026 Test Loss: 3.678 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 3.6759315
	speed: 0.4574s/iter; left time: 8611.8550s
	iters: 200, epoch: 10 | loss: 3.6607206
	speed: 0.1393s/iter; left time: 2609.1706s
Epoch: 10 cost time: 30.371323823928833
Epoch: 10, Steps: 208 | Train Loss: 3.683 Vali Loss: 3.670 Vali Acc: 0.026 Test Loss: 3.670 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 3.6681468
	speed: 0.4422s/iter; left time: 8234.3488s
	iters: 200, epoch: 11 | loss: 3.6589496
	speed: 0.1349s/iter; left time: 2498.8291s
Epoch: 11 cost time: 28.73812437057495
Epoch: 11, Steps: 208 | Train Loss: 3.683 Vali Loss: 3.672 Vali Acc: 0.026 Test Loss: 3.672 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 3.6822271
	speed: 0.4651s/iter; left time: 8564.5505s
	iters: 200, epoch: 12 | loss: 3.7124097
	speed: 0.1343s/iter; left time: 2459.2312s
Epoch: 12 cost time: 30.746055364608765
Epoch: 12, Steps: 208 | Train Loss: 3.682 Vali Loss: 3.697 Vali Acc: 0.026 Test Loss: 3.697 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.06024455711303311
model parameter : 3792483
model size : 17.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.4371295
	speed: 0.1988s/iter; left time: 4115.4854s
	iters: 200, epoch: 1 | loss: 3.8012023
	speed: 0.1639s/iter; left time: 3375.9139s
Epoch: 1 cost time: 37.77087950706482
Epoch: 1, Steps: 208 | Train Loss: 3.820 Vali Loss: 3.637 Vali Acc: 0.045 Test Loss: 3.637 Test Acc: 0.045
Validation loss decreased (inf --> -0.044700).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5638440
	speed: 0.5547s/iter; left time: 11367.1586s
	iters: 200, epoch: 2 | loss: 3.8501830
	speed: 0.1600s/iter; left time: 3262.1372s
Epoch: 2 cost time: 36.78453850746155
Epoch: 2, Steps: 208 | Train Loss: 3.613 Vali Loss: 3.531 Vali Acc: 0.053 Test Loss: 3.531 Test Acc: 0.053
Validation loss decreased (-0.044700 --> -0.053051).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5931029
	speed: 0.4788s/iter; left time: 9711.6375s
	iters: 200, epoch: 3 | loss: 3.5732148
	speed: 0.1616s/iter; left time: 3260.9902s
Epoch: 3 cost time: 32.08458685874939
Epoch: 3, Steps: 208 | Train Loss: 3.539 Vali Loss: 3.517 Vali Acc: 0.060 Test Loss: 3.517 Test Acc: 0.060
Validation loss decreased (-0.053051 --> -0.059613).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.1938999
	speed: 0.4993s/iter; left time: 10025.0617s
	iters: 200, epoch: 4 | loss: 2.8867495
	speed: 0.1644s/iter; left time: 3284.2608s
Epoch: 4 cost time: 35.59962821006775
Epoch: 4, Steps: 208 | Train Loss: 3.429 Vali Loss: 3.403 Vali Acc: 0.085 Test Loss: 3.403 Test Acc: 0.085
Validation loss decreased (-0.059613 --> -0.084666).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.4895458
	speed: 0.5350s/iter; left time: 10629.2769s
	iters: 200, epoch: 5 | loss: 3.4749863
	speed: 0.1791s/iter; left time: 3541.5161s
Epoch: 5 cost time: 36.50692844390869
Epoch: 5, Steps: 208 | Train Loss: 3.287 Vali Loss: 3.279 Vali Acc: 0.085 Test Loss: 3.279 Test Acc: 0.085
Validation loss decreased (-0.084666 --> -0.084966).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.8376708
	speed: 0.4988s/iter; left time: 9806.4824s
	iters: 200, epoch: 6 | loss: 3.2143536
	speed: 0.1583s/iter; left time: 3096.3533s
Epoch: 6 cost time: 33.74555802345276
Epoch: 6, Steps: 208 | Train Loss: 3.207 Vali Loss: 3.338 Vali Acc: 0.071 Test Loss: 3.338 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.4430604
	speed: 0.5006s/iter; left time: 9738.8171s
	iters: 200, epoch: 7 | loss: 3.0771699
	speed: 0.1697s/iter; left time: 3284.0406s
Epoch: 7 cost time: 34.607396602630615
Epoch: 7, Steps: 208 | Train Loss: 3.117 Vali Loss: 3.203 Vali Acc: 0.098 Test Loss: 3.203 Test Acc: 0.098
Validation loss decreased (-0.084966 --> -0.097791).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.1757157
	speed: 0.5785s/iter; left time: 11132.7013s
	iters: 200, epoch: 8 | loss: 3.2176266
	speed: 0.1876s/iter; left time: 3591.5643s
Epoch: 8 cost time: 39.589897871017456
Epoch: 8, Steps: 208 | Train Loss: 3.135 Vali Loss: 3.273 Vali Acc: 0.090 Test Loss: 3.273 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 3.0932443
	speed: 0.5369s/iter; left time: 10221.2734s
	iters: 200, epoch: 9 | loss: 3.2859755
	speed: 0.1533s/iter; left time: 2903.9852s
Epoch: 9 cost time: 33.20380926132202
Epoch: 9, Steps: 208 | Train Loss: 3.320 Vali Loss: 3.433 Vali Acc: 0.055 Test Loss: 3.433 Test Acc: 0.055
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 3.7701857
	speed: 0.5455s/iter; left time: 10270.5156s
	iters: 200, epoch: 10 | loss: 3.7044606
	speed: 0.1630s/iter; left time: 3053.2723s
Epoch: 10 cost time: 35.17245388031006
Epoch: 10, Steps: 208 | Train Loss: 3.602 Vali Loss: 3.703 Vali Acc: 0.026 Test Loss: 3.703 Test Acc: 0.026
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 3.7609501
	speed: 0.5924s/iter; left time: 11031.8170s
	iters: 200, epoch: 11 | loss: 3.7143252
	speed: 0.1743s/iter; left time: 3228.0483s
Epoch: 11 cost time: 39.21796751022339
Epoch: 11, Steps: 208 | Train Loss: 3.703 Vali Loss: 3.709 Vali Acc: 0.026 Test Loss: 3.709 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 3.7236629
	speed: 0.5222s/iter; left time: 9614.9077s
	iters: 200, epoch: 12 | loss: 3.6767225
	speed: 0.1741s/iter; left time: 3188.0493s
Epoch: 12 cost time: 36.46400713920593
Epoch: 12, Steps: 208 | Train Loss: 3.688 Vali Loss: 3.697 Vali Acc: 0.026 Test Loss: 3.697 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 3.7520089
	speed: 0.5215s/iter; left time: 9494.4855s
	iters: 200, epoch: 13 | loss: 3.6024072
	speed: 0.1732s/iter; left time: 3136.4867s
Epoch: 13 cost time: 35.73140859603882
Epoch: 13, Steps: 208 | Train Loss: 3.690 Vali Loss: 3.691 Vali Acc: 0.026 Test Loss: 3.691 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 3.6464531
	speed: 0.5459s/iter; left time: 9825.1318s
	iters: 200, epoch: 14 | loss: 3.7885084
	speed: 0.1679s/iter; left time: 3005.2465s
Epoch: 14 cost time: 35.54137086868286
Epoch: 14, Steps: 208 | Train Loss: 3.684 Vali Loss: 3.679 Vali Acc: 0.026 Test Loss: 3.679 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 3.6703167
	speed: 0.5418s/iter; left time: 9638.5211s
	iters: 200, epoch: 15 | loss: 3.6503901
	speed: 0.1710s/iter; left time: 3025.3475s
Epoch: 15 cost time: 38.4190731048584
Epoch: 15, Steps: 208 | Train Loss: 3.686 Vali Loss: 3.673 Vali Acc: 0.026 Test Loss: 3.673 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 3.5952971
	speed: 0.5378s/iter; left time: 9454.2656s
	iters: 200, epoch: 16 | loss: 3.6387413
	speed: 0.1730s/iter; left time: 3024.9089s
Epoch: 16 cost time: 36.643818378448486
Epoch: 16, Steps: 208 | Train Loss: 3.679 Vali Loss: 3.679 Vali Acc: 0.025 Test Loss: 3.679 Test Acc: 0.025
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 3.6388459
	speed: 0.5914s/iter; left time: 10274.7881s
	iters: 200, epoch: 17 | loss: 3.6746666
	speed: 0.1488s/iter; left time: 2569.6186s
Epoch: 17 cost time: 35.37030243873596
Epoch: 17, Steps: 208 | Train Loss: 3.682 Vali Loss: 3.678 Vali Acc: 0.026 Test Loss: 3.678 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09782284521324187
model parameter : 3787747
model size : 17.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8798611
	speed: 0.1613s/iter; left time: 3338.2138s
	iters: 200, epoch: 1 | loss: 3.5947301
	speed: 0.1426s/iter; left time: 2936.8592s
Epoch: 1 cost time: 31.815275192260742
Epoch: 1, Steps: 208 | Train Loss: 3.809 Vali Loss: 3.688 Vali Acc: 0.053 Test Loss: 3.688 Test Acc: 0.053
Validation loss decreased (inf --> -0.053050).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7052915
	speed: 0.5074s/iter; left time: 10398.7913s
	iters: 200, epoch: 2 | loss: 3.6915810
	speed: 0.1630s/iter; left time: 3324.4340s
Epoch: 2 cost time: 34.49228096008301
Epoch: 2, Steps: 208 | Train Loss: 3.679 Vali Loss: 3.593 Vali Acc: 0.051 Test Loss: 3.593 Test Acc: 0.051
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.6656051
	speed: 0.5071s/iter; left time: 10287.4137s
	iters: 200, epoch: 3 | loss: 3.7056334
	speed: 0.1618s/iter; left time: 3266.8094s
Epoch: 3 cost time: 34.5581693649292
Epoch: 3, Steps: 208 | Train Loss: 3.581 Vali Loss: 3.565 Vali Acc: 0.064 Test Loss: 3.565 Test Acc: 0.064
Validation loss decreased (-0.053050 --> -0.063788).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.1307180
	speed: 0.5177s/iter; left time: 10393.0105s
	iters: 200, epoch: 4 | loss: 3.5220199
	speed: 0.1593s/iter; left time: 3182.0121s
Epoch: 4 cost time: 33.82313299179077
Epoch: 4, Steps: 208 | Train Loss: 3.490 Vali Loss: 3.422 Vali Acc: 0.074 Test Loss: 3.422 Test Acc: 0.074
Validation loss decreased (-0.063788 --> -0.073929).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.5432684
	speed: 0.5122s/iter; left time: 10176.4931s
	iters: 200, epoch: 5 | loss: 3.5956287
	speed: 0.1513s/iter; left time: 2991.2949s
Epoch: 5 cost time: 32.893495082855225
Epoch: 5, Steps: 208 | Train Loss: 3.336 Vali Loss: 3.304 Vali Acc: 0.080 Test Loss: 3.304 Test Acc: 0.080
Validation loss decreased (-0.073929 --> -0.080194).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2054117
	speed: 0.4957s/iter; left time: 9745.5422s
	iters: 200, epoch: 6 | loss: 3.1445103
	speed: 0.1851s/iter; left time: 3621.3361s
Epoch: 6 cost time: 36.64841938018799
Epoch: 6, Steps: 208 | Train Loss: 3.207 Vali Loss: 3.283 Vali Acc: 0.082 Test Loss: 3.283 Test Acc: 0.082
Validation loss decreased (-0.080194 --> -0.081685).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.1910028
	speed: 0.5502s/iter; left time: 10702.9533s
	iters: 200, epoch: 7 | loss: 3.3721223
	speed: 0.1885s/iter; left time: 3647.1340s
Epoch: 7 cost time: 38.738407611846924
Epoch: 7, Steps: 208 | Train Loss: 3.163 Vali Loss: 3.189 Vali Acc: 0.103 Test Loss: 3.189 Test Acc: 0.103
Validation loss decreased (-0.081685 --> -0.102861).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.2460001
	speed: 0.5686s/iter; left time: 10943.6536s
	iters: 200, epoch: 8 | loss: 3.3927608
	speed: 0.1837s/iter; left time: 3517.5085s
Epoch: 8 cost time: 37.57023763656616
Epoch: 8, Steps: 208 | Train Loss: 3.151 Vali Loss: 3.198 Vali Acc: 0.097 Test Loss: 3.198 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 3.6187899
	speed: 0.5440s/iter; left time: 10355.2694s
	iters: 200, epoch: 9 | loss: 3.7581949
	speed: 0.1306s/iter; left time: 2473.3866s
Epoch: 9 cost time: 31.880770683288574
Epoch: 9, Steps: 208 | Train Loss: 3.452 Vali Loss: 3.569 Vali Acc: 0.041 Test Loss: 3.569 Test Acc: 0.041
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 3.5158083
	speed: 0.5183s/iter; left time: 9759.2436s
	iters: 200, epoch: 10 | loss: 3.7634025
	speed: 0.1598s/iter; left time: 2992.6375s
Epoch: 10 cost time: 35.03748893737793
Epoch: 10, Steps: 208 | Train Loss: 3.540 Vali Loss: 3.557 Vali Acc: 0.043 Test Loss: 3.557 Test Acc: 0.043
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 3.5940869
	speed: 0.5102s/iter; left time: 9500.1277s
	iters: 200, epoch: 11 | loss: 3.5394213
	speed: 0.1564s/iter; left time: 2896.0741s
Epoch: 11 cost time: 34.780391454696655
Epoch: 11, Steps: 208 | Train Loss: 3.559 Vali Loss: 3.566 Vali Acc: 0.051 Test Loss: 3.566 Test Acc: 0.051
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 3.7490752
	speed: 0.5780s/iter; left time: 10642.2288s
	iters: 200, epoch: 12 | loss: 3.5908976
	speed: 0.1513s/iter; left time: 2770.5804s
Epoch: 12 cost time: 33.93587899208069
Epoch: 12, Steps: 208 | Train Loss: 3.544 Vali Loss: 3.543 Vali Acc: 0.048 Test Loss: 3.543 Test Acc: 0.048
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 3.5683367
	speed: 0.5197s/iter; left time: 9461.1500s
	iters: 200, epoch: 13 | loss: 3.7913759
	speed: 0.1678s/iter; left time: 3038.7894s
Epoch: 13 cost time: 34.76299977302551
Epoch: 13, Steps: 208 | Train Loss: 3.555 Vali Loss: 3.537 Vali Acc: 0.052 Test Loss: 3.537 Test Acc: 0.052
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 3.3792787
	speed: 0.5191s/iter; left time: 9342.0875s
	iters: 200, epoch: 14 | loss: 3.6849754
	speed: 0.1475s/iter; left time: 2640.0057s
Epoch: 14 cost time: 33.19188475608826
Epoch: 14, Steps: 208 | Train Loss: 3.562 Vali Loss: 3.500 Vali Acc: 0.060 Test Loss: 3.500 Test Acc: 0.060
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 3.4689503
	speed: 0.5259s/iter; left time: 9355.8066s
	iters: 200, epoch: 15 | loss: 3.2979462
	speed: 0.1599s/iter; left time: 2828.2486s
Epoch: 15 cost time: 35.02051854133606
Epoch: 15, Steps: 208 | Train Loss: 3.529 Vali Loss: 3.492 Vali Acc: 0.051 Test Loss: 3.492 Test Acc: 0.051
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 3.6787381
	speed: 0.5184s/iter; left time: 9114.0900s
	iters: 200, epoch: 16 | loss: 3.6243439
	speed: 0.1596s/iter; left time: 2789.4929s
Epoch: 16 cost time: 33.45866417884827
Epoch: 16, Steps: 208 | Train Loss: 3.603 Vali Loss: 3.672 Vali Acc: 0.026 Test Loss: 3.672 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 3.6937706
	speed: 0.5448s/iter; left time: 9465.0290s
	iters: 200, epoch: 17 | loss: 3.7744586
	speed: 0.1644s/iter; left time: 2839.2553s
Epoch: 17 cost time: 36.60100507736206
Epoch: 17, Steps: 208 | Train Loss: 3.688 Vali Loss: 3.675 Vali Acc: 0.026 Test Loss: 3.675 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10289293170295258
model parameter : 3783011
model size : 17.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6795890
	speed: 0.1873s/iter; left time: 3876.9731s
	iters: 200, epoch: 1 | loss: 3.9695535
	speed: 0.1495s/iter; left time: 3079.8113s
Epoch: 1 cost time: 34.995628118515015
Epoch: 1, Steps: 208 | Train Loss: 3.822 Vali Loss: 3.721 Vali Acc: 0.045 Test Loss: 3.721 Test Acc: 0.045
Validation loss decreased (inf --> -0.044699).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7338777
	speed: 0.4495s/iter; left time: 9212.5431s
	iters: 200, epoch: 2 | loss: 3.4852183
	speed: 0.1490s/iter; left time: 3038.7041s
Epoch: 2 cost time: 31.712255716323853
Epoch: 2, Steps: 208 | Train Loss: 3.640 Vali Loss: 3.567 Vali Acc: 0.057 Test Loss: 3.567 Test Acc: 0.057
Validation loss decreased (-0.044699 --> -0.057226).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4017925
	speed: 0.4468s/iter; left time: 9062.3796s
	iters: 200, epoch: 3 | loss: 3.7097964
	speed: 0.1410s/iter; left time: 2846.7149s
Epoch: 3 cost time: 29.489989757537842
Epoch: 3, Steps: 208 | Train Loss: 3.558 Vali Loss: 3.528 Vali Acc: 0.053 Test Loss: 3.528 Test Acc: 0.053
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.1921597
	speed: 0.4537s/iter; left time: 9108.9200s
	iters: 200, epoch: 4 | loss: 3.4811623
	speed: 0.1509s/iter; left time: 3015.3129s
Epoch: 4 cost time: 31.276943683624268
Epoch: 4, Steps: 208 | Train Loss: 3.428 Vali Loss: 3.276 Vali Acc: 0.083 Test Loss: 3.276 Test Acc: 0.083
Validation loss decreased (-0.057226 --> -0.082580).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2526472
	speed: 0.4841s/iter; left time: 9619.1078s
	iters: 200, epoch: 5 | loss: 3.1088026
	speed: 0.1594s/iter; left time: 3150.5798s
Epoch: 5 cost time: 33.94920539855957
Epoch: 5, Steps: 208 | Train Loss: 3.229 Vali Loss: 3.211 Vali Acc: 0.098 Test Loss: 3.211 Test Acc: 0.098
Validation loss decreased (-0.082580 --> -0.098089).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.3626370
	speed: 0.5080s/iter; left time: 9987.0231s
	iters: 200, epoch: 6 | loss: 2.9651244
	speed: 0.1508s/iter; left time: 2950.3852s
Epoch: 6 cost time: 33.117557764053345
Epoch: 6, Steps: 208 | Train Loss: 3.132 Vali Loss: 3.155 Vali Acc: 0.103 Test Loss: 3.155 Test Acc: 0.103
Validation loss decreased (-0.098089 --> -0.103458).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9604220
	speed: 0.5137s/iter; left time: 9992.8586s
	iters: 200, epoch: 7 | loss: 2.8798385
	speed: 0.1495s/iter; left time: 2893.2680s
Epoch: 7 cost time: 34.142534017562866
Epoch: 7, Steps: 208 | Train Loss: 3.060 Vali Loss: 3.128 Vali Acc: 0.098 Test Loss: 3.128 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 3.0872841
	speed: 0.4888s/iter; left time: 9406.7928s
	iters: 200, epoch: 8 | loss: 3.1780965
	speed: 0.1904s/iter; left time: 3646.1147s
Epoch: 8 cost time: 40.185890197753906
Epoch: 8, Steps: 208 | Train Loss: 3.001 Vali Loss: 3.149 Vali Acc: 0.112 Test Loss: 3.149 Test Acc: 0.112
Validation loss decreased (-0.103458 --> -0.112405).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.7137825
	speed: 0.5607s/iter; left time: 10673.3862s
	iters: 200, epoch: 9 | loss: 3.1697497
	speed: 0.1740s/iter; left time: 3294.9583s
Epoch: 9 cost time: 37.75437068939209
Epoch: 9, Steps: 208 | Train Loss: 3.003 Vali Loss: 3.127 Vali Acc: 0.106 Test Loss: 3.127 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.9480622
	speed: 0.5229s/iter; left time: 9845.1462s
	iters: 200, epoch: 10 | loss: 3.0983727
	speed: 0.1865s/iter; left time: 3493.4320s
Epoch: 10 cost time: 40.22065496444702
Epoch: 10, Steps: 208 | Train Loss: 2.957 Vali Loss: 3.220 Vali Acc: 0.094 Test Loss: 3.220 Test Acc: 0.094
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.9250469
	speed: 0.4695s/iter; left time: 8741.8307s
	iters: 200, epoch: 11 | loss: 3.2922549
	speed: 0.1933s/iter; left time: 3580.7676s
Epoch: 11 cost time: 37.26095676422119
Epoch: 11, Steps: 208 | Train Loss: 3.045 Vali Loss: 3.219 Vali Acc: 0.100 Test Loss: 3.219 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 3.1848264
	speed: 0.5762s/iter; left time: 10609.9907s
	iters: 200, epoch: 12 | loss: 2.5755417
	speed: 0.1899s/iter; left time: 3477.9895s
Epoch: 12 cost time: 41.318687200546265
Epoch: 12, Steps: 208 | Train Loss: 2.986 Vali Loss: 3.207 Vali Acc: 0.109 Test Loss: 3.207 Test Acc: 0.109
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 2.7136340
	speed: 0.6127s/iter; left time: 11153.7568s
	iters: 200, epoch: 13 | loss: 3.7148831
	speed: 0.1867s/iter; left time: 3381.0702s
Epoch: 13 cost time: 42.53289556503296
Epoch: 13, Steps: 208 | Train Loss: 3.019 Vali Loss: 3.202 Vali Acc: 0.104 Test Loss: 3.202 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 2.8611479
	speed: 0.5488s/iter; left time: 9877.2729s
	iters: 200, epoch: 14 | loss: 3.2023182
	speed: 0.1688s/iter; left time: 3020.5853s
Epoch: 14 cost time: 36.40121078491211
Epoch: 14, Steps: 208 | Train Loss: 3.029 Vali Loss: 3.252 Vali Acc: 0.090 Test Loss: 3.252 Test Acc: 0.090
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 3.6320691
	speed: 0.5475s/iter; left time: 9739.1623s
	iters: 200, epoch: 15 | loss: 2.3343318
	speed: 0.1758s/iter; left time: 3110.3165s
Epoch: 15 cost time: 37.92074799537659
Epoch: 15, Steps: 208 | Train Loss: 3.107 Vali Loss: 3.236 Vali Acc: 0.086 Test Loss: 3.236 Test Acc: 0.086
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 3.1450024
	speed: 0.5214s/iter; left time: 9166.8786s
	iters: 200, epoch: 16 | loss: 3.0513613
	speed: 0.1880s/iter; left time: 3286.7697s
Epoch: 16 cost time: 38.749882221221924
Epoch: 16, Steps: 208 | Train Loss: 3.074 Vali Loss: 3.330 Vali Acc: 0.087 Test Loss: 3.330 Test Acc: 0.087
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 3.3561046
	speed: 0.5460s/iter; left time: 9486.1919s
	iters: 200, epoch: 17 | loss: 3.1439793
	speed: 0.1565s/iter; left time: 2702.9296s
Epoch: 17 cost time: 35.37541460990906
Epoch: 17, Steps: 208 | Train Loss: 3.221 Vali Loss: 3.359 Vali Acc: 0.077 Test Loss: 3.359 Test Acc: 0.077
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 3.5675302
	speed: 0.5668s/iter; left time: 9728.8193s
	iters: 200, epoch: 18 | loss: 3.5361145
	speed: 0.2143s/iter; left time: 3656.8773s
Epoch: 18 cost time: 44.255038022994995
Epoch: 18, Steps: 208 | Train Loss: 3.437 Vali Loss: 3.452 Vali Acc: 0.076 Test Loss: 3.452 Test Acc: 0.076
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11243662391887861
model parameter : 3205091
model size : 14.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7839117
	speed: 0.2222s/iter; left time: 4599.2482s
	iters: 200, epoch: 1 | loss: 3.7215173
	speed: 0.1835s/iter; left time: 3781.0031s
Epoch: 1 cost time: 41.890316009521484
Epoch: 1, Steps: 208 | Train Loss: 3.798 Vali Loss: 3.764 Vali Acc: 0.060 Test Loss: 3.764 Test Acc: 0.060
Validation loss decreased (inf --> -0.060207).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7918475
	speed: 0.5617s/iter; left time: 11510.9306s
	iters: 200, epoch: 2 | loss: 3.8184705
	speed: 0.1758s/iter; left time: 3584.2204s
Epoch: 2 cost time: 36.734357595443726
Epoch: 2, Steps: 208 | Train Loss: 3.696 Vali Loss: 3.630 Vali Acc: 0.055 Test Loss: 3.630 Test Acc: 0.055
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.3903551
	speed: 0.5418s/iter; left time: 10990.7113s
	iters: 200, epoch: 3 | loss: 3.8579741
	speed: 0.1570s/iter; left time: 3168.1735s
Epoch: 3 cost time: 34.389408826828
Epoch: 3, Steps: 208 | Train Loss: 3.594 Vali Loss: 3.504 Vali Acc: 0.067 Test Loss: 3.504 Test Acc: 0.067
Validation loss decreased (-0.060207 --> -0.066771).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4537146
	speed: 0.5132s/iter; left time: 10302.8859s
	iters: 200, epoch: 4 | loss: 3.3353329
	speed: 0.1797s/iter; left time: 3589.0465s
Epoch: 4 cost time: 36.492753744125366
Epoch: 4, Steps: 208 | Train Loss: 3.473 Vali Loss: 3.565 Vali Acc: 0.066 Test Loss: 3.565 Test Acc: 0.066
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.5785089
	speed: 0.4948s/iter; left time: 9831.7102s
	iters: 200, epoch: 5 | loss: 3.2264395
	speed: 0.1540s/iter; left time: 3044.9956s
Epoch: 5 cost time: 33.644599199295044
Epoch: 5, Steps: 208 | Train Loss: 3.376 Vali Loss: 3.314 Vali Acc: 0.074 Test Loss: 3.314 Test Acc: 0.074
Validation loss decreased (-0.066771 --> -0.074229).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2894957
	speed: 0.5158s/iter; left time: 10141.4105s
	iters: 200, epoch: 6 | loss: 3.4540431
	speed: 0.1790s/iter; left time: 3501.4462s
Epoch: 6 cost time: 36.53275489807129
Epoch: 6, Steps: 208 | Train Loss: 3.283 Vali Loss: 3.334 Vali Acc: 0.091 Test Loss: 3.334 Test Acc: 0.091
Validation loss decreased (-0.074229 --> -0.091228).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.4976192
	speed: 0.5636s/iter; left time: 10963.0505s
	iters: 200, epoch: 7 | loss: 3.2187738
	speed: 0.1898s/iter; left time: 3673.8898s
Epoch: 7 cost time: 39.2465603351593
Epoch: 7, Steps: 208 | Train Loss: 3.216 Vali Loss: 3.453 Vali Acc: 0.077 Test Loss: 3.453 Test Acc: 0.077
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 3.0675054
	speed: 0.5252s/iter; left time: 10108.4152s
	iters: 200, epoch: 8 | loss: 3.8005254
	speed: 0.1602s/iter; left time: 3066.9808s
Epoch: 8 cost time: 35.689815282821655
Epoch: 8, Steps: 208 | Train Loss: 3.328 Vali Loss: 3.641 Vali Acc: 0.038 Test Loss: 3.641 Test Acc: 0.038
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 3.4275303
	speed: 0.5382s/iter; left time: 10246.1675s
	iters: 200, epoch: 9 | loss: 3.8127191
	speed: 0.1654s/iter; left time: 3131.7561s
Epoch: 9 cost time: 36.091830015182495
Epoch: 9, Steps: 208 | Train Loss: 3.632 Vali Loss: 3.556 Vali Acc: 0.051 Test Loss: 3.556 Test Acc: 0.051
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 3.5474193
	speed: 0.5475s/iter; left time: 10308.0352s
	iters: 200, epoch: 10 | loss: 3.3113914
	speed: 0.1843s/iter; left time: 3452.0112s
Epoch: 10 cost time: 37.98433017730713
Epoch: 10, Steps: 208 | Train Loss: 3.561 Vali Loss: 3.468 Vali Acc: 0.057 Test Loss: 3.468 Test Acc: 0.057
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 3.2858105
	speed: 0.4900s/iter; left time: 9123.5961s
	iters: 200, epoch: 11 | loss: 3.6170740
	speed: 0.1624s/iter; left time: 3007.7229s
Epoch: 11 cost time: 34.287126779556274
Epoch: 11, Steps: 208 | Train Loss: 3.520 Vali Loss: 3.581 Vali Acc: 0.040 Test Loss: 3.581 Test Acc: 0.040
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 3.6479483
	speed: 0.5053s/iter; left time: 9304.0705s
	iters: 200, epoch: 12 | loss: 3.8343377
	speed: 0.1745s/iter; left time: 3196.0987s
Epoch: 12 cost time: 34.73478055000305
Epoch: 12, Steps: 208 | Train Loss: 3.663 Vali Loss: 3.704 Vali Acc: 0.024 Test Loss: 3.704 Test Acc: 0.024
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 3.6382282
	speed: 0.5005s/iter; left time: 9112.2119s
	iters: 200, epoch: 13 | loss: 3.7288399
	speed: 0.1733s/iter; left time: 3137.2688s
Epoch: 13 cost time: 38.14173722267151
Epoch: 13, Steps: 208 | Train Loss: 3.687 Vali Loss: 3.677 Vali Acc: 0.026 Test Loss: 3.677 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 3.6512480
	speed: 0.5418s/iter; left time: 9750.9870s
	iters: 200, epoch: 14 | loss: 3.6688414
	speed: 0.1534s/iter; left time: 2745.5383s
Epoch: 14 cost time: 35.51934003829956
Epoch: 14, Steps: 208 | Train Loss: 3.682 Vali Loss: 3.673 Vali Acc: 0.026 Test Loss: 3.673 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 3.6382020
	speed: 0.5632s/iter; left time: 10018.1564s
	iters: 200, epoch: 15 | loss: 3.6480854
	speed: 0.1921s/iter; left time: 3398.1211s
Epoch: 15 cost time: 40.81137490272522
Epoch: 15, Steps: 208 | Train Loss: 3.680 Vali Loss: 3.675 Vali Acc: 0.026 Test Loss: 3.675 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 3.7061262
	speed: 0.5304s/iter; left time: 9324.7699s
	iters: 200, epoch: 16 | loss: 3.6822011
	speed: 0.1571s/iter; left time: 2746.0697s
Epoch: 16 cost time: 37.680126667022705
Epoch: 16, Steps: 208 | Train Loss: 3.677 Vali Loss: 3.678 Vali Acc: 0.026 Test Loss: 3.678 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09126155681479273
model parameter : 3200355
model size : 14.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8119040
	speed: 0.2087s/iter; left time: 4319.6266s
	iters: 200, epoch: 1 | loss: 3.9507077
	speed: 0.1584s/iter; left time: 3263.7114s
Epoch: 1 cost time: 37.96204948425293
Epoch: 1, Steps: 208 | Train Loss: 3.808 Vali Loss: 3.648 Vali Acc: 0.047 Test Loss: 3.648 Test Acc: 0.047
Validation loss decreased (inf --> -0.047384).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7870197
	speed: 0.4991s/iter; left time: 10229.0765s
	iters: 200, epoch: 2 | loss: 3.4231801
	speed: 0.1695s/iter; left time: 3455.6487s
Epoch: 2 cost time: 35.625216007232666
Epoch: 2, Steps: 208 | Train Loss: 3.618 Vali Loss: 3.604 Vali Acc: 0.057 Test Loss: 3.604 Test Acc: 0.057
Validation loss decreased (-0.047384 --> -0.056928).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6916738
	speed: 0.5272s/iter; left time: 10694.7359s
	iters: 200, epoch: 3 | loss: 3.3659348
	speed: 0.1835s/iter; left time: 3703.9887s
Epoch: 3 cost time: 38.106287240982056
Epoch: 3, Steps: 208 | Train Loss: 3.559 Vali Loss: 3.461 Vali Acc: 0.071 Test Loss: 3.461 Test Acc: 0.071
Validation loss decreased (-0.056928 --> -0.071245).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.5597992
	speed: 0.5168s/iter; left time: 10375.4621s
	iters: 200, epoch: 4 | loss: 3.0246377
	speed: 0.1546s/iter; left time: 3089.0346s
Epoch: 4 cost time: 35.97879147529602
Epoch: 4, Steps: 208 | Train Loss: 3.430 Vali Loss: 3.426 Vali Acc: 0.067 Test Loss: 3.426 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.4965849
	speed: 0.4759s/iter; left time: 9456.2688s
	iters: 200, epoch: 5 | loss: 2.5519421
	speed: 0.1754s/iter; left time: 3466.9016s
Epoch: 5 cost time: 35.433621406555176
Epoch: 5, Steps: 208 | Train Loss: 3.287 Vali Loss: 3.276 Vali Acc: 0.092 Test Loss: 3.276 Test Acc: 0.092
Validation loss decreased (-0.071245 --> -0.091825).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.1632628
	speed: 0.5203s/iter; left time: 10229.7413s
	iters: 200, epoch: 6 | loss: 3.5816689
	speed: 0.1500s/iter; left time: 2933.9701s
Epoch: 6 cost time: 33.444681882858276
Epoch: 6, Steps: 208 | Train Loss: 3.145 Vali Loss: 3.221 Vali Acc: 0.116 Test Loss: 3.221 Test Acc: 0.116
Validation loss decreased (-0.091825 --> -0.116282).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.2884502
	speed: 0.5154s/iter; left time: 10025.5904s
	iters: 200, epoch: 7 | loss: 3.3931634
	speed: 0.1802s/iter; left time: 3487.3488s
Epoch: 7 cost time: 39.27301263809204
Epoch: 7, Steps: 208 | Train Loss: 3.099 Vali Loss: 3.168 Vali Acc: 0.103 Test Loss: 3.168 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.7334514
	speed: 0.4978s/iter; left time: 9580.7350s
	iters: 200, epoch: 8 | loss: 3.1162698
	speed: 0.1639s/iter; left time: 3137.2741s
Epoch: 8 cost time: 34.08674240112305
Epoch: 8, Steps: 208 | Train Loss: 3.102 Vali Loss: 3.222 Vali Acc: 0.096 Test Loss: 3.222 Test Acc: 0.096
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 3.2746153
	speed: 0.5338s/iter; left time: 10161.3258s
	iters: 200, epoch: 9 | loss: 3.3608599
	speed: 0.1685s/iter; left time: 3191.2198s
Epoch: 9 cost time: 36.772698640823364
Epoch: 9, Steps: 208 | Train Loss: 3.141 Vali Loss: 3.197 Vali Acc: 0.099 Test Loss: 3.197 Test Acc: 0.099
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 2.9645419
	speed: 0.4841s/iter; left time: 9116.0478s
	iters: 200, epoch: 10 | loss: 2.9639509
	speed: 0.1598s/iter; left time: 2992.9288s
Epoch: 10 cost time: 33.461007833480835
Epoch: 10, Steps: 208 | Train Loss: 3.186 Vali Loss: 3.334 Vali Acc: 0.081 Test Loss: 3.334 Test Acc: 0.081
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 2.8258028
	speed: 0.5474s/iter; left time: 10192.6789s
	iters: 200, epoch: 11 | loss: 3.1650100
	speed: 0.1927s/iter; left time: 3569.3377s
Epoch: 11 cost time: 40.40865182876587
Epoch: 11, Steps: 208 | Train Loss: 3.218 Vali Loss: 3.226 Vali Acc: 0.095 Test Loss: 3.226 Test Acc: 0.095
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 3.0178821
	speed: 0.4823s/iter; left time: 8879.8597s
	iters: 200, epoch: 12 | loss: 3.3771775
	speed: 0.1680s/iter; left time: 3076.0117s
Epoch: 12 cost time: 35.18017053604126
Epoch: 12, Steps: 208 | Train Loss: 3.178 Vali Loss: 3.269 Vali Acc: 0.084 Test Loss: 3.269 Test Acc: 0.084
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 2.7763960
	speed: 0.4941s/iter; left time: 8995.0003s
	iters: 200, epoch: 13 | loss: 3.2516594
	speed: 0.1775s/iter; left time: 3213.1530s
Epoch: 13 cost time: 38.68053126335144
Epoch: 13, Steps: 208 | Train Loss: 3.193 Vali Loss: 3.301 Vali Acc: 0.083 Test Loss: 3.301 Test Acc: 0.083
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 3.5202386
	speed: 0.4990s/iter; left time: 8980.4819s
	iters: 200, epoch: 14 | loss: 3.4251409
	speed: 0.1285s/iter; left time: 2300.3798s
Epoch: 14 cost time: 29.465197801589966
Epoch: 14, Steps: 208 | Train Loss: 3.281 Vali Loss: 3.276 Vali Acc: 0.076 Test Loss: 3.276 Test Acc: 0.076
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 3.0115557
	speed: 0.5313s/iter; left time: 9450.9305s
	iters: 200, epoch: 15 | loss: 3.4319680
	speed: 0.1685s/iter; left time: 2980.9096s
Epoch: 15 cost time: 37.10175275802612
Epoch: 15, Steps: 208 | Train Loss: 3.272 Vali Loss: 3.336 Vali Acc: 0.078 Test Loss: 3.336 Test Acc: 0.078
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 3.1887898
	speed: 0.4836s/iter; left time: 8502.3109s
	iters: 200, epoch: 16 | loss: 3.3933353
	speed: 0.1455s/iter; left time: 2544.2497s
Epoch: 16 cost time: 33.23591756820679
Epoch: 16, Steps: 208 | Train Loss: 3.280 Vali Loss: 3.321 Vali Acc: 0.089 Test Loss: 3.321 Test Acc: 0.089
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11631374888159857
model parameter : 3195619
model size : 14.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7018523
	speed: 0.1908s/iter; left time: 3950.1789s
	iters: 200, epoch: 1 | loss: 3.7984161
	speed: 0.1766s/iter; left time: 3637.9845s
Epoch: 1 cost time: 38.25906038284302
Epoch: 1, Steps: 208 | Train Loss: 3.807 Vali Loss: 3.744 Vali Acc: 0.054 Test Loss: 3.744 Test Acc: 0.054
Validation loss decreased (inf --> -0.053646).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7751074
	speed: 0.5157s/iter; left time: 10569.2447s
	iters: 200, epoch: 2 | loss: 3.1703200
	speed: 0.1606s/iter; left time: 3275.7584s
Epoch: 2 cost time: 36.42568492889404
Epoch: 2, Steps: 208 | Train Loss: 3.669 Vali Loss: 3.651 Vali Acc: 0.052 Test Loss: 3.651 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.1042798
	speed: 0.4776s/iter; left time: 9688.0783s
	iters: 200, epoch: 3 | loss: 3.6133795
	speed: 0.1582s/iter; left time: 3193.8383s
Epoch: 3 cost time: 32.47034764289856
Epoch: 3, Steps: 208 | Train Loss: 3.589 Vali Loss: 3.670 Vali Acc: 0.048 Test Loss: 3.670 Test Acc: 0.048
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 3.4679072
	speed: 0.4606s/iter; left time: 9247.7410s
	iters: 200, epoch: 4 | loss: 3.5258145
	speed: 0.1616s/iter; left time: 3228.0967s
Epoch: 4 cost time: 34.52341675758362
Epoch: 4, Steps: 208 | Train Loss: 3.561 Vali Loss: 3.550 Vali Acc: 0.061 Test Loss: 3.550 Test Acc: 0.061
Validation loss decreased (-0.053646 --> -0.060507).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.9949861
	speed: 0.4589s/iter; left time: 9118.1525s
	iters: 200, epoch: 5 | loss: 3.7506816
	speed: 0.1738s/iter; left time: 3435.7578s
Epoch: 5 cost time: 34.32329249382019
Epoch: 5, Steps: 208 | Train Loss: 3.724 Vali Loss: 3.714 Vali Acc: 0.025 Test Loss: 3.714 Test Acc: 0.025
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.6709414
	speed: 0.4953s/iter; left time: 9738.4598s
	iters: 200, epoch: 6 | loss: 3.8825004
	speed: 0.1343s/iter; left time: 2627.1054s
Epoch: 6 cost time: 31.8534996509552
Epoch: 6, Steps: 208 | Train Loss: 3.741 Vali Loss: 3.711 Vali Acc: 0.026 Test Loss: 3.711 Test Acc: 0.026
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 3.6753027
	speed: 0.5140s/iter; left time: 9998.2382s
	iters: 200, epoch: 7 | loss: 3.7344570
	speed: 0.1769s/iter; left time: 3422.9004s
Epoch: 7 cost time: 37.58625841140747
Epoch: 7, Steps: 208 | Train Loss: 3.726 Vali Loss: 3.672 Vali Acc: 0.025 Test Loss: 3.672 Test Acc: 0.025
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 3.6922224
	speed: 0.4982s/iter; left time: 9587.2047s
	iters: 200, epoch: 8 | loss: 3.6947217
	speed: 0.1600s/iter; left time: 3063.3573s
Epoch: 8 cost time: 32.54733681678772
Epoch: 8, Steps: 208 | Train Loss: 3.693 Vali Loss: 3.677 Vali Acc: 0.026 Test Loss: 3.677 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 3.7527754
	speed: 0.5368s/iter; left time: 10218.1943s
	iters: 200, epoch: 9 | loss: 3.6470368
	speed: 0.1800s/iter; left time: 3409.2855s
Epoch: 9 cost time: 39.300883531570435
Epoch: 9, Steps: 208 | Train Loss: 3.688 Vali Loss: 3.696 Vali Acc: 0.026 Test Loss: 3.696 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 3.7490883
	speed: 0.5187s/iter; left time: 9767.2858s
	iters: 200, epoch: 10 | loss: 3.6915419
	speed: 0.1579s/iter; left time: 2956.7081s
Epoch: 10 cost time: 35.03762698173523
Epoch: 10, Steps: 208 | Train Loss: 3.683 Vali Loss: 3.688 Vali Acc: 0.026 Test Loss: 3.688 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 3.6588054
	speed: 0.5390s/iter; left time: 10036.6748s
	iters: 200, epoch: 11 | loss: 3.6044056
	speed: 0.1753s/iter; left time: 3246.7777s
Epoch: 11 cost time: 38.14894151687622
Epoch: 11, Steps: 208 | Train Loss: 3.682 Vali Loss: 3.679 Vali Acc: 0.026 Test Loss: 3.679 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 3.6349220
	speed: 0.5445s/iter; left time: 10026.4915s
	iters: 200, epoch: 12 | loss: 3.7119436
	speed: 0.1863s/iter; left time: 3412.0492s
Epoch: 12 cost time: 38.90518236160278
Epoch: 12, Steps: 208 | Train Loss: 3.682 Vali Loss: 3.675 Vali Acc: 0.026 Test Loss: 3.675 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 3.6267765
	speed: 0.5125s/iter; left time: 9330.3043s
	iters: 200, epoch: 13 | loss: 3.7089796
	speed: 0.1543s/iter; left time: 2793.6201s
Epoch: 13 cost time: 33.05522537231445
Epoch: 13, Steps: 208 | Train Loss: 3.683 Vali Loss: 3.669 Vali Acc: 0.026 Test Loss: 3.669 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 3.6211898
	speed: 0.5645s/iter; left time: 10158.4907s
	iters: 200, epoch: 14 | loss: 3.6940820
	speed: 0.1855s/iter; left time: 3319.9717s
Epoch: 14 cost time: 39.132694482803345
Epoch: 14, Steps: 208 | Train Loss: 3.677 Vali Loss: 3.680 Vali Acc: 0.026 Test Loss: 3.680 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.060542797494780795
model parameter : 3190883
model size : 14.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6879730
	speed: 0.1844s/iter; left time: 3816.9493s
	iters: 200, epoch: 1 | loss: 4.1587992
	speed: 0.1662s/iter; left time: 3424.0374s
Epoch: 1 cost time: 36.664310693740845
Epoch: 1, Steps: 208 | Train Loss: 3.799 Vali Loss: 3.696 Vali Acc: 0.051 Test Loss: 3.696 Test Acc: 0.051
Validation loss decreased (inf --> -0.050664).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4725730
	speed: 0.5093s/iter; left time: 10436.3481s
	iters: 200, epoch: 2 | loss: 3.3931897
	speed: 0.1385s/iter; left time: 2824.0715s
Epoch: 2 cost time: 33.4926962852478
Epoch: 2, Steps: 208 | Train Loss: 3.633 Vali Loss: 3.575 Vali Acc: 0.056 Test Loss: 3.575 Test Acc: 0.056
Validation loss decreased (-0.050664 --> -0.056033).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.8023615
	speed: 0.5059s/iter; left time: 10262.5027s
	iters: 200, epoch: 3 | loss: 3.5661349
	speed: 0.1796s/iter; left time: 3625.4337s
Epoch: 3 cost time: 37.980417251586914
Epoch: 3, Steps: 208 | Train Loss: 3.520 Vali Loss: 3.447 Vali Acc: 0.057 Test Loss: 3.447 Test Acc: 0.057
Validation loss decreased (-0.056033 --> -0.056929).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2547927
	speed: 0.5553s/iter; left time: 11149.5508s
	iters: 200, epoch: 4 | loss: 3.5800645
	speed: 0.1871s/iter; left time: 3737.9344s
Epoch: 4 cost time: 39.54485368728638
Epoch: 4, Steps: 208 | Train Loss: 3.378 Vali Loss: 3.313 Vali Acc: 0.067 Test Loss: 3.313 Test Acc: 0.067
Validation loss decreased (-0.056929 --> -0.067071).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.4255176
	speed: 0.5650s/iter; left time: 11226.1437s
	iters: 200, epoch: 5 | loss: 3.0308447
	speed: 0.1911s/iter; left time: 3777.2223s
Epoch: 5 cost time: 40.95107579231262
Epoch: 5, Steps: 208 | Train Loss: 3.230 Vali Loss: 3.199 Vali Acc: 0.089 Test Loss: 3.199 Test Acc: 0.089
Validation loss decreased (-0.067071 --> -0.089440).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0827389
	speed: 0.5645s/iter; left time: 11098.5251s
	iters: 200, epoch: 6 | loss: 2.9560497
	speed: 0.1899s/iter; left time: 3713.8586s
Epoch: 6 cost time: 39.14301085472107
Epoch: 6, Steps: 208 | Train Loss: 3.134 Vali Loss: 3.284 Vali Acc: 0.094 Test Loss: 3.284 Test Acc: 0.094
Validation loss decreased (-0.089440 --> -0.093615).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.3305140
	speed: 0.6024s/iter; left time: 11717.9452s
	iters: 200, epoch: 7 | loss: 2.7430878
	speed: 0.1803s/iter; left time: 3489.8665s
Epoch: 7 cost time: 39.25783181190491
Epoch: 7, Steps: 208 | Train Loss: 3.071 Vali Loss: 3.253 Vali Acc: 0.094 Test Loss: 3.253 Test Acc: 0.094
Validation loss decreased (-0.093615 --> -0.093913).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.0841441
	speed: 0.5396s/iter; left time: 10385.5551s
	iters: 200, epoch: 8 | loss: 3.0460997
	speed: 0.1609s/iter; left time: 3079.5181s
Epoch: 8 cost time: 35.65151858329773
Epoch: 8, Steps: 208 | Train Loss: 3.041 Vali Loss: 3.213 Vali Acc: 0.106 Test Loss: 3.213 Test Acc: 0.106
Validation loss decreased (-0.093913 --> -0.105843).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.4731035
	speed: 0.5207s/iter; left time: 9912.5458s
	iters: 200, epoch: 9 | loss: 3.2672875
	speed: 0.1761s/iter; left time: 3335.4844s
Epoch: 9 cost time: 36.84648847579956
Epoch: 9, Steps: 208 | Train Loss: 2.977 Vali Loss: 3.116 Vali Acc: 0.106 Test Loss: 3.116 Test Acc: 0.106
Validation loss decreased (-0.105843 --> -0.106441).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.9873223
	speed: 0.5923s/iter; left time: 11152.0165s
	iters: 200, epoch: 10 | loss: 2.8888087
	speed: 0.1858s/iter; left time: 3480.4247s
Epoch: 10 cost time: 40.659568071365356
Epoch: 10, Steps: 208 | Train Loss: 2.974 Vali Loss: 3.183 Vali Acc: 0.094 Test Loss: 3.183 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 3.3640041
	speed: 0.5598s/iter; left time: 10424.7391s
	iters: 200, epoch: 11 | loss: 3.1498072
	speed: 0.1827s/iter; left time: 3382.9786s
Epoch: 11 cost time: 40.74189352989197
Epoch: 11, Steps: 208 | Train Loss: 3.001 Vali Loss: 3.172 Vali Acc: 0.101 Test Loss: 3.172 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 3.3163466
	speed: 0.5677s/iter; left time: 10453.1665s
	iters: 200, epoch: 12 | loss: 3.1476467
	speed: 0.1672s/iter; left time: 3062.2005s
Epoch: 12 cost time: 38.08169865608215
Epoch: 12, Steps: 208 | Train Loss: 2.989 Vali Loss: 3.232 Vali Acc: 0.094 Test Loss: 3.232 Test Acc: 0.094
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 2.8038027
	speed: 0.5931s/iter; left time: 10796.6520s
	iters: 200, epoch: 13 | loss: 2.5717740
	speed: 0.1774s/iter; left time: 3211.4760s
Epoch: 13 cost time: 39.66229248046875
Epoch: 13, Steps: 208 | Train Loss: 3.006 Vali Loss: 3.165 Vali Acc: 0.106 Test Loss: 3.165 Test Acc: 0.106
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 3.1539769
	speed: 0.5970s/iter; left time: 10743.4218s
	iters: 200, epoch: 14 | loss: 3.6877489
	speed: 0.1918s/iter; left time: 3433.2498s
Epoch: 14 cost time: 40.97941851615906
Epoch: 14, Steps: 208 | Train Loss: 2.957 Vali Loss: 3.120 Vali Acc: 0.117 Test Loss: 3.120 Test Acc: 0.117
Validation loss decreased (-0.106441 --> -0.116581).  Saving model ...
	iters: 100, epoch: 15 | loss: 2.7693236
	speed: 0.5844s/iter; left time: 10396.1103s
	iters: 200, epoch: 15 | loss: 3.1764169
	speed: 0.1805s/iter; left time: 3192.6352s
Epoch: 15 cost time: 39.974098682403564
Epoch: 15, Steps: 208 | Train Loss: 3.010 Vali Loss: 3.256 Vali Acc: 0.092 Test Loss: 3.256 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 2.9405978
	speed: 0.5893s/iter; left time: 10360.7146s
	iters: 200, epoch: 16 | loss: 2.7572019
	speed: 0.1998s/iter; left time: 3493.1258s
Epoch: 16 cost time: 43.36450505256653
Epoch: 16, Steps: 208 | Train Loss: 3.108 Vali Loss: 3.218 Vali Acc: 0.104 Test Loss: 3.218 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 3.1341658
	speed: 0.5310s/iter; left time: 9224.5941s
	iters: 200, epoch: 17 | loss: 3.2741165
	speed: 0.1565s/iter; left time: 2702.8038s
Epoch: 17 cost time: 34.2514488697052
Epoch: 17, Steps: 208 | Train Loss: 3.099 Vali Loss: 3.379 Vali Acc: 0.071 Test Loss: 3.379 Test Acc: 0.071
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 3.2782848
	speed: 0.5450s/iter; left time: 9354.6301s
	iters: 200, epoch: 18 | loss: 2.9407606
	speed: 0.1768s/iter; left time: 3017.3928s
Epoch: 18 cost time: 38.02487063407898
Epoch: 18, Steps: 208 | Train Loss: 3.230 Vali Loss: 3.313 Vali Acc: 0.086 Test Loss: 3.313 Test Acc: 0.086
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 3.3835027
	speed: 0.5330s/iter; left time: 9037.2467s
	iters: 200, epoch: 19 | loss: 3.2247727
	speed: 0.1912s/iter; left time: 3222.2678s
Epoch: 19 cost time: 40.3487811088562
Epoch: 19, Steps: 208 | Train Loss: 3.275 Vali Loss: 3.374 Vali Acc: 0.070 Test Loss: 3.374 Test Acc: 0.070
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 3.6174107
	speed: 0.5798s/iter; left time: 9711.7907s
	iters: 200, epoch: 20 | loss: 3.4392009
	speed: 0.1680s/iter; left time: 2796.3550s
Epoch: 20 cost time: 37.64275097846985
Epoch: 20, Steps: 208 | Train Loss: 3.359 Vali Loss: 3.445 Vali Acc: 0.061 Test Loss: 3.445 Test Acc: 0.061
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 3.4690690
	speed: 0.5738s/iter; left time: 9490.6322s
	iters: 200, epoch: 21 | loss: 3.4662189
	speed: 0.1877s/iter; left time: 3085.7768s
Epoch: 21 cost time: 40.5098237991333
Epoch: 21, Steps: 208 | Train Loss: 3.386 Vali Loss: 3.409 Vali Acc: 0.062 Test Loss: 3.409 Test Acc: 0.062
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 3.2405975
	speed: 0.5252s/iter; left time: 8578.0482s
	iters: 200, epoch: 22 | loss: 3.0922456
	speed: 0.1795s/iter; left time: 2913.6441s
Epoch: 22 cost time: 38.43938374519348
Epoch: 22, Steps: 208 | Train Loss: 3.307 Vali Loss: 3.371 Vali Acc: 0.080 Test Loss: 3.371 Test Acc: 0.080
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 3.3126543
	speed: 0.5691s/iter; left time: 9176.9289s
	iters: 200, epoch: 23 | loss: 3.5028627
	speed: 0.1609s/iter; left time: 2578.5111s
Epoch: 23 cost time: 37.575772523880005
Epoch: 23, Steps: 208 | Train Loss: 3.299 Vali Loss: 3.468 Vali Acc: 0.059 Test Loss: 3.468 Test Acc: 0.059
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 3.5879622
	speed: 0.5556s/iter; left time: 8843.8588s
	iters: 200, epoch: 24 | loss: 3.2881439
	speed: 0.1959s/iter; left time: 3098.6808s
Epoch: 24 cost time: 40.58493137359619
Epoch: 24, Steps: 208 | Train Loss: 3.426 Vali Loss: 3.406 Vali Acc: 0.074 Test Loss: 3.406 Test Acc: 0.074
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11661198926334626
model parameter : 2909027
model size : 13.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1792102
	speed: 0.2146s/iter; left time: 4442.0509s
	iters: 200, epoch: 1 | loss: 3.8512633
	speed: 0.1642s/iter; left time: 3381.7462s
Epoch: 1 cost time: 39.168437004089355
Epoch: 1, Steps: 208 | Train Loss: 3.800 Vali Loss: 3.703 Vali Acc: 0.045 Test Loss: 3.703 Test Acc: 0.045
Validation loss decreased (inf --> -0.044699).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6860964
	speed: 0.5415s/iter; left time: 11096.6932s
	iters: 200, epoch: 2 | loss: 3.2971718
	speed: 0.1679s/iter; left time: 3423.8061s
Epoch: 2 cost time: 35.40209364891052
Epoch: 2, Steps: 208 | Train Loss: 3.632 Vali Loss: 3.644 Vali Acc: 0.048 Test Loss: 3.644 Test Acc: 0.048
Validation loss decreased (-0.044699 --> -0.047980).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4862289
	speed: 0.5176s/iter; left time: 10499.3756s
	iters: 200, epoch: 3 | loss: 3.2260892
	speed: 0.1594s/iter; left time: 3216.9072s
Epoch: 3 cost time: 34.487985134124756
Epoch: 3, Steps: 208 | Train Loss: 3.546 Vali Loss: 3.597 Vali Acc: 0.052 Test Loss: 3.597 Test Acc: 0.052
Validation loss decreased (-0.047980 --> -0.052454).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4476328
	speed: 0.5309s/iter; left time: 10659.0849s
	iters: 200, epoch: 4 | loss: 3.6483924
	speed: 0.1763s/iter; left time: 3522.2219s
Epoch: 4 cost time: 36.45122694969177
Epoch: 4, Steps: 208 | Train Loss: 3.417 Vali Loss: 3.381 Vali Acc: 0.071 Test Loss: 3.381 Test Acc: 0.071
Validation loss decreased (-0.052454 --> -0.070947).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.4089811
	speed: 0.5317s/iter; left time: 10565.1301s
	iters: 200, epoch: 5 | loss: 2.8098276
	speed: 0.1789s/iter; left time: 3536.0118s
Epoch: 5 cost time: 36.512898683547974
Epoch: 5, Steps: 208 | Train Loss: 3.278 Vali Loss: 3.253 Vali Acc: 0.092 Test Loss: 3.253 Test Acc: 0.092
Validation loss decreased (-0.070947 --> -0.092124).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.1293991
	speed: 0.5608s/iter; left time: 11025.9305s
	iters: 200, epoch: 6 | loss: 3.4538207
	speed: 0.1620s/iter; left time: 3169.3820s
Epoch: 6 cost time: 35.98615312576294
Epoch: 6, Steps: 208 | Train Loss: 3.161 Vali Loss: 3.212 Vali Acc: 0.102 Test Loss: 3.212 Test Acc: 0.102
Validation loss decreased (-0.092124 --> -0.102264).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.0532906
	speed: 0.5566s/iter; left time: 10828.2753s
	iters: 200, epoch: 7 | loss: 2.9775410
	speed: 0.1805s/iter; left time: 3493.0714s
Epoch: 7 cost time: 36.926852226257324
Epoch: 7, Steps: 208 | Train Loss: 3.103 Vali Loss: 3.179 Vali Acc: 0.112 Test Loss: 3.179 Test Acc: 0.112
Validation loss decreased (-0.102264 --> -0.111808).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.2203009
	speed: 0.5384s/iter; left time: 10361.3205s
	iters: 200, epoch: 8 | loss: 2.7962961
	speed: 0.1757s/iter; left time: 3364.6035s
Epoch: 8 cost time: 37.15335178375244
Epoch: 8, Steps: 208 | Train Loss: 3.070 Vali Loss: 3.136 Vali Acc: 0.100 Test Loss: 3.136 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 3.2518754
	speed: 0.5599s/iter; left time: 10659.2162s
	iters: 200, epoch: 9 | loss: 2.7839403
	speed: 0.1750s/iter; left time: 3313.5684s
Epoch: 9 cost time: 36.6192364692688
Epoch: 9, Steps: 208 | Train Loss: 3.077 Vali Loss: 3.190 Vali Acc: 0.100 Test Loss: 3.190 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 2.8318601
	speed: 0.5230s/iter; left time: 9846.9298s
	iters: 200, epoch: 10 | loss: 3.1257167
	speed: 0.1704s/iter; left time: 3191.5673s
Epoch: 10 cost time: 35.69791531562805
Epoch: 10, Steps: 208 | Train Loss: 3.057 Vali Loss: 3.289 Vali Acc: 0.089 Test Loss: 3.289 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 2.9928658
	speed: 0.5642s/iter; left time: 10506.0110s
	iters: 200, epoch: 11 | loss: 3.2799277
	speed: 0.1719s/iter; left time: 3183.4069s
Epoch: 11 cost time: 37.359599113464355
Epoch: 11, Steps: 208 | Train Loss: 3.043 Vali Loss: 3.291 Vali Acc: 0.095 Test Loss: 3.291 Test Acc: 0.095
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 3.6606529
	speed: 0.5543s/iter; left time: 10205.5965s
	iters: 200, epoch: 12 | loss: 2.9599662
	speed: 0.1827s/iter; left time: 3346.5542s
Epoch: 12 cost time: 39.17484259605408
Epoch: 12, Steps: 208 | Train Loss: 3.031 Vali Loss: 3.241 Vali Acc: 0.096 Test Loss: 3.241 Test Acc: 0.096
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 3.0587184
	speed: 0.5164s/iter; left time: 9401.3077s
	iters: 200, epoch: 13 | loss: 2.9772325
	speed: 0.1690s/iter; left time: 3059.9197s
Epoch: 13 cost time: 36.20907640457153
Epoch: 13, Steps: 208 | Train Loss: 3.008 Vali Loss: 3.206 Vali Acc: 0.100 Test Loss: 3.206 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 2.8861806
	speed: 0.4860s/iter; left time: 8746.5400s
	iters: 200, epoch: 14 | loss: 2.9279809
	speed: 0.1530s/iter; left time: 2739.0757s
Epoch: 14 cost time: 30.50476908683777
Epoch: 14, Steps: 208 | Train Loss: 3.036 Vali Loss: 3.186 Vali Acc: 0.104 Test Loss: 3.186 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 2.9257691
	speed: 0.4583s/iter; left time: 8151.9622s
	iters: 200, epoch: 15 | loss: 3.0819249
	speed: 0.1570s/iter; left time: 2776.3841s
Epoch: 15 cost time: 33.422783851623535
Epoch: 15, Steps: 208 | Train Loss: 3.081 Vali Loss: 3.245 Vali Acc: 0.093 Test Loss: 3.245 Test Acc: 0.093
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 2.8684998
	speed: 0.5095s/iter; left time: 8957.4962s
	iters: 200, epoch: 16 | loss: 3.2386518
	speed: 0.1546s/iter; left time: 2703.2900s
Epoch: 16 cost time: 34.222790002822876
Epoch: 16, Steps: 208 | Train Loss: 3.154 Vali Loss: 3.297 Vali Acc: 0.078 Test Loss: 3.297 Test Acc: 0.078
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 3.1042705
	speed: 0.5461s/iter; left time: 9486.6029s
	iters: 200, epoch: 17 | loss: 3.1351798
	speed: 0.1653s/iter; left time: 2854.8221s
Epoch: 17 cost time: 36.43773317337036
Epoch: 17, Steps: 208 | Train Loss: 3.151 Vali Loss: 3.261 Vali Acc: 0.092 Test Loss: 3.261 Test Acc: 0.092
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11184014315538324
model parameter : 2904291
model size : 13.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5463924
	speed: 0.1715s/iter; left time: 3549.3976s
	iters: 200, epoch: 1 | loss: 4.1592240
	speed: 0.1366s/iter; left time: 2813.9283s
Epoch: 1 cost time: 31.922470092773438
Epoch: 1, Steps: 208 | Train Loss: 3.820 Vali Loss: 3.707 Vali Acc: 0.039 Test Loss: 3.707 Test Acc: 0.039
Validation loss decreased (inf --> -0.039331).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4647059
	speed: 0.4252s/iter; left time: 8712.7997s
	iters: 200, epoch: 2 | loss: 3.5194538
	speed: 0.1436s/iter; left time: 2927.9681s
Epoch: 2 cost time: 28.930118560791016
Epoch: 2, Steps: 208 | Train Loss: 3.640 Vali Loss: 3.593 Vali Acc: 0.047 Test Loss: 3.593 Test Acc: 0.047
Validation loss decreased (-0.039331 --> -0.046788).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6757102
	speed: 0.4557s/iter; left time: 9243.6092s
	iters: 200, epoch: 3 | loss: 3.1522226
	speed: 0.1469s/iter; left time: 2964.9687s
Epoch: 3 cost time: 32.03789520263672
Epoch: 3, Steps: 208 | Train Loss: 3.556 Vali Loss: 3.513 Vali Acc: 0.057 Test Loss: 3.513 Test Acc: 0.057
Validation loss decreased (-0.046788 --> -0.057227).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.0310457
	speed: 0.4627s/iter; left time: 9290.0787s
	iters: 200, epoch: 4 | loss: 3.0515928
	speed: 0.1275s/iter; left time: 2546.5646s
Epoch: 4 cost time: 28.891576051712036
Epoch: 4, Steps: 208 | Train Loss: 3.404 Vali Loss: 3.423 Vali Acc: 0.067 Test Loss: 3.423 Test Acc: 0.067
Validation loss decreased (-0.057227 --> -0.066772).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3391275
	speed: 0.4488s/iter; left time: 8917.5130s
	iters: 200, epoch: 5 | loss: 3.1364965
	speed: 0.1203s/iter; left time: 2377.2909s
Epoch: 5 cost time: 28.46565580368042
Epoch: 5, Steps: 208 | Train Loss: 3.267 Vali Loss: 3.321 Vali Acc: 0.094 Test Loss: 3.321 Test Acc: 0.094
Validation loss decreased (-0.066772 --> -0.093913).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.1366820
	speed: 0.4304s/iter; left time: 8462.3424s
	iters: 200, epoch: 6 | loss: 3.0844867
	speed: 0.1356s/iter; left time: 2653.1783s
Epoch: 6 cost time: 29.833811283111572
Epoch: 6, Steps: 208 | Train Loss: 3.159 Vali Loss: 3.254 Vali Acc: 0.089 Test Loss: 3.254 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.1929703
	speed: 0.4247s/iter; left time: 8261.5643s
	iters: 200, epoch: 7 | loss: 3.5073833
	speed: 0.1490s/iter; left time: 2882.8287s
Epoch: 7 cost time: 30.524635791778564
Epoch: 7, Steps: 208 | Train Loss: 3.084 Vali Loss: 3.245 Vali Acc: 0.091 Test Loss: 3.245 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.2141802
	speed: 0.4708s/iter; left time: 9059.6238s
	iters: 200, epoch: 8 | loss: 3.1209681
	speed: 0.1629s/iter; left time: 3119.0223s
Epoch: 8 cost time: 33.86322283744812
Epoch: 8, Steps: 208 | Train Loss: 3.070 Vali Loss: 3.182 Vali Acc: 0.107 Test Loss: 3.182 Test Acc: 0.107
Validation loss decreased (-0.093913 --> -0.106738).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.6989107
	speed: 0.4345s/iter; left time: 8270.9065s
	iters: 200, epoch: 9 | loss: 2.9937348
	speed: 0.1435s/iter; left time: 2717.2746s
Epoch: 9 cost time: 29.63255214691162
Epoch: 9, Steps: 208 | Train Loss: 3.035 Vali Loss: 3.316 Vali Acc: 0.083 Test Loss: 3.316 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 3.6808970
	speed: 0.4604s/iter; left time: 8669.6203s
	iters: 200, epoch: 10 | loss: 2.8612597
	speed: 0.1431s/iter; left time: 2679.6381s
Epoch: 10 cost time: 30.92800235748291
Epoch: 10, Steps: 208 | Train Loss: 3.035 Vali Loss: 3.139 Vali Acc: 0.109 Test Loss: 3.139 Test Acc: 0.109
Validation loss decreased (-0.106738 --> -0.109423).  Saving model ...
	iters: 100, epoch: 11 | loss: 3.4216046
	speed: 0.4484s/iter; left time: 8348.7488s
	iters: 200, epoch: 11 | loss: 3.2369885
	speed: 0.1533s/iter; left time: 2838.5086s
Epoch: 11 cost time: 31.89164686203003
Epoch: 11, Steps: 208 | Train Loss: 3.096 Vali Loss: 3.270 Vali Acc: 0.090 Test Loss: 3.270 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.8509586
	speed: 0.4456s/iter; left time: 8205.2278s
	iters: 200, epoch: 12 | loss: 3.0299664
	speed: 0.1303s/iter; left time: 2386.6907s
Epoch: 12 cost time: 30.3815336227417
Epoch: 12, Steps: 208 | Train Loss: 3.148 Vali Loss: 3.253 Vali Acc: 0.091 Test Loss: 3.253 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 3.5737474
	speed: 0.4626s/iter; left time: 8422.3601s
	iters: 200, epoch: 13 | loss: 2.9355178
	speed: 0.1635s/iter; left time: 2960.7245s
Epoch: 13 cost time: 33.737669467926025
Epoch: 13, Steps: 208 | Train Loss: 3.190 Vali Loss: 3.278 Vali Acc: 0.090 Test Loss: 3.278 Test Acc: 0.090
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 3.0905936
	speed: 0.4567s/iter; left time: 8218.6005s
	iters: 200, epoch: 14 | loss: 3.3752964
	speed: 0.1369s/iter; left time: 2450.7472s
Epoch: 14 cost time: 28.467493534088135
Epoch: 14, Steps: 208 | Train Loss: 3.240 Vali Loss: 3.255 Vali Acc: 0.089 Test Loss: 3.255 Test Acc: 0.089
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 3.0306590
	speed: 0.4423s/iter; left time: 7867.9896s
	iters: 200, epoch: 15 | loss: 3.3915248
	speed: 0.1551s/iter; left time: 2744.3180s
Epoch: 15 cost time: 32.121596813201904
Epoch: 15, Steps: 208 | Train Loss: 3.200 Vali Loss: 3.262 Vali Acc: 0.082 Test Loss: 3.262 Test Acc: 0.082
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 3.5066144
	speed: 0.4316s/iter; left time: 7588.2651s
	iters: 200, epoch: 16 | loss: 3.4028063
	speed: 0.1336s/iter; left time: 2335.7066s
Epoch: 16 cost time: 28.295581579208374
Epoch: 16, Steps: 208 | Train Loss: 3.190 Vali Loss: 3.239 Vali Acc: 0.093 Test Loss: 3.239 Test Acc: 0.093
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 3.1510465
	speed: 0.4662s/iter; left time: 8098.9626s
	iters: 200, epoch: 17 | loss: 3.5314469
	speed: 0.1509s/iter; left time: 2605.9257s
Epoch: 17 cost time: 33.33833599090576
Epoch: 17, Steps: 208 | Train Loss: 3.184 Vali Loss: 3.256 Vali Acc: 0.086 Test Loss: 3.256 Test Acc: 0.086
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 3.4711652
	speed: 0.4405s/iter; left time: 7561.3366s
	iters: 200, epoch: 18 | loss: 3.1796615
	speed: 0.1385s/iter; left time: 2362.6557s
Epoch: 18 cost time: 30.07691502571106
Epoch: 18, Steps: 208 | Train Loss: 3.197 Vali Loss: 3.293 Vali Acc: 0.084 Test Loss: 3.293 Test Acc: 0.084
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 2.8720355
	speed: 0.4475s/iter; left time: 7588.9055s
	iters: 200, epoch: 19 | loss: 3.7549605
	speed: 0.1520s/iter; left time: 2562.4853s
Epoch: 19 cost time: 32.817866802215576
Epoch: 19, Steps: 208 | Train Loss: 3.240 Vali Loss: 3.242 Vali Acc: 0.093 Test Loss: 3.242 Test Acc: 0.093
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 3.2330801
	speed: 0.4189s/iter; left time: 7016.0976s
	iters: 200, epoch: 20 | loss: 3.0248115
	speed: 0.1266s/iter; left time: 2106.9573s
Epoch: 20 cost time: 27.5725040435791
Epoch: 20, Steps: 208 | Train Loss: 3.232 Vali Loss: 3.279 Vali Acc: 0.086 Test Loss: 3.279 Test Acc: 0.086
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10945422010140173
model parameter : 2899555
model size : 13.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5758190
	speed: 0.1881s/iter; left time: 3894.7803s
	iters: 200, epoch: 1 | loss: 3.6138349
	speed: 0.1507s/iter; left time: 3104.0522s
Epoch: 1 cost time: 35.14907145500183
Epoch: 1, Steps: 208 | Train Loss: 3.792 Vali Loss: 3.675 Vali Acc: 0.048 Test Loss: 3.675 Test Acc: 0.048
Validation loss decreased (inf --> -0.047682).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5776680
	speed: 0.5306s/iter; left time: 10874.2122s
	iters: 200, epoch: 2 | loss: 3.4029646
	speed: 0.1630s/iter; left time: 3324.2012s
Epoch: 2 cost time: 36.210773944854736
Epoch: 2, Steps: 208 | Train Loss: 3.660 Vali Loss: 3.643 Vali Acc: 0.041 Test Loss: 3.643 Test Acc: 0.041
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.8798914
	speed: 0.5274s/iter; left time: 10698.4209s
	iters: 200, epoch: 3 | loss: 3.3421993
	speed: 0.1601s/iter; left time: 3232.3067s
Epoch: 3 cost time: 34.712838888168335
Epoch: 3, Steps: 208 | Train Loss: 3.581 Vali Loss: 3.491 Vali Acc: 0.067 Test Loss: 3.491 Test Acc: 0.067
Validation loss decreased (-0.047682 --> -0.066771).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.1911120
	speed: 0.5088s/iter; left time: 10214.6089s
	iters: 200, epoch: 4 | loss: 3.6368029
	speed: 0.1732s/iter; left time: 3460.4728s
Epoch: 4 cost time: 34.40718746185303
Epoch: 4, Steps: 208 | Train Loss: 3.425 Vali Loss: 3.321 Vali Acc: 0.077 Test Loss: 3.321 Test Acc: 0.077
Validation loss decreased (-0.066771 --> -0.076913).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.7853112
	speed: 0.5153s/iter; left time: 10237.6510s
	iters: 200, epoch: 5 | loss: 2.9522541
	speed: 0.1658s/iter; left time: 3278.0654s
Epoch: 5 cost time: 34.988105058670044
Epoch: 5, Steps: 208 | Train Loss: 3.256 Vali Loss: 3.201 Vali Acc: 0.077 Test Loss: 3.201 Test Acc: 0.077
Validation loss decreased (-0.076913 --> -0.076914).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.4707220
	speed: 0.5099s/iter; left time: 10025.0443s
	iters: 200, epoch: 6 | loss: 3.2895849
	speed: 0.1401s/iter; left time: 2739.5388s
Epoch: 6 cost time: 30.93355441093445
Epoch: 6, Steps: 208 | Train Loss: 3.144 Vali Loss: 3.199 Vali Acc: 0.107 Test Loss: 3.199 Test Acc: 0.107
Validation loss decreased (-0.076914 --> -0.107036).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.5756602
	speed: 0.4642s/iter; left time: 9029.6652s
	iters: 200, epoch: 7 | loss: 2.9234512
	speed: 0.1614s/iter; left time: 3123.8064s
Epoch: 7 cost time: 32.784754276275635
Epoch: 7, Steps: 208 | Train Loss: 3.085 Vali Loss: 3.229 Vali Acc: 0.103 Test Loss: 3.229 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 3.2820659
	speed: 0.4735s/iter; left time: 9112.4161s
	iters: 200, epoch: 8 | loss: 2.9934440
	speed: 0.1520s/iter; left time: 2910.3706s
Epoch: 8 cost time: 33.45925951004028
Epoch: 8, Steps: 208 | Train Loss: 3.025 Vali Loss: 3.229 Vali Acc: 0.109 Test Loss: 3.229 Test Acc: 0.109
Validation loss decreased (-0.107036 --> -0.109124).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.0559545
	speed: 0.4977s/iter; left time: 9475.0255s
	iters: 200, epoch: 9 | loss: 3.1220598
	speed: 0.1496s/iter; left time: 2833.1647s
Epoch: 9 cost time: 33.62537097930908
Epoch: 9, Steps: 208 | Train Loss: 3.044 Vali Loss: 3.173 Vali Acc: 0.104 Test Loss: 3.173 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.4812150
	speed: 0.5029s/iter; left time: 9468.8987s
	iters: 200, epoch: 10 | loss: 3.2122011
	speed: 0.1472s/iter; left time: 2756.1323s
Epoch: 10 cost time: 33.2835955619812
Epoch: 10, Steps: 208 | Train Loss: 2.996 Vali Loss: 3.182 Vali Acc: 0.097 Test Loss: 3.182 Test Acc: 0.097
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 3.0951500
	speed: 0.5032s/iter; left time: 9370.6909s
	iters: 200, epoch: 11 | loss: 3.0618062
	speed: 0.1350s/iter; left time: 2499.6874s
Epoch: 11 cost time: 31.58189344406128
Epoch: 11, Steps: 208 | Train Loss: 3.019 Vali Loss: 3.148 Vali Acc: 0.097 Test Loss: 3.148 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 3.1814971
	speed: 0.5048s/iter; left time: 9295.4219s
	iters: 200, epoch: 12 | loss: 3.0797575
	speed: 0.1614s/iter; left time: 2956.3739s
Epoch: 12 cost time: 34.08701276779175
Epoch: 12, Steps: 208 | Train Loss: 3.129 Vali Loss: 3.248 Vali Acc: 0.082 Test Loss: 3.248 Test Acc: 0.082
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 3.2856643
	speed: 0.5021s/iter; left time: 9140.2755s
	iters: 200, epoch: 13 | loss: 3.2184036
	speed: 0.1528s/iter; left time: 2765.8897s
Epoch: 13 cost time: 32.503960847854614
Epoch: 13, Steps: 208 | Train Loss: 3.111 Vali Loss: 3.181 Vali Acc: 0.116 Test Loss: 3.181 Test Acc: 0.116
Validation loss decreased (-0.109124 --> -0.115685).  Saving model ...
	iters: 100, epoch: 14 | loss: 3.1292570
	speed: 0.4625s/iter; left time: 8323.6915s
	iters: 200, epoch: 14 | loss: 3.1189303
	speed: 0.1393s/iter; left time: 2492.9273s
Epoch: 14 cost time: 31.121074199676514
Epoch: 14, Steps: 208 | Train Loss: 3.026 Vali Loss: 3.348 Vali Acc: 0.086 Test Loss: 3.348 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.9312344
	speed: 0.4469s/iter; left time: 7949.0657s
	iters: 200, epoch: 15 | loss: 2.6952140
	speed: 0.1508s/iter; left time: 2667.8409s
Epoch: 15 cost time: 30.357696533203125
Epoch: 15, Steps: 208 | Train Loss: 3.054 Vali Loss: 3.170 Vali Acc: 0.106 Test Loss: 3.170 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 3.1213732
	speed: 0.4855s/iter; left time: 8534.7973s
	iters: 200, epoch: 16 | loss: 2.9360118
	speed: 0.1528s/iter; left time: 2671.5332s
Epoch: 16 cost time: 32.041510343551636
Epoch: 16, Steps: 208 | Train Loss: 3.043 Vali Loss: 3.161 Vali Acc: 0.108 Test Loss: 3.161 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 3.2649560
	speed: 0.4595s/iter; left time: 7982.0460s
	iters: 200, epoch: 17 | loss: 3.2979479
	speed: 0.1429s/iter; left time: 2469.1186s
Epoch: 17 cost time: 31.013844966888428
Epoch: 17, Steps: 208 | Train Loss: 3.186 Vali Loss: 3.300 Vali Acc: 0.088 Test Loss: 3.300 Test Acc: 0.088
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 3.6675024
	speed: 0.4839s/iter; left time: 8306.7524s
	iters: 200, epoch: 18 | loss: 3.7809048
	speed: 0.1380s/iter; left time: 2354.3922s
Epoch: 18 cost time: 31.371320247650146
Epoch: 18, Steps: 208 | Train Loss: 3.579 Vali Loss: 3.688 Vali Acc: 0.044 Test Loss: 3.688 Test Acc: 0.044
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 3.4054823
	speed: 0.4870s/iter; left time: 8258.4362s
	iters: 200, epoch: 19 | loss: 3.6330755
	speed: 0.1430s/iter; left time: 2410.5932s
Epoch: 19 cost time: 30.549920082092285
Epoch: 19, Steps: 208 | Train Loss: 3.634 Vali Loss: 3.579 Vali Acc: 0.050 Test Loss: 3.579 Test Acc: 0.050
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 3.6572502
	speed: 0.4828s/iter; left time: 8086.7863s
	iters: 200, epoch: 20 | loss: 4.0681276
	speed: 0.1430s/iter; left time: 2381.0140s
Epoch: 20 cost time: 31.46013617515564
Epoch: 20, Steps: 208 | Train Loss: 3.585 Vali Loss: 3.714 Vali Acc: 0.026 Test Loss: 3.714 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 3.6131620
	speed: 0.4641s/iter; left time: 7677.2262s
	iters: 200, epoch: 21 | loss: 3.7398632
	speed: 0.1471s/iter; left time: 2417.9155s
Epoch: 21 cost time: 30.885109424591064
Epoch: 21, Steps: 208 | Train Loss: 3.600 Vali Loss: 3.681 Vali Acc: 0.026 Test Loss: 3.681 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 3.7509036
	speed: 0.4606s/iter; left time: 7523.5756s
	iters: 200, epoch: 22 | loss: 3.7246337
	speed: 0.1323s/iter; left time: 2147.5724s
Epoch: 22 cost time: 30.572787761688232
Epoch: 22, Steps: 208 | Train Loss: 3.682 Vali Loss: 3.677 Vali Acc: 0.026 Test Loss: 3.677 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 3.6571147
	speed: 0.4922s/iter; left time: 7936.2157s
	iters: 200, epoch: 23 | loss: 3.6547937
	speed: 0.1543s/iter; left time: 2472.1339s
Epoch: 23 cost time: 33.771713733673096
Epoch: 23, Steps: 208 | Train Loss: 3.682 Vali Loss: 3.668 Vali Acc: 0.026 Test Loss: 3.668 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11571726811810319
model parameter : 2894819
model size : 13.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8800323
	speed: 0.1347s/iter; left time: 2788.1586s
	iters: 200, epoch: 1 | loss: 4.0049825
	speed: 0.1183s/iter; left time: 2437.6769s
Epoch: 1 cost time: 26.459548473358154
Epoch: 1, Steps: 208 | Train Loss: 3.717 Vali Loss: 3.593 Vali Acc: 0.057 Test Loss: 3.593 Test Acc: 0.057
Validation loss decreased (inf --> -0.056630).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7621272
	speed: 0.4036s/iter; left time: 8270.8965s
	iters: 200, epoch: 2 | loss: 3.2625575
	speed: 0.1222s/iter; left time: 2491.8433s
Epoch: 2 cost time: 26.151265144348145
Epoch: 2, Steps: 208 | Train Loss: 3.602 Vali Loss: 3.520 Vali Acc: 0.054 Test Loss: 3.520 Test Acc: 0.054
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.3504860
	speed: 0.4279s/iter; left time: 8679.9057s
	iters: 200, epoch: 3 | loss: 3.1591153
	speed: 0.1342s/iter; left time: 2708.3987s
Epoch: 3 cost time: 27.81784462928772
Epoch: 3, Steps: 208 | Train Loss: 3.511 Vali Loss: 3.521 Vali Acc: 0.056 Test Loss: 3.521 Test Acc: 0.056
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 3.3619289
	speed: 0.4147s/iter; left time: 8326.6693s
	iters: 200, epoch: 4 | loss: 3.4217527
	speed: 0.1339s/iter; left time: 2675.3700s
Epoch: 4 cost time: 27.67747712135315
Epoch: 4, Steps: 208 | Train Loss: 3.484 Vali Loss: 3.491 Vali Acc: 0.063 Test Loss: 3.491 Test Acc: 0.063
Validation loss decreased (-0.056630 --> -0.063192).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.5430198
	speed: 0.4599s/iter; left time: 9138.0049s
	iters: 200, epoch: 5 | loss: 3.4330280
	speed: 0.1496s/iter; left time: 2956.8804s
Epoch: 5 cost time: 30.787129640579224
Epoch: 5, Steps: 208 | Train Loss: 3.441 Vali Loss: 3.467 Vali Acc: 0.067 Test Loss: 3.467 Test Acc: 0.067
Validation loss decreased (-0.063192 --> -0.066473).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.6568887
	speed: 0.4239s/iter; left time: 8333.9950s
	iters: 200, epoch: 6 | loss: 3.5217214
	speed: 0.1331s/iter; left time: 2602.6886s
Epoch: 6 cost time: 26.51936388015747
Epoch: 6, Steps: 208 | Train Loss: 3.443 Vali Loss: 3.492 Vali Acc: 0.058 Test Loss: 3.492 Test Acc: 0.058
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.0966778
	speed: 0.4228s/iter; left time: 8224.1499s
	iters: 200, epoch: 7 | loss: 3.5957990
	speed: 0.1296s/iter; left time: 2507.6921s
Epoch: 7 cost time: 27.72013568878174
Epoch: 7, Steps: 208 | Train Loss: 3.425 Vali Loss: 3.488 Vali Acc: 0.059 Test Loss: 3.488 Test Acc: 0.059
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.6578836
	speed: 0.4065s/iter; left time: 7822.5371s
	iters: 200, epoch: 8 | loss: 3.7928147
	speed: 0.1351s/iter; left time: 2586.1922s
Epoch: 8 cost time: 28.34814190864563
Epoch: 8, Steps: 208 | Train Loss: 3.454 Vali Loss: 3.499 Vali Acc: 0.058 Test Loss: 3.499 Test Acc: 0.058
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 3.6417427
	speed: 0.3882s/iter; left time: 7389.3416s
	iters: 200, epoch: 9 | loss: 3.8669045
	speed: 0.1096s/iter; left time: 2076.4402s
Epoch: 9 cost time: 24.572083950042725
Epoch: 9, Steps: 208 | Train Loss: 3.620 Vali Loss: 3.656 Vali Acc: 0.053 Test Loss: 3.656 Test Acc: 0.053
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 3.7502644
	speed: 0.4052s/iter; left time: 7629.8580s
	iters: 200, epoch: 10 | loss: 3.7156277
	speed: 0.1215s/iter; left time: 2275.4079s
Epoch: 10 cost time: 25.978609561920166
Epoch: 10, Steps: 208 | Train Loss: 3.667 Vali Loss: 3.664 Vali Acc: 0.030 Test Loss: 3.664 Test Acc: 0.030
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 3.6996839
	speed: 0.3900s/iter; left time: 7262.8255s
	iters: 200, epoch: 11 | loss: 3.6981804
	speed: 0.1261s/iter; left time: 2335.6576s
Epoch: 11 cost time: 26.495082139968872
Epoch: 11, Steps: 208 | Train Loss: 3.684 Vali Loss: 3.661 Vali Acc: 0.032 Test Loss: 3.661 Test Acc: 0.032
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 3.7240019
	speed: 0.4017s/iter; left time: 7396.9373s
	iters: 200, epoch: 12 | loss: 3.6932743
	speed: 0.1087s/iter; left time: 1990.2113s
Epoch: 12 cost time: 24.15418529510498
Epoch: 12, Steps: 208 | Train Loss: 3.657 Vali Loss: 3.612 Vali Acc: 0.043 Test Loss: 3.612 Test Acc: 0.043
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 3.5722203
	speed: 0.4060s/iter; left time: 7391.3196s
	iters: 200, epoch: 13 | loss: 3.7641063
	speed: 0.1264s/iter; left time: 2287.7896s
Epoch: 13 cost time: 27.845770597457886
Epoch: 13, Steps: 208 | Train Loss: 3.646 Vali Loss: 3.652 Vali Acc: 0.034 Test Loss: 3.652 Test Acc: 0.034
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 3.6501718
	speed: 0.3959s/iter; left time: 7125.7819s
	iters: 200, epoch: 14 | loss: 3.6897213
	speed: 0.1304s/iter; left time: 2334.5788s
Epoch: 14 cost time: 26.762519359588623
Epoch: 14, Steps: 208 | Train Loss: 3.648 Vali Loss: 3.601 Vali Acc: 0.043 Test Loss: 3.601 Test Acc: 0.043
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 3.6833034
	speed: 0.4162s/iter; left time: 7402.9626s
	iters: 200, epoch: 15 | loss: 3.6540337
	speed: 0.1222s/iter; left time: 2162.0541s
Epoch: 15 cost time: 26.022186994552612
Epoch: 15, Steps: 208 | Train Loss: 3.625 Vali Loss: 3.589 Vali Acc: 0.040 Test Loss: 3.589 Test Acc: 0.040
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.06650760512973457
model parameter : 1905571
model size : 8.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.4352417
	speed: 0.1643s/iter; left time: 3401.6197s
	iters: 200, epoch: 1 | loss: 3.5859950
	speed: 0.1298s/iter; left time: 2673.1427s
Epoch: 1 cost time: 31.05870270729065
Epoch: 1, Steps: 208 | Train Loss: 3.719 Vali Loss: 3.651 Vali Acc: 0.036 Test Loss: 3.651 Test Acc: 0.036
Validation loss decreased (inf --> -0.036349).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6938612
	speed: 0.4329s/iter; left time: 8870.8672s
	iters: 200, epoch: 2 | loss: 3.3771462
	speed: 0.1256s/iter; left time: 2561.8552s
Epoch: 2 cost time: 29.42933964729309
Epoch: 2, Steps: 208 | Train Loss: 3.622 Vali Loss: 3.547 Vali Acc: 0.057 Test Loss: 3.547 Test Acc: 0.057
Validation loss decreased (-0.036349 --> -0.057227).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6389940
	speed: 0.4335s/iter; left time: 8794.1579s
	iters: 200, epoch: 3 | loss: 4.0092030
	speed: 0.1136s/iter; left time: 2292.0768s
Epoch: 3 cost time: 26.28938889503479
Epoch: 3, Steps: 208 | Train Loss: 3.529 Vali Loss: 3.467 Vali Acc: 0.070 Test Loss: 3.467 Test Acc: 0.070
Validation loss decreased (-0.057227 --> -0.070052).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.9006591
	speed: 0.3800s/iter; left time: 7629.8088s
	iters: 200, epoch: 4 | loss: 3.4638648
	speed: 0.1054s/iter; left time: 2105.0392s
Epoch: 4 cost time: 23.969597816467285
Epoch: 4, Steps: 208 | Train Loss: 3.483 Vali Loss: 3.479 Vali Acc: 0.065 Test Loss: 3.479 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.4451797
	speed: 0.3874s/iter; left time: 7697.7931s
	iters: 200, epoch: 5 | loss: 3.5615458
	speed: 0.1266s/iter; left time: 2503.7129s
Epoch: 5 cost time: 26.52926802635193
Epoch: 5, Steps: 208 | Train Loss: 3.456 Vali Loss: 3.465 Vali Acc: 0.065 Test Loss: 3.465 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 3.6806569
	speed: 0.4022s/iter; left time: 7908.5619s
	iters: 200, epoch: 6 | loss: 3.1198134
	speed: 0.1198s/iter; left time: 2343.0450s
Epoch: 6 cost time: 25.38611102104187
Epoch: 6, Steps: 208 | Train Loss: 3.441 Vali Loss: 3.488 Vali Acc: 0.066 Test Loss: 3.488 Test Acc: 0.066
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 3.5821090
	speed: 0.3763s/iter; left time: 7320.5876s
	iters: 200, epoch: 7 | loss: 3.4881947
	speed: 0.1248s/iter; left time: 2415.4140s
Epoch: 7 cost time: 25.454708099365234
Epoch: 7, Steps: 208 | Train Loss: 3.427 Vali Loss: 3.432 Vali Acc: 0.064 Test Loss: 3.432 Test Acc: 0.064
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 3.1538839
	speed: 0.4278s/iter; left time: 8232.9598s
	iters: 200, epoch: 8 | loss: 3.7157373
	speed: 0.1271s/iter; left time: 2432.7568s
Epoch: 8 cost time: 27.488765954971313
Epoch: 8, Steps: 208 | Train Loss: 3.396 Vali Loss: 3.375 Vali Acc: 0.078 Test Loss: 3.375 Test Acc: 0.078
Validation loss decreased (-0.070052 --> -0.077807).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.6968083
	speed: 0.4180s/iter; left time: 7957.3896s
	iters: 200, epoch: 9 | loss: 3.3763943
	speed: 0.1109s/iter; left time: 2099.9820s
Epoch: 9 cost time: 25.6311194896698
Epoch: 9, Steps: 208 | Train Loss: 3.299 Vali Loss: 3.351 Vali Acc: 0.087 Test Loss: 3.351 Test Acc: 0.087
Validation loss decreased (-0.077807 --> -0.087053).  Saving model ...
	iters: 100, epoch: 10 | loss: 3.2077539
	speed: 0.4104s/iter; left time: 7727.3308s
	iters: 200, epoch: 10 | loss: 3.6793518
	speed: 0.1223s/iter; left time: 2290.7749s
Epoch: 10 cost time: 26.5691339969635
Epoch: 10, Steps: 208 | Train Loss: 3.255 Vali Loss: 3.307 Vali Acc: 0.089 Test Loss: 3.307 Test Acc: 0.089
Validation loss decreased (-0.087053 --> -0.088843).  Saving model ...
	iters: 100, epoch: 11 | loss: 3.2035840
	speed: 0.4715s/iter; left time: 8780.4235s
	iters: 200, epoch: 11 | loss: 3.3349652
	speed: 0.1392s/iter; left time: 2577.4552s
Epoch: 11 cost time: 29.293478965759277
Epoch: 11, Steps: 208 | Train Loss: 3.175 Vali Loss: 3.308 Vali Acc: 0.083 Test Loss: 3.308 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 3.5353947
	speed: 0.4623s/iter; left time: 8512.7311s
	iters: 200, epoch: 12 | loss: 3.2537818
	speed: 0.1317s/iter; left time: 2412.2954s
Epoch: 12 cost time: 30.173632860183716
Epoch: 12, Steps: 208 | Train Loss: 3.125 Vali Loss: 3.287 Vali Acc: 0.091 Test Loss: 3.287 Test Acc: 0.091
Validation loss decreased (-0.088843 --> -0.090632).  Saving model ...
	iters: 100, epoch: 13 | loss: 3.2823901
	speed: 0.4828s/iter; left time: 8789.8827s
	iters: 200, epoch: 13 | loss: 2.9057856
	speed: 0.1398s/iter; left time: 2530.6647s
Epoch: 13 cost time: 30.647528171539307
Epoch: 13, Steps: 208 | Train Loss: 3.167 Vali Loss: 3.377 Vali Acc: 0.087 Test Loss: 3.377 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 3.5970969
	speed: 0.4983s/iter; left time: 8967.4933s
	iters: 200, epoch: 14 | loss: 3.3032532
	speed: 0.1392s/iter; left time: 2491.8346s
Epoch: 14 cost time: 32.00150489807129
Epoch: 14, Steps: 208 | Train Loss: 3.058 Vali Loss: 3.306 Vali Acc: 0.099 Test Loss: 3.306 Test Acc: 0.099
Validation loss decreased (-0.090632 --> -0.098685).  Saving model ...
	iters: 100, epoch: 15 | loss: 3.3035700
	speed: 0.4834s/iter; left time: 8599.6623s
	iters: 200, epoch: 15 | loss: 2.7149038
	speed: 0.1645s/iter; left time: 2909.5536s
Epoch: 15 cost time: 33.589574575424194
Epoch: 15, Steps: 208 | Train Loss: 2.966 Vali Loss: 3.392 Vali Acc: 0.094 Test Loss: 3.392 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 2.8716176
	speed: 0.4887s/iter; left time: 8591.9074s
	iters: 200, epoch: 16 | loss: 3.1109564
	speed: 0.1581s/iter; left time: 2763.6497s
Epoch: 16 cost time: 32.55480885505676
Epoch: 16, Steps: 208 | Train Loss: 2.939 Vali Loss: 3.374 Vali Acc: 0.103 Test Loss: 3.374 Test Acc: 0.103
Validation loss decreased (-0.098685 --> -0.102561).  Saving model ...
	iters: 100, epoch: 17 | loss: 2.8625357
	speed: 0.5037s/iter; left time: 8749.9235s
	iters: 200, epoch: 17 | loss: 2.8826931
	speed: 0.1273s/iter; left time: 2198.8956s
Epoch: 17 cost time: 30.210768222808838
Epoch: 17, Steps: 208 | Train Loss: 2.872 Vali Loss: 3.333 Vali Acc: 0.103 Test Loss: 3.333 Test Acc: 0.103
Validation loss decreased (-0.102561 --> -0.103456).  Saving model ...
	iters: 100, epoch: 18 | loss: 3.1631250
	speed: 0.4398s/iter; left time: 7548.3281s
	iters: 200, epoch: 18 | loss: 2.9983637
	speed: 0.1243s/iter; left time: 2121.3210s
Epoch: 18 cost time: 27.705522298812866
Epoch: 18, Steps: 208 | Train Loss: 2.917 Vali Loss: 3.354 Vali Acc: 0.098 Test Loss: 3.354 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 2.7327344
	speed: 0.4717s/iter; left time: 7999.4476s
	iters: 200, epoch: 19 | loss: 3.1125524
	speed: 0.1384s/iter; left time: 2332.6242s
Epoch: 19 cost time: 30.5971622467041
Epoch: 19, Steps: 208 | Train Loss: 2.810 Vali Loss: 3.386 Vali Acc: 0.102 Test Loss: 3.386 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 2.7301106
	speed: 0.4646s/iter; left time: 7782.2595s
	iters: 200, epoch: 20 | loss: 2.8356535
	speed: 0.1302s/iter; left time: 2167.2236s
Epoch: 20 cost time: 29.088366746902466
Epoch: 20, Steps: 208 | Train Loss: 2.745 Vali Loss: 3.429 Vali Acc: 0.098 Test Loss: 3.429 Test Acc: 0.098
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 3.1962426
	speed: 0.4649s/iter; left time: 7690.5667s
	iters: 200, epoch: 21 | loss: 2.8966384
	speed: 0.1415s/iter; left time: 2327.0357s
Epoch: 21 cost time: 30.83702278137207
Epoch: 21, Steps: 208 | Train Loss: 2.793 Vali Loss: 3.358 Vali Acc: 0.105 Test Loss: 3.358 Test Acc: 0.105
Validation loss decreased (-0.103456 --> -0.104947).  Saving model ...
	iters: 100, epoch: 22 | loss: 2.7534790
	speed: 0.4654s/iter; left time: 7601.7310s
	iters: 200, epoch: 22 | loss: 3.3325524
	speed: 0.1540s/iter; left time: 2500.4559s
Epoch: 22 cost time: 31.35278296470642
Epoch: 22, Steps: 208 | Train Loss: 2.634 Vali Loss: 3.436 Vali Acc: 0.105 Test Loss: 3.436 Test Acc: 0.105
Validation loss decreased (-0.104947 --> -0.105244).  Saving model ...
	iters: 100, epoch: 23 | loss: 2.7142937
	speed: 0.4731s/iter; left time: 7629.1951s
	iters: 200, epoch: 23 | loss: 3.0172873
	speed: 0.1279s/iter; left time: 2050.3450s
Epoch: 23 cost time: 28.27372717857361
Epoch: 23, Steps: 208 | Train Loss: 2.606 Vali Loss: 3.526 Vali Acc: 0.092 Test Loss: 3.526 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 1.8195565
	speed: 0.4842s/iter; left time: 7707.7208s
	iters: 200, epoch: 24 | loss: 2.2949443
	speed: 0.1519s/iter; left time: 2402.8454s
Epoch: 24 cost time: 33.07743167877197
Epoch: 24, Steps: 208 | Train Loss: 2.509 Vali Loss: 3.598 Vali Acc: 0.099 Test Loss: 3.598 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 3.0630348
	speed: 0.4788s/iter; left time: 7521.4415s
	iters: 200, epoch: 25 | loss: 3.2747710
	speed: 0.1445s/iter; left time: 2254.7315s
Epoch: 25 cost time: 30.844099283218384
Epoch: 25, Steps: 208 | Train Loss: 2.462 Vali Loss: 3.661 Vali Acc: 0.089 Test Loss: 3.661 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 2.6261795
	speed: 0.4596s/iter; left time: 7124.6399s
	iters: 200, epoch: 26 | loss: 2.2916956
	speed: 0.1441s/iter; left time: 2220.0054s
Epoch: 26 cost time: 30.22383165359497
Epoch: 26, Steps: 208 | Train Loss: 2.457 Vali Loss: 3.698 Vali Acc: 0.096 Test Loss: 3.698 Test Acc: 0.096
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 2.6450467
	speed: 0.4552s/iter; left time: 6961.1650s
	iters: 200, epoch: 27 | loss: 2.2614987
	speed: 0.1345s/iter; left time: 2043.2692s
Epoch: 27 cost time: 30.517757415771484
Epoch: 27, Steps: 208 | Train Loss: 2.407 Vali Loss: 3.643 Vali Acc: 0.093 Test Loss: 3.643 Test Acc: 0.093
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 2.3520560
	speed: 0.4672s/iter; left time: 7047.4642s
	iters: 200, epoch: 28 | loss: 1.4655662
	speed: 0.1388s/iter; left time: 2080.2273s
Epoch: 28 cost time: 30.260096788406372
Epoch: 28, Steps: 208 | Train Loss: 2.339 Vali Loss: 3.972 Vali Acc: 0.088 Test Loss: 3.972 Test Acc: 0.088
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 2.2075074
	speed: 0.4518s/iter; left time: 6721.7167s
	iters: 200, epoch: 29 | loss: 2.5559902
	speed: 0.1335s/iter; left time: 1973.2322s
Epoch: 29 cost time: 27.851178646087646
Epoch: 29, Steps: 208 | Train Loss: 2.407 Vali Loss: 3.863 Vali Acc: 0.102 Test Loss: 3.863 Test Acc: 0.102
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 2.1800456
	speed: 0.4896s/iter; left time: 7182.1167s
	iters: 200, epoch: 30 | loss: 2.5666907
	speed: 0.1516s/iter; left time: 2208.9389s
Epoch: 30 cost time: 34.458901166915894
Epoch: 30, Steps: 208 | Train Loss: 2.366 Vali Loss: 3.847 Vali Acc: 0.092 Test Loss: 3.847 Test Acc: 0.092
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 2.2439311
	speed: 0.5038s/iter; left time: 7285.8693s
	iters: 200, epoch: 31 | loss: 2.8074551
	speed: 0.1539s/iter; left time: 2210.0342s
Epoch: 31 cost time: 32.889578342437744
Epoch: 31, Steps: 208 | Train Loss: 2.443 Vali Loss: 3.814 Vali Acc: 0.097 Test Loss: 3.814 Test Acc: 0.097
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 2.1239238
	speed: 0.4623s/iter; left time: 6588.9272s
	iters: 200, epoch: 32 | loss: 2.2719281
	speed: 0.1346s/iter; left time: 1905.6328s
Epoch: 32 cost time: 28.594465494155884
Epoch: 32, Steps: 208 | Train Loss: 2.356 Vali Loss: 3.884 Vali Acc: 0.094 Test Loss: 3.884 Test Acc: 0.094
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10527885475693409
model parameter : 1903203
model size : 8.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7982864
	speed: 0.1570s/iter; left time: 3249.1782s
	iters: 200, epoch: 1 | loss: 3.9398417
	speed: 0.1153s/iter; left time: 2375.9561s
Epoch: 1 cost time: 28.348103284835815
Epoch: 1, Steps: 208 | Train Loss: 3.706 Vali Loss: 3.653 Vali Acc: 0.054 Test Loss: 3.653 Test Acc: 0.054
Validation loss decreased (inf --> -0.053945).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.0151825
	speed: 0.3914s/iter; left time: 8021.2619s
	iters: 200, epoch: 2 | loss: 3.7751913
	speed: 0.1111s/iter; left time: 2265.0887s
Epoch: 2 cost time: 24.328900575637817
Epoch: 2, Steps: 208 | Train Loss: 3.595 Vali Loss: 3.549 Vali Acc: 0.055 Test Loss: 3.549 Test Acc: 0.055
Validation loss decreased (-0.053945 --> -0.055437).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4896030
	speed: 0.4030s/iter; left time: 8175.1299s
	iters: 200, epoch: 3 | loss: 3.5796568
	speed: 0.1162s/iter; left time: 2346.2031s
Epoch: 3 cost time: 25.03150177001953
Epoch: 3, Steps: 208 | Train Loss: 3.528 Vali Loss: 3.545 Vali Acc: 0.058 Test Loss: 3.545 Test Acc: 0.058
Validation loss decreased (-0.055437 --> -0.057525).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.5021245
	speed: 0.3879s/iter; left time: 7788.3737s
	iters: 200, epoch: 4 | loss: 3.0832639
	speed: 0.1126s/iter; left time: 2249.1124s
Epoch: 4 cost time: 24.567205667495728
Epoch: 4, Steps: 208 | Train Loss: 3.475 Vali Loss: 3.524 Vali Acc: 0.066 Test Loss: 3.524 Test Acc: 0.066
Validation loss decreased (-0.057525 --> -0.066174).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.7063119
	speed: 0.4013s/iter; left time: 7974.0131s
	iters: 200, epoch: 5 | loss: 3.4398193
	speed: 0.1217s/iter; left time: 2405.0050s
Epoch: 5 cost time: 26.457156658172607
Epoch: 5, Steps: 208 | Train Loss: 3.437 Vali Loss: 3.472 Vali Acc: 0.066 Test Loss: 3.472 Test Acc: 0.066
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.5820682
	speed: 0.3978s/iter; left time: 7821.9095s
	iters: 200, epoch: 6 | loss: 3.2659130
	speed: 0.1158s/iter; left time: 2265.9722s
Epoch: 6 cost time: 25.300713539123535
Epoch: 6, Steps: 208 | Train Loss: 3.399 Vali Loss: 3.427 Vali Acc: 0.075 Test Loss: 3.427 Test Acc: 0.075
Validation loss decreased (-0.066174 --> -0.075122).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.2414680
	speed: 0.4073s/iter; left time: 7922.4673s
	iters: 200, epoch: 7 | loss: 3.6870453
	speed: 0.1263s/iter; left time: 2444.8213s
Epoch: 7 cost time: 26.32744789123535
Epoch: 7, Steps: 208 | Train Loss: 3.349 Vali Loss: 3.490 Vali Acc: 0.058 Test Loss: 3.490 Test Acc: 0.058
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 3.1860089
	speed: 0.4245s/iter; left time: 8169.4623s
	iters: 200, epoch: 8 | loss: 3.2337770
	speed: 0.1259s/iter; left time: 2410.7548s
Epoch: 8 cost time: 27.809582471847534
Epoch: 8, Steps: 208 | Train Loss: 3.306 Vali Loss: 3.433 Vali Acc: 0.080 Test Loss: 3.433 Test Acc: 0.080
Validation loss decreased (-0.075122 --> -0.079894).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.2141607
	speed: 0.3923s/iter; left time: 7468.2038s
	iters: 200, epoch: 9 | loss: 3.1955583
	speed: 0.1145s/iter; left time: 2167.7016s
Epoch: 9 cost time: 24.707064151763916
Epoch: 9, Steps: 208 | Train Loss: 3.230 Vali Loss: 3.328 Vali Acc: 0.089 Test Loss: 3.328 Test Acc: 0.089
Validation loss decreased (-0.079894 --> -0.089439).  Saving model ...
	iters: 100, epoch: 10 | loss: 3.1526408
	speed: 0.3970s/iter; left time: 7476.0205s
	iters: 200, epoch: 10 | loss: 2.9925373
	speed: 0.1145s/iter; left time: 2144.4404s
Epoch: 10 cost time: 26.089290857315063
Epoch: 10, Steps: 208 | Train Loss: 3.140 Vali Loss: 3.316 Vali Acc: 0.091 Test Loss: 3.316 Test Acc: 0.091
Validation loss decreased (-0.089439 --> -0.090632).  Saving model ...
	iters: 100, epoch: 11 | loss: 3.2081733
	speed: 0.3888s/iter; left time: 7239.3016s
	iters: 200, epoch: 11 | loss: 2.7966421
	speed: 0.1167s/iter; left time: 2160.6069s
Epoch: 11 cost time: 25.94111657142639
Epoch: 11, Steps: 208 | Train Loss: 3.086 Vali Loss: 3.291 Vali Acc: 0.092 Test Loss: 3.291 Test Acc: 0.092
Validation loss decreased (-0.090632 --> -0.092123).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.7327414
	speed: 0.4105s/iter; left time: 7559.0112s
	iters: 200, epoch: 12 | loss: 3.4075744
	speed: 0.1255s/iter; left time: 2297.6088s
Epoch: 12 cost time: 27.886751174926758
Epoch: 12, Steps: 208 | Train Loss: 2.998 Vali Loss: 3.280 Vali Acc: 0.098 Test Loss: 3.280 Test Acc: 0.098
Validation loss decreased (-0.092123 --> -0.098387).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.2745574
	speed: 0.4153s/iter; left time: 7559.8309s
	iters: 200, epoch: 13 | loss: 2.7829597
	speed: 0.1136s/iter; left time: 2057.0682s
Epoch: 13 cost time: 25.823437690734863
Epoch: 13, Steps: 208 | Train Loss: 2.906 Vali Loss: 3.407 Vali Acc: 0.088 Test Loss: 3.407 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 2.3833699
	speed: 0.3811s/iter; left time: 6857.8828s
	iters: 200, epoch: 14 | loss: 3.2445989
	speed: 0.1228s/iter; left time: 2198.2697s
Epoch: 14 cost time: 25.954514503479004
Epoch: 14, Steps: 208 | Train Loss: 2.845 Vali Loss: 3.329 Vali Acc: 0.107 Test Loss: 3.329 Test Acc: 0.107
Validation loss decreased (-0.098387 --> -0.106737).  Saving model ...
	iters: 100, epoch: 15 | loss: 2.8361812
	speed: 0.3940s/iter; left time: 7009.5935s
	iters: 200, epoch: 15 | loss: 2.7718751
	speed: 0.1086s/iter; left time: 1921.0295s
Epoch: 15 cost time: 24.510417222976685
Epoch: 15, Steps: 208 | Train Loss: 2.798 Vali Loss: 3.359 Vali Acc: 0.103 Test Loss: 3.359 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 2.6903226
	speed: 0.4065s/iter; left time: 7146.7288s
	iters: 200, epoch: 16 | loss: 3.3098214
	speed: 0.1131s/iter; left time: 1977.0470s
Epoch: 16 cost time: 24.305392742156982
Epoch: 16, Steps: 208 | Train Loss: 2.719 Vali Loss: 3.483 Vali Acc: 0.097 Test Loss: 3.483 Test Acc: 0.097
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 2.7220526
	speed: 0.3735s/iter; left time: 6489.6422s
	iters: 200, epoch: 17 | loss: 2.6707277
	speed: 0.1174s/iter; left time: 2028.4996s
Epoch: 17 cost time: 26.568912744522095
Epoch: 17, Steps: 208 | Train Loss: 2.597 Vali Loss: 3.529 Vali Acc: 0.089 Test Loss: 3.529 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 2.9275920
	speed: 0.4224s/iter; left time: 7249.7019s
	iters: 200, epoch: 18 | loss: 2.6323922
	speed: 0.1192s/iter; left time: 2034.7962s
Epoch: 18 cost time: 26.795493364334106
Epoch: 18, Steps: 208 | Train Loss: 2.479 Vali Loss: 3.526 Vali Acc: 0.111 Test Loss: 3.526 Test Acc: 0.111
Validation loss decreased (-0.106737 --> -0.110910).  Saving model ...
	iters: 100, epoch: 19 | loss: 2.3865633
	speed: 0.4193s/iter; left time: 7110.5072s
	iters: 200, epoch: 19 | loss: 2.2091010
	speed: 0.1358s/iter; left time: 2288.7279s
Epoch: 19 cost time: 28.10027837753296
Epoch: 19, Steps: 208 | Train Loss: 2.413 Vali Loss: 3.640 Vali Acc: 0.108 Test Loss: 3.640 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.9621791
	speed: 0.4201s/iter; left time: 7036.3511s
	iters: 200, epoch: 20 | loss: 2.7419171
	speed: 0.1285s/iter; left time: 2139.3784s
Epoch: 20 cost time: 26.861847162246704
Epoch: 20, Steps: 208 | Train Loss: 2.289 Vali Loss: 3.646 Vali Acc: 0.098 Test Loss: 3.646 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 2.1890388
	speed: 0.3990s/iter; left time: 6599.1539s
	iters: 200, epoch: 21 | loss: 1.9738159
	speed: 0.1206s/iter; left time: 1983.2349s
Epoch: 21 cost time: 26.497586965560913
Epoch: 21, Steps: 208 | Train Loss: 2.154 Vali Loss: 3.833 Vali Acc: 0.095 Test Loss: 3.833 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 2.6997755
	speed: 0.3822s/iter; left time: 6242.8937s
	iters: 200, epoch: 22 | loss: 1.7259156
	speed: 0.1046s/iter; left time: 1697.8778s
Epoch: 22 cost time: 23.405742645263672
Epoch: 22, Steps: 208 | Train Loss: 2.108 Vali Loss: 3.845 Vali Acc: 0.098 Test Loss: 3.845 Test Acc: 0.098
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.3455719
	speed: 0.4003s/iter; left time: 6454.0952s
	iters: 200, epoch: 23 | loss: 1.9693708
	speed: 0.1186s/iter; left time: 1899.8680s
Epoch: 23 cost time: 26.666433095932007
Epoch: 23, Steps: 208 | Train Loss: 2.031 Vali Loss: 3.911 Vali Acc: 0.109 Test Loss: 3.911 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 2.0884049
	speed: 0.4315s/iter; left time: 6867.6120s
	iters: 200, epoch: 24 | loss: 2.1866319
	speed: 0.1359s/iter; left time: 2149.7873s
Epoch: 24 cost time: 28.388451099395752
Epoch: 24, Steps: 208 | Train Loss: 1.868 Vali Loss: 4.047 Vali Acc: 0.100 Test Loss: 4.047 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 1.8139876
	speed: 0.4410s/iter; left time: 6927.0399s
	iters: 200, epoch: 25 | loss: 2.0708320
	speed: 0.1459s/iter; left time: 2277.7709s
Epoch: 25 cost time: 30.031206369400024
Epoch: 25, Steps: 208 | Train Loss: 1.781 Vali Loss: 4.126 Vali Acc: 0.093 Test Loss: 4.126 Test Acc: 0.093
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 2.1282742
	speed: 0.4302s/iter; left time: 6669.0237s
	iters: 200, epoch: 26 | loss: 1.3150798
	speed: 0.1346s/iter; left time: 2073.6764s
Epoch: 26 cost time: 28.135708570480347
Epoch: 26, Steps: 208 | Train Loss: 1.691 Vali Loss: 4.238 Vali Acc: 0.099 Test Loss: 4.238 Test Acc: 0.099
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 1.8971281
	speed: 0.4261s/iter; left time: 6516.2569s
	iters: 200, epoch: 27 | loss: 1.4590794
	speed: 0.1331s/iter; left time: 2022.0969s
Epoch: 27 cost time: 27.950783491134644
Epoch: 27, Steps: 208 | Train Loss: 1.622 Vali Loss: 4.339 Vali Acc: 0.101 Test Loss: 4.339 Test Acc: 0.101
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 1.2832541
	speed: 0.4127s/iter; left time: 6225.0083s
	iters: 200, epoch: 28 | loss: 1.4856515
	speed: 0.1315s/iter; left time: 1971.1021s
Epoch: 28 cost time: 27.557474374771118
Epoch: 28, Steps: 208 | Train Loss: 1.497 Vali Loss: 4.513 Vali Acc: 0.105 Test Loss: 4.513 Test Acc: 0.105
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11094542201014017
model parameter : 1900835
model size : 8.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0309172
	speed: 0.1533s/iter; left time: 3172.6713s
	iters: 200, epoch: 1 | loss: 3.8426604
	speed: 0.1243s/iter; left time: 2560.5640s
Epoch: 1 cost time: 28.78803825378418
Epoch: 1, Steps: 208 | Train Loss: 3.713 Vali Loss: 3.651 Vali Acc: 0.053 Test Loss: 3.651 Test Acc: 0.053
Validation loss decreased (inf --> -0.053050).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7346687
	speed: 0.3836s/iter; left time: 7861.9817s
	iters: 200, epoch: 2 | loss: 3.4982359
	speed: 0.1309s/iter; left time: 2668.5510s
Epoch: 2 cost time: 26.275856256484985
Epoch: 2, Steps: 208 | Train Loss: 3.612 Vali Loss: 3.501 Vali Acc: 0.067 Test Loss: 3.501 Test Acc: 0.067
Validation loss decreased (-0.053050 --> -0.066473).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.2980194
	speed: 0.3807s/iter; left time: 7722.9715s
	iters: 200, epoch: 3 | loss: 3.5995426
	speed: 0.1250s/iter; left time: 2523.3054s
Epoch: 3 cost time: 25.559186935424805
Epoch: 3, Steps: 208 | Train Loss: 3.517 Vali Loss: 3.530 Vali Acc: 0.053 Test Loss: 3.530 Test Acc: 0.053
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.3136327
	speed: 0.4107s/iter; left time: 8245.2678s
	iters: 200, epoch: 4 | loss: 3.5241132
	speed: 0.1089s/iter; left time: 2176.1276s
Epoch: 4 cost time: 24.1785671710968
Epoch: 4, Steps: 208 | Train Loss: 3.470 Vali Loss: 3.462 Vali Acc: 0.069 Test Loss: 3.462 Test Acc: 0.069
Validation loss decreased (-0.066473 --> -0.068561).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.4855573
	speed: 0.3934s/iter; left time: 7816.8625s
	iters: 200, epoch: 5 | loss: 3.2915053
	speed: 0.1210s/iter; left time: 2392.8453s
Epoch: 5 cost time: 26.178933143615723
Epoch: 5, Steps: 208 | Train Loss: 3.455 Vali Loss: 3.687 Vali Acc: 0.037 Test Loss: 3.687 Test Acc: 0.037
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.7805896
	speed: 0.3755s/iter; left time: 7382.2394s
	iters: 200, epoch: 6 | loss: 3.6403956
	speed: 0.1196s/iter; left time: 2338.7941s
Epoch: 6 cost time: 24.693676710128784
Epoch: 6, Steps: 208 | Train Loss: 3.733 Vali Loss: 3.628 Vali Acc: 0.036 Test Loss: 3.628 Test Acc: 0.036
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 3.5429378
	speed: 0.4067s/iter; left time: 7910.6618s
	iters: 200, epoch: 7 | loss: 3.3494513
	speed: 0.1186s/iter; left time: 2295.4831s
Epoch: 7 cost time: 26.404274940490723
Epoch: 7, Steps: 208 | Train Loss: 3.610 Vali Loss: 3.556 Vali Acc: 0.050 Test Loss: 3.556 Test Acc: 0.050
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 3.6652327
	speed: 0.3907s/iter; left time: 7519.8077s
	iters: 200, epoch: 8 | loss: 3.8514721
	speed: 0.1041s/iter; left time: 1993.5646s
Epoch: 8 cost time: 24.024425506591797
Epoch: 8, Steps: 208 | Train Loss: 3.590 Vali Loss: 3.593 Vali Acc: 0.041 Test Loss: 3.593 Test Acc: 0.041
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 3.5867209
	speed: 0.3733s/iter; left time: 7106.6901s
	iters: 200, epoch: 9 | loss: 3.4777911
	speed: 0.1054s/iter; left time: 1995.5092s
Epoch: 9 cost time: 23.42481279373169
Epoch: 9, Steps: 208 | Train Loss: 3.598 Vali Loss: 3.604 Vali Acc: 0.042 Test Loss: 3.604 Test Acc: 0.042
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 3.5086277
	speed: 0.3703s/iter; left time: 6972.5523s
	iters: 200, epoch: 10 | loss: 3.4426758
	speed: 0.1092s/iter; left time: 2045.0739s
Epoch: 10 cost time: 24.61179494857788
Epoch: 10, Steps: 208 | Train Loss: 3.587 Vali Loss: 3.560 Vali Acc: 0.048 Test Loss: 3.560 Test Acc: 0.048
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 3.4790230
	speed: 0.3891s/iter; left time: 7245.7882s
	iters: 200, epoch: 11 | loss: 3.5302448
	speed: 0.1194s/iter; left time: 2211.7999s
Epoch: 11 cost time: 25.788458108901978
Epoch: 11, Steps: 208 | Train Loss: 3.582 Vali Loss: 3.579 Vali Acc: 0.048 Test Loss: 3.579 Test Acc: 0.048
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 3.5564744
	speed: 0.4145s/iter; left time: 7631.5767s
	iters: 200, epoch: 12 | loss: 3.6395266
	speed: 0.1214s/iter; left time: 2222.8216s
Epoch: 12 cost time: 26.362446308135986
Epoch: 12, Steps: 208 | Train Loss: 3.594 Vali Loss: 3.563 Vali Acc: 0.044 Test Loss: 3.563 Test Acc: 0.044
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 3.5137234
	speed: 0.4130s/iter; left time: 7518.8051s
	iters: 200, epoch: 13 | loss: 3.5497417
	speed: 0.1211s/iter; left time: 2193.3188s
Epoch: 13 cost time: 26.327975511550903
Epoch: 13, Steps: 208 | Train Loss: 3.570 Vali Loss: 3.555 Vali Acc: 0.046 Test Loss: 3.555 Test Acc: 0.046
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 3.5898592
	speed: 0.4337s/iter; left time: 7804.8548s
	iters: 200, epoch: 14 | loss: 3.4353359
	speed: 0.1243s/iter; left time: 2225.2890s
Epoch: 14 cost time: 27.12273073196411
Epoch: 14, Steps: 208 | Train Loss: 3.561 Vali Loss: 3.553 Vali Acc: 0.044 Test Loss: 3.553 Test Acc: 0.044
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.06859528780196839
model parameter : 1898467
model size : 8.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8241591
	speed: 0.1445s/iter; left time: 2990.7973s
	iters: 200, epoch: 1 | loss: 3.7570000
	speed: 0.1206s/iter; left time: 2485.3195s
Epoch: 1 cost time: 27.774755477905273
Epoch: 1, Steps: 208 | Train Loss: 3.703 Vali Loss: 3.633 Vali Acc: 0.055 Test Loss: 3.633 Test Acc: 0.055
Validation loss decreased (inf --> -0.054542).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3957541
	speed: 0.4105s/iter; left time: 8413.1490s
	iters: 200, epoch: 2 | loss: 3.6619751
	speed: 0.1284s/iter; left time: 2617.5641s
Epoch: 2 cost time: 26.637420892715454
Epoch: 2, Steps: 208 | Train Loss: 3.595 Vali Loss: 3.522 Vali Acc: 0.066 Test Loss: 3.522 Test Acc: 0.066
Validation loss decreased (-0.054542 --> -0.065578).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5416226
	speed: 0.3779s/iter; left time: 7665.2058s
	iters: 200, epoch: 3 | loss: 3.3849385
	speed: 0.1083s/iter; left time: 2186.6240s
Epoch: 3 cost time: 24.004223585128784
Epoch: 3, Steps: 208 | Train Loss: 3.502 Vali Loss: 3.497 Vali Acc: 0.072 Test Loss: 3.497 Test Acc: 0.072
Validation loss decreased (-0.065578 --> -0.071543).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4626386
	speed: 0.4135s/iter; left time: 8301.5158s
	iters: 200, epoch: 4 | loss: 3.6509216
	speed: 0.1241s/iter; left time: 2479.5429s
Epoch: 4 cost time: 26.685383558273315
Epoch: 4, Steps: 208 | Train Loss: 3.451 Vali Loss: 3.473 Vali Acc: 0.073 Test Loss: 3.473 Test Acc: 0.073
Validation loss decreased (-0.071543 --> -0.073332).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.6562333
	speed: 0.4236s/iter; left time: 8417.0814s
	iters: 200, epoch: 5 | loss: 3.7162631
	speed: 0.1249s/iter; left time: 2468.3618s
Epoch: 5 cost time: 26.162548065185547
Epoch: 5, Steps: 208 | Train Loss: 3.415 Vali Loss: 3.441 Vali Acc: 0.076 Test Loss: 3.441 Test Acc: 0.076
Validation loss decreased (-0.073332 --> -0.076315).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0745456
	speed: 0.3920s/iter; left time: 7706.8969s
	iters: 200, epoch: 6 | loss: 3.1856356
	speed: 0.1129s/iter; left time: 2208.7305s
Epoch: 6 cost time: 25.03361487388611
Epoch: 6, Steps: 208 | Train Loss: 3.339 Vali Loss: 3.460 Vali Acc: 0.070 Test Loss: 3.460 Test Acc: 0.070
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.1942284
	speed: 0.3916s/iter; left time: 7617.3764s
	iters: 200, epoch: 7 | loss: 2.9537778
	speed: 0.1285s/iter; left time: 2487.3822s
Epoch: 7 cost time: 26.258694887161255
Epoch: 7, Steps: 208 | Train Loss: 3.284 Vali Loss: 3.400 Vali Acc: 0.079 Test Loss: 3.400 Test Acc: 0.079
Validation loss decreased (-0.076315 --> -0.078701).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.2960112
	speed: 0.3984s/iter; left time: 7666.3445s
	iters: 200, epoch: 8 | loss: 3.1082437
	speed: 0.1091s/iter; left time: 2088.5331s
Epoch: 8 cost time: 24.391849756240845
Epoch: 8, Steps: 208 | Train Loss: 3.208 Vali Loss: 3.319 Vali Acc: 0.094 Test Loss: 3.319 Test Acc: 0.094
Validation loss decreased (-0.078701 --> -0.093614).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.9350250
	speed: 0.3995s/iter; left time: 7605.3753s
	iters: 200, epoch: 9 | loss: 3.4748564
	speed: 0.1253s/iter; left time: 2371.9625s
Epoch: 9 cost time: 26.193446159362793
Epoch: 9, Steps: 208 | Train Loss: 3.137 Vali Loss: 3.306 Vali Acc: 0.090 Test Loss: 3.306 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.5371256
	speed: 0.3970s/iter; left time: 7475.1430s
	iters: 200, epoch: 10 | loss: 2.8066123
	speed: 0.1113s/iter; left time: 2083.7142s
Epoch: 10 cost time: 25.742084741592407
Epoch: 10, Steps: 208 | Train Loss: 3.027 Vali Loss: 3.364 Vali Acc: 0.087 Test Loss: 3.364 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.8616445
	speed: 0.3939s/iter; left time: 7335.2133s
	iters: 200, epoch: 11 | loss: 3.1013291
	speed: 0.1244s/iter; left time: 2304.2055s
Epoch: 11 cost time: 27.024431228637695
Epoch: 11, Steps: 208 | Train Loss: 2.937 Vali Loss: 3.291 Vali Acc: 0.101 Test Loss: 3.291 Test Acc: 0.101
Validation loss decreased (-0.093614 --> -0.101369).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.6571634
	speed: 0.3667s/iter; left time: 6751.6002s
	iters: 200, epoch: 12 | loss: 2.5581398
	speed: 0.1127s/iter; left time: 2064.2213s
Epoch: 12 cost time: 23.84081482887268
Epoch: 12, Steps: 208 | Train Loss: 2.796 Vali Loss: 3.376 Vali Acc: 0.102 Test Loss: 3.376 Test Acc: 0.102
Validation loss decreased (-0.101369 --> -0.101964).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.5919399
	speed: 0.4120s/iter; left time: 7500.6733s
	iters: 200, epoch: 13 | loss: 2.7050908
	speed: 0.1202s/iter; left time: 2176.3953s
Epoch: 13 cost time: 25.842467308044434
Epoch: 13, Steps: 208 | Train Loss: 2.648 Vali Loss: 3.377 Vali Acc: 0.104 Test Loss: 3.377 Test Acc: 0.104
Validation loss decreased (-0.101964 --> -0.103754).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.2987421
	speed: 0.3756s/iter; left time: 6759.2501s
	iters: 200, epoch: 14 | loss: 2.4266493
	speed: 0.1159s/iter; left time: 2074.5762s
Epoch: 14 cost time: 25.07292103767395
Epoch: 14, Steps: 208 | Train Loss: 2.485 Vali Loss: 3.474 Vali Acc: 0.112 Test Loss: 3.474 Test Acc: 0.112
Validation loss decreased (-0.103754 --> -0.112104).  Saving model ...
	iters: 100, epoch: 15 | loss: 2.0189188
	speed: 0.3335s/iter; left time: 5933.4771s
	iters: 200, epoch: 15 | loss: 2.5029578
	speed: 0.1102s/iter; left time: 1948.7114s
Epoch: 15 cost time: 23.48591923713684
Epoch: 15, Steps: 208 | Train Loss: 2.334 Vali Loss: 3.479 Vali Acc: 0.107 Test Loss: 3.479 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 2.1329174
	speed: 0.3883s/iter; left time: 6827.3352s
	iters: 200, epoch: 16 | loss: 2.0590065
	speed: 0.1083s/iter; left time: 1892.3795s
Epoch: 16 cost time: 25.826347827911377
Epoch: 16, Steps: 208 | Train Loss: 2.175 Vali Loss: 3.658 Vali Acc: 0.109 Test Loss: 3.658 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.5770607
	speed: 0.4197s/iter; left time: 7292.1024s
	iters: 200, epoch: 17 | loss: 2.0275664
	speed: 0.1136s/iter; left time: 1962.9999s
Epoch: 17 cost time: 26.88117504119873
Epoch: 17, Steps: 208 | Train Loss: 1.987 Vali Loss: 3.733 Vali Acc: 0.122 Test Loss: 3.733 Test Acc: 0.122
Validation loss decreased (-0.112104 --> -0.121943).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.4458089
	speed: 0.3813s/iter; left time: 6544.2209s
	iters: 200, epoch: 18 | loss: 1.7873993
	speed: 0.1119s/iter; left time: 1910.3779s
Epoch: 18 cost time: 24.67223882675171
Epoch: 18, Steps: 208 | Train Loss: 1.794 Vali Loss: 3.914 Vali Acc: 0.101 Test Loss: 3.914 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.5448020
	speed: 0.4251s/iter; left time: 7208.1861s
	iters: 200, epoch: 19 | loss: 1.4194206
	speed: 0.1391s/iter; left time: 2344.7180s
Epoch: 19 cost time: 28.909416913986206
Epoch: 19, Steps: 208 | Train Loss: 1.670 Vali Loss: 4.067 Vali Acc: 0.111 Test Loss: 4.067 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.8753473
	speed: 0.4077s/iter; left time: 6828.6281s
	iters: 200, epoch: 20 | loss: 1.5206870
	speed: 0.1166s/iter; left time: 1942.1003s
Epoch: 20 cost time: 26.331825971603394
Epoch: 20, Steps: 208 | Train Loss: 1.522 Vali Loss: 4.053 Vali Acc: 0.111 Test Loss: 4.053 Test Acc: 0.111
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 2.0648570
	speed: 0.3821s/iter; left time: 6320.8691s
	iters: 200, epoch: 21 | loss: 1.2239722
	speed: 0.1230s/iter; left time: 2022.3112s
Epoch: 21 cost time: 26.096965789794922
Epoch: 21, Steps: 208 | Train Loss: 1.388 Vali Loss: 4.337 Vali Acc: 0.118 Test Loss: 4.337 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.7083664
	speed: 0.4183s/iter; left time: 6832.8669s
	iters: 200, epoch: 22 | loss: 1.5776228
	speed: 0.1067s/iter; left time: 1731.8635s
Epoch: 22 cost time: 24.756736755371094
Epoch: 22, Steps: 208 | Train Loss: 1.242 Vali Loss: 4.531 Vali Acc: 0.113 Test Loss: 4.531 Test Acc: 0.113
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 1.1597990
	speed: 0.3691s/iter; left time: 5952.4584s
	iters: 200, epoch: 23 | loss: 1.0639648
	speed: 0.1070s/iter; left time: 1715.0494s
Epoch: 23 cost time: 23.613399744033813
Epoch: 23, Steps: 208 | Train Loss: 1.160 Vali Loss: 4.572 Vali Acc: 0.114 Test Loss: 4.572 Test Acc: 0.114
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 1.2315789
	speed: 0.3424s/iter; left time: 5450.3627s
	iters: 200, epoch: 24 | loss: 1.0979134
	speed: 0.1189s/iter; left time: 1880.5654s
Epoch: 24 cost time: 24.422258615493774
Epoch: 24, Steps: 208 | Train Loss: 1.078 Vali Loss: 4.820 Vali Acc: 0.118 Test Loss: 4.820 Test Acc: 0.118
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 1.5118662
	speed: 0.4041s/iter; left time: 6348.3097s
	iters: 200, epoch: 25 | loss: 1.0542363
	speed: 0.1212s/iter; left time: 1892.2869s
Epoch: 25 cost time: 26.32868719100952
Epoch: 25, Steps: 208 | Train Loss: 0.986 Vali Loss: 4.894 Vali Acc: 0.120 Test Loss: 4.894 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 1.1655442
	speed: 0.3861s/iter; left time: 5985.2286s
	iters: 200, epoch: 26 | loss: 0.9341378
	speed: 0.1118s/iter; left time: 1722.5632s
Epoch: 26 cost time: 24.02493906021118
Epoch: 26, Steps: 208 | Train Loss: 0.906 Vali Loss: 5.066 Vali Acc: 0.113 Test Loss: 5.066 Test Acc: 0.113
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.6859985
	speed: 0.3739s/iter; left time: 5717.4846s
	iters: 200, epoch: 27 | loss: 0.9653788
	speed: 0.1208s/iter; left time: 1835.5866s
Epoch: 27 cost time: 25.314128398895264
Epoch: 27, Steps: 208 | Train Loss: 0.821 Vali Loss: 5.335 Vali Acc: 0.110 Test Loss: 5.335 Test Acc: 0.110
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12198031613480466
model parameter : 1311139
model size : 6.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.2669563
	speed: 0.1628s/iter; left time: 3369.3223s
	iters: 200, epoch: 1 | loss: 3.9460821
	speed: 0.1299s/iter; left time: 2676.6282s
Epoch: 1 cost time: 30.38686180114746
Epoch: 1, Steps: 208 | Train Loss: 3.700 Vali Loss: 3.666 Vali Acc: 0.051 Test Loss: 3.666 Test Acc: 0.051
Validation loss decreased (inf --> -0.051261).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8593535
	speed: 0.4460s/iter; left time: 9140.0929s
	iters: 200, epoch: 2 | loss: 3.5937960
	speed: 0.1321s/iter; left time: 2694.5073s
Epoch: 2 cost time: 28.371381759643555
Epoch: 2, Steps: 208 | Train Loss: 3.625 Vali Loss: 3.512 Vali Acc: 0.063 Test Loss: 3.512 Test Acc: 0.063
Validation loss decreased (-0.051261 --> -0.062894).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5992591
	speed: 0.4170s/iter; left time: 8459.6437s
	iters: 200, epoch: 3 | loss: 3.4238555
	speed: 0.1180s/iter; left time: 2382.3659s
Epoch: 3 cost time: 25.67707896232605
Epoch: 3, Steps: 208 | Train Loss: 3.568 Vali Loss: 3.550 Vali Acc: 0.058 Test Loss: 3.550 Test Acc: 0.058
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.4517999
	speed: 0.4356s/iter; left time: 8746.4844s
	iters: 200, epoch: 4 | loss: 3.3587677
	speed: 0.1366s/iter; left time: 2729.2433s
Epoch: 4 cost time: 28.64843726158142
Epoch: 4, Steps: 208 | Train Loss: 3.511 Vali Loss: 3.486 Vali Acc: 0.060 Test Loss: 3.486 Test Acc: 0.060
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 3.4272025
	speed: 0.4275s/iter; left time: 8493.8296s
	iters: 200, epoch: 5 | loss: 3.5373154
	speed: 0.1284s/iter; left time: 2539.2808s
Epoch: 5 cost time: 27.63748574256897
Epoch: 5, Steps: 208 | Train Loss: 3.451 Vali Loss: 3.519 Vali Acc: 0.067 Test Loss: 3.519 Test Acc: 0.067
Validation loss decreased (-0.062894 --> -0.066771).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.5546310
	speed: 0.4472s/iter; left time: 8791.9640s
	iters: 200, epoch: 6 | loss: 3.5667071
	speed: 0.1294s/iter; left time: 2530.9627s
Epoch: 6 cost time: 27.76073384284973
Epoch: 6, Steps: 208 | Train Loss: 3.427 Vali Loss: 3.486 Vali Acc: 0.066 Test Loss: 3.486 Test Acc: 0.066
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.6338644
	speed: 0.4599s/iter; left time: 8947.0153s
	iters: 200, epoch: 7 | loss: 3.0219443
	speed: 0.1207s/iter; left time: 2336.8260s
Epoch: 7 cost time: 27.942920923233032
Epoch: 7, Steps: 208 | Train Loss: 3.378 Vali Loss: 3.451 Vali Acc: 0.063 Test Loss: 3.451 Test Acc: 0.063
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.3329020
	speed: 0.4153s/iter; left time: 7993.1597s
	iters: 200, epoch: 8 | loss: 3.3423057
	speed: 0.1367s/iter; left time: 2616.5781s
Epoch: 8 cost time: 28.86558961868286
Epoch: 8, Steps: 208 | Train Loss: 3.311 Vali Loss: 3.464 Vali Acc: 0.068 Test Loss: 3.464 Test Acc: 0.068
Validation loss decreased (-0.066771 --> -0.067666).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.8258038
	speed: 0.4661s/iter; left time: 8873.2757s
	iters: 200, epoch: 9 | loss: 3.3417912
	speed: 0.1293s/iter; left time: 2448.7079s
Epoch: 9 cost time: 27.160115718841553
Epoch: 9, Steps: 208 | Train Loss: 3.265 Vali Loss: 3.367 Vali Acc: 0.078 Test Loss: 3.367 Test Acc: 0.078
Validation loss decreased (-0.067666 --> -0.077807).  Saving model ...
	iters: 100, epoch: 10 | loss: 3.4072654
	speed: 0.4592s/iter; left time: 8646.8421s
	iters: 200, epoch: 10 | loss: 3.1747773
	speed: 0.1420s/iter; left time: 2659.6989s
Epoch: 10 cost time: 29.82124400138855
Epoch: 10, Steps: 208 | Train Loss: 3.178 Vali Loss: 3.328 Vali Acc: 0.089 Test Loss: 3.328 Test Acc: 0.089
Validation loss decreased (-0.077807 --> -0.088544).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.8231003
	speed: 0.4649s/iter; left time: 8657.3180s
	iters: 200, epoch: 11 | loss: 3.5075555
	speed: 0.1177s/iter; left time: 2180.1139s
Epoch: 11 cost time: 28.402005434036255
Epoch: 11, Steps: 208 | Train Loss: 3.103 Vali Loss: 3.333 Vali Acc: 0.090 Test Loss: 3.333 Test Acc: 0.090
Validation loss decreased (-0.088544 --> -0.090334).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.7085330
	speed: 0.3984s/iter; left time: 7336.2020s
	iters: 200, epoch: 12 | loss: 2.4264948
	speed: 0.1100s/iter; left time: 2014.6113s
Epoch: 12 cost time: 23.456961154937744
Epoch: 12, Steps: 208 | Train Loss: 2.977 Vali Loss: 3.327 Vali Acc: 0.090 Test Loss: 3.327 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.9952111
	speed: 0.3797s/iter; left time: 6912.9494s
	iters: 200, epoch: 13 | loss: 2.7033055
	speed: 0.1164s/iter; left time: 2107.2157s
Epoch: 13 cost time: 25.14737057685852
Epoch: 13, Steps: 208 | Train Loss: 2.878 Vali Loss: 3.343 Vali Acc: 0.097 Test Loss: 3.343 Test Acc: 0.097
Validation loss decreased (-0.090334 --> -0.097193).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.4929395
	speed: 0.4199s/iter; left time: 7556.0557s
	iters: 200, epoch: 14 | loss: 2.9683118
	speed: 0.1258s/iter; left time: 2251.0915s
Epoch: 14 cost time: 26.104071378707886
Epoch: 14, Steps: 208 | Train Loss: 2.776 Vali Loss: 3.405 Vali Acc: 0.084 Test Loss: 3.405 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.3077941
	speed: 0.4145s/iter; left time: 7374.2486s
	iters: 200, epoch: 15 | loss: 2.8050261
	speed: 0.1234s/iter; left time: 2181.9756s
Epoch: 15 cost time: 25.824843883514404
Epoch: 15, Steps: 208 | Train Loss: 2.605 Vali Loss: 3.452 Vali Acc: 0.105 Test Loss: 3.452 Test Acc: 0.105
Validation loss decreased (-0.097193 --> -0.104648).  Saving model ...
	iters: 100, epoch: 16 | loss: 2.3016253
	speed: 0.3899s/iter; left time: 6854.7097s
	iters: 200, epoch: 16 | loss: 2.6144094
	speed: 0.1193s/iter; left time: 2084.7336s
Epoch: 16 cost time: 24.615955352783203
Epoch: 16, Steps: 208 | Train Loss: 2.483 Vali Loss: 3.599 Vali Acc: 0.108 Test Loss: 3.599 Test Acc: 0.108
Validation loss decreased (-0.104648 --> -0.107629).  Saving model ...
	iters: 100, epoch: 17 | loss: 2.4294121
	speed: 0.3926s/iter; left time: 6820.8954s
	iters: 200, epoch: 17 | loss: 2.3666205
	speed: 0.1270s/iter; left time: 2193.6271s
Epoch: 17 cost time: 25.87733244895935
Epoch: 17, Steps: 208 | Train Loss: 2.381 Vali Loss: 3.593 Vali Acc: 0.110 Test Loss: 3.593 Test Acc: 0.110
Validation loss decreased (-0.107629 --> -0.109717).  Saving model ...
	iters: 100, epoch: 18 | loss: 2.1159813
	speed: 0.4014s/iter; left time: 6889.2340s
	iters: 200, epoch: 18 | loss: 2.1698265
	speed: 0.1099s/iter; left time: 1875.1731s
Epoch: 18 cost time: 23.572564125061035
Epoch: 18, Steps: 208 | Train Loss: 2.240 Vali Loss: 3.592 Vali Acc: 0.106 Test Loss: 3.592 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.7874924
	speed: 0.4170s/iter; left time: 7071.6279s
	iters: 200, epoch: 19 | loss: 2.2927206
	speed: 0.1131s/iter; left time: 1906.3044s
Epoch: 19 cost time: 25.879018306732178
Epoch: 19, Steps: 208 | Train Loss: 2.088 Vali Loss: 3.742 Vali Acc: 0.110 Test Loss: 3.742 Test Acc: 0.110
Validation loss decreased (-0.109717 --> -0.110312).  Saving model ...
	iters: 100, epoch: 20 | loss: 2.4230149
	speed: 0.4184s/iter; left time: 7007.9427s
	iters: 200, epoch: 20 | loss: 2.6594782
	speed: 0.1396s/iter; left time: 2323.8735s
Epoch: 20 cost time: 28.11866307258606
Epoch: 20, Steps: 208 | Train Loss: 1.950 Vali Loss: 3.894 Vali Acc: 0.105 Test Loss: 3.894 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 2.3055687
	speed: 0.4318s/iter; left time: 7142.6572s
	iters: 200, epoch: 21 | loss: 1.8592408
	speed: 0.1265s/iter; left time: 2079.0775s
Epoch: 21 cost time: 26.534657955169678
Epoch: 21, Steps: 208 | Train Loss: 1.797 Vali Loss: 4.043 Vali Acc: 0.100 Test Loss: 4.043 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.9029356
	speed: 0.4235s/iter; left time: 6917.2865s
	iters: 200, epoch: 22 | loss: 2.3311024
	speed: 0.1264s/iter; left time: 2051.9341s
Epoch: 22 cost time: 26.842243194580078
Epoch: 22, Steps: 208 | Train Loss: 1.694 Vali Loss: 4.236 Vali Acc: 0.100 Test Loss: 4.236 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 1.4917564
	speed: 0.4516s/iter; left time: 7282.8406s
	iters: 200, epoch: 23 | loss: 1.7317851
	speed: 0.1183s/iter; left time: 1895.1243s
Epoch: 23 cost time: 28.019901037216187
Epoch: 23, Steps: 208 | Train Loss: 1.559 Vali Loss: 4.316 Vali Acc: 0.100 Test Loss: 4.316 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 1.6382068
	speed: 0.4508s/iter; left time: 7175.5561s
	iters: 200, epoch: 24 | loss: 1.2933415
	speed: 0.1336s/iter; left time: 2112.4447s
Epoch: 24 cost time: 28.350515365600586
Epoch: 24, Steps: 208 | Train Loss: 1.447 Vali Loss: 4.415 Vali Acc: 0.109 Test Loss: 4.415 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 1.5031190
	speed: 0.4192s/iter; left time: 6585.9196s
	iters: 200, epoch: 25 | loss: 1.2938073
	speed: 0.1293s/iter; left time: 2017.9821s
Epoch: 25 cost time: 27.8845374584198
Epoch: 25, Steps: 208 | Train Loss: 1.377 Vali Loss: 4.527 Vali Acc: 0.102 Test Loss: 4.527 Test Acc: 0.102
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 1.5187638
	speed: 0.4421s/iter; left time: 6852.8720s
	iters: 200, epoch: 26 | loss: 1.3567868
	speed: 0.1183s/iter; left time: 1821.3359s
Epoch: 26 cost time: 28.143921375274658
Epoch: 26, Steps: 208 | Train Loss: 1.245 Vali Loss: 4.664 Vali Acc: 0.100 Test Loss: 4.664 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 1.3906325
	speed: 0.3964s/iter; left time: 6062.3081s
	iters: 200, epoch: 27 | loss: 2.0024862
	speed: 0.1284s/iter; left time: 1950.1529s
Epoch: 27 cost time: 26.563982486724854
Epoch: 27, Steps: 208 | Train Loss: 1.211 Vali Loss: 4.990 Vali Acc: 0.085 Test Loss: 4.990 Test Acc: 0.085
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 1.0966669
	speed: 0.4171s/iter; left time: 6292.6124s
	iters: 200, epoch: 28 | loss: 0.7902256
	speed: 0.1190s/iter; left time: 1782.5171s
Epoch: 28 cost time: 25.989973783493042
Epoch: 28, Steps: 208 | Train Loss: 1.130 Vali Loss: 5.013 Vali Acc: 0.095 Test Loss: 5.013 Test Acc: 0.095
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.9027746
	speed: 0.3871s/iter; left time: 5759.3954s
	iters: 200, epoch: 29 | loss: 0.9866347
	speed: 0.1150s/iter; left time: 1699.8766s
Epoch: 29 cost time: 24.483136653900146
Epoch: 29, Steps: 208 | Train Loss: 1.025 Vali Loss: 5.250 Vali Acc: 0.097 Test Loss: 5.250 Test Acc: 0.097
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1103489412466448
model parameter : 1308771
model size : 6.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8023009
	speed: 0.1763s/iter; left time: 3648.5881s
	iters: 200, epoch: 1 | loss: 3.5052989
	speed: 0.1329s/iter; left time: 2738.7616s
Epoch: 1 cost time: 32.06547951698303
Epoch: 1, Steps: 208 | Train Loss: 3.694 Vali Loss: 3.618 Vali Acc: 0.056 Test Loss: 3.618 Test Acc: 0.056
Validation loss decreased (inf --> -0.056331).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4349205
	speed: 0.3869s/iter; left time: 7928.3121s
	iters: 200, epoch: 2 | loss: 2.9613881
	speed: 0.1488s/iter; left time: 3034.9263s
Epoch: 2 cost time: 31.38675022125244
Epoch: 2, Steps: 208 | Train Loss: 3.601 Vali Loss: 3.576 Vali Acc: 0.070 Test Loss: 3.576 Test Acc: 0.070
Validation loss decreased (-0.056331 --> -0.070349).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7171447
	speed: 0.4111s/iter; left time: 8339.2137s
	iters: 200, epoch: 3 | loss: 3.5592468
	speed: 0.1374s/iter; left time: 2773.2425s
Epoch: 3 cost time: 29.538820266723633
Epoch: 3, Steps: 208 | Train Loss: 3.512 Vali Loss: 3.580 Vali Acc: 0.061 Test Loss: 3.580 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.0542095
	speed: 0.4073s/iter; left time: 8176.7313s
	iters: 200, epoch: 4 | loss: 3.5068815
	speed: 0.1053s/iter; left time: 2103.9767s
Epoch: 4 cost time: 23.706495761871338
Epoch: 4, Steps: 208 | Train Loss: 3.456 Vali Loss: 3.472 Vali Acc: 0.075 Test Loss: 3.472 Test Acc: 0.075
Validation loss decreased (-0.070349 --> -0.075420).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.5753841
	speed: 0.3701s/iter; left time: 7353.4980s
	iters: 200, epoch: 5 | loss: 3.2904525
	speed: 0.1167s/iter; left time: 2307.6668s
Epoch: 5 cost time: 25.257758617401123
Epoch: 5, Steps: 208 | Train Loss: 3.387 Vali Loss: 3.472 Vali Acc: 0.071 Test Loss: 3.472 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.4502096
	speed: 0.3750s/iter; left time: 7372.1547s
	iters: 200, epoch: 6 | loss: 3.7006941
	speed: 0.1168s/iter; left time: 2283.9904s
Epoch: 6 cost time: 25.21928596496582
Epoch: 6, Steps: 208 | Train Loss: 3.346 Vali Loss: 3.436 Vali Acc: 0.066 Test Loss: 3.436 Test Acc: 0.066
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 3.3275063
	speed: 0.3657s/iter; left time: 7114.4399s
	iters: 200, epoch: 7 | loss: 3.1128983
	speed: 0.1106s/iter; left time: 2141.1470s
Epoch: 7 cost time: 24.736355781555176
Epoch: 7, Steps: 208 | Train Loss: 3.275 Vali Loss: 3.402 Vali Acc: 0.068 Test Loss: 3.402 Test Acc: 0.068
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 3.5183806
	speed: 0.3810s/iter; left time: 7332.0558s
	iters: 200, epoch: 8 | loss: 3.4758480
	speed: 0.1269s/iter; left time: 2430.3664s
Epoch: 8 cost time: 25.90582251548767
Epoch: 8, Steps: 208 | Train Loss: 3.182 Vali Loss: 3.372 Vali Acc: 0.089 Test Loss: 3.372 Test Acc: 0.089
Validation loss decreased (-0.075420 --> -0.088842).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.3363912
	speed: 0.4116s/iter; left time: 7835.1511s
	iters: 200, epoch: 9 | loss: 3.0911613
	speed: 0.1241s/iter; left time: 2350.8437s
Epoch: 9 cost time: 27.069506883621216
Epoch: 9, Steps: 208 | Train Loss: 3.105 Vali Loss: 3.297 Vali Acc: 0.102 Test Loss: 3.297 Test Acc: 0.102
Validation loss decreased (-0.088842 --> -0.101965).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.8306656
	speed: 0.4216s/iter; left time: 7937.9470s
	iters: 200, epoch: 10 | loss: 2.9089308
	speed: 0.1206s/iter; left time: 2259.2814s
Epoch: 10 cost time: 27.124595403671265
Epoch: 10, Steps: 208 | Train Loss: 2.994 Vali Loss: 3.373 Vali Acc: 0.085 Test Loss: 3.373 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 3.2792492
	speed: 0.4031s/iter; left time: 7506.2035s
	iters: 200, epoch: 11 | loss: 2.9575896
	speed: 0.1253s/iter; left time: 2320.7925s
Epoch: 11 cost time: 26.21633005142212
Epoch: 11, Steps: 208 | Train Loss: 2.870 Vali Loss: 3.370 Vali Acc: 0.099 Test Loss: 3.370 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 2.3307476
	speed: 0.4007s/iter; left time: 7377.4319s
	iters: 200, epoch: 12 | loss: 2.8330243
	speed: 0.1329s/iter; left time: 2432.9113s
Epoch: 12 cost time: 25.856441736221313
Epoch: 12, Steps: 208 | Train Loss: 2.739 Vali Loss: 3.345 Vali Acc: 0.105 Test Loss: 3.345 Test Acc: 0.105
Validation loss decreased (-0.101965 --> -0.104649).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.6446066
	speed: 0.3702s/iter; left time: 6739.5765s
	iters: 200, epoch: 13 | loss: 2.6171219
	speed: 0.1111s/iter; left time: 2011.7147s
Epoch: 13 cost time: 24.07808804512024
Epoch: 13, Steps: 208 | Train Loss: 2.608 Vali Loss: 3.454 Vali Acc: 0.110 Test Loss: 3.454 Test Acc: 0.110
Validation loss decreased (-0.104649 --> -0.109718).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.9749086
	speed: 0.4060s/iter; left time: 7306.0426s
	iters: 200, epoch: 14 | loss: 3.2752049
	speed: 0.1102s/iter; left time: 1971.5985s
Epoch: 14 cost time: 24.72438907623291
Epoch: 14, Steps: 208 | Train Loss: 2.458 Vali Loss: 3.606 Vali Acc: 0.101 Test Loss: 3.606 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.4767950
	speed: 0.3771s/iter; left time: 6709.1211s
	iters: 200, epoch: 15 | loss: 2.8833566
	speed: 0.1175s/iter; left time: 2078.7940s
Epoch: 15 cost time: 25.996392726898193
Epoch: 15, Steps: 208 | Train Loss: 2.246 Vali Loss: 3.597 Vali Acc: 0.108 Test Loss: 3.597 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.8595638
	speed: 0.4080s/iter; left time: 7172.8620s
	iters: 200, epoch: 16 | loss: 1.9009600
	speed: 0.1175s/iter; left time: 2054.4752s
Epoch: 16 cost time: 25.3537757396698
Epoch: 16, Steps: 208 | Train Loss: 2.062 Vali Loss: 3.666 Vali Acc: 0.110 Test Loss: 3.666 Test Acc: 0.110
Validation loss decreased (-0.109718 --> -0.110312).  Saving model ...
	iters: 100, epoch: 17 | loss: 2.2354152
	speed: 0.3969s/iter; left time: 6895.8340s
	iters: 200, epoch: 17 | loss: 2.4843066
	speed: 0.1244s/iter; left time: 2148.3282s
Epoch: 17 cost time: 26.7927565574646
Epoch: 17, Steps: 208 | Train Loss: 1.873 Vali Loss: 3.738 Vali Acc: 0.115 Test Loss: 3.738 Test Acc: 0.115
Validation loss decreased (-0.110312 --> -0.114785).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.6438818
	speed: 0.3978s/iter; left time: 6828.0764s
	iters: 200, epoch: 18 | loss: 1.7171282
	speed: 0.1278s/iter; left time: 2181.2376s
Epoch: 18 cost time: 27.6668803691864
Epoch: 18, Steps: 208 | Train Loss: 1.695 Vali Loss: 4.123 Vali Acc: 0.106 Test Loss: 4.123 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.2793349
	speed: 0.3838s/iter; left time: 6507.4276s
	iters: 200, epoch: 19 | loss: 1.5634046
	speed: 0.1161s/iter; left time: 1956.3341s
Epoch: 19 cost time: 24.796091318130493
Epoch: 19, Steps: 208 | Train Loss: 1.518 Vali Loss: 4.256 Vali Acc: 0.103 Test Loss: 4.256 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.2738515
	speed: 0.3852s/iter; left time: 6452.3348s
	iters: 200, epoch: 20 | loss: 1.5876478
	speed: 0.1173s/iter; left time: 1952.3283s
Epoch: 20 cost time: 25.31575870513916
Epoch: 20, Steps: 208 | Train Loss: 1.374 Vali Loss: 4.412 Vali Acc: 0.106 Test Loss: 4.412 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 1.4513620
	speed: 0.3642s/iter; left time: 6024.4484s
	iters: 200, epoch: 21 | loss: 1.2866923
	speed: 0.1030s/iter; left time: 1693.0349s
Epoch: 21 cost time: 23.585484981536865
Epoch: 21, Steps: 208 | Train Loss: 1.243 Vali Loss: 4.638 Vali Acc: 0.113 Test Loss: 4.638 Test Acc: 0.113
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 1.1989980
	speed: 0.3818s/iter; left time: 6236.2014s
	iters: 200, epoch: 22 | loss: 1.5039387
	speed: 0.1165s/iter; left time: 1891.1511s
Epoch: 22 cost time: 24.709693908691406
Epoch: 22, Steps: 208 | Train Loss: 1.121 Vali Loss: 4.763 Vali Acc: 0.100 Test Loss: 4.763 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 1.1663840
	speed: 0.3591s/iter; left time: 5790.1893s
	iters: 200, epoch: 23 | loss: 1.5324912
	speed: 0.1236s/iter; left time: 1980.8061s
Epoch: 23 cost time: 25.124001026153564
Epoch: 23, Steps: 208 | Train Loss: 0.989 Vali Loss: 4.843 Vali Acc: 0.114 Test Loss: 4.843 Test Acc: 0.114
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 1.2259505
	speed: 0.3495s/iter; left time: 5563.7087s
	iters: 200, epoch: 24 | loss: 0.6516596
	speed: 0.1174s/iter; left time: 1857.4983s
Epoch: 24 cost time: 25.18418312072754
Epoch: 24, Steps: 208 | Train Loss: 0.907 Vali Loss: 5.023 Vali Acc: 0.109 Test Loss: 5.023 Test Acc: 0.109
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.4437509
	speed: 0.4017s/iter; left time: 6310.6331s
	iters: 200, epoch: 25 | loss: 1.3228072
	speed: 0.1245s/iter; left time: 1942.9319s
Epoch: 25 cost time: 25.91739010810852
Epoch: 25, Steps: 208 | Train Loss: 0.828 Vali Loss: 5.148 Vali Acc: 0.109 Test Loss: 5.148 Test Acc: 0.109
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 1.1896952
	speed: 0.3932s/iter; left time: 6094.2651s
	iters: 200, epoch: 26 | loss: 0.9230602
	speed: 0.1179s/iter; left time: 1815.2470s
Epoch: 26 cost time: 25.267569065093994
Epoch: 26, Steps: 208 | Train Loss: 0.802 Vali Loss: 5.351 Vali Acc: 0.110 Test Loss: 5.351 Test Acc: 0.110
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.4479179
	speed: 0.3649s/iter; left time: 5580.7096s
	iters: 200, epoch: 27 | loss: 0.7293365
	speed: 0.1176s/iter; left time: 1786.0690s
Epoch: 27 cost time: 24.19689440727234
Epoch: 27, Steps: 208 | Train Loss: 0.771 Vali Loss: 5.590 Vali Acc: 0.115 Test Loss: 5.590 Test Acc: 0.115
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11482254697286012
model parameter : 1306403
model size : 6.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.2119427
	speed: 0.1621s/iter; left time: 3355.7373s
	iters: 200, epoch: 1 | loss: 3.9006526
	speed: 0.1431s/iter; left time: 2948.1276s
Epoch: 1 cost time: 31.705971002578735
Epoch: 1, Steps: 208 | Train Loss: 3.699 Vali Loss: 3.648 Vali Acc: 0.044 Test Loss: 3.648 Test Acc: 0.044
Validation loss decreased (inf --> -0.043805).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5617840
	speed: 0.4175s/iter; left time: 8556.3009s
	iters: 200, epoch: 2 | loss: 3.7942562
	speed: 0.1210s/iter; left time: 2468.1463s
Epoch: 2 cost time: 26.21925640106201
Epoch: 2, Steps: 208 | Train Loss: 3.597 Vali Loss: 3.534 Vali Acc: 0.055 Test Loss: 3.534 Test Acc: 0.055
Validation loss decreased (-0.043805 --> -0.055437).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.9243639
	speed: 0.4254s/iter; left time: 8628.2905s
	iters: 200, epoch: 3 | loss: 3.4775290
	speed: 0.1294s/iter; left time: 2611.2164s
Epoch: 3 cost time: 26.99370551109314
Epoch: 3, Steps: 208 | Train Loss: 3.521 Vali Loss: 3.482 Vali Acc: 0.067 Test Loss: 3.482 Test Acc: 0.067
Validation loss decreased (-0.055437 --> -0.067368).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.6993279
	speed: 0.4367s/iter; left time: 8768.4313s
	iters: 200, epoch: 4 | loss: 3.3223658
	speed: 0.1359s/iter; left time: 2714.3731s
Epoch: 4 cost time: 29.64942169189453
Epoch: 4, Steps: 208 | Train Loss: 3.456 Vali Loss: 3.470 Vali Acc: 0.072 Test Loss: 3.470 Test Acc: 0.072
Validation loss decreased (-0.067368 --> -0.071543).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.5277476
	speed: 0.3898s/iter; left time: 7744.8283s
	iters: 200, epoch: 5 | loss: 3.2605441
	speed: 0.1168s/iter; left time: 2309.8948s
Epoch: 5 cost time: 25.455113649368286
Epoch: 5, Steps: 208 | Train Loss: 3.374 Vali Loss: 3.396 Vali Acc: 0.084 Test Loss: 3.396 Test Acc: 0.084
Validation loss decreased (-0.071543 --> -0.083473).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.9505036
	speed: 0.4416s/iter; left time: 8681.7195s
	iters: 200, epoch: 6 | loss: 3.3707199
	speed: 0.1376s/iter; left time: 2691.3226s
Epoch: 6 cost time: 28.90598464012146
Epoch: 6, Steps: 208 | Train Loss: 3.266 Vali Loss: 3.280 Vali Acc: 0.088 Test Loss: 3.280 Test Acc: 0.088
Validation loss decreased (-0.083473 --> -0.088246).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9826384
	speed: 0.4534s/iter; left time: 8820.8273s
	iters: 200, epoch: 7 | loss: 2.7746725
	speed: 0.1290s/iter; left time: 2495.6348s
Epoch: 7 cost time: 27.814514875411987
Epoch: 7, Steps: 208 | Train Loss: 3.126 Vali Loss: 3.221 Vali Acc: 0.099 Test Loss: 3.221 Test Acc: 0.099
Validation loss decreased (-0.088246 --> -0.098984).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.6968074
	speed: 0.3992s/iter; left time: 7682.1708s
	iters: 200, epoch: 8 | loss: 2.7262936
	speed: 0.1134s/iter; left time: 2171.2048s
Epoch: 8 cost time: 24.4813334941864
Epoch: 8, Steps: 208 | Train Loss: 3.026 Vali Loss: 3.149 Vali Acc: 0.104 Test Loss: 3.149 Test Acc: 0.104
Validation loss decreased (-0.098984 --> -0.104054).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.6693237
	speed: 0.4215s/iter; left time: 8023.2055s
	iters: 200, epoch: 9 | loss: 3.1543925
	speed: 0.1155s/iter; left time: 2187.4245s
Epoch: 9 cost time: 24.97545051574707
Epoch: 9, Steps: 208 | Train Loss: 2.911 Vali Loss: 3.161 Vali Acc: 0.104 Test Loss: 3.161 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.4740896
	speed: 0.4096s/iter; left time: 7713.1095s
	iters: 200, epoch: 10 | loss: 2.7615774
	speed: 0.1273s/iter; left time: 2383.2926s
Epoch: 10 cost time: 27.42400550842285
Epoch: 10, Steps: 208 | Train Loss: 2.799 Vali Loss: 3.233 Vali Acc: 0.106 Test Loss: 3.233 Test Acc: 0.106
Validation loss decreased (-0.104054 --> -0.106141).  Saving model ...
	iters: 100, epoch: 11 | loss: 3.0576396
	speed: 0.4074s/iter; left time: 7586.2805s
	iters: 200, epoch: 11 | loss: 2.3682792
	speed: 0.1099s/iter; left time: 2035.8584s
Epoch: 11 cost time: 24.773600578308105
Epoch: 11, Steps: 208 | Train Loss: 2.649 Vali Loss: 3.259 Vali Acc: 0.109 Test Loss: 3.259 Test Acc: 0.109
Validation loss decreased (-0.106141 --> -0.109123).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.0418849
	speed: 0.4281s/iter; left time: 7881.8183s
	iters: 200, epoch: 12 | loss: 2.2601097
	speed: 0.1305s/iter; left time: 2389.9791s
Epoch: 12 cost time: 28.426176071166992
Epoch: 12, Steps: 208 | Train Loss: 2.493 Vali Loss: 3.310 Vali Acc: 0.120 Test Loss: 3.310 Test Acc: 0.120
Validation loss decreased (-0.109123 --> -0.120456).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.4474039
	speed: 0.4463s/iter; left time: 8124.9962s
	iters: 200, epoch: 13 | loss: 2.6098361
	speed: 0.1440s/iter; left time: 2607.9363s
Epoch: 13 cost time: 29.28260064125061
Epoch: 13, Steps: 208 | Train Loss: 2.382 Vali Loss: 3.449 Vali Acc: 0.122 Test Loss: 3.449 Test Acc: 0.122
Validation loss decreased (-0.120456 --> -0.121946).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.0674565
	speed: 0.4402s/iter; left time: 7922.4063s
	iters: 200, epoch: 14 | loss: 2.3141010
	speed: 0.1253s/iter; left time: 2242.7894s
Epoch: 14 cost time: 26.522143363952637
Epoch: 14, Steps: 208 | Train Loss: 2.182 Vali Loss: 3.526 Vali Acc: 0.125 Test Loss: 3.526 Test Acc: 0.125
Validation loss decreased (-0.121946 --> -0.125226).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.9079247
	speed: 0.4599s/iter; left time: 8181.8820s
	iters: 200, epoch: 15 | loss: 1.6221490
	speed: 0.1237s/iter; left time: 2188.9916s
Epoch: 15 cost time: 27.911430835723877
Epoch: 15, Steps: 208 | Train Loss: 2.091 Vali Loss: 3.675 Vali Acc: 0.112 Test Loss: 3.675 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 2.2402449
	speed: 0.4363s/iter; left time: 7671.3245s
	iters: 200, epoch: 16 | loss: 2.5661471
	speed: 0.1179s/iter; left time: 2060.4371s
Epoch: 16 cost time: 27.4769024848938
Epoch: 16, Steps: 208 | Train Loss: 1.907 Vali Loss: 3.672 Vali Acc: 0.112 Test Loss: 3.672 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 2.2725997
	speed: 0.3586s/iter; left time: 6230.4356s
	iters: 200, epoch: 17 | loss: 1.9883498
	speed: 0.1341s/iter; left time: 2315.5020s
Epoch: 17 cost time: 26.53198003768921
Epoch: 17, Steps: 208 | Train Loss: 1.740 Vali Loss: 4.023 Vali Acc: 0.109 Test Loss: 4.023 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.8009064
	speed: 0.4280s/iter; left time: 7346.7059s
	iters: 200, epoch: 18 | loss: 1.6128131
	speed: 0.1220s/iter; left time: 2081.1221s
Epoch: 18 cost time: 27.676729679107666
Epoch: 18, Steps: 208 | Train Loss: 1.607 Vali Loss: 4.120 Vali Acc: 0.119 Test Loss: 4.120 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.2982256
	speed: 0.4306s/iter; left time: 7302.2409s
	iters: 200, epoch: 19 | loss: 1.7016228
	speed: 0.1438s/iter; left time: 2424.2843s
Epoch: 19 cost time: 30.214359760284424
Epoch: 19, Steps: 208 | Train Loss: 1.484 Vali Loss: 4.154 Vali Acc: 0.118 Test Loss: 4.154 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 1.5491446
	speed: 0.3840s/iter; left time: 6432.3319s
	iters: 200, epoch: 20 | loss: 1.1574094
	speed: 0.1343s/iter; left time: 2236.4133s
Epoch: 20 cost time: 26.363008737564087
Epoch: 20, Steps: 208 | Train Loss: 1.367 Vali Loss: 4.324 Vali Acc: 0.119 Test Loss: 4.324 Test Acc: 0.119
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.7966868
	speed: 0.4232s/iter; left time: 7000.4382s
	iters: 200, epoch: 21 | loss: 1.0527903
	speed: 0.1290s/iter; left time: 2121.1168s
Epoch: 21 cost time: 27.01229190826416
Epoch: 21, Steps: 208 | Train Loss: 1.257 Vali Loss: 4.584 Vali Acc: 0.120 Test Loss: 4.584 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.9651065
	speed: 0.4396s/iter; left time: 7180.4805s
	iters: 200, epoch: 22 | loss: 0.9092110
	speed: 0.1185s/iter; left time: 1924.3291s
Epoch: 22 cost time: 26.50881814956665
Epoch: 22, Steps: 208 | Train Loss: 1.172 Vali Loss: 4.554 Vali Acc: 0.122 Test Loss: 4.554 Test Acc: 0.122
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.9010379
	speed: 0.3714s/iter; left time: 5989.2222s
	iters: 200, epoch: 23 | loss: 1.9273701
	speed: 0.1260s/iter; left time: 2019.0439s
Epoch: 23 cost time: 25.68975853919983
Epoch: 23, Steps: 208 | Train Loss: 1.079 Vali Loss: 4.845 Vali Acc: 0.111 Test Loss: 4.845 Test Acc: 0.111
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.9659446
	speed: 0.4084s/iter; left time: 6500.5423s
	iters: 200, epoch: 24 | loss: 1.8660293
	speed: 0.1256s/iter; left time: 1987.3711s
Epoch: 24 cost time: 27.08655834197998
Epoch: 24, Steps: 208 | Train Loss: 0.994 Vali Loss: 4.819 Vali Acc: 0.123 Test Loss: 4.819 Test Acc: 0.123
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12526096033402923
model parameter : 1304035
model size : 6.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7704713
	speed: 0.1320s/iter; left time: 2732.3917s
	iters: 200, epoch: 1 | loss: 3.9621718
	speed: 0.1157s/iter; left time: 2383.8901s
Epoch: 1 cost time: 25.750312089920044
Epoch: 1, Steps: 208 | Train Loss: 3.704 Vali Loss: 3.668 Vali Acc: 0.054 Test Loss: 3.668 Test Acc: 0.054
Validation loss decreased (inf --> -0.053647).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6021819
	speed: 0.4078s/iter; left time: 8357.8439s
	iters: 200, epoch: 2 | loss: 3.4810050
	speed: 0.1223s/iter; left time: 2495.0445s
Epoch: 2 cost time: 26.41768479347229
Epoch: 2, Steps: 208 | Train Loss: 3.603 Vali Loss: 3.573 Vali Acc: 0.059 Test Loss: 3.573 Test Acc: 0.059
Validation loss decreased (-0.053647 --> -0.059314).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7306480
	speed: 0.3856s/iter; left time: 7822.1837s
	iters: 200, epoch: 3 | loss: 3.6099024
	speed: 0.1163s/iter; left time: 2348.1257s
Epoch: 3 cost time: 24.562281131744385
Epoch: 3, Steps: 208 | Train Loss: 3.540 Vali Loss: 3.531 Vali Acc: 0.055 Test Loss: 3.531 Test Acc: 0.055
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.4697788
	speed: 0.3916s/iter; left time: 7861.9629s
	iters: 200, epoch: 4 | loss: 3.5551958
	speed: 0.1093s/iter; left time: 2184.2959s
Epoch: 4 cost time: 24.387341022491455
Epoch: 4, Steps: 208 | Train Loss: 3.456 Vali Loss: 3.442 Vali Acc: 0.065 Test Loss: 3.442 Test Acc: 0.065
Validation loss decreased (-0.059314 --> -0.065280).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.1002746
	speed: 0.4038s/iter; left time: 8023.0378s
	iters: 200, epoch: 5 | loss: 3.0561485
	speed: 0.1124s/iter; left time: 2221.9921s
Epoch: 5 cost time: 26.005438089370728
Epoch: 5, Steps: 208 | Train Loss: 3.351 Vali Loss: 3.377 Vali Acc: 0.071 Test Loss: 3.377 Test Acc: 0.071
Validation loss decreased (-0.065280 --> -0.071246).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.5165339
	speed: 0.3432s/iter; left time: 6748.2790s
	iters: 200, epoch: 6 | loss: 3.4194245
	speed: 0.1121s/iter; left time: 2193.0441s
Epoch: 6 cost time: 23.720329999923706
Epoch: 6, Steps: 208 | Train Loss: 3.201 Vali Loss: 3.244 Vali Acc: 0.098 Test Loss: 3.244 Test Acc: 0.098
Validation loss decreased (-0.071246 --> -0.098387).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.6886284
	speed: 0.3657s/iter; left time: 7113.8722s
	iters: 200, epoch: 7 | loss: 3.1568899
	speed: 0.1081s/iter; left time: 2091.5759s
Epoch: 7 cost time: 23.25386619567871
Epoch: 7, Steps: 208 | Train Loss: 3.052 Vali Loss: 3.152 Vali Acc: 0.106 Test Loss: 3.152 Test Acc: 0.106
Validation loss decreased (-0.098387 --> -0.106440).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.8308823
	speed: 0.3502s/iter; left time: 6740.5518s
	iters: 200, epoch: 8 | loss: 3.2251878
	speed: 0.1108s/iter; left time: 2121.7150s
Epoch: 8 cost time: 23.654663562774658
Epoch: 8, Steps: 208 | Train Loss: 2.961 Vali Loss: 3.183 Vali Acc: 0.104 Test Loss: 3.183 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.8807886
	speed: 0.3611s/iter; left time: 6874.0901s
	iters: 200, epoch: 9 | loss: 2.7199781
	speed: 0.1117s/iter; left time: 2115.3849s
Epoch: 9 cost time: 23.870455265045166
Epoch: 9, Steps: 208 | Train Loss: 2.834 Vali Loss: 3.130 Vali Acc: 0.127 Test Loss: 3.130 Test Acc: 0.127
Validation loss decreased (-0.106440 --> -0.126721).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.5364680
	speed: 0.3663s/iter; left time: 6897.9235s
	iters: 200, epoch: 10 | loss: 2.7140875
	speed: 0.1146s/iter; left time: 2145.7772s
Epoch: 10 cost time: 25.851919412612915
Epoch: 10, Steps: 208 | Train Loss: 2.670 Vali Loss: 3.223 Vali Acc: 0.123 Test Loss: 3.223 Test Acc: 0.123
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.8399527
	speed: 0.3428s/iter; left time: 6382.6560s
	iters: 200, epoch: 11 | loss: 2.5571289
	speed: 0.1139s/iter; left time: 2108.8481s
Epoch: 11 cost time: 24.092793464660645
Epoch: 11, Steps: 208 | Train Loss: 2.532 Vali Loss: 3.169 Vali Acc: 0.117 Test Loss: 3.169 Test Acc: 0.117
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 2.2503884
	speed: 0.3608s/iter; left time: 6642.4906s
	iters: 200, epoch: 12 | loss: 2.1654286
	speed: 0.1013s/iter; left time: 1854.5887s
Epoch: 12 cost time: 21.99436092376709
Epoch: 12, Steps: 208 | Train Loss: 2.344 Vali Loss: 3.262 Vali Acc: 0.119 Test Loss: 3.262 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.7459328
	speed: 0.3588s/iter; left time: 6531.8331s
	iters: 200, epoch: 13 | loss: 2.6035402
	speed: 0.1147s/iter; left time: 2076.0278s
Epoch: 13 cost time: 24.806126356124878
Epoch: 13, Steps: 208 | Train Loss: 2.166 Vali Loss: 3.433 Vali Acc: 0.131 Test Loss: 3.433 Test Acc: 0.131
Validation loss decreased (-0.126721 --> -0.130893).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.7999476
	speed: 0.3689s/iter; left time: 6639.5286s
	iters: 200, epoch: 14 | loss: 1.4522476
	speed: 0.1035s/iter; left time: 1851.5562s
Epoch: 14 cost time: 24.69425106048584
Epoch: 14, Steps: 208 | Train Loss: 2.009 Vali Loss: 3.543 Vali Acc: 0.125 Test Loss: 3.543 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.7829541
	speed: 0.3455s/iter; left time: 6146.7524s
	iters: 200, epoch: 15 | loss: 1.8502083
	speed: 0.1095s/iter; left time: 1936.8083s
Epoch: 15 cost time: 23.41880178451538
Epoch: 15, Steps: 208 | Train Loss: 1.859 Vali Loss: 3.701 Vali Acc: 0.114 Test Loss: 3.701 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 2.3723094
	speed: 0.3709s/iter; left time: 6521.3719s
	iters: 200, epoch: 16 | loss: 1.7957554
	speed: 0.1142s/iter; left time: 1995.7579s
Epoch: 16 cost time: 24.774192333221436
Epoch: 16, Steps: 208 | Train Loss: 1.716 Vali Loss: 3.754 Vali Acc: 0.123 Test Loss: 3.754 Test Acc: 0.123
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.8268408
	speed: 0.3708s/iter; left time: 6442.1302s
	iters: 200, epoch: 17 | loss: 1.0536119
	speed: 0.1052s/iter; left time: 1817.9069s
Epoch: 17 cost time: 23.098373889923096
Epoch: 17, Steps: 208 | Train Loss: 1.538 Vali Loss: 4.125 Vali Acc: 0.120 Test Loss: 4.125 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.4649642
	speed: 0.3703s/iter; left time: 6355.7125s
	iters: 200, epoch: 18 | loss: 1.3679971
	speed: 0.1110s/iter; left time: 1894.3294s
Epoch: 18 cost time: 25.429974794387817
Epoch: 18, Steps: 208 | Train Loss: 1.397 Vali Loss: 4.152 Vali Acc: 0.130 Test Loss: 4.152 Test Acc: 0.130
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.9523813
	speed: 0.3850s/iter; left time: 6528.8964s
	iters: 200, epoch: 19 | loss: 1.5927397
	speed: 0.1207s/iter; left time: 2035.2381s
Epoch: 19 cost time: 26.131721258163452
Epoch: 19, Steps: 208 | Train Loss: 1.283 Vali Loss: 4.342 Vali Acc: 0.127 Test Loss: 4.342 Test Acc: 0.127
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 1.4593527
	speed: 0.3722s/iter; left time: 6233.5388s
	iters: 200, epoch: 20 | loss: 1.6556631
	speed: 0.1091s/iter; left time: 1815.7496s
Epoch: 20 cost time: 23.24846315383911
Epoch: 20, Steps: 208 | Train Loss: 1.167 Vali Loss: 4.585 Vali Acc: 0.121 Test Loss: 4.585 Test Acc: 0.121
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.8105983
	speed: 0.3865s/iter; left time: 6392.3929s
	iters: 200, epoch: 21 | loss: 1.1599569
	speed: 0.1200s/iter; left time: 1972.5628s
Epoch: 21 cost time: 25.997267961502075
Epoch: 21, Steps: 208 | Train Loss: 1.086 Vali Loss: 4.520 Vali Acc: 0.125 Test Loss: 4.520 Test Acc: 0.125
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 1.7046039
	speed: 0.3726s/iter; left time: 6086.0526s
	iters: 200, epoch: 22 | loss: 0.8822692
	speed: 0.1047s/iter; left time: 1698.8214s
Epoch: 22 cost time: 23.65214705467224
Epoch: 22, Steps: 208 | Train Loss: 1.008 Vali Loss: 4.697 Vali Acc: 0.123 Test Loss: 4.697 Test Acc: 0.123
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.3307437
	speed: 0.3579s/iter; left time: 5771.7581s
	iters: 200, epoch: 23 | loss: 0.6165444
	speed: 0.1103s/iter; left time: 1767.6312s
Epoch: 23 cost time: 23.182917594909668
Epoch: 23, Steps: 208 | Train Loss: 0.918 Vali Loss: 4.901 Vali Acc: 0.120 Test Loss: 4.901 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1309275275872353
model parameter : 1013923
model size : 5.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.2373519
	speed: 0.1541s/iter; left time: 3190.0690s
	iters: 200, epoch: 1 | loss: 3.7429302
	speed: 0.1221s/iter; left time: 2515.4863s
Epoch: 1 cost time: 28.790648221969604
Epoch: 1, Steps: 208 | Train Loss: 3.707 Vali Loss: 3.592 Vali Acc: 0.052 Test Loss: 3.592 Test Acc: 0.052
Validation loss decreased (inf --> -0.051560).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7190208
	speed: 0.4055s/iter; left time: 8309.1110s
	iters: 200, epoch: 2 | loss: 3.4610243
	speed: 0.1270s/iter; left time: 2589.7921s
Epoch: 2 cost time: 25.95178985595703
Epoch: 2, Steps: 208 | Train Loss: 3.608 Vali Loss: 3.565 Vali Acc: 0.051 Test Loss: 3.565 Test Acc: 0.051
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.5759206
	speed: 0.3970s/iter; left time: 8052.7199s
	iters: 200, epoch: 3 | loss: 3.5578284
	speed: 0.1108s/iter; left time: 2235.8601s
Epoch: 3 cost time: 24.889319896697998
Epoch: 3, Steps: 208 | Train Loss: 3.512 Vali Loss: 3.484 Vali Acc: 0.062 Test Loss: 3.484 Test Acc: 0.062
Validation loss decreased (-0.051560 --> -0.062297).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.1519277
	speed: 0.4374s/iter; left time: 8781.0244s
	iters: 200, epoch: 4 | loss: 3.4834108
	speed: 0.1235s/iter; left time: 2467.8673s
Epoch: 4 cost time: 27.224241256713867
Epoch: 4, Steps: 208 | Train Loss: 3.462 Vali Loss: 3.438 Vali Acc: 0.075 Test Loss: 3.438 Test Acc: 0.075
Validation loss decreased (-0.062297 --> -0.074824).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2251825
	speed: 0.4196s/iter; left time: 8336.7403s
	iters: 200, epoch: 5 | loss: 3.4117429
	speed: 0.1208s/iter; left time: 2388.8933s
Epoch: 5 cost time: 26.53878378868103
Epoch: 5, Steps: 208 | Train Loss: 3.376 Vali Loss: 3.367 Vali Acc: 0.067 Test Loss: 3.367 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.1310101
	speed: 0.4254s/iter; left time: 8363.9799s
	iters: 200, epoch: 6 | loss: 3.6006463
	speed: 0.1223s/iter; left time: 2391.3925s
Epoch: 6 cost time: 27.020914554595947
Epoch: 6, Steps: 208 | Train Loss: 3.233 Vali Loss: 3.291 Vali Acc: 0.087 Test Loss: 3.291 Test Acc: 0.087
Validation loss decreased (-0.074824 --> -0.087053).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.8670523
	speed: 0.4344s/iter; left time: 8450.6088s
	iters: 200, epoch: 7 | loss: 3.4017041
	speed: 0.1275s/iter; left time: 2467.2849s
Epoch: 7 cost time: 27.357759475708008
Epoch: 7, Steps: 208 | Train Loss: 3.114 Vali Loss: 3.221 Vali Acc: 0.100 Test Loss: 3.221 Test Acc: 0.100
Validation loss decreased (-0.087053 --> -0.099878).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.7944074
	speed: 0.3736s/iter; left time: 7189.5947s
	iters: 200, epoch: 8 | loss: 2.8564541
	speed: 0.1103s/iter; left time: 2111.3920s
Epoch: 8 cost time: 24.571138620376587
Epoch: 8, Steps: 208 | Train Loss: 2.982 Vali Loss: 3.196 Vali Acc: 0.112 Test Loss: 3.196 Test Acc: 0.112
Validation loss decreased (-0.099878 --> -0.112405).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.3498340
	speed: 0.4101s/iter; left time: 7806.8750s
	iters: 200, epoch: 9 | loss: 2.8176124
	speed: 0.1153s/iter; left time: 2184.1922s
Epoch: 9 cost time: 26.18063473701477
Epoch: 9, Steps: 208 | Train Loss: 2.878 Vali Loss: 3.147 Vali Acc: 0.126 Test Loss: 3.147 Test Acc: 0.126
Validation loss decreased (-0.112405 --> -0.126422).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.7584410
	speed: 0.3981s/iter; left time: 7495.3196s
	iters: 200, epoch: 10 | loss: 2.5954607
	speed: 0.1099s/iter; left time: 2058.1615s
Epoch: 10 cost time: 24.677000522613525
Epoch: 10, Steps: 208 | Train Loss: 2.767 Vali Loss: 3.178 Vali Acc: 0.119 Test Loss: 3.178 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.2315359
	speed: 0.3927s/iter; left time: 7312.0496s
	iters: 200, epoch: 11 | loss: 2.7206168
	speed: 0.1246s/iter; left time: 2307.3123s
Epoch: 11 cost time: 26.12446093559265
Epoch: 11, Steps: 208 | Train Loss: 2.620 Vali Loss: 3.255 Vali Acc: 0.118 Test Loss: 3.255 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 2.5509377
	speed: 0.4049s/iter; left time: 7456.1770s
	iters: 200, epoch: 12 | loss: 2.1871688
	speed: 0.1377s/iter; left time: 2521.2954s
Epoch: 12 cost time: 28.437764167785645
Epoch: 12, Steps: 208 | Train Loss: 2.450 Vali Loss: 3.283 Vali Acc: 0.125 Test Loss: 3.283 Test Acc: 0.125
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 2.1001451
	speed: 0.4089s/iter; left time: 7444.4397s
	iters: 200, epoch: 13 | loss: 2.2334909
	speed: 0.1173s/iter; left time: 2123.4094s
Epoch: 13 cost time: 24.317861557006836
Epoch: 13, Steps: 208 | Train Loss: 2.277 Vali Loss: 3.389 Vali Acc: 0.126 Test Loss: 3.389 Test Acc: 0.126
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 2.3525651
	speed: 0.3644s/iter; left time: 6558.6474s
	iters: 200, epoch: 14 | loss: 2.0728588
	speed: 0.1190s/iter; left time: 2129.9160s
Epoch: 14 cost time: 24.208614349365234
Epoch: 14, Steps: 208 | Train Loss: 2.116 Vali Loss: 3.470 Vali Acc: 0.127 Test Loss: 3.470 Test Acc: 0.127
Validation loss decreased (-0.126422 --> -0.126717).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.4417582
	speed: 0.3407s/iter; left time: 6060.2201s
	iters: 200, epoch: 15 | loss: 2.0056326
	speed: 0.1030s/iter; left time: 1821.4227s
Epoch: 15 cost time: 22.183908462524414
Epoch: 15, Steps: 208 | Train Loss: 1.921 Vali Loss: 3.657 Vali Acc: 0.129 Test Loss: 3.657 Test Acc: 0.129
Validation loss decreased (-0.126717 --> -0.129102).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.6596972
	speed: 0.3417s/iter; left time: 6006.8775s
	iters: 200, epoch: 16 | loss: 1.9014781
	speed: 0.1185s/iter; left time: 2071.1772s
Epoch: 16 cost time: 24.516838550567627
Epoch: 16, Steps: 208 | Train Loss: 1.744 Vali Loss: 3.829 Vali Acc: 0.110 Test Loss: 3.829 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.3500141
	speed: 0.3632s/iter; left time: 6310.5040s
	iters: 200, epoch: 17 | loss: 1.7321823
	speed: 0.1063s/iter; left time: 1835.8856s
Epoch: 17 cost time: 23.289459466934204
Epoch: 17, Steps: 208 | Train Loss: 1.563 Vali Loss: 3.864 Vali Acc: 0.125 Test Loss: 3.864 Test Acc: 0.125
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.1975423
	speed: 0.3708s/iter; left time: 6364.5756s
	iters: 200, epoch: 18 | loss: 1.8105568
	speed: 0.1276s/iter; left time: 2176.9719s
Epoch: 18 cost time: 25.777244567871094
Epoch: 18, Steps: 208 | Train Loss: 1.369 Vali Loss: 4.248 Vali Acc: 0.118 Test Loss: 4.248 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.6812649
	speed: 0.3760s/iter; left time: 6376.4717s
	iters: 200, epoch: 19 | loss: 1.2809277
	speed: 0.1301s/iter; left time: 2193.0032s
Epoch: 19 cost time: 25.6474289894104
Epoch: 19, Steps: 208 | Train Loss: 1.253 Vali Loss: 4.408 Vali Acc: 0.121 Test Loss: 4.408 Test Acc: 0.121
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.9643337
	speed: 0.4057s/iter; left time: 6794.5052s
	iters: 200, epoch: 20 | loss: 1.2523077
	speed: 0.1304s/iter; left time: 2170.7326s
Epoch: 20 cost time: 27.149327754974365
Epoch: 20, Steps: 208 | Train Loss: 1.144 Vali Loss: 4.572 Vali Acc: 0.123 Test Loss: 4.572 Test Acc: 0.123
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.8767370
	speed: 0.3784s/iter; left time: 6258.6322s
	iters: 200, epoch: 21 | loss: 1.6161712
	speed: 0.1160s/iter; left time: 1907.8417s
Epoch: 21 cost time: 24.809369802474976
Epoch: 21, Steps: 208 | Train Loss: 1.044 Vali Loss: 4.584 Vali Acc: 0.120 Test Loss: 4.584 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.7571669
	speed: 0.3779s/iter; left time: 6171.9062s
	iters: 200, epoch: 22 | loss: 1.0032204
	speed: 0.1077s/iter; left time: 1747.6544s
Epoch: 22 cost time: 22.566805601119995
Epoch: 22, Steps: 208 | Train Loss: 0.973 Vali Loss: 4.917 Vali Acc: 0.117 Test Loss: 4.917 Test Acc: 0.117
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 1.1641800
	speed: 0.3691s/iter; left time: 5951.5877s
	iters: 200, epoch: 23 | loss: 1.6807196
	speed: 0.1012s/iter; left time: 1621.7761s
Epoch: 23 cost time: 22.018131732940674
Epoch: 23, Steps: 208 | Train Loss: 0.869 Vali Loss: 5.103 Vali Acc: 0.115 Test Loss: 5.103 Test Acc: 0.115
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.9869955
	speed: 0.3639s/iter; left time: 5792.7595s
	iters: 200, epoch: 24 | loss: 0.4220524
	speed: 0.1138s/iter; left time: 1799.8397s
Epoch: 24 cost time: 25.4448299407959
Epoch: 24, Steps: 208 | Train Loss: 0.861 Vali Loss: 5.089 Vali Acc: 0.118 Test Loss: 5.089 Test Acc: 0.118
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.8716397
	speed: 0.3530s/iter; left time: 5544.9350s
	iters: 200, epoch: 25 | loss: 1.5077848
	speed: 0.1099s/iter; left time: 1715.0399s
Epoch: 25 cost time: 23.12481999397278
Epoch: 25, Steps: 208 | Train Loss: 0.808 Vali Loss: 5.350 Vali Acc: 0.120 Test Loss: 5.350 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12913808529674917
model parameter : 1011555
model size : 5.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5893397
	speed: 0.1283s/iter; left time: 2655.6959s
	iters: 200, epoch: 1 | loss: 3.7949665
	speed: 0.1087s/iter; left time: 2240.3472s
Epoch: 1 cost time: 24.644859075546265
Epoch: 1, Steps: 208 | Train Loss: 3.699 Vali Loss: 3.607 Vali Acc: 0.047 Test Loss: 3.607 Test Acc: 0.047
Validation loss decreased (inf --> -0.047384).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7152901
	speed: 0.3402s/iter; left time: 6972.6054s
	iters: 200, epoch: 2 | loss: 3.5901685
	speed: 0.1267s/iter; left time: 2583.9929s
Epoch: 2 cost time: 24.587088584899902
Epoch: 2, Steps: 208 | Train Loss: 3.611 Vali Loss: 3.572 Vali Acc: 0.052 Test Loss: 3.572 Test Acc: 0.052
Validation loss decreased (-0.047384 --> -0.052455).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5127091
	speed: 0.3772s/iter; left time: 7652.3951s
	iters: 200, epoch: 3 | loss: 3.8466914
	speed: 0.1062s/iter; left time: 2144.6529s
Epoch: 3 cost time: 24.13415765762329
Epoch: 3, Steps: 208 | Train Loss: 3.530 Vali Loss: 3.478 Vali Acc: 0.070 Test Loss: 3.478 Test Acc: 0.070
Validation loss decreased (-0.052455 --> -0.069753).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.5568790
	speed: 0.3633s/iter; left time: 7293.2892s
	iters: 200, epoch: 4 | loss: 3.1940436
	speed: 0.1040s/iter; left time: 2077.0476s
Epoch: 4 cost time: 23.91430926322937
Epoch: 4, Steps: 208 | Train Loss: 3.467 Vali Loss: 3.473 Vali Acc: 0.065 Test Loss: 3.473 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.5700643
	speed: 0.3761s/iter; left time: 7472.4230s
	iters: 200, epoch: 5 | loss: 3.3813152
	speed: 0.1107s/iter; left time: 2187.8267s
Epoch: 5 cost time: 25.023950815200806
Epoch: 5, Steps: 208 | Train Loss: 3.352 Vali Loss: 3.368 Vali Acc: 0.082 Test Loss: 3.368 Test Acc: 0.082
Validation loss decreased (-0.069753 --> -0.081684).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2832994
	speed: 0.3493s/iter; left time: 6867.3720s
	iters: 200, epoch: 6 | loss: 3.3040924
	speed: 0.1041s/iter; left time: 2035.9626s
Epoch: 6 cost time: 22.074646472930908
Epoch: 6, Steps: 208 | Train Loss: 3.238 Vali Loss: 3.324 Vali Acc: 0.088 Test Loss: 3.324 Test Acc: 0.088
Validation loss decreased (-0.081684 --> -0.088246).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.7657027
	speed: 0.3743s/iter; left time: 7281.5769s
	iters: 200, epoch: 7 | loss: 3.0841832
	speed: 0.1158s/iter; left time: 2240.1281s
Epoch: 7 cost time: 26.280259609222412
Epoch: 7, Steps: 208 | Train Loss: 3.107 Vali Loss: 3.318 Vali Acc: 0.079 Test Loss: 3.318 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.8778999
	speed: 0.3755s/iter; left time: 7226.2132s
	iters: 200, epoch: 8 | loss: 3.0097871
	speed: 0.1192s/iter; left time: 2281.5446s
Epoch: 8 cost time: 24.758532762527466
Epoch: 8, Steps: 208 | Train Loss: 2.973 Vali Loss: 3.281 Vali Acc: 0.098 Test Loss: 3.281 Test Acc: 0.098
Validation loss decreased (-0.088246 --> -0.098387).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.7992735
	speed: 0.3870s/iter; left time: 7366.9751s
	iters: 200, epoch: 9 | loss: 3.0618036
	speed: 0.1197s/iter; left time: 2267.2076s
Epoch: 9 cost time: 25.283586978912354
Epoch: 9, Steps: 208 | Train Loss: 2.898 Vali Loss: 3.214 Vali Acc: 0.112 Test Loss: 3.214 Test Acc: 0.112
Validation loss decreased (-0.098387 --> -0.112106).  Saving model ...
	iters: 100, epoch: 10 | loss: 3.0852625
	speed: 0.3892s/iter; left time: 7327.4344s
	iters: 200, epoch: 10 | loss: 2.6464822
	speed: 0.1333s/iter; left time: 2495.7017s
Epoch: 10 cost time: 27.514393091201782
Epoch: 10, Steps: 208 | Train Loss: 2.761 Vali Loss: 3.321 Vali Acc: 0.101 Test Loss: 3.321 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.9549077
	speed: 0.3916s/iter; left time: 7292.1089s
	iters: 200, epoch: 11 | loss: 2.1647103
	speed: 0.1040s/iter; left time: 1926.8167s
Epoch: 11 cost time: 23.39434003829956
Epoch: 11, Steps: 208 | Train Loss: 2.603 Vali Loss: 3.264 Vali Acc: 0.119 Test Loss: 3.264 Test Acc: 0.119
Validation loss decreased (-0.112106 --> -0.119264).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.7379754
	speed: 0.4012s/iter; left time: 7388.0571s
	iters: 200, epoch: 12 | loss: 3.3986583
	speed: 0.1235s/iter; left time: 2262.1879s
Epoch: 12 cost time: 26.29201912879944
Epoch: 12, Steps: 208 | Train Loss: 2.467 Vali Loss: 3.375 Vali Acc: 0.109 Test Loss: 3.375 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.3206785
	speed: 0.4033s/iter; left time: 7341.5258s
	iters: 200, epoch: 13 | loss: 2.4855983
	speed: 0.1249s/iter; left time: 2260.7559s
Epoch: 13 cost time: 26.440067529678345
Epoch: 13, Steps: 208 | Train Loss: 2.304 Vali Loss: 3.467 Vali Acc: 0.122 Test Loss: 3.467 Test Acc: 0.122
Validation loss decreased (-0.119264 --> -0.121647).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.6927294
	speed: 0.4015s/iter; left time: 7226.6229s
	iters: 200, epoch: 14 | loss: 1.7980278
	speed: 0.1100s/iter; left time: 1968.7797s
Epoch: 14 cost time: 24.755862951278687
Epoch: 14, Steps: 208 | Train Loss: 2.114 Vali Loss: 3.511 Vali Acc: 0.128 Test Loss: 3.511 Test Acc: 0.128
Validation loss decreased (-0.121647 --> -0.127910).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.7912447
	speed: 0.3822s/iter; left time: 6798.8101s
	iters: 200, epoch: 15 | loss: 2.2243207
	speed: 0.1070s/iter; left time: 1892.8827s
Epoch: 15 cost time: 24.92082905769348
Epoch: 15, Steps: 208 | Train Loss: 1.930 Vali Loss: 3.661 Vali Acc: 0.125 Test Loss: 3.661 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.5460657
	speed: 0.3896s/iter; left time: 6849.2314s
	iters: 200, epoch: 16 | loss: 1.9077991
	speed: 0.1076s/iter; left time: 1880.6927s
Epoch: 16 cost time: 23.114469289779663
Epoch: 16, Steps: 208 | Train Loss: 1.775 Vali Loss: 3.791 Vali Acc: 0.115 Test Loss: 3.791 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.5752765
	speed: 0.3799s/iter; left time: 6599.7736s
	iters: 200, epoch: 17 | loss: 2.1854990
	speed: 0.1242s/iter; left time: 2145.9986s
Epoch: 17 cost time: 27.009730339050293
Epoch: 17, Steps: 208 | Train Loss: 1.637 Vali Loss: 3.795 Vali Acc: 0.118 Test Loss: 3.795 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.2727408
	speed: 0.4052s/iter; left time: 6954.7094s
	iters: 200, epoch: 18 | loss: 1.9545805
	speed: 0.1347s/iter; left time: 2298.2097s
Epoch: 18 cost time: 28.010990142822266
Epoch: 18, Steps: 208 | Train Loss: 1.476 Vali Loss: 4.103 Vali Acc: 0.118 Test Loss: 4.103 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.2164265
	speed: 0.4129s/iter; left time: 7000.7637s
	iters: 200, epoch: 19 | loss: 1.6109185
	speed: 0.1055s/iter; left time: 1779.2193s
Epoch: 19 cost time: 23.886759042739868
Epoch: 19, Steps: 208 | Train Loss: 1.371 Vali Loss: 4.141 Vali Acc: 0.120 Test Loss: 4.141 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 1.3218796
	speed: 0.4310s/iter; left time: 7218.1754s
	iters: 200, epoch: 20 | loss: 0.9391925
	speed: 0.1309s/iter; left time: 2178.5591s
Epoch: 20 cost time: 28.46515202522278
Epoch: 20, Steps: 208 | Train Loss: 1.215 Vali Loss: 4.530 Vali Acc: 0.116 Test Loss: 4.530 Test Acc: 0.116
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 1.1871306
	speed: 0.3972s/iter; left time: 6570.6171s
	iters: 200, epoch: 21 | loss: 0.7606955
	speed: 0.1162s/iter; left time: 1909.9330s
Epoch: 21 cost time: 24.657078981399536
Epoch: 21, Steps: 208 | Train Loss: 1.162 Vali Loss: 4.555 Vali Acc: 0.130 Test Loss: 4.555 Test Acc: 0.130
Validation loss decreased (-0.127910 --> -0.130285).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.6767587
	speed: 0.3890s/iter; left time: 6352.8355s
	iters: 200, epoch: 22 | loss: 0.6073024
	speed: 0.1125s/iter; left time: 1825.8452s
Epoch: 22 cost time: 23.98343062400818
Epoch: 22, Steps: 208 | Train Loss: 1.068 Vali Loss: 4.735 Vali Acc: 0.112 Test Loss: 4.735 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.8649753
	speed: 0.3735s/iter; left time: 6022.2593s
	iters: 200, epoch: 23 | loss: 0.8274558
	speed: 0.1183s/iter; left time: 1895.1384s
Epoch: 23 cost time: 25.29857039451599
Epoch: 23, Steps: 208 | Train Loss: 0.952 Vali Loss: 4.840 Vali Acc: 0.111 Test Loss: 4.840 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 1.5120529
	speed: 0.3664s/iter; left time: 5831.4836s
	iters: 200, epoch: 24 | loss: 1.2325808
	speed: 0.1150s/iter; left time: 1819.2728s
Epoch: 24 cost time: 24.087772846221924
Epoch: 24, Steps: 208 | Train Loss: 0.890 Vali Loss: 5.091 Vali Acc: 0.116 Test Loss: 5.091 Test Acc: 0.116
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.4767582
	speed: 0.3827s/iter; left time: 6011.7098s
	iters: 200, epoch: 25 | loss: 1.1004767
	speed: 0.1143s/iter; left time: 1783.8163s
Epoch: 25 cost time: 25.097074270248413
Epoch: 25, Steps: 208 | Train Loss: 0.852 Vali Loss: 5.272 Vali Acc: 0.106 Test Loss: 5.272 Test Acc: 0.106
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 1.0302902
	speed: 0.3977s/iter; left time: 6165.0925s
	iters: 200, epoch: 26 | loss: 2.3277199
	speed: 0.1087s/iter; left time: 1673.5308s
Epoch: 26 cost time: 24.79801034927368
Epoch: 26, Steps: 208 | Train Loss: 0.823 Vali Loss: 5.301 Vali Acc: 0.115 Test Loss: 5.301 Test Acc: 0.115
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 1.1340913
	speed: 0.3840s/iter; left time: 5873.0106s
	iters: 200, epoch: 27 | loss: 0.3518529
	speed: 0.1139s/iter; left time: 1731.0282s
Epoch: 27 cost time: 25.86506462097168
Epoch: 27, Steps: 208 | Train Loss: 0.780 Vali Loss: 5.440 Vali Acc: 0.115 Test Loss: 5.440 Test Acc: 0.115
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.7962505
	speed: 0.3681s/iter; left time: 5553.0944s
	iters: 200, epoch: 28 | loss: 0.8484380
	speed: 0.1104s/iter; left time: 1653.6502s
Epoch: 28 cost time: 24.509016513824463
Epoch: 28, Steps: 208 | Train Loss: 0.730 Vali Loss: 5.746 Vali Acc: 0.118 Test Loss: 5.746 Test Acc: 0.118
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 1.1471215
	speed: 0.3703s/iter; left time: 5509.2900s
	iters: 200, epoch: 29 | loss: 0.3369205
	speed: 0.0975s/iter; left time: 1441.3462s
Epoch: 29 cost time: 22.885367393493652
Epoch: 29, Steps: 208 | Train Loss: 0.722 Vali Loss: 5.655 Vali Acc: 0.112 Test Loss: 5.655 Test Acc: 0.112
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.4440513
	speed: 0.3543s/iter; left time: 5197.2083s
	iters: 200, epoch: 30 | loss: 0.7561494
	speed: 0.1102s/iter; left time: 1605.4467s
Epoch: 30 cost time: 23.28317141532898
Epoch: 30, Steps: 208 | Train Loss: 0.694 Vali Loss: 5.699 Vali Acc: 0.123 Test Loss: 5.699 Test Acc: 0.123
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.6216305
	speed: 0.3777s/iter; left time: 5461.8821s
	iters: 200, epoch: 31 | loss: 1.0602922
	speed: 0.1146s/iter; left time: 1646.2284s
Epoch: 31 cost time: 26.017836570739746
Epoch: 31, Steps: 208 | Train Loss: 0.667 Vali Loss: 5.804 Vali Acc: 0.114 Test Loss: 5.804 Test Acc: 0.114
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13033104682373994
model parameter : 1009187
model size : 5.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.3397515
	speed: 0.1229s/iter; left time: 2543.4448s
	iters: 200, epoch: 1 | loss: 3.4002061
	speed: 0.1122s/iter; left time: 2310.6413s
Epoch: 1 cost time: 24.391050577163696
Epoch: 1, Steps: 208 | Train Loss: 3.686 Vali Loss: 3.664 Vali Acc: 0.064 Test Loss: 3.664 Test Acc: 0.064
Validation loss decreased (inf --> -0.063787).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5562756
	speed: 0.3514s/iter; left time: 7201.7865s
	iters: 200, epoch: 2 | loss: 3.3123510
	speed: 0.1029s/iter; left time: 2097.4519s
Epoch: 2 cost time: 22.91580867767334
Epoch: 2, Steps: 208 | Train Loss: 3.601 Vali Loss: 3.549 Vali Acc: 0.063 Test Loss: 3.549 Test Acc: 0.063
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.7413216
	speed: 0.3086s/iter; left time: 6259.4237s
	iters: 200, epoch: 3 | loss: 3.3395610
	speed: 0.0973s/iter; left time: 1963.7298s
Epoch: 3 cost time: 21.179188013076782
Epoch: 3, Steps: 208 | Train Loss: 3.512 Vali Loss: 3.503 Vali Acc: 0.071 Test Loss: 3.503 Test Acc: 0.071
Validation loss decreased (-0.063787 --> -0.070648).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.5041721
	speed: 0.3443s/iter; left time: 6913.0736s
	iters: 200, epoch: 4 | loss: 3.3342395
	speed: 0.1121s/iter; left time: 2238.6131s
Epoch: 4 cost time: 23.817948579788208
Epoch: 4, Steps: 208 | Train Loss: 3.425 Vali Loss: 3.467 Vali Acc: 0.064 Test Loss: 3.467 Test Acc: 0.064
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.2601941
	speed: 0.3797s/iter; left time: 7544.2539s
	iters: 200, epoch: 5 | loss: 3.4019561
	speed: 0.0990s/iter; left time: 1956.6443s
Epoch: 5 cost time: 23.47688865661621
Epoch: 5, Steps: 208 | Train Loss: 3.370 Vali Loss: 3.437 Vali Acc: 0.067 Test Loss: 3.437 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 3.1950982
	speed: 0.3497s/iter; left time: 6874.6768s
	iters: 200, epoch: 6 | loss: 3.1995747
	speed: 0.1138s/iter; left time: 2226.7204s
Epoch: 6 cost time: 24.66270875930786
Epoch: 6, Steps: 208 | Train Loss: 3.286 Vali Loss: 3.342 Vali Acc: 0.083 Test Loss: 3.342 Test Acc: 0.083
Validation loss decreased (-0.070648 --> -0.082579).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9019179
	speed: 0.3543s/iter; left time: 6892.5318s
	iters: 200, epoch: 7 | loss: 3.2719903
	speed: 0.1042s/iter; left time: 2016.4072s
Epoch: 7 cost time: 22.57763361930847
Epoch: 7, Steps: 208 | Train Loss: 3.147 Vali Loss: 3.353 Vali Acc: 0.089 Test Loss: 3.353 Test Acc: 0.089
Validation loss decreased (-0.082579 --> -0.088544).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.5196455
	speed: 0.3716s/iter; left time: 7151.1665s
	iters: 200, epoch: 8 | loss: 3.4052536
	speed: 0.1067s/iter; left time: 2042.7349s
Epoch: 8 cost time: 23.30556869506836
Epoch: 8, Steps: 208 | Train Loss: 3.041 Vali Loss: 3.264 Vali Acc: 0.088 Test Loss: 3.264 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.7755694
	speed: 0.3465s/iter; left time: 6597.2474s
	iters: 200, epoch: 9 | loss: 3.0770085
	speed: 0.1142s/iter; left time: 2162.0760s
Epoch: 9 cost time: 24.14500641822815
Epoch: 9, Steps: 208 | Train Loss: 2.897 Vali Loss: 3.235 Vali Acc: 0.104 Test Loss: 3.235 Test Acc: 0.104
Validation loss decreased (-0.088544 --> -0.103755).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.6158705
	speed: 0.3310s/iter; left time: 6233.3152s
	iters: 200, epoch: 10 | loss: 3.4905484
	speed: 0.0960s/iter; left time: 1798.3698s
Epoch: 10 cost time: 21.280773162841797
Epoch: 10, Steps: 208 | Train Loss: 2.765 Vali Loss: 3.267 Vali Acc: 0.111 Test Loss: 3.267 Test Acc: 0.111
Validation loss decreased (-0.103755 --> -0.111211).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.6437643
	speed: 0.3470s/iter; left time: 6462.3171s
	iters: 200, epoch: 11 | loss: 2.6753604
	speed: 0.1017s/iter; left time: 1884.2072s
Epoch: 11 cost time: 21.858345985412598
Epoch: 11, Steps: 208 | Train Loss: 2.619 Vali Loss: 3.303 Vali Acc: 0.105 Test Loss: 3.303 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.4738295
	speed: 0.3520s/iter; left time: 6481.8301s
	iters: 200, epoch: 12 | loss: 2.1753988
	speed: 0.0993s/iter; left time: 1818.7723s
Epoch: 12 cost time: 22.19426941871643
Epoch: 12, Steps: 208 | Train Loss: 2.450 Vali Loss: 3.299 Vali Acc: 0.122 Test Loss: 3.299 Test Acc: 0.122
Validation loss decreased (-0.111211 --> -0.121947).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.3103580
	speed: 0.3453s/iter; left time: 6285.8328s
	iters: 200, epoch: 13 | loss: 2.5956459
	speed: 0.1053s/iter; left time: 1906.5162s
Epoch: 13 cost time: 23.264869928359985
Epoch: 13, Steps: 208 | Train Loss: 2.246 Vali Loss: 3.394 Vali Acc: 0.110 Test Loss: 3.394 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 2.2132998
	speed: 0.3501s/iter; left time: 6301.0437s
	iters: 200, epoch: 14 | loss: 2.3137071
	speed: 0.1091s/iter; left time: 1953.2168s
Epoch: 14 cost time: 22.829272747039795
Epoch: 14, Steps: 208 | Train Loss: 2.086 Vali Loss: 3.447 Vali Acc: 0.117 Test Loss: 3.447 Test Acc: 0.117
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.8194580
	speed: 0.3869s/iter; left time: 6882.7716s
	iters: 200, epoch: 15 | loss: 2.7436883
	speed: 0.1085s/iter; left time: 1919.4968s
Epoch: 15 cost time: 24.099794626235962
Epoch: 15, Steps: 208 | Train Loss: 1.886 Vali Loss: 3.641 Vali Acc: 0.110 Test Loss: 3.641 Test Acc: 0.110
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 2.2042248
	speed: 0.3159s/iter; left time: 5554.2983s
	iters: 200, epoch: 16 | loss: 2.1289895
	speed: 0.0940s/iter; left time: 1643.4622s
Epoch: 16 cost time: 21.0762038230896
Epoch: 16, Steps: 208 | Train Loss: 1.718 Vali Loss: 3.723 Vali Acc: 0.120 Test Loss: 3.723 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.8484600
	speed: 0.3192s/iter; left time: 5545.2361s
	iters: 200, epoch: 17 | loss: 1.8629205
	speed: 0.0930s/iter; left time: 1607.1920s
Epoch: 17 cost time: 20.909796714782715
Epoch: 17, Steps: 208 | Train Loss: 1.531 Vali Loss: 3.952 Vali Acc: 0.115 Test Loss: 3.952 Test Acc: 0.115
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.8613966
	speed: 0.3234s/iter; left time: 5551.9917s
	iters: 200, epoch: 18 | loss: 1.1637268
	speed: 0.0965s/iter; left time: 1647.4574s
Epoch: 18 cost time: 20.812275409698486
Epoch: 18, Steps: 208 | Train Loss: 1.357 Vali Loss: 4.149 Vali Acc: 0.118 Test Loss: 4.149 Test Acc: 0.118
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.8669965
	speed: 0.3065s/iter; left time: 5196.6688s
	iters: 200, epoch: 19 | loss: 1.5684273
	speed: 0.0952s/iter; left time: 1604.0680s
Epoch: 19 cost time: 20.159257411956787
Epoch: 19, Steps: 208 | Train Loss: 1.212 Vali Loss: 4.241 Vali Acc: 0.122 Test Loss: 4.241 Test Acc: 0.122
Validation loss decreased (-0.121947 --> -0.122236).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.1463766
	speed: 0.3263s/iter; left time: 5465.2948s
	iters: 200, epoch: 20 | loss: 0.9964786
	speed: 0.1091s/iter; left time: 1815.9080s
Epoch: 20 cost time: 22.277297496795654
Epoch: 20, Steps: 208 | Train Loss: 1.118 Vali Loss: 4.468 Vali Acc: 0.115 Test Loss: 4.468 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.6995950
	speed: 0.3277s/iter; left time: 5420.4155s
	iters: 200, epoch: 21 | loss: 1.4309887
	speed: 0.1023s/iter; left time: 1682.5244s
Epoch: 21 cost time: 22.598514556884766
Epoch: 21, Steps: 208 | Train Loss: 0.984 Vali Loss: 4.726 Vali Acc: 0.115 Test Loss: 4.726 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.9995720
	speed: 0.3361s/iter; left time: 5489.3551s
	iters: 200, epoch: 22 | loss: 0.9111855
	speed: 0.1017s/iter; left time: 1651.3139s
Epoch: 22 cost time: 22.022284746170044
Epoch: 22, Steps: 208 | Train Loss: 0.921 Vali Loss: 4.787 Vali Acc: 0.119 Test Loss: 4.787 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.8478836
	speed: 0.3448s/iter; left time: 5559.1004s
	iters: 200, epoch: 23 | loss: 0.9338971
	speed: 0.0989s/iter; left time: 1585.4057s
Epoch: 23 cost time: 21.954864263534546
Epoch: 23, Steps: 208 | Train Loss: 0.821 Vali Loss: 5.098 Vali Acc: 0.123 Test Loss: 5.098 Test Acc: 0.123
Validation loss decreased (-0.122236 --> -0.123122).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.7497626
	speed: 0.3416s/iter; left time: 5437.6962s
	iters: 200, epoch: 24 | loss: 1.2847304
	speed: 0.1021s/iter; left time: 1615.1845s
Epoch: 24 cost time: 22.535967111587524
Epoch: 24, Steps: 208 | Train Loss: 0.779 Vali Loss: 5.397 Vali Acc: 0.127 Test Loss: 5.397 Test Acc: 0.127
Validation loss decreased (-0.123122 --> -0.126996).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.6254693
	speed: 0.3269s/iter; left time: 5135.5508s
	iters: 200, epoch: 25 | loss: 0.7477190
	speed: 0.0947s/iter; left time: 1478.7296s
Epoch: 25 cost time: 20.42701745033264
Epoch: 25, Steps: 208 | Train Loss: 0.726 Vali Loss: 5.247 Vali Acc: 0.124 Test Loss: 5.247 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.4583403
	speed: 0.3369s/iter; left time: 5222.0206s
	iters: 200, epoch: 26 | loss: 0.6272417
	speed: 0.0905s/iter; left time: 1394.3711s
Epoch: 26 cost time: 21.55895471572876
Epoch: 26, Steps: 208 | Train Loss: 0.686 Vali Loss: 5.374 Vali Acc: 0.120 Test Loss: 5.374 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.5341017
	speed: 0.3076s/iter; left time: 4703.5398s
	iters: 200, epoch: 27 | loss: 0.8622761
	speed: 0.1030s/iter; left time: 1565.4939s
Epoch: 27 cost time: 21.533015251159668
Epoch: 27, Steps: 208 | Train Loss: 0.649 Vali Loss: 5.631 Vali Acc: 0.122 Test Loss: 5.631 Test Acc: 0.122
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.8859897
	speed: 0.3227s/iter; left time: 4868.3137s
	iters: 200, epoch: 28 | loss: 0.4604337
	speed: 0.0981s/iter; left time: 1470.2652s
Epoch: 28 cost time: 21.331850051879883
Epoch: 28, Steps: 208 | Train Loss: 0.630 Vali Loss: 5.768 Vali Acc: 0.121 Test Loss: 5.768 Test Acc: 0.121
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.3290858
	speed: 0.3283s/iter; left time: 4883.9898s
	iters: 200, epoch: 29 | loss: 0.7065545
	speed: 0.0955s/iter; left time: 1410.7063s
Epoch: 29 cost time: 21.37911105155945
Epoch: 29, Steps: 208 | Train Loss: 0.608 Vali Loss: 5.766 Vali Acc: 0.116 Test Loss: 5.766 Test Acc: 0.116
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.3744344
	speed: 0.3329s/iter; left time: 4882.6302s
	iters: 200, epoch: 30 | loss: 0.6576553
	speed: 0.1079s/iter; left time: 1572.0107s
Epoch: 30 cost time: 22.343567848205566
Epoch: 30, Steps: 208 | Train Loss: 0.568 Vali Loss: 6.218 Vali Acc: 0.112 Test Loss: 6.218 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.9930802
	speed: 0.3272s/iter; left time: 4731.7178s
	iters: 200, epoch: 31 | loss: 1.0661678
	speed: 0.1058s/iter; left time: 1519.9206s
Epoch: 31 cost time: 22.696665287017822
Epoch: 31, Steps: 208 | Train Loss: 0.580 Vali Loss: 6.160 Vali Acc: 0.121 Test Loss: 6.160 Test Acc: 0.121
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.2038849
	speed: 0.3239s/iter; left time: 4616.0804s
	iters: 200, epoch: 32 | loss: 0.3625593
	speed: 0.0983s/iter; left time: 1390.5878s
Epoch: 32 cost time: 21.101551055908203
Epoch: 32, Steps: 208 | Train Loss: 0.536 Vali Loss: 6.281 Vali Acc: 0.120 Test Loss: 6.281 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.6126256
	speed: 0.3197s/iter; left time: 4489.5318s
	iters: 200, epoch: 33 | loss: 0.8563766
	speed: 0.1079s/iter; left time: 1504.2028s
Epoch: 33 cost time: 21.965637683868408
Epoch: 33, Steps: 208 | Train Loss: 0.509 Vali Loss: 6.229 Vali Acc: 0.122 Test Loss: 6.229 Test Acc: 0.122
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.6741133
	speed: 0.3141s/iter; left time: 4346.1542s
	iters: 200, epoch: 34 | loss: 0.5910826
	speed: 0.0903s/iter; left time: 1241.1289s
Epoch: 34 cost time: 19.791545391082764
Epoch: 34, Steps: 208 | Train Loss: 0.491 Vali Loss: 6.351 Vali Acc: 0.118 Test Loss: 6.351 Test Acc: 0.118
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12705040262451536
model parameter : 1006819
model size : 5.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7109303
	speed: 0.1207s/iter; left time: 2497.9412s
	iters: 200, epoch: 1 | loss: 3.7090847
	speed: 0.0946s/iter; left time: 1947.9932s
Epoch: 1 cost time: 22.306357860565186
Epoch: 1, Steps: 208 | Train Loss: 3.678 Vali Loss: 3.588 Vali Acc: 0.054 Test Loss: 3.588 Test Acc: 0.054
Validation loss decreased (inf --> -0.054244).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4041932
	speed: 0.3218s/iter; left time: 6593.6943s
	iters: 200, epoch: 2 | loss: 3.4769516
	speed: 0.1032s/iter; left time: 2103.6677s
Epoch: 2 cost time: 21.686843872070312
Epoch: 2, Steps: 208 | Train Loss: 3.601 Vali Loss: 3.620 Vali Acc: 0.050 Test Loss: 3.620 Test Acc: 0.050
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.4351969
	speed: 0.3408s/iter; left time: 6913.4357s
	iters: 200, epoch: 3 | loss: 3.5662532
	speed: 0.0977s/iter; left time: 1972.4153s
Epoch: 3 cost time: 21.184067010879517
Epoch: 3, Steps: 208 | Train Loss: 3.523 Vali Loss: 3.485 Vali Acc: 0.074 Test Loss: 3.485 Test Acc: 0.074
Validation loss decreased (-0.054244 --> -0.073929).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2183189
	speed: 0.3309s/iter; left time: 6642.6620s
	iters: 200, epoch: 4 | loss: 3.2632921
	speed: 0.1032s/iter; left time: 2061.5578s
Epoch: 4 cost time: 22.209561109542847
Epoch: 4, Steps: 208 | Train Loss: 3.435 Vali Loss: 3.531 Vali Acc: 0.064 Test Loss: 3.531 Test Acc: 0.064
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.0430434
	speed: 0.3084s/iter; left time: 6127.2031s
	iters: 200, epoch: 5 | loss: 3.1328552
	speed: 0.0958s/iter; left time: 1893.6940s
Epoch: 5 cost time: 20.403780698776245
Epoch: 5, Steps: 208 | Train Loss: 3.327 Vali Loss: 3.275 Vali Acc: 0.085 Test Loss: 3.275 Test Acc: 0.085
Validation loss decreased (-0.073929 --> -0.084966).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.7418358
	speed: 0.3196s/iter; left time: 6284.4698s
	iters: 200, epoch: 6 | loss: 2.9452572
	speed: 0.0952s/iter; left time: 1861.6074s
Epoch: 6 cost time: 20.848063230514526
Epoch: 6, Steps: 208 | Train Loss: 3.175 Vali Loss: 3.308 Vali Acc: 0.086 Test Loss: 3.308 Test Acc: 0.086
Validation loss decreased (-0.084966 --> -0.086158).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9806168
	speed: 0.3189s/iter; left time: 6203.4803s
	iters: 200, epoch: 7 | loss: 3.2796326
	speed: 0.1028s/iter; left time: 1988.8031s
Epoch: 7 cost time: 21.460819244384766
Epoch: 7, Steps: 208 | Train Loss: 3.062 Vali Loss: 3.243 Vali Acc: 0.098 Test Loss: 3.243 Test Acc: 0.098
Validation loss decreased (-0.086158 --> -0.098089).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.5151367
	speed: 0.2940s/iter; left time: 5657.3825s
	iters: 200, epoch: 8 | loss: 2.4804280
	speed: 0.0978s/iter; left time: 1871.4828s
Epoch: 8 cost time: 20.753368377685547
Epoch: 8, Steps: 208 | Train Loss: 2.922 Vali Loss: 3.181 Vali Acc: 0.110 Test Loss: 3.181 Test Acc: 0.110
Validation loss decreased (-0.098089 --> -0.110019).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.9149909
	speed: 0.3202s/iter; left time: 6095.9317s
	iters: 200, epoch: 9 | loss: 2.3555560
	speed: 0.0970s/iter; left time: 1837.2771s
Epoch: 9 cost time: 21.03125023841858
Epoch: 9, Steps: 208 | Train Loss: 2.779 Vali Loss: 3.145 Vali Acc: 0.110 Test Loss: 3.145 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.5270190
	speed: 0.3186s/iter; left time: 5998.9565s
	iters: 200, epoch: 10 | loss: 2.5247221
	speed: 0.1042s/iter; left time: 1951.2283s
Epoch: 10 cost time: 22.05722451210022
Epoch: 10, Steps: 208 | Train Loss: 2.593 Vali Loss: 3.186 Vali Acc: 0.123 Test Loss: 3.186 Test Acc: 0.123
Validation loss decreased (-0.110019 --> -0.123141).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.1612039
	speed: 0.3622s/iter; left time: 6745.1619s
	iters: 200, epoch: 11 | loss: 2.3827407
	speed: 0.1009s/iter; left time: 1869.4573s
Epoch: 11 cost time: 23.01367998123169
Epoch: 11, Steps: 208 | Train Loss: 2.476 Vali Loss: 3.286 Vali Acc: 0.121 Test Loss: 3.286 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.9553272
	speed: 0.3555s/iter; left time: 6545.2712s
	iters: 200, epoch: 12 | loss: 2.2358873
	speed: 0.0978s/iter; left time: 1790.2354s
Epoch: 12 cost time: 22.012914896011353
Epoch: 12, Steps: 208 | Train Loss: 2.268 Vali Loss: 3.435 Vali Acc: 0.115 Test Loss: 3.435 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 2.0746615
	speed: 0.3187s/iter; left time: 5802.4995s
	iters: 200, epoch: 13 | loss: 2.1628952
	speed: 0.1026s/iter; left time: 1857.5566s
Epoch: 13 cost time: 21.268662214279175
Epoch: 13, Steps: 208 | Train Loss: 2.091 Vali Loss: 3.513 Vali Acc: 0.130 Test Loss: 3.513 Test Acc: 0.130
Validation loss decreased (-0.123141 --> -0.129699).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.0706766
	speed: 0.3160s/iter; left time: 5687.6977s
	iters: 200, epoch: 14 | loss: 2.0533776
	speed: 0.0958s/iter; left time: 1714.2824s
Epoch: 14 cost time: 21.594584465026855
Epoch: 14, Steps: 208 | Train Loss: 1.904 Vali Loss: 3.589 Vali Acc: 0.112 Test Loss: 3.589 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.6331486
	speed: 0.3125s/iter; left time: 5558.7189s
	iters: 200, epoch: 15 | loss: 1.9563142
	speed: 0.0953s/iter; left time: 1686.0051s
Epoch: 15 cost time: 20.2902352809906
Epoch: 15, Steps: 208 | Train Loss: 1.720 Vali Loss: 3.977 Vali Acc: 0.125 Test Loss: 3.977 Test Acc: 0.125
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.7750516
	speed: 0.3080s/iter; left time: 5415.0796s
	iters: 200, epoch: 16 | loss: 2.2992032
	speed: 0.1026s/iter; left time: 1794.1187s
Epoch: 16 cost time: 21.714353561401367
Epoch: 16, Steps: 208 | Train Loss: 1.546 Vali Loss: 4.036 Vali Acc: 0.125 Test Loss: 4.036 Test Acc: 0.125
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 2.3445914
	speed: 0.3042s/iter; left time: 5284.9870s
	iters: 200, epoch: 17 | loss: 0.8442724
	speed: 0.1025s/iter; left time: 1770.7632s
Epoch: 17 cost time: 21.033300638198853
Epoch: 17, Steps: 208 | Train Loss: 1.408 Vali Loss: 4.168 Vali Acc: 0.134 Test Loss: 4.168 Test Acc: 0.134
Validation loss decreased (-0.129699 --> -0.133570).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.3018278
	speed: 0.3256s/iter; left time: 5588.7713s
	iters: 200, epoch: 18 | loss: 1.4157687
	speed: 0.0918s/iter; left time: 1566.9545s
Epoch: 18 cost time: 20.937096118927002
Epoch: 18, Steps: 208 | Train Loss: 1.279 Vali Loss: 4.403 Vali Acc: 0.130 Test Loss: 4.403 Test Acc: 0.130
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.0209314
	speed: 0.3148s/iter; left time: 5338.8161s
	iters: 200, epoch: 19 | loss: 1.0851562
	speed: 0.1025s/iter; left time: 1727.8613s
Epoch: 19 cost time: 21.535831689834595
Epoch: 19, Steps: 208 | Train Loss: 1.167 Vali Loss: 4.427 Vali Acc: 0.124 Test Loss: 4.427 Test Acc: 0.124
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.9954307
	speed: 0.3285s/iter; left time: 5502.8587s
	iters: 200, epoch: 20 | loss: 1.2339767
	speed: 0.1033s/iter; left time: 1719.6858s
Epoch: 20 cost time: 21.761367559432983
Epoch: 20, Steps: 208 | Train Loss: 1.103 Vali Loss: 4.673 Vali Acc: 0.116 Test Loss: 4.673 Test Acc: 0.116
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.6456194
	speed: 0.3292s/iter; left time: 5446.0675s
	iters: 200, epoch: 21 | loss: 1.6158963
	speed: 0.0914s/iter; left time: 1503.2867s
Epoch: 21 cost time: 20.7875235080719
Epoch: 21, Steps: 208 | Train Loss: 1.005 Vali Loss: 4.714 Vali Acc: 0.115 Test Loss: 4.714 Test Acc: 0.115
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.4090897
	speed: 0.2979s/iter; left time: 4865.8144s
	iters: 200, epoch: 22 | loss: 1.0530105
	speed: 0.1029s/iter; left time: 1670.6564s
Epoch: 22 cost time: 21.91551113128662
Epoch: 22, Steps: 208 | Train Loss: 0.910 Vali Loss: 4.999 Vali Acc: 0.124 Test Loss: 4.999 Test Acc: 0.124
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.9321731
	speed: 0.3241s/iter; left time: 5226.1302s
	iters: 200, epoch: 23 | loss: 1.3333203
	speed: 0.1006s/iter; left time: 1612.1848s
Epoch: 23 cost time: 21.462079524993896
Epoch: 23, Steps: 208 | Train Loss: 0.921 Vali Loss: 4.914 Vali Acc: 0.127 Test Loss: 4.914 Test Acc: 0.127
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 1.0498731
	speed: 0.3069s/iter; left time: 4884.7014s
	iters: 200, epoch: 24 | loss: 1.0605981
	speed: 0.0931s/iter; left time: 1472.6471s
Epoch: 24 cost time: 20.603278398513794
Epoch: 24, Steps: 208 | Train Loss: 0.844 Vali Loss: 5.119 Vali Acc: 0.116 Test Loss: 5.119 Test Acc: 0.116
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.9305567
	speed: 0.3012s/iter; left time: 4731.3539s
	iters: 200, epoch: 25 | loss: 0.9885534
	speed: 0.0932s/iter; left time: 1454.7351s
Epoch: 25 cost time: 20.244429111480713
Epoch: 25, Steps: 208 | Train Loss: 0.801 Vali Loss: 5.208 Vali Acc: 0.121 Test Loss: 5.208 Test Acc: 0.121
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.2284666
	speed: 0.3390s/iter; left time: 5254.2077s
	iters: 200, epoch: 26 | loss: 0.3635532
	speed: 0.0953s/iter; left time: 1467.1314s
Epoch: 26 cost time: 21.382023572921753
Epoch: 26, Steps: 208 | Train Loss: 0.744 Vali Loss: 5.488 Vali Acc: 0.115 Test Loss: 5.488 Test Acc: 0.115
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.7197292
	speed: 0.3233s/iter; left time: 4944.4682s
	iters: 200, epoch: 27 | loss: 0.6657686
	speed: 0.0962s/iter; left time: 1462.0967s
Epoch: 27 cost time: 21.48600721359253
Epoch: 27, Steps: 208 | Train Loss: 0.723 Vali Loss: 5.522 Vali Acc: 0.128 Test Loss: 5.522 Test Acc: 0.128
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1336116910229645
model parameter : 865315
model size : 4.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9361513
	speed: 0.1278s/iter; left time: 2644.8961s
	iters: 200, epoch: 1 | loss: 3.2301538
	speed: 0.0934s/iter; left time: 1924.3254s
Epoch: 1 cost time: 23.117257833480835
Epoch: 1, Steps: 208 | Train Loss: 3.707 Vali Loss: 3.713 Vali Acc: 0.054 Test Loss: 3.713 Test Acc: 0.054
Validation loss decreased (inf --> -0.053646).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5909655
	speed: 0.2748s/iter; left time: 5630.7624s
	iters: 200, epoch: 2 | loss: 4.1016040
	speed: 0.0907s/iter; left time: 1849.7225s
Epoch: 2 cost time: 19.60242462158203
Epoch: 2, Steps: 208 | Train Loss: 3.588 Vali Loss: 3.549 Vali Acc: 0.056 Test Loss: 3.549 Test Acc: 0.056
Validation loss decreased (-0.053646 --> -0.056332).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.2731068
	speed: 0.3129s/iter; left time: 6347.8227s
	iters: 200, epoch: 3 | loss: 3.6511159
	speed: 0.0963s/iter; left time: 1943.9794s
Epoch: 3 cost time: 20.600032091140747
Epoch: 3, Steps: 208 | Train Loss: 3.522 Vali Loss: 3.482 Vali Acc: 0.069 Test Loss: 3.482 Test Acc: 0.069
Validation loss decreased (-0.056332 --> -0.068859).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3097601
	speed: 0.3346s/iter; left time: 6717.7204s
	iters: 200, epoch: 4 | loss: 3.4398994
	speed: 0.0979s/iter; left time: 1956.6817s
Epoch: 4 cost time: 22.81261706352234
Epoch: 4, Steps: 208 | Train Loss: 3.438 Vali Loss: 3.417 Vali Acc: 0.065 Test Loss: 3.417 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.2218637
	speed: 0.3028s/iter; left time: 6017.0873s
	iters: 200, epoch: 5 | loss: 3.6139388
	speed: 0.0991s/iter; left time: 1958.3116s
Epoch: 5 cost time: 21.25419044494629
Epoch: 5, Steps: 208 | Train Loss: 3.341 Vali Loss: 3.341 Vali Acc: 0.088 Test Loss: 3.341 Test Acc: 0.088
Validation loss decreased (-0.068859 --> -0.087649).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0897250
	speed: 0.3457s/iter; left time: 6796.7451s
	iters: 200, epoch: 6 | loss: 3.1866825
	speed: 0.0962s/iter; left time: 1881.5533s
Epoch: 6 cost time: 21.777406454086304
Epoch: 6, Steps: 208 | Train Loss: 3.202 Vali Loss: 3.264 Vali Acc: 0.087 Test Loss: 3.264 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.3751345
	speed: 0.2998s/iter; left time: 5831.2149s
	iters: 200, epoch: 7 | loss: 3.2288795
	speed: 0.0938s/iter; left time: 1815.6515s
Epoch: 7 cost time: 20.50850772857666
Epoch: 7, Steps: 208 | Train Loss: 3.078 Vali Loss: 3.190 Vali Acc: 0.097 Test Loss: 3.190 Test Acc: 0.097
Validation loss decreased (-0.087649 --> -0.096598).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.3659747
	speed: 0.2990s/iter; left time: 5755.1106s
	iters: 200, epoch: 8 | loss: 2.9478548
	speed: 0.0983s/iter; left time: 1882.4390s
Epoch: 8 cost time: 21.62976908683777
Epoch: 8, Steps: 208 | Train Loss: 2.948 Vali Loss: 3.178 Vali Acc: 0.102 Test Loss: 3.178 Test Acc: 0.102
Validation loss decreased (-0.096598 --> -0.101668).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.6069682
	speed: 0.3344s/iter; left time: 6366.1743s
	iters: 200, epoch: 9 | loss: 2.7039216
	speed: 0.0992s/iter; left time: 1878.3201s
Epoch: 9 cost time: 21.46821355819702
Epoch: 9, Steps: 208 | Train Loss: 2.797 Vali Loss: 3.199 Vali Acc: 0.107 Test Loss: 3.199 Test Acc: 0.107
Validation loss decreased (-0.101668 --> -0.106738).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.8654253
	speed: 0.2966s/iter; left time: 5584.1079s
	iters: 200, epoch: 10 | loss: 2.6172729
	speed: 0.0951s/iter; left time: 1781.5931s
Epoch: 10 cost time: 20.419651985168457
Epoch: 10, Steps: 208 | Train Loss: 2.644 Vali Loss: 3.148 Vali Acc: 0.127 Test Loss: 3.148 Test Acc: 0.127
Validation loss decreased (-0.106738 --> -0.127317).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.9691067
	speed: 0.2862s/iter; left time: 5328.9529s
	iters: 200, epoch: 11 | loss: 2.6314254
	speed: 0.0923s/iter; left time: 1708.8274s
Epoch: 11 cost time: 19.988044023513794
Epoch: 11, Steps: 208 | Train Loss: 2.482 Vali Loss: 3.240 Vali Acc: 0.123 Test Loss: 3.240 Test Acc: 0.123
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.5065880
	speed: 0.3050s/iter; left time: 5616.1311s
	iters: 200, epoch: 12 | loss: 2.3722925
	speed: 0.0933s/iter; left time: 1708.7561s
Epoch: 12 cost time: 20.11982011795044
Epoch: 12, Steps: 208 | Train Loss: 2.310 Vali Loss: 3.328 Vali Acc: 0.131 Test Loss: 3.328 Test Acc: 0.131
Validation loss decreased (-0.127317 --> -0.130894).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.4846284
	speed: 0.2862s/iter; left time: 5210.1567s
	iters: 200, epoch: 13 | loss: 2.2135205
	speed: 0.0942s/iter; left time: 1704.9139s
Epoch: 13 cost time: 19.630632877349854
Epoch: 13, Steps: 208 | Train Loss: 2.123 Vali Loss: 3.474 Vali Acc: 0.122 Test Loss: 3.474 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 2.5837536
	speed: 0.3233s/iter; left time: 5817.9509s
	iters: 200, epoch: 14 | loss: 2.3161383
	speed: 0.1150s/iter; left time: 2058.5163s
Epoch: 14 cost time: 22.431894779205322
Epoch: 14, Steps: 208 | Train Loss: 1.941 Vali Loss: 3.608 Vali Acc: 0.118 Test Loss: 3.608 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.7449174
	speed: 0.3250s/iter; left time: 5781.6619s
	iters: 200, epoch: 15 | loss: 1.7098850
	speed: 0.1066s/iter; left time: 1885.5885s
Epoch: 15 cost time: 22.249190092086792
Epoch: 15, Steps: 208 | Train Loss: 1.759 Vali Loss: 3.795 Vali Acc: 0.112 Test Loss: 3.795 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.6462581
	speed: 0.3111s/iter; left time: 5469.2579s
	iters: 200, epoch: 16 | loss: 2.1575124
	speed: 0.0990s/iter; left time: 1730.3548s
Epoch: 16 cost time: 21.412949562072754
Epoch: 16, Steps: 208 | Train Loss: 1.636 Vali Loss: 3.922 Vali Acc: 0.128 Test Loss: 3.922 Test Acc: 0.128
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.0428325
	speed: 0.3182s/iter; left time: 5527.8767s
	iters: 200, epoch: 17 | loss: 1.1368587
	speed: 0.0973s/iter; left time: 1681.2322s
Epoch: 17 cost time: 20.41217017173767
Epoch: 17, Steps: 208 | Train Loss: 1.460 Vali Loss: 4.115 Vali Acc: 0.120 Test Loss: 4.115 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.1913476
	speed: 0.2972s/iter; left time: 5101.6063s
	iters: 200, epoch: 18 | loss: 1.2857219
	speed: 0.0898s/iter; left time: 1533.0287s
Epoch: 18 cost time: 20.062479734420776
Epoch: 18, Steps: 208 | Train Loss: 1.337 Vali Loss: 4.238 Vali Acc: 0.109 Test Loss: 4.238 Test Acc: 0.109
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.8802955
	speed: 0.2702s/iter; left time: 4582.0839s
	iters: 200, epoch: 19 | loss: 0.6449152
	speed: 0.0892s/iter; left time: 1504.4226s
Epoch: 19 cost time: 18.91796112060547
Epoch: 19, Steps: 208 | Train Loss: 1.194 Vali Loss: 4.673 Vali Acc: 0.123 Test Loss: 4.673 Test Acc: 0.123
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 1.2957211
	speed: 0.2729s/iter; left time: 4571.0161s
	iters: 200, epoch: 20 | loss: 1.5096142
	speed: 0.0876s/iter; left time: 1459.2693s
Epoch: 20 cost time: 19.16283655166626
Epoch: 20, Steps: 208 | Train Loss: 1.106 Vali Loss: 4.594 Vali Acc: 0.108 Test Loss: 4.594 Test Acc: 0.108
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 1.2584239
	speed: 0.2763s/iter; left time: 4570.1714s
	iters: 200, epoch: 21 | loss: 1.4008278
	speed: 0.0911s/iter; left time: 1497.2967s
Epoch: 21 cost time: 19.3427791595459
Epoch: 21, Steps: 208 | Train Loss: 1.049 Vali Loss: 4.919 Vali Acc: 0.109 Test Loss: 4.919 Test Acc: 0.109
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.5935286
	speed: 0.2709s/iter; left time: 4424.5796s
	iters: 200, epoch: 22 | loss: 1.1662402
	speed: 0.0857s/iter; left time: 1391.6494s
Epoch: 22 cost time: 18.74160385131836
Epoch: 22, Steps: 208 | Train Loss: 0.994 Vali Loss: 4.797 Vali Acc: 0.121 Test Loss: 4.797 Test Acc: 0.121
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1309275275872353
model parameter : 862947
model size : 4.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.3983865
	speed: 0.1099s/iter; left time: 2274.6958s
	iters: 200, epoch: 1 | loss: 3.7154908
	speed: 0.0922s/iter; left time: 1900.2067s
Epoch: 1 cost time: 21.053789377212524
Epoch: 1, Steps: 208 | Train Loss: 3.683 Vali Loss: 3.596 Vali Acc: 0.046 Test Loss: 3.596 Test Acc: 0.046
Validation loss decreased (inf --> -0.046191).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6926482
	speed: 0.3007s/iter; left time: 6161.9633s
	iters: 200, epoch: 2 | loss: 4.1213894
	speed: 0.0907s/iter; left time: 1849.4559s
Epoch: 2 cost time: 20.64263129234314
Epoch: 2, Steps: 208 | Train Loss: 3.626 Vali Loss: 3.564 Vali Acc: 0.059 Test Loss: 3.564 Test Acc: 0.059
Validation loss decreased (-0.046191 --> -0.058718).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3563902
	speed: 0.3038s/iter; left time: 6162.0923s
	iters: 200, epoch: 3 | loss: 3.3652215
	speed: 0.0945s/iter; left time: 1908.1670s
Epoch: 3 cost time: 20.359100818634033
Epoch: 3, Steps: 208 | Train Loss: 3.510 Vali Loss: 3.519 Vali Acc: 0.062 Test Loss: 3.519 Test Acc: 0.062
Validation loss decreased (-0.058718 --> -0.061999).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3702595
	speed: 0.2741s/iter; left time: 5502.2451s
	iters: 200, epoch: 4 | loss: 3.3083150
	speed: 0.0862s/iter; left time: 1722.6922s
Epoch: 4 cost time: 18.664894819259644
Epoch: 4, Steps: 208 | Train Loss: 3.447 Vali Loss: 3.437 Vali Acc: 0.078 Test Loss: 3.437 Test Acc: 0.078
Validation loss decreased (-0.061999 --> -0.077806).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.4005475
	speed: 0.2814s/iter; left time: 5590.8253s
	iters: 200, epoch: 5 | loss: 3.2669761
	speed: 0.0931s/iter; left time: 1840.9278s
Epoch: 5 cost time: 19.692776441574097
Epoch: 5, Steps: 208 | Train Loss: 3.380 Vali Loss: 3.458 Vali Acc: 0.054 Test Loss: 3.458 Test Acc: 0.054
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.8350134
	speed: 0.2820s/iter; left time: 5543.4946s
	iters: 200, epoch: 6 | loss: 3.4258609
	speed: 0.0922s/iter; left time: 1803.1043s
Epoch: 6 cost time: 19.580822229385376
Epoch: 6, Steps: 208 | Train Loss: 3.245 Vali Loss: 3.272 Vali Acc: 0.086 Test Loss: 3.272 Test Acc: 0.086
Validation loss decreased (-0.077806 --> -0.085861).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.8144844
	speed: 0.2726s/iter; left time: 5301.9874s
	iters: 200, epoch: 7 | loss: 2.7717476
	speed: 0.0876s/iter; left time: 1695.4473s
Epoch: 7 cost time: 18.418532371520996
Epoch: 7, Steps: 208 | Train Loss: 3.105 Vali Loss: 3.236 Vali Acc: 0.105 Test Loss: 3.236 Test Acc: 0.105
Validation loss decreased (-0.085861 --> -0.104650).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.2492068
	speed: 0.2680s/iter; left time: 5157.5236s
	iters: 200, epoch: 8 | loss: 2.9972453
	speed: 0.0898s/iter; left time: 1718.2939s
Epoch: 8 cost time: 19.33726215362549
Epoch: 8, Steps: 208 | Train Loss: 2.982 Vali Loss: 3.178 Vali Acc: 0.111 Test Loss: 3.178 Test Acc: 0.111
Validation loss decreased (-0.104650 --> -0.111212).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.6733618
	speed: 0.3109s/iter; left time: 5919.3876s
	iters: 200, epoch: 9 | loss: 2.9348750
	speed: 0.0960s/iter; left time: 1817.5993s
Epoch: 9 cost time: 20.363823652267456
Epoch: 9, Steps: 208 | Train Loss: 2.850 Vali Loss: 3.156 Vali Acc: 0.118 Test Loss: 3.156 Test Acc: 0.118
Validation loss decreased (-0.111212 --> -0.118072).  Saving model ...
	iters: 100, epoch: 10 | loss: 3.3243794
	speed: 0.2951s/iter; left time: 5557.3321s
	iters: 200, epoch: 10 | loss: 3.5653148
	speed: 0.0901s/iter; left time: 1687.4154s
Epoch: 10 cost time: 19.803548097610474
Epoch: 10, Steps: 208 | Train Loss: 2.710 Vali Loss: 3.170 Vali Acc: 0.115 Test Loss: 3.170 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.9187292
	speed: 0.2921s/iter; left time: 5438.5370s
	iters: 200, epoch: 11 | loss: 2.2847459
	speed: 0.0947s/iter; left time: 1754.8410s
Epoch: 11 cost time: 20.006149768829346
Epoch: 11, Steps: 208 | Train Loss: 2.526 Vali Loss: 3.264 Vali Acc: 0.121 Test Loss: 3.264 Test Acc: 0.121
Validation loss decreased (-0.118072 --> -0.121053).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.2513199
	speed: 0.2893s/iter; left time: 5326.8279s
	iters: 200, epoch: 12 | loss: 2.7407517
	speed: 0.0875s/iter; left time: 1602.6283s
Epoch: 12 cost time: 19.04946541786194
Epoch: 12, Steps: 208 | Train Loss: 2.343 Vali Loss: 3.319 Vali Acc: 0.123 Test Loss: 3.319 Test Acc: 0.123
Validation loss decreased (-0.121053 --> -0.123438).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.6960180
	speed: 0.2622s/iter; left time: 4773.9924s
	iters: 200, epoch: 13 | loss: 2.4873195
	speed: 0.0966s/iter; left time: 1749.1219s
Epoch: 13 cost time: 19.911328077316284
Epoch: 13, Steps: 208 | Train Loss: 2.179 Vali Loss: 3.427 Vali Acc: 0.127 Test Loss: 3.427 Test Acc: 0.127
Validation loss decreased (-0.123438 --> -0.127016).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.3056910
	speed: 0.2892s/iter; left time: 5204.4369s
	iters: 200, epoch: 14 | loss: 1.9921768
	speed: 0.0851s/iter; left time: 1522.9204s
Epoch: 14 cost time: 18.722193717956543
Epoch: 14, Steps: 208 | Train Loss: 1.985 Vali Loss: 3.661 Vali Acc: 0.126 Test Loss: 3.661 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.5542492
	speed: 0.2827s/iter; left time: 5029.2344s
	iters: 200, epoch: 15 | loss: 2.1859891
	speed: 0.0889s/iter; left time: 1571.7449s
Epoch: 15 cost time: 19.396379232406616
Epoch: 15, Steps: 208 | Train Loss: 1.824 Vali Loss: 3.681 Vali Acc: 0.127 Test Loss: 3.681 Test Acc: 0.127
Validation loss decreased (-0.127016 --> -0.127312).  Saving model ...
	iters: 100, epoch: 16 | loss: 2.2487686
	speed: 0.2693s/iter; left time: 4733.9448s
	iters: 200, epoch: 16 | loss: 1.9474547
	speed: 0.0864s/iter; left time: 1509.9022s
Epoch: 16 cost time: 19.088171243667603
Epoch: 16, Steps: 208 | Train Loss: 1.682 Vali Loss: 3.882 Vali Acc: 0.122 Test Loss: 3.882 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.2862891
	speed: 0.2906s/iter; left time: 5048.2375s
	iters: 200, epoch: 17 | loss: 1.7160394
	speed: 0.0862s/iter; left time: 1489.2984s
Epoch: 17 cost time: 20.343061923980713
Epoch: 17, Steps: 208 | Train Loss: 1.524 Vali Loss: 4.036 Vali Acc: 0.123 Test Loss: 4.036 Test Acc: 0.123
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.7014278
	speed: 0.2741s/iter; left time: 4704.0765s
	iters: 200, epoch: 18 | loss: 0.9635498
	speed: 0.0914s/iter; left time: 1560.5764s
Epoch: 18 cost time: 19.492209911346436
Epoch: 18, Steps: 208 | Train Loss: 1.343 Vali Loss: 4.291 Vali Acc: 0.115 Test Loss: 4.291 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.8904650
	speed: 0.3156s/iter; left time: 5352.2349s
	iters: 200, epoch: 19 | loss: 1.1760845
	speed: 0.0930s/iter; left time: 1567.3996s
Epoch: 19 cost time: 21.459206104278564
Epoch: 19, Steps: 208 | Train Loss: 1.281 Vali Loss: 4.444 Vali Acc: 0.123 Test Loss: 4.444 Test Acc: 0.123
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 1.2127445
	speed: 0.2882s/iter; left time: 4827.2042s
	iters: 200, epoch: 20 | loss: 1.4658712
	speed: 0.0984s/iter; left time: 1638.2831s
Epoch: 20 cost time: 20.647427797317505
Epoch: 20, Steps: 208 | Train Loss: 1.166 Vali Loss: 4.485 Vali Acc: 0.118 Test Loss: 4.485 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 1.1400411
	speed: 0.2836s/iter; left time: 4691.1258s
	iters: 200, epoch: 21 | loss: 1.2478552
	speed: 0.0874s/iter; left time: 1437.3495s
Epoch: 21 cost time: 18.849089860916138
Epoch: 21, Steps: 208 | Train Loss: 1.045 Vali Loss: 4.618 Vali Acc: 0.118 Test Loss: 4.618 Test Acc: 0.118
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.4566572
	speed: 0.2900s/iter; left time: 4736.8747s
	iters: 200, epoch: 22 | loss: 1.0971063
	speed: 0.0931s/iter; left time: 1511.6422s
Epoch: 22 cost time: 19.717989206314087
Epoch: 22, Steps: 208 | Train Loss: 1.003 Vali Loss: 4.726 Vali Acc: 0.115 Test Loss: 4.726 Test Acc: 0.115
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 1.3079103
	speed: 0.2915s/iter; left time: 4700.9578s
	iters: 200, epoch: 23 | loss: 0.8545657
	speed: 0.0841s/iter; left time: 1347.0440s
Epoch: 23 cost time: 18.99749445915222
Epoch: 23, Steps: 208 | Train Loss: 0.923 Vali Loss: 4.954 Vali Acc: 0.112 Test Loss: 4.954 Test Acc: 0.112
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.7727835
	speed: 0.2899s/iter; left time: 4613.6048s
	iters: 200, epoch: 24 | loss: 1.6170053
	speed: 0.0877s/iter; left time: 1387.9058s
Epoch: 24 cost time: 18.52056336402893
Epoch: 24, Steps: 208 | Train Loss: 0.869 Vali Loss: 4.822 Vali Acc: 0.124 Test Loss: 4.822 Test Acc: 0.124
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.4249313
	speed: 0.2725s/iter; left time: 4280.9329s
	iters: 200, epoch: 25 | loss: 0.9305641
	speed: 0.0902s/iter; left time: 1408.0785s
Epoch: 25 cost time: 19.69723916053772
Epoch: 25, Steps: 208 | Train Loss: 0.833 Vali Loss: 5.193 Vali Acc: 0.116 Test Loss: 5.193 Test Acc: 0.116
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12734864300626306
model parameter : 860579
model size : 4.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.4779310
	speed: 0.1027s/iter; left time: 2125.1452s
	iters: 200, epoch: 1 | loss: 3.6079614
	speed: 0.0921s/iter; left time: 1896.3781s
Epoch: 1 cost time: 20.595032691955566
Epoch: 1, Steps: 208 | Train Loss: 3.728 Vali Loss: 3.598 Vali Acc: 0.057 Test Loss: 3.598 Test Acc: 0.057
Validation loss decreased (inf --> -0.056928).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4961057
	speed: 0.2973s/iter; left time: 6092.4640s
	iters: 200, epoch: 2 | loss: 3.4281352
	speed: 0.0876s/iter; left time: 1785.6890s
Epoch: 2 cost time: 19.32342839241028
Epoch: 2, Steps: 208 | Train Loss: 3.619 Vali Loss: 3.575 Vali Acc: 0.059 Test Loss: 3.575 Test Acc: 0.059
Validation loss decreased (-0.056928 --> -0.059314).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4638839
	speed: 0.3086s/iter; left time: 6260.8131s
	iters: 200, epoch: 3 | loss: 3.6210518
	speed: 0.0847s/iter; left time: 1709.4331s
Epoch: 3 cost time: 18.478062868118286
Epoch: 3, Steps: 208 | Train Loss: 3.533 Vali Loss: 3.477 Vali Acc: 0.070 Test Loss: 3.477 Test Acc: 0.070
Validation loss decreased (-0.059314 --> -0.070350).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.7690434
	speed: 0.2537s/iter; left time: 5092.8579s
	iters: 200, epoch: 4 | loss: 3.7499022
	speed: 0.0855s/iter; left time: 1707.8292s
Epoch: 4 cost time: 18.401342153549194
Epoch: 4, Steps: 208 | Train Loss: 3.445 Vali Loss: 3.446 Vali Acc: 0.057 Test Loss: 3.446 Test Acc: 0.057
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.4170423
	speed: 0.2864s/iter; left time: 5689.7683s
	iters: 200, epoch: 5 | loss: 3.0237284
	speed: 0.0836s/iter; left time: 1652.6339s
Epoch: 5 cost time: 18.18041682243347
Epoch: 5, Steps: 208 | Train Loss: 3.363 Vali Loss: 3.391 Vali Acc: 0.077 Test Loss: 3.391 Test Acc: 0.077
Validation loss decreased (-0.070350 --> -0.076912).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.3175666
	speed: 0.2986s/iter; left time: 5869.9870s
	iters: 200, epoch: 6 | loss: 3.5373876
	speed: 0.0866s/iter; left time: 1693.7943s
Epoch: 6 cost time: 20.02925181388855
Epoch: 6, Steps: 208 | Train Loss: 3.232 Vali Loss: 3.264 Vali Acc: 0.092 Test Loss: 3.264 Test Acc: 0.092
Validation loss decreased (-0.076912 --> -0.091527).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.5028307
	speed: 0.2676s/iter; left time: 5206.4247s
	iters: 200, epoch: 7 | loss: 3.0394850
	speed: 0.0909s/iter; left time: 1759.7251s
Epoch: 7 cost time: 18.84693193435669
Epoch: 7, Steps: 208 | Train Loss: 3.101 Vali Loss: 3.223 Vali Acc: 0.095 Test Loss: 3.223 Test Acc: 0.095
Validation loss decreased (-0.091527 --> -0.095106).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.8514380
	speed: 0.2796s/iter; left time: 5380.1771s
	iters: 200, epoch: 8 | loss: 2.9448826
	speed: 0.0885s/iter; left time: 1694.9539s
Epoch: 8 cost time: 18.81143832206726
Epoch: 8, Steps: 208 | Train Loss: 2.967 Vali Loss: 3.150 Vali Acc: 0.102 Test Loss: 3.150 Test Acc: 0.102
Validation loss decreased (-0.095106 --> -0.101668).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.5337811
	speed: 0.2975s/iter; left time: 5663.6305s
	iters: 200, epoch: 9 | loss: 2.6475840
	speed: 0.0911s/iter; left time: 1725.1076s
Epoch: 9 cost time: 19.95644211769104
Epoch: 9, Steps: 208 | Train Loss: 2.820 Vali Loss: 3.176 Vali Acc: 0.118 Test Loss: 3.176 Test Acc: 0.118
Validation loss decreased (-0.101668 --> -0.118071).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.2812064
	speed: 0.2749s/iter; left time: 5175.5507s
	iters: 200, epoch: 10 | loss: 2.3467283
	speed: 0.0973s/iter; left time: 1821.7351s
Epoch: 10 cost time: 19.58754563331604
Epoch: 10, Steps: 208 | Train Loss: 2.668 Vali Loss: 3.299 Vali Acc: 0.115 Test Loss: 3.299 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.1919832
	speed: 0.2957s/iter; left time: 5506.4292s
	iters: 200, epoch: 11 | loss: 2.6379962
	speed: 0.0939s/iter; left time: 1738.2052s
Epoch: 11 cost time: 19.950286149978638
Epoch: 11, Steps: 208 | Train Loss: 2.526 Vali Loss: 3.194 Vali Acc: 0.119 Test Loss: 3.194 Test Acc: 0.119
Validation loss decreased (-0.118071 --> -0.118966).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.1528354
	speed: 0.2731s/iter; left time: 5027.9325s
	iters: 200, epoch: 12 | loss: 2.4302545
	speed: 0.0906s/iter; left time: 1658.8171s
Epoch: 12 cost time: 18.500678777694702
Epoch: 12, Steps: 208 | Train Loss: 2.349 Vali Loss: 3.349 Vali Acc: 0.121 Test Loss: 3.349 Test Acc: 0.121
Validation loss decreased (-0.118966 --> -0.120754).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.4643977
	speed: 0.2593s/iter; left time: 4720.1634s
	iters: 200, epoch: 13 | loss: 2.0106480
	speed: 0.0864s/iter; left time: 1564.8906s
Epoch: 13 cost time: 18.32297992706299
Epoch: 13, Steps: 208 | Train Loss: 2.189 Vali Loss: 3.444 Vali Acc: 0.123 Test Loss: 3.444 Test Acc: 0.123
Validation loss decreased (-0.120754 --> -0.123139).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.2023611
	speed: 0.2772s/iter; left time: 4989.1324s
	iters: 200, epoch: 14 | loss: 2.5427597
	speed: 0.0839s/iter; left time: 1501.6536s
Epoch: 14 cost time: 17.802496671676636
Epoch: 14, Steps: 208 | Train Loss: 1.975 Vali Loss: 3.740 Vali Acc: 0.123 Test Loss: 3.740 Test Acc: 0.123
Validation loss decreased (-0.123139 --> -0.123434).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.4773085
	speed: 0.2672s/iter; left time: 4752.9561s
	iters: 200, epoch: 15 | loss: 2.0155904
	speed: 0.0830s/iter; left time: 1468.3384s
Epoch: 15 cost time: 18.160868406295776
Epoch: 15, Steps: 208 | Train Loss: 1.812 Vali Loss: 3.812 Vali Acc: 0.116 Test Loss: 3.812 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.7988912
	speed: 0.2391s/iter; left time: 4204.3004s
	iters: 200, epoch: 16 | loss: 2.1433334
	speed: 0.0759s/iter; left time: 1326.6986s
Epoch: 16 cost time: 16.183974742889404
Epoch: 16, Steps: 208 | Train Loss: 1.675 Vali Loss: 3.907 Vali Acc: 0.117 Test Loss: 3.907 Test Acc: 0.117
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.7171983
	speed: 0.2570s/iter; left time: 4464.7882s
	iters: 200, epoch: 17 | loss: 1.0207881
	speed: 0.0864s/iter; left time: 1492.5721s
Epoch: 17 cost time: 18.699116230010986
Epoch: 17, Steps: 208 | Train Loss: 1.526 Vali Loss: 4.097 Vali Acc: 0.111 Test Loss: 4.097 Test Acc: 0.111
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.4459985
	speed: 0.2819s/iter; left time: 4839.1480s
	iters: 200, epoch: 18 | loss: 1.5982895
	speed: 0.0953s/iter; left time: 1626.5438s
Epoch: 18 cost time: 20.80068278312683
Epoch: 18, Steps: 208 | Train Loss: 1.418 Vali Loss: 4.130 Vali Acc: 0.129 Test Loss: 4.130 Test Acc: 0.129
Validation loss decreased (-0.123434 --> -0.129395).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.8371881
	speed: 0.2793s/iter; left time: 4735.5330s
	iters: 200, epoch: 19 | loss: 1.5008758
	speed: 0.0887s/iter; left time: 1495.7031s
Epoch: 19 cost time: 18.785818099975586
Epoch: 19, Steps: 208 | Train Loss: 1.296 Vali Loss: 4.421 Vali Acc: 0.117 Test Loss: 4.421 Test Acc: 0.117
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.3379579
	speed: 0.2797s/iter; left time: 4685.0294s
	iters: 200, epoch: 20 | loss: 1.3495909
	speed: 0.0876s/iter; left time: 1458.8762s
Epoch: 20 cost time: 19.273056268692017
Epoch: 20, Steps: 208 | Train Loss: 1.186 Vali Loss: 4.482 Vali Acc: 0.116 Test Loss: 4.482 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.1034522
	speed: 0.2921s/iter; left time: 4832.2556s
	iters: 200, epoch: 21 | loss: 1.1466751
	speed: 0.1036s/iter; left time: 1703.9005s
Epoch: 21 cost time: 21.046192407608032
Epoch: 21, Steps: 208 | Train Loss: 1.082 Vali Loss: 4.722 Vali Acc: 0.125 Test Loss: 4.722 Test Acc: 0.125
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.5954801
	speed: 0.2906s/iter; left time: 4746.1087s
	iters: 200, epoch: 22 | loss: 0.7022521
	speed: 0.0859s/iter; left time: 1393.8584s
Epoch: 22 cost time: 18.926228046417236
Epoch: 22, Steps: 208 | Train Loss: 1.026 Vali Loss: 4.859 Vali Acc: 0.129 Test Loss: 4.859 Test Acc: 0.129
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.8796915
	speed: 0.2869s/iter; left time: 4626.3063s
	iters: 200, epoch: 23 | loss: 1.8326286
	speed: 0.0921s/iter; left time: 1476.1836s
Epoch: 23 cost time: 19.986292123794556
Epoch: 23, Steps: 208 | Train Loss: 0.957 Vali Loss: 4.999 Vali Acc: 0.124 Test Loss: 4.999 Test Acc: 0.124
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 1.2715014
	speed: 0.2991s/iter; left time: 4760.7456s
	iters: 200, epoch: 24 | loss: 0.6842056
	speed: 0.0894s/iter; left time: 1414.6203s
Epoch: 24 cost time: 20.293688774108887
Epoch: 24, Steps: 208 | Train Loss: 0.913 Vali Loss: 5.025 Vali Acc: 0.114 Test Loss: 5.025 Test Acc: 0.114
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 1.3766111
	speed: 0.2932s/iter; left time: 4606.0350s
	iters: 200, epoch: 25 | loss: 1.0657073
	speed: 0.0896s/iter; left time: 1398.0178s
Epoch: 25 cost time: 19.795210361480713
Epoch: 25, Steps: 208 | Train Loss: 0.895 Vali Loss: 5.202 Vali Acc: 0.123 Test Loss: 5.202 Test Acc: 0.123
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.7231209
	speed: 0.3104s/iter; left time: 4810.7986s
	iters: 200, epoch: 26 | loss: 1.7814776
	speed: 0.0924s/iter; left time: 1422.3761s
Epoch: 26 cost time: 20.413461208343506
Epoch: 26, Steps: 208 | Train Loss: 0.815 Vali Loss: 5.211 Vali Acc: 0.128 Test Loss: 5.211 Test Acc: 0.128
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.4112175
	speed: 0.3044s/iter; left time: 4655.3522s
	iters: 200, epoch: 27 | loss: 1.5407817
	speed: 0.0945s/iter; left time: 1435.5782s
Epoch: 27 cost time: 19.586504459381104
Epoch: 27, Steps: 208 | Train Loss: 0.800 Vali Loss: 5.499 Vali Acc: 0.115 Test Loss: 5.499 Test Acc: 0.115
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.6624922
	speed: 0.2887s/iter; left time: 4354.5855s
	iters: 200, epoch: 28 | loss: 0.9528168
	speed: 0.0858s/iter; left time: 1285.2778s
Epoch: 28 cost time: 19.4219388961792
Epoch: 28, Steps: 208 | Train Loss: 0.747 Vali Loss: 5.801 Vali Acc: 0.115 Test Loss: 5.801 Test Acc: 0.115
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12943632567849686
model parameter : 858211
model size : 4.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7466068
	speed: 0.1069s/iter; left time: 2212.5798s
	iters: 200, epoch: 1 | loss: 3.5244136
	speed: 0.0779s/iter; left time: 1604.7834s
Epoch: 1 cost time: 19.12943959236145
Epoch: 1, Steps: 208 | Train Loss: 3.654 Vali Loss: 3.612 Vali Acc: 0.061 Test Loss: 3.612 Test Acc: 0.061
Validation loss decreased (inf --> -0.061401).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7576683
	speed: 0.2676s/iter; left time: 5484.1431s
	iters: 200, epoch: 2 | loss: 3.3205194
	speed: 0.0874s/iter; left time: 1783.0167s
Epoch: 2 cost time: 18.84303879737854
Epoch: 2, Steps: 208 | Train Loss: 3.571 Vali Loss: 3.496 Vali Acc: 0.067 Test Loss: 3.496 Test Acc: 0.067
Validation loss decreased (-0.061401 --> -0.066473).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6917076
	speed: 0.2847s/iter; left time: 5774.7636s
	iters: 200, epoch: 3 | loss: 3.4012771
	speed: 0.0917s/iter; left time: 1850.3849s
Epoch: 3 cost time: 19.118200302124023
Epoch: 3, Steps: 208 | Train Loss: 3.506 Vali Loss: 3.495 Vali Acc: 0.065 Test Loss: 3.495 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.6155660
	speed: 0.2983s/iter; left time: 5989.1979s
	iters: 200, epoch: 4 | loss: 3.4546838
	speed: 0.0960s/iter; left time: 1917.1336s
Epoch: 4 cost time: 20.38235878944397
Epoch: 4, Steps: 208 | Train Loss: 3.442 Vali Loss: 3.467 Vali Acc: 0.060 Test Loss: 3.467 Test Acc: 0.060
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 3.4907677
	speed: 0.2970s/iter; left time: 5900.8685s
	iters: 200, epoch: 5 | loss: 3.2471328
	speed: 0.0943s/iter; left time: 1864.8181s
Epoch: 5 cost time: 20.255024194717407
Epoch: 5, Steps: 208 | Train Loss: 3.408 Vali Loss: 3.450 Vali Acc: 0.072 Test Loss: 3.450 Test Acc: 0.072
Validation loss decreased (-0.066473 --> -0.071543).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.5062644
	speed: 0.3199s/iter; left time: 6289.6272s
	iters: 200, epoch: 6 | loss: 3.1076589
	speed: 0.0942s/iter; left time: 1842.4931s
Epoch: 6 cost time: 21.72054672241211
Epoch: 6, Steps: 208 | Train Loss: 3.366 Vali Loss: 3.519 Vali Acc: 0.071 Test Loss: 3.519 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.7677579
	speed: 0.2865s/iter; left time: 5573.7436s
	iters: 200, epoch: 7 | loss: 3.7993529
	speed: 0.0929s/iter; left time: 1797.9819s
Epoch: 7 cost time: 18.85978603363037
Epoch: 7, Steps: 208 | Train Loss: 3.320 Vali Loss: 3.465 Vali Acc: 0.065 Test Loss: 3.465 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.1328878
	speed: 0.2735s/iter; left time: 5264.0608s
	iters: 200, epoch: 8 | loss: 3.4145641
	speed: 0.0829s/iter; left time: 1586.8799s
Epoch: 8 cost time: 18.347940921783447
Epoch: 8, Steps: 208 | Train Loss: 3.291 Vali Loss: 3.469 Vali Acc: 0.069 Test Loss: 3.469 Test Acc: 0.069
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 3.1149540
	speed: 0.2903s/iter; left time: 5525.7530s
	iters: 200, epoch: 9 | loss: 3.2967591
	speed: 0.0948s/iter; left time: 1795.9767s
Epoch: 9 cost time: 20.0143563747406
Epoch: 9, Steps: 208 | Train Loss: 3.254 Vali Loss: 3.465 Vali Acc: 0.073 Test Loss: 3.465 Test Acc: 0.073
Validation loss decreased (-0.071543 --> -0.073332).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.9081295
	speed: 0.2631s/iter; left time: 4954.6735s
	iters: 200, epoch: 10 | loss: 3.4403331
	speed: 0.0813s/iter; left time: 1523.5593s
Epoch: 10 cost time: 17.254924535751343
Epoch: 10, Steps: 208 | Train Loss: 3.212 Vali Loss: 3.430 Vali Acc: 0.076 Test Loss: 3.430 Test Acc: 0.076
Validation loss decreased (-0.073332 --> -0.076017).  Saving model ...
	iters: 100, epoch: 11 | loss: 3.4205289
	speed: 0.2927s/iter; left time: 5450.0574s
	iters: 200, epoch: 11 | loss: 2.9380040
	speed: 0.0886s/iter; left time: 1640.4617s
Epoch: 11 cost time: 19.893263578414917
Epoch: 11, Steps: 208 | Train Loss: 3.151 Vali Loss: 3.418 Vali Acc: 0.080 Test Loss: 3.418 Test Acc: 0.080
Validation loss decreased (-0.076017 --> -0.079596).  Saving model ...
	iters: 100, epoch: 12 | loss: 3.0262580
	speed: 0.2653s/iter; left time: 4885.2437s
	iters: 200, epoch: 12 | loss: 3.0537527
	speed: 0.0937s/iter; left time: 1715.0312s
Epoch: 12 cost time: 18.706708192825317
Epoch: 12, Steps: 208 | Train Loss: 3.106 Vali Loss: 3.483 Vali Acc: 0.079 Test Loss: 3.483 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.9159424
	speed: 0.2883s/iter; left time: 5247.7851s
	iters: 200, epoch: 13 | loss: 2.6529365
	speed: 0.0901s/iter; left time: 1632.0351s
Epoch: 13 cost time: 19.380714416503906
Epoch: 13, Steps: 208 | Train Loss: 3.025 Vali Loss: 3.465 Vali Acc: 0.080 Test Loss: 3.465 Test Acc: 0.080
Validation loss decreased (-0.079596 --> -0.080192).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.7563927
	speed: 0.3222s/iter; left time: 5799.2587s
	iters: 200, epoch: 14 | loss: 3.3341448
	speed: 0.0944s/iter; left time: 1689.1792s
Epoch: 14 cost time: 20.878893852233887
Epoch: 14, Steps: 208 | Train Loss: 2.957 Vali Loss: 3.489 Vali Acc: 0.083 Test Loss: 3.489 Test Acc: 0.083
Validation loss decreased (-0.080192 --> -0.082876).  Saving model ...
	iters: 100, epoch: 15 | loss: 2.8970270
	speed: 0.3057s/iter; left time: 5438.7711s
	iters: 200, epoch: 15 | loss: 2.7574418
	speed: 0.0901s/iter; left time: 1594.2213s
Epoch: 15 cost time: 20.486748218536377
Epoch: 15, Steps: 208 | Train Loss: 2.861 Vali Loss: 3.572 Vali Acc: 0.087 Test Loss: 3.572 Test Acc: 0.087
Validation loss decreased (-0.082876 --> -0.087050).  Saving model ...
	iters: 100, epoch: 16 | loss: 3.0073776
	speed: 0.2753s/iter; left time: 4840.0823s
	iters: 200, epoch: 16 | loss: 2.6971166
	speed: 0.0959s/iter; left time: 1676.2923s
Epoch: 16 cost time: 19.69157314300537
Epoch: 16, Steps: 208 | Train Loss: 2.758 Vali Loss: 3.606 Vali Acc: 0.086 Test Loss: 3.606 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 2.8969276
	speed: 0.2803s/iter; left time: 4868.8024s
	iters: 200, epoch: 17 | loss: 2.9135244
	speed: 0.0934s/iter; left time: 1612.6821s
Epoch: 17 cost time: 18.782872200012207
Epoch: 17, Steps: 208 | Train Loss: 2.656 Vali Loss: 3.584 Vali Acc: 0.096 Test Loss: 3.584 Test Acc: 0.096
Validation loss decreased (-0.087050 --> -0.096296).  Saving model ...
	iters: 100, epoch: 18 | loss: 2.3164554
	speed: 0.3066s/iter; left time: 5262.5875s
	iters: 200, epoch: 18 | loss: 3.3660078
	speed: 0.0920s/iter; left time: 1569.3406s
Epoch: 18 cost time: 20.452221155166626
Epoch: 18, Steps: 208 | Train Loss: 2.553 Vali Loss: 3.622 Vali Acc: 0.086 Test Loss: 3.622 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 2.1332576
	speed: 0.2970s/iter; left time: 5036.1301s
	iters: 200, epoch: 19 | loss: 2.3780363
	speed: 0.0863s/iter; left time: 1455.1256s
Epoch: 19 cost time: 19.79877519607544
Epoch: 19, Steps: 208 | Train Loss: 2.498 Vali Loss: 3.699 Vali Acc: 0.100 Test Loss: 3.699 Test Acc: 0.100
Validation loss decreased (-0.096296 --> -0.100172).  Saving model ...
	iters: 100, epoch: 20 | loss: 2.3562953
	speed: 0.3152s/iter; left time: 5279.3636s
	iters: 200, epoch: 20 | loss: 2.4919586
	speed: 0.0920s/iter; left time: 1532.3624s
Epoch: 20 cost time: 19.514982223510742
Epoch: 20, Steps: 208 | Train Loss: 2.356 Vali Loss: 3.777 Vali Acc: 0.095 Test Loss: 3.777 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 2.3781109
	speed: 0.3094s/iter; left time: 5118.0701s
	iters: 200, epoch: 21 | loss: 2.0768437
	speed: 0.1033s/iter; left time: 1698.0800s
Epoch: 21 cost time: 21.27558159828186
Epoch: 21, Steps: 208 | Train Loss: 2.228 Vali Loss: 3.870 Vali Acc: 0.089 Test Loss: 3.870 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.8542887
	speed: 0.3129s/iter; left time: 5110.9093s
	iters: 200, epoch: 22 | loss: 2.8677173
	speed: 0.1012s/iter; left time: 1642.6468s
Epoch: 22 cost time: 21.74637269973755
Epoch: 22, Steps: 208 | Train Loss: 2.104 Vali Loss: 3.944 Vali Acc: 0.090 Test Loss: 3.944 Test Acc: 0.090
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 1.8018814
	speed: 0.3307s/iter; left time: 5331.8670s
	iters: 200, epoch: 23 | loss: 2.8252482
	speed: 0.0946s/iter; left time: 1516.2255s
Epoch: 23 cost time: 20.097076416015625
Epoch: 23, Steps: 208 | Train Loss: 2.000 Vali Loss: 4.051 Vali Acc: 0.105 Test Loss: 4.051 Test Acc: 0.105
Validation loss decreased (-0.100172 --> -0.104940).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.4862119
	speed: 0.3011s/iter; left time: 4792.8277s
	iters: 200, epoch: 24 | loss: 2.6079793
	speed: 0.0876s/iter; left time: 1386.1726s
Epoch: 24 cost time: 19.994757890701294
Epoch: 24, Steps: 208 | Train Loss: 1.935 Vali Loss: 4.049 Vali Acc: 0.095 Test Loss: 4.049 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 2.0764141
	speed: 0.3012s/iter; left time: 4731.5382s
	iters: 200, epoch: 25 | loss: 1.8917328
	speed: 0.0953s/iter; left time: 1488.2901s
Epoch: 25 cost time: 20.201663494110107
Epoch: 25, Steps: 208 | Train Loss: 1.814 Vali Loss: 4.168 Vali Acc: 0.096 Test Loss: 4.168 Test Acc: 0.096
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 2.2028773
	speed: 0.3003s/iter; left time: 4655.4932s
	iters: 200, epoch: 26 | loss: 1.7469878
	speed: 0.0896s/iter; left time: 1380.2595s
Epoch: 26 cost time: 19.156237840652466
Epoch: 26, Steps: 208 | Train Loss: 1.756 Vali Loss: 4.220 Vali Acc: 0.098 Test Loss: 4.220 Test Acc: 0.098
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 1.4030195
	speed: 0.3076s/iter; left time: 4703.6157s
	iters: 200, epoch: 27 | loss: 2.2812765
	speed: 0.0912s/iter; left time: 1385.1387s
Epoch: 27 cost time: 20.524136066436768
Epoch: 27, Steps: 208 | Train Loss: 1.629 Vali Loss: 4.376 Vali Acc: 0.097 Test Loss: 4.376 Test Acc: 0.097
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 1.6188300
	speed: 0.2967s/iter; left time: 4476.3011s
	iters: 200, epoch: 28 | loss: 1.3422104
	speed: 0.1034s/iter; left time: 1550.0220s
Epoch: 28 cost time: 21.32493829727173
Epoch: 28, Steps: 208 | Train Loss: 1.542 Vali Loss: 4.504 Vali Acc: 0.096 Test Loss: 4.504 Test Acc: 0.096
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 1.7280926
	speed: 0.3008s/iter; left time: 4474.7885s
	iters: 200, epoch: 29 | loss: 0.9463242
	speed: 0.0974s/iter; left time: 1439.6047s
Epoch: 29 cost time: 20.0142765045166
Epoch: 29, Steps: 208 | Train Loss: 1.493 Vali Loss: 4.612 Vali Acc: 0.094 Test Loss: 4.612 Test Acc: 0.094
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 1.7130964
	speed: 0.3296s/iter; left time: 4835.3783s
	iters: 200, epoch: 30 | loss: 1.0207933
	speed: 0.0906s/iter; left time: 1319.4600s
Epoch: 30 cost time: 20.470436096191406
Epoch: 30, Steps: 208 | Train Loss: 1.386 Vali Loss: 4.765 Vali Acc: 0.090 Test Loss: 4.765 Test Acc: 0.090
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.6284067
	speed: 0.3177s/iter; left time: 4593.6842s
	iters: 200, epoch: 31 | loss: 1.4161887
	speed: 0.0889s/iter; left time: 1276.0232s
Epoch: 31 cost time: 20.16742706298828
Epoch: 31, Steps: 208 | Train Loss: 1.303 Vali Loss: 4.925 Vali Acc: 0.091 Test Loss: 4.925 Test Acc: 0.091
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 1.3429543
	speed: 0.2878s/iter; left time: 4102.5217s
	iters: 200, epoch: 32 | loss: 1.3443516
	speed: 0.1056s/iter; left time: 1494.5866s
Epoch: 32 cost time: 20.93772602081299
Epoch: 32, Steps: 208 | Train Loss: 1.275 Vali Loss: 4.933 Vali Acc: 0.096 Test Loss: 4.933 Test Acc: 0.096
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.9754217
	speed: 0.3164s/iter; left time: 4443.5223s
	iters: 200, epoch: 33 | loss: 1.1520573
	speed: 0.0959s/iter; left time: 1337.8604s
Epoch: 33 cost time: 20.947053909301758
Epoch: 33, Steps: 208 | Train Loss: 1.203 Vali Loss: 5.085 Vali Acc: 0.085 Test Loss: 5.085 Test Acc: 0.085
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1049806143751864
model parameter : 809987
model size : 3.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0312915
	speed: 0.1143s/iter; left time: 2366.6825s
	iters: 200, epoch: 1 | loss: 3.7824409
	speed: 0.0875s/iter; left time: 1803.5233s
Epoch: 1 cost time: 20.970282316207886
Epoch: 1, Steps: 208 | Train Loss: 3.694 Vali Loss: 3.568 Vali Acc: 0.054 Test Loss: 3.568 Test Acc: 0.054
Validation loss decreased (inf --> -0.054244).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5723178
	speed: 0.2744s/iter; left time: 5623.7529s
	iters: 200, epoch: 2 | loss: 3.2318139
	speed: 0.0939s/iter; left time: 1915.6088s
Epoch: 2 cost time: 20.608747243881226
Epoch: 2, Steps: 208 | Train Loss: 3.567 Vali Loss: 3.497 Vali Acc: 0.067 Test Loss: 3.497 Test Acc: 0.067
Validation loss decreased (-0.054244 --> -0.067367).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.2261605
	speed: 0.2968s/iter; left time: 6021.5464s
	iters: 200, epoch: 3 | loss: 3.5396626
	speed: 0.0911s/iter; left time: 1838.7505s
Epoch: 3 cost time: 19.03373384475708
Epoch: 3, Steps: 208 | Train Loss: 3.487 Vali Loss: 3.491 Vali Acc: 0.064 Test Loss: 3.491 Test Acc: 0.064
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.3377964
	speed: 0.2965s/iter; left time: 5952.2407s
	iters: 200, epoch: 4 | loss: 3.4412110
	speed: 0.1010s/iter; left time: 2016.7269s
Epoch: 4 cost time: 20.81667160987854
Epoch: 4, Steps: 208 | Train Loss: 3.453 Vali Loss: 3.461 Vali Acc: 0.063 Test Loss: 3.461 Test Acc: 0.063
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 3.4080443
	speed: 0.2891s/iter; left time: 5743.6161s
	iters: 200, epoch: 5 | loss: 3.1491337
	speed: 0.0850s/iter; left time: 1679.7014s
Epoch: 5 cost time: 18.15610980987549
Epoch: 5, Steps: 208 | Train Loss: 3.387 Vali Loss: 3.477 Vali Acc: 0.069 Test Loss: 3.477 Test Acc: 0.069
Validation loss decreased (-0.067367 --> -0.069455).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.3859968
	speed: 0.2982s/iter; left time: 5862.1478s
	iters: 200, epoch: 6 | loss: 3.6516371
	speed: 0.0824s/iter; left time: 1611.2933s
Epoch: 6 cost time: 18.580514907836914
Epoch: 6, Steps: 208 | Train Loss: 3.359 Vali Loss: 3.439 Vali Acc: 0.064 Test Loss: 3.439 Test Acc: 0.064
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.0874224
	speed: 0.2919s/iter; left time: 5679.0234s
	iters: 200, epoch: 7 | loss: 3.3104305
	speed: 0.0994s/iter; left time: 1924.0400s
Epoch: 7 cost time: 20.34215807914734
Epoch: 7, Steps: 208 | Train Loss: 3.304 Vali Loss: 3.475 Vali Acc: 0.067 Test Loss: 3.475 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.2661486
	speed: 0.2956s/iter; left time: 5687.9986s
	iters: 200, epoch: 8 | loss: 3.2785416
	speed: 0.0901s/iter; left time: 1724.4313s
Epoch: 8 cost time: 18.721660375595093
Epoch: 8, Steps: 208 | Train Loss: 3.269 Vali Loss: 3.446 Vali Acc: 0.072 Test Loss: 3.446 Test Acc: 0.072
Validation loss decreased (-0.069455 --> -0.072438).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.8172412
	speed: 0.2878s/iter; left time: 5478.5266s
	iters: 200, epoch: 9 | loss: 3.2709508
	speed: 0.0803s/iter; left time: 1520.0576s
Epoch: 9 cost time: 18.317928075790405
Epoch: 9, Steps: 208 | Train Loss: 3.229 Vali Loss: 3.446 Vali Acc: 0.077 Test Loss: 3.446 Test Acc: 0.077
Validation loss decreased (-0.072438 --> -0.076912).  Saving model ...
	iters: 100, epoch: 10 | loss: 3.0554280
	speed: 0.2941s/iter; left time: 5537.9773s
	iters: 200, epoch: 10 | loss: 2.9490924
	speed: 0.0942s/iter; left time: 1763.6644s
Epoch: 10 cost time: 20.246309757232666
Epoch: 10, Steps: 208 | Train Loss: 3.168 Vali Loss: 3.473 Vali Acc: 0.075 Test Loss: 3.473 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.8514848
	speed: 0.3055s/iter; left time: 5689.0790s
	iters: 200, epoch: 11 | loss: 3.0895622
	speed: 0.0910s/iter; left time: 1685.3835s
Epoch: 11 cost time: 19.502649068832397
Epoch: 11, Steps: 208 | Train Loss: 3.115 Vali Loss: 3.462 Vali Acc: 0.078 Test Loss: 3.462 Test Acc: 0.078
Validation loss decreased (-0.076912 --> -0.078104).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.9165926
	speed: 0.2927s/iter; left time: 5389.2967s
	iters: 200, epoch: 12 | loss: 3.1118934
	speed: 0.0905s/iter; left time: 1658.1058s
Epoch: 12 cost time: 19.408580541610718
Epoch: 12, Steps: 208 | Train Loss: 3.076 Vali Loss: 3.500 Vali Acc: 0.074 Test Loss: 3.500 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.9139304
	speed: 0.2936s/iter; left time: 5345.0708s
	iters: 200, epoch: 13 | loss: 3.6518140
	speed: 0.0958s/iter; left time: 1734.2301s
Epoch: 13 cost time: 20.476589679718018
Epoch: 13, Steps: 208 | Train Loss: 2.963 Vali Loss: 3.541 Vali Acc: 0.079 Test Loss: 3.541 Test Acc: 0.079
Validation loss decreased (-0.078104 --> -0.078998).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.8815417
	speed: 0.2998s/iter; left time: 5394.6831s
	iters: 200, epoch: 14 | loss: 2.5759952
	speed: 0.0878s/iter; left time: 1571.9238s
Epoch: 14 cost time: 19.458904027938843
Epoch: 14, Steps: 208 | Train Loss: 2.885 Vali Loss: 3.627 Vali Acc: 0.071 Test Loss: 3.627 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 3.0528755
	speed: 0.2749s/iter; left time: 4890.1360s
	iters: 200, epoch: 15 | loss: 2.9555013
	speed: 0.0875s/iter; left time: 1547.1195s
Epoch: 15 cost time: 19.733584880828857
Epoch: 15, Steps: 208 | Train Loss: 2.810 Vali Loss: 3.627 Vali Acc: 0.082 Test Loss: 3.627 Test Acc: 0.082
Validation loss decreased (-0.078998 --> -0.081682).  Saving model ...
	iters: 100, epoch: 16 | loss: 3.2579417
	speed: 0.2878s/iter; left time: 5060.2844s
	iters: 200, epoch: 16 | loss: 2.9130437
	speed: 0.0973s/iter; left time: 1700.5406s
Epoch: 16 cost time: 19.759294509887695
Epoch: 16, Steps: 208 | Train Loss: 2.705 Vali Loss: 3.651 Vali Acc: 0.088 Test Loss: 3.651 Test Acc: 0.088
Validation loss decreased (-0.081682 --> -0.087646).  Saving model ...
	iters: 100, epoch: 17 | loss: 2.4789619
	speed: 0.2890s/iter; left time: 5020.5499s
	iters: 200, epoch: 17 | loss: 2.9346662
	speed: 0.0835s/iter; left time: 1441.7646s
Epoch: 17 cost time: 18.67500400543213
Epoch: 17, Steps: 208 | Train Loss: 2.619 Vali Loss: 3.705 Vali Acc: 0.081 Test Loss: 3.705 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 2.4399152
	speed: 0.2811s/iter; left time: 4824.8124s
	iters: 200, epoch: 18 | loss: 3.0597270
	speed: 0.0936s/iter; left time: 1598.0558s
Epoch: 18 cost time: 20.20869779586792
Epoch: 18, Steps: 208 | Train Loss: 2.549 Vali Loss: 3.798 Vali Acc: 0.086 Test Loss: 3.798 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 2.6823864
	speed: 0.2944s/iter; left time: 4991.8724s
	iters: 200, epoch: 19 | loss: 3.0441864
	speed: 0.1003s/iter; left time: 1691.3080s
Epoch: 19 cost time: 20.741727113723755
Epoch: 19, Steps: 208 | Train Loss: 2.432 Vali Loss: 3.889 Vali Acc: 0.087 Test Loss: 3.889 Test Acc: 0.087
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 2.5502005
	speed: 0.3034s/iter; left time: 5081.2323s
	iters: 200, epoch: 20 | loss: 2.3578863
	speed: 0.0833s/iter; left time: 1387.4786s
Epoch: 20 cost time: 18.63470435142517
Epoch: 20, Steps: 208 | Train Loss: 2.362 Vali Loss: 3.924 Vali Acc: 0.079 Test Loss: 3.924 Test Acc: 0.079
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 2.0672321
	speed: 0.3011s/iter; left time: 4981.1542s
	iters: 200, epoch: 21 | loss: 2.5123301
	speed: 0.0977s/iter; left time: 1606.1269s
Epoch: 21 cost time: 21.082631587982178
Epoch: 21, Steps: 208 | Train Loss: 2.225 Vali Loss: 4.060 Vali Acc: 0.076 Test Loss: 4.060 Test Acc: 0.076
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 2.8270042
	speed: 0.2794s/iter; left time: 4562.8684s
	iters: 200, epoch: 22 | loss: 1.6679108
	speed: 0.0940s/iter; left time: 1525.7343s
Epoch: 22 cost time: 19.34125828742981
Epoch: 22, Steps: 208 | Train Loss: 2.127 Vali Loss: 4.147 Vali Acc: 0.073 Test Loss: 4.147 Test Acc: 0.073
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 1.8662710
	speed: 0.2984s/iter; left time: 4811.5374s
	iters: 200, epoch: 23 | loss: 2.3564291
	speed: 0.0847s/iter; left time: 1357.2164s
Epoch: 23 cost time: 18.26506519317627
Epoch: 23, Steps: 208 | Train Loss: 2.056 Vali Loss: 4.249 Vali Acc: 0.072 Test Loss: 4.249 Test Acc: 0.072
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 1.7059411
	speed: 0.2682s/iter; left time: 4269.1946s
	iters: 200, epoch: 24 | loss: 1.9941841
	speed: 0.0938s/iter; left time: 1483.6470s
Epoch: 24 cost time: 20.10735559463501
Epoch: 24, Steps: 208 | Train Loss: 1.929 Vali Loss: 4.317 Vali Acc: 0.077 Test Loss: 4.317 Test Acc: 0.077
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 1.7258282
	speed: 0.3001s/iter; left time: 4714.2924s
	iters: 200, epoch: 25 | loss: 2.2399976
	speed: 0.0917s/iter; left time: 1431.6779s
Epoch: 25 cost time: 19.75774383544922
Epoch: 25, Steps: 208 | Train Loss: 1.843 Vali Loss: 4.467 Vali Acc: 0.075 Test Loss: 4.467 Test Acc: 0.075
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 1.7514637
	speed: 0.2883s/iter; left time: 4468.9371s
	iters: 200, epoch: 26 | loss: 2.3443437
	speed: 0.0905s/iter; left time: 1394.1373s
Epoch: 26 cost time: 20.019634246826172
Epoch: 26, Steps: 208 | Train Loss: 1.745 Vali Loss: 4.505 Vali Acc: 0.077 Test Loss: 4.505 Test Acc: 0.077
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08768267223382047
model parameter : 808803
model size : 3.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7498565
	speed: 0.1283s/iter; left time: 2655.5591s
	iters: 200, epoch: 1 | loss: 3.5898581
	speed: 0.0908s/iter; left time: 1871.0123s
Epoch: 1 cost time: 22.670344829559326
Epoch: 1, Steps: 208 | Train Loss: 3.679 Vali Loss: 3.574 Vali Acc: 0.050 Test Loss: 3.574 Test Acc: 0.050
Validation loss decreased (inf --> -0.050069).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7566514
	speed: 0.2878s/iter; left time: 5898.7188s
	iters: 200, epoch: 2 | loss: 3.4675562
	speed: 0.0840s/iter; left time: 1712.3830s
Epoch: 2 cost time: 18.237868785858154
Epoch: 2, Steps: 208 | Train Loss: 3.548 Vali Loss: 3.494 Vali Acc: 0.061 Test Loss: 3.494 Test Acc: 0.061
Validation loss decreased (-0.050069 --> -0.061104).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4395607
	speed: 0.2853s/iter; left time: 5786.3021s
	iters: 200, epoch: 3 | loss: 3.0740345
	speed: 0.0857s/iter; left time: 1729.0162s
Epoch: 3 cost time: 18.090035438537598
Epoch: 3, Steps: 208 | Train Loss: 3.481 Vali Loss: 3.489 Vali Acc: 0.068 Test Loss: 3.489 Test Acc: 0.068
Validation loss decreased (-0.061104 --> -0.067964).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4511921
	speed: 0.2868s/iter; left time: 5758.4670s
	iters: 200, epoch: 4 | loss: 3.1716375
	speed: 0.0946s/iter; left time: 1889.3624s
Epoch: 4 cost time: 20.351109504699707
Epoch: 4, Steps: 208 | Train Loss: 3.462 Vali Loss: 3.443 Vali Acc: 0.076 Test Loss: 3.443 Test Acc: 0.076
Validation loss decreased (-0.067964 --> -0.076315).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.4467137
	speed: 0.2735s/iter; left time: 5434.8024s
	iters: 200, epoch: 5 | loss: 3.3982782
	speed: 0.0791s/iter; left time: 1562.7755s
Epoch: 5 cost time: 17.227747440338135
Epoch: 5, Steps: 208 | Train Loss: 3.412 Vali Loss: 3.427 Vali Acc: 0.069 Test Loss: 3.427 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.2311296
	speed: 0.2813s/iter; left time: 5531.0870s
	iters: 200, epoch: 6 | loss: 3.5964916
	speed: 0.0809s/iter; left time: 1582.7143s
Epoch: 6 cost time: 17.732309341430664
Epoch: 6, Steps: 208 | Train Loss: 3.375 Vali Loss: 3.413 Vali Acc: 0.073 Test Loss: 3.413 Test Acc: 0.073
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 3.1045825
	speed: 0.2717s/iter; left time: 5286.0742s
	iters: 200, epoch: 7 | loss: 3.3889868
	speed: 0.0947s/iter; left time: 1831.9453s
Epoch: 7 cost time: 20.378342628479004
Epoch: 7, Steps: 208 | Train Loss: 3.338 Vali Loss: 3.395 Vali Acc: 0.079 Test Loss: 3.395 Test Acc: 0.079
Validation loss decreased (-0.076315 --> -0.079000).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.2733886
	speed: 0.2970s/iter; left time: 5714.8689s
	iters: 200, epoch: 8 | loss: 3.4618456
	speed: 0.0837s/iter; left time: 1602.6734s
Epoch: 8 cost time: 19.254581451416016
Epoch: 8, Steps: 208 | Train Loss: 3.272 Vali Loss: 3.361 Vali Acc: 0.088 Test Loss: 3.361 Test Acc: 0.088
Validation loss decreased (-0.079000 --> -0.087947).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.3304873
	speed: 0.3208s/iter; left time: 6107.0501s
	iters: 200, epoch: 9 | loss: 3.4169533
	speed: 0.0949s/iter; left time: 1796.2433s
Epoch: 9 cost time: 20.2860324382782
Epoch: 9, Steps: 208 | Train Loss: 3.182 Vali Loss: 3.381 Vali Acc: 0.077 Test Loss: 3.381 Test Acc: 0.077
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 3.0495718
	speed: 0.2949s/iter; left time: 5553.3191s
	iters: 200, epoch: 10 | loss: 3.3505700
	speed: 0.0986s/iter; left time: 1845.9940s
Epoch: 10 cost time: 20.692505598068237
Epoch: 10, Steps: 208 | Train Loss: 3.103 Vali Loss: 3.404 Vali Acc: 0.077 Test Loss: 3.404 Test Acc: 0.077
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 3.5509171
	speed: 0.2960s/iter; left time: 5511.9949s
	iters: 200, epoch: 11 | loss: 2.7865119
	speed: 0.0867s/iter; left time: 1605.9080s
Epoch: 11 cost time: 18.67961883544922
Epoch: 11, Steps: 208 | Train Loss: 3.028 Vali Loss: 3.292 Vali Acc: 0.090 Test Loss: 3.292 Test Acc: 0.090
Validation loss decreased (-0.087947 --> -0.089737).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.4557676
	speed: 0.2920s/iter; left time: 5377.4523s
	iters: 200, epoch: 12 | loss: 3.1227026
	speed: 0.0833s/iter; left time: 1525.1795s
Epoch: 12 cost time: 18.652291774749756
Epoch: 12, Steps: 208 | Train Loss: 2.950 Vali Loss: 3.298 Vali Acc: 0.092 Test Loss: 3.298 Test Acc: 0.092
Validation loss decreased (-0.089737 --> -0.092422).  Saving model ...
	iters: 100, epoch: 13 | loss: 3.5776308
	speed: 0.2702s/iter; left time: 4919.5198s
	iters: 200, epoch: 13 | loss: 2.7697814
	speed: 0.0903s/iter; left time: 1634.5726s
Epoch: 13 cost time: 19.088993787765503
Epoch: 13, Steps: 208 | Train Loss: 2.881 Vali Loss: 3.308 Vali Acc: 0.102 Test Loss: 3.308 Test Acc: 0.102
Validation loss decreased (-0.092422 --> -0.102263).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.5313475
	speed: 0.2820s/iter; left time: 5074.4064s
	iters: 200, epoch: 14 | loss: 2.9043982
	speed: 0.0849s/iter; left time: 1519.0519s
Epoch: 14 cost time: 18.720784664154053
Epoch: 14, Steps: 208 | Train Loss: 2.782 Vali Loss: 3.346 Vali Acc: 0.101 Test Loss: 3.346 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.4334197
	speed: 0.2870s/iter; left time: 5106.0987s
	iters: 200, epoch: 15 | loss: 2.2508597
	speed: 0.0781s/iter; left time: 1381.6541s
Epoch: 15 cost time: 17.295964002609253
Epoch: 15, Steps: 208 | Train Loss: 2.716 Vali Loss: 3.341 Vali Acc: 0.095 Test Loss: 3.341 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 2.6037836
	speed: 0.2882s/iter; left time: 5066.3646s
	iters: 200, epoch: 16 | loss: 2.1500719
	speed: 0.0936s/iter; left time: 1636.4949s
Epoch: 16 cost time: 20.691410779953003
Epoch: 16, Steps: 208 | Train Loss: 2.589 Vali Loss: 3.397 Vali Acc: 0.109 Test Loss: 3.397 Test Acc: 0.109
Validation loss decreased (-0.102263 --> -0.109420).  Saving model ...
	iters: 100, epoch: 17 | loss: 2.4838214
	speed: 0.3136s/iter; left time: 5448.4443s
	iters: 200, epoch: 17 | loss: 2.9964123
	speed: 0.0981s/iter; left time: 1694.9102s
Epoch: 17 cost time: 20.953134298324585
Epoch: 17, Steps: 208 | Train Loss: 2.540 Vali Loss: 3.460 Vali Acc: 0.095 Test Loss: 3.460 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 2.7404170
	speed: 0.3052s/iter; left time: 5239.2997s
	iters: 200, epoch: 18 | loss: 3.1277308
	speed: 0.0865s/iter; left time: 1476.5805s
Epoch: 18 cost time: 18.320284605026245
Epoch: 18, Steps: 208 | Train Loss: 2.455 Vali Loss: 3.531 Vali Acc: 0.108 Test Loss: 3.531 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 3.0266552
	speed: 0.3057s/iter; left time: 5182.9746s
	iters: 200, epoch: 19 | loss: 2.1984777
	speed: 0.0986s/iter; left time: 1661.2598s
Epoch: 19 cost time: 20.891001224517822
Epoch: 19, Steps: 208 | Train Loss: 2.354 Vali Loss: 3.593 Vali Acc: 0.102 Test Loss: 3.593 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 2.0766718
	speed: 0.2941s/iter; left time: 4925.1054s
	iters: 200, epoch: 20 | loss: 2.7580082
	speed: 0.0910s/iter; left time: 1515.1317s
Epoch: 20 cost time: 19.636898279190063
Epoch: 20, Steps: 208 | Train Loss: 2.274 Vali Loss: 3.654 Vali Acc: 0.102 Test Loss: 3.654 Test Acc: 0.102
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 2.7298453
	speed: 0.3052s/iter; left time: 5047.5842s
	iters: 200, epoch: 21 | loss: 2.1605775
	speed: 0.1022s/iter; left time: 1679.6531s
Epoch: 21 cost time: 20.57447910308838
Epoch: 21, Steps: 208 | Train Loss: 2.195 Vali Loss: 3.757 Vali Acc: 0.103 Test Loss: 3.757 Test Acc: 0.103
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 2.1951690
	speed: 0.3053s/iter; left time: 4986.9595s
	iters: 200, epoch: 22 | loss: 1.8792193
	speed: 0.1015s/iter; left time: 1647.4804s
Epoch: 22 cost time: 21.236990451812744
Epoch: 22, Steps: 208 | Train Loss: 2.085 Vali Loss: 3.832 Vali Acc: 0.097 Test Loss: 3.832 Test Acc: 0.097
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 1.9070119
	speed: 0.3157s/iter; left time: 5090.8064s
	iters: 200, epoch: 23 | loss: 2.2187700
	speed: 0.1098s/iter; left time: 1760.1263s
Epoch: 23 cost time: 21.807320833206177
Epoch: 23, Steps: 208 | Train Loss: 2.007 Vali Loss: 3.865 Vali Acc: 0.106 Test Loss: 3.865 Test Acc: 0.106
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 1.5266920
	speed: 0.2848s/iter; left time: 4532.5583s
	iters: 200, epoch: 24 | loss: 2.2175288
	speed: 0.1022s/iter; left time: 1615.8055s
Epoch: 24 cost time: 20.07716989517212
Epoch: 24, Steps: 208 | Train Loss: 1.891 Vali Loss: 3.979 Vali Acc: 0.102 Test Loss: 3.979 Test Acc: 0.102
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 2.3240540
	speed: 0.3162s/iter; left time: 4967.4506s
	iters: 200, epoch: 25 | loss: 2.4529929
	speed: 0.0928s/iter; left time: 1447.9188s
Epoch: 25 cost time: 20.174992561340332
Epoch: 25, Steps: 208 | Train Loss: 1.806 Vali Loss: 4.043 Vali Acc: 0.103 Test Loss: 4.043 Test Acc: 0.103
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 1.7406243
	speed: 0.3265s/iter; left time: 5060.9927s
	iters: 200, epoch: 26 | loss: 1.4760573
	speed: 0.0958s/iter; left time: 1475.7674s
Epoch: 26 cost time: 20.998497009277344
Epoch: 26, Steps: 208 | Train Loss: 1.753 Vali Loss: 4.162 Vali Acc: 0.098 Test Loss: 4.162 Test Acc: 0.098
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10945422010140173
model parameter : 807619
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7863860
	speed: 0.1114s/iter; left time: 2305.5320s
	iters: 200, epoch: 1 | loss: 3.5070431
	speed: 0.0868s/iter; left time: 1788.7523s
Epoch: 1 cost time: 20.6230206489563
Epoch: 1, Steps: 208 | Train Loss: 3.674 Vali Loss: 3.560 Vali Acc: 0.049 Test Loss: 3.560 Test Acc: 0.049
Validation loss decreased (inf --> -0.049174).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3971696
	speed: 0.2736s/iter; left time: 5607.2492s
	iters: 200, epoch: 2 | loss: 3.2964365
	speed: 0.0824s/iter; left time: 1680.3287s
Epoch: 2 cost time: 17.968114376068115
Epoch: 2, Steps: 208 | Train Loss: 3.562 Vali Loss: 3.544 Vali Acc: 0.059 Test Loss: 3.544 Test Acc: 0.059
Validation loss decreased (-0.049174 --> -0.059016).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6620827
	speed: 0.2565s/iter; left time: 5202.7551s
	iters: 200, epoch: 3 | loss: 3.3592422
	speed: 0.0797s/iter; left time: 1609.6894s
Epoch: 3 cost time: 17.04173970222473
Epoch: 3, Steps: 208 | Train Loss: 3.504 Vali Loss: 3.462 Vali Acc: 0.064 Test Loss: 3.462 Test Acc: 0.064
Validation loss decreased (-0.059016 --> -0.064385).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3836486
	speed: 0.2697s/iter; left time: 5414.1169s
	iters: 200, epoch: 4 | loss: 3.6495733
	speed: 0.0786s/iter; left time: 1569.4402s
Epoch: 4 cost time: 17.744213104248047
Epoch: 4, Steps: 208 | Train Loss: 3.453 Vali Loss: 3.485 Vali Acc: 0.071 Test Loss: 3.485 Test Acc: 0.071
Validation loss decreased (-0.064385 --> -0.070648).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.8164647
	speed: 0.2582s/iter; left time: 5130.9589s
	iters: 200, epoch: 5 | loss: 3.3758395
	speed: 0.0811s/iter; left time: 1603.0503s
Epoch: 5 cost time: 17.32506275177002
Epoch: 5, Steps: 208 | Train Loss: 3.388 Vali Loss: 3.469 Vali Acc: 0.071 Test Loss: 3.469 Test Acc: 0.071
Validation loss decreased (-0.070648 --> -0.070648).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.4380705
	speed: 0.2589s/iter; left time: 5089.9455s
	iters: 200, epoch: 6 | loss: 3.6455541
	speed: 0.0907s/iter; left time: 1774.9767s
Epoch: 6 cost time: 18.29621458053589
Epoch: 6, Steps: 208 | Train Loss: 3.365 Vali Loss: 3.463 Vali Acc: 0.068 Test Loss: 3.463 Test Acc: 0.068
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.8798535
	speed: 0.2673s/iter; left time: 5198.8732s
	iters: 200, epoch: 7 | loss: 3.4870331
	speed: 0.0915s/iter; left time: 1771.6197s
Epoch: 7 cost time: 19.094136714935303
Epoch: 7, Steps: 208 | Train Loss: 3.347 Vali Loss: 3.452 Vali Acc: 0.075 Test Loss: 3.452 Test Acc: 0.075
Validation loss decreased (-0.070648 --> -0.074526).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.2807937
	speed: 0.2885s/iter; left time: 5552.2280s
	iters: 200, epoch: 8 | loss: 3.4759803
	speed: 0.0843s/iter; left time: 1613.1083s
Epoch: 8 cost time: 18.844317197799683
Epoch: 8, Steps: 208 | Train Loss: 3.305 Vali Loss: 3.466 Vali Acc: 0.064 Test Loss: 3.466 Test Acc: 0.064
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 3.7148333
	speed: 0.2792s/iter; left time: 5314.2250s
	iters: 200, epoch: 9 | loss: 3.6021881
	speed: 0.0880s/iter; left time: 1665.8742s
Epoch: 9 cost time: 19.019486904144287
Epoch: 9, Steps: 208 | Train Loss: 3.252 Vali Loss: 3.423 Vali Acc: 0.068 Test Loss: 3.423 Test Acc: 0.068
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 3.0237434
	speed: 0.2943s/iter; left time: 5541.6923s
	iters: 200, epoch: 10 | loss: 2.9942915
	speed: 0.0889s/iter; left time: 1665.6247s
Epoch: 10 cost time: 19.06883716583252
Epoch: 10, Steps: 208 | Train Loss: 3.198 Vali Loss: 3.439 Vali Acc: 0.084 Test Loss: 3.439 Test Acc: 0.084
Validation loss decreased (-0.074526 --> -0.084069).  Saving model ...
	iters: 100, epoch: 11 | loss: 3.0962369
	speed: 0.2959s/iter; left time: 5509.3355s
	iters: 200, epoch: 11 | loss: 3.0066590
	speed: 0.0775s/iter; left time: 1435.0942s
Epoch: 11 cost time: 18.7033269405365
Epoch: 11, Steps: 208 | Train Loss: 3.126 Vali Loss: 3.470 Vali Acc: 0.079 Test Loss: 3.470 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 3.2174506
	speed: 0.2594s/iter; left time: 4777.1459s
	iters: 200, epoch: 12 | loss: 2.6881523
	speed: 0.0881s/iter; left time: 1612.9365s
Epoch: 12 cost time: 18.165136337280273
Epoch: 12, Steps: 208 | Train Loss: 3.042 Vali Loss: 3.485 Vali Acc: 0.079 Test Loss: 3.485 Test Acc: 0.079
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 2.3851731
	speed: 0.2670s/iter; left time: 4860.4979s
	iters: 200, epoch: 13 | loss: 2.8914301
	speed: 0.0888s/iter; left time: 1608.1593s
Epoch: 13 cost time: 18.420244455337524
Epoch: 13, Steps: 208 | Train Loss: 2.963 Vali Loss: 3.570 Vali Acc: 0.084 Test Loss: 3.570 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 2.9818685
	speed: 0.2658s/iter; left time: 4784.0901s
	iters: 200, epoch: 14 | loss: 2.5608788
	speed: 0.0822s/iter; left time: 1472.0109s
Epoch: 14 cost time: 17.442068815231323
Epoch: 14, Steps: 208 | Train Loss: 2.901 Vali Loss: 3.533 Vali Acc: 0.089 Test Loss: 3.533 Test Acc: 0.089
Validation loss decreased (-0.084069 --> -0.088840).  Saving model ...
	iters: 100, epoch: 15 | loss: 2.7310739
	speed: 0.2668s/iter; left time: 4746.5000s
	iters: 200, epoch: 15 | loss: 2.9500182
	speed: 0.0811s/iter; left time: 1434.6637s
Epoch: 15 cost time: 18.190727710723877
Epoch: 15, Steps: 208 | Train Loss: 2.813 Vali Loss: 3.585 Vali Acc: 0.088 Test Loss: 3.585 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 2.9258373
	speed: 0.2846s/iter; left time: 5004.0470s
	iters: 200, epoch: 16 | loss: 2.1639419
	speed: 0.0912s/iter; left time: 1594.6535s
Epoch: 16 cost time: 20.29043984413147
Epoch: 16, Steps: 208 | Train Loss: 2.707 Vali Loss: 3.651 Vali Acc: 0.087 Test Loss: 3.651 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 2.0517137
	speed: 0.2837s/iter; left time: 4929.2768s
	iters: 200, epoch: 17 | loss: 2.6881764
	speed: 0.0827s/iter; left time: 1428.6674s
Epoch: 17 cost time: 18.09930658340454
Epoch: 17, Steps: 208 | Train Loss: 2.593 Vali Loss: 3.700 Vali Acc: 0.092 Test Loss: 3.700 Test Acc: 0.092
Validation loss decreased (-0.088840 --> -0.091523).  Saving model ...
	iters: 100, epoch: 18 | loss: 2.3126357
	speed: 0.2783s/iter; left time: 4776.4644s
	iters: 200, epoch: 18 | loss: 2.5172362
	speed: 0.0848s/iter; left time: 1447.0137s
Epoch: 18 cost time: 18.254189252853394
Epoch: 18, Steps: 208 | Train Loss: 2.484 Vali Loss: 3.781 Vali Acc: 0.085 Test Loss: 3.781 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 2.2417343
	speed: 0.2904s/iter; left time: 4923.6565s
	iters: 200, epoch: 19 | loss: 2.7552097
	speed: 0.0876s/iter; left time: 1476.2805s
Epoch: 19 cost time: 20.197530508041382
Epoch: 19, Steps: 208 | Train Loss: 2.367 Vali Loss: 3.885 Vali Acc: 0.087 Test Loss: 3.885 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.6688437
	speed: 0.2566s/iter; left time: 4297.2484s
	iters: 200, epoch: 20 | loss: 2.6569285
	speed: 0.0800s/iter; left time: 1331.9606s
Epoch: 20 cost time: 17.141377925872803
Epoch: 20, Steps: 208 | Train Loss: 2.251 Vali Loss: 3.854 Vali Acc: 0.084 Test Loss: 3.854 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 2.0455441
	speed: 0.2710s/iter; left time: 4482.3649s
	iters: 200, epoch: 21 | loss: 2.1681552
	speed: 0.0759s/iter; left time: 1247.1145s
Epoch: 21 cost time: 17.02432084083557
Epoch: 21, Steps: 208 | Train Loss: 2.137 Vali Loss: 3.987 Vali Acc: 0.079 Test Loss: 3.987 Test Acc: 0.079
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 2.4235134
	speed: 0.2621s/iter; left time: 4280.2945s
	iters: 200, epoch: 22 | loss: 2.3510642
	speed: 0.0887s/iter; left time: 1439.4443s
Epoch: 22 cost time: 18.285499334335327
Epoch: 22, Steps: 208 | Train Loss: 2.043 Vali Loss: 4.075 Vali Acc: 0.102 Test Loss: 4.075 Test Acc: 0.102
Validation loss decreased (-0.091523 --> -0.101659).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.6359417
	speed: 0.2539s/iter; left time: 4093.8791s
	iters: 200, epoch: 23 | loss: 1.8766680
	speed: 0.0792s/iter; left time: 1269.6114s
Epoch: 23 cost time: 16.37291717529297
Epoch: 23, Steps: 208 | Train Loss: 1.966 Vali Loss: 4.128 Vali Acc: 0.086 Test Loss: 4.128 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 2.1707203
	speed: 0.2695s/iter; left time: 4288.9540s
	iters: 200, epoch: 24 | loss: 1.6113071
	speed: 0.0859s/iter; left time: 1359.1703s
Epoch: 24 cost time: 18.199463844299316
Epoch: 24, Steps: 208 | Train Loss: 1.856 Vali Loss: 4.357 Vali Acc: 0.089 Test Loss: 4.357 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 2.1178999
	speed: 0.2790s/iter; left time: 4383.2725s
	iters: 200, epoch: 25 | loss: 2.1567485
	speed: 0.0875s/iter; left time: 1366.5087s
Epoch: 25 cost time: 19.308512210845947
Epoch: 25, Steps: 208 | Train Loss: 1.719 Vali Loss: 4.408 Vali Acc: 0.092 Test Loss: 4.408 Test Acc: 0.092
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 1.7586361
	speed: 0.2668s/iter; left time: 4135.4774s
	iters: 200, epoch: 26 | loss: 1.5791703
	speed: 0.0805s/iter; left time: 1240.1008s
Epoch: 26 cost time: 17.579962015151978
Epoch: 26, Steps: 208 | Train Loss: 1.660 Vali Loss: 4.578 Vali Acc: 0.094 Test Loss: 4.578 Test Acc: 0.094
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 1.8100879
	speed: 0.2756s/iter; left time: 4214.2206s
	iters: 200, epoch: 27 | loss: 1.6642650
	speed: 0.0845s/iter; left time: 1284.0791s
Epoch: 27 cost time: 17.923161029815674
Epoch: 27, Steps: 208 | Train Loss: 1.528 Vali Loss: 4.575 Vali Acc: 0.090 Test Loss: 4.575 Test Acc: 0.090
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 1.6420041
	speed: 0.2815s/iter; left time: 4246.6625s
	iters: 200, epoch: 28 | loss: 1.6180183
	speed: 0.0844s/iter; left time: 1263.9858s
Epoch: 28 cost time: 18.535669803619385
Epoch: 28, Steps: 208 | Train Loss: 1.453 Vali Loss: 4.747 Vali Acc: 0.090 Test Loss: 4.747 Test Acc: 0.090
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 1.5014651
	speed: 0.2632s/iter; left time: 3915.7456s
	iters: 200, epoch: 29 | loss: 1.2870508
	speed: 0.0849s/iter; left time: 1254.0739s
Epoch: 29 cost time: 18.501474142074585
Epoch: 29, Steps: 208 | Train Loss: 1.370 Vali Loss: 4.902 Vali Acc: 0.085 Test Loss: 4.902 Test Acc: 0.085
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 1.6321192
	speed: 0.2839s/iter; left time: 4164.0716s
	iters: 200, epoch: 30 | loss: 0.8303249
	speed: 0.0869s/iter; left time: 1266.0875s
Epoch: 30 cost time: 18.60984516143799
Epoch: 30, Steps: 208 | Train Loss: 1.281 Vali Loss: 5.041 Vali Acc: 0.085 Test Loss: 5.041 Test Acc: 0.085
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 1.1494347
	speed: 0.2904s/iter; left time: 4199.9235s
	iters: 200, epoch: 31 | loss: 1.1985714
	speed: 0.0890s/iter; left time: 1278.6968s
Epoch: 31 cost time: 19.937049865722656
Epoch: 31, Steps: 208 | Train Loss: 1.216 Vali Loss: 5.172 Vali Acc: 0.089 Test Loss: 5.172 Test Acc: 0.089
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.6097112
	speed: 0.2517s/iter; left time: 3587.9809s
	iters: 200, epoch: 32 | loss: 1.4796264
	speed: 0.0802s/iter; left time: 1134.8683s
Epoch: 32 cost time: 16.588403701782227
Epoch: 32, Steps: 208 | Train Loss: 1.140 Vali Loss: 5.126 Vali Acc: 0.097 Test Loss: 5.126 Test Acc: 0.097
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10169997017596183
model parameter : 806435
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.4185190
	speed: 0.1039s/iter; left time: 2151.3153s
	iters: 200, epoch: 1 | loss: 3.6368079
	speed: 0.0913s/iter; left time: 1881.3701s
Epoch: 1 cost time: 20.585800886154175
Epoch: 1, Steps: 208 | Train Loss: 3.656 Vali Loss: 3.528 Vali Acc: 0.056 Test Loss: 3.528 Test Acc: 0.056
Validation loss decreased (inf --> -0.055736).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3677278
	speed: 0.2926s/iter; left time: 5996.3641s
	iters: 200, epoch: 2 | loss: 3.5758567
	speed: 0.0866s/iter; left time: 1765.6387s
Epoch: 2 cost time: 18.217021226882935
Epoch: 2, Steps: 208 | Train Loss: 3.556 Vali Loss: 3.503 Vali Acc: 0.052 Test Loss: 3.503 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.8828504
	speed: 0.2806s/iter; left time: 5692.3760s
	iters: 200, epoch: 3 | loss: 3.5068762
	speed: 0.0964s/iter; left time: 1945.6615s
Epoch: 3 cost time: 20.461307287216187
Epoch: 3, Steps: 208 | Train Loss: 3.491 Vali Loss: 3.476 Vali Acc: 0.078 Test Loss: 3.476 Test Acc: 0.078
Validation loss decreased (-0.055736 --> -0.078104).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.1967504
	speed: 0.2757s/iter; left time: 5534.8972s
	iters: 200, epoch: 4 | loss: 3.6089106
	speed: 0.0854s/iter; left time: 1705.3067s
Epoch: 4 cost time: 17.519237756729126
Epoch: 4, Steps: 208 | Train Loss: 3.413 Vali Loss: 3.446 Vali Acc: 0.069 Test Loss: 3.446 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.5349472
	speed: 0.2774s/iter; left time: 5510.7632s
	iters: 200, epoch: 5 | loss: 3.4639766
	speed: 0.0807s/iter; left time: 1595.4356s
Epoch: 5 cost time: 17.931232929229736
Epoch: 5, Steps: 208 | Train Loss: 3.372 Vali Loss: 3.458 Vali Acc: 0.069 Test Loss: 3.458 Test Acc: 0.069
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 3.4238636
	speed: 0.2710s/iter; left time: 5328.7145s
	iters: 200, epoch: 6 | loss: 3.3831484
	speed: 0.0882s/iter; left time: 1725.7519s
Epoch: 6 cost time: 19.202977180480957
Epoch: 6, Steps: 208 | Train Loss: 3.321 Vali Loss: 3.461 Vali Acc: 0.076 Test Loss: 3.461 Test Acc: 0.076
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 3.2462714
	speed: 0.2784s/iter; left time: 5415.8922s
	iters: 200, epoch: 7 | loss: 3.0329065
	speed: 0.0933s/iter; left time: 1804.8240s
Epoch: 7 cost time: 18.967138051986694
Epoch: 7, Steps: 208 | Train Loss: 3.265 Vali Loss: 3.437 Vali Acc: 0.075 Test Loss: 3.437 Test Acc: 0.075
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 3.6620796
	speed: 0.2758s/iter; left time: 5307.6641s
	iters: 200, epoch: 8 | loss: 2.9956827
	speed: 0.0774s/iter; left time: 1482.5795s
Epoch: 8 cost time: 16.74909019470215
Epoch: 8, Steps: 208 | Train Loss: 3.213 Vali Loss: 3.414 Vali Acc: 0.080 Test Loss: 3.414 Test Acc: 0.080
Validation loss decreased (-0.078104 --> -0.079596).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.2440367
	speed: 0.2619s/iter; left time: 4985.9896s
	iters: 200, epoch: 9 | loss: 3.2736955
	speed: 0.0884s/iter; left time: 1673.6877s
Epoch: 9 cost time: 18.90057635307312
Epoch: 9, Steps: 208 | Train Loss: 3.115 Vali Loss: 3.460 Vali Acc: 0.084 Test Loss: 3.460 Test Acc: 0.084
Validation loss decreased (-0.079596 --> -0.083771).  Saving model ...
	iters: 100, epoch: 10 | loss: 3.1300654
	speed: 0.2823s/iter; left time: 5316.1214s
	iters: 200, epoch: 10 | loss: 3.0553122
	speed: 0.0912s/iter; left time: 1707.1840s
Epoch: 10 cost time: 19.429012298583984
Epoch: 10, Steps: 208 | Train Loss: 3.067 Vali Loss: 3.434 Vali Acc: 0.082 Test Loss: 3.434 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.7196686
	speed: 0.2870s/iter; left time: 5343.3979s
	iters: 200, epoch: 11 | loss: 3.2327881
	speed: 0.0862s/iter; left time: 1596.3721s
Epoch: 11 cost time: 18.2119083404541
Epoch: 11, Steps: 208 | Train Loss: 2.953 Vali Loss: 3.474 Vali Acc: 0.088 Test Loss: 3.474 Test Acc: 0.088
Validation loss decreased (-0.083771 --> -0.087946).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.7585571
	speed: 0.2754s/iter; left time: 5071.8479s
	iters: 200, epoch: 12 | loss: 2.7173312
	speed: 0.0873s/iter; left time: 1598.4390s
Epoch: 12 cost time: 19.054253339767456
Epoch: 12, Steps: 208 | Train Loss: 2.824 Vali Loss: 3.452 Vali Acc: 0.096 Test Loss: 3.452 Test Acc: 0.096
Validation loss decreased (-0.087946 --> -0.095701).  Saving model ...
	iters: 100, epoch: 13 | loss: 3.0031130
	speed: 0.2863s/iter; left time: 5211.8240s
	iters: 200, epoch: 13 | loss: 2.5212965
	speed: 0.0827s/iter; left time: 1496.8897s
Epoch: 13 cost time: 18.197964429855347
Epoch: 13, Steps: 208 | Train Loss: 2.708 Vali Loss: 3.544 Vali Acc: 0.086 Test Loss: 3.544 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 2.8543937
	speed: 0.2866s/iter; left time: 5158.2536s
	iters: 200, epoch: 14 | loss: 2.5577865
	speed: 0.0828s/iter; left time: 1482.3044s
Epoch: 14 cost time: 18.44950008392334
Epoch: 14, Steps: 208 | Train Loss: 2.590 Vali Loss: 3.535 Vali Acc: 0.103 Test Loss: 3.535 Test Acc: 0.103
Validation loss decreased (-0.095701 --> -0.103454).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.6508541
	speed: 0.2641s/iter; left time: 4698.8612s
	iters: 200, epoch: 15 | loss: 1.8627006
	speed: 0.0880s/iter; left time: 1557.2686s
Epoch: 15 cost time: 18.31614375114441
Epoch: 15, Steps: 208 | Train Loss: 2.437 Vali Loss: 3.595 Vali Acc: 0.106 Test Loss: 3.595 Test Acc: 0.106
Validation loss decreased (-0.103454 --> -0.105541).  Saving model ...
	iters: 100, epoch: 16 | loss: 2.2486916
	speed: 0.2803s/iter; left time: 4928.7702s
	iters: 200, epoch: 16 | loss: 2.4969835
	speed: 0.0857s/iter; left time: 1498.1432s
Epoch: 16 cost time: 17.705723762512207
Epoch: 16, Steps: 208 | Train Loss: 2.314 Vali Loss: 3.709 Vali Acc: 0.097 Test Loss: 3.709 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 2.5569868
	speed: 0.2715s/iter; left time: 4716.0916s
	iters: 200, epoch: 17 | loss: 1.9000950
	speed: 0.0908s/iter; left time: 1568.8383s
Epoch: 17 cost time: 18.73393702507019
Epoch: 17, Steps: 208 | Train Loss: 2.163 Vali Loss: 3.685 Vali Acc: 0.107 Test Loss: 3.685 Test Acc: 0.107
Validation loss decreased (-0.105541 --> -0.107330).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.6540928
	speed: 0.2736s/iter; left time: 4696.4080s
	iters: 200, epoch: 18 | loss: 1.9961269
	speed: 0.0882s/iter; left time: 1505.6829s
Epoch: 18 cost time: 18.847917318344116
Epoch: 18, Steps: 208 | Train Loss: 2.027 Vali Loss: 3.813 Vali Acc: 0.099 Test Loss: 3.813 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 2.6405754
	speed: 0.3066s/iter; left time: 5199.0693s
	iters: 200, epoch: 19 | loss: 2.4185295
	speed: 0.0851s/iter; left time: 1435.3534s
Epoch: 19 cost time: 19.1403169631958
Epoch: 19, Steps: 208 | Train Loss: 1.896 Vali Loss: 3.853 Vali Acc: 0.101 Test Loss: 3.853 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.7144589
	speed: 0.2901s/iter; left time: 4858.3738s
	iters: 200, epoch: 20 | loss: 1.4156555
	speed: 0.0871s/iter; left time: 1450.0663s
Epoch: 20 cost time: 19.218923091888428
Epoch: 20, Steps: 208 | Train Loss: 1.765 Vali Loss: 3.918 Vali Acc: 0.105 Test Loss: 3.918 Test Acc: 0.105
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 2.0985026
	speed: 0.2671s/iter; left time: 4417.7367s
	iters: 200, epoch: 21 | loss: 1.7621760
	speed: 0.0835s/iter; left time: 1372.7011s
Epoch: 21 cost time: 18.41588282585144
Epoch: 21, Steps: 208 | Train Loss: 1.597 Vali Loss: 4.132 Vali Acc: 0.105 Test Loss: 4.132 Test Acc: 0.105
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 1.1787862
	speed: 0.2791s/iter; left time: 4557.8017s
	iters: 200, epoch: 22 | loss: 2.1842513
	speed: 0.0843s/iter; left time: 1368.9176s
Epoch: 22 cost time: 18.755799055099487
Epoch: 22, Steps: 208 | Train Loss: 1.492 Vali Loss: 4.167 Vali Acc: 0.096 Test Loss: 4.167 Test Acc: 0.096
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.9964372
	speed: 0.2727s/iter; left time: 4398.0417s
	iters: 200, epoch: 23 | loss: 1.8195009
	speed: 0.0791s/iter; left time: 1267.7042s
Epoch: 23 cost time: 17.660234212875366
Epoch: 23, Steps: 208 | Train Loss: 1.404 Vali Loss: 4.377 Vali Acc: 0.106 Test Loss: 4.377 Test Acc: 0.106
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 1.7070782
	speed: 0.2701s/iter; left time: 4299.5935s
	iters: 200, epoch: 24 | loss: 1.2239355
	speed: 0.0808s/iter; left time: 1277.7562s
Epoch: 24 cost time: 17.709079265594482
Epoch: 24, Steps: 208 | Train Loss: 1.299 Vali Loss: 4.547 Vali Acc: 0.098 Test Loss: 4.547 Test Acc: 0.098
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 1.2635710
	speed: 0.2817s/iter; left time: 4425.1170s
	iters: 200, epoch: 25 | loss: 1.7421004
	speed: 0.0840s/iter; left time: 1310.3863s
Epoch: 25 cost time: 18.613967895507812
Epoch: 25, Steps: 208 | Train Loss: 1.220 Vali Loss: 4.603 Vali Acc: 0.107 Test Loss: 4.603 Test Acc: 0.107
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.3604634
	speed: 0.2897s/iter; left time: 4490.4162s
	iters: 200, epoch: 26 | loss: 0.9193556
	speed: 0.0833s/iter; left time: 1282.7855s
Epoch: 26 cost time: 18.868903398513794
Epoch: 26, Steps: 208 | Train Loss: 1.117 Vali Loss: 4.703 Vali Acc: 0.102 Test Loss: 4.703 Test Acc: 0.102
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.8358076
	speed: 0.2804s/iter; left time: 4288.7468s
	iters: 200, epoch: 27 | loss: 1.0606240
	speed: 0.0831s/iter; left time: 1263.2617s
Epoch: 27 cost time: 18.34018301963806
Epoch: 27, Steps: 208 | Train Loss: 1.051 Vali Loss: 4.846 Vali Acc: 0.096 Test Loss: 4.846 Test Acc: 0.096
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10736653742916791
model parameter : 510467
model size : 2.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5271904
	speed: 0.1230s/iter; left time: 2546.7217s
	iters: 200, epoch: 1 | loss: 3.6834574
	speed: 0.0837s/iter; left time: 1724.4927s
Epoch: 1 cost time: 21.534294605255127
Epoch: 1, Steps: 208 | Train Loss: 3.676 Vali Loss: 3.571 Vali Acc: 0.051 Test Loss: 3.571 Test Acc: 0.051
Validation loss decreased (inf --> -0.051262).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3251081
	speed: 0.2703s/iter; left time: 5538.3158s
	iters: 200, epoch: 2 | loss: 3.5261173
	speed: 0.0833s/iter; left time: 1699.1226s
Epoch: 2 cost time: 17.870090007781982
Epoch: 2, Steps: 208 | Train Loss: 3.566 Vali Loss: 3.518 Vali Acc: 0.060 Test Loss: 3.518 Test Acc: 0.060
Validation loss decreased (-0.051262 --> -0.059613).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.2503350
	speed: 0.2964s/iter; left time: 6013.0651s
	iters: 200, epoch: 3 | loss: 3.3238409
	speed: 0.0837s/iter; left time: 1689.7609s
Epoch: 3 cost time: 18.704511642456055
Epoch: 3, Steps: 208 | Train Loss: 3.495 Vali Loss: 3.491 Vali Acc: 0.062 Test Loss: 3.491 Test Acc: 0.062
Validation loss decreased (-0.059613 --> -0.061999).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2075262
	speed: 0.2835s/iter; left time: 5691.5697s
	iters: 200, epoch: 4 | loss: 3.3922169
	speed: 0.0803s/iter; left time: 1604.3828s
Epoch: 4 cost time: 18.292845726013184
Epoch: 4, Steps: 208 | Train Loss: 3.450 Vali Loss: 3.462 Vali Acc: 0.067 Test Loss: 3.462 Test Acc: 0.067
Validation loss decreased (-0.061999 --> -0.066473).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3826294
	speed: 0.2651s/iter; left time: 5267.2715s
	iters: 200, epoch: 5 | loss: 3.5007422
	speed: 0.0784s/iter; left time: 1550.7240s
Epoch: 5 cost time: 17.543959617614746
Epoch: 5, Steps: 208 | Train Loss: 3.406 Vali Loss: 3.463 Vali Acc: 0.065 Test Loss: 3.463 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.3511662
	speed: 0.2799s/iter; left time: 5503.3471s
	iters: 200, epoch: 6 | loss: 3.2087605
	speed: 0.0820s/iter; left time: 1604.8037s
Epoch: 6 cost time: 18.481783151626587
Epoch: 6, Steps: 208 | Train Loss: 3.334 Vali Loss: 3.461 Vali Acc: 0.064 Test Loss: 3.461 Test Acc: 0.064
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 3.0866735
	speed: 0.2756s/iter; left time: 5360.4270s
	iters: 200, epoch: 7 | loss: 3.6317008
	speed: 0.0845s/iter; left time: 1635.3358s
Epoch: 7 cost time: 18.75399899482727
Epoch: 7, Steps: 208 | Train Loss: 3.296 Vali Loss: 3.406 Vali Acc: 0.080 Test Loss: 3.406 Test Acc: 0.080
Validation loss decreased (-0.066473 --> -0.079894).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.5810523
	speed: 0.2934s/iter; left time: 5647.3327s
	iters: 200, epoch: 8 | loss: 3.6125145
	speed: 0.0892s/iter; left time: 1706.8317s
Epoch: 8 cost time: 18.90094566345215
Epoch: 8, Steps: 208 | Train Loss: 3.211 Vali Loss: 3.309 Vali Acc: 0.078 Test Loss: 3.309 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.7625897
	speed: 0.2766s/iter; left time: 5265.0684s
	iters: 200, epoch: 9 | loss: 3.4668286
	speed: 0.0898s/iter; left time: 1699.6256s
Epoch: 9 cost time: 18.870342016220093
Epoch: 9, Steps: 208 | Train Loss: 3.104 Vali Loss: 3.268 Vali Acc: 0.095 Test Loss: 3.268 Test Acc: 0.095
Validation loss decreased (-0.079894 --> -0.094510).  Saving model ...
	iters: 100, epoch: 10 | loss: 3.1698930
	speed: 0.2828s/iter; left time: 5324.8851s
	iters: 200, epoch: 10 | loss: 2.7360919
	speed: 0.0844s/iter; left time: 1580.0534s
Epoch: 10 cost time: 18.46623468399048
Epoch: 10, Steps: 208 | Train Loss: 2.975 Vali Loss: 3.258 Vali Acc: 0.101 Test Loss: 3.258 Test Acc: 0.101
Validation loss decreased (-0.094510 --> -0.101369).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.7123928
	speed: 0.2766s/iter; left time: 5150.5089s
	iters: 200, epoch: 11 | loss: 2.9168315
	speed: 0.0843s/iter; left time: 1560.8019s
Epoch: 11 cost time: 18.536823511123657
Epoch: 11, Steps: 208 | Train Loss: 2.895 Vali Loss: 3.233 Vali Acc: 0.101 Test Loss: 3.233 Test Acc: 0.101
Validation loss decreased (-0.101369 --> -0.101369).  Saving model ...
	iters: 100, epoch: 12 | loss: 3.0732982
	speed: 0.2669s/iter; left time: 4914.3435s
	iters: 200, epoch: 12 | loss: 3.0737357
	speed: 0.0906s/iter; left time: 1658.6703s
Epoch: 12 cost time: 18.371392011642456
Epoch: 12, Steps: 208 | Train Loss: 2.775 Vali Loss: 3.299 Vali Acc: 0.107 Test Loss: 3.299 Test Acc: 0.107
Validation loss decreased (-0.101369 --> -0.106737).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.8288853
	speed: 0.2687s/iter; left time: 4892.5392s
	iters: 200, epoch: 13 | loss: 2.8301868
	speed: 0.0801s/iter; left time: 1451.1001s
Epoch: 13 cost time: 17.09044647216797
Epoch: 13, Steps: 208 | Train Loss: 2.675 Vali Loss: 3.315 Vali Acc: 0.115 Test Loss: 3.315 Test Acc: 0.115
Validation loss decreased (-0.106737 --> -0.115386).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.7569251
	speed: 0.2660s/iter; left time: 4786.3103s
	iters: 200, epoch: 14 | loss: 2.7098672
	speed: 0.0807s/iter; left time: 1444.3481s
Epoch: 14 cost time: 17.875354766845703
Epoch: 14, Steps: 208 | Train Loss: 2.562 Vali Loss: 3.341 Vali Acc: 0.104 Test Loss: 3.341 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.6567023
	speed: 0.2667s/iter; left time: 4744.6093s
	iters: 200, epoch: 15 | loss: 2.0998993
	speed: 0.0834s/iter; left time: 1474.3812s
Epoch: 15 cost time: 18.217013835906982
Epoch: 15, Steps: 208 | Train Loss: 2.426 Vali Loss: 3.450 Vali Acc: 0.103 Test Loss: 3.450 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 2.2154350
	speed: 0.2759s/iter; left time: 4850.7383s
	iters: 200, epoch: 16 | loss: 2.0554545
	speed: 0.0851s/iter; left time: 1487.9565s
Epoch: 16 cost time: 18.23098397254944
Epoch: 16, Steps: 208 | Train Loss: 2.302 Vali Loss: 3.503 Vali Acc: 0.117 Test Loss: 3.503 Test Acc: 0.117
Validation loss decreased (-0.115386 --> -0.117173).  Saving model ...
	iters: 100, epoch: 17 | loss: 2.9083381
	speed: 0.2682s/iter; left time: 4660.1306s
	iters: 200, epoch: 17 | loss: 2.1378803
	speed: 0.0857s/iter; left time: 1480.9135s
Epoch: 17 cost time: 18.028505325317383
Epoch: 17, Steps: 208 | Train Loss: 2.142 Vali Loss: 3.470 Vali Acc: 0.115 Test Loss: 3.470 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 2.4051664
	speed: 0.2846s/iter; left time: 4884.5071s
	iters: 200, epoch: 18 | loss: 1.7941915
	speed: 0.0855s/iter; left time: 1459.5097s
Epoch: 18 cost time: 19.790791034698486
Epoch: 18, Steps: 208 | Train Loss: 2.046 Vali Loss: 3.596 Vali Acc: 0.113 Test Loss: 3.596 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.9130492
	speed: 0.2774s/iter; left time: 4704.2279s
	iters: 200, epoch: 19 | loss: 1.9675694
	speed: 0.0801s/iter; left time: 1349.4318s
Epoch: 19 cost time: 17.805603504180908
Epoch: 19, Steps: 208 | Train Loss: 1.920 Vali Loss: 3.908 Vali Acc: 0.119 Test Loss: 3.908 Test Acc: 0.119
Validation loss decreased (-0.117173 --> -0.119257).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.5327700
	speed: 0.2518s/iter; left time: 4217.0246s
	iters: 200, epoch: 20 | loss: 1.5696541
	speed: 0.0838s/iter; left time: 1395.0579s
Epoch: 20 cost time: 17.29464840888977
Epoch: 20, Steps: 208 | Train Loss: 1.791 Vali Loss: 3.908 Vali Acc: 0.108 Test Loss: 3.908 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.9531389
	speed: 0.2660s/iter; left time: 4399.2709s
	iters: 200, epoch: 21 | loss: 1.8330824
	speed: 0.0758s/iter; left time: 1245.6599s
Epoch: 21 cost time: 16.84220600128174
Epoch: 21, Steps: 208 | Train Loss: 1.659 Vali Loss: 4.059 Vali Acc: 0.109 Test Loss: 4.059 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.2410189
	speed: 0.2696s/iter; left time: 4404.1254s
	iters: 200, epoch: 22 | loss: 1.6682070
	speed: 0.0854s/iter; left time: 1386.6884s
Epoch: 22 cost time: 18.656895399093628
Epoch: 22, Steps: 208 | Train Loss: 1.559 Vali Loss: 4.069 Vali Acc: 0.111 Test Loss: 4.069 Test Acc: 0.111
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 1.5927496
	speed: 0.2456s/iter; left time: 3960.8111s
	iters: 200, epoch: 23 | loss: 1.6066856
	speed: 0.0807s/iter; left time: 1293.0283s
Epoch: 23 cost time: 17.08572769165039
Epoch: 23, Steps: 208 | Train Loss: 1.476 Vali Loss: 4.094 Vali Acc: 0.115 Test Loss: 4.094 Test Acc: 0.115
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 1.7352768
	speed: 0.2953s/iter; left time: 4699.5855s
	iters: 200, epoch: 24 | loss: 1.0234171
	speed: 0.0875s/iter; left time: 1383.4149s
Epoch: 24 cost time: 19.72258472442627
Epoch: 24, Steps: 208 | Train Loss: 1.379 Vali Loss: 4.355 Vali Acc: 0.109 Test Loss: 4.355 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 1.0707229
	speed: 0.2822s/iter; left time: 4433.5155s
	iters: 200, epoch: 25 | loss: 0.9777225
	speed: 0.0948s/iter; left time: 1479.7153s
Epoch: 25 cost time: 19.054096221923828
Epoch: 25, Steps: 208 | Train Loss: 1.244 Vali Loss: 4.569 Vali Acc: 0.111 Test Loss: 4.569 Test Acc: 0.111
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 1.5427823
	speed: 0.2707s/iter; left time: 4195.5520s
	iters: 200, epoch: 26 | loss: 1.2695199
	speed: 0.0819s/iter; left time: 1261.1362s
Epoch: 26 cost time: 17.51450753211975
Epoch: 26, Steps: 208 | Train Loss: 1.187 Vali Loss: 4.550 Vali Acc: 0.111 Test Loss: 4.550 Test Acc: 0.111
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.6383091
	speed: 0.2794s/iter; left time: 4272.3934s
	iters: 200, epoch: 27 | loss: 1.2328296
	speed: 0.0886s/iter; left time: 1346.4065s
Epoch: 27 cost time: 19.01163339614868
Epoch: 27, Steps: 208 | Train Loss: 1.077 Vali Loss: 4.676 Vali Acc: 0.111 Test Loss: 4.676 Test Acc: 0.111
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 1.4223179
	speed: 0.2655s/iter; left time: 4005.5258s
	iters: 200, epoch: 28 | loss: 1.3219934
	speed: 0.0815s/iter; left time: 1221.6604s
Epoch: 28 cost time: 17.952330350875854
Epoch: 28, Steps: 208 | Train Loss: 1.046 Vali Loss: 4.850 Vali Acc: 0.101 Test Loss: 4.850 Test Acc: 0.101
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.6970599
	speed: 0.2777s/iter; left time: 4131.4219s
	iters: 200, epoch: 29 | loss: 0.8146911
	speed: 0.0851s/iter; left time: 1257.1515s
Epoch: 29 cost time: 17.915224313735962
Epoch: 29, Steps: 208 | Train Loss: 0.978 Vali Loss: 5.040 Vali Acc: 0.109 Test Loss: 5.040 Test Acc: 0.109
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11929615269907545
model parameter : 509283
model size : 2.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9784160
	speed: 0.1020s/iter; left time: 2110.6699s
	iters: 200, epoch: 1 | loss: 3.3717284
	speed: 0.0837s/iter; left time: 1724.8546s
Epoch: 1 cost time: 19.30284070968628
Epoch: 1, Steps: 208 | Train Loss: 3.660 Vali Loss: 3.551 Vali Acc: 0.048 Test Loss: 3.551 Test Acc: 0.048
Validation loss decreased (inf --> -0.047683).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8514369
	speed: 0.2683s/iter; left time: 5498.4641s
	iters: 200, epoch: 2 | loss: 3.3807104
	speed: 0.0887s/iter; left time: 1808.0106s
Epoch: 2 cost time: 18.724495887756348
Epoch: 2, Steps: 208 | Train Loss: 3.556 Vali Loss: 3.571 Vali Acc: 0.049 Test Loss: 3.571 Test Acc: 0.049
Validation loss decreased (-0.047683 --> -0.048577).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7735960
	speed: 0.3132s/iter; left time: 6354.0159s
	iters: 200, epoch: 3 | loss: 3.7163012
	speed: 0.1000s/iter; left time: 2017.5471s
Epoch: 3 cost time: 21.925386428833008
Epoch: 3, Steps: 208 | Train Loss: 3.476 Vali Loss: 3.491 Vali Acc: 0.067 Test Loss: 3.491 Test Acc: 0.067
Validation loss decreased (-0.048577 --> -0.067069).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4707191
	speed: 0.2857s/iter; left time: 5736.0388s
	iters: 200, epoch: 4 | loss: 3.4114347
	speed: 0.0934s/iter; left time: 1865.4757s
Epoch: 4 cost time: 19.741539239883423
Epoch: 4, Steps: 208 | Train Loss: 3.434 Vali Loss: 3.460 Vali Acc: 0.057 Test Loss: 3.460 Test Acc: 0.057
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.3181009
	speed: 0.3269s/iter; left time: 6495.1622s
	iters: 200, epoch: 5 | loss: 3.2271283
	speed: 0.0887s/iter; left time: 1754.1174s
Epoch: 5 cost time: 19.399688243865967
Epoch: 5, Steps: 208 | Train Loss: 3.389 Vali Loss: 3.462 Vali Acc: 0.072 Test Loss: 3.462 Test Acc: 0.072
Validation loss decreased (-0.067069 --> -0.071543).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.1687191
	speed: 0.3064s/iter; left time: 6023.5286s
	iters: 200, epoch: 6 | loss: 3.3413556
	speed: 0.0874s/iter; left time: 1709.1587s
Epoch: 6 cost time: 19.48639750480652
Epoch: 6, Steps: 208 | Train Loss: 3.341 Vali Loss: 3.448 Vali Acc: 0.073 Test Loss: 3.448 Test Acc: 0.073
Validation loss decreased (-0.071543 --> -0.073034).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.1869709
	speed: 0.2726s/iter; left time: 5303.6989s
	iters: 200, epoch: 7 | loss: 3.3252022
	speed: 0.0849s/iter; left time: 1643.1067s
Epoch: 7 cost time: 19.47864866256714
Epoch: 7, Steps: 208 | Train Loss: 3.288 Vali Loss: 3.426 Vali Acc: 0.065 Test Loss: 3.426 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 3.2648354
	speed: 0.2889s/iter; left time: 5559.6545s
	iters: 200, epoch: 8 | loss: 2.7457304
	speed: 0.0950s/iter; left time: 1819.0617s
Epoch: 8 cost time: 20.355182886123657
Epoch: 8, Steps: 208 | Train Loss: 3.211 Vali Loss: 3.419 Vali Acc: 0.079 Test Loss: 3.419 Test Acc: 0.079
Validation loss decreased (-0.073034 --> -0.078701).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.3133678
	speed: 0.2791s/iter; left time: 5312.3707s
	iters: 200, epoch: 9 | loss: 3.6447663
	speed: 0.0843s/iter; left time: 1597.1441s
Epoch: 9 cost time: 17.92642903327942
Epoch: 9, Steps: 208 | Train Loss: 3.146 Vali Loss: 3.421 Vali Acc: 0.081 Test Loss: 3.421 Test Acc: 0.081
Validation loss decreased (-0.078701 --> -0.080491).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.7650070
	speed: 0.2918s/iter; left time: 5494.3453s
	iters: 200, epoch: 10 | loss: 2.7000711
	speed: 0.0892s/iter; left time: 1670.6944s
Epoch: 10 cost time: 20.195471048355103
Epoch: 10, Steps: 208 | Train Loss: 3.029 Vali Loss: 3.293 Vali Acc: 0.100 Test Loss: 3.293 Test Acc: 0.100
Validation loss decreased (-0.080491 --> -0.099878).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.8972414
	speed: 0.3117s/iter; left time: 5804.8857s
	iters: 200, epoch: 11 | loss: 2.8076234
	speed: 0.0920s/iter; left time: 1703.7726s
Epoch: 11 cost time: 20.518921613693237
Epoch: 11, Steps: 208 | Train Loss: 2.899 Vali Loss: 3.312 Vali Acc: 0.097 Test Loss: 3.312 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.5736804
	speed: 0.3000s/iter; left time: 5523.8203s
	iters: 200, epoch: 12 | loss: 3.0370803
	speed: 0.0926s/iter; left time: 1696.1395s
Epoch: 12 cost time: 19.658485651016235
Epoch: 12, Steps: 208 | Train Loss: 2.790 Vali Loss: 3.390 Vali Acc: 0.090 Test Loss: 3.390 Test Acc: 0.090
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 2.6349771
	speed: 0.3163s/iter; left time: 5758.1262s
	iters: 200, epoch: 13 | loss: 2.5955408
	speed: 0.0913s/iter; left time: 1652.5493s
Epoch: 13 cost time: 20.46839189529419
Epoch: 13, Steps: 208 | Train Loss: 2.702 Vali Loss: 3.308 Vali Acc: 0.109 Test Loss: 3.308 Test Acc: 0.109
Validation loss decreased (-0.099878 --> -0.108825).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.6161866
	speed: 0.2694s/iter; left time: 4848.3150s
	iters: 200, epoch: 14 | loss: 2.8154275
	speed: 0.0960s/iter; left time: 1717.4043s
Epoch: 14 cost time: 18.83355450630188
Epoch: 14, Steps: 208 | Train Loss: 2.569 Vali Loss: 3.376 Vali Acc: 0.107 Test Loss: 3.376 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.0253406
	speed: 0.2772s/iter; left time: 4931.9509s
	iters: 200, epoch: 15 | loss: 2.6983037
	speed: 0.0857s/iter; left time: 1516.7097s
Epoch: 15 cost time: 17.770128965377808
Epoch: 15, Steps: 208 | Train Loss: 2.457 Vali Loss: 3.401 Vali Acc: 0.103 Test Loss: 3.401 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.9858814
	speed: 0.2908s/iter; left time: 5112.8100s
	iters: 200, epoch: 16 | loss: 2.0161872
	speed: 0.0995s/iter; left time: 1738.7767s
Epoch: 16 cost time: 21.369404554367065
Epoch: 16, Steps: 208 | Train Loss: 2.336 Vali Loss: 3.475 Vali Acc: 0.103 Test Loss: 3.475 Test Acc: 0.103
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 2.0125818
	speed: 0.2662s/iter; left time: 4624.4084s
	iters: 200, epoch: 17 | loss: 2.5182307
	speed: 0.0820s/iter; left time: 1415.8593s
Epoch: 17 cost time: 17.430442333221436
Epoch: 17, Steps: 208 | Train Loss: 2.209 Vali Loss: 3.592 Vali Acc: 0.110 Test Loss: 3.592 Test Acc: 0.110
Validation loss decreased (-0.108825 --> -0.110015).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.7898825
	speed: 0.3151s/iter; left time: 5408.2026s
	iters: 200, epoch: 18 | loss: 1.7258288
	speed: 0.0887s/iter; left time: 1514.4074s
Epoch: 18 cost time: 19.792452335357666
Epoch: 18, Steps: 208 | Train Loss: 2.085 Vali Loss: 3.657 Vali Acc: 0.113 Test Loss: 3.657 Test Acc: 0.113
Validation loss decreased (-0.110015 --> -0.112997).  Saving model ...
	iters: 100, epoch: 19 | loss: 2.1722081
	speed: 0.3154s/iter; left time: 5348.9478s
	iters: 200, epoch: 19 | loss: 1.9926184
	speed: 0.0953s/iter; left time: 1606.9131s
Epoch: 19 cost time: 20.836249589920044
Epoch: 19, Steps: 208 | Train Loss: 1.940 Vali Loss: 3.788 Vali Acc: 0.108 Test Loss: 3.788 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.8155649
	speed: 0.2889s/iter; left time: 4838.7099s
	iters: 200, epoch: 20 | loss: 1.2715304
	speed: 0.1022s/iter; left time: 1700.9778s
Epoch: 20 cost time: 19.76863121986389
Epoch: 20, Steps: 208 | Train Loss: 1.830 Vali Loss: 3.883 Vali Acc: 0.103 Test Loss: 3.883 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.6138570
	speed: 0.3190s/iter; left time: 5275.8233s
	iters: 200, epoch: 21 | loss: 1.5323927
	speed: 0.0903s/iter; left time: 1484.3965s
Epoch: 21 cost time: 20.05561923980713
Epoch: 21, Steps: 208 | Train Loss: 1.712 Vali Loss: 3.952 Vali Acc: 0.108 Test Loss: 3.952 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.3121076
	speed: 0.2881s/iter; left time: 4706.3242s
	iters: 200, epoch: 22 | loss: 0.9261623
	speed: 0.0836s/iter; left time: 1356.8716s
Epoch: 22 cost time: 18.050692796707153
Epoch: 22, Steps: 208 | Train Loss: 1.583 Vali Loss: 4.084 Vali Acc: 0.098 Test Loss: 4.084 Test Acc: 0.098
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.3484582
	speed: 0.2786s/iter; left time: 4492.6615s
	iters: 200, epoch: 23 | loss: 1.8458407
	speed: 0.0931s/iter; left time: 1492.1014s
Epoch: 23 cost time: 19.3046395778656
Epoch: 23, Steps: 208 | Train Loss: 1.484 Vali Loss: 4.173 Vali Acc: 0.106 Test Loss: 4.173 Test Acc: 0.106
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 1.6359148
	speed: 0.2998s/iter; left time: 4771.7393s
	iters: 200, epoch: 24 | loss: 0.9975526
	speed: 0.0909s/iter; left time: 1438.1179s
Epoch: 24 cost time: 20.310203075408936
Epoch: 24, Steps: 208 | Train Loss: 1.347 Vali Loss: 4.339 Vali Acc: 0.106 Test Loss: 4.339 Test Acc: 0.106
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 1.3542088
	speed: 0.2891s/iter; left time: 4541.4636s
	iters: 200, epoch: 25 | loss: 1.6979167
	speed: 0.0785s/iter; left time: 1226.0207s
Epoch: 25 cost time: 18.03374457359314
Epoch: 25, Steps: 208 | Train Loss: 1.291 Vali Loss: 4.459 Vali Acc: 0.109 Test Loss: 4.459 Test Acc: 0.109
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 1.1680797
	speed: 0.2941s/iter; left time: 4558.2724s
	iters: 200, epoch: 26 | loss: 1.2894908
	speed: 0.0981s/iter; left time: 1511.2832s
Epoch: 26 cost time: 21.4420428276062
Epoch: 26, Steps: 208 | Train Loss: 1.182 Vali Loss: 4.617 Vali Acc: 0.104 Test Loss: 4.617 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.6884032
	speed: 0.3030s/iter; left time: 4633.4159s
	iters: 200, epoch: 27 | loss: 0.6023718
	speed: 0.1041s/iter; left time: 1581.0395s
Epoch: 27 cost time: 21.333957195281982
Epoch: 27, Steps: 208 | Train Loss: 1.122 Vali Loss: 4.746 Vali Acc: 0.113 Test Loss: 4.746 Test Acc: 0.113
Validation loss decreased (-0.112997 --> -0.113284).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.9804641
	speed: 0.3148s/iter; left time: 4748.7942s
	iters: 200, epoch: 28 | loss: 0.8296693
	speed: 0.0907s/iter; left time: 1359.4997s
Epoch: 28 cost time: 19.144965887069702
Epoch: 28, Steps: 208 | Train Loss: 1.021 Vali Loss: 4.922 Vali Acc: 0.111 Test Loss: 4.922 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.8262061
	speed: 0.2790s/iter; left time: 4150.0843s
	iters: 200, epoch: 29 | loss: 1.5004851
	speed: 0.0890s/iter; left time: 1315.5489s
Epoch: 29 cost time: 18.546855926513672
Epoch: 29, Steps: 208 | Train Loss: 0.996 Vali Loss: 5.168 Vali Acc: 0.099 Test Loss: 5.168 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 1.0408154
	speed: 0.2887s/iter; left time: 4235.3510s
	iters: 200, epoch: 30 | loss: 1.2658907
	speed: 0.1011s/iter; left time: 1472.2396s
Epoch: 30 cost time: 20.36717200279236
Epoch: 30, Steps: 208 | Train Loss: 0.924 Vali Loss: 5.202 Vali Acc: 0.101 Test Loss: 5.202 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.7464135
	speed: 0.2922s/iter; left time: 4225.9830s
	iters: 200, epoch: 31 | loss: 1.2618734
	speed: 0.0819s/iter; left time: 1176.7264s
Epoch: 31 cost time: 17.721125602722168
Epoch: 31, Steps: 208 | Train Loss: 0.880 Vali Loss: 5.249 Vali Acc: 0.105 Test Loss: 5.249 Test Acc: 0.105
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.7394804
	speed: 0.2903s/iter; left time: 4137.3753s
	iters: 200, epoch: 32 | loss: 0.6817675
	speed: 0.0886s/iter; left time: 1253.5587s
Epoch: 32 cost time: 19.636239767074585
Epoch: 32, Steps: 208 | Train Loss: 0.826 Vali Loss: 5.470 Vali Acc: 0.098 Test Loss: 5.470 Test Acc: 0.098
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.7729034
	speed: 0.2925s/iter; left time: 4107.8962s
	iters: 200, epoch: 33 | loss: 1.0163362
	speed: 0.0866s/iter; left time: 1207.6476s
Epoch: 33 cost time: 19.67440676689148
Epoch: 33, Steps: 208 | Train Loss: 0.799 Vali Loss: 5.558 Vali Acc: 0.105 Test Loss: 5.558 Test Acc: 0.105
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.8946903
	speed: 0.2655s/iter; left time: 3673.8380s
	iters: 200, epoch: 34 | loss: 1.3555644
	speed: 0.0798s/iter; left time: 1095.6169s
Epoch: 34 cost time: 17.640076875686646
Epoch: 34, Steps: 208 | Train Loss: 0.761 Vali Loss: 5.712 Vali Acc: 0.116 Test Loss: 5.712 Test Acc: 0.116
Validation loss decreased (-0.113284 --> -0.116257).  Saving model ...
	iters: 100, epoch: 35 | loss: 0.5238820
	speed: 0.2875s/iter; left time: 3917.7696s
	iters: 200, epoch: 35 | loss: 0.5736340
	speed: 0.0928s/iter; left time: 1256.0479s
Epoch: 35 cost time: 19.522780895233154
Epoch: 35, Steps: 208 | Train Loss: 0.737 Vali Loss: 5.754 Vali Acc: 0.110 Test Loss: 5.754 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 0.9391406
	speed: 0.3073s/iter; left time: 4123.6267s
	iters: 200, epoch: 36 | loss: 0.5310458
	speed: 0.0864s/iter; left time: 1151.2751s
Epoch: 36 cost time: 19.582730770111084
Epoch: 36, Steps: 208 | Train Loss: 0.733 Vali Loss: 5.871 Vali Acc: 0.109 Test Loss: 5.871 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 0.4819178
	speed: 0.2968s/iter; left time: 3921.5751s
	iters: 200, epoch: 37 | loss: 0.5825511
	speed: 0.0994s/iter; left time: 1303.7895s
Epoch: 37 cost time: 21.27408456802368
Epoch: 37, Steps: 208 | Train Loss: 0.661 Vali Loss: 6.218 Vali Acc: 0.112 Test Loss: 6.218 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 0.3653024
	speed: 0.3024s/iter; left time: 3932.4482s
	iters: 200, epoch: 38 | loss: 0.9597740
	speed: 0.0926s/iter; left time: 1194.4352s
Epoch: 38 cost time: 19.830630779266357
Epoch: 38, Steps: 208 | Train Loss: 0.637 Vali Loss: 6.080 Vali Acc: 0.106 Test Loss: 6.080 Test Acc: 0.106
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 0.9086620
	speed: 0.2916s/iter; left time: 3731.6058s
	iters: 200, epoch: 39 | loss: 0.9820117
	speed: 0.0855s/iter; left time: 1086.1661s
Epoch: 39 cost time: 18.44309163093567
Epoch: 39, Steps: 208 | Train Loss: 0.619 Vali Loss: 6.386 Vali Acc: 0.101 Test Loss: 6.386 Test Acc: 0.101
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 40 | loss: 0.7356714
	speed: 0.2676s/iter; left time: 3368.2504s
	iters: 200, epoch: 40 | loss: 0.6593970
	speed: 0.0893s/iter; left time: 1114.8182s
Epoch: 40 cost time: 19.558972120285034
Epoch: 40, Steps: 208 | Train Loss: 0.668 Vali Loss: 6.091 Vali Acc: 0.103 Test Loss: 6.091 Test Acc: 0.103
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 41 | loss: 0.8287292
	speed: 0.2891s/iter; left time: 3579.1378s
	iters: 200, epoch: 41 | loss: 0.5338666
	speed: 0.0794s/iter; left time: 975.3427s
Epoch: 41 cost time: 17.81313419342041
Epoch: 41, Steps: 208 | Train Loss: 0.630 Vali Loss: 6.461 Vali Acc: 0.107 Test Loss: 6.461 Test Acc: 0.107
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 42 | loss: 0.7120174
	speed: 0.2757s/iter; left time: 3355.6930s
	iters: 200, epoch: 42 | loss: 0.3116972
	speed: 0.0801s/iter; left time: 967.2416s
Epoch: 42 cost time: 17.838937282562256
Epoch: 42, Steps: 208 | Train Loss: 0.564 Vali Loss: 6.468 Vali Acc: 0.107 Test Loss: 6.468 Test Acc: 0.107
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 43 | loss: 0.3403729
	speed: 0.2689s/iter; left time: 3217.0882s
	iters: 200, epoch: 43 | loss: 0.7880226
	speed: 0.0963s/iter; left time: 1142.5665s
Epoch: 43 cost time: 19.46690034866333
Epoch: 43, Steps: 208 | Train Loss: 0.579 Vali Loss: 6.629 Vali Acc: 0.105 Test Loss: 6.629 Test Acc: 0.105
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 44 | loss: 0.2730137
	speed: 0.3000s/iter; left time: 3526.8254s
	iters: 200, epoch: 44 | loss: 0.6496723
	speed: 0.0908s/iter; left time: 1058.7749s
Epoch: 44 cost time: 19.5169198513031
Epoch: 44, Steps: 208 | Train Loss: 0.596 Vali Loss: 6.559 Vali Acc: 0.108 Test Loss: 6.559 Test Acc: 0.108
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11631374888159857
model parameter : 508099
model size : 2.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9364243
	speed: 0.1132s/iter; left time: 2344.1196s
	iters: 200, epoch: 1 | loss: 3.3527577
	speed: 0.0883s/iter; left time: 1818.7207s
Epoch: 1 cost time: 20.93513059616089
Epoch: 1, Steps: 208 | Train Loss: 3.691 Vali Loss: 3.587 Vali Acc: 0.041 Test Loss: 3.587 Test Acc: 0.041
Validation loss decreased (inf --> -0.040823).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6118670
	speed: 0.2937s/iter; left time: 6018.7741s
	iters: 200, epoch: 2 | loss: 3.6101112
	speed: 0.0902s/iter; left time: 1840.2841s
Epoch: 2 cost time: 19.471949100494385
Epoch: 2, Steps: 208 | Train Loss: 3.553 Vali Loss: 3.501 Vali Acc: 0.055 Test Loss: 3.501 Test Acc: 0.055
Validation loss decreased (-0.040823 --> -0.055139).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5180376
	speed: 0.2559s/iter; left time: 5191.6568s
	iters: 200, epoch: 3 | loss: 3.4928789
	speed: 0.0854s/iter; left time: 1724.4043s
Epoch: 3 cost time: 17.860245943069458
Epoch: 3, Steps: 208 | Train Loss: 3.486 Vali Loss: 3.495 Vali Acc: 0.066 Test Loss: 3.495 Test Acc: 0.066
Validation loss decreased (-0.055139 --> -0.065876).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3740504
	speed: 0.2805s/iter; left time: 5632.2379s
	iters: 200, epoch: 4 | loss: 3.1834497
	speed: 0.0851s/iter; left time: 1700.3136s
Epoch: 4 cost time: 18.302737712860107
Epoch: 4, Steps: 208 | Train Loss: 3.429 Vali Loss: 3.460 Vali Acc: 0.069 Test Loss: 3.460 Test Acc: 0.069
Validation loss decreased (-0.065876 --> -0.068561).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2693412
	speed: 0.2849s/iter; left time: 5661.6268s
	iters: 200, epoch: 5 | loss: 3.6208014
	speed: 0.0857s/iter; left time: 1694.3232s
Epoch: 5 cost time: 19.007235765457153
Epoch: 5, Steps: 208 | Train Loss: 3.359 Vali Loss: 3.449 Vali Acc: 0.077 Test Loss: 3.449 Test Acc: 0.077
Validation loss decreased (-0.068561 --> -0.077210).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2067769
	speed: 0.2829s/iter; left time: 5563.0401s
	iters: 200, epoch: 6 | loss: 3.1105072
	speed: 0.0894s/iter; left time: 1748.9519s
Epoch: 6 cost time: 20.213656187057495
Epoch: 6, Steps: 208 | Train Loss: 3.296 Vali Loss: 3.419 Vali Acc: 0.076 Test Loss: 3.419 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.1345057
	speed: 0.2874s/iter; left time: 5590.1502s
	iters: 200, epoch: 7 | loss: 2.7465038
	speed: 0.1073s/iter; left time: 2077.2127s
Epoch: 7 cost time: 22.092466831207275
Epoch: 7, Steps: 208 | Train Loss: 3.226 Vali Loss: 3.410 Vali Acc: 0.078 Test Loss: 3.410 Test Acc: 0.078
Validation loss decreased (-0.077210 --> -0.077807).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.9193022
	speed: 0.2962s/iter; left time: 5700.4504s
	iters: 200, epoch: 8 | loss: 3.1362348
	speed: 0.0776s/iter; left time: 1485.9431s
Epoch: 8 cost time: 17.736223459243774
Epoch: 8, Steps: 208 | Train Loss: 3.103 Vali Loss: 3.310 Vali Acc: 0.097 Test Loss: 3.310 Test Acc: 0.097
Validation loss decreased (-0.077807 --> -0.096895).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.9519830
	speed: 0.3084s/iter; left time: 5871.4974s
	iters: 200, epoch: 9 | loss: 2.6376233
	speed: 0.0895s/iter; left time: 1695.4938s
Epoch: 9 cost time: 19.495410203933716
Epoch: 9, Steps: 208 | Train Loss: 2.984 Vali Loss: 3.278 Vali Acc: 0.101 Test Loss: 3.278 Test Acc: 0.101
Validation loss decreased (-0.096895 --> -0.100474).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.8596172
	speed: 0.2999s/iter; left time: 5647.0825s
	iters: 200, epoch: 10 | loss: 3.4492352
	speed: 0.1094s/iter; left time: 2049.8068s
Epoch: 10 cost time: 22.028705835342407
Epoch: 10, Steps: 208 | Train Loss: 2.870 Vali Loss: 3.243 Vali Acc: 0.103 Test Loss: 3.243 Test Acc: 0.103
Validation loss decreased (-0.100474 --> -0.102861).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.6932840
	speed: 0.2466s/iter; left time: 4591.2937s
	iters: 200, epoch: 11 | loss: 2.6200154
	speed: 0.0898s/iter; left time: 1663.5480s
Epoch: 11 cost time: 18.00603747367859
Epoch: 11, Steps: 208 | Train Loss: 2.755 Vali Loss: 3.299 Vali Acc: 0.109 Test Loss: 3.299 Test Acc: 0.109
Validation loss decreased (-0.102861 --> -0.109421).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.5774689
	speed: 0.2759s/iter; left time: 5079.3847s
	iters: 200, epoch: 12 | loss: 2.8515182
	speed: 0.0821s/iter; left time: 1503.6018s
Epoch: 12 cost time: 18.375696659088135
Epoch: 12, Steps: 208 | Train Loss: 2.647 Vali Loss: 3.318 Vali Acc: 0.106 Test Loss: 3.318 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.3244967
	speed: 0.2850s/iter; left time: 5188.2884s
	iters: 200, epoch: 13 | loss: 2.7353568
	speed: 0.0810s/iter; left time: 1466.4429s
Epoch: 13 cost time: 17.083897352218628
Epoch: 13, Steps: 208 | Train Loss: 2.527 Vali Loss: 3.328 Vali Acc: 0.108 Test Loss: 3.328 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 2.9730008
	speed: 0.2831s/iter; left time: 5095.2539s
	iters: 200, epoch: 14 | loss: 1.8963224
	speed: 0.0909s/iter; left time: 1626.2792s
Epoch: 14 cost time: 19.74767017364502
Epoch: 14, Steps: 208 | Train Loss: 2.401 Vali Loss: 3.380 Vali Acc: 0.124 Test Loss: 3.380 Test Acc: 0.124
Validation loss decreased (-0.109421 --> -0.124034).  Saving model ...
	iters: 100, epoch: 15 | loss: 2.7162237
	speed: 0.2839s/iter; left time: 5051.1587s
	iters: 200, epoch: 15 | loss: 2.7095230
	speed: 0.1012s/iter; left time: 1790.8550s
Epoch: 15 cost time: 20.68822932243347
Epoch: 15, Steps: 208 | Train Loss: 2.275 Vali Loss: 3.496 Vali Acc: 0.115 Test Loss: 3.496 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 2.5681067
	speed: 0.2914s/iter; left time: 5123.5669s
	iters: 200, epoch: 16 | loss: 1.9006631
	speed: 0.0892s/iter; left time: 1558.4476s
Epoch: 16 cost time: 19.93728494644165
Epoch: 16, Steps: 208 | Train Loss: 2.136 Vali Loss: 3.632 Vali Acc: 0.114 Test Loss: 3.632 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.8563584
	speed: 0.3150s/iter; left time: 5472.6196s
	iters: 200, epoch: 17 | loss: 1.7608289
	speed: 0.0966s/iter; left time: 1669.1268s
Epoch: 17 cost time: 20.75667691230774
Epoch: 17, Steps: 208 | Train Loss: 2.007 Vali Loss: 3.649 Vali Acc: 0.108 Test Loss: 3.649 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 2.2224655
	speed: 0.2846s/iter; left time: 4884.5687s
	iters: 200, epoch: 18 | loss: 1.5153561
	speed: 0.0904s/iter; left time: 1542.6120s
Epoch: 18 cost time: 18.831810474395752
Epoch: 18, Steps: 208 | Train Loss: 1.855 Vali Loss: 3.742 Vali Acc: 0.106 Test Loss: 3.742 Test Acc: 0.106
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 2.0585737
	speed: 0.2821s/iter; left time: 4783.3485s
	iters: 200, epoch: 19 | loss: 2.4335530
	speed: 0.0842s/iter; left time: 1419.5108s
Epoch: 19 cost time: 18.734667778015137
Epoch: 19, Steps: 208 | Train Loss: 1.744 Vali Loss: 3.906 Vali Acc: 0.117 Test Loss: 3.906 Test Acc: 0.117
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 1.6276093
	speed: 0.2895s/iter; left time: 4849.0028s
	iters: 200, epoch: 20 | loss: 0.7657065
	speed: 0.0913s/iter; left time: 1520.8673s
Epoch: 20 cost time: 19.597287893295288
Epoch: 20, Steps: 208 | Train Loss: 1.596 Vali Loss: 4.149 Vali Acc: 0.111 Test Loss: 4.149 Test Acc: 0.111
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 1.9772813
	speed: 0.2540s/iter; left time: 4201.5906s
	iters: 200, epoch: 21 | loss: 2.4694147
	speed: 0.0866s/iter; left time: 1423.2820s
Epoch: 21 cost time: 18.142459869384766
Epoch: 21, Steps: 208 | Train Loss: 1.512 Vali Loss: 4.258 Vali Acc: 0.107 Test Loss: 4.258 Test Acc: 0.107
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 1.2846553
	speed: 0.2905s/iter; left time: 4744.2860s
	iters: 200, epoch: 22 | loss: 1.5082520
	speed: 0.0859s/iter; left time: 1393.6032s
Epoch: 22 cost time: 19.26630711555481
Epoch: 22, Steps: 208 | Train Loss: 1.407 Vali Loss: 4.313 Vali Acc: 0.109 Test Loss: 4.313 Test Acc: 0.109
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.9833869
	speed: 0.3018s/iter; left time: 4865.8159s
	iters: 200, epoch: 23 | loss: 1.1789564
	speed: 0.0855s/iter; left time: 1370.0454s
Epoch: 23 cost time: 18.73663830757141
Epoch: 23, Steps: 208 | Train Loss: 1.279 Vali Loss: 4.356 Vali Acc: 0.115 Test Loss: 4.356 Test Acc: 0.115
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 1.3245623
	speed: 0.2891s/iter; left time: 4602.1504s
	iters: 200, epoch: 24 | loss: 1.2825460
	speed: 0.0931s/iter; left time: 1471.8014s
Epoch: 24 cost time: 20.040981769561768
Epoch: 24, Steps: 208 | Train Loss: 1.211 Vali Loss: 4.581 Vali Acc: 0.119 Test Loss: 4.581 Test Acc: 0.119
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12406799880703848
model parameter : 506915
model size : 2.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8565354
	speed: 0.1062s/iter; left time: 2199.4740s
	iters: 200, epoch: 1 | loss: 3.9558322
	speed: 0.0812s/iter; left time: 1672.9252s
Epoch: 1 cost time: 19.413825035095215
Epoch: 1, Steps: 208 | Train Loss: 3.681 Vali Loss: 3.577 Vali Acc: 0.047 Test Loss: 3.577 Test Acc: 0.047
Validation loss decreased (inf --> -0.046788).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5818510
	speed: 0.2605s/iter; left time: 5339.1415s
	iters: 200, epoch: 2 | loss: 3.5251772
	speed: 0.0894s/iter; left time: 1823.1243s
Epoch: 2 cost time: 19.313023567199707
Epoch: 2, Steps: 208 | Train Loss: 3.562 Vali Loss: 3.484 Vali Acc: 0.062 Test Loss: 3.484 Test Acc: 0.062
Validation loss decreased (-0.046788 --> -0.062297).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5513880
	speed: 0.2641s/iter; left time: 5357.6303s
	iters: 200, epoch: 3 | loss: 3.5725389
	speed: 0.0921s/iter; left time: 1858.9703s
Epoch: 3 cost time: 18.519893169403076
Epoch: 3, Steps: 208 | Train Loss: 3.486 Vali Loss: 3.450 Vali Acc: 0.083 Test Loss: 3.450 Test Acc: 0.083
Validation loss decreased (-0.062297 --> -0.083175).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3927531
	speed: 0.2744s/iter; left time: 5508.8361s
	iters: 200, epoch: 4 | loss: 3.1661732
	speed: 0.0797s/iter; left time: 1592.3197s
Epoch: 4 cost time: 17.235702753067017
Epoch: 4, Steps: 208 | Train Loss: 3.432 Vali Loss: 3.474 Vali Acc: 0.072 Test Loss: 3.474 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.7029526
	speed: 0.2755s/iter; left time: 5474.4900s
	iters: 200, epoch: 5 | loss: 3.4130056
	speed: 0.0938s/iter; left time: 1853.9630s
Epoch: 5 cost time: 19.74207878112793
Epoch: 5, Steps: 208 | Train Loss: 3.367 Vali Loss: 3.444 Vali Acc: 0.074 Test Loss: 3.444 Test Acc: 0.074
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 3.2296858
	speed: 0.2856s/iter; left time: 5614.4821s
	iters: 200, epoch: 6 | loss: 3.7963185
	speed: 0.0936s/iter; left time: 1829.9360s
Epoch: 6 cost time: 19.6485013961792
Epoch: 6, Steps: 208 | Train Loss: 3.304 Vali Loss: 3.412 Vali Acc: 0.075 Test Loss: 3.412 Test Acc: 0.075
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 3.0064466
	speed: 0.3006s/iter; left time: 5848.3296s
	iters: 200, epoch: 7 | loss: 3.1235406
	speed: 0.1035s/iter; left time: 2003.4961s
Epoch: 7 cost time: 21.3667254447937
Epoch: 7, Steps: 208 | Train Loss: 3.223 Vali Loss: 3.413 Vali Acc: 0.072 Test Loss: 3.413 Test Acc: 0.072
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 3.2745523
	speed: 0.2980s/iter; left time: 5734.5966s
	iters: 200, epoch: 8 | loss: 3.1635020
	speed: 0.0957s/iter; left time: 1833.0575s
Epoch: 8 cost time: 20.40444540977478
Epoch: 8, Steps: 208 | Train Loss: 3.141 Vali Loss: 3.294 Vali Acc: 0.095 Test Loss: 3.294 Test Acc: 0.095
Validation loss decreased (-0.083175 --> -0.095404).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.2802055
	speed: 0.3147s/iter; left time: 5991.1215s
	iters: 200, epoch: 9 | loss: 3.2762568
	speed: 0.0910s/iter; left time: 1723.6896s
Epoch: 9 cost time: 19.23926067352295
Epoch: 9, Steps: 208 | Train Loss: 3.019 Vali Loss: 3.328 Vali Acc: 0.091 Test Loss: 3.328 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 3.1856520
	speed: 0.2961s/iter; left time: 5575.6696s
	iters: 200, epoch: 10 | loss: 3.0981169
	speed: 0.0934s/iter; left time: 1748.8426s
Epoch: 10 cost time: 20.313096523284912
Epoch: 10, Steps: 208 | Train Loss: 2.912 Vali Loss: 3.257 Vali Acc: 0.105 Test Loss: 3.257 Test Acc: 0.105
Validation loss decreased (-0.095404 --> -0.104948).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.6410227
	speed: 0.3030s/iter; left time: 5642.0563s
	iters: 200, epoch: 11 | loss: 2.7209697
	speed: 0.0853s/iter; left time: 1580.5154s
Epoch: 11 cost time: 19.423323154449463
Epoch: 11, Steps: 208 | Train Loss: 2.786 Vali Loss: 3.261 Vali Acc: 0.114 Test Loss: 3.261 Test Acc: 0.114
Validation loss decreased (-0.104948 --> -0.113895).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.6913786
	speed: 0.2731s/iter; left time: 5027.7420s
	iters: 200, epoch: 12 | loss: 1.9387034
	speed: 0.0939s/iter; left time: 1719.0259s
Epoch: 12 cost time: 18.912060976028442
Epoch: 12, Steps: 208 | Train Loss: 2.662 Vali Loss: 3.342 Vali Acc: 0.101 Test Loss: 3.342 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.2901764
	speed: 0.2977s/iter; left time: 5419.9542s
	iters: 200, epoch: 13 | loss: 2.4743783
	speed: 0.0849s/iter; left time: 1536.3589s
Epoch: 13 cost time: 19.11652421951294
Epoch: 13, Steps: 208 | Train Loss: 2.524 Vali Loss: 3.329 Vali Acc: 0.102 Test Loss: 3.329 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 2.2643411
	speed: 0.2934s/iter; left time: 5280.2205s
	iters: 200, epoch: 14 | loss: 2.9114068
	speed: 0.0885s/iter; left time: 1583.1932s
Epoch: 14 cost time: 19.485677242279053
Epoch: 14, Steps: 208 | Train Loss: 2.408 Vali Loss: 3.322 Vali Acc: 0.115 Test Loss: 3.322 Test Acc: 0.115
Validation loss decreased (-0.113895 --> -0.114491).  Saving model ...
	iters: 100, epoch: 15 | loss: 2.0576572
	speed: 0.3035s/iter; left time: 5399.7072s
	iters: 200, epoch: 15 | loss: 2.5394447
	speed: 0.0920s/iter; left time: 1626.8493s
Epoch: 15 cost time: 20.403551816940308
Epoch: 15, Steps: 208 | Train Loss: 2.270 Vali Loss: 3.469 Vali Acc: 0.111 Test Loss: 3.469 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.8667409
	speed: 0.3412s/iter; left time: 5999.2121s
	iters: 200, epoch: 16 | loss: 2.1688333
	speed: 0.1015s/iter; left time: 1774.3101s
Epoch: 16 cost time: 21.93194890022278
Epoch: 16, Steps: 208 | Train Loss: 2.126 Vali Loss: 3.517 Vali Acc: 0.112 Test Loss: 3.517 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 2.1690466
	speed: 0.3075s/iter; left time: 5341.6755s
	iters: 200, epoch: 17 | loss: 2.3823979
	speed: 0.1006s/iter; left time: 1737.9747s
Epoch: 17 cost time: 21.70659899711609
Epoch: 17, Steps: 208 | Train Loss: 2.016 Vali Loss: 3.557 Vali Acc: 0.111 Test Loss: 3.557 Test Acc: 0.111
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.2428792
	speed: 0.2986s/iter; left time: 5125.6349s
	iters: 200, epoch: 18 | loss: 2.5956299
	speed: 0.0972s/iter; left time: 1659.4670s
Epoch: 18 cost time: 20.339606523513794
Epoch: 18, Steps: 208 | Train Loss: 1.863 Vali Loss: 3.632 Vali Acc: 0.108 Test Loss: 3.632 Test Acc: 0.108
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.6609507
	speed: 0.2984s/iter; left time: 5059.8263s
	iters: 200, epoch: 19 | loss: 1.7638363
	speed: 0.0793s/iter; left time: 1337.0607s
Epoch: 19 cost time: 17.904666423797607
Epoch: 19, Steps: 208 | Train Loss: 1.738 Vali Loss: 3.777 Vali Acc: 0.123 Test Loss: 3.777 Test Acc: 0.123
Validation loss decreased (-0.114491 --> -0.123136).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.4354401
	speed: 0.2778s/iter; left time: 4652.2716s
	iters: 200, epoch: 20 | loss: 1.6791131
	speed: 0.0868s/iter; left time: 1444.6327s
Epoch: 20 cost time: 19.45035672187805
Epoch: 20, Steps: 208 | Train Loss: 1.596 Vali Loss: 3.904 Vali Acc: 0.111 Test Loss: 3.904 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.2314060
	speed: 0.2730s/iter; left time: 4515.5184s
	iters: 200, epoch: 21 | loss: 1.4619720
	speed: 0.0928s/iter; left time: 1526.2800s
Epoch: 21 cost time: 19.695699453353882
Epoch: 21, Steps: 208 | Train Loss: 1.520 Vali Loss: 4.001 Vali Acc: 0.109 Test Loss: 4.001 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.6220115
	speed: 0.3150s/iter; left time: 5144.1552s
	iters: 200, epoch: 22 | loss: 1.7490515
	speed: 0.0897s/iter; left time: 1455.7748s
Epoch: 22 cost time: 20.634593963623047
Epoch: 22, Steps: 208 | Train Loss: 1.371 Vali Loss: 4.123 Vali Acc: 0.110 Test Loss: 4.123 Test Acc: 0.110
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 1.3304743
	speed: 0.3128s/iter; left time: 5044.1323s
	iters: 200, epoch: 23 | loss: 1.0398015
	speed: 0.0924s/iter; left time: 1481.4944s
Epoch: 23 cost time: 19.760966300964355
Epoch: 23, Steps: 208 | Train Loss: 1.275 Vali Loss: 4.223 Vali Acc: 0.117 Test Loss: 4.223 Test Acc: 0.117
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.8589579
	speed: 0.3250s/iter; left time: 5172.6395s
	iters: 200, epoch: 24 | loss: 1.3257339
	speed: 0.0973s/iter; left time: 1538.9512s
Epoch: 24 cost time: 21.768720626831055
Epoch: 24, Steps: 208 | Train Loss: 1.175 Vali Loss: 4.357 Vali Acc: 0.117 Test Loss: 4.357 Test Acc: 0.117
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.9962206
	speed: 0.3020s/iter; left time: 4743.6353s
	iters: 200, epoch: 25 | loss: 1.0923136
	speed: 0.1010s/iter; left time: 1576.8054s
Epoch: 25 cost time: 20.847933053970337
Epoch: 25, Steps: 208 | Train Loss: 1.081 Vali Loss: 4.594 Vali Acc: 0.115 Test Loss: 4.594 Test Acc: 0.115
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 1.1158357
	speed: 0.2787s/iter; left time: 4320.3041s
	iters: 200, epoch: 26 | loss: 1.0539389
	speed: 0.0859s/iter; left time: 1323.6386s
Epoch: 26 cost time: 19.23429799079895
Epoch: 26, Steps: 208 | Train Loss: 1.012 Vali Loss: 4.769 Vali Acc: 0.111 Test Loss: 4.769 Test Acc: 0.111
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 1.4007677
	speed: 0.3070s/iter; left time: 4695.1490s
	iters: 200, epoch: 27 | loss: 0.7700189
	speed: 0.0890s/iter; left time: 1352.3345s
Epoch: 27 cost time: 19.379568576812744
Epoch: 27, Steps: 208 | Train Loss: 0.940 Vali Loss: 4.733 Vali Acc: 0.116 Test Loss: 4.733 Test Acc: 0.116
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.8525214
	speed: 0.2699s/iter; left time: 4072.1427s
	iters: 200, epoch: 28 | loss: 1.9356061
	speed: 0.0930s/iter; left time: 1394.2172s
Epoch: 28 cost time: 19.222970485687256
Epoch: 28, Steps: 208 | Train Loss: 0.861 Vali Loss: 4.946 Vali Acc: 0.115 Test Loss: 4.946 Test Acc: 0.115
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.9032351
	speed: 0.2878s/iter; left time: 4281.2930s
	iters: 200, epoch: 29 | loss: 1.4263642
	speed: 0.0879s/iter; left time: 1299.1643s
Epoch: 29 cost time: 18.317035675048828
Epoch: 29, Steps: 208 | Train Loss: 0.832 Vali Loss: 5.046 Vali Acc: 0.122 Test Loss: 5.046 Test Acc: 0.122
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12317327766179541
model parameter : 360707
model size : 2.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9367213
	speed: 0.1033s/iter; left time: 2138.3749s
	iters: 200, epoch: 1 | loss: 3.9728498
	speed: 0.0855s/iter; left time: 1760.9888s
Epoch: 1 cost time: 19.934980392456055
Epoch: 1, Steps: 208 | Train Loss: 3.673 Vali Loss: 3.551 Vali Acc: 0.050 Test Loss: 3.551 Test Acc: 0.050
Validation loss decreased (inf --> -0.049771).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3300486
	speed: 0.2910s/iter; left time: 5962.7978s
	iters: 200, epoch: 2 | loss: 3.6667867
	speed: 0.0814s/iter; left time: 1660.9795s
Epoch: 2 cost time: 18.021636486053467
Epoch: 2, Steps: 208 | Train Loss: 3.548 Vali Loss: 3.473 Vali Acc: 0.055 Test Loss: 3.473 Test Acc: 0.055
Validation loss decreased (-0.049771 --> -0.054842).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5506680
	speed: 0.2811s/iter; left time: 5702.6092s
	iters: 200, epoch: 3 | loss: 3.5628028
	speed: 0.0821s/iter; left time: 1657.1082s
Epoch: 3 cost time: 18.04383134841919
Epoch: 3, Steps: 208 | Train Loss: 3.490 Vali Loss: 3.454 Vali Acc: 0.068 Test Loss: 3.454 Test Acc: 0.068
Validation loss decreased (-0.054842 --> -0.067666).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4382942
	speed: 0.2480s/iter; left time: 4978.8943s
	iters: 200, epoch: 4 | loss: 3.4590211
	speed: 0.0809s/iter; left time: 1616.7958s
Epoch: 4 cost time: 17.052420139312744
Epoch: 4, Steps: 208 | Train Loss: 3.450 Vali Loss: 3.466 Vali Acc: 0.066 Test Loss: 3.466 Test Acc: 0.066
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.6228762
	speed: 0.2655s/iter; left time: 5274.9664s
	iters: 200, epoch: 5 | loss: 3.4928765
	speed: 0.0887s/iter; left time: 1754.1915s
Epoch: 5 cost time: 17.842211723327637
Epoch: 5, Steps: 208 | Train Loss: 3.410 Vali Loss: 3.421 Vali Acc: 0.073 Test Loss: 3.421 Test Acc: 0.073
Validation loss decreased (-0.067666 --> -0.073035).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.5129178
	speed: 0.2868s/iter; left time: 5638.3804s
	iters: 200, epoch: 6 | loss: 3.4658346
	speed: 0.0836s/iter; left time: 1635.8734s
Epoch: 6 cost time: 17.81250286102295
Epoch: 6, Steps: 208 | Train Loss: 3.357 Vali Loss: 3.401 Vali Acc: 0.066 Test Loss: 3.401 Test Acc: 0.066
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.3151994
	speed: 0.2588s/iter; left time: 5034.6566s
	iters: 200, epoch: 7 | loss: 3.1624756
	speed: 0.0872s/iter; left time: 1687.8520s
Epoch: 7 cost time: 18.59663224220276
Epoch: 7, Steps: 208 | Train Loss: 3.278 Vali Loss: 3.390 Vali Acc: 0.074 Test Loss: 3.390 Test Acc: 0.074
Validation loss decreased (-0.073035 --> -0.073930).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.1937449
	speed: 0.2590s/iter; left time: 4983.6788s
	iters: 200, epoch: 8 | loss: 3.1364477
	speed: 0.0829s/iter; left time: 1587.6735s
Epoch: 8 cost time: 17.406582593917847
Epoch: 8, Steps: 208 | Train Loss: 3.174 Vali Loss: 3.251 Vali Acc: 0.101 Test Loss: 3.251 Test Acc: 0.101
Validation loss decreased (-0.073930 --> -0.101071).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.2888250
	speed: 0.2695s/iter; left time: 5129.7127s
	iters: 200, epoch: 9 | loss: 3.3620026
	speed: 0.0836s/iter; left time: 1583.4258s
Epoch: 9 cost time: 17.347005367279053
Epoch: 9, Steps: 208 | Train Loss: 3.028 Vali Loss: 3.292 Vali Acc: 0.092 Test Loss: 3.292 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 3.0600092
	speed: 0.2758s/iter; left time: 5192.8241s
	iters: 200, epoch: 10 | loss: 3.1797872
	speed: 0.0893s/iter; left time: 1672.5136s
Epoch: 10 cost time: 19.039238452911377
Epoch: 10, Steps: 208 | Train Loss: 2.930 Vali Loss: 3.224 Vali Acc: 0.101 Test Loss: 3.224 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.9021173
	speed: 0.2939s/iter; left time: 5471.8225s
	iters: 200, epoch: 11 | loss: 3.0210109
	speed: 0.0869s/iter; left time: 1609.2415s
Epoch: 11 cost time: 19.20048975944519
Epoch: 11, Steps: 208 | Train Loss: 2.795 Vali Loss: 3.296 Vali Acc: 0.106 Test Loss: 3.296 Test Acc: 0.106
Validation loss decreased (-0.101071 --> -0.106439).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.6649003
	speed: 0.2705s/iter; left time: 4981.0094s
	iters: 200, epoch: 12 | loss: 2.8654697
	speed: 0.0783s/iter; left time: 1433.5024s
Epoch: 12 cost time: 17.040801763534546
Epoch: 12, Steps: 208 | Train Loss: 2.698 Vali Loss: 3.287 Vali Acc: 0.115 Test Loss: 3.287 Test Acc: 0.115
Validation loss decreased (-0.106439 --> -0.115088).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.5414679
	speed: 0.2863s/iter; left time: 5211.8636s
	iters: 200, epoch: 13 | loss: 2.1233482
	speed: 0.0948s/iter; left time: 1716.2938s
Epoch: 13 cost time: 20.043240547180176
Epoch: 13, Steps: 208 | Train Loss: 2.550 Vali Loss: 3.314 Vali Acc: 0.107 Test Loss: 3.314 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 2.4238975
	speed: 0.2687s/iter; left time: 4836.1384s
	iters: 200, epoch: 14 | loss: 2.2614326
	speed: 0.0911s/iter; left time: 1630.8272s
Epoch: 14 cost time: 18.298462390899658
Epoch: 14, Steps: 208 | Train Loss: 2.417 Vali Loss: 3.346 Vali Acc: 0.120 Test Loss: 3.346 Test Acc: 0.120
Validation loss decreased (-0.115088 --> -0.120157).  Saving model ...
	iters: 100, epoch: 15 | loss: 2.2314248
	speed: 0.2627s/iter; left time: 4672.7380s
	iters: 200, epoch: 15 | loss: 2.9502020
	speed: 0.0804s/iter; left time: 1422.6786s
Epoch: 15 cost time: 17.138137340545654
Epoch: 15, Steps: 208 | Train Loss: 2.310 Vali Loss: 3.386 Vali Acc: 0.119 Test Loss: 3.386 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 2.5481110
	speed: 0.2793s/iter; left time: 4909.5854s
	iters: 200, epoch: 16 | loss: 2.0177913
	speed: 0.0843s/iter; left time: 1473.2347s
Epoch: 16 cost time: 19.26548719406128
Epoch: 16, Steps: 208 | Train Loss: 2.119 Vali Loss: 3.569 Vali Acc: 0.111 Test Loss: 3.569 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 2.1164331
	speed: 0.2730s/iter; left time: 4743.3262s
	iters: 200, epoch: 17 | loss: 2.4543707
	speed: 0.0874s/iter; left time: 1508.9382s
Epoch: 17 cost time: 18.379772663116455
Epoch: 17, Steps: 208 | Train Loss: 2.013 Vali Loss: 3.517 Vali Acc: 0.123 Test Loss: 3.517 Test Acc: 0.123
Validation loss decreased (-0.120157 --> -0.122840).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.5813930
	speed: 0.2872s/iter; left time: 4929.8848s
	iters: 200, epoch: 18 | loss: 2.6061900
	speed: 0.0843s/iter; left time: 1437.7761s
Epoch: 18 cost time: 19.178652048110962
Epoch: 18, Steps: 208 | Train Loss: 1.875 Vali Loss: 3.687 Vali Acc: 0.113 Test Loss: 3.687 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.4105020
	speed: 0.2825s/iter; left time: 4791.1447s
	iters: 200, epoch: 19 | loss: 2.1696887
	speed: 0.0881s/iter; left time: 1485.4711s
Epoch: 19 cost time: 19.001444816589355
Epoch: 19, Steps: 208 | Train Loss: 1.754 Vali Loss: 3.801 Vali Acc: 0.129 Test Loss: 3.801 Test Acc: 0.129
Validation loss decreased (-0.122840 --> -0.129398).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.3528407
	speed: 0.2895s/iter; left time: 4848.2526s
	iters: 200, epoch: 20 | loss: 1.4832495
	speed: 0.0796s/iter; left time: 1325.1616s
Epoch: 20 cost time: 17.843449354171753
Epoch: 20, Steps: 208 | Train Loss: 1.626 Vali Loss: 3.845 Vali Acc: 0.121 Test Loss: 3.845 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.5933778
	speed: 0.2830s/iter; left time: 4681.1678s
	iters: 200, epoch: 21 | loss: 1.5997310
	speed: 0.0885s/iter; left time: 1455.1236s
Epoch: 21 cost time: 19.35895013809204
Epoch: 21, Steps: 208 | Train Loss: 1.511 Vali Loss: 3.913 Vali Acc: 0.108 Test Loss: 3.913 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.8059050
	speed: 0.2748s/iter; left time: 4487.8223s
	iters: 200, epoch: 22 | loss: 1.2907053
	speed: 0.0909s/iter; left time: 1475.4491s
Epoch: 22 cost time: 19.84557843208313
Epoch: 22, Steps: 208 | Train Loss: 1.419 Vali Loss: 4.078 Vali Acc: 0.115 Test Loss: 4.078 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 1.4516296
	speed: 0.2776s/iter; left time: 4476.3469s
	iters: 200, epoch: 23 | loss: 1.1443858
	speed: 0.0842s/iter; left time: 1349.6089s
Epoch: 23 cost time: 17.88349223136902
Epoch: 23, Steps: 208 | Train Loss: 1.308 Vali Loss: 4.286 Vali Acc: 0.116 Test Loss: 4.286 Test Acc: 0.116
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 1.1481234
	speed: 0.2619s/iter; left time: 4168.0370s
	iters: 200, epoch: 24 | loss: 1.9633654
	speed: 0.0883s/iter; left time: 1396.6581s
Epoch: 24 cost time: 18.635302305221558
Epoch: 24, Steps: 208 | Train Loss: 1.251 Vali Loss: 4.273 Vali Acc: 0.118 Test Loss: 4.273 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 1.1340072
	speed: 0.3022s/iter; left time: 4746.9652s
	iters: 200, epoch: 25 | loss: 1.7087376
	speed: 0.0850s/iter; left time: 1327.4527s
Epoch: 25 cost time: 19.58467936515808
Epoch: 25, Steps: 208 | Train Loss: 1.164 Vali Loss: 4.409 Vali Acc: 0.119 Test Loss: 4.409 Test Acc: 0.119
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 1.0548234
	speed: 0.2654s/iter; left time: 4113.6683s
	iters: 200, epoch: 26 | loss: 1.2672107
	speed: 0.0777s/iter; left time: 1196.6965s
Epoch: 26 cost time: 17.683536052703857
Epoch: 26, Steps: 208 | Train Loss: 1.077 Vali Loss: 4.614 Vali Acc: 0.124 Test Loss: 4.614 Test Acc: 0.124
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 1.6086977
	speed: 0.2950s/iter; left time: 4512.0138s
	iters: 200, epoch: 27 | loss: 0.7754692
	speed: 0.0861s/iter; left time: 1308.8445s
Epoch: 27 cost time: 18.824302911758423
Epoch: 27, Steps: 208 | Train Loss: 1.050 Vali Loss: 4.712 Vali Acc: 0.118 Test Loss: 4.712 Test Acc: 0.118
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.9740070
	speed: 0.2957s/iter; left time: 4461.1080s
	iters: 200, epoch: 28 | loss: 0.7097609
	speed: 0.0845s/iter; left time: 1266.3383s
Epoch: 28 cost time: 18.927667379379272
Epoch: 28, Steps: 208 | Train Loss: 0.976 Vali Loss: 4.941 Vali Acc: 0.118 Test Loss: 4.941 Test Acc: 0.118
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.7015691
	speed: 0.2614s/iter; left time: 3889.2401s
	iters: 200, epoch: 29 | loss: 0.7906545
	speed: 0.0883s/iter; left time: 1305.0667s
Epoch: 29 cost time: 18.123395204544067
Epoch: 29, Steps: 208 | Train Loss: 0.908 Vali Loss: 4.895 Vali Acc: 0.119 Test Loss: 4.895 Test Acc: 0.119
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12943632567849686
model parameter : 359523
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7777522
	speed: 0.1154s/iter; left time: 2389.8761s
	iters: 200, epoch: 1 | loss: 3.4754581
	speed: 0.0903s/iter; left time: 1861.1264s
Epoch: 1 cost time: 21.36901354789734
Epoch: 1, Steps: 208 | Train Loss: 3.702 Vali Loss: 3.612 Vali Acc: 0.053 Test Loss: 3.612 Test Acc: 0.053
Validation loss decreased (inf --> -0.052752).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8811421
	speed: 0.2849s/iter; left time: 5838.4337s
	iters: 200, epoch: 2 | loss: 3.3424942
	speed: 0.0953s/iter; left time: 1943.1141s
Epoch: 2 cost time: 19.923197746276855
Epoch: 2, Steps: 208 | Train Loss: 3.577 Vali Loss: 3.530 Vali Acc: 0.062 Test Loss: 3.530 Test Acc: 0.062
Validation loss decreased (-0.052752 --> -0.061700).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.0815120
	speed: 0.3065s/iter; left time: 6217.3198s
	iters: 200, epoch: 3 | loss: 3.3147125
	speed: 0.0915s/iter; left time: 1847.1427s
Epoch: 3 cost time: 20.376188039779663
Epoch: 3, Steps: 208 | Train Loss: 3.508 Vali Loss: 3.567 Vali Acc: 0.067 Test Loss: 3.567 Test Acc: 0.067
Validation loss decreased (-0.061700 --> -0.066472).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.0501256
	speed: 0.3054s/iter; left time: 6131.7931s
	iters: 200, epoch: 4 | loss: 3.5734684
	speed: 0.0783s/iter; left time: 1564.9792s
Epoch: 4 cost time: 18.09354019165039
Epoch: 4, Steps: 208 | Train Loss: 3.437 Vali Loss: 3.489 Vali Acc: 0.065 Test Loss: 3.489 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.3507872
	speed: 0.2957s/iter; left time: 5875.1623s
	iters: 200, epoch: 5 | loss: 3.4861603
	speed: 0.1033s/iter; left time: 2042.2033s
Epoch: 5 cost time: 22.03315305709839
Epoch: 5, Steps: 208 | Train Loss: 3.397 Vali Loss: 3.433 Vali Acc: 0.067 Test Loss: 3.433 Test Acc: 0.067
Validation loss decreased (-0.066472 --> -0.066772).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.3455067
	speed: 0.3069s/iter; left time: 6033.1260s
	iters: 200, epoch: 6 | loss: 3.1742454
	speed: 0.0957s/iter; left time: 1872.5855s
Epoch: 6 cost time: 20.594776153564453
Epoch: 6, Steps: 208 | Train Loss: 3.329 Vali Loss: 3.528 Vali Acc: 0.066 Test Loss: 3.528 Test Acc: 0.066
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 4.1738701
	speed: 0.3039s/iter; left time: 5911.1031s
	iters: 200, epoch: 7 | loss: 3.3899667
	speed: 0.0960s/iter; left time: 1857.8246s
Epoch: 7 cost time: 20.278557538986206
Epoch: 7, Steps: 208 | Train Loss: 3.262 Vali Loss: 3.441 Vali Acc: 0.074 Test Loss: 3.441 Test Acc: 0.074
Validation loss decreased (-0.066772 --> -0.074227).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.0688000
	speed: 0.3166s/iter; left time: 6092.9439s
	iters: 200, epoch: 8 | loss: 3.4778769
	speed: 0.0916s/iter; left time: 1754.2955s
Epoch: 8 cost time: 20.272292852401733
Epoch: 8, Steps: 208 | Train Loss: 3.158 Vali Loss: 3.368 Vali Acc: 0.091 Test Loss: 3.368 Test Acc: 0.091
Validation loss decreased (-0.074227 --> -0.090631).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.1455441
	speed: 0.2946s/iter; left time: 5608.2862s
	iters: 200, epoch: 9 | loss: 2.8293207
	speed: 0.0911s/iter; left time: 1725.6961s
Epoch: 9 cost time: 20.08184051513672
Epoch: 9, Steps: 208 | Train Loss: 3.059 Vali Loss: 3.296 Vali Acc: 0.098 Test Loss: 3.296 Test Acc: 0.098
Validation loss decreased (-0.090631 --> -0.097790).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.5226724
	speed: 0.2875s/iter; left time: 5413.0446s
	iters: 200, epoch: 10 | loss: 3.5657957
	speed: 0.0984s/iter; left time: 1843.0742s
Epoch: 10 cost time: 20.339694261550903
Epoch: 10, Steps: 208 | Train Loss: 2.907 Vali Loss: 3.337 Vali Acc: 0.089 Test Loss: 3.337 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.8012609
	speed: 0.3111s/iter; left time: 5792.8216s
	iters: 200, epoch: 11 | loss: 3.3884788
	speed: 0.0865s/iter; left time: 1602.2215s
Epoch: 11 cost time: 19.71772789955139
Epoch: 11, Steps: 208 | Train Loss: 2.776 Vali Loss: 3.284 Vali Acc: 0.103 Test Loss: 3.284 Test Acc: 0.103
Validation loss decreased (-0.097790 --> -0.102860).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.3181167
	speed: 0.2888s/iter; left time: 5317.4543s
	iters: 200, epoch: 12 | loss: 2.9780991
	speed: 0.0950s/iter; left time: 1739.3112s
Epoch: 12 cost time: 20.874563217163086
Epoch: 12, Steps: 208 | Train Loss: 2.653 Vali Loss: 3.338 Vali Acc: 0.098 Test Loss: 3.338 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.9213858
	speed: 0.2970s/iter; left time: 5406.3643s
	iters: 200, epoch: 13 | loss: 2.8309348
	speed: 0.1088s/iter; left time: 1969.6092s
Epoch: 13 cost time: 22.070277214050293
Epoch: 13, Steps: 208 | Train Loss: 2.514 Vali Loss: 3.404 Vali Acc: 0.111 Test Loss: 3.404 Test Acc: 0.111
Validation loss decreased (-0.102860 --> -0.110911).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.9895154
	speed: 0.2944s/iter; left time: 5299.1939s
	iters: 200, epoch: 14 | loss: 2.2184477
	speed: 0.0914s/iter; left time: 1635.9600s
Epoch: 14 cost time: 19.153688669204712
Epoch: 14, Steps: 208 | Train Loss: 2.383 Vali Loss: 3.451 Vali Acc: 0.105 Test Loss: 3.451 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.2876379
	speed: 0.3146s/iter; left time: 5595.7476s
	iters: 200, epoch: 15 | loss: 3.0325344
	speed: 0.0908s/iter; left time: 1606.3106s
Epoch: 15 cost time: 19.27229595184326
Epoch: 15, Steps: 208 | Train Loss: 2.213 Vali Loss: 3.581 Vali Acc: 0.114 Test Loss: 3.581 Test Acc: 0.114
Validation loss decreased (-0.110911 --> -0.114190).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.8174033
	speed: 0.2811s/iter; left time: 4941.1621s
	iters: 200, epoch: 16 | loss: 3.0213480
	speed: 0.0843s/iter; left time: 1473.8221s
Epoch: 16 cost time: 18.870049476623535
Epoch: 16, Steps: 208 | Train Loss: 2.080 Vali Loss: 3.633 Vali Acc: 0.105 Test Loss: 3.633 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 2.3145864
	speed: 0.2638s/iter; left time: 4582.6896s
	iters: 200, epoch: 17 | loss: 2.2678475
	speed: 0.0839s/iter; left time: 1449.5172s
Epoch: 17 cost time: 18.04686999320984
Epoch: 17, Steps: 208 | Train Loss: 1.963 Vali Loss: 3.790 Vali Acc: 0.114 Test Loss: 3.790 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.8574716
	speed: 0.2818s/iter; left time: 4836.3233s
	iters: 200, epoch: 18 | loss: 1.5828015
	speed: 0.0857s/iter; left time: 1462.8380s
Epoch: 18 cost time: 18.954676628112793
Epoch: 18, Steps: 208 | Train Loss: 1.820 Vali Loss: 3.754 Vali Acc: 0.113 Test Loss: 3.754 Test Acc: 0.113
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.7883549
	speed: 0.2625s/iter; left time: 4451.8987s
	iters: 200, epoch: 19 | loss: 1.7315176
	speed: 0.0799s/iter; left time: 1346.5935s
Epoch: 19 cost time: 17.236900091171265
Epoch: 19, Steps: 208 | Train Loss: 1.713 Vali Loss: 3.961 Vali Acc: 0.106 Test Loss: 3.961 Test Acc: 0.106
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.9861184
	speed: 0.2636s/iter; left time: 4415.3099s
	iters: 200, epoch: 20 | loss: 1.5238674
	speed: 0.0853s/iter; left time: 1419.7168s
Epoch: 20 cost time: 18.87549877166748
Epoch: 20, Steps: 208 | Train Loss: 1.568 Vali Loss: 4.077 Vali Acc: 0.102 Test Loss: 4.077 Test Acc: 0.102
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 1.4443991
	speed: 0.2817s/iter; left time: 4660.3363s
	iters: 200, epoch: 21 | loss: 0.9309503
	speed: 0.0882s/iter; left time: 1450.2275s
Epoch: 21 cost time: 18.585967779159546
Epoch: 21, Steps: 208 | Train Loss: 1.446 Vali Loss: 4.285 Vali Acc: 0.114 Test Loss: 4.285 Test Acc: 0.114
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 1.2586768
	speed: 0.2759s/iter; left time: 4506.7944s
	iters: 200, epoch: 22 | loss: 1.6164998
	speed: 0.0790s/iter; left time: 1282.0032s
Epoch: 22 cost time: 17.65834093093872
Epoch: 22, Steps: 208 | Train Loss: 1.341 Vali Loss: 4.282 Vali Acc: 0.108 Test Loss: 4.282 Test Acc: 0.108
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.9196066
	speed: 0.2863s/iter; left time: 4617.2849s
	iters: 200, epoch: 23 | loss: 1.1507905
	speed: 0.0901s/iter; left time: 1443.1279s
Epoch: 23 cost time: 20.2380154132843
Epoch: 23, Steps: 208 | Train Loss: 1.264 Vali Loss: 4.424 Vali Acc: 0.106 Test Loss: 4.424 Test Acc: 0.106
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.9807919
	speed: 0.2752s/iter; left time: 4380.4553s
	iters: 200, epoch: 24 | loss: 0.8522369
	speed: 0.0844s/iter; left time: 1334.6156s
Epoch: 24 cost time: 18.148964643478394
Epoch: 24, Steps: 208 | Train Loss: 1.177 Vali Loss: 4.592 Vali Acc: 0.119 Test Loss: 4.592 Test Acc: 0.119
Validation loss decreased (-0.114190 --> -0.118952).  Saving model ...
	iters: 100, epoch: 25 | loss: 1.0622139
	speed: 0.2672s/iter; left time: 4197.3226s
	iters: 200, epoch: 25 | loss: 1.4170549
	speed: 0.0752s/iter; left time: 1173.1988s
Epoch: 25 cost time: 17.008739709854126
Epoch: 25, Steps: 208 | Train Loss: 1.097 Vali Loss: 4.644 Vali Acc: 0.117 Test Loss: 4.644 Test Acc: 0.117
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.6943634
	speed: 0.2658s/iter; left time: 4119.7629s
	iters: 200, epoch: 26 | loss: 0.9792464
	speed: 0.0848s/iter; left time: 1305.3636s
Epoch: 26 cost time: 18.354477882385254
Epoch: 26, Steps: 208 | Train Loss: 1.023 Vali Loss: 4.685 Vali Acc: 0.117 Test Loss: 4.685 Test Acc: 0.117
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 1.1454124
	speed: 0.2687s/iter; left time: 4108.5062s
	iters: 200, epoch: 27 | loss: 0.9648006
	speed: 0.0826s/iter; left time: 1255.2207s
Epoch: 27 cost time: 17.747331857681274
Epoch: 27, Steps: 208 | Train Loss: 0.972 Vali Loss: 4.864 Vali Acc: 0.112 Test Loss: 4.864 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.6394098
	speed: 0.2794s/iter; left time: 4214.8889s
	iters: 200, epoch: 28 | loss: 0.8973150
	speed: 0.0822s/iter; left time: 1231.3213s
Epoch: 28 cost time: 18.57972478866577
Epoch: 28, Steps: 208 | Train Loss: 0.907 Vali Loss: 4.986 Vali Acc: 0.105 Test Loss: 4.986 Test Acc: 0.105
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.7036969
	speed: 0.2671s/iter; left time: 3973.1278s
	iters: 200, epoch: 29 | loss: 1.0221980
	speed: 0.0842s/iter; left time: 1243.8648s
Epoch: 29 cost time: 18.69783878326416
Epoch: 29, Steps: 208 | Train Loss: 0.873 Vali Loss: 5.095 Vali Acc: 0.114 Test Loss: 5.095 Test Acc: 0.114
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.5796987
	speed: 0.2847s/iter; left time: 4176.5533s
	iters: 200, epoch: 30 | loss: 0.7468273
	speed: 0.0907s/iter; left time: 1321.7917s
Epoch: 30 cost time: 18.887900352478027
Epoch: 30, Steps: 208 | Train Loss: 0.827 Vali Loss: 5.266 Vali Acc: 0.118 Test Loss: 5.266 Test Acc: 0.118
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.7858712
	speed: 0.2729s/iter; left time: 3946.1325s
	iters: 200, epoch: 31 | loss: 0.9934982
	speed: 0.0801s/iter; left time: 1150.4666s
Epoch: 31 cost time: 18.408342599868774
Epoch: 31, Steps: 208 | Train Loss: 0.783 Vali Loss: 5.211 Vali Acc: 0.115 Test Loss: 5.211 Test Acc: 0.115
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.8016440
	speed: 0.2879s/iter; left time: 4103.8765s
	iters: 200, epoch: 32 | loss: 1.1430287
	speed: 0.0907s/iter; left time: 1283.8209s
Epoch: 32 cost time: 19.605679750442505
Epoch: 32, Steps: 208 | Train Loss: 0.777 Vali Loss: 5.483 Vali Acc: 0.111 Test Loss: 5.483 Test Acc: 0.111
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 1.6785947
	speed: 0.2701s/iter; left time: 3793.0780s
	iters: 200, epoch: 33 | loss: 0.7273445
	speed: 0.0840s/iter; left time: 1171.6934s
Epoch: 33 cost time: 18.16783881187439
Epoch: 33, Steps: 208 | Train Loss: 0.719 Vali Loss: 5.478 Vali Acc: 0.106 Test Loss: 5.478 Test Acc: 0.106
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.3149675
	speed: 0.2510s/iter; left time: 3473.1689s
	iters: 200, epoch: 34 | loss: 0.6099615
	speed: 0.0831s/iter; left time: 1141.6479s
Epoch: 34 cost time: 17.652689456939697
Epoch: 34, Steps: 208 | Train Loss: 0.707 Vali Loss: 5.688 Vali Acc: 0.111 Test Loss: 5.688 Test Acc: 0.111
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11899791231732777
model parameter : 358339
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5362656
	speed: 0.1192s/iter; left time: 2466.9103s
	iters: 200, epoch: 1 | loss: 3.7909894
	speed: 0.0884s/iter; left time: 1821.9803s
Epoch: 1 cost time: 21.60847020149231
Epoch: 1, Steps: 208 | Train Loss: 3.652 Vali Loss: 3.524 Vali Acc: 0.059 Test Loss: 3.524 Test Acc: 0.059
Validation loss decreased (inf --> -0.058718).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2579412
	speed: 0.2629s/iter; left time: 5388.5327s
	iters: 200, epoch: 2 | loss: 3.5779691
	speed: 0.0841s/iter; left time: 1714.9372s
Epoch: 2 cost time: 17.773242950439453
Epoch: 2, Steps: 208 | Train Loss: 3.558 Vali Loss: 3.489 Vali Acc: 0.064 Test Loss: 3.489 Test Acc: 0.064
Validation loss decreased (-0.058718 --> -0.063490).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3903532
	speed: 0.2903s/iter; left time: 5887.9990s
	iters: 200, epoch: 3 | loss: 3.3487072
	speed: 0.0902s/iter; left time: 1819.8171s
Epoch: 3 cost time: 18.41716742515564
Epoch: 3, Steps: 208 | Train Loss: 3.491 Vali Loss: 3.499 Vali Acc: 0.070 Test Loss: 3.499 Test Acc: 0.070
Validation loss decreased (-0.063490 --> -0.070051).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2618597
	speed: 0.2955s/iter; left time: 5932.1154s
	iters: 200, epoch: 4 | loss: 3.6044242
	speed: 0.0887s/iter; left time: 1771.6619s
Epoch: 4 cost time: 19.50553059577942
Epoch: 4, Steps: 208 | Train Loss: 3.447 Vali Loss: 3.450 Vali Acc: 0.071 Test Loss: 3.450 Test Acc: 0.071
Validation loss decreased (-0.070051 --> -0.070947).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.7063770
	speed: 0.2802s/iter; left time: 5568.1236s
	iters: 200, epoch: 5 | loss: 3.4817128
	speed: 0.0891s/iter; left time: 1761.2868s
Epoch: 5 cost time: 19.04505705833435
Epoch: 5, Steps: 208 | Train Loss: 3.394 Vali Loss: 3.457 Vali Acc: 0.078 Test Loss: 3.457 Test Acc: 0.078
Validation loss decreased (-0.070947 --> -0.077806).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2868662
	speed: 0.2702s/iter; left time: 5312.9312s
	iters: 200, epoch: 6 | loss: 3.3981588
	speed: 0.0796s/iter; left time: 1556.5807s
Epoch: 6 cost time: 17.496962547302246
Epoch: 6, Steps: 208 | Train Loss: 3.340 Vali Loss: 3.450 Vali Acc: 0.071 Test Loss: 3.450 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.4598238
	speed: 0.2665s/iter; left time: 5185.1427s
	iters: 200, epoch: 7 | loss: 3.5669017
	speed: 0.0776s/iter; left time: 1500.9227s
Epoch: 7 cost time: 16.801956176757812
Epoch: 7, Steps: 208 | Train Loss: 3.259 Vali Loss: 3.404 Vali Acc: 0.076 Test Loss: 3.404 Test Acc: 0.076
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.8796744
	speed: 0.2581s/iter; left time: 4966.7550s
	iters: 200, epoch: 8 | loss: 3.4034891
	speed: 0.0884s/iter; left time: 1693.1256s
Epoch: 8 cost time: 18.137255907058716
Epoch: 8, Steps: 208 | Train Loss: 3.142 Vali Loss: 3.298 Vali Acc: 0.089 Test Loss: 3.298 Test Acc: 0.089
Validation loss decreased (-0.077806 --> -0.089141).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.2314253
	speed: 0.2682s/iter; left time: 5106.0588s
	iters: 200, epoch: 9 | loss: 3.0744455
	speed: 0.0801s/iter; left time: 1516.1174s
Epoch: 9 cost time: 17.187809228897095
Epoch: 9, Steps: 208 | Train Loss: 3.016 Vali Loss: 3.314 Vali Acc: 0.089 Test Loss: 3.314 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.8526621
	speed: 0.2700s/iter; left time: 5083.7500s
	iters: 200, epoch: 10 | loss: 2.6962645
	speed: 0.0800s/iter; left time: 1497.5661s
Epoch: 10 cost time: 18.327480792999268
Epoch: 10, Steps: 208 | Train Loss: 2.899 Vali Loss: 3.350 Vali Acc: 0.104 Test Loss: 3.350 Test Acc: 0.104
Validation loss decreased (-0.089141 --> -0.104351).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.7081628
	speed: 0.2972s/iter; left time: 5533.2837s
	iters: 200, epoch: 11 | loss: 2.2552309
	speed: 0.1092s/iter; left time: 2022.8345s
Epoch: 11 cost time: 22.194299936294556
Epoch: 11, Steps: 208 | Train Loss: 2.780 Vali Loss: 3.307 Vali Acc: 0.107 Test Loss: 3.307 Test Acc: 0.107
Validation loss decreased (-0.104351 --> -0.107333).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.5501125
	speed: 0.2837s/iter; left time: 5223.2779s
	iters: 200, epoch: 12 | loss: 3.3320055
	speed: 0.0777s/iter; left time: 1422.5514s
Epoch: 12 cost time: 17.04778242111206
Epoch: 12, Steps: 208 | Train Loss: 2.661 Vali Loss: 3.281 Vali Acc: 0.111 Test Loss: 3.281 Test Acc: 0.111
Validation loss decreased (-0.107333 --> -0.110614).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.4960868
	speed: 0.2706s/iter; left time: 4927.0995s
	iters: 200, epoch: 13 | loss: 2.6345050
	speed: 0.0859s/iter; left time: 1555.5145s
Epoch: 13 cost time: 17.912461042404175
Epoch: 13, Steps: 208 | Train Loss: 2.544 Vali Loss: 3.328 Vali Acc: 0.122 Test Loss: 3.328 Test Acc: 0.122
Validation loss decreased (-0.110614 --> -0.121649).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.6522946
	speed: 0.2572s/iter; left time: 4629.0760s
	iters: 200, epoch: 14 | loss: 2.8099914
	speed: 0.0841s/iter; left time: 1505.3465s
Epoch: 14 cost time: 18.30270528793335
Epoch: 14, Steps: 208 | Train Loss: 2.384 Vali Loss: 3.385 Vali Acc: 0.118 Test Loss: 3.385 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.9762508
	speed: 0.2588s/iter; left time: 4603.1055s
	iters: 200, epoch: 15 | loss: 2.5311480
	speed: 0.0804s/iter; left time: 1422.4079s
Epoch: 15 cost time: 17.2840576171875
Epoch: 15, Steps: 208 | Train Loss: 2.279 Vali Loss: 3.538 Vali Acc: 0.114 Test Loss: 3.538 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 2.8873644
	speed: 0.2656s/iter; left time: 4669.9182s
	iters: 200, epoch: 16 | loss: 2.4443886
	speed: 0.0874s/iter; left time: 1528.2830s
Epoch: 16 cost time: 18.49680185317993
Epoch: 16, Steps: 208 | Train Loss: 2.147 Vali Loss: 3.504 Vali Acc: 0.120 Test Loss: 3.504 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 2.5685937
	speed: 0.2742s/iter; left time: 4764.2699s
	iters: 200, epoch: 17 | loss: 1.8953378
	speed: 0.0777s/iter; left time: 1341.7925s
Epoch: 17 cost time: 17.46923041343689
Epoch: 17, Steps: 208 | Train Loss: 2.016 Vali Loss: 3.636 Vali Acc: 0.111 Test Loss: 3.636 Test Acc: 0.111
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.6659918
	speed: 0.2534s/iter; left time: 4349.1628s
	iters: 200, epoch: 18 | loss: 2.1786287
	speed: 0.0822s/iter; left time: 1402.3756s
Epoch: 18 cost time: 17.650593042373657
Epoch: 18, Steps: 208 | Train Loss: 1.896 Vali Loss: 3.716 Vali Acc: 0.125 Test Loss: 3.716 Test Acc: 0.125
Validation loss decreased (-0.121649 --> -0.124926).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.6478920
	speed: 0.2717s/iter; left time: 4607.8563s
	iters: 200, epoch: 19 | loss: 1.5655676
	speed: 0.0834s/iter; left time: 1405.8479s
Epoch: 19 cost time: 17.879708528518677
Epoch: 19, Steps: 208 | Train Loss: 1.776 Vali Loss: 3.784 Vali Acc: 0.118 Test Loss: 3.784 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.7438363
	speed: 0.2715s/iter; left time: 4546.6296s
	iters: 200, epoch: 20 | loss: 1.9505081
	speed: 0.0737s/iter; left time: 1227.0287s
Epoch: 20 cost time: 17.082412481307983
Epoch: 20, Steps: 208 | Train Loss: 1.684 Vali Loss: 3.902 Vali Acc: 0.124 Test Loss: 3.902 Test Acc: 0.124
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.7630758
	speed: 0.2624s/iter; left time: 4340.5290s
	iters: 200, epoch: 21 | loss: 1.8224941
	speed: 0.0909s/iter; left time: 1493.9859s
Epoch: 21 cost time: 18.700255632400513
Epoch: 21, Steps: 208 | Train Loss: 1.557 Vali Loss: 3.991 Vali Acc: 0.129 Test Loss: 3.991 Test Acc: 0.129
Validation loss decreased (-0.124926 --> -0.129098).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.7324538
	speed: 0.2760s/iter; left time: 4507.3933s
	iters: 200, epoch: 22 | loss: 1.6468091
	speed: 0.0894s/iter; left time: 1451.4337s
Epoch: 22 cost time: 18.61141014099121
Epoch: 22, Steps: 208 | Train Loss: 1.461 Vali Loss: 4.144 Vali Acc: 0.115 Test Loss: 4.144 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.5543952
	speed: 0.2651s/iter; left time: 4274.8440s
	iters: 200, epoch: 23 | loss: 1.4340932
	speed: 0.0850s/iter; left time: 1362.3546s
Epoch: 23 cost time: 17.574100494384766
Epoch: 23, Steps: 208 | Train Loss: 1.347 Vali Loss: 4.134 Vali Acc: 0.116 Test Loss: 4.134 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.9066859
	speed: 0.2677s/iter; left time: 4261.1473s
	iters: 200, epoch: 24 | loss: 1.1827540
	speed: 0.0787s/iter; left time: 1244.2973s
Epoch: 24 cost time: 17.28603768348694
Epoch: 24, Steps: 208 | Train Loss: 1.213 Vali Loss: 4.450 Vali Acc: 0.121 Test Loss: 4.450 Test Acc: 0.121
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 1.1221057
	speed: 0.2670s/iter; left time: 4194.2486s
	iters: 200, epoch: 25 | loss: 1.5098580
	speed: 0.0819s/iter; left time: 1278.7424s
Epoch: 25 cost time: 17.77597665786743
Epoch: 25, Steps: 208 | Train Loss: 1.165 Vali Loss: 4.488 Vali Acc: 0.134 Test Loss: 4.488 Test Acc: 0.134
Validation loss decreased (-0.129098 --> -0.134163).  Saving model ...
	iters: 100, epoch: 26 | loss: 1.4895923
	speed: 0.2557s/iter; left time: 3963.5566s
	iters: 200, epoch: 26 | loss: 1.1175044
	speed: 0.0777s/iter; left time: 1195.8981s
Epoch: 26 cost time: 16.53001046180725
Epoch: 26, Steps: 208 | Train Loss: 1.045 Vali Loss: 4.792 Vali Acc: 0.123 Test Loss: 4.792 Test Acc: 0.123
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 1.0335810
	speed: 0.2681s/iter; left time: 4100.1052s
	iters: 200, epoch: 27 | loss: 1.2888974
	speed: 0.0871s/iter; left time: 1323.9955s
Epoch: 27 cost time: 18.318772077560425
Epoch: 27, Steps: 208 | Train Loss: 1.042 Vali Loss: 4.712 Vali Acc: 0.129 Test Loss: 4.712 Test Acc: 0.129
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 1.4580923
	speed: 0.3028s/iter; left time: 4567.7681s
	iters: 200, epoch: 28 | loss: 1.3713187
	speed: 0.0913s/iter; left time: 1368.8625s
Epoch: 28 cost time: 21.07910656929016
Epoch: 28, Steps: 208 | Train Loss: 0.979 Vali Loss: 4.880 Vali Acc: 0.114 Test Loss: 4.880 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 1.3581853
	speed: 0.2845s/iter; left time: 4231.7841s
	iters: 200, epoch: 29 | loss: 0.5563268
	speed: 0.0933s/iter; left time: 1378.9282s
Epoch: 29 cost time: 19.286869049072266
Epoch: 29, Steps: 208 | Train Loss: 0.934 Vali Loss: 4.921 Vali Acc: 0.118 Test Loss: 4.921 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.8389858
	speed: 0.3039s/iter; left time: 4457.5048s
	iters: 200, epoch: 30 | loss: 1.0387573
	speed: 0.0838s/iter; left time: 1220.3465s
Epoch: 30 cost time: 18.618788480758667
Epoch: 30, Steps: 208 | Train Loss: 0.847 Vali Loss: 5.011 Vali Acc: 0.125 Test Loss: 5.011 Test Acc: 0.125
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.9586602
	speed: 0.2684s/iter; left time: 3880.7595s
	iters: 200, epoch: 31 | loss: 1.2138619
	speed: 0.0946s/iter; left time: 1359.0994s
Epoch: 31 cost time: 19.097392559051514
Epoch: 31, Steps: 208 | Train Loss: 0.836 Vali Loss: 5.263 Vali Acc: 0.124 Test Loss: 5.263 Test Acc: 0.124
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 1.2782032
	speed: 0.2712s/iter; left time: 3865.3259s
	iters: 200, epoch: 32 | loss: 0.6686004
	speed: 0.0817s/iter; left time: 1155.8493s
Epoch: 32 cost time: 18.335261821746826
Epoch: 32, Steps: 208 | Train Loss: 0.815 Vali Loss: 5.365 Vali Acc: 0.119 Test Loss: 5.365 Test Acc: 0.119
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.7333599
	speed: 0.2930s/iter; left time: 4114.8547s
	iters: 200, epoch: 33 | loss: 0.9653268
	speed: 0.0806s/iter; left time: 1123.5358s
Epoch: 33 cost time: 17.832838773727417
Epoch: 33, Steps: 208 | Train Loss: 0.758 Vali Loss: 5.410 Vali Acc: 0.121 Test Loss: 5.410 Test Acc: 0.121
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.4973215
	speed: 0.2624s/iter; left time: 3631.4837s
	iters: 200, epoch: 34 | loss: 0.9626164
	speed: 0.0854s/iter; left time: 1173.7310s
Epoch: 34 cost time: 18.552090406417847
Epoch: 34, Steps: 208 | Train Loss: 0.756 Vali Loss: 5.578 Vali Acc: 0.110 Test Loss: 5.578 Test Acc: 0.110
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.9513485
	speed: 0.2953s/iter; left time: 4024.9657s
	iters: 200, epoch: 35 | loss: 0.9106433
	speed: 0.0922s/iter; left time: 1247.2332s
Epoch: 35 cost time: 19.49954056739807
Epoch: 35, Steps: 208 | Train Loss: 0.718 Vali Loss: 5.537 Vali Acc: 0.121 Test Loss: 5.537 Test Acc: 0.121
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13420817178645988
model parameter : 357155
model size : 2.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7117119
	speed: 0.1050s/iter; left time: 2173.7687s
	iters: 200, epoch: 1 | loss: 3.8387125
	speed: 0.0871s/iter; left time: 1794.2602s
Epoch: 1 cost time: 20.02661919593811
Epoch: 1, Steps: 208 | Train Loss: 3.654 Vali Loss: 3.534 Vali Acc: 0.064 Test Loss: 3.534 Test Acc: 0.064
Validation loss decreased (inf --> -0.064385).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4514384
	speed: 0.2853s/iter; left time: 5847.0882s
	iters: 200, epoch: 2 | loss: 3.5172539
	speed: 0.0763s/iter; left time: 1555.5115s
Epoch: 2 cost time: 17.441255569458008
Epoch: 2, Steps: 208 | Train Loss: 3.540 Vali Loss: 3.481 Vali Acc: 0.064 Test Loss: 3.481 Test Acc: 0.064
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.2942655
	speed: 0.2580s/iter; left time: 5233.9212s
	iters: 200, epoch: 3 | loss: 3.3699694
	speed: 0.0844s/iter; left time: 1703.7965s
Epoch: 3 cost time: 17.46124291419983
Epoch: 3, Steps: 208 | Train Loss: 3.479 Vali Loss: 3.499 Vali Acc: 0.067 Test Loss: 3.499 Test Acc: 0.067
Validation loss decreased (-0.064385 --> -0.066473).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2742121
	speed: 0.2679s/iter; left time: 5379.1707s
	iters: 200, epoch: 4 | loss: 3.4203920
	speed: 0.1009s/iter; left time: 2016.0875s
Epoch: 4 cost time: 20.313640594482422
Epoch: 4, Steps: 208 | Train Loss: 3.431 Vali Loss: 3.442 Vali Acc: 0.071 Test Loss: 3.442 Test Acc: 0.071
Validation loss decreased (-0.066473 --> -0.070649).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2931917
	speed: 0.2783s/iter; left time: 5529.5040s
	iters: 200, epoch: 5 | loss: 3.3874283
	speed: 0.0872s/iter; left time: 1723.6938s
Epoch: 5 cost time: 18.22388005256653
Epoch: 5, Steps: 208 | Train Loss: 3.380 Vali Loss: 3.467 Vali Acc: 0.083 Test Loss: 3.467 Test Acc: 0.083
Validation loss decreased (-0.070649 --> -0.082876).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2626579
	speed: 0.2652s/iter; left time: 5214.4719s
	iters: 200, epoch: 6 | loss: 3.2945154
	speed: 0.0757s/iter; left time: 1480.2511s
Epoch: 6 cost time: 16.95755386352539
Epoch: 6, Steps: 208 | Train Loss: 3.326 Vali Loss: 3.421 Vali Acc: 0.076 Test Loss: 3.421 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.2663164
	speed: 0.2644s/iter; left time: 5142.8936s
	iters: 200, epoch: 7 | loss: 3.2508898
	speed: 0.0939s/iter; left time: 1816.5165s
Epoch: 7 cost time: 19.549694061279297
Epoch: 7, Steps: 208 | Train Loss: 3.249 Vali Loss: 3.407 Vali Acc: 0.075 Test Loss: 3.407 Test Acc: 0.075
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.4247468
	speed: 0.2792s/iter; left time: 5372.2452s
	iters: 200, epoch: 8 | loss: 3.2856162
	speed: 0.0785s/iter; left time: 1502.9051s
Epoch: 8 cost time: 18.16858744621277
Epoch: 8, Steps: 208 | Train Loss: 3.119 Vali Loss: 3.352 Vali Acc: 0.082 Test Loss: 3.352 Test Acc: 0.082
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 3.2364917
	speed: 0.2797s/iter; left time: 5324.5844s
	iters: 200, epoch: 9 | loss: 3.2174695
	speed: 0.0883s/iter; left time: 1671.2068s
Epoch: 9 cost time: 18.31036114692688
Epoch: 9, Steps: 208 | Train Loss: 2.989 Vali Loss: 3.273 Vali Acc: 0.111 Test Loss: 3.273 Test Acc: 0.111
Validation loss decreased (-0.082876 --> -0.110913).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.9254262
	speed: 0.2717s/iter; left time: 5115.0962s
	iters: 200, epoch: 10 | loss: 2.7391520
	speed: 0.0828s/iter; left time: 1550.9787s
Epoch: 10 cost time: 17.779974460601807
Epoch: 10, Steps: 208 | Train Loss: 2.879 Vali Loss: 3.352 Vali Acc: 0.095 Test Loss: 3.352 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.4422677
	speed: 0.2633s/iter; left time: 4902.0143s
	iters: 200, epoch: 11 | loss: 2.6129558
	speed: 0.0753s/iter; left time: 1395.5198s
Epoch: 11 cost time: 17.454554080963135
Epoch: 11, Steps: 208 | Train Loss: 2.764 Vali Loss: 3.285 Vali Acc: 0.108 Test Loss: 3.285 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 2.8808229
	speed: 0.2405s/iter; left time: 4427.7638s
	iters: 200, epoch: 12 | loss: 2.9161026
	speed: 0.0877s/iter; left time: 1605.2329s
Epoch: 12 cost time: 17.78230619430542
Epoch: 12, Steps: 208 | Train Loss: 2.654 Vali Loss: 3.293 Vali Acc: 0.116 Test Loss: 3.293 Test Acc: 0.116
Validation loss decreased (-0.110913 --> -0.116281).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.4758985
	speed: 0.2678s/iter; left time: 4874.4314s
	iters: 200, epoch: 13 | loss: 2.8888133
	speed: 0.0841s/iter; left time: 1522.3343s
Epoch: 13 cost time: 17.657727479934692
Epoch: 13, Steps: 208 | Train Loss: 2.515 Vali Loss: 3.361 Vali Acc: 0.112 Test Loss: 3.361 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 2.2219849
	speed: 0.2639s/iter; left time: 4749.0951s
	iters: 200, epoch: 14 | loss: 2.2967515
	speed: 0.0856s/iter; left time: 1532.3326s
Epoch: 14 cost time: 18.864847898483276
Epoch: 14, Steps: 208 | Train Loss: 2.389 Vali Loss: 3.416 Vali Acc: 0.118 Test Loss: 3.416 Test Acc: 0.118
Validation loss decreased (-0.116281 --> -0.118069).  Saving model ...
	iters: 100, epoch: 15 | loss: 2.7238920
	speed: 0.2639s/iter; left time: 4694.0063s
	iters: 200, epoch: 15 | loss: 2.0727055
	speed: 0.0856s/iter; left time: 1514.9999s
Epoch: 15 cost time: 18.307602643966675
Epoch: 15, Steps: 208 | Train Loss: 2.270 Vali Loss: 3.421 Vali Acc: 0.127 Test Loss: 3.421 Test Acc: 0.127
Validation loss decreased (-0.118069 --> -0.127016).  Saving model ...
	iters: 100, epoch: 16 | loss: 2.3373892
	speed: 0.2921s/iter; left time: 5135.5888s
	iters: 200, epoch: 16 | loss: 2.2821560
	speed: 0.0979s/iter; left time: 1711.7820s
Epoch: 16 cost time: 19.895713329315186
Epoch: 16, Steps: 208 | Train Loss: 2.151 Vali Loss: 3.573 Vali Acc: 0.132 Test Loss: 3.573 Test Acc: 0.132
Validation loss decreased (-0.127016 --> -0.131488).  Saving model ...
	iters: 100, epoch: 17 | loss: 2.5350666
	speed: 0.2818s/iter; left time: 4895.3410s
	iters: 200, epoch: 17 | loss: 1.9682055
	speed: 0.0885s/iter; left time: 1528.4270s
Epoch: 17 cost time: 19.33185863494873
Epoch: 17, Steps: 208 | Train Loss: 2.008 Vali Loss: 3.660 Vali Acc: 0.121 Test Loss: 3.660 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 2.3625717
	speed: 0.2751s/iter; left time: 4722.1312s
	iters: 200, epoch: 18 | loss: 1.9630215
	speed: 0.0813s/iter; left time: 1386.9279s
Epoch: 18 cost time: 17.57545495033264
Epoch: 18, Steps: 208 | Train Loss: 1.878 Vali Loss: 3.805 Vali Acc: 0.112 Test Loss: 3.805 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.1936337
	speed: 0.2655s/iter; left time: 4502.4823s
	iters: 200, epoch: 19 | loss: 1.3556939
	speed: 0.0845s/iter; left time: 1424.2919s
Epoch: 19 cost time: 18.382917881011963
Epoch: 19, Steps: 208 | Train Loss: 1.748 Vali Loss: 3.782 Vali Acc: 0.115 Test Loss: 3.782 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.6586781
	speed: 0.2643s/iter; left time: 4426.5374s
	iters: 200, epoch: 20 | loss: 1.6613171
	speed: 0.0797s/iter; left time: 1326.8957s
Epoch: 20 cost time: 18.025354862213135
Epoch: 20, Steps: 208 | Train Loss: 1.626 Vali Loss: 3.914 Vali Acc: 0.119 Test Loss: 3.914 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 1.4023069
	speed: 0.2495s/iter; left time: 4127.2308s
	iters: 200, epoch: 21 | loss: 1.5720932
	speed: 0.0824s/iter; left time: 1354.3050s
Epoch: 21 cost time: 17.406266927719116
Epoch: 21, Steps: 208 | Train Loss: 1.543 Vali Loss: 4.075 Vali Acc: 0.117 Test Loss: 4.075 Test Acc: 0.117
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 1.6577696
	speed: 0.2627s/iter; left time: 4291.3081s
	iters: 200, epoch: 22 | loss: 1.6283823
	speed: 0.0813s/iter; left time: 1320.0056s
Epoch: 22 cost time: 17.03442621231079
Epoch: 22, Steps: 208 | Train Loss: 1.411 Vali Loss: 4.115 Vali Acc: 0.124 Test Loss: 4.115 Test Acc: 0.124
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 1.8757998
	speed: 0.2842s/iter; left time: 4583.1731s
	iters: 200, epoch: 23 | loss: 1.9867320
	speed: 0.0900s/iter; left time: 1443.0376s
Epoch: 23 cost time: 19.36415982246399
Epoch: 23, Steps: 208 | Train Loss: 1.337 Vali Loss: 4.263 Vali Acc: 0.124 Test Loss: 4.263 Test Acc: 0.124
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 1.4073676
	speed: 0.2614s/iter; left time: 4160.6031s
	iters: 200, epoch: 24 | loss: 1.2174476
	speed: 0.0874s/iter; left time: 1382.9078s
Epoch: 24 cost time: 17.974395990371704
Epoch: 24, Steps: 208 | Train Loss: 1.215 Vali Loss: 4.386 Vali Acc: 0.126 Test Loss: 4.386 Test Acc: 0.126
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 1.3194454
	speed: 0.2751s/iter; left time: 4321.5771s
	iters: 200, epoch: 25 | loss: 1.3897707
	speed: 0.0828s/iter; left time: 1292.3223s
Epoch: 25 cost time: 17.898587465286255
Epoch: 25, Steps: 208 | Train Loss: 1.138 Vali Loss: 4.649 Vali Acc: 0.116 Test Loss: 4.649 Test Acc: 0.116
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 1.0743477
	speed: 0.2826s/iter; left time: 4379.9184s
	iters: 200, epoch: 26 | loss: 1.3926519
	speed: 0.0851s/iter; left time: 1310.8752s
Epoch: 26 cost time: 18.23639941215515
Epoch: 26, Steps: 208 | Train Loss: 1.098 Vali Loss: 4.575 Vali Acc: 0.118 Test Loss: 4.575 Test Acc: 0.118
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1315240083507307
model parameter : 285827
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6745372
	speed: 0.1049s/iter; left time: 2170.6570s
	iters: 200, epoch: 1 | loss: 3.5253937
	speed: 0.0834s/iter; left time: 1718.2487s
Epoch: 1 cost time: 19.62342405319214
Epoch: 1, Steps: 208 | Train Loss: 3.691 Vali Loss: 3.564 Vali Acc: 0.048 Test Loss: 3.564 Test Acc: 0.048
Validation loss decreased (inf --> -0.047981).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4677157
	speed: 0.2743s/iter; left time: 5621.9300s
	iters: 200, epoch: 2 | loss: 3.4722514
	speed: 0.0861s/iter; left time: 1755.1249s
Epoch: 2 cost time: 18.563021659851074
Epoch: 2, Steps: 208 | Train Loss: 3.573 Vali Loss: 3.539 Vali Acc: 0.061 Test Loss: 3.539 Test Acc: 0.061
Validation loss decreased (-0.047981 --> -0.061402).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5894144
	speed: 0.2626s/iter; left time: 5326.4119s
	iters: 200, epoch: 3 | loss: 3.0802982
	speed: 0.0844s/iter; left time: 1702.9700s
Epoch: 3 cost time: 18.04596495628357
Epoch: 3, Steps: 208 | Train Loss: 3.494 Vali Loss: 3.491 Vali Acc: 0.078 Test Loss: 3.491 Test Acc: 0.078
Validation loss decreased (-0.061402 --> -0.077508).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.7127671
	speed: 0.2794s/iter; left time: 5609.0744s
	iters: 200, epoch: 4 | loss: 3.0394597
	speed: 0.0863s/iter; left time: 1723.5383s
Epoch: 4 cost time: 18.03326153755188
Epoch: 4, Steps: 208 | Train Loss: 3.423 Vali Loss: 3.518 Vali Acc: 0.070 Test Loss: 3.518 Test Acc: 0.070
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.2838576
	speed: 0.2853s/iter; left time: 5667.9110s
	iters: 200, epoch: 5 | loss: 3.5062225
	speed: 0.0805s/iter; left time: 1592.1237s
Epoch: 5 cost time: 17.801926374435425
Epoch: 5, Steps: 208 | Train Loss: 3.352 Vali Loss: 3.441 Vali Acc: 0.073 Test Loss: 3.441 Test Acc: 0.073
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 3.2006457
	speed: 0.2755s/iter; left time: 5415.6344s
	iters: 200, epoch: 6 | loss: 3.0936587
	speed: 0.0903s/iter; left time: 1766.1120s
Epoch: 6 cost time: 20.26089596748352
Epoch: 6, Steps: 208 | Train Loss: 3.286 Vali Loss: 3.451 Vali Acc: 0.068 Test Loss: 3.451 Test Acc: 0.068
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 3.6595464
	speed: 0.3139s/iter; left time: 6105.3845s
	iters: 200, epoch: 7 | loss: 3.0335314
	speed: 0.0942s/iter; left time: 1823.4097s
Epoch: 7 cost time: 20.8881094455719
Epoch: 7, Steps: 208 | Train Loss: 3.191 Vali Loss: 3.468 Vali Acc: 0.081 Test Loss: 3.468 Test Acc: 0.081
Validation loss decreased (-0.077508 --> -0.080788).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.1307201
	speed: 0.2758s/iter; left time: 5307.2559s
	iters: 200, epoch: 8 | loss: 3.3790739
	speed: 0.0877s/iter; left time: 1678.9140s
Epoch: 8 cost time: 18.80297613143921
Epoch: 8, Steps: 208 | Train Loss: 3.092 Vali Loss: 3.386 Vali Acc: 0.083 Test Loss: 3.386 Test Acc: 0.083
Validation loss decreased (-0.080788 --> -0.082877).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.8428090
	speed: 0.3034s/iter; left time: 5776.6454s
	iters: 200, epoch: 9 | loss: 2.8231823
	speed: 0.0925s/iter; left time: 1751.2892s
Epoch: 9 cost time: 19.267099380493164
Epoch: 9, Steps: 208 | Train Loss: 2.962 Vali Loss: 3.385 Vali Acc: 0.093 Test Loss: 3.385 Test Acc: 0.093
Validation loss decreased (-0.082877 --> -0.093315).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.9482813
	speed: 0.3015s/iter; left time: 5676.6113s
	iters: 200, epoch: 10 | loss: 2.9731338
	speed: 0.0850s/iter; left time: 1592.5204s
Epoch: 10 cost time: 19.208314895629883
Epoch: 10, Steps: 208 | Train Loss: 2.837 Vali Loss: 3.367 Vali Acc: 0.105 Test Loss: 3.367 Test Acc: 0.105
Validation loss decreased (-0.093315 --> -0.104649).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.5764637
	speed: 0.2569s/iter; left time: 4783.5454s
	iters: 200, epoch: 11 | loss: 2.5206094
	speed: 0.0820s/iter; left time: 1518.3970s
Epoch: 11 cost time: 17.861343145370483
Epoch: 11, Steps: 208 | Train Loss: 2.744 Vali Loss: 3.369 Vali Acc: 0.097 Test Loss: 3.369 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.3609915
	speed: 0.2875s/iter; left time: 5294.0478s
	iters: 200, epoch: 12 | loss: 2.4977193
	speed: 0.0913s/iter; left time: 1672.4574s
Epoch: 12 cost time: 20.391672611236572
Epoch: 12, Steps: 208 | Train Loss: 2.594 Vali Loss: 3.420 Vali Acc: 0.104 Test Loss: 3.420 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 2.6075511
	speed: 0.2796s/iter; left time: 5090.1300s
	iters: 200, epoch: 13 | loss: 2.7774062
	speed: 0.0862s/iter; left time: 1560.2108s
Epoch: 13 cost time: 17.81756830215454
Epoch: 13, Steps: 208 | Train Loss: 2.472 Vali Loss: 3.456 Vali Acc: 0.104 Test Loss: 3.456 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 2.9767663
	speed: 0.2762s/iter; left time: 4970.8143s
	iters: 200, epoch: 14 | loss: 2.7423210
	speed: 0.0898s/iter; left time: 1607.2351s
Epoch: 14 cost time: 18.62646174430847
Epoch: 14, Steps: 208 | Train Loss: 2.325 Vali Loss: 3.501 Vali Acc: 0.104 Test Loss: 3.501 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.7395804
	speed: 0.3008s/iter; left time: 5350.1613s
	iters: 200, epoch: 15 | loss: 1.8464783
	speed: 0.0897s/iter; left time: 1586.8064s
Epoch: 15 cost time: 19.86973285675049
Epoch: 15, Steps: 208 | Train Loss: 2.206 Vali Loss: 3.545 Vali Acc: 0.105 Test Loss: 3.545 Test Acc: 0.105
Validation loss decreased (-0.104649 --> -0.105243).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.9959035
	speed: 0.2608s/iter; left time: 4585.2433s
	iters: 200, epoch: 16 | loss: 1.8219018
	speed: 0.0806s/iter; left time: 1409.1361s
Epoch: 16 cost time: 17.366699934005737
Epoch: 16, Steps: 208 | Train Loss: 2.050 Vali Loss: 3.732 Vali Acc: 0.108 Test Loss: 3.732 Test Acc: 0.108
Validation loss decreased (-0.105243 --> -0.107627).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.7308509
	speed: 0.2743s/iter; left time: 4765.6684s
	iters: 200, epoch: 17 | loss: 2.0432997
	speed: 0.0815s/iter; left time: 1407.7643s
Epoch: 17 cost time: 18.022807836532593
Epoch: 17, Steps: 208 | Train Loss: 1.908 Vali Loss: 3.747 Vali Acc: 0.105 Test Loss: 3.747 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 2.1789913
	speed: 0.2770s/iter; left time: 4754.1732s
	iters: 200, epoch: 18 | loss: 2.1204731
	speed: 0.0804s/iter; left time: 1371.8079s
Epoch: 18 cost time: 17.556981086730957
Epoch: 18, Steps: 208 | Train Loss: 1.736 Vali Loss: 3.891 Vali Acc: 0.110 Test Loss: 3.891 Test Acc: 0.110
Validation loss decreased (-0.107627 --> -0.110012).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.4397138
	speed: 0.2725s/iter; left time: 4620.5509s
	iters: 200, epoch: 19 | loss: 1.6572073
	speed: 0.0732s/iter; left time: 1233.5460s
Epoch: 19 cost time: 17.37934374809265
Epoch: 19, Steps: 208 | Train Loss: 1.625 Vali Loss: 4.012 Vali Acc: 0.110 Test Loss: 4.012 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.9419657
	speed: 0.2835s/iter; left time: 4748.9138s
	iters: 200, epoch: 20 | loss: 1.8508015
	speed: 0.0940s/iter; left time: 1565.5632s
Epoch: 20 cost time: 19.93868613243103
Epoch: 20, Steps: 208 | Train Loss: 1.519 Vali Loss: 4.165 Vali Acc: 0.111 Test Loss: 4.165 Test Acc: 0.111
Validation loss decreased (-0.110012 --> -0.111202).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.4917425
	speed: 0.2838s/iter; left time: 4695.0554s
	iters: 200, epoch: 21 | loss: 1.6015661
	speed: 0.0859s/iter; left time: 1412.8372s
Epoch: 21 cost time: 18.20055079460144
Epoch: 21, Steps: 208 | Train Loss: 1.398 Vali Loss: 4.239 Vali Acc: 0.104 Test Loss: 4.239 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.3376753
	speed: 0.2838s/iter; left time: 4635.9969s
	iters: 200, epoch: 22 | loss: 1.6578200
	speed: 0.0897s/iter; left time: 1456.4885s
Epoch: 22 cost time: 18.39397406578064
Epoch: 22, Steps: 208 | Train Loss: 1.301 Vali Loss: 4.444 Vali Acc: 0.113 Test Loss: 4.444 Test Acc: 0.113
Validation loss decreased (-0.111202 --> -0.112989).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.3860390
	speed: 0.2905s/iter; left time: 4683.6171s
	iters: 200, epoch: 23 | loss: 1.1324111
	speed: 0.0878s/iter; left time: 1407.5385s
Epoch: 23 cost time: 18.922751426696777
Epoch: 23, Steps: 208 | Train Loss: 1.225 Vali Loss: 4.522 Vali Acc: 0.108 Test Loss: 4.522 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 1.1518983
	speed: 0.2629s/iter; left time: 4183.9127s
	iters: 200, epoch: 24 | loss: 1.6173698
	speed: 0.0771s/iter; left time: 1219.7349s
Epoch: 24 cost time: 16.711271286010742
Epoch: 24, Steps: 208 | Train Loss: 1.127 Vali Loss: 4.696 Vali Acc: 0.099 Test Loss: 4.696 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 1.2865686
	speed: 0.2564s/iter; left time: 4027.1365s
	iters: 200, epoch: 25 | loss: 1.4555836
	speed: 0.0764s/iter; left time: 1192.4664s
Epoch: 25 cost time: 17.060800313949585
Epoch: 25, Steps: 208 | Train Loss: 1.040 Vali Loss: 4.853 Vali Acc: 0.103 Test Loss: 4.853 Test Acc: 0.103
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 1.0033630
	speed: 0.2809s/iter; left time: 4353.9119s
	iters: 200, epoch: 26 | loss: 1.6399404
	speed: 0.0860s/iter; left time: 1323.8234s
Epoch: 26 cost time: 18.686119318008423
Epoch: 26, Steps: 208 | Train Loss: 0.972 Vali Loss: 4.862 Vali Acc: 0.106 Test Loss: 4.862 Test Acc: 0.106
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.9768807
	speed: 0.2341s/iter; left time: 3580.0908s
	iters: 200, epoch: 27 | loss: 0.7441455
	speed: 0.0826s/iter; left time: 1254.4390s
Epoch: 27 cost time: 17.253581047058105
Epoch: 27, Steps: 208 | Train Loss: 0.913 Vali Loss: 5.040 Vali Acc: 0.105 Test Loss: 5.040 Test Acc: 0.105
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.7867315
	speed: 0.2606s/iter; left time: 3931.6886s
	iters: 200, epoch: 28 | loss: 1.1369038
	speed: 0.0891s/iter; left time: 1335.4864s
Epoch: 28 cost time: 18.63484263420105
Epoch: 28, Steps: 208 | Train Loss: 0.912 Vali Loss: 5.137 Vali Acc: 0.098 Test Loss: 5.137 Test Acc: 0.098
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.9582105
	speed: 0.2830s/iter; left time: 4210.3335s
	iters: 200, epoch: 29 | loss: 1.1706171
	speed: 0.0815s/iter; left time: 1204.3877s
Epoch: 29 cost time: 18.45455312728882
Epoch: 29, Steps: 208 | Train Loss: 0.826 Vali Loss: 5.206 Vali Acc: 0.106 Test Loss: 5.206 Test Acc: 0.106
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 1.1810254
	speed: 0.2637s/iter; left time: 3868.1319s
	iters: 200, epoch: 30 | loss: 0.4452237
	speed: 0.0841s/iter; left time: 1224.9917s
Epoch: 30 cost time: 17.878070831298828
Epoch: 30, Steps: 208 | Train Loss: 0.799 Vali Loss: 5.477 Vali Acc: 0.109 Test Loss: 5.477 Test Acc: 0.109
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.4367224
	speed: 0.2898s/iter; left time: 4191.1388s
	iters: 200, epoch: 31 | loss: 0.9709914
	speed: 0.0918s/iter; left time: 1318.8794s
Epoch: 31 cost time: 19.23206377029419
Epoch: 31, Steps: 208 | Train Loss: 0.771 Vali Loss: 5.634 Vali Acc: 0.106 Test Loss: 5.634 Test Acc: 0.106
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 1.3905655
	speed: 0.3013s/iter; left time: 4294.1375s
	iters: 200, epoch: 32 | loss: 1.4330698
	speed: 0.0970s/iter; left time: 1373.5349s
Epoch: 32 cost time: 20.808551788330078
Epoch: 32, Steps: 208 | Train Loss: 0.753 Vali Loss: 5.713 Vali Acc: 0.104 Test Loss: 5.713 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.113033104682374
model parameter : 284643
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0281420
	speed: 0.1177s/iter; left time: 2437.2399s
	iters: 200, epoch: 1 | loss: 3.8639975
	speed: 0.0950s/iter; left time: 1957.8156s
Epoch: 1 cost time: 22.19284749031067
Epoch: 1, Steps: 208 | Train Loss: 3.681 Vali Loss: 3.596 Vali Acc: 0.055 Test Loss: 3.596 Test Acc: 0.055
Validation loss decreased (inf --> -0.054840).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5526850
	speed: 0.2949s/iter; left time: 6043.2332s
	iters: 200, epoch: 2 | loss: 3.6555097
	speed: 0.0849s/iter; left time: 1730.8318s
Epoch: 2 cost time: 18.746087789535522
Epoch: 2, Steps: 208 | Train Loss: 3.576 Vali Loss: 3.508 Vali Acc: 0.069 Test Loss: 3.508 Test Acc: 0.069
Validation loss decreased (-0.054840 --> -0.068858).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4972863
	speed: 0.2777s/iter; left time: 5634.1559s
	iters: 200, epoch: 3 | loss: 4.0440054
	speed: 0.0884s/iter; left time: 1785.2069s
Epoch: 3 cost time: 18.786012172698975
Epoch: 3, Steps: 208 | Train Loss: 3.481 Vali Loss: 3.510 Vali Acc: 0.062 Test Loss: 3.510 Test Acc: 0.062
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.5380847
	speed: 0.3007s/iter; left time: 6037.3000s
	iters: 200, epoch: 4 | loss: 3.4204090
	speed: 0.0980s/iter; left time: 1957.7378s
Epoch: 4 cost time: 20.363173961639404
Epoch: 4, Steps: 208 | Train Loss: 3.414 Vali Loss: 3.503 Vali Acc: 0.067 Test Loss: 3.503 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 3.4546731
	speed: 0.2869s/iter; left time: 5701.1809s
	iters: 200, epoch: 5 | loss: 3.6145332
	speed: 0.0939s/iter; left time: 1857.1920s
Epoch: 5 cost time: 19.105525016784668
Epoch: 5, Steps: 208 | Train Loss: 3.341 Vali Loss: 3.466 Vali Acc: 0.066 Test Loss: 3.466 Test Acc: 0.066
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 3.1278224
	speed: 0.3158s/iter; left time: 6208.4287s
	iters: 200, epoch: 6 | loss: 4.1235542
	speed: 0.1052s/iter; left time: 2058.3231s
Epoch: 6 cost time: 21.88942289352417
Epoch: 6, Steps: 208 | Train Loss: 3.274 Vali Loss: 3.418 Vali Acc: 0.085 Test Loss: 3.418 Test Acc: 0.085
Validation loss decreased (-0.068858 --> -0.084666).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.1751919
	speed: 0.2952s/iter; left time: 5741.8400s
	iters: 200, epoch: 7 | loss: 3.0556350
	speed: 0.0928s/iter; left time: 1795.6304s
Epoch: 7 cost time: 19.179383993148804
Epoch: 7, Steps: 208 | Train Loss: 3.177 Vali Loss: 3.396 Vali Acc: 0.088 Test Loss: 3.396 Test Acc: 0.088
Validation loss decreased (-0.084666 --> -0.087947).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.2555091
	speed: 0.2708s/iter; left time: 5210.5884s
	iters: 200, epoch: 8 | loss: 3.3260677
	speed: 0.0918s/iter; left time: 1757.3389s
Epoch: 8 cost time: 19.479196071624756
Epoch: 8, Steps: 208 | Train Loss: 3.041 Vali Loss: 3.324 Vali Acc: 0.098 Test Loss: 3.324 Test Acc: 0.098
Validation loss decreased (-0.087947 --> -0.097790).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.2053459
	speed: 0.2974s/iter; left time: 5662.4785s
	iters: 200, epoch: 9 | loss: 3.1113670
	speed: 0.0852s/iter; left time: 1614.1484s
Epoch: 9 cost time: 18.816195011138916
Epoch: 9, Steps: 208 | Train Loss: 2.905 Vali Loss: 3.294 Vali Acc: 0.097 Test Loss: 3.294 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.9137213
	speed: 0.2691s/iter; left time: 5067.1587s
	iters: 200, epoch: 10 | loss: 3.2983630
	speed: 0.0903s/iter; left time: 1691.3617s
Epoch: 10 cost time: 18.870706796646118
Epoch: 10, Steps: 208 | Train Loss: 2.802 Vali Loss: 3.326 Vali Acc: 0.103 Test Loss: 3.326 Test Acc: 0.103
Validation loss decreased (-0.097790 --> -0.102561).  Saving model ...
	iters: 100, epoch: 11 | loss: 3.0937037
	speed: 0.2901s/iter; left time: 5401.9940s
	iters: 200, epoch: 11 | loss: 2.5785162
	speed: 0.0936s/iter; left time: 1734.2071s
Epoch: 11 cost time: 19.995413064956665
Epoch: 11, Steps: 208 | Train Loss: 2.687 Vali Loss: 3.330 Vali Acc: 0.105 Test Loss: 3.330 Test Acc: 0.105
Validation loss decreased (-0.102561 --> -0.104947).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.8598013
	speed: 0.3089s/iter; left time: 5686.8633s
	iters: 200, epoch: 12 | loss: 2.5365455
	speed: 0.0938s/iter; left time: 1717.7470s
Epoch: 12 cost time: 20.13958764076233
Epoch: 12, Steps: 208 | Train Loss: 2.576 Vali Loss: 3.348 Vali Acc: 0.114 Test Loss: 3.348 Test Acc: 0.114
Validation loss decreased (-0.104947 --> -0.113596).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.3568540
	speed: 0.2858s/iter; left time: 5203.0784s
	iters: 200, epoch: 13 | loss: 2.3651755
	speed: 0.0918s/iter; left time: 1662.2103s
Epoch: 13 cost time: 19.37521195411682
Epoch: 13, Steps: 208 | Train Loss: 2.421 Vali Loss: 3.430 Vali Acc: 0.106 Test Loss: 3.430 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 2.3950541
	speed: 0.2969s/iter; left time: 5343.8206s
	iters: 200, epoch: 14 | loss: 2.5861170
	speed: 0.0929s/iter; left time: 1662.5730s
Epoch: 14 cost time: 19.602479457855225
Epoch: 14, Steps: 208 | Train Loss: 2.320 Vali Loss: 3.458 Vali Acc: 0.111 Test Loss: 3.458 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 2.1037719
	speed: 0.2763s/iter; left time: 4914.8664s
	iters: 200, epoch: 15 | loss: 2.4110844
	speed: 0.0811s/iter; left time: 1433.7283s
Epoch: 15 cost time: 18.108709812164307
Epoch: 15, Steps: 208 | Train Loss: 2.173 Vali Loss: 3.530 Vali Acc: 0.116 Test Loss: 3.530 Test Acc: 0.116
Validation loss decreased (-0.113596 --> -0.115980).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.8874811
	speed: 0.2635s/iter; left time: 4632.8772s
	iters: 200, epoch: 16 | loss: 1.7410269
	speed: 0.0845s/iter; left time: 1476.5598s
Epoch: 16 cost time: 18.19431447982788
Epoch: 16, Steps: 208 | Train Loss: 2.036 Vali Loss: 3.581 Vali Acc: 0.117 Test Loss: 3.581 Test Acc: 0.117
Validation loss decreased (-0.115980 --> -0.117173).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.9867697
	speed: 0.2814s/iter; left time: 4888.0951s
	iters: 200, epoch: 17 | loss: 1.8051479
	speed: 0.0861s/iter; left time: 1487.4742s
Epoch: 17 cost time: 18.980190753936768
Epoch: 17, Steps: 208 | Train Loss: 1.888 Vali Loss: 3.663 Vali Acc: 0.119 Test Loss: 3.663 Test Acc: 0.119
Validation loss decreased (-0.117173 --> -0.119260).  Saving model ...
	iters: 100, epoch: 18 | loss: 2.3861485
	speed: 0.2809s/iter; left time: 4821.4963s
	iters: 200, epoch: 18 | loss: 1.7985301
	speed: 0.0841s/iter; left time: 1435.4652s
Epoch: 18 cost time: 18.918749809265137
Epoch: 18, Steps: 208 | Train Loss: 1.746 Vali Loss: 3.793 Vali Acc: 0.113 Test Loss: 3.793 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.6523638
	speed: 0.2779s/iter; left time: 4711.7851s
	iters: 200, epoch: 19 | loss: 2.0238817
	speed: 0.0973s/iter; left time: 1640.9344s
Epoch: 19 cost time: 19.91799783706665
Epoch: 19, Steps: 208 | Train Loss: 1.630 Vali Loss: 3.831 Vali Acc: 0.120 Test Loss: 3.831 Test Acc: 0.120
Validation loss decreased (-0.119260 --> -0.119556).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.8077790
	speed: 0.2944s/iter; left time: 4930.7400s
	iters: 200, epoch: 20 | loss: 1.4935559
	speed: 0.0959s/iter; left time: 1596.2887s
Epoch: 20 cost time: 19.866329193115234
Epoch: 20, Steps: 208 | Train Loss: 1.508 Vali Loss: 4.066 Vali Acc: 0.113 Test Loss: 4.066 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.4527712
	speed: 0.2992s/iter; left time: 4949.0544s
	iters: 200, epoch: 21 | loss: 1.8793236
	speed: 0.0911s/iter; left time: 1498.0005s
Epoch: 21 cost time: 18.755462408065796
Epoch: 21, Steps: 208 | Train Loss: 1.400 Vali Loss: 4.184 Vali Acc: 0.126 Test Loss: 4.184 Test Acc: 0.126
Validation loss decreased (-0.119556 --> -0.125517).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.6746919
	speed: 0.2776s/iter; left time: 4533.2784s
	iters: 200, epoch: 22 | loss: 1.1672292
	speed: 0.0855s/iter; left time: 1388.7217s
Epoch: 22 cost time: 18.388819694519043
Epoch: 22, Steps: 208 | Train Loss: 1.272 Vali Loss: 4.209 Vali Acc: 0.111 Test Loss: 4.209 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.8563090
	speed: 0.2805s/iter; left time: 4523.5696s
	iters: 200, epoch: 23 | loss: 1.3852745
	speed: 0.0859s/iter; left time: 1376.3329s
Epoch: 23 cost time: 19.321077823638916
Epoch: 23, Steps: 208 | Train Loss: 1.202 Vali Loss: 4.365 Vali Acc: 0.115 Test Loss: 4.365 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 1.1079288
	speed: 0.2865s/iter; left time: 4560.9786s
	iters: 200, epoch: 24 | loss: 1.3381001
	speed: 0.0828s/iter; left time: 1310.1810s
Epoch: 24 cost time: 17.964340448379517
Epoch: 24, Steps: 208 | Train Loss: 1.101 Vali Loss: 4.519 Vali Acc: 0.124 Test Loss: 4.519 Test Acc: 0.124
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 1.1936619
	speed: 0.2694s/iter; left time: 4231.4580s
	iters: 200, epoch: 25 | loss: 0.7257930
	speed: 0.0888s/iter; left time: 1385.4187s
Epoch: 25 cost time: 18.793943643569946
Epoch: 25, Steps: 208 | Train Loss: 1.037 Vali Loss: 4.797 Vali Acc: 0.118 Test Loss: 4.797 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.7494885
	speed: 0.2777s/iter; left time: 4304.8273s
	iters: 200, epoch: 26 | loss: 0.9874979
	speed: 0.0853s/iter; left time: 1313.0249s
Epoch: 26 cost time: 18.4495747089386
Epoch: 26, Steps: 208 | Train Loss: 0.996 Vali Loss: 4.748 Vali Acc: 0.116 Test Loss: 4.748 Test Acc: 0.116
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.7524133
	speed: 0.2960s/iter; left time: 4527.4458s
	iters: 200, epoch: 27 | loss: 1.2803667
	speed: 0.0888s/iter; left time: 1348.3826s
Epoch: 27 cost time: 18.942697286605835
Epoch: 27, Steps: 208 | Train Loss: 0.965 Vali Loss: 5.028 Vali Acc: 0.117 Test Loss: 5.028 Test Acc: 0.117
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.8898033
	speed: 0.2886s/iter; left time: 4352.8951s
	iters: 200, epoch: 28 | loss: 1.0900404
	speed: 0.0920s/iter; left time: 1378.2744s
Epoch: 28 cost time: 19.738327980041504
Epoch: 28, Steps: 208 | Train Loss: 0.878 Vali Loss: 5.174 Vali Acc: 0.106 Test Loss: 5.174 Test Acc: 0.106
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.8233781
	speed: 0.3028s/iter; left time: 4504.3035s
	iters: 200, epoch: 29 | loss: 1.1358278
	speed: 0.0907s/iter; left time: 1340.8621s
Epoch: 29 cost time: 19.991941213607788
Epoch: 29, Steps: 208 | Train Loss: 0.850 Vali Loss: 5.094 Vali Acc: 0.112 Test Loss: 5.094 Test Acc: 0.112
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.8785443
	speed: 0.2911s/iter; left time: 4269.5774s
	iters: 200, epoch: 30 | loss: 0.6781713
	speed: 0.0956s/iter; left time: 1393.5065s
Epoch: 30 cost time: 19.76107144355774
Epoch: 30, Steps: 208 | Train Loss: 0.794 Vali Loss: 5.274 Vali Acc: 0.115 Test Loss: 5.274 Test Acc: 0.115
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.4456439
	speed: 0.2937s/iter; left time: 4247.6418s
	iters: 200, epoch: 31 | loss: 0.3754860
	speed: 0.0834s/iter; left time: 1197.0077s
Epoch: 31 cost time: 19.92582106590271
Epoch: 31, Steps: 208 | Train Loss: 0.734 Vali Loss: 5.356 Vali Acc: 0.113 Test Loss: 5.356 Test Acc: 0.113
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12555920071577692
model parameter : 283459
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6336415
	speed: 0.0970s/iter; left time: 2007.8597s
	iters: 200, epoch: 1 | loss: 3.5879362
	speed: 0.0816s/iter; left time: 1680.1739s
Epoch: 1 cost time: 18.606654405593872
Epoch: 1, Steps: 208 | Train Loss: 3.687 Vali Loss: 3.557 Vali Acc: 0.047 Test Loss: 3.557 Test Acc: 0.047
Validation loss decreased (inf --> -0.046490).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5707190
	speed: 0.2641s/iter; left time: 5411.4414s
	iters: 200, epoch: 2 | loss: 3.8710918
	speed: 0.0849s/iter; left time: 1732.0013s
Epoch: 2 cost time: 17.740960121154785
Epoch: 2, Steps: 208 | Train Loss: 3.562 Vali Loss: 3.497 Vali Acc: 0.075 Test Loss: 3.497 Test Acc: 0.075
Validation loss decreased (-0.046490 --> -0.074525).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6704423
	speed: 0.2745s/iter; left time: 5567.7460s
	iters: 200, epoch: 3 | loss: 3.6701283
	speed: 0.0925s/iter; left time: 1867.2190s
Epoch: 3 cost time: 19.394800662994385
Epoch: 3, Steps: 208 | Train Loss: 3.491 Vali Loss: 3.470 Vali Acc: 0.060 Test Loss: 3.470 Test Acc: 0.060
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.3366861
	speed: 0.2662s/iter; left time: 5345.4242s
	iters: 200, epoch: 4 | loss: 3.4592421
	speed: 0.0825s/iter; left time: 1648.5317s
Epoch: 4 cost time: 17.837728023529053
Epoch: 4, Steps: 208 | Train Loss: 3.431 Vali Loss: 3.494 Vali Acc: 0.064 Test Loss: 3.494 Test Acc: 0.064
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 3.4926000
	speed: 0.2922s/iter; left time: 5805.0572s
	iters: 200, epoch: 5 | loss: 3.5883641
	speed: 0.0875s/iter; left time: 1730.2846s
Epoch: 5 cost time: 18.845637321472168
Epoch: 5, Steps: 208 | Train Loss: 3.375 Vali Loss: 3.453 Vali Acc: 0.074 Test Loss: 3.453 Test Acc: 0.074
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 3.3671665
	speed: 0.2745s/iter; left time: 5396.6455s
	iters: 200, epoch: 6 | loss: 3.0216203
	speed: 0.0833s/iter; left time: 1629.4299s
Epoch: 6 cost time: 18.259581565856934
Epoch: 6, Steps: 208 | Train Loss: 3.306 Vali Loss: 3.461 Vali Acc: 0.074 Test Loss: 3.461 Test Acc: 0.074
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 3.4831424
	speed: 0.2418s/iter; left time: 4702.8946s
	iters: 200, epoch: 7 | loss: 3.2571979
	speed: 0.0849s/iter; left time: 1643.9115s
Epoch: 7 cost time: 17.743438005447388
Epoch: 7, Steps: 208 | Train Loss: 3.225 Vali Loss: 3.348 Vali Acc: 0.080 Test Loss: 3.348 Test Acc: 0.080
Validation loss decreased (-0.074525 --> -0.080193).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.6930623
	speed: 0.2811s/iter; left time: 5409.5098s
	iters: 200, epoch: 8 | loss: 2.7499766
	speed: 0.0866s/iter; left time: 1657.1712s
Epoch: 8 cost time: 18.304564476013184
Epoch: 8, Steps: 208 | Train Loss: 3.090 Vali Loss: 3.243 Vali Acc: 0.099 Test Loss: 3.243 Test Acc: 0.099
Validation loss decreased (-0.080193 --> -0.098685).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.7169173
	speed: 0.2544s/iter; left time: 4843.6941s
	iters: 200, epoch: 9 | loss: 3.0684543
	speed: 0.0734s/iter; left time: 1389.0718s
Epoch: 9 cost time: 16.797627210617065
Epoch: 9, Steps: 208 | Train Loss: 2.959 Vali Loss: 3.252 Vali Acc: 0.103 Test Loss: 3.252 Test Acc: 0.103
Validation loss decreased (-0.098685 --> -0.102562).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.5347841
	speed: 0.2614s/iter; left time: 4922.3965s
	iters: 200, epoch: 10 | loss: 2.8205481
	speed: 0.0858s/iter; left time: 1607.3665s
Epoch: 10 cost time: 18.596765518188477
Epoch: 10, Steps: 208 | Train Loss: 2.848 Vali Loss: 3.222 Vali Acc: 0.106 Test Loss: 3.222 Test Acc: 0.106
Validation loss decreased (-0.102562 --> -0.105545).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.4527564
	speed: 0.2716s/iter; left time: 5057.7989s
	iters: 200, epoch: 11 | loss: 2.8217859
	speed: 0.0943s/iter; left time: 1746.5040s
Epoch: 11 cost time: 19.093618631362915
Epoch: 11, Steps: 208 | Train Loss: 2.756 Vali Loss: 3.220 Vali Acc: 0.112 Test Loss: 3.220 Test Acc: 0.112
Validation loss decreased (-0.105545 --> -0.112106).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.4426615
	speed: 0.2759s/iter; left time: 5080.8459s
	iters: 200, epoch: 12 | loss: 2.7892604
	speed: 0.0753s/iter; left time: 1378.7033s
Epoch: 12 cost time: 16.68733048439026
Epoch: 12, Steps: 208 | Train Loss: 2.635 Vali Loss: 3.244 Vali Acc: 0.112 Test Loss: 3.244 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.5813704
	speed: 0.2704s/iter; left time: 4922.7370s
	iters: 200, epoch: 13 | loss: 2.6269970
	speed: 0.0853s/iter; left time: 1544.1707s
Epoch: 13 cost time: 18.841854572296143
Epoch: 13, Steps: 208 | Train Loss: 2.524 Vali Loss: 3.282 Vali Acc: 0.109 Test Loss: 3.282 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 2.3536122
	speed: 0.2722s/iter; left time: 4898.6222s
	iters: 200, epoch: 14 | loss: 2.1951675
	speed: 0.0878s/iter; left time: 1570.5992s
Epoch: 14 cost time: 18.29713535308838
Epoch: 14, Steps: 208 | Train Loss: 2.388 Vali Loss: 3.332 Vali Acc: 0.111 Test Loss: 3.332 Test Acc: 0.111
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 2.2177186
	speed: 0.2529s/iter; left time: 4498.3195s
	iters: 200, epoch: 15 | loss: 2.8181987
	speed: 0.0736s/iter; left time: 1302.3807s
Epoch: 15 cost time: 16.323341131210327
Epoch: 15, Steps: 208 | Train Loss: 2.233 Vali Loss: 3.385 Vali Acc: 0.132 Test Loss: 3.385 Test Acc: 0.132
Validation loss decreased (-0.112106 --> -0.131788).  Saving model ...
	iters: 100, epoch: 16 | loss: 2.4234123
	speed: 0.2636s/iter; left time: 4635.1600s
	iters: 200, epoch: 16 | loss: 2.4034297
	speed: 0.0800s/iter; left time: 1398.5516s
Epoch: 16 cost time: 18.215075731277466
Epoch: 16, Steps: 208 | Train Loss: 2.113 Vali Loss: 3.480 Vali Acc: 0.119 Test Loss: 3.480 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.5801771
	speed: 0.2725s/iter; left time: 4734.4681s
	iters: 200, epoch: 17 | loss: 1.9669030
	speed: 0.0834s/iter; left time: 1440.5072s
Epoch: 17 cost time: 17.85006809234619
Epoch: 17, Steps: 208 | Train Loss: 2.013 Vali Loss: 3.532 Vali Acc: 0.123 Test Loss: 3.532 Test Acc: 0.123
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.9788367
	speed: 0.2497s/iter; left time: 4286.8105s
	iters: 200, epoch: 18 | loss: 1.9615039
	speed: 0.0809s/iter; left time: 1380.3590s
Epoch: 18 cost time: 17.1662278175354
Epoch: 18, Steps: 208 | Train Loss: 1.895 Vali Loss: 3.645 Vali Acc: 0.125 Test Loss: 3.645 Test Acc: 0.125
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.5138978
	speed: 0.2678s/iter; left time: 4541.9120s
	iters: 200, epoch: 19 | loss: 1.9222476
	speed: 0.0858s/iter; left time: 1446.1411s
Epoch: 19 cost time: 18.097355127334595
Epoch: 19, Steps: 208 | Train Loss: 1.764 Vali Loss: 3.737 Vali Acc: 0.121 Test Loss: 3.737 Test Acc: 0.121
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 1.7474337
	speed: 0.2762s/iter; left time: 4625.3416s
	iters: 200, epoch: 20 | loss: 1.5741222
	speed: 0.0865s/iter; left time: 1440.7056s
Epoch: 20 cost time: 18.089012384414673
Epoch: 20, Steps: 208 | Train Loss: 1.633 Vali Loss: 3.832 Vali Acc: 0.130 Test Loss: 3.832 Test Acc: 0.130
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 1.4185932
	speed: 0.2711s/iter; left time: 4484.1200s
	iters: 200, epoch: 21 | loss: 1.7124445
	speed: 0.0820s/iter; left time: 1347.9409s
Epoch: 21 cost time: 18.42268395423889
Epoch: 21, Steps: 208 | Train Loss: 1.527 Vali Loss: 3.940 Vali Acc: 0.116 Test Loss: 3.940 Test Acc: 0.116
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 1.2622511
	speed: 0.2739s/iter; left time: 4473.5794s
	iters: 200, epoch: 22 | loss: 2.0420861
	speed: 0.0919s/iter; left time: 1491.5816s
Epoch: 22 cost time: 19.5089054107666
Epoch: 22, Steps: 208 | Train Loss: 1.464 Vali Loss: 4.084 Vali Acc: 0.117 Test Loss: 4.084 Test Acc: 0.117
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 1.1454011
	speed: 0.2703s/iter; left time: 4359.2484s
	iters: 200, epoch: 23 | loss: 0.9628884
	speed: 0.0866s/iter; left time: 1387.2486s
Epoch: 23 cost time: 18.1866455078125
Epoch: 23, Steps: 208 | Train Loss: 1.348 Vali Loss: 4.158 Vali Acc: 0.123 Test Loss: 4.158 Test Acc: 0.123
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 1.2849402
	speed: 0.2518s/iter; left time: 4008.5921s
	iters: 200, epoch: 24 | loss: 1.9100922
	speed: 0.0779s/iter; left time: 1231.5039s
Epoch: 24 cost time: 16.96560788154602
Epoch: 24, Steps: 208 | Train Loss: 1.266 Vali Loss: 4.211 Vali Acc: 0.127 Test Loss: 4.211 Test Acc: 0.127
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 1.2452081
	speed: 0.2697s/iter; left time: 4237.1526s
	iters: 200, epoch: 25 | loss: 1.0059558
	speed: 0.0868s/iter; left time: 1354.3256s
Epoch: 25 cost time: 18.85347032546997
Epoch: 25, Steps: 208 | Train Loss: 1.191 Vali Loss: 4.288 Vali Acc: 0.112 Test Loss: 4.288 Test Acc: 0.112
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1318222487324784
model parameter : 282275
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.8227901
	speed: 0.1120s/iter; left time: 2318.7706s
	iters: 200, epoch: 1 | loss: 3.5889575
	speed: 0.0784s/iter; left time: 1615.6699s
Epoch: 1 cost time: 19.824494123458862
Epoch: 1, Steps: 208 | Train Loss: 4.062 Vali Loss: 3.968 Vali Acc: 0.051 Test Loss: 3.968 Test Acc: 0.051
Validation loss decreased (inf --> -0.051258).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7497764
	speed: 0.2798s/iter; left time: 5733.9441s
	iters: 200, epoch: 2 | loss: 3.6986837
	speed: 0.0785s/iter; left time: 1600.6841s
Epoch: 2 cost time: 18.026187419891357
Epoch: 2, Steps: 208 | Train Loss: 3.792 Vali Loss: 3.662 Vali Acc: 0.057 Test Loss: 3.662 Test Acc: 0.057
Validation loss decreased (-0.051258 --> -0.056629).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5780549
	speed: 0.2840s/iter; left time: 5761.7513s
	iters: 200, epoch: 3 | loss: 3.9663222
	speed: 0.0852s/iter; left time: 1719.1347s
Epoch: 3 cost time: 18.430413246154785
Epoch: 3, Steps: 208 | Train Loss: 3.644 Vali Loss: 3.530 Vali Acc: 0.075 Test Loss: 3.530 Test Acc: 0.075
Validation loss decreased (-0.056629 --> -0.075121).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4689901
	speed: 0.2721s/iter; left time: 5462.7899s
	iters: 200, epoch: 4 | loss: 3.4015405
	speed: 0.0789s/iter; left time: 1576.6923s
Epoch: 4 cost time: 17.91955280303955
Epoch: 4, Steps: 208 | Train Loss: 3.460 Vali Loss: 3.488 Vali Acc: 0.069 Test Loss: 3.488 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.3550804
	speed: 0.2618s/iter; left time: 5202.0161s
	iters: 200, epoch: 5 | loss: 3.1229115
	speed: 0.0878s/iter; left time: 1734.8329s
Epoch: 5 cost time: 18.26218295097351
Epoch: 5, Steps: 208 | Train Loss: 3.374 Vali Loss: 3.739 Vali Acc: 0.058 Test Loss: 3.739 Test Acc: 0.058
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 3.7154064
	speed: 0.2571s/iter; left time: 5055.5305s
	iters: 200, epoch: 6 | loss: 3.5788329
	speed: 0.0875s/iter; left time: 1711.4263s
Epoch: 6 cost time: 18.033823251724243
Epoch: 6, Steps: 208 | Train Loss: 3.688 Vali Loss: 3.781 Vali Acc: 0.026 Test Loss: 3.781 Test Acc: 0.026
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 3.9128759
	speed: 0.2174s/iter; left time: 4230.0499s
	iters: 200, epoch: 7 | loss: 3.7881432
	speed: 0.0842s/iter; left time: 1629.2827s
Epoch: 7 cost time: 16.69712543487549
Epoch: 7, Steps: 208 | Train Loss: 3.805 Vali Loss: 3.751 Vali Acc: 0.026 Test Loss: 3.751 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 3.7650599
	speed: 0.2584s/iter; left time: 4972.2944s
	iters: 200, epoch: 8 | loss: 3.7746496
	speed: 0.0847s/iter; left time: 1620.9396s
Epoch: 8 cost time: 18.420228958129883
Epoch: 8, Steps: 208 | Train Loss: 3.757 Vali Loss: 3.719 Vali Acc: 0.025 Test Loss: 3.719 Test Acc: 0.025
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 3.8156755
	speed: 0.2610s/iter; left time: 4968.4206s
	iters: 200, epoch: 9 | loss: 3.7378473
	speed: 0.0873s/iter; left time: 1653.0278s
Epoch: 9 cost time: 19.050866842269897
Epoch: 9, Steps: 208 | Train Loss: 3.726 Vali Loss: 3.724 Vali Acc: 0.026 Test Loss: 3.724 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 3.8096373
	speed: 0.2510s/iter; left time: 4726.9443s
	iters: 200, epoch: 10 | loss: 3.6029234
	speed: 0.0825s/iter; left time: 1544.3055s
Epoch: 10 cost time: 18.96433734893799
Epoch: 10, Steps: 208 | Train Loss: 3.730 Vali Loss: 3.692 Vali Acc: 0.026 Test Loss: 3.692 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 3.6997831
	speed: 0.2716s/iter; left time: 5056.9808s
	iters: 200, epoch: 11 | loss: 3.7443070
	speed: 0.0851s/iter; left time: 1575.3613s
Epoch: 11 cost time: 18.3819637298584
Epoch: 11, Steps: 208 | Train Loss: 3.719 Vali Loss: 3.695 Vali Acc: 0.026 Test Loss: 3.695 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 3.7011452
	speed: 0.2673s/iter; left time: 4922.3452s
	iters: 200, epoch: 12 | loss: 3.7494574
	speed: 0.0819s/iter; left time: 1500.0908s
Epoch: 12 cost time: 17.74815344810486
Epoch: 12, Steps: 208 | Train Loss: 3.715 Vali Loss: 3.695 Vali Acc: 0.026 Test Loss: 3.695 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 3.7042575
	speed: 0.2633s/iter; left time: 4793.7196s
	iters: 200, epoch: 13 | loss: 3.6359248
	speed: 0.0886s/iter; left time: 1604.9910s
Epoch: 13 cost time: 19.500073432922363
Epoch: 13, Steps: 208 | Train Loss: 3.701 Vali Loss: 3.691 Vali Acc: 0.026 Test Loss: 3.691 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.07515657620041753
model parameter : 11722839
model size : 49.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.5694051
	speed: 0.1080s/iter; left time: 2236.2515s
	iters: 200, epoch: 1 | loss: 3.8007944
	speed: 0.0810s/iter; left time: 1669.4187s
Epoch: 1 cost time: 19.64631938934326
Epoch: 1, Steps: 208 | Train Loss: 4.105 Vali Loss: 3.679 Vali Acc: 0.065 Test Loss: 3.679 Test Acc: 0.065
Validation loss decreased (inf --> -0.064980).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9160678
	speed: 0.2697s/iter; left time: 5527.0615s
	iters: 200, epoch: 2 | loss: 3.2862825
	speed: 0.0920s/iter; left time: 1876.6262s
Epoch: 2 cost time: 19.666534185409546
Epoch: 2, Steps: 208 | Train Loss: 3.754 Vali Loss: 3.740 Vali Acc: 0.056 Test Loss: 3.740 Test Acc: 0.056
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.0067854
	speed: 0.2611s/iter; left time: 5297.0791s
	iters: 200, epoch: 3 | loss: 3.2149813
	speed: 0.0833s/iter; left time: 1682.3789s
Epoch: 3 cost time: 18.139339447021484
Epoch: 3, Steps: 208 | Train Loss: 3.653 Vali Loss: 3.550 Vali Acc: 0.067 Test Loss: 3.550 Test Acc: 0.067
Validation loss decreased (-0.064980 --> -0.066770).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.7416406
	speed: 0.2600s/iter; left time: 5220.3662s
	iters: 200, epoch: 4 | loss: 3.2622945
	speed: 0.0851s/iter; left time: 1699.8810s
Epoch: 4 cost time: 18.63499665260315
Epoch: 4, Steps: 208 | Train Loss: 3.484 Vali Loss: 3.346 Vali Acc: 0.077 Test Loss: 3.346 Test Acc: 0.077
Validation loss decreased (-0.066770 --> -0.077211).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2764249
	speed: 0.2906s/iter; left time: 5774.2378s
	iters: 200, epoch: 5 | loss: 3.3064778
	speed: 0.0926s/iter; left time: 1830.9545s
Epoch: 5 cost time: 20.061335802078247
Epoch: 5, Steps: 208 | Train Loss: 3.415 Vali Loss: 3.454 Vali Acc: 0.069 Test Loss: 3.454 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.9539087
	speed: 0.2772s/iter; left time: 5450.8591s
	iters: 200, epoch: 6 | loss: 3.8583775
	speed: 0.0890s/iter; left time: 1740.7743s
Epoch: 6 cost time: 19.677497386932373
Epoch: 6, Steps: 208 | Train Loss: 3.795 Vali Loss: 3.791 Vali Acc: 0.026 Test Loss: 3.791 Test Acc: 0.026
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 3.7394075
	speed: 0.2840s/iter; left time: 5524.2596s
	iters: 200, epoch: 7 | loss: 3.5918758
	speed: 0.0870s/iter; left time: 1682.8129s
Epoch: 7 cost time: 19.13729476928711
Epoch: 7, Steps: 208 | Train Loss: 3.795 Vali Loss: 3.779 Vali Acc: 0.026 Test Loss: 3.779 Test Acc: 0.026
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 3.5990725
	speed: 0.2821s/iter; left time: 5428.7167s
	iters: 200, epoch: 8 | loss: 3.9852667
	speed: 0.0943s/iter; left time: 1804.6124s
Epoch: 8 cost time: 19.615381717681885
Epoch: 8, Steps: 208 | Train Loss: 3.842 Vali Loss: 3.850 Vali Acc: 0.026 Test Loss: 3.850 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 3.6727819
	speed: 0.2755s/iter; left time: 5245.1626s
	iters: 200, epoch: 9 | loss: 3.7821486
	speed: 0.0844s/iter; left time: 1599.1213s
Epoch: 9 cost time: 18.24808669090271
Epoch: 9, Steps: 208 | Train Loss: 3.761 Vali Loss: 3.689 Vali Acc: 0.026 Test Loss: 3.689 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 3.6411433
	speed: 0.2732s/iter; left time: 5144.6694s
	iters: 200, epoch: 10 | loss: 3.7266269
	speed: 0.0872s/iter; left time: 1632.5590s
Epoch: 10 cost time: 18.509607791900635
Epoch: 10, Steps: 208 | Train Loss: 3.727 Vali Loss: 3.688 Vali Acc: 0.026 Test Loss: 3.688 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 3.6173496
	speed: 0.2638s/iter; left time: 4912.6046s
	iters: 200, epoch: 11 | loss: 3.7248034
	speed: 0.0928s/iter; left time: 1718.1471s
Epoch: 11 cost time: 19.983614206314087
Epoch: 11, Steps: 208 | Train Loss: 3.718 Vali Loss: 3.702 Vali Acc: 0.026 Test Loss: 3.702 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 3.6399097
	speed: 0.2526s/iter; left time: 4651.9571s
	iters: 200, epoch: 12 | loss: 3.7621622
	speed: 0.0876s/iter; left time: 1604.6895s
Epoch: 12 cost time: 18.236162185668945
Epoch: 12, Steps: 208 | Train Loss: 3.708 Vali Loss: 3.676 Vali Acc: 0.026 Test Loss: 3.676 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 3.7083037
	speed: 0.2732s/iter; left time: 4973.5707s
	iters: 200, epoch: 13 | loss: 3.7290709
	speed: 0.0869s/iter; left time: 1572.4573s
Epoch: 13 cost time: 18.64626407623291
Epoch: 13, Steps: 208 | Train Loss: 3.710 Vali Loss: 3.682 Vali Acc: 0.026 Test Loss: 3.682 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 3.6793633
	speed: 0.2570s/iter; left time: 4625.7039s
	iters: 200, epoch: 14 | loss: 3.6258581
	speed: 0.0893s/iter; left time: 1597.5863s
Epoch: 14 cost time: 19.084617376327515
Epoch: 14, Steps: 208 | Train Loss: 3.702 Vali Loss: 3.677 Vali Acc: 0.026 Test Loss: 3.677 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.07724425887265135
model parameter : 11714135
model size : 49.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.6412497
	speed: 0.1022s/iter; left time: 2115.7202s
	iters: 200, epoch: 1 | loss: 3.6699574
	speed: 0.0824s/iter; left time: 1698.1109s
Epoch: 1 cost time: 19.22962737083435
Epoch: 1, Steps: 208 | Train Loss: 4.115 Vali Loss: 4.112 Vali Acc: 0.041 Test Loss: 4.112 Test Acc: 0.041
Validation loss decreased (inf --> -0.041414).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7545044
	speed: 0.3032s/iter; left time: 6214.0798s
	iters: 200, epoch: 2 | loss: 3.3601005
	speed: 0.0936s/iter; left time: 1908.2479s
Epoch: 2 cost time: 21.420076847076416
Epoch: 2, Steps: 208 | Train Loss: 3.816 Vali Loss: 3.780 Vali Acc: 0.055 Test Loss: 3.780 Test Acc: 0.055
Validation loss decreased (-0.041414 --> -0.054540).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7110903
	speed: 0.2932s/iter; left time: 5948.1187s
	iters: 200, epoch: 3 | loss: 3.7210021
	speed: 0.1040s/iter; left time: 2100.1604s
Epoch: 3 cost time: 21.65132236480713
Epoch: 3, Steps: 208 | Train Loss: 3.650 Vali Loss: 3.743 Vali Acc: 0.076 Test Loss: 3.743 Test Acc: 0.076
Validation loss decreased (-0.054540 --> -0.076014).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.5677323
	speed: 0.2747s/iter; left time: 5514.5817s
	iters: 200, epoch: 4 | loss: 3.2467296
	speed: 0.0961s/iter; left time: 1919.9864s
Epoch: 4 cost time: 19.806617736816406
Epoch: 4, Steps: 208 | Train Loss: 3.465 Vali Loss: 3.378 Vali Acc: 0.081 Test Loss: 3.378 Test Acc: 0.081
Validation loss decreased (-0.076014 --> -0.080789).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.7165260
	speed: 0.2780s/iter; left time: 5523.9712s
	iters: 200, epoch: 5 | loss: 3.8322108
	speed: 0.0994s/iter; left time: 1965.6660s
Epoch: 5 cost time: 19.997045516967773
Epoch: 5, Steps: 208 | Train Loss: 3.374 Vali Loss: 3.617 Vali Acc: 0.055 Test Loss: 3.617 Test Acc: 0.055
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.9044557
	speed: 0.2743s/iter; left time: 5393.3082s
	iters: 200, epoch: 6 | loss: 3.7294965
	speed: 0.0947s/iter; left time: 1852.9237s
Epoch: 6 cost time: 20.66551923751831
Epoch: 6, Steps: 208 | Train Loss: 3.764 Vali Loss: 3.797 Vali Acc: 0.026 Test Loss: 3.797 Test Acc: 0.026
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 3.7592759
	speed: 0.2879s/iter; left time: 5599.7244s
	iters: 200, epoch: 7 | loss: 3.7757146
	speed: 0.0914s/iter; left time: 1769.5082s
Epoch: 7 cost time: 19.95851445198059
Epoch: 7, Steps: 208 | Train Loss: 3.810 Vali Loss: 3.758 Vali Acc: 0.026 Test Loss: 3.758 Test Acc: 0.026
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 3.6535351
	speed: 0.2792s/iter; left time: 5373.6801s
	iters: 200, epoch: 8 | loss: 3.7806759
	speed: 0.0891s/iter; left time: 1705.7331s
Epoch: 8 cost time: 19.534249305725098
Epoch: 8, Steps: 208 | Train Loss: 3.748 Vali Loss: 3.707 Vali Acc: 0.026 Test Loss: 3.707 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 3.8204248
	speed: 0.2929s/iter; left time: 5576.8430s
	iters: 200, epoch: 9 | loss: 4.0061741
	speed: 0.1027s/iter; left time: 1945.6344s
Epoch: 9 cost time: 22.190953969955444
Epoch: 9, Steps: 208 | Train Loss: 3.830 Vali Loss: 3.749 Vali Acc: 0.026 Test Loss: 3.749 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 3.7981012
	speed: 0.2960s/iter; left time: 5572.6408s
	iters: 200, epoch: 10 | loss: 3.8409812
	speed: 0.0953s/iter; left time: 1784.0398s
Epoch: 10 cost time: 20.41241717338562
Epoch: 10, Steps: 208 | Train Loss: 3.753 Vali Loss: 3.719 Vali Acc: 0.026 Test Loss: 3.719 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 3.6820838
	speed: 0.2904s/iter; left time: 5407.8489s
	iters: 200, epoch: 11 | loss: 3.5778489
	speed: 0.0891s/iter; left time: 1650.9636s
Epoch: 11 cost time: 20.091398239135742
Epoch: 11, Steps: 208 | Train Loss: 3.729 Vali Loss: 3.717 Vali Acc: 0.026 Test Loss: 3.717 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 3.6501465
	speed: 0.2844s/iter; left time: 5236.6927s
	iters: 200, epoch: 12 | loss: 3.7503865
	speed: 0.0987s/iter; left time: 1806.7647s
Epoch: 12 cost time: 20.896068811416626
Epoch: 12, Steps: 208 | Train Loss: 3.711 Vali Loss: 3.685 Vali Acc: 0.026 Test Loss: 3.685 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 3.6706014
	speed: 0.2699s/iter; left time: 4913.9464s
	iters: 200, epoch: 13 | loss: 3.7185626
	speed: 0.0854s/iter; left time: 1545.4930s
Epoch: 13 cost time: 18.497279167175293
Epoch: 13, Steps: 208 | Train Loss: 3.703 Vali Loss: 3.677 Vali Acc: 0.026 Test Loss: 3.677 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 3.6426008
	speed: 0.2735s/iter; left time: 4922.1202s
	iters: 200, epoch: 14 | loss: 3.7284598
	speed: 0.0895s/iter; left time: 1602.6726s
Epoch: 14 cost time: 19.665228366851807
Epoch: 14, Steps: 208 | Train Loss: 3.700 Vali Loss: 3.686 Vali Acc: 0.026 Test Loss: 3.686 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08082314345362362
model parameter : 11705431
model size : 49.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0426011
	speed: 0.1103s/iter; left time: 2283.1464s
	iters: 200, epoch: 1 | loss: 3.6487100
	speed: 0.0942s/iter; left time: 1941.4970s
Epoch: 1 cost time: 21.34298610687256
Epoch: 1, Steps: 208 | Train Loss: 4.026 Vali Loss: 3.741 Vali Acc: 0.046 Test Loss: 3.741 Test Acc: 0.046
Validation loss decreased (inf --> -0.046190).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4158280
	speed: 0.2859s/iter; left time: 5859.2002s
	iters: 200, epoch: 2 | loss: 3.7070999
	speed: 0.0965s/iter; left time: 1967.9637s
Epoch: 2 cost time: 20.554036140441895
Epoch: 2, Steps: 208 | Train Loss: 3.718 Vali Loss: 3.611 Vali Acc: 0.052 Test Loss: 3.611 Test Acc: 0.052
Validation loss decreased (-0.046190 --> -0.052454).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6421475
	speed: 0.2796s/iter; left time: 5671.5640s
	iters: 200, epoch: 3 | loss: 3.4926045
	speed: 0.0929s/iter; left time: 1874.6395s
Epoch: 3 cost time: 20.617528438568115
Epoch: 3, Steps: 208 | Train Loss: 3.570 Vali Loss: 3.424 Vali Acc: 0.074 Test Loss: 3.424 Test Acc: 0.074
Validation loss decreased (-0.052454 --> -0.073631).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.5628750
	speed: 0.2940s/iter; left time: 5902.0818s
	iters: 200, epoch: 4 | loss: 3.3974814
	speed: 0.0950s/iter; left time: 1898.6702s
Epoch: 4 cost time: 19.76229953765869
Epoch: 4, Steps: 208 | Train Loss: 3.421 Vali Loss: 3.446 Vali Acc: 0.079 Test Loss: 3.446 Test Acc: 0.079
Validation loss decreased (-0.073631 --> -0.078999).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.1528065
	speed: 0.2749s/iter; left time: 5461.4179s
	iters: 200, epoch: 5 | loss: 3.4073086
	speed: 0.0828s/iter; left time: 1636.6715s
Epoch: 5 cost time: 17.762447595596313
Epoch: 5, Steps: 208 | Train Loss: 3.356 Vali Loss: 3.521 Vali Acc: 0.074 Test Loss: 3.521 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.8290217
	speed: 0.2839s/iter; left time: 5581.8868s
	iters: 200, epoch: 6 | loss: 3.7655652
	speed: 0.0941s/iter; left time: 1840.2545s
Epoch: 6 cost time: 21.12886357307434
Epoch: 6, Steps: 208 | Train Loss: 3.675 Vali Loss: 3.780 Vali Acc: 0.026 Test Loss: 3.780 Test Acc: 0.026
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 3.9377208
	speed: 0.2920s/iter; left time: 5679.8259s
	iters: 200, epoch: 7 | loss: 3.7472315
	speed: 0.1035s/iter; left time: 2003.7155s
Epoch: 7 cost time: 22.295767784118652
Epoch: 7, Steps: 208 | Train Loss: 3.930 Vali Loss: 4.169 Vali Acc: 0.026 Test Loss: 4.169 Test Acc: 0.026
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 4.0018711
	speed: 0.2745s/iter; left time: 5282.8287s
	iters: 200, epoch: 8 | loss: 3.5320628
	speed: 0.0749s/iter; left time: 1434.2981s
Epoch: 8 cost time: 16.6535484790802
Epoch: 8, Steps: 208 | Train Loss: 3.981 Vali Loss: 3.776 Vali Acc: 0.026 Test Loss: 3.776 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 3.8385100
	speed: 0.2644s/iter; left time: 5032.7104s
	iters: 200, epoch: 9 | loss: 3.9564970
	speed: 0.0960s/iter; left time: 1818.4399s
Epoch: 9 cost time: 20.912189245224
Epoch: 9, Steps: 208 | Train Loss: 3.789 Vali Loss: 3.763 Vali Acc: 0.026 Test Loss: 3.763 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 3.8142056
	speed: 0.2752s/iter; left time: 5182.5979s
	iters: 200, epoch: 10 | loss: 3.8617702
	speed: 0.0831s/iter; left time: 1556.6059s
Epoch: 10 cost time: 18.575404167175293
Epoch: 10, Steps: 208 | Train Loss: 3.750 Vali Loss: 3.699 Vali Acc: 0.026 Test Loss: 3.699 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 3.7184985
	speed: 0.2790s/iter; left time: 5195.8925s
	iters: 200, epoch: 11 | loss: 3.7842047
	speed: 0.0962s/iter; left time: 1782.5961s
Epoch: 11 cost time: 19.974753856658936
Epoch: 11, Steps: 208 | Train Loss: 3.724 Vali Loss: 3.697 Vali Acc: 0.026 Test Loss: 3.697 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 3.7621312
	speed: 0.2604s/iter; left time: 4795.1790s
	iters: 200, epoch: 12 | loss: 3.8120394
	speed: 0.0846s/iter; left time: 1549.0727s
Epoch: 12 cost time: 18.799225091934204
Epoch: 12, Steps: 208 | Train Loss: 3.732 Vali Loss: 3.682 Vali Acc: 0.026 Test Loss: 3.682 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 3.7677670
	speed: 0.2754s/iter; left time: 5013.7918s
	iters: 200, epoch: 13 | loss: 3.6853619
	speed: 0.0890s/iter; left time: 1610.9666s
Epoch: 13 cost time: 19.731014490127563
Epoch: 13, Steps: 208 | Train Loss: 3.723 Vali Loss: 3.686 Vali Acc: 0.026 Test Loss: 3.686 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 3.8044915
	speed: 0.2794s/iter; left time: 5028.2418s
	iters: 200, epoch: 14 | loss: 3.5880868
	speed: 0.0973s/iter; left time: 1740.9465s
Epoch: 14 cost time: 20.281585454940796
Epoch: 14, Steps: 208 | Train Loss: 3.711 Vali Loss: 3.673 Vali Acc: 0.026 Test Loss: 3.673 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.07903370116313749
model parameter : 11696727
model size : 49.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.0798531
	speed: 0.1167s/iter; left time: 2415.5733s
	iters: 200, epoch: 1 | loss: 4.0222611
	speed: 0.0963s/iter; left time: 1984.2937s
Epoch: 1 cost time: 22.07786536216736
Epoch: 1, Steps: 208 | Train Loss: 4.194 Vali Loss: 3.761 Vali Acc: 0.059 Test Loss: 3.761 Test Acc: 0.059
Validation loss decreased (inf --> -0.059014).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3304431
	speed: 0.2692s/iter; left time: 5515.7538s
	iters: 200, epoch: 2 | loss: 3.7128360
	speed: 0.0892s/iter; left time: 1819.7931s
Epoch: 2 cost time: 19.07974338531494
Epoch: 2, Steps: 208 | Train Loss: 3.718 Vali Loss: 3.643 Vali Acc: 0.047 Test Loss: 3.643 Test Acc: 0.047
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.6668789
	speed: 0.2826s/iter; left time: 5733.0335s
	iters: 200, epoch: 3 | loss: 3.8178017
	speed: 0.1015s/iter; left time: 2049.1046s
Epoch: 3 cost time: 21.183173894882202
Epoch: 3, Steps: 208 | Train Loss: 3.549 Vali Loss: 3.675 Vali Acc: 0.071 Test Loss: 3.675 Test Acc: 0.071
Validation loss decreased (-0.059014 --> -0.071243).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4416187
	speed: 0.2631s/iter; left time: 5283.2313s
	iters: 200, epoch: 4 | loss: 2.9572723
	speed: 0.0828s/iter; left time: 1654.8349s
Epoch: 4 cost time: 17.797680139541626
Epoch: 4, Steps: 208 | Train Loss: 3.384 Vali Loss: 3.332 Vali Acc: 0.088 Test Loss: 3.332 Test Acc: 0.088
Validation loss decreased (-0.071243 --> -0.088246).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.4760575
	speed: 0.2792s/iter; left time: 5547.4974s
	iters: 200, epoch: 5 | loss: 3.5181179
	speed: 0.0996s/iter; left time: 1969.6724s
Epoch: 5 cost time: 21.628560066223145
Epoch: 5, Steps: 208 | Train Loss: 3.331 Vali Loss: 3.460 Vali Acc: 0.052 Test Loss: 3.460 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.7945979
	speed: 0.2733s/iter; left time: 5372.7142s
	iters: 200, epoch: 6 | loss: 3.8537054
	speed: 0.0911s/iter; left time: 1781.3374s
Epoch: 6 cost time: 19.4354407787323
Epoch: 6, Steps: 208 | Train Loss: 3.708 Vali Loss: 3.933 Vali Acc: 0.026 Test Loss: 3.933 Test Acc: 0.026
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 3.7528207
	speed: 0.2424s/iter; left time: 4715.7049s
	iters: 200, epoch: 7 | loss: 3.9988289
	speed: 0.0826s/iter; left time: 1598.3983s
Epoch: 7 cost time: 17.134783029556274
Epoch: 7, Steps: 208 | Train Loss: 3.811 Vali Loss: 3.870 Vali Acc: 0.025 Test Loss: 3.870 Test Acc: 0.025
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 3.7336166
	speed: 0.2811s/iter; left time: 5410.1878s
	iters: 200, epoch: 8 | loss: 3.6761363
	speed: 0.1029s/iter; left time: 1970.5715s
Epoch: 8 cost time: 21.333268404006958
Epoch: 8, Steps: 208 | Train Loss: 3.750 Vali Loss: 3.705 Vali Acc: 0.026 Test Loss: 3.705 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 3.6893592
	speed: 0.2764s/iter; left time: 5262.5720s
	iters: 200, epoch: 9 | loss: 3.9085710
	speed: 0.0976s/iter; left time: 1847.5559s
Epoch: 9 cost time: 20.21492862701416
Epoch: 9, Steps: 208 | Train Loss: 3.714 Vali Loss: 3.700 Vali Acc: 0.026 Test Loss: 3.700 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 3.7769461
	speed: 0.2624s/iter; left time: 4940.2790s
	iters: 200, epoch: 10 | loss: 3.7135701
	speed: 0.0849s/iter; left time: 1589.2315s
Epoch: 10 cost time: 17.457735538482666
Epoch: 10, Steps: 208 | Train Loss: 3.711 Vali Loss: 3.704 Vali Acc: 0.026 Test Loss: 3.704 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 3.6678648
	speed: 0.2814s/iter; left time: 5240.0085s
	iters: 200, epoch: 11 | loss: 3.6790857
	speed: 0.0914s/iter; left time: 1692.6376s
Epoch: 11 cost time: 19.94136643409729
Epoch: 11, Steps: 208 | Train Loss: 3.706 Vali Loss: 3.696 Vali Acc: 0.026 Test Loss: 3.696 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 3.7264075
	speed: 0.2680s/iter; left time: 4934.2538s
	iters: 200, epoch: 12 | loss: 3.6147604
	speed: 0.0944s/iter; left time: 1729.0543s
Epoch: 12 cost time: 20.50250482559204
Epoch: 12, Steps: 208 | Train Loss: 3.704 Vali Loss: 3.692 Vali Acc: 0.026 Test Loss: 3.692 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 3.6558840
	speed: 0.2697s/iter; left time: 4910.4086s
	iters: 200, epoch: 13 | loss: 3.6495910
	speed: 0.0896s/iter; left time: 1622.2747s
Epoch: 13 cost time: 19.622363328933716
Epoch: 13, Steps: 208 | Train Loss: 3.701 Vali Loss: 3.697 Vali Acc: 0.026 Test Loss: 3.697 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 3.6729088
	speed: 0.2608s/iter; left time: 4693.7733s
	iters: 200, epoch: 14 | loss: 3.7345574
	speed: 0.0871s/iter; left time: 1558.6356s
Epoch: 14 cost time: 18.862563133239746
Epoch: 14, Steps: 208 | Train Loss: 3.700 Vali Loss: 3.698 Vali Acc: 0.025 Test Loss: 3.698 Test Acc: 0.025
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08827915299731584
model parameter : 9884247
model size : 42.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.1599026
	speed: 0.1113s/iter; left time: 2303.3862s
	iters: 200, epoch: 1 | loss: 4.3079133
	speed: 0.0916s/iter; left time: 1886.4039s
Epoch: 1 cost time: 21.12973403930664
Epoch: 1, Steps: 208 | Train Loss: 4.153 Vali Loss: 3.844 Vali Acc: 0.039 Test Loss: 3.844 Test Acc: 0.039
Validation loss decreased (inf --> -0.039329).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9409146
	speed: 0.2697s/iter; left time: 5526.5729s
	iters: 200, epoch: 2 | loss: 3.8348677
	speed: 0.1003s/iter; left time: 2046.0137s
Epoch: 2 cost time: 19.649996519088745
Epoch: 2, Steps: 208 | Train Loss: 3.734 Vali Loss: 3.713 Vali Acc: 0.062 Test Loss: 3.713 Test Acc: 0.062
Validation loss decreased (-0.039329 --> -0.061699).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3807971
	speed: 0.2726s/iter; left time: 5528.7326s
	iters: 200, epoch: 3 | loss: 3.0952079
	speed: 0.0851s/iter; left time: 1718.4210s
Epoch: 3 cost time: 19.034067153930664
Epoch: 3, Steps: 208 | Train Loss: 3.607 Vali Loss: 3.519 Vali Acc: 0.061 Test Loss: 3.519 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.4003329
	speed: 0.2758s/iter; left time: 5537.1858s
	iters: 200, epoch: 4 | loss: 3.5441372
	speed: 0.0854s/iter; left time: 1705.9745s
Epoch: 4 cost time: 18.82013463973999
Epoch: 4, Steps: 208 | Train Loss: 3.432 Vali Loss: 3.426 Vali Acc: 0.078 Test Loss: 3.426 Test Acc: 0.078
Validation loss decreased (-0.061699 --> -0.077806).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.0967658
	speed: 0.2609s/iter; left time: 5184.6784s
	iters: 200, epoch: 5 | loss: 3.2206707
	speed: 0.0834s/iter; left time: 1648.5898s
Epoch: 5 cost time: 17.551820516586304
Epoch: 5, Steps: 208 | Train Loss: 3.326 Vali Loss: 3.321 Vali Acc: 0.081 Test Loss: 3.321 Test Acc: 0.081
Validation loss decreased (-0.077806 --> -0.081386).  Saving model ...
	iters: 100, epoch: 6 | loss: 4.1685615
	speed: 0.2688s/iter; left time: 5285.5455s
	iters: 200, epoch: 6 | loss: 3.8638043
	speed: 0.0878s/iter; left time: 1716.9136s
Epoch: 6 cost time: 19.11653757095337
Epoch: 6, Steps: 208 | Train Loss: 3.675 Vali Loss: 3.753 Vali Acc: 0.026 Test Loss: 3.753 Test Acc: 0.026
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.9779723
	speed: 0.2699s/iter; left time: 5250.0726s
	iters: 200, epoch: 7 | loss: 3.8017182
	speed: 0.0893s/iter; left time: 1727.3861s
Epoch: 7 cost time: 18.443939208984375
Epoch: 7, Steps: 208 | Train Loss: 3.813 Vali Loss: 3.818 Vali Acc: 0.026 Test Loss: 3.818 Test Acc: 0.026
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.6946862
	speed: 0.2603s/iter; left time: 5009.9290s
	iters: 200, epoch: 8 | loss: 3.7382815
	speed: 0.0943s/iter; left time: 1805.5181s
Epoch: 8 cost time: 19.865006923675537
Epoch: 8, Steps: 208 | Train Loss: 3.750 Vali Loss: 3.721 Vali Acc: 0.026 Test Loss: 3.721 Test Acc: 0.026
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 3.7675912
	speed: 0.2477s/iter; left time: 4715.5394s
	iters: 200, epoch: 9 | loss: 3.5691626
	speed: 0.0889s/iter; left time: 1684.0917s
Epoch: 9 cost time: 18.29628324508667
Epoch: 9, Steps: 208 | Train Loss: 3.715 Vali Loss: 3.762 Vali Acc: 0.026 Test Loss: 3.762 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 3.7927845
	speed: 0.2510s/iter; left time: 4726.0948s
	iters: 200, epoch: 10 | loss: 3.7308257
	speed: 0.0813s/iter; left time: 1522.8412s
Epoch: 10 cost time: 17.800700664520264
Epoch: 10, Steps: 208 | Train Loss: 3.713 Vali Loss: 3.687 Vali Acc: 0.026 Test Loss: 3.687 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 3.7582562
	speed: 0.2603s/iter; left time: 4846.9880s
	iters: 200, epoch: 11 | loss: 3.6116955
	speed: 0.0928s/iter; left time: 1719.4084s
Epoch: 11 cost time: 19.778888463974
Epoch: 11, Steps: 208 | Train Loss: 3.699 Vali Loss: 3.693 Vali Acc: 0.026 Test Loss: 3.693 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 3.5487688
	speed: 0.2430s/iter; left time: 4473.7145s
	iters: 200, epoch: 12 | loss: 3.6932759
	speed: 0.0813s/iter; left time: 1489.1896s
Epoch: 12 cost time: 17.25659942626953
Epoch: 12, Steps: 208 | Train Loss: 3.701 Vali Loss: 3.687 Vali Acc: 0.026 Test Loss: 3.687 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 3.6608651
	speed: 0.2590s/iter; left time: 4715.4316s
	iters: 200, epoch: 13 | loss: 3.7274687
	speed: 0.0711s/iter; left time: 1287.7459s
Epoch: 13 cost time: 16.271146297454834
Epoch: 13, Steps: 208 | Train Loss: 3.698 Vali Loss: 3.715 Vali Acc: 0.026 Test Loss: 3.715 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 3.7734914
	speed: 0.2595s/iter; left time: 4669.9208s
	iters: 200, epoch: 14 | loss: 3.6208799
	speed: 0.0932s/iter; left time: 1668.7837s
Epoch: 14 cost time: 19.774856328964233
Epoch: 14, Steps: 208 | Train Loss: 3.700 Vali Loss: 3.707 Vali Acc: 0.026 Test Loss: 3.707 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 3.6888285
	speed: 0.2508s/iter; left time: 4461.2530s
	iters: 200, epoch: 15 | loss: 3.6730611
	speed: 0.0852s/iter; left time: 1506.3580s
Epoch: 15 cost time: 17.85671615600586
Epoch: 15, Steps: 208 | Train Loss: 3.697 Vali Loss: 3.683 Vali Acc: 0.026 Test Loss: 3.683 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.081419624217119
model parameter : 9875543
model size : 42.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.7408929
	speed: 0.0976s/iter; left time: 2020.7291s
	iters: 200, epoch: 1 | loss: 4.1158991
	speed: 0.0801s/iter; left time: 1650.9921s
Epoch: 1 cost time: 18.531236171722412
Epoch: 1, Steps: 208 | Train Loss: 4.203 Vali Loss: 3.892 Vali Acc: 0.044 Test Loss: 3.892 Test Acc: 0.044
Validation loss decreased (inf --> -0.044399).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7310193
	speed: 0.2308s/iter; left time: 4730.7186s
	iters: 200, epoch: 2 | loss: 3.2938466
	speed: 0.0823s/iter; left time: 1678.5524s
Epoch: 2 cost time: 17.865530967712402
Epoch: 2, Steps: 208 | Train Loss: 3.782 Vali Loss: 3.840 Vali Acc: 0.026 Test Loss: 3.840 Test Acc: 0.026
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.2176168
	speed: 0.2351s/iter; left time: 4769.8223s
	iters: 200, epoch: 3 | loss: 3.1544015
	speed: 0.0820s/iter; left time: 1654.1717s
Epoch: 3 cost time: 17.127686023712158
Epoch: 3, Steps: 208 | Train Loss: 3.623 Vali Loss: 3.523 Vali Acc: 0.074 Test Loss: 3.523 Test Acc: 0.074
Validation loss decreased (-0.044399 --> -0.073630).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.0256553
	speed: 0.2603s/iter; left time: 5226.8538s
	iters: 200, epoch: 4 | loss: 3.3728452
	speed: 0.0880s/iter; left time: 1758.0422s
Epoch: 4 cost time: 19.122549295425415
Epoch: 4, Steps: 208 | Train Loss: 3.471 Vali Loss: 3.387 Vali Acc: 0.069 Test Loss: 3.387 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.6646886
	speed: 0.2451s/iter; left time: 4868.9979s
	iters: 200, epoch: 5 | loss: 3.2104220
	speed: 0.0826s/iter; left time: 1631.9402s
Epoch: 5 cost time: 17.92880129814148
Epoch: 5, Steps: 208 | Train Loss: 3.354 Vali Loss: 3.434 Vali Acc: 0.081 Test Loss: 3.434 Test Acc: 0.081
Validation loss decreased (-0.073630 --> -0.080789).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.5754519
	speed: 0.2461s/iter; left time: 4839.3178s
	iters: 200, epoch: 6 | loss: 3.5787709
	speed: 0.0732s/iter; left time: 1432.1630s
Epoch: 6 cost time: 15.987950325012207
Epoch: 6, Steps: 208 | Train Loss: 3.653 Vali Loss: 3.743 Vali Acc: 0.026 Test Loss: 3.743 Test Acc: 0.026
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.8905921
	speed: 0.2300s/iter; left time: 4475.0780s
	iters: 200, epoch: 7 | loss: 3.7258098
	speed: 0.0693s/iter; left time: 1341.5922s
Epoch: 7 cost time: 14.901292085647583
Epoch: 7, Steps: 208 | Train Loss: 3.809 Vali Loss: 3.722 Vali Acc: 0.026 Test Loss: 3.722 Test Acc: 0.026
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.4744961
	speed: 0.2447s/iter; left time: 4708.8603s
	iters: 200, epoch: 8 | loss: 3.6941736
	speed: 0.0854s/iter; left time: 1634.1398s
Epoch: 8 cost time: 18.863814115524292
Epoch: 8, Steps: 208 | Train Loss: 3.745 Vali Loss: 3.753 Vali Acc: 0.026 Test Loss: 3.753 Test Acc: 0.026
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 3.6254399
	speed: 0.2405s/iter; left time: 4579.3047s
	iters: 200, epoch: 9 | loss: 3.7131937
	speed: 0.0766s/iter; left time: 1451.3022s
Epoch: 9 cost time: 16.793153285980225
Epoch: 9, Steps: 208 | Train Loss: 3.723 Vali Loss: 3.741 Vali Acc: 0.026 Test Loss: 3.741 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 3.7567055
	speed: 0.2462s/iter; left time: 4635.7336s
	iters: 200, epoch: 10 | loss: 3.5773783
	speed: 0.0922s/iter; left time: 1726.3639s
Epoch: 10 cost time: 19.21686100959778
Epoch: 10, Steps: 208 | Train Loss: 3.718 Vali Loss: 3.706 Vali Acc: 0.026 Test Loss: 3.706 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 3.7555957
	speed: 0.2446s/iter; left time: 4555.4715s
	iters: 200, epoch: 11 | loss: 3.7196548
	speed: 0.0765s/iter; left time: 1416.6050s
Epoch: 11 cost time: 16.63371706008911
Epoch: 11, Steps: 208 | Train Loss: 3.710 Vali Loss: 3.687 Vali Acc: 0.026 Test Loss: 3.687 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 3.7670858
	speed: 0.2286s/iter; left time: 4208.7664s
	iters: 200, epoch: 12 | loss: 3.6353600
	speed: 0.0811s/iter; left time: 1485.1615s
Epoch: 12 cost time: 17.206701278686523
Epoch: 12, Steps: 208 | Train Loss: 3.702 Vali Loss: 3.693 Vali Acc: 0.025 Test Loss: 3.693 Test Acc: 0.025
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 3.8059990
	speed: 0.2546s/iter; left time: 4634.2147s
	iters: 200, epoch: 13 | loss: 3.8040018
	speed: 0.0899s/iter; left time: 1628.2530s
Epoch: 13 cost time: 19.068180322647095
Epoch: 13, Steps: 208 | Train Loss: 3.690 Vali Loss: 3.736 Vali Acc: 0.026 Test Loss: 3.736 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 3.7425973
	speed: 0.2351s/iter; left time: 4231.9406s
	iters: 200, epoch: 14 | loss: 3.7827737
	speed: 0.0801s/iter; left time: 1433.2586s
Epoch: 14 cost time: 17.367830276489258
Epoch: 14, Steps: 208 | Train Loss: 3.710 Vali Loss: 3.689 Vali Acc: 0.026 Test Loss: 3.689 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 3.6619947
	speed: 0.2606s/iter; left time: 4636.6591s
	iters: 200, epoch: 15 | loss: 3.7119460
	speed: 0.0825s/iter; left time: 1459.9074s
Epoch: 15 cost time: 18.336092472076416
Epoch: 15, Steps: 208 | Train Loss: 3.699 Vali Loss: 3.696 Vali Acc: 0.026 Test Loss: 3.696 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08082314345362362
model parameter : 9866839
model size : 42.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.5941548
	speed: 0.1023s/iter; left time: 2117.2053s
	iters: 200, epoch: 1 | loss: 4.5671630
	speed: 0.0868s/iter; left time: 1787.6677s
Epoch: 1 cost time: 19.770620822906494
Epoch: 1, Steps: 208 | Train Loss: 4.065 Vali Loss: 3.860 Vali Acc: 0.045 Test Loss: 3.860 Test Acc: 0.045
Validation loss decreased (inf --> -0.044996).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.0966105
	speed: 0.2406s/iter; left time: 4931.5271s
	iters: 200, epoch: 2 | loss: 3.7131047
	speed: 0.0736s/iter; left time: 1500.8510s
Epoch: 2 cost time: 16.503318548202515
Epoch: 2, Steps: 208 | Train Loss: 3.742 Vali Loss: 3.735 Vali Acc: 0.042 Test Loss: 3.735 Test Acc: 0.042
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.3231468
	speed: 0.2468s/iter; left time: 5005.8840s
	iters: 200, epoch: 3 | loss: 3.5251763
	speed: 0.0825s/iter; left time: 1666.0400s
Epoch: 3 cost time: 17.45121431350708
Epoch: 3, Steps: 208 | Train Loss: 3.609 Vali Loss: 3.449 Vali Acc: 0.062 Test Loss: 3.449 Test Acc: 0.062
Validation loss decreased (-0.044996 --> -0.062298).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2658751
	speed: 0.2399s/iter; left time: 4817.3514s
	iters: 200, epoch: 4 | loss: 3.2751985
	speed: 0.0859s/iter; left time: 1716.5569s
Epoch: 4 cost time: 17.277769088745117
Epoch: 4, Steps: 208 | Train Loss: 3.459 Vali Loss: 3.411 Vali Acc: 0.072 Test Loss: 3.411 Test Acc: 0.072
Validation loss decreased (-0.062298 --> -0.072438).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.0049953
	speed: 0.2322s/iter; left time: 4614.3281s
	iters: 200, epoch: 5 | loss: 3.3778667
	speed: 0.0804s/iter; left time: 1589.1892s
Epoch: 5 cost time: 17.43220829963684
Epoch: 5, Steps: 208 | Train Loss: 3.324 Vali Loss: 3.268 Vali Acc: 0.092 Test Loss: 3.268 Test Acc: 0.092
Validation loss decreased (-0.072438 --> -0.091825).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.9097445
	speed: 0.2575s/iter; left time: 5061.7556s
	iters: 200, epoch: 6 | loss: 3.6967149
	speed: 0.0818s/iter; left time: 1599.9968s
Epoch: 6 cost time: 18.12209725379944
Epoch: 6, Steps: 208 | Train Loss: 3.516 Vali Loss: 3.779 Vali Acc: 0.026 Test Loss: 3.779 Test Acc: 0.026
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.9420288
	speed: 0.2304s/iter; left time: 4481.0079s
	iters: 200, epoch: 7 | loss: 3.5506589
	speed: 0.0781s/iter; left time: 1511.2390s
Epoch: 7 cost time: 16.867213249206543
Epoch: 7, Steps: 208 | Train Loss: 3.812 Vali Loss: 3.792 Vali Acc: 0.026 Test Loss: 3.792 Test Acc: 0.026
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.5793133
	speed: 0.2389s/iter; left time: 4598.1403s
	iters: 200, epoch: 8 | loss: 3.7809162
	speed: 0.0829s/iter; left time: 1587.1766s
Epoch: 8 cost time: 17.84265375137329
Epoch: 8, Steps: 208 | Train Loss: 3.768 Vali Loss: 3.750 Vali Acc: 0.026 Test Loss: 3.750 Test Acc: 0.026
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 3.7769582
	speed: 0.2466s/iter; left time: 4695.3531s
	iters: 200, epoch: 9 | loss: 3.6159930
	speed: 0.0739s/iter; left time: 1399.9478s
Epoch: 9 cost time: 16.632002353668213
Epoch: 9, Steps: 208 | Train Loss: 3.721 Vali Loss: 3.729 Vali Acc: 0.027 Test Loss: 3.729 Test Acc: 0.027
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 3.7176676
	speed: 0.2436s/iter; left time: 4586.8477s
	iters: 200, epoch: 10 | loss: 3.6354938
	speed: 0.0778s/iter; left time: 1457.7639s
Epoch: 10 cost time: 16.769548654556274
Epoch: 10, Steps: 208 | Train Loss: 3.697 Vali Loss: 3.682 Vali Acc: 0.034 Test Loss: 3.682 Test Acc: 0.034
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 3.8247807
	speed: 0.2402s/iter; left time: 4472.8917s
	iters: 200, epoch: 11 | loss: 3.5616312
	speed: 0.0823s/iter; left time: 1525.1320s
Epoch: 11 cost time: 17.807053804397583
Epoch: 11, Steps: 208 | Train Loss: 3.681 Vali Loss: 3.688 Vali Acc: 0.030 Test Loss: 3.688 Test Acc: 0.030
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 3.7264650
	speed: 0.2488s/iter; left time: 4581.2669s
	iters: 200, epoch: 12 | loss: 3.6205952
	speed: 0.0761s/iter; left time: 1394.2659s
Epoch: 12 cost time: 17.06756353378296
Epoch: 12, Steps: 208 | Train Loss: 3.692 Vali Loss: 3.662 Vali Acc: 0.034 Test Loss: 3.662 Test Acc: 0.034
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 3.7408297
	speed: 0.2447s/iter; left time: 4454.0416s
	iters: 200, epoch: 13 | loss: 3.7273564
	speed: 0.0790s/iter; left time: 1430.5642s
Epoch: 13 cost time: 16.69902205467224
Epoch: 13, Steps: 208 | Train Loss: 3.767 Vali Loss: 3.692 Vali Acc: 0.026 Test Loss: 3.692 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 3.7367733
	speed: 0.2291s/iter; left time: 4123.0197s
	iters: 200, epoch: 14 | loss: 3.5977376
	speed: 0.0810s/iter; left time: 1450.4446s
Epoch: 14 cost time: 17.67110848426819
Epoch: 14, Steps: 208 | Train Loss: 3.967 Vali Loss: 3.885 Vali Acc: 0.026 Test Loss: 3.885 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 3.8617945
	speed: 0.2426s/iter; left time: 4316.4593s
	iters: 200, epoch: 15 | loss: 3.7508230
	speed: 0.0832s/iter; left time: 1472.3563s
Epoch: 15 cost time: 17.985397815704346
Epoch: 15, Steps: 208 | Train Loss: 3.799 Vali Loss: 3.700 Vali Acc: 0.026 Test Loss: 3.700 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.0918580375782881
model parameter : 9858135
model size : 42.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0185623
	speed: 0.1120s/iter; left time: 2319.3648s
	iters: 200, epoch: 1 | loss: 3.8520584
	speed: 0.0957s/iter; left time: 1971.2124s
Epoch: 1 cost time: 21.50459885597229
Epoch: 1, Steps: 208 | Train Loss: 4.125 Vali Loss: 3.806 Vali Acc: 0.024 Test Loss: 3.806 Test Acc: 0.024
Validation loss decreased (inf --> -0.024418).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6014531
	speed: 0.2605s/iter; left time: 5339.4093s
	iters: 200, epoch: 2 | loss: 3.6510463
	speed: 0.0873s/iter; left time: 1780.0289s
Epoch: 2 cost time: 18.66886615753174
Epoch: 2, Steps: 208 | Train Loss: 3.775 Vali Loss: 3.801 Vali Acc: 0.049 Test Loss: 3.801 Test Acc: 0.049
Validation loss decreased (-0.024418 --> -0.049172).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3191407
	speed: 0.2558s/iter; left time: 5187.9930s
	iters: 200, epoch: 3 | loss: 3.8695266
	speed: 0.0766s/iter; left time: 1546.3949s
Epoch: 3 cost time: 17.362217664718628
Epoch: 3, Steps: 208 | Train Loss: 3.587 Vali Loss: 3.470 Vali Acc: 0.073 Test Loss: 3.470 Test Acc: 0.073
Validation loss decreased (-0.049172 --> -0.073034).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4240766
	speed: 0.2712s/iter; left time: 5444.7024s
	iters: 200, epoch: 4 | loss: 3.7685926
	speed: 0.0890s/iter; left time: 1778.0621s
Epoch: 4 cost time: 19.89058804512024
Epoch: 4, Steps: 208 | Train Loss: 3.410 Vali Loss: 3.367 Vali Acc: 0.075 Test Loss: 3.367 Test Acc: 0.075
Validation loss decreased (-0.073034 --> -0.075123).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.5879042
	speed: 0.2693s/iter; left time: 5350.0121s
	iters: 200, epoch: 5 | loss: 3.5735960
	speed: 0.0902s/iter; left time: 1782.8231s
Epoch: 5 cost time: 18.763713121414185
Epoch: 5, Steps: 208 | Train Loss: 3.299 Vali Loss: 3.386 Vali Acc: 0.077 Test Loss: 3.386 Test Acc: 0.077
Validation loss decreased (-0.075123 --> -0.076614).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2036161
	speed: 0.2720s/iter; left time: 5347.8308s
	iters: 200, epoch: 6 | loss: 3.6693742
	speed: 0.0893s/iter; left time: 1747.6889s
Epoch: 6 cost time: 19.155292510986328
Epoch: 6, Steps: 208 | Train Loss: 3.493 Vali Loss: 3.683 Vali Acc: 0.034 Test Loss: 3.683 Test Acc: 0.034
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.7857709
	speed: 0.2509s/iter; left time: 4880.5219s
	iters: 200, epoch: 7 | loss: 3.7508790
	speed: 0.0690s/iter; left time: 1336.0390s
Epoch: 7 cost time: 16.33054280281067
Epoch: 7, Steps: 208 | Train Loss: 3.782 Vali Loss: 3.794 Vali Acc: 0.026 Test Loss: 3.794 Test Acc: 0.026
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.7287295
	speed: 0.2560s/iter; left time: 4926.8126s
	iters: 200, epoch: 8 | loss: 3.6434102
	speed: 0.0784s/iter; left time: 1501.4636s
Epoch: 8 cost time: 17.977749586105347
Epoch: 8, Steps: 208 | Train Loss: 3.757 Vali Loss: 3.721 Vali Acc: 0.026 Test Loss: 3.721 Test Acc: 0.026
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 3.7473261
	speed: 0.2514s/iter; left time: 4785.9835s
	iters: 200, epoch: 9 | loss: 3.7270362
	speed: 0.0912s/iter; left time: 1726.6796s
Epoch: 9 cost time: 19.267255544662476
Epoch: 9, Steps: 208 | Train Loss: 3.730 Vali Loss: 3.719 Vali Acc: 0.026 Test Loss: 3.719 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 3.7252383
	speed: 0.2529s/iter; left time: 4761.4541s
	iters: 200, epoch: 10 | loss: 3.7505829
	speed: 0.0848s/iter; left time: 1588.8951s
Epoch: 10 cost time: 18.769970178604126
Epoch: 10, Steps: 208 | Train Loss: 3.707 Vali Loss: 3.724 Vali Acc: 0.026 Test Loss: 3.724 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 3.7149584
	speed: 0.2630s/iter; left time: 4897.4877s
	iters: 200, epoch: 11 | loss: 3.7017045
	speed: 0.0892s/iter; left time: 1652.0409s
Epoch: 11 cost time: 19.315141201019287
Epoch: 11, Steps: 208 | Train Loss: 3.708 Vali Loss: 3.714 Vali Acc: 0.026 Test Loss: 3.714 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 3.8479326
	speed: 0.2409s/iter; left time: 4436.1296s
	iters: 200, epoch: 12 | loss: 3.7363367
	speed: 0.0911s/iter; left time: 1669.0684s
Epoch: 12 cost time: 18.3275043964386
Epoch: 12, Steps: 208 | Train Loss: 3.706 Vali Loss: 3.686 Vali Acc: 0.026 Test Loss: 3.686 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 3.7358894
	speed: 0.2535s/iter; left time: 4615.2123s
	iters: 200, epoch: 13 | loss: 3.6819324
	speed: 0.0857s/iter; left time: 1551.7085s
Epoch: 13 cost time: 18.359089374542236
Epoch: 13, Steps: 208 | Train Loss: 3.698 Vali Loss: 3.681 Vali Acc: 0.026 Test Loss: 3.681 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 3.6862295
	speed: 0.2710s/iter; left time: 4877.8642s
	iters: 200, epoch: 14 | loss: 3.6339233
	speed: 0.0848s/iter; left time: 1518.1420s
Epoch: 14 cost time: 18.367397785186768
Epoch: 14, Steps: 208 | Train Loss: 3.693 Vali Loss: 3.702 Vali Acc: 0.026 Test Loss: 3.702 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 3.5935900
	speed: 0.2660s/iter; left time: 4731.1651s
	iters: 200, epoch: 15 | loss: 3.6935346
	speed: 0.0787s/iter; left time: 1392.4712s
Epoch: 15 cost time: 18.06558609008789
Epoch: 15, Steps: 208 | Train Loss: 3.698 Vali Loss: 3.696 Vali Acc: 0.026 Test Loss: 3.696 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.07664777810915598
model parameter : 8964951
model size : 39.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.5355749
	speed: 0.1009s/iter; left time: 2088.7318s
	iters: 200, epoch: 1 | loss: 3.6403995
	speed: 0.0755s/iter; left time: 1554.6615s
Epoch: 1 cost time: 18.47673749923706
Epoch: 1, Steps: 208 | Train Loss: 4.091 Vali Loss: 3.984 Vali Acc: 0.048 Test Loss: 3.984 Test Acc: 0.048
Validation loss decreased (inf --> -0.047679).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6255264
	speed: 0.2455s/iter; left time: 5030.6676s
	iters: 200, epoch: 2 | loss: 3.7258134
	speed: 0.0883s/iter; left time: 1800.6546s
Epoch: 2 cost time: 18.587705850601196
Epoch: 2, Steps: 208 | Train Loss: 3.729 Vali Loss: 3.648 Vali Acc: 0.053 Test Loss: 3.648 Test Acc: 0.053
Validation loss decreased (-0.047679 --> -0.052752).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7808263
	speed: 0.2396s/iter; left time: 4860.7083s
	iters: 200, epoch: 3 | loss: 3.5172863
	speed: 0.0821s/iter; left time: 1656.9229s
Epoch: 3 cost time: 17.216538906097412
Epoch: 3, Steps: 208 | Train Loss: 3.556 Vali Loss: 3.585 Vali Acc: 0.072 Test Loss: 3.585 Test Acc: 0.072
Validation loss decreased (-0.052752 --> -0.072437).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.1528513
	speed: 0.2398s/iter; left time: 4815.0482s
	iters: 200, epoch: 4 | loss: 3.1319335
	speed: 0.0761s/iter; left time: 1520.9484s
Epoch: 4 cost time: 16.838548183441162
Epoch: 4, Steps: 208 | Train Loss: 3.433 Vali Loss: 3.427 Vali Acc: 0.063 Test Loss: 3.427 Test Acc: 0.063
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.9167974
	speed: 0.2421s/iter; left time: 4810.8233s
	iters: 200, epoch: 5 | loss: 3.4486923
	speed: 0.0873s/iter; left time: 1725.3086s
Epoch: 5 cost time: 18.672105312347412
Epoch: 5, Steps: 208 | Train Loss: 3.305 Vali Loss: 3.241 Vali Acc: 0.081 Test Loss: 3.241 Test Acc: 0.081
Validation loss decreased (-0.072437 --> -0.081387).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.7011032
	speed: 0.2387s/iter; left time: 4693.2229s
	iters: 200, epoch: 6 | loss: 3.4967177
	speed: 0.0754s/iter; left time: 1474.6556s
Epoch: 6 cost time: 15.743368148803711
Epoch: 6, Steps: 208 | Train Loss: 3.523 Vali Loss: 3.588 Vali Acc: 0.036 Test Loss: 3.588 Test Acc: 0.036
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.6990721
	speed: 0.2593s/iter; left time: 5044.4765s
	iters: 200, epoch: 7 | loss: 3.4948444
	speed: 0.0757s/iter; left time: 1464.7288s
Epoch: 7 cost time: 17.358479022979736
Epoch: 7, Steps: 208 | Train Loss: 3.630 Vali Loss: 3.578 Vali Acc: 0.044 Test Loss: 3.578 Test Acc: 0.044
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.6330404
	speed: 0.2676s/iter; left time: 5150.5799s
	iters: 200, epoch: 8 | loss: 3.9739082
	speed: 0.0931s/iter; left time: 1782.7002s
Epoch: 8 cost time: 19.8170166015625
Epoch: 8, Steps: 208 | Train Loss: 3.680 Vali Loss: 3.584 Vali Acc: 0.038 Test Loss: 3.584 Test Acc: 0.038
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 3.4357727
	speed: 0.2414s/iter; left time: 4596.0331s
	iters: 200, epoch: 9 | loss: 3.4948599
	speed: 0.0769s/iter; left time: 1455.9045s
Epoch: 9 cost time: 16.692724466323853
Epoch: 9, Steps: 208 | Train Loss: 3.641 Vali Loss: 3.719 Vali Acc: 0.041 Test Loss: 3.719 Test Acc: 0.041
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 3.7513239
	speed: 0.2614s/iter; left time: 4922.2131s
	iters: 200, epoch: 10 | loss: 3.7474744
	speed: 0.0853s/iter; left time: 1597.2099s
Epoch: 10 cost time: 18.249794006347656
Epoch: 10, Steps: 208 | Train Loss: 3.716 Vali Loss: 3.650 Vali Acc: 0.032 Test Loss: 3.650 Test Acc: 0.032
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 3.8537555
	speed: 0.2518s/iter; left time: 4689.2629s
	iters: 200, epoch: 11 | loss: 4.5442777
	speed: 0.0921s/iter; left time: 1705.9704s
Epoch: 11 cost time: 19.140966176986694
Epoch: 11, Steps: 208 | Train Loss: 3.882 Vali Loss: 4.075 Vali Acc: 0.034 Test Loss: 4.075 Test Acc: 0.034
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 4.2252793
	speed: 0.2520s/iter; left time: 4640.7019s
	iters: 200, epoch: 12 | loss: 3.9730246
	speed: 0.0790s/iter; left time: 1447.0799s
Epoch: 12 cost time: 17.755342721939087
Epoch: 12, Steps: 208 | Train Loss: 3.966 Vali Loss: 3.723 Vali Acc: 0.026 Test Loss: 3.723 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 3.6570957
	speed: 0.2570s/iter; left time: 4678.5573s
	iters: 200, epoch: 13 | loss: 3.8430052
	speed: 0.0790s/iter; left time: 1430.2853s
Epoch: 13 cost time: 17.879459142684937
Epoch: 13, Steps: 208 | Train Loss: 3.848 Vali Loss: 3.706 Vali Acc: 0.026 Test Loss: 3.706 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 3.8041546
	speed: 0.2522s/iter; left time: 4538.8376s
	iters: 200, epoch: 14 | loss: 3.5668514
	speed: 0.0877s/iter; left time: 1569.7147s
Epoch: 14 cost time: 19.26396083831787
Epoch: 14, Steps: 208 | Train Loss: 3.750 Vali Loss: 3.690 Vali Acc: 0.026 Test Loss: 3.690 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 3.7724574
	speed: 0.2588s/iter; left time: 4604.2692s
	iters: 200, epoch: 15 | loss: 3.7963870
	speed: 0.0846s/iter; left time: 1496.8365s
Epoch: 15 cost time: 18.4777250289917
Epoch: 15, Steps: 208 | Train Loss: 3.732 Vali Loss: 3.691 Vali Acc: 0.026 Test Loss: 3.691 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.081419624217119
model parameter : 8956247
model size : 39.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.3485355
	speed: 0.0900s/iter; left time: 1863.2009s
	iters: 200, epoch: 1 | loss: 3.6092288
	speed: 0.0884s/iter; left time: 1821.6313s
Epoch: 1 cost time: 18.604835510253906
Epoch: 1, Steps: 208 | Train Loss: 4.091 Vali Loss: 3.774 Vali Acc: 0.039 Test Loss: 3.774 Test Acc: 0.039
Validation loss decreased (inf --> -0.039032).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8980110
	speed: 0.2526s/iter; left time: 5176.0624s
	iters: 200, epoch: 2 | loss: 4.2003498
	speed: 0.0834s/iter; left time: 1700.8787s
Epoch: 2 cost time: 17.97758984565735
Epoch: 2, Steps: 208 | Train Loss: 3.726 Vali Loss: 3.819 Vali Acc: 0.035 Test Loss: 3.819 Test Acc: 0.035
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.5886483
	speed: 0.2640s/iter; left time: 5354.8957s
	iters: 200, epoch: 3 | loss: 3.3319023
	speed: 0.0817s/iter; left time: 1649.1359s
Epoch: 3 cost time: 18.177286386489868
Epoch: 3, Steps: 208 | Train Loss: 3.571 Vali Loss: 3.438 Vali Acc: 0.061 Test Loss: 3.438 Test Acc: 0.061
Validation loss decreased (-0.039032 --> -0.061105).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.5329492
	speed: 0.2449s/iter; left time: 4917.6323s
	iters: 200, epoch: 4 | loss: 3.4786520
	speed: 0.0827s/iter; left time: 1652.2492s
Epoch: 4 cost time: 17.773760080337524
Epoch: 4, Steps: 208 | Train Loss: 3.358 Vali Loss: 3.469 Vali Acc: 0.072 Test Loss: 3.469 Test Acc: 0.072
Validation loss decreased (-0.061105 --> -0.072438).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.4674997
	speed: 0.2528s/iter; left time: 5022.4759s
	iters: 200, epoch: 5 | loss: 3.3842635
	speed: 0.0850s/iter; left time: 1681.0331s
Epoch: 5 cost time: 17.855095148086548
Epoch: 5, Steps: 208 | Train Loss: 3.283 Vali Loss: 3.324 Vali Acc: 0.092 Test Loss: 3.324 Test Acc: 0.092
Validation loss decreased (-0.072438 --> -0.092421).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.3337402
	speed: 0.2787s/iter; left time: 5479.1773s
	iters: 200, epoch: 6 | loss: 3.7435033
	speed: 0.0852s/iter; left time: 1667.2235s
Epoch: 6 cost time: 18.342565774917603
Epoch: 6, Steps: 208 | Train Loss: 3.453 Vali Loss: 3.754 Vali Acc: 0.033 Test Loss: 3.754 Test Acc: 0.033
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.7559354
	speed: 0.2338s/iter; left time: 4548.5054s
	iters: 200, epoch: 7 | loss: 3.7138820
	speed: 0.0784s/iter; left time: 1518.0556s
Epoch: 7 cost time: 17.330708980560303
Epoch: 7, Steps: 208 | Train Loss: 3.741 Vali Loss: 3.828 Vali Acc: 0.026 Test Loss: 3.828 Test Acc: 0.026
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.7078619
	speed: 0.2634s/iter; left time: 5069.3725s
	iters: 200, epoch: 8 | loss: 3.8042331
	speed: 0.0855s/iter; left time: 1636.0903s
Epoch: 8 cost time: 18.55159616470337
Epoch: 8, Steps: 208 | Train Loss: 3.801 Vali Loss: 3.713 Vali Acc: 0.026 Test Loss: 3.713 Test Acc: 0.026
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 3.8643482
	speed: 0.2622s/iter; left time: 4992.2992s
	iters: 200, epoch: 9 | loss: 3.7439184
	speed: 0.0881s/iter; left time: 1669.2655s
Epoch: 9 cost time: 18.140632152557373
Epoch: 9, Steps: 208 | Train Loss: 3.737 Vali Loss: 3.716 Vali Acc: 0.026 Test Loss: 3.716 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 3.4822993
	speed: 0.2433s/iter; left time: 4581.6388s
	iters: 200, epoch: 10 | loss: 3.7987487
	speed: 0.0840s/iter; left time: 1572.5879s
Epoch: 10 cost time: 17.72388458251953
Epoch: 10, Steps: 208 | Train Loss: 3.681 Vali Loss: 3.693 Vali Acc: 0.025 Test Loss: 3.693 Test Acc: 0.025
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 3.6192148
	speed: 0.2675s/iter; left time: 4980.4146s
	iters: 200, epoch: 11 | loss: 3.7124429
	speed: 0.0900s/iter; left time: 1666.4582s
Epoch: 11 cost time: 18.19413423538208
Epoch: 11, Steps: 208 | Train Loss: 3.677 Vali Loss: 3.669 Vali Acc: 0.033 Test Loss: 3.669 Test Acc: 0.033
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 3.7120938
	speed: 0.2803s/iter; left time: 5161.5929s
	iters: 200, epoch: 12 | loss: 3.7707539
	speed: 0.0781s/iter; left time: 1429.4610s
Epoch: 12 cost time: 19.919262647628784
Epoch: 12, Steps: 208 | Train Loss: 3.702 Vali Loss: 3.683 Vali Acc: 0.026 Test Loss: 3.683 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 3.6041925
	speed: 0.2330s/iter; left time: 4242.5808s
	iters: 200, epoch: 13 | loss: 3.7095094
	speed: 0.0822s/iter; left time: 1488.4657s
Epoch: 13 cost time: 17.349836587905884
Epoch: 13, Steps: 208 | Train Loss: 3.706 Vali Loss: 3.681 Vali Acc: 0.026 Test Loss: 3.681 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 3.7029309
	speed: 0.2590s/iter; left time: 4661.6607s
	iters: 200, epoch: 14 | loss: 3.7171628
	speed: 0.0808s/iter; left time: 1445.6444s
Epoch: 14 cost time: 17.287339210510254
Epoch: 14, Steps: 208 | Train Loss: 3.706 Vali Loss: 3.693 Vali Acc: 0.025 Test Loss: 3.693 Test Acc: 0.025
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 3.6908770
	speed: 0.2540s/iter; left time: 4519.2061s
	iters: 200, epoch: 15 | loss: 3.6387851
	speed: 0.0813s/iter; left time: 1437.6456s
Epoch: 15 cost time: 18.56646180152893
Epoch: 15, Steps: 208 | Train Loss: 3.695 Vali Loss: 3.701 Vali Acc: 0.026 Test Loss: 3.701 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09245451834178348
model parameter : 8947543
model size : 39.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0285606
	speed: 0.1002s/iter; left time: 2075.1651s
	iters: 200, epoch: 1 | loss: 3.8905363
	speed: 0.0753s/iter; left time: 1551.7252s
Epoch: 1 cost time: 18.289191722869873
Epoch: 1, Steps: 208 | Train Loss: 4.051 Vali Loss: 3.822 Vali Acc: 0.055 Test Loss: 3.822 Test Acc: 0.055
Validation loss decreased (inf --> -0.054838).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8625271
	speed: 0.2348s/iter; left time: 4811.8242s
	iters: 200, epoch: 2 | loss: 4.0010195
	speed: 0.0818s/iter; left time: 1668.7148s
Epoch: 2 cost time: 17.166556358337402
Epoch: 2, Steps: 208 | Train Loss: 3.734 Vali Loss: 3.698 Vali Acc: 0.051 Test Loss: 3.698 Test Acc: 0.051
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.9492888
	speed: 0.2396s/iter; left time: 4860.3993s
	iters: 200, epoch: 3 | loss: 3.1655784
	speed: 0.0765s/iter; left time: 1544.2047s
Epoch: 3 cost time: 16.55144739151001
Epoch: 3, Steps: 208 | Train Loss: 3.624 Vali Loss: 3.630 Vali Acc: 0.058 Test Loss: 3.630 Test Acc: 0.058
Validation loss decreased (-0.054838 --> -0.057822).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.1937332
	speed: 0.2600s/iter; left time: 5220.5678s
	iters: 200, epoch: 4 | loss: 3.7243879
	speed: 0.0833s/iter; left time: 1663.7249s
Epoch: 4 cost time: 18.35754132270813
Epoch: 4, Steps: 208 | Train Loss: 3.445 Vali Loss: 3.448 Vali Acc: 0.069 Test Loss: 3.448 Test Acc: 0.069
Validation loss decreased (-0.057822 --> -0.069456).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.1822906
	speed: 0.2668s/iter; left time: 5301.0739s
	iters: 200, epoch: 5 | loss: 3.3982234
	speed: 0.0804s/iter; left time: 1589.4923s
Epoch: 5 cost time: 17.32672619819641
Epoch: 5, Steps: 208 | Train Loss: 3.378 Vali Loss: 3.471 Vali Acc: 0.061 Test Loss: 3.471 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.5916529
	speed: 0.2544s/iter; left time: 5002.7412s
	iters: 200, epoch: 6 | loss: 3.8163390
	speed: 0.0783s/iter; left time: 1532.2888s
Epoch: 6 cost time: 16.728845596313477
Epoch: 6, Steps: 208 | Train Loss: 3.690 Vali Loss: 3.945 Vali Acc: 0.025 Test Loss: 3.945 Test Acc: 0.025
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 3.4774044
	speed: 0.2462s/iter; left time: 4789.0270s
	iters: 200, epoch: 7 | loss: 3.7501132
	speed: 0.0865s/iter; left time: 1673.3093s
Epoch: 7 cost time: 18.583272457122803
Epoch: 7, Steps: 208 | Train Loss: 3.792 Vali Loss: 3.737 Vali Acc: 0.025 Test Loss: 3.737 Test Acc: 0.025
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 3.6491930
	speed: 0.2396s/iter; left time: 4611.7241s
	iters: 200, epoch: 8 | loss: 3.8082182
	speed: 0.0791s/iter; left time: 1513.5855s
Epoch: 8 cost time: 17.118992567062378
Epoch: 8, Steps: 208 | Train Loss: 3.739 Vali Loss: 3.719 Vali Acc: 0.026 Test Loss: 3.719 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 3.8332410
	speed: 0.2452s/iter; left time: 4667.5100s
	iters: 200, epoch: 9 | loss: 3.5851886
	speed: 0.0765s/iter; left time: 1448.8962s
Epoch: 9 cost time: 16.82607936859131
Epoch: 9, Steps: 208 | Train Loss: 3.723 Vali Loss: 3.703 Vali Acc: 0.026 Test Loss: 3.703 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 3.6859217
	speed: 0.2473s/iter; left time: 4656.5678s
	iters: 200, epoch: 10 | loss: 3.7255328
	speed: 0.0734s/iter; left time: 1374.3971s
Epoch: 10 cost time: 16.332669496536255
Epoch: 10, Steps: 208 | Train Loss: 3.705 Vali Loss: 3.699 Vali Acc: 0.026 Test Loss: 3.699 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 3.6876240
	speed: 0.2174s/iter; left time: 4048.4957s
	iters: 200, epoch: 11 | loss: 3.6032224
	speed: 0.0806s/iter; left time: 1493.5756s
Epoch: 11 cost time: 17.314759969711304
Epoch: 11, Steps: 208 | Train Loss: 3.705 Vali Loss: 3.693 Vali Acc: 0.026 Test Loss: 3.693 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 3.7265000
	speed: 0.2389s/iter; left time: 4398.2300s
	iters: 200, epoch: 12 | loss: 3.8678873
	speed: 0.0823s/iter; left time: 1507.2111s
Epoch: 12 cost time: 17.511565446853638
Epoch: 12, Steps: 208 | Train Loss: 3.700 Vali Loss: 3.690 Vali Acc: 0.026 Test Loss: 3.690 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 3.7248993
	speed: 0.2580s/iter; left time: 4696.9220s
	iters: 200, epoch: 13 | loss: 4.4214268
	speed: 0.0802s/iter; left time: 1451.9910s
Epoch: 13 cost time: 17.019900798797607
Epoch: 13, Steps: 208 | Train Loss: 3.753 Vali Loss: 3.838 Vali Acc: 0.026 Test Loss: 3.838 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 3.7124093
	speed: 0.2234s/iter; left time: 4019.8656s
	iters: 200, epoch: 14 | loss: 3.7497666
	speed: 0.0677s/iter; left time: 1212.1528s
Epoch: 14 cost time: 14.269123315811157
Epoch: 14, Steps: 208 | Train Loss: 3.744 Vali Loss: 3.720 Vali Acc: 0.026 Test Loss: 3.720 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.06949000894721145
model parameter : 8938839
model size : 39.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6376112
	speed: 0.0898s/iter; left time: 1859.4569s
	iters: 200, epoch: 1 | loss: 4.0059490
	speed: 0.0769s/iter; left time: 1585.0938s
Epoch: 1 cost time: 17.440722465515137
Epoch: 1, Steps: 208 | Train Loss: 4.219 Vali Loss: 3.835 Vali Acc: 0.048 Test Loss: 3.835 Test Acc: 0.048
Validation loss decreased (inf --> -0.048277).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9114528
	speed: 0.2420s/iter; left time: 4958.4496s
	iters: 200, epoch: 2 | loss: 3.5808172
	speed: 0.0813s/iter; left time: 1658.3479s
Epoch: 2 cost time: 17.75570034980774
Epoch: 2, Steps: 208 | Train Loss: 3.736 Vali Loss: 3.740 Vali Acc: 0.043 Test Loss: 3.740 Test Acc: 0.043
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.4555652
	speed: 0.2310s/iter; left time: 4685.4287s
	iters: 200, epoch: 3 | loss: 3.3024738
	speed: 0.0829s/iter; left time: 1673.2665s
Epoch: 3 cost time: 17.753900289535522
Epoch: 3, Steps: 208 | Train Loss: 3.565 Vali Loss: 3.412 Vali Acc: 0.064 Test Loss: 3.412 Test Acc: 0.064
Validation loss decreased (-0.048277 --> -0.063491).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2095668
	speed: 0.2391s/iter; left time: 4799.7335s
	iters: 200, epoch: 4 | loss: 3.4450245
	speed: 0.0747s/iter; left time: 1492.3236s
Epoch: 4 cost time: 15.931841850280762
Epoch: 4, Steps: 208 | Train Loss: 3.397 Vali Loss: 3.402 Vali Acc: 0.074 Test Loss: 3.402 Test Acc: 0.074
Validation loss decreased (-0.063491 --> -0.074228).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.1587634
	speed: 0.2461s/iter; left time: 4889.6740s
	iters: 200, epoch: 5 | loss: 3.4702733
	speed: 0.0901s/iter; left time: 1781.9500s
Epoch: 5 cost time: 18.80456566810608
Epoch: 5, Steps: 208 | Train Loss: 3.280 Vali Loss: 3.456 Vali Acc: 0.081 Test Loss: 3.456 Test Acc: 0.081
Validation loss decreased (-0.074228 --> -0.080789).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.6363778
	speed: 0.2382s/iter; left time: 4683.2117s
	iters: 200, epoch: 6 | loss: 3.9078872
	speed: 0.0829s/iter; left time: 1621.3778s
Epoch: 6 cost time: 17.215120315551758
Epoch: 6, Steps: 208 | Train Loss: 3.542 Vali Loss: 3.773 Vali Acc: 0.026 Test Loss: 3.773 Test Acc: 0.026
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.7838011
	speed: 0.2415s/iter; left time: 4698.0624s
	iters: 200, epoch: 7 | loss: 3.6740699
	speed: 0.0739s/iter; left time: 1430.9494s
Epoch: 7 cost time: 16.771955966949463
Epoch: 7, Steps: 208 | Train Loss: 3.782 Vali Loss: 3.705 Vali Acc: 0.026 Test Loss: 3.705 Test Acc: 0.026
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.6573277
	speed: 0.2577s/iter; left time: 4960.1586s
	iters: 200, epoch: 8 | loss: 3.6375020
	speed: 0.0865s/iter; left time: 1656.1970s
Epoch: 8 cost time: 18.697389364242554
Epoch: 8, Steps: 208 | Train Loss: 3.733 Vali Loss: 3.712 Vali Acc: 0.026 Test Loss: 3.712 Test Acc: 0.026
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 3.7821786
	speed: 0.2283s/iter; left time: 4346.7305s
	iters: 200, epoch: 9 | loss: 3.7415762
	speed: 0.0678s/iter; left time: 1284.3959s
Epoch: 9 cost time: 15.16947889328003
Epoch: 9, Steps: 208 | Train Loss: 3.708 Vali Loss: 3.733 Vali Acc: 0.026 Test Loss: 3.733 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 3.9337904
	speed: 0.2463s/iter; left time: 4636.6991s
	iters: 200, epoch: 10 | loss: 3.6860292
	speed: 0.0831s/iter; left time: 1556.6415s
Epoch: 10 cost time: 17.747848510742188
Epoch: 10, Steps: 208 | Train Loss: 3.698 Vali Loss: 3.701 Vali Acc: 0.026 Test Loss: 3.701 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 3.7209105
	speed: 0.2397s/iter; left time: 4462.9891s
	iters: 200, epoch: 11 | loss: 3.7736323
	speed: 0.0864s/iter; left time: 1599.8064s
Epoch: 11 cost time: 17.817840814590454
Epoch: 11, Steps: 208 | Train Loss: 3.698 Vali Loss: 3.677 Vali Acc: 0.026 Test Loss: 3.677 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 3.7053316
	speed: 0.2219s/iter; left time: 4085.2318s
	iters: 200, epoch: 12 | loss: 3.7036643
	speed: 0.0801s/iter; left time: 1467.6984s
Epoch: 12 cost time: 17.039802312850952
Epoch: 12, Steps: 208 | Train Loss: 3.695 Vali Loss: 3.677 Vali Acc: 0.026 Test Loss: 3.677 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 3.7414994
	speed: 0.2413s/iter; left time: 4393.4644s
	iters: 200, epoch: 13 | loss: 3.5687175
	speed: 0.0830s/iter; left time: 1503.3213s
Epoch: 13 cost time: 17.4600567817688
Epoch: 13, Steps: 208 | Train Loss: 3.688 Vali Loss: 3.706 Vali Acc: 0.026 Test Loss: 3.706 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 3.7571681
	speed: 0.2349s/iter; left time: 4227.2453s
	iters: 200, epoch: 14 | loss: 3.7072232
	speed: 0.0773s/iter; left time: 1382.8313s
Epoch: 14 cost time: 17.290802478790283
Epoch: 14, Steps: 208 | Train Loss: 3.687 Vali Loss: 3.703 Vali Acc: 0.026 Test Loss: 3.703 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 3.7263522
	speed: 0.2276s/iter; left time: 4049.4541s
	iters: 200, epoch: 15 | loss: 3.7060852
	speed: 0.0852s/iter; left time: 1506.5412s
Epoch: 15 cost time: 17.67792296409607
Epoch: 15, Steps: 208 | Train Loss: 3.695 Vali Loss: 3.686 Vali Acc: 0.026 Test Loss: 3.686 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08082314345362362
model parameter : 8505303
model size : 37.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.2480764
	speed: 0.1066s/iter; left time: 2207.2505s
	iters: 200, epoch: 1 | loss: 4.1756282
	speed: 0.0825s/iter; left time: 1700.0287s
Epoch: 1 cost time: 19.781938314437866
Epoch: 1, Steps: 208 | Train Loss: 4.146 Vali Loss: 3.710 Vali Acc: 0.045 Test Loss: 3.710 Test Acc: 0.045
Validation loss decreased (inf --> -0.044997).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9697809
	speed: 0.2437s/iter; left time: 4993.8975s
	iters: 200, epoch: 2 | loss: 3.3258574
	speed: 0.0780s/iter; left time: 1589.6772s
Epoch: 2 cost time: 16.926466941833496
Epoch: 2, Steps: 208 | Train Loss: 3.740 Vali Loss: 3.735 Vali Acc: 0.051 Test Loss: 3.735 Test Acc: 0.051
Validation loss decreased (-0.044997 --> -0.050664).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6321120
	speed: 0.2485s/iter; left time: 5041.5026s
	iters: 200, epoch: 3 | loss: 3.6931276
	speed: 0.0720s/iter; left time: 1453.6622s
Epoch: 3 cost time: 16.092811584472656
Epoch: 3, Steps: 208 | Train Loss: 3.588 Vali Loss: 3.512 Vali Acc: 0.068 Test Loss: 3.512 Test Acc: 0.068
Validation loss decreased (-0.050664 --> -0.067964).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.7541943
	speed: 0.2513s/iter; left time: 5045.7584s
	iters: 200, epoch: 4 | loss: 3.3290708
	speed: 0.0831s/iter; left time: 1660.6959s
Epoch: 4 cost time: 17.665064811706543
Epoch: 4, Steps: 208 | Train Loss: 3.397 Vali Loss: 3.503 Vali Acc: 0.072 Test Loss: 3.503 Test Acc: 0.072
Validation loss decreased (-0.067964 --> -0.071543).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2213018
	speed: 0.2366s/iter; left time: 4701.7968s
	iters: 200, epoch: 5 | loss: 3.5177925
	speed: 0.0784s/iter; left time: 1550.6801s
Epoch: 5 cost time: 16.4023699760437
Epoch: 5, Steps: 208 | Train Loss: 3.275 Vali Loss: 3.401 Vali Acc: 0.093 Test Loss: 3.401 Test Acc: 0.093
Validation loss decreased (-0.071543 --> -0.093315).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2423010
	speed: 0.2372s/iter; left time: 4663.1868s
	iters: 200, epoch: 6 | loss: 3.5941117
	speed: 0.0768s/iter; left time: 1502.5813s
Epoch: 6 cost time: 16.38198685646057
Epoch: 6, Steps: 208 | Train Loss: 3.372 Vali Loss: 3.649 Vali Acc: 0.053 Test Loss: 3.649 Test Acc: 0.053
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.9968328
	speed: 0.2229s/iter; left time: 4335.8034s
	iters: 200, epoch: 7 | loss: 3.7162101
	speed: 0.0783s/iter; left time: 1516.0452s
Epoch: 7 cost time: 16.577971935272217
Epoch: 7, Steps: 208 | Train Loss: 3.656 Vali Loss: 3.646 Vali Acc: 0.037 Test Loss: 3.646 Test Acc: 0.037
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.5481870
	speed: 0.2119s/iter; left time: 4078.6275s
	iters: 200, epoch: 8 | loss: 3.9289036
	speed: 0.0759s/iter; left time: 1453.2149s
Epoch: 8 cost time: 15.748809099197388
Epoch: 8, Steps: 208 | Train Loss: 3.712 Vali Loss: 3.690 Vali Acc: 0.027 Test Loss: 3.690 Test Acc: 0.027
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 3.6840417
	speed: 0.2388s/iter; left time: 4546.0467s
	iters: 200, epoch: 9 | loss: 3.7020192
	speed: 0.0857s/iter; left time: 1623.4532s
Epoch: 9 cost time: 17.83975052833557
Epoch: 9, Steps: 208 | Train Loss: 3.701 Vali Loss: 3.600 Vali Acc: 0.039 Test Loss: 3.600 Test Acc: 0.039
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 3.5384285
	speed: 0.2673s/iter; left time: 5032.3502s
	iters: 200, epoch: 10 | loss: 3.4789970
	speed: 0.0859s/iter; left time: 1608.1297s
Epoch: 10 cost time: 18.657878398895264
Epoch: 10, Steps: 208 | Train Loss: 3.666 Vali Loss: 3.738 Vali Acc: 0.037 Test Loss: 3.738 Test Acc: 0.037
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 4.0775266
	speed: 0.2436s/iter; left time: 4535.2750s
	iters: 200, epoch: 11 | loss: 3.6461196
	speed: 0.0745s/iter; left time: 1378.9355s
Epoch: 11 cost time: 16.2016441822052
Epoch: 11, Steps: 208 | Train Loss: 3.801 Vali Loss: 3.786 Vali Acc: 0.026 Test Loss: 3.786 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 3.6476550
	speed: 0.2409s/iter; left time: 4435.4969s
	iters: 200, epoch: 12 | loss: 3.7434547
	speed: 0.0767s/iter; left time: 1404.5359s
Epoch: 12 cost time: 16.203163146972656
Epoch: 12, Steps: 208 | Train Loss: 3.761 Vali Loss: 3.704 Vali Acc: 0.026 Test Loss: 3.704 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 3.7720985
	speed: 0.2367s/iter; left time: 4308.4247s
	iters: 200, epoch: 13 | loss: 3.7171907
	speed: 0.0821s/iter; left time: 1486.6178s
Epoch: 13 cost time: 17.50961995124817
Epoch: 13, Steps: 208 | Train Loss: 3.722 Vali Loss: 3.724 Vali Acc: 0.026 Test Loss: 3.724 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 3.7050147
	speed: 0.2531s/iter; left time: 4555.8021s
	iters: 200, epoch: 14 | loss: 3.7653096
	speed: 0.0815s/iter; left time: 1459.0684s
Epoch: 14 cost time: 17.80071783065796
Epoch: 14, Steps: 208 | Train Loss: 3.715 Vali Loss: 3.683 Vali Acc: 0.026 Test Loss: 3.683 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 3.6649036
	speed: 0.2525s/iter; left time: 4492.4879s
	iters: 200, epoch: 15 | loss: 3.6334183
	speed: 0.0836s/iter; left time: 1478.6849s
Epoch: 15 cost time: 17.359274864196777
Epoch: 15, Steps: 208 | Train Loss: 3.702 Vali Loss: 3.688 Vali Acc: 0.026 Test Loss: 3.688 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09334923948702654
model parameter : 8496599
model size : 37.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.4691582
	speed: 0.1002s/iter; left time: 2074.2812s
	iters: 200, epoch: 1 | loss: 3.2593427
	speed: 0.0766s/iter; left time: 1577.9853s
Epoch: 1 cost time: 18.423222064971924
Epoch: 1, Steps: 208 | Train Loss: 4.138 Vali Loss: 3.915 Vali Acc: 0.042 Test Loss: 3.915 Test Acc: 0.042
Validation loss decreased (inf --> -0.042013).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.0988374
	speed: 0.2524s/iter; left time: 5173.4154s
	iters: 200, epoch: 2 | loss: 3.6356695
	speed: 0.0820s/iter; left time: 1671.2472s
Epoch: 2 cost time: 17.228362798690796
Epoch: 2, Steps: 208 | Train Loss: 3.796 Vali Loss: 3.770 Vali Acc: 0.043 Test Loss: 3.770 Test Acc: 0.043
Validation loss decreased (-0.042013 --> -0.042909).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3431363
	speed: 0.2561s/iter; left time: 5195.6651s
	iters: 200, epoch: 3 | loss: 3.5626099
	speed: 0.0742s/iter; left time: 1498.5188s
Epoch: 3 cost time: 16.831668376922607
Epoch: 3, Steps: 208 | Train Loss: 3.627 Vali Loss: 3.584 Vali Acc: 0.041 Test Loss: 3.584 Test Acc: 0.041
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.4101775
	speed: 0.2558s/iter; left time: 5135.1151s
	iters: 200, epoch: 4 | loss: 3.4221067
	speed: 0.0875s/iter; left time: 1747.6499s
Epoch: 4 cost time: 18.53955340385437
Epoch: 4, Steps: 208 | Train Loss: 3.482 Vali Loss: 3.287 Vali Acc: 0.079 Test Loss: 3.287 Test Acc: 0.079
Validation loss decreased (-0.042909 --> -0.079299).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.9710920
	speed: 0.2616s/iter; left time: 5196.7958s
	iters: 200, epoch: 5 | loss: 3.3344543
	speed: 0.0911s/iter; left time: 1801.6623s
Epoch: 5 cost time: 18.634246826171875
Epoch: 5, Steps: 208 | Train Loss: 3.339 Vali Loss: 3.387 Vali Acc: 0.076 Test Loss: 3.387 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.2867131
	speed: 0.2330s/iter; left time: 4580.9401s
	iters: 200, epoch: 6 | loss: 3.8673012
	speed: 0.0758s/iter; left time: 1482.2701s
Epoch: 6 cost time: 16.061204195022583
Epoch: 6, Steps: 208 | Train Loss: 3.583 Vali Loss: 3.823 Vali Acc: 0.031 Test Loss: 3.823 Test Acc: 0.031
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 3.4089794
	speed: 0.2374s/iter; left time: 4618.7532s
	iters: 200, epoch: 7 | loss: 3.9727616
	speed: 0.0759s/iter; left time: 1469.6717s
Epoch: 7 cost time: 16.47123074531555
Epoch: 7, Steps: 208 | Train Loss: 3.840 Vali Loss: 3.781 Vali Acc: 0.026 Test Loss: 3.781 Test Acc: 0.026
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 3.9305403
	speed: 0.2301s/iter; left time: 4428.2424s
	iters: 200, epoch: 8 | loss: 3.7090766
	speed: 0.0786s/iter; left time: 1504.5079s
Epoch: 8 cost time: 16.886809825897217
Epoch: 8, Steps: 208 | Train Loss: 3.769 Vali Loss: 3.769 Vali Acc: 0.026 Test Loss: 3.769 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 3.9313886
	speed: 0.2194s/iter; left time: 4177.4729s
	iters: 200, epoch: 9 | loss: 3.7419984
	speed: 0.0777s/iter; left time: 1471.6169s
Epoch: 9 cost time: 16.875961542129517
Epoch: 9, Steps: 208 | Train Loss: 3.725 Vali Loss: 3.709 Vali Acc: 0.026 Test Loss: 3.709 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 3.6410217
	speed: 0.2272s/iter; left time: 4277.4594s
	iters: 200, epoch: 10 | loss: 3.7389004
	speed: 0.0709s/iter; left time: 1327.6345s
Epoch: 10 cost time: 15.270595073699951
Epoch: 10, Steps: 208 | Train Loss: 3.719 Vali Loss: 3.684 Vali Acc: 0.026 Test Loss: 3.684 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 3.9035141
	speed: 0.2343s/iter; left time: 4363.8130s
	iters: 200, epoch: 11 | loss: 3.6115255
	speed: 0.0799s/iter; left time: 1479.4506s
Epoch: 11 cost time: 17.40899658203125
Epoch: 11, Steps: 208 | Train Loss: 3.809 Vali Loss: 3.758 Vali Acc: 0.026 Test Loss: 3.758 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 3.6439154
	speed: 0.2425s/iter; left time: 4465.0356s
	iters: 200, epoch: 12 | loss: 3.8578405
	speed: 0.0774s/iter; left time: 1418.0575s
Epoch: 12 cost time: 17.176870822906494
Epoch: 12, Steps: 208 | Train Loss: 3.740 Vali Loss: 3.688 Vali Acc: 0.026 Test Loss: 3.688 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 3.6750236
	speed: 0.2486s/iter; left time: 4524.9814s
	iters: 200, epoch: 13 | loss: 3.7642937
	speed: 0.0780s/iter; left time: 1412.6976s
Epoch: 13 cost time: 16.797054529190063
Epoch: 13, Steps: 208 | Train Loss: 3.717 Vali Loss: 3.680 Vali Acc: 0.026 Test Loss: 3.680 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 3.6776588
	speed: 0.2418s/iter; left time: 4350.9674s
	iters: 200, epoch: 14 | loss: 3.7486467
	speed: 0.0828s/iter; left time: 1481.9357s
Epoch: 14 cost time: 17.866254806518555
Epoch: 14, Steps: 208 | Train Loss: 3.706 Vali Loss: 3.678 Vali Acc: 0.026 Test Loss: 3.678 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.07933194154488518
model parameter : 8487895
model size : 37.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.8059988
	speed: 0.0925s/iter; left time: 1915.5267s
	iters: 200, epoch: 1 | loss: 3.8393524
	speed: 0.0742s/iter; left time: 1529.0679s
Epoch: 1 cost time: 17.400495290756226
Epoch: 1, Steps: 208 | Train Loss: 4.072 Vali Loss: 3.787 Vali Acc: 0.044 Test Loss: 3.787 Test Acc: 0.044
Validation loss decreased (inf --> -0.043803).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5958195
	speed: 0.2258s/iter; left time: 4627.3691s
	iters: 200, epoch: 2 | loss: 4.1620750
	speed: 0.0785s/iter; left time: 1600.7774s
Epoch: 2 cost time: 17.122339010238647
Epoch: 2, Steps: 208 | Train Loss: 3.688 Vali Loss: 3.718 Vali Acc: 0.041 Test Loss: 3.718 Test Acc: 0.041
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.5155227
	speed: 0.2398s/iter; left time: 4864.7536s
	iters: 200, epoch: 3 | loss: 3.8251829
	speed: 0.0758s/iter; left time: 1530.9567s
Epoch: 3 cost time: 16.292351961135864
Epoch: 3, Steps: 208 | Train Loss: 3.598 Vali Loss: 3.554 Vali Acc: 0.066 Test Loss: 3.554 Test Acc: 0.066
Validation loss decreased (-0.043803 --> -0.066174).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3882003
	speed: 0.2257s/iter; left time: 4531.1588s
	iters: 200, epoch: 4 | loss: 3.4028788
	speed: 0.0760s/iter; left time: 1517.4504s
Epoch: 4 cost time: 16.060747146606445
Epoch: 4, Steps: 208 | Train Loss: 3.429 Vali Loss: 3.462 Vali Acc: 0.075 Test Loss: 3.462 Test Acc: 0.075
Validation loss decreased (-0.066174 --> -0.075122).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2590742
	speed: 0.2243s/iter; left time: 4456.7330s
	iters: 200, epoch: 5 | loss: 3.1126521
	speed: 0.0751s/iter; left time: 1484.7296s
Epoch: 5 cost time: 16.25338387489319
Epoch: 5, Steps: 208 | Train Loss: 3.342 Vali Loss: 3.390 Vali Acc: 0.094 Test Loss: 3.390 Test Acc: 0.094
Validation loss decreased (-0.075122 --> -0.093614).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.8539205
	speed: 0.2315s/iter; left time: 4551.0885s
	iters: 200, epoch: 6 | loss: 3.5879815
	speed: 0.0764s/iter; left time: 1495.0981s
Epoch: 6 cost time: 16.507164478302002
Epoch: 6, Steps: 208 | Train Loss: 3.602 Vali Loss: 3.674 Vali Acc: 0.052 Test Loss: 3.674 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.8900406
	speed: 0.2439s/iter; left time: 4744.5283s
	iters: 200, epoch: 7 | loss: 3.6611724
	speed: 0.0742s/iter; left time: 1435.1425s
Epoch: 7 cost time: 15.812789678573608
Epoch: 7, Steps: 208 | Train Loss: 3.701 Vali Loss: 3.736 Vali Acc: 0.026 Test Loss: 3.736 Test Acc: 0.026
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.8650393
	speed: 0.2482s/iter; left time: 4777.3841s
	iters: 200, epoch: 8 | loss: 3.6386790
	speed: 0.0796s/iter; left time: 1523.4020s
Epoch: 8 cost time: 17.601900815963745
Epoch: 8, Steps: 208 | Train Loss: 3.729 Vali Loss: 3.641 Vali Acc: 0.029 Test Loss: 3.641 Test Acc: 0.029
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 3.6539273
	speed: 0.2462s/iter; left time: 4687.5124s
	iters: 200, epoch: 9 | loss: 3.8309479
	speed: 0.0681s/iter; left time: 1289.3798s
Epoch: 9 cost time: 15.22537350654602
Epoch: 9, Steps: 208 | Train Loss: 3.673 Vali Loss: 3.702 Vali Acc: 0.026 Test Loss: 3.702 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 3.7034473
	speed: 0.2279s/iter; left time: 4291.0382s
	iters: 200, epoch: 10 | loss: 3.7412338
	speed: 0.0749s/iter; left time: 1402.3293s
Epoch: 10 cost time: 16.151111602783203
Epoch: 10, Steps: 208 | Train Loss: 3.697 Vali Loss: 3.698 Vali Acc: 0.026 Test Loss: 3.698 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 3.6744809
	speed: 0.2322s/iter; left time: 4323.2449s
	iters: 200, epoch: 11 | loss: 3.6668267
	speed: 0.0768s/iter; left time: 1422.2012s
Epoch: 11 cost time: 16.635180711746216
Epoch: 11, Steps: 208 | Train Loss: 3.699 Vali Loss: 3.684 Vali Acc: 0.026 Test Loss: 3.684 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 3.5519743
	speed: 0.2184s/iter; left time: 4020.8389s
	iters: 200, epoch: 12 | loss: 3.7102375
	speed: 0.0716s/iter; left time: 1311.2922s
Epoch: 12 cost time: 15.411161661148071
Epoch: 12, Steps: 208 | Train Loss: 3.691 Vali Loss: 3.696 Vali Acc: 0.026 Test Loss: 3.696 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 3.6756368
	speed: 0.2268s/iter; left time: 4128.2844s
	iters: 200, epoch: 13 | loss: 3.5484116
	speed: 0.0795s/iter; left time: 1439.9953s
Epoch: 13 cost time: 16.83754062652588
Epoch: 13, Steps: 208 | Train Loss: 3.686 Vali Loss: 3.835 Vali Acc: 0.026 Test Loss: 3.835 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 3.6613362
	speed: 0.2192s/iter; left time: 3944.9767s
	iters: 200, epoch: 14 | loss: 3.7628284
	speed: 0.0682s/iter; left time: 1220.3654s
Epoch: 14 cost time: 15.101242542266846
Epoch: 14, Steps: 208 | Train Loss: 3.686 Vali Loss: 3.638 Vali Acc: 0.038 Test Loss: 3.638 Test Acc: 0.038
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 3.7109950
	speed: 0.2198s/iter; left time: 3910.8395s
	iters: 200, epoch: 15 | loss: 3.6629565
	speed: 0.0739s/iter; left time: 1306.7051s
Epoch: 15 cost time: 16.175443649291992
Epoch: 15, Steps: 208 | Train Loss: 3.682 Vali Loss: 3.692 Vali Acc: 0.026 Test Loss: 3.692 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09364747986877424
model parameter : 8479191
model size : 37.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0931354
	speed: 0.1006s/iter; left time: 2082.6139s
	iters: 200, epoch: 1 | loss: 3.6023245
	speed: 0.0772s/iter; left time: 1589.7066s
Epoch: 1 cost time: 18.50351881980896
Epoch: 1, Steps: 208 | Train Loss: 3.870 Vali Loss: 3.663 Vali Acc: 0.055 Test Loss: 3.663 Test Acc: 0.055
Validation loss decreased (inf --> -0.054840).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9943283
	speed: 0.2340s/iter; left time: 4795.8364s
	iters: 200, epoch: 2 | loss: 3.6330314
	speed: 0.0754s/iter; left time: 1538.2262s
Epoch: 2 cost time: 16.050983428955078
Epoch: 2, Steps: 208 | Train Loss: 3.700 Vali Loss: 3.715 Vali Acc: 0.043 Test Loss: 3.715 Test Acc: 0.043
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.8636162
	speed: 0.2254s/iter; left time: 4571.2531s
	iters: 200, epoch: 3 | loss: 3.8280275
	speed: 0.0664s/iter; left time: 1340.5403s
Epoch: 3 cost time: 14.690033674240112
Epoch: 3, Steps: 208 | Train Loss: 3.633 Vali Loss: 3.664 Vali Acc: 0.057 Test Loss: 3.664 Test Acc: 0.057
Validation loss decreased (-0.054840 --> -0.056629).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2909589
	speed: 0.2371s/iter; left time: 4760.5520s
	iters: 200, epoch: 4 | loss: 3.2271352
	speed: 0.0801s/iter; left time: 1599.2599s
Epoch: 4 cost time: 18.117348670959473
Epoch: 4, Steps: 208 | Train Loss: 3.517 Vali Loss: 3.390 Vali Acc: 0.078 Test Loss: 3.390 Test Acc: 0.078
Validation loss decreased (-0.056629 --> -0.077509).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.1716912
	speed: 0.2311s/iter; left time: 4592.1984s
	iters: 200, epoch: 5 | loss: 3.1921101
	speed: 0.0812s/iter; left time: 1604.7838s
Epoch: 5 cost time: 17.065123319625854
Epoch: 5, Steps: 208 | Train Loss: 3.340 Vali Loss: 3.327 Vali Acc: 0.080 Test Loss: 3.327 Test Acc: 0.080
Validation loss decreased (-0.077509 --> -0.079895).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.6480904
	speed: 0.2420s/iter; left time: 4758.1808s
	iters: 200, epoch: 6 | loss: 3.5666986
	speed: 0.0817s/iter; left time: 1598.2023s
Epoch: 6 cost time: 17.386016607284546
Epoch: 6, Steps: 208 | Train Loss: 3.240 Vali Loss: 3.283 Vali Acc: 0.097 Test Loss: 3.283 Test Acc: 0.097
Validation loss decreased (-0.079895 --> -0.096895).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.8225083
	speed: 0.2082s/iter; left time: 4049.5386s
	iters: 200, epoch: 7 | loss: 3.1667929
	speed: 0.0704s/iter; left time: 1362.3907s
Epoch: 7 cost time: 15.094337463378906
Epoch: 7, Steps: 208 | Train Loss: 3.201 Vali Loss: 3.221 Vali Acc: 0.094 Test Loss: 3.221 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 3.4338329
	speed: 0.2144s/iter; left time: 4125.9331s
	iters: 200, epoch: 8 | loss: 3.2105484
	speed: 0.0790s/iter; left time: 1511.8779s
Epoch: 8 cost time: 16.88946223258972
Epoch: 8, Steps: 208 | Train Loss: 3.193 Vali Loss: 3.265 Vali Acc: 0.083 Test Loss: 3.265 Test Acc: 0.083
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 3.3381610
	speed: 0.2267s/iter; left time: 4315.8407s
	iters: 200, epoch: 9 | loss: 3.1265101
	speed: 0.0678s/iter; left time: 1283.8801s
Epoch: 9 cost time: 15.084871053695679
Epoch: 9, Steps: 208 | Train Loss: 3.223 Vali Loss: 3.324 Vali Acc: 0.081 Test Loss: 3.324 Test Acc: 0.081
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 2.6137097
	speed: 0.2129s/iter; left time: 4008.5468s
	iters: 200, epoch: 10 | loss: 3.2247500
	speed: 0.0611s/iter; left time: 1144.4759s
Epoch: 10 cost time: 13.536852598190308
Epoch: 10, Steps: 208 | Train Loss: 3.178 Vali Loss: 3.342 Vali Acc: 0.078 Test Loss: 3.342 Test Acc: 0.078
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 3.3393977
	speed: 0.2248s/iter; left time: 4186.4346s
	iters: 200, epoch: 11 | loss: 3.0395999
	speed: 0.0762s/iter; left time: 1410.8085s
Epoch: 11 cost time: 16.956931829452515
Epoch: 11, Steps: 208 | Train Loss: 3.178 Vali Loss: 3.261 Vali Acc: 0.090 Test Loss: 3.261 Test Acc: 0.090
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 3.6095541
	speed: 0.2299s/iter; left time: 4232.3097s
	iters: 200, epoch: 12 | loss: 3.1180639
	speed: 0.0688s/iter; left time: 1260.4344s
Epoch: 12 cost time: 15.154785394668579
Epoch: 12, Steps: 208 | Train Loss: 3.161 Vali Loss: 3.201 Vali Acc: 0.099 Test Loss: 3.201 Test Acc: 0.099
Validation loss decreased (-0.096895 --> -0.099282).  Saving model ...
	iters: 100, epoch: 13 | loss: 3.4830818
	speed: 0.2357s/iter; left time: 4291.0393s
	iters: 200, epoch: 13 | loss: 3.2493279
	speed: 0.0779s/iter; left time: 1410.0495s
Epoch: 13 cost time: 16.736644506454468
Epoch: 13, Steps: 208 | Train Loss: 3.163 Vali Loss: 3.220 Vali Acc: 0.098 Test Loss: 3.220 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 3.2084253
	speed: 0.2252s/iter; left time: 4053.7049s
	iters: 200, epoch: 14 | loss: 3.7190394
	speed: 0.0785s/iter; left time: 1405.1054s
Epoch: 14 cost time: 17.200323581695557
Epoch: 14, Steps: 208 | Train Loss: 3.376 Vali Loss: 3.911 Vali Acc: 0.020 Test Loss: 3.911 Test Acc: 0.020
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 3.6541042
	speed: 0.2174s/iter; left time: 3867.0980s
	iters: 200, epoch: 15 | loss: 3.5186458
	speed: 0.0738s/iter; left time: 1305.5595s
Epoch: 15 cost time: 15.393699645996094
Epoch: 15, Steps: 208 | Train Loss: 3.741 Vali Loss: 3.809 Vali Acc: 0.025 Test Loss: 3.809 Test Acc: 0.025
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 3.7158530
	speed: 0.2164s/iter; left time: 3804.4004s
	iters: 200, epoch: 16 | loss: 3.6053381
	speed: 0.0773s/iter; left time: 1350.5243s
Epoch: 16 cost time: 16.236024856567383
Epoch: 16, Steps: 208 | Train Loss: 3.746 Vali Loss: 3.716 Vali Acc: 0.026 Test Loss: 3.716 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 3.6703668
	speed: 0.2224s/iter; left time: 3863.2080s
	iters: 200, epoch: 17 | loss: 3.7589355
	speed: 0.0787s/iter; left time: 1358.7451s
Epoch: 17 cost time: 17.00920081138611
Epoch: 17, Steps: 208 | Train Loss: 3.716 Vali Loss: 3.677 Vali Acc: 0.026 Test Loss: 3.677 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 3.6627262
	speed: 0.2177s/iter; left time: 3736.6209s
	iters: 200, epoch: 18 | loss: 3.6534293
	speed: 0.0714s/iter; left time: 1218.9030s
Epoch: 18 cost time: 15.254777193069458
Epoch: 18, Steps: 208 | Train Loss: 3.714 Vali Loss: 3.693 Vali Acc: 0.026 Test Loss: 3.693 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 3.6482422
	speed: 0.2272s/iter; left time: 3852.9160s
	iters: 200, epoch: 19 | loss: 3.6885719
	speed: 0.0750s/iter; left time: 1264.0089s
Epoch: 19 cost time: 16.352240085601807
Epoch: 19, Steps: 208 | Train Loss: 3.703 Vali Loss: 3.689 Vali Acc: 0.026 Test Loss: 3.689 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 3.8107810
	speed: 0.2341s/iter; left time: 3920.2085s
	iters: 200, epoch: 20 | loss: 3.6583061
	speed: 0.0862s/iter; left time: 1434.9905s
Epoch: 20 cost time: 17.408523559570312
Epoch: 20, Steps: 208 | Train Loss: 3.705 Vali Loss: 3.697 Vali Acc: 0.026 Test Loss: 3.697 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 3.6790447
	speed: 0.2261s/iter; left time: 3740.1045s
	iters: 200, epoch: 21 | loss: 3.7923522
	speed: 0.0701s/iter; left time: 1152.4108s
Epoch: 21 cost time: 15.37507963180542
Epoch: 21, Steps: 208 | Train Loss: 3.698 Vali Loss: 3.689 Vali Acc: 0.026 Test Loss: 3.689 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 3.6565273
	speed: 0.2268s/iter; left time: 3704.9799s
	iters: 200, epoch: 22 | loss: 3.6680181
	speed: 0.0738s/iter; left time: 1197.4864s
Epoch: 22 cost time: 16.2131085395813
Epoch: 22, Steps: 208 | Train Loss: 3.697 Vali Loss: 3.688 Vali Acc: 0.026 Test Loss: 3.688 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09931404712198032
model parameter : 4030039
model size : 17.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.1357589
	speed: 0.0953s/iter; left time: 1973.4113s
	iters: 200, epoch: 1 | loss: 3.1950870
	speed: 0.0664s/iter; left time: 1367.2258s
Epoch: 1 cost time: 16.81834387779236
Epoch: 1, Steps: 208 | Train Loss: 3.893 Vali Loss: 3.839 Vali Acc: 0.047 Test Loss: 3.839 Test Acc: 0.047
Validation loss decreased (inf --> -0.046785).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6419704
	speed: 0.2325s/iter; left time: 4765.6323s
	iters: 200, epoch: 2 | loss: 3.8654659
	speed: 0.0754s/iter; left time: 1537.2036s
Epoch: 2 cost time: 16.290587186813354
Epoch: 2, Steps: 208 | Train Loss: 3.666 Vali Loss: 3.641 Vali Acc: 0.046 Test Loss: 3.641 Test Acc: 0.046
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.4324787
	speed: 0.2283s/iter; left time: 4630.2493s
	iters: 200, epoch: 3 | loss: 3.8878648
	speed: 0.0765s/iter; left time: 1543.1485s
Epoch: 3 cost time: 16.44210147857666
Epoch: 3, Steps: 208 | Train Loss: 3.557 Vali Loss: 3.553 Vali Acc: 0.067 Test Loss: 3.553 Test Acc: 0.067
Validation loss decreased (-0.046785 --> -0.067069).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.1820633
	speed: 0.2298s/iter; left time: 4613.6296s
	iters: 200, epoch: 4 | loss: 3.6189554
	speed: 0.0755s/iter; left time: 1507.9030s
Epoch: 4 cost time: 16.308096408843994
Epoch: 4, Steps: 208 | Train Loss: 3.441 Vali Loss: 3.465 Vali Acc: 0.071 Test Loss: 3.465 Test Acc: 0.071
Validation loss decreased (-0.067069 --> -0.070648).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.0466907
	speed: 0.2413s/iter; left time: 4794.5155s
	iters: 200, epoch: 5 | loss: 3.4827905
	speed: 0.0761s/iter; left time: 1503.6243s
Epoch: 5 cost time: 16.047796726226807
Epoch: 5, Steps: 208 | Train Loss: 3.311 Vali Loss: 3.339 Vali Acc: 0.082 Test Loss: 3.339 Test Acc: 0.082
Validation loss decreased (-0.070648 --> -0.082281).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2215557
	speed: 0.2302s/iter; left time: 4526.6621s
	iters: 200, epoch: 6 | loss: 3.6495874
	speed: 0.0737s/iter; left time: 1442.4985s
Epoch: 6 cost time: 15.746917724609375
Epoch: 6, Steps: 208 | Train Loss: 3.198 Vali Loss: 3.254 Vali Acc: 0.091 Test Loss: 3.254 Test Acc: 0.091
Validation loss decreased (-0.082281 --> -0.090931).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.2052979
	speed: 0.2292s/iter; left time: 4457.8061s
	iters: 200, epoch: 7 | loss: 3.5987289
	speed: 0.0707s/iter; left time: 1369.2136s
Epoch: 7 cost time: 15.894426584243774
Epoch: 7, Steps: 208 | Train Loss: 3.209 Vali Loss: 3.273 Vali Acc: 0.083 Test Loss: 3.273 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.9588497
	speed: 0.2560s/iter; left time: 4926.9043s
	iters: 200, epoch: 8 | loss: 3.3889067
	speed: 0.0914s/iter; left time: 1749.9645s
Epoch: 8 cost time: 19.43925189971924
Epoch: 8, Steps: 208 | Train Loss: 3.166 Vali Loss: 3.257 Vali Acc: 0.089 Test Loss: 3.257 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 3.3673723
	speed: 0.2043s/iter; left time: 3890.2090s
	iters: 200, epoch: 9 | loss: 3.1656933
	speed: 0.0648s/iter; left time: 1226.6209s
Epoch: 9 cost time: 14.123998880386353
Epoch: 9, Steps: 208 | Train Loss: 3.246 Vali Loss: 3.368 Vali Acc: 0.070 Test Loss: 3.368 Test Acc: 0.070
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 3.6773944
	speed: 0.2133s/iter; left time: 4016.1919s
	iters: 200, epoch: 10 | loss: 3.3535419
	speed: 0.0740s/iter; left time: 1385.8637s
Epoch: 10 cost time: 15.799093961715698
Epoch: 10, Steps: 208 | Train Loss: 3.410 Vali Loss: 3.481 Vali Acc: 0.054 Test Loss: 3.481 Test Acc: 0.054
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 3.5423615
	speed: 0.2267s/iter; left time: 4221.3502s
	iters: 200, epoch: 11 | loss: 3.4481905
	speed: 0.0742s/iter; left time: 1373.4813s
Epoch: 11 cost time: 15.558711528778076
Epoch: 11, Steps: 208 | Train Loss: 3.437 Vali Loss: 3.421 Vali Acc: 0.059 Test Loss: 3.421 Test Acc: 0.059
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 3.6140685
	speed: 0.2205s/iter; left time: 4060.8352s
	iters: 200, epoch: 12 | loss: 3.3011522
	speed: 0.0711s/iter; left time: 1301.3489s
Epoch: 12 cost time: 15.890000104904175
Epoch: 12, Steps: 208 | Train Loss: 3.430 Vali Loss: 3.446 Vali Acc: 0.060 Test Loss: 3.446 Test Acc: 0.060
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 3.6807749
	speed: 0.2215s/iter; left time: 4033.2625s
	iters: 200, epoch: 13 | loss: 3.4127345
	speed: 0.0622s/iter; left time: 1125.4439s
Epoch: 13 cost time: 14.188189268112183
Epoch: 13, Steps: 208 | Train Loss: 3.486 Vali Loss: 3.538 Vali Acc: 0.051 Test Loss: 3.538 Test Acc: 0.051
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 3.4123397
	speed: 0.2251s/iter; left time: 4050.7240s
	iters: 200, epoch: 14 | loss: 3.4742334
	speed: 0.0766s/iter; left time: 1370.4725s
Epoch: 14 cost time: 16.398862838745117
Epoch: 14, Steps: 208 | Train Loss: 3.578 Vali Loss: 3.610 Vali Acc: 0.041 Test Loss: 3.610 Test Acc: 0.041
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 3.5903981
	speed: 0.2391s/iter; left time: 4252.9643s
	iters: 200, epoch: 15 | loss: 3.5484278
	speed: 0.0741s/iter; left time: 1310.3508s
Epoch: 15 cost time: 16.320326328277588
Epoch: 15, Steps: 208 | Train Loss: 3.620 Vali Loss: 3.632 Vali Acc: 0.032 Test Loss: 3.632 Test Acc: 0.032
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 3.9431219
	speed: 0.2312s/iter; left time: 4064.7700s
	iters: 200, epoch: 16 | loss: 3.6988368
	speed: 0.0724s/iter; left time: 1266.2441s
Epoch: 16 cost time: 15.917629957199097
Epoch: 16, Steps: 208 | Train Loss: 3.640 Vali Loss: 3.603 Vali Acc: 0.038 Test Loss: 3.603 Test Acc: 0.038
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09096331643304503
model parameter : 4025687
model size : 17.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.4411159
	speed: 0.0912s/iter; left time: 1887.8038s
	iters: 200, epoch: 1 | loss: 3.8325114
	speed: 0.0698s/iter; left time: 1438.4594s
Epoch: 1 cost time: 16.75472140312195
Epoch: 1, Steps: 208 | Train Loss: 3.873 Vali Loss: 3.702 Vali Acc: 0.045 Test Loss: 3.702 Test Acc: 0.045
Validation loss decreased (inf --> -0.045296).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.0635123
	speed: 0.2231s/iter; left time: 4572.0631s
	iters: 200, epoch: 2 | loss: 3.4767702
	speed: 0.0703s/iter; left time: 1434.2200s
Epoch: 2 cost time: 15.758622169494629
Epoch: 2, Steps: 208 | Train Loss: 3.641 Vali Loss: 3.532 Vali Acc: 0.059 Test Loss: 3.532 Test Acc: 0.059
Validation loss decreased (-0.045296 --> -0.058718).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5926604
	speed: 0.2342s/iter; left time: 4751.6652s
	iters: 200, epoch: 3 | loss: 3.4610939
	speed: 0.0679s/iter; left time: 1369.8262s
Epoch: 3 cost time: 14.741560459136963
Epoch: 3, Steps: 208 | Train Loss: 3.576 Vali Loss: 3.521 Vali Acc: 0.078 Test Loss: 3.521 Test Acc: 0.078
Validation loss decreased (-0.058718 --> -0.078104).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4671454
	speed: 0.2167s/iter; left time: 4350.2227s
	iters: 200, epoch: 4 | loss: 3.8154480
	speed: 0.0721s/iter; left time: 1439.7592s
Epoch: 4 cost time: 15.652118444442749
Epoch: 4, Steps: 208 | Train Loss: 3.431 Vali Loss: 3.438 Vali Acc: 0.076 Test Loss: 3.438 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.1287591
	speed: 0.2172s/iter; left time: 4314.9190s
	iters: 200, epoch: 5 | loss: 3.0212562
	speed: 0.0733s/iter; left time: 1449.5966s
Epoch: 5 cost time: 15.771876335144043
Epoch: 5, Steps: 208 | Train Loss: 3.295 Vali Loss: 3.389 Vali Acc: 0.076 Test Loss: 3.389 Test Acc: 0.076
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 3.7375908
	speed: 0.2195s/iter; left time: 4314.8444s
	iters: 200, epoch: 6 | loss: 3.0559635
	speed: 0.0678s/iter; left time: 1325.6987s
Epoch: 6 cost time: 14.987493991851807
Epoch: 6, Steps: 208 | Train Loss: 3.209 Vali Loss: 3.296 Vali Acc: 0.089 Test Loss: 3.296 Test Acc: 0.089
Validation loss decreased (-0.078104 --> -0.088544).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.2469914
	speed: 0.2255s/iter; left time: 4386.1027s
	iters: 200, epoch: 7 | loss: 3.4073901
	speed: 0.0710s/iter; left time: 1373.7486s
Epoch: 7 cost time: 15.558679580688477
Epoch: 7, Steps: 208 | Train Loss: 3.205 Vali Loss: 3.489 Vali Acc: 0.066 Test Loss: 3.489 Test Acc: 0.066
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 3.7717230
	speed: 0.2301s/iter; left time: 4428.6051s
	iters: 200, epoch: 8 | loss: 3.4145639
	speed: 0.0681s/iter; left time: 1303.8410s
Epoch: 8 cost time: 15.027909755706787
Epoch: 8, Steps: 208 | Train Loss: 3.233 Vali Loss: 3.237 Vali Acc: 0.087 Test Loss: 3.237 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 3.3692098
	speed: 0.2204s/iter; left time: 4195.9742s
	iters: 200, epoch: 9 | loss: 3.4153521
	speed: 0.0658s/iter; left time: 1245.6649s
Epoch: 9 cost time: 14.359910249710083
Epoch: 9, Steps: 208 | Train Loss: 3.262 Vali Loss: 3.256 Vali Acc: 0.089 Test Loss: 3.256 Test Acc: 0.089
Validation loss decreased (-0.088544 --> -0.088843).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.9656091
	speed: 0.2364s/iter; left time: 4451.2868s
	iters: 200, epoch: 10 | loss: 3.2323370
	speed: 0.0711s/iter; left time: 1330.7794s
Epoch: 10 cost time: 15.482851028442383
Epoch: 10, Steps: 208 | Train Loss: 3.172 Vali Loss: 3.225 Vali Acc: 0.097 Test Loss: 3.225 Test Acc: 0.097
Validation loss decreased (-0.088843 --> -0.096896).  Saving model ...
	iters: 100, epoch: 11 | loss: 3.1771255
	speed: 0.2142s/iter; left time: 3988.6624s
	iters: 200, epoch: 11 | loss: 3.1152227
	speed: 0.0705s/iter; left time: 1306.1995s
Epoch: 11 cost time: 15.252095699310303
Epoch: 11, Steps: 208 | Train Loss: 3.173 Vali Loss: 3.472 Vali Acc: 0.064 Test Loss: 3.472 Test Acc: 0.064
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 3.2678375
	speed: 0.2197s/iter; left time: 4045.5419s
	iters: 200, epoch: 12 | loss: 3.5397277
	speed: 0.0679s/iter; left time: 1242.9719s
Epoch: 12 cost time: 15.373567581176758
Epoch: 12, Steps: 208 | Train Loss: 3.283 Vali Loss: 3.355 Vali Acc: 0.078 Test Loss: 3.355 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 3.6041574
	speed: 0.2169s/iter; left time: 3948.2048s
	iters: 200, epoch: 13 | loss: 2.9321964
	speed: 0.0729s/iter; left time: 1319.1328s
Epoch: 13 cost time: 15.642856121063232
Epoch: 13, Steps: 208 | Train Loss: 3.255 Vali Loss: 3.333 Vali Acc: 0.078 Test Loss: 3.333 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 3.2723632
	speed: 0.2101s/iter; left time: 3781.2955s
	iters: 200, epoch: 14 | loss: 3.0464747
	speed: 0.0666s/iter; left time: 1192.4393s
Epoch: 14 cost time: 14.917152881622314
Epoch: 14, Steps: 208 | Train Loss: 3.203 Vali Loss: 3.315 Vali Acc: 0.087 Test Loss: 3.315 Test Acc: 0.087
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 2.9923229
	speed: 0.2129s/iter; left time: 3787.0174s
	iters: 200, epoch: 15 | loss: 3.6083696
	speed: 0.0713s/iter; left time: 1261.8881s
Epoch: 15 cost time: 15.436292171478271
Epoch: 15, Steps: 208 | Train Loss: 3.260 Vali Loss: 3.441 Vali Acc: 0.069 Test Loss: 3.441 Test Acc: 0.069
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 3.1485045
	speed: 0.2177s/iter; left time: 3826.9670s
	iters: 200, epoch: 16 | loss: 3.4603584
	speed: 0.0716s/iter; left time: 1250.8872s
Epoch: 16 cost time: 15.12716817855835
Epoch: 16, Steps: 208 | Train Loss: 3.421 Vali Loss: 3.450 Vali Acc: 0.064 Test Loss: 3.450 Test Acc: 0.064
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 3.3800669
	speed: 0.2287s/iter; left time: 3973.1977s
	iters: 200, epoch: 17 | loss: 3.6009183
	speed: 0.0809s/iter; left time: 1397.1117s
Epoch: 17 cost time: 17.529560565948486
Epoch: 17, Steps: 208 | Train Loss: 3.364 Vali Loss: 3.437 Vali Acc: 0.062 Test Loss: 3.437 Test Acc: 0.062
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 3.5585053
	speed: 0.2509s/iter; left time: 4305.8734s
	iters: 200, epoch: 18 | loss: 3.3426886
	speed: 0.0741s/iter; left time: 1264.5591s
Epoch: 18 cost time: 15.871271848678589
Epoch: 18, Steps: 208 | Train Loss: 3.477 Vali Loss: 3.483 Vali Acc: 0.063 Test Loss: 3.483 Test Acc: 0.063
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 3.5849295
	speed: 0.2248s/iter; left time: 3812.2835s
	iters: 200, epoch: 19 | loss: 3.4899697
	speed: 0.0694s/iter; left time: 1169.6491s
Epoch: 19 cost time: 15.378190755844116
Epoch: 19, Steps: 208 | Train Loss: 3.474 Vali Loss: 3.490 Vali Acc: 0.056 Test Loss: 3.490 Test Acc: 0.056
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 3.7144206
	speed: 0.2166s/iter; left time: 3628.5167s
	iters: 200, epoch: 20 | loss: 3.4434578
	speed: 0.0718s/iter; left time: 1195.2742s
Epoch: 20 cost time: 15.837604284286499
Epoch: 20, Steps: 208 | Train Loss: 3.451 Vali Loss: 3.409 Vali Acc: 0.067 Test Loss: 3.409 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.0969281240679988
model parameter : 4021335
model size : 17.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0220623
	speed: 0.0794s/iter; left time: 1642.6318s
	iters: 200, epoch: 1 | loss: 3.8496752
	speed: 0.0599s/iter; left time: 1234.2027s
Epoch: 1 cost time: 14.505311489105225
Epoch: 1, Steps: 208 | Train Loss: 3.893 Vali Loss: 3.995 Vali Acc: 0.036 Test Loss: 3.995 Test Acc: 0.036
Validation loss decreased (inf --> -0.036047).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9142118
	speed: 0.2104s/iter; left time: 4312.6599s
	iters: 200, epoch: 2 | loss: 3.6064560
	speed: 0.0744s/iter; left time: 1517.8867s
Epoch: 2 cost time: 15.84581971168518
Epoch: 2, Steps: 208 | Train Loss: 3.662 Vali Loss: 3.663 Vali Acc: 0.050 Test Loss: 3.663 Test Acc: 0.050
Validation loss decreased (-0.036047 --> -0.049471).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5504982
	speed: 0.2056s/iter; left time: 4170.6744s
	iters: 200, epoch: 3 | loss: 3.8480120
	speed: 0.0691s/iter; left time: 1395.5930s
Epoch: 3 cost time: 14.521135330200195
Epoch: 3, Steps: 208 | Train Loss: 3.577 Vali Loss: 3.525 Vali Acc: 0.064 Test Loss: 3.525 Test Acc: 0.064
Validation loss decreased (-0.049471 --> -0.064086).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.1954379
	speed: 0.2138s/iter; left time: 4292.0798s
	iters: 200, epoch: 4 | loss: 3.4697437
	speed: 0.0706s/iter; left time: 1410.1447s
Epoch: 4 cost time: 15.37066102027893
Epoch: 4, Steps: 208 | Train Loss: 3.430 Vali Loss: 3.411 Vali Acc: 0.079 Test Loss: 3.411 Test Acc: 0.079
Validation loss decreased (-0.064086 --> -0.078701).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3406138
	speed: 0.2395s/iter; left time: 4758.6318s
	iters: 200, epoch: 5 | loss: 2.9656134
	speed: 0.0758s/iter; left time: 1498.8804s
Epoch: 5 cost time: 16.13599681854248
Epoch: 5, Steps: 208 | Train Loss: 3.296 Vali Loss: 3.294 Vali Acc: 0.083 Test Loss: 3.294 Test Acc: 0.083
Validation loss decreased (-0.078701 --> -0.083176).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0386930
	speed: 0.2268s/iter; left time: 4458.6675s
	iters: 200, epoch: 6 | loss: 3.6215811
	speed: 0.0669s/iter; left time: 1309.4939s
Epoch: 6 cost time: 14.869547605514526
Epoch: 6, Steps: 208 | Train Loss: 3.175 Vali Loss: 3.275 Vali Acc: 0.098 Test Loss: 3.275 Test Acc: 0.098
Validation loss decreased (-0.083176 --> -0.097790).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.2126818
	speed: 0.2348s/iter; left time: 4567.9667s
	iters: 200, epoch: 7 | loss: 3.2482326
	speed: 0.0714s/iter; left time: 1381.6201s
Epoch: 7 cost time: 15.363173723220825
Epoch: 7, Steps: 208 | Train Loss: 3.164 Vali Loss: 3.273 Vali Acc: 0.081 Test Loss: 3.273 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 3.0655272
	speed: 0.2247s/iter; left time: 4324.0281s
	iters: 200, epoch: 8 | loss: 3.4356484
	speed: 0.0731s/iter; left time: 1399.9055s
Epoch: 8 cost time: 15.904978513717651
Epoch: 8, Steps: 208 | Train Loss: 3.167 Vali Loss: 3.422 Vali Acc: 0.075 Test Loss: 3.422 Test Acc: 0.075
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 3.0110877
	speed: 0.2084s/iter; left time: 3966.4483s
	iters: 200, epoch: 9 | loss: 3.2879155
	speed: 0.0700s/iter; left time: 1324.9572s
Epoch: 9 cost time: 15.288911581039429
Epoch: 9, Steps: 208 | Train Loss: 3.343 Vali Loss: 3.402 Vali Acc: 0.067 Test Loss: 3.402 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 3.1344800
	speed: 0.2175s/iter; left time: 4095.1711s
	iters: 200, epoch: 10 | loss: 3.3339651
	speed: 0.0701s/iter; left time: 1313.4582s
Epoch: 10 cost time: 15.06564474105835
Epoch: 10, Steps: 208 | Train Loss: 3.443 Vali Loss: 3.489 Vali Acc: 0.058 Test Loss: 3.489 Test Acc: 0.058
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 3.8022444
	speed: 0.2168s/iter; left time: 4037.0700s
	iters: 200, epoch: 11 | loss: 3.2375767
	speed: 0.0690s/iter; left time: 1277.2711s
Epoch: 11 cost time: 14.968709468841553
Epoch: 11, Steps: 208 | Train Loss: 3.454 Vali Loss: 3.458 Vali Acc: 0.060 Test Loss: 3.458 Test Acc: 0.060
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 3.6392293
	speed: 0.2136s/iter; left time: 3932.3375s
	iters: 200, epoch: 12 | loss: 3.6293187
	speed: 0.0716s/iter; left time: 1311.4070s
Epoch: 12 cost time: 15.376234769821167
Epoch: 12, Steps: 208 | Train Loss: 3.421 Vali Loss: 3.448 Vali Acc: 0.061 Test Loss: 3.448 Test Acc: 0.061
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 3.2976313
	speed: 0.2029s/iter; left time: 3693.0581s
	iters: 200, epoch: 13 | loss: 3.5404720
	speed: 0.0686s/iter; left time: 1242.4149s
Epoch: 13 cost time: 14.450339317321777
Epoch: 13, Steps: 208 | Train Loss: 3.483 Vali Loss: 3.497 Vali Acc: 0.058 Test Loss: 3.497 Test Acc: 0.058
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 3.6626680
	speed: 0.2203s/iter; left time: 3964.5967s
	iters: 200, epoch: 14 | loss: 3.5182772
	speed: 0.0762s/iter; left time: 1363.9782s
Epoch: 14 cost time: 15.668418884277344
Epoch: 14, Steps: 208 | Train Loss: 3.509 Vali Loss: 3.496 Vali Acc: 0.048 Test Loss: 3.496 Test Acc: 0.048
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 3.3868833
	speed: 0.2187s/iter; left time: 3891.0565s
	iters: 200, epoch: 15 | loss: 3.6276066
	speed: 0.0687s/iter; left time: 1215.5662s
Epoch: 15 cost time: 14.790120363235474
Epoch: 15, Steps: 208 | Train Loss: 3.482 Vali Loss: 3.469 Vali Acc: 0.058 Test Loss: 3.469 Test Acc: 0.058
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 3.3746791
	speed: 0.2134s/iter; left time: 3751.5248s
	iters: 200, epoch: 16 | loss: 3.4403796
	speed: 0.0687s/iter; left time: 1200.9411s
Epoch: 16 cost time: 14.856797218322754
Epoch: 16, Steps: 208 | Train Loss: 3.486 Vali Loss: 3.464 Vali Acc: 0.056 Test Loss: 3.464 Test Acc: 0.056
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09782284521324187
model parameter : 4016983
model size : 17.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7772503
	speed: 0.0940s/iter; left time: 1946.4544s
	iters: 200, epoch: 1 | loss: 3.8785822
	speed: 0.0780s/iter; left time: 1606.7372s
Epoch: 1 cost time: 17.876232862472534
Epoch: 1, Steps: 208 | Train Loss: 3.892 Vali Loss: 3.834 Vali Acc: 0.049 Test Loss: 3.834 Test Acc: 0.049
Validation loss decreased (inf --> -0.048873).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4497087
	speed: 0.2173s/iter; left time: 4452.2865s
	iters: 200, epoch: 2 | loss: 3.3448892
	speed: 0.0691s/iter; left time: 1409.0051s
Epoch: 2 cost time: 15.434289693832397
Epoch: 2, Steps: 208 | Train Loss: 3.660 Vali Loss: 3.609 Vali Acc: 0.059 Test Loss: 3.609 Test Acc: 0.059
Validation loss decreased (-0.048873 --> -0.059314).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6319604
	speed: 0.2184s/iter; left time: 4430.6406s
	iters: 200, epoch: 3 | loss: 3.6023519
	speed: 0.0744s/iter; left time: 1501.5092s
Epoch: 3 cost time: 15.655714988708496
Epoch: 3, Steps: 208 | Train Loss: 3.573 Vali Loss: 3.550 Vali Acc: 0.065 Test Loss: 3.550 Test Acc: 0.065
Validation loss decreased (-0.059314 --> -0.064683).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3025370
	speed: 0.2053s/iter; left time: 4122.2306s
	iters: 200, epoch: 4 | loss: 3.7117746
	speed: 0.0712s/iter; left time: 1422.6785s
Epoch: 4 cost time: 15.59824514389038
Epoch: 4, Steps: 208 | Train Loss: 3.428 Vali Loss: 3.339 Vali Acc: 0.077 Test Loss: 3.339 Test Acc: 0.077
Validation loss decreased (-0.064683 --> -0.076614).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.8564820
	speed: 0.2168s/iter; left time: 4308.2725s
	iters: 200, epoch: 5 | loss: 3.1389871
	speed: 0.0715s/iter; left time: 1413.5046s
Epoch: 5 cost time: 15.789933204650879
Epoch: 5, Steps: 208 | Train Loss: 3.245 Vali Loss: 3.230 Vali Acc: 0.100 Test Loss: 3.230 Test Acc: 0.100
Validation loss decreased (-0.076614 --> -0.099878).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2681441
	speed: 0.2452s/iter; left time: 4821.4097s
	iters: 200, epoch: 6 | loss: 2.7353330
	speed: 0.0786s/iter; left time: 1537.4630s
Epoch: 6 cost time: 16.628096342086792
Epoch: 6, Steps: 208 | Train Loss: 3.122 Vali Loss: 3.170 Vali Acc: 0.103 Test Loss: 3.170 Test Acc: 0.103
Validation loss decreased (-0.099878 --> -0.103458).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.1871676
	speed: 0.2160s/iter; left time: 4201.9372s
	iters: 200, epoch: 7 | loss: 2.8707745
	speed: 0.0698s/iter; left time: 1351.5868s
Epoch: 7 cost time: 14.98702621459961
Epoch: 7, Steps: 208 | Train Loss: 3.065 Vali Loss: 3.177 Vali Acc: 0.118 Test Loss: 3.177 Test Acc: 0.118
Validation loss decreased (-0.103458 --> -0.117773).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.9981675
	speed: 0.2159s/iter; left time: 4154.3848s
	iters: 200, epoch: 8 | loss: 3.0377748
	speed: 0.0715s/iter; left time: 1368.9254s
Epoch: 8 cost time: 15.321161270141602
Epoch: 8, Steps: 208 | Train Loss: 2.955 Vali Loss: 3.110 Vali Acc: 0.112 Test Loss: 3.110 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.5691793
	speed: 0.2330s/iter; left time: 4434.7907s
	iters: 200, epoch: 9 | loss: 2.5061345
	speed: 0.0724s/iter; left time: 1371.4965s
Epoch: 9 cost time: 15.560324907302856
Epoch: 9, Steps: 208 | Train Loss: 2.840 Vali Loss: 3.099 Vali Acc: 0.111 Test Loss: 3.099 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 2.9806619
	speed: 0.2078s/iter; left time: 3912.6933s
	iters: 200, epoch: 10 | loss: 2.8284578
	speed: 0.0779s/iter; left time: 1458.6001s
Epoch: 10 cost time: 16.32781744003296
Epoch: 10, Steps: 208 | Train Loss: 2.829 Vali Loss: 3.125 Vali Acc: 0.109 Test Loss: 3.125 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 2.5577192
	speed: 0.2166s/iter; left time: 4034.0547s
	iters: 200, epoch: 11 | loss: 2.9988964
	speed: 0.0733s/iter; left time: 1357.5915s
Epoch: 11 cost time: 15.789554834365845
Epoch: 11, Steps: 208 | Train Loss: 2.838 Vali Loss: 3.130 Vali Acc: 0.112 Test Loss: 3.130 Test Acc: 0.112
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 2.5377321
	speed: 0.2222s/iter; left time: 4091.7157s
	iters: 200, epoch: 12 | loss: 2.7821975
	speed: 0.0757s/iter; left time: 1385.5959s
Epoch: 12 cost time: 16.11546778678894
Epoch: 12, Steps: 208 | Train Loss: 2.785 Vali Loss: 3.162 Vali Acc: 0.124 Test Loss: 3.162 Test Acc: 0.124
Validation loss decreased (-0.117773 --> -0.124335).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.6547413
	speed: 0.2053s/iter; left time: 3736.7229s
	iters: 200, epoch: 13 | loss: 3.1794269
	speed: 0.0699s/iter; left time: 1266.1812s
Epoch: 13 cost time: 14.911410808563232
Epoch: 13, Steps: 208 | Train Loss: 2.738 Vali Loss: 3.094 Vali Acc: 0.132 Test Loss: 3.094 Test Acc: 0.132
Validation loss decreased (-0.124335 --> -0.132388).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.8303015
	speed: 0.1971s/iter; left time: 3547.1057s
	iters: 200, epoch: 14 | loss: 2.4965284
	speed: 0.0612s/iter; left time: 1095.1803s
Epoch: 14 cost time: 13.745945692062378
Epoch: 14, Steps: 208 | Train Loss: 2.704 Vali Loss: 3.159 Vali Acc: 0.123 Test Loss: 3.159 Test Acc: 0.123
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.7785063
	speed: 0.2162s/iter; left time: 3845.1330s
	iters: 200, epoch: 15 | loss: 3.0046086
	speed: 0.0713s/iter; left time: 1261.4421s
Epoch: 15 cost time: 14.512901544570923
Epoch: 15, Steps: 208 | Train Loss: 2.705 Vali Loss: 3.215 Vali Acc: 0.111 Test Loss: 3.215 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 2.7149014
	speed: 0.2271s/iter; left time: 3993.1330s
	iters: 200, epoch: 16 | loss: 3.0169652
	speed: 0.0731s/iter; left time: 1278.5313s
Epoch: 16 cost time: 15.202687501907349
Epoch: 16, Steps: 208 | Train Loss: 2.743 Vali Loss: 3.166 Vali Acc: 0.127 Test Loss: 3.166 Test Acc: 0.127
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 2.6869864
	speed: 0.2236s/iter; left time: 3884.5055s
	iters: 200, epoch: 17 | loss: 2.9118938
	speed: 0.0717s/iter; left time: 1239.1058s
Epoch: 17 cost time: 15.6487557888031
Epoch: 17, Steps: 208 | Train Loss: 2.760 Vali Loss: 3.180 Vali Acc: 0.115 Test Loss: 3.180 Test Acc: 0.115
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 2.8466794
	speed: 0.2140s/iter; left time: 3672.8536s
	iters: 200, epoch: 18 | loss: 2.4628382
	speed: 0.0756s/iter; left time: 1290.9251s
Epoch: 18 cost time: 15.808138132095337
Epoch: 18, Steps: 208 | Train Loss: 2.794 Vali Loss: 3.240 Vali Acc: 0.101 Test Loss: 3.240 Test Acc: 0.101
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 2.7788112
	speed: 0.2271s/iter; left time: 3850.9362s
	iters: 200, epoch: 19 | loss: 3.0731177
	speed: 0.0761s/iter; left time: 1282.0986s
Epoch: 19 cost time: 16.29186749458313
Epoch: 19, Steps: 208 | Train Loss: 2.828 Vali Loss: 3.232 Vali Acc: 0.102 Test Loss: 3.232 Test Acc: 0.102
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 2.9234722
	speed: 0.2112s/iter; left time: 3536.6805s
	iters: 200, epoch: 20 | loss: 3.1284959
	speed: 0.0749s/iter; left time: 1246.6710s
Epoch: 20 cost time: 15.21094536781311
Epoch: 20, Steps: 208 | Train Loss: 2.789 Vali Loss: 3.164 Vali Acc: 0.110 Test Loss: 3.164 Test Acc: 0.110
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 3.0046296
	speed: 0.2160s/iter; left time: 3572.8641s
	iters: 200, epoch: 21 | loss: 2.8553023
	speed: 0.0734s/iter; left time: 1206.4046s
Epoch: 21 cost time: 16.345523595809937
Epoch: 21, Steps: 208 | Train Loss: 2.788 Vali Loss: 3.175 Vali Acc: 0.114 Test Loss: 3.175 Test Acc: 0.114
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 2.5644326
	speed: 0.2370s/iter; left time: 3870.7347s
	iters: 200, epoch: 22 | loss: 3.1720493
	speed: 0.0716s/iter; left time: 1162.2048s
Epoch: 22 cost time: 15.899202346801758
Epoch: 22, Steps: 208 | Train Loss: 2.762 Vali Loss: 3.198 Vali Acc: 0.111 Test Loss: 3.198 Test Acc: 0.111
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 2.9494720
	speed: 0.2153s/iter; left time: 3472.1054s
	iters: 200, epoch: 23 | loss: 3.2699232
	speed: 0.0731s/iter; left time: 1172.0483s
Epoch: 23 cost time: 15.880752325057983
Epoch: 23, Steps: 208 | Train Loss: 2.822 Vali Loss: 3.265 Vali Acc: 0.119 Test Loss: 3.265 Test Acc: 0.119
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13241872949597375
model parameter : 3108951
model size : 14.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.2477655
	speed: 0.0876s/iter; left time: 1812.8821s
	iters: 200, epoch: 1 | loss: 3.4984834
	speed: 0.0678s/iter; left time: 1396.7197s
Epoch: 1 cost time: 16.2603600025177
Epoch: 1, Steps: 208 | Train Loss: 3.916 Vali Loss: 3.699 Vali Acc: 0.057 Test Loss: 3.699 Test Acc: 0.057
Validation loss decreased (inf --> -0.056629).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7985461
	speed: 0.2239s/iter; left time: 4588.8201s
	iters: 200, epoch: 2 | loss: 3.4229982
	speed: 0.0670s/iter; left time: 1365.7489s
Epoch: 2 cost time: 15.115079879760742
Epoch: 2, Steps: 208 | Train Loss: 3.682 Vali Loss: 3.647 Vali Acc: 0.046 Test Loss: 3.647 Test Acc: 0.046
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.3746228
	speed: 0.2180s/iter; left time: 4421.6147s
	iters: 200, epoch: 3 | loss: 3.8255587
	speed: 0.0696s/iter; left time: 1404.8329s
Epoch: 3 cost time: 15.049094200134277
Epoch: 3, Steps: 208 | Train Loss: 3.571 Vali Loss: 3.607 Vali Acc: 0.058 Test Loss: 3.607 Test Acc: 0.058
Validation loss decreased (-0.056629 --> -0.058419).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.0264995
	speed: 0.2113s/iter; left time: 4241.6257s
	iters: 200, epoch: 4 | loss: 3.3114769
	speed: 0.0683s/iter; left time: 1364.1449s
Epoch: 4 cost time: 14.559642553329468
Epoch: 4, Steps: 208 | Train Loss: 3.447 Vali Loss: 3.583 Vali Acc: 0.054 Test Loss: 3.583 Test Acc: 0.054
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.0634797
	speed: 0.2187s/iter; left time: 4345.4692s
	iters: 200, epoch: 5 | loss: 3.4330823
	speed: 0.0710s/iter; left time: 1403.7598s
Epoch: 5 cost time: 15.248473405838013
Epoch: 5, Steps: 208 | Train Loss: 3.301 Vali Loss: 3.258 Vali Acc: 0.094 Test Loss: 3.258 Test Acc: 0.094
Validation loss decreased (-0.058419 --> -0.094211).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.9597991
	speed: 0.2101s/iter; left time: 4130.7523s
	iters: 200, epoch: 6 | loss: 2.9075186
	speed: 0.0637s/iter; left time: 1246.1781s
Epoch: 6 cost time: 14.419638633728027
Epoch: 6, Steps: 208 | Train Loss: 3.178 Vali Loss: 3.272 Vali Acc: 0.087 Test Loss: 3.272 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.9022677
	speed: 0.2087s/iter; left time: 4060.5832s
	iters: 200, epoch: 7 | loss: 2.7629075
	speed: 0.0679s/iter; left time: 1313.1332s
Epoch: 7 cost time: 14.864432096481323
Epoch: 7, Steps: 208 | Train Loss: 3.147 Vali Loss: 3.297 Vali Acc: 0.082 Test Loss: 3.297 Test Acc: 0.082
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.8238034
	speed: 0.2145s/iter; left time: 4127.5915s
	iters: 200, epoch: 8 | loss: 3.1903009
	speed: 0.0743s/iter; left time: 1422.1105s
Epoch: 8 cost time: 15.735384702682495
Epoch: 8, Steps: 208 | Train Loss: 3.087 Vali Loss: 3.156 Vali Acc: 0.107 Test Loss: 3.156 Test Acc: 0.107
Validation loss decreased (-0.094211 --> -0.107335).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.0105288
	speed: 0.2149s/iter; left time: 4091.0623s
	iters: 200, epoch: 9 | loss: 2.4444623
	speed: 0.0690s/iter; left time: 1307.2291s
Epoch: 9 cost time: 14.759244918823242
Epoch: 9, Steps: 208 | Train Loss: 3.020 Vali Loss: 3.200 Vali Acc: 0.109 Test Loss: 3.200 Test Acc: 0.109
Validation loss decreased (-0.107335 --> -0.108527).  Saving model ...
	iters: 100, epoch: 10 | loss: 3.2808404
	speed: 0.2149s/iter; left time: 4046.4185s
	iters: 200, epoch: 10 | loss: 3.3571994
	speed: 0.0672s/iter; left time: 1259.1070s
Epoch: 10 cost time: 14.386955976486206
Epoch: 10, Steps: 208 | Train Loss: 3.021 Vali Loss: 3.195 Vali Acc: 0.100 Test Loss: 3.195 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.9803104
	speed: 0.2178s/iter; left time: 4054.9764s
	iters: 200, epoch: 11 | loss: 3.2790427
	speed: 0.0703s/iter; left time: 1301.4562s
Epoch: 11 cost time: 15.07895040512085
Epoch: 11, Steps: 208 | Train Loss: 2.999 Vali Loss: 3.209 Vali Acc: 0.090 Test Loss: 3.209 Test Acc: 0.090
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 3.1380539
	speed: 0.2187s/iter; left time: 4026.6951s
	iters: 200, epoch: 12 | loss: 3.0182652
	speed: 0.0736s/iter; left time: 1347.4805s
Epoch: 12 cost time: 15.404041290283203
Epoch: 12, Steps: 208 | Train Loss: 2.997 Vali Loss: 3.271 Vali Acc: 0.082 Test Loss: 3.271 Test Acc: 0.082
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 3.3637578
	speed: 0.2173s/iter; left time: 3956.6427s
	iters: 200, epoch: 13 | loss: 2.9993019
	speed: 0.0658s/iter; left time: 1191.0096s
Epoch: 13 cost time: 14.827149152755737
Epoch: 13, Steps: 208 | Train Loss: 2.975 Vali Loss: 3.213 Vali Acc: 0.104 Test Loss: 3.213 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 3.1614835
	speed: 0.2109s/iter; left time: 3795.6291s
	iters: 200, epoch: 14 | loss: 3.3282487
	speed: 0.0625s/iter; left time: 1119.3660s
Epoch: 14 cost time: 13.630931615829468
Epoch: 14, Steps: 208 | Train Loss: 2.937 Vali Loss: 3.256 Vali Acc: 0.097 Test Loss: 3.256 Test Acc: 0.097
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 3.1276400
	speed: 0.2100s/iter; left time: 3735.9243s
	iters: 200, epoch: 15 | loss: 2.9937243
	speed: 0.0706s/iter; left time: 1248.0503s
Epoch: 15 cost time: 15.601803064346313
Epoch: 15, Steps: 208 | Train Loss: 2.998 Vali Loss: 3.274 Vali Acc: 0.094 Test Loss: 3.274 Test Acc: 0.094
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 3.0504436
	speed: 0.2088s/iter; left time: 3670.7739s
	iters: 200, epoch: 16 | loss: 3.0062497
	speed: 0.0699s/iter; left time: 1221.8364s
Epoch: 16 cost time: 15.129523992538452
Epoch: 16, Steps: 208 | Train Loss: 3.012 Vali Loss: 3.294 Vali Acc: 0.100 Test Loss: 3.294 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 3.0735667
	speed: 0.2311s/iter; left time: 4014.3828s
	iters: 200, epoch: 17 | loss: 3.2763851
	speed: 0.0692s/iter; left time: 1195.9859s
Epoch: 17 cost time: 15.244854211807251
Epoch: 17, Steps: 208 | Train Loss: 3.094 Vali Loss: 3.477 Vali Acc: 0.063 Test Loss: 3.477 Test Acc: 0.063
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 2.9953470
	speed: 0.2247s/iter; left time: 3857.3920s
	iters: 200, epoch: 18 | loss: 3.1856878
	speed: 0.0701s/iter; left time: 1196.9096s
Epoch: 18 cost time: 15.499190092086792
Epoch: 18, Steps: 208 | Train Loss: 3.188 Vali Loss: 3.302 Vali Acc: 0.093 Test Loss: 3.302 Test Acc: 0.093
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 3.5271378
	speed: 0.2263s/iter; left time: 3837.9216s
	iters: 200, epoch: 19 | loss: 2.9325294
	speed: 0.0698s/iter; left time: 1176.3326s
Epoch: 19 cost time: 15.506977558135986
Epoch: 19, Steps: 208 | Train Loss: 3.115 Vali Loss: 3.263 Vali Acc: 0.098 Test Loss: 3.263 Test Acc: 0.098
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10855949895615867
model parameter : 3104599
model size : 14.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8210697
	speed: 0.0917s/iter; left time: 1897.8447s
	iters: 200, epoch: 1 | loss: 4.1968369
	speed: 0.0752s/iter; left time: 1549.2049s
Epoch: 1 cost time: 17.42076063156128
Epoch: 1, Steps: 208 | Train Loss: 3.950 Vali Loss: 3.834 Vali Acc: 0.057 Test Loss: 3.834 Test Acc: 0.057
Validation loss decreased (inf --> -0.056926).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5843241
	speed: 0.2264s/iter; left time: 4639.7108s
	iters: 200, epoch: 2 | loss: 3.4226232
	speed: 0.0742s/iter; left time: 1513.5570s
Epoch: 2 cost time: 15.977434873580933
Epoch: 2, Steps: 208 | Train Loss: 3.785 Vali Loss: 3.586 Vali Acc: 0.062 Test Loss: 3.586 Test Acc: 0.062
Validation loss decreased (-0.056926 --> -0.062296).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3249986
	speed: 0.2208s/iter; left time: 4478.8181s
	iters: 200, epoch: 3 | loss: 3.7428052
	speed: 0.0713s/iter; left time: 1439.3364s
Epoch: 3 cost time: 15.601320505142212
Epoch: 3, Steps: 208 | Train Loss: 3.594 Vali Loss: 3.517 Vali Acc: 0.058 Test Loss: 3.517 Test Acc: 0.058
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.2579744
	speed: 0.2167s/iter; left time: 4351.4655s
	iters: 200, epoch: 4 | loss: 3.2708008
	speed: 0.0743s/iter; left time: 1484.3303s
Epoch: 4 cost time: 15.686737298965454
Epoch: 4, Steps: 208 | Train Loss: 3.429 Vali Loss: 3.324 Vali Acc: 0.084 Test Loss: 3.324 Test Acc: 0.084
Validation loss decreased (-0.062296 --> -0.083474).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.7563968
	speed: 0.2237s/iter; left time: 4444.8535s
	iters: 200, epoch: 5 | loss: 3.3056512
	speed: 0.0713s/iter; left time: 1409.3738s
Epoch: 5 cost time: 15.658338069915771
Epoch: 5, Steps: 208 | Train Loss: 3.273 Vali Loss: 3.253 Vali Acc: 0.097 Test Loss: 3.253 Test Acc: 0.097
Validation loss decreased (-0.083474 --> -0.097194).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.9802153
	speed: 0.2346s/iter; left time: 4612.9751s
	iters: 200, epoch: 6 | loss: 3.6109338
	speed: 0.0727s/iter; left time: 1422.7434s
Epoch: 6 cost time: 16.12195873260498
Epoch: 6, Steps: 208 | Train Loss: 3.138 Vali Loss: 3.228 Vali Acc: 0.109 Test Loss: 3.228 Test Acc: 0.109
Validation loss decreased (-0.097194 --> -0.108825).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9212184
	speed: 0.2220s/iter; left time: 4317.7313s
	iters: 200, epoch: 7 | loss: 3.0111725
	speed: 0.0747s/iter; left time: 1446.2535s
Epoch: 7 cost time: 15.413219928741455
Epoch: 7, Steps: 208 | Train Loss: 3.077 Vali Loss: 3.158 Vali Acc: 0.108 Test Loss: 3.158 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.7809637
	speed: 0.2435s/iter; left time: 4685.3977s
	iters: 200, epoch: 8 | loss: 2.9037571
	speed: 0.0722s/iter; left time: 1382.1389s
Epoch: 8 cost time: 15.803837060928345
Epoch: 8, Steps: 208 | Train Loss: 3.014 Vali Loss: 3.204 Vali Acc: 0.094 Test Loss: 3.204 Test Acc: 0.094
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.8040538
	speed: 0.2376s/iter; left time: 4523.0477s
	iters: 200, epoch: 9 | loss: 3.5639846
	speed: 0.0712s/iter; left time: 1348.5807s
Epoch: 9 cost time: 15.287862539291382
Epoch: 9, Steps: 208 | Train Loss: 2.943 Vali Loss: 3.139 Vali Acc: 0.102 Test Loss: 3.139 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 2.7374463
	speed: 0.2258s/iter; left time: 4251.6632s
	iters: 200, epoch: 10 | loss: 2.6335921
	speed: 0.0750s/iter; left time: 1404.8997s
Epoch: 10 cost time: 15.86106252670288
Epoch: 10, Steps: 208 | Train Loss: 2.878 Vali Loss: 3.104 Vali Acc: 0.109 Test Loss: 3.104 Test Acc: 0.109
Validation loss decreased (-0.108825 --> -0.108827).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.6409094
	speed: 0.2184s/iter; left time: 4067.0087s
	iters: 200, epoch: 11 | loss: 2.8071074
	speed: 0.0721s/iter; left time: 1334.5405s
Epoch: 11 cost time: 15.216851949691772
Epoch: 11, Steps: 208 | Train Loss: 2.816 Vali Loss: 3.172 Vali Acc: 0.109 Test Loss: 3.172 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.6655970
	speed: 0.2168s/iter; left time: 3991.7905s
	iters: 200, epoch: 12 | loss: 2.5646458
	speed: 0.0732s/iter; left time: 1340.8410s
Epoch: 12 cost time: 15.499660015106201
Epoch: 12, Steps: 208 | Train Loss: 2.758 Vali Loss: 3.171 Vali Acc: 0.122 Test Loss: 3.171 Test Acc: 0.122
Validation loss decreased (-0.108827 --> -0.121949).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.8767312
	speed: 0.2180s/iter; left time: 3969.0414s
	iters: 200, epoch: 13 | loss: 2.8436055
	speed: 0.0696s/iter; left time: 1260.3588s
Epoch: 13 cost time: 15.1942138671875
Epoch: 13, Steps: 208 | Train Loss: 2.727 Vali Loss: 3.190 Vali Acc: 0.115 Test Loss: 3.190 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 2.2561102
	speed: 0.2238s/iter; left time: 4027.7092s
	iters: 200, epoch: 14 | loss: 3.0677962
	speed: 0.0676s/iter; left time: 1210.5019s
Epoch: 14 cost time: 15.21794843673706
Epoch: 14, Steps: 208 | Train Loss: 2.865 Vali Loss: 3.230 Vali Acc: 0.095 Test Loss: 3.230 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 3.0793991
	speed: 0.2289s/iter; left time: 4072.7435s
	iters: 200, epoch: 15 | loss: 3.0638237
	speed: 0.0749s/iter; left time: 1325.4275s
Epoch: 15 cost time: 16.10141682624817
Epoch: 15, Steps: 208 | Train Loss: 2.854 Vali Loss: 3.155 Vali Acc: 0.119 Test Loss: 3.155 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 2.6785254
	speed: 0.2242s/iter; left time: 3941.3761s
	iters: 200, epoch: 16 | loss: 2.5007448
	speed: 0.0734s/iter; left time: 1283.9590s
Epoch: 16 cost time: 15.656052589416504
Epoch: 16, Steps: 208 | Train Loss: 2.762 Vali Loss: 3.208 Vali Acc: 0.120 Test Loss: 3.208 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 3.0951772
	speed: 0.2272s/iter; left time: 3947.4719s
	iters: 200, epoch: 17 | loss: 2.9276824
	speed: 0.0726s/iter; left time: 1253.8348s
Epoch: 17 cost time: 15.51254677772522
Epoch: 17, Steps: 208 | Train Loss: 2.796 Vali Loss: 3.209 Vali Acc: 0.111 Test Loss: 3.209 Test Acc: 0.111
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 2.8087656
	speed: 0.2316s/iter; left time: 3975.4903s
	iters: 200, epoch: 18 | loss: 2.7936885
	speed: 0.0691s/iter; left time: 1179.7149s
Epoch: 18 cost time: 14.953528642654419
Epoch: 18, Steps: 208 | Train Loss: 2.826 Vali Loss: 3.246 Vali Acc: 0.106 Test Loss: 3.246 Test Acc: 0.106
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 3.2243414
	speed: 0.2042s/iter; left time: 3462.4206s
	iters: 200, epoch: 19 | loss: 3.0661912
	speed: 0.0698s/iter; left time: 1177.4144s
Epoch: 19 cost time: 15.375468015670776
Epoch: 19, Steps: 208 | Train Loss: 2.843 Vali Loss: 3.255 Vali Acc: 0.101 Test Loss: 3.255 Test Acc: 0.101
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 2.6305056
	speed: 0.2274s/iter; left time: 3808.5751s
	iters: 200, epoch: 20 | loss: 2.9430175
	speed: 0.0744s/iter; left time: 1239.0340s
Epoch: 20 cost time: 15.779382228851318
Epoch: 20, Steps: 208 | Train Loss: 2.865 Vali Loss: 3.253 Vali Acc: 0.099 Test Loss: 3.253 Test Acc: 0.099
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 3.2677391
	speed: 0.2232s/iter; left time: 3692.5697s
	iters: 200, epoch: 21 | loss: 3.0234456
	speed: 0.0719s/iter; left time: 1182.8771s
Epoch: 21 cost time: 14.710509061813354
Epoch: 21, Steps: 208 | Train Loss: 2.971 Vali Loss: 3.249 Vali Acc: 0.092 Test Loss: 3.249 Test Acc: 0.092
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 2.8317206
	speed: 0.2181s/iter; left time: 3562.1757s
	iters: 200, epoch: 22 | loss: 3.2451174
	speed: 0.0686s/iter; left time: 1112.8546s
Epoch: 22 cost time: 15.48490571975708
Epoch: 22, Steps: 208 | Train Loss: 3.129 Vali Loss: 3.324 Vali Acc: 0.091 Test Loss: 3.324 Test Acc: 0.091
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12198031613480466
model parameter : 3100247
model size : 14.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0239124
	speed: 0.0868s/iter; left time: 1797.3754s
	iters: 200, epoch: 1 | loss: 3.9808090
	speed: 0.0671s/iter; left time: 1383.3343s
Epoch: 1 cost time: 16.03486466407776
Epoch: 1, Steps: 208 | Train Loss: 3.875 Vali Loss: 3.799 Vali Acc: 0.037 Test Loss: 3.799 Test Acc: 0.037
Validation loss decreased (inf --> -0.036944).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8057530
	speed: 0.2195s/iter; left time: 4498.7303s
	iters: 200, epoch: 2 | loss: 3.5841458
	speed: 0.0707s/iter; left time: 1442.5994s
Epoch: 2 cost time: 15.216847658157349
Epoch: 2, Steps: 208 | Train Loss: 3.656 Vali Loss: 3.586 Vali Acc: 0.051 Test Loss: 3.586 Test Acc: 0.051
Validation loss decreased (-0.036944 --> -0.050665).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5101514
	speed: 0.2103s/iter; left time: 4265.7287s
	iters: 200, epoch: 3 | loss: 3.6492348
	speed: 0.0684s/iter; left time: 1381.0700s
Epoch: 3 cost time: 14.430219411849976
Epoch: 3, Steps: 208 | Train Loss: 3.586 Vali Loss: 3.533 Vali Acc: 0.072 Test Loss: 3.533 Test Acc: 0.072
Validation loss decreased (-0.050665 --> -0.072139).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4583149
	speed: 0.2252s/iter; left time: 4521.9913s
	iters: 200, epoch: 4 | loss: 3.6957819
	speed: 0.0698s/iter; left time: 1394.1403s
Epoch: 4 cost time: 15.02362847328186
Epoch: 4, Steps: 208 | Train Loss: 3.433 Vali Loss: 3.438 Vali Acc: 0.082 Test Loss: 3.438 Test Acc: 0.082
Validation loss decreased (-0.072139 --> -0.081982).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.5143826
	speed: 0.2249s/iter; left time: 4468.7019s
	iters: 200, epoch: 5 | loss: 3.0751207
	speed: 0.0718s/iter; left time: 1419.5565s
Epoch: 5 cost time: 15.478758811950684
Epoch: 5, Steps: 208 | Train Loss: 3.266 Vali Loss: 3.297 Vali Acc: 0.098 Test Loss: 3.297 Test Acc: 0.098
Validation loss decreased (-0.081982 --> -0.098386).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.6524298
	speed: 0.2127s/iter; left time: 4181.3170s
	iters: 200, epoch: 6 | loss: 3.3496821
	speed: 0.0692s/iter; left time: 1353.9210s
Epoch: 6 cost time: 14.972631931304932
Epoch: 6, Steps: 208 | Train Loss: 3.178 Vali Loss: 3.264 Vali Acc: 0.100 Test Loss: 3.264 Test Acc: 0.100
Validation loss decreased (-0.098386 --> -0.100176).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.8179898
	speed: 0.1969s/iter; left time: 3830.1236s
	iters: 200, epoch: 7 | loss: 2.9706612
	speed: 0.0594s/iter; left time: 1150.5013s
Epoch: 7 cost time: 13.003298044204712
Epoch: 7, Steps: 208 | Train Loss: 3.072 Vali Loss: 3.263 Vali Acc: 0.100 Test Loss: 3.263 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 3.6371469
	speed: 0.2153s/iter; left time: 4143.6592s
	iters: 200, epoch: 8 | loss: 3.2941222
	speed: 0.0741s/iter; left time: 1419.6010s
Epoch: 8 cost time: 15.712393760681152
Epoch: 8, Steps: 208 | Train Loss: 3.032 Vali Loss: 3.169 Vali Acc: 0.105 Test Loss: 3.169 Test Acc: 0.105
Validation loss decreased (-0.100176 --> -0.105247).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.1235042
	speed: 0.2239s/iter; left time: 4261.7939s
	iters: 200, epoch: 9 | loss: 2.6523581
	speed: 0.0688s/iter; left time: 1303.0370s
Epoch: 9 cost time: 14.771705627441406
Epoch: 9, Steps: 208 | Train Loss: 2.970 Vali Loss: 3.155 Vali Acc: 0.113 Test Loss: 3.155 Test Acc: 0.113
Validation loss decreased (-0.105247 --> -0.112703).  Saving model ...
	iters: 100, epoch: 10 | loss: 3.6574903
	speed: 0.2279s/iter; left time: 4291.7325s
	iters: 200, epoch: 10 | loss: 2.8371880
	speed: 0.0675s/iter; left time: 1264.4539s
Epoch: 10 cost time: 14.844676733016968
Epoch: 10, Steps: 208 | Train Loss: 2.912 Vali Loss: 3.159 Vali Acc: 0.108 Test Loss: 3.159 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.8849142
	speed: 0.2203s/iter; left time: 4101.3630s
	iters: 200, epoch: 11 | loss: 3.1874297
	speed: 0.0689s/iter; left time: 1276.9598s
Epoch: 11 cost time: 15.153604984283447
Epoch: 11, Steps: 208 | Train Loss: 2.821 Vali Loss: 3.290 Vali Acc: 0.099 Test Loss: 3.290 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 3.3825176
	speed: 0.2205s/iter; left time: 4059.8722s
	iters: 200, epoch: 12 | loss: 3.1136954
	speed: 0.0697s/iter; left time: 1276.2048s
Epoch: 12 cost time: 15.069351196289062
Epoch: 12, Steps: 208 | Train Loss: 2.789 Vali Loss: 3.170 Vali Acc: 0.115 Test Loss: 3.170 Test Acc: 0.115
Validation loss decreased (-0.112703 --> -0.115089).  Saving model ...
	iters: 100, epoch: 13 | loss: 3.1831315
	speed: 0.2176s/iter; left time: 3961.9893s
	iters: 200, epoch: 13 | loss: 2.6936047
	speed: 0.0705s/iter; left time: 1276.1826s
Epoch: 13 cost time: 15.201297283172607
Epoch: 13, Steps: 208 | Train Loss: 2.736 Vali Loss: 3.233 Vali Acc: 0.106 Test Loss: 3.233 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 3.1565731
	speed: 0.2193s/iter; left time: 3946.5119s
	iters: 200, epoch: 14 | loss: 2.9149821
	speed: 0.0719s/iter; left time: 1286.4962s
Epoch: 14 cost time: 15.18981671333313
Epoch: 14, Steps: 208 | Train Loss: 2.690 Vali Loss: 3.178 Vali Acc: 0.121 Test Loss: 3.178 Test Acc: 0.121
Validation loss decreased (-0.115089 --> -0.121352).  Saving model ...
	iters: 100, epoch: 15 | loss: 2.6628740
	speed: 0.2066s/iter; left time: 3674.4357s
	iters: 200, epoch: 15 | loss: 2.8671682
	speed: 0.0697s/iter; left time: 1232.3133s
Epoch: 15 cost time: 14.798279523849487
Epoch: 15, Steps: 208 | Train Loss: 2.688 Vali Loss: 3.242 Vali Acc: 0.119 Test Loss: 3.242 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 2.0577693
	speed: 0.2110s/iter; left time: 3710.1183s
	iters: 200, epoch: 16 | loss: 2.5743740
	speed: 0.0709s/iter; left time: 1239.3352s
Epoch: 16 cost time: 15.134471416473389
Epoch: 16, Steps: 208 | Train Loss: 2.573 Vali Loss: 3.227 Vali Acc: 0.124 Test Loss: 3.227 Test Acc: 0.124
Validation loss decreased (-0.121352 --> -0.123737).  Saving model ...
	iters: 100, epoch: 17 | loss: 2.5881245
	speed: 0.2334s/iter; left time: 4055.6308s
	iters: 200, epoch: 17 | loss: 2.8231735
	speed: 0.0711s/iter; left time: 1228.1737s
Epoch: 17 cost time: 15.172783374786377
Epoch: 17, Steps: 208 | Train Loss: 2.668 Vali Loss: 3.266 Vali Acc: 0.112 Test Loss: 3.266 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 2.4815176
	speed: 0.2015s/iter; left time: 3459.0462s
	iters: 200, epoch: 18 | loss: 2.3806176
	speed: 0.0629s/iter; left time: 1073.0675s
Epoch: 18 cost time: 14.0452401638031
Epoch: 18, Steps: 208 | Train Loss: 2.564 Vali Loss: 3.298 Vali Acc: 0.118 Test Loss: 3.298 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 2.2300043
	speed: 0.2329s/iter; left time: 3949.3444s
	iters: 200, epoch: 19 | loss: 3.0807631
	speed: 0.0728s/iter; left time: 1227.3904s
Epoch: 19 cost time: 16.084490537643433
Epoch: 19, Steps: 208 | Train Loss: 2.540 Vali Loss: 3.334 Vali Acc: 0.109 Test Loss: 3.334 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 2.6053603
	speed: 0.2438s/iter; left time: 4083.9606s
	iters: 200, epoch: 20 | loss: 2.6909175
	speed: 0.0758s/iter; left time: 1262.7785s
Epoch: 20 cost time: 15.715870141983032
Epoch: 20, Steps: 208 | Train Loss: 2.625 Vali Loss: 3.291 Vali Acc: 0.105 Test Loss: 3.291 Test Acc: 0.105
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 2.6295507
	speed: 0.2237s/iter; left time: 3700.1916s
	iters: 200, epoch: 21 | loss: 2.3071291
	speed: 0.0684s/iter; left time: 1124.3318s
Epoch: 21 cost time: 15.459207534790039
Epoch: 21, Steps: 208 | Train Loss: 2.620 Vali Loss: 3.390 Vali Acc: 0.121 Test Loss: 3.390 Test Acc: 0.121
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 2.3003232
	speed: 0.2265s/iter; left time: 3700.1323s
	iters: 200, epoch: 22 | loss: 2.2597737
	speed: 0.0726s/iter; left time: 1177.7211s
Epoch: 22 cost time: 15.063930034637451
Epoch: 22, Steps: 208 | Train Loss: 2.591 Vali Loss: 3.320 Vali Acc: 0.119 Test Loss: 3.320 Test Acc: 0.119
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 2.5984533
	speed: 0.2144s/iter; left time: 3456.9532s
	iters: 200, epoch: 23 | loss: 3.2391951
	speed: 0.0705s/iter; left time: 1129.6949s
Epoch: 23 cost time: 14.997284889221191
Epoch: 23, Steps: 208 | Train Loss: 2.624 Vali Loss: 3.344 Vali Acc: 0.116 Test Loss: 3.344 Test Acc: 0.116
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 3.4350867
	speed: 0.2149s/iter; left time: 3421.0440s
	iters: 200, epoch: 24 | loss: 3.4518397
	speed: 0.0709s/iter; left time: 1122.1869s
Epoch: 24 cost time: 15.397513389587402
Epoch: 24, Steps: 208 | Train Loss: 2.667 Vali Loss: 3.471 Vali Acc: 0.098 Test Loss: 3.471 Test Acc: 0.098
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 2.4665501
	speed: 0.2327s/iter; left time: 3656.0677s
	iters: 200, epoch: 25 | loss: 2.8928759
	speed: 0.0706s/iter; left time: 1101.9933s
Epoch: 25 cost time: 15.492804765701294
Epoch: 25, Steps: 208 | Train Loss: 2.755 Vali Loss: 3.384 Vali Acc: 0.102 Test Loss: 3.384 Test Acc: 0.102
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 2.9245656
	speed: 0.2264s/iter; left time: 3509.9121s
	iters: 200, epoch: 26 | loss: 2.5628066
	speed: 0.0707s/iter; left time: 1088.7502s
Epoch: 26 cost time: 15.282123327255249
Epoch: 26, Steps: 208 | Train Loss: 2.887 Vali Loss: 3.285 Vali Acc: 0.109 Test Loss: 3.285 Test Acc: 0.109
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12376975842529078
model parameter : 3095895
model size : 14.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1954489
	speed: 0.0996s/iter; left time: 2062.1928s
	iters: 200, epoch: 1 | loss: 3.4986918
	speed: 0.0772s/iter; left time: 1589.7210s
Epoch: 1 cost time: 18.362869262695312
Epoch: 1, Steps: 208 | Train Loss: 3.917 Vali Loss: 3.787 Vali Acc: 0.048 Test Loss: 3.787 Test Acc: 0.048
Validation loss decreased (inf --> -0.047979).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5933490
	speed: 0.2382s/iter; left time: 4881.9364s
	iters: 200, epoch: 2 | loss: 3.3896716
	speed: 0.0752s/iter; left time: 1533.6169s
Epoch: 2 cost time: 16.06719160079956
Epoch: 2, Steps: 208 | Train Loss: 3.662 Vali Loss: 3.612 Vali Acc: 0.045 Test Loss: 3.612 Test Acc: 0.045
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.5569797
	speed: 0.2243s/iter; left time: 4550.3295s
	iters: 200, epoch: 3 | loss: 3.6913702
	speed: 0.0742s/iter; left time: 1497.0576s
Epoch: 3 cost time: 15.327646732330322
Epoch: 3, Steps: 208 | Train Loss: 3.567 Vali Loss: 3.612 Vali Acc: 0.061 Test Loss: 3.612 Test Acc: 0.061
Validation loss decreased (-0.047979 --> -0.060507).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2901115
	speed: 0.2306s/iter; left time: 4629.8384s
	iters: 200, epoch: 4 | loss: 3.3618646
	speed: 0.0783s/iter; left time: 1564.2507s
Epoch: 4 cost time: 16.66265344619751
Epoch: 4, Steps: 208 | Train Loss: 3.443 Vali Loss: 3.378 Vali Acc: 0.075 Test Loss: 3.378 Test Acc: 0.075
Validation loss decreased (-0.060507 --> -0.074825).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2247941
	speed: 0.2246s/iter; left time: 4462.1952s
	iters: 200, epoch: 5 | loss: 3.4710481
	speed: 0.0731s/iter; left time: 1444.2113s
Epoch: 5 cost time: 15.83212423324585
Epoch: 5, Steps: 208 | Train Loss: 3.297 Vali Loss: 3.263 Vali Acc: 0.090 Test Loss: 3.263 Test Acc: 0.090
Validation loss decreased (-0.074825 --> -0.090036).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.9082141
	speed: 0.2189s/iter; left time: 4304.2914s
	iters: 200, epoch: 6 | loss: 3.3035569
	speed: 0.0730s/iter; left time: 1428.3082s
Epoch: 6 cost time: 15.329874038696289
Epoch: 6, Steps: 208 | Train Loss: 3.171 Vali Loss: 3.326 Vali Acc: 0.085 Test Loss: 3.326 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.6359117
	speed: 0.2058s/iter; left time: 4004.1208s
	iters: 200, epoch: 7 | loss: 2.9577477
	speed: 0.0763s/iter; left time: 1477.2898s
Epoch: 7 cost time: 16.358316659927368
Epoch: 7, Steps: 208 | Train Loss: 3.090 Vali Loss: 3.182 Vali Acc: 0.103 Test Loss: 3.182 Test Acc: 0.103
Validation loss decreased (-0.090036 --> -0.102861).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.8408878
	speed: 0.2292s/iter; left time: 4410.7791s
	iters: 200, epoch: 8 | loss: 2.9865143
	speed: 0.0731s/iter; left time: 1399.6360s
Epoch: 8 cost time: 15.136573314666748
Epoch: 8, Steps: 208 | Train Loss: 2.987 Vali Loss: 3.162 Vali Acc: 0.106 Test Loss: 3.162 Test Acc: 0.106
Validation loss decreased (-0.102861 --> -0.105844).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.7780535
	speed: 0.2212s/iter; left time: 4210.6343s
	iters: 200, epoch: 9 | loss: 3.0365210
	speed: 0.0724s/iter; left time: 1371.0744s
Epoch: 9 cost time: 15.816549301147461
Epoch: 9, Steps: 208 | Train Loss: 2.883 Vali Loss: 3.230 Vali Acc: 0.114 Test Loss: 3.230 Test Acc: 0.114
Validation loss decreased (-0.105844 --> -0.114194).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.7592709
	speed: 0.2317s/iter; left time: 4361.8786s
	iters: 200, epoch: 10 | loss: 2.7533705
	speed: 0.0757s/iter; left time: 1417.2452s
Epoch: 10 cost time: 16.17489743232727
Epoch: 10, Steps: 208 | Train Loss: 2.778 Vali Loss: 3.201 Vali Acc: 0.120 Test Loss: 3.201 Test Acc: 0.120
Validation loss decreased (-0.114194 --> -0.119562).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.5772748
	speed: 0.2432s/iter; left time: 4529.0109s
	iters: 200, epoch: 11 | loss: 2.6933982
	speed: 0.0744s/iter; left time: 1377.9364s
Epoch: 11 cost time: 16.093278169631958
Epoch: 11, Steps: 208 | Train Loss: 2.706 Vali Loss: 3.183 Vali Acc: 0.117 Test Loss: 3.183 Test Acc: 0.117
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.7989454
	speed: 0.2467s/iter; left time: 4543.1576s
	iters: 200, epoch: 12 | loss: 2.3841851
	speed: 0.0783s/iter; left time: 1434.8012s
Epoch: 12 cost time: 16.632315635681152
Epoch: 12, Steps: 208 | Train Loss: 2.684 Vali Loss: 3.213 Vali Acc: 0.120 Test Loss: 3.213 Test Acc: 0.120
Validation loss decreased (-0.119562 --> -0.120457).  Saving model ...
	iters: 100, epoch: 13 | loss: 3.0228250
	speed: 0.2122s/iter; left time: 3862.2223s
	iters: 200, epoch: 13 | loss: 2.7646782
	speed: 0.0738s/iter; left time: 1335.8535s
Epoch: 13 cost time: 15.92562747001648
Epoch: 13, Steps: 208 | Train Loss: 2.571 Vali Loss: 3.218 Vali Acc: 0.123 Test Loss: 3.218 Test Acc: 0.123
Validation loss decreased (-0.120457 --> -0.123439).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.3235648
	speed: 0.2197s/iter; left time: 3953.4929s
	iters: 200, epoch: 14 | loss: 2.8635890
	speed: 0.0730s/iter; left time: 1307.0994s
Epoch: 14 cost time: 15.621209859848022
Epoch: 14, Steps: 208 | Train Loss: 2.524 Vali Loss: 3.270 Vali Acc: 0.115 Test Loss: 3.270 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.8565469
	speed: 0.2172s/iter; left time: 3862.9739s
	iters: 200, epoch: 15 | loss: 2.5045319
	speed: 0.0706s/iter; left time: 1248.5408s
Epoch: 15 cost time: 15.976513147354126
Epoch: 15, Steps: 208 | Train Loss: 2.529 Vali Loss: 3.331 Vali Acc: 0.112 Test Loss: 3.331 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 2.4716041
	speed: 0.2174s/iter; left time: 3822.8446s
	iters: 200, epoch: 16 | loss: 2.8432741
	speed: 0.0742s/iter; left time: 1296.8863s
Epoch: 16 cost time: 16.219019174575806
Epoch: 16, Steps: 208 | Train Loss: 2.460 Vali Loss: 3.357 Vali Acc: 0.122 Test Loss: 3.357 Test Acc: 0.122
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 2.1233609
	speed: 0.2221s/iter; left time: 3858.0664s
	iters: 200, epoch: 17 | loss: 2.3237441
	speed: 0.0730s/iter; left time: 1261.3264s
Epoch: 17 cost time: 15.551403999328613
Epoch: 17, Steps: 208 | Train Loss: 2.444 Vali Loss: 3.318 Vali Acc: 0.112 Test Loss: 3.318 Test Acc: 0.112
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 2.2308729
	speed: 0.2265s/iter; left time: 3887.0489s
	iters: 200, epoch: 18 | loss: 2.5845928
	speed: 0.0653s/iter; left time: 1114.6086s
Epoch: 18 cost time: 15.112168312072754
Epoch: 18, Steps: 208 | Train Loss: 2.411 Vali Loss: 3.382 Vali Acc: 0.113 Test Loss: 3.382 Test Acc: 0.113
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 2.4597826
	speed: 0.2380s/iter; left time: 4035.7166s
	iters: 200, epoch: 19 | loss: 2.7060108
	speed: 0.0743s/iter; left time: 1252.1281s
Epoch: 19 cost time: 16.421773672103882
Epoch: 19, Steps: 208 | Train Loss: 2.372 Vali Loss: 3.437 Vali Acc: 0.117 Test Loss: 3.437 Test Acc: 0.117
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 2.2694054
	speed: 0.2325s/iter; left time: 3894.5219s
	iters: 200, epoch: 20 | loss: 2.5722792
	speed: 0.0696s/iter; left time: 1158.6487s
Epoch: 20 cost time: 15.011428356170654
Epoch: 20, Steps: 208 | Train Loss: 2.404 Vali Loss: 3.406 Vali Acc: 0.112 Test Loss: 3.406 Test Acc: 0.112
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 3.2364743
	speed: 0.2223s/iter; left time: 3676.7182s
	iters: 200, epoch: 21 | loss: 2.3609858
	speed: 0.0725s/iter; left time: 1192.4572s
Epoch: 21 cost time: 16.4586021900177
Epoch: 21, Steps: 208 | Train Loss: 2.437 Vali Loss: 3.418 Vali Acc: 0.113 Test Loss: 3.418 Test Acc: 0.113
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 2.1175528
	speed: 0.2361s/iter; left time: 3855.8883s
	iters: 200, epoch: 22 | loss: 2.6397908
	speed: 0.0747s/iter; left time: 1212.7654s
Epoch: 22 cost time: 16.050317525863647
Epoch: 22, Steps: 208 | Train Loss: 2.453 Vali Loss: 3.419 Vali Acc: 0.097 Test Loss: 3.419 Test Acc: 0.097
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 2.4292731
	speed: 0.2097s/iter; left time: 3381.1036s
	iters: 200, epoch: 23 | loss: 2.4896364
	speed: 0.0712s/iter; left time: 1141.3476s
Epoch: 23 cost time: 15.27239465713501
Epoch: 23, Steps: 208 | Train Loss: 2.401 Vali Loss: 3.490 Vali Acc: 0.113 Test Loss: 3.490 Test Acc: 0.113
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1234715180435431
model parameter : 2648407
model size : 12.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8334100
	speed: 0.0867s/iter; left time: 1794.3980s
	iters: 200, epoch: 1 | loss: 4.3021936
	speed: 0.0727s/iter; left time: 1497.0719s
Epoch: 1 cost time: 16.556612730026245
Epoch: 1, Steps: 208 | Train Loss: 3.893 Vali Loss: 3.717 Vali Acc: 0.052 Test Loss: 3.717 Test Acc: 0.052
Validation loss decreased (inf --> -0.051857).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9800279
	speed: 0.2332s/iter; left time: 4778.1367s
	iters: 200, epoch: 2 | loss: 3.9872472
	speed: 0.0681s/iter; left time: 1388.9948s
Epoch: 2 cost time: 15.131449937820435
Epoch: 2, Steps: 208 | Train Loss: 3.696 Vali Loss: 3.669 Vali Acc: 0.058 Test Loss: 3.669 Test Acc: 0.058
Validation loss decreased (-0.051857 --> -0.058120).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7570949
	speed: 0.2210s/iter; left time: 4482.4912s
	iters: 200, epoch: 3 | loss: 3.7650573
	speed: 0.0705s/iter; left time: 1423.0320s
Epoch: 3 cost time: 15.488346815109253
Epoch: 3, Steps: 208 | Train Loss: 3.617 Vali Loss: 3.708 Vali Acc: 0.053 Test Loss: 3.708 Test Acc: 0.053
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.6344972
	speed: 0.2370s/iter; left time: 4758.0596s
	iters: 200, epoch: 4 | loss: 3.2867916
	speed: 0.0687s/iter; left time: 1371.9483s
Epoch: 4 cost time: 15.078765869140625
Epoch: 4, Steps: 208 | Train Loss: 3.507 Vali Loss: 3.466 Vali Acc: 0.072 Test Loss: 3.466 Test Acc: 0.072
Validation loss decreased (-0.058120 --> -0.072438).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.8498120
	speed: 0.2270s/iter; left time: 4509.4333s
	iters: 200, epoch: 5 | loss: 3.0063443
	speed: 0.0688s/iter; left time: 1361.0721s
Epoch: 5 cost time: 14.945832014083862
Epoch: 5, Steps: 208 | Train Loss: 3.303 Vali Loss: 3.381 Vali Acc: 0.079 Test Loss: 3.381 Test Acc: 0.079
Validation loss decreased (-0.072438 --> -0.079000).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2081947
	speed: 0.2198s/iter; left time: 4320.5601s
	iters: 200, epoch: 6 | loss: 3.2553046
	speed: 0.0674s/iter; left time: 1318.1814s
Epoch: 6 cost time: 13.900931119918823
Epoch: 6, Steps: 208 | Train Loss: 3.191 Vali Loss: 3.245 Vali Acc: 0.097 Test Loss: 3.245 Test Acc: 0.097
Validation loss decreased (-0.079000 --> -0.096896).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.2194185
	speed: 0.2193s/iter; left time: 4265.3660s
	iters: 200, epoch: 7 | loss: 2.9786735
	speed: 0.0702s/iter; left time: 1359.0201s
Epoch: 7 cost time: 15.07224726676941
Epoch: 7, Steps: 208 | Train Loss: 3.082 Vali Loss: 3.145 Vali Acc: 0.106 Test Loss: 3.145 Test Acc: 0.106
Validation loss decreased (-0.096896 --> -0.105844).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.2388234
	speed: 0.2311s/iter; left time: 4447.3510s
	iters: 200, epoch: 8 | loss: 2.8638597
	speed: 0.0731s/iter; left time: 1399.0573s
Epoch: 8 cost time: 15.314972162246704
Epoch: 8, Steps: 208 | Train Loss: 2.966 Vali Loss: 3.142 Vali Acc: 0.109 Test Loss: 3.142 Test Acc: 0.109
Validation loss decreased (-0.105844 --> -0.109125).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.3000271
	speed: 0.2083s/iter; left time: 3966.1738s
	iters: 200, epoch: 9 | loss: 2.7482328
	speed: 0.0696s/iter; left time: 1318.7301s
Epoch: 9 cost time: 15.534231185913086
Epoch: 9, Steps: 208 | Train Loss: 2.856 Vali Loss: 3.103 Vali Acc: 0.123 Test Loss: 3.103 Test Acc: 0.123
Validation loss decreased (-0.109125 --> -0.123142).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.6412964
	speed: 0.2372s/iter; left time: 4465.4585s
	iters: 200, epoch: 10 | loss: 3.1935313
	speed: 0.0738s/iter; left time: 1382.2799s
Epoch: 10 cost time: 15.960163116455078
Epoch: 10, Steps: 208 | Train Loss: 2.801 Vali Loss: 3.070 Vali Acc: 0.123 Test Loss: 3.070 Test Acc: 0.123
Validation loss decreased (-0.123142 --> -0.123143).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.8141389
	speed: 0.2352s/iter; left time: 4379.6509s
	iters: 200, epoch: 11 | loss: 2.8948698
	speed: 0.0757s/iter; left time: 1402.1950s
Epoch: 11 cost time: 16.01439666748047
Epoch: 11, Steps: 208 | Train Loss: 2.723 Vali Loss: 3.062 Vali Acc: 0.124 Test Loss: 3.062 Test Acc: 0.124
Validation loss decreased (-0.123143 --> -0.124336).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.4827740
	speed: 0.2219s/iter; left time: 4085.7813s
	iters: 200, epoch: 12 | loss: 2.8948045
	speed: 0.0701s/iter; left time: 1283.0624s
Epoch: 12 cost time: 15.057555675506592
Epoch: 12, Steps: 208 | Train Loss: 2.666 Vali Loss: 3.146 Vali Acc: 0.121 Test Loss: 3.146 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.5357885
	speed: 0.2365s/iter; left time: 4306.3043s
	iters: 200, epoch: 13 | loss: 2.4695544
	speed: 0.0737s/iter; left time: 1333.6690s
Epoch: 13 cost time: 15.862567663192749
Epoch: 13, Steps: 208 | Train Loss: 2.609 Vali Loss: 3.186 Vali Acc: 0.110 Test Loss: 3.186 Test Acc: 0.110
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 2.8047421
	speed: 0.2206s/iter; left time: 3970.7779s
	iters: 200, epoch: 14 | loss: 2.6437120
	speed: 0.0716s/iter; left time: 1282.2326s
Epoch: 14 cost time: 15.499409914016724
Epoch: 14, Steps: 208 | Train Loss: 2.599 Vali Loss: 3.149 Vali Acc: 0.121 Test Loss: 3.149 Test Acc: 0.121
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 2.3674779
	speed: 0.2134s/iter; left time: 3796.1726s
	iters: 200, epoch: 15 | loss: 2.1950011
	speed: 0.0691s/iter; left time: 1222.3630s
Epoch: 15 cost time: 15.224040508270264
Epoch: 15, Steps: 208 | Train Loss: 2.550 Vali Loss: 3.260 Vali Acc: 0.120 Test Loss: 3.260 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 2.7718287
	speed: 0.2298s/iter; left time: 4040.3435s
	iters: 200, epoch: 16 | loss: 3.1246364
	speed: 0.0735s/iter; left time: 1284.2932s
Epoch: 16 cost time: 15.840431213378906
Epoch: 16, Steps: 208 | Train Loss: 2.570 Vali Loss: 3.159 Vali Acc: 0.125 Test Loss: 3.159 Test Acc: 0.125
Validation loss decreased (-0.124336 --> -0.124633).  Saving model ...
	iters: 100, epoch: 17 | loss: 2.5206184
	speed: 0.2248s/iter; left time: 3905.0142s
	iters: 200, epoch: 17 | loss: 2.9825487
	speed: 0.0752s/iter; left time: 1299.2391s
Epoch: 17 cost time: 15.8549485206604
Epoch: 17, Steps: 208 | Train Loss: 2.560 Vali Loss: 3.247 Vali Acc: 0.109 Test Loss: 3.247 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.9713620
	speed: 0.2231s/iter; left time: 3829.7965s
	iters: 200, epoch: 18 | loss: 2.9118044
	speed: 0.0664s/iter; left time: 1133.3382s
Epoch: 18 cost time: 15.001953363418579
Epoch: 18, Steps: 208 | Train Loss: 2.543 Vali Loss: 3.249 Vali Acc: 0.110 Test Loss: 3.249 Test Acc: 0.110
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 2.3630152
	speed: 0.2325s/iter; left time: 3942.4923s
	iters: 200, epoch: 19 | loss: 2.7497952
	speed: 0.0729s/iter; left time: 1228.9826s
Epoch: 19 cost time: 15.28502082824707
Epoch: 19, Steps: 208 | Train Loss: 2.527 Vali Loss: 3.179 Vali Acc: 0.119 Test Loss: 3.179 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 2.6493106
	speed: 0.2153s/iter; left time: 3605.5545s
	iters: 200, epoch: 20 | loss: 2.6271949
	speed: 0.0684s/iter; left time: 1138.1943s
Epoch: 20 cost time: 14.84698748588562
Epoch: 20, Steps: 208 | Train Loss: 2.517 Vali Loss: 3.268 Vali Acc: 0.115 Test Loss: 3.268 Test Acc: 0.115
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 2.1072471
	speed: 0.2325s/iter; left time: 3845.6264s
	iters: 200, epoch: 21 | loss: 2.9366071
	speed: 0.0709s/iter; left time: 1164.9501s
Epoch: 21 cost time: 15.36487364768982
Epoch: 21, Steps: 208 | Train Loss: 2.643 Vali Loss: 3.231 Vali Acc: 0.098 Test Loss: 3.231 Test Acc: 0.098
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 2.5749998
	speed: 0.2222s/iter; left time: 3628.6803s
	iters: 200, epoch: 22 | loss: 2.3444121
	speed: 0.0717s/iter; left time: 1163.7859s
Epoch: 22 cost time: 15.14404582977295
Epoch: 22, Steps: 208 | Train Loss: 2.669 Vali Loss: 3.363 Vali Acc: 0.107 Test Loss: 3.363 Test Acc: 0.107
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 2.4581449
	speed: 0.2134s/iter; left time: 3440.2706s
	iters: 200, epoch: 23 | loss: 2.6233325
	speed: 0.0680s/iter; left time: 1090.4625s
Epoch: 23 cost time: 14.971299409866333
Epoch: 23, Steps: 208 | Train Loss: 2.700 Vali Loss: 3.245 Vali Acc: 0.110 Test Loss: 3.245 Test Acc: 0.110
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 2.9240663
	speed: 0.2113s/iter; left time: 3363.4875s
	iters: 200, epoch: 24 | loss: 3.1615462
	speed: 0.0656s/iter; left time: 1038.0791s
Epoch: 24 cost time: 14.714903116226196
Epoch: 24, Steps: 208 | Train Loss: 2.712 Vali Loss: 3.228 Vali Acc: 0.115 Test Loss: 3.228 Test Acc: 0.115
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 2.6968026
	speed: 0.2222s/iter; left time: 3490.2158s
	iters: 200, epoch: 25 | loss: 2.6518347
	speed: 0.0731s/iter; left time: 1141.2539s
Epoch: 25 cost time: 15.383502006530762
Epoch: 25, Steps: 208 | Train Loss: 2.721 Vali Loss: 3.302 Vali Acc: 0.108 Test Loss: 3.302 Test Acc: 0.108
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 2.7355113
	speed: 0.2068s/iter; left time: 3205.0512s
	iters: 200, epoch: 26 | loss: 2.5406904
	speed: 0.0681s/iter; left time: 1048.2600s
Epoch: 26 cost time: 15.18376612663269
Epoch: 26, Steps: 208 | Train Loss: 2.693 Vali Loss: 3.273 Vali Acc: 0.106 Test Loss: 3.273 Test Acc: 0.106
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12466447957053385
model parameter : 2644055
model size : 12.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.4340329
	speed: 0.1227s/iter; left time: 2540.8985s
	iters: 200, epoch: 1 | loss: 3.8385406
	speed: 0.1058s/iter; left time: 2179.9490s
Epoch: 1 cost time: 23.810497999191284
Epoch: 1, Steps: 208 | Train Loss: 3.916 Vali Loss: 3.861 Vali Acc: 0.053 Test Loss: 3.861 Test Acc: 0.053
Validation loss decreased (inf --> -0.053048).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3634453
	speed: 0.2521s/iter; left time: 5166.7414s
	iters: 200, epoch: 2 | loss: 3.7687032
	speed: 0.0731s/iter; left time: 1490.5494s
Epoch: 2 cost time: 17.469581365585327
Epoch: 2, Steps: 208 | Train Loss: 3.665 Vali Loss: 3.625 Vali Acc: 0.054 Test Loss: 3.625 Test Acc: 0.054
Validation loss decreased (-0.053048 --> -0.053647).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7763939
	speed: 0.2723s/iter; left time: 5523.3889s
	iters: 200, epoch: 3 | loss: 3.6215591
	speed: 0.1005s/iter; left time: 2028.1059s
Epoch: 3 cost time: 22.026142835617065
Epoch: 3, Steps: 208 | Train Loss: 3.582 Vali Loss: 3.639 Vali Acc: 0.050 Test Loss: 3.639 Test Acc: 0.050
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.3944099
	speed: 0.2436s/iter; left time: 4890.1346s
	iters: 200, epoch: 4 | loss: 3.5157793
	speed: 0.0895s/iter; left time: 1788.8755s
Epoch: 4 cost time: 18.414580583572388
Epoch: 4, Steps: 208 | Train Loss: 3.446 Vali Loss: 3.421 Vali Acc: 0.072 Test Loss: 3.421 Test Acc: 0.072
Validation loss decreased (-0.053647 --> -0.072438).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.6879938
	speed: 0.2555s/iter; left time: 5077.2593s
	iters: 200, epoch: 5 | loss: 2.8021390
	speed: 0.1001s/iter; left time: 1977.8910s
Epoch: 5 cost time: 21.429230451583862
Epoch: 5, Steps: 208 | Train Loss: 3.290 Vali Loss: 3.278 Vali Acc: 0.100 Test Loss: 3.278 Test Acc: 0.100
Validation loss decreased (-0.072438 --> -0.100176).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0731351
	speed: 0.2521s/iter; left time: 4956.9366s
	iters: 200, epoch: 6 | loss: 3.1130865
	speed: 0.0838s/iter; left time: 1638.8439s
Epoch: 6 cost time: 18.252322673797607
Epoch: 6, Steps: 208 | Train Loss: 3.135 Vali Loss: 3.309 Vali Acc: 0.086 Test Loss: 3.309 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.2291703
	speed: 0.2726s/iter; left time: 5302.1445s
	iters: 200, epoch: 7 | loss: 2.9137292
	speed: 0.1061s/iter; left time: 2052.6208s
Epoch: 7 cost time: 22.189428567886353
Epoch: 7, Steps: 208 | Train Loss: 3.076 Vali Loss: 3.194 Vali Acc: 0.104 Test Loss: 3.194 Test Acc: 0.104
Validation loss decreased (-0.100176 --> -0.104352).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.6717668
	speed: 0.2395s/iter; left time: 4609.4647s
	iters: 200, epoch: 8 | loss: 2.6660395
	speed: 0.0949s/iter; left time: 1816.9769s
Epoch: 8 cost time: 18.849413633346558
Epoch: 8, Steps: 208 | Train Loss: 2.950 Vali Loss: 3.175 Vali Acc: 0.113 Test Loss: 3.175 Test Acc: 0.113
Validation loss decreased (-0.104352 --> -0.113001).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.5911772
	speed: 0.2577s/iter; left time: 4906.1582s
	iters: 200, epoch: 9 | loss: 2.9779289
	speed: 0.0904s/iter; left time: 1711.2184s
Epoch: 9 cost time: 19.964725971221924
Epoch: 9, Steps: 208 | Train Loss: 2.824 Vali Loss: 3.092 Vali Acc: 0.127 Test Loss: 3.092 Test Acc: 0.127
Validation loss decreased (-0.113001 --> -0.126721).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.4805646
	speed: 0.2566s/iter; left time: 4831.6098s
	iters: 200, epoch: 10 | loss: 3.2848675
	speed: 0.1125s/iter; left time: 2107.9173s
Epoch: 10 cost time: 21.72815990447998
Epoch: 10, Steps: 208 | Train Loss: 2.773 Vali Loss: 3.086 Vali Acc: 0.138 Test Loss: 3.086 Test Acc: 0.138
Validation loss decreased (-0.126721 --> -0.138353).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.5887985
	speed: 0.2758s/iter; left time: 5136.1244s
	iters: 200, epoch: 11 | loss: 2.7843924
	speed: 0.0765s/iter; left time: 1417.7251s
Epoch: 11 cost time: 19.03249979019165
Epoch: 11, Steps: 208 | Train Loss: 2.681 Vali Loss: 3.102 Vali Acc: 0.129 Test Loss: 3.102 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.5004487
	speed: 0.2641s/iter; left time: 4863.6532s
	iters: 200, epoch: 12 | loss: 2.7590122
	speed: 0.1004s/iter; left time: 1837.8119s
Epoch: 12 cost time: 20.825908660888672
Epoch: 12, Steps: 208 | Train Loss: 2.591 Vali Loss: 3.098 Vali Acc: 0.135 Test Loss: 3.098 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 2.6746831
	speed: 0.2630s/iter; left time: 4787.7712s
	iters: 200, epoch: 13 | loss: 2.4882255
	speed: 0.0752s/iter; left time: 1361.2589s
Epoch: 13 cost time: 17.6974458694458
Epoch: 13, Steps: 208 | Train Loss: 2.446 Vali Loss: 3.238 Vali Acc: 0.126 Test Loss: 3.238 Test Acc: 0.126
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 2.3327429
	speed: 0.2865s/iter; left time: 5155.5177s
	iters: 200, epoch: 14 | loss: 2.4840231
	speed: 0.1157s/iter; left time: 2071.0135s
Epoch: 14 cost time: 25.179226875305176
Epoch: 14, Steps: 208 | Train Loss: 2.409 Vali Loss: 3.205 Vali Acc: 0.138 Test Loss: 3.205 Test Acc: 0.138
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 2.3742821
	speed: 0.2202s/iter; left time: 3917.2460s
	iters: 200, epoch: 15 | loss: 3.0705261
	speed: 0.0731s/iter; left time: 1293.4794s
Epoch: 15 cost time: 15.18620777130127
Epoch: 15, Steps: 208 | Train Loss: 2.362 Vali Loss: 3.199 Vali Acc: 0.127 Test Loss: 3.199 Test Acc: 0.127
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 2.0680065
	speed: 0.2582s/iter; left time: 4539.0314s
	iters: 200, epoch: 16 | loss: 2.8390517
	speed: 0.1007s/iter; left time: 1759.6415s
Epoch: 16 cost time: 21.79686689376831
Epoch: 16, Steps: 208 | Train Loss: 2.352 Vali Loss: 3.201 Vali Acc: 0.118 Test Loss: 3.201 Test Acc: 0.118
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 2.4419394
	speed: 0.2403s/iter; left time: 4174.4529s
	iters: 200, epoch: 17 | loss: 2.0949588
	speed: 0.0814s/iter; left time: 1405.6920s
Epoch: 17 cost time: 17.27479887008667
Epoch: 17, Steps: 208 | Train Loss: 2.374 Vali Loss: 3.210 Vali Acc: 0.136 Test Loss: 3.210 Test Acc: 0.136
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.8159288
	speed: 0.2510s/iter; left time: 4308.5071s
	iters: 200, epoch: 18 | loss: 2.2048683
	speed: 0.0977s/iter; left time: 1666.7086s
Epoch: 18 cost time: 20.84015917778015
Epoch: 18, Steps: 208 | Train Loss: 2.430 Vali Loss: 3.314 Vali Acc: 0.128 Test Loss: 3.314 Test Acc: 0.128
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 2.6932213
	speed: 0.2338s/iter; left time: 3963.7608s
	iters: 200, epoch: 19 | loss: 2.2632859
	speed: 0.0941s/iter; left time: 1586.4304s
Epoch: 19 cost time: 18.92586088180542
Epoch: 19, Steps: 208 | Train Loss: 2.362 Vali Loss: 3.346 Vali Acc: 0.125 Test Loss: 3.346 Test Acc: 0.125
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 2.6731977
	speed: 0.2531s/iter; left time: 4238.8723s
	iters: 200, epoch: 20 | loss: 2.4348695
	speed: 0.0980s/iter; left time: 1632.2069s
Epoch: 20 cost time: 20.68074941635132
Epoch: 20, Steps: 208 | Train Loss: 2.449 Vali Loss: 3.255 Vali Acc: 0.126 Test Loss: 3.255 Test Acc: 0.126
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13838353713092752
model parameter : 2639703
model size : 12.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8271279
	speed: 0.0770s/iter; left time: 1593.2377s
	iters: 200, epoch: 1 | loss: 3.4845936
	speed: 0.0587s/iter; left time: 1209.4104s
Epoch: 1 cost time: 14.116827487945557
Epoch: 1, Steps: 208 | Train Loss: 3.921 Vali Loss: 3.870 Vali Acc: 0.053 Test Loss: 3.870 Test Acc: 0.053
Validation loss decreased (inf --> -0.053346).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.0509982
	speed: 0.2237s/iter; left time: 4583.9963s
	iters: 200, epoch: 2 | loss: 3.6915658
	speed: 0.0985s/iter; left time: 2009.1497s
Epoch: 2 cost time: 20.504669189453125
Epoch: 2, Steps: 208 | Train Loss: 3.657 Vali Loss: 3.613 Vali Acc: 0.045 Test Loss: 3.613 Test Acc: 0.045
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.5771582
	speed: 0.2442s/iter; left time: 4953.8799s
	iters: 200, epoch: 3 | loss: 3.6987705
	speed: 0.0739s/iter; left time: 1491.5794s
Epoch: 3 cost time: 16.63982605934143
Epoch: 3, Steps: 208 | Train Loss: 3.566 Vali Loss: 3.602 Vali Acc: 0.050 Test Loss: 3.602 Test Acc: 0.050
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 3.2248702
	speed: 0.2646s/iter; left time: 5313.1649s
	iters: 200, epoch: 4 | loss: 3.5850043
	speed: 0.0989s/iter; left time: 1975.6153s
Epoch: 4 cost time: 21.317444801330566
Epoch: 4, Steps: 208 | Train Loss: 3.417 Vali Loss: 3.371 Vali Acc: 0.086 Test Loss: 3.371 Test Acc: 0.086
Validation loss decreased (-0.053346 --> -0.085561).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.7779953
	speed: 0.2300s/iter; left time: 4568.9307s
	iters: 200, epoch: 5 | loss: 3.6562569
	speed: 0.0791s/iter; left time: 1564.2905s
Epoch: 5 cost time: 17.26942753791809
Epoch: 5, Steps: 208 | Train Loss: 3.248 Vali Loss: 3.279 Vali Acc: 0.084 Test Loss: 3.279 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.9589326
	speed: 0.2575s/iter; left time: 5063.4050s
	iters: 200, epoch: 6 | loss: 2.9674900
	speed: 0.0993s/iter; left time: 1941.9793s
Epoch: 6 cost time: 21.078124046325684
Epoch: 6, Steps: 208 | Train Loss: 3.132 Vali Loss: 3.299 Vali Acc: 0.093 Test Loss: 3.299 Test Acc: 0.093
Validation loss decreased (-0.085561 --> -0.093316).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9174438
	speed: 0.2467s/iter; left time: 4798.9868s
	iters: 200, epoch: 7 | loss: 3.0909555
	speed: 0.0865s/iter; left time: 1674.2170s
Epoch: 7 cost time: 18.47302746772766
Epoch: 7, Steps: 208 | Train Loss: 3.062 Vali Loss: 3.215 Vali Acc: 0.095 Test Loss: 3.215 Test Acc: 0.095
Validation loss decreased (-0.093316 --> -0.094510).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.0155334
	speed: 0.2528s/iter; left time: 4864.9693s
	iters: 200, epoch: 8 | loss: 3.9475899
	speed: 0.1005s/iter; left time: 1923.3405s
Epoch: 8 cost time: 21.171109199523926
Epoch: 8, Steps: 208 | Train Loss: 2.940 Vali Loss: 3.152 Vali Acc: 0.116 Test Loss: 3.152 Test Acc: 0.116
Validation loss decreased (-0.094510 --> -0.115686).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.8300774
	speed: 0.2364s/iter; left time: 4500.8243s
	iters: 200, epoch: 9 | loss: 2.9295111
	speed: 0.0875s/iter; left time: 1657.7032s
Epoch: 9 cost time: 17.692039012908936
Epoch: 9, Steps: 208 | Train Loss: 2.857 Vali Loss: 3.207 Vali Acc: 0.123 Test Loss: 3.207 Test Acc: 0.123
Validation loss decreased (-0.115686 --> -0.122843).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.8688295
	speed: 0.2483s/iter; left time: 4674.7225s
	iters: 200, epoch: 10 | loss: 2.7880440
	speed: 0.0918s/iter; left time: 1718.7735s
Epoch: 10 cost time: 19.832390546798706
Epoch: 10, Steps: 208 | Train Loss: 2.768 Vali Loss: 3.191 Vali Acc: 0.114 Test Loss: 3.191 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.1516995
	speed: 0.2440s/iter; left time: 4544.3003s
	iters: 200, epoch: 11 | loss: 2.6430717
	speed: 0.1044s/iter; left time: 1933.0044s
Epoch: 11 cost time: 20.07883048057556
Epoch: 11, Steps: 208 | Train Loss: 2.659 Vali Loss: 3.164 Vali Acc: 0.124 Test Loss: 3.164 Test Acc: 0.124
Validation loss decreased (-0.122843 --> -0.124335).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.7446661
	speed: 0.2696s/iter; left time: 4963.4083s
	iters: 200, epoch: 12 | loss: 2.5791214
	speed: 0.0787s/iter; left time: 1440.7996s
Epoch: 12 cost time: 19.012582540512085
Epoch: 12, Steps: 208 | Train Loss: 2.622 Vali Loss: 3.170 Vali Acc: 0.135 Test Loss: 3.170 Test Acc: 0.135
Validation loss decreased (-0.124335 --> -0.134475).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.2069740
	speed: 0.2835s/iter; left time: 5161.1948s
	iters: 200, epoch: 13 | loss: 2.8655307
	speed: 0.0987s/iter; left time: 1786.6637s
Epoch: 13 cost time: 20.462573051452637
Epoch: 13, Steps: 208 | Train Loss: 2.554 Vali Loss: 3.149 Vali Acc: 0.130 Test Loss: 3.149 Test Acc: 0.130
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 2.1729336
	speed: 0.2493s/iter; left time: 4486.0173s
	iters: 200, epoch: 14 | loss: 2.6541474
	speed: 0.0775s/iter; left time: 1386.4187s
Epoch: 14 cost time: 17.43395733833313
Epoch: 14, Steps: 208 | Train Loss: 2.505 Vali Loss: 3.179 Vali Acc: 0.129 Test Loss: 3.179 Test Acc: 0.129
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 2.3899403
	speed: 0.2518s/iter; left time: 4479.6103s
	iters: 200, epoch: 15 | loss: 2.6120231
	speed: 0.0973s/iter; left time: 1721.3126s
Epoch: 15 cost time: 20.712695837020874
Epoch: 15, Steps: 208 | Train Loss: 2.518 Vali Loss: 3.200 Vali Acc: 0.123 Test Loss: 3.200 Test Acc: 0.123
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 2.8312125
	speed: 0.2439s/iter; left time: 4288.2779s
	iters: 200, epoch: 16 | loss: 2.5092187
	speed: 0.0830s/iter; left time: 1450.7864s
Epoch: 16 cost time: 17.547879934310913
Epoch: 16, Steps: 208 | Train Loss: 2.503 Vali Loss: 3.156 Vali Acc: 0.134 Test Loss: 3.156 Test Acc: 0.134
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 2.0375824
	speed: 0.2629s/iter; left time: 4567.3446s
	iters: 200, epoch: 17 | loss: 3.2530024
	speed: 0.1013s/iter; left time: 1749.3131s
Epoch: 17 cost time: 21.36583685874939
Epoch: 17, Steps: 208 | Train Loss: 2.521 Vali Loss: 3.321 Vali Acc: 0.123 Test Loss: 3.321 Test Acc: 0.123
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 2.7013876
	speed: 0.2389s/iter; left time: 4100.4492s
	iters: 200, epoch: 18 | loss: 2.7533274
	speed: 0.0810s/iter; left time: 1381.7278s
Epoch: 18 cost time: 17.310600996017456
Epoch: 18, Steps: 208 | Train Loss: 2.488 Vali Loss: 3.132 Vali Acc: 0.131 Test Loss: 3.132 Test Acc: 0.131
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 2.1624928
	speed: 0.2478s/iter; left time: 4202.3397s
	iters: 200, epoch: 19 | loss: 3.4954796
	speed: 0.0947s/iter; left time: 1596.7697s
Epoch: 19 cost time: 19.76586365699768
Epoch: 19, Steps: 208 | Train Loss: 2.544 Vali Loss: 3.208 Vali Acc: 0.131 Test Loss: 3.208 Test Acc: 0.131
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 2.3700404
	speed: 0.2438s/iter; left time: 4082.7076s
	iters: 200, epoch: 20 | loss: 2.4907188
	speed: 0.1039s/iter; left time: 1729.5146s
Epoch: 20 cost time: 19.27893352508545
Epoch: 20, Steps: 208 | Train Loss: 2.585 Vali Loss: 3.193 Vali Acc: 0.122 Test Loss: 3.193 Test Acc: 0.122
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 2.9679313
	speed: 0.2622s/iter; left time: 4336.5237s
	iters: 200, epoch: 21 | loss: 2.9378614
	speed: 0.0815s/iter; left time: 1340.3527s
Epoch: 21 cost time: 19.569108724594116
Epoch: 21, Steps: 208 | Train Loss: 2.606 Vali Loss: 3.228 Vali Acc: 0.120 Test Loss: 3.228 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 2.6884747
	speed: 0.2465s/iter; left time: 4026.6348s
	iters: 200, epoch: 22 | loss: 2.7571585
	speed: 0.0990s/iter; left time: 1607.5949s
Epoch: 22 cost time: 19.903462171554565
Epoch: 22, Steps: 208 | Train Loss: 2.565 Vali Loss: 3.174 Vali Acc: 0.133 Test Loss: 3.174 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13450641216820758
model parameter : 2635351
model size : 12.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.4113355
	speed: 0.0966s/iter; left time: 1999.6485s
	iters: 200, epoch: 1 | loss: 4.4102979
	speed: 0.0986s/iter; left time: 2031.8102s
Epoch: 1 cost time: 20.121838808059692
Epoch: 1, Steps: 208 | Train Loss: 3.913 Vali Loss: 3.770 Vali Acc: 0.050 Test Loss: 3.770 Test Acc: 0.050
Validation loss decreased (inf --> -0.050067).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3926082
	speed: 0.2125s/iter; left time: 4355.3518s
	iters: 200, epoch: 2 | loss: 3.5609918
	speed: 0.0590s/iter; left time: 1202.3593s
Epoch: 2 cost time: 13.218443632125854
Epoch: 2, Steps: 208 | Train Loss: 3.645 Vali Loss: 3.649 Vali Acc: 0.053 Test Loss: 3.649 Test Acc: 0.053
Validation loss decreased (-0.050067 --> -0.052752).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.9089379
	speed: 0.2530s/iter; left time: 5132.0107s
	iters: 200, epoch: 3 | loss: 3.7203925
	speed: 0.1072s/iter; left time: 2164.0343s
Epoch: 3 cost time: 22.39236831665039
Epoch: 3, Steps: 208 | Train Loss: 3.577 Vali Loss: 3.481 Vali Acc: 0.063 Test Loss: 3.481 Test Acc: 0.063
Validation loss decreased (-0.052752 --> -0.062596).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2786918
	speed: 0.2380s/iter; left time: 4779.2644s
	iters: 200, epoch: 4 | loss: 3.7480795
	speed: 0.0823s/iter; left time: 1643.4691s
Epoch: 4 cost time: 17.86684513092041
Epoch: 4, Steps: 208 | Train Loss: 3.414 Vali Loss: 3.389 Vali Acc: 0.087 Test Loss: 3.389 Test Acc: 0.087
Validation loss decreased (-0.062596 --> -0.086754).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.4548764
	speed: 0.2486s/iter; left time: 4938.6605s
	iters: 200, epoch: 5 | loss: 3.3329425
	speed: 0.1021s/iter; left time: 2019.3214s
Epoch: 5 cost time: 20.602853059768677
Epoch: 5, Steps: 208 | Train Loss: 3.254 Vali Loss: 3.349 Vali Acc: 0.088 Test Loss: 3.349 Test Acc: 0.088
Validation loss decreased (-0.086754 --> -0.087649).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.3964958
	speed: 0.2361s/iter; left time: 4642.3361s
	iters: 200, epoch: 6 | loss: 3.1213009
	speed: 0.1095s/iter; left time: 2142.5641s
Epoch: 6 cost time: 20.46703577041626
Epoch: 6, Steps: 208 | Train Loss: 3.150 Vali Loss: 3.226 Vali Acc: 0.090 Test Loss: 3.226 Test Acc: 0.090
Validation loss decreased (-0.087649 --> -0.089738).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.1662011
	speed: 0.2750s/iter; left time: 5349.8068s
	iters: 200, epoch: 7 | loss: 3.3178265
	speed: 0.0837s/iter; left time: 1618.8928s
Epoch: 7 cost time: 20.133068084716797
Epoch: 7, Steps: 208 | Train Loss: 3.044 Vali Loss: 3.169 Vali Acc: 0.098 Test Loss: 3.169 Test Acc: 0.098
Validation loss decreased (-0.089738 --> -0.098089).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.3490765
	speed: 0.2709s/iter; left time: 5212.6420s
	iters: 200, epoch: 8 | loss: 2.8929956
	speed: 0.1048s/iter; left time: 2005.8571s
Epoch: 8 cost time: 21.64196252822876
Epoch: 8, Steps: 208 | Train Loss: 2.894 Vali Loss: 3.289 Vali Acc: 0.101 Test Loss: 3.289 Test Acc: 0.101
Validation loss decreased (-0.098089 --> -0.100772).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.1035197
	speed: 0.2599s/iter; left time: 4948.4731s
	iters: 200, epoch: 9 | loss: 2.8470986
	speed: 0.0786s/iter; left time: 1487.9137s
Epoch: 9 cost time: 17.53776216506958
Epoch: 9, Steps: 208 | Train Loss: 2.754 Vali Loss: 3.276 Vali Acc: 0.112 Test Loss: 3.276 Test Acc: 0.112
Validation loss decreased (-0.100772 --> -0.111807).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.8927600
	speed: 0.2724s/iter; left time: 5128.7235s
	iters: 200, epoch: 10 | loss: 3.0178835
	speed: 0.1040s/iter; left time: 1947.0787s
Epoch: 10 cost time: 21.83987045288086
Epoch: 10, Steps: 208 | Train Loss: 2.661 Vali Loss: 3.145 Vali Acc: 0.129 Test Loss: 3.145 Test Acc: 0.129
Validation loss decreased (-0.111807 --> -0.129405).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.5892274
	speed: 0.2414s/iter; left time: 4494.8103s
	iters: 200, epoch: 11 | loss: 2.3566606
	speed: 0.0813s/iter; left time: 1506.1360s
Epoch: 11 cost time: 17.351298570632935
Epoch: 11, Steps: 208 | Train Loss: 2.584 Vali Loss: 3.122 Vali Acc: 0.137 Test Loss: 3.122 Test Acc: 0.137
Validation loss decreased (-0.129405 --> -0.137458).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.1003313
	speed: 0.2680s/iter; left time: 4935.4592s
	iters: 200, epoch: 12 | loss: 2.8119032
	speed: 0.1073s/iter; left time: 1964.4334s
Epoch: 12 cost time: 23.036045789718628
Epoch: 12, Steps: 208 | Train Loss: 2.496 Vali Loss: 3.121 Vali Acc: 0.133 Test Loss: 3.121 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.6795375
	speed: 0.2389s/iter; left time: 4349.4630s
	iters: 200, epoch: 13 | loss: 2.4166794
	speed: 0.0896s/iter; left time: 1622.7078s
Epoch: 13 cost time: 18.379868507385254
Epoch: 13, Steps: 208 | Train Loss: 2.445 Vali Loss: 3.096 Vali Acc: 0.127 Test Loss: 3.096 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 2.2148247
	speed: 0.2725s/iter; left time: 4904.8644s
	iters: 200, epoch: 14 | loss: 2.6477458
	speed: 0.0891s/iter; left time: 1593.9267s
Epoch: 14 cost time: 20.01664447784424
Epoch: 14, Steps: 208 | Train Loss: 2.365 Vali Loss: 3.214 Vali Acc: 0.139 Test Loss: 3.214 Test Acc: 0.139
Validation loss decreased (-0.137458 --> -0.138948).  Saving model ...
	iters: 100, epoch: 15 | loss: 2.3564687
	speed: 0.2549s/iter; left time: 4533.6120s
	iters: 200, epoch: 15 | loss: 2.3833499
	speed: 0.1122s/iter; left time: 1984.2263s
Epoch: 15 cost time: 21.863503456115723
Epoch: 15, Steps: 208 | Train Loss: 2.306 Vali Loss: 3.187 Vali Acc: 0.134 Test Loss: 3.187 Test Acc: 0.134
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 2.2072337
	speed: 0.2677s/iter; left time: 4707.0066s
	iters: 200, epoch: 16 | loss: 2.3004861
	speed: 0.0771s/iter; left time: 1347.0087s
Epoch: 16 cost time: 17.228545427322388
Epoch: 16, Steps: 208 | Train Loss: 2.326 Vali Loss: 3.261 Vali Acc: 0.123 Test Loss: 3.261 Test Acc: 0.123
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 2.4506986
	speed: 0.2699s/iter; left time: 4689.7679s
	iters: 200, epoch: 17 | loss: 1.9252946
	speed: 0.0950s/iter; left time: 1640.6541s
Epoch: 17 cost time: 20.99113631248474
Epoch: 17, Steps: 208 | Train Loss: 2.286 Vali Loss: 3.489 Vali Acc: 0.120 Test Loss: 3.489 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.9949013
	speed: 0.2523s/iter; left time: 4329.8818s
	iters: 200, epoch: 18 | loss: 2.1063814
	speed: 0.0795s/iter; left time: 1357.1607s
Epoch: 18 cost time: 17.67199683189392
Epoch: 18, Steps: 208 | Train Loss: 2.294 Vali Loss: 3.333 Vali Acc: 0.128 Test Loss: 3.333 Test Acc: 0.128
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 2.5730562
	speed: 0.2634s/iter; left time: 4467.0013s
	iters: 200, epoch: 19 | loss: 2.7258704
	speed: 0.0997s/iter; left time: 1681.2738s
Epoch: 19 cost time: 21.613905429840088
Epoch: 19, Steps: 208 | Train Loss: 2.305 Vali Loss: 3.390 Vali Acc: 0.130 Test Loss: 3.390 Test Acc: 0.130
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 2.0037334
	speed: 0.2409s/iter; left time: 4034.9927s
	iters: 200, epoch: 20 | loss: 2.2971661
	speed: 0.0817s/iter; left time: 1360.8078s
Epoch: 20 cost time: 17.714116096496582
Epoch: 20, Steps: 208 | Train Loss: 2.279 Vali Loss: 3.460 Vali Acc: 0.120 Test Loss: 3.460 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 2.4692831
	speed: 0.2854s/iter; left time: 4720.1486s
	iters: 200, epoch: 21 | loss: 2.4623611
	speed: 0.1054s/iter; left time: 1732.1310s
Epoch: 21 cost time: 22.354679107666016
Epoch: 21, Steps: 208 | Train Loss: 2.284 Vali Loss: 3.438 Vali Acc: 0.128 Test Loss: 3.438 Test Acc: 0.128
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 2.1353073
	speed: 0.2410s/iter; left time: 3936.4141s
	iters: 200, epoch: 22 | loss: 2.2022665
	speed: 0.0957s/iter; left time: 1552.9127s
Epoch: 22 cost time: 17.969200372695923
Epoch: 22, Steps: 208 | Train Loss: 2.439 Vali Loss: 3.453 Vali Acc: 0.115 Test Loss: 3.453 Test Acc: 0.115
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 1.9493645
	speed: 0.2064s/iter; left time: 3327.7409s
	iters: 200, epoch: 23 | loss: 2.4426765
	speed: 0.0967s/iter; left time: 1549.1544s
Epoch: 23 cost time: 17.184667587280273
Epoch: 23, Steps: 208 | Train Loss: 2.429 Vali Loss: 3.419 Vali Acc: 0.119 Test Loss: 3.419 Test Acc: 0.119
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 2.2378111
	speed: 0.2580s/iter; left time: 4106.3170s
	iters: 200, epoch: 24 | loss: 2.1653075
	speed: 0.0814s/iter; left time: 1288.2739s
Epoch: 24 cost time: 19.229206323623657
Epoch: 24, Steps: 208 | Train Loss: 2.477 Vali Loss: 3.424 Vali Acc: 0.098 Test Loss: 3.424 Test Acc: 0.098
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1389800178944229
model parameter : 2418135
model size : 11.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1545682
	speed: 0.1087s/iter; left time: 2250.4620s
	iters: 200, epoch: 1 | loss: 4.7006950
	speed: 0.0860s/iter; left time: 1771.8580s
Epoch: 1 cost time: 20.143123149871826
Epoch: 1, Steps: 208 | Train Loss: 3.963 Vali Loss: 3.989 Vali Acc: 0.050 Test Loss: 3.989 Test Acc: 0.050
Validation loss decreased (inf --> -0.049468).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6364620
	speed: 0.2551s/iter; left time: 5227.1579s
	iters: 200, epoch: 2 | loss: 3.8431556
	speed: 0.1031s/iter; left time: 2102.1638s
Epoch: 2 cost time: 20.30187726020813
Epoch: 2, Steps: 208 | Train Loss: 3.755 Vali Loss: 3.661 Vali Acc: 0.051 Test Loss: 3.661 Test Acc: 0.051
Validation loss decreased (-0.049468 --> -0.050962).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4801786
	speed: 0.2612s/iter; left time: 5299.1697s
	iters: 200, epoch: 3 | loss: 3.4504502
	speed: 0.0754s/iter; left time: 1520.9976s
Epoch: 3 cost time: 17.719388961791992
Epoch: 3, Steps: 208 | Train Loss: 3.596 Vali Loss: 3.582 Vali Acc: 0.049 Test Loss: 3.582 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.4530470
	speed: 0.2530s/iter; left time: 5078.5440s
	iters: 200, epoch: 4 | loss: 3.3900926
	speed: 0.0895s/iter; left time: 1788.9313s
Epoch: 4 cost time: 19.5233473777771
Epoch: 4, Steps: 208 | Train Loss: 3.457 Vali Loss: 3.419 Vali Acc: 0.067 Test Loss: 3.419 Test Acc: 0.067
Validation loss decreased (-0.050962 --> -0.067070).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3689170
	speed: 0.2526s/iter; left time: 5019.3654s
	iters: 200, epoch: 5 | loss: 3.3781552
	speed: 0.0802s/iter; left time: 1586.1060s
Epoch: 5 cost time: 17.731669187545776
Epoch: 5, Steps: 208 | Train Loss: 3.259 Vali Loss: 3.350 Vali Acc: 0.092 Test Loss: 3.350 Test Acc: 0.092
Validation loss decreased (-0.067070 --> -0.091526).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.1337833
	speed: 0.2641s/iter; left time: 5191.6613s
	iters: 200, epoch: 6 | loss: 3.0310915
	speed: 0.0913s/iter; left time: 1785.2281s
Epoch: 6 cost time: 20.024047374725342
Epoch: 6, Steps: 208 | Train Loss: 3.121 Vali Loss: 3.277 Vali Acc: 0.102 Test Loss: 3.277 Test Acc: 0.102
Validation loss decreased (-0.091526 --> -0.101965).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.0349689
	speed: 0.2572s/iter; left time: 5003.3307s
	iters: 200, epoch: 7 | loss: 3.0074079
	speed: 0.0792s/iter; left time: 1531.9573s
Epoch: 7 cost time: 16.544177532196045
Epoch: 7, Steps: 208 | Train Loss: 3.021 Vali Loss: 3.249 Vali Acc: 0.104 Test Loss: 3.249 Test Acc: 0.104
Validation loss decreased (-0.101965 --> -0.103755).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.0206721
	speed: 0.2623s/iter; left time: 5048.2016s
	iters: 200, epoch: 8 | loss: 3.2654290
	speed: 0.0975s/iter; left time: 1866.7863s
Epoch: 8 cost time: 20.43127703666687
Epoch: 8, Steps: 208 | Train Loss: 2.900 Vali Loss: 3.027 Vali Acc: 0.129 Test Loss: 3.027 Test Acc: 0.129
Validation loss decreased (-0.103755 --> -0.128810).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.6923032
	speed: 0.2242s/iter; left time: 4267.5156s
	iters: 200, epoch: 9 | loss: 2.9863164
	speed: 0.0828s/iter; left time: 1568.5978s
Epoch: 9 cost time: 17.252838850021362
Epoch: 9, Steps: 208 | Train Loss: 2.741 Vali Loss: 3.186 Vali Acc: 0.111 Test Loss: 3.186 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.9591904
	speed: 0.2643s/iter; left time: 4975.8984s
	iters: 200, epoch: 10 | loss: 2.4708898
	speed: 0.0873s/iter; left time: 1634.8265s
Epoch: 10 cost time: 18.74167227745056
Epoch: 10, Steps: 208 | Train Loss: 2.614 Vali Loss: 3.070 Vali Acc: 0.133 Test Loss: 3.070 Test Acc: 0.133
Validation loss decreased (-0.128810 --> -0.133283).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.8144598
	speed: 0.2605s/iter; left time: 4850.5635s
	iters: 200, epoch: 11 | loss: 2.1859975
	speed: 0.0979s/iter; left time: 1813.2033s
Epoch: 11 cost time: 19.448198080062866
Epoch: 11, Steps: 208 | Train Loss: 2.473 Vali Loss: 3.246 Vali Acc: 0.113 Test Loss: 3.246 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.8467096
	speed: 0.2565s/iter; left time: 4722.2155s
	iters: 200, epoch: 12 | loss: 2.7688899
	speed: 0.0761s/iter; left time: 1394.2177s
Epoch: 12 cost time: 18.311222553253174
Epoch: 12, Steps: 208 | Train Loss: 2.317 Vali Loss: 3.299 Vali Acc: 0.127 Test Loss: 3.299 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 2.6781669
	speed: 0.2580s/iter; left time: 4697.4586s
	iters: 200, epoch: 13 | loss: 2.6193395
	speed: 0.0892s/iter; left time: 1615.5378s
Epoch: 13 cost time: 19.395756483078003
Epoch: 13, Steps: 208 | Train Loss: 2.229 Vali Loss: 3.377 Vali Acc: 0.126 Test Loss: 3.377 Test Acc: 0.126
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.8480471
	speed: 0.2559s/iter; left time: 4605.2838s
	iters: 200, epoch: 14 | loss: 2.1623058
	speed: 0.0826s/iter; left time: 1478.0684s
Epoch: 14 cost time: 17.816199779510498
Epoch: 14, Steps: 208 | Train Loss: 2.150 Vali Loss: 3.366 Vali Acc: 0.132 Test Loss: 3.366 Test Acc: 0.132
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 2.8620920
	speed: 0.2478s/iter; left time: 4408.3654s
	iters: 200, epoch: 15 | loss: 1.9453548
	speed: 0.0926s/iter; left time: 1637.4542s
Epoch: 15 cost time: 19.474109411239624
Epoch: 15, Steps: 208 | Train Loss: 2.050 Vali Loss: 3.551 Vali Acc: 0.122 Test Loss: 3.551 Test Acc: 0.122
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 2.6639545
	speed: 0.2336s/iter; left time: 4106.7563s
	iters: 200, epoch: 16 | loss: 2.1776984
	speed: 0.0799s/iter; left time: 1397.0872s
Epoch: 16 cost time: 16.8177707195282
Epoch: 16, Steps: 208 | Train Loss: 2.057 Vali Loss: 3.487 Vali Acc: 0.131 Test Loss: 3.487 Test Acc: 0.131
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 2.1412115
	speed: 0.2580s/iter; left time: 4481.9180s
	iters: 200, epoch: 17 | loss: 1.5228175
	speed: 0.0987s/iter; left time: 1704.4388s
Epoch: 17 cost time: 20.328808784484863
Epoch: 17, Steps: 208 | Train Loss: 2.016 Vali Loss: 3.546 Vali Acc: 0.129 Test Loss: 3.546 Test Acc: 0.129
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.9054549
	speed: 0.2453s/iter; left time: 4210.1794s
	iters: 200, epoch: 18 | loss: 1.7167563
	speed: 0.0902s/iter; left time: 1538.8631s
Epoch: 18 cost time: 18.47697377204895
Epoch: 18, Steps: 208 | Train Loss: 1.917 Vali Loss: 3.562 Vali Acc: 0.122 Test Loss: 3.562 Test Acc: 0.122
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 2.1790941
	speed: 0.2785s/iter; left time: 4722.8655s
	iters: 200, epoch: 19 | loss: 2.5598726
	speed: 0.0835s/iter; left time: 1407.9435s
Epoch: 19 cost time: 19.409913778305054
Epoch: 19, Steps: 208 | Train Loss: 1.962 Vali Loss: 3.643 Vali Acc: 0.123 Test Loss: 3.643 Test Acc: 0.123
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.6442151
	speed: 0.3472s/iter; left time: 5815.3137s
	iters: 200, epoch: 20 | loss: 2.0525970
	speed: 0.1695s/iter; left time: 2822.7139s
Epoch: 20 cost time: 33.72011184692383
Epoch: 20, Steps: 208 | Train Loss: 1.959 Vali Loss: 3.734 Vali Acc: 0.133 Test Loss: 3.734 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13331345064121683
model parameter : 2413783
model size : 11.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7033117
	speed: 0.1597s/iter; left time: 3306.4659s
	iters: 200, epoch: 1 | loss: 3.7557077
	speed: 0.1188s/iter; left time: 2446.9105s
Epoch: 1 cost time: 28.893873691558838
Epoch: 1, Steps: 208 | Train Loss: 3.933 Vali Loss: 3.739 Vali Acc: 0.041 Test Loss: 3.739 Test Acc: 0.041
Validation loss decreased (inf --> -0.041120).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6550715
	speed: 0.3069s/iter; left time: 6289.9333s
	iters: 200, epoch: 2 | loss: 3.8914056
	speed: 0.1047s/iter; left time: 2134.1301s
Epoch: 2 cost time: 22.791295766830444
Epoch: 2, Steps: 208 | Train Loss: 3.679 Vali Loss: 3.616 Vali Acc: 0.048 Test Loss: 3.616 Test Acc: 0.048
Validation loss decreased (-0.041120 --> -0.048279).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5655320
	speed: 0.3331s/iter; left time: 6756.6363s
	iters: 200, epoch: 3 | loss: 3.7930779
	speed: 0.1381s/iter; left time: 2787.6514s
Epoch: 3 cost time: 30.67881941795349
Epoch: 3, Steps: 208 | Train Loss: 3.559 Vali Loss: 3.620 Vali Acc: 0.060 Test Loss: 3.620 Test Acc: 0.060
Validation loss decreased (-0.048279 --> -0.060208).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.5538664
	speed: 0.3343s/iter; left time: 6712.5191s
	iters: 200, epoch: 4 | loss: 3.5053957
	speed: 0.1348s/iter; left time: 2692.5997s
Epoch: 4 cost time: 28.626957893371582
Epoch: 4, Steps: 208 | Train Loss: 3.437 Vali Loss: 3.383 Vali Acc: 0.076 Test Loss: 3.383 Test Acc: 0.076
Validation loss decreased (-0.060208 --> -0.075719).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.1935661
	speed: 0.3503s/iter; left time: 6959.7561s
	iters: 200, epoch: 5 | loss: 3.4451411
	speed: 0.1441s/iter; left time: 2847.7468s
Epoch: 5 cost time: 30.819708347320557
Epoch: 5, Steps: 208 | Train Loss: 3.279 Vali Loss: 3.330 Vali Acc: 0.087 Test Loss: 3.330 Test Acc: 0.087
Validation loss decreased (-0.075719 --> -0.087351).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.8945336
	speed: 0.3428s/iter; left time: 6738.9286s
	iters: 200, epoch: 6 | loss: 3.3298450
	speed: 0.1385s/iter; left time: 2709.7924s
Epoch: 6 cost time: 29.99841594696045
Epoch: 6, Steps: 208 | Train Loss: 3.103 Vali Loss: 3.307 Vali Acc: 0.101 Test Loss: 3.307 Test Acc: 0.101
Validation loss decreased (-0.087351 --> -0.100772).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.2404714
	speed: 0.3426s/iter; left time: 6663.6432s
	iters: 200, epoch: 7 | loss: 2.7440329
	speed: 0.1326s/iter; left time: 2566.3770s
Epoch: 7 cost time: 28.4487726688385
Epoch: 7, Steps: 208 | Train Loss: 2.991 Vali Loss: 3.225 Vali Acc: 0.109 Test Loss: 3.225 Test Acc: 0.109
Validation loss decreased (-0.100772 --> -0.108825).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.4091852
	speed: 0.3433s/iter; left time: 6606.2005s
	iters: 200, epoch: 8 | loss: 2.8830667
	speed: 0.1526s/iter; left time: 2922.4473s
Epoch: 8 cost time: 31.07462787628174
Epoch: 8, Steps: 208 | Train Loss: 2.870 Vali Loss: 3.194 Vali Acc: 0.114 Test Loss: 3.194 Test Acc: 0.114
Validation loss decreased (-0.108825 --> -0.114194).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.5650237
	speed: 0.3569s/iter; left time: 6794.3780s
	iters: 200, epoch: 9 | loss: 2.1578639
	speed: 0.1502s/iter; left time: 2844.7691s
Epoch: 9 cost time: 31.880630254745483
Epoch: 9, Steps: 208 | Train Loss: 2.747 Vali Loss: 3.074 Vali Acc: 0.116 Test Loss: 3.074 Test Acc: 0.116
Validation loss decreased (-0.114194 --> -0.115985).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.6780229
	speed: 0.3680s/iter; left time: 6928.7617s
	iters: 200, epoch: 10 | loss: 2.7817421
	speed: 0.1386s/iter; left time: 2595.0931s
Epoch: 10 cost time: 31.53364849090576
Epoch: 10, Steps: 208 | Train Loss: 2.615 Vali Loss: 3.175 Vali Acc: 0.134 Test Loss: 3.175 Test Acc: 0.134
Validation loss decreased (-0.115985 --> -0.134176).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.8992198
	speed: 0.3728s/iter; left time: 6941.1230s
	iters: 200, epoch: 11 | loss: 2.6297314
	speed: 0.1475s/iter; left time: 2732.7344s
Epoch: 11 cost time: 33.35403108596802
Epoch: 11, Steps: 208 | Train Loss: 2.527 Vali Loss: 3.041 Vali Acc: 0.145 Test Loss: 3.041 Test Acc: 0.145
Validation loss decreased (-0.134176 --> -0.145213).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.7587383
	speed: 0.3603s/iter; left time: 6633.6365s
	iters: 200, epoch: 12 | loss: 2.7457385
	speed: 0.1361s/iter; left time: 2492.7223s
Epoch: 12 cost time: 30.370039224624634
Epoch: 12, Steps: 208 | Train Loss: 2.491 Vali Loss: 3.140 Vali Acc: 0.136 Test Loss: 3.140 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.2673881
	speed: 0.3437s/iter; left time: 6257.8396s
	iters: 200, epoch: 13 | loss: 2.6542711
	speed: 0.1484s/iter; left time: 2686.3283s
Epoch: 13 cost time: 31.113603353500366
Epoch: 13, Steps: 208 | Train Loss: 2.434 Vali Loss: 3.098 Vali Acc: 0.135 Test Loss: 3.098 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 2.5068626
	speed: 0.3335s/iter; left time: 6002.8805s
	iters: 200, epoch: 14 | loss: 2.2530136
	speed: 0.1406s/iter; left time: 2516.6931s
Epoch: 14 cost time: 30.977667331695557
Epoch: 14, Steps: 208 | Train Loss: 2.409 Vali Loss: 3.283 Vali Acc: 0.126 Test Loss: 3.283 Test Acc: 0.126
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 2.1263046
	speed: 0.3470s/iter; left time: 6173.0988s
	iters: 200, epoch: 15 | loss: 1.9353765
	speed: 0.1419s/iter; left time: 2509.8956s
Epoch: 15 cost time: 30.890381574630737
Epoch: 15, Steps: 208 | Train Loss: 2.313 Vali Loss: 3.260 Vali Acc: 0.132 Test Loss: 3.260 Test Acc: 0.132
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.7346799
	speed: 0.3383s/iter; left time: 5946.7803s
	iters: 200, epoch: 16 | loss: 1.7848914
	speed: 0.1444s/iter; left time: 2524.3437s
Epoch: 16 cost time: 31.10956382751465
Epoch: 16, Steps: 208 | Train Loss: 2.257 Vali Loss: 3.358 Vali Acc: 0.122 Test Loss: 3.358 Test Acc: 0.122
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.9152286
	speed: 0.3427s/iter; left time: 5953.3788s
	iters: 200, epoch: 17 | loss: 2.1539216
	speed: 0.1559s/iter; left time: 2693.3469s
Epoch: 17 cost time: 32.29510259628296
Epoch: 17, Steps: 208 | Train Loss: 2.258 Vali Loss: 3.338 Vali Acc: 0.132 Test Loss: 3.338 Test Acc: 0.132
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.8989407
	speed: 0.3423s/iter; left time: 5875.5078s
	iters: 200, epoch: 18 | loss: 2.2117627
	speed: 0.1421s/iter; left time: 2425.1228s
Epoch: 18 cost time: 30.99040126800537
Epoch: 18, Steps: 208 | Train Loss: 2.223 Vali Loss: 3.284 Vali Acc: 0.129 Test Loss: 3.284 Test Acc: 0.129
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.9589410
	speed: 0.3363s/iter; left time: 5703.0477s
	iters: 200, epoch: 19 | loss: 2.2911730
	speed: 0.1398s/iter; left time: 2356.3562s
Epoch: 19 cost time: 30.521864652633667
Epoch: 19, Steps: 208 | Train Loss: 2.239 Vali Loss: 3.494 Vali Acc: 0.118 Test Loss: 3.494 Test Acc: 0.118
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.7567495
	speed: 0.3346s/iter; left time: 5604.9431s
	iters: 200, epoch: 20 | loss: 2.5494814
	speed: 0.1466s/iter; left time: 2440.9699s
Epoch: 20 cost time: 31.861143827438354
Epoch: 20, Steps: 208 | Train Loss: 2.217 Vali Loss: 3.394 Vali Acc: 0.118 Test Loss: 3.394 Test Acc: 0.118
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 2.1207831
	speed: 0.3526s/iter; left time: 5832.9319s
	iters: 200, epoch: 21 | loss: 2.5400360
	speed: 0.1652s/iter; left time: 2716.4245s
Epoch: 21 cost time: 33.46455121040344
Epoch: 21, Steps: 208 | Train Loss: 2.268 Vali Loss: 3.312 Vali Acc: 0.129 Test Loss: 3.312 Test Acc: 0.129
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.14524306591112437
model parameter : 2409431
model size : 11.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5855803
	speed: 0.1677s/iter; left time: 3472.2109s
	iters: 200, epoch: 1 | loss: 4.5373878
	speed: 0.1292s/iter; left time: 2661.8988s
Epoch: 1 cost time: 30.900346040725708
Epoch: 1, Steps: 208 | Train Loss: 3.922 Vali Loss: 3.644 Vali Acc: 0.055 Test Loss: 3.644 Test Acc: 0.055
Validation loss decreased (inf --> -0.054840).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7865446
	speed: 0.3483s/iter; left time: 7136.7201s
	iters: 200, epoch: 2 | loss: 3.5959477
	speed: 0.1406s/iter; left time: 2867.6644s
Epoch: 2 cost time: 30.26170516014099
Epoch: 2, Steps: 208 | Train Loss: 3.644 Vali Loss: 3.623 Vali Acc: 0.041 Test Loss: 3.623 Test Acc: 0.041
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.7210822
	speed: 0.2556s/iter; left time: 5185.7661s
	iters: 200, epoch: 3 | loss: 3.7244663
	speed: 0.0713s/iter; left time: 1438.2694s
Epoch: 3 cost time: 16.17195725440979
Epoch: 3, Steps: 208 | Train Loss: 3.563 Vali Loss: 3.499 Vali Acc: 0.059 Test Loss: 3.499 Test Acc: 0.059
Validation loss decreased (-0.054840 --> -0.058718).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3347616
	speed: 0.2405s/iter; left time: 4829.0937s
	iters: 200, epoch: 4 | loss: 3.1132727
	speed: 0.0882s/iter; left time: 1762.6026s
Epoch: 4 cost time: 19.406935214996338
Epoch: 4, Steps: 208 | Train Loss: 3.414 Vali Loss: 3.427 Vali Acc: 0.087 Test Loss: 3.427 Test Acc: 0.087
Validation loss decreased (-0.058718 --> -0.086754).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.0964038
	speed: 0.2320s/iter; left time: 4609.7571s
	iters: 200, epoch: 5 | loss: 3.2945402
	speed: 0.0712s/iter; left time: 1408.1333s
Epoch: 5 cost time: 15.889761447906494
Epoch: 5, Steps: 208 | Train Loss: 3.249 Vali Loss: 3.256 Vali Acc: 0.095 Test Loss: 3.256 Test Acc: 0.095
Validation loss decreased (-0.086754 --> -0.094510).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.8595967
	speed: 0.2198s/iter; left time: 4322.3680s
	iters: 200, epoch: 6 | loss: 3.0613947
	speed: 0.0609s/iter; left time: 1192.1035s
Epoch: 6 cost time: 13.804894208908081
Epoch: 6, Steps: 208 | Train Loss: 3.132 Vali Loss: 3.193 Vali Acc: 0.109 Test Loss: 3.193 Test Acc: 0.109
Validation loss decreased (-0.094510 --> -0.108826).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9827282
	speed: 0.2513s/iter; left time: 4888.6272s
	iters: 200, epoch: 7 | loss: 2.6385279
	speed: 0.0940s/iter; left time: 1818.5482s
Epoch: 7 cost time: 20.24980616569519
Epoch: 7, Steps: 208 | Train Loss: 3.031 Vali Loss: 3.097 Vali Acc: 0.119 Test Loss: 3.097 Test Acc: 0.119
Validation loss decreased (-0.108826 --> -0.119265).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.2316492
	speed: 0.2504s/iter; left time: 4819.1331s
	iters: 200, epoch: 8 | loss: 2.7384124
	speed: 0.0884s/iter; left time: 1692.2937s
Epoch: 8 cost time: 17.59674072265625
Epoch: 8, Steps: 208 | Train Loss: 2.875 Vali Loss: 3.170 Vali Acc: 0.116 Test Loss: 3.170 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.6938624
	speed: 0.2622s/iter; left time: 4992.3827s
	iters: 200, epoch: 9 | loss: 3.5112100
	speed: 0.0789s/iter; left time: 1494.0112s
Epoch: 9 cost time: 18.67034649848938
Epoch: 9, Steps: 208 | Train Loss: 2.781 Vali Loss: 3.030 Vali Acc: 0.123 Test Loss: 3.030 Test Acc: 0.123
Validation loss decreased (-0.119265 --> -0.122546).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.8351572
	speed: 0.2711s/iter; left time: 5103.8044s
	iters: 200, epoch: 10 | loss: 2.7482774
	speed: 0.1036s/iter; left time: 1939.6711s
Epoch: 10 cost time: 21.23909568786621
Epoch: 10, Steps: 208 | Train Loss: 2.705 Vali Loss: 3.065 Vali Acc: 0.129 Test Loss: 3.065 Test Acc: 0.129
Validation loss decreased (-0.122546 --> -0.129406).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.7821758
	speed: 0.2592s/iter; left time: 4826.8441s
	iters: 200, epoch: 11 | loss: 2.5068178
	speed: 0.0756s/iter; left time: 1399.8124s
Epoch: 11 cost time: 16.780892848968506
Epoch: 11, Steps: 208 | Train Loss: 2.670 Vali Loss: 3.186 Vali Acc: 0.123 Test Loss: 3.186 Test Acc: 0.123
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.3922307
	speed: 0.2352s/iter; left time: 4330.0181s
	iters: 200, epoch: 12 | loss: 3.2784951
	speed: 0.0994s/iter; left time: 1820.6063s
Epoch: 12 cost time: 19.19080948829651
Epoch: 12, Steps: 208 | Train Loss: 2.579 Vali Loss: 3.044 Vali Acc: 0.132 Test Loss: 3.044 Test Acc: 0.132
Validation loss decreased (-0.129406 --> -0.132090).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.2420242
	speed: 0.3222s/iter; left time: 5865.1994s
	iters: 200, epoch: 13 | loss: 2.4160619
	speed: 0.1314s/iter; left time: 2379.6889s
Epoch: 13 cost time: 27.290161609649658
Epoch: 13, Steps: 208 | Train Loss: 2.508 Vali Loss: 3.129 Vali Acc: 0.121 Test Loss: 3.129 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 2.2514646
	speed: 0.3346s/iter; left time: 6021.5626s
	iters: 200, epoch: 14 | loss: 2.4304428
	speed: 0.1450s/iter; left time: 2594.9425s
Epoch: 14 cost time: 30.051668167114258
Epoch: 14, Steps: 208 | Train Loss: 2.492 Vali Loss: 3.061 Vali Acc: 0.135 Test Loss: 3.061 Test Acc: 0.135
Validation loss decreased (-0.132090 --> -0.134476).  Saving model ...
	iters: 100, epoch: 15 | loss: 2.5880477
	speed: 0.3373s/iter; left time: 6000.6318s
	iters: 200, epoch: 15 | loss: 2.9792848
	speed: 0.1376s/iter; left time: 2434.6983s
Epoch: 15 cost time: 29.680230140686035
Epoch: 15, Steps: 208 | Train Loss: 2.457 Vali Loss: 3.130 Vali Acc: 0.128 Test Loss: 3.130 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 2.4195275
	speed: 0.3492s/iter; left time: 6139.1101s
	iters: 200, epoch: 16 | loss: 2.2914691
	speed: 0.1391s/iter; left time: 2432.4473s
Epoch: 16 cost time: 30.71893835067749
Epoch: 16, Steps: 208 | Train Loss: 2.385 Vali Loss: 3.175 Vali Acc: 0.133 Test Loss: 3.175 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 2.7271094
	speed: 0.3336s/iter; left time: 5795.4376s
	iters: 200, epoch: 17 | loss: 2.1975508
	speed: 0.1294s/iter; left time: 2234.3993s
Epoch: 17 cost time: 28.26141333580017
Epoch: 17, Steps: 208 | Train Loss: 2.384 Vali Loss: 3.201 Vali Acc: 0.122 Test Loss: 3.201 Test Acc: 0.122
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 2.4293432
	speed: 0.3506s/iter; left time: 6018.1355s
	iters: 200, epoch: 18 | loss: 2.3242166
	speed: 0.1452s/iter; left time: 2477.5811s
Epoch: 18 cost time: 31.329374074935913
Epoch: 18, Steps: 208 | Train Loss: 2.328 Vali Loss: 3.222 Vali Acc: 0.132 Test Loss: 3.222 Test Acc: 0.132
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 2.2075653
	speed: 0.3509s/iter; left time: 5950.2281s
	iters: 200, epoch: 19 | loss: 2.3686893
	speed: 0.1334s/iter; left time: 2249.3186s
Epoch: 19 cost time: 30.167223930358887
Epoch: 19, Steps: 208 | Train Loss: 2.333 Vali Loss: 3.366 Vali Acc: 0.129 Test Loss: 3.366 Test Acc: 0.129
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 1.7513311
	speed: 0.3437s/iter; left time: 5756.0497s
	iters: 200, epoch: 20 | loss: 2.4906781
	speed: 0.1398s/iter; left time: 2326.7317s
Epoch: 20 cost time: 30.10576844215393
Epoch: 20, Steps: 208 | Train Loss: 2.310 Vali Loss: 3.220 Vali Acc: 0.123 Test Loss: 3.220 Test Acc: 0.123
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 2.5508361
	speed: 0.3393s/iter; left time: 5611.5551s
	iters: 200, epoch: 21 | loss: 2.8947487
	speed: 0.1445s/iter; left time: 2375.6334s
Epoch: 21 cost time: 31.119147062301636
Epoch: 21, Steps: 208 | Train Loss: 2.451 Vali Loss: 3.207 Vali Acc: 0.118 Test Loss: 3.207 Test Acc: 0.118
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 2.5127826
	speed: 0.3676s/iter; left time: 6004.2512s
	iters: 200, epoch: 22 | loss: 2.3318791
	speed: 0.1562s/iter; left time: 2536.0154s
Epoch: 22 cost time: 33.19384241104126
Epoch: 22, Steps: 208 | Train Loss: 2.439 Vali Loss: 3.274 Vali Acc: 0.124 Test Loss: 3.274 Test Acc: 0.124
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 2.5263455
	speed: 0.3693s/iter; left time: 5955.7365s
	iters: 200, epoch: 23 | loss: 2.7201924
	speed: 0.1501s/iter; left time: 2405.8251s
Epoch: 23 cost time: 32.21146273612976
Epoch: 23, Steps: 208 | Train Loss: 2.289 Vali Loss: 3.224 Vali Acc: 0.133 Test Loss: 3.224 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 2.3221529
	speed: 0.3706s/iter; left time: 5898.3711s
	iters: 200, epoch: 24 | loss: 2.8863297
	speed: 0.1558s/iter; left time: 2464.5542s
Epoch: 24 cost time: 33.30578851699829
Epoch: 24, Steps: 208 | Train Loss: 2.499 Vali Loss: 3.178 Vali Acc: 0.126 Test Loss: 3.178 Test Acc: 0.126
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13450641216820758
model parameter : 2405079
model size : 11.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9804595
	speed: 0.1275s/iter; left time: 2639.7771s
	iters: 200, epoch: 1 | loss: 3.8381448
	speed: 0.1098s/iter; left time: 2261.3143s
Epoch: 1 cost time: 24.719770193099976
Epoch: 1, Steps: 208 | Train Loss: 3.778 Vali Loss: 3.638 Vali Acc: 0.054 Test Loss: 3.638 Test Acc: 0.054
Validation loss decreased (inf --> -0.053647).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7869167
	speed: 0.3035s/iter; left time: 6220.0591s
	iters: 200, epoch: 2 | loss: 3.4715588
	speed: 0.1108s/iter; left time: 2258.9510s
Epoch: 2 cost time: 23.548750162124634
Epoch: 2, Steps: 208 | Train Loss: 3.655 Vali Loss: 3.558 Vali Acc: 0.058 Test Loss: 3.558 Test Acc: 0.058
Validation loss decreased (-0.053647 --> -0.057823).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5644360
	speed: 0.3104s/iter; left time: 6296.2957s
	iters: 200, epoch: 3 | loss: 3.5289114
	speed: 0.1174s/iter; left time: 2369.2296s
Epoch: 3 cost time: 24.759034872055054
Epoch: 3, Steps: 208 | Train Loss: 3.531 Vali Loss: 3.574 Vali Acc: 0.060 Test Loss: 3.574 Test Acc: 0.060
Validation loss decreased (-0.057823 --> -0.060209).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.5169206
	speed: 0.3072s/iter; left time: 6167.5316s
	iters: 200, epoch: 4 | loss: 3.4185743
	speed: 0.1151s/iter; left time: 2298.7773s
Epoch: 4 cost time: 24.070651531219482
Epoch: 4, Steps: 208 | Train Loss: 3.484 Vali Loss: 3.514 Vali Acc: 0.064 Test Loss: 3.514 Test Acc: 0.064
Validation loss decreased (-0.060209 --> -0.064087).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.5750952
	speed: 0.2971s/iter; left time: 5903.9732s
	iters: 200, epoch: 5 | loss: 3.2512696
	speed: 0.1093s/iter; left time: 2159.9974s
Epoch: 5 cost time: 23.126359939575195
Epoch: 5, Steps: 208 | Train Loss: 3.455 Vali Loss: 3.498 Vali Acc: 0.066 Test Loss: 3.498 Test Acc: 0.066
Validation loss decreased (-0.064087 --> -0.065578).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.1338055
	speed: 0.3222s/iter; left time: 6334.1784s
	iters: 200, epoch: 6 | loss: 3.3355448
	speed: 0.1088s/iter; left time: 2128.2196s
Epoch: 6 cost time: 23.211005926132202
Epoch: 6, Steps: 208 | Train Loss: 3.437 Vali Loss: 3.575 Vali Acc: 0.050 Test Loss: 3.575 Test Acc: 0.050
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.2863433
	speed: 0.2881s/iter; left time: 5605.0862s
	iters: 200, epoch: 7 | loss: 3.3546941
	speed: 0.1072s/iter; left time: 2074.4571s
Epoch: 7 cost time: 22.71732449531555
Epoch: 7, Steps: 208 | Train Loss: 3.429 Vali Loss: 3.469 Vali Acc: 0.073 Test Loss: 3.469 Test Acc: 0.073
Validation loss decreased (-0.065578 --> -0.072736).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.5370314
	speed: 0.3078s/iter; left time: 5923.1685s
	iters: 200, epoch: 8 | loss: 3.1696591
	speed: 0.1115s/iter; left time: 2135.2090s
Epoch: 8 cost time: 23.271241188049316
Epoch: 8, Steps: 208 | Train Loss: 3.373 Vali Loss: 3.468 Vali Acc: 0.069 Test Loss: 3.468 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 3.2115421
	speed: 0.3086s/iter; left time: 5875.2848s
	iters: 200, epoch: 9 | loss: 3.2782552
	speed: 0.1205s/iter; left time: 2282.2834s
Epoch: 9 cost time: 24.951109409332275
Epoch: 9, Steps: 208 | Train Loss: 3.357 Vali Loss: 3.457 Vali Acc: 0.076 Test Loss: 3.457 Test Acc: 0.076
Validation loss decreased (-0.072736 --> -0.076315).  Saving model ...
	iters: 100, epoch: 10 | loss: 3.1875744
	speed: 0.3311s/iter; left time: 6234.5315s
	iters: 200, epoch: 10 | loss: 3.3401392
	speed: 0.1237s/iter; left time: 2317.4345s
Epoch: 10 cost time: 25.492395877838135
Epoch: 10, Steps: 208 | Train Loss: 3.311 Vali Loss: 3.450 Vali Acc: 0.072 Test Loss: 3.450 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 3.1685579
	speed: 0.3154s/iter; left time: 5872.2509s
	iters: 200, epoch: 11 | loss: 3.2734172
	speed: 0.1156s/iter; left time: 2141.2752s
Epoch: 11 cost time: 23.820956230163574
Epoch: 11, Steps: 208 | Train Loss: 3.238 Vali Loss: 3.455 Vali Acc: 0.073 Test Loss: 3.455 Test Acc: 0.073
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 2.6967189
	speed: 0.3310s/iter; left time: 6094.6008s
	iters: 200, epoch: 12 | loss: 3.1825767
	speed: 0.1179s/iter; left time: 2159.9536s
Epoch: 12 cost time: 25.443984270095825
Epoch: 12, Steps: 208 | Train Loss: 3.162 Vali Loss: 3.477 Vali Acc: 0.078 Test Loss: 3.477 Test Acc: 0.078
Validation loss decreased (-0.076315 --> -0.077508).  Saving model ...
	iters: 100, epoch: 13 | loss: 3.1542869
	speed: 0.3199s/iter; left time: 5823.8036s
	iters: 200, epoch: 13 | loss: 3.1135001
	speed: 0.1149s/iter; left time: 2080.6838s
Epoch: 13 cost time: 24.451745748519897
Epoch: 13, Steps: 208 | Train Loss: 3.067 Vali Loss: 3.508 Vali Acc: 0.082 Test Loss: 3.508 Test Acc: 0.082
Validation loss decreased (-0.077508 --> -0.081683).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.5252049
	speed: 0.3180s/iter; left time: 5723.3877s
	iters: 200, epoch: 14 | loss: 2.8527036
	speed: 0.1086s/iter; left time: 1943.6156s
Epoch: 14 cost time: 23.590412139892578
Epoch: 14, Steps: 208 | Train Loss: 2.941 Vali Loss: 3.599 Vali Acc: 0.084 Test Loss: 3.599 Test Acc: 0.084
Validation loss decreased (-0.081683 --> -0.084068).  Saving model ...
	iters: 100, epoch: 15 | loss: 2.5152376
	speed: 0.3009s/iter; left time: 5352.3776s
	iters: 200, epoch: 15 | loss: 2.7862453
	speed: 0.1040s/iter; left time: 1839.5040s
Epoch: 15 cost time: 22.250997066497803
Epoch: 15, Steps: 208 | Train Loss: 2.834 Vali Loss: 3.623 Vali Acc: 0.078 Test Loss: 3.623 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.8179413
	speed: 0.2369s/iter; left time: 4164.7126s
	iters: 200, epoch: 16 | loss: 3.3745930
	speed: 0.1111s/iter; left time: 1942.7392s
Epoch: 16 cost time: 19.581942319869995
Epoch: 16, Steps: 208 | Train Loss: 2.675 Vali Loss: 3.731 Vali Acc: 0.085 Test Loss: 3.731 Test Acc: 0.085
Validation loss decreased (-0.084068 --> -0.084663).  Saving model ...
	iters: 100, epoch: 17 | loss: 2.7387261
	speed: 0.3016s/iter; left time: 5240.2090s
	iters: 200, epoch: 17 | loss: 2.4962616
	speed: 0.1094s/iter; left time: 1890.2205s
Epoch: 17 cost time: 23.363409757614136
Epoch: 17, Steps: 208 | Train Loss: 2.546 Vali Loss: 3.879 Vali Acc: 0.086 Test Loss: 3.879 Test Acc: 0.086
Validation loss decreased (-0.084663 --> -0.086153).  Saving model ...
	iters: 100, epoch: 18 | loss: 2.9777229
	speed: 0.3005s/iter; left time: 5157.6725s
	iters: 200, epoch: 18 | loss: 2.7580545
	speed: 0.1119s/iter; left time: 1909.3447s
Epoch: 18 cost time: 23.870238065719604
Epoch: 18, Steps: 208 | Train Loss: 2.344 Vali Loss: 4.056 Vali Acc: 0.086 Test Loss: 4.056 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 2.2433755
	speed: 0.3109s/iter; left time: 5272.5909s
	iters: 200, epoch: 19 | loss: 2.8598397
	speed: 0.1174s/iter; left time: 1979.4140s
Epoch: 19 cost time: 24.464550495147705
Epoch: 19, Steps: 208 | Train Loss: 2.204 Vali Loss: 4.080 Vali Acc: 0.086 Test Loss: 4.080 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 2.2112834
	speed: 0.3019s/iter; left time: 5057.0610s
	iters: 200, epoch: 20 | loss: 2.7036114
	speed: 0.1146s/iter; left time: 1907.4669s
Epoch: 20 cost time: 23.84463930130005
Epoch: 20, Steps: 208 | Train Loss: 2.073 Vali Loss: 4.187 Vali Acc: 0.088 Test Loss: 4.187 Test Acc: 0.088
Validation loss decreased (-0.086153 --> -0.087939).  Saving model ...
	iters: 100, epoch: 21 | loss: 2.3027070
	speed: 0.2985s/iter; left time: 4936.9807s
	iters: 200, epoch: 21 | loss: 2.2013168
	speed: 0.1003s/iter; left time: 1648.7594s
Epoch: 21 cost time: 21.39832043647766
Epoch: 21, Steps: 208 | Train Loss: 1.887 Vali Loss: 4.421 Vali Acc: 0.084 Test Loss: 4.421 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.9121940
	speed: 0.2975s/iter; left time: 4858.3277s
	iters: 200, epoch: 22 | loss: 2.2749753
	speed: 0.1111s/iter; left time: 1802.8511s
Epoch: 22 cost time: 23.393934726715088
Epoch: 22, Steps: 208 | Train Loss: 1.686 Vali Loss: 4.621 Vali Acc: 0.079 Test Loss: 4.621 Test Acc: 0.079
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 1.9924209
	speed: 0.3175s/iter; left time: 5119.0079s
	iters: 200, epoch: 23 | loss: 2.0501246
	speed: 0.1161s/iter; left time: 1860.9393s
Epoch: 23 cost time: 24.666855096817017
Epoch: 23, Steps: 208 | Train Loss: 1.566 Vali Loss: 4.742 Vali Acc: 0.090 Test Loss: 4.742 Test Acc: 0.090
Validation loss decreased (-0.087939 --> -0.089723).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.6347759
	speed: 0.3328s/iter; left time: 5297.9623s
	iters: 200, epoch: 24 | loss: 1.3114471
	speed: 0.1177s/iter; left time: 1861.6770s
Epoch: 24 cost time: 25.048914670944214
Epoch: 24, Steps: 208 | Train Loss: 1.453 Vali Loss: 4.861 Vali Acc: 0.086 Test Loss: 4.861 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.3697226
	speed: 0.3157s/iter; left time: 4959.5294s
	iters: 200, epoch: 25 | loss: 1.2536891
	speed: 0.1138s/iter; left time: 1775.6124s
Epoch: 25 cost time: 23.797173738479614
Epoch: 25, Steps: 208 | Train Loss: 1.365 Vali Loss: 5.134 Vali Acc: 0.084 Test Loss: 5.134 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 1.4565898
	speed: 0.3193s/iter; left time: 4950.0162s
	iters: 200, epoch: 26 | loss: 1.7321228
	speed: 0.1187s/iter; left time: 1828.8403s
Epoch: 26 cost time: 24.51133918762207
Epoch: 26, Steps: 208 | Train Loss: 1.226 Vali Loss: 5.340 Vali Acc: 0.081 Test Loss: 5.340 Test Acc: 0.081
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 1.1068134
	speed: 0.3289s/iter; left time: 5029.4715s
	iters: 200, epoch: 27 | loss: 1.0351424
	speed: 0.1270s/iter; left time: 1929.8262s
Epoch: 27 cost time: 26.550201416015625
Epoch: 27, Steps: 208 | Train Loss: 1.164 Vali Loss: 5.349 Vali Acc: 0.089 Test Loss: 5.349 Test Acc: 0.089
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.7482463
	speed: 0.2847s/iter; left time: 4294.4114s
	iters: 200, epoch: 28 | loss: 1.1837322
	speed: 0.1016s/iter; left time: 1522.5107s
Epoch: 28 cost time: 21.47463059425354
Epoch: 28, Steps: 208 | Train Loss: 1.083 Vali Loss: 5.614 Vali Acc: 0.083 Test Loss: 5.614 Test Acc: 0.083
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 1.6162176
	speed: 0.2890s/iter; left time: 4300.0189s
	iters: 200, epoch: 29 | loss: 0.4685237
	speed: 0.1144s/iter; left time: 1691.0538s
Epoch: 29 cost time: 23.488927364349365
Epoch: 29, Steps: 208 | Train Loss: 1.001 Vali Loss: 5.786 Vali Acc: 0.086 Test Loss: 5.786 Test Acc: 0.086
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.4898801
	speed: 0.2982s/iter; left time: 4374.5421s
	iters: 200, epoch: 30 | loss: 0.7044127
	speed: 0.1103s/iter; left time: 1607.6442s
Epoch: 30 cost time: 23.0425283908844
Epoch: 30, Steps: 208 | Train Loss: 0.941 Vali Loss: 6.035 Vali Acc: 0.085 Test Loss: 6.035 Test Acc: 0.085
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.6321725
	speed: 0.3044s/iter; left time: 4402.2692s
	iters: 200, epoch: 31 | loss: 1.2084079
	speed: 0.1100s/iter; left time: 1579.5223s
Epoch: 31 cost time: 22.816322326660156
Epoch: 31, Steps: 208 | Train Loss: 0.898 Vali Loss: 6.058 Vali Acc: 0.089 Test Loss: 6.058 Test Acc: 0.089
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.8848788
	speed: 0.2985s/iter; left time: 4254.5034s
	iters: 200, epoch: 32 | loss: 1.2195380
	speed: 0.1131s/iter; left time: 1600.9349s
Epoch: 32 cost time: 23.54150891304016
Epoch: 32, Steps: 208 | Train Loss: 0.870 Vali Loss: 6.196 Vali Acc: 0.085 Test Loss: 6.196 Test Acc: 0.085
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.5376695
	speed: 0.2901s/iter; left time: 4074.3710s
	iters: 200, epoch: 33 | loss: 1.1699178
	speed: 0.1116s/iter; left time: 1555.7492s
Epoch: 33 cost time: 23.657564640045166
Epoch: 33, Steps: 208 | Train Loss: 0.817 Vali Loss: 6.447 Vali Acc: 0.086 Test Loss: 6.447 Test Acc: 0.086
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08977035490605428
model parameter : 1559895
model size : 7.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6364384
	speed: 0.1298s/iter; left time: 2686.4489s
	iters: 200, epoch: 1 | loss: 4.0656838
	speed: 0.1097s/iter; left time: 2259.6329s
Epoch: 1 cost time: 24.954962491989136
Epoch: 1, Steps: 208 | Train Loss: 3.756 Vali Loss: 3.638 Vali Acc: 0.045 Test Loss: 3.638 Test Acc: 0.045
Validation loss decreased (inf --> -0.044998).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9320948
	speed: 0.3088s/iter; left time: 6328.9778s
	iters: 200, epoch: 2 | loss: 3.8464458
	speed: 0.1158s/iter; left time: 2362.4987s
Epoch: 2 cost time: 24.483005046844482
Epoch: 2, Steps: 208 | Train Loss: 3.603 Vali Loss: 3.667 Vali Acc: 0.054 Test Loss: 3.667 Test Acc: 0.054
Validation loss decreased (-0.044998 --> -0.053945).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5967293
	speed: 0.2666s/iter; left time: 5408.2940s
	iters: 200, epoch: 3 | loss: 3.5104058
	speed: 0.0864s/iter; left time: 1744.1160s
Epoch: 3 cost time: 18.44404888153076
Epoch: 3, Steps: 208 | Train Loss: 3.539 Vali Loss: 3.505 Vali Acc: 0.069 Test Loss: 3.505 Test Acc: 0.069
Validation loss decreased (-0.053945 --> -0.069157).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.9106343
	speed: 0.2447s/iter; left time: 4912.7695s
	iters: 200, epoch: 4 | loss: 3.4073079
	speed: 0.0877s/iter; left time: 1752.9154s
Epoch: 4 cost time: 18.19087052345276
Epoch: 4, Steps: 208 | Train Loss: 3.469 Vali Loss: 3.503 Vali Acc: 0.072 Test Loss: 3.503 Test Acc: 0.072
Validation loss decreased (-0.069157 --> -0.072437).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3345463
	speed: 0.2952s/iter; left time: 5864.5556s
	iters: 200, epoch: 5 | loss: 3.1567872
	speed: 0.1064s/iter; left time: 2103.5074s
Epoch: 5 cost time: 23.328194856643677
Epoch: 5, Steps: 208 | Train Loss: 3.369 Vali Loss: 3.458 Vali Acc: 0.070 Test Loss: 3.458 Test Acc: 0.070
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.6886942
	speed: 0.3097s/iter; left time: 6089.5795s
	iters: 200, epoch: 6 | loss: 3.7294345
	speed: 0.1107s/iter; left time: 2164.9992s
Epoch: 6 cost time: 24.303569316864014
Epoch: 6, Steps: 208 | Train Loss: 3.261 Vali Loss: 3.262 Vali Acc: 0.087 Test Loss: 3.262 Test Acc: 0.087
Validation loss decreased (-0.072437 --> -0.087352).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.1379268
	speed: 0.3251s/iter; left time: 6324.6248s
	iters: 200, epoch: 7 | loss: 3.1192431
	speed: 0.1127s/iter; left time: 2180.1851s
Epoch: 7 cost time: 24.161116361618042
Epoch: 7, Steps: 208 | Train Loss: 3.136 Vali Loss: 3.272 Vali Acc: 0.101 Test Loss: 3.272 Test Acc: 0.101
Validation loss decreased (-0.087352 --> -0.100474).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.7245450
	speed: 0.3018s/iter; left time: 5808.3919s
	iters: 200, epoch: 8 | loss: 2.5462730
	speed: 0.0865s/iter; left time: 1656.2335s
Epoch: 8 cost time: 20.111770629882812
Epoch: 8, Steps: 208 | Train Loss: 2.992 Vali Loss: 3.275 Vali Acc: 0.102 Test Loss: 3.275 Test Acc: 0.102
Validation loss decreased (-0.100474 --> -0.102264).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.7892027
	speed: 0.2437s/iter; left time: 4638.7699s
	iters: 200, epoch: 9 | loss: 3.1339695
	speed: 0.1099s/iter; left time: 2081.6896s
Epoch: 9 cost time: 20.052306652069092
Epoch: 9, Steps: 208 | Train Loss: 2.863 Vali Loss: 3.180 Vali Acc: 0.107 Test Loss: 3.180 Test Acc: 0.107
Validation loss decreased (-0.102264 --> -0.107037).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.2186511
	speed: 0.2946s/iter; left time: 5547.8946s
	iters: 200, epoch: 10 | loss: 3.5400484
	speed: 0.1022s/iter; left time: 1914.0833s
Epoch: 10 cost time: 22.345102548599243
Epoch: 10, Steps: 208 | Train Loss: 2.661 Vali Loss: 3.228 Vali Acc: 0.119 Test Loss: 3.228 Test Acc: 0.119
Validation loss decreased (-0.107037 --> -0.118966).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.2690508
	speed: 0.2959s/iter; left time: 5509.6458s
	iters: 200, epoch: 11 | loss: 2.5332787
	speed: 0.1033s/iter; left time: 1912.7788s
Epoch: 11 cost time: 22.571155309677124
Epoch: 11, Steps: 208 | Train Loss: 2.463 Vali Loss: 3.535 Vali Acc: 0.114 Test Loss: 3.535 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.3917613
	speed: 0.2974s/iter; left time: 5475.3745s
	iters: 200, epoch: 12 | loss: 2.4197445
	speed: 0.1097s/iter; left time: 2009.1531s
Epoch: 12 cost time: 23.69006061553955
Epoch: 12, Steps: 208 | Train Loss: 2.259 Vali Loss: 3.490 Vali Acc: 0.122 Test Loss: 3.490 Test Acc: 0.122
Validation loss decreased (-0.118966 --> -0.122244).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.4204030
	speed: 0.2829s/iter; left time: 5149.4581s
	iters: 200, epoch: 13 | loss: 1.9552811
	speed: 0.1072s/iter; left time: 1941.4160s
Epoch: 13 cost time: 22.682063817977905
Epoch: 13, Steps: 208 | Train Loss: 2.044 Vali Loss: 3.627 Vali Acc: 0.107 Test Loss: 3.627 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.7633492
	speed: 0.2832s/iter; left time: 5097.2854s
	iters: 200, epoch: 14 | loss: 2.3617711
	speed: 0.1062s/iter; left time: 1900.3847s
Epoch: 14 cost time: 22.116677045822144
Epoch: 14, Steps: 208 | Train Loss: 1.770 Vali Loss: 3.989 Vali Acc: 0.113 Test Loss: 3.989 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.8836811
	speed: 0.2929s/iter; left time: 5209.5344s
	iters: 200, epoch: 15 | loss: 2.1726460
	speed: 0.1107s/iter; left time: 1957.7826s
Epoch: 15 cost time: 23.731096744537354
Epoch: 15, Steps: 208 | Train Loss: 1.611 Vali Loss: 4.100 Vali Acc: 0.107 Test Loss: 4.100 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.2063582
	speed: 0.2755s/iter; left time: 4844.1353s
	iters: 200, epoch: 16 | loss: 1.4957858
	speed: 0.1081s/iter; left time: 1889.2347s
Epoch: 16 cost time: 22.64668583869934
Epoch: 16, Steps: 208 | Train Loss: 1.365 Vali Loss: 4.336 Vali Acc: 0.112 Test Loss: 4.336 Test Acc: 0.112
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.2469820
	speed: 0.2935s/iter; left time: 5099.8258s
	iters: 200, epoch: 17 | loss: 1.2188834
	speed: 0.1069s/iter; left time: 1846.9753s
Epoch: 17 cost time: 22.946948289871216
Epoch: 17, Steps: 208 | Train Loss: 1.217 Vali Loss: 4.655 Vali Acc: 0.106 Test Loss: 4.655 Test Acc: 0.106
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.0428834
	speed: 0.2862s/iter; left time: 4912.5955s
	iters: 200, epoch: 18 | loss: 1.6673884
	speed: 0.1025s/iter; left time: 1748.9355s
Epoch: 18 cost time: 22.161147117614746
Epoch: 18, Steps: 208 | Train Loss: 1.080 Vali Loss: 4.767 Vali Acc: 0.117 Test Loss: 4.767 Test Acc: 0.117
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.2785855
	speed: 0.2866s/iter; left time: 4860.6835s
	iters: 200, epoch: 19 | loss: 0.6505908
	speed: 0.1095s/iter; left time: 1845.4513s
Epoch: 19 cost time: 22.915796279907227
Epoch: 19, Steps: 208 | Train Loss: 0.952 Vali Loss: 4.918 Vali Acc: 0.113 Test Loss: 4.918 Test Acc: 0.113
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.4526889
	speed: 0.2895s/iter; left time: 4848.7776s
	iters: 200, epoch: 20 | loss: 1.2892824
	speed: 0.1133s/iter; left time: 1886.2361s
Epoch: 20 cost time: 23.927234411239624
Epoch: 20, Steps: 208 | Train Loss: 0.858 Vali Loss: 5.189 Vali Acc: 0.110 Test Loss: 5.189 Test Acc: 0.110
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 1.2186360
	speed: 0.3040s/iter; left time: 5028.3903s
	iters: 200, epoch: 21 | loss: 0.8131144
	speed: 0.1207s/iter; left time: 1985.0093s
Epoch: 21 cost time: 25.035967588424683
Epoch: 21, Steps: 208 | Train Loss: 0.803 Vali Loss: 5.718 Vali Acc: 0.111 Test Loss: 5.718 Test Acc: 0.111
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.6583609
	speed: 0.3127s/iter; left time: 5107.7161s
	iters: 200, epoch: 22 | loss: 0.6384467
	speed: 0.1122s/iter; left time: 1821.5626s
Epoch: 22 cost time: 24.105076551437378
Epoch: 22, Steps: 208 | Train Loss: 0.751 Vali Loss: 5.556 Vali Acc: 0.106 Test Loss: 5.556 Test Acc: 0.106
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12227855651655234
model parameter : 1557719
model size : 7.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8091085
	speed: 0.1261s/iter; left time: 2611.1213s
	iters: 200, epoch: 1 | loss: 3.8183951
	speed: 0.1156s/iter; left time: 2382.0808s
Epoch: 1 cost time: 25.194390773773193
Epoch: 1, Steps: 208 | Train Loss: 3.783 Vali Loss: 3.683 Vali Acc: 0.046 Test Loss: 3.683 Test Acc: 0.046
Validation loss decreased (inf --> -0.045892).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4805644
	speed: 0.2886s/iter; left time: 5914.8126s
	iters: 200, epoch: 2 | loss: 3.6595945
	speed: 0.1114s/iter; left time: 2271.5742s
Epoch: 2 cost time: 22.865450859069824
Epoch: 2, Steps: 208 | Train Loss: 3.633 Vali Loss: 3.660 Vali Acc: 0.053 Test Loss: 3.660 Test Acc: 0.053
Validation loss decreased (-0.045892 --> -0.053050).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.2595470
	speed: 0.2971s/iter; left time: 6026.6374s
	iters: 200, epoch: 3 | loss: 3.3400171
	speed: 0.1150s/iter; left time: 2320.4529s
Epoch: 3 cost time: 23.844746351242065
Epoch: 3, Steps: 208 | Train Loss: 3.554 Vali Loss: 3.568 Vali Acc: 0.064 Test Loss: 3.568 Test Acc: 0.064
Validation loss decreased (-0.053050 --> -0.064086).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2874088
	speed: 0.2870s/iter; left time: 5762.7292s
	iters: 200, epoch: 4 | loss: 3.6405807
	speed: 0.1123s/iter; left time: 2243.4343s
Epoch: 4 cost time: 23.52082872390747
Epoch: 4, Steps: 208 | Train Loss: 3.478 Vali Loss: 3.494 Vali Acc: 0.068 Test Loss: 3.494 Test Acc: 0.068
Validation loss decreased (-0.064086 --> -0.067666).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.5685043
	speed: 0.2897s/iter; left time: 5756.5172s
	iters: 200, epoch: 5 | loss: 3.5864403
	speed: 0.1126s/iter; left time: 2225.6117s
Epoch: 5 cost time: 23.385449409484863
Epoch: 5, Steps: 208 | Train Loss: 3.414 Vali Loss: 3.442 Vali Acc: 0.077 Test Loss: 3.442 Test Acc: 0.077
Validation loss decreased (-0.067666 --> -0.076613).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0649130
	speed: 0.2937s/iter; left time: 5774.1839s
	iters: 200, epoch: 6 | loss: 3.4257903
	speed: 0.1138s/iter; left time: 2226.8791s
Epoch: 6 cost time: 23.77620816230774
Epoch: 6, Steps: 208 | Train Loss: 3.286 Vali Loss: 3.302 Vali Acc: 0.088 Test Loss: 3.302 Test Acc: 0.088
Validation loss decreased (-0.076613 --> -0.088246).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9762638
	speed: 0.3003s/iter; left time: 5842.2402s
	iters: 200, epoch: 7 | loss: 3.1266136
	speed: 0.1133s/iter; left time: 2193.2562s
Epoch: 7 cost time: 23.831167459487915
Epoch: 7, Steps: 208 | Train Loss: 3.163 Vali Loss: 3.266 Vali Acc: 0.095 Test Loss: 3.266 Test Acc: 0.095
Validation loss decreased (-0.088246 --> -0.095404).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.5326171
	speed: 0.2941s/iter; left time: 5659.7128s
	iters: 200, epoch: 8 | loss: 2.7139604
	speed: 0.1095s/iter; left time: 2096.9578s
Epoch: 8 cost time: 23.606729984283447
Epoch: 8, Steps: 208 | Train Loss: 3.049 Vali Loss: 3.281 Vali Acc: 0.084 Test Loss: 3.281 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 3.1569369
	speed: 0.3024s/iter; left time: 5756.3888s
	iters: 200, epoch: 9 | loss: 2.4912720
	speed: 0.1084s/iter; left time: 2053.5309s
Epoch: 9 cost time: 23.749672412872314
Epoch: 9, Steps: 208 | Train Loss: 2.891 Vali Loss: 3.242 Vali Acc: 0.105 Test Loss: 3.242 Test Acc: 0.105
Validation loss decreased (-0.095404 --> -0.105246).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.5769489
	speed: 0.2686s/iter; left time: 5056.9091s
	iters: 200, epoch: 10 | loss: 2.6261888
	speed: 0.0866s/iter; left time: 1622.4969s
Epoch: 10 cost time: 18.765036582946777
Epoch: 10, Steps: 208 | Train Loss: 2.718 Vali Loss: 3.251 Vali Acc: 0.105 Test Loss: 3.251 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.8606467
	speed: 0.2817s/iter; left time: 5245.8028s
	iters: 200, epoch: 11 | loss: 2.4630630
	speed: 0.1058s/iter; left time: 1959.9629s
Epoch: 11 cost time: 23.003610134124756
Epoch: 11, Steps: 208 | Train Loss: 2.542 Vali Loss: 3.411 Vali Acc: 0.113 Test Loss: 3.411 Test Acc: 0.113
Validation loss decreased (-0.105246 --> -0.113297).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.7781401
	speed: 0.2997s/iter; left time: 5518.7849s
	iters: 200, epoch: 12 | loss: 2.2377136
	speed: 0.1172s/iter; left time: 2145.4350s
Epoch: 12 cost time: 24.770289421081543
Epoch: 12, Steps: 208 | Train Loss: 2.285 Vali Loss: 3.559 Vali Acc: 0.122 Test Loss: 3.559 Test Acc: 0.122
Validation loss decreased (-0.113297 --> -0.121646).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.1988258
	speed: 0.2683s/iter; left time: 4883.7187s
	iters: 200, epoch: 13 | loss: 1.9847929
	speed: 0.0778s/iter; left time: 1408.6920s
Epoch: 13 cost time: 16.152042388916016
Epoch: 13, Steps: 208 | Train Loss: 2.073 Vali Loss: 3.754 Vali Acc: 0.115 Test Loss: 3.754 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.6191248
	speed: 0.2880s/iter; left time: 5182.9148s
	iters: 200, epoch: 14 | loss: 1.7124158
	speed: 0.1164s/iter; left time: 2082.8771s
Epoch: 14 cost time: 25.09247851371765
Epoch: 14, Steps: 208 | Train Loss: 1.824 Vali Loss: 3.793 Vali Acc: 0.123 Test Loss: 3.793 Test Acc: 0.123
Validation loss decreased (-0.121646 --> -0.123135).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.9413660
	speed: 0.3043s/iter; left time: 5412.7750s
	iters: 200, epoch: 15 | loss: 1.8915776
	speed: 0.1151s/iter; left time: 2036.5336s
Epoch: 15 cost time: 24.109248638153076
Epoch: 15, Steps: 208 | Train Loss: 1.595 Vali Loss: 4.004 Vali Acc: 0.115 Test Loss: 4.004 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 2.1316254
	speed: 0.2901s/iter; left time: 5099.9206s
	iters: 200, epoch: 16 | loss: 2.1796215
	speed: 0.1110s/iter; left time: 1940.2004s
Epoch: 16 cost time: 23.181154012680054
Epoch: 16, Steps: 208 | Train Loss: 1.374 Vali Loss: 4.384 Vali Acc: 0.117 Test Loss: 4.384 Test Acc: 0.117
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.2090820
	speed: 0.2826s/iter; left time: 4909.0061s
	iters: 200, epoch: 17 | loss: 0.9441997
	speed: 0.1053s/iter; left time: 1818.0861s
Epoch: 17 cost time: 22.508094549179077
Epoch: 17, Steps: 208 | Train Loss: 1.211 Vali Loss: 4.568 Vali Acc: 0.112 Test Loss: 4.568 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.4369700
	speed: 0.2920s/iter; left time: 5012.7949s
	iters: 200, epoch: 18 | loss: 1.9579525
	speed: 0.1091s/iter; left time: 1862.4962s
Epoch: 18 cost time: 22.978724241256714
Epoch: 18, Steps: 208 | Train Loss: 1.063 Vali Loss: 4.844 Vali Acc: 0.114 Test Loss: 4.844 Test Acc: 0.114
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.2661431
	speed: 0.2798s/iter; left time: 4744.4267s
	iters: 200, epoch: 19 | loss: 1.1437882
	speed: 0.1121s/iter; left time: 1889.3829s
Epoch: 19 cost time: 23.20299196243286
Epoch: 19, Steps: 208 | Train Loss: 0.912 Vali Loss: 5.105 Vali Acc: 0.115 Test Loss: 5.105 Test Acc: 0.115
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.4839925
	speed: 0.2773s/iter; left time: 4644.8741s
	iters: 200, epoch: 20 | loss: 0.6453182
	speed: 0.1094s/iter; left time: 1820.7800s
Epoch: 20 cost time: 22.479494094848633
Epoch: 20, Steps: 208 | Train Loss: 0.837 Vali Loss: 5.474 Vali Acc: 0.123 Test Loss: 5.474 Test Acc: 0.123
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.5691791
	speed: 0.2920s/iter; left time: 4829.5604s
	iters: 200, epoch: 21 | loss: 0.9074321
	speed: 0.1059s/iter; left time: 1741.1046s
Epoch: 21 cost time: 22.42697262763977
Epoch: 21, Steps: 208 | Train Loss: 0.807 Vali Loss: 5.571 Vali Acc: 0.120 Test Loss: 5.571 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 1.1518019
	speed: 0.2901s/iter; left time: 4737.8356s
	iters: 200, epoch: 22 | loss: 0.5581185
	speed: 0.1061s/iter; left time: 1722.7779s
Epoch: 22 cost time: 23.231046438217163
Epoch: 22, Steps: 208 | Train Loss: 0.748 Vali Loss: 5.669 Vali Acc: 0.112 Test Loss: 5.669 Test Acc: 0.112
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.6596315
	speed: 0.2994s/iter; left time: 4827.7758s
	iters: 200, epoch: 23 | loss: 1.2015537
	speed: 0.1166s/iter; left time: 1869.2330s
Epoch: 23 cost time: 24.411993980407715
Epoch: 23, Steps: 208 | Train Loss: 0.677 Vali Loss: 5.793 Vali Acc: 0.114 Test Loss: 5.793 Test Acc: 0.114
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.3916077
	speed: 0.3015s/iter; left time: 4799.5800s
	iters: 200, epoch: 24 | loss: 1.0557222
	speed: 0.1126s/iter; left time: 1780.3691s
Epoch: 24 cost time: 23.504152059555054
Epoch: 24, Steps: 208 | Train Loss: 0.651 Vali Loss: 5.756 Vali Acc: 0.115 Test Loss: 5.756 Test Acc: 0.115
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12317327766179541
model parameter : 1555543
model size : 7.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9642262
	speed: 0.1259s/iter; left time: 2606.3892s
	iters: 200, epoch: 1 | loss: 4.4326558
	speed: 0.1117s/iter; left time: 2301.6731s
Epoch: 1 cost time: 24.68539571762085
Epoch: 1, Steps: 208 | Train Loss: 3.740 Vali Loss: 3.669 Vali Acc: 0.057 Test Loss: 3.669 Test Acc: 0.057
Validation loss decreased (inf --> -0.056629).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5859017
	speed: 0.2969s/iter; left time: 6085.2317s
	iters: 200, epoch: 2 | loss: 3.9052377
	speed: 0.1151s/iter; left time: 2346.8543s
Epoch: 2 cost time: 24.073405742645264
Epoch: 2, Steps: 208 | Train Loss: 3.698 Vali Loss: 3.621 Vali Acc: 0.052 Test Loss: 3.621 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.4721184
	speed: 0.2982s/iter; left time: 6049.9565s
	iters: 200, epoch: 3 | loss: 3.6771677
	speed: 0.1169s/iter; left time: 2359.4257s
Epoch: 3 cost time: 23.30229949951172
Epoch: 3, Steps: 208 | Train Loss: 3.543 Vali Loss: 3.588 Vali Acc: 0.063 Test Loss: 3.588 Test Acc: 0.063
Validation loss decreased (-0.056629 --> -0.063191).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.0477142
	speed: 0.3078s/iter; left time: 6179.7778s
	iters: 200, epoch: 4 | loss: 3.5627041
	speed: 0.1147s/iter; left time: 2290.4232s
Epoch: 4 cost time: 24.077550649642944
Epoch: 4, Steps: 208 | Train Loss: 3.476 Vali Loss: 3.541 Vali Acc: 0.068 Test Loss: 3.541 Test Acc: 0.068
Validation loss decreased (-0.063191 --> -0.068262).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.4687889
	speed: 0.3064s/iter; left time: 6086.9603s
	iters: 200, epoch: 5 | loss: 3.6179316
	speed: 0.1077s/iter; left time: 2129.6854s
Epoch: 5 cost time: 24.007211208343506
Epoch: 5, Steps: 208 | Train Loss: 3.366 Vali Loss: 3.544 Vali Acc: 0.067 Test Loss: 3.544 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.2301235
	speed: 0.2925s/iter; left time: 5751.4603s
	iters: 200, epoch: 6 | loss: 3.1882584
	speed: 0.1087s/iter; left time: 2125.3887s
Epoch: 6 cost time: 23.198275566101074
Epoch: 6, Steps: 208 | Train Loss: 3.291 Vali Loss: 3.412 Vali Acc: 0.074 Test Loss: 3.412 Test Acc: 0.074
Validation loss decreased (-0.068262 --> -0.073929).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.1335988
	speed: 0.2882s/iter; left time: 5606.8247s
	iters: 200, epoch: 7 | loss: 3.2271225
	speed: 0.1083s/iter; left time: 2095.9853s
Epoch: 7 cost time: 22.623769998550415
Epoch: 7, Steps: 208 | Train Loss: 3.212 Vali Loss: 3.443 Vali Acc: 0.069 Test Loss: 3.443 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.9906919
	speed: 0.2895s/iter; left time: 5570.5011s
	iters: 200, epoch: 8 | loss: 3.5110376
	speed: 0.0989s/iter; left time: 1892.8457s
Epoch: 8 cost time: 22.011543035507202
Epoch: 8, Steps: 208 | Train Loss: 3.143 Vali Loss: 3.306 Vali Acc: 0.088 Test Loss: 3.306 Test Acc: 0.088
Validation loss decreased (-0.073929 --> -0.087650).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.9442859
	speed: 0.2901s/iter; left time: 5523.2556s
	iters: 200, epoch: 9 | loss: 3.5464766
	speed: 0.1073s/iter; left time: 2032.1836s
Epoch: 9 cost time: 22.45262360572815
Epoch: 9, Steps: 208 | Train Loss: 3.045 Vali Loss: 3.319 Vali Acc: 0.090 Test Loss: 3.319 Test Acc: 0.090
Validation loss decreased (-0.087650 --> -0.090035).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.8844082
	speed: 0.2908s/iter; left time: 5476.2241s
	iters: 200, epoch: 10 | loss: 2.8811212
	speed: 0.1022s/iter; left time: 1913.8144s
Epoch: 10 cost time: 22.39066505432129
Epoch: 10, Steps: 208 | Train Loss: 2.982 Vali Loss: 3.271 Vali Acc: 0.101 Test Loss: 3.271 Test Acc: 0.101
Validation loss decreased (-0.090035 --> -0.101071).  Saving model ...
	iters: 100, epoch: 11 | loss: 3.1451564
	speed: 0.2990s/iter; left time: 5567.7729s
	iters: 200, epoch: 11 | loss: 2.5272098
	speed: 0.1125s/iter; left time: 2083.5146s
Epoch: 11 cost time: 23.83479118347168
Epoch: 11, Steps: 208 | Train Loss: 2.819 Vali Loss: 3.293 Vali Acc: 0.105 Test Loss: 3.293 Test Acc: 0.105
Validation loss decreased (-0.101071 --> -0.104649).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.6889026
	speed: 0.2871s/iter; left time: 5286.1662s
	iters: 200, epoch: 12 | loss: 2.7257593
	speed: 0.1069s/iter; left time: 1957.1092s
Epoch: 12 cost time: 22.830421209335327
Epoch: 12, Steps: 208 | Train Loss: 2.652 Vali Loss: 3.373 Vali Acc: 0.113 Test Loss: 3.373 Test Acc: 0.113
Validation loss decreased (-0.104649 --> -0.113298).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.7365654
	speed: 0.2911s/iter; left time: 5299.1629s
	iters: 200, epoch: 13 | loss: 2.4979880
	speed: 0.1065s/iter; left time: 1927.3558s
Epoch: 13 cost time: 22.579995155334473
Epoch: 13, Steps: 208 | Train Loss: 2.496 Vali Loss: 3.460 Vali Acc: 0.104 Test Loss: 3.460 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 2.2041941
	speed: 0.2924s/iter; left time: 5261.4639s
	iters: 200, epoch: 14 | loss: 2.2466803
	speed: 0.1105s/iter; left time: 1977.0225s
Epoch: 14 cost time: 23.569754600524902
Epoch: 14, Steps: 208 | Train Loss: 2.247 Vali Loss: 3.822 Vali Acc: 0.100 Test Loss: 3.822 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.7715235
	speed: 0.2799s/iter; left time: 4979.8057s
	iters: 200, epoch: 15 | loss: 1.6315058
	speed: 0.1083s/iter; left time: 1915.6129s
Epoch: 15 cost time: 22.746068239212036
Epoch: 15, Steps: 208 | Train Loss: 2.016 Vali Loss: 3.785 Vali Acc: 0.111 Test Loss: 3.785 Test Acc: 0.111
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.7116531
	speed: 0.2941s/iter; left time: 5171.4485s
	iters: 200, epoch: 16 | loss: 2.0513446
	speed: 0.0946s/iter; left time: 1654.3505s
Epoch: 16 cost time: 20.682010650634766
Epoch: 16, Steps: 208 | Train Loss: 1.751 Vali Loss: 4.108 Vali Acc: 0.112 Test Loss: 4.108 Test Acc: 0.112
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.8094079
	speed: 0.3118s/iter; left time: 5417.3118s
	iters: 200, epoch: 17 | loss: 2.2032502
	speed: 0.1195s/iter; left time: 2064.7854s
Epoch: 17 cost time: 24.985811233520508
Epoch: 17, Steps: 208 | Train Loss: 1.480 Vali Loss: 4.388 Vali Acc: 0.107 Test Loss: 4.388 Test Acc: 0.107
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.4167311
	speed: 0.3059s/iter; left time: 5251.2913s
	iters: 200, epoch: 18 | loss: 0.9615326
	speed: 0.1108s/iter; left time: 1890.3333s
Epoch: 18 cost time: 23.86039423942566
Epoch: 18, Steps: 208 | Train Loss: 1.300 Vali Loss: 4.597 Vali Acc: 0.106 Test Loss: 4.597 Test Acc: 0.106
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 1.4807632
	speed: 0.3191s/iter; left time: 5410.4113s
	iters: 200, epoch: 19 | loss: 1.2715107
	speed: 0.1094s/iter; left time: 1844.8275s
Epoch: 19 cost time: 23.855648040771484
Epoch: 19, Steps: 208 | Train Loss: 1.103 Vali Loss: 4.982 Vali Acc: 0.105 Test Loss: 4.982 Test Acc: 0.105
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.8190928
	speed: 0.2889s/iter; left time: 4839.3943s
	iters: 200, epoch: 20 | loss: 0.8561127
	speed: 0.1043s/iter; left time: 1737.1373s
Epoch: 20 cost time: 22.652963638305664
Epoch: 20, Steps: 208 | Train Loss: 0.972 Vali Loss: 5.178 Vali Acc: 0.101 Test Loss: 5.178 Test Acc: 0.101
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 1.1196570
	speed: 0.2620s/iter; left time: 4334.0669s
	iters: 200, epoch: 21 | loss: 1.2688124
	speed: 0.0686s/iter; left time: 1128.0167s
Epoch: 21 cost time: 17.164182662963867
Epoch: 21, Steps: 208 | Train Loss: 0.895 Vali Loss: 5.234 Vali Acc: 0.110 Test Loss: 5.234 Test Acc: 0.110
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 1.3956375
	speed: 0.2619s/iter; left time: 4278.0689s
	iters: 200, epoch: 22 | loss: 0.7099720
	speed: 0.1113s/iter; left time: 1806.4759s
Epoch: 22 cost time: 23.011883974075317
Epoch: 22, Steps: 208 | Train Loss: 0.814 Vali Loss: 5.416 Vali Acc: 0.116 Test Loss: 5.416 Test Acc: 0.116
Validation loss decreased (-0.113298 --> -0.115961).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.7950079
	speed: 0.2914s/iter; left time: 4699.0425s
	iters: 200, epoch: 23 | loss: 0.8987271
	speed: 0.1079s/iter; left time: 1729.4975s
Epoch: 23 cost time: 22.696780681610107
Epoch: 23, Steps: 208 | Train Loss: 0.732 Vali Loss: 5.349 Vali Acc: 0.101 Test Loss: 5.349 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.7604076
	speed: 0.2849s/iter; left time: 4534.6840s
	iters: 200, epoch: 24 | loss: 0.5875103
	speed: 0.1058s/iter; left time: 1672.9577s
Epoch: 24 cost time: 22.22605061531067
Epoch: 24, Steps: 208 | Train Loss: 0.716 Vali Loss: 5.738 Vali Acc: 0.107 Test Loss: 5.738 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.9498117
	speed: 0.2901s/iter; left time: 4557.6908s
	iters: 200, epoch: 25 | loss: 0.5700811
	speed: 0.1035s/iter; left time: 1615.5337s
Epoch: 25 cost time: 22.420177936553955
Epoch: 25, Steps: 208 | Train Loss: 0.646 Vali Loss: 5.968 Vali Acc: 0.114 Test Loss: 5.968 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.3959576
	speed: 0.3152s/iter; left time: 4886.0052s
	iters: 200, epoch: 26 | loss: 0.4110562
	speed: 0.1097s/iter; left time: 1688.7326s
Epoch: 26 cost time: 23.019198656082153
Epoch: 26, Steps: 208 | Train Loss: 0.619 Vali Loss: 5.991 Vali Acc: 0.112 Test Loss: 5.991 Test Acc: 0.112
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.6469429
	speed: 0.2899s/iter; left time: 4433.9709s
	iters: 200, epoch: 27 | loss: 0.5043038
	speed: 0.1084s/iter; left time: 1647.6560s
Epoch: 27 cost time: 23.31233048439026
Epoch: 27, Steps: 208 | Train Loss: 0.583 Vali Loss: 6.233 Vali Acc: 0.103 Test Loss: 6.233 Test Acc: 0.103
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.4097464
	speed: 0.2863s/iter; left time: 4318.1819s
	iters: 200, epoch: 28 | loss: 0.3853885
	speed: 0.1070s/iter; left time: 1603.4113s
Epoch: 28 cost time: 23.09482216835022
Epoch: 28, Steps: 208 | Train Loss: 0.574 Vali Loss: 6.448 Vali Acc: 0.106 Test Loss: 6.448 Test Acc: 0.106
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.4411099
	speed: 0.2815s/iter; left time: 4187.8856s
	iters: 200, epoch: 29 | loss: 0.2445479
	speed: 0.1136s/iter; left time: 1679.2984s
Epoch: 29 cost time: 23.12110710144043
Epoch: 29, Steps: 208 | Train Loss: 0.518 Vali Loss: 6.561 Vali Acc: 0.107 Test Loss: 6.561 Test Acc: 0.107
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.1830985
	speed: 0.3022s/iter; left time: 4432.4326s
	iters: 200, epoch: 30 | loss: 0.6454496
	speed: 0.1157s/iter; left time: 1685.4071s
Epoch: 30 cost time: 23.803527355194092
Epoch: 30, Steps: 208 | Train Loss: 0.508 Vali Loss: 6.339 Vali Acc: 0.104 Test Loss: 6.339 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.4006864
	speed: 0.3062s/iter; left time: 4427.4035s
	iters: 200, epoch: 31 | loss: 0.4645470
	speed: 0.1088s/iter; left time: 1562.1856s
Epoch: 31 cost time: 23.967670917510986
Epoch: 31, Steps: 208 | Train Loss: 0.489 Vali Loss: 6.696 Vali Acc: 0.107 Test Loss: 6.696 Test Acc: 0.107
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.2106986
	speed: 0.3109s/iter; left time: 4431.8727s
	iters: 200, epoch: 32 | loss: 0.2672106
	speed: 0.1197s/iter; left time: 1694.6491s
Epoch: 32 cost time: 24.95321035385132
Epoch: 32, Steps: 208 | Train Loss: 0.475 Vali Loss: 6.894 Vali Acc: 0.101 Test Loss: 6.894 Test Acc: 0.101
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11601550849985089
model parameter : 1553367
model size : 7.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8784354
	speed: 0.1200s/iter; left time: 2484.7442s
	iters: 200, epoch: 1 | loss: 3.5592003
	speed: 0.1132s/iter; left time: 2332.7059s
Epoch: 1 cost time: 24.319007873535156
Epoch: 1, Steps: 208 | Train Loss: 3.761 Vali Loss: 3.814 Vali Acc: 0.042 Test Loss: 3.814 Test Acc: 0.042
Validation loss decreased (inf --> -0.042014).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5328295
	speed: 0.2881s/iter; left time: 5903.9012s
	iters: 200, epoch: 2 | loss: 3.5544317
	speed: 0.1044s/iter; left time: 2128.0417s
Epoch: 2 cost time: 22.47858715057373
Epoch: 2, Steps: 208 | Train Loss: 3.644 Vali Loss: 3.595 Vali Acc: 0.052 Test Loss: 3.595 Test Acc: 0.052
Validation loss decreased (-0.042014 --> -0.052156).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3509483
	speed: 0.2940s/iter; left time: 5964.5758s
	iters: 200, epoch: 3 | loss: 3.3156443
	speed: 0.1021s/iter; left time: 2061.0264s
Epoch: 3 cost time: 22.550607204437256
Epoch: 3, Steps: 208 | Train Loss: 3.535 Vali Loss: 3.536 Vali Acc: 0.066 Test Loss: 3.536 Test Acc: 0.066
Validation loss decreased (-0.052156 --> -0.066174).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.6743546
	speed: 0.2888s/iter; left time: 5799.0167s
	iters: 200, epoch: 4 | loss: 3.2596960
	speed: 0.1154s/iter; left time: 2304.6541s
Epoch: 4 cost time: 24.02912473678589
Epoch: 4, Steps: 208 | Train Loss: 3.476 Vali Loss: 3.525 Vali Acc: 0.065 Test Loss: 3.525 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.3498487
	speed: 0.2921s/iter; left time: 5803.9132s
	iters: 200, epoch: 5 | loss: 3.6546257
	speed: 0.1095s/iter; left time: 2164.8211s
Epoch: 5 cost time: 23.389531135559082
Epoch: 5, Steps: 208 | Train Loss: 3.360 Vali Loss: 3.402 Vali Acc: 0.068 Test Loss: 3.402 Test Acc: 0.068
Validation loss decreased (-0.066174 --> -0.067667).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0680327
	speed: 0.2892s/iter; left time: 5685.7529s
	iters: 200, epoch: 6 | loss: 3.2629008
	speed: 0.1097s/iter; left time: 2146.3817s
Epoch: 6 cost time: 23.17032766342163
Epoch: 6, Steps: 208 | Train Loss: 3.201 Vali Loss: 3.219 Vali Acc: 0.089 Test Loss: 3.219 Test Acc: 0.089
Validation loss decreased (-0.067667 --> -0.088843).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.6894608
	speed: 0.2885s/iter; left time: 5611.5225s
	iters: 200, epoch: 7 | loss: 2.8301127
	speed: 0.1077s/iter; left time: 2083.6708s
Epoch: 7 cost time: 22.87977647781372
Epoch: 7, Steps: 208 | Train Loss: 3.051 Vali Loss: 3.248 Vali Acc: 0.098 Test Loss: 3.248 Test Acc: 0.098
Validation loss decreased (-0.088843 --> -0.097790).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.9738960
	speed: 0.2909s/iter; left time: 5598.5208s
	iters: 200, epoch: 8 | loss: 3.0734539
	speed: 0.1095s/iter; left time: 2095.9282s
Epoch: 8 cost time: 23.000014066696167
Epoch: 8, Steps: 208 | Train Loss: 2.928 Vali Loss: 3.190 Vali Acc: 0.118 Test Loss: 3.190 Test Acc: 0.118
Validation loss decreased (-0.097790 --> -0.118071).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.5688438
	speed: 0.2901s/iter; left time: 5522.3490s
	iters: 200, epoch: 9 | loss: 2.8680024
	speed: 0.1052s/iter; left time: 1992.5423s
Epoch: 9 cost time: 22.851824045181274
Epoch: 9, Steps: 208 | Train Loss: 2.757 Vali Loss: 3.201 Vali Acc: 0.106 Test Loss: 3.201 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.6955822
	speed: 0.2982s/iter; left time: 5615.2419s
	iters: 200, epoch: 10 | loss: 3.1035843
	speed: 0.1119s/iter; left time: 2095.3942s
Epoch: 10 cost time: 23.614254236221313
Epoch: 10, Steps: 208 | Train Loss: 2.554 Vali Loss: 3.275 Vali Acc: 0.121 Test Loss: 3.275 Test Acc: 0.121
Validation loss decreased (-0.118071 --> -0.121351).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.3955412
	speed: 0.2930s/iter; left time: 5456.2688s
	iters: 200, epoch: 11 | loss: 2.6325424
	speed: 0.1181s/iter; left time: 2187.9509s
Epoch: 11 cost time: 24.662988662719727
Epoch: 11, Steps: 208 | Train Loss: 2.315 Vali Loss: 3.285 Vali Acc: 0.117 Test Loss: 3.285 Test Acc: 0.117
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.8045306
	speed: 0.3066s/iter; left time: 5644.8013s
	iters: 200, epoch: 12 | loss: 2.4236622
	speed: 0.1132s/iter; left time: 2073.5913s
Epoch: 12 cost time: 24.15302014350891
Epoch: 12, Steps: 208 | Train Loss: 2.046 Vali Loss: 3.514 Vali Acc: 0.130 Test Loss: 3.514 Test Acc: 0.130
Validation loss decreased (-0.121351 --> -0.129998).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.4550574
	speed: 0.3136s/iter; left time: 5709.4087s
	iters: 200, epoch: 13 | loss: 2.1300344
	speed: 0.0944s/iter; left time: 1709.5218s
Epoch: 13 cost time: 22.50162982940674
Epoch: 13, Steps: 208 | Train Loss: 1.756 Vali Loss: 3.874 Vali Acc: 0.126 Test Loss: 3.874 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.7420611
	speed: 0.2924s/iter; left time: 5262.8374s
	iters: 200, epoch: 14 | loss: 1.3690932
	speed: 0.1174s/iter; left time: 2101.9372s
Epoch: 14 cost time: 25.17164945602417
Epoch: 14, Steps: 208 | Train Loss: 1.487 Vali Loss: 4.304 Vali Acc: 0.120 Test Loss: 4.304 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.3861974
	speed: 0.2872s/iter; left time: 5108.3520s
	iters: 200, epoch: 15 | loss: 1.5034096
	speed: 0.1051s/iter; left time: 1859.9012s
Epoch: 15 cost time: 22.809406757354736
Epoch: 15, Steps: 208 | Train Loss: 1.264 Vali Loss: 4.350 Vali Acc: 0.118 Test Loss: 4.350 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.2320530
	speed: 0.2910s/iter; left time: 5116.6848s
	iters: 200, epoch: 16 | loss: 1.4593740
	speed: 0.1050s/iter; left time: 1835.3252s
Epoch: 16 cost time: 22.98668074607849
Epoch: 16, Steps: 208 | Train Loss: 1.068 Vali Loss: 4.640 Vali Acc: 0.132 Test Loss: 4.640 Test Acc: 0.132
Validation loss decreased (-0.129998 --> -0.132074).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.7040145
	speed: 0.2867s/iter; left time: 4980.7869s
	iters: 200, epoch: 17 | loss: 1.2954760
	speed: 0.1096s/iter; left time: 1892.7859s
Epoch: 17 cost time: 23.14330530166626
Epoch: 17, Steps: 208 | Train Loss: 0.941 Vali Loss: 4.876 Vali Acc: 0.124 Test Loss: 4.876 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.9932787
	speed: 0.2800s/iter; left time: 4805.4075s
	iters: 200, epoch: 18 | loss: 0.8128622
	speed: 0.1031s/iter; left time: 1759.4015s
Epoch: 18 cost time: 21.744224309921265
Epoch: 18, Steps: 208 | Train Loss: 0.833 Vali Loss: 4.969 Vali Acc: 0.124 Test Loss: 4.969 Test Acc: 0.124
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.4251141
	speed: 0.2921s/iter; left time: 4953.7915s
	iters: 200, epoch: 19 | loss: 0.9756168
	speed: 0.0983s/iter; left time: 1657.4708s
Epoch: 19 cost time: 21.643579483032227
Epoch: 19, Steps: 208 | Train Loss: 0.750 Vali Loss: 5.331 Vali Acc: 0.120 Test Loss: 5.331 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.8274341
	speed: 0.2370s/iter; left time: 3970.2527s
	iters: 200, epoch: 20 | loss: 0.7355986
	speed: 0.0845s/iter; left time: 1407.6270s
Epoch: 20 cost time: 16.836410760879517
Epoch: 20, Steps: 208 | Train Loss: 0.711 Vali Loss: 5.782 Vali Acc: 0.117 Test Loss: 5.782 Test Acc: 0.117
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.3483507
	speed: 0.2892s/iter; left time: 4783.7133s
	iters: 200, epoch: 21 | loss: 0.7711656
	speed: 0.1111s/iter; left time: 1827.2036s
Epoch: 21 cost time: 23.155747175216675
Epoch: 21, Steps: 208 | Train Loss: 0.637 Vali Loss: 6.023 Vali Acc: 0.120 Test Loss: 6.023 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.4468002
	speed: 0.2866s/iter; left time: 4681.0611s
	iters: 200, epoch: 22 | loss: 0.6741834
	speed: 0.1077s/iter; left time: 1748.7507s
Epoch: 22 cost time: 22.88775634765625
Epoch: 22, Steps: 208 | Train Loss: 0.635 Vali Loss: 5.913 Vali Acc: 0.117 Test Loss: 5.913 Test Acc: 0.117
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.3120686
	speed: 0.2831s/iter; left time: 4564.9746s
	iters: 200, epoch: 23 | loss: 0.1831439
	speed: 0.1081s/iter; left time: 1731.7386s
Epoch: 23 cost time: 22.52393913269043
Epoch: 23, Steps: 208 | Train Loss: 0.558 Vali Loss: 6.230 Vali Acc: 0.120 Test Loss: 6.230 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.4311146
	speed: 0.2900s/iter; left time: 4615.6601s
	iters: 200, epoch: 24 | loss: 0.7810864
	speed: 0.1112s/iter; left time: 1759.0403s
Epoch: 24 cost time: 22.867953777313232
Epoch: 24, Steps: 208 | Train Loss: 0.548 Vali Loss: 6.262 Vali Acc: 0.119 Test Loss: 6.262 Test Acc: 0.119
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.1710405
	speed: 0.2999s/iter; left time: 4710.5414s
	iters: 200, epoch: 25 | loss: 0.5655157
	speed: 0.1034s/iter; left time: 1613.2548s
Epoch: 25 cost time: 23.643696784973145
Epoch: 25, Steps: 208 | Train Loss: 0.509 Vali Loss: 6.271 Vali Acc: 0.115 Test Loss: 6.271 Test Acc: 0.115
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.4759586
	speed: 0.3175s/iter; left time: 4922.0618s
	iters: 200, epoch: 26 | loss: 0.6079751
	speed: 0.1095s/iter; left time: 1686.1511s
Epoch: 26 cost time: 23.863054990768433
Epoch: 26, Steps: 208 | Train Loss: 0.499 Vali Loss: 6.541 Vali Acc: 0.119 Test Loss: 6.541 Test Acc: 0.119
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13212048911422605
model parameter : 1097559
model size : 5.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1647325
	speed: 0.1345s/iter; left time: 2785.2911s
	iters: 200, epoch: 1 | loss: 3.9925261
	speed: 0.1176s/iter; left time: 2423.2380s
Epoch: 1 cost time: 26.308921575546265
Epoch: 1, Steps: 208 | Train Loss: 3.772 Vali Loss: 3.761 Vali Acc: 0.058 Test Loss: 3.761 Test Acc: 0.058
Validation loss decreased (inf --> -0.058119).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7392812
	speed: 0.2939s/iter; left time: 6023.2967s
	iters: 200, epoch: 2 | loss: 3.6875474
	speed: 0.0966s/iter; left time: 1969.8146s
Epoch: 2 cost time: 21.483229160308838
Epoch: 2, Steps: 208 | Train Loss: 3.675 Vali Loss: 3.720 Vali Acc: 0.066 Test Loss: 3.720 Test Acc: 0.066
Validation loss decreased (-0.058119 --> -0.066172).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.2272017
	speed: 0.2916s/iter; left time: 5914.2746s
	iters: 200, epoch: 3 | loss: 3.6505172
	speed: 0.1029s/iter; left time: 2077.3948s
Epoch: 3 cost time: 22.253563404083252
Epoch: 3, Steps: 208 | Train Loss: 3.560 Vali Loss: 3.536 Vali Acc: 0.063 Test Loss: 3.536 Test Acc: 0.063
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.5252056
	speed: 0.2897s/iter; left time: 5815.5317s
	iters: 200, epoch: 4 | loss: 3.1927943
	speed: 0.1102s/iter; left time: 2201.4871s
Epoch: 4 cost time: 22.853034734725952
Epoch: 4, Steps: 208 | Train Loss: 3.455 Vali Loss: 3.502 Vali Acc: 0.071 Test Loss: 3.502 Test Acc: 0.071
Validation loss decreased (-0.066172 --> -0.071244).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3160169
	speed: 0.2837s/iter; left time: 5637.4007s
	iters: 200, epoch: 5 | loss: 3.3181579
	speed: 0.1092s/iter; left time: 2158.9141s
Epoch: 5 cost time: 23.164565563201904
Epoch: 5, Steps: 208 | Train Loss: 3.353 Vali Loss: 3.424 Vali Acc: 0.080 Test Loss: 3.424 Test Acc: 0.080
Validation loss decreased (-0.071244 --> -0.080192).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0643284
	speed: 0.2783s/iter; left time: 5471.7225s
	iters: 200, epoch: 6 | loss: 3.2427492
	speed: 0.1029s/iter; left time: 2012.9925s
Epoch: 6 cost time: 21.33650302886963
Epoch: 6, Steps: 208 | Train Loss: 3.190 Vali Loss: 3.386 Vali Acc: 0.083 Test Loss: 3.386 Test Acc: 0.083
Validation loss decreased (-0.080192 --> -0.082579).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.8127902
	speed: 0.2806s/iter; left time: 5458.0735s
	iters: 200, epoch: 7 | loss: 2.9772763
	speed: 0.1092s/iter; left time: 2113.1923s
Epoch: 7 cost time: 22.178248405456543
Epoch: 7, Steps: 208 | Train Loss: 3.057 Vali Loss: 3.301 Vali Acc: 0.101 Test Loss: 3.301 Test Acc: 0.101
Validation loss decreased (-0.082579 --> -0.101369).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.8903484
	speed: 0.2895s/iter; left time: 5570.7998s
	iters: 200, epoch: 8 | loss: 3.2904158
	speed: 0.1065s/iter; left time: 2038.0359s
Epoch: 8 cost time: 22.833247661590576
Epoch: 8, Steps: 208 | Train Loss: 2.915 Vali Loss: 3.335 Vali Acc: 0.097 Test Loss: 3.335 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.7089021
	speed: 0.2947s/iter; left time: 5611.1437s
	iters: 200, epoch: 9 | loss: 2.8160107
	speed: 0.1076s/iter; left time: 2037.8050s
Epoch: 9 cost time: 22.446696281433105
Epoch: 9, Steps: 208 | Train Loss: 2.724 Vali Loss: 3.421 Vali Acc: 0.105 Test Loss: 3.421 Test Acc: 0.105
Validation loss decreased (-0.101369 --> -0.105245).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.2032840
	speed: 0.2919s/iter; left time: 5496.6583s
	iters: 200, epoch: 10 | loss: 2.4276662
	speed: 0.1079s/iter; left time: 2020.3680s
Epoch: 10 cost time: 22.658576250076294
Epoch: 10, Steps: 208 | Train Loss: 2.469 Vali Loss: 3.409 Vali Acc: 0.113 Test Loss: 3.409 Test Acc: 0.113
Validation loss decreased (-0.105245 --> -0.113297).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.5110734
	speed: 0.2928s/iter; left time: 5452.0678s
	iters: 200, epoch: 11 | loss: 2.0618985
	speed: 0.1107s/iter; left time: 2049.9864s
Epoch: 11 cost time: 23.403602361679077
Epoch: 11, Steps: 208 | Train Loss: 2.204 Vali Loss: 3.605 Vali Acc: 0.106 Test Loss: 3.605 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.8270887
	speed: 0.2805s/iter; left time: 5164.1804s
	iters: 200, epoch: 12 | loss: 2.4469509
	speed: 0.1099s/iter; left time: 2011.9061s
Epoch: 12 cost time: 23.201287984848022
Epoch: 12, Steps: 208 | Train Loss: 1.922 Vali Loss: 3.807 Vali Acc: 0.117 Test Loss: 3.807 Test Acc: 0.117
Validation loss decreased (-0.113297 --> -0.116872).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.7698538
	speed: 0.3054s/iter; left time: 5559.8568s
	iters: 200, epoch: 13 | loss: 2.0855277
	speed: 0.1118s/iter; left time: 2023.8676s
Epoch: 13 cost time: 23.639989614486694
Epoch: 13, Steps: 208 | Train Loss: 1.611 Vali Loss: 3.977 Vali Acc: 0.104 Test Loss: 3.977 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.3387668
	speed: 0.3198s/iter; left time: 5754.9294s
	iters: 200, epoch: 14 | loss: 1.5773706
	speed: 0.1145s/iter; left time: 2049.0350s
Epoch: 14 cost time: 25.022985219955444
Epoch: 14, Steps: 208 | Train Loss: 1.334 Vali Loss: 4.288 Vali Acc: 0.123 Test Loss: 4.288 Test Acc: 0.123
Validation loss decreased (-0.116872 --> -0.123429).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.2232171
	speed: 0.3118s/iter; left time: 5545.7618s
	iters: 200, epoch: 15 | loss: 1.3299525
	speed: 0.1139s/iter; left time: 2015.0408s
Epoch: 15 cost time: 24.374953746795654
Epoch: 15, Steps: 208 | Train Loss: 1.137 Vali Loss: 4.488 Vali Acc: 0.129 Test Loss: 4.488 Test Acc: 0.129
Validation loss decreased (-0.123429 --> -0.129093).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.1404867
	speed: 0.3144s/iter; left time: 5526.9277s
	iters: 200, epoch: 16 | loss: 0.8106443
	speed: 0.0995s/iter; left time: 1740.1261s
Epoch: 16 cost time: 22.66122555732727
Epoch: 16, Steps: 208 | Train Loss: 0.962 Vali Loss: 4.872 Vali Acc: 0.109 Test Loss: 4.872 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.0704708
	speed: 0.2525s/iter; left time: 4386.2295s
	iters: 200, epoch: 17 | loss: 0.6341093
	speed: 0.0839s/iter; left time: 1449.7922s
Epoch: 17 cost time: 18.239551782608032
Epoch: 17, Steps: 208 | Train Loss: 0.824 Vali Loss: 5.130 Vali Acc: 0.110 Test Loss: 5.130 Test Acc: 0.110
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.3817717
	speed: 0.2726s/iter; left time: 4679.3321s
	iters: 200, epoch: 18 | loss: 0.5372996
	speed: 0.1042s/iter; left time: 1778.6455s
Epoch: 18 cost time: 22.61953091621399
Epoch: 18, Steps: 208 | Train Loss: 0.726 Vali Loss: 5.141 Vali Acc: 0.112 Test Loss: 5.141 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.9648415
	speed: 0.2733s/iter; left time: 4634.0479s
	iters: 200, epoch: 19 | loss: 0.6389717
	speed: 0.0699s/iter; left time: 1178.9454s
Epoch: 19 cost time: 17.76913619041443
Epoch: 19, Steps: 208 | Train Loss: 0.657 Vali Loss: 5.803 Vali Acc: 0.119 Test Loss: 5.803 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.6063834
	speed: 0.2335s/iter; left time: 3910.8605s
	iters: 200, epoch: 20 | loss: 0.3825489
	speed: 0.1021s/iter; left time: 1699.6761s
Epoch: 20 cost time: 18.45973801612854
Epoch: 20, Steps: 208 | Train Loss: 0.614 Vali Loss: 5.670 Vali Acc: 0.118 Test Loss: 5.670 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.4880062
	speed: 0.2730s/iter; left time: 4516.2824s
	iters: 200, epoch: 21 | loss: 0.1490156
	speed: 0.0967s/iter; left time: 1589.2526s
Epoch: 21 cost time: 21.52342915534973
Epoch: 21, Steps: 208 | Train Loss: 0.558 Vali Loss: 5.918 Vali Acc: 0.117 Test Loss: 5.918 Test Acc: 0.117
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.6472244
	speed: 0.2858s/iter; left time: 4668.4696s
	iters: 200, epoch: 22 | loss: 0.4452536
	speed: 0.0970s/iter; left time: 1575.2751s
Epoch: 22 cost time: 21.799951791763306
Epoch: 22, Steps: 208 | Train Loss: 0.505 Vali Loss: 6.257 Vali Acc: 0.119 Test Loss: 6.257 Test Acc: 0.119
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.4198610
	speed: 0.2785s/iter; left time: 4490.9281s
	iters: 200, epoch: 23 | loss: 0.2200786
	speed: 0.1027s/iter; left time: 1645.4393s
Epoch: 23 cost time: 21.980915307998657
Epoch: 23, Steps: 208 | Train Loss: 0.490 Vali Loss: 6.319 Vali Acc: 0.110 Test Loss: 6.319 Test Acc: 0.110
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.2443461
	speed: 0.2850s/iter; left time: 4536.4253s
	iters: 200, epoch: 24 | loss: 0.7312936
	speed: 0.1065s/iter; left time: 1684.5934s
Epoch: 24 cost time: 22.90789270401001
Epoch: 24, Steps: 208 | Train Loss: 0.438 Vali Loss: 6.588 Vali Acc: 0.120 Test Loss: 6.588 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.1644965
	speed: 0.2683s/iter; left time: 4215.0570s
	iters: 200, epoch: 25 | loss: 0.2140488
	speed: 0.1051s/iter; left time: 1640.8861s
Epoch: 25 cost time: 21.694998025894165
Epoch: 25, Steps: 208 | Train Loss: 0.449 Vali Loss: 6.593 Vali Acc: 0.116 Test Loss: 6.593 Test Acc: 0.116
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12913808529674917
model parameter : 1095383
model size : 5.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8343108
	speed: 0.1322s/iter; left time: 2736.7603s
	iters: 200, epoch: 1 | loss: 3.6830895
	speed: 0.1103s/iter; left time: 2272.9608s
Epoch: 1 cost time: 25.258418798446655
Epoch: 1, Steps: 208 | Train Loss: 3.764 Vali Loss: 3.891 Vali Acc: 0.041 Test Loss: 3.891 Test Acc: 0.041
Validation loss decreased (inf --> -0.041118).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.0493555
	speed: 0.3082s/iter; left time: 6315.5284s
	iters: 200, epoch: 2 | loss: 3.6193535
	speed: 0.1155s/iter; left time: 2354.8818s
Epoch: 2 cost time: 25.115591287612915
Epoch: 2, Steps: 208 | Train Loss: 3.654 Vali Loss: 3.542 Vali Acc: 0.060 Test Loss: 3.542 Test Acc: 0.060
Validation loss decreased (-0.041118 --> -0.060209).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.8762128
	speed: 0.3033s/iter; left time: 6153.1711s
	iters: 200, epoch: 3 | loss: 3.5214341
	speed: 0.1123s/iter; left time: 2266.3605s
Epoch: 3 cost time: 23.629912614822388
Epoch: 3, Steps: 208 | Train Loss: 3.543 Vali Loss: 3.536 Vali Acc: 0.055 Test Loss: 3.536 Test Acc: 0.055
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.4902434
	speed: 0.2868s/iter; left time: 5757.9907s
	iters: 200, epoch: 4 | loss: 3.2949762
	speed: 0.1007s/iter; left time: 2011.9286s
Epoch: 4 cost time: 22.12325358390808
Epoch: 4, Steps: 208 | Train Loss: 3.469 Vali Loss: 3.511 Vali Acc: 0.064 Test Loss: 3.511 Test Acc: 0.064
Validation loss decreased (-0.060209 --> -0.063788).  Saving model ...
	iters: 100, epoch: 5 | loss: 4.1561456
	speed: 0.2865s/iter; left time: 5693.1070s
	iters: 200, epoch: 5 | loss: 3.0023468
	speed: 0.1088s/iter; left time: 2150.7812s
Epoch: 5 cost time: 23.089683055877686
Epoch: 5, Steps: 208 | Train Loss: 3.346 Vali Loss: 3.328 Vali Acc: 0.083 Test Loss: 3.328 Test Acc: 0.083
Validation loss decreased (-0.063788 --> -0.082878).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2079349
	speed: 0.2908s/iter; left time: 5716.4857s
	iters: 200, epoch: 6 | loss: 3.2633474
	speed: 0.1008s/iter; left time: 1971.7521s
Epoch: 6 cost time: 22.223777532577515
Epoch: 6, Steps: 208 | Train Loss: 3.206 Vali Loss: 3.263 Vali Acc: 0.100 Test Loss: 3.263 Test Acc: 0.100
Validation loss decreased (-0.082878 --> -0.099580).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.0440080
	speed: 0.2831s/iter; left time: 5507.4480s
	iters: 200, epoch: 7 | loss: 3.2120857
	speed: 0.1103s/iter; left time: 2135.2509s
Epoch: 7 cost time: 22.87003493309021
Epoch: 7, Steps: 208 | Train Loss: 3.059 Vali Loss: 3.205 Vali Acc: 0.104 Test Loss: 3.205 Test Acc: 0.104
Validation loss decreased (-0.099580 --> -0.103756).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.2001085
	speed: 0.3105s/iter; left time: 5976.1197s
	iters: 200, epoch: 8 | loss: 3.2474389
	speed: 0.1140s/iter; left time: 2182.5755s
Epoch: 8 cost time: 24.212949514389038
Epoch: 8, Steps: 208 | Train Loss: 2.901 Vali Loss: 3.176 Vali Acc: 0.107 Test Loss: 3.176 Test Acc: 0.107
Validation loss decreased (-0.103756 --> -0.107037).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.0829263
	speed: 0.3086s/iter; left time: 5875.7095s
	iters: 200, epoch: 9 | loss: 2.8488595
	speed: 0.1107s/iter; left time: 2096.3781s
Epoch: 9 cost time: 24.16785740852356
Epoch: 9, Steps: 208 | Train Loss: 2.742 Vali Loss: 3.334 Vali Acc: 0.120 Test Loss: 3.334 Test Acc: 0.120
Validation loss decreased (-0.107037 --> -0.119859).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.3790181
	speed: 0.2867s/iter; left time: 5398.8779s
	iters: 200, epoch: 10 | loss: 2.8480487
	speed: 0.1052s/iter; left time: 1971.0767s
Epoch: 10 cost time: 22.580528259277344
Epoch: 10, Steps: 208 | Train Loss: 2.521 Vali Loss: 3.343 Vali Acc: 0.119 Test Loss: 3.343 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.1554410
	speed: 0.3006s/iter; left time: 5597.8900s
	iters: 200, epoch: 11 | loss: 2.4579926
	speed: 0.1118s/iter; left time: 2070.9496s
Epoch: 11 cost time: 23.224957704544067
Epoch: 11, Steps: 208 | Train Loss: 2.284 Vali Loss: 3.536 Vali Acc: 0.121 Test Loss: 3.536 Test Acc: 0.121
Validation loss decreased (-0.119859 --> -0.121050).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.8972274
	speed: 0.2870s/iter; left time: 5285.0334s
	iters: 200, epoch: 12 | loss: 1.9139845
	speed: 0.1040s/iter; left time: 1904.4908s
Epoch: 12 cost time: 22.593968629837036
Epoch: 12, Steps: 208 | Train Loss: 2.017 Vali Loss: 3.711 Vali Acc: 0.126 Test Loss: 3.711 Test Acc: 0.126
Validation loss decreased (-0.121050 --> -0.126119).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.9094230
	speed: 0.2994s/iter; left time: 5450.3033s
	iters: 200, epoch: 13 | loss: 1.8527822
	speed: 0.1148s/iter; left time: 2078.6342s
Epoch: 13 cost time: 23.96426796913147
Epoch: 13, Steps: 208 | Train Loss: 1.741 Vali Loss: 3.936 Vali Acc: 0.126 Test Loss: 3.936 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.1240833
	speed: 0.3426s/iter; left time: 6165.4908s
	iters: 200, epoch: 14 | loss: 1.7414231
	speed: 0.1300s/iter; left time: 2326.2472s
Epoch: 14 cost time: 27.455004692077637
Epoch: 14, Steps: 208 | Train Loss: 1.550 Vali Loss: 4.241 Vali Acc: 0.116 Test Loss: 4.241 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.2076523
	speed: 0.3258s/iter; left time: 5795.0368s
	iters: 200, epoch: 15 | loss: 1.2472061
	speed: 0.1242s/iter; left time: 2197.8368s
Epoch: 15 cost time: 25.434058666229248
Epoch: 15, Steps: 208 | Train Loss: 1.306 Vali Loss: 4.522 Vali Acc: 0.120 Test Loss: 4.522 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.3064178
	speed: 0.3274s/iter; left time: 5756.4882s
	iters: 200, epoch: 16 | loss: 0.4778138
	speed: 0.1247s/iter; left time: 2180.6805s
Epoch: 16 cost time: 26.04037857055664
Epoch: 16, Steps: 208 | Train Loss: 1.140 Vali Loss: 4.776 Vali Acc: 0.119 Test Loss: 4.776 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.4890152
	speed: 0.3383s/iter; left time: 5876.8472s
	iters: 200, epoch: 17 | loss: 1.2953614
	speed: 0.1169s/iter; left time: 2018.4305s
Epoch: 17 cost time: 25.428943157196045
Epoch: 17, Steps: 208 | Train Loss: 0.986 Vali Loss: 4.994 Vali Acc: 0.122 Test Loss: 4.994 Test Acc: 0.122
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.5423512
	speed: 0.3179s/iter; left time: 5457.4835s
	iters: 200, epoch: 18 | loss: 1.0579810
	speed: 0.1179s/iter; left time: 2012.6247s
Epoch: 18 cost time: 25.14813780784607
Epoch: 18, Steps: 208 | Train Loss: 0.886 Vali Loss: 5.118 Vali Acc: 0.119 Test Loss: 5.118 Test Acc: 0.119
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.9313543
	speed: 0.3110s/iter; left time: 5272.7961s
	iters: 200, epoch: 19 | loss: 0.3715898
	speed: 0.1104s/iter; left time: 1861.5237s
Epoch: 19 cost time: 23.740312576293945
Epoch: 19, Steps: 208 | Train Loss: 0.838 Vali Loss: 5.214 Vali Acc: 0.126 Test Loss: 5.214 Test Acc: 0.126
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 1.0757201
	speed: 0.3143s/iter; left time: 5263.7759s
	iters: 200, epoch: 20 | loss: 0.9853820
	speed: 0.1120s/iter; left time: 1865.2917s
Epoch: 20 cost time: 24.514334678649902
Epoch: 20, Steps: 208 | Train Loss: 0.747 Vali Loss: 5.631 Vali Acc: 0.130 Test Loss: 5.631 Test Acc: 0.130
Validation loss decreased (-0.126119 --> -0.129678).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.6093023
	speed: 0.3144s/iter; left time: 5199.9258s
	iters: 200, epoch: 21 | loss: 0.9363843
	speed: 0.1192s/iter; left time: 1960.4993s
Epoch: 21 cost time: 25.261789560317993
Epoch: 21, Steps: 208 | Train Loss: 0.696 Vali Loss: 5.448 Vali Acc: 0.118 Test Loss: 5.448 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.6465127
	speed: 0.3035s/iter; left time: 4957.4850s
	iters: 200, epoch: 22 | loss: 0.8838237
	speed: 0.1122s/iter; left time: 1821.7911s
Epoch: 22 cost time: 23.63537573814392
Epoch: 22, Steps: 208 | Train Loss: 0.652 Vali Loss: 5.985 Vali Acc: 0.128 Test Loss: 5.985 Test Acc: 0.128
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.6296251
	speed: 0.2939s/iter; left time: 4738.9648s
	iters: 200, epoch: 23 | loss: 0.6986415
	speed: 0.1174s/iter; left time: 1880.5627s
Epoch: 23 cost time: 22.931732416152954
Epoch: 23, Steps: 208 | Train Loss: 0.650 Vali Loss: 6.039 Vali Acc: 0.111 Test Loss: 6.039 Test Acc: 0.111
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.2669907
	speed: 0.2780s/iter; left time: 4425.5054s
	iters: 200, epoch: 24 | loss: 0.5119120
	speed: 0.1209s/iter; left time: 1912.3444s
Epoch: 24 cost time: 23.029565811157227
Epoch: 24, Steps: 208 | Train Loss: 0.622 Vali Loss: 5.874 Vali Acc: 0.120 Test Loss: 5.874 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.6312116
	speed: 0.2955s/iter; left time: 4641.7159s
	iters: 200, epoch: 25 | loss: 0.3089858
	speed: 0.1058s/iter; left time: 1652.1415s
Epoch: 25 cost time: 22.957826375961304
Epoch: 25, Steps: 208 | Train Loss: 0.542 Vali Loss: 6.136 Vali Acc: 0.120 Test Loss: 6.136 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.5914233
	speed: 0.3075s/iter; left time: 4767.2315s
	iters: 200, epoch: 26 | loss: 0.8090934
	speed: 0.1153s/iter; left time: 1776.3106s
Epoch: 26 cost time: 24.58140516281128
Epoch: 26, Steps: 208 | Train Loss: 0.561 Vali Loss: 6.334 Vali Acc: 0.116 Test Loss: 6.334 Test Acc: 0.116
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.7585808
	speed: 0.2758s/iter; left time: 4217.8250s
	iters: 200, epoch: 27 | loss: 0.5163559
	speed: 0.0732s/iter; left time: 1112.4425s
Epoch: 27 cost time: 16.93702244758606
Epoch: 27, Steps: 208 | Train Loss: 0.532 Vali Loss: 6.485 Vali Acc: 0.118 Test Loss: 6.485 Test Acc: 0.118
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.2313546
	speed: 0.2933s/iter; left time: 4423.9807s
	iters: 200, epoch: 28 | loss: 0.5069686
	speed: 0.1241s/iter; left time: 1859.0123s
Epoch: 28 cost time: 26.798726081848145
Epoch: 28, Steps: 208 | Train Loss: 0.488 Vali Loss: 6.858 Vali Acc: 0.120 Test Loss: 6.858 Test Acc: 0.120
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.3186688
	speed: 0.3332s/iter; left time: 4957.2744s
	iters: 200, epoch: 29 | loss: 0.3224425
	speed: 0.1249s/iter; left time: 1845.1432s
Epoch: 29 cost time: 26.22472071647644
Epoch: 29, Steps: 208 | Train Loss: 0.473 Vali Loss: 6.548 Vali Acc: 0.124 Test Loss: 6.548 Test Acc: 0.124
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.6510009
	speed: 0.3201s/iter; left time: 4695.2425s
	iters: 200, epoch: 30 | loss: 0.6987774
	speed: 0.1129s/iter; left time: 1645.4185s
Epoch: 30 cost time: 23.974215030670166
Epoch: 30, Steps: 208 | Train Loss: 0.450 Vali Loss: 6.728 Vali Acc: 0.112 Test Loss: 6.728 Test Acc: 0.112
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12973456606024455
model parameter : 1093207
model size : 5.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8683438
	speed: 0.1504s/iter; left time: 3114.4092s
	iters: 200, epoch: 1 | loss: 3.8005886
	speed: 0.1312s/iter; left time: 2703.2991s
Epoch: 1 cost time: 29.288188934326172
Epoch: 1, Steps: 208 | Train Loss: 3.761 Vali Loss: 3.721 Vali Acc: 0.050 Test Loss: 3.721 Test Acc: 0.050
Validation loss decreased (inf --> -0.050365).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9374540
	speed: 0.3020s/iter; left time: 6189.6808s
	iters: 200, epoch: 2 | loss: 3.9204769
	speed: 0.1068s/iter; left time: 2177.3406s
Epoch: 2 cost time: 21.821076154708862
Epoch: 2, Steps: 208 | Train Loss: 3.720 Vali Loss: 3.660 Vali Acc: 0.060 Test Loss: 3.660 Test Acc: 0.060
Validation loss decreased (-0.050365 --> -0.060208).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7119417
	speed: 0.2925s/iter; left time: 5933.3560s
	iters: 200, epoch: 3 | loss: 3.5624118
	speed: 0.1066s/iter; left time: 2151.3572s
Epoch: 3 cost time: 21.34839129447937
Epoch: 3, Steps: 208 | Train Loss: 3.554 Vali Loss: 3.546 Vali Acc: 0.064 Test Loss: 3.546 Test Acc: 0.064
Validation loss decreased (-0.060208 --> -0.064384).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.5259295
	speed: 0.3037s/iter; left time: 6098.0242s
	iters: 200, epoch: 4 | loss: 3.8655746
	speed: 0.1096s/iter; left time: 2189.4103s
Epoch: 4 cost time: 24.04838538169861
Epoch: 4, Steps: 208 | Train Loss: 3.467 Vali Loss: 3.491 Vali Acc: 0.065 Test Loss: 3.491 Test Acc: 0.065
Validation loss decreased (-0.064384 --> -0.064683).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.6759014
	speed: 0.3172s/iter; left time: 6301.6238s
	iters: 200, epoch: 5 | loss: 3.5776086
	speed: 0.1136s/iter; left time: 2246.1601s
Epoch: 5 cost time: 24.325440883636475
Epoch: 5, Steps: 208 | Train Loss: 3.405 Vali Loss: 3.486 Vali Acc: 0.077 Test Loss: 3.486 Test Acc: 0.077
Validation loss decreased (-0.064683 --> -0.076613).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2407351
	speed: 0.3249s/iter; left time: 6388.1480s
	iters: 200, epoch: 6 | loss: 3.0587709
	speed: 0.1086s/iter; left time: 2124.4729s
Epoch: 6 cost time: 24.058751583099365
Epoch: 6, Steps: 208 | Train Loss: 3.340 Vali Loss: 3.508 Vali Acc: 0.064 Test Loss: 3.508 Test Acc: 0.064
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.6072812
	speed: 0.3054s/iter; left time: 5940.8867s
	iters: 200, epoch: 7 | loss: 2.9687908
	speed: 0.1176s/iter; left time: 2275.8179s
Epoch: 7 cost time: 24.86124277114868
Epoch: 7, Steps: 208 | Train Loss: 3.257 Vali Loss: 3.482 Vali Acc: 0.083 Test Loss: 3.482 Test Acc: 0.083
Validation loss decreased (-0.076613 --> -0.082578).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.0768733
	speed: 0.3149s/iter; left time: 6060.3738s
	iters: 200, epoch: 8 | loss: 3.3940411
	speed: 0.1138s/iter; left time: 2178.1127s
Epoch: 8 cost time: 24.69054126739502
Epoch: 8, Steps: 208 | Train Loss: 3.173 Vali Loss: 3.453 Vali Acc: 0.081 Test Loss: 3.453 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.9658170
	speed: 0.3022s/iter; left time: 5752.2624s
	iters: 200, epoch: 9 | loss: 3.4888589
	speed: 0.1132s/iter; left time: 2142.9103s
Epoch: 9 cost time: 23.873112201690674
Epoch: 9, Steps: 208 | Train Loss: 3.021 Vali Loss: 3.373 Vali Acc: 0.106 Test Loss: 3.373 Test Acc: 0.106
Validation loss decreased (-0.082578 --> -0.105842).  Saving model ...
	iters: 100, epoch: 10 | loss: 3.0227740
	speed: 0.3104s/iter; left time: 5844.6020s
	iters: 200, epoch: 10 | loss: 2.6325328
	speed: 0.1074s/iter; left time: 2011.0656s
Epoch: 10 cost time: 23.58466362953186
Epoch: 10, Steps: 208 | Train Loss: 2.855 Vali Loss: 3.383 Vali Acc: 0.093 Test Loss: 3.383 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.2693460
	speed: 0.3123s/iter; left time: 5814.5200s
	iters: 200, epoch: 11 | loss: 2.5029473
	speed: 0.1114s/iter; left time: 2064.0913s
Epoch: 11 cost time: 23.97856640815735
Epoch: 11, Steps: 208 | Train Loss: 2.616 Vali Loss: 3.400 Vali Acc: 0.108 Test Loss: 3.400 Test Acc: 0.108
Validation loss decreased (-0.105842 --> -0.107929).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.9785984
	speed: 0.3199s/iter; left time: 5890.4105s
	iters: 200, epoch: 12 | loss: 3.0398159
	speed: 0.1071s/iter; left time: 1961.1087s
Epoch: 12 cost time: 23.608362674713135
Epoch: 12, Steps: 208 | Train Loss: 2.374 Vali Loss: 3.659 Vali Acc: 0.102 Test Loss: 3.659 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.7619050
	speed: 0.3081s/iter; left time: 5608.6851s
	iters: 200, epoch: 13 | loss: 2.3329151
	speed: 0.1149s/iter; left time: 2081.1446s
Epoch: 13 cost time: 24.62021827697754
Epoch: 13, Steps: 208 | Train Loss: 2.080 Vali Loss: 3.673 Vali Acc: 0.101 Test Loss: 3.673 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.9722761
	speed: 0.3053s/iter; left time: 5495.0280s
	iters: 200, epoch: 14 | loss: 2.1130846
	speed: 0.1220s/iter; left time: 2184.2893s
Epoch: 14 cost time: 25.085110187530518
Epoch: 14, Steps: 208 | Train Loss: 1.820 Vali Loss: 3.895 Vali Acc: 0.109 Test Loss: 3.895 Test Acc: 0.109
Validation loss decreased (-0.107929 --> -0.109415).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.1464387
	speed: 0.3374s/iter; left time: 6001.6387s
	iters: 200, epoch: 15 | loss: 1.3296815
	speed: 0.1187s/iter; left time: 2098.8510s
Epoch: 15 cost time: 25.486080169677734
Epoch: 15, Steps: 208 | Train Loss: 1.558 Vali Loss: 4.128 Vali Acc: 0.116 Test Loss: 4.128 Test Acc: 0.116
Validation loss decreased (-0.109415 --> -0.115676).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.5150886
	speed: 0.3208s/iter; left time: 5639.4997s
	iters: 200, epoch: 16 | loss: 1.0846651
	speed: 0.1173s/iter; left time: 2050.3549s
Epoch: 16 cost time: 24.217584371566772
Epoch: 16, Steps: 208 | Train Loss: 1.286 Vali Loss: 4.615 Vali Acc: 0.100 Test Loss: 4.615 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.9025827
	speed: 0.3294s/iter; left time: 5723.3250s
	iters: 200, epoch: 17 | loss: 0.9840921
	speed: 0.1165s/iter; left time: 2012.1463s
Epoch: 17 cost time: 25.145463466644287
Epoch: 17, Steps: 208 | Train Loss: 1.080 Vali Loss: 4.830 Vali Acc: 0.111 Test Loss: 4.830 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.6123106
	speed: 0.3055s/iter; left time: 5243.4160s
	iters: 200, epoch: 18 | loss: 0.7650235
	speed: 0.0993s/iter; left time: 1695.3344s
Epoch: 18 cost time: 21.83349061012268
Epoch: 18, Steps: 208 | Train Loss: 0.916 Vali Loss: 5.143 Vali Acc: 0.096 Test Loss: 5.143 Test Acc: 0.096
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.2596507
	speed: 0.3076s/iter; left time: 5216.3811s
	iters: 200, epoch: 19 | loss: 1.0906754
	speed: 0.1007s/iter; left time: 1697.8122s
Epoch: 19 cost time: 22.67739748954773
Epoch: 19, Steps: 208 | Train Loss: 0.814 Vali Loss: 5.321 Vali Acc: 0.107 Test Loss: 5.321 Test Acc: 0.107
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.5268379
	speed: 0.3073s/iter; left time: 5147.4628s
	iters: 200, epoch: 20 | loss: 0.8161044
	speed: 0.0901s/iter; left time: 1500.7813s
Epoch: 20 cost time: 20.789665460586548
Epoch: 20, Steps: 208 | Train Loss: 0.710 Vali Loss: 5.575 Vali Acc: 0.109 Test Loss: 5.575 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.3990871
	speed: 0.2937s/iter; left time: 4857.3194s
	iters: 200, epoch: 21 | loss: 1.0317591
	speed: 0.1095s/iter; left time: 1800.0110s
Epoch: 21 cost time: 23.891327381134033
Epoch: 21, Steps: 208 | Train Loss: 0.666 Vali Loss: 5.561 Vali Acc: 0.109 Test Loss: 5.561 Test Acc: 0.109
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.4789763
	speed: 0.3110s/iter; left time: 5078.9701s
	iters: 200, epoch: 22 | loss: 0.5274448
	speed: 0.1085s/iter; left time: 1761.3737s
Epoch: 22 cost time: 23.87545609474182
Epoch: 22, Steps: 208 | Train Loss: 0.579 Vali Loss: 5.903 Vali Acc: 0.101 Test Loss: 5.903 Test Acc: 0.101
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.6990496
	speed: 0.3273s/iter; left time: 5276.9725s
	iters: 200, epoch: 23 | loss: 1.4816847
	speed: 0.1139s/iter; left time: 1824.8080s
Epoch: 23 cost time: 24.27315926551819
Epoch: 23, Steps: 208 | Train Loss: 0.536 Vali Loss: 5.991 Vali Acc: 0.108 Test Loss: 5.991 Test Acc: 0.108
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.2792902
	speed: 0.2972s/iter; left time: 4730.2194s
	iters: 200, epoch: 24 | loss: 0.1435149
	speed: 0.0888s/iter; left time: 1404.0138s
Epoch: 24 cost time: 20.622363805770874
Epoch: 24, Steps: 208 | Train Loss: 0.520 Vali Loss: 6.338 Vali Acc: 0.098 Test Loss: 6.338 Test Acc: 0.098
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.4660041
	speed: 0.2419s/iter; left time: 3800.3567s
	iters: 200, epoch: 25 | loss: 0.7143840
	speed: 0.0947s/iter; left time: 1478.4056s
Epoch: 25 cost time: 18.2733793258667
Epoch: 25, Steps: 208 | Train Loss: 0.502 Vali Loss: 6.539 Vali Acc: 0.107 Test Loss: 6.539 Test Acc: 0.107
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11571726811810319
model parameter : 1091031
model size : 5.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6920304
	speed: 0.1389s/iter; left time: 2875.9408s
	iters: 200, epoch: 1 | loss: 3.8185573
	speed: 0.1224s/iter; left time: 2520.8009s
Epoch: 1 cost time: 27.274179458618164
Epoch: 1, Steps: 208 | Train Loss: 3.742 Vali Loss: 3.851 Vali Acc: 0.050 Test Loss: 3.851 Test Acc: 0.050
Validation loss decreased (inf --> -0.049469).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.0019941
	speed: 0.3326s/iter; left time: 6815.5924s
	iters: 200, epoch: 2 | loss: 3.2567737
	speed: 0.1256s/iter; left time: 2560.8356s
Epoch: 2 cost time: 26.13908886909485
Epoch: 2, Steps: 208 | Train Loss: 3.692 Vali Loss: 3.686 Vali Acc: 0.055 Test Loss: 3.686 Test Acc: 0.055
Validation loss decreased (-0.049469 --> -0.054541).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6003120
	speed: 0.3410s/iter; left time: 6917.0663s
	iters: 200, epoch: 3 | loss: 3.9163465
	speed: 0.1246s/iter; left time: 2515.5551s
Epoch: 3 cost time: 26.129379510879517
Epoch: 3, Steps: 208 | Train Loss: 3.570 Vali Loss: 3.639 Vali Acc: 0.051 Test Loss: 3.639 Test Acc: 0.051
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.7265508
	speed: 0.3312s/iter; left time: 6649.5880s
	iters: 200, epoch: 4 | loss: 3.6476579
	speed: 0.1226s/iter; left time: 2448.6201s
Epoch: 4 cost time: 25.42101788520813
Epoch: 4, Steps: 208 | Train Loss: 3.466 Vali Loss: 3.484 Vali Acc: 0.078 Test Loss: 3.484 Test Acc: 0.078
Validation loss decreased (-0.054541 --> -0.078104).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.4916959
	speed: 0.2944s/iter; left time: 5849.6133s
	iters: 200, epoch: 5 | loss: 3.0798244
	speed: 0.1160s/iter; left time: 2293.4251s
Epoch: 5 cost time: 22.98125696182251
Epoch: 5, Steps: 208 | Train Loss: 3.328 Vali Loss: 3.486 Vali Acc: 0.080 Test Loss: 3.486 Test Acc: 0.080
Validation loss decreased (-0.078104 --> -0.079894).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0232086
	speed: 0.2917s/iter; left time: 5734.1771s
	iters: 200, epoch: 6 | loss: 3.5435691
	speed: 0.1010s/iter; left time: 1974.7524s
Epoch: 6 cost time: 21.32874035835266
Epoch: 6, Steps: 208 | Train Loss: 3.149 Vali Loss: 3.329 Vali Acc: 0.096 Test Loss: 3.329 Test Acc: 0.096
Validation loss decreased (-0.079894 --> -0.095702).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.1394377
	speed: 0.3115s/iter; left time: 6059.9921s
	iters: 200, epoch: 7 | loss: 2.7957361
	speed: 0.1050s/iter; left time: 2032.7107s
Epoch: 7 cost time: 23.227415561676025
Epoch: 7, Steps: 208 | Train Loss: 2.958 Vali Loss: 3.407 Vali Acc: 0.101 Test Loss: 3.407 Test Acc: 0.101
Validation loss decreased (-0.095702 --> -0.100771).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.4879253
	speed: 0.3008s/iter; left time: 5789.4167s
	iters: 200, epoch: 8 | loss: 2.6239123
	speed: 0.1017s/iter; left time: 1946.8020s
Epoch: 8 cost time: 22.877838373184204
Epoch: 8, Steps: 208 | Train Loss: 2.799 Vali Loss: 3.260 Vali Acc: 0.111 Test Loss: 3.260 Test Acc: 0.111
Validation loss decreased (-0.100771 --> -0.110913).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.2631819
	speed: 0.3247s/iter; left time: 6180.9602s
	iters: 200, epoch: 9 | loss: 2.5592182
	speed: 0.1130s/iter; left time: 2139.2062s
Epoch: 9 cost time: 24.544081687927246
Epoch: 9, Steps: 208 | Train Loss: 2.583 Vali Loss: 3.334 Vali Acc: 0.112 Test Loss: 3.334 Test Acc: 0.112
Validation loss decreased (-0.110913 --> -0.112105).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.4159429
	speed: 0.3062s/iter; left time: 5766.1515s
	iters: 200, epoch: 10 | loss: 2.1357160
	speed: 0.1103s/iter; left time: 2066.4581s
Epoch: 10 cost time: 23.948885679244995
Epoch: 10, Steps: 208 | Train Loss: 2.317 Vali Loss: 3.534 Vali Acc: 0.111 Test Loss: 3.534 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.9759815
	speed: 0.3089s/iter; left time: 5752.1438s
	iters: 200, epoch: 11 | loss: 2.0551646
	speed: 0.1082s/iter; left time: 2003.6704s
Epoch: 11 cost time: 23.0358943939209
Epoch: 11, Steps: 208 | Train Loss: 2.058 Vali Loss: 3.678 Vali Acc: 0.114 Test Loss: 3.678 Test Acc: 0.114
Validation loss decreased (-0.112105 --> -0.113891).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.5213636
	speed: 0.3114s/iter; left time: 5733.6708s
	iters: 200, epoch: 12 | loss: 2.2298119
	speed: 0.1171s/iter; left time: 2145.1122s
Epoch: 12 cost time: 24.88347578048706
Epoch: 12, Steps: 208 | Train Loss: 1.721 Vali Loss: 3.900 Vali Acc: 0.130 Test Loss: 3.900 Test Acc: 0.130
Validation loss decreased (-0.113891 --> -0.129994).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.4979219
	speed: 0.3025s/iter; left time: 5507.4198s
	iters: 200, epoch: 13 | loss: 1.3858565
	speed: 0.1126s/iter; left time: 2037.9772s
Epoch: 13 cost time: 23.731751918792725
Epoch: 13, Steps: 208 | Train Loss: 1.461 Vali Loss: 4.146 Vali Acc: 0.131 Test Loss: 4.146 Test Acc: 0.131
Validation loss decreased (-0.129994 --> -0.130886).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.0729707
	speed: 0.3136s/iter; left time: 5643.4661s
	iters: 200, epoch: 14 | loss: 1.3224703
	speed: 0.1135s/iter; left time: 2031.8394s
Epoch: 14 cost time: 23.23673939704895
Epoch: 14, Steps: 208 | Train Loss: 1.198 Vali Loss: 4.473 Vali Acc: 0.126 Test Loss: 4.473 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.6045650
	speed: 0.3069s/iter; left time: 5459.5453s
	iters: 200, epoch: 15 | loss: 1.0225726
	speed: 0.1122s/iter; left time: 1984.8480s
Epoch: 15 cost time: 24.325055599212646
Epoch: 15, Steps: 208 | Train Loss: 1.032 Vali Loss: 4.602 Vali Acc: 0.124 Test Loss: 4.602 Test Acc: 0.124
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.0169322
	speed: 0.3282s/iter; left time: 5769.8596s
	iters: 200, epoch: 16 | loss: 1.1212206
	speed: 0.1115s/iter; left time: 1949.3443s
Epoch: 16 cost time: 24.019677877426147
Epoch: 16, Steps: 208 | Train Loss: 0.897 Vali Loss: 5.068 Vali Acc: 0.130 Test Loss: 5.068 Test Acc: 0.130
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.1262400
	speed: 0.3285s/iter; left time: 5706.7756s
	iters: 200, epoch: 17 | loss: 1.2392993
	speed: 0.1096s/iter; left time: 1892.2944s
Epoch: 17 cost time: 24.1946120262146
Epoch: 17, Steps: 208 | Train Loss: 0.788 Vali Loss: 5.059 Vali Acc: 0.124 Test Loss: 5.059 Test Acc: 0.124
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.3955115
	speed: 0.3264s/iter; left time: 5602.6077s
	iters: 200, epoch: 18 | loss: 0.4618324
	speed: 0.1137s/iter; left time: 1939.6438s
Epoch: 18 cost time: 24.710424661636353
Epoch: 18, Steps: 208 | Train Loss: 0.716 Vali Loss: 5.370 Vali Acc: 0.118 Test Loss: 5.370 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.1351333
	speed: 0.3136s/iter; left time: 5317.8940s
	iters: 200, epoch: 19 | loss: 0.7882500
	speed: 0.1099s/iter; left time: 1852.9024s
Epoch: 19 cost time: 24.0735023021698
Epoch: 19, Steps: 208 | Train Loss: 0.648 Vali Loss: 5.282 Vali Acc: 0.113 Test Loss: 5.282 Test Acc: 0.113
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.4467579
	speed: 0.3065s/iter; left time: 5134.1421s
	iters: 200, epoch: 20 | loss: 0.7358517
	speed: 0.1041s/iter; left time: 1733.1060s
Epoch: 20 cost time: 23.09109854698181
Epoch: 20, Steps: 208 | Train Loss: 0.629 Vali Loss: 5.776 Vali Acc: 0.115 Test Loss: 5.776 Test Acc: 0.115
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.4710827
	speed: 0.3089s/iter; left time: 5109.0919s
	iters: 200, epoch: 21 | loss: 0.9128010
	speed: 0.1181s/iter; left time: 1942.0792s
Epoch: 21 cost time: 24.26787519454956
Epoch: 21, Steps: 208 | Train Loss: 0.574 Vali Loss: 5.979 Vali Acc: 0.118 Test Loss: 5.979 Test Acc: 0.118
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.5412738
	speed: 0.2714s/iter; left time: 4433.2604s
	iters: 200, epoch: 22 | loss: 0.2363771
	speed: 0.1146s/iter; left time: 1860.9206s
Epoch: 22 cost time: 22.8913414478302
Epoch: 22, Steps: 208 | Train Loss: 0.541 Vali Loss: 5.886 Vali Acc: 0.112 Test Loss: 5.886 Test Acc: 0.112
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.3182302
	speed: 0.3001s/iter; left time: 4839.4620s
	iters: 200, epoch: 23 | loss: 0.2651708
	speed: 0.1100s/iter; left time: 1762.6700s
Epoch: 23 cost time: 23.50335121154785
Epoch: 23, Steps: 208 | Train Loss: 0.535 Vali Loss: 6.314 Vali Acc: 0.120 Test Loss: 6.314 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1309275275872353
model parameter : 866391
model size : 4.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7270479
	speed: 0.1287s/iter; left time: 2664.0264s
	iters: 200, epoch: 1 | loss: 3.9289322
	speed: 0.1002s/iter; left time: 2063.2805s
Epoch: 1 cost time: 23.948180198669434
Epoch: 1, Steps: 208 | Train Loss: 3.729 Vali Loss: 3.782 Vali Acc: 0.042 Test Loss: 3.782 Test Acc: 0.042
Validation loss decreased (inf --> -0.042014).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4077938
	speed: 0.2545s/iter; left time: 5214.7675s
	iters: 200, epoch: 2 | loss: 3.7678568
	speed: 0.0669s/iter; left time: 1364.1981s
Epoch: 2 cost time: 15.05251669883728
Epoch: 2, Steps: 208 | Train Loss: 3.660 Vali Loss: 3.608 Vali Acc: 0.066 Test Loss: 3.608 Test Acc: 0.066
Validation loss decreased (-0.042014 --> -0.065577).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3138111
	speed: 0.2901s/iter; left time: 5883.6791s
	iters: 200, epoch: 3 | loss: 3.2819743
	speed: 0.1059s/iter; left time: 2136.7087s
Epoch: 3 cost time: 22.750670909881592
Epoch: 3, Steps: 208 | Train Loss: 3.557 Vali Loss: 3.582 Vali Acc: 0.061 Test Loss: 3.582 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.8137248
	speed: 0.2983s/iter; left time: 5989.2811s
	iters: 200, epoch: 4 | loss: 4.0263247
	speed: 0.1128s/iter; left time: 2253.4813s
Epoch: 4 cost time: 23.96736168861389
Epoch: 4, Steps: 208 | Train Loss: 3.471 Vali Loss: 3.506 Vali Acc: 0.061 Test Loss: 3.506 Test Acc: 0.061
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 3.7191286
	speed: 0.3104s/iter; left time: 6167.1075s
	iters: 200, epoch: 5 | loss: 3.0832291
	speed: 0.1166s/iter; left time: 2305.4248s
Epoch: 5 cost time: 24.809327840805054
Epoch: 5, Steps: 208 | Train Loss: 3.388 Vali Loss: 3.484 Vali Acc: 0.069 Test Loss: 3.484 Test Acc: 0.069
Validation loss decreased (-0.065577 --> -0.069157).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2505631
	speed: 0.3089s/iter; left time: 6072.6449s
	iters: 200, epoch: 6 | loss: 3.7436261
	speed: 0.1160s/iter; left time: 2269.4726s
Epoch: 6 cost time: 24.0679714679718
Epoch: 6, Steps: 208 | Train Loss: 3.253 Vali Loss: 3.442 Vali Acc: 0.079 Test Loss: 3.442 Test Acc: 0.079
Validation loss decreased (-0.069157 --> -0.078999).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.3523040
	speed: 0.3191s/iter; left time: 6208.3349s
	iters: 200, epoch: 7 | loss: 2.8736076
	speed: 0.1113s/iter; left time: 2154.8940s
Epoch: 7 cost time: 23.962703227996826
Epoch: 7, Steps: 208 | Train Loss: 3.132 Vali Loss: 3.288 Vali Acc: 0.089 Test Loss: 3.288 Test Acc: 0.089
Validation loss decreased (-0.078999 --> -0.089439).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.5810070
	speed: 0.3267s/iter; left time: 6286.5051s
	iters: 200, epoch: 8 | loss: 2.9989524
	speed: 0.1217s/iter; left time: 2330.7540s
Epoch: 8 cost time: 24.82005786895752
Epoch: 8, Steps: 208 | Train Loss: 2.992 Vali Loss: 3.342 Vali Acc: 0.101 Test Loss: 3.342 Test Acc: 0.101
Validation loss decreased (-0.089439 --> -0.101070).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.1384556
	speed: 0.3020s/iter; left time: 5749.8307s
	iters: 200, epoch: 9 | loss: 3.1520500
	speed: 0.1039s/iter; left time: 1968.2388s
Epoch: 9 cost time: 22.953453063964844
Epoch: 9, Steps: 208 | Train Loss: 2.814 Vali Loss: 3.368 Vali Acc: 0.095 Test Loss: 3.368 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.9893081
	speed: 0.2997s/iter; left time: 5642.7293s
	iters: 200, epoch: 10 | loss: 2.9484890
	speed: 0.1022s/iter; left time: 1913.2545s
Epoch: 10 cost time: 22.66172695159912
Epoch: 10, Steps: 208 | Train Loss: 2.631 Vali Loss: 3.333 Vali Acc: 0.109 Test Loss: 3.333 Test Acc: 0.109
Validation loss decreased (-0.101070 --> -0.109123).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.6293931
	speed: 0.3028s/iter; left time: 5639.1002s
	iters: 200, epoch: 11 | loss: 2.7786233
	speed: 0.1079s/iter; left time: 1998.5987s
Epoch: 11 cost time: 23.4413845539093
Epoch: 11, Steps: 208 | Train Loss: 2.389 Vali Loss: 3.502 Vali Acc: 0.101 Test Loss: 3.502 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.6226721
	speed: 0.2852s/iter; left time: 5251.5156s
	iters: 200, epoch: 12 | loss: 2.1520262
	speed: 0.1142s/iter; left time: 2091.8624s
Epoch: 12 cost time: 23.737035512924194
Epoch: 12, Steps: 208 | Train Loss: 2.157 Vali Loss: 3.727 Vali Acc: 0.101 Test Loss: 3.727 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 2.2716551
	speed: 0.2936s/iter; left time: 5344.2403s
	iters: 200, epoch: 13 | loss: 2.3774393
	speed: 0.1106s/iter; left time: 2002.1684s
Epoch: 13 cost time: 22.703745365142822
Epoch: 13, Steps: 208 | Train Loss: 1.875 Vali Loss: 3.881 Vali Acc: 0.115 Test Loss: 3.881 Test Acc: 0.115
Validation loss decreased (-0.109123 --> -0.115082).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.5922982
	speed: 0.3018s/iter; left time: 5430.6755s
	iters: 200, epoch: 14 | loss: 1.8003674
	speed: 0.1123s/iter; left time: 2009.8222s
Epoch: 14 cost time: 23.137315034866333
Epoch: 14, Steps: 208 | Train Loss: 1.605 Vali Loss: 3.963 Vali Acc: 0.106 Test Loss: 3.963 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.1965716
	speed: 0.3016s/iter; left time: 5364.6055s
	iters: 200, epoch: 15 | loss: 2.2441750
	speed: 0.1146s/iter; left time: 2026.5558s
Epoch: 15 cost time: 23.58626914024353
Epoch: 15, Steps: 208 | Train Loss: 1.390 Vali Loss: 4.179 Vali Acc: 0.110 Test Loss: 4.179 Test Acc: 0.110
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.9009169
	speed: 0.2986s/iter; left time: 5249.7705s
	iters: 200, epoch: 16 | loss: 1.5420091
	speed: 0.1056s/iter; left time: 1846.1027s
Epoch: 16 cost time: 22.739577531814575
Epoch: 16, Steps: 208 | Train Loss: 1.172 Vali Loss: 4.611 Vali Acc: 0.112 Test Loss: 4.611 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.9875008
	speed: 0.2963s/iter; left time: 5147.2574s
	iters: 200, epoch: 17 | loss: 1.0790620
	speed: 0.1094s/iter; left time: 1889.7546s
Epoch: 17 cost time: 22.635214805603027
Epoch: 17, Steps: 208 | Train Loss: 1.006 Vali Loss: 4.728 Vali Acc: 0.120 Test Loss: 4.728 Test Acc: 0.120
Validation loss decreased (-0.115082 --> -0.120442).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.6994080
	speed: 0.2923s/iter; left time: 5017.5713s
	iters: 200, epoch: 18 | loss: 1.6764985
	speed: 0.1118s/iter; left time: 1907.1038s
Epoch: 18 cost time: 23.54024839401245
Epoch: 18, Steps: 208 | Train Loss: 0.868 Vali Loss: 4.865 Vali Acc: 0.108 Test Loss: 4.865 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.4252931
	speed: 0.2948s/iter; left time: 4999.6326s
	iters: 200, epoch: 19 | loss: 0.8372380
	speed: 0.1180s/iter; left time: 1988.3128s
Epoch: 19 cost time: 24.58660912513733
Epoch: 19, Steps: 208 | Train Loss: 0.795 Vali Loss: 5.451 Vali Acc: 0.110 Test Loss: 5.451 Test Acc: 0.110
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.7810904
	speed: 0.3141s/iter; left time: 5260.0655s
	iters: 200, epoch: 20 | loss: 1.2088391
	speed: 0.1195s/iter; left time: 1988.9345s
Epoch: 20 cost time: 24.887654542922974
Epoch: 20, Steps: 208 | Train Loss: 0.680 Vali Loss: 5.499 Vali Acc: 0.115 Test Loss: 5.499 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.7133803
	speed: 0.3187s/iter; left time: 5271.4501s
	iters: 200, epoch: 21 | loss: 0.7247666
	speed: 0.1197s/iter; left time: 1967.8938s
Epoch: 21 cost time: 24.590807914733887
Epoch: 21, Steps: 208 | Train Loss: 0.647 Vali Loss: 5.578 Vali Acc: 0.115 Test Loss: 5.578 Test Acc: 0.115
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.2939729
	speed: 0.3073s/iter; left time: 5018.8676s
	iters: 200, epoch: 22 | loss: 0.8337817
	speed: 0.1248s/iter; left time: 2025.3282s
Epoch: 22 cost time: 24.66370439529419
Epoch: 22, Steps: 208 | Train Loss: 0.627 Vali Loss: 5.626 Vali Acc: 0.125 Test Loss: 5.626 Test Acc: 0.125
Validation loss decreased (-0.120442 --> -0.125205).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.7488233
	speed: 0.3052s/iter; left time: 4921.8220s
	iters: 200, epoch: 23 | loss: 0.5969156
	speed: 0.1099s/iter; left time: 1760.4221s
Epoch: 23 cost time: 22.590469121932983
Epoch: 23, Steps: 208 | Train Loss: 0.551 Vali Loss: 6.096 Vali Acc: 0.116 Test Loss: 6.096 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.6702158
	speed: 0.2913s/iter; left time: 4636.9167s
	iters: 200, epoch: 24 | loss: 0.6327646
	speed: 0.1021s/iter; left time: 1615.5227s
Epoch: 24 cost time: 21.74834108352661
Epoch: 24, Steps: 208 | Train Loss: 0.536 Vali Loss: 5.972 Vali Acc: 0.115 Test Loss: 5.972 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.8998381
	speed: 0.3021s/iter; left time: 4744.9958s
	iters: 200, epoch: 25 | loss: 0.2963489
	speed: 0.1116s/iter; left time: 1742.4334s
Epoch: 25 cost time: 23.61851406097412
Epoch: 25, Steps: 208 | Train Loss: 0.476 Vali Loss: 6.297 Vali Acc: 0.112 Test Loss: 6.297 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.3213838
	speed: 0.2486s/iter; left time: 3854.0880s
	iters: 200, epoch: 26 | loss: 0.5370218
	speed: 0.0702s/iter; left time: 1080.5382s
Epoch: 26 cost time: 15.556771755218506
Epoch: 26, Steps: 208 | Train Loss: 0.476 Vali Loss: 6.248 Vali Acc: 0.120 Test Loss: 6.248 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.6965407
	speed: 0.2943s/iter; left time: 4500.7653s
	iters: 200, epoch: 27 | loss: 0.3986840
	speed: 0.1054s/iter; left time: 1602.0892s
Epoch: 27 cost time: 23.10999608039856
Epoch: 27, Steps: 208 | Train Loss: 0.434 Vali Loss: 6.840 Vali Acc: 0.122 Test Loss: 6.840 Test Acc: 0.122
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.1729736
	speed: 0.2602s/iter; left time: 3925.8194s
	iters: 200, epoch: 28 | loss: 0.1365164
	speed: 0.0856s/iter; left time: 1283.3391s
Epoch: 28 cost time: 18.267518520355225
Epoch: 28, Steps: 208 | Train Loss: 0.433 Vali Loss: 6.990 Vali Acc: 0.115 Test Loss: 6.990 Test Acc: 0.115
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.3434606
	speed: 0.3017s/iter; left time: 4488.7489s
	iters: 200, epoch: 29 | loss: 1.0302272
	speed: 0.1075s/iter; left time: 1589.0074s
Epoch: 29 cost time: 23.701632499694824
Epoch: 29, Steps: 208 | Train Loss: 0.412 Vali Loss: 6.987 Vali Acc: 0.112 Test Loss: 6.987 Test Acc: 0.112
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.2992719
	speed: 0.3006s/iter; left time: 4409.9806s
	iters: 200, epoch: 30 | loss: 0.6819922
	speed: 0.1080s/iter; left time: 1572.7267s
Epoch: 30 cost time: 23.184082508087158
Epoch: 30, Steps: 208 | Train Loss: 0.428 Vali Loss: 6.867 Vali Acc: 0.114 Test Loss: 6.867 Test Acc: 0.114
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.4851905
	speed: 0.3101s/iter; left time: 4483.9824s
	iters: 200, epoch: 31 | loss: 0.5143107
	speed: 0.1082s/iter; left time: 1554.0603s
Epoch: 31 cost time: 23.452268362045288
Epoch: 31, Steps: 208 | Train Loss: 0.368 Vali Loss: 6.819 Vali Acc: 0.116 Test Loss: 6.819 Test Acc: 0.116
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.4080793
	speed: 0.2904s/iter; left time: 4138.9598s
	iters: 200, epoch: 32 | loss: 0.3319449
	speed: 0.1107s/iter; left time: 1566.8799s
Epoch: 32 cost time: 22.886873245239258
Epoch: 32, Steps: 208 | Train Loss: 0.369 Vali Loss: 7.169 Vali Acc: 0.114 Test Loss: 7.169 Test Acc: 0.114
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12526096033402923
model parameter : 864215
model size : 4.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8836277
	speed: 0.1366s/iter; left time: 2828.7864s
	iters: 200, epoch: 1 | loss: 3.7061076
	speed: 0.1116s/iter; left time: 2298.6503s
Epoch: 1 cost time: 25.813763856887817
Epoch: 1, Steps: 208 | Train Loss: 3.782 Vali Loss: 3.809 Vali Acc: 0.045 Test Loss: 3.809 Test Acc: 0.045
Validation loss decreased (inf --> -0.044996).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3527424
	speed: 0.3192s/iter; left time: 6541.2645s
	iters: 200, epoch: 2 | loss: 3.7001004
	speed: 0.1165s/iter; left time: 2376.0971s
Epoch: 2 cost time: 24.712164878845215
Epoch: 2, Steps: 208 | Train Loss: 3.702 Vali Loss: 3.571 Vali Acc: 0.050 Test Loss: 3.571 Test Acc: 0.050
Validation loss decreased (-0.044996 --> -0.050367).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.1314120
	speed: 0.3270s/iter; left time: 6632.5500s
	iters: 200, epoch: 3 | loss: 3.4613562
	speed: 0.1187s/iter; left time: 2396.6761s
Epoch: 3 cost time: 25.6929190158844
Epoch: 3, Steps: 208 | Train Loss: 3.525 Vali Loss: 3.592 Vali Acc: 0.061 Test Loss: 3.592 Test Acc: 0.061
Validation loss decreased (-0.050367 --> -0.060507).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4073036
	speed: 0.3020s/iter; left time: 6064.0282s
	iters: 200, epoch: 4 | loss: 3.5074165
	speed: 0.1097s/iter; left time: 2192.3664s
Epoch: 4 cost time: 22.774805784225464
Epoch: 4, Steps: 208 | Train Loss: 3.462 Vali Loss: 3.469 Vali Acc: 0.065 Test Loss: 3.469 Test Acc: 0.065
Validation loss decreased (-0.060507 --> -0.064683).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3654418
	speed: 0.2986s/iter; left time: 5932.0970s
	iters: 200, epoch: 5 | loss: 3.4479840
	speed: 0.1079s/iter; left time: 2132.7040s
Epoch: 5 cost time: 22.79538083076477
Epoch: 5, Steps: 208 | Train Loss: 3.335 Vali Loss: 3.311 Vali Acc: 0.083 Test Loss: 3.311 Test Acc: 0.083
Validation loss decreased (-0.064683 --> -0.082579).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.8784540
	speed: 0.2946s/iter; left time: 5792.8863s
	iters: 200, epoch: 6 | loss: 3.0414057
	speed: 0.1023s/iter; left time: 2001.6646s
Epoch: 6 cost time: 22.53286862373352
Epoch: 6, Steps: 208 | Train Loss: 3.178 Vali Loss: 3.253 Vali Acc: 0.093 Test Loss: 3.253 Test Acc: 0.093
Validation loss decreased (-0.082579 --> -0.093018).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.7731130
	speed: 0.2981s/iter; left time: 5798.4443s
	iters: 200, epoch: 7 | loss: 2.9720564
	speed: 0.0979s/iter; left time: 1894.7392s
Epoch: 7 cost time: 21.80949592590332
Epoch: 7, Steps: 208 | Train Loss: 3.023 Vali Loss: 3.256 Vali Acc: 0.108 Test Loss: 3.256 Test Acc: 0.108
Validation loss decreased (-0.093018 --> -0.108229).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.7820785
	speed: 0.3075s/iter; left time: 5918.3851s
	iters: 200, epoch: 8 | loss: 2.9798834
	speed: 0.1083s/iter; left time: 2073.0071s
Epoch: 8 cost time: 23.31791639328003
Epoch: 8, Steps: 208 | Train Loss: 2.856 Vali Loss: 3.130 Vali Acc: 0.116 Test Loss: 3.130 Test Acc: 0.116
Validation loss decreased (-0.108229 --> -0.116282).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.8844495
	speed: 0.3069s/iter; left time: 5842.0256s
	iters: 200, epoch: 9 | loss: 2.7306836
	speed: 0.1094s/iter; left time: 2071.7313s
Epoch: 9 cost time: 23.65105390548706
Epoch: 9, Steps: 208 | Train Loss: 2.646 Vali Loss: 3.159 Vali Acc: 0.118 Test Loss: 3.159 Test Acc: 0.118
Validation loss decreased (-0.116282 --> -0.117773).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.0959792
	speed: 0.3096s/iter; left time: 5829.4158s
	iters: 200, epoch: 10 | loss: 2.6881196
	speed: 0.1064s/iter; left time: 1993.5695s
Epoch: 10 cost time: 23.219964504241943
Epoch: 10, Steps: 208 | Train Loss: 2.401 Vali Loss: 3.225 Vali Acc: 0.123 Test Loss: 3.225 Test Acc: 0.123
Validation loss decreased (-0.117773 --> -0.123439).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.4189003
	speed: 0.3005s/iter; left time: 5595.1589s
	iters: 200, epoch: 11 | loss: 2.3054962
	speed: 0.1081s/iter; left time: 2002.7877s
Epoch: 11 cost time: 22.940701007843018
Epoch: 11, Steps: 208 | Train Loss: 2.142 Vali Loss: 3.554 Vali Acc: 0.122 Test Loss: 3.554 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.9418851
	speed: 0.3008s/iter; left time: 5537.7920s
	iters: 200, epoch: 12 | loss: 1.8353837
	speed: 0.1077s/iter; left time: 1971.5585s
Epoch: 12 cost time: 23.66152548789978
Epoch: 12, Steps: 208 | Train Loss: 1.871 Vali Loss: 3.504 Vali Acc: 0.117 Test Loss: 3.504 Test Acc: 0.117
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 2.0045862
	speed: 0.2957s/iter; left time: 5383.6761s
	iters: 200, epoch: 13 | loss: 1.6926994
	speed: 0.1106s/iter; left time: 2002.4883s
Epoch: 13 cost time: 23.790878534317017
Epoch: 13, Steps: 208 | Train Loss: 1.590 Vali Loss: 3.947 Vali Acc: 0.122 Test Loss: 3.947 Test Acc: 0.122
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.9999875
	speed: 0.3037s/iter; left time: 5464.8271s
	iters: 200, epoch: 14 | loss: 1.6688321
	speed: 0.1150s/iter; left time: 2058.2045s
Epoch: 14 cost time: 23.49101448059082
Epoch: 14, Steps: 208 | Train Loss: 1.391 Vali Loss: 4.228 Vali Acc: 0.126 Test Loss: 4.228 Test Acc: 0.126
Validation loss decreased (-0.123439 --> -0.126113).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.5970225
	speed: 0.3267s/iter; left time: 5811.2531s
	iters: 200, epoch: 15 | loss: 1.6080368
	speed: 0.1112s/iter; left time: 1967.7355s
Epoch: 15 cost time: 24.27776789665222
Epoch: 15, Steps: 208 | Train Loss: 1.160 Vali Loss: 4.430 Vali Acc: 0.112 Test Loss: 4.430 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.3358574
	speed: 0.3046s/iter; left time: 5355.1277s
	iters: 200, epoch: 16 | loss: 1.0123413
	speed: 0.1149s/iter; left time: 2008.5763s
Epoch: 16 cost time: 23.02640151977539
Epoch: 16, Steps: 208 | Train Loss: 1.006 Vali Loss: 4.888 Vali Acc: 0.116 Test Loss: 4.888 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.8426792
	speed: 0.3038s/iter; left time: 5278.5293s
	iters: 200, epoch: 17 | loss: 1.5937873
	speed: 0.1136s/iter; left time: 1961.3753s
Epoch: 17 cost time: 22.83355975151062
Epoch: 17, Steps: 208 | Train Loss: 0.887 Vali Loss: 5.141 Vali Acc: 0.119 Test Loss: 5.141 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.0432656
	speed: 0.3048s/iter; left time: 5232.6094s
	iters: 200, epoch: 18 | loss: 1.0440693
	speed: 0.1056s/iter; left time: 1802.6326s
Epoch: 18 cost time: 22.770146131515503
Epoch: 18, Steps: 208 | Train Loss: 0.822 Vali Loss: 4.997 Vali Acc: 0.117 Test Loss: 4.997 Test Acc: 0.117
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.8263246
	speed: 0.2558s/iter; left time: 4337.7625s
	iters: 200, epoch: 19 | loss: 0.7319028
	speed: 0.0699s/iter; left time: 1178.2983s
Epoch: 19 cost time: 15.06037163734436
Epoch: 19, Steps: 208 | Train Loss: 0.714 Vali Loss: 5.457 Vali Acc: 0.117 Test Loss: 5.457 Test Acc: 0.117
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.8149318
	speed: 0.2920s/iter; left time: 4890.7673s
	iters: 200, epoch: 20 | loss: 0.3181393
	speed: 0.1076s/iter; left time: 1790.7587s
Epoch: 20 cost time: 24.032100915908813
Epoch: 20, Steps: 208 | Train Loss: 0.668 Vali Loss: 5.713 Vali Acc: 0.125 Test Loss: 5.713 Test Acc: 0.125
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.4534336
	speed: 0.3068s/iter; left time: 5074.5653s
	iters: 200, epoch: 21 | loss: 0.6073362
	speed: 0.1033s/iter; left time: 1697.9177s
Epoch: 21 cost time: 22.93601655960083
Epoch: 21, Steps: 208 | Train Loss: 0.631 Vali Loss: 5.984 Vali Acc: 0.116 Test Loss: 5.984 Test Acc: 0.116
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.3973672
	speed: 0.3045s/iter; left time: 4973.9934s
	iters: 200, epoch: 22 | loss: 0.8340540
	speed: 0.1126s/iter; left time: 1827.1267s
Epoch: 22 cost time: 23.929553985595703
Epoch: 22, Steps: 208 | Train Loss: 0.589 Vali Loss: 6.267 Vali Acc: 0.108 Test Loss: 6.267 Test Acc: 0.108
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.6812290
	speed: 0.3032s/iter; left time: 4889.5209s
	iters: 200, epoch: 23 | loss: 0.6777124
	speed: 0.1083s/iter; left time: 1735.1507s
Epoch: 23 cost time: 23.69669485092163
Epoch: 23, Steps: 208 | Train Loss: 0.568 Vali Loss: 6.316 Vali Acc: 0.116 Test Loss: 6.316 Test Acc: 0.116
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.4992164
	speed: 0.3199s/iter; left time: 5092.2409s
	iters: 200, epoch: 24 | loss: 0.6495911
	speed: 0.1095s/iter; left time: 1732.1495s
Epoch: 24 cost time: 23.161791563034058
Epoch: 24, Steps: 208 | Train Loss: 0.535 Vali Loss: 6.196 Vali Acc: 0.112 Test Loss: 6.196 Test Acc: 0.112
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12615568147927228
model parameter : 862039
model size : 4.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7875080
	speed: 0.1167s/iter; left time: 2416.0421s
	iters: 200, epoch: 1 | loss: 3.5933540
	speed: 0.0990s/iter; left time: 2038.5172s
Epoch: 1 cost time: 22.519402265548706
Epoch: 1, Steps: 208 | Train Loss: 3.758 Vali Loss: 3.776 Vali Acc: 0.058 Test Loss: 3.776 Test Acc: 0.058
Validation loss decreased (inf --> -0.058417).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8464699
	speed: 0.2814s/iter; left time: 5765.7231s
	iters: 200, epoch: 2 | loss: 3.3533337
	speed: 0.0966s/iter; left time: 1970.6554s
Epoch: 2 cost time: 20.88666844367981
Epoch: 2, Steps: 208 | Train Loss: 3.660 Vali Loss: 3.633 Vali Acc: 0.064 Test Loss: 3.633 Test Acc: 0.064
Validation loss decreased (-0.058417 --> -0.063489).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6100671
	speed: 0.3137s/iter; left time: 6363.3141s
	iters: 200, epoch: 3 | loss: 3.5143638
	speed: 0.1123s/iter; left time: 2267.1967s
Epoch: 3 cost time: 23.823466539382935
Epoch: 3, Steps: 208 | Train Loss: 3.547 Vali Loss: 3.594 Vali Acc: 0.058 Test Loss: 3.594 Test Acc: 0.058
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.2426019
	speed: 0.2982s/iter; left time: 5987.8527s
	iters: 200, epoch: 4 | loss: 3.7212191
	speed: 0.1020s/iter; left time: 2036.9402s
Epoch: 4 cost time: 22.131897687911987
Epoch: 4, Steps: 208 | Train Loss: 3.457 Vali Loss: 3.515 Vali Acc: 0.065 Test Loss: 3.515 Test Acc: 0.065
Validation loss decreased (-0.063489 --> -0.065279).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.1477778
	speed: 0.3116s/iter; left time: 6191.0354s
	iters: 200, epoch: 5 | loss: 3.3460901
	speed: 0.1070s/iter; left time: 2115.6469s
Epoch: 5 cost time: 23.376014232635498
Epoch: 5, Steps: 208 | Train Loss: 3.358 Vali Loss: 3.479 Vali Acc: 0.065 Test Loss: 3.479 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.0705755
	speed: 0.3072s/iter; left time: 6040.5163s
	iters: 200, epoch: 6 | loss: 3.7908237
	speed: 0.1000s/iter; left time: 1956.5095s
Epoch: 6 cost time: 22.50851798057556
Epoch: 6, Steps: 208 | Train Loss: 3.245 Vali Loss: 3.417 Vali Acc: 0.079 Test Loss: 3.417 Test Acc: 0.079
Validation loss decreased (-0.065279 --> -0.079298).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.1945755
	speed: 0.2893s/iter; left time: 5627.6082s
	iters: 200, epoch: 7 | loss: 2.9855690
	speed: 0.1072s/iter; left time: 2074.2346s
Epoch: 7 cost time: 22.8395094871521
Epoch: 7, Steps: 208 | Train Loss: 3.106 Vali Loss: 3.387 Vali Acc: 0.087 Test Loss: 3.387 Test Acc: 0.087
Validation loss decreased (-0.079298 --> -0.087351).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.5407853
	speed: 0.2966s/iter; left time: 5708.7875s
	iters: 200, epoch: 8 | loss: 3.0339162
	speed: 0.1055s/iter; left time: 2019.0679s
Epoch: 8 cost time: 22.323290586471558
Epoch: 8, Steps: 208 | Train Loss: 2.946 Vali Loss: 3.295 Vali Acc: 0.111 Test Loss: 3.295 Test Acc: 0.111
Validation loss decreased (-0.087351 --> -0.110614).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.8039770
	speed: 0.2790s/iter; left time: 5312.2458s
	iters: 200, epoch: 9 | loss: 2.8513241
	speed: 0.1061s/iter; left time: 2009.6091s
Epoch: 9 cost time: 22.058255672454834
Epoch: 9, Steps: 208 | Train Loss: 2.718 Vali Loss: 3.325 Vali Acc: 0.110 Test Loss: 3.325 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.0515153
	speed: 0.2789s/iter; left time: 5252.2493s
	iters: 200, epoch: 10 | loss: 2.9608846
	speed: 0.1035s/iter; left time: 1939.2840s
Epoch: 10 cost time: 21.784958362579346
Epoch: 10, Steps: 208 | Train Loss: 2.501 Vali Loss: 3.381 Vali Acc: 0.120 Test Loss: 3.381 Test Acc: 0.120
Validation loss decreased (-0.110614 --> -0.119859).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.4051907
	speed: 0.2876s/iter; left time: 5354.8556s
	iters: 200, epoch: 11 | loss: 2.5724421
	speed: 0.0978s/iter; left time: 1812.2325s
Epoch: 11 cost time: 20.907586336135864
Epoch: 11, Steps: 208 | Train Loss: 2.207 Vali Loss: 3.493 Vali Acc: 0.124 Test Loss: 3.493 Test Acc: 0.124
Validation loss decreased (-0.119859 --> -0.123735).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.2982969
	speed: 0.2855s/iter; left time: 5256.0142s
	iters: 200, epoch: 12 | loss: 1.9884245
	speed: 0.1018s/iter; left time: 1864.1578s
Epoch: 12 cost time: 21.22098660469055
Epoch: 12, Steps: 208 | Train Loss: 1.932 Vali Loss: 3.708 Vali Acc: 0.118 Test Loss: 3.708 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.4578936
	speed: 0.2888s/iter; left time: 5257.6402s
	iters: 200, epoch: 13 | loss: 1.5957754
	speed: 0.1013s/iter; left time: 1834.1195s
Epoch: 13 cost time: 21.54959201812744
Epoch: 13, Steps: 208 | Train Loss: 1.646 Vali Loss: 3.911 Vali Acc: 0.112 Test Loss: 3.911 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.2692583
	speed: 0.2802s/iter; left time: 5043.5647s
	iters: 200, epoch: 14 | loss: 1.8266060
	speed: 0.1005s/iter; left time: 1798.2500s
Epoch: 14 cost time: 21.46927309036255
Epoch: 14, Steps: 208 | Train Loss: 1.403 Vali Loss: 4.305 Vali Acc: 0.118 Test Loss: 4.305 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.0556182
	speed: 0.2789s/iter; left time: 4960.9960s
	iters: 200, epoch: 15 | loss: 1.1832399
	speed: 0.0988s/iter; left time: 1747.6788s
Epoch: 15 cost time: 20.959059715270996
Epoch: 15, Steps: 208 | Train Loss: 1.182 Vali Loss: 4.296 Vali Acc: 0.123 Test Loss: 4.296 Test Acc: 0.123
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.5104085
	speed: 0.2851s/iter; left time: 5012.4395s
	iters: 200, epoch: 16 | loss: 0.9125300
	speed: 0.1084s/iter; left time: 1895.3050s
Epoch: 16 cost time: 22.68480086326599
Epoch: 16, Steps: 208 | Train Loss: 0.981 Vali Loss: 4.663 Vali Acc: 0.113 Test Loss: 4.663 Test Acc: 0.113
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.4586498
	speed: 0.2963s/iter; left time: 5147.1128s
	iters: 200, epoch: 17 | loss: 0.9869707
	speed: 0.1121s/iter; left time: 1936.5046s
Epoch: 17 cost time: 23.39900302886963
Epoch: 17, Steps: 208 | Train Loss: 0.853 Vali Loss: 4.848 Vali Acc: 0.113 Test Loss: 4.848 Test Acc: 0.113
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.2314923
	speed: 0.3057s/iter; left time: 5248.1579s
	iters: 200, epoch: 18 | loss: 0.7955774
	speed: 0.1119s/iter; left time: 1909.0765s
Epoch: 18 cost time: 23.83041024208069
Epoch: 18, Steps: 208 | Train Loss: 0.740 Vali Loss: 5.071 Vali Acc: 0.109 Test Loss: 5.071 Test Acc: 0.109
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.5726579
	speed: 0.3072s/iter; left time: 5209.6084s
	iters: 200, epoch: 19 | loss: 1.2593974
	speed: 0.1202s/iter; left time: 2025.9186s
Epoch: 19 cost time: 24.088597536087036
Epoch: 19, Steps: 208 | Train Loss: 0.661 Vali Loss: 5.436 Vali Acc: 0.114 Test Loss: 5.436 Test Acc: 0.114
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.1436019
	speed: 0.3114s/iter; left time: 5216.0772s
	iters: 200, epoch: 20 | loss: 1.0831867
	speed: 0.1045s/iter; left time: 1740.2261s
Epoch: 20 cost time: 22.363266944885254
Epoch: 20, Steps: 208 | Train Loss: 0.581 Vali Loss: 5.869 Vali Acc: 0.113 Test Loss: 5.869 Test Acc: 0.113
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.8593789
	speed: 0.2795s/iter; left time: 4623.5793s
	iters: 200, epoch: 21 | loss: 0.3645884
	speed: 0.0884s/iter; left time: 1453.4374s
Epoch: 21 cost time: 19.374824285507202
Epoch: 21, Steps: 208 | Train Loss: 0.538 Vali Loss: 5.912 Vali Acc: 0.112 Test Loss: 5.912 Test Acc: 0.112
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12376975842529078
model parameter : 859863
model size : 4.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1848483
	speed: 0.1285s/iter; left time: 2659.2529s
	iters: 200, epoch: 1 | loss: 3.7228587
	speed: 0.1014s/iter; left time: 2089.4704s
Epoch: 1 cost time: 23.86963677406311
Epoch: 1, Steps: 208 | Train Loss: 3.767 Vali Loss: 3.758 Vali Acc: 0.061 Test Loss: 3.758 Test Acc: 0.061
Validation loss decreased (inf --> -0.061400).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3831232
	speed: 0.2946s/iter; left time: 6036.9749s
	iters: 200, epoch: 2 | loss: 3.8265092
	speed: 0.1029s/iter; left time: 2097.7338s
Epoch: 2 cost time: 22.065624475479126
Epoch: 2, Steps: 208 | Train Loss: 3.677 Vali Loss: 3.687 Vali Acc: 0.054 Test Loss: 3.687 Test Acc: 0.054
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.2310014
	speed: 0.2895s/iter; left time: 5872.3624s
	iters: 200, epoch: 3 | loss: 3.2952535
	speed: 0.1051s/iter; left time: 2122.3159s
Epoch: 3 cost time: 22.096370697021484
Epoch: 3, Steps: 208 | Train Loss: 3.563 Vali Loss: 3.591 Vali Acc: 0.057 Test Loss: 3.591 Test Acc: 0.057
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 3.1394858
	speed: 0.2989s/iter; left time: 6000.1676s
	iters: 200, epoch: 4 | loss: 3.4899659
	speed: 0.1107s/iter; left time: 2212.0558s
Epoch: 4 cost time: 23.032353162765503
Epoch: 4, Steps: 208 | Train Loss: 3.411 Vali Loss: 3.554 Vali Acc: 0.063 Test Loss: 3.554 Test Acc: 0.063
Validation loss decreased (-0.061400 --> -0.062893).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.5732329
	speed: 0.2467s/iter; left time: 4901.7128s
	iters: 200, epoch: 5 | loss: 3.0686145
	speed: 0.0944s/iter; left time: 1866.4395s
Epoch: 5 cost time: 19.580211400985718
Epoch: 5, Steps: 208 | Train Loss: 3.274 Vali Loss: 3.545 Vali Acc: 0.065 Test Loss: 3.545 Test Acc: 0.065
Validation loss decreased (-0.062893 --> -0.065279).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.7932408
	speed: 0.2845s/iter; left time: 5593.0432s
	iters: 200, epoch: 6 | loss: 2.9019556
	speed: 0.0993s/iter; left time: 1941.8669s
Epoch: 6 cost time: 21.468888759613037
Epoch: 6, Steps: 208 | Train Loss: 3.112 Vali Loss: 3.431 Vali Acc: 0.090 Test Loss: 3.431 Test Acc: 0.090
Validation loss decreased (-0.065279 --> -0.089736).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.8883855
	speed: 0.3067s/iter; left time: 5965.3315s
	iters: 200, epoch: 7 | loss: 3.1499088
	speed: 0.1205s/iter; left time: 2332.2180s
Epoch: 7 cost time: 23.830848932266235
Epoch: 7, Steps: 208 | Train Loss: 2.954 Vali Loss: 3.411 Vali Acc: 0.097 Test Loss: 3.411 Test Acc: 0.097
Validation loss decreased (-0.089736 --> -0.096894).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.7563531
	speed: 0.2959s/iter; left time: 5694.1622s
	iters: 200, epoch: 8 | loss: 3.0587800
	speed: 0.1123s/iter; left time: 2150.7380s
Epoch: 8 cost time: 23.475117921829224
Epoch: 8, Steps: 208 | Train Loss: 2.760 Vali Loss: 3.388 Vali Acc: 0.106 Test Loss: 3.388 Test Acc: 0.106
Validation loss decreased (-0.096894 --> -0.106140).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.0948756
	speed: 0.3063s/iter; left time: 5831.7794s
	iters: 200, epoch: 9 | loss: 2.6637845
	speed: 0.1061s/iter; left time: 2008.3945s
Epoch: 9 cost time: 22.792534589767456
Epoch: 9, Steps: 208 | Train Loss: 2.548 Vali Loss: 3.440 Vali Acc: 0.111 Test Loss: 3.440 Test Acc: 0.111
Validation loss decreased (-0.106140 --> -0.110613).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.7517345
	speed: 0.3143s/iter; left time: 5917.4592s
	iters: 200, epoch: 10 | loss: 2.3019395
	speed: 0.1059s/iter; left time: 1984.0466s
Epoch: 10 cost time: 22.70730948448181
Epoch: 10, Steps: 208 | Train Loss: 2.260 Vali Loss: 3.628 Vali Acc: 0.105 Test Loss: 3.628 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.7447431
	speed: 0.2895s/iter; left time: 5390.5855s
	iters: 200, epoch: 11 | loss: 2.2726908
	speed: 0.0958s/iter; left time: 1773.7747s
Epoch: 11 cost time: 20.991008281707764
Epoch: 11, Steps: 208 | Train Loss: 1.987 Vali Loss: 3.705 Vali Acc: 0.106 Test Loss: 3.705 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.7070692
	speed: 0.2881s/iter; left time: 5303.8889s
	iters: 200, epoch: 12 | loss: 1.4754062
	speed: 0.1019s/iter; left time: 1865.4234s
Epoch: 12 cost time: 21.713072776794434
Epoch: 12, Steps: 208 | Train Loss: 1.707 Vali Loss: 3.872 Vali Acc: 0.115 Test Loss: 3.872 Test Acc: 0.115
Validation loss decreased (-0.110613 --> -0.114486).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.0749695
	speed: 0.2817s/iter; left time: 5128.4424s
	iters: 200, epoch: 13 | loss: 1.6862524
	speed: 0.1002s/iter; left time: 1814.7772s
Epoch: 13 cost time: 21.307421922683716
Epoch: 13, Steps: 208 | Train Loss: 1.451 Vali Loss: 4.184 Vali Acc: 0.107 Test Loss: 4.184 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.7400918
	speed: 0.2911s/iter; left time: 5239.1429s
	iters: 200, epoch: 14 | loss: 1.8097198
	speed: 0.1051s/iter; left time: 1880.6000s
Epoch: 14 cost time: 22.494834423065186
Epoch: 14, Steps: 208 | Train Loss: 1.242 Vali Loss: 4.383 Vali Acc: 0.114 Test Loss: 4.383 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.9973547
	speed: 0.2746s/iter; left time: 4885.2798s
	iters: 200, epoch: 15 | loss: 1.1415045
	speed: 0.1061s/iter; left time: 1877.4823s
Epoch: 15 cost time: 22.10249400138855
Epoch: 15, Steps: 208 | Train Loss: 1.062 Vali Loss: 4.618 Vali Acc: 0.119 Test Loss: 4.618 Test Acc: 0.119
Validation loss decreased (-0.114486 --> -0.118653).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.6208672
	speed: 0.3058s/iter; left time: 5375.7077s
	iters: 200, epoch: 16 | loss: 2.0309594
	speed: 0.1042s/iter; left time: 1821.3745s
Epoch: 16 cost time: 22.634281873703003
Epoch: 16, Steps: 208 | Train Loss: 0.949 Vali Loss: 4.935 Vali Acc: 0.117 Test Loss: 4.935 Test Acc: 0.117
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.7255248
	speed: 0.2831s/iter; left time: 4917.6539s
	iters: 200, epoch: 17 | loss: 1.3463144
	speed: 0.1007s/iter; left time: 1739.2923s
Epoch: 17 cost time: 21.01521611213684
Epoch: 17, Steps: 208 | Train Loss: 0.842 Vali Loss: 5.114 Vali Acc: 0.104 Test Loss: 5.114 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.4292520
	speed: 0.2790s/iter; left time: 4788.8517s
	iters: 200, epoch: 18 | loss: 0.4057940
	speed: 0.1056s/iter; left time: 1801.6046s
Epoch: 18 cost time: 21.944373846054077
Epoch: 18, Steps: 208 | Train Loss: 0.761 Vali Loss: 5.375 Vali Acc: 0.115 Test Loss: 5.375 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.5041517
	speed: 0.2810s/iter; left time: 4764.6304s
	iters: 200, epoch: 19 | loss: 0.9493685
	speed: 0.0883s/iter; left time: 1487.6563s
Epoch: 19 cost time: 19.824100017547607
Epoch: 19, Steps: 208 | Train Loss: 0.703 Vali Loss: 5.601 Vali Acc: 0.110 Test Loss: 5.601 Test Acc: 0.110
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.8670946
	speed: 0.2356s/iter; left time: 3946.7315s
	iters: 200, epoch: 20 | loss: 1.1765774
	speed: 0.0974s/iter; left time: 1620.9851s
Epoch: 20 cost time: 18.31021499633789
Epoch: 20, Steps: 208 | Train Loss: 0.645 Vali Loss: 5.744 Vali Acc: 0.117 Test Loss: 5.744 Test Acc: 0.117
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.8890269
	speed: 0.3109s/iter; left time: 5142.2616s
	iters: 200, epoch: 21 | loss: 0.5824173
	speed: 0.1032s/iter; left time: 1696.4752s
Epoch: 21 cost time: 22.91231942176819
Epoch: 21, Steps: 208 | Train Loss: 0.590 Vali Loss: 5.931 Vali Acc: 0.112 Test Loss: 5.931 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.6507547
	speed: 0.3106s/iter; left time: 5073.3500s
	iters: 200, epoch: 22 | loss: 0.9132488
	speed: 0.0966s/iter; left time: 1568.3903s
Epoch: 22 cost time: 22.32991361618042
Epoch: 22, Steps: 208 | Train Loss: 0.573 Vali Loss: 6.038 Vali Acc: 0.126 Test Loss: 6.038 Test Acc: 0.126
Validation loss decreased (-0.118653 --> -0.126095).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.8613336
	speed: 0.3101s/iter; left time: 5001.1626s
	iters: 200, epoch: 23 | loss: 1.2385198
	speed: 0.1092s/iter; left time: 1749.7671s
Epoch: 23 cost time: 23.323790311813354
Epoch: 23, Steps: 208 | Train Loss: 0.540 Vali Loss: 6.265 Vali Acc: 0.116 Test Loss: 6.265 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.3878435
	speed: 0.3042s/iter; left time: 4841.8672s
	iters: 200, epoch: 24 | loss: 0.4814007
	speed: 0.1035s/iter; left time: 1636.5906s
Epoch: 24 cost time: 22.1826274394989
Epoch: 24, Steps: 208 | Train Loss: 0.505 Vali Loss: 6.539 Vali Acc: 0.114 Test Loss: 6.539 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.1544927
	speed: 0.2872s/iter; left time: 4511.2250s
	iters: 200, epoch: 25 | loss: 0.6366479
	speed: 0.1049s/iter; left time: 1637.2652s
Epoch: 25 cost time: 22.500368118286133
Epoch: 25, Steps: 208 | Train Loss: 0.512 Vali Loss: 6.581 Vali Acc: 0.109 Test Loss: 6.581 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.5453656
	speed: 0.2838s/iter; left time: 4398.6084s
	iters: 200, epoch: 26 | loss: 0.6670647
	speed: 0.1045s/iter; left time: 1609.8741s
Epoch: 26 cost time: 21.589121341705322
Epoch: 26, Steps: 208 | Train Loss: 0.495 Vali Loss: 6.824 Vali Acc: 0.115 Test Loss: 6.824 Test Acc: 0.115
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.2836722
	speed: 0.2807s/iter; left time: 4292.9130s
	iters: 200, epoch: 27 | loss: 0.8791639
	speed: 0.1158s/iter; left time: 1759.3984s
Epoch: 27 cost time: 22.129024744033813
Epoch: 27, Steps: 208 | Train Loss: 0.482 Vali Loss: 7.042 Vali Acc: 0.109 Test Loss: 7.042 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.2877788
	speed: 0.2853s/iter; left time: 4303.1525s
	iters: 200, epoch: 28 | loss: 0.4665368
	speed: 0.1006s/iter; left time: 1507.6462s
Epoch: 28 cost time: 21.279027700424194
Epoch: 28, Steps: 208 | Train Loss: 0.458 Vali Loss: 6.591 Vali Acc: 0.120 Test Loss: 6.591 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.2819565
	speed: 0.2874s/iter; left time: 4275.0523s
	iters: 200, epoch: 29 | loss: 1.3173225
	speed: 0.0884s/iter; left time: 1306.2818s
Epoch: 29 cost time: 19.77072525024414
Epoch: 29, Steps: 208 | Train Loss: 0.448 Vali Loss: 7.197 Vali Acc: 0.113 Test Loss: 7.197 Test Acc: 0.113
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.2402151
	speed: 0.2775s/iter; left time: 4070.7110s
	iters: 200, epoch: 30 | loss: 0.0567976
	speed: 0.1016s/iter; left time: 1480.4600s
Epoch: 30 cost time: 21.76162099838257
Epoch: 30, Steps: 208 | Train Loss: 0.409 Vali Loss: 7.409 Vali Acc: 0.111 Test Loss: 7.409 Test Acc: 0.111
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.4668185
	speed: 0.2824s/iter; left time: 4084.0972s
	iters: 200, epoch: 31 | loss: 0.2344452
	speed: 0.0962s/iter; left time: 1381.9259s
Epoch: 31 cost time: 20.804232597351074
Epoch: 31, Steps: 208 | Train Loss: 0.390 Vali Loss: 7.451 Vali Acc: 0.119 Test Loss: 7.451 Test Acc: 0.119
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.4721064
	speed: 0.2967s/iter; left time: 4229.0054s
	iters: 200, epoch: 32 | loss: 0.5369112
	speed: 0.1036s/iter; left time: 1466.6470s
Epoch: 32 cost time: 21.568577527999878
Epoch: 32, Steps: 208 | Train Loss: 0.405 Vali Loss: 7.187 Vali Acc: 0.121 Test Loss: 7.187 Test Acc: 0.121
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12615568147927228
model parameter : 750807
model size : 4.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.4573331
	speed: 0.1278s/iter; left time: 2644.7109s
	iters: 200, epoch: 1 | loss: 3.7410161
	speed: 0.1118s/iter; left time: 2302.8363s
Epoch: 1 cost time: 24.97674870491028
Epoch: 1, Steps: 208 | Train Loss: 3.777 Vali Loss: 3.632 Vali Acc: 0.052 Test Loss: 3.632 Test Acc: 0.052
Validation loss decreased (inf --> -0.051858).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.1531563
	speed: 0.2968s/iter; left time: 6083.1403s
	iters: 200, epoch: 2 | loss: 3.6061664
	speed: 0.1096s/iter; left time: 2235.4792s
Epoch: 2 cost time: 22.59673237800598
Epoch: 2, Steps: 208 | Train Loss: 3.641 Vali Loss: 3.628 Vali Acc: 0.052 Test Loss: 3.628 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.3854356
	speed: 0.3033s/iter; left time: 6152.8279s
	iters: 200, epoch: 3 | loss: 3.4069192
	speed: 0.1143s/iter; left time: 2307.5244s
Epoch: 3 cost time: 23.27932357788086
Epoch: 3, Steps: 208 | Train Loss: 3.526 Vali Loss: 3.572 Vali Acc: 0.055 Test Loss: 3.572 Test Acc: 0.055
Validation loss decreased (-0.051858 --> -0.055437).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2552137
	speed: 0.3042s/iter; left time: 6106.6063s
	iters: 200, epoch: 4 | loss: 3.3081069
	speed: 0.1020s/iter; left time: 2037.3113s
Epoch: 4 cost time: 21.882738828659058
Epoch: 4, Steps: 208 | Train Loss: 3.462 Vali Loss: 3.565 Vali Acc: 0.066 Test Loss: 3.565 Test Acc: 0.066
Validation loss decreased (-0.055437 --> -0.065577).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.4399602
	speed: 0.2879s/iter; left time: 5720.0530s
	iters: 200, epoch: 5 | loss: 3.0367241
	speed: 0.1006s/iter; left time: 1987.8395s
Epoch: 5 cost time: 21.235361576080322
Epoch: 5, Steps: 208 | Train Loss: 3.345 Vali Loss: 3.425 Vali Acc: 0.078 Test Loss: 3.425 Test Acc: 0.078
Validation loss decreased (-0.065577 --> -0.077508).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.1916327
	speed: 0.2894s/iter; left time: 5690.2641s
	iters: 200, epoch: 6 | loss: 3.2036994
	speed: 0.0958s/iter; left time: 1874.8161s
Epoch: 6 cost time: 20.84900140762329
Epoch: 6, Steps: 208 | Train Loss: 3.189 Vali Loss: 3.286 Vali Acc: 0.093 Test Loss: 3.286 Test Acc: 0.093
Validation loss decreased (-0.077508 --> -0.093316).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.6886992
	speed: 0.2917s/iter; left time: 5674.1796s
	iters: 200, epoch: 7 | loss: 3.5721443
	speed: 0.0913s/iter; left time: 1766.2878s
Epoch: 7 cost time: 20.927143096923828
Epoch: 7, Steps: 208 | Train Loss: 3.034 Vali Loss: 3.237 Vali Acc: 0.105 Test Loss: 3.237 Test Acc: 0.105
Validation loss decreased (-0.093316 --> -0.104650).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.2741623
	speed: 0.2942s/iter; left time: 5662.2520s
	iters: 200, epoch: 8 | loss: 2.7444220
	speed: 0.0998s/iter; left time: 1910.7703s
Epoch: 8 cost time: 21.35622549057007
Epoch: 8, Steps: 208 | Train Loss: 2.919 Vali Loss: 3.296 Vali Acc: 0.107 Test Loss: 3.296 Test Acc: 0.107
Validation loss decreased (-0.104650 --> -0.107035).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.9046953
	speed: 0.2847s/iter; left time: 5419.7381s
	iters: 200, epoch: 9 | loss: 2.8161149
	speed: 0.1020s/iter; left time: 1932.4552s
Epoch: 9 cost time: 21.615373134613037
Epoch: 9, Steps: 208 | Train Loss: 2.717 Vali Loss: 3.400 Vali Acc: 0.103 Test Loss: 3.400 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.3320053
	speed: 0.2915s/iter; left time: 5488.8164s
	iters: 200, epoch: 10 | loss: 2.5771797
	speed: 0.1041s/iter; left time: 1948.7841s
Epoch: 10 cost time: 22.185703992843628
Epoch: 10, Steps: 208 | Train Loss: 2.488 Vali Loss: 3.397 Vali Acc: 0.110 Test Loss: 3.397 Test Acc: 0.110
Validation loss decreased (-0.107035 --> -0.110017).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.8861541
	speed: 0.2868s/iter; left time: 5340.8386s
	iters: 200, epoch: 11 | loss: 2.4672155
	speed: 0.1066s/iter; left time: 1973.8651s
Epoch: 11 cost time: 21.98090434074402
Epoch: 11, Steps: 208 | Train Loss: 2.235 Vali Loss: 3.516 Vali Acc: 0.112 Test Loss: 3.516 Test Acc: 0.112
Validation loss decreased (-0.110017 --> -0.111507).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4422259
	speed: 0.2861s/iter; left time: 5268.3128s
	iters: 200, epoch: 12 | loss: 2.2529373
	speed: 0.1005s/iter; left time: 1841.2868s
Epoch: 12 cost time: 21.75629234313965
Epoch: 12, Steps: 208 | Train Loss: 1.937 Vali Loss: 3.746 Vali Acc: 0.122 Test Loss: 3.746 Test Acc: 0.122
Validation loss decreased (-0.111507 --> -0.122241).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.7179639
	speed: 0.2811s/iter; left time: 5116.6574s
	iters: 200, epoch: 13 | loss: 2.1962526
	speed: 0.1083s/iter; left time: 1960.5205s
Epoch: 13 cost time: 21.650407791137695
Epoch: 13, Steps: 208 | Train Loss: 1.689 Vali Loss: 4.069 Vali Acc: 0.118 Test Loss: 4.069 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.6993214
	speed: 0.2759s/iter; left time: 4964.5308s
	iters: 200, epoch: 14 | loss: 1.3457698
	speed: 0.0995s/iter; left time: 1781.1500s
Epoch: 14 cost time: 21.070491790771484
Epoch: 14, Steps: 208 | Train Loss: 1.455 Vali Loss: 4.156 Vali Acc: 0.114 Test Loss: 4.156 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.5103291
	speed: 0.3009s/iter; left time: 5352.4190s
	iters: 200, epoch: 15 | loss: 1.4971050
	speed: 0.1099s/iter; left time: 1943.3533s
Epoch: 15 cost time: 23.720805883407593
Epoch: 15, Steps: 208 | Train Loss: 1.234 Vali Loss: 4.491 Vali Acc: 0.117 Test Loss: 4.491 Test Acc: 0.117
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.2111816
	speed: 0.3075s/iter; left time: 5406.4324s
	iters: 200, epoch: 16 | loss: 1.4816208
	speed: 0.0992s/iter; left time: 1734.0809s
Epoch: 16 cost time: 21.2606463432312
Epoch: 16, Steps: 208 | Train Loss: 1.056 Vali Loss: 4.651 Vali Acc: 0.114 Test Loss: 4.651 Test Acc: 0.114
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.9855491
	speed: 0.3098s/iter; left time: 5381.4732s
	iters: 200, epoch: 17 | loss: 0.9996599
	speed: 0.1078s/iter; left time: 1862.0431s
Epoch: 17 cost time: 22.767501831054688
Epoch: 17, Steps: 208 | Train Loss: 0.935 Vali Loss: 4.902 Vali Acc: 0.117 Test Loss: 4.902 Test Acc: 0.117
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.7551000
	speed: 0.3218s/iter; left time: 5523.7460s
	iters: 200, epoch: 18 | loss: 0.7976522
	speed: 0.1130s/iter; left time: 1927.6943s
Epoch: 18 cost time: 24.047024250030518
Epoch: 18, Steps: 208 | Train Loss: 0.805 Vali Loss: 5.144 Vali Acc: 0.110 Test Loss: 5.144 Test Acc: 0.110
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.6006956
	speed: 0.2799s/iter; left time: 4746.7564s
	iters: 200, epoch: 19 | loss: 1.1199628
	speed: 0.0835s/iter; left time: 1407.0961s
Epoch: 19 cost time: 17.885301113128662
Epoch: 19, Steps: 208 | Train Loss: 0.759 Vali Loss: 5.273 Vali Acc: 0.118 Test Loss: 5.273 Test Acc: 0.118
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.3972723
	speed: 0.2852s/iter; left time: 4776.5827s
	iters: 200, epoch: 20 | loss: 0.2741261
	speed: 0.0924s/iter; left time: 1537.8496s
Epoch: 20 cost time: 20.1463565826416
Epoch: 20, Steps: 208 | Train Loss: 0.668 Vali Loss: 5.719 Vali Acc: 0.117 Test Loss: 5.719 Test Acc: 0.117
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.3396998
	speed: 0.3043s/iter; left time: 5034.2311s
	iters: 200, epoch: 21 | loss: 0.4558552
	speed: 0.1073s/iter; left time: 1763.9923s
Epoch: 21 cost time: 22.67431354522705
Epoch: 21, Steps: 208 | Train Loss: 0.611 Vali Loss: 6.163 Vali Acc: 0.115 Test Loss: 6.163 Test Acc: 0.115
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.8359191
	speed: 0.2843s/iter; left time: 4642.6897s
	iters: 200, epoch: 22 | loss: 1.0416284
	speed: 0.1095s/iter; left time: 1776.8018s
Epoch: 22 cost time: 22.99229884147644
Epoch: 22, Steps: 208 | Train Loss: 0.625 Vali Loss: 5.938 Vali Acc: 0.113 Test Loss: 5.938 Test Acc: 0.113
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12227855651655234
model parameter : 748631
model size : 4.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7345264
	speed: 0.1214s/iter; left time: 2512.6171s
	iters: 200, epoch: 1 | loss: 3.9456198
	speed: 0.1038s/iter; left time: 2138.1172s
Epoch: 1 cost time: 23.4266140460968
Epoch: 1, Steps: 208 | Train Loss: 3.739 Vali Loss: 3.774 Vali Acc: 0.052 Test Loss: 3.774 Test Acc: 0.052
Validation loss decreased (inf --> -0.052453).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8213766
	speed: 0.2889s/iter; left time: 5920.2987s
	iters: 200, epoch: 2 | loss: 3.5248513
	speed: 0.1027s/iter; left time: 2093.5825s
Epoch: 2 cost time: 21.116287231445312
Epoch: 2, Steps: 208 | Train Loss: 3.702 Vali Loss: 3.665 Vali Acc: 0.060 Test Loss: 3.665 Test Acc: 0.060
Validation loss decreased (-0.052453 --> -0.060208).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.8379166
	speed: 0.2981s/iter; left time: 6046.2925s
	iters: 200, epoch: 3 | loss: 3.9804788
	speed: 0.1010s/iter; left time: 2037.9071s
Epoch: 3 cost time: 21.672424793243408
Epoch: 3, Steps: 208 | Train Loss: 3.580 Vali Loss: 3.648 Vali Acc: 0.052 Test Loss: 3.648 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.6557708
	speed: 0.2869s/iter; left time: 5759.1550s
	iters: 200, epoch: 4 | loss: 3.5993557
	speed: 0.1034s/iter; left time: 2065.0886s
Epoch: 4 cost time: 22.000778198242188
Epoch: 4, Steps: 208 | Train Loss: 3.469 Vali Loss: 3.543 Vali Acc: 0.061 Test Loss: 3.543 Test Acc: 0.061
Validation loss decreased (-0.060208 --> -0.060507).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2242913
	speed: 0.2843s/iter; left time: 5649.2041s
	iters: 200, epoch: 5 | loss: 3.3528006
	speed: 0.0872s/iter; left time: 1724.2151s
Epoch: 5 cost time: 20.091670274734497
Epoch: 5, Steps: 208 | Train Loss: 3.353 Vali Loss: 3.402 Vali Acc: 0.075 Test Loss: 3.402 Test Acc: 0.075
Validation loss decreased (-0.060507 --> -0.075421).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.9668264
	speed: 0.2725s/iter; left time: 5356.7361s
	iters: 200, epoch: 6 | loss: 2.9871130
	speed: 0.1067s/iter; left time: 2087.9993s
Epoch: 6 cost time: 22.643104791641235
Epoch: 6, Steps: 208 | Train Loss: 3.197 Vali Loss: 3.352 Vali Acc: 0.099 Test Loss: 3.352 Test Acc: 0.099
Validation loss decreased (-0.075421 --> -0.099281).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.8671482
	speed: 0.2816s/iter; left time: 5477.4777s
	iters: 200, epoch: 7 | loss: 3.7170064
	speed: 0.1014s/iter; left time: 1963.2493s
Epoch: 7 cost time: 21.426325798034668
Epoch: 7, Steps: 208 | Train Loss: 3.044 Vali Loss: 3.258 Vali Acc: 0.102 Test Loss: 3.258 Test Acc: 0.102
Validation loss decreased (-0.099281 --> -0.101966).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.0488029
	speed: 0.2932s/iter; left time: 5643.2287s
	iters: 200, epoch: 8 | loss: 2.7013927
	speed: 0.1102s/iter; left time: 2110.5145s
Epoch: 8 cost time: 22.82213258743286
Epoch: 8, Steps: 208 | Train Loss: 2.824 Vali Loss: 3.260 Vali Acc: 0.107 Test Loss: 3.260 Test Acc: 0.107
Validation loss decreased (-0.101966 --> -0.106737).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.5840845
	speed: 0.3031s/iter; left time: 5770.8741s
	iters: 200, epoch: 9 | loss: 2.7247434
	speed: 0.1076s/iter; left time: 2036.8737s
Epoch: 9 cost time: 22.237936973571777
Epoch: 9, Steps: 208 | Train Loss: 2.579 Vali Loss: 3.354 Vali Acc: 0.118 Test Loss: 3.354 Test Acc: 0.118
Validation loss decreased (-0.106737 --> -0.117771).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.1375039
	speed: 0.3076s/iter; left time: 5791.1704s
	iters: 200, epoch: 10 | loss: 2.3551357
	speed: 0.1006s/iter; left time: 1884.9739s
Epoch: 10 cost time: 22.200864553451538
Epoch: 10, Steps: 208 | Train Loss: 2.326 Vali Loss: 3.443 Vali Acc: 0.118 Test Loss: 3.443 Test Acc: 0.118
Validation loss decreased (-0.117771 --> -0.118367).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5440989
	speed: 0.3151s/iter; left time: 5866.5997s
	iters: 200, epoch: 11 | loss: 1.7075794
	speed: 0.1016s/iter; left time: 1881.9474s
Epoch: 11 cost time: 22.431533813476562
Epoch: 11, Steps: 208 | Train Loss: 2.031 Vali Loss: 3.577 Vali Acc: 0.133 Test Loss: 3.577 Test Acc: 0.133
Validation loss decreased (-0.118367 --> -0.132681).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.3131571
	speed: 0.2974s/iter; left time: 5475.5473s
	iters: 200, epoch: 12 | loss: 2.1866112
	speed: 0.0981s/iter; left time: 1796.3981s
Epoch: 12 cost time: 20.59827160835266
Epoch: 12, Steps: 208 | Train Loss: 1.756 Vali Loss: 3.772 Vali Acc: 0.129 Test Loss: 3.772 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.7618995
	speed: 0.2882s/iter; left time: 5246.7116s
	iters: 200, epoch: 13 | loss: 2.1576905
	speed: 0.0991s/iter; left time: 1794.3641s
Epoch: 13 cost time: 21.736868619918823
Epoch: 13, Steps: 208 | Train Loss: 1.476 Vali Loss: 3.983 Vali Acc: 0.113 Test Loss: 3.983 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.7810609
	speed: 0.2900s/iter; left time: 5219.5920s
	iters: 200, epoch: 14 | loss: 1.3689983
	speed: 0.1052s/iter; left time: 1882.2133s
Epoch: 14 cost time: 22.326865911483765
Epoch: 14, Steps: 208 | Train Loss: 1.249 Vali Loss: 4.168 Vali Acc: 0.118 Test Loss: 4.168 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.7852621
	speed: 0.2902s/iter; left time: 5162.4267s
	iters: 200, epoch: 15 | loss: 1.2295868
	speed: 0.1056s/iter; left time: 1867.1447s
Epoch: 15 cost time: 22.82059097290039
Epoch: 15, Steps: 208 | Train Loss: 1.054 Vali Loss: 4.410 Vali Acc: 0.120 Test Loss: 4.410 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.1809164
	speed: 0.2830s/iter; left time: 4975.7037s
	iters: 200, epoch: 16 | loss: 1.4196863
	speed: 0.1045s/iter; left time: 1827.0525s
Epoch: 16 cost time: 21.791037797927856
Epoch: 16, Steps: 208 | Train Loss: 0.915 Vali Loss: 4.850 Vali Acc: 0.128 Test Loss: 4.850 Test Acc: 0.128
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.6665123
	speed: 0.2893s/iter; left time: 5026.8542s
	iters: 200, epoch: 17 | loss: 1.2884696
	speed: 0.1068s/iter; left time: 1843.9838s
Epoch: 17 cost time: 22.52969455718994
Epoch: 17, Steps: 208 | Train Loss: 0.768 Vali Loss: 5.077 Vali Acc: 0.118 Test Loss: 5.077 Test Acc: 0.118
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.8613886
	speed: 0.2866s/iter; left time: 4919.7372s
	iters: 200, epoch: 18 | loss: 0.5518611
	speed: 0.0991s/iter; left time: 1690.4213s
Epoch: 18 cost time: 21.581488370895386
Epoch: 18, Steps: 208 | Train Loss: 0.716 Vali Loss: 5.347 Vali Acc: 0.123 Test Loss: 5.347 Test Acc: 0.123
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.1955460
	speed: 0.2949s/iter; left time: 5001.2929s
	iters: 200, epoch: 19 | loss: 0.9713884
	speed: 0.0961s/iter; left time: 1620.0737s
Epoch: 19 cost time: 20.478424549102783
Epoch: 19, Steps: 208 | Train Loss: 0.635 Vali Loss: 5.710 Vali Acc: 0.121 Test Loss: 5.710 Test Acc: 0.121
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.2920892
	speed: 0.2946s/iter; left time: 4934.6824s
	iters: 200, epoch: 20 | loss: 0.6218582
	speed: 0.1065s/iter; left time: 1773.4382s
Epoch: 20 cost time: 22.157960891723633
Epoch: 20, Steps: 208 | Train Loss: 0.586 Vali Loss: 5.916 Vali Acc: 0.117 Test Loss: 5.916 Test Acc: 0.117
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.4577055
	speed: 0.2984s/iter; left time: 4936.0723s
	iters: 200, epoch: 21 | loss: 0.6191769
	speed: 0.0997s/iter; left time: 1638.4593s
Epoch: 21 cost time: 21.628480672836304
Epoch: 21, Steps: 208 | Train Loss: 0.518 Vali Loss: 5.938 Vali Acc: 0.115 Test Loss: 5.938 Test Acc: 0.115
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13271696987772144
model parameter : 746455
model size : 4.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.2613802
	speed: 0.1242s/iter; left time: 2571.6179s
	iters: 200, epoch: 1 | loss: 3.4726372
	speed: 0.1079s/iter; left time: 2223.4893s
Epoch: 1 cost time: 24.0784809589386
Epoch: 1, Steps: 208 | Train Loss: 3.768 Vali Loss: 3.722 Vali Acc: 0.047 Test Loss: 3.722 Test Acc: 0.047
Validation loss decreased (inf --> -0.047383).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4250927
	speed: 0.2975s/iter; left time: 6097.0735s
	iters: 200, epoch: 2 | loss: 3.1947803
	speed: 0.0861s/iter; left time: 1755.3342s
Epoch: 2 cost time: 19.574023008346558
Epoch: 2, Steps: 208 | Train Loss: 3.684 Vali Loss: 3.680 Vali Acc: 0.056 Test Loss: 3.680 Test Acc: 0.056
Validation loss decreased (-0.047383 --> -0.056032).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4705801
	speed: 0.2494s/iter; left time: 5058.3587s
	iters: 200, epoch: 3 | loss: 3.9150743
	speed: 0.0754s/iter; left time: 1522.0433s
Epoch: 3 cost time: 16.36500334739685
Epoch: 3, Steps: 208 | Train Loss: 3.531 Vali Loss: 3.524 Vali Acc: 0.062 Test Loss: 3.524 Test Acc: 0.062
Validation loss decreased (-0.056032 --> -0.061999).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3265252
	speed: 0.3177s/iter; left time: 6377.7555s
	iters: 200, epoch: 4 | loss: 3.3457603
	speed: 0.1039s/iter; left time: 2076.5360s
Epoch: 4 cost time: 23.00582194328308
Epoch: 4, Steps: 208 | Train Loss: 3.459 Vali Loss: 3.467 Vali Acc: 0.068 Test Loss: 3.467 Test Acc: 0.068
Validation loss decreased (-0.061999 --> -0.067964).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.4635837
	speed: 0.2984s/iter; left time: 5929.5657s
	iters: 200, epoch: 5 | loss: 3.3010421
	speed: 0.1061s/iter; left time: 2096.5330s
Epoch: 5 cost time: 22.512453079223633
Epoch: 5, Steps: 208 | Train Loss: 3.316 Vali Loss: 3.416 Vali Acc: 0.076 Test Loss: 3.416 Test Acc: 0.076
Validation loss decreased (-0.067964 --> -0.076017).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.1155815
	speed: 0.2843s/iter; left time: 5590.3670s
	iters: 200, epoch: 6 | loss: 3.4100194
	speed: 0.1011s/iter; left time: 1977.4398s
Epoch: 6 cost time: 21.957640171051025
Epoch: 6, Steps: 208 | Train Loss: 3.158 Vali Loss: 3.268 Vali Acc: 0.102 Test Loss: 3.268 Test Acc: 0.102
Validation loss decreased (-0.076017 --> -0.102264).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.1524734
	speed: 0.2979s/iter; left time: 5794.4989s
	iters: 200, epoch: 7 | loss: 3.0416868
	speed: 0.1074s/iter; left time: 2078.0282s
Epoch: 7 cost time: 22.697935819625854
Epoch: 7, Steps: 208 | Train Loss: 2.995 Vali Loss: 3.219 Vali Acc: 0.109 Test Loss: 3.219 Test Acc: 0.109
Validation loss decreased (-0.102264 --> -0.109124).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.0784459
	speed: 0.3007s/iter; left time: 5787.0471s
	iters: 200, epoch: 8 | loss: 2.7666209
	speed: 0.1062s/iter; left time: 2032.5921s
Epoch: 8 cost time: 22.52294945716858
Epoch: 8, Steps: 208 | Train Loss: 2.827 Vali Loss: 3.288 Vali Acc: 0.118 Test Loss: 3.288 Test Acc: 0.118
Validation loss decreased (-0.109124 --> -0.117474).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.8119135
	speed: 0.2896s/iter; left time: 5513.1491s
	iters: 200, epoch: 9 | loss: 2.4892948
	speed: 0.0996s/iter; left time: 1885.8870s
Epoch: 9 cost time: 21.48329448699951
Epoch: 9, Steps: 208 | Train Loss: 2.619 Vali Loss: 3.257 Vali Acc: 0.116 Test Loss: 3.257 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.7864416
	speed: 0.2896s/iter; left time: 5453.5903s
	iters: 200, epoch: 10 | loss: 2.6406507
	speed: 0.1047s/iter; left time: 1960.8362s
Epoch: 10 cost time: 22.069965362548828
Epoch: 10, Steps: 208 | Train Loss: 2.388 Vali Loss: 3.398 Vali Acc: 0.123 Test Loss: 3.398 Test Acc: 0.123
Validation loss decreased (-0.117474 --> -0.122841).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.2372835
	speed: 0.2812s/iter; left time: 5236.6691s
	iters: 200, epoch: 11 | loss: 2.9047091
	speed: 0.1086s/iter; left time: 2011.5589s
Epoch: 11 cost time: 21.538013219833374
Epoch: 11, Steps: 208 | Train Loss: 2.102 Vali Loss: 3.560 Vali Acc: 0.124 Test Loss: 3.560 Test Acc: 0.124
Validation loss decreased (-0.122841 --> -0.123734).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.0897331
	speed: 0.2960s/iter; left time: 5450.6779s
	iters: 200, epoch: 12 | loss: 2.3486116
	speed: 0.1028s/iter; left time: 1883.4162s
Epoch: 12 cost time: 22.52371096611023
Epoch: 12, Steps: 208 | Train Loss: 1.833 Vali Loss: 3.733 Vali Acc: 0.126 Test Loss: 3.733 Test Acc: 0.126
Validation loss decreased (-0.123734 --> -0.125820).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.2034693
	speed: 0.2850s/iter; left time: 5189.2536s
	iters: 200, epoch: 13 | loss: 1.5677041
	speed: 0.0989s/iter; left time: 1790.7028s
Epoch: 13 cost time: 20.83443284034729
Epoch: 13, Steps: 208 | Train Loss: 1.571 Vali Loss: 3.921 Vali Acc: 0.118 Test Loss: 3.921 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.0014137
	speed: 0.2978s/iter; left time: 5358.6973s
	iters: 200, epoch: 14 | loss: 1.7208126
	speed: 0.1012s/iter; left time: 1811.2181s
Epoch: 14 cost time: 22.044872999191284
Epoch: 14, Steps: 208 | Train Loss: 1.329 Vali Loss: 4.193 Vali Acc: 0.135 Test Loss: 4.193 Test Acc: 0.135
Validation loss decreased (-0.125820 --> -0.134464).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.0897142
	speed: 0.3147s/iter; left time: 5598.5081s
	iters: 200, epoch: 15 | loss: 0.9089819
	speed: 0.1088s/iter; left time: 1924.0439s
Epoch: 15 cost time: 23.83851909637451
Epoch: 15, Steps: 208 | Train Loss: 1.111 Vali Loss: 4.614 Vali Acc: 0.127 Test Loss: 4.614 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.5176231
	speed: 0.3211s/iter; left time: 5645.4664s
	iters: 200, epoch: 16 | loss: 1.2226144
	speed: 0.1088s/iter; left time: 1901.3242s
Epoch: 16 cost time: 23.695889711380005
Epoch: 16, Steps: 208 | Train Loss: 1.033 Vali Loss: 4.795 Vali Acc: 0.133 Test Loss: 4.795 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.9805852
	speed: 0.3106s/iter; left time: 5396.6575s
	iters: 200, epoch: 17 | loss: 1.4422311
	speed: 0.1083s/iter; left time: 1870.4526s
Epoch: 17 cost time: 23.5459463596344
Epoch: 17, Steps: 208 | Train Loss: 0.881 Vali Loss: 5.036 Vali Acc: 0.129 Test Loss: 5.036 Test Acc: 0.129
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.5778829
	speed: 0.3172s/iter; left time: 5444.0548s
	iters: 200, epoch: 18 | loss: 0.2010539
	speed: 0.1077s/iter; left time: 1837.3716s
Epoch: 18 cost time: 23.6304349899292
Epoch: 18, Steps: 208 | Train Loss: 0.788 Vali Loss: 5.271 Vali Acc: 0.115 Test Loss: 5.271 Test Acc: 0.115
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.6126291
	speed: 0.2855s/iter; left time: 4841.7065s
	iters: 200, epoch: 19 | loss: 0.9108636
	speed: 0.1018s/iter; left time: 1715.9880s
Epoch: 19 cost time: 21.997381687164307
Epoch: 19, Steps: 208 | Train Loss: 0.778 Vali Loss: 5.428 Vali Acc: 0.124 Test Loss: 5.428 Test Acc: 0.124
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.5332660
	speed: 0.2927s/iter; left time: 4902.6028s
	iters: 200, epoch: 20 | loss: 0.6966437
	speed: 0.1036s/iter; left time: 1724.2126s
Epoch: 20 cost time: 22.01345181465149
Epoch: 20, Steps: 208 | Train Loss: 0.710 Vali Loss: 5.515 Vali Acc: 0.117 Test Loss: 5.515 Test Acc: 0.117
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.4845867
	speed: 0.2905s/iter; left time: 4805.3791s
	iters: 200, epoch: 21 | loss: 1.1294110
	speed: 0.1000s/iter; left time: 1644.4925s
Epoch: 21 cost time: 21.79338765144348
Epoch: 21, Steps: 208 | Train Loss: 0.663 Vali Loss: 5.858 Vali Acc: 0.117 Test Loss: 5.858 Test Acc: 0.117
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.5153518
	speed: 0.2794s/iter; left time: 4563.0398s
	iters: 200, epoch: 22 | loss: 0.2916443
	speed: 0.1053s/iter; left time: 1709.3191s
Epoch: 22 cost time: 21.830137729644775
Epoch: 22, Steps: 208 | Train Loss: 0.619 Vali Loss: 6.007 Vali Acc: 0.119 Test Loss: 6.007 Test Acc: 0.119
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.1297929
	speed: 0.2815s/iter; left time: 4539.8319s
	iters: 200, epoch: 23 | loss: 0.2300615
	speed: 0.1011s/iter; left time: 1620.2810s
Epoch: 23 cost time: 21.557460069656372
Epoch: 23, Steps: 208 | Train Loss: 0.586 Vali Loss: 6.115 Vali Acc: 0.121 Test Loss: 6.115 Test Acc: 0.121
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.5391988
	speed: 0.2860s/iter; left time: 4552.8082s
	iters: 200, epoch: 24 | loss: 0.9108282
	speed: 0.1022s/iter; left time: 1616.5166s
Epoch: 24 cost time: 21.632330179214478
Epoch: 24, Steps: 208 | Train Loss: 0.608 Vali Loss: 6.385 Vali Acc: 0.113 Test Loss: 6.385 Test Acc: 0.113
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13450641216820758
model parameter : 744279
model size : 4.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6468039
	speed: 0.0892s/iter; left time: 1846.3467s
	iters: 200, epoch: 1 | loss: 3.7609265
	speed: 0.0728s/iter; left time: 1499.6394s
Epoch: 1 cost time: 16.8800847530365
Epoch: 1, Steps: 208 | Train Loss: 3.697 Vali Loss: 3.678 Vali Acc: 0.050 Test Loss: 3.678 Test Acc: 0.050
Validation loss decreased (inf --> -0.049471).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8049896
	speed: 0.2667s/iter; left time: 5466.2721s
	iters: 200, epoch: 2 | loss: 3.4574306
	speed: 0.0710s/iter; left time: 1448.5797s
Epoch: 2 cost time: 15.529668807983398
Epoch: 2, Steps: 208 | Train Loss: 3.593 Vali Loss: 3.529 Vali Acc: 0.064 Test Loss: 3.529 Test Acc: 0.064
Validation loss decreased (-0.049471 --> -0.063490).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.2637682
	speed: 0.2492s/iter; left time: 5055.6409s
	iters: 200, epoch: 3 | loss: 3.0969062
	speed: 0.0726s/iter; left time: 1465.2542s
Epoch: 3 cost time: 15.27813196182251
Epoch: 3, Steps: 208 | Train Loss: 3.487 Vali Loss: 3.498 Vali Acc: 0.061 Test Loss: 3.498 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.5531502
	speed: 0.2566s/iter; left time: 5151.0992s
	iters: 200, epoch: 4 | loss: 3.6725554
	speed: 0.0762s/iter; left time: 1521.2680s
Epoch: 4 cost time: 15.89860224723816
Epoch: 4, Steps: 208 | Train Loss: 3.390 Vali Loss: 3.578 Vali Acc: 0.059 Test Loss: 3.578 Test Acc: 0.059
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 3.3726068
	speed: 0.2682s/iter; left time: 5328.5791s
	iters: 200, epoch: 5 | loss: 3.1899064
	speed: 0.0742s/iter; left time: 1466.2225s
Epoch: 5 cost time: 16.035888671875
Epoch: 5, Steps: 208 | Train Loss: 3.325 Vali Loss: 3.461 Vali Acc: 0.071 Test Loss: 3.461 Test Acc: 0.071
Validation loss decreased (-0.063490 --> -0.070947).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.1139634
	speed: 0.2849s/iter; left time: 5601.3986s
	iters: 200, epoch: 6 | loss: 2.6548252
	speed: 0.0756s/iter; left time: 1478.4799s
Epoch: 6 cost time: 16.597776651382446
Epoch: 6, Steps: 208 | Train Loss: 3.254 Vali Loss: 3.536 Vali Acc: 0.069 Test Loss: 3.536 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.6654046
	speed: 0.2787s/iter; left time: 5422.1584s
	iters: 200, epoch: 7 | loss: 3.8587439
	speed: 0.0767s/iter; left time: 1483.4333s
Epoch: 7 cost time: 16.769019603729248
Epoch: 7, Steps: 208 | Train Loss: 3.161 Vali Loss: 3.466 Vali Acc: 0.081 Test Loss: 3.466 Test Acc: 0.081
Validation loss decreased (-0.070947 --> -0.081087).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.1894467
	speed: 0.2830s/iter; left time: 5446.8531s
	iters: 200, epoch: 8 | loss: 2.8632495
	speed: 0.0724s/iter; left time: 1385.2869s
Epoch: 8 cost time: 15.767216444015503
Epoch: 8, Steps: 208 | Train Loss: 3.037 Vali Loss: 3.465 Vali Acc: 0.092 Test Loss: 3.465 Test Acc: 0.092
Validation loss decreased (-0.081087 --> -0.091823).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.8034959
	speed: 0.2619s/iter; left time: 4985.3654s
	iters: 200, epoch: 9 | loss: 2.8096917
	speed: 0.0722s/iter; left time: 1367.4487s
Epoch: 9 cost time: 15.292993068695068
Epoch: 9, Steps: 208 | Train Loss: 2.912 Vali Loss: 3.496 Vali Acc: 0.085 Test Loss: 3.496 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.7953856
	speed: 0.2692s/iter; left time: 5069.1247s
	iters: 200, epoch: 10 | loss: 2.9254074
	speed: 0.0695s/iter; left time: 1301.9862s
Epoch: 10 cost time: 15.221765041351318
Epoch: 10, Steps: 208 | Train Loss: 2.764 Vali Loss: 3.560 Vali Acc: 0.083 Test Loss: 3.560 Test Acc: 0.083
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 3.0289006
	speed: 0.2612s/iter; left time: 4864.1740s
	iters: 200, epoch: 11 | loss: 3.1298954
	speed: 0.0676s/iter; left time: 1252.8513s
Epoch: 11 cost time: 15.204874038696289
Epoch: 11, Steps: 208 | Train Loss: 2.614 Vali Loss: 3.519 Vali Acc: 0.091 Test Loss: 3.519 Test Acc: 0.091
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 2.5414691
	speed: 0.2650s/iter; left time: 4878.9104s
	iters: 200, epoch: 12 | loss: 2.9045513
	speed: 0.0700s/iter; left time: 1282.4123s
Epoch: 12 cost time: 15.336353302001953
Epoch: 12, Steps: 208 | Train Loss: 2.451 Vali Loss: 3.568 Vali Acc: 0.104 Test Loss: 3.568 Test Acc: 0.104
Validation loss decreased (-0.091823 --> -0.103752).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.0226626
	speed: 0.2370s/iter; left time: 4315.2909s
	iters: 200, epoch: 13 | loss: 2.2059326
	speed: 0.0628s/iter; left time: 1136.6516s
Epoch: 13 cost time: 13.497505903244019
Epoch: 13, Steps: 208 | Train Loss: 2.266 Vali Loss: 3.684 Vali Acc: 0.100 Test Loss: 3.684 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 2.2126412
	speed: 0.2437s/iter; left time: 4385.6907s
	iters: 200, epoch: 14 | loss: 2.5467787
	speed: 0.0712s/iter; left time: 1274.0156s
Epoch: 14 cost time: 15.650874853134155
Epoch: 14, Steps: 208 | Train Loss: 2.091 Vali Loss: 3.799 Vali Acc: 0.099 Test Loss: 3.799 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 2.1845405
	speed: 0.2497s/iter; left time: 4441.4601s
	iters: 200, epoch: 15 | loss: 2.5987313
	speed: 0.0696s/iter; left time: 1231.6121s
Epoch: 15 cost time: 14.882893800735474
Epoch: 15, Steps: 208 | Train Loss: 1.907 Vali Loss: 3.998 Vali Acc: 0.100 Test Loss: 3.998 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.3905511
	speed: 0.2597s/iter; left time: 4566.6439s
	iters: 200, epoch: 16 | loss: 1.6309730
	speed: 0.0707s/iter; left time: 1235.9990s
Epoch: 16 cost time: 15.484432458877563
Epoch: 16, Steps: 208 | Train Loss: 1.724 Vali Loss: 4.135 Vali Acc: 0.086 Test Loss: 4.135 Test Acc: 0.086
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.4012440
	speed: 0.2608s/iter; left time: 4531.0275s
	iters: 200, epoch: 17 | loss: 1.9686478
	speed: 0.0707s/iter; left time: 1221.9868s
Epoch: 17 cost time: 15.634907960891724
Epoch: 17, Steps: 208 | Train Loss: 1.575 Vali Loss: 4.230 Vali Acc: 0.088 Test Loss: 4.230 Test Acc: 0.088
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.4760244
	speed: 0.2636s/iter; left time: 4525.4273s
	iters: 200, epoch: 18 | loss: 1.9173443
	speed: 0.0685s/iter; left time: 1169.1407s
Epoch: 18 cost time: 15.307782888412476
Epoch: 18, Steps: 208 | Train Loss: 1.425 Vali Loss: 4.443 Vali Acc: 0.101 Test Loss: 4.443 Test Acc: 0.101
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.9477797
	speed: 0.2652s/iter; left time: 4497.3770s
	iters: 200, epoch: 19 | loss: 1.2399662
	speed: 0.0713s/iter; left time: 1201.7141s
Epoch: 19 cost time: 15.813169240951538
Epoch: 19, Steps: 208 | Train Loss: 1.276 Vali Loss: 4.601 Vali Acc: 0.089 Test Loss: 4.601 Test Acc: 0.089
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 1.8328568
	speed: 0.2560s/iter; left time: 4288.3075s
	iters: 200, epoch: 20 | loss: 1.5357567
	speed: 0.0675s/iter; left time: 1123.1266s
Epoch: 20 cost time: 14.830692529678345
Epoch: 20, Steps: 208 | Train Loss: 1.150 Vali Loss: 4.750 Vali Acc: 0.095 Test Loss: 4.750 Test Acc: 0.095
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 1.0055954
	speed: 0.2687s/iter; left time: 4444.9079s
	iters: 200, epoch: 21 | loss: 0.9822547
	speed: 0.0713s/iter; left time: 1171.8947s
Epoch: 21 cost time: 15.882880210876465
Epoch: 21, Steps: 208 | Train Loss: 1.010 Vali Loss: 5.012 Vali Acc: 0.091 Test Loss: 5.012 Test Acc: 0.091
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.6198581
	speed: 0.2611s/iter; left time: 4264.4520s
	iters: 200, epoch: 22 | loss: 0.9130518
	speed: 0.0758s/iter; left time: 1230.8156s
Epoch: 22 cost time: 15.737319231033325
Epoch: 22, Steps: 208 | Train Loss: 0.944 Vali Loss: 5.192 Vali Acc: 0.092 Test Loss: 5.192 Test Acc: 0.092
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10378765284819565
model parameter : 668887
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5449066
	speed: 0.0910s/iter; left time: 1884.0973s
	iters: 200, epoch: 1 | loss: 4.2638354
	speed: 0.0682s/iter; left time: 1404.6315s
Epoch: 1 cost time: 16.585376262664795
Epoch: 1, Steps: 208 | Train Loss: 3.701 Vali Loss: 3.709 Vali Acc: 0.047 Test Loss: 3.709 Test Acc: 0.047
Validation loss decreased (inf --> -0.047383).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7286677
	speed: 0.2484s/iter; left time: 5091.2189s
	iters: 200, epoch: 2 | loss: 3.8190713
	speed: 0.0719s/iter; left time: 1465.7913s
Epoch: 2 cost time: 15.580647706985474
Epoch: 2, Steps: 208 | Train Loss: 3.587 Vali Loss: 3.596 Vali Acc: 0.066 Test Loss: 3.596 Test Acc: 0.066
Validation loss decreased (-0.047383 --> -0.065577).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5626462
	speed: 0.2595s/iter; left time: 5263.4941s
	iters: 200, epoch: 3 | loss: 3.4386322
	speed: 0.0679s/iter; left time: 1370.8506s
Epoch: 3 cost time: 14.583523511886597
Epoch: 3, Steps: 208 | Train Loss: 3.521 Vali Loss: 3.509 Vali Acc: 0.066 Test Loss: 3.509 Test Acc: 0.066
Validation loss decreased (-0.065577 --> -0.066174).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3499551
	speed: 0.2466s/iter; left time: 4951.6324s
	iters: 200, epoch: 4 | loss: 3.6993902
	speed: 0.0704s/iter; left time: 1406.1374s
Epoch: 4 cost time: 15.17246699333191
Epoch: 4, Steps: 208 | Train Loss: 3.429 Vali Loss: 3.533 Vali Acc: 0.068 Test Loss: 3.533 Test Acc: 0.068
Validation loss decreased (-0.066174 --> -0.068262).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.9489393
	speed: 0.2648s/iter; left time: 5261.7873s
	iters: 200, epoch: 5 | loss: 2.9699626
	speed: 0.0673s/iter; left time: 1330.5554s
Epoch: 5 cost time: 14.612845659255981
Epoch: 5, Steps: 208 | Train Loss: 3.356 Vali Loss: 3.482 Vali Acc: 0.068 Test Loss: 3.482 Test Acc: 0.068
Validation loss decreased (-0.068262 --> -0.068262).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.3246324
	speed: 0.2485s/iter; left time: 4885.2600s
	iters: 200, epoch: 6 | loss: 3.1573362
	speed: 0.0738s/iter; left time: 1442.9129s
Epoch: 6 cost time: 15.607261419296265
Epoch: 6, Steps: 208 | Train Loss: 3.277 Vali Loss: 3.447 Vali Acc: 0.069 Test Loss: 3.447 Test Acc: 0.069
Validation loss decreased (-0.068262 --> -0.068561).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.2675385
	speed: 0.2579s/iter; left time: 5016.4016s
	iters: 200, epoch: 7 | loss: 3.1215317
	speed: 0.0712s/iter; left time: 1377.9435s
Epoch: 7 cost time: 15.43135404586792
Epoch: 7, Steps: 208 | Train Loss: 3.186 Vali Loss: 3.490 Vali Acc: 0.080 Test Loss: 3.490 Test Acc: 0.080
Validation loss decreased (-0.068561 --> -0.079894).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.1355927
	speed: 0.2519s/iter; left time: 4847.3996s
	iters: 200, epoch: 8 | loss: 3.4667344
	speed: 0.0684s/iter; left time: 1309.7906s
Epoch: 8 cost time: 15.080830097198486
Epoch: 8, Steps: 208 | Train Loss: 3.102 Vali Loss: 3.488 Vali Acc: 0.084 Test Loss: 3.488 Test Acc: 0.084
Validation loss decreased (-0.079894 --> -0.083771).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.8426065
	speed: 0.2400s/iter; left time: 4569.0142s
	iters: 200, epoch: 9 | loss: 3.3129678
	speed: 0.0667s/iter; left time: 1263.0605s
Epoch: 9 cost time: 14.347591638565063
Epoch: 9, Steps: 208 | Train Loss: 2.958 Vali Loss: 3.455 Vali Acc: 0.093 Test Loss: 3.455 Test Acc: 0.093
Validation loss decreased (-0.083771 --> -0.092718).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.7774489
	speed: 0.2556s/iter; left time: 4813.2753s
	iters: 200, epoch: 10 | loss: 2.8955481
	speed: 0.0697s/iter; left time: 1306.2932s
Epoch: 10 cost time: 15.048491716384888
Epoch: 10, Steps: 208 | Train Loss: 2.843 Vali Loss: 3.611 Vali Acc: 0.092 Test Loss: 3.611 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 3.6256349
	speed: 0.2538s/iter; left time: 4725.3211s
	iters: 200, epoch: 11 | loss: 3.1391182
	speed: 0.0692s/iter; left time: 1280.7430s
Epoch: 11 cost time: 15.044098138809204
Epoch: 11, Steps: 208 | Train Loss: 2.706 Vali Loss: 3.563 Vali Acc: 0.089 Test Loss: 3.563 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 2.4949918
	speed: 0.2513s/iter; left time: 4626.8741s
	iters: 200, epoch: 12 | loss: 2.6174622
	speed: 0.0704s/iter; left time: 1288.3564s
Epoch: 12 cost time: 15.2299964427948
Epoch: 12, Steps: 208 | Train Loss: 2.523 Vali Loss: 3.675 Vali Acc: 0.096 Test Loss: 3.675 Test Acc: 0.096
Validation loss decreased (-0.092718 --> -0.095997).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.2272267
	speed: 0.2467s/iter; left time: 4491.9028s
	iters: 200, epoch: 13 | loss: 2.4227674
	speed: 0.0719s/iter; left time: 1302.0103s
Epoch: 13 cost time: 15.394824743270874
Epoch: 13, Steps: 208 | Train Loss: 2.333 Vali Loss: 3.780 Vali Acc: 0.098 Test Loss: 3.780 Test Acc: 0.098
Validation loss decreased (-0.095997 --> -0.097487).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.7956868
	speed: 0.2669s/iter; left time: 4804.2800s
	iters: 200, epoch: 14 | loss: 2.5920708
	speed: 0.0751s/iter; left time: 1343.7838s
Epoch: 14 cost time: 16.441238164901733
Epoch: 14, Steps: 208 | Train Loss: 2.172 Vali Loss: 3.853 Vali Acc: 0.101 Test Loss: 3.853 Test Acc: 0.101
Validation loss decreased (-0.097487 --> -0.101363).  Saving model ...
	iters: 100, epoch: 15 | loss: 2.1375830
	speed: 0.2851s/iter; left time: 5071.5839s
	iters: 200, epoch: 15 | loss: 2.1474378
	speed: 0.0714s/iter; left time: 1263.1670s
Epoch: 15 cost time: 15.680341958999634
Epoch: 15, Steps: 208 | Train Loss: 1.976 Vali Loss: 3.910 Vali Acc: 0.102 Test Loss: 3.910 Test Acc: 0.102
Validation loss decreased (-0.101363 --> -0.102257).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.8793091
	speed: 0.2713s/iter; left time: 4769.1359s
	iters: 200, epoch: 16 | loss: 2.0085976
	speed: 0.0719s/iter; left time: 1257.4872s
Epoch: 16 cost time: 15.503555297851562
Epoch: 16, Steps: 208 | Train Loss: 1.806 Vali Loss: 4.061 Vali Acc: 0.098 Test Loss: 4.061 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.1633795
	speed: 0.2701s/iter; left time: 4692.4314s
	iters: 200, epoch: 17 | loss: 1.6670668
	speed: 0.0672s/iter; left time: 1160.8298s
Epoch: 17 cost time: 15.651902437210083
Epoch: 17, Steps: 208 | Train Loss: 1.622 Vali Loss: 4.228 Vali Acc: 0.101 Test Loss: 4.228 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.3062060
	speed: 0.2239s/iter; left time: 3843.2030s
	iters: 200, epoch: 18 | loss: 1.9752436
	speed: 0.0700s/iter; left time: 1195.3444s
Epoch: 18 cost time: 14.724692106246948
Epoch: 18, Steps: 208 | Train Loss: 1.464 Vali Loss: 4.417 Vali Acc: 0.092 Test Loss: 4.417 Test Acc: 0.092
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.8628790
	speed: 0.2661s/iter; left time: 4512.2145s
	iters: 200, epoch: 19 | loss: 1.4533111
	speed: 0.0696s/iter; left time: 1173.9801s
Epoch: 19 cost time: 15.450108289718628
Epoch: 19, Steps: 208 | Train Loss: 1.302 Vali Loss: 4.676 Vali Acc: 0.093 Test Loss: 4.676 Test Acc: 0.093
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 1.4978710
	speed: 0.2530s/iter; left time: 4237.7431s
	iters: 200, epoch: 20 | loss: 1.2810252
	speed: 0.0660s/iter; left time: 1098.1700s
Epoch: 20 cost time: 14.65769624710083
Epoch: 20, Steps: 208 | Train Loss: 1.161 Vali Loss: 4.930 Vali Acc: 0.096 Test Loss: 4.930 Test Acc: 0.096
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.7777308
	speed: 0.2497s/iter; left time: 4129.4864s
	iters: 200, epoch: 21 | loss: 1.1756392
	speed: 0.0668s/iter; left time: 1098.6485s
Epoch: 21 cost time: 14.853329420089722
Epoch: 21, Steps: 208 | Train Loss: 1.066 Vali Loss: 5.108 Vali Acc: 0.092 Test Loss: 5.108 Test Acc: 0.092
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.3425316
	speed: 0.2558s/iter; left time: 4177.3984s
	iters: 200, epoch: 22 | loss: 1.2868947
	speed: 0.0678s/iter; left time: 1099.9821s
Epoch: 22 cost time: 15.06224250793457
Epoch: 22, Steps: 208 | Train Loss: 0.944 Vali Loss: 5.067 Vali Acc: 0.096 Test Loss: 5.067 Test Acc: 0.096
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.7422292
	speed: 0.2551s/iter; left time: 4113.6519s
	iters: 200, epoch: 23 | loss: 0.9607291
	speed: 0.0686s/iter; left time: 1099.8827s
Epoch: 23 cost time: 15.242802381515503
Epoch: 23, Steps: 208 | Train Loss: 0.874 Vali Loss: 5.573 Vali Acc: 0.090 Test Loss: 5.573 Test Acc: 0.090
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.9308628
	speed: 0.2616s/iter; left time: 4163.7287s
	iters: 200, epoch: 24 | loss: 1.5497596
	speed: 0.0708s/iter; left time: 1119.4201s
Epoch: 24 cost time: 15.88122034072876
Epoch: 24, Steps: 208 | Train Loss: 0.818 Vali Loss: 5.583 Vali Acc: 0.096 Test Loss: 5.583 Test Acc: 0.096
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 1.0443541
	speed: 0.2450s/iter; left time: 3848.8947s
	iters: 200, epoch: 25 | loss: 0.5222760
	speed: 0.0704s/iter; left time: 1099.2511s
Epoch: 25 cost time: 14.838917016983032
Epoch: 25, Steps: 208 | Train Loss: 0.766 Vali Loss: 5.686 Vali Acc: 0.091 Test Loss: 5.686 Test Acc: 0.091
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1022964509394572
model parameter : 667799
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6640601
	speed: 0.0908s/iter; left time: 1880.5185s
	iters: 200, epoch: 1 | loss: 3.7282090
	speed: 0.0722s/iter; left time: 1486.9958s
Epoch: 1 cost time: 16.95124912261963
Epoch: 1, Steps: 208 | Train Loss: 3.674 Vali Loss: 3.645 Vali Acc: 0.059 Test Loss: 3.645 Test Acc: 0.059
Validation loss decreased (inf --> -0.059313).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5859747
	speed: 0.2568s/iter; left time: 5263.0082s
	iters: 200, epoch: 2 | loss: 3.8028769
	speed: 0.0682s/iter; left time: 1390.2346s
Epoch: 2 cost time: 14.722530841827393
Epoch: 2, Steps: 208 | Train Loss: 3.564 Vali Loss: 3.533 Vali Acc: 0.064 Test Loss: 3.533 Test Acc: 0.064
Validation loss decreased (-0.059313 --> -0.064086).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3376436
	speed: 0.2662s/iter; left time: 5400.3582s
	iters: 200, epoch: 3 | loss: 3.2002909
	speed: 0.0759s/iter; left time: 1532.7605s
Epoch: 3 cost time: 16.51876211166382
Epoch: 3, Steps: 208 | Train Loss: 3.493 Vali Loss: 3.509 Vali Acc: 0.063 Test Loss: 3.509 Test Acc: 0.063
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.3406456
	speed: 0.2734s/iter; left time: 5488.5735s
	iters: 200, epoch: 4 | loss: 4.0192146
	speed: 0.0709s/iter; left time: 1415.9907s
Epoch: 4 cost time: 15.386510610580444
Epoch: 4, Steps: 208 | Train Loss: 3.431 Vali Loss: 3.450 Vali Acc: 0.074 Test Loss: 3.450 Test Acc: 0.074
Validation loss decreased (-0.064086 --> -0.073631).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.4018617
	speed: 0.2757s/iter; left time: 5478.4740s
	iters: 200, epoch: 5 | loss: 3.4004335
	speed: 0.0716s/iter; left time: 1415.7074s
Epoch: 5 cost time: 15.80496096611023
Epoch: 5, Steps: 208 | Train Loss: 3.358 Vali Loss: 3.468 Vali Acc: 0.077 Test Loss: 3.468 Test Acc: 0.077
Validation loss decreased (-0.073631 --> -0.076911).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.3293402
	speed: 0.2740s/iter; left time: 5386.2499s
	iters: 200, epoch: 6 | loss: 3.5667124
	speed: 0.0731s/iter; left time: 1430.3260s
Epoch: 6 cost time: 15.860409498214722
Epoch: 6, Steps: 208 | Train Loss: 3.295 Vali Loss: 3.507 Vali Acc: 0.075 Test Loss: 3.507 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.9815905
	speed: 0.2650s/iter; left time: 5154.6612s
	iters: 200, epoch: 7 | loss: 3.7693608
	speed: 0.0684s/iter; left time: 1324.5721s
Epoch: 7 cost time: 14.94230580329895
Epoch: 7, Steps: 208 | Train Loss: 3.206 Vali Loss: 3.466 Vali Acc: 0.082 Test Loss: 3.466 Test Acc: 0.082
Validation loss decreased (-0.076911 --> -0.081683).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.1954095
	speed: 0.2488s/iter; left time: 4788.3732s
	iters: 200, epoch: 8 | loss: 2.9024816
	speed: 0.0731s/iter; left time: 1399.7882s
Epoch: 8 cost time: 15.58204698562622
Epoch: 8, Steps: 208 | Train Loss: 3.090 Vali Loss: 3.462 Vali Acc: 0.075 Test Loss: 3.462 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.8821235
	speed: 0.2643s/iter; left time: 5030.6659s
	iters: 200, epoch: 9 | loss: 2.5158041
	speed: 0.0678s/iter; left time: 1283.0505s
Epoch: 9 cost time: 15.01135516166687
Epoch: 9, Steps: 208 | Train Loss: 2.949 Vali Loss: 3.397 Vali Acc: 0.093 Test Loss: 3.397 Test Acc: 0.093
Validation loss decreased (-0.081683 --> -0.092719).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.3797977
	speed: 0.2505s/iter; left time: 4717.1030s
	iters: 200, epoch: 10 | loss: 3.1043537
	speed: 0.0686s/iter; left time: 1283.9905s
Epoch: 10 cost time: 14.903275728225708
Epoch: 10, Steps: 208 | Train Loss: 2.790 Vali Loss: 3.459 Vali Acc: 0.101 Test Loss: 3.459 Test Acc: 0.101
Validation loss decreased (-0.092719 --> -0.100472).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.3733728
	speed: 0.2558s/iter; left time: 4762.9040s
	iters: 200, epoch: 11 | loss: 2.5814304
	speed: 0.0704s/iter; left time: 1304.0871s
Epoch: 11 cost time: 14.953192710876465
Epoch: 11, Steps: 208 | Train Loss: 2.642 Vali Loss: 3.500 Vali Acc: 0.093 Test Loss: 3.500 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.4080551
	speed: 0.2383s/iter; left time: 4387.3172s
	iters: 200, epoch: 12 | loss: 2.5290422
	speed: 0.0639s/iter; left time: 1170.1917s
Epoch: 12 cost time: 13.943134307861328
Epoch: 12, Steps: 208 | Train Loss: 2.468 Vali Loss: 3.512 Vali Acc: 0.110 Test Loss: 3.512 Test Acc: 0.110
Validation loss decreased (-0.100472 --> -0.110016).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.2039831
	speed: 0.2492s/iter; left time: 4535.9387s
	iters: 200, epoch: 13 | loss: 2.4846051
	speed: 0.0696s/iter; left time: 1259.8999s
Epoch: 13 cost time: 14.743985176086426
Epoch: 13, Steps: 208 | Train Loss: 2.276 Vali Loss: 3.647 Vali Acc: 0.103 Test Loss: 3.647 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.9467611
	speed: 0.2650s/iter; left time: 4768.4618s
	iters: 200, epoch: 14 | loss: 1.8400527
	speed: 0.0706s/iter; left time: 1264.0290s
Epoch: 14 cost time: 15.52891206741333
Epoch: 14, Steps: 208 | Train Loss: 2.079 Vali Loss: 3.727 Vali Acc: 0.104 Test Loss: 3.727 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 2.0130324
	speed: 0.2478s/iter; left time: 4407.5792s
	iters: 200, epoch: 15 | loss: 2.0002646
	speed: 0.0707s/iter; left time: 1250.6277s
Epoch: 15 cost time: 15.186260223388672
Epoch: 15, Steps: 208 | Train Loss: 1.899 Vali Loss: 3.869 Vali Acc: 0.101 Test Loss: 3.869 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.6767919
	speed: 0.2670s/iter; left time: 4694.4587s
	iters: 200, epoch: 16 | loss: 1.4555265
	speed: 0.0706s/iter; left time: 1234.6913s
Epoch: 16 cost time: 15.291780948638916
Epoch: 16, Steps: 208 | Train Loss: 1.723 Vali Loss: 4.078 Vali Acc: 0.092 Test Loss: 4.078 Test Acc: 0.092
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.2926451
	speed: 0.2553s/iter; left time: 4434.8150s
	iters: 200, epoch: 17 | loss: 1.7399889
	speed: 0.0737s/iter; left time: 1272.5901s
Epoch: 17 cost time: 15.51111626625061
Epoch: 17, Steps: 208 | Train Loss: 1.517 Vali Loss: 4.234 Vali Acc: 0.103 Test Loss: 4.234 Test Acc: 0.103
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.4678422
	speed: 0.2571s/iter; left time: 4413.2817s
	iters: 200, epoch: 18 | loss: 1.4914229
	speed: 0.0719s/iter; left time: 1227.6954s
Epoch: 18 cost time: 14.913605213165283
Epoch: 18, Steps: 208 | Train Loss: 1.392 Vali Loss: 4.398 Vali Acc: 0.092 Test Loss: 4.398 Test Acc: 0.092
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 1.3506626
	speed: 0.2750s/iter; left time: 4664.0054s
	iters: 200, epoch: 19 | loss: 1.6468694
	speed: 0.0714s/iter; left time: 1203.4609s
Epoch: 19 cost time: 15.749163627624512
Epoch: 19, Steps: 208 | Train Loss: 1.233 Vali Loss: 4.743 Vali Acc: 0.097 Test Loss: 4.743 Test Acc: 0.097
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.9250437
	speed: 0.2813s/iter; left time: 4711.8449s
	iters: 200, epoch: 20 | loss: 0.9032719
	speed: 0.0742s/iter; left time: 1235.1390s
Epoch: 20 cost time: 16.403061389923096
Epoch: 20, Steps: 208 | Train Loss: 1.115 Vali Loss: 4.882 Vali Acc: 0.094 Test Loss: 4.882 Test Acc: 0.094
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.6303718
	speed: 0.2722s/iter; left time: 4501.7473s
	iters: 200, epoch: 21 | loss: 0.8933053
	speed: 0.0703s/iter; left time: 1155.7079s
Epoch: 21 cost time: 15.722201585769653
Epoch: 21, Steps: 208 | Train Loss: 0.998 Vali Loss: 5.200 Vali Acc: 0.098 Test Loss: 5.200 Test Acc: 0.098
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 1.0956784
	speed: 0.2799s/iter; left time: 4571.4288s
	iters: 200, epoch: 22 | loss: 1.0739791
	speed: 0.0767s/iter; left time: 1244.6164s
Epoch: 22 cost time: 16.801746606826782
Epoch: 22, Steps: 208 | Train Loss: 0.883 Vali Loss: 5.286 Vali Acc: 0.099 Test Loss: 5.286 Test Acc: 0.099
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11005070086489711
model parameter : 666711
model size : 3.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7381513
	speed: 0.0739s/iter; left time: 1530.8089s
	iters: 200, epoch: 1 | loss: 3.0792580
	speed: 0.0626s/iter; left time: 1288.8652s
Epoch: 1 cost time: 14.35034728050232
Epoch: 1, Steps: 208 | Train Loss: 3.695 Vali Loss: 3.634 Vali Acc: 0.047 Test Loss: 3.634 Test Acc: 0.047
Validation loss decreased (inf --> -0.046489).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7224920
	speed: 0.2424s/iter; left time: 4966.8439s
	iters: 200, epoch: 2 | loss: 3.3819301
	speed: 0.0657s/iter; left time: 1339.8508s
Epoch: 2 cost time: 14.229247808456421
Epoch: 2, Steps: 208 | Train Loss: 3.609 Vali Loss: 3.549 Vali Acc: 0.063 Test Loss: 3.549 Test Acc: 0.063
Validation loss decreased (-0.046489 --> -0.062893).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3778653
	speed: 0.2413s/iter; left time: 4894.4906s
	iters: 200, epoch: 3 | loss: 3.9026237
	speed: 0.0656s/iter; left time: 1323.7714s
Epoch: 3 cost time: 14.111560344696045
Epoch: 3, Steps: 208 | Train Loss: 3.494 Vali Loss: 3.520 Vali Acc: 0.066 Test Loss: 3.520 Test Acc: 0.066
Validation loss decreased (-0.062893 --> -0.066174).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.5201972
	speed: 0.2541s/iter; left time: 5101.3417s
	iters: 200, epoch: 4 | loss: 3.1981788
	speed: 0.0671s/iter; left time: 1339.7551s
Epoch: 4 cost time: 15.002603769302368
Epoch: 4, Steps: 208 | Train Loss: 3.411 Vali Loss: 3.507 Vali Acc: 0.078 Test Loss: 3.507 Test Acc: 0.078
Validation loss decreased (-0.066174 --> -0.077507).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.6127799
	speed: 0.2432s/iter; left time: 4831.2429s
	iters: 200, epoch: 5 | loss: 3.2221329
	speed: 0.0662s/iter; left time: 1309.0526s
Epoch: 5 cost time: 14.187731981277466
Epoch: 5, Steps: 208 | Train Loss: 3.315 Vali Loss: 3.525 Vali Acc: 0.071 Test Loss: 3.525 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.1171410
	speed: 0.2408s/iter; left time: 4733.4801s
	iters: 200, epoch: 6 | loss: 3.4135787
	speed: 0.0657s/iter; left time: 1284.5082s
Epoch: 6 cost time: 14.194648504257202
Epoch: 6, Steps: 208 | Train Loss: 3.250 Vali Loss: 3.469 Vali Acc: 0.068 Test Loss: 3.469 Test Acc: 0.068
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 3.0496736
	speed: 0.2524s/iter; left time: 4910.2000s
	iters: 200, epoch: 7 | loss: 3.1568189
	speed: 0.0681s/iter; left time: 1318.8704s
Epoch: 7 cost time: 14.88779354095459
Epoch: 7, Steps: 208 | Train Loss: 3.171 Vali Loss: 3.459 Vali Acc: 0.083 Test Loss: 3.459 Test Acc: 0.083
Validation loss decreased (-0.077507 --> -0.082876).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.7770982
	speed: 0.2530s/iter; left time: 4869.5018s
	iters: 200, epoch: 8 | loss: 3.1642613
	speed: 0.0670s/iter; left time: 1282.6218s
Epoch: 8 cost time: 14.920191526412964
Epoch: 8, Steps: 208 | Train Loss: 3.032 Vali Loss: 3.455 Vali Acc: 0.084 Test Loss: 3.455 Test Acc: 0.084
Validation loss decreased (-0.082876 --> -0.083771).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.1618443
	speed: 0.2482s/iter; left time: 4724.2626s
	iters: 200, epoch: 9 | loss: 3.0491261
	speed: 0.0715s/iter; left time: 1354.2185s
Epoch: 9 cost time: 15.195914268493652
Epoch: 9, Steps: 208 | Train Loss: 2.904 Vali Loss: 3.387 Vali Acc: 0.102 Test Loss: 3.387 Test Acc: 0.102
Validation loss decreased (-0.083771 --> -0.102263).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.8419702
	speed: 0.2373s/iter; left time: 4468.0219s
	iters: 200, epoch: 10 | loss: 2.6673017
	speed: 0.0661s/iter; left time: 1237.1578s
Epoch: 10 cost time: 14.024617671966553
Epoch: 10, Steps: 208 | Train Loss: 2.787 Vali Loss: 3.446 Vali Acc: 0.094 Test Loss: 3.446 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.6974385
	speed: 0.2521s/iter; left time: 4694.3124s
	iters: 200, epoch: 11 | loss: 2.8328104
	speed: 0.0714s/iter; left time: 1322.6551s
Epoch: 11 cost time: 15.2354896068573
Epoch: 11, Steps: 208 | Train Loss: 2.634 Vali Loss: 3.525 Vali Acc: 0.104 Test Loss: 3.525 Test Acc: 0.104
Validation loss decreased (-0.102263 --> -0.104349).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.4657090
	speed: 0.2703s/iter; left time: 4976.8949s
	iters: 200, epoch: 12 | loss: 3.1369560
	speed: 0.0686s/iter; left time: 1255.8226s
Epoch: 12 cost time: 15.32585072517395
Epoch: 12, Steps: 208 | Train Loss: 2.465 Vali Loss: 3.546 Vali Acc: 0.103 Test Loss: 3.546 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.2483587
	speed: 0.2662s/iter; left time: 4845.2845s
	iters: 200, epoch: 13 | loss: 2.5448368
	speed: 0.0664s/iter; left time: 1202.9475s
Epoch: 13 cost time: 14.963136911392212
Epoch: 13, Steps: 208 | Train Loss: 2.320 Vali Loss: 3.657 Vali Acc: 0.103 Test Loss: 3.657 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.7703625
	speed: 0.2633s/iter; left time: 4739.2720s
	iters: 200, epoch: 14 | loss: 2.3250594
	speed: 0.0733s/iter; left time: 1311.3657s
Epoch: 14 cost time: 15.97508716583252
Epoch: 14, Steps: 208 | Train Loss: 2.140 Vali Loss: 3.782 Vali Acc: 0.102 Test Loss: 3.782 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 2.0868542
	speed: 0.2607s/iter; left time: 4637.3074s
	iters: 200, epoch: 15 | loss: 2.2463844
	speed: 0.0675s/iter; left time: 1194.6506s
Epoch: 15 cost time: 14.775059700012207
Epoch: 15, Steps: 208 | Train Loss: 1.970 Vali Loss: 3.843 Vali Acc: 0.101 Test Loss: 3.843 Test Acc: 0.101
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.9894538
	speed: 0.2411s/iter; left time: 4238.4013s
	iters: 200, epoch: 16 | loss: 1.7101690
	speed: 0.0667s/iter; left time: 1165.2120s
Epoch: 16 cost time: 14.418678045272827
Epoch: 16, Steps: 208 | Train Loss: 1.799 Vali Loss: 3.995 Vali Acc: 0.098 Test Loss: 3.995 Test Acc: 0.098
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.9638246
	speed: 0.2578s/iter; left time: 4479.0290s
	iters: 200, epoch: 17 | loss: 1.3663201
	speed: 0.0672s/iter; left time: 1161.3233s
Epoch: 17 cost time: 15.199773073196411
Epoch: 17, Steps: 208 | Train Loss: 1.604 Vali Loss: 4.291 Vali Acc: 0.101 Test Loss: 4.291 Test Acc: 0.101
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.1501395
	speed: 0.2437s/iter; left time: 4182.8605s
	iters: 200, epoch: 18 | loss: 1.1271985
	speed: 0.0655s/iter; left time: 1118.2060s
Epoch: 18 cost time: 14.436918497085571
Epoch: 18, Steps: 208 | Train Loss: 1.473 Vali Loss: 4.348 Vali Acc: 0.103 Test Loss: 4.348 Test Acc: 0.103
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.6249299
	speed: 0.2468s/iter; left time: 4184.2031s
	iters: 200, epoch: 19 | loss: 1.2351161
	speed: 0.0714s/iter; left time: 1203.5268s
Epoch: 19 cost time: 15.306470155715942
Epoch: 19, Steps: 208 | Train Loss: 1.279 Vali Loss: 4.504 Vali Acc: 0.104 Test Loss: 4.504 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.0847584
	speed: 0.2510s/iter; left time: 4203.4450s
	iters: 200, epoch: 20 | loss: 1.3866957
	speed: 0.0670s/iter; left time: 1115.7935s
Epoch: 20 cost time: 14.937744617462158
Epoch: 20, Steps: 208 | Train Loss: 1.188 Vali Loss: 4.688 Vali Acc: 0.103 Test Loss: 4.688 Test Acc: 0.103
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 1.6692656
	speed: 0.2425s/iter; left time: 4011.5869s
	iters: 200, epoch: 21 | loss: 0.8383839
	speed: 0.0670s/iter; left time: 1100.8408s
Epoch: 21 cost time: 14.589473724365234
Epoch: 21, Steps: 208 | Train Loss: 1.093 Vali Loss: 4.809 Vali Acc: 0.108 Test Loss: 4.809 Test Acc: 0.108
Validation loss decreased (-0.104349 --> -0.108213).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.9648483
	speed: 0.2573s/iter; left time: 4202.2834s
	iters: 200, epoch: 22 | loss: 1.2349590
	speed: 0.0667s/iter; left time: 1082.2944s
Epoch: 22 cost time: 14.8062744140625
Epoch: 22, Steps: 208 | Train Loss: 0.984 Vali Loss: 5.042 Vali Acc: 0.103 Test Loss: 5.042 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.8169679
	speed: 0.2501s/iter; left time: 4032.5482s
	iters: 200, epoch: 23 | loss: 1.1217928
	speed: 0.0691s/iter; left time: 1107.1972s
Epoch: 23 cost time: 14.988998889923096
Epoch: 23, Steps: 208 | Train Loss: 0.891 Vali Loss: 5.332 Vali Acc: 0.109 Test Loss: 5.332 Test Acc: 0.109
Validation loss decreased (-0.108213 --> -0.109401).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.4898393
	speed: 0.2630s/iter; left time: 4186.6504s
	iters: 200, epoch: 24 | loss: 1.5284138
	speed: 0.0667s/iter; left time: 1055.5033s
Epoch: 24 cost time: 15.035603284835815
Epoch: 24, Steps: 208 | Train Loss: 0.824 Vali Loss: 5.320 Vali Acc: 0.096 Test Loss: 5.320 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.1249034
	speed: 0.2472s/iter; left time: 3882.5337s
	iters: 200, epoch: 25 | loss: 1.4112356
	speed: 0.0660s/iter; left time: 1029.8322s
Epoch: 25 cost time: 14.908063173294067
Epoch: 25, Steps: 208 | Train Loss: 0.744 Vali Loss: 5.843 Vali Acc: 0.102 Test Loss: 5.843 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.5557862
	speed: 0.2346s/iter; left time: 3636.3951s
	iters: 200, epoch: 26 | loss: 0.9912857
	speed: 0.0630s/iter; left time: 970.4234s
Epoch: 26 cost time: 13.83387804031372
Epoch: 26, Steps: 208 | Train Loss: 0.712 Vali Loss: 5.769 Vali Acc: 0.095 Test Loss: 5.769 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.8653095
	speed: 0.2531s/iter; left time: 3871.3077s
	iters: 200, epoch: 27 | loss: 1.0084060
	speed: 0.0706s/iter; left time: 1072.4316s
Epoch: 27 cost time: 16.013087034225464
Epoch: 27, Steps: 208 | Train Loss: 0.676 Vali Loss: 6.141 Vali Acc: 0.102 Test Loss: 6.141 Test Acc: 0.102
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.1812661
	speed: 0.2560s/iter; left time: 3861.6754s
	iters: 200, epoch: 28 | loss: 0.9590963
	speed: 0.0729s/iter; left time: 1092.8043s
Epoch: 28 cost time: 15.557631254196167
Epoch: 28, Steps: 208 | Train Loss: 0.645 Vali Loss: 6.186 Vali Acc: 0.095 Test Loss: 6.186 Test Acc: 0.095
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.4285287
	speed: 0.2635s/iter; left time: 3919.6059s
	iters: 200, epoch: 29 | loss: 0.4146174
	speed: 0.0733s/iter; left time: 1083.3850s
Epoch: 29 cost time: 15.789551734924316
Epoch: 29, Steps: 208 | Train Loss: 0.615 Vali Loss: 6.235 Vali Acc: 0.100 Test Loss: 6.235 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.5735878
	speed: 0.2630s/iter; left time: 3858.4227s
	iters: 200, epoch: 30 | loss: 0.4160011
	speed: 0.0734s/iter; left time: 1069.3807s
Epoch: 30 cost time: 15.651145696640015
Epoch: 30, Steps: 208 | Train Loss: 0.598 Vali Loss: 6.536 Vali Acc: 0.103 Test Loss: 6.536 Test Acc: 0.103
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.2452380
	speed: 0.2656s/iter; left time: 3841.0763s
	iters: 200, epoch: 31 | loss: 0.4475160
	speed: 0.0707s/iter; left time: 1015.8130s
Epoch: 31 cost time: 15.53415846824646
Epoch: 31, Steps: 208 | Train Loss: 0.535 Vali Loss: 6.561 Vali Acc: 0.104 Test Loss: 6.561 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.2278201
	speed: 0.2449s/iter; left time: 3490.6320s
	iters: 200, epoch: 32 | loss: 0.2863438
	speed: 0.0684s/iter; left time: 967.6956s
Epoch: 32 cost time: 14.706161499023438
Epoch: 32, Steps: 208 | Train Loss: 0.536 Vali Loss: 6.723 Vali Acc: 0.107 Test Loss: 6.723 Test Acc: 0.107
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 1.1038519
	speed: 0.2445s/iter; left time: 3433.5611s
	iters: 200, epoch: 33 | loss: 0.4432135
	speed: 0.0663s/iter; left time: 923.8863s
Epoch: 33 cost time: 14.249964475631714
Epoch: 33, Steps: 208 | Train Loss: 0.529 Vali Loss: 6.727 Vali Acc: 0.100 Test Loss: 6.727 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10945422010140173
model parameter : 665623
model size : 3.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5041916
	speed: 0.0938s/iter; left time: 1942.0746s
	iters: 200, epoch: 1 | loss: 3.5408034
	speed: 0.0666s/iter; left time: 1371.5336s
Epoch: 1 cost time: 16.740118980407715
Epoch: 1, Steps: 208 | Train Loss: 3.665 Vali Loss: 3.601 Vali Acc: 0.052 Test Loss: 3.601 Test Acc: 0.052
Validation loss decreased (inf --> -0.051560).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6592329
	speed: 0.2402s/iter; left time: 4922.2097s
	iters: 200, epoch: 2 | loss: 3.4492877
	speed: 0.0639s/iter; left time: 1302.4724s
Epoch: 2 cost time: 13.955453157424927
Epoch: 2, Steps: 208 | Train Loss: 3.570 Vali Loss: 3.592 Vali Acc: 0.066 Test Loss: 3.592 Test Acc: 0.066
Validation loss decreased (-0.051560 --> -0.065577).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6467957
	speed: 0.2450s/iter; left time: 4970.1882s
	iters: 200, epoch: 3 | loss: 3.3748066
	speed: 0.0729s/iter; left time: 1471.0240s
Epoch: 3 cost time: 15.482295274734497
Epoch: 3, Steps: 208 | Train Loss: 3.495 Vali Loss: 3.556 Vali Acc: 0.053 Test Loss: 3.556 Test Acc: 0.053
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.6105244
	speed: 0.2405s/iter; left time: 4827.6045s
	iters: 200, epoch: 4 | loss: 3.2623713
	speed: 0.0676s/iter; left time: 1350.1338s
Epoch: 4 cost time: 14.075664281845093
Epoch: 4, Steps: 208 | Train Loss: 3.404 Vali Loss: 3.512 Vali Acc: 0.068 Test Loss: 3.512 Test Acc: 0.068
Validation loss decreased (-0.065577 --> -0.067964).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3170166
	speed: 0.2576s/iter; left time: 5117.2698s
	iters: 200, epoch: 5 | loss: 3.3054278
	speed: 0.0714s/iter; left time: 1410.9712s
Epoch: 5 cost time: 15.221210479736328
Epoch: 5, Steps: 208 | Train Loss: 3.323 Vali Loss: 3.587 Vali Acc: 0.067 Test Loss: 3.587 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.4210966
	speed: 0.2548s/iter; left time: 5010.5729s
	iters: 200, epoch: 6 | loss: 3.3410304
	speed: 0.0698s/iter; left time: 1365.5930s
Epoch: 6 cost time: 14.981669187545776
Epoch: 6, Steps: 208 | Train Loss: 3.232 Vali Loss: 3.445 Vali Acc: 0.082 Test Loss: 3.445 Test Acc: 0.082
Validation loss decreased (-0.067964 --> -0.082280).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9253016
	speed: 0.2626s/iter; left time: 5107.4981s
	iters: 200, epoch: 7 | loss: 3.2969909
	speed: 0.0650s/iter; left time: 1258.7784s
Epoch: 7 cost time: 14.750015497207642
Epoch: 7, Steps: 208 | Train Loss: 3.092 Vali Loss: 3.395 Vali Acc: 0.089 Test Loss: 3.395 Test Acc: 0.089
Validation loss decreased (-0.082280 --> -0.088842).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.4401670
	speed: 0.2506s/iter; left time: 4822.4141s
	iters: 200, epoch: 8 | loss: 3.1013651
	speed: 0.0701s/iter; left time: 1341.5894s
Epoch: 8 cost time: 15.433243751525879
Epoch: 8, Steps: 208 | Train Loss: 2.915 Vali Loss: 3.363 Vali Acc: 0.100 Test Loss: 3.363 Test Acc: 0.100
Validation loss decreased (-0.088842 --> -0.099877).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.4004228
	speed: 0.2734s/iter; left time: 5205.3005s
	iters: 200, epoch: 9 | loss: 2.6367886
	speed: 0.0720s/iter; left time: 1364.1896s
Epoch: 9 cost time: 15.815629243850708
Epoch: 9, Steps: 208 | Train Loss: 2.761 Vali Loss: 3.456 Vali Acc: 0.095 Test Loss: 3.456 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.4765780
	speed: 0.2862s/iter; left time: 5389.0506s
	iters: 200, epoch: 10 | loss: 2.4098780
	speed: 0.0712s/iter; left time: 1332.6923s
Epoch: 10 cost time: 15.772383213043213
Epoch: 10, Steps: 208 | Train Loss: 2.613 Vali Loss: 3.438 Vali Acc: 0.108 Test Loss: 3.438 Test Acc: 0.108
Validation loss decreased (-0.099877 --> -0.108227).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.8546500
	speed: 0.2741s/iter; left time: 5103.9722s
	iters: 200, epoch: 11 | loss: 2.3401599
	speed: 0.0716s/iter; left time: 1326.6173s
Epoch: 11 cost time: 15.933308839797974
Epoch: 11, Steps: 208 | Train Loss: 2.443 Vali Loss: 3.476 Vali Acc: 0.107 Test Loss: 3.476 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.5045068
	speed: 0.2715s/iter; left time: 4999.8866s
	iters: 200, epoch: 12 | loss: 1.9155648
	speed: 0.0679s/iter; left time: 1243.7596s
Epoch: 12 cost time: 15.162672519683838
Epoch: 12, Steps: 208 | Train Loss: 2.259 Vali Loss: 3.601 Vali Acc: 0.109 Test Loss: 3.601 Test Acc: 0.109
Validation loss decreased (-0.108227 --> -0.109120).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.7760308
	speed: 0.2478s/iter; left time: 4511.5800s
	iters: 200, epoch: 13 | loss: 1.8662120
	speed: 0.0737s/iter; left time: 1335.1876s
Epoch: 13 cost time: 15.309673547744751
Epoch: 13, Steps: 208 | Train Loss: 2.038 Vali Loss: 3.733 Vali Acc: 0.112 Test Loss: 3.733 Test Acc: 0.112
Validation loss decreased (-0.109120 --> -0.112101).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.7164068
	speed: 0.2547s/iter; left time: 4584.4603s
	iters: 200, epoch: 14 | loss: 2.4087403
	speed: 0.0737s/iter; left time: 1318.9466s
Epoch: 14 cost time: 15.811022758483887
Epoch: 14, Steps: 208 | Train Loss: 1.867 Vali Loss: 3.803 Vali Acc: 0.108 Test Loss: 3.803 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.7376794
	speed: 0.2656s/iter; left time: 4724.2886s
	iters: 200, epoch: 15 | loss: 1.4124764
	speed: 0.0631s/iter; left time: 1116.2459s
Epoch: 15 cost time: 14.1751229763031
Epoch: 15, Steps: 208 | Train Loss: 1.689 Vali Loss: 4.082 Vali Acc: 0.109 Test Loss: 4.082 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 2.0814590
	speed: 0.2516s/iter; left time: 4424.1872s
	iters: 200, epoch: 16 | loss: 1.4656415
	speed: 0.0723s/iter; left time: 1264.5708s
Epoch: 16 cost time: 15.481563329696655
Epoch: 16, Steps: 208 | Train Loss: 1.502 Vali Loss: 4.154 Vali Acc: 0.120 Test Loss: 4.154 Test Acc: 0.120
Validation loss decreased (-0.112101 --> -0.120448).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.4643853
	speed: 0.2623s/iter; left time: 4557.5695s
	iters: 200, epoch: 17 | loss: 1.3246477
	speed: 0.0699s/iter; left time: 1206.8822s
Epoch: 17 cost time: 15.294025182723999
Epoch: 17, Steps: 208 | Train Loss: 1.344 Vali Loss: 4.288 Vali Acc: 0.108 Test Loss: 4.288 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.2386297
	speed: 0.2531s/iter; left time: 4344.5383s
	iters: 200, epoch: 18 | loss: 0.8138127
	speed: 0.0703s/iter; left time: 1198.9718s
Epoch: 18 cost time: 14.899379014968872
Epoch: 18, Steps: 208 | Train Loss: 1.195 Vali Loss: 4.493 Vali Acc: 0.098 Test Loss: 4.493 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.4916992
	speed: 0.2500s/iter; left time: 4239.0679s
	iters: 200, epoch: 19 | loss: 1.0240368
	speed: 0.0704s/iter; left time: 1187.3238s
Epoch: 19 cost time: 15.32776427268982
Epoch: 19, Steps: 208 | Train Loss: 1.061 Vali Loss: 4.708 Vali Acc: 0.113 Test Loss: 4.708 Test Acc: 0.113
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.0447471
	speed: 0.2537s/iter; left time: 4249.2345s
	iters: 200, epoch: 20 | loss: 1.2127247
	speed: 0.0687s/iter; left time: 1143.9932s
Epoch: 20 cost time: 15.276310205459595
Epoch: 20, Steps: 208 | Train Loss: 0.943 Vali Loss: 4.919 Vali Acc: 0.111 Test Loss: 4.919 Test Acc: 0.111
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.9554814
	speed: 0.3103s/iter; left time: 5132.4374s
	iters: 200, epoch: 21 | loss: 0.9730579
	speed: 0.0839s/iter; left time: 1379.9899s
Epoch: 21 cost time: 17.938063383102417
Epoch: 21, Steps: 208 | Train Loss: 0.853 Vali Loss: 5.160 Vali Acc: 0.107 Test Loss: 5.160 Test Acc: 0.107
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.6549175
	speed: 0.3121s/iter; left time: 5097.4940s
	iters: 200, epoch: 22 | loss: 0.8098074
	speed: 0.0724s/iter; left time: 1174.4932s
Epoch: 22 cost time: 16.478065729141235
Epoch: 22, Steps: 208 | Train Loss: 0.775 Vali Loss: 5.332 Vali Acc: 0.111 Test Loss: 5.332 Test Acc: 0.111
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.5137911
	speed: 0.2833s/iter; left time: 4568.0032s
	iters: 200, epoch: 23 | loss: 0.9394584
	speed: 0.0780s/iter; left time: 1249.3874s
Epoch: 23 cost time: 17.233798265457153
Epoch: 23, Steps: 208 | Train Loss: 0.718 Vali Loss: 5.473 Vali Acc: 0.112 Test Loss: 5.473 Test Acc: 0.112
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.9357966
	speed: 0.2901s/iter; left time: 4617.7585s
	iters: 200, epoch: 24 | loss: 0.7451084
	speed: 0.0762s/iter; left time: 1205.9051s
Epoch: 24 cost time: 16.843883514404297
Epoch: 24, Steps: 208 | Train Loss: 0.667 Vali Loss: 5.707 Vali Acc: 0.110 Test Loss: 5.707 Test Acc: 0.110
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.4977107
	speed: 0.3035s/iter; left time: 4768.1210s
	iters: 200, epoch: 25 | loss: 0.7211965
	speed: 0.0754s/iter; left time: 1177.6533s
Epoch: 25 cost time: 16.87655806541443
Epoch: 25, Steps: 208 | Train Loss: 0.620 Vali Loss: 5.668 Vali Acc: 0.113 Test Loss: 5.668 Test Acc: 0.113
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.8383808
	speed: 0.2962s/iter; left time: 4590.7252s
	iters: 200, epoch: 26 | loss: 0.5772088
	speed: 0.0744s/iter; left time: 1145.8266s
Epoch: 26 cost time: 16.048872709274292
Epoch: 26, Steps: 208 | Train Loss: 0.580 Vali Loss: 6.089 Vali Acc: 0.104 Test Loss: 6.089 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12048911422606622
model parameter : 435927
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7673819
	speed: 0.1051s/iter; left time: 2175.4416s
	iters: 200, epoch: 1 | loss: 3.6506903
	speed: 0.0834s/iter; left time: 1718.5712s
Epoch: 1 cost time: 19.66830539703369
Epoch: 1, Steps: 208 | Train Loss: 3.683 Vali Loss: 3.592 Vali Acc: 0.056 Test Loss: 3.592 Test Acc: 0.056
Validation loss decreased (inf --> -0.056033).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4414675
	speed: 0.2975s/iter; left time: 6095.9582s
	iters: 200, epoch: 2 | loss: 3.4065936
	speed: 0.0783s/iter; left time: 1597.5892s
Epoch: 2 cost time: 16.76478862762451
Epoch: 2, Steps: 208 | Train Loss: 3.593 Vali Loss: 3.532 Vali Acc: 0.065 Test Loss: 3.532 Test Acc: 0.065
Validation loss decreased (-0.056033 --> -0.064683).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4980481
	speed: 0.2941s/iter; left time: 5965.1567s
	iters: 200, epoch: 3 | loss: 3.7452853
	speed: 0.0736s/iter; left time: 1486.1618s
Epoch: 3 cost time: 16.296314239501953
Epoch: 3, Steps: 208 | Train Loss: 3.531 Vali Loss: 3.589 Vali Acc: 0.059 Test Loss: 3.589 Test Acc: 0.059
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.2694321
	speed: 0.2547s/iter; left time: 5112.8814s
	iters: 200, epoch: 4 | loss: 3.4714150
	speed: 0.0738s/iter; left time: 1474.0149s
Epoch: 4 cost time: 15.630208253860474
Epoch: 4, Steps: 208 | Train Loss: 3.436 Vali Loss: 3.531 Vali Acc: 0.066 Test Loss: 3.531 Test Acc: 0.066
Validation loss decreased (-0.064683 --> -0.066174).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.4651432
	speed: 0.2871s/iter; left time: 5704.8379s
	iters: 200, epoch: 5 | loss: 3.2397676
	speed: 0.0683s/iter; left time: 1350.2714s
Epoch: 5 cost time: 16.099709272384644
Epoch: 5, Steps: 208 | Train Loss: 3.345 Vali Loss: 3.481 Vali Acc: 0.069 Test Loss: 3.481 Test Acc: 0.069
Validation loss decreased (-0.066174 --> -0.068859).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.1764774
	speed: 0.2698s/iter; left time: 5303.7307s
	iters: 200, epoch: 6 | loss: 3.5545652
	speed: 0.0847s/iter; left time: 1656.4696s
Epoch: 6 cost time: 18.052137851715088
Epoch: 6, Steps: 208 | Train Loss: 3.231 Vali Loss: 3.442 Vali Acc: 0.077 Test Loss: 3.442 Test Acc: 0.077
Validation loss decreased (-0.068859 --> -0.077210).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.1976640
	speed: 0.3162s/iter; left time: 6151.9195s
	iters: 200, epoch: 7 | loss: 3.0893261
	speed: 0.0897s/iter; left time: 1735.1231s
Epoch: 7 cost time: 19.391276836395264
Epoch: 7, Steps: 208 | Train Loss: 3.088 Vali Loss: 3.390 Vali Acc: 0.092 Test Loss: 3.390 Test Acc: 0.092
Validation loss decreased (-0.077210 --> -0.092421).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.6160293
	speed: 0.3324s/iter; left time: 6397.8996s
	iters: 200, epoch: 8 | loss: 2.7126572
	speed: 0.0823s/iter; left time: 1575.8404s
Epoch: 8 cost time: 18.238271236419678
Epoch: 8, Steps: 208 | Train Loss: 2.933 Vali Loss: 3.411 Vali Acc: 0.101 Test Loss: 3.411 Test Acc: 0.101
Validation loss decreased (-0.092421 --> -0.100473).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.5066211
	speed: 0.3197s/iter; left time: 6086.3162s
	iters: 200, epoch: 9 | loss: 2.7993045
	speed: 0.0772s/iter; left time: 1461.5282s
Epoch: 9 cost time: 17.47099804878235
Epoch: 9, Steps: 208 | Train Loss: 2.776 Vali Loss: 3.320 Vali Acc: 0.111 Test Loss: 3.320 Test Acc: 0.111
Validation loss decreased (-0.100473 --> -0.110912).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.7668831
	speed: 0.3216s/iter; left time: 6055.4728s
	iters: 200, epoch: 10 | loss: 2.4133329
	speed: 0.0781s/iter; left time: 1462.3101s
Epoch: 10 cost time: 17.438534259796143
Epoch: 10, Steps: 208 | Train Loss: 2.630 Vali Loss: 3.384 Vali Acc: 0.114 Test Loss: 3.384 Test Acc: 0.114
Validation loss decreased (-0.110912 --> -0.113596).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.2230623
	speed: 0.3178s/iter; left time: 5917.8714s
	iters: 200, epoch: 11 | loss: 2.9908473
	speed: 0.0862s/iter; left time: 1595.8431s
Epoch: 11 cost time: 19.479328870773315
Epoch: 11, Steps: 208 | Train Loss: 2.472 Vali Loss: 3.473 Vali Acc: 0.115 Test Loss: 3.473 Test Acc: 0.115
Validation loss decreased (-0.113596 --> -0.115086).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.3666921
	speed: 0.3181s/iter; left time: 5856.3295s
	iters: 200, epoch: 12 | loss: 2.5368493
	speed: 0.0836s/iter; left time: 1530.9365s
Epoch: 12 cost time: 17.702934980392456
Epoch: 12, Steps: 208 | Train Loss: 2.311 Vali Loss: 3.592 Vali Acc: 0.106 Test Loss: 3.592 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.7271069
	speed: 0.3261s/iter; left time: 5936.3405s
	iters: 200, epoch: 13 | loss: 2.1366699
	speed: 0.0751s/iter; left time: 1359.5519s
Epoch: 13 cost time: 17.33179545402527
Epoch: 13, Steps: 208 | Train Loss: 2.121 Vali Loss: 3.575 Vali Acc: 0.104 Test Loss: 3.575 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.8681926
	speed: 0.3002s/iter; left time: 5402.0388s
	iters: 200, epoch: 14 | loss: 2.4125569
	speed: 0.0872s/iter; left time: 1560.1255s
Epoch: 14 cost time: 18.35043430328369
Epoch: 14, Steps: 208 | Train Loss: 1.962 Vali Loss: 3.739 Vali Acc: 0.109 Test Loss: 3.739 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 2.0041237
	speed: 0.2994s/iter; left time: 5326.8500s
	iters: 200, epoch: 15 | loss: 2.2794294
	speed: 0.0741s/iter; left time: 1310.7671s
Epoch: 15 cost time: 16.45133876800537
Epoch: 15, Steps: 208 | Train Loss: 1.782 Vali Loss: 3.820 Vali Acc: 0.112 Test Loss: 3.820 Test Acc: 0.112
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.9099635
	speed: 0.3003s/iter; left time: 5279.8474s
	iters: 200, epoch: 16 | loss: 2.2086627
	speed: 0.0744s/iter; left time: 1299.7328s
Epoch: 16 cost time: 16.506009340286255
Epoch: 16, Steps: 208 | Train Loss: 1.583 Vali Loss: 3.988 Vali Acc: 0.113 Test Loss: 3.988 Test Acc: 0.113
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.1373954
	speed: 0.2950s/iter; left time: 5125.4900s
	iters: 200, epoch: 17 | loss: 1.4729537
	speed: 0.0706s/iter; left time: 1220.2938s
Epoch: 17 cost time: 15.225898027420044
Epoch: 17, Steps: 208 | Train Loss: 1.411 Vali Loss: 4.162 Vali Acc: 0.118 Test Loss: 4.162 Test Acc: 0.118
Validation loss decreased (-0.115086 --> -0.117763).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.1081648
	speed: 0.2889s/iter; left time: 4959.0603s
	iters: 200, epoch: 18 | loss: 1.9642094
	speed: 0.0766s/iter; left time: 1306.4574s
Epoch: 18 cost time: 16.989407777786255
Epoch: 18, Steps: 208 | Train Loss: 1.262 Vali Loss: 4.409 Vali Acc: 0.115 Test Loss: 4.409 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.2039635
	speed: 0.3052s/iter; left time: 5175.1813s
	iters: 200, epoch: 19 | loss: 1.1378899
	speed: 0.0783s/iter; left time: 1319.9760s
Epoch: 19 cost time: 17.389436721801758
Epoch: 19, Steps: 208 | Train Loss: 1.132 Vali Loss: 4.519 Vali Acc: 0.111 Test Loss: 4.519 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.1044223
	speed: 0.2888s/iter; left time: 4837.3638s
	iters: 200, epoch: 20 | loss: 1.3066273
	speed: 0.0738s/iter; left time: 1228.9832s
Epoch: 20 cost time: 16.688698053359985
Epoch: 20, Steps: 208 | Train Loss: 0.993 Vali Loss: 4.869 Vali Acc: 0.109 Test Loss: 4.869 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.4512253
	speed: 0.2838s/iter; left time: 4694.5387s
	iters: 200, epoch: 21 | loss: 1.0368356
	speed: 0.0746s/iter; left time: 1226.1511s
Epoch: 21 cost time: 16.21809482574463
Epoch: 21, Steps: 208 | Train Loss: 0.919 Vali Loss: 4.969 Vali Acc: 0.110 Test Loss: 4.969 Test Acc: 0.110
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.7673195
	speed: 0.2905s/iter; left time: 4744.0855s
	iters: 200, epoch: 22 | loss: 1.1624672
	speed: 0.0816s/iter; left time: 1324.6281s
Epoch: 22 cost time: 17.51478934288025
Epoch: 22, Steps: 208 | Train Loss: 0.846 Vali Loss: 5.103 Vali Acc: 0.109 Test Loss: 5.103 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.4911970
	speed: 0.2906s/iter; left time: 4686.1647s
	iters: 200, epoch: 23 | loss: 1.2146943
	speed: 0.0782s/iter; left time: 1252.7910s
Epoch: 23 cost time: 17.102403163909912
Epoch: 23, Steps: 208 | Train Loss: 0.725 Vali Loss: 5.412 Vali Acc: 0.106 Test Loss: 5.412 Test Acc: 0.106
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.5961630
	speed: 0.2855s/iter; left time: 4543.7908s
	iters: 200, epoch: 24 | loss: 0.6736580
	speed: 0.0737s/iter; left time: 1166.4232s
Epoch: 24 cost time: 16.954020738601685
Epoch: 24, Steps: 208 | Train Loss: 0.667 Vali Loss: 5.683 Vali Acc: 0.111 Test Loss: 5.683 Test Acc: 0.111
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.3511053
	speed: 0.2690s/iter; left time: 4226.1753s
	iters: 200, epoch: 25 | loss: 1.0020202
	speed: 0.0725s/iter; left time: 1131.2140s
Epoch: 25 cost time: 15.714093208312988
Epoch: 25, Steps: 208 | Train Loss: 0.664 Vali Loss: 5.617 Vali Acc: 0.105 Test Loss: 5.617 Test Acc: 0.105
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.7081294
	speed: 0.2754s/iter; left time: 4269.4445s
	iters: 200, epoch: 26 | loss: 0.6905001
	speed: 0.0760s/iter; left time: 1171.0398s
Epoch: 26 cost time: 17.15770959854126
Epoch: 26, Steps: 208 | Train Loss: 0.620 Vali Loss: 5.864 Vali Acc: 0.107 Test Loss: 5.864 Test Acc: 0.107
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.7747681
	speed: 0.2708s/iter; left time: 4140.8100s
	iters: 200, epoch: 27 | loss: 1.0833452
	speed: 0.0710s/iter; left time: 1078.2410s
Epoch: 27 cost time: 15.625225067138672
Epoch: 27, Steps: 208 | Train Loss: 0.589 Vali Loss: 6.285 Vali Acc: 0.109 Test Loss: 6.285 Test Acc: 0.109
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11780495079033701
model parameter : 434839
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.3877916
	speed: 0.0915s/iter; left time: 1893.6233s
	iters: 200, epoch: 1 | loss: 3.9390614
	speed: 0.0752s/iter; left time: 1548.7824s
Epoch: 1 cost time: 17.297343254089355
Epoch: 1, Steps: 208 | Train Loss: 3.676 Vali Loss: 3.647 Vali Acc: 0.061 Test Loss: 3.647 Test Acc: 0.061
Validation loss decreased (inf --> -0.061401).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3586755
	speed: 0.2661s/iter; left time: 5453.2963s
	iters: 200, epoch: 2 | loss: 3.2472796
	speed: 0.0739s/iter; left time: 1507.1867s
Epoch: 2 cost time: 15.79353928565979
Epoch: 2, Steps: 208 | Train Loss: 3.574 Vali Loss: 3.557 Vali Acc: 0.064 Test Loss: 3.557 Test Acc: 0.064
Validation loss decreased (-0.061401 --> -0.063490).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5113680
	speed: 0.3239s/iter; left time: 6570.7106s
	iters: 200, epoch: 3 | loss: 3.3950171
	speed: 0.0971s/iter; left time: 1959.3369s
Epoch: 3 cost time: 19.94524312019348
Epoch: 3, Steps: 208 | Train Loss: 3.501 Vali Loss: 3.511 Vali Acc: 0.056 Test Loss: 3.511 Test Acc: 0.056
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.5773597
	speed: 0.3315s/iter; left time: 6656.1833s
	iters: 200, epoch: 4 | loss: 3.8069403
	speed: 0.0875s/iter; left time: 1748.6517s
Epoch: 4 cost time: 18.124916315078735
Epoch: 4, Steps: 208 | Train Loss: 3.429 Vali Loss: 3.566 Vali Acc: 0.063 Test Loss: 3.566 Test Acc: 0.063
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 3.3117709
	speed: 0.3614s/iter; left time: 7180.6970s
	iters: 200, epoch: 5 | loss: 3.2134137
	speed: 0.0912s/iter; left time: 1803.2427s
Epoch: 5 cost time: 20.635990619659424
Epoch: 5, Steps: 208 | Train Loss: 3.339 Vali Loss: 3.457 Vali Acc: 0.068 Test Loss: 3.457 Test Acc: 0.068
Validation loss decreased (-0.063490 --> -0.067964).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0315571
	speed: 0.3166s/iter; left time: 6225.3696s
	iters: 200, epoch: 6 | loss: 3.0969787
	speed: 0.0889s/iter; left time: 1738.3683s
Epoch: 6 cost time: 18.389521837234497
Epoch: 6, Steps: 208 | Train Loss: 3.202 Vali Loss: 3.426 Vali Acc: 0.084 Test Loss: 3.426 Test Acc: 0.084
Validation loss decreased (-0.067964 --> -0.083473).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.7977786
	speed: 0.3139s/iter; left time: 6105.4810s
	iters: 200, epoch: 7 | loss: 3.3662093
	speed: 0.0764s/iter; left time: 1478.8613s
Epoch: 7 cost time: 16.63891887664795
Epoch: 7, Steps: 208 | Train Loss: 3.041 Vali Loss: 3.346 Vali Acc: 0.089 Test Loss: 3.346 Test Acc: 0.089
Validation loss decreased (-0.083473 --> -0.089140).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.4843011
	speed: 0.3365s/iter; left time: 6475.9234s
	iters: 200, epoch: 8 | loss: 2.8604741
	speed: 0.0897s/iter; left time: 1716.8687s
Epoch: 8 cost time: 19.7493097782135
Epoch: 8, Steps: 208 | Train Loss: 2.903 Vali Loss: 3.283 Vali Acc: 0.101 Test Loss: 3.283 Test Acc: 0.101
Validation loss decreased (-0.089140 --> -0.101071).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.5473015
	speed: 0.3517s/iter; left time: 6696.1400s
	iters: 200, epoch: 9 | loss: 2.6438920
	speed: 0.0923s/iter; left time: 1748.7224s
Epoch: 9 cost time: 19.280503273010254
Epoch: 9, Steps: 208 | Train Loss: 2.772 Vali Loss: 3.359 Vali Acc: 0.101 Test Loss: 3.359 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 3.1263599
	speed: 0.3416s/iter; left time: 6431.8695s
	iters: 200, epoch: 10 | loss: 2.4170296
	speed: 0.0943s/iter; left time: 1767.0218s
Epoch: 10 cost time: 19.704002618789673
Epoch: 10, Steps: 208 | Train Loss: 2.609 Vali Loss: 3.377 Vali Acc: 0.105 Test Loss: 3.377 Test Acc: 0.105
Validation loss decreased (-0.101071 --> -0.104649).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.4270039
	speed: 0.3536s/iter; left time: 6584.8003s
	iters: 200, epoch: 11 | loss: 2.5466857
	speed: 0.0948s/iter; left time: 1756.4612s
Epoch: 11 cost time: 19.585968494415283
Epoch: 11, Steps: 208 | Train Loss: 2.444 Vali Loss: 3.446 Vali Acc: 0.106 Test Loss: 3.446 Test Acc: 0.106
Validation loss decreased (-0.104649 --> -0.105543).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.3342874
	speed: 0.3356s/iter; left time: 6179.1795s
	iters: 200, epoch: 12 | loss: 2.0683699
	speed: 0.0886s/iter; left time: 1622.2080s
Epoch: 12 cost time: 20.06920099258423
Epoch: 12, Steps: 208 | Train Loss: 2.291 Vali Loss: 3.427 Vali Acc: 0.114 Test Loss: 3.427 Test Acc: 0.114
Validation loss decreased (-0.105543 --> -0.113894).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.9199497
	speed: 0.3961s/iter; left time: 7210.6807s
	iters: 200, epoch: 13 | loss: 2.0722899
	speed: 0.0968s/iter; left time: 1753.0211s
Epoch: 13 cost time: 22.379826307296753
Epoch: 13, Steps: 208 | Train Loss: 2.095 Vali Loss: 3.574 Vali Acc: 0.116 Test Loss: 3.574 Test Acc: 0.116
Validation loss decreased (-0.113894 --> -0.115682).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.1023450
	speed: 0.3792s/iter; left time: 6823.9114s
	iters: 200, epoch: 14 | loss: 1.9128028
	speed: 0.0968s/iter; left time: 1731.9448s
Epoch: 14 cost time: 21.42475414276123
Epoch: 14, Steps: 208 | Train Loss: 1.907 Vali Loss: 3.714 Vali Acc: 0.115 Test Loss: 3.714 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.1904424
	speed: 0.3587s/iter; left time: 6381.0671s
	iters: 200, epoch: 15 | loss: 1.8452148
	speed: 0.0982s/iter; left time: 1737.0598s
Epoch: 15 cost time: 20.822611570358276
Epoch: 15, Steps: 208 | Train Loss: 1.729 Vali Loss: 3.848 Vali Acc: 0.118 Test Loss: 3.848 Test Acc: 0.118
Validation loss decreased (-0.115682 --> -0.118363).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.8000244
	speed: 0.3921s/iter; left time: 6894.2718s
	iters: 200, epoch: 16 | loss: 2.0441127
	speed: 0.0925s/iter; left time: 1616.4854s
Epoch: 16 cost time: 19.674697637557983
Epoch: 16, Steps: 208 | Train Loss: 1.538 Vali Loss: 4.221 Vali Acc: 0.108 Test Loss: 4.221 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.1574357
	speed: 0.3934s/iter; left time: 6834.2926s
	iters: 200, epoch: 17 | loss: 2.1526058
	speed: 0.0873s/iter; left time: 1508.1154s
Epoch: 17 cost time: 21.31733775138855
Epoch: 17, Steps: 208 | Train Loss: 1.375 Vali Loss: 4.155 Vali Acc: 0.113 Test Loss: 4.155 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.7984828
	speed: 0.3689s/iter; left time: 6332.5239s
	iters: 200, epoch: 18 | loss: 1.7211808
	speed: 0.0923s/iter; left time: 1575.4438s
Epoch: 18 cost time: 20.029196739196777
Epoch: 18, Steps: 208 | Train Loss: 1.211 Vali Loss: 4.450 Vali Acc: 0.106 Test Loss: 4.450 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.0172749
	speed: 0.3769s/iter; left time: 6391.7098s
	iters: 200, epoch: 19 | loss: 1.2561086
	speed: 0.0911s/iter; left time: 1536.4725s
Epoch: 19 cost time: 20.16252899169922
Epoch: 19, Steps: 208 | Train Loss: 1.092 Vali Loss: 4.685 Vali Acc: 0.118 Test Loss: 4.685 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.8055175
	speed: 0.3489s/iter; left time: 5844.4718s
	iters: 200, epoch: 20 | loss: 1.5646766
	speed: 0.0961s/iter; left time: 1599.5648s
Epoch: 20 cost time: 20.087258100509644
Epoch: 20, Steps: 208 | Train Loss: 0.969 Vali Loss: 4.835 Vali Acc: 0.110 Test Loss: 4.835 Test Acc: 0.110
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.8254675
	speed: 0.3304s/iter; left time: 5465.9580s
	iters: 200, epoch: 21 | loss: 0.9670499
	speed: 0.0888s/iter; left time: 1460.3107s
Epoch: 21 cost time: 19.47434949874878
Epoch: 21, Steps: 208 | Train Loss: 0.877 Vali Loss: 5.061 Vali Acc: 0.112 Test Loss: 5.061 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 1.0447376
	speed: 0.3501s/iter; left time: 5718.2257s
	iters: 200, epoch: 22 | loss: 0.7839587
	speed: 0.1028s/iter; left time: 1668.9383s
Epoch: 22 cost time: 22.302217960357666
Epoch: 22, Steps: 208 | Train Loss: 0.823 Vali Loss: 5.243 Vali Acc: 0.112 Test Loss: 5.243 Test Acc: 0.112
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.6483247
	speed: 0.3811s/iter; left time: 6144.4900s
	iters: 200, epoch: 23 | loss: 0.9067138
	speed: 0.1049s/iter; left time: 1680.4318s
Epoch: 23 cost time: 23.051685333251953
Epoch: 23, Steps: 208 | Train Loss: 0.717 Vali Loss: 5.454 Vali Acc: 0.121 Test Loss: 5.454 Test Acc: 0.121
Validation loss decreased (-0.118363 --> -0.121031).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.9636817
	speed: 0.3789s/iter; left time: 6030.7089s
	iters: 200, epoch: 24 | loss: 0.5253154
	speed: 0.1154s/iter; left time: 1824.5454s
Epoch: 24 cost time: 23.666942834854126
Epoch: 24, Steps: 208 | Train Loss: 0.721 Vali Loss: 5.699 Vali Acc: 0.108 Test Loss: 5.699 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.8311674
	speed: 0.4231s/iter; left time: 6645.8543s
	iters: 200, epoch: 25 | loss: 0.3705151
	speed: 0.1061s/iter; left time: 1655.7948s
Epoch: 25 cost time: 23.25970983505249
Epoch: 25, Steps: 208 | Train Loss: 0.657 Vali Loss: 5.644 Vali Acc: 0.115 Test Loss: 5.644 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.5851666
	speed: 0.3937s/iter; left time: 6102.0854s
	iters: 200, epoch: 26 | loss: 0.9516879
	speed: 0.0831s/iter; left time: 1280.0254s
Epoch: 26 cost time: 20.79071068763733
Epoch: 26, Steps: 208 | Train Loss: 0.639 Vali Loss: 5.691 Vali Acc: 0.106 Test Loss: 5.691 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.3738455
	speed: 0.3868s/iter; left time: 5914.9500s
	iters: 200, epoch: 27 | loss: 0.7779354
	speed: 0.0924s/iter; left time: 1403.4806s
Epoch: 27 cost time: 21.57435393333435
Epoch: 27, Steps: 208 | Train Loss: 0.584 Vali Loss: 5.770 Vali Acc: 0.123 Test Loss: 5.770 Test Acc: 0.123
Validation loss decreased (-0.121031 --> -0.122817).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.5290661
	speed: 0.4007s/iter; left time: 6044.8421s
	iters: 200, epoch: 28 | loss: 0.2305402
	speed: 0.1059s/iter; left time: 1586.1900s
Epoch: 28 cost time: 22.990252256393433
Epoch: 28, Steps: 208 | Train Loss: 0.573 Vali Loss: 6.268 Vali Acc: 0.104 Test Loss: 6.268 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.7630581
	speed: 0.4020s/iter; left time: 5981.2266s
	iters: 200, epoch: 29 | loss: 0.7256883
	speed: 0.1002s/iter; left time: 1481.0000s
Epoch: 29 cost time: 22.866225004196167
Epoch: 29, Steps: 208 | Train Loss: 0.547 Vali Loss: 6.349 Vali Acc: 0.116 Test Loss: 6.349 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.6017057
	speed: 0.4166s/iter; left time: 6111.7104s
	iters: 200, epoch: 30 | loss: 0.4838153
	speed: 0.1094s/iter; left time: 1593.6266s
Epoch: 30 cost time: 24.251484155654907
Epoch: 30, Steps: 208 | Train Loss: 0.524 Vali Loss: 6.483 Vali Acc: 0.108 Test Loss: 6.483 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.3883303
	speed: 0.3883s/iter; left time: 5614.9804s
	iters: 200, epoch: 31 | loss: 0.8646291
	speed: 0.0964s/iter; left time: 1384.7201s
Epoch: 31 cost time: 21.25913715362549
Epoch: 31, Steps: 208 | Train Loss: 0.500 Vali Loss: 6.509 Vali Acc: 0.113 Test Loss: 6.509 Test Acc: 0.113
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.2172853
	speed: 0.3357s/iter; left time: 4784.3178s
	iters: 200, epoch: 32 | loss: 0.3926916
	speed: 0.1048s/iter; left time: 1483.2330s
Epoch: 32 cost time: 21.33472990989685
Epoch: 32, Steps: 208 | Train Loss: 0.480 Vali Loss: 6.676 Vali Acc: 0.110 Test Loss: 6.676 Test Acc: 0.110
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.1262913
	speed: 0.3805s/iter; left time: 5343.5622s
	iters: 200, epoch: 33 | loss: 0.3075888
	speed: 0.0975s/iter; left time: 1359.0307s
Epoch: 33 cost time: 21.465420246124268
Epoch: 33, Steps: 208 | Train Loss: 0.462 Vali Loss: 6.819 Vali Acc: 0.114 Test Loss: 6.819 Test Acc: 0.114
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.4132699
	speed: 0.3780s/iter; left time: 5230.9392s
	iters: 200, epoch: 34 | loss: 0.5256346
	speed: 0.1008s/iter; left time: 1384.3823s
Epoch: 34 cost time: 21.879338026046753
Epoch: 34, Steps: 208 | Train Loss: 0.426 Vali Loss: 7.403 Vali Acc: 0.119 Test Loss: 7.403 Test Acc: 0.119
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.5575164
	speed: 0.3882s/iter; left time: 5290.8472s
	iters: 200, epoch: 35 | loss: 0.7767043
	speed: 0.0918s/iter; left time: 1241.3743s
Epoch: 35 cost time: 20.94521427154541
Epoch: 35, Steps: 208 | Train Loss: 0.430 Vali Loss: 7.059 Vali Acc: 0.113 Test Loss: 7.059 Test Acc: 0.113
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 0.7948312
	speed: 0.3628s/iter; left time: 4869.3890s
	iters: 200, epoch: 36 | loss: 0.4389513
	speed: 0.1025s/iter; left time: 1364.9362s
Epoch: 36 cost time: 21.042942762374878
Epoch: 36, Steps: 208 | Train Loss: 0.414 Vali Loss: 7.123 Vali Acc: 0.104 Test Loss: 7.123 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 0.1695319
	speed: 0.3747s/iter; left time: 4951.2810s
	iters: 200, epoch: 37 | loss: 0.3693925
	speed: 0.0961s/iter; left time: 1260.4504s
Epoch: 37 cost time: 22.008946657180786
Epoch: 37, Steps: 208 | Train Loss: 0.435 Vali Loss: 7.054 Vali Acc: 0.119 Test Loss: 7.054 Test Acc: 0.119
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12287503728004771
model parameter : 433751
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6981854
	speed: 0.1185s/iter; left time: 2452.5734s
	iters: 200, epoch: 1 | loss: 3.6342738
	speed: 0.0858s/iter; left time: 1767.6772s
Epoch: 1 cost time: 21.374595642089844
Epoch: 1, Steps: 208 | Train Loss: 3.719 Vali Loss: 3.608 Vali Acc: 0.056 Test Loss: 3.608 Test Acc: 0.056
Validation loss decreased (inf --> -0.056331).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8310323
	speed: 0.3485s/iter; left time: 7142.4950s
	iters: 200, epoch: 2 | loss: 3.5369940
	speed: 0.0901s/iter; left time: 1837.6511s
Epoch: 2 cost time: 19.84799027442932
Epoch: 2, Steps: 208 | Train Loss: 3.584 Vali Loss: 3.560 Vali Acc: 0.058 Test Loss: 3.560 Test Acc: 0.058
Validation loss decreased (-0.056331 --> -0.057823).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.9585993
	speed: 0.3286s/iter; left time: 6666.0001s
	iters: 200, epoch: 3 | loss: 3.5833426
	speed: 0.0830s/iter; left time: 1675.5876s
Epoch: 3 cost time: 17.779831409454346
Epoch: 3, Steps: 208 | Train Loss: 3.497 Vali Loss: 3.511 Vali Acc: 0.058 Test Loss: 3.511 Test Acc: 0.058
Validation loss decreased (-0.057823 --> -0.057824).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4363534
	speed: 0.3276s/iter; left time: 6577.5418s
	iters: 200, epoch: 4 | loss: 3.1917827
	speed: 0.0813s/iter; left time: 1623.2256s
Epoch: 4 cost time: 17.498337507247925
Epoch: 4, Steps: 208 | Train Loss: 3.406 Vali Loss: 3.545 Vali Acc: 0.074 Test Loss: 3.545 Test Acc: 0.074
Validation loss decreased (-0.057824 --> -0.073630).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2415977
	speed: 0.3364s/iter; left time: 6684.3032s
	iters: 200, epoch: 5 | loss: 3.1933379
	speed: 0.0865s/iter; left time: 1710.4089s
Epoch: 5 cost time: 19.433043241500854
Epoch: 5, Steps: 208 | Train Loss: 3.322 Vali Loss: 3.517 Vali Acc: 0.063 Test Loss: 3.517 Test Acc: 0.063
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.4634807
	speed: 0.3280s/iter; left time: 6449.0274s
	iters: 200, epoch: 6 | loss: 3.2369933
	speed: 0.0904s/iter; left time: 1769.0280s
Epoch: 6 cost time: 18.707430124282837
Epoch: 6, Steps: 208 | Train Loss: 3.224 Vali Loss: 3.490 Vali Acc: 0.074 Test Loss: 3.490 Test Acc: 0.074
Validation loss decreased (-0.073630 --> -0.074227).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9422417
	speed: 0.3319s/iter; left time: 6457.0593s
	iters: 200, epoch: 7 | loss: 3.0744798
	speed: 0.0860s/iter; left time: 1664.8115s
Epoch: 7 cost time: 18.718495845794678
Epoch: 7, Steps: 208 | Train Loss: 3.109 Vali Loss: 3.485 Vali Acc: 0.082 Test Loss: 3.485 Test Acc: 0.082
Validation loss decreased (-0.074227 --> -0.081981).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.8470671
	speed: 0.3399s/iter; left time: 6541.5426s
	iters: 200, epoch: 8 | loss: 2.5730574
	speed: 0.0844s/iter; left time: 1616.1348s
Epoch: 8 cost time: 18.622881412506104
Epoch: 8, Steps: 208 | Train Loss: 2.961 Vali Loss: 3.375 Vali Acc: 0.092 Test Loss: 3.375 Test Acc: 0.092
Validation loss decreased (-0.081981 --> -0.092421).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.9947090
	speed: 0.3344s/iter; left time: 6365.3542s
	iters: 200, epoch: 9 | loss: 2.8128631
	speed: 0.0850s/iter; left time: 1610.4283s
Epoch: 9 cost time: 18.868285655975342
Epoch: 9, Steps: 208 | Train Loss: 2.799 Vali Loss: 3.385 Vali Acc: 0.103 Test Loss: 3.385 Test Acc: 0.103
Validation loss decreased (-0.092421 --> -0.103456).  Saving model ...
	iters: 100, epoch: 10 | loss: 3.1155090
	speed: 0.3346s/iter; left time: 6299.8721s
	iters: 200, epoch: 10 | loss: 2.1672416
	speed: 0.0953s/iter; left time: 1784.8850s
Epoch: 10 cost time: 20.065222024917603
Epoch: 10, Steps: 208 | Train Loss: 2.692 Vali Loss: 3.389 Vali Acc: 0.102 Test Loss: 3.389 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 3.1273849
	speed: 0.3862s/iter; left time: 7192.2972s
	iters: 200, epoch: 11 | loss: 2.7274010
	speed: 0.0905s/iter; left time: 1677.0672s
Epoch: 11 cost time: 21.016631841659546
Epoch: 11, Steps: 208 | Train Loss: 2.499 Vali Loss: 3.481 Vali Acc: 0.102 Test Loss: 3.481 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 2.1976194
	speed: 0.3574s/iter; left time: 6581.4908s
	iters: 200, epoch: 12 | loss: 2.3295667
	speed: 0.0836s/iter; left time: 1530.3986s
Epoch: 12 cost time: 18.84354877471924
Epoch: 12, Steps: 208 | Train Loss: 2.331 Vali Loss: 3.513 Vali Acc: 0.108 Test Loss: 3.513 Test Acc: 0.108
Validation loss decreased (-0.103456 --> -0.107630).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.2129323
	speed: 0.3377s/iter; left time: 6147.3116s
	iters: 200, epoch: 13 | loss: 2.1317170
	speed: 0.0901s/iter; left time: 1631.8167s
Epoch: 13 cost time: 19.689306020736694
Epoch: 13, Steps: 208 | Train Loss: 2.169 Vali Loss: 3.688 Vali Acc: 0.106 Test Loss: 3.688 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 2.1140323
	speed: 0.3120s/iter; left time: 5614.2497s
	iters: 200, epoch: 14 | loss: 2.1481040
	speed: 0.0831s/iter; left time: 1487.1383s
Epoch: 14 cost time: 17.637660026550293
Epoch: 14, Steps: 208 | Train Loss: 1.994 Vali Loss: 3.711 Vali Acc: 0.112 Test Loss: 3.711 Test Acc: 0.112
Validation loss decreased (-0.107630 --> -0.111505).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.6941986
	speed: 0.3500s/iter; left time: 6226.4217s
	iters: 200, epoch: 15 | loss: 1.9565992
	speed: 0.0833s/iter; left time: 1474.3264s
Epoch: 15 cost time: 18.877304077148438
Epoch: 15, Steps: 208 | Train Loss: 1.805 Vali Loss: 3.974 Vali Acc: 0.106 Test Loss: 3.974 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 2.5048921
	speed: 0.3327s/iter; left time: 5850.0600s
	iters: 200, epoch: 16 | loss: 2.1124434
	speed: 0.0908s/iter; left time: 1588.1011s
Epoch: 16 cost time: 18.70920991897583
Epoch: 16, Steps: 208 | Train Loss: 1.637 Vali Loss: 4.125 Vali Acc: 0.105 Test Loss: 4.125 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.8429868
	speed: 0.3217s/iter; left time: 5589.6054s
	iters: 200, epoch: 17 | loss: 1.7685454
	speed: 0.0779s/iter; left time: 1345.3140s
Epoch: 17 cost time: 17.83105444908142
Epoch: 17, Steps: 208 | Train Loss: 1.449 Vali Loss: 4.183 Vali Acc: 0.112 Test Loss: 4.183 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.4961413
	speed: 0.3294s/iter; left time: 5653.5625s
	iters: 200, epoch: 18 | loss: 1.3790673
	speed: 0.0934s/iter; left time: 1594.2916s
Epoch: 18 cost time: 19.945117235183716
Epoch: 18, Steps: 208 | Train Loss: 1.314 Vali Loss: 4.519 Vali Acc: 0.099 Test Loss: 4.519 Test Acc: 0.099
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.3752215
	speed: 0.3492s/iter; left time: 5920.6075s
	iters: 200, epoch: 19 | loss: 1.5384806
	speed: 0.0952s/iter; left time: 1604.3378s
Epoch: 19 cost time: 20.682128429412842
Epoch: 19, Steps: 208 | Train Loss: 1.178 Vali Loss: 4.549 Vali Acc: 0.115 Test Loss: 4.549 Test Acc: 0.115
Validation loss decreased (-0.111505 --> -0.114777).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.8172129
	speed: 0.3835s/iter; left time: 6422.8334s
	iters: 200, epoch: 20 | loss: 1.2095877
	speed: 0.0958s/iter; left time: 1594.1601s
Epoch: 20 cost time: 21.3037428855896
Epoch: 20, Steps: 208 | Train Loss: 1.079 Vali Loss: 4.919 Vali Acc: 0.108 Test Loss: 4.919 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.1806657
	speed: 0.3274s/iter; left time: 5415.6203s
	iters: 200, epoch: 21 | loss: 1.2015220
	speed: 0.0832s/iter; left time: 1367.6794s
Epoch: 21 cost time: 17.93993616104126
Epoch: 21, Steps: 208 | Train Loss: 0.928 Vali Loss: 4.934 Vali Acc: 0.109 Test Loss: 4.934 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.1688098
	speed: 0.3164s/iter; left time: 5167.8328s
	iters: 200, epoch: 22 | loss: 0.6614660
	speed: 0.0774s/iter; left time: 1256.0426s
Epoch: 22 cost time: 17.76802635192871
Epoch: 22, Steps: 208 | Train Loss: 0.855 Vali Loss: 5.263 Vali Acc: 0.104 Test Loss: 5.263 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.6032010
	speed: 0.2882s/iter; left time: 4646.8050s
	iters: 200, epoch: 23 | loss: 0.8126454
	speed: 0.0835s/iter; left time: 1337.8363s
Epoch: 23 cost time: 17.972582578659058
Epoch: 23, Steps: 208 | Train Loss: 0.784 Vali Loss: 5.240 Vali Acc: 0.105 Test Loss: 5.240 Test Acc: 0.105
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.2968366
	speed: 0.3109s/iter; left time: 4949.1060s
	iters: 200, epoch: 24 | loss: 0.9756622
	speed: 0.0835s/iter; left time: 1320.6115s
Epoch: 24 cost time: 17.961053371429443
Epoch: 24, Steps: 208 | Train Loss: 0.695 Vali Loss: 5.581 Vali Acc: 0.108 Test Loss: 5.581 Test Acc: 0.108
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.5179589
	speed: 0.3457s/iter; left time: 5430.8051s
	iters: 200, epoch: 25 | loss: 0.5766096
	speed: 0.1028s/iter; left time: 1604.2824s
Epoch: 25 cost time: 20.885003566741943
Epoch: 25, Steps: 208 | Train Loss: 0.669 Vali Loss: 5.703 Vali Acc: 0.106 Test Loss: 5.703 Test Acc: 0.106
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.6468321
	speed: 0.3556s/iter; left time: 5512.8786s
	iters: 200, epoch: 26 | loss: 0.2922177
	speed: 0.0990s/iter; left time: 1524.1915s
Epoch: 26 cost time: 22.079095602035522
Epoch: 26, Steps: 208 | Train Loss: 0.633 Vali Loss: 5.817 Vali Acc: 0.109 Test Loss: 5.817 Test Acc: 0.109
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.8369352
	speed: 0.3681s/iter; left time: 5628.6854s
	iters: 200, epoch: 27 | loss: 1.2970694
	speed: 0.0881s/iter; left time: 1338.9922s
Epoch: 27 cost time: 20.20671248435974
Epoch: 27, Steps: 208 | Train Loss: 0.585 Vali Loss: 6.171 Vali Acc: 0.106 Test Loss: 6.171 Test Acc: 0.106
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.9577915
	speed: 0.4322s/iter; left time: 6519.5728s
	iters: 200, epoch: 28 | loss: 1.0192103
	speed: 0.0922s/iter; left time: 1381.1797s
Epoch: 28 cost time: 24.039947986602783
Epoch: 28, Steps: 208 | Train Loss: 0.562 Vali Loss: 6.144 Vali Acc: 0.107 Test Loss: 6.144 Test Acc: 0.107
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.3813746
	speed: 0.3913s/iter; left time: 5821.5154s
	iters: 200, epoch: 29 | loss: 0.4129083
	speed: 0.1170s/iter; left time: 1728.7548s
Epoch: 29 cost time: 23.645587921142578
Epoch: 29, Steps: 208 | Train Loss: 0.538 Vali Loss: 6.552 Vali Acc: 0.105 Test Loss: 6.552 Test Acc: 0.105
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11482254697286012
model parameter : 432663
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6719077
	speed: 0.1162s/iter; left time: 2406.2633s
	iters: 200, epoch: 1 | loss: 3.6634295
	speed: 0.0902s/iter; left time: 1858.6106s
Epoch: 1 cost time: 21.516868591308594
Epoch: 1, Steps: 208 | Train Loss: 3.713 Vali Loss: 3.544 Vali Acc: 0.051 Test Loss: 3.544 Test Acc: 0.051
Validation loss decreased (inf --> -0.050964).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4840407
	speed: 0.3499s/iter; left time: 7169.6242s
	iters: 200, epoch: 2 | loss: 3.6672137
	speed: 0.0859s/iter; left time: 1752.3826s
Epoch: 2 cost time: 17.568562030792236
Epoch: 2, Steps: 208 | Train Loss: 3.577 Vali Loss: 3.567 Vali Acc: 0.060 Test Loss: 3.567 Test Acc: 0.060
Validation loss decreased (-0.050964 --> -0.059911).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5690703
	speed: 0.3214s/iter; left time: 6519.8300s
	iters: 200, epoch: 3 | loss: 3.4854884
	speed: 0.0918s/iter; left time: 1853.8496s
Epoch: 3 cost time: 20.933324337005615
Epoch: 3, Steps: 208 | Train Loss: 3.501 Vali Loss: 3.500 Vali Acc: 0.061 Test Loss: 3.500 Test Acc: 0.061
Validation loss decreased (-0.059911 --> -0.060806).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3816226
	speed: 0.3318s/iter; left time: 6661.2825s
	iters: 200, epoch: 4 | loss: 3.8386664
	speed: 0.0864s/iter; left time: 1725.5618s
Epoch: 4 cost time: 18.849560022354126
Epoch: 4, Steps: 208 | Train Loss: 3.423 Vali Loss: 3.531 Vali Acc: 0.061 Test Loss: 3.531 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.3401015
	speed: 0.3539s/iter; left time: 7031.2772s
	iters: 200, epoch: 5 | loss: 3.2917316
	speed: 0.0909s/iter; left time: 1796.5512s
Epoch: 5 cost time: 20.505794763565063
Epoch: 5, Steps: 208 | Train Loss: 3.364 Vali Loss: 3.489 Vali Acc: 0.064 Test Loss: 3.489 Test Acc: 0.064
Validation loss decreased (-0.060806 --> -0.063789).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.3661327
	speed: 0.3221s/iter; left time: 6332.0908s
	iters: 200, epoch: 6 | loss: 3.1290596
	speed: 0.0831s/iter; left time: 1625.3504s
Epoch: 6 cost time: 17.194491147994995
Epoch: 6, Steps: 208 | Train Loss: 3.280 Vali Loss: 3.500 Vali Acc: 0.078 Test Loss: 3.500 Test Acc: 0.078
Validation loss decreased (-0.063789 --> -0.077806).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9062877
	speed: 0.3327s/iter; left time: 6471.8194s
	iters: 200, epoch: 7 | loss: 2.8155363
	speed: 0.0867s/iter; left time: 1678.6365s
Epoch: 7 cost time: 18.47890830039978
Epoch: 7, Steps: 208 | Train Loss: 3.127 Vali Loss: 3.398 Vali Acc: 0.089 Test Loss: 3.398 Test Acc: 0.089
Validation loss decreased (-0.077806 --> -0.089140).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.1940317
	speed: 0.3487s/iter; left time: 6711.2677s
	iters: 200, epoch: 8 | loss: 3.4746618
	speed: 0.0821s/iter; left time: 1571.4380s
Epoch: 8 cost time: 19.75605058670044
Epoch: 8, Steps: 208 | Train Loss: 2.974 Vali Loss: 3.363 Vali Acc: 0.105 Test Loss: 3.363 Test Acc: 0.105
Validation loss decreased (-0.089140 --> -0.104947).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.4470513
	speed: 0.3299s/iter; left time: 6280.6831s
	iters: 200, epoch: 9 | loss: 3.2669525
	speed: 0.0911s/iter; left time: 1724.4580s
Epoch: 9 cost time: 19.344518899917603
Epoch: 9, Steps: 208 | Train Loss: 2.846 Vali Loss: 3.343 Vali Acc: 0.104 Test Loss: 3.343 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.6357379
	speed: 0.3344s/iter; left time: 6296.7143s
	iters: 200, epoch: 10 | loss: 3.0043588
	speed: 0.0854s/iter; left time: 1600.0690s
Epoch: 10 cost time: 17.915327787399292
Epoch: 10, Steps: 208 | Train Loss: 2.672 Vali Loss: 3.376 Vali Acc: 0.107 Test Loss: 3.376 Test Acc: 0.107
Validation loss decreased (-0.104947 --> -0.106736).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.3870924
	speed: 0.3482s/iter; left time: 6483.9373s
	iters: 200, epoch: 11 | loss: 3.0470631
	speed: 0.0889s/iter; left time: 1646.6534s
Epoch: 11 cost time: 19.29948854446411
Epoch: 11, Steps: 208 | Train Loss: 2.509 Vali Loss: 3.460 Vali Acc: 0.092 Test Loss: 3.460 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.5853662
	speed: 0.3409s/iter; left time: 6276.3906s
	iters: 200, epoch: 12 | loss: 2.2634194
	speed: 0.0925s/iter; left time: 1693.8950s
Epoch: 12 cost time: 19.098744869232178
Epoch: 12, Steps: 208 | Train Loss: 2.346 Vali Loss: 3.502 Vali Acc: 0.113 Test Loss: 3.502 Test Acc: 0.113
Validation loss decreased (-0.106736 --> -0.113296).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.2784278
	speed: 0.3184s/iter; left time: 5796.3060s
	iters: 200, epoch: 13 | loss: 3.4612699
	speed: 0.0843s/iter; left time: 1526.6668s
Epoch: 13 cost time: 19.41402006149292
Epoch: 13, Steps: 208 | Train Loss: 2.158 Vali Loss: 3.694 Vali Acc: 0.100 Test Loss: 3.694 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.1698053
	speed: 0.2704s/iter; left time: 4866.5983s
	iters: 200, epoch: 14 | loss: 1.7532939
	speed: 0.0824s/iter; left time: 1474.9313s
Epoch: 14 cost time: 17.073121309280396
Epoch: 14, Steps: 208 | Train Loss: 1.944 Vali Loss: 3.761 Vali Acc: 0.111 Test Loss: 3.761 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.7281840
	speed: 0.3241s/iter; left time: 5765.8463s
	iters: 200, epoch: 15 | loss: 2.2115464
	speed: 0.0854s/iter; left time: 1509.9780s
Epoch: 15 cost time: 18.92439341545105
Epoch: 15, Steps: 208 | Train Loss: 1.753 Vali Loss: 3.888 Vali Acc: 0.103 Test Loss: 3.888 Test Acc: 0.103
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.4359829
	speed: 0.3118s/iter; left time: 5482.3900s
	iters: 200, epoch: 16 | loss: 1.5247337
	speed: 0.0768s/iter; left time: 1342.9644s
Epoch: 16 cost time: 16.999967098236084
Epoch: 16, Steps: 208 | Train Loss: 1.576 Vali Loss: 4.099 Vali Acc: 0.106 Test Loss: 4.099 Test Acc: 0.106
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.9068167
	speed: 0.3063s/iter; left time: 5321.3084s
	iters: 200, epoch: 17 | loss: 1.6573306
	speed: 0.0763s/iter; left time: 1318.1911s
Epoch: 17 cost time: 16.902554273605347
Epoch: 17, Steps: 208 | Train Loss: 1.443 Vali Loss: 4.298 Vali Acc: 0.116 Test Loss: 4.298 Test Acc: 0.116
Validation loss decreased (-0.113296 --> -0.115973).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.4476098
	speed: 0.2986s/iter; left time: 5126.0585s
	iters: 200, epoch: 18 | loss: 1.5873802
	speed: 0.0809s/iter; left time: 1381.2187s
Epoch: 18 cost time: 17.906890392303467
Epoch: 18, Steps: 208 | Train Loss: 1.292 Vali Loss: 4.340 Vali Acc: 0.116 Test Loss: 4.340 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.3650838
	speed: 0.2915s/iter; left time: 4943.6358s
	iters: 200, epoch: 19 | loss: 1.6339124
	speed: 0.0849s/iter; left time: 1430.9791s
Epoch: 19 cost time: 17.286707878112793
Epoch: 19, Steps: 208 | Train Loss: 1.147 Vali Loss: 4.511 Vali Acc: 0.120 Test Loss: 4.511 Test Acc: 0.120
Validation loss decreased (-0.115973 --> -0.119848).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.8793699
	speed: 0.3201s/iter; left time: 5360.8488s
	iters: 200, epoch: 20 | loss: 1.1581542
	speed: 0.0812s/iter; left time: 1351.3901s
Epoch: 20 cost time: 18.43489360809326
Epoch: 20, Steps: 208 | Train Loss: 1.033 Vali Loss: 4.737 Vali Acc: 0.113 Test Loss: 4.737 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.2373751
	speed: 0.2758s/iter; left time: 4562.2790s
	iters: 200, epoch: 21 | loss: 0.5620334
	speed: 0.0746s/iter; left time: 1227.2159s
Epoch: 21 cost time: 15.828608512878418
Epoch: 21, Steps: 208 | Train Loss: 0.914 Vali Loss: 4.929 Vali Acc: 0.113 Test Loss: 4.929 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.8284194
	speed: 0.2882s/iter; left time: 4706.7839s
	iters: 200, epoch: 22 | loss: 1.3879530
	speed: 0.0832s/iter; left time: 1350.4011s
Epoch: 22 cost time: 17.61523461341858
Epoch: 22, Steps: 208 | Train Loss: 0.875 Vali Loss: 5.124 Vali Acc: 0.111 Test Loss: 5.124 Test Acc: 0.111
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 1.0854871
	speed: 0.3449s/iter; left time: 5561.2940s
	iters: 200, epoch: 23 | loss: 0.4883472
	speed: 0.0793s/iter; left time: 1271.1690s
Epoch: 23 cost time: 19.601989030838013
Epoch: 23, Steps: 208 | Train Loss: 0.769 Vali Loss: 5.246 Vali Acc: 0.112 Test Loss: 5.246 Test Acc: 0.112
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.6560352
	speed: 0.3103s/iter; left time: 4938.7744s
	iters: 200, epoch: 24 | loss: 0.6925840
	speed: 0.0895s/iter; left time: 1415.7568s
Epoch: 24 cost time: 18.688560962677002
Epoch: 24, Steps: 208 | Train Loss: 0.710 Vali Loss: 5.363 Vali Acc: 0.119 Test Loss: 5.363 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.8396882
	speed: 0.3142s/iter; left time: 4935.1247s
	iters: 200, epoch: 25 | loss: 0.5389977
	speed: 0.0788s/iter; left time: 1230.6797s
Epoch: 25 cost time: 16.965132236480713
Epoch: 25, Steps: 208 | Train Loss: 0.641 Vali Loss: 5.670 Vali Acc: 0.112 Test Loss: 5.670 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.8045496
	speed: 0.3023s/iter; left time: 4686.5002s
	iters: 200, epoch: 26 | loss: 1.0675960
	speed: 0.0771s/iter; left time: 1186.6800s
Epoch: 26 cost time: 17.774543046951294
Epoch: 26, Steps: 208 | Train Loss: 0.615 Vali Loss: 5.738 Vali Acc: 0.110 Test Loss: 5.738 Test Acc: 0.110
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.1840000
	speed: 0.3028s/iter; left time: 4630.0438s
	iters: 200, epoch: 27 | loss: 0.4744937
	speed: 0.0786s/iter; left time: 1194.6129s
Epoch: 27 cost time: 17.530078649520874
Epoch: 27, Steps: 208 | Train Loss: 0.555 Vali Loss: 5.882 Vali Acc: 0.112 Test Loss: 5.882 Test Acc: 0.112
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.6288526
	speed: 0.2784s/iter; left time: 4199.7642s
	iters: 200, epoch: 28 | loss: 0.2807345
	speed: 0.0728s/iter; left time: 1090.8652s
Epoch: 28 cost time: 16.464673042297363
Epoch: 28, Steps: 208 | Train Loss: 0.549 Vali Loss: 6.201 Vali Acc: 0.110 Test Loss: 6.201 Test Acc: 0.110
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.9571001
	speed: 0.2881s/iter; left time: 4285.7887s
	iters: 200, epoch: 29 | loss: 0.7070720
	speed: 0.0766s/iter; left time: 1131.2704s
Epoch: 29 cost time: 16.062480211257935
Epoch: 29, Steps: 208 | Train Loss: 0.535 Vali Loss: 6.390 Vali Acc: 0.108 Test Loss: 6.390 Test Acc: 0.108
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11989263346257083
model parameter : 319447
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8015001
	speed: 0.1040s/iter; left time: 2153.4849s
	iters: 200, epoch: 1 | loss: 3.8080111
	speed: 0.0769s/iter; left time: 1583.7436s
Epoch: 1 cost time: 18.761146545410156
Epoch: 1, Steps: 208 | Train Loss: 3.690 Vali Loss: 3.614 Vali Acc: 0.044 Test Loss: 3.614 Test Acc: 0.044
Validation loss decreased (inf --> -0.043507).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6160705
	speed: 0.2878s/iter; left time: 5896.9163s
	iters: 200, epoch: 2 | loss: 3.1948264
	speed: 0.0731s/iter; left time: 1490.1557s
Epoch: 2 cost time: 16.20993947982788
Epoch: 2, Steps: 208 | Train Loss: 3.574 Vali Loss: 3.633 Vali Acc: 0.065 Test Loss: 3.633 Test Acc: 0.065
Validation loss decreased (-0.043507 --> -0.064682).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.8428817
	speed: 0.2876s/iter; left time: 5834.4780s
	iters: 200, epoch: 3 | loss: 3.2671571
	speed: 0.0745s/iter; left time: 1502.9568s
Epoch: 3 cost time: 16.412524938583374
Epoch: 3, Steps: 208 | Train Loss: 3.506 Vali Loss: 3.588 Vali Acc: 0.066 Test Loss: 3.588 Test Acc: 0.066
Validation loss decreased (-0.064682 --> -0.065577).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.6558936
	speed: 0.2702s/iter; left time: 5425.3503s
	iters: 200, epoch: 4 | loss: 3.7409706
	speed: 0.0765s/iter; left time: 1527.8524s
Epoch: 4 cost time: 15.883290767669678
Epoch: 4, Steps: 208 | Train Loss: 3.420 Vali Loss: 3.472 Vali Acc: 0.069 Test Loss: 3.472 Test Acc: 0.069
Validation loss decreased (-0.065577 --> -0.068859).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2577770
	speed: 0.2622s/iter; left time: 5209.7312s
	iters: 200, epoch: 5 | loss: 3.2697072
	speed: 0.0725s/iter; left time: 1433.8979s
Epoch: 5 cost time: 15.56425404548645
Epoch: 5, Steps: 208 | Train Loss: 3.325 Vali Loss: 3.618 Vali Acc: 0.061 Test Loss: 3.618 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.1318827
	speed: 0.2918s/iter; left time: 5737.8569s
	iters: 200, epoch: 6 | loss: 3.2332432
	speed: 0.0743s/iter; left time: 1453.9262s
Epoch: 6 cost time: 16.542924165725708
Epoch: 6, Steps: 208 | Train Loss: 3.220 Vali Loss: 3.458 Vali Acc: 0.079 Test Loss: 3.458 Test Acc: 0.079
Validation loss decreased (-0.068859 --> -0.078999).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.5321336
	speed: 0.3002s/iter; left time: 5839.5934s
	iters: 200, epoch: 7 | loss: 3.2594726
	speed: 0.0779s/iter; left time: 1508.1960s
Epoch: 7 cost time: 17.069259881973267
Epoch: 7, Steps: 208 | Train Loss: 3.062 Vali Loss: 3.375 Vali Acc: 0.095 Test Loss: 3.375 Test Acc: 0.095
Validation loss decreased (-0.078999 --> -0.094807).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.4876390
	speed: 0.3023s/iter; left time: 5818.5466s
	iters: 200, epoch: 8 | loss: 2.7288110
	speed: 0.0836s/iter; left time: 1599.9295s
Epoch: 8 cost time: 17.345933198928833
Epoch: 8, Steps: 208 | Train Loss: 2.909 Vali Loss: 3.329 Vali Acc: 0.096 Test Loss: 3.329 Test Acc: 0.096
Validation loss decreased (-0.094807 --> -0.096298).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.3852000
	speed: 0.2800s/iter; left time: 5330.0183s
	iters: 200, epoch: 9 | loss: 2.6260242
	speed: 0.0803s/iter; left time: 1521.3972s
Epoch: 9 cost time: 16.44997787475586
Epoch: 9, Steps: 208 | Train Loss: 2.755 Vali Loss: 3.388 Vali Acc: 0.111 Test Loss: 3.388 Test Acc: 0.111
Validation loss decreased (-0.096298 --> -0.110613).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.4085307
	speed: 0.2893s/iter; left time: 5447.9162s
	iters: 200, epoch: 10 | loss: 2.5856831
	speed: 0.0755s/iter; left time: 1414.2751s
Epoch: 10 cost time: 15.976553678512573
Epoch: 10, Steps: 208 | Train Loss: 2.576 Vali Loss: 3.426 Vali Acc: 0.109 Test Loss: 3.426 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.3799226
	speed: 0.2669s/iter; left time: 4969.2212s
	iters: 200, epoch: 11 | loss: 3.1798275
	speed: 0.0745s/iter; left time: 1379.6332s
Epoch: 11 cost time: 16.43826913833618
Epoch: 11, Steps: 208 | Train Loss: 2.431 Vali Loss: 3.391 Vali Acc: 0.112 Test Loss: 3.391 Test Acc: 0.112
Validation loss decreased (-0.110613 --> -0.112104).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.8108866
	speed: 0.2638s/iter; left time: 4857.1579s
	iters: 200, epoch: 12 | loss: 2.7322791
	speed: 0.0745s/iter; left time: 1363.8877s
Epoch: 12 cost time: 15.796503782272339
Epoch: 12, Steps: 208 | Train Loss: 2.276 Vali Loss: 3.458 Vali Acc: 0.112 Test Loss: 3.458 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.4629260
	speed: 0.2664s/iter; left time: 4850.4557s
	iters: 200, epoch: 13 | loss: 2.2813563
	speed: 0.0775s/iter; left time: 1402.3310s
Epoch: 13 cost time: 16.97193455696106
Epoch: 13, Steps: 208 | Train Loss: 2.089 Vali Loss: 3.639 Vali Acc: 0.116 Test Loss: 3.639 Test Acc: 0.116
Validation loss decreased (-0.112104 --> -0.116277).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.9027896
	speed: 0.3005s/iter; left time: 5407.7130s
	iters: 200, epoch: 14 | loss: 2.3470769
	speed: 0.0881s/iter; left time: 1577.2639s
Epoch: 14 cost time: 18.86575937271118
Epoch: 14, Steps: 208 | Train Loss: 1.900 Vali Loss: 3.740 Vali Acc: 0.122 Test Loss: 3.740 Test Acc: 0.122
Validation loss decreased (-0.116277 --> -0.122241).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.8995194
	speed: 0.2873s/iter; left time: 5110.6072s
	iters: 200, epoch: 15 | loss: 1.9718993
	speed: 0.0790s/iter; left time: 1397.1978s
Epoch: 15 cost time: 16.757704496383667
Epoch: 15, Steps: 208 | Train Loss: 1.717 Vali Loss: 3.840 Vali Acc: 0.119 Test Loss: 3.840 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.6820879
	speed: 0.2828s/iter; left time: 4971.7988s
	iters: 200, epoch: 16 | loss: 1.6347122
	speed: 0.0720s/iter; left time: 1257.8612s
Epoch: 16 cost time: 15.660309791564941
Epoch: 16, Steps: 208 | Train Loss: 1.542 Vali Loss: 3.992 Vali Acc: 0.119 Test Loss: 3.992 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.3970808
	speed: 0.2670s/iter; left time: 4638.5522s
	iters: 200, epoch: 17 | loss: 1.9054176
	speed: 0.0724s/iter; left time: 1250.7005s
Epoch: 17 cost time: 15.565603733062744
Epoch: 17, Steps: 208 | Train Loss: 1.425 Vali Loss: 4.108 Vali Acc: 0.111 Test Loss: 4.108 Test Acc: 0.111
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.1041472
	speed: 0.2724s/iter; left time: 4675.4205s
	iters: 200, epoch: 18 | loss: 1.5383400
	speed: 0.0768s/iter; left time: 1310.5153s
Epoch: 18 cost time: 16.22722864151001
Epoch: 18, Steps: 208 | Train Loss: 1.277 Vali Loss: 4.335 Vali Acc: 0.109 Test Loss: 4.335 Test Acc: 0.109
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.6268462
	speed: 0.2769s/iter; left time: 4695.0046s
	iters: 200, epoch: 19 | loss: 0.5906753
	speed: 0.0751s/iter; left time: 1265.5734s
Epoch: 19 cost time: 16.117616176605225
Epoch: 19, Steps: 208 | Train Loss: 1.140 Vali Loss: 4.514 Vali Acc: 0.120 Test Loss: 4.514 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 1.2058938
	speed: 0.2997s/iter; left time: 5019.1647s
	iters: 200, epoch: 20 | loss: 1.0282297
	speed: 0.0765s/iter; left time: 1274.1943s
Epoch: 20 cost time: 17.040851593017578
Epoch: 20, Steps: 208 | Train Loss: 1.031 Vali Loss: 4.754 Vali Acc: 0.120 Test Loss: 4.754 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 1.2689315
	speed: 0.2792s/iter; left time: 4619.0270s
	iters: 200, epoch: 21 | loss: 1.0404131
	speed: 0.0761s/iter; left time: 1251.0370s
Epoch: 21 cost time: 16.277364492416382
Epoch: 21, Steps: 208 | Train Loss: 0.944 Vali Loss: 4.994 Vali Acc: 0.115 Test Loss: 4.994 Test Acc: 0.115
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 1.1361587
	speed: 0.2828s/iter; left time: 4619.6668s
	iters: 200, epoch: 22 | loss: 0.5445235
	speed: 0.0803s/iter; left time: 1302.9818s
Epoch: 22 cost time: 17.418782472610474
Epoch: 22, Steps: 208 | Train Loss: 0.847 Vali Loss: 5.045 Vali Acc: 0.114 Test Loss: 5.045 Test Acc: 0.114
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 1.1110255
	speed: 0.2873s/iter; left time: 4633.2853s
	iters: 200, epoch: 23 | loss: 1.3569552
	speed: 0.0686s/iter; left time: 1099.9326s
Epoch: 23 cost time: 15.742767095565796
Epoch: 23, Steps: 208 | Train Loss: 0.790 Vali Loss: 5.121 Vali Acc: 0.115 Test Loss: 5.121 Test Acc: 0.115
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.5262980
	speed: 0.2696s/iter; left time: 4291.9977s
	iters: 200, epoch: 24 | loss: 0.5504403
	speed: 0.0734s/iter; left time: 1161.5743s
Epoch: 24 cost time: 15.908408164978027
Epoch: 24, Steps: 208 | Train Loss: 0.720 Vali Loss: 5.527 Vali Acc: 0.121 Test Loss: 5.527 Test Acc: 0.121
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12227855651655234
model parameter : 318359
model size : 1.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5965440
	speed: 0.0976s/iter; left time: 2020.8696s
	iters: 200, epoch: 1 | loss: 3.9470015
	speed: 0.0735s/iter; left time: 1514.0533s
Epoch: 1 cost time: 17.798916578292847
Epoch: 1, Steps: 208 | Train Loss: 3.712 Vali Loss: 3.601 Vali Acc: 0.055 Test Loss: 3.601 Test Acc: 0.055
Validation loss decreased (inf --> -0.054840).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5245948
	speed: 0.2719s/iter; left time: 5571.9947s
	iters: 200, epoch: 2 | loss: 3.3325520
	speed: 0.0679s/iter; left time: 1384.8591s
Epoch: 2 cost time: 14.884170770645142
Epoch: 2, Steps: 208 | Train Loss: 3.590 Vali Loss: 3.599 Vali Acc: 0.057 Test Loss: 3.599 Test Acc: 0.057
Validation loss decreased (-0.054840 --> -0.056928).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5716894
	speed: 0.2817s/iter; left time: 5713.3633s
	iters: 200, epoch: 3 | loss: 3.2793641
	speed: 0.0693s/iter; left time: 1398.1352s
Epoch: 3 cost time: 15.357493877410889
Epoch: 3, Steps: 208 | Train Loss: 3.511 Vali Loss: 3.518 Vali Acc: 0.065 Test Loss: 3.518 Test Acc: 0.065
Validation loss decreased (-0.056928 --> -0.064683).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.1517060
	speed: 0.2738s/iter; left time: 5496.8445s
	iters: 200, epoch: 4 | loss: 3.4898078
	speed: 0.0708s/iter; left time: 1414.2500s
Epoch: 4 cost time: 15.258528232574463
Epoch: 4, Steps: 208 | Train Loss: 3.431 Vali Loss: 3.454 Vali Acc: 0.077 Test Loss: 3.454 Test Acc: 0.077
Validation loss decreased (-0.064683 --> -0.076613).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.9117410
	speed: 0.2766s/iter; left time: 5495.7432s
	iters: 200, epoch: 5 | loss: 3.4259641
	speed: 0.0819s/iter; left time: 1619.9115s
Epoch: 5 cost time: 16.94967818260193
Epoch: 5, Steps: 208 | Train Loss: 3.358 Vali Loss: 3.469 Vali Acc: 0.069 Test Loss: 3.469 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.2395608
	speed: 0.2803s/iter; left time: 5510.4208s
	iters: 200, epoch: 6 | loss: 3.2179101
	speed: 0.0774s/iter; left time: 1514.3232s
Epoch: 6 cost time: 16.872422218322754
Epoch: 6, Steps: 208 | Train Loss: 3.280 Vali Loss: 3.473 Vali Acc: 0.074 Test Loss: 3.473 Test Acc: 0.074
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 3.0692823
	speed: 0.2636s/iter; left time: 5127.3135s
	iters: 200, epoch: 7 | loss: 3.4971535
	speed: 0.0718s/iter; left time: 1389.0363s
Epoch: 7 cost time: 15.493151187896729
Epoch: 7, Steps: 208 | Train Loss: 3.170 Vali Loss: 3.415 Vali Acc: 0.077 Test Loss: 3.415 Test Acc: 0.077
Validation loss decreased (-0.076613 --> -0.077210).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.2309337
	speed: 0.2710s/iter; left time: 5215.2832s
	iters: 200, epoch: 8 | loss: 3.2095189
	speed: 0.0738s/iter; left time: 1413.7082s
Epoch: 8 cost time: 15.579662084579468
Epoch: 8, Steps: 208 | Train Loss: 3.029 Vali Loss: 3.361 Vali Acc: 0.092 Test Loss: 3.361 Test Acc: 0.092
Validation loss decreased (-0.077210 --> -0.092421).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.5476401
	speed: 0.2626s/iter; left time: 4998.9252s
	iters: 200, epoch: 9 | loss: 2.9610896
	speed: 0.0814s/iter; left time: 1541.2372s
Epoch: 9 cost time: 16.58453917503357
Epoch: 9, Steps: 208 | Train Loss: 2.858 Vali Loss: 3.338 Vali Acc: 0.111 Test Loss: 3.338 Test Acc: 0.111
Validation loss decreased (-0.092421 --> -0.110614).  Saving model ...
	iters: 100, epoch: 10 | loss: 3.0180337
	speed: 0.2761s/iter; left time: 5199.0370s
	iters: 200, epoch: 10 | loss: 2.6025152
	speed: 0.0706s/iter; left time: 1322.0675s
Epoch: 10 cost time: 15.831872940063477
Epoch: 10, Steps: 208 | Train Loss: 2.721 Vali Loss: 3.335 Vali Acc: 0.091 Test Loss: 3.335 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.6108778
	speed: 0.2824s/iter; left time: 5259.2185s
	iters: 200, epoch: 11 | loss: 2.4672570
	speed: 0.0778s/iter; left time: 1441.7271s
Epoch: 11 cost time: 16.39345121383667
Epoch: 11, Steps: 208 | Train Loss: 2.545 Vali Loss: 3.408 Vali Acc: 0.121 Test Loss: 3.408 Test Acc: 0.121
Validation loss decreased (-0.110614 --> -0.121350).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.0930727
	speed: 0.2954s/iter; left time: 5438.6690s
	iters: 200, epoch: 12 | loss: 2.0775039
	speed: 0.0700s/iter; left time: 1281.9080s
Epoch: 12 cost time: 15.7052161693573
Epoch: 12, Steps: 208 | Train Loss: 2.408 Vali Loss: 3.447 Vali Acc: 0.109 Test Loss: 3.447 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.2242861
	speed: 0.2616s/iter; left time: 4761.6437s
	iters: 200, epoch: 13 | loss: 2.6880369
	speed: 0.0698s/iter; left time: 1263.8019s
Epoch: 13 cost time: 14.939342021942139
Epoch: 13, Steps: 208 | Train Loss: 2.243 Vali Loss: 3.576 Vali Acc: 0.109 Test Loss: 3.576 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 2.2316034
	speed: 0.2703s/iter; left time: 4864.2319s
	iters: 200, epoch: 14 | loss: 2.2573433
	speed: 0.0722s/iter; left time: 1291.6220s
Epoch: 14 cost time: 16.191915273666382
Epoch: 14, Steps: 208 | Train Loss: 2.052 Vali Loss: 3.614 Vali Acc: 0.115 Test Loss: 3.614 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.7550747
	speed: 0.2545s/iter; left time: 4528.1467s
	iters: 200, epoch: 15 | loss: 2.8872654
	speed: 0.0708s/iter; left time: 1253.2368s
Epoch: 15 cost time: 14.991602182388306
Epoch: 15, Steps: 208 | Train Loss: 1.876 Vali Loss: 3.717 Vali Acc: 0.119 Test Loss: 3.717 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.0752213
	speed: 0.2532s/iter; left time: 4450.7012s
	iters: 200, epoch: 16 | loss: 1.8558267
	speed: 0.0706s/iter; left time: 1234.6746s
Epoch: 16 cost time: 15.370426654815674
Epoch: 16, Steps: 208 | Train Loss: 1.679 Vali Loss: 3.989 Vali Acc: 0.112 Test Loss: 3.989 Test Acc: 0.112
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.5040288
	speed: 0.2454s/iter; left time: 4263.7909s
	iters: 200, epoch: 17 | loss: 1.9087163
	speed: 0.0685s/iter; left time: 1182.9090s
Epoch: 17 cost time: 14.567982912063599
Epoch: 17, Steps: 208 | Train Loss: 1.531 Vali Loss: 4.060 Vali Acc: 0.112 Test Loss: 4.060 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.9439574
	speed: 0.2623s/iter; left time: 4501.8249s
	iters: 200, epoch: 18 | loss: 1.5047879
	speed: 0.0674s/iter; left time: 1149.9711s
Epoch: 18 cost time: 14.763572454452515
Epoch: 18, Steps: 208 | Train Loss: 1.383 Vali Loss: 4.320 Vali Acc: 0.115 Test Loss: 4.320 Test Acc: 0.115
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.0185567
	speed: 0.2729s/iter; left time: 4628.2910s
	iters: 200, epoch: 19 | loss: 1.3732498
	speed: 0.0728s/iter; left time: 1227.5340s
Epoch: 19 cost time: 16.302252531051636
Epoch: 19, Steps: 208 | Train Loss: 1.243 Vali Loss: 4.466 Vali Acc: 0.109 Test Loss: 4.466 Test Acc: 0.109
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.5510486
	speed: 0.2537s/iter; left time: 4249.8688s
	iters: 200, epoch: 20 | loss: 1.2339146
	speed: 0.0684s/iter; left time: 1139.3542s
Epoch: 20 cost time: 14.751343250274658
Epoch: 20, Steps: 208 | Train Loss: 1.096 Vali Loss: 4.601 Vali Acc: 0.109 Test Loss: 4.601 Test Acc: 0.109
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 1.1543710
	speed: 0.2462s/iter; left time: 4072.8437s
	iters: 200, epoch: 21 | loss: 1.3574839
	speed: 0.0687s/iter; left time: 1129.2870s
Epoch: 21 cost time: 14.836811304092407
Epoch: 21, Steps: 208 | Train Loss: 1.016 Vali Loss: 4.757 Vali Acc: 0.111 Test Loss: 4.757 Test Acc: 0.111
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12138383537130927
model parameter : 317271
model size : 1.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8078175
	speed: 0.0866s/iter; left time: 1793.4087s
	iters: 200, epoch: 1 | loss: 3.2740974
	speed: 0.0696s/iter; left time: 1433.6503s
Epoch: 1 cost time: 16.330881118774414
Epoch: 1, Steps: 208 | Train Loss: 3.687 Vali Loss: 3.587 Vali Acc: 0.056 Test Loss: 3.587 Test Acc: 0.056
Validation loss decreased (inf --> -0.055735).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5773246
	speed: 0.2740s/iter; left time: 5615.2145s
	iters: 200, epoch: 2 | loss: 3.2334321
	speed: 0.0732s/iter; left time: 1493.7239s
Epoch: 2 cost time: 16.207147359848022
Epoch: 2, Steps: 208 | Train Loss: 3.594 Vali Loss: 3.592 Vali Acc: 0.065 Test Loss: 3.592 Test Acc: 0.065
Validation loss decreased (-0.055735 --> -0.064682).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4248912
	speed: 0.2437s/iter; left time: 4944.1742s
	iters: 200, epoch: 3 | loss: 3.2528286
	speed: 0.0778s/iter; left time: 1569.5087s
Epoch: 3 cost time: 16.70998787879944
Epoch: 3, Steps: 208 | Train Loss: 3.498 Vali Loss: 3.503 Vali Acc: 0.071 Test Loss: 3.503 Test Acc: 0.071
Validation loss decreased (-0.064682 --> -0.071244).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.6037660
	speed: 0.2682s/iter; left time: 5385.6305s
	iters: 200, epoch: 4 | loss: 3.0564022
	speed: 0.0713s/iter; left time: 1423.6912s
Epoch: 4 cost time: 15.63330864906311
Epoch: 4, Steps: 208 | Train Loss: 3.412 Vali Loss: 3.601 Vali Acc: 0.059 Test Loss: 3.601 Test Acc: 0.059
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.5247025
	speed: 0.2795s/iter; left time: 5553.3465s
	iters: 200, epoch: 5 | loss: 2.9281559
	speed: 0.0731s/iter; left time: 1444.2160s
Epoch: 5 cost time: 15.719895839691162
Epoch: 5, Steps: 208 | Train Loss: 3.309 Vali Loss: 3.500 Vali Acc: 0.077 Test Loss: 3.500 Test Acc: 0.077
Validation loss decreased (-0.071244 --> -0.077209).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.4962273
	speed: 0.2740s/iter; left time: 5387.7100s
	iters: 200, epoch: 6 | loss: 3.0816772
	speed: 0.0756s/iter; left time: 1478.3417s
Epoch: 6 cost time: 16.35958456993103
Epoch: 6, Steps: 208 | Train Loss: 3.161 Vali Loss: 3.318 Vali Acc: 0.098 Test Loss: 3.318 Test Acc: 0.098
Validation loss decreased (-0.077209 --> -0.098088).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9608941
	speed: 0.2778s/iter; left time: 5403.5320s
	iters: 200, epoch: 7 | loss: 3.1551945
	speed: 0.0696s/iter; left time: 1346.4502s
Epoch: 7 cost time: 15.617828845977783
Epoch: 7, Steps: 208 | Train Loss: 3.007 Vali Loss: 3.333 Vali Acc: 0.102 Test Loss: 3.333 Test Acc: 0.102
Validation loss decreased (-0.098088 --> -0.101965).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.7832007
	speed: 0.2580s/iter; left time: 4964.5546s
	iters: 200, epoch: 8 | loss: 3.4713938
	speed: 0.0695s/iter; left time: 1330.4068s
Epoch: 8 cost time: 15.518401145935059
Epoch: 8, Steps: 208 | Train Loss: 2.869 Vali Loss: 3.298 Vali Acc: 0.106 Test Loss: 3.298 Test Acc: 0.106
Validation loss decreased (-0.101965 --> -0.106439).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.8701093
	speed: 0.2537s/iter; left time: 4829.2306s
	iters: 200, epoch: 9 | loss: 2.8138220
	speed: 0.0711s/iter; left time: 1347.1808s
Epoch: 9 cost time: 14.988785982131958
Epoch: 9, Steps: 208 | Train Loss: 2.724 Vali Loss: 3.427 Vali Acc: 0.104 Test Loss: 3.427 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.1270819
	speed: 0.2577s/iter; left time: 4852.0040s
	iters: 200, epoch: 10 | loss: 2.5473163
	speed: 0.0717s/iter; left time: 1342.1700s
Epoch: 10 cost time: 15.649090051651001
Epoch: 10, Steps: 208 | Train Loss: 2.567 Vali Loss: 3.391 Vali Acc: 0.110 Test Loss: 3.391 Test Acc: 0.110
Validation loss decreased (-0.106439 --> -0.110017).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.5750618
	speed: 0.2568s/iter; left time: 4781.3326s
	iters: 200, epoch: 11 | loss: 2.5088487
	speed: 0.0691s/iter; left time: 1280.6081s
Epoch: 11 cost time: 14.904510498046875
Epoch: 11, Steps: 208 | Train Loss: 2.417 Vali Loss: 3.385 Vali Acc: 0.118 Test Loss: 3.385 Test Acc: 0.118
Validation loss decreased (-0.110017 --> -0.117771).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.8350735
	speed: 0.2485s/iter; left time: 4574.7966s
	iters: 200, epoch: 12 | loss: 2.3607111
	speed: 0.0688s/iter; left time: 1259.3070s
Epoch: 12 cost time: 14.702574253082275
Epoch: 12, Steps: 208 | Train Loss: 2.249 Vali Loss: 3.510 Vali Acc: 0.119 Test Loss: 3.510 Test Acc: 0.119
Validation loss decreased (-0.117771 --> -0.119261).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.2353106
	speed: 0.2630s/iter; left time: 4787.8920s
	iters: 200, epoch: 13 | loss: 2.1162164
	speed: 0.0699s/iter; left time: 1265.9590s
Epoch: 13 cost time: 15.077108144760132
Epoch: 13, Steps: 208 | Train Loss: 2.095 Vali Loss: 3.647 Vali Acc: 0.113 Test Loss: 3.647 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 2.1095548
	speed: 0.2503s/iter; left time: 4504.1833s
	iters: 200, epoch: 14 | loss: 1.8168097
	speed: 0.0816s/iter; left time: 1459.5841s
Epoch: 14 cost time: 17.519739151000977
Epoch: 14, Steps: 208 | Train Loss: 1.914 Vali Loss: 3.778 Vali Acc: 0.108 Test Loss: 3.778 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.5480058
	speed: 0.2591s/iter; left time: 4609.3013s
	iters: 200, epoch: 15 | loss: 1.6967691
	speed: 0.0692s/iter; left time: 1224.1057s
Epoch: 15 cost time: 15.248259544372559
Epoch: 15, Steps: 208 | Train Loss: 1.745 Vali Loss: 3.954 Vali Acc: 0.112 Test Loss: 3.954 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.1999598
	speed: 0.2642s/iter; left time: 4645.5286s
	iters: 200, epoch: 16 | loss: 1.7416835
	speed: 0.0730s/iter; left time: 1275.9854s
Epoch: 16 cost time: 16.087772130966187
Epoch: 16, Steps: 208 | Train Loss: 1.584 Vali Loss: 3.989 Vali Acc: 0.110 Test Loss: 3.989 Test Acc: 0.110
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.3197846
	speed: 0.2486s/iter; left time: 4319.7599s
	iters: 200, epoch: 17 | loss: 1.9886408
	speed: 0.0772s/iter; left time: 1333.6978s
Epoch: 17 cost time: 15.4998300075531
Epoch: 17, Steps: 208 | Train Loss: 1.406 Vali Loss: 4.230 Vali Acc: 0.110 Test Loss: 4.230 Test Acc: 0.110
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.4906613
	speed: 0.2655s/iter; left time: 4556.9678s
	iters: 200, epoch: 18 | loss: 0.7922254
	speed: 0.0697s/iter; left time: 1190.0275s
Epoch: 18 cost time: 15.279870510101318
Epoch: 18, Steps: 208 | Train Loss: 1.288 Vali Loss: 4.283 Vali Acc: 0.120 Test Loss: 4.283 Test Acc: 0.120
Validation loss decreased (-0.119261 --> -0.120148).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.5053027
	speed: 0.2723s/iter; left time: 4617.5421s
	iters: 200, epoch: 19 | loss: 0.8036569
	speed: 0.0721s/iter; left time: 1215.8870s
Epoch: 19 cost time: 15.715945959091187
Epoch: 19, Steps: 208 | Train Loss: 1.168 Vali Loss: 4.543 Vali Acc: 0.118 Test Loss: 4.543 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.6663674
	speed: 0.2750s/iter; left time: 4606.7146s
	iters: 200, epoch: 20 | loss: 1.2330214
	speed: 0.0788s/iter; left time: 1311.9481s
Epoch: 20 cost time: 17.257684469223022
Epoch: 20, Steps: 208 | Train Loss: 1.064 Vali Loss: 4.631 Vali Acc: 0.115 Test Loss: 4.631 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.7754982
	speed: 0.2917s/iter; left time: 4824.3436s
	iters: 200, epoch: 21 | loss: 1.2420560
	speed: 0.0748s/iter; left time: 1229.4917s
Epoch: 21 cost time: 16.202028512954712
Epoch: 21, Steps: 208 | Train Loss: 0.980 Vali Loss: 4.909 Vali Acc: 0.109 Test Loss: 4.909 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.9361269
	speed: 0.2772s/iter; left time: 4527.1701s
	iters: 200, epoch: 22 | loss: 0.8224382
	speed: 0.0734s/iter; left time: 1191.5208s
Epoch: 22 cost time: 16.186191082000732
Epoch: 22, Steps: 208 | Train Loss: 0.866 Vali Loss: 5.066 Vali Acc: 0.108 Test Loss: 5.066 Test Acc: 0.108
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.5409566
	speed: 0.2626s/iter; left time: 4235.1581s
	iters: 200, epoch: 23 | loss: 0.7283749
	speed: 0.0698s/iter; left time: 1118.0332s
Epoch: 23 cost time: 15.316110372543335
Epoch: 23, Steps: 208 | Train Loss: 0.809 Vali Loss: 5.229 Vali Acc: 0.116 Test Loss: 5.229 Test Acc: 0.116
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.5112722
	speed: 0.2749s/iter; left time: 4375.1336s
	iters: 200, epoch: 24 | loss: 0.8283476
	speed: 0.0740s/iter; left time: 1171.1798s
Epoch: 24 cost time: 15.985720872879028
Epoch: 24, Steps: 208 | Train Loss: 0.753 Vali Loss: 5.348 Vali Acc: 0.112 Test Loss: 5.348 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.7732958
	speed: 0.2634s/iter; left time: 4136.9928s
	iters: 200, epoch: 25 | loss: 0.6713384
	speed: 0.0730s/iter; left time: 1139.7155s
Epoch: 25 cost time: 16.240400314331055
Epoch: 25, Steps: 208 | Train Loss: 0.667 Vali Loss: 5.688 Vali Acc: 0.120 Test Loss: 5.688 Test Acc: 0.120
Validation loss decreased (-0.120148 --> -0.120432).  Saving model ...
	iters: 100, epoch: 26 | loss: 1.1622165
	speed: 0.2550s/iter; left time: 3952.9301s
	iters: 200, epoch: 26 | loss: 0.5703359
	speed: 0.0684s/iter; left time: 1052.8641s
Epoch: 26 cost time: 14.89905309677124
Epoch: 26, Steps: 208 | Train Loss: 0.650 Vali Loss: 5.728 Vali Acc: 0.112 Test Loss: 5.728 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.2642333
	speed: 0.2572s/iter; left time: 3932.6242s
	iters: 200, epoch: 27 | loss: 1.0666254
	speed: 0.0746s/iter; left time: 1133.9881s
Epoch: 27 cost time: 15.92485523223877
Epoch: 27, Steps: 208 | Train Loss: 0.610 Vali Loss: 5.803 Vali Acc: 0.110 Test Loss: 5.803 Test Acc: 0.110
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.2582607
	speed: 0.2713s/iter; left time: 4092.2224s
	iters: 200, epoch: 28 | loss: 0.4206123
	speed: 0.0720s/iter; left time: 1078.3514s
Epoch: 28 cost time: 15.60096263885498
Epoch: 28, Steps: 208 | Train Loss: 0.541 Vali Loss: 6.056 Vali Acc: 0.118 Test Loss: 6.056 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.8311407
	speed: 0.2623s/iter; left time: 3901.4986s
	iters: 200, epoch: 29 | loss: 0.5157773
	speed: 0.0725s/iter; left time: 1071.1332s
Epoch: 29 cost time: 15.264894485473633
Epoch: 29, Steps: 208 | Train Loss: 0.529 Vali Loss: 6.213 Vali Acc: 0.111 Test Loss: 6.213 Test Acc: 0.111
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.1907299
	speed: 0.2606s/iter; left time: 3822.1075s
	iters: 200, epoch: 30 | loss: 1.0064391
	speed: 0.0700s/iter; left time: 1019.6179s
Epoch: 30 cost time: 14.787654161453247
Epoch: 30, Steps: 208 | Train Loss: 0.533 Vali Loss: 6.341 Vali Acc: 0.119 Test Loss: 6.341 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.3728149
	speed: 0.2528s/iter; left time: 3655.4772s
	iters: 200, epoch: 31 | loss: 0.7163192
	speed: 0.0740s/iter; left time: 1062.9434s
Epoch: 31 cost time: 15.971645593643188
Epoch: 31, Steps: 208 | Train Loss: 0.509 Vali Loss: 6.440 Vali Acc: 0.108 Test Loss: 6.440 Test Acc: 0.108
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.4106092
	speed: 0.2585s/iter; left time: 3683.7655s
	iters: 200, epoch: 32 | loss: 0.2145075
	speed: 0.0692s/iter; left time: 979.5195s
Epoch: 32 cost time: 15.101390838623047
Epoch: 32, Steps: 208 | Train Loss: 0.504 Vali Loss: 6.673 Vali Acc: 0.115 Test Loss: 6.673 Test Acc: 0.115
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.4175656
	speed: 0.2783s/iter; left time: 3909.2294s
	iters: 200, epoch: 33 | loss: 0.4207352
	speed: 0.0745s/iter; left time: 1039.3749s
Epoch: 33 cost time: 15.973054647445679
Epoch: 33, Steps: 208 | Train Loss: 0.477 Vali Loss: 6.735 Vali Acc: 0.112 Test Loss: 6.735 Test Acc: 0.112
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.2632090
	speed: 0.2855s/iter; left time: 3950.4535s
	iters: 200, epoch: 34 | loss: 0.4734672
	speed: 0.0729s/iter; left time: 1001.4042s
Epoch: 34 cost time: 16.50314712524414
Epoch: 34, Steps: 208 | Train Loss: 0.448 Vali Loss: 6.708 Vali Acc: 0.103 Test Loss: 6.708 Test Acc: 0.103
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.6235106
	speed: 0.2713s/iter; left time: 3697.8943s
	iters: 200, epoch: 35 | loss: 0.6093067
	speed: 0.0753s/iter; left time: 1018.6743s
Epoch: 35 cost time: 16.220934867858887
Epoch: 35, Steps: 208 | Train Loss: 0.443 Vali Loss: 6.881 Vali Acc: 0.111 Test Loss: 6.881 Test Acc: 0.111
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12048911422606622
model parameter : 316183
model size : 1.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6064153
	speed: 0.0929s/iter; left time: 1923.5263s
	iters: 200, epoch: 1 | loss: 3.3914602
	speed: 0.0751s/iter; left time: 1547.7964s
Epoch: 1 cost time: 17.454848527908325
Epoch: 1, Steps: 208 | Train Loss: 3.647 Vali Loss: 3.635 Vali Acc: 0.049 Test Loss: 3.635 Test Acc: 0.049
Validation loss decreased (inf --> -0.048577).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.0266471
	speed: 0.2548s/iter; left time: 5222.6345s
	iters: 200, epoch: 2 | loss: 3.3038764
	speed: 0.0779s/iter; left time: 1589.4951s
Epoch: 2 cost time: 15.883114099502563
Epoch: 2, Steps: 208 | Train Loss: 3.581 Vali Loss: 3.565 Vali Acc: 0.061 Test Loss: 3.565 Test Acc: 0.061
Validation loss decreased (-0.048577 --> -0.060805).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.9189565
	speed: 0.2577s/iter; left time: 5227.5374s
	iters: 200, epoch: 3 | loss: 3.5405192
	speed: 0.0685s/iter; left time: 1381.8286s
Epoch: 3 cost time: 14.840903997421265
Epoch: 3, Steps: 208 | Train Loss: 3.501 Vali Loss: 3.499 Vali Acc: 0.059 Test Loss: 3.499 Test Acc: 0.059
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.5438619
	speed: 0.2549s/iter; left time: 5117.5562s
	iters: 200, epoch: 4 | loss: 3.2354739
	speed: 0.0722s/iter; left time: 1443.2423s
Epoch: 4 cost time: 15.261388301849365
Epoch: 4, Steps: 208 | Train Loss: 3.417 Vali Loss: 3.547 Vali Acc: 0.061 Test Loss: 3.547 Test Acc: 0.061
Validation loss decreased (-0.060805 --> -0.061104).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.8656728
	speed: 0.2670s/iter; left time: 5304.6380s
	iters: 200, epoch: 5 | loss: 3.1382995
	speed: 0.0732s/iter; left time: 1447.5683s
Epoch: 5 cost time: 15.484931945800781
Epoch: 5, Steps: 208 | Train Loss: 3.349 Vali Loss: 3.466 Vali Acc: 0.076 Test Loss: 3.466 Test Acc: 0.076
Validation loss decreased (-0.061104 --> -0.076315).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.3569725
	speed: 0.2581s/iter; left time: 5073.8725s
	iters: 200, epoch: 6 | loss: 3.4793901
	speed: 0.0763s/iter; left time: 1492.5990s
Epoch: 6 cost time: 15.79069995880127
Epoch: 6, Steps: 208 | Train Loss: 3.212 Vali Loss: 3.323 Vali Acc: 0.093 Test Loss: 3.323 Test Acc: 0.093
Validation loss decreased (-0.076315 --> -0.092720).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.1136632
	speed: 0.2651s/iter; left time: 5156.3862s
	iters: 200, epoch: 7 | loss: 2.9257555
	speed: 0.0720s/iter; left time: 1393.2300s
Epoch: 7 cost time: 15.724371671676636
Epoch: 7, Steps: 208 | Train Loss: 3.023 Vali Loss: 3.287 Vali Acc: 0.098 Test Loss: 3.287 Test Acc: 0.098
Validation loss decreased (-0.092720 --> -0.098088).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.1194210
	speed: 0.2636s/iter; left time: 5073.7096s
	iters: 200, epoch: 8 | loss: 2.7042439
	speed: 0.0658s/iter; left time: 1260.6914s
Epoch: 8 cost time: 14.517384767532349
Epoch: 8, Steps: 208 | Train Loss: 2.880 Vali Loss: 3.341 Vali Acc: 0.105 Test Loss: 3.341 Test Acc: 0.105
Validation loss decreased (-0.098088 --> -0.104649).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.3193181
	speed: 0.2608s/iter; left time: 4964.2998s
	iters: 200, epoch: 9 | loss: 3.2048132
	speed: 0.0747s/iter; left time: 1414.0211s
Epoch: 9 cost time: 16.467346906661987
Epoch: 9, Steps: 208 | Train Loss: 2.743 Vali Loss: 3.335 Vali Acc: 0.105 Test Loss: 3.335 Test Acc: 0.105
Validation loss decreased (-0.104649 --> -0.105246).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.3056374
	speed: 0.2441s/iter; left time: 4595.9065s
	iters: 200, epoch: 10 | loss: 3.1318679
	speed: 0.0658s/iter; left time: 1233.0066s
Epoch: 10 cost time: 13.982532501220703
Epoch: 10, Steps: 208 | Train Loss: 2.571 Vali Loss: 3.322 Vali Acc: 0.109 Test Loss: 3.322 Test Acc: 0.109
Validation loss decreased (-0.105246 --> -0.108526).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.5416160
	speed: 0.2442s/iter; left time: 4546.6363s
	iters: 200, epoch: 11 | loss: 2.2059884
	speed: 0.0695s/iter; left time: 1287.1657s
Epoch: 11 cost time: 14.830555200576782
Epoch: 11, Steps: 208 | Train Loss: 2.394 Vali Loss: 3.381 Vali Acc: 0.117 Test Loss: 3.381 Test Acc: 0.117
Validation loss decreased (-0.108526 --> -0.117175).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.2271590
	speed: 0.2737s/iter; left time: 5038.9363s
	iters: 200, epoch: 12 | loss: 2.4234722
	speed: 0.0723s/iter; left time: 1323.4604s
Epoch: 12 cost time: 16.1759250164032
Epoch: 12, Steps: 208 | Train Loss: 2.224 Vali Loss: 3.450 Vali Acc: 0.121 Test Loss: 3.450 Test Acc: 0.121
Validation loss decreased (-0.117175 --> -0.121349).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.9277663
	speed: 0.2682s/iter; left time: 4882.5631s
	iters: 200, epoch: 13 | loss: 1.8343484
	speed: 0.0753s/iter; left time: 1363.9013s
Epoch: 13 cost time: 15.910077571868896
Epoch: 13, Steps: 208 | Train Loss: 2.041 Vali Loss: 3.605 Vali Acc: 0.116 Test Loss: 3.605 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 2.1242893
	speed: 0.2698s/iter; left time: 4854.9331s
	iters: 200, epoch: 14 | loss: 2.0425746
	speed: 0.0723s/iter; left time: 1293.4301s
Epoch: 14 cost time: 15.740704774856567
Epoch: 14, Steps: 208 | Train Loss: 1.870 Vali Loss: 3.653 Vali Acc: 0.124 Test Loss: 3.653 Test Acc: 0.124
Validation loss decreased (-0.121349 --> -0.124031).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.7413914
	speed: 0.2633s/iter; left time: 4683.8177s
	iters: 200, epoch: 15 | loss: 1.9715674
	speed: 0.0726s/iter; left time: 1283.8817s
Epoch: 15 cost time: 15.790512323379517
Epoch: 15, Steps: 208 | Train Loss: 1.695 Vali Loss: 3.863 Vali Acc: 0.125 Test Loss: 3.863 Test Acc: 0.125
Validation loss decreased (-0.124031 --> -0.124626).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.9133881
	speed: 0.2540s/iter; left time: 4465.9589s
	iters: 200, epoch: 16 | loss: 1.5216166
	speed: 0.0696s/iter; left time: 1217.1238s
Epoch: 16 cost time: 14.801311492919922
Epoch: 16, Steps: 208 | Train Loss: 1.536 Vali Loss: 3.996 Vali Acc: 0.120 Test Loss: 3.996 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.4245273
	speed: 0.2411s/iter; left time: 4188.2183s
	iters: 200, epoch: 17 | loss: 1.5057449
	speed: 0.0678s/iter; left time: 1171.4473s
Epoch: 17 cost time: 15.236286640167236
Epoch: 17, Steps: 208 | Train Loss: 1.387 Vali Loss: 4.076 Vali Acc: 0.110 Test Loss: 4.076 Test Acc: 0.110
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.1806738
	speed: 0.2449s/iter; left time: 4203.4309s
	iters: 200, epoch: 18 | loss: 0.6334314
	speed: 0.0660s/iter; left time: 1126.9739s
Epoch: 18 cost time: 14.144676208496094
Epoch: 18, Steps: 208 | Train Loss: 1.227 Vali Loss: 4.360 Vali Acc: 0.123 Test Loss: 4.360 Test Acc: 0.123
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.0227343
	speed: 0.2517s/iter; left time: 4267.3030s
	iters: 200, epoch: 19 | loss: 1.2357684
	speed: 0.0683s/iter; left time: 1150.7764s
Epoch: 19 cost time: 14.922258615493774
Epoch: 19, Steps: 208 | Train Loss: 1.126 Vali Loss: 4.515 Vali Acc: 0.122 Test Loss: 4.515 Test Acc: 0.122
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 1.0856112
	speed: 0.2589s/iter; left time: 4335.4878s
	iters: 200, epoch: 20 | loss: 1.3301105
	speed: 0.0665s/iter; left time: 1107.8201s
Epoch: 20 cost time: 14.903177499771118
Epoch: 20, Steps: 208 | Train Loss: 1.022 Vali Loss: 4.692 Vali Acc: 0.118 Test Loss: 4.692 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.7733976
	speed: 0.2509s/iter; left time: 4150.0548s
	iters: 200, epoch: 21 | loss: 0.8392631
	speed: 0.0699s/iter; left time: 1149.7242s
Epoch: 21 cost time: 14.988348960876465
Epoch: 21, Steps: 208 | Train Loss: 0.910 Vali Loss: 5.008 Vali Acc: 0.116 Test Loss: 5.008 Test Acc: 0.116
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.6098563
	speed: 0.2444s/iter; left time: 3992.5773s
	iters: 200, epoch: 22 | loss: 1.3237200
	speed: 0.0683s/iter; left time: 1109.4671s
Epoch: 22 cost time: 14.348058462142944
Epoch: 22, Steps: 208 | Train Loss: 0.817 Vali Loss: 5.105 Vali Acc: 0.119 Test Loss: 5.105 Test Acc: 0.119
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.7719944
	speed: 0.2618s/iter; left time: 4221.7653s
	iters: 200, epoch: 23 | loss: 0.4487252
	speed: 0.0741s/iter; left time: 1187.4758s
Epoch: 23 cost time: 16.226362943649292
Epoch: 23, Steps: 208 | Train Loss: 0.770 Vali Loss: 5.180 Vali Acc: 0.108 Test Loss: 5.180 Test Acc: 0.108
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.8420330
	speed: 0.2615s/iter; left time: 4163.0040s
	iters: 200, epoch: 24 | loss: 0.9244891
	speed: 0.0732s/iter; left time: 1157.2159s
Epoch: 24 cost time: 15.906914710998535
Epoch: 24, Steps: 208 | Train Loss: 0.689 Vali Loss: 5.545 Vali Acc: 0.117 Test Loss: 5.545 Test Acc: 0.117
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.7311494
	speed: 0.2544s/iter; left time: 3996.3017s
	iters: 200, epoch: 25 | loss: 0.1972489
	speed: 0.0668s/iter; left time: 1042.8951s
Epoch: 25 cost time: 14.467102289199829
Epoch: 25, Steps: 208 | Train Loss: 0.672 Vali Loss: 5.669 Vali Acc: 0.114 Test Loss: 5.669 Test Acc: 0.114
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12466447957053385
model parameter : 261207
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5343630
	speed: 0.0909s/iter; left time: 1882.5643s
	iters: 200, epoch: 1 | loss: 3.8129954
	speed: 0.0705s/iter; left time: 1452.3432s
Epoch: 1 cost time: 16.85124921798706
Epoch: 1, Steps: 208 | Train Loss: 3.698 Vali Loss: 3.632 Vali Acc: 0.043 Test Loss: 3.632 Test Acc: 0.043
Validation loss decreased (inf --> -0.042612).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6427090
	speed: 0.2648s/iter; left time: 5426.8128s
	iters: 200, epoch: 2 | loss: 3.4921346
	speed: 0.0716s/iter; left time: 1459.9353s
Epoch: 2 cost time: 15.440604209899902
Epoch: 2, Steps: 208 | Train Loss: 3.601 Vali Loss: 3.643 Vali Acc: 0.059 Test Loss: 3.643 Test Acc: 0.059
Validation loss decreased (-0.042612 --> -0.059313).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.1306434
	speed: 0.2786s/iter; left time: 5651.3112s
	iters: 200, epoch: 3 | loss: 3.4428039
	speed: 0.0716s/iter; left time: 1444.2881s
Epoch: 3 cost time: 16.107383728027344
Epoch: 3, Steps: 208 | Train Loss: 3.515 Vali Loss: 3.600 Vali Acc: 0.057 Test Loss: 3.600 Test Acc: 0.057
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.5520856
	speed: 0.2683s/iter; left time: 5385.7352s
	iters: 200, epoch: 4 | loss: 3.3723786
	speed: 0.0701s/iter; left time: 1399.6401s
Epoch: 4 cost time: 15.513274192810059
Epoch: 4, Steps: 208 | Train Loss: 3.434 Vali Loss: 3.529 Vali Acc: 0.068 Test Loss: 3.529 Test Acc: 0.068
Validation loss decreased (-0.059313 --> -0.067964).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.7330716
	speed: 0.2496s/iter; left time: 4959.1211s
	iters: 200, epoch: 5 | loss: 2.9721334
	speed: 0.0688s/iter; left time: 1359.3483s
Epoch: 5 cost time: 14.736197471618652
Epoch: 5, Steps: 208 | Train Loss: 3.347 Vali Loss: 3.523 Vali Acc: 0.069 Test Loss: 3.523 Test Acc: 0.069
Validation loss decreased (-0.067964 --> -0.068858).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2098992
	speed: 0.2504s/iter; left time: 4922.2068s
	iters: 200, epoch: 6 | loss: 3.2499900
	speed: 0.0669s/iter; left time: 1307.9868s
Epoch: 6 cost time: 14.573208808898926
Epoch: 6, Steps: 208 | Train Loss: 3.261 Vali Loss: 3.590 Vali Acc: 0.071 Test Loss: 3.590 Test Acc: 0.071
Validation loss decreased (-0.068858 --> -0.070945).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.3465126
	speed: 0.2485s/iter; left time: 4834.6115s
	iters: 200, epoch: 7 | loss: 3.1561072
	speed: 0.0664s/iter; left time: 1285.3583s
Epoch: 7 cost time: 14.71646785736084
Epoch: 7, Steps: 208 | Train Loss: 3.114 Vali Loss: 3.501 Vali Acc: 0.081 Test Loss: 3.501 Test Acc: 0.081
Validation loss decreased (-0.070945 --> -0.080788).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.5007594
	speed: 0.2557s/iter; left time: 4921.7938s
	iters: 200, epoch: 8 | loss: 2.8410916
	speed: 0.0688s/iter; left time: 1317.4357s
Epoch: 8 cost time: 14.81398057937622
Epoch: 8, Steps: 208 | Train Loss: 2.935 Vali Loss: 3.423 Vali Acc: 0.092 Test Loss: 3.423 Test Acc: 0.092
Validation loss decreased (-0.080788 --> -0.092420).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.2703428
	speed: 0.2566s/iter; left time: 4885.4587s
	iters: 200, epoch: 9 | loss: 3.0138607
	speed: 0.0710s/iter; left time: 1344.6669s
Epoch: 9 cost time: 14.817262887954712
Epoch: 9, Steps: 208 | Train Loss: 2.787 Vali Loss: 3.358 Vali Acc: 0.101 Test Loss: 3.358 Test Acc: 0.101
Validation loss decreased (-0.092420 --> -0.101070).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.5357785
	speed: 0.2577s/iter; left time: 4851.4568s
	iters: 200, epoch: 10 | loss: 2.6806619
	speed: 0.0664s/iter; left time: 1244.2105s
Epoch: 10 cost time: 14.802985191345215
Epoch: 10, Steps: 208 | Train Loss: 2.624 Vali Loss: 3.470 Vali Acc: 0.104 Test Loss: 3.470 Test Acc: 0.104
Validation loss decreased (-0.101070 --> -0.104051).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.8549201
	speed: 0.2529s/iter; left time: 4709.0981s
	iters: 200, epoch: 11 | loss: 2.5452442
	speed: 0.0705s/iter; left time: 1306.5537s
Epoch: 11 cost time: 15.490128993988037
Epoch: 11, Steps: 208 | Train Loss: 2.445 Vali Loss: 3.540 Vali Acc: 0.105 Test Loss: 3.540 Test Acc: 0.105
Validation loss decreased (-0.104051 --> -0.104945).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.4196260
	speed: 0.2506s/iter; left time: 4613.7267s
	iters: 200, epoch: 12 | loss: 2.3539772
	speed: 0.0695s/iter; left time: 1272.3289s
Epoch: 12 cost time: 14.803375005722046
Epoch: 12, Steps: 208 | Train Loss: 2.259 Vali Loss: 3.665 Vali Acc: 0.107 Test Loss: 3.665 Test Acc: 0.107
Validation loss decreased (-0.104945 --> -0.107330).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.3660276
	speed: 0.2565s/iter; left time: 4669.2850s
	iters: 200, epoch: 13 | loss: 2.7654736
	speed: 0.0699s/iter; left time: 1266.0513s
Epoch: 13 cost time: 14.83855128288269
Epoch: 13, Steps: 208 | Train Loss: 2.089 Vali Loss: 3.696 Vali Acc: 0.115 Test Loss: 3.696 Test Acc: 0.115
Validation loss decreased (-0.107330 --> -0.114786).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.8682349
	speed: 0.2181s/iter; left time: 3924.7432s
	iters: 200, epoch: 14 | loss: 1.8667718
	speed: 0.0679s/iter; left time: 1214.5692s
Epoch: 14 cost time: 14.417312145233154
Epoch: 14, Steps: 208 | Train Loss: 1.888 Vali Loss: 3.925 Vali Acc: 0.117 Test Loss: 3.925 Test Acc: 0.117
Validation loss decreased (-0.114786 --> -0.116573).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.1460239
	speed: 0.2536s/iter; left time: 4511.0054s
	iters: 200, epoch: 15 | loss: 1.7433385
	speed: 0.0685s/iter; left time: 1211.0089s
Epoch: 15 cost time: 14.68328857421875
Epoch: 15, Steps: 208 | Train Loss: 1.726 Vali Loss: 3.928 Vali Acc: 0.118 Test Loss: 3.928 Test Acc: 0.118
Validation loss decreased (-0.116573 --> -0.117467).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.1889310
	speed: 0.2585s/iter; left time: 4544.5717s
	iters: 200, epoch: 16 | loss: 2.0901809
	speed: 0.0704s/iter; left time: 1231.3719s
Epoch: 16 cost time: 14.934506893157959
Epoch: 16, Steps: 208 | Train Loss: 1.542 Vali Loss: 4.204 Vali Acc: 0.117 Test Loss: 4.204 Test Acc: 0.117
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.4763697
	speed: 0.2619s/iter; left time: 4549.3424s
	iters: 200, epoch: 17 | loss: 1.1381656
	speed: 0.0686s/iter; left time: 1185.1423s
Epoch: 17 cost time: 15.236685276031494
Epoch: 17, Steps: 208 | Train Loss: 1.383 Vali Loss: 4.391 Vali Acc: 0.103 Test Loss: 4.391 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.2083133
	speed: 0.2539s/iter; left time: 4358.3705s
	iters: 200, epoch: 18 | loss: 1.4322301
	speed: 0.0747s/iter; left time: 1274.2479s
Epoch: 18 cost time: 15.682780265808105
Epoch: 18, Steps: 208 | Train Loss: 1.243 Vali Loss: 4.585 Vali Acc: 0.106 Test Loss: 4.585 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.4217540
	speed: 0.2521s/iter; left time: 4274.5676s
	iters: 200, epoch: 19 | loss: 0.9945827
	speed: 0.0658s/iter; left time: 1109.5781s
Epoch: 19 cost time: 14.641525983810425
Epoch: 19, Steps: 208 | Train Loss: 1.098 Vali Loss: 4.839 Vali Acc: 0.113 Test Loss: 4.839 Test Acc: 0.113
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.8489200
	speed: 0.2544s/iter; left time: 4261.1728s
	iters: 200, epoch: 20 | loss: 1.0983987
	speed: 0.0724s/iter; left time: 1205.4444s
Epoch: 20 cost time: 15.098660707473755
Epoch: 20, Steps: 208 | Train Loss: 1.004 Vali Loss: 4.820 Vali Acc: 0.113 Test Loss: 4.820 Test Acc: 0.113
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.7864823
	speed: 0.2467s/iter; left time: 4080.2976s
	iters: 200, epoch: 21 | loss: 0.6367241
	speed: 0.0677s/iter; left time: 1112.8842s
Epoch: 21 cost time: 14.278852462768555
Epoch: 21, Steps: 208 | Train Loss: 0.928 Vali Loss: 5.177 Vali Acc: 0.112 Test Loss: 5.177 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.4398416
	speed: 0.2546s/iter; left time: 4158.5753s
	iters: 200, epoch: 22 | loss: 0.3113104
	speed: 0.0636s/iter; left time: 1032.2017s
Epoch: 22 cost time: 13.97400426864624
Epoch: 22, Steps: 208 | Train Loss: 0.846 Vali Loss: 5.448 Vali Acc: 0.104 Test Loss: 5.448 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 1.2533946
	speed: 0.2336s/iter; left time: 3766.6642s
	iters: 200, epoch: 23 | loss: 0.6699173
	speed: 0.0670s/iter; left time: 1073.6271s
Epoch: 23 cost time: 14.28486442565918
Epoch: 23, Steps: 208 | Train Loss: 0.769 Vali Loss: 5.501 Vali Acc: 0.108 Test Loss: 5.501 Test Acc: 0.108
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 1.1313612
	speed: 0.2499s/iter; left time: 3976.8802s
	iters: 200, epoch: 24 | loss: 0.7451417
	speed: 0.0677s/iter; left time: 1071.5027s
Epoch: 24 cost time: 14.695684432983398
Epoch: 24, Steps: 208 | Train Loss: 0.753 Vali Loss: 5.493 Vali Acc: 0.111 Test Loss: 5.493 Test Acc: 0.111
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.6336641
	speed: 0.2590s/iter; left time: 4068.5053s
	iters: 200, epoch: 25 | loss: 0.5960120
	speed: 0.0689s/iter; left time: 1075.8108s
Epoch: 25 cost time: 14.973960638046265
Epoch: 25, Steps: 208 | Train Loss: 0.694 Vali Loss: 5.840 Vali Acc: 0.109 Test Loss: 5.840 Test Acc: 0.109
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11750671040858933
model parameter : 260119
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6265657
	speed: 0.0875s/iter; left time: 1810.4218s
	iters: 200, epoch: 1 | loss: 3.6759558
	speed: 0.0673s/iter; left time: 1387.0844s
Epoch: 1 cost time: 16.19828152656555
Epoch: 1, Steps: 208 | Train Loss: 3.682 Vali Loss: 3.581 Vali Acc: 0.055 Test Loss: 3.581 Test Acc: 0.055
Validation loss decreased (inf --> -0.054840).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.0122004
	speed: 0.2378s/iter; left time: 4873.5702s
	iters: 200, epoch: 2 | loss: 3.8312910
	speed: 0.0692s/iter; left time: 1411.8912s
Epoch: 2 cost time: 14.705692052841187
Epoch: 2, Steps: 208 | Train Loss: 3.588 Vali Loss: 3.588 Vali Acc: 0.063 Test Loss: 3.588 Test Acc: 0.063
Validation loss decreased (-0.054840 --> -0.063191).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5642123
	speed: 0.2590s/iter; left time: 5252.9735s
	iters: 200, epoch: 3 | loss: 3.4279075
	speed: 0.0695s/iter; left time: 1402.4058s
Epoch: 3 cost time: 14.93644380569458
Epoch: 3, Steps: 208 | Train Loss: 3.511 Vali Loss: 3.545 Vali Acc: 0.072 Test Loss: 3.545 Test Acc: 0.072
Validation loss decreased (-0.063191 --> -0.072437).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.1623323
	speed: 0.2495s/iter; left time: 5008.4254s
	iters: 200, epoch: 4 | loss: 3.1826599
	speed: 0.0674s/iter; left time: 1347.2999s
Epoch: 4 cost time: 14.409709453582764
Epoch: 4, Steps: 208 | Train Loss: 3.436 Vali Loss: 3.548 Vali Acc: 0.067 Test Loss: 3.548 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.1529181
	speed: 0.2509s/iter; left time: 4985.4110s
	iters: 200, epoch: 5 | loss: 3.3534229
	speed: 0.0708s/iter; left time: 1399.2011s
Epoch: 5 cost time: 14.834180355072021
Epoch: 5, Steps: 208 | Train Loss: 3.324 Vali Loss: 3.513 Vali Acc: 0.072 Test Loss: 3.513 Test Acc: 0.072
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 3.5498569
	speed: 0.2693s/iter; left time: 5294.0047s
	iters: 200, epoch: 6 | loss: 3.0905566
	speed: 0.0765s/iter; left time: 1496.1396s
Epoch: 6 cost time: 16.256627798080444
Epoch: 6, Steps: 208 | Train Loss: 3.150 Vali Loss: 3.323 Vali Acc: 0.083 Test Loss: 3.323 Test Acc: 0.083
Validation loss decreased (-0.072437 --> -0.082579).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9867191
	speed: 0.2768s/iter; left time: 5384.7482s
	iters: 200, epoch: 7 | loss: 2.7548957
	speed: 0.0713s/iter; left time: 1379.4053s
Epoch: 7 cost time: 15.924675941467285
Epoch: 7, Steps: 208 | Train Loss: 2.978 Vali Loss: 3.332 Vali Acc: 0.091 Test Loss: 3.332 Test Acc: 0.091
Validation loss decreased (-0.082579 --> -0.090632).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.9713321
	speed: 0.2561s/iter; left time: 4929.5392s
	iters: 200, epoch: 8 | loss: 2.5799026
	speed: 0.0700s/iter; left time: 1339.8807s
Epoch: 8 cost time: 15.017417907714844
Epoch: 8, Steps: 208 | Train Loss: 2.877 Vali Loss: 3.304 Vali Acc: 0.105 Test Loss: 3.304 Test Acc: 0.105
Validation loss decreased (-0.090632 --> -0.105246).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.3361273
	speed: 0.2606s/iter; left time: 4960.6723s
	iters: 200, epoch: 9 | loss: 3.0275500
	speed: 0.0759s/iter; left time: 1437.1470s
Epoch: 9 cost time: 15.708715677261353
Epoch: 9, Steps: 208 | Train Loss: 2.735 Vali Loss: 3.378 Vali Acc: 0.098 Test Loss: 3.378 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.9095974
	speed: 0.2804s/iter; left time: 5278.7561s
	iters: 200, epoch: 10 | loss: 2.8735185
	speed: 0.0713s/iter; left time: 1335.4767s
Epoch: 10 cost time: 15.436422109603882
Epoch: 10, Steps: 208 | Train Loss: 2.577 Vali Loss: 3.398 Vali Acc: 0.099 Test Loss: 3.398 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.2775149
	speed: 0.2621s/iter; left time: 4881.1959s
	iters: 200, epoch: 11 | loss: 2.2952111
	speed: 0.0755s/iter; left time: 1399.2205s
Epoch: 11 cost time: 16.405102014541626
Epoch: 11, Steps: 208 | Train Loss: 2.405 Vali Loss: 3.478 Vali Acc: 0.101 Test Loss: 3.478 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 2.1299436
	speed: 0.2549s/iter; left time: 4692.6235s
	iters: 200, epoch: 12 | loss: 2.3551474
	speed: 0.0712s/iter; left time: 1303.8610s
Epoch: 12 cost time: 14.954264163970947
Epoch: 12, Steps: 208 | Train Loss: 2.257 Vali Loss: 3.516 Vali Acc: 0.101 Test Loss: 3.516 Test Acc: 0.101
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.6659172
	speed: 0.2490s/iter; left time: 4532.5976s
	iters: 200, epoch: 13 | loss: 1.6153672
	speed: 0.0662s/iter; left time: 1198.2453s
Epoch: 13 cost time: 14.8064603805542
Epoch: 13, Steps: 208 | Train Loss: 2.066 Vali Loss: 3.624 Vali Acc: 0.107 Test Loss: 3.624 Test Acc: 0.107
Validation loss decreased (-0.105246 --> -0.107032).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.5116620
	speed: 0.2745s/iter; left time: 4940.6667s
	iters: 200, epoch: 14 | loss: 2.2430227
	speed: 0.0739s/iter; left time: 1322.3378s
Epoch: 14 cost time: 16.04837727546692
Epoch: 14, Steps: 208 | Train Loss: 1.913 Vali Loss: 3.720 Vali Acc: 0.113 Test Loss: 3.720 Test Acc: 0.113
Validation loss decreased (-0.107032 --> -0.113294).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.2241424
	speed: 0.2419s/iter; left time: 4303.1259s
	iters: 200, epoch: 15 | loss: 2.0394909
	speed: 0.0693s/iter; left time: 1226.1576s
Epoch: 15 cost time: 14.928780794143677
Epoch: 15, Steps: 208 | Train Loss: 1.725 Vali Loss: 3.838 Vali Acc: 0.109 Test Loss: 3.838 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.7098534
	speed: 0.2410s/iter; left time: 4236.7751s
	iters: 200, epoch: 16 | loss: 2.2037470
	speed: 0.0687s/iter; left time: 1200.4279s
Epoch: 16 cost time: 14.912549257278442
Epoch: 16, Steps: 208 | Train Loss: 1.579 Vali Loss: 3.913 Vali Acc: 0.115 Test Loss: 3.913 Test Acc: 0.115
Validation loss decreased (-0.113294 --> -0.114485).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.2879634
	speed: 0.2450s/iter; left time: 4256.9042s
	iters: 200, epoch: 17 | loss: 1.5378141
	speed: 0.0699s/iter; left time: 1206.8704s
Epoch: 17 cost time: 14.908714532852173
Epoch: 17, Steps: 208 | Train Loss: 1.420 Vali Loss: 4.071 Vali Acc: 0.110 Test Loss: 4.071 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.5718000
	speed: 0.2555s/iter; left time: 4385.2892s
	iters: 200, epoch: 18 | loss: 2.2301219
	speed: 0.0673s/iter; left time: 1148.4726s
Epoch: 18 cost time: 14.640949010848999
Epoch: 18, Steps: 208 | Train Loss: 1.271 Vali Loss: 4.278 Vali Acc: 0.116 Test Loss: 4.278 Test Acc: 0.116
Validation loss decreased (-0.114485 --> -0.115973).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.6594176
	speed: 0.2580s/iter; left time: 4375.5600s
	iters: 200, epoch: 19 | loss: 0.9503528
	speed: 0.0717s/iter; left time: 1208.7666s
Epoch: 19 cost time: 15.682027101516724
Epoch: 19, Steps: 208 | Train Loss: 1.164 Vali Loss: 4.449 Vali Acc: 0.107 Test Loss: 4.449 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.5013320
	speed: 0.2476s/iter; left time: 4147.3478s
	iters: 200, epoch: 20 | loss: 0.8781969
	speed: 0.0662s/iter; left time: 1102.7385s
Epoch: 20 cost time: 14.294605016708374
Epoch: 20, Steps: 208 | Train Loss: 1.029 Vali Loss: 4.744 Vali Acc: 0.105 Test Loss: 4.744 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.0995591
	speed: 0.2603s/iter; left time: 4306.4009s
	iters: 200, epoch: 21 | loss: 0.9583927
	speed: 0.0713s/iter; left time: 1172.0914s
Epoch: 21 cost time: 15.357120275497437
Epoch: 21, Steps: 208 | Train Loss: 0.941 Vali Loss: 4.785 Vali Acc: 0.118 Test Loss: 4.785 Test Acc: 0.118
Validation loss decreased (-0.115973 --> -0.118055).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.9372770
	speed: 0.2640s/iter; left time: 4311.9191s
	iters: 200, epoch: 22 | loss: 0.7664253
	speed: 0.0755s/iter; left time: 1224.8878s
Epoch: 22 cost time: 15.90744137763977
Epoch: 22, Steps: 208 | Train Loss: 0.855 Vali Loss: 4.937 Vali Acc: 0.120 Test Loss: 4.937 Test Acc: 0.120
Validation loss decreased (-0.118055 --> -0.120440).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.9592522
	speed: 0.2662s/iter; left time: 4292.3653s
	iters: 200, epoch: 23 | loss: 1.0019943
	speed: 0.0773s/iter; left time: 1239.4868s
Epoch: 23 cost time: 16.31296730041504
Epoch: 23, Steps: 208 | Train Loss: 0.794 Vali Loss: 5.182 Vali Acc: 0.115 Test Loss: 5.182 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.6852493
	speed: 0.2713s/iter; left time: 4317.5212s
	iters: 200, epoch: 24 | loss: 0.4608223
	speed: 0.0680s/iter; left time: 1075.6744s
Epoch: 24 cost time: 14.817180871963501
Epoch: 24, Steps: 208 | Train Loss: 0.736 Vali Loss: 5.254 Vali Acc: 0.103 Test Loss: 5.254 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.2184760
	speed: 0.2570s/iter; left time: 4036.8276s
	iters: 200, epoch: 25 | loss: 0.4383298
	speed: 0.0708s/iter; left time: 1105.6423s
Epoch: 25 cost time: 15.199983835220337
Epoch: 25, Steps: 208 | Train Loss: 0.665 Vali Loss: 5.552 Vali Acc: 0.108 Test Loss: 5.552 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.6405660
	speed: 0.2704s/iter; left time: 4191.1535s
	iters: 200, epoch: 26 | loss: 0.6937886
	speed: 0.0744s/iter; left time: 1146.3991s
Epoch: 26 cost time: 16.113863945007324
Epoch: 26, Steps: 208 | Train Loss: 0.630 Vali Loss: 5.812 Vali Acc: 0.118 Test Loss: 5.812 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.4350354
	speed: 0.2698s/iter; left time: 4125.8167s
	iters: 200, epoch: 27 | loss: 0.5983893
	speed: 0.0726s/iter; left time: 1102.5646s
Epoch: 27 cost time: 15.302350044250488
Epoch: 27, Steps: 208 | Train Loss: 0.598 Vali Loss: 5.846 Vali Acc: 0.116 Test Loss: 5.846 Test Acc: 0.116
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.4970984
	speed: 0.2519s/iter; left time: 3799.6387s
	iters: 200, epoch: 28 | loss: 1.0099546
	speed: 0.0655s/iter; left time: 981.1863s
Epoch: 28 cost time: 14.415508508682251
Epoch: 28, Steps: 208 | Train Loss: 0.584 Vali Loss: 5.904 Vali Acc: 0.118 Test Loss: 5.904 Test Acc: 0.118
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 1.0064291
	speed: 0.2400s/iter; left time: 3569.8527s
	iters: 200, epoch: 29 | loss: 0.3233829
	speed: 0.0652s/iter; left time: 963.2224s
Epoch: 29 cost time: 13.967471361160278
Epoch: 29, Steps: 208 | Train Loss: 0.560 Vali Loss: 6.134 Vali Acc: 0.113 Test Loss: 6.134 Test Acc: 0.113
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.4347855
	speed: 0.2474s/iter; left time: 3629.4018s
	iters: 200, epoch: 30 | loss: 0.7915403
	speed: 0.0741s/iter; left time: 1079.6074s
Epoch: 30 cost time: 16.100805282592773
Epoch: 30, Steps: 208 | Train Loss: 0.544 Vali Loss: 6.268 Vali Acc: 0.108 Test Loss: 6.268 Test Acc: 0.108
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.4071938
	speed: 0.2509s/iter; left time: 3627.7540s
	iters: 200, epoch: 31 | loss: 0.6067446
	speed: 0.0698s/iter; left time: 1002.6103s
Epoch: 31 cost time: 15.23544955253601
Epoch: 31, Steps: 208 | Train Loss: 0.502 Vali Loss: 6.319 Vali Acc: 0.118 Test Loss: 6.319 Test Acc: 0.118
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.1169777
	speed: 0.2491s/iter; left time: 3550.0040s
	iters: 200, epoch: 32 | loss: 0.6602643
	speed: 0.0732s/iter; left time: 1036.3011s
Epoch: 32 cost time: 15.895662069320679
Epoch: 32, Steps: 208 | Train Loss: 0.503 Vali Loss: 6.526 Vali Acc: 0.107 Test Loss: 6.526 Test Acc: 0.107
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12048911422606622
model parameter : 259031
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.3646290
	speed: 0.0869s/iter; left time: 1799.6136s
	iters: 200, epoch: 1 | loss: 3.4159250
	speed: 0.0684s/iter; left time: 1409.0501s
Epoch: 1 cost time: 16.170925617218018
Epoch: 1, Steps: 208 | Train Loss: 3.698 Vali Loss: 3.703 Vali Acc: 0.060 Test Loss: 3.703 Test Acc: 0.060
Validation loss decreased (inf --> -0.059909).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6776576
	speed: 0.2427s/iter; left time: 4974.6037s
	iters: 200, epoch: 2 | loss: 3.4031718
	speed: 0.0621s/iter; left time: 1267.2300s
Epoch: 2 cost time: 13.60651969909668
Epoch: 2, Steps: 208 | Train Loss: 3.600 Vali Loss: 3.580 Vali Acc: 0.061 Test Loss: 3.580 Test Acc: 0.061
Validation loss decreased (-0.059909 --> -0.060805).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.2850680
	speed: 0.2357s/iter; left time: 4781.7004s
	iters: 200, epoch: 3 | loss: 3.7736409
	speed: 0.0637s/iter; left time: 1286.4000s
Epoch: 3 cost time: 13.867799997329712
Epoch: 3, Steps: 208 | Train Loss: 3.507 Vali Loss: 3.537 Vali Acc: 0.070 Test Loss: 3.537 Test Acc: 0.070
Validation loss decreased (-0.060805 --> -0.070051).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3564837
	speed: 0.2517s/iter; left time: 5053.4376s
	iters: 200, epoch: 4 | loss: 3.4877954
	speed: 0.0677s/iter; left time: 1352.9190s
Epoch: 4 cost time: 14.983775615692139
Epoch: 4, Steps: 208 | Train Loss: 3.414 Vali Loss: 3.585 Vali Acc: 0.070 Test Loss: 3.585 Test Acc: 0.070
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.5330629
	speed: 0.2634s/iter; left time: 5234.4187s
	iters: 200, epoch: 5 | loss: 3.1768351
	speed: 0.0691s/iter; left time: 1366.0955s
Epoch: 5 cost time: 14.577168464660645
Epoch: 5, Steps: 208 | Train Loss: 3.315 Vali Loss: 3.490 Vali Acc: 0.080 Test Loss: 3.490 Test Acc: 0.080
Validation loss decreased (-0.070051 --> -0.079894).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0186327
	speed: 0.2505s/iter; left time: 4924.9059s
	iters: 200, epoch: 6 | loss: 3.4667070
	speed: 0.0691s/iter; left time: 1351.7872s
Epoch: 6 cost time: 14.875526905059814
Epoch: 6, Steps: 208 | Train Loss: 3.208 Vali Loss: 3.434 Vali Acc: 0.078 Test Loss: 3.434 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.4635618
	speed: 0.2657s/iter; left time: 5168.8549s
	iters: 200, epoch: 7 | loss: 2.7157834
	speed: 0.0662s/iter; left time: 1281.2980s
Epoch: 7 cost time: 14.300599098205566
Epoch: 7, Steps: 208 | Train Loss: 3.031 Vali Loss: 3.461 Vali Acc: 0.086 Test Loss: 3.461 Test Acc: 0.086
Validation loss decreased (-0.079894 --> -0.085560).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.8227551
	speed: 0.2532s/iter; left time: 4873.0659s
	iters: 200, epoch: 8 | loss: 2.8559566
	speed: 0.0670s/iter; left time: 1281.8514s
Epoch: 8 cost time: 14.9485445022583
Epoch: 8, Steps: 208 | Train Loss: 2.865 Vali Loss: 3.378 Vali Acc: 0.098 Test Loss: 3.378 Test Acc: 0.098
Validation loss decreased (-0.085560 --> -0.098087).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.9150107
	speed: 0.2558s/iter; left time: 4870.3730s
	iters: 200, epoch: 9 | loss: 2.8363137
	speed: 0.0639s/iter; left time: 1210.0038s
Epoch: 9 cost time: 14.438277006149292
Epoch: 9, Steps: 208 | Train Loss: 2.746 Vali Loss: 3.330 Vali Acc: 0.108 Test Loss: 3.330 Test Acc: 0.108
Validation loss decreased (-0.098087 --> -0.107930).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.5680599
	speed: 0.2576s/iter; left time: 4850.3900s
	iters: 200, epoch: 10 | loss: 2.7582026
	speed: 0.0708s/iter; left time: 1326.3784s
Epoch: 10 cost time: 15.055809259414673
Epoch: 10, Steps: 208 | Train Loss: 2.573 Vali Loss: 3.328 Vali Acc: 0.113 Test Loss: 3.328 Test Acc: 0.113
Validation loss decreased (-0.107930 --> -0.113298).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.4193070
	speed: 0.2466s/iter; left time: 4592.3556s
	iters: 200, epoch: 11 | loss: 2.3872886
	speed: 0.0647s/iter; left time: 1198.5767s
Epoch: 11 cost time: 14.225490093231201
Epoch: 11, Steps: 208 | Train Loss: 2.401 Vali Loss: 3.512 Vali Acc: 0.099 Test Loss: 3.512 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.0797627
	speed: 0.2563s/iter; left time: 4719.3180s
	iters: 200, epoch: 12 | loss: 2.1255560
	speed: 0.0637s/iter; left time: 1166.9006s
Epoch: 12 cost time: 14.592485189437866
Epoch: 12, Steps: 208 | Train Loss: 2.222 Vali Loss: 3.551 Vali Acc: 0.114 Test Loss: 3.551 Test Acc: 0.114
Validation loss decreased (-0.113298 --> -0.113892).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.0577753
	speed: 0.2254s/iter; left time: 4103.6221s
	iters: 200, epoch: 13 | loss: 1.9280919
	speed: 0.0627s/iter; left time: 1136.0074s
Epoch: 13 cost time: 13.79782509803772
Epoch: 13, Steps: 208 | Train Loss: 2.061 Vali Loss: 3.575 Vali Acc: 0.118 Test Loss: 3.575 Test Acc: 0.118
Validation loss decreased (-0.113892 --> -0.117769).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.9625735
	speed: 0.2316s/iter; left time: 4168.1517s
	iters: 200, epoch: 14 | loss: 1.8888726
	speed: 0.0666s/iter; left time: 1191.1284s
Epoch: 14 cost time: 14.435089826583862
Epoch: 14, Steps: 208 | Train Loss: 1.899 Vali Loss: 3.722 Vali Acc: 0.106 Test Loss: 3.722 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.1107466
	speed: 0.2261s/iter; left time: 4021.4740s
	iters: 200, epoch: 15 | loss: 1.8598254
	speed: 0.0609s/iter; left time: 1076.6215s
Epoch: 15 cost time: 13.392378568649292
Epoch: 15, Steps: 208 | Train Loss: 1.736 Vali Loss: 3.846 Vali Acc: 0.123 Test Loss: 3.846 Test Acc: 0.123
Validation loss decreased (-0.117769 --> -0.123433).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.4300592
	speed: 0.2369s/iter; left time: 4165.4416s
	iters: 200, epoch: 16 | loss: 1.6796557
	speed: 0.0676s/iter; left time: 1182.4723s
Epoch: 16 cost time: 14.301039218902588
Epoch: 16, Steps: 208 | Train Loss: 1.557 Vali Loss: 3.915 Vali Acc: 0.119 Test Loss: 3.915 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.9985852
	speed: 0.2579s/iter; left time: 4480.2824s
	iters: 200, epoch: 17 | loss: 0.8462138
	speed: 0.0720s/iter; left time: 1243.6126s
Epoch: 17 cost time: 15.664268732070923
Epoch: 17, Steps: 208 | Train Loss: 1.406 Vali Loss: 4.199 Vali Acc: 0.113 Test Loss: 4.199 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.0215650
	speed: 0.2690s/iter; left time: 4616.8244s
	iters: 200, epoch: 18 | loss: 0.9099457
	speed: 0.0739s/iter; left time: 1261.6315s
Epoch: 18 cost time: 16.136063814163208
Epoch: 18, Steps: 208 | Train Loss: 1.232 Vali Loss: 4.314 Vali Acc: 0.118 Test Loss: 4.314 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.9515167
	speed: 0.2485s/iter; left time: 4214.6435s
	iters: 200, epoch: 19 | loss: 0.7831945
	speed: 0.0678s/iter; left time: 1143.4870s
Epoch: 19 cost time: 14.648694038391113
Epoch: 19, Steps: 208 | Train Loss: 1.125 Vali Loss: 4.480 Vali Acc: 0.116 Test Loss: 4.480 Test Acc: 0.116
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.6398429
	speed: 0.2609s/iter; left time: 4370.1397s
	iters: 200, epoch: 20 | loss: 1.1014242
	speed: 0.0699s/iter; left time: 1163.4918s
Epoch: 20 cost time: 14.817445516586304
Epoch: 20, Steps: 208 | Train Loss: 1.030 Vali Loss: 4.691 Vali Acc: 0.111 Test Loss: 4.691 Test Acc: 0.111
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.5329348
	speed: 0.2545s/iter; left time: 4209.6958s
	iters: 200, epoch: 21 | loss: 1.2158940
	speed: 0.0713s/iter; left time: 1171.8826s
Epoch: 21 cost time: 14.957891702651978
Epoch: 21, Steps: 208 | Train Loss: 0.926 Vali Loss: 4.796 Vali Acc: 0.116 Test Loss: 4.796 Test Acc: 0.116
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.8626532
	speed: 0.2396s/iter; left time: 3913.9462s
	iters: 200, epoch: 22 | loss: 1.0472705
	speed: 0.0605s/iter; left time: 981.6561s
Epoch: 22 cost time: 13.695383071899414
Epoch: 22, Steps: 208 | Train Loss: 0.825 Vali Loss: 4.986 Vali Acc: 0.118 Test Loss: 4.986 Test Acc: 0.118
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.3781793
	speed: 0.2541s/iter; left time: 4096.8460s
	iters: 200, epoch: 23 | loss: 0.6146274
	speed: 0.0628s/iter; left time: 1006.9923s
Epoch: 23 cost time: 14.03463625907898
Epoch: 23, Steps: 208 | Train Loss: 0.758 Vali Loss: 5.250 Vali Acc: 0.118 Test Loss: 5.250 Test Acc: 0.118
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 1.4268034
	speed: 0.2505s/iter; left time: 3987.0988s
	iters: 200, epoch: 24 | loss: 1.0140433
	speed: 0.0643s/iter; left time: 1016.7096s
Epoch: 24 cost time: 14.196934223175049
Epoch: 24, Steps: 208 | Train Loss: 0.702 Vali Loss: 5.531 Vali Acc: 0.121 Test Loss: 5.531 Test Acc: 0.121
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.3554600
	speed: 0.2496s/iter; left time: 3920.8473s
	iters: 200, epoch: 25 | loss: 1.1171565
	speed: 0.0690s/iter; left time: 1076.7498s
Epoch: 25 cost time: 14.905608892440796
Epoch: 25, Steps: 208 | Train Loss: 0.664 Vali Loss: 5.517 Vali Acc: 0.117 Test Loss: 5.517 Test Acc: 0.117
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1234715180435431
model parameter : 257943
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.2379904
	speed: 0.1751s/iter; left time: 3624.4611s
	iters: 200, epoch: 1 | loss: 3.6991072
	speed: 0.1458s/iter; left time: 3004.4170s
Epoch: 1 cost time: 33.3830087184906
Epoch: 1, Steps: 208 | Train Loss: 4.847 Vali Loss: 4.287 Vali Acc: 0.058 Test Loss: 4.287 Test Acc: 0.058
Validation loss decreased (inf --> -0.057518).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.1039524
	speed: 0.3431s/iter; left time: 7030.4682s
	iters: 200, epoch: 2 | loss: 3.7218933
	speed: 0.1535s/iter; left time: 3130.8181s
Epoch: 2 cost time: 31.829960107803345
Epoch: 2, Steps: 208 | Train Loss: 3.976 Vali Loss: 3.931 Vali Acc: 0.041 Test Loss: 3.931 Test Acc: 0.041
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.6221364
	speed: 0.3316s/iter; left time: 6726.1691s
	iters: 200, epoch: 3 | loss: 4.2220583
	speed: 0.1675s/iter; left time: 3381.7615s
Epoch: 3 cost time: 32.2240469455719
Epoch: 3, Steps: 208 | Train Loss: 3.783 Vali Loss: 3.611 Vali Acc: 0.067 Test Loss: 3.611 Test Acc: 0.067
Validation loss decreased (-0.057518 --> -0.066770).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.1999969
	speed: 0.2825s/iter; left time: 5671.5722s
	iters: 200, epoch: 4 | loss: 3.9629054
	speed: 0.0747s/iter; left time: 1491.8127s
Epoch: 4 cost time: 17.93234157562256
Epoch: 4, Steps: 208 | Train Loss: 3.526 Vali Loss: 3.567 Vali Acc: 0.082 Test Loss: 3.567 Test Acc: 0.082
Validation loss decreased (-0.066770 --> -0.081980).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3623879
	speed: 0.3035s/iter; left time: 6030.8703s
	iters: 200, epoch: 5 | loss: 3.2217467
	speed: 0.1647s/iter; left time: 3256.1809s
Epoch: 5 cost time: 30.681398391723633
Epoch: 5, Steps: 208 | Train Loss: 3.360 Vali Loss: 3.417 Vali Acc: 0.076 Test Loss: 3.417 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.4228718
	speed: 0.3698s/iter; left time: 7270.3055s
	iters: 200, epoch: 6 | loss: 3.7765141
	speed: 0.1617s/iter; left time: 3163.8730s
Epoch: 6 cost time: 32.94490027427673
Epoch: 6, Steps: 208 | Train Loss: 3.390 Vali Loss: 3.582 Vali Acc: 0.046 Test Loss: 3.582 Test Acc: 0.046
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 4.0510712
	speed: 0.3659s/iter; left time: 7117.3767s
	iters: 200, epoch: 7 | loss: 4.0173216
	speed: 0.1291s/iter; left time: 2497.6614s
Epoch: 7 cost time: 30.9304518699646
Epoch: 7, Steps: 208 | Train Loss: 3.705 Vali Loss: 3.619 Vali Acc: 0.056 Test Loss: 3.619 Test Acc: 0.056
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 3.8945971
	speed: 0.3438s/iter; left time: 6615.5218s
	iters: 200, epoch: 8 | loss: 3.6335030
	speed: 0.1387s/iter; left time: 2655.7691s
Epoch: 8 cost time: 29.516643047332764
Epoch: 8, Steps: 208 | Train Loss: 3.727 Vali Loss: 3.649 Vali Acc: 0.037 Test Loss: 3.649 Test Acc: 0.037
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 3.6667333
	speed: 0.3374s/iter; left time: 6423.9832s
	iters: 200, epoch: 9 | loss: 3.3643198
	speed: 0.1426s/iter; left time: 2699.5338s
Epoch: 9 cost time: 30.31141185760498
Epoch: 9, Steps: 208 | Train Loss: 3.608 Vali Loss: 3.634 Vali Acc: 0.043 Test Loss: 3.634 Test Acc: 0.043
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 3.7020612
	speed: 0.3414s/iter; left time: 6428.2917s
	iters: 200, epoch: 10 | loss: 4.3413420
	speed: 0.1409s/iter; left time: 2638.1054s
Epoch: 10 cost time: 30.306645393371582
Epoch: 10, Steps: 208 | Train Loss: 3.826 Vali Loss: 3.818 Vali Acc: 0.026 Test Loss: 3.818 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 4.0158272
	speed: 0.3178s/iter; left time: 5917.9877s
	iters: 200, epoch: 11 | loss: 3.8385308
	speed: 0.1525s/iter; left time: 2824.8672s
Epoch: 11 cost time: 27.949419498443604
Epoch: 11, Steps: 208 | Train Loss: 3.896 Vali Loss: 3.754 Vali Acc: 0.026 Test Loss: 3.754 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 3.8147671
	speed: 0.3306s/iter; left time: 6086.4440s
	iters: 200, epoch: 12 | loss: 3.6369543
	speed: 0.1338s/iter; left time: 2449.5194s
Epoch: 12 cost time: 30.123572826385498
Epoch: 12, Steps: 208 | Train Loss: 3.782 Vali Loss: 3.712 Vali Acc: 0.025 Test Loss: 3.712 Test Acc: 0.025
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 4.0674782
	speed: 0.3513s/iter; left time: 6396.2704s
	iters: 200, epoch: 13 | loss: 3.6275718
	speed: 0.1402s/iter; left time: 2538.2900s
Epoch: 13 cost time: 30.381697177886963
Epoch: 13, Steps: 208 | Train Loss: 3.755 Vali Loss: 3.781 Vali Acc: 0.026 Test Loss: 3.781 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 3.7552071
	speed: 0.3411s/iter; left time: 6139.0139s
	iters: 200, epoch: 14 | loss: 3.7959464
	speed: 0.1644s/iter; left time: 2942.5196s
Epoch: 14 cost time: 32.07563877105713
Epoch: 14, Steps: 208 | Train Loss: 3.741 Vali Loss: 3.709 Vali Acc: 0.026 Test Loss: 3.709 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08201610498061437
model parameter : 9100875
model size : 39.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.7366920
	speed: 0.1484s/iter; left time: 3072.2844s
	iters: 200, epoch: 1 | loss: 3.9882729
	speed: 0.1212s/iter; left time: 2496.7740s
Epoch: 1 cost time: 28.20237946510315
Epoch: 1, Steps: 208 | Train Loss: 4.652 Vali Loss: 4.092 Vali Acc: 0.035 Test Loss: 4.092 Test Acc: 0.035
Validation loss decreased (inf --> -0.034555).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.2265282
	speed: 0.3331s/iter; left time: 6827.0862s
	iters: 200, epoch: 2 | loss: 4.0835209
	speed: 0.1531s/iter; left time: 3122.6934s
Epoch: 2 cost time: 30.317128896713257
Epoch: 2, Steps: 208 | Train Loss: 3.930 Vali Loss: 3.819 Vali Acc: 0.054 Test Loss: 3.819 Test Acc: 0.054
Validation loss decreased (-0.034555 --> -0.053645).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.9582129
	speed: 0.3282s/iter; left time: 6656.5520s
	iters: 200, epoch: 3 | loss: 3.1680830
	speed: 0.1365s/iter; left time: 2755.6825s
Epoch: 3 cost time: 27.282722234725952
Epoch: 3, Steps: 208 | Train Loss: 3.833 Vali Loss: 3.732 Vali Acc: 0.067 Test Loss: 3.732 Test Acc: 0.067
Validation loss decreased (-0.053645 --> -0.067067).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.6086483
	speed: 0.2794s/iter; left time: 5608.5563s
	iters: 200, epoch: 4 | loss: 4.0186095
	speed: 0.0955s/iter; left time: 1908.2438s
Epoch: 4 cost time: 20.56585955619812
Epoch: 4, Steps: 208 | Train Loss: 3.637 Vali Loss: 3.702 Vali Acc: 0.098 Test Loss: 3.702 Test Acc: 0.098
Validation loss decreased (-0.067067 --> -0.098382).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3287683
	speed: 0.2805s/iter; left time: 5573.5881s
	iters: 200, epoch: 5 | loss: 3.3994653
	speed: 0.1007s/iter; left time: 1991.3751s
Epoch: 5 cost time: 21.331235647201538
Epoch: 5, Steps: 208 | Train Loss: 3.498 Vali Loss: 3.611 Vali Acc: 0.063 Test Loss: 3.611 Test Acc: 0.063
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.4218888
	speed: 0.2848s/iter; left time: 5600.2280s
	iters: 200, epoch: 6 | loss: 3.9626114
	speed: 0.1056s/iter; left time: 2065.3635s
Epoch: 6 cost time: 23.29860806465149
Epoch: 6, Steps: 208 | Train Loss: 3.474 Vali Loss: 3.738 Vali Acc: 0.036 Test Loss: 3.738 Test Acc: 0.036
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 3.6942077
	speed: 0.2577s/iter; left time: 5012.3846s
	iters: 200, epoch: 7 | loss: 3.4670823
	speed: 0.1257s/iter; left time: 2432.6656s
Epoch: 7 cost time: 23.244524240493774
Epoch: 7, Steps: 208 | Train Loss: 3.794 Vali Loss: 3.620 Vali Acc: 0.047 Test Loss: 3.620 Test Acc: 0.047
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 3.9184730
	speed: 0.3150s/iter; left time: 6062.5046s
	iters: 200, epoch: 8 | loss: 3.4107268
	speed: 0.1140s/iter; left time: 2183.4299s
Epoch: 8 cost time: 26.048109531402588
Epoch: 8, Steps: 208 | Train Loss: 3.759 Vali Loss: 3.695 Vali Acc: 0.037 Test Loss: 3.695 Test Acc: 0.037
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 3.7817583
	speed: 0.3328s/iter; left time: 6336.0928s
	iters: 200, epoch: 9 | loss: 4.2918544
	speed: 0.1344s/iter; left time: 2544.8899s
Epoch: 9 cost time: 27.734307765960693
Epoch: 9, Steps: 208 | Train Loss: 3.888 Vali Loss: 3.805 Vali Acc: 0.025 Test Loss: 3.805 Test Acc: 0.025
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 3.6988115
	speed: 0.2553s/iter; left time: 4807.6199s
	iters: 200, epoch: 10 | loss: 4.0290074
	speed: 0.0657s/iter; left time: 1229.7348s
Epoch: 10 cost time: 14.59163761138916
Epoch: 10, Steps: 208 | Train Loss: 3.795 Vali Loss: 3.752 Vali Acc: 0.026 Test Loss: 3.752 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 3.8415091
	speed: 0.2403s/iter; left time: 4474.7451s
	iters: 200, epoch: 11 | loss: 3.8085089
	speed: 0.0729s/iter; left time: 1350.9380s
Epoch: 11 cost time: 16.271854877471924
Epoch: 11, Steps: 208 | Train Loss: 3.778 Vali Loss: 3.708 Vali Acc: 0.026 Test Loss: 3.708 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 3.8773673
	speed: 0.3292s/iter; left time: 6061.2914s
	iters: 200, epoch: 12 | loss: 3.6447771
	speed: 0.1345s/iter; left time: 2462.6929s
Epoch: 12 cost time: 27.364156246185303
Epoch: 12, Steps: 208 | Train Loss: 3.733 Vali Loss: 3.688 Vali Acc: 0.026 Test Loss: 3.688 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 3.7586069
	speed: 0.3507s/iter; left time: 6384.1056s
	iters: 200, epoch: 13 | loss: 3.6968696
	speed: 0.1171s/iter; left time: 2120.8711s
Epoch: 13 cost time: 28.062203645706177
Epoch: 13, Steps: 208 | Train Loss: 3.715 Vali Loss: 3.686 Vali Acc: 0.026 Test Loss: 3.686 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 3.6690524
	speed: 0.3429s/iter; left time: 6170.9489s
	iters: 200, epoch: 14 | loss: 3.6345544
	speed: 0.1356s/iter; left time: 2427.3775s
Epoch: 14 cost time: 27.37808895111084
Epoch: 14, Steps: 208 | Train Loss: 3.706 Vali Loss: 3.670 Vali Acc: 0.026 Test Loss: 3.670 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09841932597673725
model parameter : 9093451
model size : 39.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.9472480
	speed: 0.1547s/iter; left time: 3203.4536s
	iters: 200, epoch: 1 | loss: 3.9972434
	speed: 0.1353s/iter; left time: 2787.5268s
Epoch: 1 cost time: 30.212082147598267
Epoch: 1, Steps: 208 | Train Loss: 4.618 Vali Loss: 3.819 Vali Acc: 0.052 Test Loss: 3.819 Test Acc: 0.052
Validation loss decreased (inf --> -0.051557).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3654709
	speed: 0.3181s/iter; left time: 6519.6146s
	iters: 200, epoch: 2 | loss: 3.6140001
	speed: 0.1197s/iter; left time: 2441.2227s
Epoch: 2 cost time: 25.502683639526367
Epoch: 2, Steps: 208 | Train Loss: 3.839 Vali Loss: 3.792 Vali Acc: 0.057 Test Loss: 3.792 Test Acc: 0.057
Validation loss decreased (-0.051557 --> -0.056628).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4276192
	speed: 0.3192s/iter; left time: 6474.6035s
	iters: 200, epoch: 3 | loss: 3.2320008
	speed: 0.1225s/iter; left time: 2472.4984s
Epoch: 3 cost time: 26.451067209243774
Epoch: 3, Steps: 208 | Train Loss: 3.760 Vali Loss: 3.709 Vali Acc: 0.060 Test Loss: 3.709 Test Acc: 0.060
Validation loss decreased (-0.056628 --> -0.059611).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3443105
	speed: 0.3198s/iter; left time: 6420.8806s
	iters: 200, epoch: 4 | loss: 4.0021687
	speed: 0.1210s/iter; left time: 2416.7588s
Epoch: 4 cost time: 27.259527683258057
Epoch: 4, Steps: 208 | Train Loss: 3.518 Vali Loss: 3.626 Vali Acc: 0.073 Test Loss: 3.626 Test Acc: 0.073
Validation loss decreased (-0.059611 --> -0.073033).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.6582222
	speed: 0.3077s/iter; left time: 6113.3498s
	iters: 200, epoch: 5 | loss: 2.9187145
	speed: 0.1317s/iter; left time: 2602.9975s
Epoch: 5 cost time: 26.10547924041748
Epoch: 5, Steps: 208 | Train Loss: 3.365 Vali Loss: 3.429 Vali Acc: 0.074 Test Loss: 3.429 Test Acc: 0.074
Validation loss decreased (-0.073033 --> -0.073929).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.4764369
	speed: 0.3331s/iter; left time: 6548.6173s
	iters: 200, epoch: 6 | loss: 3.3671203
	speed: 0.1207s/iter; left time: 2360.5515s
Epoch: 6 cost time: 26.56809973716736
Epoch: 6, Steps: 208 | Train Loss: 3.408 Vali Loss: 3.697 Vali Acc: 0.053 Test Loss: 3.697 Test Acc: 0.053
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 4.4000115
	speed: 0.3137s/iter; left time: 6101.5628s
	iters: 200, epoch: 7 | loss: 3.9015651
	speed: 0.1354s/iter; left time: 2621.1363s
Epoch: 7 cost time: 27.966495990753174
Epoch: 7, Steps: 208 | Train Loss: 3.767 Vali Loss: 3.620 Vali Acc: 0.044 Test Loss: 3.620 Test Acc: 0.044
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.5710356
	speed: 0.3119s/iter; left time: 6002.2007s
	iters: 200, epoch: 8 | loss: 3.8326545
	speed: 0.1321s/iter; left time: 2529.4745s
Epoch: 8 cost time: 27.097025871276855
Epoch: 8, Steps: 208 | Train Loss: 3.609 Vali Loss: 3.569 Vali Acc: 0.050 Test Loss: 3.569 Test Acc: 0.050
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 4.0314236
	speed: 0.3377s/iter; left time: 6428.4844s
	iters: 200, epoch: 9 | loss: 3.0115964
	speed: 0.1279s/iter; left time: 2422.6593s
Epoch: 9 cost time: 27.318926572799683
Epoch: 9, Steps: 208 | Train Loss: 3.512 Vali Loss: 3.354 Vali Acc: 0.075 Test Loss: 3.354 Test Acc: 0.075
Validation loss decreased (-0.073929 --> -0.075421).  Saving model ...
	iters: 100, epoch: 10 | loss: 3.6582077
	speed: 0.3436s/iter; left time: 6470.2414s
	iters: 200, epoch: 10 | loss: 3.3280756
	speed: 0.1250s/iter; left time: 2341.6764s
Epoch: 10 cost time: 27.613617658615112
Epoch: 10, Steps: 208 | Train Loss: 3.583 Vali Loss: 3.530 Vali Acc: 0.060 Test Loss: 3.530 Test Acc: 0.060
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 3.5690143
	speed: 0.3492s/iter; left time: 6503.3197s
	iters: 200, epoch: 11 | loss: 3.2884116
	speed: 0.1125s/iter; left time: 2082.8001s
Epoch: 11 cost time: 27.1649432182312
Epoch: 11, Steps: 208 | Train Loss: 3.498 Vali Loss: 3.455 Vali Acc: 0.066 Test Loss: 3.455 Test Acc: 0.066
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 3.6793454
	speed: 0.3049s/iter; left time: 5614.5351s
	iters: 200, epoch: 12 | loss: 3.5928526
	speed: 0.1356s/iter; left time: 2482.7292s
Epoch: 12 cost time: 26.81184720993042
Epoch: 12, Steps: 208 | Train Loss: 3.446 Vali Loss: 3.562 Vali Acc: 0.055 Test Loss: 3.562 Test Acc: 0.055
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 3.4546223
	speed: 0.3330s/iter; left time: 6062.8565s
	iters: 200, epoch: 13 | loss: 3.4540565
	speed: 0.1216s/iter; left time: 2201.5458s
Epoch: 13 cost time: 28.372451305389404
Epoch: 13, Steps: 208 | Train Loss: 3.444 Vali Loss: 3.485 Vali Acc: 0.062 Test Loss: 3.485 Test Acc: 0.062
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 3.1375141
	speed: 0.3202s/iter; left time: 5763.4526s
	iters: 200, epoch: 14 | loss: 3.4436357
	speed: 0.1287s/iter; left time: 2303.3069s
Epoch: 14 cost time: 26.885642528533936
Epoch: 14, Steps: 208 | Train Loss: 3.446 Vali Loss: 3.438 Vali Acc: 0.068 Test Loss: 3.438 Test Acc: 0.068
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 3.3302412
	speed: 0.2986s/iter; left time: 5311.4153s
	iters: 200, epoch: 15 | loss: 3.4944642
	speed: 0.1210s/iter; left time: 2141.2200s
Epoch: 15 cost time: 24.224563121795654
Epoch: 15, Steps: 208 | Train Loss: 3.439 Vali Loss: 3.470 Vali Acc: 0.059 Test Loss: 3.470 Test Acc: 0.059
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 3.4154935
	speed: 0.3052s/iter; left time: 5366.5928s
	iters: 200, epoch: 16 | loss: 5.2731080
	speed: 0.1202s/iter; left time: 2101.7319s
Epoch: 16 cost time: 25.94500970840454
Epoch: 16, Steps: 208 | Train Loss: 4.048 Vali Loss: 4.202 Vali Acc: 0.028 Test Loss: 4.202 Test Acc: 0.028
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 4.1705613
	speed: 0.2419s/iter; left time: 4203.0090s
	iters: 200, epoch: 17 | loss: 3.8459008
	speed: 0.0652s/iter; left time: 1126.3241s
Epoch: 17 cost time: 14.937375783920288
Epoch: 17, Steps: 208 | Train Loss: 3.986 Vali Loss: 3.768 Vali Acc: 0.026 Test Loss: 3.768 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 3.7977612
	speed: 0.2832s/iter; left time: 4861.7306s
	iters: 200, epoch: 18 | loss: 3.6587253
	speed: 0.1199s/iter; left time: 2046.7848s
Epoch: 18 cost time: 26.881503105163574
Epoch: 18, Steps: 208 | Train Loss: 3.768 Vali Loss: 3.686 Vali Acc: 0.026 Test Loss: 3.686 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 3.6864815
	speed: 0.3067s/iter; left time: 5200.9703s
	iters: 200, epoch: 19 | loss: 3.5558951
	speed: 0.1437s/iter; left time: 2422.7126s
Epoch: 19 cost time: 28.86856698989868
Epoch: 19, Steps: 208 | Train Loss: 3.728 Vali Loss: 3.699 Vali Acc: 0.026 Test Loss: 3.699 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.07545481658216523
model parameter : 9086027
model size : 39.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 7.0947981
	speed: 0.1597s/iter; left time: 3305.9510s
	iters: 200, epoch: 1 | loss: 4.0710616
	speed: 0.1242s/iter; left time: 2558.4594s
Epoch: 1 cost time: 29.05408501625061
Epoch: 1, Steps: 208 | Train Loss: 4.492 Vali Loss: 3.692 Vali Acc: 0.052 Test Loss: 3.692 Test Acc: 0.052
Validation loss decreased (inf --> -0.051559).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6776133
	speed: 0.3315s/iter; left time: 6793.8765s
	iters: 200, epoch: 2 | loss: 3.4883575
	speed: 0.1465s/iter; left time: 2987.5328s
Epoch: 2 cost time: 29.479085206985474
Epoch: 2, Steps: 208 | Train Loss: 3.868 Vali Loss: 3.791 Vali Acc: 0.054 Test Loss: 3.791 Test Acc: 0.054
Validation loss decreased (-0.051559 --> -0.054242).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.8517129
	speed: 0.2618s/iter; left time: 5311.2960s
	iters: 200, epoch: 3 | loss: 4.0932789
	speed: 0.0874s/iter; left time: 1763.4841s
Epoch: 3 cost time: 19.429315090179443
Epoch: 3, Steps: 208 | Train Loss: 3.743 Vali Loss: 3.683 Vali Acc: 0.037 Test Loss: 3.683 Test Acc: 0.037
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.4244728
	speed: 0.2729s/iter; left time: 5479.3762s
	iters: 200, epoch: 4 | loss: 3.4729199
	speed: 0.1339s/iter; left time: 2674.5049s
Epoch: 4 cost time: 26.31761908531189
Epoch: 4, Steps: 208 | Train Loss: 3.573 Vali Loss: 3.660 Vali Acc: 0.065 Test Loss: 3.660 Test Acc: 0.065
Validation loss decreased (-0.054242 --> -0.064682).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3287461
	speed: 0.3106s/iter; left time: 6170.4050s
	iters: 200, epoch: 5 | loss: 3.2576795
	speed: 0.1248s/iter; left time: 2467.4087s
Epoch: 5 cost time: 26.836111783981323
Epoch: 5, Steps: 208 | Train Loss: 3.451 Vali Loss: 3.403 Vali Acc: 0.070 Test Loss: 3.403 Test Acc: 0.070
Validation loss decreased (-0.064682 --> -0.070052).  Saving model ...
	iters: 100, epoch: 6 | loss: 4.0556951
	speed: 0.2917s/iter; left time: 5734.3671s
	iters: 200, epoch: 6 | loss: 3.8783271
	speed: 0.1261s/iter; left time: 2467.3905s
Epoch: 6 cost time: 24.551753997802734
Epoch: 6, Steps: 208 | Train Loss: 3.430 Vali Loss: 3.581 Vali Acc: 0.062 Test Loss: 3.581 Test Acc: 0.062
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 4.1227617
	speed: 0.2994s/iter; left time: 5824.7770s
	iters: 200, epoch: 7 | loss: 3.8697112
	speed: 0.1125s/iter; left time: 2178.0590s
Epoch: 7 cost time: 24.577444314956665
Epoch: 7, Steps: 208 | Train Loss: 3.806 Vali Loss: 3.728 Vali Acc: 0.026 Test Loss: 3.728 Test Acc: 0.026
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.3394775
	speed: 0.3010s/iter; left time: 5792.4579s
	iters: 200, epoch: 8 | loss: 3.6739221
	speed: 0.1307s/iter; left time: 2501.8266s
Epoch: 8 cost time: 27.065431594848633
Epoch: 8, Steps: 208 | Train Loss: 3.771 Vali Loss: 3.885 Vali Acc: 0.026 Test Loss: 3.885 Test Acc: 0.026
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 3.6989279
	speed: 0.3111s/iter; left time: 5923.3606s
	iters: 200, epoch: 9 | loss: 3.9113786
	speed: 0.1056s/iter; left time: 2000.1219s
Epoch: 9 cost time: 24.33359456062317
Epoch: 9, Steps: 208 | Train Loss: 3.721 Vali Loss: 3.640 Vali Acc: 0.041 Test Loss: 3.640 Test Acc: 0.041
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 3.6174135
	speed: 0.3033s/iter; left time: 5710.5670s
	iters: 200, epoch: 10 | loss: 3.8207211
	speed: 0.1328s/iter; left time: 2486.5038s
Epoch: 10 cost time: 26.618172645568848
Epoch: 10, Steps: 208 | Train Loss: 3.637 Vali Loss: 3.610 Vali Acc: 0.048 Test Loss: 3.610 Test Acc: 0.048
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 3.5104063
	speed: 0.3213s/iter; left time: 5983.8043s
	iters: 200, epoch: 11 | loss: 3.5360277
	speed: 0.1379s/iter; left time: 2554.5115s
Epoch: 11 cost time: 29.556912899017334
Epoch: 11, Steps: 208 | Train Loss: 3.627 Vali Loss: 3.598 Vali Acc: 0.038 Test Loss: 3.598 Test Acc: 0.038
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 3.5120721
	speed: 0.3204s/iter; left time: 5899.0733s
	iters: 200, epoch: 12 | loss: 3.5387998
	speed: 0.1375s/iter; left time: 2517.2846s
Epoch: 12 cost time: 26.880828619003296
Epoch: 12, Steps: 208 | Train Loss: 3.594 Vali Loss: 3.530 Vali Acc: 0.046 Test Loss: 3.530 Test Acc: 0.046
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 3.5423059
	speed: 0.3193s/iter; left time: 5812.8699s
	iters: 200, epoch: 13 | loss: 3.5483923
	speed: 0.1390s/iter; left time: 2517.2271s
Epoch: 13 cost time: 28.335997104644775
Epoch: 13, Steps: 208 | Train Loss: 3.592 Vali Loss: 3.573 Vali Acc: 0.047 Test Loss: 3.573 Test Acc: 0.047
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 3.6716461
	speed: 0.3299s/iter; left time: 5937.7505s
	iters: 200, epoch: 14 | loss: 3.8802145
	speed: 0.1162s/iter; left time: 2079.4426s
Epoch: 14 cost time: 26.15432906150818
Epoch: 14, Steps: 208 | Train Loss: 3.682 Vali Loss: 3.637 Vali Acc: 0.041 Test Loss: 3.637 Test Acc: 0.041
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 3.6028426
	speed: 0.3041s/iter; left time: 5409.4279s
	iters: 200, epoch: 15 | loss: 3.8173168
	speed: 0.1124s/iter; left time: 1987.8228s
Epoch: 15 cost time: 25.417041301727295
Epoch: 15, Steps: 208 | Train Loss: 3.655 Vali Loss: 3.681 Vali Acc: 0.042 Test Loss: 3.681 Test Acc: 0.042
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.07008648971070683
model parameter : 9078603
model size : 39.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 6.0734181
	speed: 0.1432s/iter; left time: 2963.7827s
	iters: 200, epoch: 1 | loss: 3.8386564
	speed: 0.0767s/iter; left time: 1579.3380s
Epoch: 1 cost time: 22.69343400001526
Epoch: 1, Steps: 208 | Train Loss: 4.580 Vali Loss: 3.916 Vali Acc: 0.049 Test Loss: 3.916 Test Acc: 0.049
Validation loss decreased (inf --> -0.049171).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8449461
	speed: 0.2969s/iter; left time: 6083.7199s
	iters: 200, epoch: 2 | loss: 3.0408108
	speed: 0.1181s/iter; left time: 2407.7581s
Epoch: 2 cost time: 27.678027868270874
Epoch: 2, Steps: 208 | Train Loss: 3.888 Vali Loss: 3.828 Vali Acc: 0.050 Test Loss: 3.828 Test Acc: 0.050
Validation loss decreased (-0.049171 --> -0.050066).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7530098
	speed: 0.3099s/iter; left time: 6285.6744s
	iters: 200, epoch: 3 | loss: 4.0074348
	speed: 0.1270s/iter; left time: 2563.1604s
Epoch: 3 cost time: 27.42200803756714
Epoch: 3, Steps: 208 | Train Loss: 3.741 Vali Loss: 3.724 Vali Acc: 0.071 Test Loss: 3.724 Test Acc: 0.071
Validation loss decreased (-0.050066 --> -0.071242).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.0909905
	speed: 0.3219s/iter; left time: 6462.7609s
	iters: 200, epoch: 4 | loss: 3.6753209
	speed: 0.1360s/iter; left time: 2717.3162s
Epoch: 4 cost time: 29.353795289993286
Epoch: 4, Steps: 208 | Train Loss: 3.522 Vali Loss: 3.527 Vali Acc: 0.081 Test Loss: 3.527 Test Acc: 0.081
Validation loss decreased (-0.071242 --> -0.080788).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3379288
	speed: 0.3340s/iter; left time: 6635.4604s
	iters: 200, epoch: 5 | loss: 3.0521040
	speed: 0.1235s/iter; left time: 2441.2911s
Epoch: 5 cost time: 28.344743728637695
Epoch: 5, Steps: 208 | Train Loss: 3.359 Vali Loss: 3.684 Vali Acc: 0.098 Test Loss: 3.684 Test Acc: 0.098
Validation loss decreased (-0.080788 --> -0.098084).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.7218618
	speed: 0.3275s/iter; left time: 6438.7294s
	iters: 200, epoch: 6 | loss: 3.2510123
	speed: 0.1487s/iter; left time: 2909.5874s
Epoch: 6 cost time: 31.105719804763794
Epoch: 6, Steps: 208 | Train Loss: 3.291 Vali Loss: 3.524 Vali Acc: 0.058 Test Loss: 3.524 Test Acc: 0.058
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.7096024
	speed: 0.3208s/iter; left time: 6240.2852s
	iters: 200, epoch: 7 | loss: 3.6392977
	speed: 0.1509s/iter; left time: 2920.8417s
Epoch: 7 cost time: 29.3846652507782
Epoch: 7, Steps: 208 | Train Loss: 3.603 Vali Loss: 3.659 Vali Acc: 0.041 Test Loss: 3.659 Test Acc: 0.041
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.9573038
	speed: 0.3337s/iter; left time: 6422.9757s
	iters: 200, epoch: 8 | loss: 3.6722572
	speed: 0.1327s/iter; left time: 2540.8355s
Epoch: 8 cost time: 28.999940633773804
Epoch: 8, Steps: 208 | Train Loss: 3.671 Vali Loss: 3.725 Vali Acc: 0.038 Test Loss: 3.725 Test Acc: 0.038
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 3.4228981
	speed: 0.3369s/iter; left time: 6413.4296s
	iters: 200, epoch: 9 | loss: 3.3724160
	speed: 0.1785s/iter; left time: 3379.5410s
Epoch: 9 cost time: 32.92580032348633
Epoch: 9, Steps: 208 | Train Loss: 3.657 Vali Loss: 3.732 Vali Acc: 0.036 Test Loss: 3.732 Test Acc: 0.036
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 3.5521839
	speed: 0.3448s/iter; left time: 6492.8167s
	iters: 200, epoch: 10 | loss: 3.7879333
	speed: 0.1220s/iter; left time: 2285.2084s
Epoch: 10 cost time: 26.818045139312744
Epoch: 10, Steps: 208 | Train Loss: 3.593 Vali Loss: 3.533 Vali Acc: 0.052 Test Loss: 3.533 Test Acc: 0.052
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 3.8143191
	speed: 0.2973s/iter; left time: 5535.8396s
	iters: 200, epoch: 11 | loss: 3.5391040
	speed: 0.1251s/iter; left time: 2317.1638s
Epoch: 11 cost time: 27.49771499633789
Epoch: 11, Steps: 208 | Train Loss: 3.596 Vali Loss: 3.583 Vali Acc: 0.050 Test Loss: 3.583 Test Acc: 0.050
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 3.6347456
	speed: 0.3270s/iter; left time: 6021.7745s
	iters: 200, epoch: 12 | loss: 3.5756245
	speed: 0.1386s/iter; left time: 2539.0451s
Epoch: 12 cost time: 28.858547925949097
Epoch: 12, Steps: 208 | Train Loss: 3.670 Vali Loss: 3.586 Vali Acc: 0.042 Test Loss: 3.586 Test Acc: 0.042
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 3.2531543
	speed: 0.2965s/iter; left time: 5398.6924s
	iters: 200, epoch: 13 | loss: 3.5824606
	speed: 0.1322s/iter; left time: 2394.3771s
Epoch: 13 cost time: 26.305379152297974
Epoch: 13, Steps: 208 | Train Loss: 3.600 Vali Loss: 3.684 Vali Acc: 0.032 Test Loss: 3.684 Test Acc: 0.032
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 3.5607154
	speed: 0.2705s/iter; left time: 4868.4903s
	iters: 200, epoch: 14 | loss: 3.4006121
	speed: 0.0926s/iter; left time: 1657.3489s
Epoch: 14 cost time: 20.89978528022766
Epoch: 14, Steps: 208 | Train Loss: 3.575 Vali Loss: 3.562 Vali Acc: 0.047 Test Loss: 3.562 Test Acc: 0.047
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 3.3691175
	speed: 0.2767s/iter; left time: 4921.4278s
	iters: 200, epoch: 15 | loss: 3.8284655
	speed: 0.0996s/iter; left time: 1762.6926s
Epoch: 15 cost time: 22.9030864238739
Epoch: 15, Steps: 208 | Train Loss: 3.584 Vali Loss: 3.668 Vali Acc: 0.024 Test Loss: 3.668 Test Acc: 0.024
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09812108559498957
model parameter : 7787595
model size : 34.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.6767297
	speed: 0.1332s/iter; left time: 2756.9997s
	iters: 200, epoch: 1 | loss: 4.1443796
	speed: 0.1174s/iter; left time: 2418.5655s
Epoch: 1 cost time: 26.22851324081421
Epoch: 1, Steps: 208 | Train Loss: 4.541 Vali Loss: 4.092 Vali Acc: 0.039 Test Loss: 4.092 Test Acc: 0.039
Validation loss decreased (inf --> -0.038730).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.0064149
	speed: 0.3047s/iter; left time: 6243.5550s
	iters: 200, epoch: 2 | loss: 3.7494118
	speed: 0.1262s/iter; left time: 2573.1028s
Epoch: 2 cost time: 27.439077615737915
Epoch: 2, Steps: 208 | Train Loss: 3.899 Vali Loss: 3.848 Vali Acc: 0.053 Test Loss: 3.848 Test Acc: 0.053
Validation loss decreased (-0.038730 --> -0.052750).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.1110778
	speed: 0.2890s/iter; left time: 5861.7975s
	iters: 200, epoch: 3 | loss: 4.0130634
	speed: 0.1363s/iter; left time: 2751.6319s
Epoch: 3 cost time: 26.033365488052368
Epoch: 3, Steps: 208 | Train Loss: 3.732 Vali Loss: 3.694 Vali Acc: 0.061 Test Loss: 3.694 Test Acc: 0.061
Validation loss decreased (-0.052750 --> -0.060804).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2958405
	speed: 0.3246s/iter; left time: 6517.0434s
	iters: 200, epoch: 4 | loss: 3.4457269
	speed: 0.1135s/iter; left time: 2267.7528s
Epoch: 4 cost time: 25.122249841690063
Epoch: 4, Steps: 208 | Train Loss: 3.544 Vali Loss: 3.751 Vali Acc: 0.082 Test Loss: 3.751 Test Acc: 0.082
Validation loss decreased (-0.060804 --> -0.081680).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.1215634
	speed: 0.3471s/iter; left time: 6895.7063s
	iters: 200, epoch: 5 | loss: 3.7566173
	speed: 0.1267s/iter; left time: 2505.6969s
Epoch: 5 cost time: 28.57854390144348
Epoch: 5, Steps: 208 | Train Loss: 3.352 Vali Loss: 3.368 Vali Acc: 0.096 Test Loss: 3.368 Test Acc: 0.096
Validation loss decreased (-0.081680 --> -0.096000).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.3849552
	speed: 0.3339s/iter; left time: 6564.7667s
	iters: 200, epoch: 6 | loss: 3.0618725
	speed: 0.1201s/iter; left time: 2349.4423s
Epoch: 6 cost time: 26.976304054260254
Epoch: 6, Steps: 208 | Train Loss: 3.264 Vali Loss: 3.369 Vali Acc: 0.085 Test Loss: 3.369 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.2141237
	speed: 0.3015s/iter; left time: 5865.3009s
	iters: 200, epoch: 7 | loss: 3.5857625
	speed: 0.1181s/iter; left time: 2285.6294s
Epoch: 7 cost time: 25.760663509368896
Epoch: 7, Steps: 208 | Train Loss: 3.496 Vali Loss: 3.496 Vali Acc: 0.062 Test Loss: 3.496 Test Acc: 0.062
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.4707322
	speed: 0.2195s/iter; left time: 4224.8934s
	iters: 200, epoch: 8 | loss: 3.5254266
	speed: 0.0709s/iter; left time: 1356.7255s
Epoch: 8 cost time: 14.960509061813354
Epoch: 8, Steps: 208 | Train Loss: 3.526 Vali Loss: 3.575 Vali Acc: 0.038 Test Loss: 3.575 Test Acc: 0.038
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 3.7251189
	speed: 0.3008s/iter; left time: 5726.4077s
	iters: 200, epoch: 9 | loss: 3.4511094
	speed: 0.1236s/iter; left time: 2340.7968s
Epoch: 9 cost time: 25.891803741455078
Epoch: 9, Steps: 208 | Train Loss: 3.634 Vali Loss: 3.588 Vali Acc: 0.046 Test Loss: 3.588 Test Acc: 0.046
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 3.4599168
	speed: 0.2852s/iter; left time: 5370.3457s
	iters: 200, epoch: 10 | loss: 3.4704025
	speed: 0.1203s/iter; left time: 2254.0052s
Epoch: 10 cost time: 23.824223518371582
Epoch: 10, Steps: 208 | Train Loss: 3.578 Vali Loss: 3.652 Vali Acc: 0.041 Test Loss: 3.652 Test Acc: 0.041
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 3.7537069
	speed: 0.3074s/iter; left time: 5725.0100s
	iters: 200, epoch: 11 | loss: 3.5600753
	speed: 0.1230s/iter; left time: 2277.3401s
Epoch: 11 cost time: 26.35796356201172
Epoch: 11, Steps: 208 | Train Loss: 3.564 Vali Loss: 3.505 Vali Acc: 0.057 Test Loss: 3.505 Test Acc: 0.057
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 3.7336519
	speed: 0.3026s/iter; left time: 5571.3764s
	iters: 200, epoch: 12 | loss: 3.1492250
	speed: 0.1325s/iter; left time: 2427.3810s
Epoch: 12 cost time: 26.917656421661377
Epoch: 12, Steps: 208 | Train Loss: 3.496 Vali Loss: 3.634 Vali Acc: 0.035 Test Loss: 3.634 Test Acc: 0.035
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 3.7451935
	speed: 0.2946s/iter; left time: 5363.9601s
	iters: 200, epoch: 13 | loss: 3.2440906
	speed: 0.1172s/iter; left time: 2122.2038s
Epoch: 13 cost time: 25.25100541114807
Epoch: 13, Steps: 208 | Train Loss: 3.495 Vali Loss: 3.401 Vali Acc: 0.063 Test Loss: 3.401 Test Acc: 0.063
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 3.3217337
	speed: 0.2961s/iter; left time: 5329.8089s
	iters: 200, epoch: 14 | loss: 3.5195651
	speed: 0.1185s/iter; left time: 2120.1931s
Epoch: 14 cost time: 24.595049142837524
Epoch: 14, Steps: 208 | Train Loss: 3.490 Vali Loss: 3.435 Vali Acc: 0.067 Test Loss: 3.435 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 3.5046897
	speed: 0.3173s/iter; left time: 5644.2491s
	iters: 200, epoch: 15 | loss: 3.3305357
	speed: 0.1307s/iter; left time: 2311.2670s
Epoch: 15 cost time: 26.837552309036255
Epoch: 15, Steps: 208 | Train Loss: 3.434 Vali Loss: 3.424 Vali Acc: 0.059 Test Loss: 3.424 Test Acc: 0.059
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09603340292275574
model parameter : 7780171
model size : 34.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.7637014
	speed: 0.1485s/iter; left time: 3074.0727s
	iters: 200, epoch: 1 | loss: 4.4696259
	speed: 0.1077s/iter; left time: 2219.6147s
Epoch: 1 cost time: 26.41388249397278
Epoch: 1, Steps: 208 | Train Loss: 4.674 Vali Loss: 4.081 Vali Acc: 0.042 Test Loss: 4.081 Test Acc: 0.042
Validation loss decreased (inf --> -0.042309).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9337518
	speed: 0.3053s/iter; left time: 6257.1625s
	iters: 200, epoch: 2 | loss: 3.2792261
	speed: 0.1312s/iter; left time: 2676.5332s
Epoch: 2 cost time: 26.03429412841797
Epoch: 2, Steps: 208 | Train Loss: 3.859 Vali Loss: 3.926 Vali Acc: 0.048 Test Loss: 3.926 Test Acc: 0.048
Validation loss decreased (-0.042309 --> -0.047679).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5374670
	speed: 0.2934s/iter; left time: 5952.5992s
	iters: 200, epoch: 3 | loss: 3.9905217
	speed: 0.1191s/iter; left time: 2404.4692s
Epoch: 3 cost time: 25.751717567443848
Epoch: 3, Steps: 208 | Train Loss: 3.763 Vali Loss: 3.780 Vali Acc: 0.077 Test Loss: 3.780 Test Acc: 0.077
Validation loss decreased (-0.047679 --> -0.076610).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.8267784
	speed: 0.2975s/iter; left time: 5972.6212s
	iters: 200, epoch: 4 | loss: 4.5713353
	speed: 0.1242s/iter; left time: 2481.2561s
Epoch: 4 cost time: 25.49439525604248
Epoch: 4, Steps: 208 | Train Loss: 3.540 Vali Loss: 3.626 Vali Acc: 0.059 Test Loss: 3.626 Test Acc: 0.059
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.4478714
	speed: 0.3033s/iter; left time: 6025.4266s
	iters: 200, epoch: 5 | loss: 3.1252532
	speed: 0.1331s/iter; left time: 2631.8923s
Epoch: 5 cost time: 26.057605981826782
Epoch: 5, Steps: 208 | Train Loss: 3.375 Vali Loss: 3.573 Vali Acc: 0.062 Test Loss: 3.573 Test Acc: 0.062
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 3.2409830
	speed: 0.3080s/iter; left time: 6055.8006s
	iters: 200, epoch: 6 | loss: 4.0063658
	speed: 0.1132s/iter; left time: 2214.2472s
Epoch: 6 cost time: 25.236676692962646
Epoch: 6, Steps: 208 | Train Loss: 3.300 Vali Loss: 3.272 Vali Acc: 0.097 Test Loss: 3.272 Test Acc: 0.097
Validation loss decreased (-0.076610 --> -0.096895).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.7507885
	speed: 0.3270s/iter; left time: 6361.0471s
	iters: 200, epoch: 7 | loss: 3.8246970
	speed: 0.1135s/iter; left time: 2195.9944s
Epoch: 7 cost time: 24.878050327301025
Epoch: 7, Steps: 208 | Train Loss: 3.557 Vali Loss: 3.659 Vali Acc: 0.036 Test Loss: 3.659 Test Acc: 0.036
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 3.4348626
	speed: 0.3019s/iter; left time: 5809.1239s
	iters: 200, epoch: 8 | loss: 3.7000558
	speed: 0.1295s/iter; left time: 2479.9686s
Epoch: 8 cost time: 26.960819721221924
Epoch: 8, Steps: 208 | Train Loss: 3.600 Vali Loss: 3.547 Vali Acc: 0.049 Test Loss: 3.547 Test Acc: 0.049
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 3.6639271
	speed: 0.3024s/iter; left time: 5756.2370s
	iters: 200, epoch: 9 | loss: 3.6150651
	speed: 0.1274s/iter; left time: 2411.9890s
Epoch: 9 cost time: 26.11009168624878
Epoch: 9, Steps: 208 | Train Loss: 3.542 Vali Loss: 3.522 Vali Acc: 0.053 Test Loss: 3.522 Test Acc: 0.053
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 3.6091132
	speed: 0.2975s/iter; left time: 5600.7914s
	iters: 200, epoch: 10 | loss: 3.5942883
	speed: 0.1068s/iter; left time: 1999.3710s
Epoch: 10 cost time: 23.85607385635376
Epoch: 10, Steps: 208 | Train Loss: 3.643 Vali Loss: 3.569 Vali Acc: 0.051 Test Loss: 3.569 Test Acc: 0.051
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 3.6132553
	speed: 0.3303s/iter; left time: 6150.7327s
	iters: 200, epoch: 11 | loss: 3.4137759
	speed: 0.1419s/iter; left time: 2627.7721s
Epoch: 11 cost time: 29.197576761245728
Epoch: 11, Steps: 208 | Train Loss: 3.610 Vali Loss: 3.714 Vali Acc: 0.047 Test Loss: 3.714 Test Acc: 0.047
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 3.4819856
	speed: 0.3154s/iter; left time: 5806.6644s
	iters: 200, epoch: 12 | loss: 3.5870461
	speed: 0.1213s/iter; left time: 2221.5174s
Epoch: 12 cost time: 24.61082911491394
Epoch: 12, Steps: 208 | Train Loss: 3.606 Vali Loss: 3.573 Vali Acc: 0.054 Test Loss: 3.573 Test Acc: 0.054
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 3.8069227
	speed: 0.2812s/iter; left time: 5119.1111s
	iters: 200, epoch: 13 | loss: 3.4744990
	speed: 0.0884s/iter; left time: 1601.1206s
Epoch: 13 cost time: 20.86048936843872
Epoch: 13, Steps: 208 | Train Loss: 3.561 Vali Loss: 3.515 Vali Acc: 0.055 Test Loss: 3.515 Test Acc: 0.055
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 3.7978070
	speed: 0.2866s/iter; left time: 5157.6377s
	iters: 200, epoch: 14 | loss: 3.5010626
	speed: 0.0772s/iter; left time: 1381.1555s
Epoch: 14 cost time: 19.44023108482361
Epoch: 14, Steps: 208 | Train Loss: 3.579 Vali Loss: 3.543 Vali Acc: 0.046 Test Loss: 3.543 Test Acc: 0.046
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 3.8479040
	speed: 0.2279s/iter; left time: 4054.9110s
	iters: 200, epoch: 15 | loss: 3.7064323
	speed: 0.1151s/iter; left time: 2035.6006s
Epoch: 15 cost time: 21.134856700897217
Epoch: 15, Steps: 208 | Train Loss: 3.615 Vali Loss: 3.579 Vali Acc: 0.044 Test Loss: 3.579 Test Acc: 0.044
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 3.7687371
	speed: 0.3018s/iter; left time: 5305.5875s
	iters: 200, epoch: 16 | loss: 3.5147624
	speed: 0.1184s/iter; left time: 2070.0724s
Epoch: 16 cost time: 25.708076000213623
Epoch: 16, Steps: 208 | Train Loss: 3.639 Vali Loss: 3.782 Vali Acc: 0.026 Test Loss: 3.782 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.0969281240679988
model parameter : 7772747
model size : 34.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.8878374
	speed: 0.1427s/iter; left time: 2953.0459s
	iters: 200, epoch: 1 | loss: 3.5254679
	speed: 0.1159s/iter; left time: 2387.9602s
Epoch: 1 cost time: 26.92858338356018
Epoch: 1, Steps: 208 | Train Loss: 4.635 Vali Loss: 4.027 Vali Acc: 0.035 Test Loss: 4.027 Test Acc: 0.035
Validation loss decreased (inf --> -0.035152).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5827007
	speed: 0.2993s/iter; left time: 6134.5737s
	iters: 200, epoch: 2 | loss: 3.9892128
	speed: 0.1201s/iter; left time: 2448.1945s
Epoch: 2 cost time: 24.90503740310669
Epoch: 2, Steps: 208 | Train Loss: 3.891 Vali Loss: 3.808 Vali Acc: 0.048 Test Loss: 3.808 Test Acc: 0.048
Validation loss decreased (-0.035152 --> -0.048277).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.9640951
	speed: 0.3020s/iter; left time: 6125.8698s
	iters: 200, epoch: 3 | loss: 3.8745172
	speed: 0.1300s/iter; left time: 2623.3916s
Epoch: 3 cost time: 26.21008610725403
Epoch: 3, Steps: 208 | Train Loss: 3.724 Vali Loss: 3.750 Vali Acc: 0.072 Test Loss: 3.750 Test Acc: 0.072
Validation loss decreased (-0.048277 --> -0.071838).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.5174055
	speed: 0.3040s/iter; left time: 6103.8241s
	iters: 200, epoch: 4 | loss: 3.0960732
	speed: 0.1205s/iter; left time: 2407.0353s
Epoch: 4 cost time: 24.996305465698242
Epoch: 4, Steps: 208 | Train Loss: 3.563 Vali Loss: 3.949 Vali Acc: 0.038 Test Loss: 3.949 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.5634077
	speed: 0.2958s/iter; left time: 5876.7080s
	iters: 200, epoch: 5 | loss: 4.0338593
	speed: 0.0956s/iter; left time: 1890.1300s
Epoch: 5 cost time: 22.776520013809204
Epoch: 5, Steps: 208 | Train Loss: 3.435 Vali Loss: 3.376 Vali Acc: 0.094 Test Loss: 3.376 Test Acc: 0.094
Validation loss decreased (-0.071838 --> -0.093912).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.6630156
	speed: 0.3163s/iter; left time: 6219.1560s
	iters: 200, epoch: 6 | loss: 2.8278213
	speed: 0.1352s/iter; left time: 2645.1393s
Epoch: 6 cost time: 27.915685892105103
Epoch: 6, Steps: 208 | Train Loss: 3.341 Vali Loss: 3.481 Vali Acc: 0.067 Test Loss: 3.481 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.6188900
	speed: 0.3031s/iter; left time: 5895.4465s
	iters: 200, epoch: 7 | loss: 4.1009617
	speed: 0.1112s/iter; left time: 2151.8190s
Epoch: 7 cost time: 23.210140705108643
Epoch: 7, Steps: 208 | Train Loss: 3.497 Vali Loss: 3.756 Vali Acc: 0.028 Test Loss: 3.756 Test Acc: 0.028
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.7220356
	speed: 0.3235s/iter; left time: 6225.6887s
	iters: 200, epoch: 8 | loss: 3.7169921
	speed: 0.1022s/iter; left time: 1956.2741s
Epoch: 8 cost time: 24.940133333206177
Epoch: 8, Steps: 208 | Train Loss: 3.731 Vali Loss: 3.554 Vali Acc: 0.056 Test Loss: 3.554 Test Acc: 0.056
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 3.6018064
	speed: 0.2891s/iter; left time: 5503.3538s
	iters: 200, epoch: 9 | loss: 3.3121042
	speed: 0.1214s/iter; left time: 2298.9469s
Epoch: 9 cost time: 23.680788040161133
Epoch: 9, Steps: 208 | Train Loss: 3.619 Vali Loss: 3.566 Vali Acc: 0.050 Test Loss: 3.566 Test Acc: 0.050
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 3.2166617
	speed: 0.3069s/iter; left time: 5778.6896s
	iters: 200, epoch: 10 | loss: 3.5445321
	speed: 0.1116s/iter; left time: 2089.5925s
Epoch: 10 cost time: 25.288291931152344
Epoch: 10, Steps: 208 | Train Loss: 3.494 Vali Loss: 3.520 Vali Acc: 0.063 Test Loss: 3.520 Test Acc: 0.063
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 3.4508355
	speed: 0.3128s/iter; left time: 5825.4226s
	iters: 200, epoch: 11 | loss: 3.3007123
	speed: 0.1120s/iter; left time: 2075.2330s
Epoch: 11 cost time: 25.0712251663208
Epoch: 11, Steps: 208 | Train Loss: 3.520 Vali Loss: 3.452 Vali Acc: 0.069 Test Loss: 3.452 Test Acc: 0.069
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 3.3773286
	speed: 0.2797s/iter; left time: 5149.9654s
	iters: 200, epoch: 12 | loss: 3.8126154
	speed: 0.1286s/iter; left time: 2354.6004s
Epoch: 12 cost time: 24.555553436279297
Epoch: 12, Steps: 208 | Train Loss: 3.484 Vali Loss: 3.510 Vali Acc: 0.052 Test Loss: 3.510 Test Acc: 0.052
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 3.3399384
	speed: 0.3011s/iter; left time: 5480.9797s
	iters: 200, epoch: 13 | loss: 3.4211934
	speed: 0.1075s/iter; left time: 1946.2474s
Epoch: 13 cost time: 24.64914345741272
Epoch: 13, Steps: 208 | Train Loss: 3.459 Vali Loss: 3.483 Vali Acc: 0.060 Test Loss: 3.483 Test Acc: 0.060
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 3.3235583
	speed: 0.3102s/iter; left time: 5583.3243s
	iters: 200, epoch: 14 | loss: 3.4649367
	speed: 0.1123s/iter; left time: 2009.0192s
Epoch: 14 cost time: 25.36972141265869
Epoch: 14, Steps: 208 | Train Loss: 3.507 Vali Loss: 3.530 Vali Acc: 0.050 Test Loss: 3.530 Test Acc: 0.050
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 3.3516116
	speed: 0.2927s/iter; left time: 5207.3011s
	iters: 200, epoch: 15 | loss: 3.2593079
	speed: 0.1263s/iter; left time: 2234.3352s
Epoch: 15 cost time: 25.349332332611084
Epoch: 15, Steps: 208 | Train Loss: 3.537 Vali Loss: 3.607 Vali Acc: 0.048 Test Loss: 3.607 Test Acc: 0.048
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09394572025052192
model parameter : 7765323
model size : 34.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.2968230
	speed: 0.1552s/iter; left time: 3212.9637s
	iters: 200, epoch: 1 | loss: 4.0901699
	speed: 0.1389s/iter; left time: 2861.2971s
Epoch: 1 cost time: 30.71987247467041
Epoch: 1, Steps: 208 | Train Loss: 4.724 Vali Loss: 4.215 Vali Acc: 0.038 Test Loss: 4.215 Test Acc: 0.038
Validation loss decreased (inf --> -0.037536).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.0039821
	speed: 0.2806s/iter; left time: 5750.1127s
	iters: 200, epoch: 2 | loss: 3.9265637
	speed: 0.0800s/iter; left time: 1631.1897s
Epoch: 2 cost time: 17.396485805511475
Epoch: 2, Steps: 208 | Train Loss: 3.877 Vali Loss: 3.744 Vali Acc: 0.061 Test Loss: 3.744 Test Acc: 0.061
Validation loss decreased (-0.037536 --> -0.061400).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7568381
	speed: 0.3047s/iter; left time: 6180.8447s
	iters: 200, epoch: 3 | loss: 3.2563400
	speed: 0.1213s/iter; left time: 2448.3908s
Epoch: 3 cost time: 26.879659175872803
Epoch: 3, Steps: 208 | Train Loss: 3.720 Vali Loss: 3.704 Vali Acc: 0.061 Test Loss: 3.704 Test Acc: 0.061
Validation loss decreased (-0.061400 --> -0.061400).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.5016322
	speed: 0.3270s/iter; left time: 6564.3372s
	iters: 200, epoch: 4 | loss: 3.3707180
	speed: 0.1115s/iter; left time: 2227.5689s
Epoch: 4 cost time: 25.398661375045776
Epoch: 4, Steps: 208 | Train Loss: 3.507 Vali Loss: 3.481 Vali Acc: 0.082 Test Loss: 3.481 Test Acc: 0.082
Validation loss decreased (-0.061400 --> -0.081981).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3869290
	speed: 0.3040s/iter; left time: 6040.5393s
	iters: 200, epoch: 5 | loss: 3.2299519
	speed: 0.1320s/iter; left time: 2609.3265s
Epoch: 5 cost time: 26.130854606628418
Epoch: 5, Steps: 208 | Train Loss: 3.355 Vali Loss: 3.519 Vali Acc: 0.071 Test Loss: 3.519 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.1592846
	speed: 0.3024s/iter; left time: 5945.6446s
	iters: 200, epoch: 6 | loss: 3.3672457
	speed: 0.1246s/iter; left time: 2438.2103s
Epoch: 6 cost time: 26.629646062850952
Epoch: 6, Steps: 208 | Train Loss: 3.288 Vali Loss: 3.677 Vali Acc: 0.063 Test Loss: 3.677 Test Acc: 0.063
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 3.7641068
	speed: 0.3184s/iter; left time: 6193.9565s
	iters: 200, epoch: 7 | loss: 3.6110663
	speed: 0.1208s/iter; left time: 2338.4645s
Epoch: 7 cost time: 26.452754497528076
Epoch: 7, Steps: 208 | Train Loss: 3.384 Vali Loss: 3.553 Vali Acc: 0.061 Test Loss: 3.553 Test Acc: 0.061
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 3.7090364
	speed: 0.3108s/iter; left time: 5980.9315s
	iters: 200, epoch: 8 | loss: 3.6567559
	speed: 0.1312s/iter; left time: 2511.2451s
Epoch: 8 cost time: 27.81614351272583
Epoch: 8, Steps: 208 | Train Loss: 3.625 Vali Loss: 3.473 Vali Acc: 0.066 Test Loss: 3.473 Test Acc: 0.066
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 3.4270172
	speed: 0.2937s/iter; left time: 5591.9742s
	iters: 200, epoch: 9 | loss: 3.2523534
	speed: 0.1294s/iter; left time: 2450.4103s
Epoch: 9 cost time: 25.677214860916138
Epoch: 9, Steps: 208 | Train Loss: 3.523 Vali Loss: 3.559 Vali Acc: 0.048 Test Loss: 3.559 Test Acc: 0.048
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 3.9574413
	speed: 0.3185s/iter; left time: 5997.5189s
	iters: 200, epoch: 10 | loss: 3.6958096
	speed: 0.0977s/iter; left time: 1830.3597s
Epoch: 10 cost time: 24.447290182113647
Epoch: 10, Steps: 208 | Train Loss: 3.530 Vali Loss: 3.529 Vali Acc: 0.057 Test Loss: 3.529 Test Acc: 0.057
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 3.7072167
	speed: 0.2568s/iter; left time: 4782.3331s
	iters: 200, epoch: 11 | loss: 3.3416419
	speed: 0.0980s/iter; left time: 1815.7356s
Epoch: 11 cost time: 21.521695137023926
Epoch: 11, Steps: 208 | Train Loss: 3.541 Vali Loss: 3.560 Vali Acc: 0.049 Test Loss: 3.560 Test Acc: 0.049
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 3.4992185
	speed: 0.3005s/iter; left time: 5533.7664s
	iters: 200, epoch: 12 | loss: 3.4342225
	speed: 0.1474s/iter; left time: 2698.6575s
Epoch: 12 cost time: 27.7153537273407
Epoch: 12, Steps: 208 | Train Loss: 3.500 Vali Loss: 3.603 Vali Acc: 0.045 Test Loss: 3.603 Test Acc: 0.045
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 3.3725827
	speed: 0.2880s/iter; left time: 5242.2832s
	iters: 200, epoch: 13 | loss: 3.6764092
	speed: 0.1321s/iter; left time: 2392.2065s
Epoch: 13 cost time: 25.53562641143799
Epoch: 13, Steps: 208 | Train Loss: 3.490 Vali Loss: 3.704 Vali Acc: 0.027 Test Loss: 3.704 Test Acc: 0.027
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 3.4899917
	speed: 0.3352s/iter; left time: 6032.0227s
	iters: 200, epoch: 14 | loss: 3.8132353
	speed: 0.1180s/iter; left time: 2112.2558s
Epoch: 14 cost time: 27.82589817047119
Epoch: 14, Steps: 208 | Train Loss: 3.886 Vali Loss: 3.813 Vali Acc: 0.026 Test Loss: 3.813 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08201610498061437
model parameter : 7130955
model size : 32.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.2178340
	speed: 0.1233s/iter; left time: 2551.5573s
	iters: 200, epoch: 1 | loss: 4.0760579
	speed: 0.1204s/iter; left time: 2480.6479s
Epoch: 1 cost time: 25.194709062576294
Epoch: 1, Steps: 208 | Train Loss: 4.677 Vali Loss: 3.881 Vali Acc: 0.046 Test Loss: 3.881 Test Acc: 0.046
Validation loss decreased (inf --> -0.045592).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4500797
	speed: 0.2837s/iter; left time: 5814.2227s
	iters: 200, epoch: 2 | loss: 3.9778438
	speed: 0.1158s/iter; left time: 2362.5223s
Epoch: 2 cost time: 24.013383388519287
Epoch: 2, Steps: 208 | Train Loss: 3.889 Vali Loss: 3.860 Vali Acc: 0.043 Test Loss: 3.860 Test Acc: 0.043
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.9100828
	speed: 0.2908s/iter; left time: 5899.0018s
	iters: 200, epoch: 3 | loss: 3.5903733
	speed: 0.1100s/iter; left time: 2219.8665s
Epoch: 3 cost time: 24.3011577129364
Epoch: 3, Steps: 208 | Train Loss: 3.683 Vali Loss: 3.854 Vali Acc: 0.053 Test Loss: 3.854 Test Acc: 0.053
Validation loss decreased (-0.045592 --> -0.052750).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.8570664
	speed: 0.2897s/iter; left time: 5816.3073s
	iters: 200, epoch: 4 | loss: 3.2262502
	speed: 0.1212s/iter; left time: 2421.5529s
Epoch: 4 cost time: 24.119471549987793
Epoch: 4, Steps: 208 | Train Loss: 3.513 Vali Loss: 3.635 Vali Acc: 0.047 Test Loss: 3.635 Test Acc: 0.047
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.2328248
	speed: 0.2895s/iter; left time: 5752.0780s
	iters: 200, epoch: 5 | loss: 3.1265683
	speed: 0.1150s/iter; left time: 2274.0842s
Epoch: 5 cost time: 25.296568870544434
Epoch: 5, Steps: 208 | Train Loss: 3.340 Vali Loss: 3.365 Vali Acc: 0.106 Test Loss: 3.365 Test Acc: 0.106
Validation loss decreased (-0.052750 --> -0.106140).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.8628430
	speed: 0.2897s/iter; left time: 5694.8128s
	iters: 200, epoch: 6 | loss: 3.3633678
	speed: 0.1215s/iter; left time: 2375.7171s
Epoch: 6 cost time: 24.878405809402466
Epoch: 6, Steps: 208 | Train Loss: 3.252 Vali Loss: 3.383 Vali Acc: 0.083 Test Loss: 3.383 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.1792681
	speed: 0.2758s/iter; left time: 5364.7727s
	iters: 200, epoch: 7 | loss: 3.8125565
	speed: 0.0993s/iter; left time: 1921.8067s
Epoch: 7 cost time: 22.662293910980225
Epoch: 7, Steps: 208 | Train Loss: 3.411 Vali Loss: 3.510 Vali Acc: 0.047 Test Loss: 3.510 Test Acc: 0.047
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.5689878
	speed: 0.2898s/iter; left time: 5576.7482s
	iters: 200, epoch: 8 | loss: 3.5848463
	speed: 0.1201s/iter; left time: 2299.9285s
Epoch: 8 cost time: 25.450649976730347
Epoch: 8, Steps: 208 | Train Loss: 3.539 Vali Loss: 3.484 Vali Acc: 0.067 Test Loss: 3.484 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 3.4113989
	speed: 0.3088s/iter; left time: 5878.4809s
	iters: 200, epoch: 9 | loss: 3.4413257
	speed: 0.1254s/iter; left time: 2375.0964s
Epoch: 9 cost time: 26.173167943954468
Epoch: 9, Steps: 208 | Train Loss: 3.477 Vali Loss: 3.529 Vali Acc: 0.061 Test Loss: 3.529 Test Acc: 0.061
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 3.8181028
	speed: 0.3205s/iter; left time: 6034.4396s
	iters: 200, epoch: 10 | loss: 3.9281991
	speed: 0.1050s/iter; left time: 1965.9820s
Epoch: 10 cost time: 25.364197492599487
Epoch: 10, Steps: 208 | Train Loss: 3.514 Vali Loss: 3.475 Vali Acc: 0.071 Test Loss: 3.475 Test Acc: 0.071
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 3.6869497
	speed: 0.3336s/iter; left time: 6212.8236s
	iters: 200, epoch: 11 | loss: 3.5873256
	speed: 0.1324s/iter; left time: 2452.2562s
Epoch: 11 cost time: 28.25621008872986
Epoch: 11, Steps: 208 | Train Loss: 3.462 Vali Loss: 3.406 Vali Acc: 0.069 Test Loss: 3.406 Test Acc: 0.069
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 3.3230152
	speed: 0.2841s/iter; left time: 5231.5166s
	iters: 200, epoch: 12 | loss: 3.6809247
	speed: 0.1177s/iter; left time: 2156.1665s
Epoch: 12 cost time: 24.613495349884033
Epoch: 12, Steps: 208 | Train Loss: 3.470 Vali Loss: 3.462 Vali Acc: 0.058 Test Loss: 3.462 Test Acc: 0.058
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 3.6616127
	speed: 0.2839s/iter; left time: 5167.9680s
	iters: 200, epoch: 13 | loss: 3.4966195
	speed: 0.1046s/iter; left time: 1893.2610s
Epoch: 13 cost time: 23.055441856384277
Epoch: 13, Steps: 208 | Train Loss: 3.468 Vali Loss: 3.462 Vali Acc: 0.061 Test Loss: 3.462 Test Acc: 0.061
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 3.3836863
	speed: 0.2110s/iter; left time: 3797.9216s
	iters: 200, epoch: 14 | loss: 3.7450087
	speed: 0.0768s/iter; left time: 1374.8655s
Epoch: 14 cost time: 15.542431116104126
Epoch: 14, Steps: 208 | Train Loss: 3.443 Vali Loss: 3.432 Vali Acc: 0.063 Test Loss: 3.432 Test Acc: 0.063
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 3.4172609
	speed: 0.2818s/iter; left time: 5012.6450s
	iters: 200, epoch: 15 | loss: 3.1737599
	speed: 0.1129s/iter; left time: 1996.7234s
Epoch: 15 cost time: 23.282809257507324
Epoch: 15, Steps: 208 | Train Loss: 3.420 Vali Loss: 3.496 Vali Acc: 0.070 Test Loss: 3.496 Test Acc: 0.070
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10617357590217716
model parameter : 7123531
model size : 32.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.2079692
	speed: 0.1317s/iter; left time: 2726.9713s
	iters: 200, epoch: 1 | loss: 4.0583057
	speed: 0.1226s/iter; left time: 2525.1463s
Epoch: 1 cost time: 26.398425102233887
Epoch: 1, Steps: 208 | Train Loss: 4.881 Vali Loss: 4.366 Vali Acc: 0.038 Test Loss: 4.366 Test Acc: 0.038
Validation loss decreased (inf --> -0.038131).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.0540395
	speed: 0.2909s/iter; left time: 5960.9882s
	iters: 200, epoch: 2 | loss: 3.7728868
	speed: 0.1176s/iter; left time: 2398.4172s
Epoch: 2 cost time: 24.41000533103943
Epoch: 2, Steps: 208 | Train Loss: 3.939 Vali Loss: 3.954 Vali Acc: 0.048 Test Loss: 3.954 Test Acc: 0.048
Validation loss decreased (-0.038131 --> -0.047977).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3982298
	speed: 0.2921s/iter; left time: 5925.1227s
	iters: 200, epoch: 3 | loss: 3.9332328
	speed: 0.1034s/iter; left time: 2086.5960s
Epoch: 3 cost time: 23.0405056476593
Epoch: 3, Steps: 208 | Train Loss: 3.794 Vali Loss: 3.698 Vali Acc: 0.067 Test Loss: 3.698 Test Acc: 0.067
Validation loss decreased (-0.047977 --> -0.067067).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.8230908
	speed: 0.3206s/iter; left time: 6436.8034s
	iters: 200, epoch: 4 | loss: 3.7281756
	speed: 0.1258s/iter; left time: 2513.1993s
Epoch: 4 cost time: 27.325700759887695
Epoch: 4, Steps: 208 | Train Loss: 3.584 Vali Loss: 3.633 Vali Acc: 0.089 Test Loss: 3.633 Test Acc: 0.089
Validation loss decreased (-0.067067 --> -0.089436).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.7541306
	speed: 0.3064s/iter; left time: 6087.1914s
	iters: 200, epoch: 5 | loss: 3.1366582
	speed: 0.1263s/iter; left time: 2497.3580s
Epoch: 5 cost time: 25.18255114555359
Epoch: 5, Steps: 208 | Train Loss: 3.361 Vali Loss: 3.542 Vali Acc: 0.073 Test Loss: 3.542 Test Acc: 0.073
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.5416920
	speed: 0.3048s/iter; left time: 5992.1342s
	iters: 200, epoch: 6 | loss: 2.9943891
	speed: 0.1287s/iter; left time: 2516.6004s
Epoch: 6 cost time: 26.979072332382202
Epoch: 6, Steps: 208 | Train Loss: 3.286 Vali Loss: 3.356 Vali Acc: 0.089 Test Loss: 3.356 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 3.2843533
	speed: 0.3082s/iter; left time: 5995.0725s
	iters: 200, epoch: 7 | loss: 3.4300675
	speed: 0.0957s/iter; left time: 1852.1853s
Epoch: 7 cost time: 22.835819959640503
Epoch: 7, Steps: 208 | Train Loss: 3.440 Vali Loss: 3.676 Vali Acc: 0.047 Test Loss: 3.676 Test Acc: 0.047
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 3.6105707
	speed: 0.2804s/iter; left time: 5396.0085s
	iters: 200, epoch: 8 | loss: 3.3718216
	speed: 0.1078s/iter; left time: 2062.9824s
Epoch: 8 cost time: 24.079471349716187
Epoch: 8, Steps: 208 | Train Loss: 3.472 Vali Loss: 3.591 Vali Acc: 0.059 Test Loss: 3.591 Test Acc: 0.059
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 3.6149144
	speed: 0.2813s/iter; left time: 5354.8031s
	iters: 200, epoch: 9 | loss: 3.4064124
	speed: 0.1237s/iter; left time: 2341.8088s
Epoch: 9 cost time: 25.70644783973694
Epoch: 9, Steps: 208 | Train Loss: 3.479 Vali Loss: 3.382 Vali Acc: 0.069 Test Loss: 3.382 Test Acc: 0.069
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 3.4710991
	speed: 0.2886s/iter; left time: 5433.9821s
	iters: 200, epoch: 10 | loss: 3.6623278
	speed: 0.1195s/iter; left time: 2237.3002s
Epoch: 10 cost time: 25.169514179229736
Epoch: 10, Steps: 208 | Train Loss: 3.403 Vali Loss: 3.614 Vali Acc: 0.047 Test Loss: 3.614 Test Acc: 0.047
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 2.8600008
	speed: 0.2871s/iter; left time: 5345.2251s
	iters: 200, epoch: 11 | loss: 3.3521810
	speed: 0.1047s/iter; left time: 1939.0088s
Epoch: 11 cost time: 22.90732479095459
Epoch: 11, Steps: 208 | Train Loss: 3.387 Vali Loss: 3.446 Vali Acc: 0.069 Test Loss: 3.446 Test Acc: 0.069
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 3.5078166
	speed: 0.2922s/iter; left time: 5379.8926s
	iters: 200, epoch: 12 | loss: 3.2127311
	speed: 0.1143s/iter; left time: 2093.5902s
Epoch: 12 cost time: 25.167241096496582
Epoch: 12, Steps: 208 | Train Loss: 3.406 Vali Loss: 3.401 Vali Acc: 0.072 Test Loss: 3.401 Test Acc: 0.072
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 3.2612281
	speed: 0.2797s/iter; left time: 5091.9091s
	iters: 200, epoch: 13 | loss: 3.6764352
	speed: 0.1168s/iter; left time: 2113.9713s
Epoch: 13 cost time: 22.835035800933838
Epoch: 13, Steps: 208 | Train Loss: 3.464 Vali Loss: 3.503 Vali Acc: 0.063 Test Loss: 3.503 Test Acc: 0.063
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 3.4779875
	speed: 0.2895s/iter; left time: 5210.0738s
	iters: 200, epoch: 14 | loss: 3.3487973
	speed: 0.1062s/iter; left time: 1900.8887s
Epoch: 14 cost time: 23.938602924346924
Epoch: 14, Steps: 208 | Train Loss: 3.460 Vali Loss: 3.483 Vali Acc: 0.059 Test Loss: 3.483 Test Acc: 0.059
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08947211452430659
model parameter : 7116107
model size : 32.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.0446649
	speed: 0.1477s/iter; left time: 3056.9791s
	iters: 200, epoch: 1 | loss: 4.5617137
	speed: 0.1084s/iter; left time: 2232.1620s
Epoch: 1 cost time: 26.727808713912964
Epoch: 1, Steps: 208 | Train Loss: 5.187 Vali Loss: 4.963 Vali Acc: 0.025 Test Loss: 4.963 Test Acc: 0.025
Validation loss decreased (inf --> -0.025301).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.5337238
	speed: 0.2961s/iter; left time: 6068.9236s
	iters: 200, epoch: 2 | loss: 4.1037431
	speed: 0.1189s/iter; left time: 2423.8027s
Epoch: 2 cost time: 24.947832345962524
Epoch: 2, Steps: 208 | Train Loss: 4.118 Vali Loss: 3.938 Vali Acc: 0.047 Test Loss: 3.938 Test Acc: 0.047
Validation loss decreased (-0.025301 --> -0.046486).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.8887022
	speed: 0.2915s/iter; left time: 5912.6519s
	iters: 200, epoch: 3 | loss: 4.4250460
	speed: 0.1285s/iter; left time: 2593.3525s
Epoch: 3 cost time: 25.43440341949463
Epoch: 3, Steps: 208 | Train Loss: 3.795 Vali Loss: 3.879 Vali Acc: 0.048 Test Loss: 3.879 Test Acc: 0.048
Validation loss decreased (-0.046486 --> -0.047978).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.7869139
	speed: 0.2893s/iter; left time: 5807.7504s
	iters: 200, epoch: 4 | loss: 2.9319098
	speed: 0.1140s/iter; left time: 2276.8691s
Epoch: 4 cost time: 24.42945694923401
Epoch: 4, Steps: 208 | Train Loss: 3.597 Vali Loss: 3.567 Vali Acc: 0.076 Test Loss: 3.567 Test Acc: 0.076
Validation loss decreased (-0.047978 --> -0.076314).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.9968476
	speed: 0.2723s/iter; left time: 5410.3245s
	iters: 200, epoch: 5 | loss: 4.0247712
	speed: 0.1130s/iter; left time: 2234.5468s
Epoch: 5 cost time: 22.901231288909912
Epoch: 5, Steps: 208 | Train Loss: 3.386 Vali Loss: 3.416 Vali Acc: 0.088 Test Loss: 3.416 Test Acc: 0.088
Validation loss decreased (-0.076314 --> -0.087947).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.9196095
	speed: 0.2779s/iter; left time: 5464.5691s
	iters: 200, epoch: 6 | loss: 3.2108755
	speed: 0.0977s/iter; left time: 1910.4432s
Epoch: 6 cost time: 22.234639167785645
Epoch: 6, Steps: 208 | Train Loss: 3.348 Vali Loss: 3.454 Vali Acc: 0.085 Test Loss: 3.454 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.6770635
	speed: 0.2036s/iter; left time: 3961.3485s
	iters: 200, epoch: 7 | loss: 3.2704375
	speed: 0.1205s/iter; left time: 2332.8577s
Epoch: 7 cost time: 20.570810317993164
Epoch: 7, Steps: 208 | Train Loss: 3.365 Vali Loss: 3.458 Vali Acc: 0.059 Test Loss: 3.458 Test Acc: 0.059
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.6940255
	speed: 0.2762s/iter; left time: 5316.2807s
	iters: 200, epoch: 8 | loss: 3.5732241
	speed: 0.1040s/iter; left time: 1990.5888s
Epoch: 8 cost time: 23.55487036705017
Epoch: 8, Steps: 208 | Train Loss: 3.406 Vali Loss: 3.449 Vali Acc: 0.065 Test Loss: 3.449 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 3.3772442
	speed: 0.2876s/iter; left time: 5474.4869s
	iters: 200, epoch: 9 | loss: 3.3823802
	speed: 0.1062s/iter; left time: 2010.8198s
Epoch: 9 cost time: 23.200846910476685
Epoch: 9, Steps: 208 | Train Loss: 3.435 Vali Loss: 3.382 Vali Acc: 0.070 Test Loss: 3.382 Test Acc: 0.070
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 3.2035370
	speed: 0.2877s/iter; left time: 5417.4020s
	iters: 200, epoch: 10 | loss: 3.5056305
	speed: 0.1060s/iter; left time: 1985.3839s
Epoch: 10 cost time: 24.601780891418457
Epoch: 10, Steps: 208 | Train Loss: 3.423 Vali Loss: 3.368 Vali Acc: 0.073 Test Loss: 3.368 Test Acc: 0.073
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 2.9783335
	speed: 0.2627s/iter; left time: 4892.5277s
	iters: 200, epoch: 11 | loss: 3.9461422
	speed: 0.1187s/iter; left time: 2198.6638s
Epoch: 11 cost time: 23.50995969772339
Epoch: 11, Steps: 208 | Train Loss: 3.396 Vali Loss: 3.519 Vali Acc: 0.055 Test Loss: 3.519 Test Acc: 0.055
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 3.6599751
	speed: 0.2831s/iter; left time: 5213.5103s
	iters: 200, epoch: 12 | loss: 3.7765756
	speed: 0.1137s/iter; left time: 2081.7035s
Epoch: 12 cost time: 25.077085733413696
Epoch: 12, Steps: 208 | Train Loss: 3.450 Vali Loss: 3.490 Vali Acc: 0.056 Test Loss: 3.490 Test Acc: 0.056
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 3.2959414
	speed: 0.2937s/iter; left time: 5346.0973s
	iters: 200, epoch: 13 | loss: 3.6145697
	speed: 0.1216s/iter; left time: 2200.6818s
Epoch: 13 cost time: 26.133321285247803
Epoch: 13, Steps: 208 | Train Loss: 3.436 Vali Loss: 3.520 Vali Acc: 0.048 Test Loss: 3.520 Test Acc: 0.048
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 3.4714503
	speed: 0.2917s/iter; left time: 5250.1579s
	iters: 200, epoch: 14 | loss: 3.3956120
	speed: 0.1057s/iter; left time: 1891.2773s
Epoch: 14 cost time: 23.86332416534424
Epoch: 14, Steps: 208 | Train Loss: 3.440 Vali Loss: 3.399 Vali Acc: 0.070 Test Loss: 3.399 Test Acc: 0.070
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 3.4302447
	speed: 0.2982s/iter; left time: 5304.2339s
	iters: 200, epoch: 15 | loss: 3.6308877
	speed: 0.1051s/iter; left time: 1859.3111s
Epoch: 15 cost time: 24.382322072982788
Epoch: 15, Steps: 208 | Train Loss: 3.396 Vali Loss: 3.417 Vali Acc: 0.072 Test Loss: 3.417 Test Acc: 0.072
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08798091261556815
model parameter : 7108683
model size : 32.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.6384239
	speed: 0.1389s/iter; left time: 2876.1199s
	iters: 200, epoch: 1 | loss: 3.8174400
	speed: 0.1207s/iter; left time: 2487.1619s
Epoch: 1 cost time: 27.203883409500122
Epoch: 1, Steps: 208 | Train Loss: 4.758 Vali Loss: 4.153 Vali Acc: 0.050 Test Loss: 4.153 Test Acc: 0.050
Validation loss decreased (inf --> -0.049466).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7335215
	speed: 0.2955s/iter; left time: 6054.9320s
	iters: 200, epoch: 2 | loss: 3.6320610
	speed: 0.1263s/iter; left time: 2574.7872s
Epoch: 2 cost time: 25.815939903259277
Epoch: 2, Steps: 208 | Train Loss: 3.918 Vali Loss: 3.700 Vali Acc: 0.044 Test Loss: 3.700 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.0739655
	speed: 0.2986s/iter; left time: 6057.2881s
	iters: 200, epoch: 3 | loss: 3.2001486
	speed: 0.1324s/iter; left time: 2673.2766s
Epoch: 3 cost time: 27.611401796340942
Epoch: 3, Steps: 208 | Train Loss: 3.709 Vali Loss: 3.695 Vali Acc: 0.058 Test Loss: 3.695 Test Acc: 0.058
Validation loss decreased (-0.049466 --> -0.058120).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.6187315
	speed: 0.3096s/iter; left time: 6214.9708s
	iters: 200, epoch: 4 | loss: 3.5746670
	speed: 0.1259s/iter; left time: 2514.1163s
Epoch: 4 cost time: 26.50558590888977
Epoch: 4, Steps: 208 | Train Loss: 3.468 Vali Loss: 3.578 Vali Acc: 0.081 Test Loss: 3.578 Test Acc: 0.081
Validation loss decreased (-0.058120 --> -0.081384).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.5045531
	speed: 0.2982s/iter; left time: 5924.1915s
	iters: 200, epoch: 5 | loss: 2.7226965
	speed: 0.1121s/iter; left time: 2216.1475s
Epoch: 5 cost time: 24.391842126846313
Epoch: 5, Steps: 208 | Train Loss: 3.315 Vali Loss: 3.644 Vali Acc: 0.075 Test Loss: 3.644 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.7149384
	speed: 0.2643s/iter; left time: 5196.9203s
	iters: 200, epoch: 6 | loss: 3.0270784
	speed: 0.1162s/iter; left time: 2272.6750s
Epoch: 6 cost time: 23.27500605583191
Epoch: 6, Steps: 208 | Train Loss: 3.237 Vali Loss: 3.297 Vali Acc: 0.081 Test Loss: 3.297 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 3.3163602
	speed: 0.2909s/iter; left time: 5659.0612s
	iters: 200, epoch: 7 | loss: 3.3887196
	speed: 0.1115s/iter; left time: 2157.8077s
Epoch: 7 cost time: 24.953868865966797
Epoch: 7, Steps: 208 | Train Loss: 3.302 Vali Loss: 3.464 Vali Acc: 0.062 Test Loss: 3.464 Test Acc: 0.062
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 3.2847879
	speed: 0.3092s/iter; left time: 5950.2421s
	iters: 200, epoch: 8 | loss: 3.4258339
	speed: 0.1423s/iter; left time: 2725.1281s
Epoch: 8 cost time: 27.132201671600342
Epoch: 8, Steps: 208 | Train Loss: 3.603 Vali Loss: 3.633 Vali Acc: 0.044 Test Loss: 3.633 Test Acc: 0.044
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 3.3712258
	speed: 0.3059s/iter; left time: 5822.9741s
	iters: 200, epoch: 9 | loss: 3.5875239
	speed: 0.1291s/iter; left time: 2444.3738s
Epoch: 9 cost time: 26.209840059280396
Epoch: 9, Steps: 208 | Train Loss: 3.558 Vali Loss: 3.608 Vali Acc: 0.052 Test Loss: 3.608 Test Acc: 0.052
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 3.1541233
	speed: 0.3137s/iter; left time: 5906.9174s
	iters: 200, epoch: 10 | loss: 3.9797535
	speed: 0.1218s/iter; left time: 2280.4659s
Epoch: 10 cost time: 26.538279056549072
Epoch: 10, Steps: 208 | Train Loss: 3.542 Vali Loss: 3.531 Vali Acc: 0.047 Test Loss: 3.531 Test Acc: 0.047
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 3.5747416
	speed: 0.3058s/iter; left time: 5694.4903s
	iters: 200, epoch: 11 | loss: 3.7780223
	speed: 0.1215s/iter; left time: 2250.0080s
Epoch: 11 cost time: 26.307266235351562
Epoch: 11, Steps: 208 | Train Loss: 3.495 Vali Loss: 3.622 Vali Acc: 0.035 Test Loss: 3.622 Test Acc: 0.035
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 3.6933186
	speed: 0.2857s/iter; left time: 5261.1431s
	iters: 200, epoch: 12 | loss: 3.5032904
	speed: 0.1139s/iter; left time: 2086.1123s
Epoch: 12 cost time: 24.8657808303833
Epoch: 12, Steps: 208 | Train Loss: 3.461 Vali Loss: 3.509 Vali Acc: 0.063 Test Loss: 3.509 Test Acc: 0.063
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 3.4425502
	speed: 0.2323s/iter; left time: 4228.6753s
	iters: 200, epoch: 13 | loss: 3.2268548
	speed: 0.0867s/iter; left time: 1570.0391s
Epoch: 13 cost time: 17.294704914093018
Epoch: 13, Steps: 208 | Train Loss: 3.500 Vali Loss: 3.595 Vali Acc: 0.060 Test Loss: 3.595 Test Acc: 0.060
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 3.2775285
	speed: 0.2880s/iter; left time: 5182.4479s
	iters: 200, epoch: 14 | loss: 3.2979820
	speed: 0.1268s/iter; left time: 2268.8250s
Epoch: 14 cost time: 25.388431310653687
Epoch: 14, Steps: 208 | Train Loss: 3.502 Vali Loss: 3.581 Vali Acc: 0.044 Test Loss: 3.581 Test Acc: 0.044
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.081419624217119
model parameter : 6802635
model size : 30.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 7.2010250
	speed: 0.1157s/iter; left time: 2395.7137s
	iters: 200, epoch: 1 | loss: 4.8636875
	speed: 0.1079s/iter; left time: 2223.2561s
Epoch: 1 cost time: 23.37867283821106
Epoch: 1, Steps: 208 | Train Loss: 5.083 Vali Loss: 4.903 Vali Acc: 0.046 Test Loss: 4.903 Test Acc: 0.046
Validation loss decreased (inf --> -0.045880).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.2157249
	speed: 0.2675s/iter; left time: 5481.7776s
	iters: 200, epoch: 2 | loss: 3.5620747
	speed: 0.1114s/iter; left time: 2272.0050s
Epoch: 2 cost time: 22.549187660217285
Epoch: 2, Steps: 208 | Train Loss: 4.014 Vali Loss: 3.826 Vali Acc: 0.062 Test Loss: 3.826 Test Acc: 0.062
Validation loss decreased (-0.045880 --> -0.062294).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6887665
	speed: 0.2802s/iter; left time: 5683.2919s
	iters: 200, epoch: 3 | loss: 3.7859266
	speed: 0.1033s/iter; left time: 2086.0458s
Epoch: 3 cost time: 22.14306879043579
Epoch: 3, Steps: 208 | Train Loss: 3.712 Vali Loss: 3.538 Vali Acc: 0.087 Test Loss: 3.538 Test Acc: 0.087
Validation loss decreased (-0.062294 --> -0.086753).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.5466261
	speed: 0.2794s/iter; left time: 5609.7771s
	iters: 200, epoch: 4 | loss: 3.3546376
	speed: 0.1041s/iter; left time: 2080.3352s
Epoch: 4 cost time: 22.425776720046997
Epoch: 4, Steps: 208 | Train Loss: 3.441 Vali Loss: 3.512 Vali Acc: 0.090 Test Loss: 3.512 Test Acc: 0.090
Validation loss decreased (-0.086753 --> -0.090033).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.4567769
	speed: 0.2866s/iter; left time: 5694.9457s
	iters: 200, epoch: 5 | loss: 3.2920871
	speed: 0.1195s/iter; left time: 2363.2694s
Epoch: 5 cost time: 24.23525643348694
Epoch: 5, Steps: 208 | Train Loss: 3.277 Vali Loss: 3.382 Vali Acc: 0.106 Test Loss: 3.382 Test Acc: 0.106
Validation loss decreased (-0.090033 --> -0.106140).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.7048373
	speed: 0.3025s/iter; left time: 5947.4697s
	iters: 200, epoch: 6 | loss: 3.0450749
	speed: 0.1037s/iter; left time: 2028.2112s
Epoch: 6 cost time: 24.33033776283264
Epoch: 6, Steps: 208 | Train Loss: 3.161 Vali Loss: 3.374 Vali Acc: 0.103 Test Loss: 3.374 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.0933454
	speed: 0.2890s/iter; left time: 5622.2836s
	iters: 200, epoch: 7 | loss: 3.3688982
	speed: 0.1013s/iter; left time: 1960.5567s
Epoch: 7 cost time: 22.654091596603394
Epoch: 7, Steps: 208 | Train Loss: 3.147 Vali Loss: 3.423 Vali Acc: 0.077 Test Loss: 3.423 Test Acc: 0.077
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.3675978
	speed: 0.2620s/iter; left time: 5042.6193s
	iters: 200, epoch: 8 | loss: 3.3689418
	speed: 0.1146s/iter; left time: 2193.2771s
Epoch: 8 cost time: 22.483813285827637
Epoch: 8, Steps: 208 | Train Loss: 3.300 Vali Loss: 3.379 Vali Acc: 0.073 Test Loss: 3.379 Test Acc: 0.073
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 3.1256442
	speed: 0.2657s/iter; left time: 5058.0033s
	iters: 200, epoch: 9 | loss: 3.1336555
	speed: 0.0965s/iter; left time: 1826.8132s
Epoch: 9 cost time: 21.710882663726807
Epoch: 9, Steps: 208 | Train Loss: 3.326 Vali Loss: 3.482 Vali Acc: 0.067 Test Loss: 3.482 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 3.1735208
	speed: 0.2772s/iter; left time: 5218.9775s
	iters: 200, epoch: 10 | loss: 2.9705787
	speed: 0.1010s/iter; left time: 1892.3396s
Epoch: 10 cost time: 21.62103271484375
Epoch: 10, Steps: 208 | Train Loss: 3.353 Vali Loss: 3.448 Vali Acc: 0.071 Test Loss: 3.448 Test Acc: 0.071
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 3.5302184
	speed: 0.2636s/iter; left time: 4909.3992s
	iters: 200, epoch: 11 | loss: 3.4152634
	speed: 0.1186s/iter; left time: 2197.1117s
Epoch: 11 cost time: 23.155107021331787
Epoch: 11, Steps: 208 | Train Loss: 3.326 Vali Loss: 3.329 Vali Acc: 0.081 Test Loss: 3.329 Test Acc: 0.081
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 3.2549458
	speed: 0.2663s/iter; left time: 4902.8493s
	iters: 200, epoch: 12 | loss: 3.7879395
	speed: 0.0979s/iter; left time: 1792.5971s
Epoch: 12 cost time: 21.731743097305298
Epoch: 12, Steps: 208 | Train Loss: 3.345 Vali Loss: 3.402 Vali Acc: 0.077 Test Loss: 3.402 Test Acc: 0.077
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 3.2784221
	speed: 0.2746s/iter; left time: 4999.9243s
	iters: 200, epoch: 13 | loss: 3.7321892
	speed: 0.1049s/iter; left time: 1899.3633s
Epoch: 13 cost time: 22.47407102584839
Epoch: 13, Steps: 208 | Train Loss: 3.429 Vali Loss: 3.543 Vali Acc: 0.057 Test Loss: 3.543 Test Acc: 0.057
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 3.4786029
	speed: 0.2640s/iter; left time: 4751.8400s
	iters: 200, epoch: 14 | loss: 3.1049805
	speed: 0.1140s/iter; left time: 2039.5890s
Epoch: 14 cost time: 23.15823721885681
Epoch: 14, Steps: 208 | Train Loss: 3.413 Vali Loss: 3.432 Vali Acc: 0.064 Test Loss: 3.432 Test Acc: 0.064
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 3.4057848
	speed: 0.2706s/iter; left time: 4814.3999s
	iters: 200, epoch: 15 | loss: 3.4329467
	speed: 0.1002s/iter; left time: 1772.6039s
Epoch: 15 cost time: 21.682984828948975
Epoch: 15, Steps: 208 | Train Loss: 3.362 Vali Loss: 3.460 Vali Acc: 0.073 Test Loss: 3.460 Test Acc: 0.073
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10617357590217716
model parameter : 6795211
model size : 30.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.6883540
	speed: 0.1360s/iter; left time: 2816.2372s
	iters: 200, epoch: 1 | loss: 3.9645038
	speed: 0.1034s/iter; left time: 2129.1206s
Epoch: 1 cost time: 25.119991540908813
Epoch: 1, Steps: 208 | Train Loss: 4.708 Vali Loss: 4.237 Vali Acc: 0.033 Test Loss: 4.237 Test Acc: 0.033
Validation loss decreased (inf --> -0.032764).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.4961667
	speed: 0.2873s/iter; left time: 5887.8329s
	iters: 200, epoch: 2 | loss: 3.9804127
	speed: 0.1206s/iter; left time: 2459.9627s
Epoch: 2 cost time: 24.67664861679077
Epoch: 2, Steps: 208 | Train Loss: 3.988 Vali Loss: 3.779 Vali Acc: 0.046 Test Loss: 3.779 Test Acc: 0.046
Validation loss decreased (-0.032764 --> -0.045593).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6240113
	speed: 0.2838s/iter; left time: 5757.5892s
	iters: 200, epoch: 3 | loss: 3.0917647
	speed: 0.0955s/iter; left time: 1927.6879s
Epoch: 3 cost time: 21.630526542663574
Epoch: 3, Steps: 208 | Train Loss: 3.755 Vali Loss: 3.938 Vali Acc: 0.067 Test Loss: 3.938 Test Acc: 0.067
Validation loss decreased (-0.045593 --> -0.066468).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4988072
	speed: 0.2709s/iter; left time: 5439.5091s
	iters: 200, epoch: 4 | loss: 3.9350436
	speed: 0.0995s/iter; left time: 1988.1257s
Epoch: 4 cost time: 21.536749839782715
Epoch: 4, Steps: 208 | Train Loss: 3.536 Vali Loss: 3.374 Vali Acc: 0.094 Test Loss: 3.374 Test Acc: 0.094
Validation loss decreased (-0.066468 --> -0.094210).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.6641588
	speed: 0.2692s/iter; left time: 5347.9635s
	iters: 200, epoch: 5 | loss: 3.2811251
	speed: 0.1080s/iter; left time: 2135.1671s
Epoch: 5 cost time: 23.189958810806274
Epoch: 5, Steps: 208 | Train Loss: 3.343 Vali Loss: 3.393 Vali Acc: 0.099 Test Loss: 3.393 Test Acc: 0.099
Validation loss decreased (-0.094210 --> -0.098684).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2722459
	speed: 0.2283s/iter; left time: 4487.6538s
	iters: 200, epoch: 6 | loss: 3.3951480
	speed: 0.0489s/iter; left time: 956.3353s
Epoch: 6 cost time: 12.563307523727417
Epoch: 6, Steps: 208 | Train Loss: 3.257 Vali Loss: 3.432 Vali Acc: 0.084 Test Loss: 3.432 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.3055096
	speed: 0.2087s/iter; left time: 4060.2375s
	iters: 200, epoch: 7 | loss: 3.5307832
	speed: 0.0738s/iter; left time: 1427.4524s
Epoch: 7 cost time: 17.058177709579468
Epoch: 7, Steps: 208 | Train Loss: 3.377 Vali Loss: 3.556 Vali Acc: 0.055 Test Loss: 3.556 Test Acc: 0.055
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.9781590
	speed: 0.2614s/iter; left time: 5030.9231s
	iters: 200, epoch: 8 | loss: 3.5836289
	speed: 0.1144s/iter; left time: 2189.9938s
Epoch: 8 cost time: 23.756421089172363
Epoch: 8, Steps: 208 | Train Loss: 3.445 Vali Loss: 3.469 Vali Acc: 0.059 Test Loss: 3.469 Test Acc: 0.059
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 3.6003773
	speed: 0.2713s/iter; left time: 5164.5735s
	iters: 200, epoch: 9 | loss: 3.3637266
	speed: 0.0993s/iter; left time: 1880.0771s
Epoch: 9 cost time: 22.188019514083862
Epoch: 9, Steps: 208 | Train Loss: 3.368 Vali Loss: 3.342 Vali Acc: 0.091 Test Loss: 3.342 Test Acc: 0.091
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 3.3212764
	speed: 0.2572s/iter; left time: 4843.1951s
	iters: 200, epoch: 10 | loss: 3.2383132
	speed: 0.1040s/iter; left time: 1948.6186s
Epoch: 10 cost time: 21.83744740486145
Epoch: 10, Steps: 208 | Train Loss: 3.366 Vali Loss: 3.353 Vali Acc: 0.068 Test Loss: 3.353 Test Acc: 0.068
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 3.2385392
	speed: 0.2708s/iter; left time: 5042.4426s
	iters: 200, epoch: 11 | loss: 3.5567715
	speed: 0.1152s/iter; left time: 2133.3309s
Epoch: 11 cost time: 23.133463621139526
Epoch: 11, Steps: 208 | Train Loss: 3.379 Vali Loss: 3.531 Vali Acc: 0.058 Test Loss: 3.531 Test Acc: 0.058
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 3.2478180
	speed: 0.2873s/iter; left time: 5290.2158s
	iters: 200, epoch: 12 | loss: 3.4704418
	speed: 0.1086s/iter; left time: 1989.2398s
Epoch: 12 cost time: 23.90148663520813
Epoch: 12, Steps: 208 | Train Loss: 3.390 Vali Loss: 3.417 Vali Acc: 0.066 Test Loss: 3.417 Test Acc: 0.066
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 3.3525436
	speed: 0.2908s/iter; left time: 5293.8177s
	iters: 200, epoch: 13 | loss: 3.2923794
	speed: 0.1093s/iter; left time: 1978.5176s
Epoch: 13 cost time: 22.78924870491028
Epoch: 13, Steps: 208 | Train Loss: 3.362 Vali Loss: 3.475 Vali Acc: 0.070 Test Loss: 3.475 Test Acc: 0.070
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 3.5655398
	speed: 0.2863s/iter; left time: 5152.4320s
	iters: 200, epoch: 14 | loss: 3.2967534
	speed: 0.1190s/iter; left time: 2128.8720s
Epoch: 14 cost time: 24.390767812728882
Epoch: 14, Steps: 208 | Train Loss: 3.348 Vali Loss: 3.392 Vali Acc: 0.069 Test Loss: 3.392 Test Acc: 0.069
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 3.2916386
	speed: 0.3032s/iter; left time: 5393.5810s
	iters: 200, epoch: 15 | loss: 3.2033498
	speed: 0.1114s/iter; left time: 1971.4277s
Epoch: 15 cost time: 25.817261457443237
Epoch: 15, Steps: 208 | Train Loss: 3.352 Vali Loss: 3.451 Vali Acc: 0.073 Test Loss: 3.451 Test Acc: 0.073
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09871756635848494
model parameter : 6787787
model size : 30.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.6346035
	speed: 0.1209s/iter; left time: 2502.8951s
	iters: 200, epoch: 1 | loss: 3.6604967
	speed: 0.1070s/iter; left time: 2204.1316s
Epoch: 1 cost time: 23.572392225265503
Epoch: 1, Steps: 208 | Train Loss: 4.623 Vali Loss: 3.909 Vali Acc: 0.055 Test Loss: 3.909 Test Acc: 0.055
Validation loss decreased (inf --> -0.054837).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.1510196
	speed: 0.2444s/iter; left time: 5009.1223s
	iters: 200, epoch: 2 | loss: 4.2790270
	speed: 0.0912s/iter; left time: 1860.5750s
Epoch: 2 cost time: 19.909305095672607
Epoch: 2, Steps: 208 | Train Loss: 3.887 Vali Loss: 3.896 Vali Acc: 0.045 Test Loss: 3.896 Test Acc: 0.045
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.9855709
	speed: 0.2546s/iter; left time: 5164.1653s
	iters: 200, epoch: 3 | loss: 3.6794395
	speed: 0.1043s/iter; left time: 2105.9418s
Epoch: 3 cost time: 21.74137783050537
Epoch: 3, Steps: 208 | Train Loss: 3.769 Vali Loss: 3.937 Vali Acc: 0.033 Test Loss: 3.937 Test Acc: 0.033
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 3.3933654
	speed: 0.2429s/iter; left time: 4876.8207s
	iters: 200, epoch: 4 | loss: 3.7153239
	speed: 0.1043s/iter; left time: 2084.3818s
Epoch: 4 cost time: 21.362836837768555
Epoch: 4, Steps: 208 | Train Loss: 3.586 Vali Loss: 3.615 Vali Acc: 0.068 Test Loss: 3.615 Test Acc: 0.068
Validation loss decreased (-0.054837 --> -0.067664).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3301187
	speed: 0.2639s/iter; left time: 5242.4392s
	iters: 200, epoch: 5 | loss: 2.6451504
	speed: 0.0991s/iter; left time: 1958.6634s
Epoch: 5 cost time: 21.702102184295654
Epoch: 5, Steps: 208 | Train Loss: 3.336 Vali Loss: 3.554 Vali Acc: 0.081 Test Loss: 3.554 Test Acc: 0.081
Validation loss decreased (-0.067664 --> -0.080788).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.4096296
	speed: 0.2453s/iter; left time: 4823.0110s
	iters: 200, epoch: 6 | loss: 3.2080450
	speed: 0.0959s/iter; left time: 1874.9959s
Epoch: 6 cost time: 19.79346466064453
Epoch: 6, Steps: 208 | Train Loss: 3.252 Vali Loss: 3.389 Vali Acc: 0.073 Test Loss: 3.389 Test Acc: 0.073
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.3082509
	speed: 0.2558s/iter; left time: 4975.1918s
	iters: 200, epoch: 7 | loss: 3.4083934
	speed: 0.0984s/iter; left time: 1903.9429s
Epoch: 7 cost time: 21.641322374343872
Epoch: 7, Steps: 208 | Train Loss: 3.338 Vali Loss: 3.414 Vali Acc: 0.062 Test Loss: 3.414 Test Acc: 0.062
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.9125729
	speed: 0.2388s/iter; left time: 4595.9269s
	iters: 200, epoch: 8 | loss: 3.5239289
	speed: 0.1056s/iter; left time: 2021.8163s
Epoch: 8 cost time: 20.70298671722412
Epoch: 8, Steps: 208 | Train Loss: 3.383 Vali Loss: 3.348 Vali Acc: 0.081 Test Loss: 3.348 Test Acc: 0.081
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 3.4484637
	speed: 0.2580s/iter; left time: 4910.6705s
	iters: 200, epoch: 9 | loss: 3.7146664
	speed: 0.1001s/iter; left time: 1895.6236s
Epoch: 9 cost time: 22.665691137313843
Epoch: 9, Steps: 208 | Train Loss: 3.344 Vali Loss: 3.451 Vali Acc: 0.057 Test Loss: 3.451 Test Acc: 0.057
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 2.6547904
	speed: 0.2491s/iter; left time: 4690.0410s
	iters: 200, epoch: 10 | loss: 3.6319063
	speed: 0.0830s/iter; left time: 1554.8395s
Epoch: 10 cost time: 18.031805992126465
Epoch: 10, Steps: 208 | Train Loss: 3.336 Vali Loss: 3.316 Vali Acc: 0.075 Test Loss: 3.316 Test Acc: 0.075
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 3.3207529
	speed: 0.2016s/iter; left time: 3753.7295s
	iters: 200, epoch: 11 | loss: 3.6010318
	speed: 0.1155s/iter; left time: 2140.0037s
Epoch: 11 cost time: 19.29253840446472
Epoch: 11, Steps: 208 | Train Loss: 3.267 Vali Loss: 3.354 Vali Acc: 0.077 Test Loss: 3.354 Test Acc: 0.077
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 3.3048484
	speed: 0.2848s/iter; left time: 5243.8728s
	iters: 200, epoch: 12 | loss: 3.0916727
	speed: 0.1076s/iter; left time: 1970.9067s
Epoch: 12 cost time: 24.653043031692505
Epoch: 12, Steps: 208 | Train Loss: 3.328 Vali Loss: 3.357 Vali Acc: 0.069 Test Loss: 3.357 Test Acc: 0.069
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 3.0185628
	speed: 0.2883s/iter; left time: 5248.6213s
	iters: 200, epoch: 13 | loss: 3.4447970
	speed: 0.0964s/iter; left time: 1745.4411s
Epoch: 13 cost time: 22.540099620819092
Epoch: 13, Steps: 208 | Train Loss: 3.313 Vali Loss: 3.308 Vali Acc: 0.081 Test Loss: 3.308 Test Acc: 0.081
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 3.1800301
	speed: 0.2527s/iter; left time: 4547.2454s
	iters: 200, epoch: 14 | loss: 3.7704320
	speed: 0.1100s/iter; left time: 1968.1771s
Epoch: 14 cost time: 22.415332794189453
Epoch: 14, Steps: 208 | Train Loss: 3.318 Vali Loss: 3.341 Vali Acc: 0.072 Test Loss: 3.341 Test Acc: 0.072
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 3.0401132
	speed: 0.2621s/iter; left time: 4661.8986s
	iters: 200, epoch: 15 | loss: 3.5635440
	speed: 0.1047s/iter; left time: 1851.3925s
Epoch: 15 cost time: 22.52362370491028
Epoch: 15, Steps: 208 | Train Loss: 3.297 Vali Loss: 3.346 Vali Acc: 0.073 Test Loss: 3.346 Test Acc: 0.073
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08082314345362362
model parameter : 6780363
model size : 30.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1891012
	speed: 0.1300s/iter; left time: 2690.2950s
	iters: 200, epoch: 1 | loss: 4.2057452
	speed: 0.1128s/iter; left time: 2324.1401s
Epoch: 1 cost time: 24.86057996749878
Epoch: 1, Steps: 208 | Train Loss: 4.113 Vali Loss: 3.819 Vali Acc: 0.050 Test Loss: 3.819 Test Acc: 0.050
Validation loss decreased (inf --> -0.050066).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5185394
	speed: 0.2567s/iter; left time: 5259.6495s
	iters: 200, epoch: 2 | loss: 3.7590790
	speed: 0.1255s/iter; left time: 2558.4909s
Epoch: 2 cost time: 24.605774402618408
Epoch: 2, Steps: 208 | Train Loss: 3.748 Vali Loss: 3.732 Vali Acc: 0.040 Test Loss: 3.732 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.2198339
	speed: 0.2707s/iter; left time: 5491.9649s
	iters: 200, epoch: 3 | loss: 3.7395396
	speed: 0.1059s/iter; left time: 2137.2306s
Epoch: 3 cost time: 24.45172643661499
Epoch: 3, Steps: 208 | Train Loss: 3.698 Vali Loss: 3.797 Vali Acc: 0.051 Test Loss: 3.797 Test Acc: 0.051
Validation loss decreased (-0.050066 --> -0.050961).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4025679
	speed: 0.2658s/iter; left time: 5335.5573s
	iters: 200, epoch: 4 | loss: 3.3904643
	speed: 0.1041s/iter; left time: 2080.2816s
Epoch: 4 cost time: 23.50757622718811
Epoch: 4, Steps: 208 | Train Loss: 3.520 Vali Loss: 3.630 Vali Acc: 0.080 Test Loss: 3.630 Test Acc: 0.080
Validation loss decreased (-0.050961 --> -0.079594).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2245789
	speed: 0.2760s/iter; left time: 5484.4861s
	iters: 200, epoch: 5 | loss: 3.1166630
	speed: 0.0892s/iter; left time: 1763.9019s
Epoch: 5 cost time: 21.04108476638794
Epoch: 5, Steps: 208 | Train Loss: 3.349 Vali Loss: 3.337 Vali Acc: 0.083 Test Loss: 3.337 Test Acc: 0.083
Validation loss decreased (-0.079594 --> -0.082579).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.7729633
	speed: 0.2351s/iter; left time: 4621.7003s
	iters: 200, epoch: 6 | loss: 3.5681453
	speed: 0.1262s/iter; left time: 2467.6870s
Epoch: 6 cost time: 24.006566524505615
Epoch: 6, Steps: 208 | Train Loss: 3.221 Vali Loss: 3.309 Vali Acc: 0.089 Test Loss: 3.309 Test Acc: 0.089
Validation loss decreased (-0.082579 --> -0.089141).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.6714830
	speed: 0.2850s/iter; left time: 5543.8201s
	iters: 200, epoch: 7 | loss: 3.0318377
	speed: 0.1302s/iter; left time: 2519.1095s
Epoch: 7 cost time: 26.219435214996338
Epoch: 7, Steps: 208 | Train Loss: 3.072 Vali Loss: 3.242 Vali Acc: 0.105 Test Loss: 3.242 Test Acc: 0.105
Validation loss decreased (-0.089141 --> -0.104948).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.0381856
	speed: 0.2947s/iter; left time: 5672.2856s
	iters: 200, epoch: 8 | loss: 2.9902205
	speed: 0.1346s/iter; left time: 2577.7316s
Epoch: 8 cost time: 28.128689765930176
Epoch: 8, Steps: 208 | Train Loss: 2.873 Vali Loss: 3.121 Vali Acc: 0.120 Test Loss: 3.121 Test Acc: 0.120
Validation loss decreased (-0.104948 --> -0.120160).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.8485954
	speed: 0.2962s/iter; left time: 5638.7818s
	iters: 200, epoch: 9 | loss: 2.6914589
	speed: 0.0993s/iter; left time: 1880.2031s
Epoch: 9 cost time: 24.452855825424194
Epoch: 9, Steps: 208 | Train Loss: 2.652 Vali Loss: 3.070 Vali Acc: 0.131 Test Loss: 3.070 Test Acc: 0.131
Validation loss decreased (-0.120160 --> -0.131195).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.4699707
	speed: 0.2721s/iter; left time: 5122.8369s
	iters: 200, epoch: 10 | loss: 2.7239358
	speed: 0.1028s/iter; left time: 1925.4391s
Epoch: 10 cost time: 23.668020248413086
Epoch: 10, Steps: 208 | Train Loss: 2.440 Vali Loss: 3.112 Vali Acc: 0.141 Test Loss: 3.112 Test Acc: 0.141
Validation loss decreased (-0.131195 --> -0.141335).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.2776978
	speed: 0.2727s/iter; left time: 5077.8132s
	iters: 200, epoch: 11 | loss: 2.0617466
	speed: 0.1216s/iter; left time: 2252.9260s
Epoch: 11 cost time: 25.09996247291565
Epoch: 11, Steps: 208 | Train Loss: 2.267 Vali Loss: 3.252 Vali Acc: 0.139 Test Loss: 3.252 Test Acc: 0.139
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.1241264
	speed: 0.2106s/iter; left time: 3877.2734s
	iters: 200, epoch: 12 | loss: 2.2413669
	speed: 0.0601s/iter; left time: 1101.0913s
Epoch: 12 cost time: 12.970893383026123
Epoch: 12, Steps: 208 | Train Loss: 2.040 Vali Loss: 3.418 Vali Acc: 0.135 Test Loss: 3.418 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 2.1757915
	speed: 0.2476s/iter; left time: 4508.0814s
	iters: 200, epoch: 13 | loss: 1.7403902
	speed: 0.1133s/iter; left time: 2050.5669s
Epoch: 13 cost time: 24.937503814697266
Epoch: 13, Steps: 208 | Train Loss: 1.827 Vali Loss: 3.572 Vali Acc: 0.132 Test Loss: 3.572 Test Acc: 0.132
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.0986241
	speed: 0.2778s/iter; left time: 4998.8679s
	iters: 200, epoch: 14 | loss: 2.1024978
	speed: 0.1207s/iter; left time: 2160.1553s
Epoch: 14 cost time: 25.189090251922607
Epoch: 14, Steps: 208 | Train Loss: 1.672 Vali Loss: 3.802 Vali Acc: 0.120 Test Loss: 3.802 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.4315718
	speed: 0.2653s/iter; left time: 4719.8307s
	iters: 200, epoch: 15 | loss: 1.6565516
	speed: 0.1140s/iter; left time: 2016.3782s
Epoch: 15 cost time: 24.71732473373413
Epoch: 15, Steps: 208 | Train Loss: 1.519 Vali Loss: 4.062 Vali Acc: 0.131 Test Loss: 4.062 Test Acc: 0.131
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.8117462
	speed: 0.2671s/iter; left time: 4696.4881s
	iters: 200, epoch: 16 | loss: 1.0661201
	speed: 0.1160s/iter; left time: 2028.2712s
Epoch: 16 cost time: 24.664735078811646
Epoch: 16, Steps: 208 | Train Loss: 1.368 Vali Loss: 4.373 Vali Acc: 0.121 Test Loss: 4.373 Test Acc: 0.121
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.5756565
	speed: 0.3124s/iter; left time: 5427.8956s
	iters: 200, epoch: 17 | loss: 1.5546241
	speed: 0.1220s/iter; left time: 2106.6457s
Epoch: 17 cost time: 28.46005630493164
Epoch: 17, Steps: 208 | Train Loss: 1.246 Vali Loss: 4.209 Vali Acc: 0.131 Test Loss: 4.209 Test Acc: 0.131
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.8456674
	speed: 0.2879s/iter; left time: 4941.6284s
	iters: 200, epoch: 18 | loss: 1.6524494
	speed: 0.1073s/iter; left time: 1831.7852s
Epoch: 18 cost time: 25.05985927581787
Epoch: 18, Steps: 208 | Train Loss: 1.146 Vali Loss: 4.950 Vali Acc: 0.129 Test Loss: 4.950 Test Acc: 0.129
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.8841230
	speed: 0.2960s/iter; left time: 5019.8514s
	iters: 200, epoch: 19 | loss: 1.2251325
	speed: 0.1247s/iter; left time: 2101.6407s
Epoch: 19 cost time: 26.94337010383606
Epoch: 19, Steps: 208 | Train Loss: 1.067 Vali Loss: 4.946 Vali Acc: 0.128 Test Loss: 4.946 Test Acc: 0.128
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.2582389
	speed: 0.2871s/iter; left time: 4808.0938s
	iters: 200, epoch: 20 | loss: 1.3835903
	speed: 0.1225s/iter; left time: 2039.2623s
Epoch: 20 cost time: 26.287687301635742
Epoch: 20, Steps: 208 | Train Loss: 1.001 Vali Loss: 4.965 Vali Acc: 0.120 Test Loss: 4.965 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1413659409484044
model parameter : 3242315
model size : 14.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.8074369
	speed: 0.1117s/iter; left time: 2311.9087s
	iters: 200, epoch: 1 | loss: 4.0041308
	speed: 0.0895s/iter; left time: 1843.1592s
Epoch: 1 cost time: 21.129559755325317
Epoch: 1, Steps: 208 | Train Loss: 4.312 Vali Loss: 3.962 Vali Acc: 0.047 Test Loss: 3.962 Test Acc: 0.047
Validation loss decreased (inf --> -0.046486).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.0442982
	speed: 0.2651s/iter; left time: 5433.0167s
	iters: 200, epoch: 2 | loss: 4.0642900
	speed: 0.1174s/iter; left time: 2393.4543s
Epoch: 2 cost time: 23.78800344467163
Epoch: 2, Steps: 208 | Train Loss: 3.769 Vali Loss: 3.805 Vali Acc: 0.047 Test Loss: 3.805 Test Acc: 0.047
Validation loss decreased (-0.046486 --> -0.047084).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.8677151
	speed: 0.2578s/iter; left time: 5229.6709s
	iters: 200, epoch: 3 | loss: 3.6442223
	speed: 0.1078s/iter; left time: 2175.3218s
Epoch: 3 cost time: 22.292214155197144
Epoch: 3, Steps: 208 | Train Loss: 3.652 Vali Loss: 3.628 Vali Acc: 0.057 Test Loss: 3.628 Test Acc: 0.057
Validation loss decreased (-0.047084 --> -0.056629).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.5404551
	speed: 0.2626s/iter; left time: 5271.9247s
	iters: 200, epoch: 4 | loss: 3.7527444
	speed: 0.0928s/iter; left time: 1853.1363s
Epoch: 4 cost time: 21.912171125411987
Epoch: 4, Steps: 208 | Train Loss: 3.508 Vali Loss: 3.876 Vali Acc: 0.036 Test Loss: 3.876 Test Acc: 0.036
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.9094357
	speed: 0.2778s/iter; left time: 5519.3572s
	iters: 200, epoch: 5 | loss: 3.1549480
	speed: 0.1133s/iter; left time: 2239.5084s
Epoch: 5 cost time: 23.783211708068848
Epoch: 5, Steps: 208 | Train Loss: 3.284 Vali Loss: 3.395 Vali Acc: 0.079 Test Loss: 3.395 Test Acc: 0.079
Validation loss decreased (-0.056629 --> -0.078702).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.3003893
	speed: 0.2528s/iter; left time: 4970.9402s
	iters: 200, epoch: 6 | loss: 2.7346466
	speed: 0.0989s/iter; left time: 1933.8315s
Epoch: 6 cost time: 21.495601177215576
Epoch: 6, Steps: 208 | Train Loss: 3.143 Vali Loss: 3.218 Vali Acc: 0.101 Test Loss: 3.218 Test Acc: 0.101
Validation loss decreased (-0.078702 --> -0.100475).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9299698
	speed: 0.2654s/iter; left time: 5162.4001s
	iters: 200, epoch: 7 | loss: 3.3736072
	speed: 0.1001s/iter; left time: 1938.1010s
Epoch: 7 cost time: 22.244161367416382
Epoch: 7, Steps: 208 | Train Loss: 3.019 Vali Loss: 3.092 Vali Acc: 0.123 Test Loss: 3.092 Test Acc: 0.123
Validation loss decreased (-0.100475 --> -0.122844).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.7600133
	speed: 0.2198s/iter; left time: 4230.2796s
	iters: 200, epoch: 8 | loss: 3.1088393
	speed: 0.0553s/iter; left time: 1057.8579s
Epoch: 8 cost time: 12.665074825286865
Epoch: 8, Steps: 208 | Train Loss: 2.830 Vali Loss: 3.135 Vali Acc: 0.108 Test Loss: 3.135 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.4349442
	speed: 0.2829s/iter; left time: 5385.0552s
	iters: 200, epoch: 9 | loss: 2.7399166
	speed: 0.1136s/iter; left time: 2151.7158s
Epoch: 9 cost time: 24.05742859840393
Epoch: 9, Steps: 208 | Train Loss: 2.590 Vali Loss: 3.175 Vali Acc: 0.123 Test Loss: 3.175 Test Acc: 0.123
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 2.0680614
	speed: 0.2895s/iter; left time: 5450.9155s
	iters: 200, epoch: 10 | loss: 2.2493000
	speed: 0.1134s/iter; left time: 2124.6782s
Epoch: 10 cost time: 24.56641697883606
Epoch: 10, Steps: 208 | Train Loss: 2.390 Vali Loss: 3.202 Vali Acc: 0.132 Test Loss: 3.202 Test Acc: 0.132
Validation loss decreased (-0.122844 --> -0.131492).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.9869072
	speed: 0.2805s/iter; left time: 5223.4992s
	iters: 200, epoch: 11 | loss: 2.7947593
	speed: 0.1061s/iter; left time: 1965.8215s
Epoch: 11 cost time: 23.30207109451294
Epoch: 11, Steps: 208 | Train Loss: 2.173 Vali Loss: 3.408 Vali Acc: 0.123 Test Loss: 3.408 Test Acc: 0.123
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.9916464
	speed: 0.2583s/iter; left time: 4756.6859s
	iters: 200, epoch: 12 | loss: 2.5561039
	speed: 0.1056s/iter; left time: 1933.0365s
Epoch: 12 cost time: 22.606415033340454
Epoch: 12, Steps: 208 | Train Loss: 1.983 Vali Loss: 3.630 Vali Acc: 0.120 Test Loss: 3.630 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.0284386
	speed: 0.2598s/iter; left time: 4730.3738s
	iters: 200, epoch: 13 | loss: 2.5325077
	speed: 0.0974s/iter; left time: 1762.6416s
Epoch: 13 cost time: 21.733288049697876
Epoch: 13, Steps: 208 | Train Loss: 1.774 Vali Loss: 3.824 Vali Acc: 0.138 Test Loss: 3.824 Test Acc: 0.138
Validation loss decreased (-0.131492 --> -0.138345).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.2704365
	speed: 0.2404s/iter; left time: 4326.3461s
	iters: 200, epoch: 14 | loss: 2.0640023
	speed: 0.0964s/iter; left time: 1724.7251s
Epoch: 14 cost time: 19.883041381835938
Epoch: 14, Steps: 208 | Train Loss: 1.589 Vali Loss: 3.936 Vali Acc: 0.128 Test Loss: 3.936 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.9209356
	speed: 0.2677s/iter; left time: 4762.0946s
	iters: 200, epoch: 15 | loss: 1.5626680
	speed: 0.1022s/iter; left time: 1808.6934s
Epoch: 15 cost time: 23.05927872657776
Epoch: 15, Steps: 208 | Train Loss: 1.464 Vali Loss: 4.218 Vali Acc: 0.118 Test Loss: 4.218 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.6487333
	speed: 0.2552s/iter; left time: 4486.7837s
	iters: 200, epoch: 16 | loss: 1.2684681
	speed: 0.1107s/iter; left time: 1934.8657s
Epoch: 16 cost time: 22.203536987304688
Epoch: 16, Steps: 208 | Train Loss: 1.291 Vali Loss: 4.597 Vali Acc: 0.129 Test Loss: 4.597 Test Acc: 0.129
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.0399563
	speed: 0.2452s/iter; left time: 4260.2894s
	iters: 200, epoch: 17 | loss: 0.7577929
	speed: 0.1082s/iter; left time: 1869.7727s
Epoch: 17 cost time: 22.31861925125122
Epoch: 17, Steps: 208 | Train Loss: 1.212 Vali Loss: 4.769 Vali Acc: 0.127 Test Loss: 4.769 Test Acc: 0.127
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.5248826
	speed: 0.2665s/iter; left time: 4574.5543s
	iters: 200, epoch: 18 | loss: 1.3082492
	speed: 0.1064s/iter; left time: 1815.8101s
Epoch: 18 cost time: 22.773995637893677
Epoch: 18, Steps: 208 | Train Loss: 1.132 Vali Loss: 5.021 Vali Acc: 0.122 Test Loss: 5.021 Test Acc: 0.122
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.5007739
	speed: 0.2536s/iter; left time: 4300.8698s
	iters: 200, epoch: 19 | loss: 1.0137268
	speed: 0.1167s/iter; left time: 1967.4586s
Epoch: 19 cost time: 22.043973684310913
Epoch: 19, Steps: 208 | Train Loss: 1.066 Vali Loss: 5.140 Vali Acc: 0.119 Test Loss: 5.140 Test Acc: 0.119
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.7567087
	speed: 0.2691s/iter; left time: 4507.9731s
	iters: 200, epoch: 20 | loss: 1.2761668
	speed: 0.1098s/iter; left time: 1828.8214s
Epoch: 20 cost time: 23.055769681930542
Epoch: 20, Steps: 208 | Train Loss: 0.959 Vali Loss: 5.056 Vali Acc: 0.130 Test Loss: 5.056 Test Acc: 0.130
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.7997141
	speed: 0.2881s/iter; left time: 4766.2779s
	iters: 200, epoch: 21 | loss: 0.8355240
	speed: 0.1011s/iter; left time: 1661.9843s
Epoch: 21 cost time: 23.758254766464233
Epoch: 21, Steps: 208 | Train Loss: 0.963 Vali Loss: 5.497 Vali Acc: 0.128 Test Loss: 5.497 Test Acc: 0.128
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.6629311
	speed: 0.2766s/iter; left time: 4517.2692s
	iters: 200, epoch: 22 | loss: 0.9353385
	speed: 0.1212s/iter; left time: 1967.4158s
Epoch: 22 cost time: 23.62026810646057
Epoch: 22, Steps: 208 | Train Loss: 0.975 Vali Loss: 5.740 Vali Acc: 0.127 Test Loss: 5.740 Test Acc: 0.127
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.4027243
	speed: 0.2703s/iter; left time: 4358.6738s
	iters: 200, epoch: 23 | loss: 0.8691354
	speed: 0.1104s/iter; left time: 1768.6982s
Epoch: 23 cost time: 22.195539474487305
Epoch: 23, Steps: 208 | Train Loss: 0.886 Vali Loss: 5.853 Vali Acc: 0.118 Test Loss: 5.853 Test Acc: 0.118
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13838353713092752
model parameter : 3238603
model size : 14.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1722531
	speed: 0.1353s/iter; left time: 2800.2092s
	iters: 200, epoch: 1 | loss: 3.6577947
	speed: 0.0954s/iter; left time: 1964.4936s
Epoch: 1 cost time: 23.630152225494385
Epoch: 1, Steps: 208 | Train Loss: 4.089 Vali Loss: 3.654 Vali Acc: 0.044 Test Loss: 3.654 Test Acc: 0.044
Validation loss decreased (inf --> -0.043805).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8846815
	speed: 0.1983s/iter; left time: 4063.2185s
	iters: 200, epoch: 2 | loss: 3.5355058
	speed: 0.0717s/iter; left time: 1463.1511s
Epoch: 2 cost time: 14.865405082702637
Epoch: 2, Steps: 208 | Train Loss: 3.720 Vali Loss: 3.753 Vali Acc: 0.051 Test Loss: 3.753 Test Acc: 0.051
Validation loss decreased (-0.043805 --> -0.050663).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6728601
	speed: 0.2710s/iter; left time: 5496.3626s
	iters: 200, epoch: 3 | loss: 3.6524806
	speed: 0.1157s/iter; left time: 2335.7867s
Epoch: 3 cost time: 24.3605477809906
Epoch: 3, Steps: 208 | Train Loss: 3.671 Vali Loss: 3.706 Vali Acc: 0.058 Test Loss: 3.706 Test Acc: 0.058
Validation loss decreased (-0.050663 --> -0.057523).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.0966411
	speed: 0.2474s/iter; left time: 4966.7768s
	iters: 200, epoch: 4 | loss: 3.5563095
	speed: 0.1149s/iter; left time: 2295.8212s
Epoch: 4 cost time: 22.601604223251343
Epoch: 4, Steps: 208 | Train Loss: 3.542 Vali Loss: 3.489 Vali Acc: 0.066 Test Loss: 3.489 Test Acc: 0.066
Validation loss decreased (-0.057523 --> -0.065578).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.4693172
	speed: 0.2561s/iter; left time: 5087.6679s
	iters: 200, epoch: 5 | loss: 3.4005134
	speed: 0.1075s/iter; left time: 2124.4192s
Epoch: 5 cost time: 23.16212010383606
Epoch: 5, Steps: 208 | Train Loss: 3.348 Vali Loss: 3.425 Vali Acc: 0.069 Test Loss: 3.425 Test Acc: 0.069
Validation loss decreased (-0.065578 --> -0.068859).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.4911947
	speed: 0.2654s/iter; left time: 5218.8500s
	iters: 200, epoch: 6 | loss: 3.1890931
	speed: 0.1120s/iter; left time: 2190.5374s
Epoch: 6 cost time: 24.276430368423462
Epoch: 6, Steps: 208 | Train Loss: 3.214 Vali Loss: 3.253 Vali Acc: 0.094 Test Loss: 3.253 Test Acc: 0.094
Validation loss decreased (-0.068859 --> -0.093615).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.6806879
	speed: 0.2558s/iter; left time: 4975.3603s
	iters: 200, epoch: 7 | loss: 2.7779713
	speed: 0.1145s/iter; left time: 2216.2141s
Epoch: 7 cost time: 22.60110330581665
Epoch: 7, Steps: 208 | Train Loss: 3.096 Vali Loss: 3.206 Vali Acc: 0.103 Test Loss: 3.206 Test Acc: 0.103
Validation loss decreased (-0.093615 --> -0.102563).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.7114577
	speed: 0.2838s/iter; left time: 5461.1642s
	iters: 200, epoch: 8 | loss: 2.5627260
	speed: 0.1229s/iter; left time: 2353.0343s
Epoch: 8 cost time: 25.494466066360474
Epoch: 8, Steps: 208 | Train Loss: 2.886 Vali Loss: 3.153 Vali Acc: 0.123 Test Loss: 3.153 Test Acc: 0.123
Validation loss decreased (-0.102563 --> -0.122844).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.0030768
	speed: 0.3026s/iter; left time: 5760.0542s
	iters: 200, epoch: 9 | loss: 2.6787083
	speed: 0.1019s/iter; left time: 1930.3706s
Epoch: 9 cost time: 24.857781171798706
Epoch: 9, Steps: 208 | Train Loss: 2.702 Vali Loss: 3.166 Vali Acc: 0.109 Test Loss: 3.166 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.6898673
	speed: 0.2885s/iter; left time: 5431.4769s
	iters: 200, epoch: 10 | loss: 2.8962445
	speed: 0.1179s/iter; left time: 2208.2627s
Epoch: 10 cost time: 25.229832410812378
Epoch: 10, Steps: 208 | Train Loss: 2.519 Vali Loss: 3.246 Vali Acc: 0.130 Test Loss: 3.246 Test Acc: 0.130
Validation loss decreased (-0.122844 --> -0.130299).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.4648895
	speed: 0.2698s/iter; left time: 5023.6232s
	iters: 200, epoch: 11 | loss: 2.4701900
	speed: 0.1166s/iter; left time: 2160.1032s
Epoch: 11 cost time: 23.386757373809814
Epoch: 11, Steps: 208 | Train Loss: 2.354 Vali Loss: 3.211 Vali Acc: 0.128 Test Loss: 3.211 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.1475234
	speed: 0.2682s/iter; left time: 4937.5844s
	iters: 200, epoch: 12 | loss: 2.2129405
	speed: 0.0974s/iter; left time: 1784.0930s
Epoch: 12 cost time: 22.60276460647583
Epoch: 12, Steps: 208 | Train Loss: 2.170 Vali Loss: 3.307 Vali Acc: 0.127 Test Loss: 3.307 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.7185003
	speed: 0.2712s/iter; left time: 4937.0790s
	iters: 200, epoch: 13 | loss: 2.6691523
	speed: 0.1077s/iter; left time: 1949.6868s
Epoch: 13 cost time: 22.702503204345703
Epoch: 13, Steps: 208 | Train Loss: 1.991 Vali Loss: 3.444 Vali Acc: 0.124 Test Loss: 3.444 Test Acc: 0.124
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.9354753
	speed: 0.2563s/iter; left time: 4613.4876s
	iters: 200, epoch: 14 | loss: 1.9576066
	speed: 0.1184s/iter; left time: 2119.4096s
Epoch: 14 cost time: 24.221331357955933
Epoch: 14, Steps: 208 | Train Loss: 1.886 Vali Loss: 3.520 Vali Acc: 0.136 Test Loss: 3.520 Test Acc: 0.136
Validation loss decreased (-0.130299 --> -0.135962).  Saving model ...
	iters: 100, epoch: 15 | loss: 2.0564382
	speed: 0.2639s/iter; left time: 4694.2800s
	iters: 200, epoch: 15 | loss: 1.9635711
	speed: 0.1091s/iter; left time: 1930.6685s
Epoch: 15 cost time: 23.283607482910156
Epoch: 15, Steps: 208 | Train Loss: 1.648 Vali Loss: 3.970 Vali Acc: 0.113 Test Loss: 3.970 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.3653297
	speed: 0.2512s/iter; left time: 4416.3489s
	iters: 200, epoch: 16 | loss: 1.6007472
	speed: 0.1024s/iter; left time: 1789.6383s
Epoch: 16 cost time: 22.15752911567688
Epoch: 16, Steps: 208 | Train Loss: 1.509 Vali Loss: 3.860 Vali Acc: 0.129 Test Loss: 3.860 Test Acc: 0.129
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.4802551
	speed: 0.2616s/iter; left time: 4545.4456s
	iters: 200, epoch: 17 | loss: 0.7937024
	speed: 0.1168s/iter; left time: 2016.7025s
Epoch: 17 cost time: 24.161359310150146
Epoch: 17, Steps: 208 | Train Loss: 1.344 Vali Loss: 4.477 Vali Acc: 0.132 Test Loss: 4.477 Test Acc: 0.132
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.6680379
	speed: 0.1981s/iter; left time: 3399.7881s
	iters: 200, epoch: 18 | loss: 1.2882329
	speed: 0.0495s/iter; left time: 844.0920s
Epoch: 18 cost time: 11.815950632095337
Epoch: 18, Steps: 208 | Train Loss: 1.266 Vali Loss: 4.546 Vali Acc: 0.123 Test Loss: 4.546 Test Acc: 0.123
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.6703482
	speed: 0.2268s/iter; left time: 3846.6308s
	iters: 200, epoch: 19 | loss: 1.5898714
	speed: 0.0774s/iter; left time: 1304.8995s
Epoch: 19 cost time: 17.831421375274658
Epoch: 19, Steps: 208 | Train Loss: 1.193 Vali Loss: 4.620 Vali Acc: 0.124 Test Loss: 4.620 Test Acc: 0.124
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 1.5259205
	speed: 0.2827s/iter; left time: 4734.4528s
	iters: 200, epoch: 20 | loss: 1.3484207
	speed: 0.1226s/iter; left time: 2040.7016s
Epoch: 20 cost time: 25.738871812820435
Epoch: 20, Steps: 208 | Train Loss: 1.106 Vali Loss: 4.864 Vali Acc: 0.132 Test Loss: 4.864 Test Acc: 0.132
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 1.4710625
	speed: 0.2647s/iter; left time: 4378.1220s
	iters: 200, epoch: 21 | loss: 1.6227320
	speed: 0.1351s/iter; left time: 2221.2940s
Epoch: 21 cost time: 25.843690395355225
Epoch: 21, Steps: 208 | Train Loss: 1.050 Vali Loss: 4.988 Vali Acc: 0.116 Test Loss: 4.988 Test Acc: 0.116
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 1.5635509
	speed: 0.2907s/iter; left time: 4747.6747s
	iters: 200, epoch: 22 | loss: 1.3375256
	speed: 0.0965s/iter; left time: 1566.6266s
Epoch: 22 cost time: 23.80109190940857
Epoch: 22, Steps: 208 | Train Loss: 1.057 Vali Loss: 4.718 Vali Acc: 0.126 Test Loss: 4.718 Test Acc: 0.126
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 1.1162317
	speed: 0.2561s/iter; left time: 4129.3610s
	iters: 200, epoch: 23 | loss: 0.6644808
	speed: 0.1159s/iter; left time: 1857.4643s
Epoch: 23 cost time: 22.51060962677002
Epoch: 23, Steps: 208 | Train Loss: 0.972 Vali Loss: 5.257 Vali Acc: 0.123 Test Loss: 5.257 Test Acc: 0.123
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 1.1342123
	speed: 0.2504s/iter; left time: 3985.8052s
	iters: 200, epoch: 24 | loss: 0.4354233
	speed: 0.1167s/iter; left time: 1846.0053s
Epoch: 24 cost time: 23.581637382507324
Epoch: 24, Steps: 208 | Train Loss: 0.915 Vali Loss: 6.183 Vali Acc: 0.128 Test Loss: 6.183 Test Acc: 0.128
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13599761407694602
model parameter : 3234891
model size : 14.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5213778
	speed: 0.1343s/iter; left time: 2780.7925s
	iters: 200, epoch: 1 | loss: 3.3078566
	speed: 0.0970s/iter; left time: 1998.8222s
Epoch: 1 cost time: 23.735408544540405
Epoch: 1, Steps: 208 | Train Loss: 4.255 Vali Loss: 3.894 Vali Acc: 0.049 Test Loss: 3.894 Test Acc: 0.049
Validation loss decreased (inf --> -0.048872).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8602898
	speed: 0.2532s/iter; left time: 5188.6311s
	iters: 200, epoch: 2 | loss: 3.4766960
	speed: 0.1123s/iter; left time: 2289.9261s
Epoch: 2 cost time: 23.062069416046143
Epoch: 2, Steps: 208 | Train Loss: 3.764 Vali Loss: 3.741 Vali Acc: 0.046 Test Loss: 3.741 Test Acc: 0.046
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.4409821
	speed: 0.2483s/iter; left time: 5036.9881s
	iters: 200, epoch: 3 | loss: 4.1694965
	speed: 0.1018s/iter; left time: 2054.1070s
Epoch: 3 cost time: 22.172041416168213
Epoch: 3, Steps: 208 | Train Loss: 3.663 Vali Loss: 3.628 Vali Acc: 0.058 Test Loss: 3.628 Test Acc: 0.058
Validation loss decreased (-0.048872 --> -0.057822).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.0863914
	speed: 0.2680s/iter; left time: 5381.4316s
	iters: 200, epoch: 4 | loss: 3.5220387
	speed: 0.1005s/iter; left time: 2007.5046s
Epoch: 4 cost time: 22.478639841079712
Epoch: 4, Steps: 208 | Train Loss: 3.515 Vali Loss: 3.494 Vali Acc: 0.060 Test Loss: 3.494 Test Acc: 0.060
Validation loss decreased (-0.057822 --> -0.060210).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.4079053
	speed: 0.2518s/iter; left time: 5002.5989s
	iters: 200, epoch: 5 | loss: 3.1287179
	speed: 0.1106s/iter; left time: 2186.4194s
Epoch: 5 cost time: 22.31619095802307
Epoch: 5, Steps: 208 | Train Loss: 3.312 Vali Loss: 3.404 Vali Acc: 0.079 Test Loss: 3.404 Test Acc: 0.079
Validation loss decreased (-0.060210 --> -0.079000).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.6254010
	speed: 0.2618s/iter; left time: 5147.4555s
	iters: 200, epoch: 6 | loss: 2.9187870
	speed: 0.1224s/iter; left time: 2393.6593s
Epoch: 6 cost time: 24.830817461013794
Epoch: 6, Steps: 208 | Train Loss: 3.206 Vali Loss: 3.230 Vali Acc: 0.102 Test Loss: 3.230 Test Acc: 0.102
Validation loss decreased (-0.079000 --> -0.101966).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.7189109
	speed: 0.2812s/iter; left time: 5469.6428s
	iters: 200, epoch: 7 | loss: 2.8920803
	speed: 0.1127s/iter; left time: 2180.4988s
Epoch: 7 cost time: 24.437122106552124
Epoch: 7, Steps: 208 | Train Loss: 3.075 Vali Loss: 3.234 Vali Acc: 0.089 Test Loss: 3.234 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.7440608
	speed: 0.2664s/iter; left time: 5126.6428s
	iters: 200, epoch: 8 | loss: 2.8394430
	speed: 0.1198s/iter; left time: 2293.2747s
Epoch: 8 cost time: 24.68466281890869
Epoch: 8, Steps: 208 | Train Loss: 2.853 Vali Loss: 3.192 Vali Acc: 0.122 Test Loss: 3.192 Test Acc: 0.122
Validation loss decreased (-0.101966 --> -0.121650).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.7816617
	speed: 0.3071s/iter; left time: 5845.7414s
	iters: 200, epoch: 9 | loss: 2.8039355
	speed: 0.1101s/iter; left time: 2085.7233s
Epoch: 9 cost time: 25.530489921569824
Epoch: 9, Steps: 208 | Train Loss: 2.642 Vali Loss: 3.199 Vali Acc: 0.123 Test Loss: 3.199 Test Acc: 0.123
Validation loss decreased (-0.121650 --> -0.122843).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.6631403
	speed: 0.2612s/iter; left time: 4918.6309s
	iters: 200, epoch: 10 | loss: 2.7882910
	speed: 0.1012s/iter; left time: 1894.8370s
Epoch: 10 cost time: 22.41573476791382
Epoch: 10, Steps: 208 | Train Loss: 2.443 Vali Loss: 3.285 Vali Acc: 0.121 Test Loss: 3.285 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.7696030
	speed: 0.2536s/iter; left time: 4721.7843s
	iters: 200, epoch: 11 | loss: 2.0691833
	speed: 0.1113s/iter; left time: 2061.3726s
Epoch: 11 cost time: 22.947085857391357
Epoch: 11, Steps: 208 | Train Loss: 2.209 Vali Loss: 3.622 Vali Acc: 0.109 Test Loss: 3.622 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.2794294
	speed: 0.2669s/iter; left time: 4914.5328s
	iters: 200, epoch: 12 | loss: 1.9676712
	speed: 0.0950s/iter; left time: 1740.2489s
Epoch: 12 cost time: 22.808189392089844
Epoch: 12, Steps: 208 | Train Loss: 2.013 Vali Loss: 3.572 Vali Acc: 0.123 Test Loss: 3.572 Test Acc: 0.123
Validation loss decreased (-0.122843 --> -0.123138).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.3842974
	speed: 0.1905s/iter; left time: 3467.7181s
	iters: 200, epoch: 13 | loss: 2.2304652
	speed: 0.0710s/iter; left time: 1285.0945s
Epoch: 13 cost time: 15.082228899002075
Epoch: 13, Steps: 208 | Train Loss: 1.755 Vali Loss: 3.916 Vali Acc: 0.129 Test Loss: 3.916 Test Acc: 0.129
Validation loss decreased (-0.123138 --> -0.128801).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.7511964
	speed: 0.2756s/iter; left time: 4959.6432s
	iters: 200, epoch: 14 | loss: 1.7955437
	speed: 0.1064s/iter; left time: 1903.8951s
Epoch: 14 cost time: 23.83221673965454
Epoch: 14, Steps: 208 | Train Loss: 1.578 Vali Loss: 3.784 Vali Acc: 0.133 Test Loss: 3.784 Test Acc: 0.133
Validation loss decreased (-0.128801 --> -0.132679).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.3913087
	speed: 0.2551s/iter; left time: 4537.6868s
	iters: 200, epoch: 15 | loss: 1.3938940
	speed: 0.1175s/iter; left time: 2079.2843s
Epoch: 15 cost time: 23.907944440841675
Epoch: 15, Steps: 208 | Train Loss: 1.403 Vali Loss: 4.241 Vali Acc: 0.124 Test Loss: 4.241 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.8152623
	speed: 0.2644s/iter; left time: 4647.5943s
	iters: 200, epoch: 16 | loss: 1.8675326
	speed: 0.1075s/iter; left time: 1878.3948s
Epoch: 16 cost time: 22.97289776802063
Epoch: 16, Steps: 208 | Train Loss: 1.315 Vali Loss: 4.325 Vali Acc: 0.123 Test Loss: 4.325 Test Acc: 0.123
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.9493840
	speed: 0.2418s/iter; left time: 4200.3750s
	iters: 200, epoch: 17 | loss: 1.3516675
	speed: 0.1153s/iter; left time: 1991.3251s
Epoch: 17 cost time: 22.963008165359497
Epoch: 17, Steps: 208 | Train Loss: 1.247 Vali Loss: 4.835 Vali Acc: 0.115 Test Loss: 4.835 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.3830205
	speed: 0.2787s/iter; left time: 4784.4504s
	iters: 200, epoch: 18 | loss: 0.6694977
	speed: 0.1177s/iter; left time: 2009.0969s
Epoch: 18 cost time: 26.3338782787323
Epoch: 18, Steps: 208 | Train Loss: 1.157 Vali Loss: 5.051 Vali Acc: 0.130 Test Loss: 5.051 Test Acc: 0.130
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.2632180
	speed: 0.2756s/iter; left time: 4673.4984s
	iters: 200, epoch: 19 | loss: 1.3722861
	speed: 0.1166s/iter; left time: 1965.5382s
Epoch: 19 cost time: 24.22412872314453
Epoch: 19, Steps: 208 | Train Loss: 1.064 Vali Loss: 4.831 Vali Acc: 0.128 Test Loss: 4.831 Test Acc: 0.128
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.9581584
	speed: 0.2662s/iter; left time: 4457.9265s
	iters: 200, epoch: 20 | loss: 1.8773196
	speed: 0.1287s/iter; left time: 2143.5538s
Epoch: 20 cost time: 24.78361463546753
Epoch: 20, Steps: 208 | Train Loss: 0.994 Vali Loss: 5.277 Vali Acc: 0.120 Test Loss: 5.277 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.9745186
	speed: 0.2854s/iter; left time: 4720.4602s
	iters: 200, epoch: 21 | loss: 0.8746799
	speed: 0.0728s/iter; left time: 1197.4092s
Epoch: 21 cost time: 19.97369384765625
Epoch: 21, Steps: 208 | Train Loss: 0.936 Vali Loss: 5.636 Vali Acc: 0.115 Test Loss: 5.636 Test Acc: 0.115
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.6656317
	speed: 0.2613s/iter; left time: 4268.3095s
	iters: 200, epoch: 22 | loss: 1.0451503
	speed: 0.1087s/iter; left time: 1765.2021s
Epoch: 22 cost time: 23.83546733856201
Epoch: 22, Steps: 208 | Train Loss: 0.951 Vali Loss: 5.328 Vali Acc: 0.122 Test Loss: 5.328 Test Acc: 0.122
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.6402773
	speed: 0.2596s/iter; left time: 4185.5168s
	iters: 200, epoch: 23 | loss: 0.4209521
	speed: 0.1231s/iter; left time: 1972.8482s
Epoch: 23 cost time: 24.712666749954224
Epoch: 23, Steps: 208 | Train Loss: 0.886 Vali Loss: 5.957 Vali Acc: 0.115 Test Loss: 5.957 Test Acc: 0.115
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.9795010
	speed: 0.2561s/iter; left time: 4076.2868s
	iters: 200, epoch: 24 | loss: 1.1713691
	speed: 0.1155s/iter; left time: 1826.5678s
Epoch: 24 cost time: 23.790254831314087
Epoch: 24, Steps: 208 | Train Loss: 0.892 Vali Loss: 5.407 Vali Acc: 0.123 Test Loss: 5.407 Test Acc: 0.123
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13271696987772144
model parameter : 3231179
model size : 14.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.8842216
	speed: 0.1371s/iter; left time: 2837.4930s
	iters: 200, epoch: 1 | loss: 5.6567383
	speed: 0.1315s/iter; left time: 2708.0909s
Epoch: 1 cost time: 27.917808771133423
Epoch: 1, Steps: 208 | Train Loss: 4.280 Vali Loss: 4.543 Vali Acc: 0.046 Test Loss: 4.543 Test Acc: 0.046
Validation loss decreased (inf --> -0.045884).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7492537
	speed: 0.2742s/iter; left time: 5619.4824s
	iters: 200, epoch: 2 | loss: 3.6554852
	speed: 0.1176s/iter; left time: 2398.8213s
Epoch: 2 cost time: 26.215820789337158
Epoch: 2, Steps: 208 | Train Loss: 3.909 Vali Loss: 3.796 Vali Acc: 0.056 Test Loss: 3.796 Test Acc: 0.056
Validation loss decreased (-0.045884 --> -0.056329).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5740685
	speed: 0.2697s/iter; left time: 5470.2916s
	iters: 200, epoch: 3 | loss: 3.6977541
	speed: 0.1266s/iter; left time: 2556.0753s
Epoch: 3 cost time: 26.26024556159973
Epoch: 3, Steps: 208 | Train Loss: 3.651 Vali Loss: 3.711 Vali Acc: 0.068 Test Loss: 3.711 Test Acc: 0.068
Validation loss decreased (-0.056329 --> -0.068260).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4514396
	speed: 0.2839s/iter; left time: 5699.9213s
	iters: 200, epoch: 4 | loss: 3.1858466
	speed: 0.1208s/iter; left time: 2412.6956s
Epoch: 4 cost time: 26.8096125125885
Epoch: 4, Steps: 208 | Train Loss: 3.495 Vali Loss: 3.557 Vali Acc: 0.064 Test Loss: 3.557 Test Acc: 0.064
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 4.0270925
	speed: 0.2778s/iter; left time: 5519.3058s
	iters: 200, epoch: 5 | loss: 3.4156139
	speed: 0.1235s/iter; left time: 2441.6289s
Epoch: 5 cost time: 25.792285680770874
Epoch: 5, Steps: 208 | Train Loss: 3.320 Vali Loss: 3.389 Vali Acc: 0.089 Test Loss: 3.389 Test Acc: 0.089
Validation loss decreased (-0.068260 --> -0.089438).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2292039
	speed: 0.2839s/iter; left time: 5582.1348s
	iters: 200, epoch: 6 | loss: 3.1193972
	speed: 0.1281s/iter; left time: 2506.5329s
Epoch: 6 cost time: 26.863007307052612
Epoch: 6, Steps: 208 | Train Loss: 3.143 Vali Loss: 3.297 Vali Acc: 0.078 Test Loss: 3.297 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.1856735
	speed: 0.2870s/iter; left time: 5583.2277s
	iters: 200, epoch: 7 | loss: 3.2955046
	speed: 0.0824s/iter; left time: 1594.1518s
Epoch: 7 cost time: 22.15918755531311
Epoch: 7, Steps: 208 | Train Loss: 3.015 Vali Loss: 3.126 Vali Acc: 0.112 Test Loss: 3.126 Test Acc: 0.112
Validation loss decreased (-0.089438 --> -0.112405).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.1256270
	speed: 0.2293s/iter; left time: 4413.3076s
	iters: 200, epoch: 8 | loss: 3.2942507
	speed: 0.1201s/iter; left time: 2299.8408s
Epoch: 8 cost time: 22.90750217437744
Epoch: 8, Steps: 208 | Train Loss: 2.770 Vali Loss: 3.129 Vali Acc: 0.099 Test Loss: 3.129 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.1446915
	speed: 0.2505s/iter; left time: 4768.8378s
	iters: 200, epoch: 9 | loss: 2.6533873
	speed: 0.1250s/iter; left time: 2367.4465s
Epoch: 9 cost time: 24.514258861541748
Epoch: 9, Steps: 208 | Train Loss: 2.526 Vali Loss: 3.276 Vali Acc: 0.124 Test Loss: 3.276 Test Acc: 0.124
Validation loss decreased (-0.112405 --> -0.124035).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.0489964
	speed: 0.2621s/iter; left time: 4934.4355s
	iters: 200, epoch: 10 | loss: 2.4109058
	speed: 0.1322s/iter; left time: 2475.2120s
Epoch: 10 cost time: 25.740949869155884
Epoch: 10, Steps: 208 | Train Loss: 2.344 Vali Loss: 3.193 Vali Acc: 0.119 Test Loss: 3.193 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.3241343
	speed: 0.2511s/iter; left time: 4675.1578s
	iters: 200, epoch: 11 | loss: 2.8540246
	speed: 0.1197s/iter; left time: 2217.1717s
Epoch: 11 cost time: 24.25124716758728
Epoch: 11, Steps: 208 | Train Loss: 2.126 Vali Loss: 3.388 Vali Acc: 0.129 Test Loss: 3.388 Test Acc: 0.129
Validation loss decreased (-0.124035 --> -0.129104).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.9336810
	speed: 0.2796s/iter; left time: 5148.0282s
	iters: 200, epoch: 12 | loss: 1.9977593
	speed: 0.1179s/iter; left time: 2159.1903s
Epoch: 12 cost time: 25.51395559310913
Epoch: 12, Steps: 208 | Train Loss: 1.914 Vali Loss: 3.558 Vali Acc: 0.123 Test Loss: 3.558 Test Acc: 0.123
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.6822082
	speed: 0.2682s/iter; left time: 4881.7113s
	iters: 200, epoch: 13 | loss: 1.7778445
	speed: 0.1171s/iter; left time: 2119.7535s
Epoch: 13 cost time: 26.055267810821533
Epoch: 13, Steps: 208 | Train Loss: 1.673 Vali Loss: 3.768 Vali Acc: 0.121 Test Loss: 3.768 Test Acc: 0.121
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.8010682
	speed: 0.2791s/iter; left time: 5022.7420s
	iters: 200, epoch: 14 | loss: 1.7076631
	speed: 0.1095s/iter; left time: 1959.1540s
Epoch: 14 cost time: 24.746561288833618
Epoch: 14, Steps: 208 | Train Loss: 1.519 Vali Loss: 4.063 Vali Acc: 0.124 Test Loss: 4.063 Test Acc: 0.124
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.7982792
	speed: 0.2704s/iter; left time: 4809.3563s
	iters: 200, epoch: 15 | loss: 1.2996842
	speed: 0.1076s/iter; left time: 1903.3837s
Epoch: 15 cost time: 25.117722749710083
Epoch: 15, Steps: 208 | Train Loss: 1.389 Vali Loss: 4.299 Vali Acc: 0.123 Test Loss: 4.299 Test Acc: 0.123
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.1889193
	speed: 0.2625s/iter; left time: 4615.8227s
	iters: 200, epoch: 16 | loss: 1.6506159
	speed: 0.1201s/iter; left time: 2099.3376s
Epoch: 16 cost time: 25.680126667022705
Epoch: 16, Steps: 208 | Train Loss: 1.249 Vali Loss: 4.481 Vali Acc: 0.120 Test Loss: 4.481 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.3695003
	speed: 0.2867s/iter; left time: 4980.8423s
	iters: 200, epoch: 17 | loss: 0.9268787
	speed: 0.1348s/iter; left time: 2328.1000s
Epoch: 17 cost time: 27.090873956680298
Epoch: 17, Steps: 208 | Train Loss: 1.137 Vali Loss: 4.669 Vali Acc: 0.126 Test Loss: 4.669 Test Acc: 0.126
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.1136167
	speed: 0.2786s/iter; left time: 4782.8158s
	iters: 200, epoch: 18 | loss: 0.6312256
	speed: 0.1621s/iter; left time: 2765.9561s
Epoch: 18 cost time: 29.259512901306152
Epoch: 18, Steps: 208 | Train Loss: 1.146 Vali Loss: 4.821 Vali Acc: 0.128 Test Loss: 4.821 Test Acc: 0.128
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.0677233
	speed: 0.2762s/iter; left time: 4683.5191s
	iters: 200, epoch: 19 | loss: 1.1262388
	speed: 0.1178s/iter; left time: 1985.8060s
Epoch: 19 cost time: 25.66628408432007
Epoch: 19, Steps: 208 | Train Loss: 1.041 Vali Loss: 4.897 Vali Acc: 0.125 Test Loss: 4.897 Test Acc: 0.125
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.9811244
	speed: 0.2555s/iter; left time: 4279.6471s
	iters: 200, epoch: 20 | loss: 0.9604549
	speed: 0.1103s/iter; left time: 1835.8626s
Epoch: 20 cost time: 23.83579134941101
Epoch: 20, Steps: 208 | Train Loss: 0.995 Vali Loss: 5.060 Vali Acc: 0.122 Test Loss: 5.060 Test Acc: 0.122
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 1.2182537
	speed: 0.2829s/iter; left time: 4679.3955s
	iters: 200, epoch: 21 | loss: 1.2559693
	speed: 0.1054s/iter; left time: 1733.6478s
Epoch: 21 cost time: 25.757166862487793
Epoch: 21, Steps: 208 | Train Loss: 0.945 Vali Loss: 5.407 Vali Acc: 0.116 Test Loss: 5.407 Test Acc: 0.116
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12913808529674917
model parameter : 2584395
model size : 12.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8498664
	speed: 0.1083s/iter; left time: 2242.2172s
	iters: 200, epoch: 1 | loss: 5.1218958
	speed: 0.0863s/iter; left time: 1778.3516s
Epoch: 1 cost time: 20.073583364486694
Epoch: 1, Steps: 208 | Train Loss: 4.247 Vali Loss: 4.360 Vali Acc: 0.038 Test Loss: 4.360 Test Acc: 0.038
Validation loss decreased (inf --> -0.037535).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5128841
	speed: 0.2543s/iter; left time: 5210.9922s
	iters: 200, epoch: 2 | loss: 3.5679626
	speed: 0.1145s/iter; left time: 2335.1815s
Epoch: 2 cost time: 23.898308038711548
Epoch: 2, Steps: 208 | Train Loss: 3.802 Vali Loss: 3.830 Vali Acc: 0.052 Test Loss: 3.830 Test Acc: 0.052
Validation loss decreased (-0.037535 --> -0.052452).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.9113920
	speed: 0.2525s/iter; left time: 5121.6720s
	iters: 200, epoch: 3 | loss: 3.5426209
	speed: 0.1131s/iter; left time: 2282.4890s
Epoch: 3 cost time: 22.85204815864563
Epoch: 3, Steps: 208 | Train Loss: 3.685 Vali Loss: 3.715 Vali Acc: 0.058 Test Loss: 3.715 Test Acc: 0.058
Validation loss decreased (-0.052452 --> -0.057523).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.0839846
	speed: 0.2080s/iter; left time: 4176.8059s
	iters: 200, epoch: 4 | loss: 3.1727846
	speed: 0.0605s/iter; left time: 1209.1807s
Epoch: 4 cost time: 13.324743032455444
Epoch: 4, Steps: 208 | Train Loss: 3.479 Vali Loss: 3.508 Vali Acc: 0.079 Test Loss: 3.508 Test Acc: 0.079
Validation loss decreased (-0.057523 --> -0.078700).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2443712
	speed: 0.2479s/iter; left time: 4924.9074s
	iters: 200, epoch: 5 | loss: 3.3964279
	speed: 0.1050s/iter; left time: 2075.7971s
Epoch: 5 cost time: 23.84273672103882
Epoch: 5, Steps: 208 | Train Loss: 3.303 Vali Loss: 3.301 Vali Acc: 0.098 Test Loss: 3.301 Test Acc: 0.098
Validation loss decreased (-0.078700 --> -0.098386).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.8487561
	speed: 0.2654s/iter; left time: 5218.6138s
	iters: 200, epoch: 6 | loss: 3.6798208
	speed: 0.1174s/iter; left time: 2296.9009s
Epoch: 6 cost time: 23.655614852905273
Epoch: 6, Steps: 208 | Train Loss: 3.142 Vali Loss: 3.323 Vali Acc: 0.096 Test Loss: 3.323 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.7896352
	speed: 0.2761s/iter; left time: 5370.2260s
	iters: 200, epoch: 7 | loss: 2.3540804
	speed: 0.1196s/iter; left time: 2315.3964s
Epoch: 7 cost time: 24.406500101089478
Epoch: 7, Steps: 208 | Train Loss: 3.023 Vali Loss: 3.235 Vali Acc: 0.092 Test Loss: 3.235 Test Acc: 0.092
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.0769396
	speed: 0.3097s/iter; left time: 5959.7133s
	iters: 200, epoch: 8 | loss: 2.5025263
	speed: 0.1218s/iter; left time: 2332.6887s
Epoch: 8 cost time: 27.497207164764404
Epoch: 8, Steps: 208 | Train Loss: 2.826 Vali Loss: 3.135 Vali Acc: 0.121 Test Loss: 3.135 Test Acc: 0.121
Validation loss decreased (-0.098386 --> -0.121352).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.5085049
	speed: 0.2604s/iter; left time: 4957.7740s
	iters: 200, epoch: 9 | loss: 2.4892559
	speed: 0.1130s/iter; left time: 2139.6290s
Epoch: 9 cost time: 23.1465961933136
Epoch: 9, Steps: 208 | Train Loss: 2.543 Vali Loss: 3.195 Vali Acc: 0.132 Test Loss: 3.195 Test Acc: 0.132
Validation loss decreased (-0.121352 --> -0.132089).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.9137747
	speed: 0.2611s/iter; left time: 4917.1600s
	iters: 200, epoch: 10 | loss: 1.1419339
	speed: 0.1073s/iter; left time: 2010.5506s
Epoch: 10 cost time: 22.731884956359863
Epoch: 10, Steps: 208 | Train Loss: 2.265 Vali Loss: 3.386 Vali Acc: 0.134 Test Loss: 3.386 Test Acc: 0.134
Validation loss decreased (-0.132089 --> -0.133876).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.3388894
	speed: 0.2604s/iter; left time: 4848.8453s
	iters: 200, epoch: 11 | loss: 1.7839921
	speed: 0.1072s/iter; left time: 1985.6763s
Epoch: 11 cost time: 23.52975034713745
Epoch: 11, Steps: 208 | Train Loss: 2.020 Vali Loss: 3.409 Vali Acc: 0.136 Test Loss: 3.409 Test Acc: 0.136
Validation loss decreased (-0.133876 --> -0.136262).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.2417707
	speed: 0.2554s/iter; left time: 4702.9735s
	iters: 200, epoch: 12 | loss: 2.4827275
	speed: 0.1090s/iter; left time: 1996.1250s
Epoch: 12 cost time: 22.774349689483643
Epoch: 12, Steps: 208 | Train Loss: 1.787 Vali Loss: 3.712 Vali Acc: 0.132 Test Loss: 3.712 Test Acc: 0.132
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.6211457
	speed: 0.2508s/iter; left time: 4566.5786s
	iters: 200, epoch: 13 | loss: 1.7631961
	speed: 0.1076s/iter; left time: 1947.7785s
Epoch: 13 cost time: 22.292017459869385
Epoch: 13, Steps: 208 | Train Loss: 1.539 Vali Loss: 4.065 Vali Acc: 0.119 Test Loss: 4.065 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.9830753
	speed: 0.2443s/iter; left time: 4396.3467s
	iters: 200, epoch: 14 | loss: 1.3132223
	speed: 0.1209s/iter; left time: 2164.5000s
Epoch: 14 cost time: 23.52747392654419
Epoch: 14, Steps: 208 | Train Loss: 1.304 Vali Loss: 4.360 Vali Acc: 0.134 Test Loss: 4.360 Test Acc: 0.134
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.0491315
	speed: 0.2652s/iter; left time: 4717.3332s
	iters: 200, epoch: 15 | loss: 1.6841794
	speed: 0.1018s/iter; left time: 1801.3109s
Epoch: 15 cost time: 22.49239444732666
Epoch: 15, Steps: 208 | Train Loss: 1.240 Vali Loss: 4.238 Vali Acc: 0.123 Test Loss: 4.238 Test Acc: 0.123
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.2149417
	speed: 0.2452s/iter; left time: 4310.2547s
	iters: 200, epoch: 16 | loss: 1.9905341
	speed: 0.1028s/iter; left time: 1796.8910s
Epoch: 16 cost time: 21.91573739051819
Epoch: 16, Steps: 208 | Train Loss: 1.129 Vali Loss: 4.753 Vali Acc: 0.119 Test Loss: 4.753 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.6394711
	speed: 0.2507s/iter; left time: 4354.6463s
	iters: 200, epoch: 17 | loss: 0.7656318
	speed: 0.1272s/iter; left time: 2197.3603s
Epoch: 17 cost time: 25.22991418838501
Epoch: 17, Steps: 208 | Train Loss: 1.003 Vali Loss: 5.056 Vali Acc: 0.121 Test Loss: 5.056 Test Acc: 0.121
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.9786901
	speed: 0.2911s/iter; left time: 4997.0364s
	iters: 200, epoch: 18 | loss: 0.8386601
	speed: 0.1119s/iter; left time: 1909.8342s
Epoch: 18 cost time: 25.477011919021606
Epoch: 18, Steps: 208 | Train Loss: 0.965 Vali Loss: 5.632 Vali Acc: 0.109 Test Loss: 5.632 Test Acc: 0.109
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.1033869
	speed: 0.2760s/iter; left time: 4680.5878s
	iters: 200, epoch: 19 | loss: 1.8880423
	speed: 0.1117s/iter; left time: 1883.4204s
Epoch: 19 cost time: 25.006829738616943
Epoch: 19, Steps: 208 | Train Loss: 0.846 Vali Loss: 6.093 Vali Acc: 0.126 Test Loss: 6.093 Test Acc: 0.126
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.0122430
	speed: 0.2821s/iter; left time: 4724.5221s
	iters: 200, epoch: 20 | loss: 1.0998176
	speed: 0.1232s/iter; left time: 2051.2590s
Epoch: 20 cost time: 25.351255416870117
Epoch: 20, Steps: 208 | Train Loss: 0.823 Vali Loss: 5.578 Vali Acc: 0.132 Test Loss: 5.578 Test Acc: 0.132
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.4173757
	speed: 0.2513s/iter; left time: 4156.3632s
	iters: 200, epoch: 21 | loss: 1.4571618
	speed: 0.0867s/iter; left time: 1425.0550s
Epoch: 21 cost time: 20.992345571517944
Epoch: 21, Steps: 208 | Train Loss: 0.783 Vali Loss: 5.913 Vali Acc: 0.123 Test Loss: 5.913 Test Acc: 0.123
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13629585445869372
model parameter : 2580683
model size : 12.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.6417928
	speed: 0.1201s/iter; left time: 2485.4376s
	iters: 200, epoch: 1 | loss: 5.1927996
	speed: 0.1040s/iter; left time: 2142.3426s
Epoch: 1 cost time: 23.27637267112732
Epoch: 1, Steps: 208 | Train Loss: 4.286 Vali Loss: 5.046 Vali Acc: 0.042 Test Loss: 5.046 Test Acc: 0.042
Validation loss decreased (inf --> -0.041703).  Saving model ...
	iters: 100, epoch: 2 | loss: 5.1130228
	speed: 0.2552s/iter; left time: 5230.1567s
	iters: 200, epoch: 2 | loss: 4.2272930
	speed: 0.0989s/iter; left time: 2016.3142s
Epoch: 2 cost time: 22.929116249084473
Epoch: 2, Steps: 208 | Train Loss: 4.498 Vali Loss: 4.139 Vali Acc: 0.048 Test Loss: 4.139 Test Acc: 0.048
Validation loss decreased (-0.041703 --> -0.048274).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6679010
	speed: 0.2497s/iter; left time: 5066.1526s
	iters: 200, epoch: 3 | loss: 3.8020515
	speed: 0.1028s/iter; left time: 2074.6310s
Epoch: 3 cost time: 21.88149404525757
Epoch: 3, Steps: 208 | Train Loss: 3.743 Vali Loss: 3.707 Vali Acc: 0.063 Test Loss: 3.707 Test Acc: 0.063
Validation loss decreased (-0.048274 --> -0.063190).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.9695621
	speed: 0.2432s/iter; left time: 4883.0635s
	iters: 200, epoch: 4 | loss: 3.5253754
	speed: 0.1143s/iter; left time: 2283.3929s
Epoch: 4 cost time: 21.689496755599976
Epoch: 4, Steps: 208 | Train Loss: 3.523 Vali Loss: 3.582 Vali Acc: 0.075 Test Loss: 3.582 Test Acc: 0.075
Validation loss decreased (-0.063190 --> -0.074524).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.0660439
	speed: 0.2675s/iter; left time: 5315.6090s
	iters: 200, epoch: 5 | loss: 3.0295286
	speed: 0.1151s/iter; left time: 2276.3524s
Epoch: 5 cost time: 24.066018104553223
Epoch: 5, Steps: 208 | Train Loss: 3.259 Vali Loss: 3.628 Vali Acc: 0.078 Test Loss: 3.628 Test Acc: 0.078
Validation loss decreased (-0.074524 --> -0.077506).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.7362120
	speed: 0.2423s/iter; left time: 4763.2566s
	iters: 200, epoch: 6 | loss: 3.3302741
	speed: 0.0919s/iter; left time: 1797.5897s
Epoch: 6 cost time: 20.80274510383606
Epoch: 6, Steps: 208 | Train Loss: 3.042 Vali Loss: 3.268 Vali Acc: 0.089 Test Loss: 3.268 Test Acc: 0.089
Validation loss decreased (-0.077506 --> -0.089141).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9937824
	speed: 0.2454s/iter; left time: 4772.8945s
	iters: 200, epoch: 7 | loss: 2.7266586
	speed: 0.1213s/iter; left time: 2347.7939s
Epoch: 7 cost time: 23.225751638412476
Epoch: 7, Steps: 208 | Train Loss: 2.879 Vali Loss: 3.211 Vali Acc: 0.111 Test Loss: 3.211 Test Acc: 0.111
Validation loss decreased (-0.089141 --> -0.110615).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.9472935
	speed: 0.2668s/iter; left time: 5134.0204s
	iters: 200, epoch: 8 | loss: 2.7660720
	speed: 0.1381s/iter; left time: 2643.4242s
Epoch: 8 cost time: 26.415999174118042
Epoch: 8, Steps: 208 | Train Loss: 2.629 Vali Loss: 3.112 Vali Acc: 0.124 Test Loss: 3.112 Test Acc: 0.124
Validation loss decreased (-0.110615 --> -0.124335).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.7179105
	speed: 0.2368s/iter; left time: 4508.2638s
	iters: 200, epoch: 9 | loss: 2.4984753
	speed: 0.0958s/iter; left time: 1813.2686s
Epoch: 9 cost time: 19.488784074783325
Epoch: 9, Steps: 208 | Train Loss: 2.359 Vali Loss: 3.300 Vali Acc: 0.137 Test Loss: 3.300 Test Acc: 0.137
Validation loss decreased (-0.124335 --> -0.137456).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.6671741
	speed: 0.2809s/iter; left time: 5288.1268s
	iters: 200, epoch: 10 | loss: 2.3114533
	speed: 0.0906s/iter; left time: 1696.0182s
Epoch: 10 cost time: 22.17553949356079
Epoch: 10, Steps: 208 | Train Loss: 2.088 Vali Loss: 3.427 Vali Acc: 0.128 Test Loss: 3.427 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.3938459
	speed: 0.2604s/iter; left time: 4848.4787s
	iters: 200, epoch: 11 | loss: 2.0898824
	speed: 0.1099s/iter; left time: 2036.2435s
Epoch: 11 cost time: 23.58683156967163
Epoch: 11, Steps: 208 | Train Loss: 1.880 Vali Loss: 3.548 Vali Acc: 0.132 Test Loss: 3.548 Test Acc: 0.132
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.1115484
	speed: 0.2376s/iter; left time: 4374.0936s
	iters: 200, epoch: 12 | loss: 2.4450209
	speed: 0.1072s/iter; left time: 1963.8638s
Epoch: 12 cost time: 21.925334930419922
Epoch: 12, Steps: 208 | Train Loss: 1.631 Vali Loss: 3.885 Vali Acc: 0.136 Test Loss: 3.885 Test Acc: 0.136
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.0777102
	speed: 0.2536s/iter; left time: 4616.1138s
	iters: 200, epoch: 13 | loss: 1.5915627
	speed: 0.1012s/iter; left time: 1832.1897s
Epoch: 13 cost time: 21.959097146987915
Epoch: 13, Steps: 208 | Train Loss: 1.446 Vali Loss: 4.279 Vali Acc: 0.126 Test Loss: 4.279 Test Acc: 0.126
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.6440287
	speed: 0.2642s/iter; left time: 4755.5575s
	iters: 200, epoch: 14 | loss: 1.5659870
	speed: 0.1074s/iter; left time: 1921.2783s
Epoch: 14 cost time: 23.715866804122925
Epoch: 14, Steps: 208 | Train Loss: 1.263 Vali Loss: 4.573 Vali Acc: 0.129 Test Loss: 4.573 Test Acc: 0.129
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.3013474
	speed: 0.2526s/iter; left time: 4493.6819s
	iters: 200, epoch: 15 | loss: 1.0484145
	speed: 0.1096s/iter; left time: 1939.2503s
Epoch: 15 cost time: 22.941922903060913
Epoch: 15, Steps: 208 | Train Loss: 1.158 Vali Loss: 4.456 Vali Acc: 0.132 Test Loss: 4.456 Test Acc: 0.132
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.6547663
	speed: 0.2412s/iter; left time: 4239.8083s
	iters: 200, epoch: 16 | loss: 0.7515781
	speed: 0.1081s/iter; left time: 1890.3771s
Epoch: 16 cost time: 22.06855034828186
Epoch: 16, Steps: 208 | Train Loss: 1.073 Vali Loss: 5.288 Vali Acc: 0.122 Test Loss: 5.288 Test Acc: 0.122
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.8953362
	speed: 0.2610s/iter; left time: 4535.1323s
	iters: 200, epoch: 17 | loss: 0.7607359
	speed: 0.1139s/iter; left time: 1966.9091s
Epoch: 17 cost time: 24.460489749908447
Epoch: 17, Steps: 208 | Train Loss: 0.993 Vali Loss: 5.822 Vali Acc: 0.133 Test Loss: 5.822 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.1255131
	speed: 0.2596s/iter; left time: 4456.5086s
	iters: 200, epoch: 18 | loss: 1.2677121
	speed: 0.0922s/iter; left time: 1573.9006s
Epoch: 18 cost time: 21.37452721595764
Epoch: 18, Steps: 208 | Train Loss: 0.988 Vali Loss: 5.559 Vali Acc: 0.119 Test Loss: 5.559 Test Acc: 0.119
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 1.3740759
	speed: 0.2315s/iter; left time: 3925.6264s
	iters: 200, epoch: 19 | loss: 1.5910653
	speed: 0.1238s/iter; left time: 2087.5125s
Epoch: 19 cost time: 23.110255479812622
Epoch: 19, Steps: 208 | Train Loss: 0.982 Vali Loss: 5.379 Vali Acc: 0.126 Test Loss: 5.379 Test Acc: 0.126
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13748881598568446
model parameter : 2576971
model size : 12.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.8243780
	speed: 0.1264s/iter; left time: 2617.4631s
	iters: 200, epoch: 1 | loss: 3.8199751
	speed: 0.1132s/iter; left time: 2332.1744s
Epoch: 1 cost time: 25.092047691345215
Epoch: 1, Steps: 208 | Train Loss: 4.321 Vali Loss: 4.310 Vali Acc: 0.051 Test Loss: 4.310 Test Acc: 0.051
Validation loss decreased (inf --> -0.051254).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3563008
	speed: 0.2888s/iter; left time: 5918.3136s
	iters: 200, epoch: 2 | loss: 3.7908967
	speed: 0.0893s/iter; left time: 1821.0570s
Epoch: 2 cost time: 22.891961812973022
Epoch: 2, Steps: 208 | Train Loss: 3.923 Vali Loss: 3.707 Vali Acc: 0.052 Test Loss: 3.707 Test Acc: 0.052
Validation loss decreased (-0.051254 --> -0.051857).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3703752
	speed: 0.1958s/iter; left time: 3971.1255s
	iters: 200, epoch: 3 | loss: 3.1617460
	speed: 0.0708s/iter; left time: 1428.6651s
Epoch: 3 cost time: 14.848815202713013
Epoch: 3, Steps: 208 | Train Loss: 3.735 Vali Loss: 3.746 Vali Acc: 0.072 Test Loss: 3.746 Test Acc: 0.072
Validation loss decreased (-0.051857 --> -0.071838).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.1207092
	speed: 0.2569s/iter; left time: 5157.4134s
	iters: 200, epoch: 4 | loss: 3.7047882
	speed: 0.0946s/iter; left time: 1890.5666s
Epoch: 4 cost time: 20.951067686080933
Epoch: 4, Steps: 208 | Train Loss: 3.462 Vali Loss: 3.599 Vali Acc: 0.075 Test Loss: 3.599 Test Acc: 0.075
Validation loss decreased (-0.071838 --> -0.075121).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3225062
	speed: 0.2344s/iter; left time: 4656.3016s
	iters: 200, epoch: 5 | loss: 3.2252371
	speed: 0.1004s/iter; left time: 1984.5011s
Epoch: 5 cost time: 20.636945724487305
Epoch: 5, Steps: 208 | Train Loss: 3.280 Vali Loss: 3.315 Vali Acc: 0.089 Test Loss: 3.315 Test Acc: 0.089
Validation loss decreased (-0.075121 --> -0.089439).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.8656485
	speed: 0.2322s/iter; left time: 4565.2114s
	iters: 200, epoch: 6 | loss: 3.0908227
	speed: 0.1178s/iter; left time: 2304.6252s
Epoch: 6 cost time: 22.66795825958252
Epoch: 6, Steps: 208 | Train Loss: 3.090 Vali Loss: 3.243 Vali Acc: 0.101 Test Loss: 3.243 Test Acc: 0.101
Validation loss decreased (-0.089439 --> -0.101369).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.0675452
	speed: 0.2432s/iter; left time: 4731.2193s
	iters: 200, epoch: 7 | loss: 3.1654742
	speed: 0.1052s/iter; left time: 2035.5580s
Epoch: 7 cost time: 22.362353324890137
Epoch: 7, Steps: 208 | Train Loss: 2.920 Vali Loss: 3.254 Vali Acc: 0.099 Test Loss: 3.254 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.8943760
	speed: 0.2526s/iter; left time: 4860.3452s
	iters: 200, epoch: 8 | loss: 2.9234827
	speed: 0.0973s/iter; left time: 1862.9601s
Epoch: 8 cost time: 21.903681993484497
Epoch: 8, Steps: 208 | Train Loss: 2.664 Vali Loss: 3.169 Vali Acc: 0.122 Test Loss: 3.169 Test Acc: 0.122
Validation loss decreased (-0.101369 --> -0.121650).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.2425597
	speed: 0.2718s/iter; left time: 5174.9426s
	iters: 200, epoch: 9 | loss: 2.0517597
	speed: 0.1080s/iter; left time: 2044.7543s
Epoch: 9 cost time: 23.691064596176147
Epoch: 9, Steps: 208 | Train Loss: 2.435 Vali Loss: 3.298 Vali Acc: 0.124 Test Loss: 3.298 Test Acc: 0.124
Validation loss decreased (-0.121650 --> -0.124333).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.5181746
	speed: 0.2445s/iter; left time: 4602.9237s
	iters: 200, epoch: 10 | loss: 2.5814307
	speed: 0.1003s/iter; left time: 1878.5951s
Epoch: 10 cost time: 21.373615026474
Epoch: 10, Steps: 208 | Train Loss: 2.191 Vali Loss: 3.331 Vali Acc: 0.128 Test Loss: 3.331 Test Acc: 0.128
Validation loss decreased (-0.124333 --> -0.128210).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.6665428
	speed: 0.2500s/iter; left time: 4654.5624s
	iters: 200, epoch: 11 | loss: 2.6450646
	speed: 0.0994s/iter; left time: 1841.8790s
Epoch: 11 cost time: 21.151694536209106
Epoch: 11, Steps: 208 | Train Loss: 1.952 Vali Loss: 3.631 Vali Acc: 0.129 Test Loss: 3.631 Test Acc: 0.129
Validation loss decreased (-0.128210 --> -0.129102).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.0206089
	speed: 0.2670s/iter; left time: 4916.9484s
	iters: 200, epoch: 12 | loss: 1.5782924
	speed: 0.1273s/iter; left time: 2331.8573s
Epoch: 12 cost time: 25.40442156791687
Epoch: 12, Steps: 208 | Train Loss: 1.747 Vali Loss: 3.872 Vali Acc: 0.135 Test Loss: 3.872 Test Acc: 0.135
Validation loss decreased (-0.129102 --> -0.134468).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.0201397
	speed: 0.2321s/iter; left time: 4225.1295s
	iters: 200, epoch: 13 | loss: 1.6762505
	speed: 0.0810s/iter; left time: 1466.9605s
Epoch: 13 cost time: 16.678111791610718
Epoch: 13, Steps: 208 | Train Loss: 1.549 Vali Loss: 4.052 Vali Acc: 0.128 Test Loss: 4.052 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.9865308
	speed: 0.2540s/iter; left time: 4570.6748s
	iters: 200, epoch: 14 | loss: 1.1179537
	speed: 0.1057s/iter; left time: 1891.7643s
Epoch: 14 cost time: 23.518380403518677
Epoch: 14, Steps: 208 | Train Loss: 1.357 Vali Loss: 4.513 Vali Acc: 0.130 Test Loss: 4.513 Test Acc: 0.130
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 2.3143585
	speed: 0.2689s/iter; left time: 4782.9736s
	iters: 200, epoch: 15 | loss: 1.3560174
	speed: 0.0988s/iter; left time: 1747.1782s
Epoch: 15 cost time: 22.343708038330078
Epoch: 15, Steps: 208 | Train Loss: 1.257 Vali Loss: 4.533 Vali Acc: 0.123 Test Loss: 4.533 Test Acc: 0.123
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.3938619
	speed: 0.2379s/iter; left time: 4183.3739s
	iters: 200, epoch: 16 | loss: 1.4022139
	speed: 0.1031s/iter; left time: 1802.9998s
Epoch: 16 cost time: 21.656446933746338
Epoch: 16, Steps: 208 | Train Loss: 1.143 Vali Loss: 4.854 Vali Acc: 0.120 Test Loss: 4.854 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.6223174
	speed: 0.2405s/iter; left time: 4178.3170s
	iters: 200, epoch: 17 | loss: 0.8788218
	speed: 0.1056s/iter; left time: 1824.2452s
Epoch: 17 cost time: 20.68878698348999
Epoch: 17, Steps: 208 | Train Loss: 1.112 Vali Loss: 5.186 Vali Acc: 0.121 Test Loss: 5.186 Test Acc: 0.121
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.8568280
	speed: 0.2369s/iter; left time: 4065.6186s
	iters: 200, epoch: 18 | loss: 1.3519901
	speed: 0.1141s/iter; left time: 1946.4050s
Epoch: 18 cost time: 22.620450019836426
Epoch: 18, Steps: 208 | Train Loss: 1.009 Vali Loss: 5.184 Vali Acc: 0.119 Test Loss: 5.184 Test Acc: 0.119
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 1.4464039
	speed: 0.2418s/iter; left time: 4100.7992s
	iters: 200, epoch: 19 | loss: 1.4654702
	speed: 0.0725s/iter; left time: 1222.9509s
Epoch: 19 cost time: 17.848575353622437
Epoch: 19, Steps: 208 | Train Loss: 0.980 Vali Loss: 5.425 Vali Acc: 0.125 Test Loss: 5.425 Test Acc: 0.125
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.6263650
	speed: 0.1676s/iter; left time: 2806.4025s
	iters: 200, epoch: 20 | loss: 0.8528202
	speed: 0.0731s/iter; left time: 1216.5494s
Epoch: 20 cost time: 14.140619039535522
Epoch: 20, Steps: 208 | Train Loss: 0.903 Vali Loss: 5.726 Vali Acc: 0.126 Test Loss: 5.726 Test Acc: 0.126
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.6051348
	speed: 0.2566s/iter; left time: 4245.1979s
	iters: 200, epoch: 21 | loss: 0.7775797
	speed: 0.0996s/iter; left time: 1636.8935s
Epoch: 21 cost time: 22.636335134506226
Epoch: 21, Steps: 208 | Train Loss: 0.870 Vali Loss: 5.538 Vali Acc: 0.115 Test Loss: 5.538 Test Acc: 0.115
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 1.5463585
	speed: 0.2405s/iter; left time: 3928.7685s
	iters: 200, epoch: 22 | loss: 0.7820951
	speed: 0.0909s/iter; left time: 1475.7820s
Epoch: 22 cost time: 20.582298278808594
Epoch: 22, Steps: 208 | Train Loss: 0.879 Vali Loss: 6.101 Vali Acc: 0.121 Test Loss: 6.101 Test Acc: 0.121
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13450641216820758
model parameter : 2573259
model size : 12.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.3220692
	speed: 0.1480s/iter; left time: 3062.8012s
	iters: 200, epoch: 1 | loss: 4.7215414
	speed: 0.0980s/iter; left time: 2018.9418s
Epoch: 1 cost time: 25.826272010803223
Epoch: 1, Steps: 208 | Train Loss: 4.341 Vali Loss: 4.366 Vali Acc: 0.042 Test Loss: 4.366 Test Acc: 0.042
Validation loss decreased (inf --> -0.042008).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6742928
	speed: 0.2908s/iter; left time: 5959.6206s
	iters: 200, epoch: 2 | loss: 3.6492047
	speed: 0.1362s/iter; left time: 2777.1118s
Epoch: 2 cost time: 27.945780277252197
Epoch: 2, Steps: 208 | Train Loss: 3.809 Vali Loss: 4.077 Vali Acc: 0.043 Test Loss: 4.077 Test Acc: 0.043
Validation loss decreased (-0.042008 --> -0.042906).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3289423
	speed: 0.2970s/iter; left time: 6025.3599s
	iters: 200, epoch: 3 | loss: 3.3804851
	speed: 0.1154s/iter; left time: 2330.1127s
Epoch: 3 cost time: 26.148098707199097
Epoch: 3, Steps: 208 | Train Loss: 3.656 Vali Loss: 3.754 Vali Acc: 0.054 Test Loss: 3.754 Test Acc: 0.054
Validation loss decreased (-0.042906 --> -0.054242).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3411345
	speed: 0.2692s/iter; left time: 5404.6050s
	iters: 200, epoch: 4 | loss: 3.1929750
	speed: 0.1075s/iter; left time: 2148.1015s
Epoch: 4 cost time: 23.429721117019653
Epoch: 4, Steps: 208 | Train Loss: 3.509 Vali Loss: 3.593 Vali Acc: 0.078 Test Loss: 3.593 Test Acc: 0.078
Validation loss decreased (-0.054242 --> -0.078103).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3404689
	speed: 0.2723s/iter; left time: 5410.0209s
	iters: 200, epoch: 5 | loss: 3.6937380
	speed: 0.1117s/iter; left time: 2207.7290s
Epoch: 5 cost time: 25.13709831237793
Epoch: 5, Steps: 208 | Train Loss: 3.291 Vali Loss: 3.407 Vali Acc: 0.081 Test Loss: 3.407 Test Acc: 0.081
Validation loss decreased (-0.078103 --> -0.081386).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0879190
	speed: 0.2700s/iter; left time: 5308.6743s
	iters: 200, epoch: 6 | loss: 3.4962311
	speed: 0.1062s/iter; left time: 2078.2933s
Epoch: 6 cost time: 24.06858515739441
Epoch: 6, Steps: 208 | Train Loss: 3.130 Vali Loss: 3.357 Vali Acc: 0.098 Test Loss: 3.357 Test Acc: 0.098
Validation loss decreased (-0.081386 --> -0.098088).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9250445
	speed: 0.2663s/iter; left time: 5179.8060s
	iters: 200, epoch: 7 | loss: 2.9986165
	speed: 0.1336s/iter; left time: 2586.4758s
Epoch: 7 cost time: 26.475525617599487
Epoch: 7, Steps: 208 | Train Loss: 2.933 Vali Loss: 3.186 Vali Acc: 0.115 Test Loss: 3.186 Test Acc: 0.115
Validation loss decreased (-0.098088 --> -0.115089).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.4826818
	speed: 0.2704s/iter; left time: 5204.6189s
	iters: 200, epoch: 8 | loss: 3.1001990
	speed: 0.1207s/iter; left time: 2310.7302s
Epoch: 8 cost time: 24.847211122512817
Epoch: 8, Steps: 208 | Train Loss: 2.659 Vali Loss: 3.222 Vali Acc: 0.135 Test Loss: 3.222 Test Acc: 0.135
Validation loss decreased (-0.115089 --> -0.135369).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.8885604
	speed: 0.2533s/iter; left time: 4821.3716s
	iters: 200, epoch: 9 | loss: 2.8562989
	speed: 0.1185s/iter; left time: 2243.4271s
Epoch: 9 cost time: 23.648048877716064
Epoch: 9, Steps: 208 | Train Loss: 2.407 Vali Loss: 3.247 Vali Acc: 0.123 Test Loss: 3.247 Test Acc: 0.123
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.9152063
	speed: 0.2528s/iter; left time: 4759.3890s
	iters: 200, epoch: 10 | loss: 1.5727862
	speed: 0.1351s/iter; left time: 2529.9856s
Epoch: 10 cost time: 25.96495246887207
Epoch: 10, Steps: 208 | Train Loss: 2.166 Vali Loss: 3.548 Vali Acc: 0.126 Test Loss: 3.548 Test Acc: 0.126
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.6801045
	speed: 0.2568s/iter; left time: 4781.3614s
	iters: 200, epoch: 11 | loss: 2.0590661
	speed: 0.1079s/iter; left time: 1998.1360s
Epoch: 11 cost time: 22.992647171020508
Epoch: 11, Steps: 208 | Train Loss: 1.938 Vali Loss: 3.714 Vali Acc: 0.128 Test Loss: 3.714 Test Acc: 0.128
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.7078811
	speed: 0.2458s/iter; left time: 4526.0385s
	iters: 200, epoch: 12 | loss: 1.4923134
	speed: 0.1117s/iter; left time: 2045.8748s
Epoch: 12 cost time: 23.07858657836914
Epoch: 12, Steps: 208 | Train Loss: 1.702 Vali Loss: 4.233 Vali Acc: 0.129 Test Loss: 4.233 Test Acc: 0.129
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.3300065
	speed: 0.2886s/iter; left time: 5253.7551s
	iters: 200, epoch: 13 | loss: 1.0209305
	speed: 0.1405s/iter; left time: 2544.2741s
Epoch: 13 cost time: 28.044487714767456
Epoch: 13, Steps: 208 | Train Loss: 1.488 Vali Loss: 4.125 Vali Acc: 0.117 Test Loss: 4.125 Test Acc: 0.117
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.9240487
	speed: 0.2936s/iter; left time: 5283.4400s
	iters: 200, epoch: 14 | loss: 1.5895047
	speed: 0.1203s/iter; left time: 2152.7628s
Epoch: 14 cost time: 26.06773829460144
Epoch: 14, Steps: 208 | Train Loss: 1.339 Vali Loss: 4.196 Vali Acc: 0.128 Test Loss: 4.196 Test Acc: 0.128
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.8219822
	speed: 0.1996s/iter; left time: 3549.8091s
	iters: 200, epoch: 15 | loss: 1.1261748
	speed: 0.0556s/iter; left time: 983.6725s
Epoch: 15 cost time: 12.338283777236938
Epoch: 15, Steps: 208 | Train Loss: 1.195 Vali Loss: 4.646 Vali Acc: 0.132 Test Loss: 4.646 Test Acc: 0.132
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.1617975
	speed: 0.2584s/iter; left time: 4542.8026s
	iters: 200, epoch: 16 | loss: 0.9752780
	speed: 0.1143s/iter; left time: 1997.3869s
Epoch: 16 cost time: 24.880269289016724
Epoch: 16, Steps: 208 | Train Loss: 1.128 Vali Loss: 4.708 Vali Acc: 0.127 Test Loss: 4.708 Test Acc: 0.127
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.0259674
	speed: 0.2441s/iter; left time: 4240.5586s
	iters: 200, epoch: 17 | loss: 1.7719048
	speed: 0.1041s/iter; left time: 1798.2038s
Epoch: 17 cost time: 21.147005558013916
Epoch: 17, Steps: 208 | Train Loss: 1.067 Vali Loss: 5.109 Vali Acc: 0.121 Test Loss: 5.109 Test Acc: 0.121
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 1.4157372
	speed: 0.2538s/iter; left time: 4356.3666s
	iters: 200, epoch: 18 | loss: 1.7160481
	speed: 0.1074s/iter; left time: 1833.4000s
Epoch: 18 cost time: 22.897921562194824
Epoch: 18, Steps: 208 | Train Loss: 1.003 Vali Loss: 5.214 Vali Acc: 0.123 Test Loss: 5.214 Test Acc: 0.123
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13540113331345063
model parameter : 2255435
model size : 11.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6347020
	speed: 0.1194s/iter; left time: 2471.7078s
	iters: 200, epoch: 1 | loss: 5.1877351
	speed: 0.0999s/iter; left time: 2057.1682s
Epoch: 1 cost time: 22.362446784973145
Epoch: 1, Steps: 208 | Train Loss: 4.337 Vali Loss: 4.340 Vali Acc: 0.050 Test Loss: 4.340 Test Acc: 0.050
Validation loss decreased (inf --> -0.049763).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.6274281
	speed: 0.2392s/iter; left time: 4901.4687s
	iters: 200, epoch: 2 | loss: 4.1931977
	speed: 0.1120s/iter; left time: 2284.3177s
Epoch: 2 cost time: 21.454915285110474
Epoch: 2, Steps: 208 | Train Loss: 4.400 Vali Loss: 4.047 Vali Acc: 0.049 Test Loss: 4.047 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.3264172
	speed: 0.2532s/iter; left time: 5136.3150s
	iters: 200, epoch: 3 | loss: 3.5542724
	speed: 0.1194s/iter; left time: 2409.4138s
Epoch: 3 cost time: 23.979177951812744
Epoch: 3, Steps: 208 | Train Loss: 3.809 Vali Loss: 3.845 Vali Acc: 0.049 Test Loss: 3.845 Test Acc: 0.049
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 3.5333958
	speed: 0.2551s/iter; left time: 5121.7880s
	iters: 200, epoch: 4 | loss: 3.4304273
	speed: 0.1051s/iter; left time: 2100.4549s
Epoch: 4 cost time: 22.005191802978516
Epoch: 4, Steps: 208 | Train Loss: 3.500 Vali Loss: 3.530 Vali Acc: 0.075 Test Loss: 3.530 Test Acc: 0.075
Validation loss decreased (-0.049763 --> -0.074823).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2059422
	speed: 0.2485s/iter; left time: 4936.7816s
	iters: 200, epoch: 5 | loss: 2.8537428
	speed: 0.1089s/iter; left time: 2152.7143s
Epoch: 5 cost time: 22.683939933776855
Epoch: 5, Steps: 208 | Train Loss: 3.236 Vali Loss: 3.320 Vali Acc: 0.080 Test Loss: 3.320 Test Acc: 0.080
Validation loss decreased (-0.074823 --> -0.079597).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2516475
	speed: 0.2495s/iter; left time: 4905.0690s
	iters: 200, epoch: 6 | loss: 2.8995986
	speed: 0.0850s/iter; left time: 1662.7474s
Epoch: 6 cost time: 19.46280860900879
Epoch: 6, Steps: 208 | Train Loss: 3.031 Vali Loss: 3.397 Vali Acc: 0.098 Test Loss: 3.397 Test Acc: 0.098
Validation loss decreased (-0.079597 --> -0.098385).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.0971718
	speed: 0.2823s/iter; left time: 5490.9969s
	iters: 200, epoch: 7 | loss: 2.7499573
	speed: 0.0989s/iter; left time: 1913.2133s
Epoch: 7 cost time: 23.408729314804077
Epoch: 7, Steps: 208 | Train Loss: 2.821 Vali Loss: 3.312 Vali Acc: 0.119 Test Loss: 3.312 Test Acc: 0.119
Validation loss decreased (-0.098385 --> -0.118965).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.2209160
	speed: 0.2723s/iter; left time: 5241.3533s
	iters: 200, epoch: 8 | loss: 2.6524253
	speed: 0.1040s/iter; left time: 1990.2855s
Epoch: 8 cost time: 22.71503448486328
Epoch: 8, Steps: 208 | Train Loss: 2.582 Vali Loss: 3.205 Vali Acc: 0.123 Test Loss: 3.205 Test Acc: 0.123
Validation loss decreased (-0.118965 --> -0.122843).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.1991236
	speed: 0.2462s/iter; left time: 4685.9813s
	iters: 200, epoch: 9 | loss: 2.6972237
	speed: 0.1159s/iter; left time: 2194.5221s
Epoch: 9 cost time: 23.00303602218628
Epoch: 9, Steps: 208 | Train Loss: 2.276 Vali Loss: 3.333 Vali Acc: 0.121 Test Loss: 3.333 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.1200697
	speed: 0.2403s/iter; left time: 4524.2780s
	iters: 200, epoch: 10 | loss: 1.8692832
	speed: 0.1060s/iter; left time: 1985.1348s
Epoch: 10 cost time: 20.973952293395996
Epoch: 10, Steps: 208 | Train Loss: 2.008 Vali Loss: 3.555 Vali Acc: 0.143 Test Loss: 3.555 Test Acc: 0.143
Validation loss decreased (-0.122843 --> -0.143418).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5206125
	speed: 0.2437s/iter; left time: 4537.5230s
	iters: 200, epoch: 11 | loss: 2.1298318
	speed: 0.1095s/iter; left time: 2028.4114s
Epoch: 11 cost time: 22.42308259010315
Epoch: 11, Steps: 208 | Train Loss: 1.692 Vali Loss: 3.925 Vali Acc: 0.137 Test Loss: 3.925 Test Acc: 0.137
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.7076169
	speed: 0.2529s/iter; left time: 4656.2489s
	iters: 200, epoch: 12 | loss: 1.8933973
	speed: 0.1009s/iter; left time: 1847.5567s
Epoch: 12 cost time: 21.501596450805664
Epoch: 12, Steps: 208 | Train Loss: 1.516 Vali Loss: 4.043 Vali Acc: 0.136 Test Loss: 4.043 Test Acc: 0.136
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.5178922
	speed: 0.1998s/iter; left time: 3637.5056s
	iters: 200, epoch: 13 | loss: 1.4852208
	speed: 0.0522s/iter; left time: 945.3030s
Epoch: 13 cost time: 12.523367881774902
Epoch: 13, Steps: 208 | Train Loss: 1.274 Vali Loss: 4.626 Vali Acc: 0.130 Test Loss: 4.626 Test Acc: 0.130
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.1875659
	speed: 0.2310s/iter; left time: 4157.6100s
	iters: 200, epoch: 14 | loss: 1.3602819
	speed: 0.0937s/iter; left time: 1676.8931s
Epoch: 14 cost time: 21.84678864479065
Epoch: 14, Steps: 208 | Train Loss: 1.134 Vali Loss: 4.722 Vali Acc: 0.134 Test Loss: 4.722 Test Acc: 0.134
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.6581317
	speed: 0.2486s/iter; left time: 4422.5489s
	iters: 200, epoch: 15 | loss: 0.4408627
	speed: 0.1044s/iter; left time: 1847.1866s
Epoch: 15 cost time: 21.960882902145386
Epoch: 15, Steps: 208 | Train Loss: 1.013 Vali Loss: 5.336 Vali Acc: 0.132 Test Loss: 5.336 Test Acc: 0.132
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.0183259
	speed: 0.2469s/iter; left time: 4340.1886s
	iters: 200, epoch: 16 | loss: 1.2243811
	speed: 0.0971s/iter; left time: 1697.0160s
Epoch: 16 cost time: 21.779148817062378
Epoch: 16, Steps: 208 | Train Loss: 0.957 Vali Loss: 5.518 Vali Acc: 0.126 Test Loss: 5.518 Test Acc: 0.126
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.8961360
	speed: 0.2838s/iter; left time: 4930.7698s
	iters: 200, epoch: 17 | loss: 1.3484012
	speed: 0.0936s/iter; left time: 1616.4415s
Epoch: 17 cost time: 21.966874361038208
Epoch: 17, Steps: 208 | Train Loss: 0.929 Vali Loss: 5.313 Vali Acc: 0.123 Test Loss: 5.313 Test Acc: 0.123
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.7830799
	speed: 0.2638s/iter; left time: 4528.2301s
	iters: 200, epoch: 18 | loss: 0.8974033
	speed: 0.1044s/iter; left time: 1782.0628s
Epoch: 18 cost time: 22.36316466331482
Epoch: 18, Steps: 208 | Train Loss: 0.884 Vali Loss: 5.873 Vali Acc: 0.134 Test Loss: 5.873 Test Acc: 0.134
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 1.1629814
	speed: 0.2575s/iter; left time: 4366.5119s
	iters: 200, epoch: 19 | loss: 0.7282596
	speed: 0.1306s/iter; left time: 2201.3468s
Epoch: 19 cost time: 23.784982442855835
Epoch: 19, Steps: 208 | Train Loss: 0.857 Vali Loss: 5.727 Vali Acc: 0.129 Test Loss: 5.727 Test Acc: 0.129
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.7484207
	speed: 0.2518s/iter; left time: 4217.0994s
	iters: 200, epoch: 20 | loss: 0.8270882
	speed: 0.1040s/iter; left time: 1731.0638s
Epoch: 20 cost time: 21.588521003723145
Epoch: 20, Steps: 208 | Train Loss: 0.799 Vali Loss: 5.735 Vali Acc: 0.133 Test Loss: 5.735 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.14345362362063824
model parameter : 2251723
model size : 11.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9012423
	speed: 0.1116s/iter; left time: 2310.7214s
	iters: 200, epoch: 1 | loss: 3.9249928
	speed: 0.0979s/iter; left time: 2017.7918s
Epoch: 1 cost time: 21.522921562194824
Epoch: 1, Steps: 208 | Train Loss: 4.326 Vali Loss: 4.868 Vali Acc: 0.042 Test Loss: 4.868 Test Acc: 0.042
Validation loss decreased (inf --> -0.041705).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6108036
	speed: 0.2311s/iter; left time: 4735.9292s
	iters: 200, epoch: 2 | loss: 3.4202144
	speed: 0.1064s/iter; left time: 2170.7678s
Epoch: 2 cost time: 21.947255849838257
Epoch: 2, Steps: 208 | Train Loss: 3.960 Vali Loss: 3.831 Vali Acc: 0.058 Test Loss: 3.831 Test Acc: 0.058
Validation loss decreased (-0.041705 --> -0.057820).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.2428136
	speed: 0.2476s/iter; left time: 5021.6782s
	iters: 200, epoch: 3 | loss: 3.5155866
	speed: 0.1037s/iter; left time: 2092.7173s
Epoch: 3 cost time: 21.963526725769043
Epoch: 3, Steps: 208 | Train Loss: 3.706 Vali Loss: 3.862 Vali Acc: 0.068 Test Loss: 3.862 Test Acc: 0.068
Validation loss decreased (-0.057820 --> -0.067662).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.2243156
	speed: 0.2519s/iter; left time: 5058.1827s
	iters: 200, epoch: 4 | loss: 3.5163248
	speed: 0.1076s/iter; left time: 2149.1035s
Epoch: 4 cost time: 22.465714693069458
Epoch: 4, Steps: 208 | Train Loss: 3.503 Vali Loss: 3.462 Vali Acc: 0.086 Test Loss: 3.462 Test Acc: 0.086
Validation loss decreased (-0.067662 --> -0.085560).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.7022769
	speed: 0.2443s/iter; left time: 4854.9182s
	iters: 200, epoch: 5 | loss: 3.1041739
	speed: 0.1119s/iter; left time: 2211.6918s
Epoch: 5 cost time: 21.76449704170227
Epoch: 5, Steps: 208 | Train Loss: 3.310 Vali Loss: 3.377 Vali Acc: 0.086 Test Loss: 3.377 Test Acc: 0.086
Validation loss decreased (-0.085560 --> -0.086456).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.8911037
	speed: 0.2341s/iter; left time: 4601.7899s
	iters: 200, epoch: 6 | loss: 3.3418128
	speed: 0.1061s/iter; left time: 2075.4233s
Epoch: 6 cost time: 21.51171565055847
Epoch: 6, Steps: 208 | Train Loss: 3.153 Vali Loss: 3.219 Vali Acc: 0.094 Test Loss: 3.219 Test Acc: 0.094
Validation loss decreased (-0.086456 --> -0.093914).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.8737888
	speed: 0.2497s/iter; left time: 4857.6871s
	iters: 200, epoch: 7 | loss: 3.4486189
	speed: 0.1044s/iter; left time: 2019.9262s
Epoch: 7 cost time: 21.973780393600464
Epoch: 7, Steps: 208 | Train Loss: 2.944 Vali Loss: 3.238 Vali Acc: 0.110 Test Loss: 3.238 Test Acc: 0.110
Validation loss decreased (-0.093914 --> -0.110317).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.8843164
	speed: 0.2623s/iter; left time: 5048.0751s
	iters: 200, epoch: 8 | loss: 2.8145413
	speed: 0.1048s/iter; left time: 2005.5846s
Epoch: 8 cost time: 23.155895948410034
Epoch: 8, Steps: 208 | Train Loss: 2.726 Vali Loss: 3.204 Vali Acc: 0.111 Test Loss: 3.204 Test Acc: 0.111
Validation loss decreased (-0.110317 --> -0.110615).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.3744147
	speed: 0.2631s/iter; left time: 5008.3433s
	iters: 200, epoch: 9 | loss: 2.2578821
	speed: 0.0996s/iter; left time: 1886.6225s
Epoch: 9 cost time: 22.072003841400146
Epoch: 9, Steps: 208 | Train Loss: 2.420 Vali Loss: 3.277 Vali Acc: 0.126 Test Loss: 3.277 Test Acc: 0.126
Validation loss decreased (-0.110615 --> -0.126421).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.6799040
	speed: 0.2096s/iter; left time: 3946.0007s
	iters: 200, epoch: 10 | loss: 2.2326133
	speed: 0.0469s/iter; left time: 878.5785s
Epoch: 10 cost time: 10.995442152023315
Epoch: 10, Steps: 208 | Train Loss: 2.138 Vali Loss: 3.535 Vali Acc: 0.130 Test Loss: 3.535 Test Acc: 0.130
Validation loss decreased (-0.126421 --> -0.130296).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.9628123
	speed: 0.2126s/iter; left time: 3958.6286s
	iters: 200, epoch: 11 | loss: 2.1633072
	speed: 0.0689s/iter; left time: 1276.2206s
Epoch: 11 cost time: 17.258968591690063
Epoch: 11, Steps: 208 | Train Loss: 1.914 Vali Loss: 3.700 Vali Acc: 0.126 Test Loss: 3.700 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.5246389
	speed: 0.2230s/iter; left time: 4105.6929s
	iters: 200, epoch: 12 | loss: 2.1057432
	speed: 0.1012s/iter; left time: 1853.4492s
Epoch: 12 cost time: 20.771479845046997
Epoch: 12, Steps: 208 | Train Loss: 1.630 Vali Loss: 3.904 Vali Acc: 0.126 Test Loss: 3.904 Test Acc: 0.126
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.9679426
	speed: 0.2353s/iter; left time: 4282.9146s
	iters: 200, epoch: 13 | loss: 1.0367801
	speed: 0.1040s/iter; left time: 1883.2384s
Epoch: 13 cost time: 21.05667757987976
Epoch: 13, Steps: 208 | Train Loss: 1.462 Vali Loss: 4.131 Vali Acc: 0.129 Test Loss: 4.131 Test Acc: 0.129
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.3867602
	speed: 0.2417s/iter; left time: 4349.9568s
	iters: 200, epoch: 14 | loss: 1.4699724
	speed: 0.1068s/iter; left time: 1912.1746s
Epoch: 14 cost time: 22.131864309310913
Epoch: 14, Steps: 208 | Train Loss: 1.251 Vali Loss: 4.393 Vali Acc: 0.122 Test Loss: 4.393 Test Acc: 0.122
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.3023586
	speed: 0.2225s/iter; left time: 3958.7587s
	iters: 200, epoch: 15 | loss: 1.4784409
	speed: 0.1024s/iter; left time: 1811.3804s
Epoch: 15 cost time: 19.153257131576538
Epoch: 15, Steps: 208 | Train Loss: 1.145 Vali Loss: 4.710 Vali Acc: 0.118 Test Loss: 4.710 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.1923288
	speed: 0.2315s/iter; left time: 4069.4441s
	iters: 200, epoch: 16 | loss: 1.5403633
	speed: 0.0958s/iter; left time: 1675.1435s
Epoch: 16 cost time: 20.24882745742798
Epoch: 16, Steps: 208 | Train Loss: 1.041 Vali Loss: 4.933 Vali Acc: 0.135 Test Loss: 4.933 Test Acc: 0.135
Validation loss decreased (-0.130296 --> -0.135352).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.8638841
	speed: 0.2562s/iter; left time: 4451.4589s
	iters: 200, epoch: 17 | loss: 1.5939442
	speed: 0.1096s/iter; left time: 1893.0975s
Epoch: 17 cost time: 23.22485899925232
Epoch: 17, Steps: 208 | Train Loss: 0.993 Vali Loss: 4.778 Vali Acc: 0.115 Test Loss: 4.778 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.9122093
	speed: 0.2324s/iter; left time: 3988.5461s
	iters: 200, epoch: 18 | loss: 1.0122248
	speed: 0.0863s/iter; left time: 1472.5115s
Epoch: 18 cost time: 19.55186128616333
Epoch: 18, Steps: 208 | Train Loss: 0.947 Vali Loss: 5.469 Vali Acc: 0.113 Test Loss: 5.469 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.4303178
	speed: 0.2380s/iter; left time: 4036.0125s
	iters: 200, epoch: 19 | loss: 0.7611821
	speed: 0.0813s/iter; left time: 1370.3556s
Epoch: 19 cost time: 19.56454586982727
Epoch: 19, Steps: 208 | Train Loss: 0.908 Vali Loss: 5.185 Vali Acc: 0.126 Test Loss: 5.185 Test Acc: 0.126
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.8577564
	speed: 0.2385s/iter; left time: 3994.1329s
	iters: 200, epoch: 20 | loss: 0.8815967
	speed: 0.1143s/iter; left time: 1902.8124s
Epoch: 20 cost time: 22.851638555526733
Epoch: 20, Steps: 208 | Train Loss: 0.916 Vali Loss: 5.506 Vali Acc: 0.118 Test Loss: 5.506 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.6843635
	speed: 0.2522s/iter; left time: 4171.6837s
	iters: 200, epoch: 21 | loss: 0.4442214
	speed: 0.1122s/iter; left time: 1844.0192s
Epoch: 21 cost time: 22.463799715042114
Epoch: 21, Steps: 208 | Train Loss: 0.852 Vali Loss: 5.287 Vali Acc: 0.128 Test Loss: 5.287 Test Acc: 0.128
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.6124935
	speed: 0.2626s/iter; left time: 4289.8458s
	iters: 200, epoch: 22 | loss: 1.0377777
	speed: 0.1112s/iter; left time: 1804.7143s
Epoch: 22 cost time: 22.255277395248413
Epoch: 22, Steps: 208 | Train Loss: 0.823 Vali Loss: 5.726 Vali Acc: 0.116 Test Loss: 5.726 Test Acc: 0.116
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 1.1915338
	speed: 0.2644s/iter; left time: 4263.3228s
	iters: 200, epoch: 23 | loss: 1.3036067
	speed: 0.1060s/iter; left time: 1698.1347s
Epoch: 23 cost time: 23.19711399078369
Epoch: 23, Steps: 208 | Train Loss: 0.793 Vali Loss: 5.853 Vali Acc: 0.125 Test Loss: 5.853 Test Acc: 0.125
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 1.2851855
	speed: 0.2690s/iter; left time: 4282.1760s
	iters: 200, epoch: 24 | loss: 0.9344244
	speed: 0.1343s/iter; left time: 2123.7027s
Epoch: 24 cost time: 26.642625093460083
Epoch: 24, Steps: 208 | Train Loss: 0.796 Vali Loss: 5.638 Vali Acc: 0.123 Test Loss: 5.638 Test Acc: 0.123
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.6461174
	speed: 0.2123s/iter; left time: 3334.6604s
	iters: 200, epoch: 25 | loss: 0.8894414
	speed: 0.0890s/iter; left time: 1389.7714s
Epoch: 25 cost time: 16.628257751464844
Epoch: 25, Steps: 208 | Train Loss: 0.786 Vali Loss: 6.090 Vali Acc: 0.120 Test Loss: 6.090 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.2731747
	speed: 0.2238s/iter; left time: 3469.1477s
	iters: 200, epoch: 26 | loss: 1.0108689
	speed: 0.1105s/iter; left time: 1701.6701s
Epoch: 26 cost time: 22.31980609893799
Epoch: 26, Steps: 208 | Train Loss: 0.754 Vali Loss: 5.852 Vali Acc: 0.112 Test Loss: 5.852 Test Acc: 0.112
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13540113331345063
model parameter : 2248011
model size : 11.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1101856
	speed: 0.1077s/iter; left time: 2229.3814s
	iters: 200, epoch: 1 | loss: 5.1797152
	speed: 0.1028s/iter; left time: 2118.4569s
Epoch: 1 cost time: 21.87121605873108
Epoch: 1, Steps: 208 | Train Loss: 4.300 Vali Loss: 4.619 Vali Acc: 0.046 Test Loss: 4.619 Test Acc: 0.046
Validation loss decreased (inf --> -0.045883).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9341626
	speed: 0.2342s/iter; left time: 4799.9051s
	iters: 200, epoch: 2 | loss: 3.8109612
	speed: 0.1085s/iter; left time: 2212.4102s
Epoch: 2 cost time: 21.381516456604004
Epoch: 2, Steps: 208 | Train Loss: 3.988 Vali Loss: 3.894 Vali Acc: 0.045 Test Loss: 3.894 Test Acc: 0.045
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.8268518
	speed: 0.2265s/iter; left time: 4594.4929s
	iters: 200, epoch: 3 | loss: 3.4565768
	speed: 0.0937s/iter; left time: 1890.9676s
Epoch: 3 cost time: 19.755160808563232
Epoch: 3, Steps: 208 | Train Loss: 3.673 Vali Loss: 3.680 Vali Acc: 0.063 Test Loss: 3.680 Test Acc: 0.063
Validation loss decreased (-0.045883 --> -0.062594).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.8787451
	speed: 0.2346s/iter; left time: 4710.9448s
	iters: 200, epoch: 4 | loss: 3.4266119
	speed: 0.1012s/iter; left time: 2021.2854s
Epoch: 4 cost time: 20.749227046966553
Epoch: 4, Steps: 208 | Train Loss: 3.496 Vali Loss: 3.480 Vali Acc: 0.072 Test Loss: 3.480 Test Acc: 0.072
Validation loss decreased (-0.062594 --> -0.071543).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.0867724
	speed: 0.2329s/iter; left time: 4627.8979s
	iters: 200, epoch: 5 | loss: 3.0739760
	speed: 0.1078s/iter; left time: 2131.4543s
Epoch: 5 cost time: 21.004300832748413
Epoch: 5, Steps: 208 | Train Loss: 3.282 Vali Loss: 3.316 Vali Acc: 0.088 Test Loss: 3.316 Test Acc: 0.088
Validation loss decreased (-0.071543 --> -0.087650).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2433500
	speed: 0.2424s/iter; left time: 4766.1172s
	iters: 200, epoch: 6 | loss: 2.6894858
	speed: 0.0924s/iter; left time: 1807.4437s
Epoch: 6 cost time: 20.53074550628662
Epoch: 6, Steps: 208 | Train Loss: 3.134 Vali Loss: 3.201 Vali Acc: 0.095 Test Loss: 3.201 Test Acc: 0.095
Validation loss decreased (-0.087650 --> -0.095405).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.7186384
	speed: 0.2528s/iter; left time: 4918.4504s
	iters: 200, epoch: 7 | loss: 2.7889895
	speed: 0.0937s/iter; left time: 1812.8007s
Epoch: 7 cost time: 20.467414379119873
Epoch: 7, Steps: 208 | Train Loss: 2.942 Vali Loss: 3.258 Vali Acc: 0.118 Test Loss: 3.258 Test Acc: 0.118
Validation loss decreased (-0.095405 --> -0.117772).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.4106345
	speed: 0.2364s/iter; left time: 4550.0559s
	iters: 200, epoch: 8 | loss: 3.1929312
	speed: 0.0518s/iter; left time: 992.5190s
Epoch: 8 cost time: 13.6615469455719
Epoch: 8, Steps: 208 | Train Loss: 2.667 Vali Loss: 3.221 Vali Acc: 0.113 Test Loss: 3.221 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.4493759
	speed: 0.2419s/iter; left time: 4605.3837s
	iters: 200, epoch: 9 | loss: 2.4443154
	speed: 0.0921s/iter; left time: 1744.3766s
Epoch: 9 cost time: 21.167916536331177
Epoch: 9, Steps: 208 | Train Loss: 2.413 Vali Loss: 3.332 Vali Acc: 0.108 Test Loss: 3.332 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.8314574
	speed: 0.2554s/iter; left time: 4808.4056s
	iters: 200, epoch: 10 | loss: 1.8044770
	speed: 0.0938s/iter; left time: 1756.9524s
Epoch: 10 cost time: 21.223421812057495
Epoch: 10, Steps: 208 | Train Loss: 2.136 Vali Loss: 3.584 Vali Acc: 0.129 Test Loss: 3.584 Test Acc: 0.129
Validation loss decreased (-0.117772 --> -0.128506).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.8900065
	speed: 0.2254s/iter; left time: 4196.9411s
	iters: 200, epoch: 11 | loss: 1.7801564
	speed: 0.0728s/iter; left time: 1348.9835s
Epoch: 11 cost time: 15.734025478363037
Epoch: 11, Steps: 208 | Train Loss: 1.827 Vali Loss: 3.702 Vali Acc: 0.120 Test Loss: 3.702 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.1674893
	speed: 0.2359s/iter; left time: 4344.4277s
	iters: 200, epoch: 12 | loss: 1.5356358
	speed: 0.0980s/iter; left time: 1794.0709s
Epoch: 12 cost time: 21.466463327407837
Epoch: 12, Steps: 208 | Train Loss: 1.554 Vali Loss: 4.213 Vali Acc: 0.125 Test Loss: 4.213 Test Acc: 0.125
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.1986582
	speed: 0.2512s/iter; left time: 4573.5907s
	iters: 200, epoch: 13 | loss: 1.8706075
	speed: 0.0974s/iter; left time: 1763.0456s
Epoch: 13 cost time: 20.769442081451416
Epoch: 13, Steps: 208 | Train Loss: 1.354 Vali Loss: 4.366 Vali Acc: 0.120 Test Loss: 4.366 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.6424598
	speed: 0.2323s/iter; left time: 4180.4517s
	iters: 200, epoch: 14 | loss: 1.7408688
	speed: 0.1064s/iter; left time: 1905.1091s
Epoch: 14 cost time: 20.71014666557312
Epoch: 14, Steps: 208 | Train Loss: 1.127 Vali Loss: 5.003 Vali Acc: 0.126 Test Loss: 5.003 Test Acc: 0.126
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.1757827
	speed: 0.2392s/iter; left time: 4254.6489s
	iters: 200, epoch: 15 | loss: 1.2130820
	speed: 0.1001s/iter; left time: 1770.3903s
Epoch: 15 cost time: 20.87867569923401
Epoch: 15, Steps: 208 | Train Loss: 1.038 Vali Loss: 5.018 Vali Acc: 0.124 Test Loss: 5.018 Test Acc: 0.124
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.4526627
	speed: 0.2361s/iter; left time: 4150.0082s
	iters: 200, epoch: 16 | loss: 1.1996957
	speed: 0.0965s/iter; left time: 1686.2465s
Epoch: 16 cost time: 20.52363634109497
Epoch: 16, Steps: 208 | Train Loss: 1.013 Vali Loss: 5.199 Vali Acc: 0.121 Test Loss: 5.199 Test Acc: 0.121
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.2162495
	speed: 0.2474s/iter; left time: 4298.1000s
	iters: 200, epoch: 17 | loss: 0.5962440
	speed: 0.1050s/iter; left time: 1813.8840s
Epoch: 17 cost time: 22.43799614906311
Epoch: 17, Steps: 208 | Train Loss: 0.966 Vali Loss: 5.204 Vali Acc: 0.129 Test Loss: 5.204 Test Acc: 0.129
Validation loss decreased (-0.128506 --> -0.128788).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.6108389
	speed: 0.2403s/iter; left time: 4124.1628s
	iters: 200, epoch: 18 | loss: 1.2439507
	speed: 0.1054s/iter; left time: 1799.1164s
Epoch: 18 cost time: 20.383857011795044
Epoch: 18, Steps: 208 | Train Loss: 0.885 Vali Loss: 5.415 Vali Acc: 0.115 Test Loss: 5.415 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.8126080
	speed: 0.2338s/iter; left time: 3964.2744s
	iters: 200, epoch: 19 | loss: 1.2932619
	speed: 0.1050s/iter; left time: 1770.6547s
Epoch: 19 cost time: 20.764804124832153
Epoch: 19, Steps: 208 | Train Loss: 0.859 Vali Loss: 6.072 Vali Acc: 0.114 Test Loss: 6.072 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.8529318
	speed: 0.2697s/iter; left time: 4516.5372s
	iters: 200, epoch: 20 | loss: 0.8449661
	speed: 0.1141s/iter; left time: 1900.2844s
Epoch: 20 cost time: 23.434425592422485
Epoch: 20, Steps: 208 | Train Loss: 0.821 Vali Loss: 5.988 Vali Acc: 0.119 Test Loss: 5.988 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.7402580
	speed: 0.2374s/iter; left time: 3926.2084s
	iters: 200, epoch: 21 | loss: 0.9936895
	speed: 0.0626s/iter; left time: 1028.4198s
Epoch: 21 cost time: 15.71148681640625
Epoch: 21, Steps: 208 | Train Loss: 0.798 Vali Loss: 5.876 Vali Acc: 0.120 Test Loss: 5.876 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 1.3376763
	speed: 0.1793s/iter; left time: 2927.9971s
	iters: 200, epoch: 22 | loss: 0.6508143
	speed: 0.0848s/iter; left time: 1375.9829s
Epoch: 22 cost time: 14.661852836608887
Epoch: 22, Steps: 208 | Train Loss: 0.775 Vali Loss: 5.797 Vali Acc: 0.110 Test Loss: 5.797 Test Acc: 0.110
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 1.1128398
	speed: 0.2445s/iter; left time: 3942.9807s
	iters: 200, epoch: 23 | loss: 0.4029238
	speed: 0.0956s/iter; left time: 1532.3036s
Epoch: 23 cost time: 20.63289785385132
Epoch: 23, Steps: 208 | Train Loss: 0.818 Vali Loss: 6.033 Vali Acc: 0.116 Test Loss: 6.033 Test Acc: 0.116
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 1.0629925
	speed: 0.2573s/iter; left time: 4095.5320s
	iters: 200, epoch: 24 | loss: 0.4059511
	speed: 0.0944s/iter; left time: 1492.3827s
Epoch: 24 cost time: 20.07212471961975
Epoch: 24, Steps: 208 | Train Loss: 0.791 Vali Loss: 6.296 Vali Acc: 0.118 Test Loss: 6.296 Test Acc: 0.118
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.3692906
	speed: 0.2571s/iter; left time: 4039.4405s
	iters: 200, epoch: 25 | loss: 0.8466668
	speed: 0.0908s/iter; left time: 1418.0263s
Epoch: 25 cost time: 19.551255702972412
Epoch: 25, Steps: 208 | Train Loss: 0.754 Vali Loss: 6.225 Vali Acc: 0.108 Test Loss: 6.225 Test Acc: 0.108
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.6410251
	speed: 0.2613s/iter; left time: 4051.1234s
	iters: 200, epoch: 26 | loss: 1.1694297
	speed: 0.0988s/iter; left time: 1521.9199s
Epoch: 26 cost time: 19.933589696884155
Epoch: 26, Steps: 208 | Train Loss: 0.758 Vali Loss: 6.277 Vali Acc: 0.119 Test Loss: 6.277 Test Acc: 0.119
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.3025896
	speed: 0.2650s/iter; left time: 4052.7966s
	iters: 200, epoch: 27 | loss: 1.1573154
	speed: 0.0986s/iter; left time: 1497.7689s
Epoch: 27 cost time: 19.85843062400818
Epoch: 27, Steps: 208 | Train Loss: 0.734 Vali Loss: 6.304 Vali Acc: 0.125 Test Loss: 6.304 Test Acc: 0.125
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1288398449150015
model parameter : 2244299
model size : 11.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.4967675
	speed: 0.1188s/iter; left time: 2459.4111s
	iters: 200, epoch: 1 | loss: 5.0017161
	speed: 0.1037s/iter; left time: 2136.6325s
Epoch: 1 cost time: 23.355453491210938
Epoch: 1, Steps: 208 | Train Loss: 4.301 Vali Loss: 4.360 Vali Acc: 0.041 Test Loss: 4.360 Test Acc: 0.041
Validation loss decreased (inf --> -0.041114).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8387609
	speed: 0.2759s/iter; left time: 5653.9441s
	iters: 200, epoch: 2 | loss: 4.2582560
	speed: 0.0978s/iter; left time: 1994.5782s
Epoch: 2 cost time: 19.60768437385559
Epoch: 2, Steps: 208 | Train Loss: 3.855 Vali Loss: 3.850 Vali Acc: 0.052 Test Loss: 3.850 Test Acc: 0.052
Validation loss decreased (-0.041114 --> -0.052452).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7318945
	speed: 0.3165s/iter; left time: 6420.6685s
	iters: 200, epoch: 3 | loss: 3.0836532
	speed: 0.0949s/iter; left time: 1914.6510s
Epoch: 3 cost time: 22.346582412719727
Epoch: 3, Steps: 208 | Train Loss: 3.673 Vali Loss: 3.611 Vali Acc: 0.054 Test Loss: 3.611 Test Acc: 0.054
Validation loss decreased (-0.052452 --> -0.053647).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3345437
	speed: 0.3087s/iter; left time: 6198.3657s
	iters: 200, epoch: 4 | loss: 3.6348040
	speed: 0.1037s/iter; left time: 2071.4258s
Epoch: 4 cost time: 21.18881583213806
Epoch: 4, Steps: 208 | Train Loss: 3.517 Vali Loss: 3.580 Vali Acc: 0.064 Test Loss: 3.580 Test Acc: 0.064
Validation loss decreased (-0.053647 --> -0.063489).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.4401755
	speed: 0.3025s/iter; left time: 6009.8650s
	iters: 200, epoch: 5 | loss: 3.6050289
	speed: 0.0966s/iter; left time: 1910.0865s
Epoch: 5 cost time: 20.926023483276367
Epoch: 5, Steps: 208 | Train Loss: 3.255 Vali Loss: 3.401 Vali Acc: 0.086 Test Loss: 3.401 Test Acc: 0.086
Validation loss decreased (-0.063489 --> -0.086157).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2291789
	speed: 0.2982s/iter; left time: 5861.9865s
	iters: 200, epoch: 6 | loss: 2.8494301
	speed: 0.0867s/iter; left time: 1696.5168s
Epoch: 6 cost time: 21.3392333984375
Epoch: 6, Steps: 208 | Train Loss: 3.103 Vali Loss: 3.381 Vali Acc: 0.094 Test Loss: 3.381 Test Acc: 0.094
Validation loss decreased (-0.086157 --> -0.094210).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.8780680
	speed: 0.2863s/iter; left time: 5569.4581s
	iters: 200, epoch: 7 | loss: 2.5353792
	speed: 0.0952s/iter; left time: 1842.1553s
Epoch: 7 cost time: 20.998225927352905
Epoch: 7, Steps: 208 | Train Loss: 2.924 Vali Loss: 3.175 Vali Acc: 0.107 Test Loss: 3.175 Test Acc: 0.107
Validation loss decreased (-0.094210 --> -0.106738).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.8778338
	speed: 0.2803s/iter; left time: 5393.6399s
	iters: 200, epoch: 8 | loss: 2.4888713
	speed: 0.0979s/iter; left time: 1873.5101s
Epoch: 8 cost time: 20.206820726394653
Epoch: 8, Steps: 208 | Train Loss: 2.675 Vali Loss: 3.198 Vali Acc: 0.109 Test Loss: 3.198 Test Acc: 0.109
Validation loss decreased (-0.106738 --> -0.108528).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.5778062
	speed: 0.2493s/iter; left time: 4745.5592s
	iters: 200, epoch: 9 | loss: 2.0996056
	speed: 0.0890s/iter; left time: 1685.9219s
Epoch: 9 cost time: 17.01135563850403
Epoch: 9, Steps: 208 | Train Loss: 2.406 Vali Loss: 3.235 Vali Acc: 0.122 Test Loss: 3.235 Test Acc: 0.122
Validation loss decreased (-0.108528 --> -0.121650).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.0861266
	speed: 0.2338s/iter; left time: 4402.7771s
	iters: 200, epoch: 10 | loss: 1.9576018
	speed: 0.0495s/iter; left time: 926.9507s
Epoch: 10 cost time: 12.914160251617432
Epoch: 10, Steps: 208 | Train Loss: 2.169 Vali Loss: 3.293 Vali Acc: 0.139 Test Loss: 3.293 Test Acc: 0.139
Validation loss decreased (-0.121650 --> -0.138649).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.6783291
	speed: 0.2414s/iter; left time: 4495.7627s
	iters: 200, epoch: 11 | loss: 2.2025709
	speed: 0.0578s/iter; left time: 1070.8340s
Epoch: 11 cost time: 13.262308597564697
Epoch: 11, Steps: 208 | Train Loss: 1.914 Vali Loss: 3.321 Vali Acc: 0.134 Test Loss: 3.321 Test Acc: 0.134
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.6687641
	speed: 0.2287s/iter; left time: 4211.7032s
	iters: 200, epoch: 12 | loss: 2.3013639
	speed: 0.0617s/iter; left time: 1129.5256s
Epoch: 12 cost time: 13.72667384147644
Epoch: 12, Steps: 208 | Train Loss: 1.661 Vali Loss: 3.733 Vali Acc: 0.137 Test Loss: 3.733 Test Acc: 0.137
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.0485089
	speed: 0.2253s/iter; left time: 4102.4202s
	iters: 200, epoch: 13 | loss: 1.5107532
	speed: 0.0707s/iter; left time: 1279.3423s
Epoch: 13 cost time: 14.836446285247803
Epoch: 13, Steps: 208 | Train Loss: 1.421 Vali Loss: 4.238 Vali Acc: 0.126 Test Loss: 4.238 Test Acc: 0.126
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.9072476
	speed: 0.2230s/iter; left time: 4013.1165s
	iters: 200, epoch: 14 | loss: 1.2677605
	speed: 0.0578s/iter; left time: 1033.6926s
Epoch: 14 cost time: 12.832892894744873
Epoch: 14, Steps: 208 | Train Loss: 1.273 Vali Loss: 4.383 Vali Acc: 0.123 Test Loss: 4.383 Test Acc: 0.123
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.9900889
	speed: 0.2947s/iter; left time: 5241.7121s
	iters: 200, epoch: 15 | loss: 1.1458306
	speed: 0.0865s/iter; left time: 1530.3246s
Epoch: 15 cost time: 20.02864146232605
Epoch: 15, Steps: 208 | Train Loss: 1.143 Vali Loss: 4.734 Vali Acc: 0.135 Test Loss: 4.734 Test Acc: 0.135
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.6957065
	speed: 0.2642s/iter; left time: 4644.2441s
	iters: 200, epoch: 16 | loss: 1.5561128
	speed: 0.0920s/iter; left time: 1609.0569s
Epoch: 16 cost time: 19.592798948287964
Epoch: 16, Steps: 208 | Train Loss: 1.089 Vali Loss: 4.827 Vali Acc: 0.123 Test Loss: 4.827 Test Acc: 0.123
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.1454926
	speed: 0.2763s/iter; left time: 4800.6911s
	iters: 200, epoch: 17 | loss: 0.3495724
	speed: 0.0947s/iter; left time: 1635.7336s
Epoch: 17 cost time: 20.116325616836548
Epoch: 17, Steps: 208 | Train Loss: 0.970 Vali Loss: 5.513 Vali Acc: 0.117 Test Loss: 5.513 Test Acc: 0.117
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.9034480
	speed: 0.2633s/iter; left time: 4518.8684s
	iters: 200, epoch: 18 | loss: 1.9279370
	speed: 0.1019s/iter; left time: 1739.4139s
Epoch: 18 cost time: 19.892744541168213
Epoch: 18, Steps: 208 | Train Loss: 0.939 Vali Loss: 5.202 Vali Acc: 0.125 Test Loss: 5.202 Test Acc: 0.125
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 1.1951164
	speed: 0.2588s/iter; left time: 4389.0918s
	iters: 200, epoch: 19 | loss: 0.4168437
	speed: 0.0922s/iter; left time: 1553.9490s
Epoch: 19 cost time: 18.605243921279907
Epoch: 19, Steps: 208 | Train Loss: 0.860 Vali Loss: 5.995 Vali Acc: 0.130 Test Loss: 5.995 Test Acc: 0.130
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.9451171
	speed: 0.2670s/iter; left time: 4472.5123s
	iters: 200, epoch: 20 | loss: 1.8207575
	speed: 0.0759s/iter; left time: 1263.5865s
Epoch: 20 cost time: 18.27785849571228
Epoch: 20, Steps: 208 | Train Loss: 0.831 Vali Loss: 5.502 Vali Acc: 0.127 Test Loss: 5.502 Test Acc: 0.127
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13868177751267521
model parameter : 2090955
model size : 10.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.6205673
	speed: 0.1072s/iter; left time: 2220.1401s
	iters: 200, epoch: 1 | loss: 5.7226110
	speed: 0.0739s/iter; left time: 1522.2348s
Epoch: 1 cost time: 18.983454704284668
Epoch: 1, Steps: 208 | Train Loss: 4.286 Vali Loss: 4.719 Vali Acc: 0.038 Test Loss: 4.719 Test Acc: 0.038
Validation loss decreased (inf --> -0.038426).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9996676
	speed: 0.2611s/iter; left time: 5351.1423s
	iters: 200, epoch: 2 | loss: 4.1307106
	speed: 0.0848s/iter; left time: 1730.2927s
Epoch: 2 cost time: 18.967493295669556
Epoch: 2, Steps: 208 | Train Loss: 4.092 Vali Loss: 4.081 Vali Acc: 0.052 Test Loss: 4.081 Test Acc: 0.052
Validation loss decreased (-0.038426 --> -0.051853).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7001040
	speed: 0.2481s/iter; left time: 5032.8106s
	iters: 200, epoch: 3 | loss: 3.3757532
	speed: 0.0756s/iter; left time: 1525.0511s
Epoch: 3 cost time: 17.243550300598145
Epoch: 3, Steps: 208 | Train Loss: 3.760 Vali Loss: 3.803 Vali Acc: 0.057 Test Loss: 3.803 Test Acc: 0.057
Validation loss decreased (-0.051853 --> -0.056926).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.6016271
	speed: 0.2799s/iter; left time: 5619.5241s
	iters: 200, epoch: 4 | loss: 3.1825829
	speed: 0.0771s/iter; left time: 1540.5610s
Epoch: 4 cost time: 19.29202151298523
Epoch: 4, Steps: 208 | Train Loss: 3.528 Vali Loss: 3.451 Vali Acc: 0.083 Test Loss: 3.451 Test Acc: 0.083
Validation loss decreased (-0.056926 --> -0.082876).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.4308057
	speed: 0.2716s/iter; left time: 5395.9803s
	iters: 200, epoch: 5 | loss: 3.1981390
	speed: 0.0836s/iter; left time: 1653.2153s
Epoch: 5 cost time: 18.868907928466797
Epoch: 5, Steps: 208 | Train Loss: 3.263 Vali Loss: 3.330 Vali Acc: 0.095 Test Loss: 3.330 Test Acc: 0.095
Validation loss decreased (-0.082876 --> -0.095404).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0119526
	speed: 0.2685s/iter; left time: 5278.0080s
	iters: 200, epoch: 6 | loss: 2.8288624
	speed: 0.0822s/iter; left time: 1607.1800s
Epoch: 6 cost time: 18.066845655441284
Epoch: 6, Steps: 208 | Train Loss: 3.071 Vali Loss: 3.259 Vali Acc: 0.095 Test Loss: 3.259 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.5658786
	speed: 0.2533s/iter; left time: 4927.0285s
	iters: 200, epoch: 7 | loss: 3.7901411
	speed: 0.0902s/iter; left time: 1744.8692s
Epoch: 7 cost time: 19.01947784423828
Epoch: 7, Steps: 208 | Train Loss: 2.829 Vali Loss: 3.126 Vali Acc: 0.114 Test Loss: 3.126 Test Acc: 0.114
Validation loss decreased (-0.095404 --> -0.113897).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.7130997
	speed: 0.2419s/iter; left time: 4654.8141s
	iters: 200, epoch: 8 | loss: 2.9556439
	speed: 0.0855s/iter; left time: 1637.1542s
Epoch: 8 cost time: 18.957031965255737
Epoch: 8, Steps: 208 | Train Loss: 2.588 Vali Loss: 3.152 Vali Acc: 0.121 Test Loss: 3.152 Test Acc: 0.121
Validation loss decreased (-0.113897 --> -0.121352).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.1889801
	speed: 0.2399s/iter; left time: 4567.6327s
	iters: 200, epoch: 9 | loss: 2.9487085
	speed: 0.0733s/iter; left time: 1387.6264s
Epoch: 9 cost time: 16.98704242706299
Epoch: 9, Steps: 208 | Train Loss: 2.311 Vali Loss: 3.260 Vali Acc: 0.130 Test Loss: 3.260 Test Acc: 0.130
Validation loss decreased (-0.121352 --> -0.130000).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.2588074
	speed: 0.2435s/iter; left time: 4584.2749s
	iters: 200, epoch: 10 | loss: 2.3745782
	speed: 0.0828s/iter; left time: 1550.6859s
Epoch: 10 cost time: 18.99359703063965
Epoch: 10, Steps: 208 | Train Loss: 2.028 Vali Loss: 3.334 Vali Acc: 0.131 Test Loss: 3.334 Test Acc: 0.131
Validation loss decreased (-0.130000 --> -0.130596).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.1211994
	speed: 0.2238s/iter; left time: 4167.7910s
	iters: 200, epoch: 11 | loss: 2.3967381
	speed: 0.0928s/iter; left time: 1718.6853s
Epoch: 11 cost time: 19.349721908569336
Epoch: 11, Steps: 208 | Train Loss: 1.753 Vali Loss: 3.702 Vali Acc: 0.129 Test Loss: 3.702 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.4060411
	speed: 0.2355s/iter; left time: 4336.1660s
	iters: 200, epoch: 12 | loss: 2.0832920
	speed: 0.0896s/iter; left time: 1640.5430s
Epoch: 12 cost time: 19.54716920852661
Epoch: 12, Steps: 208 | Train Loss: 1.540 Vali Loss: 3.955 Vali Acc: 0.120 Test Loss: 3.955 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.8838596
	speed: 0.2111s/iter; left time: 3843.1099s
	iters: 200, epoch: 13 | loss: 2.0100703
	speed: 0.0556s/iter; left time: 1006.2364s
Epoch: 13 cost time: 12.71850848197937
Epoch: 13, Steps: 208 | Train Loss: 1.339 Vali Loss: 4.470 Vali Acc: 0.126 Test Loss: 4.470 Test Acc: 0.126
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.2484090
	speed: 0.1563s/iter; left time: 2812.4242s
	iters: 200, epoch: 14 | loss: 1.7101882
	speed: 0.0888s/iter; left time: 1589.0385s
Epoch: 14 cost time: 15.57166075706482
Epoch: 14, Steps: 208 | Train Loss: 1.217 Vali Loss: 5.140 Vali Acc: 0.125 Test Loss: 5.140 Test Acc: 0.125
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.3006155
	speed: 0.2411s/iter; left time: 4289.4681s
	iters: 200, epoch: 15 | loss: 1.1584157
	speed: 0.0911s/iter; left time: 1612.1999s
Epoch: 15 cost time: 18.726358652114868
Epoch: 15, Steps: 208 | Train Loss: 1.063 Vali Loss: 4.753 Vali Acc: 0.128 Test Loss: 4.753 Test Acc: 0.128
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.7447968
	speed: 0.2898s/iter; left time: 5095.7370s
	iters: 200, epoch: 16 | loss: 1.7137827
	speed: 0.0839s/iter; left time: 1466.0030s
Epoch: 16 cost time: 18.84157395362854
Epoch: 16, Steps: 208 | Train Loss: 1.052 Vali Loss: 5.371 Vali Acc: 0.129 Test Loss: 5.371 Test Acc: 0.129
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.5562041
	speed: 0.3006s/iter; left time: 5222.5849s
	iters: 200, epoch: 17 | loss: 1.3259370
	speed: 0.0711s/iter; left time: 1228.1953s
Epoch: 17 cost time: 16.37297773361206
Epoch: 17, Steps: 208 | Train Loss: 0.998 Vali Loss: 5.121 Vali Acc: 0.124 Test Loss: 5.121 Test Acc: 0.124
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.4400493
	speed: 0.3027s/iter; left time: 5196.2509s
	iters: 200, epoch: 18 | loss: 1.7756383
	speed: 0.0936s/iter; left time: 1596.7367s
Epoch: 18 cost time: 19.331331491470337
Epoch: 18, Steps: 208 | Train Loss: 0.957 Vali Loss: 5.176 Vali Acc: 0.131 Test Loss: 5.176 Test Acc: 0.131
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 1.1877174
	speed: 0.3409s/iter; left time: 5780.8590s
	iters: 200, epoch: 19 | loss: 1.2875085
	speed: 0.0788s/iter; left time: 1327.5115s
Epoch: 19 cost time: 17.884788036346436
Epoch: 19, Steps: 208 | Train Loss: 0.914 Vali Loss: 5.776 Vali Acc: 0.125 Test Loss: 5.776 Test Acc: 0.125
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.0184891
	speed: 0.3422s/iter; left time: 5731.7607s
	iters: 200, epoch: 20 | loss: 0.4200790
	speed: 0.0905s/iter; left time: 1506.9032s
Epoch: 20 cost time: 19.831581115722656
Epoch: 20, Steps: 208 | Train Loss: 0.884 Vali Loss: 5.661 Vali Acc: 0.126 Test Loss: 5.661 Test Acc: 0.126
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1306292872054876
model parameter : 2087243
model size : 10.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8410845
	speed: 0.1197s/iter; left time: 2478.5823s
	iters: 200, epoch: 1 | loss: 4.3824415
	speed: 0.1057s/iter; left time: 2178.5289s
Epoch: 1 cost time: 23.57459306716919
Epoch: 1, Steps: 208 | Train Loss: 4.260 Vali Loss: 4.844 Vali Acc: 0.045 Test Loss: 4.844 Test Acc: 0.045
Validation loss decreased (inf --> -0.044688).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4696581
	speed: 0.3192s/iter; left time: 6542.2086s
	iters: 200, epoch: 2 | loss: 3.5234849
	speed: 0.0937s/iter; left time: 1909.9425s
Epoch: 2 cost time: 20.349933385849
Epoch: 2, Steps: 208 | Train Loss: 3.987 Vali Loss: 3.957 Vali Acc: 0.050 Test Loss: 3.957 Test Acc: 0.050
Validation loss decreased (-0.044688 --> -0.050065).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5147171
	speed: 0.3194s/iter; left time: 6478.6700s
	iters: 200, epoch: 3 | loss: 3.4204762
	speed: 0.0871s/iter; left time: 1757.8187s
Epoch: 3 cost time: 19.068068742752075
Epoch: 3, Steps: 208 | Train Loss: 3.802 Vali Loss: 3.783 Vali Acc: 0.050 Test Loss: 3.783 Test Acc: 0.050
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.4822960
	speed: 0.3040s/iter; left time: 6104.2220s
	iters: 200, epoch: 4 | loss: 3.5288012
	speed: 0.0833s/iter; left time: 1664.5063s
Epoch: 4 cost time: 18.17086362838745
Epoch: 4, Steps: 208 | Train Loss: 3.572 Vali Loss: 3.619 Vali Acc: 0.078 Test Loss: 3.619 Test Acc: 0.078
Validation loss decreased (-0.050065 --> -0.077506).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.7956483
	speed: 0.2894s/iter; left time: 5749.6777s
	iters: 200, epoch: 5 | loss: 3.3392036
	speed: 0.0807s/iter; left time: 1595.6398s
Epoch: 5 cost time: 17.498331308364868
Epoch: 5, Steps: 208 | Train Loss: 3.298 Vali Loss: 3.387 Vali Acc: 0.078 Test Loss: 3.387 Test Acc: 0.078
Validation loss decreased (-0.077506 --> -0.077509).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0804288
	speed: 0.2885s/iter; left time: 5672.0878s
	iters: 200, epoch: 6 | loss: 2.9082150
	speed: 0.0946s/iter; left time: 1849.5964s
Epoch: 6 cost time: 18.093810319900513
Epoch: 6, Steps: 208 | Train Loss: 3.106 Vali Loss: 3.236 Vali Acc: 0.096 Test Loss: 3.236 Test Acc: 0.096
Validation loss decreased (-0.077509 --> -0.095703).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.3945107
	speed: 0.2765s/iter; left time: 5379.5824s
	iters: 200, epoch: 7 | loss: 3.0101700
	speed: 0.0687s/iter; left time: 1328.8859s
Epoch: 7 cost time: 15.235705375671387
Epoch: 7, Steps: 208 | Train Loss: 2.902 Vali Loss: 3.119 Vali Acc: 0.115 Test Loss: 3.119 Test Acc: 0.115
Validation loss decreased (-0.095703 --> -0.115388).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.7478955
	speed: 0.3346s/iter; left time: 6439.6585s
	iters: 200, epoch: 8 | loss: 3.3556669
	speed: 0.0828s/iter; left time: 1585.9639s
Epoch: 8 cost time: 19.86300301551819
Epoch: 8, Steps: 208 | Train Loss: 2.678 Vali Loss: 3.191 Vali Acc: 0.125 Test Loss: 3.191 Test Acc: 0.125
Validation loss decreased (-0.115388 --> -0.124633).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.3994198
	speed: 0.3138s/iter; left time: 5973.3598s
	iters: 200, epoch: 9 | loss: 2.5953405
	speed: 0.0831s/iter; left time: 1572.9998s
Epoch: 9 cost time: 17.837417125701904
Epoch: 9, Steps: 208 | Train Loss: 2.406 Vali Loss: 3.302 Vali Acc: 0.122 Test Loss: 3.302 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.2695510
	speed: 0.3045s/iter; left time: 5733.3479s
	iters: 200, epoch: 10 | loss: 1.8894975
	speed: 0.0925s/iter; left time: 1732.7081s
Epoch: 10 cost time: 18.642469882965088
Epoch: 10, Steps: 208 | Train Loss: 2.162 Vali Loss: 3.355 Vali Acc: 0.126 Test Loss: 3.355 Test Acc: 0.126
Validation loss decreased (-0.124633 --> -0.126122).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4800276
	speed: 0.3566s/iter; left time: 6640.7667s
	iters: 200, epoch: 11 | loss: 2.0871534
	speed: 0.0843s/iter; left time: 1560.4528s
Epoch: 11 cost time: 20.102750062942505
Epoch: 11, Steps: 208 | Train Loss: 1.953 Vali Loss: 3.678 Vali Acc: 0.136 Test Loss: 3.678 Test Acc: 0.136
Validation loss decreased (-0.126122 --> -0.135663).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.7990950
	speed: 0.3233s/iter; left time: 5953.7285s
	iters: 200, epoch: 12 | loss: 1.5717847
	speed: 0.0984s/iter; left time: 1802.6330s
Epoch: 12 cost time: 19.94369125366211
Epoch: 12, Steps: 208 | Train Loss: 1.706 Vali Loss: 3.839 Vali Acc: 0.129 Test Loss: 3.839 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.8026843
	speed: 0.3317s/iter; left time: 6038.6539s
	iters: 200, epoch: 13 | loss: 1.8742068
	speed: 0.0730s/iter; left time: 1321.9543s
Epoch: 13 cost time: 17.641419887542725
Epoch: 13, Steps: 208 | Train Loss: 1.503 Vali Loss: 3.920 Vali Acc: 0.121 Test Loss: 3.920 Test Acc: 0.121
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.2719779
	speed: 0.3132s/iter; left time: 5637.3126s
	iters: 200, epoch: 14 | loss: 1.7719754
	speed: 0.0857s/iter; left time: 1533.2725s
Epoch: 14 cost time: 18.696142196655273
Epoch: 14, Steps: 208 | Train Loss: 1.350 Vali Loss: 4.340 Vali Acc: 0.129 Test Loss: 4.340 Test Acc: 0.129
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.4500141
	speed: 0.3412s/iter; left time: 6069.8349s
	iters: 200, epoch: 15 | loss: 1.2041723
	speed: 0.0856s/iter; left time: 1513.5098s
Epoch: 15 cost time: 19.538195371627808
Epoch: 15, Steps: 208 | Train Loss: 1.235 Vali Loss: 4.513 Vali Acc: 0.135 Test Loss: 4.513 Test Acc: 0.135
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.8144672
	speed: 0.3328s/iter; left time: 5851.6476s
	iters: 200, epoch: 16 | loss: 1.8320796
	speed: 0.0838s/iter; left time: 1465.3661s
Epoch: 16 cost time: 18.57517385482788
Epoch: 16, Steps: 208 | Train Loss: 1.127 Vali Loss: 4.994 Vali Acc: 0.126 Test Loss: 4.994 Test Acc: 0.126
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.8747410
	speed: 0.3329s/iter; left time: 5783.9536s
	iters: 200, epoch: 17 | loss: 1.9248748
	speed: 0.0786s/iter; left time: 1356.7992s
Epoch: 17 cost time: 17.809814453125
Epoch: 17, Steps: 208 | Train Loss: 1.024 Vali Loss: 5.235 Vali Acc: 0.118 Test Loss: 5.235 Test Acc: 0.118
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.2869653
	speed: 0.3639s/iter; left time: 6247.0769s
	iters: 200, epoch: 18 | loss: 1.6815531
	speed: 0.1028s/iter; left time: 1754.8261s
Epoch: 18 cost time: 21.597475051879883
Epoch: 18, Steps: 208 | Train Loss: 1.021 Vali Loss: 4.970 Vali Acc: 0.129 Test Loss: 4.970 Test Acc: 0.129
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.3101341
	speed: 0.3706s/iter; left time: 6284.7340s
	iters: 200, epoch: 19 | loss: 1.2533296
	speed: 0.0773s/iter; left time: 1303.6500s
Epoch: 19 cost time: 18.58695077896118
Epoch: 19, Steps: 208 | Train Loss: 0.941 Vali Loss: 5.444 Vali Acc: 0.131 Test Loss: 5.444 Test Acc: 0.131
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.2242638
	speed: 0.3465s/iter; left time: 5804.0595s
	iters: 200, epoch: 20 | loss: 1.4942478
	speed: 0.0863s/iter; left time: 1436.9708s
Epoch: 20 cost time: 19.879916667938232
Epoch: 20, Steps: 208 | Train Loss: 0.927 Vali Loss: 5.662 Vali Acc: 0.119 Test Loss: 5.662 Test Acc: 0.119
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 1.0990388
	speed: 0.3284s/iter; left time: 5431.3849s
	iters: 200, epoch: 21 | loss: 1.3795121
	speed: 0.0691s/iter; left time: 1136.3954s
Epoch: 21 cost time: 15.863272428512573
Epoch: 21, Steps: 208 | Train Loss: 0.871 Vali Loss: 5.652 Vali Acc: 0.128 Test Loss: 5.652 Test Acc: 0.128
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13569937369519833
model parameter : 2083531
model size : 10.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.8056865
	speed: 0.1056s/iter; left time: 2186.8829s
	iters: 200, epoch: 1 | loss: 4.4754710
	speed: 0.0773s/iter; left time: 1592.5356s
Epoch: 1 cost time: 18.983143091201782
Epoch: 1, Steps: 208 | Train Loss: 4.395 Vali Loss: 4.733 Vali Acc: 0.034 Test Loss: 4.733 Test Acc: 0.034
Validation loss decreased (inf --> -0.034250).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9267642
	speed: 0.3082s/iter; left time: 6315.5630s
	iters: 200, epoch: 2 | loss: 4.3789253
	speed: 0.0723s/iter; left time: 1473.6766s
Epoch: 2 cost time: 16.173595428466797
Epoch: 2, Steps: 208 | Train Loss: 4.079 Vali Loss: 3.890 Vali Acc: 0.041 Test Loss: 3.890 Test Acc: 0.041
Validation loss decreased (-0.034250 --> -0.041417).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.9632649
	speed: 0.3036s/iter; left time: 6158.8500s
	iters: 200, epoch: 3 | loss: 3.5141704
	speed: 0.0621s/iter; left time: 1252.9550s
Epoch: 3 cost time: 15.208629369735718
Epoch: 3, Steps: 208 | Train Loss: 3.677 Vali Loss: 3.729 Vali Acc: 0.054 Test Loss: 3.729 Test Acc: 0.054
Validation loss decreased (-0.041417 --> -0.053944).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.0691187
	speed: 0.2642s/iter; left time: 5305.1993s
	iters: 200, epoch: 4 | loss: 3.6642106
	speed: 0.0697s/iter; left time: 1391.5068s
Epoch: 4 cost time: 15.703629493713379
Epoch: 4, Steps: 208 | Train Loss: 3.479 Vali Loss: 3.747 Vali Acc: 0.066 Test Loss: 3.747 Test Acc: 0.066
Validation loss decreased (-0.053944 --> -0.065874).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2168179
	speed: 0.2970s/iter; left time: 5900.6886s
	iters: 200, epoch: 5 | loss: 2.9579141
	speed: 0.0887s/iter; left time: 1752.8466s
Epoch: 5 cost time: 18.60921859741211
Epoch: 5, Steps: 208 | Train Loss: 3.234 Vali Loss: 3.347 Vali Acc: 0.089 Test Loss: 3.347 Test Acc: 0.089
Validation loss decreased (-0.065874 --> -0.088544).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2698312
	speed: 0.3921s/iter; left time: 7708.8558s
	iters: 200, epoch: 6 | loss: 2.7952495
	speed: 0.0906s/iter; left time: 1771.9186s
Epoch: 6 cost time: 19.533651113510132
Epoch: 6, Steps: 208 | Train Loss: 3.078 Vali Loss: 3.360 Vali Acc: 0.084 Test Loss: 3.360 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.0978522
	speed: 0.3443s/iter; left time: 6698.5608s
	iters: 200, epoch: 7 | loss: 2.5179713
	speed: 0.0831s/iter; left time: 1608.6450s
Epoch: 7 cost time: 17.900887489318848
Epoch: 7, Steps: 208 | Train Loss: 2.901 Vali Loss: 3.191 Vali Acc: 0.108 Test Loss: 3.191 Test Acc: 0.108
Validation loss decreased (-0.088544 --> -0.108229).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.4821911
	speed: 0.3301s/iter; left time: 6351.8390s
	iters: 200, epoch: 8 | loss: 2.8411405
	speed: 0.0936s/iter; left time: 1791.8083s
Epoch: 8 cost time: 18.33119010925293
Epoch: 8, Steps: 208 | Train Loss: 2.631 Vali Loss: 3.165 Vali Acc: 0.110 Test Loss: 3.165 Test Acc: 0.110
Validation loss decreased (-0.108229 --> -0.110019).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.4437194
	speed: 0.3480s/iter; left time: 6624.6299s
	iters: 200, epoch: 9 | loss: 2.4264550
	speed: 0.0775s/iter; left time: 1468.2486s
Epoch: 9 cost time: 17.678666830062866
Epoch: 9, Steps: 208 | Train Loss: 2.341 Vali Loss: 3.396 Vali Acc: 0.115 Test Loss: 3.396 Test Acc: 0.115
Validation loss decreased (-0.110019 --> -0.115087).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.1454120
	speed: 0.3376s/iter; left time: 6356.2623s
	iters: 200, epoch: 10 | loss: 1.9623389
	speed: 0.0902s/iter; left time: 1688.8855s
Epoch: 10 cost time: 18.50892162322998
Epoch: 10, Steps: 208 | Train Loss: 2.071 Vali Loss: 3.383 Vali Acc: 0.135 Test Loss: 3.383 Test Acc: 0.135
Validation loss decreased (-0.115087 --> -0.134771).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.3624587
	speed: 0.3240s/iter; left time: 6032.3320s
	iters: 200, epoch: 11 | loss: 1.4966885
	speed: 0.0854s/iter; left time: 1581.6515s
Epoch: 11 cost time: 18.211585521697998
Epoch: 11, Steps: 208 | Train Loss: 1.783 Vali Loss: 3.677 Vali Acc: 0.121 Test Loss: 3.677 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.5078901
	speed: 0.3358s/iter; left time: 6183.1512s
	iters: 200, epoch: 12 | loss: 1.9495448
	speed: 0.0799s/iter; left time: 1463.8081s
Epoch: 12 cost time: 17.68835759162903
Epoch: 12, Steps: 208 | Train Loss: 1.555 Vali Loss: 3.825 Vali Acc: 0.121 Test Loss: 3.825 Test Acc: 0.121
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.5398645
	speed: 0.3269s/iter; left time: 5951.1576s
	iters: 200, epoch: 13 | loss: 1.3594329
	speed: 0.0880s/iter; left time: 1593.6488s
Epoch: 13 cost time: 19.10858702659607
Epoch: 13, Steps: 208 | Train Loss: 1.383 Vali Loss: 4.170 Vali Acc: 0.123 Test Loss: 4.170 Test Acc: 0.123
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.0576522
	speed: 0.3361s/iter; left time: 6048.9283s
	iters: 200, epoch: 14 | loss: 1.7934195
	speed: 0.0781s/iter; left time: 1398.2053s
Epoch: 14 cost time: 18.25166368484497
Epoch: 14, Steps: 208 | Train Loss: 1.218 Vali Loss: 4.929 Vali Acc: 0.123 Test Loss: 4.929 Test Acc: 0.123
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.4785476
	speed: 0.3151s/iter; left time: 5605.4640s
	iters: 200, epoch: 15 | loss: 0.9965801
	speed: 0.0604s/iter; left time: 1068.8401s
Epoch: 15 cost time: 13.985499143600464
Epoch: 15, Steps: 208 | Train Loss: 1.101 Vali Loss: 5.377 Vali Acc: 0.135 Test Loss: 5.377 Test Acc: 0.135
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.3876604
	speed: 0.3442s/iter; left time: 6050.6888s
	iters: 200, epoch: 16 | loss: 1.2156420
	speed: 0.1098s/iter; left time: 1919.0195s
Epoch: 16 cost time: 22.62297773361206
Epoch: 16, Steps: 208 | Train Loss: 1.029 Vali Loss: 5.131 Vali Acc: 0.122 Test Loss: 5.131 Test Acc: 0.122
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.7110167
	speed: 0.3874s/iter; left time: 6729.8620s
	iters: 200, epoch: 17 | loss: 0.8140717
	speed: 0.1127s/iter; left time: 1946.2536s
Epoch: 17 cost time: 23.358261108398438
Epoch: 17, Steps: 208 | Train Loss: 0.961 Vali Loss: 5.940 Vali Acc: 0.106 Test Loss: 5.940 Test Acc: 0.106
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.8931046
	speed: 0.3882s/iter; left time: 6664.3046s
	iters: 200, epoch: 18 | loss: 1.0371040
	speed: 0.0941s/iter; left time: 1605.9902s
Epoch: 18 cost time: 20.93666958808899
Epoch: 18, Steps: 208 | Train Loss: 0.925 Vali Loss: 5.100 Vali Acc: 0.125 Test Loss: 5.100 Test Acc: 0.125
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.9453708
	speed: 0.3834s/iter; left time: 6501.7976s
	iters: 200, epoch: 19 | loss: 0.9718158
	speed: 0.1017s/iter; left time: 1715.1291s
Epoch: 19 cost time: 21.814922332763672
Epoch: 19, Steps: 208 | Train Loss: 0.933 Vali Loss: 5.361 Vali Acc: 0.125 Test Loss: 5.361 Test Acc: 0.125
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.3987309
	speed: 0.3931s/iter; left time: 6583.6013s
	iters: 200, epoch: 20 | loss: 0.6064762
	speed: 0.0934s/iter; left time: 1555.5054s
Epoch: 20 cost time: 20.221959590911865
Epoch: 20, Steps: 208 | Train Loss: 0.832 Vali Loss: 5.362 Vali Acc: 0.132 Test Loss: 5.362 Test Acc: 0.132
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13480465254995527
model parameter : 2079819
model size : 10.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1518307
	speed: 0.0923s/iter; left time: 1911.7150s
	iters: 200, epoch: 1 | loss: 4.3912554
	speed: 0.0772s/iter; left time: 1590.5581s
Epoch: 1 cost time: 17.674192428588867
Epoch: 1, Steps: 208 | Train Loss: 3.934 Vali Loss: 3.967 Vali Acc: 0.047 Test Loss: 3.967 Test Acc: 0.047
Validation loss decreased (inf --> -0.046784).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6822388
	speed: 0.2892s/iter; left time: 5927.3455s
	iters: 200, epoch: 2 | loss: 3.8339562
	speed: 0.0819s/iter; left time: 1669.4407s
Epoch: 2 cost time: 17.829204082489014
Epoch: 2, Steps: 208 | Train Loss: 3.898 Vali Loss: 3.975 Vali Acc: 0.053 Test Loss: 3.975 Test Acc: 0.053
Validation loss decreased (-0.046784 --> -0.053345).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.8885369
	speed: 0.3146s/iter; left time: 6381.6087s
	iters: 200, epoch: 3 | loss: 3.3864613
	speed: 0.0721s/iter; left time: 1455.0365s
Epoch: 3 cost time: 16.095566034317017
Epoch: 3, Steps: 208 | Train Loss: 3.631 Vali Loss: 3.676 Vali Acc: 0.032 Test Loss: 3.676 Test Acc: 0.032
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.6899424
	speed: 0.2746s/iter; left time: 5513.7000s
	iters: 200, epoch: 4 | loss: 3.7963343
	speed: 0.0662s/iter; left time: 1321.8975s
Epoch: 4 cost time: 14.322160482406616
Epoch: 4, Steps: 208 | Train Loss: 3.496 Vali Loss: 3.519 Vali Acc: 0.061 Test Loss: 3.519 Test Acc: 0.061
Validation loss decreased (-0.053345 --> -0.060508).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.6834900
	speed: 0.3306s/iter; left time: 6568.4400s
	iters: 200, epoch: 5 | loss: 2.9871206
	speed: 0.0782s/iter; left time: 1546.2377s
Epoch: 5 cost time: 17.716047048568726
Epoch: 5, Steps: 208 | Train Loss: 3.332 Vali Loss: 3.423 Vali Acc: 0.092 Test Loss: 3.423 Test Acc: 0.092
Validation loss decreased (-0.060508 --> -0.092122).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.7501493
	speed: 0.3271s/iter; left time: 6432.0853s
	iters: 200, epoch: 6 | loss: 3.0932488
	speed: 0.0863s/iter; left time: 1687.5444s
Epoch: 6 cost time: 18.94830870628357
Epoch: 6, Steps: 208 | Train Loss: 3.166 Vali Loss: 3.354 Vali Acc: 0.084 Test Loss: 3.354 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.1616890
	speed: 0.3674s/iter; left time: 7147.0114s
	iters: 200, epoch: 7 | loss: 2.9354692
	speed: 0.0859s/iter; left time: 1663.0018s
Epoch: 7 cost time: 19.728804111480713
Epoch: 7, Steps: 208 | Train Loss: 2.983 Vali Loss: 3.271 Vali Acc: 0.095 Test Loss: 3.271 Test Acc: 0.095
Validation loss decreased (-0.092122 --> -0.095106).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.7136500
	speed: 0.3533s/iter; left time: 6798.7276s
	iters: 200, epoch: 8 | loss: 2.6723223
	speed: 0.0949s/iter; left time: 1817.2426s
Epoch: 8 cost time: 19.35209894180298
Epoch: 8, Steps: 208 | Train Loss: 2.765 Vali Loss: 3.377 Vali Acc: 0.115 Test Loss: 3.377 Test Acc: 0.115
Validation loss decreased (-0.095106 --> -0.114491).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.4432714
	speed: 0.3512s/iter; left time: 6685.9500s
	iters: 200, epoch: 9 | loss: 2.6613750
	speed: 0.0973s/iter; left time: 1842.4114s
Epoch: 9 cost time: 20.824955701828003
Epoch: 9, Steps: 208 | Train Loss: 2.474 Vali Loss: 3.413 Vali Acc: 0.116 Test Loss: 3.413 Test Acc: 0.116
Validation loss decreased (-0.114491 --> -0.116280).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.0284142
	speed: 0.3696s/iter; left time: 6959.4796s
	iters: 200, epoch: 10 | loss: 2.2937937
	speed: 0.0916s/iter; left time: 1715.6526s
Epoch: 10 cost time: 20.73697280883789
Epoch: 10, Steps: 208 | Train Loss: 2.112 Vali Loss: 3.494 Vali Acc: 0.107 Test Loss: 3.494 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.8558348
	speed: 0.4155s/iter; left time: 7736.9505s
	iters: 200, epoch: 11 | loss: 2.0204570
	speed: 0.1013s/iter; left time: 1875.9125s
Epoch: 11 cost time: 21.885157823562622
Epoch: 11, Steps: 208 | Train Loss: 1.725 Vali Loss: 3.877 Vali Acc: 0.117 Test Loss: 3.877 Test Acc: 0.117
Validation loss decreased (-0.116280 --> -0.116871).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.7125918
	speed: 0.4205s/iter; left time: 7742.4785s
	iters: 200, epoch: 12 | loss: 2.1087978
	speed: 0.0986s/iter; left time: 1804.8753s
Epoch: 12 cost time: 22.36515164375305
Epoch: 12, Steps: 208 | Train Loss: 1.372 Vali Loss: 4.154 Vali Acc: 0.117 Test Loss: 4.154 Test Acc: 0.117
Validation loss decreased (-0.116871 --> -0.117167).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.9654152
	speed: 0.3586s/iter; left time: 6528.9977s
	iters: 200, epoch: 13 | loss: 0.9398142
	speed: 0.0844s/iter; left time: 1528.4769s
Epoch: 13 cost time: 19.330772638320923
Epoch: 13, Steps: 208 | Train Loss: 1.075 Vali Loss: 4.791 Vali Acc: 0.117 Test Loss: 4.791 Test Acc: 0.117
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.1063281
	speed: 0.3257s/iter; left time: 5861.2191s
	iters: 200, epoch: 14 | loss: 0.7909201
	speed: 0.0905s/iter; left time: 1619.0222s
Epoch: 14 cost time: 18.23355722427368
Epoch: 14, Steps: 208 | Train Loss: 0.905 Vali Loss: 4.776 Vali Acc: 0.114 Test Loss: 4.776 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.6648319
	speed: 0.3912s/iter; left time: 6959.0178s
	iters: 200, epoch: 15 | loss: 0.9457352
	speed: 0.0979s/iter; left time: 1732.3696s
Epoch: 15 cost time: 21.50117802619934
Epoch: 15, Steps: 208 | Train Loss: 0.759 Vali Loss: 5.382 Vali Acc: 0.118 Test Loss: 5.382 Test Acc: 0.118
Validation loss decreased (-0.117167 --> -0.117453).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.1712642
	speed: 0.4069s/iter; left time: 7153.2204s
	iters: 200, epoch: 16 | loss: 0.5806419
	speed: 0.1077s/iter; left time: 1882.4345s
Epoch: 16 cost time: 23.425052642822266
Epoch: 16, Steps: 208 | Train Loss: 0.673 Vali Loss: 5.605 Vali Acc: 0.119 Test Loss: 5.605 Test Acc: 0.119
Validation loss decreased (-0.117453 --> -0.118942).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.1884527
	speed: 0.4232s/iter; left time: 7352.5078s
	iters: 200, epoch: 17 | loss: 0.8046591
	speed: 0.1076s/iter; left time: 1858.0160s
Epoch: 17 cost time: 22.72231149673462
Epoch: 17, Steps: 208 | Train Loss: 0.610 Vali Loss: 5.740 Vali Acc: 0.123 Test Loss: 5.740 Test Acc: 0.123
Validation loss decreased (-0.118942 --> -0.123116).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.6130854
	speed: 0.4070s/iter; left time: 6986.4080s
	iters: 200, epoch: 18 | loss: 0.9599571
	speed: 0.0880s/iter; left time: 1502.1861s
Epoch: 18 cost time: 19.532743453979492
Epoch: 18, Steps: 208 | Train Loss: 0.545 Vali Loss: 6.010 Vali Acc: 0.109 Test Loss: 6.010 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.8234230
	speed: 0.3655s/iter; left time: 6197.8277s
	iters: 200, epoch: 19 | loss: 0.5469407
	speed: 0.1024s/iter; left time: 1726.0792s
Epoch: 19 cost time: 21.966994047164917
Epoch: 19, Steps: 208 | Train Loss: 0.519 Vali Loss: 6.149 Vali Acc: 0.124 Test Loss: 6.149 Test Acc: 0.124
Validation loss decreased (-0.123116 --> -0.123708).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.9032978
	speed: 0.3940s/iter; left time: 6598.7222s
	iters: 200, epoch: 20 | loss: 0.4243332
	speed: 0.0996s/iter; left time: 1658.7066s
Epoch: 20 cost time: 21.575327396392822
Epoch: 20, Steps: 208 | Train Loss: 0.473 Vali Loss: 6.508 Vali Acc: 0.124 Test Loss: 6.508 Test Acc: 0.124
Validation loss decreased (-0.123708 --> -0.124301).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.2496097
	speed: 0.4016s/iter; left time: 6643.2842s
	iters: 200, epoch: 21 | loss: 0.6591002
	speed: 0.0921s/iter; left time: 1514.1602s
Epoch: 21 cost time: 22.018416166305542
Epoch: 21, Steps: 208 | Train Loss: 0.451 Vali Loss: 6.435 Vali Acc: 0.117 Test Loss: 6.435 Test Acc: 0.117
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.2935154
	speed: 0.3554s/iter; left time: 5804.0305s
	iters: 200, epoch: 22 | loss: 0.7418421
	speed: 0.0910s/iter; left time: 1476.7814s
Epoch: 22 cost time: 19.394712924957275
Epoch: 22, Steps: 208 | Train Loss: 0.432 Vali Loss: 6.554 Vali Acc: 0.127 Test Loss: 6.554 Test Acc: 0.127
Validation loss decreased (-0.124301 --> -0.126687).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.4303787
	speed: 0.3529s/iter; left time: 5690.4972s
	iters: 200, epoch: 23 | loss: 0.1387668
	speed: 0.0965s/iter; left time: 1546.4391s
Epoch: 23 cost time: 20.490833520889282
Epoch: 23, Steps: 208 | Train Loss: 0.401 Vali Loss: 6.848 Vali Acc: 0.119 Test Loss: 6.848 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.4719799
	speed: 0.3620s/iter; left time: 5761.4448s
	iters: 200, epoch: 24 | loss: 0.2530898
	speed: 0.0763s/iter; left time: 1206.7718s
Epoch: 24 cost time: 17.041588306427002
Epoch: 24, Steps: 208 | Train Loss: 0.370 Vali Loss: 6.718 Vali Acc: 0.118 Test Loss: 6.718 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.2996176
	speed: 0.3250s/iter; left time: 5104.7787s
	iters: 200, epoch: 25 | loss: 0.6839228
	speed: 0.0747s/iter; left time: 1165.9131s
Epoch: 25 cost time: 15.56688666343689
Epoch: 25, Steps: 208 | Train Loss: 0.365 Vali Loss: 7.234 Vali Acc: 0.121 Test Loss: 7.234 Test Acc: 0.121
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.1774371
	speed: 0.3134s/iter; left time: 4857.8184s
	iters: 200, epoch: 26 | loss: 0.3139245
	speed: 0.0803s/iter; left time: 1237.3737s
Epoch: 26 cost time: 17.650879859924316
Epoch: 26, Steps: 208 | Train Loss: 0.373 Vali Loss: 7.618 Vali Acc: 0.118 Test Loss: 7.618 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.2345539
	speed: 0.3098s/iter; left time: 4737.3371s
	iters: 200, epoch: 27 | loss: 0.4380282
	speed: 0.0797s/iter; left time: 1211.0652s
Epoch: 27 cost time: 17.59501886367798
Epoch: 27, Steps: 208 | Train Loss: 0.310 Vali Loss: 7.419 Vali Acc: 0.118 Test Loss: 7.419 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0266897
	speed: 0.3264s/iter; left time: 4923.4206s
	iters: 200, epoch: 28 | loss: 0.3565525
	speed: 0.0723s/iter; left time: 1083.1095s
Epoch: 28 cost time: 17.01908564567566
Epoch: 28, Steps: 208 | Train Loss: 0.331 Vali Loss: 7.404 Vali Acc: 0.127 Test Loss: 7.404 Test Acc: 0.127
Validation loss decreased (-0.126687 --> -0.126976).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.5879161
	speed: 0.3125s/iter; left time: 4648.3946s
	iters: 200, epoch: 29 | loss: 0.1593825
	speed: 0.0801s/iter; left time: 1183.9775s
Epoch: 29 cost time: 16.846410512924194
Epoch: 29, Steps: 208 | Train Loss: 0.316 Vali Loss: 7.504 Vali Acc: 0.125 Test Loss: 7.504 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.1120043
	speed: 0.3495s/iter; left time: 5126.9990s
	iters: 200, epoch: 30 | loss: 0.2727338
	speed: 0.0867s/iter; left time: 1262.8016s
Epoch: 30 cost time: 18.415791034698486
Epoch: 30, Steps: 208 | Train Loss: 0.339 Vali Loss: 7.929 Vali Acc: 0.124 Test Loss: 7.929 Test Acc: 0.124
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.2971547
	speed: 0.3508s/iter; left time: 5073.3885s
	iters: 200, epoch: 31 | loss: 0.2323779
	speed: 0.0977s/iter; left time: 1402.8031s
Epoch: 31 cost time: 20.391318559646606
Epoch: 31, Steps: 208 | Train Loss: 0.303 Vali Loss: 8.381 Vali Acc: 0.115 Test Loss: 8.381 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.0075526
	speed: 0.3704s/iter; left time: 5279.5786s
	iters: 200, epoch: 32 | loss: 0.3913830
	speed: 0.0945s/iter; left time: 1337.6223s
Epoch: 32 cost time: 19.093337535858154
Epoch: 32, Steps: 208 | Train Loss: 0.318 Vali Loss: 8.406 Vali Acc: 0.118 Test Loss: 8.406 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.6182573
	speed: 0.3591s/iter; left time: 5043.0132s
	iters: 200, epoch: 33 | loss: 0.0371953
	speed: 0.0837s/iter; left time: 1167.5275s
Epoch: 33 cost time: 17.95117449760437
Epoch: 33, Steps: 208 | Train Loss: 0.297 Vali Loss: 8.607 Vali Acc: 0.118 Test Loss: 8.607 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.0379265
	speed: 0.3510s/iter; left time: 4857.0971s
	iters: 200, epoch: 34 | loss: 0.2841007
	speed: 0.0828s/iter; left time: 1137.3547s
Epoch: 34 cost time: 18.608124494552612
Epoch: 34, Steps: 208 | Train Loss: 0.301 Vali Loss: 8.139 Vali Acc: 0.123 Test Loss: 8.139 Test Acc: 0.123
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 0.5194629
	speed: 0.3739s/iter; left time: 5095.4242s
	iters: 200, epoch: 35 | loss: 0.0531592
	speed: 0.0744s/iter; left time: 1007.2021s
Epoch: 35 cost time: 17.62494707107544
Epoch: 35, Steps: 208 | Train Loss: 0.262 Vali Loss: 8.611 Vali Acc: 0.124 Test Loss: 8.611 Test Acc: 0.124
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 0.0241661
	speed: 0.3333s/iter; left time: 4473.6853s
	iters: 200, epoch: 36 | loss: 0.1983099
	speed: 0.0773s/iter; left time: 1029.9541s
Epoch: 36 cost time: 17.438117742538452
Epoch: 36, Steps: 208 | Train Loss: 0.262 Vali Loss: 8.144 Vali Acc: 0.115 Test Loss: 8.144 Test Acc: 0.115
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 0.4355398
	speed: 0.3092s/iter; left time: 4085.2279s
	iters: 200, epoch: 37 | loss: 0.0577474
	speed: 0.0830s/iter; left time: 1088.7218s
Epoch: 37 cost time: 17.35094952583313
Epoch: 37, Steps: 208 | Train Loss: 0.293 Vali Loss: 8.467 Vali Acc: 0.121 Test Loss: 8.467 Test Acc: 0.121
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 0.0458827
	speed: 0.3009s/iter; left time: 3912.9212s
	iters: 200, epoch: 38 | loss: 0.0416302
	speed: 0.0772s/iter; left time: 996.5217s
Epoch: 38 cost time: 17.277181148529053
Epoch: 38, Steps: 208 | Train Loss: 0.289 Vali Loss: 8.487 Vali Acc: 0.121 Test Loss: 8.487 Test Acc: 0.121
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12705040262451536
model parameter : 1296075
model size : 6.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9974909
	speed: 0.1397s/iter; left time: 2891.8356s
	iters: 200, epoch: 1 | loss: 4.3524995
	speed: 0.1072s/iter; left time: 2209.0306s
Epoch: 1 cost time: 25.979013919830322
Epoch: 1, Steps: 208 | Train Loss: 3.911 Vali Loss: 3.865 Vali Acc: 0.058 Test Loss: 3.865 Test Acc: 0.058
Validation loss decreased (inf --> -0.057820).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8136246
	speed: 0.4539s/iter; left time: 9302.6957s
	iters: 200, epoch: 2 | loss: 4.1925173
	speed: 0.1188s/iter; left time: 2422.5766s
Epoch: 2 cost time: 26.12661051750183
Epoch: 2, Steps: 208 | Train Loss: 3.756 Vali Loss: 3.666 Vali Acc: 0.060 Test Loss: 3.666 Test Acc: 0.060
Validation loss decreased (-0.057820 --> -0.059910).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5842452
	speed: 0.5095s/iter; left time: 10335.0600s
	iters: 200, epoch: 3 | loss: 3.8409545
	speed: 0.1287s/iter; left time: 2596.8065s
Epoch: 3 cost time: 27.742950439453125
Epoch: 3, Steps: 208 | Train Loss: 3.617 Vali Loss: 3.607 Vali Acc: 0.050 Test Loss: 3.607 Test Acc: 0.050
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.4591351
	speed: 0.4736s/iter; left time: 9508.4510s
	iters: 200, epoch: 4 | loss: 3.4278598
	speed: 0.1185s/iter; left time: 2367.9553s
Epoch: 4 cost time: 25.593220472335815
Epoch: 4, Steps: 208 | Train Loss: 3.526 Vali Loss: 3.573 Vali Acc: 0.069 Test Loss: 3.573 Test Acc: 0.069
Validation loss decreased (-0.059910 --> -0.068560).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2592697
	speed: 0.4510s/iter; left time: 8961.3114s
	iters: 200, epoch: 5 | loss: 3.4057589
	speed: 0.1018s/iter; left time: 2011.5649s
Epoch: 5 cost time: 22.465997457504272
Epoch: 5, Steps: 208 | Train Loss: 3.340 Vali Loss: 3.378 Vali Acc: 0.093 Test Loss: 3.378 Test Acc: 0.093
Validation loss decreased (-0.068560 --> -0.092719).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.3128905
	speed: 0.4948s/iter; left time: 9727.9215s
	iters: 200, epoch: 6 | loss: 3.9758320
	speed: 0.1197s/iter; left time: 2341.8597s
Epoch: 6 cost time: 26.59183096885681
Epoch: 6, Steps: 208 | Train Loss: 3.168 Vali Loss: 3.289 Vali Acc: 0.097 Test Loss: 3.289 Test Acc: 0.097
Validation loss decreased (-0.092719 --> -0.096597).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9059298
	speed: 0.5072s/iter; left time: 9867.2854s
	iters: 200, epoch: 7 | loss: 3.0719590
	speed: 0.1185s/iter; left time: 2292.5454s
Epoch: 7 cost time: 25.729363918304443
Epoch: 7, Steps: 208 | Train Loss: 2.987 Vali Loss: 3.243 Vali Acc: 0.097 Test Loss: 3.243 Test Acc: 0.097
Validation loss decreased (-0.096597 --> -0.096896).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.1485388
	speed: 0.4603s/iter; left time: 8857.7496s
	iters: 200, epoch: 8 | loss: 2.9006109
	speed: 0.1168s/iter; left time: 2236.3428s
Epoch: 8 cost time: 25.712108612060547
Epoch: 8, Steps: 208 | Train Loss: 2.770 Vali Loss: 3.291 Vali Acc: 0.110 Test Loss: 3.291 Test Acc: 0.110
Validation loss decreased (-0.096896 --> -0.110018).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.7033789
	speed: 0.4534s/iter; left time: 8631.2630s
	iters: 200, epoch: 9 | loss: 2.9356415
	speed: 0.0955s/iter; left time: 1808.7250s
Epoch: 9 cost time: 21.66932439804077
Epoch: 9, Steps: 208 | Train Loss: 2.490 Vali Loss: 3.441 Vali Acc: 0.115 Test Loss: 3.441 Test Acc: 0.115
Validation loss decreased (-0.110018 --> -0.114788).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.5096536
	speed: 0.4689s/iter; left time: 8829.4325s
	iters: 200, epoch: 10 | loss: 2.5281403
	speed: 0.0936s/iter; left time: 1752.1508s
Epoch: 10 cost time: 22.74090886116028
Epoch: 10, Steps: 208 | Train Loss: 2.150 Vali Loss: 3.521 Vali Acc: 0.121 Test Loss: 3.521 Test Acc: 0.121
Validation loss decreased (-0.114788 --> -0.121349).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.1648390
	speed: 0.4477s/iter; left time: 8337.0458s
	iters: 200, epoch: 11 | loss: 1.7376205
	speed: 0.0943s/iter; left time: 1746.1875s
Epoch: 11 cost time: 22.353057384490967
Epoch: 11, Steps: 208 | Train Loss: 1.745 Vali Loss: 3.795 Vali Acc: 0.117 Test Loss: 3.795 Test Acc: 0.117
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.4038239
	speed: 0.3967s/iter; left time: 7303.6927s
	iters: 200, epoch: 12 | loss: 1.8148977
	speed: 0.0774s/iter; left time: 1417.4854s
Epoch: 12 cost time: 19.304704427719116
Epoch: 12, Steps: 208 | Train Loss: 1.408 Vali Loss: 4.269 Vali Acc: 0.117 Test Loss: 4.269 Test Acc: 0.117
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.2726828
	speed: 0.3226s/iter; left time: 5872.7459s
	iters: 200, epoch: 13 | loss: 1.0940007
	speed: 0.0899s/iter; left time: 1628.0817s
Epoch: 13 cost time: 18.39182162284851
Epoch: 13, Steps: 208 | Train Loss: 1.064 Vali Loss: 4.732 Vali Acc: 0.118 Test Loss: 4.732 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.0093063
	speed: 0.3336s/iter; left time: 6003.2963s
	iters: 200, epoch: 14 | loss: 1.4562608
	speed: 0.0805s/iter; left time: 1440.1596s
Epoch: 14 cost time: 18.22719979286194
Epoch: 14, Steps: 208 | Train Loss: 0.866 Vali Loss: 5.418 Vali Acc: 0.123 Test Loss: 5.418 Test Acc: 0.123
Validation loss decreased (-0.121349 --> -0.122523).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.8423719
	speed: 0.3438s/iter; left time: 6116.2969s
	iters: 200, epoch: 15 | loss: 0.8080049
	speed: 0.0858s/iter; left time: 1517.2744s
Epoch: 15 cost time: 18.24998188018799
Epoch: 15, Steps: 208 | Train Loss: 0.809 Vali Loss: 5.509 Vali Acc: 0.122 Test Loss: 5.509 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.6299359
	speed: 0.3653s/iter; left time: 6422.8564s
	iters: 200, epoch: 16 | loss: 0.7096818
	speed: 0.0909s/iter; left time: 1588.9298s
Epoch: 16 cost time: 20.124268054962158
Epoch: 16, Steps: 208 | Train Loss: 0.692 Vali Loss: 5.639 Vali Acc: 0.129 Test Loss: 5.639 Test Acc: 0.129
Validation loss decreased (-0.122523 --> -0.128783).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.7275397
	speed: 0.4082s/iter; left time: 7092.5044s
	iters: 200, epoch: 17 | loss: 0.5986757
	speed: 0.0995s/iter; left time: 1719.1581s
Epoch: 17 cost time: 21.41615080833435
Epoch: 17, Steps: 208 | Train Loss: 0.599 Vali Loss: 5.984 Vali Acc: 0.110 Test Loss: 5.984 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.8268419
	speed: 0.3977s/iter; left time: 6826.7674s
	iters: 200, epoch: 18 | loss: 0.9258496
	speed: 0.0926s/iter; left time: 1580.8529s
Epoch: 18 cost time: 21.23245882987976
Epoch: 18, Steps: 208 | Train Loss: 0.551 Vali Loss: 6.140 Vali Acc: 0.121 Test Loss: 6.140 Test Acc: 0.121
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.3384262
	speed: 0.3950s/iter; left time: 6697.6125s
	iters: 200, epoch: 19 | loss: 0.4930916
	speed: 0.1208s/iter; left time: 2036.9109s
Epoch: 19 cost time: 25.995784282684326
Epoch: 19, Steps: 208 | Train Loss: 0.504 Vali Loss: 6.540 Vali Acc: 0.121 Test Loss: 6.540 Test Acc: 0.121
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.2350692
	speed: 0.4251s/iter; left time: 7120.1257s
	iters: 200, epoch: 20 | loss: 0.6229488
	speed: 0.1039s/iter; left time: 1730.1443s
Epoch: 20 cost time: 22.965538501739502
Epoch: 20, Steps: 208 | Train Loss: 0.494 Vali Loss: 7.094 Vali Acc: 0.116 Test Loss: 7.094 Test Acc: 0.116
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.2651271
	speed: 0.3789s/iter; left time: 6266.8382s
	iters: 200, epoch: 21 | loss: 0.6590642
	speed: 0.0971s/iter; left time: 1597.2189s
Epoch: 21 cost time: 20.601642608642578
Epoch: 21, Steps: 208 | Train Loss: 0.458 Vali Loss: 6.724 Vali Acc: 0.109 Test Loss: 6.724 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.2722052
	speed: 0.4056s/iter; left time: 6625.1614s
	iters: 200, epoch: 22 | loss: 0.7298335
	speed: 0.0880s/iter; left time: 1428.3035s
Epoch: 22 cost time: 20.968146800994873
Epoch: 22, Steps: 208 | Train Loss: 0.445 Vali Loss: 6.804 Vali Acc: 0.127 Test Loss: 6.804 Test Acc: 0.127
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.5606437
	speed: 0.3679s/iter; left time: 5932.9369s
	iters: 200, epoch: 23 | loss: 0.3100355
	speed: 0.0906s/iter; left time: 1452.5437s
Epoch: 23 cost time: 19.65240502357483
Epoch: 23, Steps: 208 | Train Loss: 0.412 Vali Loss: 7.371 Vali Acc: 0.120 Test Loss: 7.371 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.1230166
	speed: 0.3644s/iter; left time: 5800.7521s
	iters: 200, epoch: 24 | loss: 0.0759657
	speed: 0.1000s/iter; left time: 1581.6374s
Epoch: 24 cost time: 21.400713205337524
Epoch: 24, Steps: 208 | Train Loss: 0.366 Vali Loss: 7.619 Vali Acc: 0.127 Test Loss: 7.619 Test Acc: 0.127
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.5395993
	speed: 0.3793s/iter; left time: 5959.0994s
	iters: 200, epoch: 25 | loss: 0.2078351
	speed: 0.0938s/iter; left time: 1463.8517s
Epoch: 25 cost time: 21.061793327331543
Epoch: 25, Steps: 208 | Train Loss: 0.356 Vali Loss: 7.566 Vali Acc: 0.125 Test Loss: 7.566 Test Acc: 0.125
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.2505625
	speed: 0.3639s/iter; left time: 5640.9641s
	iters: 200, epoch: 26 | loss: 0.4861616
	speed: 0.0812s/iter; left time: 1251.1301s
Epoch: 26 cost time: 18.86598229408264
Epoch: 26, Steps: 208 | Train Loss: 0.374 Vali Loss: 7.618 Vali Acc: 0.120 Test Loss: 7.618 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1288398449150015
model parameter : 1294219
model size : 6.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1033211
	speed: 0.1259s/iter; left time: 2607.1212s
	iters: 200, epoch: 1 | loss: 3.9324067
	speed: 0.0923s/iter; left time: 1902.3436s
Epoch: 1 cost time: 22.862157821655273
Epoch: 1, Steps: 208 | Train Loss: 3.944 Vali Loss: 4.138 Vali Acc: 0.044 Test Loss: 4.138 Test Acc: 0.044
Validation loss decreased (inf --> -0.044396).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7416496
	speed: 0.3592s/iter; left time: 7361.4521s
	iters: 200, epoch: 2 | loss: 3.5078259
	speed: 0.0984s/iter; left time: 2006.4046s
Epoch: 2 cost time: 21.059492349624634
Epoch: 2, Steps: 208 | Train Loss: 3.833 Vali Loss: 3.723 Vali Acc: 0.059 Test Loss: 3.723 Test Acc: 0.059
Validation loss decreased (-0.044396 --> -0.059313).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4342475
	speed: 0.3868s/iter; left time: 7845.5249s
	iters: 200, epoch: 3 | loss: 3.5176144
	speed: 0.1021s/iter; left time: 2060.1031s
Epoch: 3 cost time: 21.710726261138916
Epoch: 3, Steps: 208 | Train Loss: 3.616 Vali Loss: 3.632 Vali Acc: 0.037 Test Loss: 3.632 Test Acc: 0.037
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.4517484
	speed: 0.4004s/iter; left time: 8038.9934s
	iters: 200, epoch: 4 | loss: 3.0116675
	speed: 0.1000s/iter; left time: 1998.4940s
Epoch: 4 cost time: 22.170519828796387
Epoch: 4, Steps: 208 | Train Loss: 3.517 Vali Loss: 3.533 Vali Acc: 0.056 Test Loss: 3.533 Test Acc: 0.056
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 3.9112065
	speed: 0.4027s/iter; left time: 8001.8474s
	iters: 200, epoch: 5 | loss: 3.5024946
	speed: 0.0944s/iter; left time: 1867.1328s
Epoch: 5 cost time: 20.576759338378906
Epoch: 5, Steps: 208 | Train Loss: 3.377 Vali Loss: 3.375 Vali Acc: 0.084 Test Loss: 3.375 Test Acc: 0.084
Validation loss decreased (-0.059313 --> -0.083474).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.1259949
	speed: 0.3634s/iter; left time: 7145.3406s
	iters: 200, epoch: 6 | loss: 3.5787487
	speed: 0.0855s/iter; left time: 1673.0014s
Epoch: 6 cost time: 19.71263337135315
Epoch: 6, Steps: 208 | Train Loss: 3.187 Vali Loss: 3.387 Vali Acc: 0.087 Test Loss: 3.387 Test Acc: 0.087
Validation loss decreased (-0.083474 --> -0.087351).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.1667578
	speed: 0.3696s/iter; left time: 7189.8286s
	iters: 200, epoch: 7 | loss: 3.2318637
	speed: 0.0938s/iter; left time: 1814.5665s
Epoch: 7 cost time: 21.608717441558838
Epoch: 7, Steps: 208 | Train Loss: 3.048 Vali Loss: 3.238 Vali Acc: 0.108 Test Loss: 3.238 Test Acc: 0.108
Validation loss decreased (-0.087351 --> -0.107931).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.5875723
	speed: 0.3561s/iter; left time: 6852.3133s
	iters: 200, epoch: 8 | loss: 3.1571133
	speed: 0.0958s/iter; left time: 1833.3126s
Epoch: 8 cost time: 21.41651701927185
Epoch: 8, Steps: 208 | Train Loss: 2.833 Vali Loss: 3.227 Vali Acc: 0.108 Test Loss: 3.227 Test Acc: 0.108
Validation loss decreased (-0.107931 --> -0.108229).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.7721055
	speed: 0.3960s/iter; left time: 7538.8302s
	iters: 200, epoch: 9 | loss: 2.7823195
	speed: 0.0881s/iter; left time: 1668.5984s
Epoch: 9 cost time: 20.251062631607056
Epoch: 9, Steps: 208 | Train Loss: 2.609 Vali Loss: 3.346 Vali Acc: 0.123 Test Loss: 3.346 Test Acc: 0.123
Validation loss decreased (-0.108229 --> -0.123140).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.4469438
	speed: 0.3495s/iter; left time: 6580.5513s
	iters: 200, epoch: 10 | loss: 2.3497610
	speed: 0.0947s/iter; left time: 1774.2417s
Epoch: 10 cost time: 20.191235780715942
Epoch: 10, Steps: 208 | Train Loss: 2.296 Vali Loss: 3.761 Vali Acc: 0.113 Test Loss: 3.761 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.9418997
	speed: 0.3554s/iter; left time: 6618.0999s
	iters: 200, epoch: 11 | loss: 1.6681491
	speed: 0.0856s/iter; left time: 1585.5586s
Epoch: 11 cost time: 18.336941957473755
Epoch: 11, Steps: 208 | Train Loss: 1.930 Vali Loss: 3.626 Vali Acc: 0.123 Test Loss: 3.626 Test Acc: 0.123
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.9061830
	speed: 0.3397s/iter; left time: 6255.7739s
	iters: 200, epoch: 12 | loss: 2.0593657
	speed: 0.0845s/iter; left time: 1547.4262s
Epoch: 12 cost time: 19.013535499572754
Epoch: 12, Steps: 208 | Train Loss: 1.594 Vali Loss: 4.210 Vali Acc: 0.115 Test Loss: 4.210 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.7927615
	speed: 0.3083s/iter; left time: 5613.5116s
	iters: 200, epoch: 13 | loss: 0.8432598
	speed: 0.0713s/iter; left time: 1290.8190s
Epoch: 13 cost time: 16.283904790878296
Epoch: 13, Steps: 208 | Train Loss: 1.247 Vali Loss: 4.684 Vali Acc: 0.126 Test Loss: 4.684 Test Acc: 0.126
Validation loss decreased (-0.123140 --> -0.125811).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.6774883
	speed: 0.3302s/iter; left time: 5942.3575s
	iters: 200, epoch: 14 | loss: 0.6180977
	speed: 0.0908s/iter; left time: 1624.1786s
Epoch: 14 cost time: 19.92730402946472
Epoch: 14, Steps: 208 | Train Loss: 1.016 Vali Loss: 4.766 Vali Acc: 0.125 Test Loss: 4.766 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.0611647
	speed: 0.3516s/iter; left time: 6254.6734s
	iters: 200, epoch: 15 | loss: 0.6361831
	speed: 0.0908s/iter; left time: 1606.2066s
Epoch: 15 cost time: 20.152366876602173
Epoch: 15, Steps: 208 | Train Loss: 0.850 Vali Loss: 5.451 Vali Acc: 0.118 Test Loss: 5.451 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.7330416
	speed: 0.3672s/iter; left time: 6454.9221s
	iters: 200, epoch: 16 | loss: 0.4870556
	speed: 0.0905s/iter; left time: 1581.9702s
Epoch: 16 cost time: 20.462995052337646
Epoch: 16, Steps: 208 | Train Loss: 0.743 Vali Loss: 5.683 Vali Acc: 0.115 Test Loss: 5.683 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.6804616
	speed: 0.3111s/iter; left time: 5403.8888s
	iters: 200, epoch: 17 | loss: 0.9163550
	speed: 0.0809s/iter; left time: 1397.8071s
Epoch: 17 cost time: 17.21089792251587
Epoch: 17, Steps: 208 | Train Loss: 0.643 Vali Loss: 5.838 Vali Acc: 0.113 Test Loss: 5.838 Test Acc: 0.113
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.9240034
	speed: 0.2970s/iter; left time: 5097.7717s
	iters: 200, epoch: 18 | loss: 0.5956699
	speed: 0.0757s/iter; left time: 1291.0772s
Epoch: 18 cost time: 17.18027138710022
Epoch: 18, Steps: 208 | Train Loss: 0.585 Vali Loss: 5.877 Vali Acc: 0.120 Test Loss: 5.877 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.7384201
	speed: 0.3107s/iter; left time: 5268.9930s
	iters: 200, epoch: 19 | loss: 0.7356412
	speed: 0.0841s/iter; left time: 1417.6072s
Epoch: 19 cost time: 17.823151111602783
Epoch: 19, Steps: 208 | Train Loss: 0.535 Vali Loss: 6.216 Vali Acc: 0.102 Test Loss: 6.216 Test Acc: 0.102
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.8409379
	speed: 0.3097s/iter; left time: 5186.4253s
	iters: 200, epoch: 20 | loss: 0.6369033
	speed: 0.0850s/iter; left time: 1415.6088s
Epoch: 20 cost time: 18.74879479408264
Epoch: 20, Steps: 208 | Train Loss: 0.464 Vali Loss: 6.609 Vali Acc: 0.113 Test Loss: 6.609 Test Acc: 0.113
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.2608764
	speed: 0.3091s/iter; left time: 5112.5329s
	iters: 200, epoch: 21 | loss: 0.3235131
	speed: 0.0913s/iter; left time: 1500.5259s
Epoch: 21 cost time: 19.461207389831543
Epoch: 21, Steps: 208 | Train Loss: 0.483 Vali Loss: 6.635 Vali Acc: 0.118 Test Loss: 6.635 Test Acc: 0.118
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.6423919
	speed: 0.2857s/iter; left time: 4666.3373s
	iters: 200, epoch: 22 | loss: 0.4998647
	speed: 0.0903s/iter; left time: 1466.3750s
Epoch: 22 cost time: 18.952091217041016
Epoch: 22, Steps: 208 | Train Loss: 0.438 Vali Loss: 6.738 Vali Acc: 0.112 Test Loss: 6.738 Test Acc: 0.112
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.2589483
	speed: 0.3156s/iter; left time: 5089.1537s
	iters: 200, epoch: 23 | loss: 0.5343942
	speed: 0.0848s/iter; left time: 1359.4339s
Epoch: 23 cost time: 18.81263780593872
Epoch: 23, Steps: 208 | Train Loss: 0.424 Vali Loss: 6.770 Vali Acc: 0.113 Test Loss: 6.770 Test Acc: 0.113
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1258574410975246
model parameter : 1292363
model size : 6.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1087499
	speed: 0.1131s/iter; left time: 2341.6149s
	iters: 200, epoch: 1 | loss: 4.3264470
	speed: 0.0816s/iter; left time: 1680.9541s
Epoch: 1 cost time: 20.03246545791626
Epoch: 1, Steps: 208 | Train Loss: 3.916 Vali Loss: 4.001 Vali Acc: 0.052 Test Loss: 4.001 Test Acc: 0.052
Validation loss decreased (inf --> -0.051556).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9638088
	speed: 0.2794s/iter; left time: 5726.6103s
	iters: 200, epoch: 2 | loss: 4.0999875
	speed: 0.0775s/iter; left time: 1579.8023s
Epoch: 2 cost time: 17.72805142402649
Epoch: 2, Steps: 208 | Train Loss: 3.897 Vali Loss: 3.728 Vali Acc: 0.065 Test Loss: 3.728 Test Acc: 0.065
Validation loss decreased (-0.051556 --> -0.065277).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.9219298
	speed: 0.3041s/iter; left time: 6169.0052s
	iters: 200, epoch: 3 | loss: 3.3330500
	speed: 0.0687s/iter; left time: 1385.8998s
Epoch: 3 cost time: 17.094910144805908
Epoch: 3, Steps: 208 | Train Loss: 3.625 Vali Loss: 3.714 Vali Acc: 0.058 Test Loss: 3.714 Test Acc: 0.058
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.6076109
	speed: 0.2897s/iter; left time: 5815.6256s
	iters: 200, epoch: 4 | loss: 3.7506723
	speed: 0.0825s/iter; left time: 1648.3116s
Epoch: 4 cost time: 18.02577018737793
Epoch: 4, Steps: 208 | Train Loss: 3.496 Vali Loss: 3.653 Vali Acc: 0.063 Test Loss: 3.653 Test Acc: 0.063
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.7376547
	speed: 0.2939s/iter; left time: 5839.8486s
	iters: 200, epoch: 5 | loss: 3.4508748
	speed: 0.0761s/iter; left time: 1505.3494s
Epoch: 5 cost time: 17.311424016952515
Epoch: 5, Steps: 208 | Train Loss: 3.334 Vali Loss: 3.524 Vali Acc: 0.072 Test Loss: 3.524 Test Acc: 0.072
Validation loss decreased (-0.065277 --> -0.071841).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2495282
	speed: 0.2697s/iter; left time: 5303.5459s
	iters: 200, epoch: 6 | loss: 3.4678872
	speed: 0.0812s/iter; left time: 1588.4795s
Epoch: 6 cost time: 18.024383544921875
Epoch: 6, Steps: 208 | Train Loss: 3.159 Vali Loss: 3.432 Vali Acc: 0.081 Test Loss: 3.432 Test Acc: 0.081
Validation loss decreased (-0.071841 --> -0.081385).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9496200
	speed: 0.2992s/iter; left time: 5820.9926s
	iters: 200, epoch: 7 | loss: 2.4090619
	speed: 0.0768s/iter; left time: 1486.2520s
Epoch: 7 cost time: 17.528544664382935
Epoch: 7, Steps: 208 | Train Loss: 2.985 Vali Loss: 3.569 Vali Acc: 0.088 Test Loss: 3.569 Test Acc: 0.088
Validation loss decreased (-0.081385 --> -0.088243).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.9849737
	speed: 0.2903s/iter; left time: 5586.2907s
	iters: 200, epoch: 8 | loss: 2.9209006
	speed: 0.0795s/iter; left time: 1522.1952s
Epoch: 8 cost time: 17.603693962097168
Epoch: 8, Steps: 208 | Train Loss: 2.789 Vali Loss: 3.503 Vali Acc: 0.091 Test Loss: 3.503 Test Acc: 0.091
Validation loss decreased (-0.088243 --> -0.091227).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.3780577
	speed: 0.2804s/iter; left time: 5338.8865s
	iters: 200, epoch: 9 | loss: 2.6565757
	speed: 0.0866s/iter; left time: 1639.0026s
Epoch: 9 cost time: 18.486886262893677
Epoch: 9, Steps: 208 | Train Loss: 2.501 Vali Loss: 3.600 Vali Acc: 0.103 Test Loss: 3.600 Test Acc: 0.103
Validation loss decreased (-0.091227 --> -0.103155).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.2744493
	speed: 0.2799s/iter; left time: 5270.2641s
	iters: 200, epoch: 10 | loss: 2.6018002
	speed: 0.0878s/iter; left time: 1645.0259s
Epoch: 10 cost time: 18.793278694152832
Epoch: 10, Steps: 208 | Train Loss: 2.128 Vali Loss: 3.861 Vali Acc: 0.106 Test Loss: 3.861 Test Acc: 0.106
Validation loss decreased (-0.103155 --> -0.105538).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.0709231
	speed: 0.2621s/iter; left time: 4880.2604s
	iters: 200, epoch: 11 | loss: 1.8218116
	speed: 0.0834s/iter; left time: 1544.1148s
Epoch: 11 cost time: 18.272942543029785
Epoch: 11, Steps: 208 | Train Loss: 1.725 Vali Loss: 4.155 Vali Acc: 0.095 Test Loss: 4.155 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.4304296
	speed: 0.2627s/iter; left time: 4836.5753s
	iters: 200, epoch: 12 | loss: 1.7774971
	speed: 0.0840s/iter; left time: 1537.4195s
Epoch: 12 cost time: 17.99138593673706
Epoch: 12, Steps: 208 | Train Loss: 1.318 Vali Loss: 4.676 Vali Acc: 0.109 Test Loss: 4.676 Test Acc: 0.109
Validation loss decreased (-0.105538 --> -0.108811).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.1957195
	speed: 0.2630s/iter; left time: 4788.1324s
	iters: 200, epoch: 13 | loss: 0.9390506
	speed: 0.0856s/iter; left time: 1549.0782s
Epoch: 13 cost time: 17.754228353500366
Epoch: 13, Steps: 208 | Train Loss: 0.999 Vali Loss: 5.163 Vali Acc: 0.103 Test Loss: 5.163 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.1236346
	speed: 0.2625s/iter; left time: 4724.7217s
	iters: 200, epoch: 14 | loss: 0.8193339
	speed: 0.0884s/iter; left time: 1581.2531s
Epoch: 14 cost time: 17.91704797744751
Epoch: 14, Steps: 208 | Train Loss: 0.797 Vali Loss: 5.370 Vali Acc: 0.101 Test Loss: 5.370 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.9812639
	speed: 0.2648s/iter; left time: 4710.2103s
	iters: 200, epoch: 15 | loss: 1.0410271
	speed: 0.0897s/iter; left time: 1586.6139s
Epoch: 15 cost time: 18.339887380599976
Epoch: 15, Steps: 208 | Train Loss: 0.687 Vali Loss: 5.902 Vali Acc: 0.108 Test Loss: 5.902 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.2841471
	speed: 0.2634s/iter; left time: 4631.1109s
	iters: 200, epoch: 16 | loss: 0.4920791
	speed: 0.0726s/iter; left time: 1269.1746s
Epoch: 16 cost time: 14.918192863464355
Epoch: 16, Steps: 208 | Train Loss: 0.577 Vali Loss: 6.098 Vali Acc: 0.105 Test Loss: 6.098 Test Acc: 0.105
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.2610272
	speed: 0.2160s/iter; left time: 3752.7294s
	iters: 200, epoch: 17 | loss: 0.7557350
	speed: 0.0573s/iter; left time: 989.0854s
Epoch: 17 cost time: 11.642181634902954
Epoch: 17, Steps: 208 | Train Loss: 0.534 Vali Loss: 6.358 Vali Acc: 0.099 Test Loss: 6.358 Test Acc: 0.099
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.8203356
	speed: 0.2807s/iter; left time: 4818.5715s
	iters: 200, epoch: 18 | loss: 0.8607505
	speed: 0.0789s/iter; left time: 1346.4956s
Epoch: 18 cost time: 17.705354928970337
Epoch: 18, Steps: 208 | Train Loss: 0.493 Vali Loss: 6.529 Vali Acc: 0.101 Test Loss: 6.529 Test Acc: 0.101
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.3447289
	speed: 0.2813s/iter; left time: 4770.7730s
	iters: 200, epoch: 19 | loss: 0.0772530
	speed: 0.0852s/iter; left time: 1435.5387s
Epoch: 19 cost time: 17.565929889678955
Epoch: 19, Steps: 208 | Train Loss: 0.446 Vali Loss: 6.845 Vali Acc: 0.105 Test Loss: 6.845 Test Acc: 0.105
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.6782930
	speed: 0.2795s/iter; left time: 4680.8831s
	iters: 200, epoch: 20 | loss: 0.4224885
	speed: 0.0810s/iter; left time: 1348.2368s
Epoch: 20 cost time: 17.0916645526886
Epoch: 20, Steps: 208 | Train Loss: 0.394 Vali Loss: 7.143 Vali Acc: 0.104 Test Loss: 7.143 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.2942142
	speed: 0.2667s/iter; left time: 4411.9444s
	iters: 200, epoch: 21 | loss: 0.9209392
	speed: 0.0849s/iter; left time: 1395.2857s
Epoch: 21 cost time: 16.985528230667114
Epoch: 21, Steps: 208 | Train Loss: 0.382 Vali Loss: 7.454 Vali Acc: 0.112 Test Loss: 7.454 Test Acc: 0.112
Validation loss decreased (-0.108811 --> -0.111467).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.8683975
	speed: 0.2435s/iter; left time: 3976.9743s
	iters: 200, epoch: 22 | loss: 0.5237854
	speed: 0.0840s/iter; left time: 1363.0060s
Epoch: 22 cost time: 16.628129482269287
Epoch: 22, Steps: 208 | Train Loss: 0.350 Vali Loss: 7.280 Vali Acc: 0.102 Test Loss: 7.280 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0252847
	speed: 0.2660s/iter; left time: 4289.0387s
	iters: 200, epoch: 23 | loss: 0.9086947
	speed: 0.0836s/iter; left time: 1339.8242s
Epoch: 23 cost time: 17.192352294921875
Epoch: 23, Steps: 208 | Train Loss: 0.353 Vali Loss: 7.354 Vali Acc: 0.113 Test Loss: 7.354 Test Acc: 0.113
Validation loss decreased (-0.111467 --> -0.112960).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.4816352
	speed: 0.2702s/iter; left time: 4299.9811s
	iters: 200, epoch: 24 | loss: 0.4710669
	speed: 0.0822s/iter; left time: 1300.4342s
Epoch: 24 cost time: 16.919984579086304
Epoch: 24, Steps: 208 | Train Loss: 0.351 Vali Loss: 7.822 Vali Acc: 0.102 Test Loss: 7.822 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.7610362
	speed: 0.2793s/iter; left time: 4388.2482s
	iters: 200, epoch: 25 | loss: 0.3060907
	speed: 0.0845s/iter; left time: 1318.8776s
Epoch: 25 cost time: 18.43606972694397
Epoch: 25, Steps: 208 | Train Loss: 0.345 Vali Loss: 7.783 Vali Acc: 0.109 Test Loss: 7.783 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.5706234
	speed: 0.2642s/iter; left time: 4094.6696s
	iters: 200, epoch: 26 | loss: 0.1024929
	speed: 0.0838s/iter; left time: 1291.0991s
Epoch: 26 cost time: 18.418192386627197
Epoch: 26, Steps: 208 | Train Loss: 0.297 Vali Loss: 7.896 Vali Acc: 0.099 Test Loss: 7.896 Test Acc: 0.099
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.6210685
	speed: 0.2558s/iter; left time: 3912.1704s
	iters: 200, epoch: 27 | loss: 0.6995322
	speed: 0.0838s/iter; left time: 1273.5485s
Epoch: 27 cost time: 17.989250659942627
Epoch: 27, Steps: 208 | Train Loss: 0.326 Vali Loss: 8.845 Vali Acc: 0.106 Test Loss: 8.845 Test Acc: 0.106
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.1163111
	speed: 0.2796s/iter; left time: 4218.2970s
	iters: 200, epoch: 28 | loss: 0.2132752
	speed: 0.0802s/iter; left time: 1201.6434s
Epoch: 28 cost time: 17.231756925582886
Epoch: 28, Steps: 208 | Train Loss: 0.310 Vali Loss: 7.655 Vali Acc: 0.100 Test Loss: 7.655 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0916103
	speed: 0.2835s/iter; left time: 4218.0431s
	iters: 200, epoch: 29 | loss: 0.4530795
	speed: 0.0794s/iter; left time: 1172.7769s
Epoch: 29 cost time: 18.010882139205933
Epoch: 29, Steps: 208 | Train Loss: 0.273 Vali Loss: 8.073 Vali Acc: 0.111 Test Loss: 8.073 Test Acc: 0.111
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.1948959
	speed: 0.3029s/iter; left time: 4442.7524s
	iters: 200, epoch: 30 | loss: 0.0693973
	speed: 0.0796s/iter; left time: 1159.0420s
Epoch: 30 cost time: 18.123547077178955
Epoch: 30, Steps: 208 | Train Loss: 0.276 Vali Loss: 8.161 Vali Acc: 0.102 Test Loss: 8.161 Test Acc: 0.102
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 1.0425935
	speed: 0.2802s/iter; left time: 4052.5208s
	iters: 200, epoch: 31 | loss: 0.1152101
	speed: 0.0798s/iter; left time: 1146.5776s
Epoch: 31 cost time: 18.016295194625854
Epoch: 31, Steps: 208 | Train Loss: 0.252 Vali Loss: 8.835 Vali Acc: 0.107 Test Loss: 8.835 Test Acc: 0.107
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0258142
	speed: 0.2943s/iter; left time: 4194.1714s
	iters: 200, epoch: 32 | loss: 0.2960924
	speed: 0.0793s/iter; left time: 1122.2419s
Epoch: 32 cost time: 17.146366596221924
Epoch: 32, Steps: 208 | Train Loss: 0.260 Vali Loss: 8.861 Vali Acc: 0.111 Test Loss: 8.861 Test Acc: 0.111
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.3519479
	speed: 0.2905s/iter; left time: 4079.9302s
	iters: 200, epoch: 33 | loss: 0.0123605
	speed: 0.0808s/iter; left time: 1127.3051s
Epoch: 33 cost time: 17.00206971168518
Epoch: 33, Steps: 208 | Train Loss: 0.251 Vali Loss: 9.025 Vali Acc: 0.104 Test Loss: 9.025 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.113033104682374
model parameter : 1290507
model size : 6.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8665402
	speed: 0.0997s/iter; left time: 2064.2844s
	iters: 200, epoch: 1 | loss: 3.9170210
	speed: 0.0736s/iter; left time: 1515.9375s
Epoch: 1 cost time: 18.022876024246216
Epoch: 1, Steps: 208 | Train Loss: 3.961 Vali Loss: 3.862 Vali Acc: 0.054 Test Loss: 3.862 Test Acc: 0.054
Validation loss decreased (inf --> -0.054241).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.1783175
	speed: 0.2954s/iter; left time: 6053.4920s
	iters: 200, epoch: 2 | loss: 3.5956447
	speed: 0.0795s/iter; left time: 1621.4643s
Epoch: 2 cost time: 17.542075157165527
Epoch: 2, Steps: 208 | Train Loss: 3.809 Vali Loss: 3.870 Vali Acc: 0.053 Test Loss: 3.870 Test Acc: 0.053
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.4765778
	speed: 0.2807s/iter; left time: 5694.6629s
	iters: 200, epoch: 3 | loss: 3.6979961
	speed: 0.0849s/iter; left time: 1713.2254s
Epoch: 3 cost time: 16.958049774169922
Epoch: 3, Steps: 208 | Train Loss: 3.640 Vali Loss: 3.573 Vali Acc: 0.067 Test Loss: 3.573 Test Acc: 0.067
Validation loss decreased (-0.054241 --> -0.066770).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.5205107
	speed: 0.2681s/iter; left time: 5381.8285s
	iters: 200, epoch: 4 | loss: 3.7652502
	speed: 0.0859s/iter; left time: 1715.7563s
Epoch: 4 cost time: 17.674715995788574
Epoch: 4, Steps: 208 | Train Loss: 3.490 Vali Loss: 3.606 Vali Acc: 0.065 Test Loss: 3.606 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.6322320
	speed: 0.2539s/iter; left time: 5044.9714s
	iters: 200, epoch: 5 | loss: 3.4620039
	speed: 0.0862s/iter; left time: 1703.6011s
Epoch: 5 cost time: 17.664081811904907
Epoch: 5, Steps: 208 | Train Loss: 3.342 Vali Loss: 3.486 Vali Acc: 0.073 Test Loss: 3.486 Test Acc: 0.073
Validation loss decreased (-0.066770 --> -0.072736).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2653000
	speed: 0.2525s/iter; left time: 4963.6390s
	iters: 200, epoch: 6 | loss: 2.9072657
	speed: 0.0762s/iter; left time: 1490.0371s
Epoch: 6 cost time: 15.566993474960327
Epoch: 6, Steps: 208 | Train Loss: 3.181 Vali Loss: 3.279 Vali Acc: 0.089 Test Loss: 3.279 Test Acc: 0.089
Validation loss decreased (-0.072736 --> -0.089439).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.4897125
	speed: 0.2054s/iter; left time: 3996.0872s
	iters: 200, epoch: 7 | loss: 3.1169989
	speed: 0.0706s/iter; left time: 1367.2103s
Epoch: 7 cost time: 14.073166608810425
Epoch: 7, Steps: 208 | Train Loss: 3.009 Vali Loss: 3.256 Vali Acc: 0.107 Test Loss: 3.256 Test Acc: 0.107
Validation loss decreased (-0.089439 --> -0.107036).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.9940367
	speed: 0.2461s/iter; left time: 4736.0404s
	iters: 200, epoch: 8 | loss: 2.8541164
	speed: 0.0791s/iter; left time: 1514.4084s
Epoch: 8 cost time: 16.151931047439575
Epoch: 8, Steps: 208 | Train Loss: 2.765 Vali Loss: 3.244 Vali Acc: 0.098 Test Loss: 3.244 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.5449717
	speed: 0.2631s/iter; left time: 5008.0948s
	iters: 200, epoch: 9 | loss: 2.8994544
	speed: 0.0773s/iter; left time: 1462.9864s
Epoch: 9 cost time: 17.023895740509033
Epoch: 9, Steps: 208 | Train Loss: 2.477 Vali Loss: 3.315 Vali Acc: 0.112 Test Loss: 3.315 Test Acc: 0.112
Validation loss decreased (-0.107036 --> -0.111807).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.5981402
	speed: 0.2910s/iter; left time: 5480.0227s
	iters: 200, epoch: 10 | loss: 2.1573596
	speed: 0.0741s/iter; left time: 1388.3192s
Epoch: 10 cost time: 16.55913782119751
Epoch: 10, Steps: 208 | Train Loss: 2.144 Vali Loss: 3.615 Vali Acc: 0.118 Test Loss: 3.615 Test Acc: 0.118
Validation loss decreased (-0.111807 --> -0.118067).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4336337
	speed: 0.2650s/iter; left time: 4934.9474s
	iters: 200, epoch: 11 | loss: 1.6417428
	speed: 0.0762s/iter; left time: 1410.6149s
Epoch: 11 cost time: 17.103572368621826
Epoch: 11, Steps: 208 | Train Loss: 1.741 Vali Loss: 4.024 Vali Acc: 0.125 Test Loss: 4.024 Test Acc: 0.125
Validation loss decreased (-0.118067 --> -0.124624).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.0703130
	speed: 0.2749s/iter; left time: 5062.3537s
	iters: 200, epoch: 12 | loss: 1.0698581
	speed: 0.0819s/iter; left time: 1500.2614s
Epoch: 12 cost time: 18.119152545928955
Epoch: 12, Steps: 208 | Train Loss: 1.379 Vali Loss: 4.520 Vali Acc: 0.117 Test Loss: 4.520 Test Acc: 0.117
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.2296705
	speed: 0.2439s/iter; left time: 4440.4567s
	iters: 200, epoch: 13 | loss: 1.5003418
	speed: 0.0766s/iter; left time: 1386.7877s
Epoch: 13 cost time: 17.05335521697998
Epoch: 13, Steps: 208 | Train Loss: 1.062 Vali Loss: 4.755 Vali Acc: 0.114 Test Loss: 4.755 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.7824215
	speed: 0.2603s/iter; left time: 4685.4909s
	iters: 200, epoch: 14 | loss: 0.9352177
	speed: 0.0705s/iter; left time: 1261.8028s
Epoch: 14 cost time: 16.01421070098877
Epoch: 14, Steps: 208 | Train Loss: 0.864 Vali Loss: 5.108 Vali Acc: 0.112 Test Loss: 5.108 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.4940457
	speed: 0.2638s/iter; left time: 4693.4197s
	iters: 200, epoch: 15 | loss: 0.8721354
	speed: 0.0727s/iter; left time: 1286.7359s
Epoch: 15 cost time: 15.844165086746216
Epoch: 15, Steps: 208 | Train Loss: 0.704 Vali Loss: 5.706 Vali Acc: 0.112 Test Loss: 5.706 Test Acc: 0.112
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.6248793
	speed: 0.2610s/iter; left time: 4589.2626s
	iters: 200, epoch: 16 | loss: 0.6010159
	speed: 0.0758s/iter; left time: 1324.8809s
Epoch: 16 cost time: 16.585405826568604
Epoch: 16, Steps: 208 | Train Loss: 0.617 Vali Loss: 6.177 Vali Acc: 0.107 Test Loss: 6.177 Test Acc: 0.107
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.5688508
	speed: 0.2449s/iter; left time: 4253.9910s
	iters: 200, epoch: 17 | loss: 0.5834332
	speed: 0.0778s/iter; left time: 1343.1676s
Epoch: 17 cost time: 16.695494413375854
Epoch: 17, Steps: 208 | Train Loss: 0.543 Vali Loss: 6.160 Vali Acc: 0.111 Test Loss: 6.160 Test Acc: 0.111
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.2111147
	speed: 0.2441s/iter; left time: 4189.7721s
	iters: 200, epoch: 18 | loss: 0.5839207
	speed: 0.0735s/iter; left time: 1254.2909s
Epoch: 18 cost time: 15.909475088119507
Epoch: 18, Steps: 208 | Train Loss: 0.499 Vali Loss: 6.384 Vali Acc: 0.110 Test Loss: 6.384 Test Acc: 0.110
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.9482101
	speed: 0.2483s/iter; left time: 4210.9058s
	iters: 200, epoch: 19 | loss: 0.2654730
	speed: 0.0694s/iter; left time: 1170.6319s
Epoch: 19 cost time: 15.523322820663452
Epoch: 19, Steps: 208 | Train Loss: 0.449 Vali Loss: 6.633 Vali Acc: 0.110 Test Loss: 6.633 Test Acc: 0.110
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.0124457
	speed: 0.2444s/iter; left time: 4093.1326s
	iters: 200, epoch: 20 | loss: 0.5075670
	speed: 0.0786s/iter; left time: 1307.8458s
Epoch: 20 cost time: 16.706533193588257
Epoch: 20, Steps: 208 | Train Loss: 0.426 Vali Loss: 6.957 Vali Acc: 0.113 Test Loss: 6.957 Test Acc: 0.113
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0708873
	speed: 0.2504s/iter; left time: 4141.4435s
	iters: 200, epoch: 21 | loss: 0.3445711
	speed: 0.0782s/iter; left time: 1285.2233s
Epoch: 21 cost time: 17.08244490623474
Epoch: 21, Steps: 208 | Train Loss: 0.417 Vali Loss: 6.386 Vali Acc: 0.117 Test Loss: 6.386 Test Acc: 0.117
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12466447957053385
model parameter : 965835
model size : 5.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.5320854
	speed: 0.1045s/iter; left time: 2163.9101s
	iters: 200, epoch: 1 | loss: 4.1710496
	speed: 0.0766s/iter; left time: 1578.0350s
Epoch: 1 cost time: 18.746251583099365
Epoch: 1, Steps: 208 | Train Loss: 3.912 Vali Loss: 4.186 Vali Acc: 0.040 Test Loss: 4.186 Test Acc: 0.040
Validation loss decreased (inf --> -0.039922).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.1127183
	speed: 0.2571s/iter; left time: 5269.1547s
	iters: 200, epoch: 2 | loss: 4.3157053
	speed: 0.0883s/iter; left time: 1801.1977s
Epoch: 2 cost time: 18.804150104522705
Epoch: 2, Steps: 208 | Train Loss: 3.725 Vali Loss: 3.630 Vali Acc: 0.052 Test Loss: 3.630 Test Acc: 0.052
Validation loss decreased (-0.039922 --> -0.052156).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3924232
	speed: 0.2553s/iter; left time: 5178.8163s
	iters: 200, epoch: 3 | loss: 3.8190050
	speed: 0.0810s/iter; left time: 1635.3126s
Epoch: 3 cost time: 17.665613174438477
Epoch: 3, Steps: 208 | Train Loss: 3.580 Vali Loss: 3.597 Vali Acc: 0.045 Test Loss: 3.597 Test Acc: 0.045
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.5393951
	speed: 0.2711s/iter; left time: 5442.0210s
	iters: 200, epoch: 4 | loss: 3.9946904
	speed: 0.0887s/iter; left time: 1772.6993s
Epoch: 4 cost time: 19.320573329925537
Epoch: 4, Steps: 208 | Train Loss: 3.494 Vali Loss: 3.591 Vali Acc: 0.060 Test Loss: 3.591 Test Acc: 0.060
Validation loss decreased (-0.052156 --> -0.059612).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.1785131
	speed: 0.2659s/iter; left time: 5283.8640s
	iters: 200, epoch: 5 | loss: 3.3018718
	speed: 0.0895s/iter; left time: 1769.0028s
Epoch: 5 cost time: 19.427440404891968
Epoch: 5, Steps: 208 | Train Loss: 3.307 Vali Loss: 3.496 Vali Acc: 0.078 Test Loss: 3.496 Test Acc: 0.078
Validation loss decreased (-0.059612 --> -0.078402).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.8523438
	speed: 0.2604s/iter; left time: 5119.4507s
	iters: 200, epoch: 6 | loss: 3.5393388
	speed: 0.0805s/iter; left time: 1575.0018s
Epoch: 6 cost time: 17.596256732940674
Epoch: 6, Steps: 208 | Train Loss: 3.131 Vali Loss: 3.259 Vali Acc: 0.084 Test Loss: 3.259 Test Acc: 0.084
Validation loss decreased (-0.078402 --> -0.084369).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.2592876
	speed: 0.2437s/iter; left time: 4739.9997s
	iters: 200, epoch: 7 | loss: 3.2555358
	speed: 0.0759s/iter; left time: 1468.4839s
Epoch: 7 cost time: 16.104607105255127
Epoch: 7, Steps: 208 | Train Loss: 2.975 Vali Loss: 3.218 Vali Acc: 0.099 Test Loss: 3.218 Test Acc: 0.099
Validation loss decreased (-0.084369 --> -0.098685).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.9516914
	speed: 0.2169s/iter; left time: 4174.6838s
	iters: 200, epoch: 8 | loss: 2.7980928
	speed: 0.0740s/iter; left time: 1416.1076s
Epoch: 8 cost time: 15.417858123779297
Epoch: 8, Steps: 208 | Train Loss: 2.763 Vali Loss: 3.272 Vali Acc: 0.124 Test Loss: 3.272 Test Acc: 0.124
Validation loss decreased (-0.098685 --> -0.124035).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.7779467
	speed: 0.2546s/iter; left time: 4847.0259s
	iters: 200, epoch: 9 | loss: 2.3692861
	speed: 0.0762s/iter; left time: 1442.1154s
Epoch: 9 cost time: 16.107187032699585
Epoch: 9, Steps: 208 | Train Loss: 2.453 Vali Loss: 3.389 Vali Acc: 0.101 Test Loss: 3.389 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.0744481
	speed: 0.2337s/iter; left time: 4400.7791s
	iters: 200, epoch: 10 | loss: 2.2930398
	speed: 0.0785s/iter; left time: 1470.7549s
Epoch: 10 cost time: 16.586435079574585
Epoch: 10, Steps: 208 | Train Loss: 2.103 Vali Loss: 3.658 Vali Acc: 0.117 Test Loss: 3.658 Test Acc: 0.117
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.3519455
	speed: 0.2393s/iter; left time: 4456.2022s
	iters: 200, epoch: 11 | loss: 1.9436303
	speed: 0.0785s/iter; left time: 1453.3127s
Epoch: 11 cost time: 16.826199531555176
Epoch: 11, Steps: 208 | Train Loss: 1.732 Vali Loss: 3.842 Vali Acc: 0.115 Test Loss: 3.842 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.8199503
	speed: 0.2402s/iter; left time: 4423.1408s
	iters: 200, epoch: 12 | loss: 1.5412139
	speed: 0.0736s/iter; left time: 1348.5450s
Epoch: 12 cost time: 16.23225998878479
Epoch: 12, Steps: 208 | Train Loss: 1.343 Vali Loss: 4.428 Vali Acc: 0.117 Test Loss: 4.428 Test Acc: 0.117
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.4030497
	speed: 0.2329s/iter; left time: 4240.4781s
	iters: 200, epoch: 13 | loss: 1.4082336
	speed: 0.0732s/iter; left time: 1324.9321s
Epoch: 13 cost time: 16.105077743530273
Epoch: 13, Steps: 208 | Train Loss: 1.040 Vali Loss: 4.803 Vali Acc: 0.115 Test Loss: 4.803 Test Acc: 0.115
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.1655207
	speed: 0.2403s/iter; left time: 4324.5945s
	iters: 200, epoch: 14 | loss: 0.8358866
	speed: 0.0671s/iter; left time: 1200.5247s
Epoch: 14 cost time: 15.411082029342651
Epoch: 14, Steps: 208 | Train Loss: 0.864 Vali Loss: 5.279 Vali Acc: 0.113 Test Loss: 5.279 Test Acc: 0.113
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.2303578
	speed: 0.2611s/iter; left time: 4644.5756s
	iters: 200, epoch: 15 | loss: 0.8565628
	speed: 0.0835s/iter; left time: 1477.6447s
Epoch: 15 cost time: 17.670469760894775
Epoch: 15, Steps: 208 | Train Loss: 0.721 Vali Loss: 5.717 Vali Acc: 0.112 Test Loss: 5.717 Test Acc: 0.112
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.7300848
	speed: 0.2623s/iter; left time: 4611.3581s
	iters: 200, epoch: 16 | loss: 0.2286498
	speed: 0.0805s/iter; left time: 1408.0057s
Epoch: 16 cost time: 17.632264614105225
Epoch: 16, Steps: 208 | Train Loss: 0.614 Vali Loss: 6.117 Vali Acc: 0.114 Test Loss: 6.117 Test Acc: 0.114
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.2473352
	speed: 0.2793s/iter; left time: 4852.7344s
	iters: 200, epoch: 17 | loss: 1.0306530
	speed: 0.0768s/iter; left time: 1326.9048s
Epoch: 17 cost time: 16.902838468551636
Epoch: 17, Steps: 208 | Train Loss: 0.542 Vali Loss: 6.141 Vali Acc: 0.113 Test Loss: 6.141 Test Acc: 0.113
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.6229025
	speed: 0.2449s/iter; left time: 4203.6531s
	iters: 200, epoch: 18 | loss: 0.4505126
	speed: 0.0778s/iter; left time: 1327.0618s
Epoch: 18 cost time: 17.24324917793274
Epoch: 18, Steps: 208 | Train Loss: 0.520 Vali Loss: 6.219 Vali Acc: 0.119 Test Loss: 6.219 Test Acc: 0.119
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12406799880703848
model parameter : 963979
model size : 5.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1618571
	speed: 0.0853s/iter; left time: 1766.1611s
	iters: 200, epoch: 1 | loss: 3.9012585
	speed: 0.0684s/iter; left time: 1408.6847s
Epoch: 1 cost time: 15.996810674667358
Epoch: 1, Steps: 208 | Train Loss: 3.924 Vali Loss: 4.173 Vali Acc: 0.049 Test Loss: 4.173 Test Acc: 0.049
Validation loss decreased (inf --> -0.048571).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7393951
	speed: 0.1989s/iter; left time: 4075.2703s
	iters: 200, epoch: 2 | loss: 3.7738130
	speed: 0.0756s/iter; left time: 1541.1965s
Epoch: 2 cost time: 13.861823558807373
Epoch: 2, Steps: 208 | Train Loss: 3.890 Vali Loss: 3.807 Vali Acc: 0.064 Test Loss: 3.807 Test Acc: 0.064
Validation loss decreased (-0.048571 --> -0.063785).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.8266654
	speed: 0.2606s/iter; left time: 5285.5113s
	iters: 200, epoch: 3 | loss: 3.6195929
	speed: 0.0820s/iter; left time: 1655.4120s
Epoch: 3 cost time: 16.9400851726532
Epoch: 3, Steps: 208 | Train Loss: 3.623 Vali Loss: 3.676 Vali Acc: 0.044 Test Loss: 3.676 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.4222252
	speed: 0.2475s/iter; left time: 4969.0874s
	iters: 200, epoch: 4 | loss: 3.2306216
	speed: 0.0756s/iter; left time: 1510.9338s
Epoch: 4 cost time: 16.744513511657715
Epoch: 4, Steps: 208 | Train Loss: 3.515 Vali Loss: 3.525 Vali Acc: 0.070 Test Loss: 3.525 Test Acc: 0.070
Validation loss decreased (-0.063785 --> -0.070349).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.6493342
	speed: 0.3063s/iter; left time: 6086.1670s
	iters: 200, epoch: 5 | loss: 3.7371018
	speed: 0.0864s/iter; left time: 1708.7913s
Epoch: 5 cost time: 18.23160481452942
Epoch: 5, Steps: 208 | Train Loss: 3.339 Vali Loss: 3.450 Vali Acc: 0.075 Test Loss: 3.450 Test Acc: 0.075
Validation loss decreased (-0.070349 --> -0.074526).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.3986905
	speed: 0.2791s/iter; left time: 5487.4807s
	iters: 200, epoch: 6 | loss: 2.9589252
	speed: 0.0846s/iter; left time: 1655.3149s
Epoch: 6 cost time: 17.552112340927124
Epoch: 6, Steps: 208 | Train Loss: 3.105 Vali Loss: 3.282 Vali Acc: 0.103 Test Loss: 3.282 Test Acc: 0.103
Validation loss decreased (-0.074526 --> -0.103457).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9613702
	speed: 0.2857s/iter; left time: 5556.9588s
	iters: 200, epoch: 7 | loss: 2.8282721
	speed: 0.0907s/iter; left time: 1755.5350s
Epoch: 7 cost time: 18.953301429748535
Epoch: 7, Steps: 208 | Train Loss: 2.902 Vali Loss: 3.300 Vali Acc: 0.104 Test Loss: 3.300 Test Acc: 0.104
Validation loss decreased (-0.103457 --> -0.103755).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.4802825
	speed: 0.2996s/iter; left time: 5766.4378s
	iters: 200, epoch: 8 | loss: 2.9246192
	speed: 0.0839s/iter; left time: 1605.5435s
Epoch: 8 cost time: 18.891982793807983
Epoch: 8, Steps: 208 | Train Loss: 2.603 Vali Loss: 3.337 Vali Acc: 0.103 Test Loss: 3.337 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.3712714
	speed: 0.2741s/iter; left time: 5218.1252s
	iters: 200, epoch: 9 | loss: 2.9729114
	speed: 0.0813s/iter; left time: 1540.4697s
Epoch: 9 cost time: 17.663399934768677
Epoch: 9, Steps: 208 | Train Loss: 2.260 Vali Loss: 3.705 Vali Acc: 0.108 Test Loss: 3.705 Test Acc: 0.108
Validation loss decreased (-0.103755 --> -0.107628).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.2722156
	speed: 0.2593s/iter; left time: 4882.5728s
	iters: 200, epoch: 10 | loss: 2.0850308
	speed: 0.0781s/iter; left time: 1462.7994s
Epoch: 10 cost time: 17.56217885017395
Epoch: 10, Steps: 208 | Train Loss: 1.828 Vali Loss: 3.697 Vali Acc: 0.109 Test Loss: 3.697 Test Acc: 0.109
Validation loss decreased (-0.107628 --> -0.109417).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5097427
	speed: 0.2669s/iter; left time: 4969.9336s
	iters: 200, epoch: 11 | loss: 1.2945206
	speed: 0.0796s/iter; left time: 1473.6329s
Epoch: 11 cost time: 17.907495737075806
Epoch: 11, Steps: 208 | Train Loss: 1.440 Vali Loss: 4.290 Vali Acc: 0.113 Test Loss: 4.290 Test Acc: 0.113
Validation loss decreased (-0.109417 --> -0.112692).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.1844158
	speed: 0.2677s/iter; left time: 4928.9559s
	iters: 200, epoch: 12 | loss: 1.2633333
	speed: 0.0798s/iter; left time: 1461.5309s
Epoch: 12 cost time: 17.665621757507324
Epoch: 12, Steps: 208 | Train Loss: 1.093 Vali Loss: 4.646 Vali Acc: 0.118 Test Loss: 4.646 Test Acc: 0.118
Validation loss decreased (-0.112692 --> -0.117460).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.5956116
	speed: 0.2661s/iter; left time: 4844.5351s
	iters: 200, epoch: 13 | loss: 1.5422647
	speed: 0.0784s/iter; left time: 1419.0808s
Epoch: 13 cost time: 17.391579389572144
Epoch: 13, Steps: 208 | Train Loss: 0.836 Vali Loss: 5.023 Vali Acc: 0.102 Test Loss: 5.023 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.7105514
	speed: 0.2609s/iter; left time: 4696.0385s
	iters: 200, epoch: 14 | loss: 1.1473470
	speed: 0.0764s/iter; left time: 1367.9310s
Epoch: 14 cost time: 17.371345043182373
Epoch: 14, Steps: 208 | Train Loss: 0.710 Vali Loss: 5.752 Vali Acc: 0.096 Test Loss: 5.752 Test Acc: 0.096
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.7869929
	speed: 0.2467s/iter; left time: 4388.4147s
	iters: 200, epoch: 15 | loss: 0.3783218
	speed: 0.0760s/iter; left time: 1344.5692s
Epoch: 15 cost time: 17.22886061668396
Epoch: 15, Steps: 208 | Train Loss: 0.595 Vali Loss: 5.786 Vali Acc: 0.103 Test Loss: 5.786 Test Acc: 0.103
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.3982185
	speed: 0.2585s/iter; left time: 4544.2376s
	iters: 200, epoch: 16 | loss: 0.2540067
	speed: 0.0758s/iter; left time: 1325.2485s
Epoch: 16 cost time: 17.105895280838013
Epoch: 16, Steps: 208 | Train Loss: 0.531 Vali Loss: 6.200 Vali Acc: 0.112 Test Loss: 6.200 Test Acc: 0.112
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.3743012
	speed: 0.2516s/iter; left time: 4370.7517s
	iters: 200, epoch: 17 | loss: 0.8437631
	speed: 0.0711s/iter; left time: 1227.5318s
Epoch: 17 cost time: 16.671443462371826
Epoch: 17, Steps: 208 | Train Loss: 0.461 Vali Loss: 6.259 Vali Acc: 0.113 Test Loss: 6.259 Test Acc: 0.113
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.8045042
	speed: 0.2638s/iter; left time: 4527.2792s
	iters: 200, epoch: 18 | loss: 0.4553808
	speed: 0.0852s/iter; left time: 1454.3195s
Epoch: 18 cost time: 18.348787546157837
Epoch: 18, Steps: 208 | Train Loss: 0.434 Vali Loss: 6.499 Vali Acc: 0.112 Test Loss: 6.499 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.2745646
	speed: 0.2732s/iter; left time: 4631.8061s
	iters: 200, epoch: 19 | loss: 0.6265720
	speed: 0.0823s/iter; left time: 1387.6002s
Epoch: 19 cost time: 17.977258682250977
Epoch: 19, Steps: 208 | Train Loss: 0.415 Vali Loss: 6.569 Vali Acc: 0.110 Test Loss: 6.569 Test Acc: 0.110
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.2472895
	speed: 0.2728s/iter; left time: 4568.5625s
	iters: 200, epoch: 20 | loss: 0.8692313
	speed: 0.0791s/iter; left time: 1316.4181s
Epoch: 20 cost time: 17.82596778869629
Epoch: 20, Steps: 208 | Train Loss: 0.384 Vali Loss: 6.795 Vali Acc: 0.107 Test Loss: 6.795 Test Acc: 0.107
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.3501512
	speed: 0.2811s/iter; left time: 4648.9503s
	iters: 200, epoch: 21 | loss: 0.3708901
	speed: 0.0787s/iter; left time: 1293.1554s
Epoch: 21 cost time: 17.619115352630615
Epoch: 21, Steps: 208 | Train Loss: 0.349 Vali Loss: 7.342 Vali Acc: 0.106 Test Loss: 7.342 Test Acc: 0.106
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.6658140
	speed: 0.2705s/iter; left time: 4418.0893s
	iters: 200, epoch: 22 | loss: 0.2815581
	speed: 0.0800s/iter; left time: 1298.1858s
Epoch: 22 cost time: 17.813794136047363
Epoch: 22, Steps: 208 | Train Loss: 0.341 Vali Loss: 7.668 Vali Acc: 0.110 Test Loss: 7.668 Test Acc: 0.110
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11750671040858933
model parameter : 962123
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.5629392
	speed: 0.0986s/iter; left time: 2042.1349s
	iters: 200, epoch: 1 | loss: 4.3373027
	speed: 0.0768s/iter; left time: 1581.8043s
Epoch: 1 cost time: 18.14678931236267
Epoch: 1, Steps: 208 | Train Loss: 3.928 Vali Loss: 3.952 Vali Acc: 0.052 Test Loss: 3.952 Test Acc: 0.052
Validation loss decreased (inf --> -0.052153).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7994463
	speed: 0.2746s/iter; left time: 5627.4889s
	iters: 200, epoch: 2 | loss: 3.7776318
	speed: 0.0764s/iter; left time: 1557.8185s
Epoch: 2 cost time: 16.73378825187683
Epoch: 2, Steps: 208 | Train Loss: 3.796 Vali Loss: 3.665 Vali Acc: 0.052 Test Loss: 3.665 Test Acc: 0.052
Validation loss decreased (-0.052153 --> -0.052155).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6181483
	speed: 0.2265s/iter; left time: 4595.0171s
	iters: 200, epoch: 3 | loss: 3.0203509
	speed: 0.0491s/iter; left time: 992.0741s
Epoch: 3 cost time: 11.206328630447388
Epoch: 3, Steps: 208 | Train Loss: 3.619 Vali Loss: 3.781 Vali Acc: 0.056 Test Loss: 3.781 Test Acc: 0.056
Validation loss decreased (-0.052155 --> -0.056330).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4691694
	speed: 0.2249s/iter; left time: 4515.9740s
	iters: 200, epoch: 4 | loss: 3.3671496
	speed: 0.0787s/iter; left time: 1572.1615s
Epoch: 4 cost time: 16.381582260131836
Epoch: 4, Steps: 208 | Train Loss: 3.506 Vali Loss: 3.621 Vali Acc: 0.083 Test Loss: 3.621 Test Acc: 0.083
Validation loss decreased (-0.056330 --> -0.082576).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.9289887
	speed: 0.2513s/iter; left time: 4993.3249s
	iters: 200, epoch: 5 | loss: 3.2604170
	speed: 0.0772s/iter; left time: 1525.2600s
Epoch: 5 cost time: 16.858749389648438
Epoch: 5, Steps: 208 | Train Loss: 3.352 Vali Loss: 3.502 Vali Acc: 0.078 Test Loss: 3.502 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.3662579
	speed: 0.2650s/iter; left time: 5210.4240s
	iters: 200, epoch: 6 | loss: 3.5007014
	speed: 0.0779s/iter; left time: 1523.3821s
Epoch: 6 cost time: 17.240477561950684
Epoch: 6, Steps: 208 | Train Loss: 3.138 Vali Loss: 3.385 Vali Acc: 0.095 Test Loss: 3.385 Test Acc: 0.095
Validation loss decreased (-0.082576 --> -0.094807).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9804223
	speed: 0.2443s/iter; left time: 4752.2015s
	iters: 200, epoch: 7 | loss: 3.0774548
	speed: 0.0801s/iter; left time: 1549.9354s
Epoch: 7 cost time: 17.512209177017212
Epoch: 7, Steps: 208 | Train Loss: 2.919 Vali Loss: 3.343 Vali Acc: 0.105 Test Loss: 3.343 Test Acc: 0.105
Validation loss decreased (-0.094807 --> -0.105245).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.2231808
	speed: 0.2519s/iter; left time: 4847.2520s
	iters: 200, epoch: 8 | loss: 3.0778704
	speed: 0.0794s/iter; left time: 1519.5530s
Epoch: 8 cost time: 17.753384113311768
Epoch: 8, Steps: 208 | Train Loss: 2.698 Vali Loss: 3.350 Vali Acc: 0.103 Test Loss: 3.350 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.1298981
	speed: 0.2658s/iter; left time: 5059.7035s
	iters: 200, epoch: 9 | loss: 2.0569086
	speed: 0.0888s/iter; left time: 1680.9982s
Epoch: 9 cost time: 18.932949781417847
Epoch: 9, Steps: 208 | Train Loss: 2.396 Vali Loss: 3.595 Vali Acc: 0.118 Test Loss: 3.595 Test Acc: 0.118
Validation loss decreased (-0.105245 --> -0.118365).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.0667014
	speed: 0.2579s/iter; left time: 4856.8310s
	iters: 200, epoch: 10 | loss: 2.6310637
	speed: 0.0875s/iter; left time: 1638.4992s
Epoch: 10 cost time: 17.586270332336426
Epoch: 10, Steps: 208 | Train Loss: 2.012 Vali Loss: 3.896 Vali Acc: 0.116 Test Loss: 3.896 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.3612757
	speed: 0.2625s/iter; left time: 4887.3178s
	iters: 200, epoch: 11 | loss: 2.3414118
	speed: 0.0831s/iter; left time: 1538.5266s
Epoch: 11 cost time: 17.845766067504883
Epoch: 11, Steps: 208 | Train Loss: 1.602 Vali Loss: 4.113 Vali Acc: 0.107 Test Loss: 4.113 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.8175282
	speed: 0.2844s/iter; left time: 5237.2223s
	iters: 200, epoch: 12 | loss: 1.0569204
	speed: 0.0852s/iter; left time: 1560.6059s
Epoch: 12 cost time: 18.154578685760498
Epoch: 12, Steps: 208 | Train Loss: 1.192 Vali Loss: 4.554 Vali Acc: 0.106 Test Loss: 4.554 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.9865869
	speed: 0.2416s/iter; left time: 4397.8499s
	iters: 200, epoch: 13 | loss: 0.8081141
	speed: 0.0799s/iter; left time: 1446.2556s
Epoch: 13 cost time: 16.826432704925537
Epoch: 13, Steps: 208 | Train Loss: 0.929 Vali Loss: 5.243 Vali Acc: 0.111 Test Loss: 5.243 Test Acc: 0.111
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.5346188
	speed: 0.2380s/iter; left time: 4283.8985s
	iters: 200, epoch: 14 | loss: 0.4381331
	speed: 0.0818s/iter; left time: 1463.8336s
Epoch: 14 cost time: 16.288432359695435
Epoch: 14, Steps: 208 | Train Loss: 0.775 Vali Loss: 5.491 Vali Acc: 0.114 Test Loss: 5.491 Test Acc: 0.114
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.2011463
	speed: 0.2342s/iter; left time: 4166.7426s
	iters: 200, epoch: 15 | loss: 0.5650910
	speed: 0.0742s/iter; left time: 1311.8675s
Epoch: 15 cost time: 15.53840684890747
Epoch: 15, Steps: 208 | Train Loss: 0.624 Vali Loss: 6.002 Vali Acc: 0.112 Test Loss: 6.002 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.4162640
	speed: 0.2468s/iter; left time: 4339.8581s
	iters: 200, epoch: 16 | loss: 0.4693763
	speed: 0.0763s/iter; left time: 1334.3774s
Epoch: 16 cost time: 15.955451726913452
Epoch: 16, Steps: 208 | Train Loss: 0.563 Vali Loss: 6.350 Vali Acc: 0.112 Test Loss: 6.350 Test Acc: 0.112
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.1599111
	speed: 0.2428s/iter; left time: 4217.8660s
	iters: 200, epoch: 17 | loss: 0.2983560
	speed: 0.0761s/iter; left time: 1315.2138s
Epoch: 17 cost time: 15.930960893630981
Epoch: 17, Steps: 208 | Train Loss: 0.484 Vali Loss: 6.635 Vali Acc: 0.094 Test Loss: 6.635 Test Acc: 0.094
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.2662746
	speed: 0.2376s/iter; left time: 4078.6711s
	iters: 200, epoch: 18 | loss: 0.1910303
	speed: 0.0666s/iter; left time: 1135.8768s
Epoch: 18 cost time: 16.022980213165283
Epoch: 18, Steps: 208 | Train Loss: 0.463 Vali Loss: 7.003 Vali Acc: 0.108 Test Loss: 7.003 Test Acc: 0.108
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.4615376
	speed: 0.2348s/iter; left time: 3980.8274s
	iters: 200, epoch: 19 | loss: 0.3906948
	speed: 0.0695s/iter; left time: 1171.4268s
Epoch: 19 cost time: 15.282114744186401
Epoch: 19, Steps: 208 | Train Loss: 0.439 Vali Loss: 7.070 Vali Acc: 0.109 Test Loss: 7.070 Test Acc: 0.109
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11840143155383238
model parameter : 960267
model size : 4.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7608483
	speed: 0.1094s/iter; left time: 2264.2200s
	iters: 200, epoch: 1 | loss: 4.1047816
	speed: 0.0778s/iter; left time: 1603.4470s
Epoch: 1 cost time: 19.487881660461426
Epoch: 1, Steps: 208 | Train Loss: 3.917 Vali Loss: 3.684 Vali Acc: 0.050 Test Loss: 3.684 Test Acc: 0.050
Validation loss decreased (inf --> -0.049769).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.0186539
	speed: 0.2456s/iter; left time: 5033.4681s
	iters: 200, epoch: 2 | loss: 3.5222433
	speed: 0.0817s/iter; left time: 1665.8183s
Epoch: 2 cost time: 17.841835498809814
Epoch: 2, Steps: 208 | Train Loss: 3.677 Vali Loss: 3.734 Vali Acc: 0.049 Test Loss: 3.734 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.0941052
	speed: 0.2776s/iter; left time: 5630.4145s
	iters: 200, epoch: 3 | loss: 3.3770332
	speed: 0.0822s/iter; left time: 1659.4469s
Epoch: 3 cost time: 18.599266529083252
Epoch: 3, Steps: 208 | Train Loss: 3.598 Vali Loss: 3.678 Vali Acc: 0.064 Test Loss: 3.678 Test Acc: 0.064
Validation loss decreased (-0.049769 --> -0.064383).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4939830
	speed: 0.2805s/iter; left time: 5630.7094s
	iters: 200, epoch: 4 | loss: 3.6753707
	speed: 0.0792s/iter; left time: 1582.4476s
Epoch: 4 cost time: 17.85857844352722
Epoch: 4, Steps: 208 | Train Loss: 3.527 Vali Loss: 3.535 Vali Acc: 0.066 Test Loss: 3.535 Test Acc: 0.066
Validation loss decreased (-0.064383 --> -0.065876).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2278399
	speed: 0.2653s/iter; left time: 5270.8724s
	iters: 200, epoch: 5 | loss: 3.0168152
	speed: 0.0847s/iter; left time: 1673.4992s
Epoch: 5 cost time: 18.368510961532593
Epoch: 5, Steps: 208 | Train Loss: 3.362 Vali Loss: 3.439 Vali Acc: 0.073 Test Loss: 3.439 Test Acc: 0.073
Validation loss decreased (-0.065876 --> -0.073333).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.5096834
	speed: 0.2811s/iter; left time: 5526.3257s
	iters: 200, epoch: 6 | loss: 3.2838316
	speed: 0.0851s/iter; left time: 1664.9298s
Epoch: 6 cost time: 18.471153736114502
Epoch: 6, Steps: 208 | Train Loss: 3.174 Vali Loss: 3.292 Vali Acc: 0.093 Test Loss: 3.292 Test Acc: 0.093
Validation loss decreased (-0.073333 --> -0.092720).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.3069675
	speed: 0.2545s/iter; left time: 4950.4594s
	iters: 200, epoch: 7 | loss: 3.3458376
	speed: 0.0728s/iter; left time: 1408.3158s
Epoch: 7 cost time: 16.500348567962646
Epoch: 7, Steps: 208 | Train Loss: 3.010 Vali Loss: 3.240 Vali Acc: 0.102 Test Loss: 3.240 Test Acc: 0.102
Validation loss decreased (-0.092720 --> -0.102264).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.8741035
	speed: 0.2403s/iter; left time: 4624.8949s
	iters: 200, epoch: 8 | loss: 2.5105629
	speed: 0.0798s/iter; left time: 1526.8930s
Epoch: 8 cost time: 17.583014965057373
Epoch: 8, Steps: 208 | Train Loss: 2.805 Vali Loss: 3.171 Vali Acc: 0.121 Test Loss: 3.171 Test Acc: 0.121
Validation loss decreased (-0.102264 --> -0.120756).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.6974838
	speed: 0.2057s/iter; left time: 3915.6500s
	iters: 200, epoch: 9 | loss: 2.8239651
	speed: 0.0478s/iter; left time: 905.6092s
Epoch: 9 cost time: 10.423888921737671
Epoch: 9, Steps: 208 | Train Loss: 2.521 Vali Loss: 3.300 Vali Acc: 0.118 Test Loss: 3.300 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.9144690
	speed: 0.2201s/iter; left time: 4143.3581s
	iters: 200, epoch: 10 | loss: 2.7584722
	speed: 0.0809s/iter; left time: 1514.4950s
Epoch: 10 cost time: 17.4727041721344
Epoch: 10, Steps: 208 | Train Loss: 2.219 Vali Loss: 3.581 Vali Acc: 0.119 Test Loss: 3.581 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.4265404
	speed: 0.2406s/iter; left time: 4479.9034s
	iters: 200, epoch: 11 | loss: 2.4329827
	speed: 0.0831s/iter; left time: 1539.5782s
Epoch: 11 cost time: 17.841360330581665
Epoch: 11, Steps: 208 | Train Loss: 1.857 Vali Loss: 3.784 Vali Acc: 0.124 Test Loss: 3.784 Test Acc: 0.124
Validation loss decreased (-0.120756 --> -0.123732).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.8039944
	speed: 0.2405s/iter; left time: 4427.8641s
	iters: 200, epoch: 12 | loss: 1.7049251
	speed: 0.0827s/iter; left time: 1513.9981s
Epoch: 12 cost time: 17.766666173934937
Epoch: 12, Steps: 208 | Train Loss: 1.506 Vali Loss: 4.186 Vali Acc: 0.130 Test Loss: 4.186 Test Acc: 0.130
Validation loss decreased (-0.123732 --> -0.129991).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.0782970
	speed: 0.2196s/iter; left time: 3997.8926s
	iters: 200, epoch: 13 | loss: 1.5907601
	speed: 0.0816s/iter; left time: 1478.1613s
Epoch: 13 cost time: 16.18376898765564
Epoch: 13, Steps: 208 | Train Loss: 1.175 Vali Loss: 5.047 Vali Acc: 0.125 Test Loss: 5.047 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.7382064
	speed: 0.2418s/iter; left time: 4352.0533s
	iters: 200, epoch: 14 | loss: 0.5539118
	speed: 0.0828s/iter; left time: 1482.0227s
Epoch: 14 cost time: 16.24290442466736
Epoch: 14, Steps: 208 | Train Loss: 0.980 Vali Loss: 4.838 Vali Acc: 0.139 Test Loss: 4.838 Test Acc: 0.139
Validation loss decreased (-0.129991 --> -0.138633).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.2201917
	speed: 0.2327s/iter; left time: 4139.7486s
	iters: 200, epoch: 15 | loss: 1.1015598
	speed: 0.0799s/iter; left time: 1414.2067s
Epoch: 15 cost time: 16.645389318466187
Epoch: 15, Steps: 208 | Train Loss: 0.834 Vali Loss: 5.657 Vali Acc: 0.123 Test Loss: 5.657 Test Acc: 0.123
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.0577599
	speed: 0.2299s/iter; left time: 4042.1677s
	iters: 200, epoch: 16 | loss: 1.0613335
	speed: 0.0882s/iter; left time: 1541.7822s
Epoch: 16 cost time: 18.06314706802368
Epoch: 16, Steps: 208 | Train Loss: 0.720 Vali Loss: 5.568 Vali Acc: 0.137 Test Loss: 5.568 Test Acc: 0.137
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.1064825
	speed: 0.2631s/iter; left time: 4570.4184s
	iters: 200, epoch: 17 | loss: 0.9226608
	speed: 0.0879s/iter; left time: 1518.1880s
Epoch: 17 cost time: 18.64419198036194
Epoch: 17, Steps: 208 | Train Loss: 0.655 Vali Loss: 5.957 Vali Acc: 0.132 Test Loss: 5.957 Test Acc: 0.132
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.9765312
	speed: 0.2548s/iter; left time: 4374.0050s
	iters: 200, epoch: 18 | loss: 0.5052701
	speed: 0.0904s/iter; left time: 1542.5303s
Epoch: 18 cost time: 18.283136129379272
Epoch: 18, Steps: 208 | Train Loss: 0.592 Vali Loss: 6.226 Vali Acc: 0.132 Test Loss: 6.226 Test Acc: 0.132
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.6480848
	speed: 0.2663s/iter; left time: 4516.0005s
	iters: 200, epoch: 19 | loss: 0.7939261
	speed: 0.0945s/iter; left time: 1593.5666s
Epoch: 19 cost time: 19.183566331863403
Epoch: 19, Steps: 208 | Train Loss: 0.537 Vali Loss: 6.354 Vali Acc: 0.130 Test Loss: 6.354 Test Acc: 0.130
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.1449746
	speed: 0.2469s/iter; left time: 4135.2756s
	iters: 200, epoch: 20 | loss: 0.2317099
	speed: 0.0830s/iter; left time: 1381.1305s
Epoch: 20 cost time: 17.076290607452393
Epoch: 20, Steps: 208 | Train Loss: 0.509 Vali Loss: 6.776 Vali Acc: 0.132 Test Loss: 6.776 Test Acc: 0.132
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.1890496
	speed: 0.2340s/iter; left time: 3870.6708s
	iters: 200, epoch: 21 | loss: 0.5995298
	speed: 0.0827s/iter; left time: 1359.2229s
Epoch: 21 cost time: 16.94536519050598
Epoch: 21, Steps: 208 | Train Loss: 0.499 Vali Loss: 6.900 Vali Acc: 0.117 Test Loss: 6.900 Test Acc: 0.117
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.2687097
	speed: 0.2343s/iter; left time: 3827.0655s
	iters: 200, epoch: 22 | loss: 0.6981459
	speed: 0.0848s/iter; left time: 1377.1409s
Epoch: 22 cost time: 16.926509141921997
Epoch: 22, Steps: 208 | Train Loss: 0.439 Vali Loss: 7.236 Vali Acc: 0.135 Test Loss: 7.236 Test Acc: 0.135
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.1745423
	speed: 0.2356s/iter; left time: 3798.4952s
	iters: 200, epoch: 23 | loss: 0.6082765
	speed: 0.0799s/iter; left time: 1280.8624s
Epoch: 23 cost time: 16.367004871368408
Epoch: 23, Steps: 208 | Train Loss: 0.410 Vali Loss: 7.475 Vali Acc: 0.126 Test Loss: 7.475 Test Acc: 0.126
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.1594873
	speed: 0.2217s/iter; left time: 3528.7599s
	iters: 200, epoch: 24 | loss: 0.2996820
	speed: 0.0734s/iter; left time: 1161.6721s
Epoch: 24 cost time: 15.567745208740234
Epoch: 24, Steps: 208 | Train Loss: 0.394 Vali Loss: 7.311 Vali Acc: 0.131 Test Loss: 7.311 Test Acc: 0.131
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13868177751267521
model parameter : 800715
model size : 4.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.2208920
	speed: 0.0950s/iter; left time: 1966.1193s
	iters: 200, epoch: 1 | loss: 4.3026538
	speed: 0.0718s/iter; left time: 1479.6532s
Epoch: 1 cost time: 17.358402490615845
Epoch: 1, Steps: 208 | Train Loss: 3.889 Vali Loss: 4.030 Vali Acc: 0.058 Test Loss: 4.030 Test Acc: 0.058
Validation loss decreased (inf --> -0.057818).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.3068662
	speed: 0.2314s/iter; left time: 4742.8177s
	iters: 200, epoch: 2 | loss: 3.5289650
	speed: 0.0715s/iter; left time: 1459.0912s
Epoch: 2 cost time: 16.088463306427002
Epoch: 2, Steps: 208 | Train Loss: 3.907 Vali Loss: 3.734 Vali Acc: 0.052 Test Loss: 3.734 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.8054042
	speed: 0.2325s/iter; left time: 4717.0105s
	iters: 200, epoch: 3 | loss: 3.5780015
	speed: 0.0750s/iter; left time: 1513.6297s
Epoch: 3 cost time: 16.340731143951416
Epoch: 3, Steps: 208 | Train Loss: 3.589 Vali Loss: 3.655 Vali Acc: 0.053 Test Loss: 3.655 Test Acc: 0.053
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 3.4063323
	speed: 0.2249s/iter; left time: 4514.4716s
	iters: 200, epoch: 4 | loss: 3.5644469
	speed: 0.0754s/iter; left time: 1507.2212s
Epoch: 4 cost time: 16.607536554336548
Epoch: 4, Steps: 208 | Train Loss: 3.466 Vali Loss: 3.575 Vali Acc: 0.061 Test Loss: 3.575 Test Acc: 0.061
Validation loss decreased (-0.057818 --> -0.060507).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.0565515
	speed: 0.2264s/iter; left time: 4498.3863s
	iters: 200, epoch: 5 | loss: 3.2810221
	speed: 0.0821s/iter; left time: 1622.1218s
Epoch: 5 cost time: 17.70671582221985
Epoch: 5, Steps: 208 | Train Loss: 3.304 Vali Loss: 3.654 Vali Acc: 0.065 Test Loss: 3.654 Test Acc: 0.065
Validation loss decreased (-0.060507 --> -0.064682).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0738759
	speed: 0.2555s/iter; left time: 5023.2956s
	iters: 200, epoch: 6 | loss: 3.1631978
	speed: 0.0863s/iter; left time: 1688.5391s
Epoch: 6 cost time: 18.458292722702026
Epoch: 6, Steps: 208 | Train Loss: 3.117 Vali Loss: 3.292 Vali Acc: 0.106 Test Loss: 3.292 Test Acc: 0.106
Validation loss decreased (-0.064682 --> -0.106439).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.7949021
	speed: 0.2430s/iter; left time: 4726.9105s
	iters: 200, epoch: 7 | loss: 3.3562469
	speed: 0.0834s/iter; left time: 1613.6812s
Epoch: 7 cost time: 17.088501930236816
Epoch: 7, Steps: 208 | Train Loss: 2.881 Vali Loss: 3.292 Vali Acc: 0.094 Test Loss: 3.292 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 3.3704784
	speed: 0.2467s/iter; left time: 4747.8716s
	iters: 200, epoch: 8 | loss: 2.8162744
	speed: 0.0908s/iter; left time: 1738.5211s
Epoch: 8 cost time: 18.04586386680603
Epoch: 8, Steps: 208 | Train Loss: 2.659 Vali Loss: 3.212 Vali Acc: 0.108 Test Loss: 3.212 Test Acc: 0.108
Validation loss decreased (-0.106439 --> -0.107931).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.3323336
	speed: 0.2354s/iter; left time: 4481.3634s
	iters: 200, epoch: 9 | loss: 2.9504831
	speed: 0.0805s/iter; left time: 1524.9670s
Epoch: 9 cost time: 16.532325744628906
Epoch: 9, Steps: 208 | Train Loss: 2.330 Vali Loss: 3.407 Vali Acc: 0.120 Test Loss: 3.407 Test Acc: 0.120
Validation loss decreased (-0.107931 --> -0.120157).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.3988066
	speed: 0.2140s/iter; left time: 4028.6815s
	iters: 200, epoch: 10 | loss: 1.8042802
	speed: 0.0759s/iter; left time: 1421.9806s
Epoch: 10 cost time: 15.74606704711914
Epoch: 10, Steps: 208 | Train Loss: 1.979 Vali Loss: 3.638 Vali Acc: 0.128 Test Loss: 3.638 Test Acc: 0.128
Validation loss decreased (-0.120157 --> -0.127909).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.0863073
	speed: 0.2301s/iter; left time: 4284.7486s
	iters: 200, epoch: 11 | loss: 2.4102314
	speed: 0.0745s/iter; left time: 1379.3742s
Epoch: 11 cost time: 15.496214866638184
Epoch: 11, Steps: 208 | Train Loss: 1.622 Vali Loss: 4.134 Vali Acc: 0.121 Test Loss: 4.134 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.8466517
	speed: 0.2315s/iter; left time: 4262.8524s
	iters: 200, epoch: 12 | loss: 1.2222192
	speed: 0.0775s/iter; left time: 1419.9445s
Epoch: 12 cost time: 16.614270448684692
Epoch: 12, Steps: 208 | Train Loss: 1.285 Vali Loss: 4.672 Vali Acc: 0.120 Test Loss: 4.672 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.1284798
	speed: 0.2257s/iter; left time: 4109.3796s
	iters: 200, epoch: 13 | loss: 0.7763907
	speed: 0.0722s/iter; left time: 1307.1782s
Epoch: 13 cost time: 15.795798540115356
Epoch: 13, Steps: 208 | Train Loss: 1.005 Vali Loss: 4.993 Vali Acc: 0.119 Test Loss: 4.993 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.7095482
	speed: 0.2198s/iter; left time: 3956.5330s
	iters: 200, epoch: 14 | loss: 0.9623317
	speed: 0.0738s/iter; left time: 1321.1789s
Epoch: 14 cost time: 16.358831644058228
Epoch: 14, Steps: 208 | Train Loss: 0.861 Vali Loss: 5.313 Vali Acc: 0.126 Test Loss: 5.313 Test Acc: 0.126
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.8319546
	speed: 0.2354s/iter; left time: 4186.7785s
	iters: 200, epoch: 15 | loss: 0.8739702
	speed: 0.0730s/iter; left time: 1291.1492s
Epoch: 15 cost time: 16.363459587097168
Epoch: 15, Steps: 208 | Train Loss: 0.735 Vali Loss: 5.921 Vali Acc: 0.115 Test Loss: 5.921 Test Acc: 0.115
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.9220325
	speed: 0.2029s/iter; left time: 3566.5115s
	iters: 200, epoch: 16 | loss: 0.4292584
	speed: 0.0461s/iter; left time: 805.1962s
Epoch: 16 cost time: 11.58546781539917
Epoch: 16, Steps: 208 | Train Loss: 0.615 Vali Loss: 5.944 Vali Acc: 0.123 Test Loss: 5.944 Test Acc: 0.123
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.5267681
	speed: 0.1523s/iter; left time: 2646.2393s
	iters: 200, epoch: 17 | loss: 0.8162712
	speed: 0.0465s/iter; left time: 803.4574s
Epoch: 17 cost time: 10.25393009185791
Epoch: 17, Steps: 208 | Train Loss: 0.599 Vali Loss: 6.632 Vali Acc: 0.122 Test Loss: 6.632 Test Acc: 0.122
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.2626288
	speed: 0.2073s/iter; left time: 3558.7288s
	iters: 200, epoch: 18 | loss: 0.3177414
	speed: 0.0724s/iter; left time: 1235.9518s
Epoch: 18 cost time: 15.450034856796265
Epoch: 18, Steps: 208 | Train Loss: 0.522 Vali Loss: 6.744 Vali Acc: 0.121 Test Loss: 6.744 Test Acc: 0.121
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.2079754
	speed: 0.2350s/iter; left time: 3984.3262s
	iters: 200, epoch: 19 | loss: 0.2446258
	speed: 0.0770s/iter; left time: 1297.6170s
Epoch: 19 cost time: 16.370081424713135
Epoch: 19, Steps: 208 | Train Loss: 0.501 Vali Loss: 6.779 Vali Acc: 0.119 Test Loss: 6.779 Test Acc: 0.119
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.2979029
	speed: 0.2417s/iter; left time: 4048.9630s
	iters: 200, epoch: 20 | loss: 0.4371476
	speed: 0.0816s/iter; left time: 1359.0375s
Epoch: 20 cost time: 17.808836221694946
Epoch: 20, Steps: 208 | Train Loss: 0.497 Vali Loss: 6.588 Vali Acc: 0.106 Test Loss: 6.588 Test Acc: 0.106
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12794512376975842
model parameter : 798859
model size : 4.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.2236891
	speed: 0.0927s/iter; left time: 1917.9842s
	iters: 200, epoch: 1 | loss: 4.5177574
	speed: 0.0841s/iter; left time: 1732.6896s
Epoch: 1 cost time: 18.49744987487793
Epoch: 1, Steps: 208 | Train Loss: 3.890 Vali Loss: 3.855 Vali Acc: 0.054 Test Loss: 3.855 Test Acc: 0.054
Validation loss decreased (inf --> -0.054241).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8590448
	speed: 0.2378s/iter; left time: 4873.0366s
	iters: 200, epoch: 2 | loss: 3.8506830
	speed: 0.0759s/iter; left time: 1547.0731s
Epoch: 2 cost time: 15.802420616149902
Epoch: 2, Steps: 208 | Train Loss: 3.782 Vali Loss: 3.652 Vali Acc: 0.060 Test Loss: 3.652 Test Acc: 0.060
Validation loss decreased (-0.054241 --> -0.059910).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5233917
	speed: 0.2123s/iter; left time: 4306.0104s
	iters: 200, epoch: 3 | loss: 3.9094412
	speed: 0.0601s/iter; left time: 1213.5304s
Epoch: 3 cost time: 13.523474931716919
Epoch: 3, Steps: 208 | Train Loss: 3.585 Vali Loss: 3.588 Vali Acc: 0.064 Test Loss: 3.588 Test Acc: 0.064
Validation loss decreased (-0.059910 --> -0.063489).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.6605172
	speed: 0.2281s/iter; left time: 4578.6745s
	iters: 200, epoch: 4 | loss: 3.4784396
	speed: 0.0747s/iter; left time: 1493.1285s
Epoch: 4 cost time: 16.16702914237976
Epoch: 4, Steps: 208 | Train Loss: 3.491 Vali Loss: 3.621 Vali Acc: 0.070 Test Loss: 3.621 Test Acc: 0.070
Validation loss decreased (-0.063489 --> -0.070050).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2859626
	speed: 0.2116s/iter; left time: 4204.5074s
	iters: 200, epoch: 5 | loss: 3.3123429
	speed: 0.0705s/iter; left time: 1394.7000s
Epoch: 5 cost time: 15.251248836517334
Epoch: 5, Steps: 208 | Train Loss: 3.322 Vali Loss: 3.394 Vali Acc: 0.081 Test Loss: 3.394 Test Acc: 0.081
Validation loss decreased (-0.070050 --> -0.081087).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.7047856
	speed: 0.2283s/iter; left time: 4487.9009s
	iters: 200, epoch: 6 | loss: 3.1794336
	speed: 0.0735s/iter; left time: 1437.7372s
Epoch: 6 cost time: 16.03024458885193
Epoch: 6, Steps: 208 | Train Loss: 3.128 Vali Loss: 3.374 Vali Acc: 0.089 Test Loss: 3.374 Test Acc: 0.089
Validation loss decreased (-0.081087 --> -0.088842).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.0577762
	speed: 0.2291s/iter; left time: 4457.4514s
	iters: 200, epoch: 7 | loss: 2.9090488
	speed: 0.0719s/iter; left time: 1391.9859s
Epoch: 7 cost time: 16.028972387313843
Epoch: 7, Steps: 208 | Train Loss: 2.954 Vali Loss: 3.204 Vali Acc: 0.099 Test Loss: 3.204 Test Acc: 0.099
Validation loss decreased (-0.088842 --> -0.098686).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.5797997
	speed: 0.2386s/iter; left time: 4592.2022s
	iters: 200, epoch: 8 | loss: 2.9808202
	speed: 0.0695s/iter; left time: 1330.9506s
Epoch: 8 cost time: 16.41358733177185
Epoch: 8, Steps: 208 | Train Loss: 2.699 Vali Loss: 3.275 Vali Acc: 0.111 Test Loss: 3.275 Test Acc: 0.111
Validation loss decreased (-0.098686 --> -0.110614).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.3932486
	speed: 0.2343s/iter; left time: 4460.6533s
	iters: 200, epoch: 9 | loss: 2.3684962
	speed: 0.0684s/iter; left time: 1295.9463s
Epoch: 9 cost time: 15.910290718078613
Epoch: 9, Steps: 208 | Train Loss: 2.409 Vali Loss: 3.434 Vali Acc: 0.122 Test Loss: 3.434 Test Acc: 0.122
Validation loss decreased (-0.110614 --> -0.121648).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.4505262
	speed: 0.2488s/iter; left time: 4685.2747s
	iters: 200, epoch: 10 | loss: 2.7871270
	speed: 0.0758s/iter; left time: 1419.0385s
Epoch: 10 cost time: 16.444727897644043
Epoch: 10, Steps: 208 | Train Loss: 2.077 Vali Loss: 3.584 Vali Acc: 0.122 Test Loss: 3.584 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.1867409
	speed: 0.2111s/iter; left time: 3931.3334s
	iters: 200, epoch: 11 | loss: 2.3297567
	speed: 0.0771s/iter; left time: 1427.4957s
Epoch: 11 cost time: 16.318299055099487
Epoch: 11, Steps: 208 | Train Loss: 1.703 Vali Loss: 3.872 Vali Acc: 0.118 Test Loss: 3.872 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.6928298
	speed: 0.2214s/iter; left time: 4076.6724s
	iters: 200, epoch: 12 | loss: 2.1944132
	speed: 0.0792s/iter; left time: 1450.1734s
Epoch: 12 cost time: 17.058157920837402
Epoch: 12, Steps: 208 | Train Loss: 1.336 Vali Loss: 4.408 Vali Acc: 0.123 Test Loss: 4.408 Test Acc: 0.123
Validation loss decreased (-0.121648 --> -0.122831).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.7158141
	speed: 0.2390s/iter; left time: 4351.0482s
	iters: 200, epoch: 13 | loss: 0.8175470
	speed: 0.0878s/iter; left time: 1589.5855s
Epoch: 13 cost time: 18.65546703338623
Epoch: 13, Steps: 208 | Train Loss: 1.043 Vali Loss: 5.075 Vali Acc: 0.128 Test Loss: 5.075 Test Acc: 0.128
Validation loss decreased (-0.122831 --> -0.127894).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.8781702
	speed: 0.2432s/iter; left time: 4376.3405s
	iters: 200, epoch: 14 | loss: 0.6240224
	speed: 0.0840s/iter; left time: 1503.1332s
Epoch: 14 cost time: 18.177359580993652
Epoch: 14, Steps: 208 | Train Loss: 0.861 Vali Loss: 5.144 Vali Acc: 0.123 Test Loss: 5.144 Test Acc: 0.123
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.6621681
	speed: 0.2487s/iter; left time: 4424.5022s
	iters: 200, epoch: 15 | loss: 0.6262941
	speed: 0.0922s/iter; left time: 1631.0867s
Epoch: 15 cost time: 19.44564938545227
Epoch: 15, Steps: 208 | Train Loss: 0.748 Vali Loss: 5.549 Vali Acc: 0.124 Test Loss: 5.549 Test Acc: 0.124
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.1964548
	speed: 0.2300s/iter; left time: 4044.3795s
	iters: 200, epoch: 16 | loss: 0.4104762
	speed: 0.0882s/iter; left time: 1542.4048s
Epoch: 16 cost time: 17.667167901992798
Epoch: 16, Steps: 208 | Train Loss: 0.612 Vali Loss: 6.075 Vali Acc: 0.120 Test Loss: 6.075 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.0665284
	speed: 0.2318s/iter; left time: 4027.5201s
	iters: 200, epoch: 17 | loss: 0.4383506
	speed: 0.0794s/iter; left time: 1372.1909s
Epoch: 17 cost time: 16.439650774002075
Epoch: 17, Steps: 208 | Train Loss: 0.580 Vali Loss: 6.343 Vali Acc: 0.123 Test Loss: 6.343 Test Acc: 0.123
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.3561525
	speed: 0.2387s/iter; left time: 4096.9144s
	iters: 200, epoch: 18 | loss: 0.9176594
	speed: 0.0830s/iter; left time: 1416.2771s
Epoch: 18 cost time: 16.67904305458069
Epoch: 18, Steps: 208 | Train Loss: 0.542 Vali Loss: 6.596 Vali Acc: 0.130 Test Loss: 6.596 Test Acc: 0.130
Validation loss decreased (-0.127894 --> -0.129967).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.8812644
	speed: 0.2155s/iter; left time: 3654.4778s
	iters: 200, epoch: 19 | loss: 0.3997509
	speed: 0.0777s/iter; left time: 1309.4587s
Epoch: 19 cost time: 15.742160081863403
Epoch: 19, Steps: 208 | Train Loss: 0.507 Vali Loss: 6.922 Vali Acc: 0.121 Test Loss: 6.922 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.5511182
	speed: 0.2165s/iter; left time: 3625.6802s
	iters: 200, epoch: 20 | loss: 0.4240880
	speed: 0.0709s/iter; left time: 1180.3422s
Epoch: 20 cost time: 15.541434526443481
Epoch: 20, Steps: 208 | Train Loss: 0.470 Vali Loss: 7.142 Vali Acc: 0.122 Test Loss: 7.142 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.4443314
	speed: 0.2186s/iter; left time: 3616.1052s
	iters: 200, epoch: 21 | loss: 0.1881208
	speed: 0.0730s/iter; left time: 1200.7005s
Epoch: 21 cost time: 15.012079238891602
Epoch: 21, Steps: 208 | Train Loss: 0.454 Vali Loss: 6.817 Vali Acc: 0.117 Test Loss: 6.817 Test Acc: 0.117
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0470026
	speed: 0.2298s/iter; left time: 3753.0937s
	iters: 200, epoch: 22 | loss: 0.3199577
	speed: 0.0707s/iter; left time: 1147.8798s
Epoch: 22 cost time: 16.129420518875122
Epoch: 22, Steps: 208 | Train Loss: 0.401 Vali Loss: 6.907 Vali Acc: 0.120 Test Loss: 6.907 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0721598
	speed: 0.2493s/iter; left time: 4019.4443s
	iters: 200, epoch: 23 | loss: 0.4800243
	speed: 0.0657s/iter; left time: 1053.2267s
Epoch: 23 cost time: 15.617258787155151
Epoch: 23, Steps: 208 | Train Loss: 0.402 Vali Loss: 7.095 Vali Acc: 0.118 Test Loss: 7.095 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.4348351
	speed: 0.2268s/iter; left time: 3609.4812s
	iters: 200, epoch: 24 | loss: 1.0028322
	speed: 0.0716s/iter; left time: 1132.3064s
Epoch: 24 cost time: 15.400601863861084
Epoch: 24, Steps: 208 | Train Loss: 0.391 Vali Loss: 6.949 Vali Acc: 0.117 Test Loss: 6.949 Test Acc: 0.117
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.2598567
	speed: 0.2272s/iter; left time: 3568.9926s
	iters: 200, epoch: 25 | loss: 0.1891856
	speed: 0.0724s/iter; left time: 1130.6666s
Epoch: 25 cost time: 16.087650299072266
Epoch: 25, Steps: 208 | Train Loss: 0.367 Vali Loss: 7.720 Vali Acc: 0.127 Test Loss: 7.720 Test Acc: 0.127
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.4237151
	speed: 0.2341s/iter; left time: 3628.5216s
	iters: 200, epoch: 26 | loss: 0.5659592
	speed: 0.0747s/iter; left time: 1150.0740s
Epoch: 26 cost time: 16.321805953979492
Epoch: 26, Steps: 208 | Train Loss: 0.363 Vali Loss: 7.818 Vali Acc: 0.116 Test Loss: 7.818 Test Acc: 0.116
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.1402880
	speed: 0.2220s/iter; left time: 3395.5159s
	iters: 200, epoch: 27 | loss: 0.5026676
	speed: 0.0697s/iter; left time: 1058.7842s
Epoch: 27 cost time: 16.428056240081787
Epoch: 27, Steps: 208 | Train Loss: 0.362 Vali Loss: 7.623 Vali Acc: 0.118 Test Loss: 7.623 Test Acc: 0.118
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.4077592
	speed: 0.2423s/iter; left time: 3655.5491s
	iters: 200, epoch: 28 | loss: 0.1944970
	speed: 0.0726s/iter; left time: 1087.2918s
Epoch: 28 cost time: 16.636413097381592
Epoch: 28, Steps: 208 | Train Loss: 0.326 Vali Loss: 7.701 Vali Acc: 0.114 Test Loss: 7.701 Test Acc: 0.114
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.13003280644199225
model parameter : 797003
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.4730823
	speed: 0.0986s/iter; left time: 2040.0871s
	iters: 200, epoch: 1 | loss: 4.0050945
	speed: 0.0889s/iter; left time: 1830.4360s
Epoch: 1 cost time: 19.57745361328125
Epoch: 1, Steps: 208 | Train Loss: 3.936 Vali Loss: 4.029 Vali Acc: 0.048 Test Loss: 4.029 Test Acc: 0.048
Validation loss decreased (inf --> -0.047976).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7418079
	speed: 0.2338s/iter; left time: 4790.3599s
	iters: 200, epoch: 2 | loss: 3.7633038
	speed: 0.0706s/iter; left time: 1438.7899s
Epoch: 2 cost time: 15.157996416091919
Epoch: 2, Steps: 208 | Train Loss: 3.987 Vali Loss: 3.853 Vali Acc: 0.052 Test Loss: 3.853 Test Acc: 0.052
Validation loss decreased (-0.047976 --> -0.051855).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3333452
	speed: 0.1920s/iter; left time: 3894.5247s
	iters: 200, epoch: 3 | loss: 3.9869163
	speed: 0.0500s/iter; left time: 1010.1566s
Epoch: 3 cost time: 11.26927661895752
Epoch: 3, Steps: 208 | Train Loss: 3.723 Vali Loss: 3.793 Vali Acc: 0.054 Test Loss: 3.793 Test Acc: 0.054
Validation loss decreased (-0.051855 --> -0.053944).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3576066
	speed: 0.2275s/iter; left time: 4568.3151s
	iters: 200, epoch: 4 | loss: 3.2471561
	speed: 0.0614s/iter; left time: 1227.5319s
Epoch: 4 cost time: 13.831048011779785
Epoch: 4, Steps: 208 | Train Loss: 3.501 Vali Loss: 3.648 Vali Acc: 0.075 Test Loss: 3.648 Test Acc: 0.075
Validation loss decreased (-0.053944 --> -0.074524).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3975029
	speed: 0.2306s/iter; left time: 4582.3396s
	iters: 200, epoch: 5 | loss: 3.1554625
	speed: 0.0709s/iter; left time: 1402.3353s
Epoch: 5 cost time: 15.422072172164917
Epoch: 5, Steps: 208 | Train Loss: 3.250 Vali Loss: 3.527 Vali Acc: 0.081 Test Loss: 3.527 Test Acc: 0.081
Validation loss decreased (-0.074524 --> -0.081086).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.9023397
	speed: 0.2282s/iter; left time: 4487.3836s
	iters: 200, epoch: 6 | loss: 3.0137160
	speed: 0.0716s/iter; left time: 1401.5166s
Epoch: 6 cost time: 15.591655015945435
Epoch: 6, Steps: 208 | Train Loss: 3.026 Vali Loss: 3.478 Vali Acc: 0.086 Test Loss: 3.478 Test Acc: 0.086
Validation loss decreased (-0.081086 --> -0.085560).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.0926952
	speed: 0.2490s/iter; left time: 4844.2328s
	iters: 200, epoch: 7 | loss: 3.3159199
	speed: 0.0695s/iter; left time: 1344.7777s
Epoch: 7 cost time: 15.876980304718018
Epoch: 7, Steps: 208 | Train Loss: 2.793 Vali Loss: 3.408 Vali Acc: 0.108 Test Loss: 3.408 Test Acc: 0.108
Validation loss decreased (-0.085560 --> -0.108227).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.7440956
	speed: 0.2380s/iter; left time: 4581.1166s
	iters: 200, epoch: 8 | loss: 2.7322440
	speed: 0.0681s/iter; left time: 1304.5716s
Epoch: 8 cost time: 14.933578729629517
Epoch: 8, Steps: 208 | Train Loss: 2.507 Vali Loss: 3.438 Vali Acc: 0.120 Test Loss: 3.438 Test Acc: 0.120
Validation loss decreased (-0.108227 --> -0.120455).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.9795899
	speed: 0.2373s/iter; left time: 4517.4635s
	iters: 200, epoch: 9 | loss: 2.6146321
	speed: 0.0710s/iter; left time: 1343.6063s
Epoch: 9 cost time: 16.077386617660522
Epoch: 9, Steps: 208 | Train Loss: 2.136 Vali Loss: 3.786 Vali Acc: 0.111 Test Loss: 3.786 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.2870810
	speed: 0.2456s/iter; left time: 4624.7572s
	iters: 200, epoch: 10 | loss: 2.2877810
	speed: 0.0760s/iter; left time: 1424.1509s
Epoch: 10 cost time: 16.036900281906128
Epoch: 10, Steps: 208 | Train Loss: 1.765 Vali Loss: 3.863 Vali Acc: 0.122 Test Loss: 3.863 Test Acc: 0.122
Validation loss decreased (-0.120455 --> -0.122240).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.2188835
	speed: 0.2439s/iter; left time: 4542.4207s
	iters: 200, epoch: 11 | loss: 1.4785796
	speed: 0.0700s/iter; left time: 1296.2299s
Epoch: 11 cost time: 15.46544075012207
Epoch: 11, Steps: 208 | Train Loss: 1.383 Vali Loss: 4.433 Vali Acc: 0.113 Test Loss: 4.433 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.0378226
	speed: 0.2289s/iter; left time: 4214.3014s
	iters: 200, epoch: 12 | loss: 1.3221728
	speed: 0.0673s/iter; left time: 1231.6180s
Epoch: 12 cost time: 16.075408935546875
Epoch: 12, Steps: 208 | Train Loss: 1.060 Vali Loss: 4.933 Vali Acc: 0.117 Test Loss: 4.933 Test Acc: 0.117
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.8961223
	speed: 0.2244s/iter; left time: 4084.7741s
	iters: 200, epoch: 13 | loss: 0.8378870
	speed: 0.0795s/iter; left time: 1438.4557s
Epoch: 13 cost time: 16.458089590072632
Epoch: 13, Steps: 208 | Train Loss: 0.825 Vali Loss: 5.195 Vali Acc: 0.109 Test Loss: 5.195 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.8445413
	speed: 0.2321s/iter; left time: 4177.8435s
	iters: 200, epoch: 14 | loss: 1.0052913
	speed: 0.0750s/iter; left time: 1341.4667s
Epoch: 14 cost time: 16.63823914527893
Epoch: 14, Steps: 208 | Train Loss: 0.690 Vali Loss: 5.560 Vali Acc: 0.118 Test Loss: 5.560 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.4102526
	speed: 0.2411s/iter; left time: 4289.0536s
	iters: 200, epoch: 15 | loss: 0.6276268
	speed: 0.0771s/iter; left time: 1363.9381s
Epoch: 15 cost time: 17.346462726593018
Epoch: 15, Steps: 208 | Train Loss: 0.601 Vali Loss: 5.707 Vali Acc: 0.114 Test Loss: 5.707 Test Acc: 0.114
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.8458940
	speed: 0.2432s/iter; left time: 4276.0530s
	iters: 200, epoch: 16 | loss: 1.1219608
	speed: 0.0840s/iter; left time: 1467.6594s
Epoch: 16 cost time: 17.531697034835815
Epoch: 16, Steps: 208 | Train Loss: 0.537 Vali Loss: 6.197 Vali Acc: 0.115 Test Loss: 6.197 Test Acc: 0.115
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.3421648
	speed: 0.2364s/iter; left time: 4106.1093s
	iters: 200, epoch: 17 | loss: 0.4038830
	speed: 0.0781s/iter; left time: 1348.6523s
Epoch: 17 cost time: 16.91752791404724
Epoch: 17, Steps: 208 | Train Loss: 0.474 Vali Loss: 6.483 Vali Acc: 0.109 Test Loss: 6.483 Test Acc: 0.109
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.1242240
	speed: 0.2238s/iter; left time: 3841.3526s
	iters: 200, epoch: 18 | loss: 0.3831483
	speed: 0.0777s/iter; left time: 1325.6460s
Epoch: 18 cost time: 16.4068386554718
Epoch: 18, Steps: 208 | Train Loss: 0.434 Vali Loss: 6.462 Vali Acc: 0.106 Test Loss: 6.462 Test Acc: 0.106
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.9726468
	speed: 0.2232s/iter; left time: 3785.5765s
	iters: 200, epoch: 19 | loss: 0.3427915
	speed: 0.0812s/iter; left time: 1369.2132s
Epoch: 19 cost time: 16.882193326950073
Epoch: 19, Steps: 208 | Train Loss: 0.424 Vali Loss: 6.713 Vali Acc: 0.108 Test Loss: 6.713 Test Acc: 0.108
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.4793501
	speed: 0.2141s/iter; left time: 3586.1486s
	iters: 200, epoch: 20 | loss: 0.3792452
	speed: 0.0787s/iter; left time: 1310.7647s
Epoch: 20 cost time: 16.144023418426514
Epoch: 20, Steps: 208 | Train Loss: 0.383 Vali Loss: 7.043 Vali Acc: 0.107 Test Loss: 7.043 Test Acc: 0.107
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12227855651655234
model parameter : 795147
model size : 4.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9589489
	speed: 0.0860s/iter; left time: 1779.9095s
	iters: 200, epoch: 1 | loss: 4.2041306
	speed: 0.0694s/iter; left time: 1429.9213s
Epoch: 1 cost time: 16.209803581237793
Epoch: 1, Steps: 208 | Train Loss: 3.946 Vali Loss: 4.124 Vali Acc: 0.056 Test Loss: 4.124 Test Acc: 0.056
Validation loss decreased (inf --> -0.056326).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7939150
	speed: 0.2281s/iter; left time: 4674.8022s
	iters: 200, epoch: 2 | loss: 4.0675178
	speed: 0.0643s/iter; left time: 1311.6307s
Epoch: 2 cost time: 14.776868343353271
Epoch: 2, Steps: 208 | Train Loss: 3.940 Vali Loss: 3.779 Vali Acc: 0.059 Test Loss: 3.779 Test Acc: 0.059
Validation loss decreased (-0.056326 --> -0.059312).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7913694
	speed: 0.1740s/iter; left time: 3529.5083s
	iters: 200, epoch: 3 | loss: 3.9323802
	speed: 0.0444s/iter; left time: 896.3197s
Epoch: 3 cost time: 9.966064929962158
Epoch: 3, Steps: 208 | Train Loss: 3.647 Vali Loss: 3.706 Vali Acc: 0.056 Test Loss: 3.706 Test Acc: 0.056
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.0938432
	speed: 0.2095s/iter; left time: 4205.7272s
	iters: 200, epoch: 4 | loss: 3.3861480
	speed: 0.0798s/iter; left time: 1594.1274s
Epoch: 4 cost time: 16.758649349212646
Epoch: 4, Steps: 208 | Train Loss: 3.493 Vali Loss: 3.734 Vali Acc: 0.061 Test Loss: 3.734 Test Acc: 0.061
Validation loss decreased (-0.059312 --> -0.060804).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.0980217
	speed: 0.2327s/iter; left time: 4624.2800s
	iters: 200, epoch: 5 | loss: 3.5740395
	speed: 0.0813s/iter; left time: 1607.5193s
Epoch: 5 cost time: 17.118992805480957
Epoch: 5, Steps: 208 | Train Loss: 3.302 Vali Loss: 3.508 Vali Acc: 0.082 Test Loss: 3.508 Test Acc: 0.082
Validation loss decreased (-0.060804 --> -0.081981).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.7842722
	speed: 0.2431s/iter; left time: 4778.8581s
	iters: 200, epoch: 6 | loss: 3.1681225
	speed: 0.0881s/iter; left time: 1723.3034s
Epoch: 6 cost time: 18.640748739242554
Epoch: 6, Steps: 208 | Train Loss: 3.094 Vali Loss: 3.552 Vali Acc: 0.075 Test Loss: 3.552 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.8565509
	speed: 0.2485s/iter; left time: 4833.9021s
	iters: 200, epoch: 7 | loss: 2.7110474
	speed: 0.0843s/iter; left time: 1631.0730s
Epoch: 7 cost time: 18.208534240722656
Epoch: 7, Steps: 208 | Train Loss: 2.908 Vali Loss: 3.374 Vali Acc: 0.100 Test Loss: 3.374 Test Acc: 0.100
Validation loss decreased (-0.081981 --> -0.099877).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.3327208
	speed: 0.2506s/iter; left time: 4823.7520s
	iters: 200, epoch: 8 | loss: 2.5612428
	speed: 0.0812s/iter; left time: 1555.4927s
Epoch: 8 cost time: 17.915456295013428
Epoch: 8, Steps: 208 | Train Loss: 2.631 Vali Loss: 3.538 Vali Acc: 0.108 Test Loss: 3.538 Test Acc: 0.108
Validation loss decreased (-0.099877 --> -0.108226).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.0434229
	speed: 0.2454s/iter; left time: 4670.7505s
	iters: 200, epoch: 9 | loss: 2.2128942
	speed: 0.0851s/iter; left time: 1611.9818s
Epoch: 9 cost time: 18.167057991027832
Epoch: 9, Steps: 208 | Train Loss: 2.289 Vali Loss: 3.638 Vali Acc: 0.101 Test Loss: 3.638 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.0831485
	speed: 0.2283s/iter; left time: 4298.1954s
	iters: 200, epoch: 10 | loss: 2.3001988
	speed: 0.0785s/iter; left time: 1471.1333s
Epoch: 10 cost time: 16.543412923812866
Epoch: 10, Steps: 208 | Train Loss: 1.941 Vali Loss: 4.113 Vali Acc: 0.109 Test Loss: 4.113 Test Acc: 0.109
Validation loss decreased (-0.108226 --> -0.109413).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.0480325
	speed: 0.2341s/iter; left time: 4359.3849s
	iters: 200, epoch: 11 | loss: 1.9078407
	speed: 0.0698s/iter; left time: 1291.9790s
Epoch: 11 cost time: 15.441772222518921
Epoch: 11, Steps: 208 | Train Loss: 1.550 Vali Loss: 4.126 Vali Acc: 0.109 Test Loss: 4.126 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.9578699
	speed: 0.2246s/iter; left time: 4135.0848s
	iters: 200, epoch: 12 | loss: 1.2837377
	speed: 0.0966s/iter; left time: 1768.8897s
Epoch: 12 cost time: 19.673956632614136
Epoch: 12, Steps: 208 | Train Loss: 1.218 Vali Loss: 4.652 Vali Acc: 0.112 Test Loss: 4.652 Test Acc: 0.112
Validation loss decreased (-0.109413 --> -0.112092).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.2467816
	speed: 0.2484s/iter; left time: 4522.7864s
	iters: 200, epoch: 13 | loss: 1.4522046
	speed: 0.0895s/iter; left time: 1620.0987s
Epoch: 13 cost time: 18.061021089553833
Epoch: 13, Steps: 208 | Train Loss: 0.981 Vali Loss: 5.011 Vali Acc: 0.113 Test Loss: 5.011 Test Acc: 0.113
Validation loss decreased (-0.112092 --> -0.112685).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.9411470
	speed: 0.2502s/iter; left time: 4503.4139s
	iters: 200, epoch: 14 | loss: 0.8459812
	speed: 0.0880s/iter; left time: 1574.6359s
Epoch: 14 cost time: 19.343973636627197
Epoch: 14, Steps: 208 | Train Loss: 0.827 Vali Loss: 5.421 Vali Acc: 0.112 Test Loss: 5.421 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.0436047
	speed: 0.2438s/iter; left time: 4336.7492s
	iters: 200, epoch: 15 | loss: 0.6209394
	speed: 0.0750s/iter; left time: 1326.1408s
Epoch: 15 cost time: 16.925911903381348
Epoch: 15, Steps: 208 | Train Loss: 0.703 Vali Loss: 5.712 Vali Acc: 0.118 Test Loss: 5.712 Test Acc: 0.118
Validation loss decreased (-0.112685 --> -0.117748).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.9138685
	speed: 0.2498s/iter; left time: 4392.3526s
	iters: 200, epoch: 16 | loss: 0.6087360
	speed: 0.0927s/iter; left time: 1621.1481s
Epoch: 16 cost time: 19.53203272819519
Epoch: 16, Steps: 208 | Train Loss: 0.626 Vali Loss: 6.204 Vali Acc: 0.122 Test Loss: 6.204 Test Acc: 0.122
Validation loss decreased (-0.117748 --> -0.121620).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.8162999
	speed: 0.2409s/iter; left time: 4185.9361s
	iters: 200, epoch: 17 | loss: 0.8205314
	speed: 0.0898s/iter; left time: 1551.2283s
Epoch: 17 cost time: 18.86689805984497
Epoch: 17, Steps: 208 | Train Loss: 0.565 Vali Loss: 6.229 Vali Acc: 0.108 Test Loss: 6.229 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.4197161
	speed: 0.2482s/iter; left time: 4260.7467s
	iters: 200, epoch: 18 | loss: 0.6263658
	speed: 0.0943s/iter; left time: 1609.8826s
Epoch: 18 cost time: 19.978222131729126
Epoch: 18, Steps: 208 | Train Loss: 0.525 Vali Loss: 6.757 Vali Acc: 0.112 Test Loss: 6.757 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0785377
	speed: 0.2423s/iter; left time: 4108.2053s
	iters: 200, epoch: 19 | loss: 0.0953847
	speed: 0.0881s/iter; left time: 1485.7240s
Epoch: 19 cost time: 18.892791032791138
Epoch: 19, Steps: 208 | Train Loss: 0.479 Vali Loss: 6.871 Vali Acc: 0.123 Test Loss: 6.871 Test Acc: 0.123
Validation loss decreased (-0.121620 --> -0.123105).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.2965378
	speed: 0.2405s/iter; left time: 4028.4127s
	iters: 200, epoch: 20 | loss: 0.5452758
	speed: 0.0847s/iter; left time: 1410.6288s
Epoch: 20 cost time: 18.5927152633667
Epoch: 20, Steps: 208 | Train Loss: 0.453 Vali Loss: 6.943 Vali Acc: 0.116 Test Loss: 6.943 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.7570248
	speed: 0.2427s/iter; left time: 4014.6119s
	iters: 200, epoch: 21 | loss: 0.5233653
	speed: 0.0884s/iter; left time: 1454.1437s
Epoch: 21 cost time: 18.678879261016846
Epoch: 21, Steps: 208 | Train Loss: 0.417 Vali Loss: 6.951 Vali Acc: 0.119 Test Loss: 6.951 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.1061037
	speed: 0.2740s/iter; left time: 4475.3334s
	iters: 200, epoch: 22 | loss: 0.2806553
	speed: 0.0973s/iter; left time: 1579.4359s
Epoch: 22 cost time: 21.246174097061157
Epoch: 22, Steps: 208 | Train Loss: 0.384 Vali Loss: 7.661 Vali Acc: 0.120 Test Loss: 7.661 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.3195622
	speed: 0.2652s/iter; left time: 4276.7897s
	iters: 200, epoch: 23 | loss: 0.1088080
	speed: 0.0920s/iter; left time: 1475.0783s
Epoch: 23 cost time: 19.290183067321777
Epoch: 23, Steps: 208 | Train Loss: 0.389 Vali Loss: 7.724 Vali Acc: 0.118 Test Loss: 7.724 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.4546995
	speed: 0.2666s/iter; left time: 4242.8968s
	iters: 200, epoch: 24 | loss: 0.3712912
	speed: 0.1012s/iter; left time: 1600.5792s
Epoch: 24 cost time: 21.8339364528656
Epoch: 24, Steps: 208 | Train Loss: 0.373 Vali Loss: 8.076 Vali Acc: 0.112 Test Loss: 8.076 Test Acc: 0.112
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.1966382
	speed: 0.2588s/iter; left time: 4064.7281s
	iters: 200, epoch: 25 | loss: 0.6197246
	speed: 0.0921s/iter; left time: 1438.1255s
Epoch: 25 cost time: 19.307297706604004
Epoch: 25, Steps: 208 | Train Loss: 0.373 Vali Loss: 7.722 Vali Acc: 0.110 Test Loss: 7.722 Test Acc: 0.110
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.4664984
	speed: 0.2602s/iter; left time: 4033.4473s
	iters: 200, epoch: 26 | loss: 0.2121492
	speed: 0.0892s/iter; left time: 1373.6777s
Epoch: 26 cost time: 18.80929160118103
Epoch: 26, Steps: 208 | Train Loss: 0.343 Vali Loss: 8.383 Vali Acc: 0.113 Test Loss: 8.383 Test Acc: 0.113
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.1816164
	speed: 0.2349s/iter; left time: 3592.4359s
	iters: 200, epoch: 27 | loss: 0.3979537
	speed: 0.0746s/iter; left time: 1133.4852s
Epoch: 27 cost time: 16.504004955291748
Epoch: 27, Steps: 208 | Train Loss: 0.326 Vali Loss: 8.548 Vali Acc: 0.116 Test Loss: 8.548 Test Acc: 0.116
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.6649495
	speed: 0.2557s/iter; left time: 3857.4404s
	iters: 200, epoch: 28 | loss: 0.4017817
	speed: 0.0951s/iter; left time: 1425.2014s
Epoch: 28 cost time: 20.101011276245117
Epoch: 28, Steps: 208 | Train Loss: 0.343 Vali Loss: 8.278 Vali Acc: 0.115 Test Loss: 8.278 Test Acc: 0.115
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.7834241
	speed: 0.2489s/iter; left time: 3702.6234s
	iters: 200, epoch: 29 | loss: 0.2541292
	speed: 0.0900s/iter; left time: 1330.6290s
Epoch: 29 cost time: 19.157138109207153
Epoch: 29, Steps: 208 | Train Loss: 0.328 Vali Loss: 8.505 Vali Acc: 0.112 Test Loss: 8.505 Test Acc: 0.112
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12317327766179541
model parameter : 718155
model size : 4.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7060778
	speed: 0.0965s/iter; left time: 1997.1947s
	iters: 200, epoch: 1 | loss: 3.7462969
	speed: 0.0855s/iter; left time: 1760.7681s
Epoch: 1 cost time: 19.04394841194153
Epoch: 1, Steps: 208 | Train Loss: 3.921 Vali Loss: 3.890 Vali Acc: 0.047 Test Loss: 3.890 Test Acc: 0.047
Validation loss decreased (inf --> -0.047381).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7945299
	speed: 0.2533s/iter; left time: 5190.3733s
	iters: 200, epoch: 2 | loss: 3.6071942
	speed: 0.0882s/iter; left time: 1798.9540s
Epoch: 2 cost time: 19.463686227798462
Epoch: 2, Steps: 208 | Train Loss: 3.888 Vali Loss: 3.873 Vali Acc: 0.056 Test Loss: 3.873 Test Acc: 0.056
Validation loss decreased (-0.047381 --> -0.055732).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5944026
	speed: 0.1853s/iter; left time: 3759.5165s
	iters: 200, epoch: 3 | loss: 3.7586789
	speed: 0.0531s/iter; left time: 1071.3821s
Epoch: 3 cost time: 11.096678972244263
Epoch: 3, Steps: 208 | Train Loss: 3.667 Vali Loss: 3.694 Vali Acc: 0.055 Test Loss: 3.694 Test Acc: 0.055
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.3003981
	speed: 0.2591s/iter; left time: 5202.3825s
	iters: 200, epoch: 4 | loss: 3.3049986
	speed: 0.0813s/iter; left time: 1624.9407s
Epoch: 4 cost time: 18.68177604675293
Epoch: 4, Steps: 208 | Train Loss: 3.494 Vali Loss: 3.643 Vali Acc: 0.062 Test Loss: 3.643 Test Acc: 0.062
Validation loss decreased (-0.055732 --> -0.061998).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.1599958
	speed: 0.2538s/iter; left time: 5043.0719s
	iters: 200, epoch: 5 | loss: 3.4648681
	speed: 0.0958s/iter; left time: 1894.0933s
Epoch: 5 cost time: 19.727036952972412
Epoch: 5, Steps: 208 | Train Loss: 3.324 Vali Loss: 3.389 Vali Acc: 0.072 Test Loss: 3.389 Test Acc: 0.072
Validation loss decreased (-0.061998 --> -0.072140).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0661261
	speed: 0.2604s/iter; left time: 5119.5683s
	iters: 200, epoch: 6 | loss: 3.0257604
	speed: 0.0906s/iter; left time: 1773.1736s
Epoch: 6 cost time: 19.97697949409485
Epoch: 6, Steps: 208 | Train Loss: 3.126 Vali Loss: 3.294 Vali Acc: 0.090 Test Loss: 3.294 Test Acc: 0.090
Validation loss decreased (-0.072140 --> -0.089737).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.5323148
	speed: 0.2664s/iter; left time: 5182.8337s
	iters: 200, epoch: 7 | loss: 2.5373559
	speed: 0.1004s/iter; left time: 1942.9891s
Epoch: 7 cost time: 21.31221032142639
Epoch: 7, Steps: 208 | Train Loss: 2.941 Vali Loss: 3.243 Vali Acc: 0.101 Test Loss: 3.243 Test Acc: 0.101
Validation loss decreased (-0.089737 --> -0.101071).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.6557500
	speed: 0.2764s/iter; left time: 5318.9293s
	iters: 200, epoch: 8 | loss: 2.7988787
	speed: 0.0898s/iter; left time: 1720.0988s
Epoch: 8 cost time: 20.14852476119995
Epoch: 8, Steps: 208 | Train Loss: 2.712 Vali Loss: 3.293 Vali Acc: 0.108 Test Loss: 3.293 Test Acc: 0.108
Validation loss decreased (-0.101071 --> -0.107632).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.3638935
	speed: 0.2700s/iter; left time: 5139.8865s
	iters: 200, epoch: 9 | loss: 2.1668484
	speed: 0.1047s/iter; left time: 1982.9969s
Epoch: 9 cost time: 21.72075319290161
Epoch: 9, Steps: 208 | Train Loss: 2.455 Vali Loss: 3.285 Vali Acc: 0.116 Test Loss: 3.285 Test Acc: 0.116
Validation loss decreased (-0.107632 --> -0.115684).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.3116183
	speed: 0.2678s/iter; left time: 5043.0207s
	iters: 200, epoch: 10 | loss: 2.4653881
	speed: 0.0896s/iter; left time: 1677.6955s
Epoch: 10 cost time: 19.370525598526
Epoch: 10, Steps: 208 | Train Loss: 2.163 Vali Loss: 3.466 Vali Acc: 0.112 Test Loss: 3.466 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.5612993
	speed: 0.2621s/iter; left time: 4881.1826s
	iters: 200, epoch: 11 | loss: 2.3914595
	speed: 0.0903s/iter; left time: 1671.9149s
Epoch: 11 cost time: 18.8166561126709
Epoch: 11, Steps: 208 | Train Loss: 1.846 Vali Loss: 3.912 Vali Acc: 0.130 Test Loss: 3.912 Test Acc: 0.130
Validation loss decreased (-0.115684 --> -0.129695).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.9581017
	speed: 0.2564s/iter; left time: 4720.9545s
	iters: 200, epoch: 12 | loss: 1.1842459
	speed: 0.0835s/iter; left time: 1529.2239s
Epoch: 12 cost time: 18.07357406616211
Epoch: 12, Steps: 208 | Train Loss: 1.495 Vali Loss: 4.244 Vali Acc: 0.115 Test Loss: 4.244 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.3281313
	speed: 0.2449s/iter; left time: 4458.1409s
	iters: 200, epoch: 13 | loss: 1.3087118
	speed: 0.0896s/iter; left time: 1621.6866s
Epoch: 13 cost time: 19.06448769569397
Epoch: 13, Steps: 208 | Train Loss: 1.214 Vali Loss: 4.392 Vali Acc: 0.121 Test Loss: 4.392 Test Acc: 0.121
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.9837826
	speed: 0.2426s/iter; left time: 4366.3555s
	iters: 200, epoch: 14 | loss: 0.9873466
	speed: 0.0812s/iter; left time: 1453.6832s
Epoch: 14 cost time: 17.729040384292603
Epoch: 14, Steps: 208 | Train Loss: 1.014 Vali Loss: 5.124 Vali Acc: 0.129 Test Loss: 5.124 Test Acc: 0.129
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.8790726
	speed: 0.2499s/iter; left time: 4444.5924s
	iters: 200, epoch: 15 | loss: 1.1437488
	speed: 0.0925s/iter; left time: 1635.8562s
Epoch: 15 cost time: 19.920868396759033
Epoch: 15, Steps: 208 | Train Loss: 0.835 Vali Loss: 5.464 Vali Acc: 0.124 Test Loss: 5.464 Test Acc: 0.124
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.9269495
	speed: 0.2373s/iter; left time: 4171.5258s
	iters: 200, epoch: 16 | loss: 0.4075032
	speed: 0.0878s/iter; left time: 1534.5882s
Epoch: 16 cost time: 17.775965452194214
Epoch: 16, Steps: 208 | Train Loss: 0.739 Vali Loss: 5.863 Vali Acc: 0.122 Test Loss: 5.863 Test Acc: 0.122
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.9289312
	speed: 0.2646s/iter; left time: 4596.5918s
	iters: 200, epoch: 17 | loss: 0.2664265
	speed: 0.0934s/iter; left time: 1613.1279s
Epoch: 17 cost time: 19.8983097076416
Epoch: 17, Steps: 208 | Train Loss: 0.638 Vali Loss: 6.095 Vali Acc: 0.118 Test Loss: 6.095 Test Acc: 0.118
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.9079570
	speed: 0.2432s/iter; left time: 4175.0371s
	iters: 200, epoch: 18 | loss: 0.9030235
	speed: 0.0825s/iter; left time: 1407.8708s
Epoch: 18 cost time: 17.622917652130127
Epoch: 18, Steps: 208 | Train Loss: 0.587 Vali Loss: 6.447 Vali Acc: 0.125 Test Loss: 6.447 Test Acc: 0.125
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.6378317
	speed: 0.2538s/iter; left time: 4303.4886s
	iters: 200, epoch: 19 | loss: 0.6336828
	speed: 0.0927s/iter; left time: 1562.2465s
Epoch: 19 cost time: 19.032907009124756
Epoch: 19, Steps: 208 | Train Loss: 0.540 Vali Loss: 6.513 Vali Acc: 0.118 Test Loss: 6.513 Test Acc: 0.118
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.6039129
	speed: 0.2489s/iter; left time: 4169.1648s
	iters: 200, epoch: 20 | loss: 0.4156697
	speed: 0.0837s/iter; left time: 1393.8967s
Epoch: 20 cost time: 17.745893716812134
Epoch: 20, Steps: 208 | Train Loss: 0.504 Vali Loss: 6.513 Vali Acc: 0.116 Test Loss: 6.513 Test Acc: 0.116
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.5497237
	speed: 0.2634s/iter; left time: 4357.2971s
	iters: 200, epoch: 21 | loss: 0.5601411
	speed: 0.0930s/iter; left time: 1528.4075s
Epoch: 21 cost time: 20.276014804840088
Epoch: 21, Steps: 208 | Train Loss: 0.493 Vali Loss: 7.310 Vali Acc: 0.127 Test Loss: 7.310 Test Acc: 0.127
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12973456606024455
model parameter : 716299
model size : 4.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9206336
	speed: 0.1126s/iter; left time: 2331.9162s
	iters: 200, epoch: 1 | loss: 3.6606200
	speed: 0.1022s/iter; left time: 2105.3566s
Epoch: 1 cost time: 22.382285833358765
Epoch: 1, Steps: 208 | Train Loss: 3.930 Vali Loss: 4.006 Vali Acc: 0.049 Test Loss: 4.006 Test Acc: 0.049
Validation loss decreased (inf --> -0.048871).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8495286
	speed: 0.2583s/iter; left time: 5293.7564s
	iters: 200, epoch: 2 | loss: 3.5757399
	speed: 0.0907s/iter; left time: 1848.7933s
Epoch: 2 cost time: 18.4470534324646
Epoch: 2, Steps: 208 | Train Loss: 3.922 Vali Loss: 3.868 Vali Acc: 0.058 Test Loss: 3.868 Test Acc: 0.058
Validation loss decreased (-0.048871 --> -0.058416).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.9453206
	speed: 0.2474s/iter; left time: 5018.5763s
	iters: 200, epoch: 3 | loss: 3.7403970
	speed: 0.0688s/iter; left time: 1388.8232s
Epoch: 3 cost time: 15.06573486328125
Epoch: 3, Steps: 208 | Train Loss: 3.695 Vali Loss: 3.781 Vali Acc: 0.057 Test Loss: 3.781 Test Acc: 0.057
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.5834928
	speed: 0.2536s/iter; left time: 5090.8886s
	iters: 200, epoch: 4 | loss: 3.4505997
	speed: 0.0969s/iter; left time: 1934.9501s
Epoch: 4 cost time: 20.958557605743408
Epoch: 4, Steps: 208 | Train Loss: 3.520 Vali Loss: 3.653 Vali Acc: 0.064 Test Loss: 3.653 Test Acc: 0.064
Validation loss decreased (-0.058416 --> -0.063489).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3867331
	speed: 0.2682s/iter; left time: 5328.3690s
	iters: 200, epoch: 5 | loss: 3.1914952
	speed: 0.0792s/iter; left time: 1565.3278s
Epoch: 5 cost time: 17.755579710006714
Epoch: 5, Steps: 208 | Train Loss: 3.368 Vali Loss: 3.514 Vali Acc: 0.073 Test Loss: 3.514 Test Acc: 0.073
Validation loss decreased (-0.063489 --> -0.073332).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.4559855
	speed: 0.2026s/iter; left time: 3982.6836s
	iters: 200, epoch: 6 | loss: 2.8746052
	speed: 0.0591s/iter; left time: 1155.6342s
Epoch: 6 cost time: 13.0071120262146
Epoch: 6, Steps: 208 | Train Loss: 3.135 Vali Loss: 3.411 Vali Acc: 0.090 Test Loss: 3.411 Test Acc: 0.090
Validation loss decreased (-0.073332 --> -0.090333).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9138911
	speed: 0.2522s/iter; left time: 4906.4085s
	iters: 200, epoch: 7 | loss: 3.1883569
	speed: 0.0789s/iter; left time: 1526.2588s
Epoch: 7 cost time: 17.673978567123413
Epoch: 7, Steps: 208 | Train Loss: 2.935 Vali Loss: 3.418 Vali Acc: 0.095 Test Loss: 3.418 Test Acc: 0.095
Validation loss decreased (-0.090333 --> -0.095403).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.8442974
	speed: 0.2477s/iter; left time: 4767.6942s
	iters: 200, epoch: 8 | loss: 2.8312984
	speed: 0.0918s/iter; left time: 1757.0126s
Epoch: 8 cost time: 19.6618070602417
Epoch: 8, Steps: 208 | Train Loss: 2.676 Vali Loss: 3.566 Vali Acc: 0.104 Test Loss: 3.566 Test Acc: 0.104
Validation loss decreased (-0.095403 --> -0.104050).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9746200
	speed: 0.2371s/iter; left time: 4514.3013s
	iters: 200, epoch: 9 | loss: 2.2937603
	speed: 0.0849s/iter; left time: 1608.0293s
Epoch: 9 cost time: 18.004916667938232
Epoch: 9, Steps: 208 | Train Loss: 2.328 Vali Loss: 3.629 Vali Acc: 0.096 Test Loss: 3.629 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.7146096
	speed: 0.2463s/iter; left time: 4638.0058s
	iters: 200, epoch: 10 | loss: 1.9533169
	speed: 0.0924s/iter; left time: 1731.2209s
Epoch: 10 cost time: 19.64820671081543
Epoch: 10, Steps: 208 | Train Loss: 1.903 Vali Loss: 3.850 Vali Acc: 0.099 Test Loss: 3.850 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.9471374
	speed: 0.2373s/iter; left time: 4417.9167s
	iters: 200, epoch: 11 | loss: 2.3403003
	speed: 0.0731s/iter; left time: 1354.4762s
Epoch: 11 cost time: 16.66969919204712
Epoch: 11, Steps: 208 | Train Loss: 1.538 Vali Loss: 4.385 Vali Acc: 0.107 Test Loss: 4.385 Test Acc: 0.107
Validation loss decreased (-0.104050 --> -0.107323).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.2234865
	speed: 0.2468s/iter; left time: 4545.1589s
	iters: 200, epoch: 12 | loss: 0.9257520
	speed: 0.0909s/iter; left time: 1664.9020s
Epoch: 12 cost time: 19.081560611724854
Epoch: 12, Steps: 208 | Train Loss: 1.200 Vali Loss: 4.630 Vali Acc: 0.108 Test Loss: 4.630 Test Acc: 0.108
Validation loss decreased (-0.107323 --> -0.107618).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.9750935
	speed: 0.2493s/iter; left time: 4539.0996s
	iters: 200, epoch: 13 | loss: 1.2127471
	speed: 0.0778s/iter; left time: 1409.4553s
Epoch: 13 cost time: 17.42445683479309
Epoch: 13, Steps: 208 | Train Loss: 0.958 Vali Loss: 4.991 Vali Acc: 0.109 Test Loss: 4.991 Test Acc: 0.109
Validation loss decreased (-0.107618 --> -0.109404).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.4562619
	speed: 0.2451s/iter; left time: 4410.8545s
	iters: 200, epoch: 14 | loss: 1.6788638
	speed: 0.0936s/iter; left time: 1674.8939s
Epoch: 14 cost time: 19.647984504699707
Epoch: 14, Steps: 208 | Train Loss: 0.769 Vali Loss: 5.291 Vali Acc: 0.103 Test Loss: 5.291 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.5644733
	speed: 0.2384s/iter; left time: 4241.0798s
	iters: 200, epoch: 15 | loss: 0.6861578
	speed: 0.0910s/iter; left time: 1609.2714s
Epoch: 15 cost time: 19.147772550582886
Epoch: 15, Steps: 208 | Train Loss: 0.672 Vali Loss: 5.532 Vali Acc: 0.108 Test Loss: 5.532 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.8115417
	speed: 0.2478s/iter; left time: 4356.6967s
	iters: 200, epoch: 16 | loss: 0.6443794
	speed: 0.0896s/iter; left time: 1566.6607s
Epoch: 16 cost time: 19.089532613754272
Epoch: 16, Steps: 208 | Train Loss: 0.599 Vali Loss: 5.775 Vali Acc: 0.109 Test Loss: 5.775 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0928439
	speed: 0.2524s/iter; left time: 4385.6370s
	iters: 200, epoch: 17 | loss: 0.9002562
	speed: 0.1029s/iter; left time: 1777.8405s
Epoch: 17 cost time: 19.64947271347046
Epoch: 17, Steps: 208 | Train Loss: 0.542 Vali Loss: 5.997 Vali Acc: 0.110 Test Loss: 5.997 Test Acc: 0.110
Validation loss decreased (-0.109404 --> -0.110289).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.1716796
	speed: 0.2822s/iter; left time: 4844.8015s
	iters: 200, epoch: 18 | loss: 0.2032238
	speed: 0.0922s/iter; left time: 1574.1196s
Epoch: 18 cost time: 20.20328640937805
Epoch: 18, Steps: 208 | Train Loss: 0.489 Vali Loss: 6.420 Vali Acc: 0.116 Test Loss: 6.420 Test Acc: 0.116
Validation loss decreased (-0.110289 --> -0.115951).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.5283580
	speed: 0.2609s/iter; left time: 4424.1421s
	iters: 200, epoch: 19 | loss: 0.8560864
	speed: 0.0872s/iter; left time: 1469.3552s
Epoch: 19 cost time: 18.86388397216797
Epoch: 19, Steps: 208 | Train Loss: 0.463 Vali Loss: 6.552 Vali Acc: 0.109 Test Loss: 6.552 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.4489518
	speed: 0.2797s/iter; left time: 4683.9159s
	iters: 200, epoch: 20 | loss: 0.1433556
	speed: 0.0760s/iter; left time: 1264.7948s
Epoch: 20 cost time: 18.95842981338501
Epoch: 20, Steps: 208 | Train Loss: 0.422 Vali Loss: 6.993 Vali Acc: 0.101 Test Loss: 6.993 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.4424826
	speed: 0.2551s/iter; left time: 4220.1093s
	iters: 200, epoch: 21 | loss: 0.4135624
	speed: 0.0915s/iter; left time: 1504.6470s
Epoch: 21 cost time: 19.45815372467041
Epoch: 21, Steps: 208 | Train Loss: 0.379 Vali Loss: 7.262 Vali Acc: 0.110 Test Loss: 7.262 Test Acc: 0.110
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.4079788
	speed: 0.2547s/iter; left time: 4160.4136s
	iters: 200, epoch: 22 | loss: 0.5860966
	speed: 0.0927s/iter; left time: 1505.0066s
Epoch: 22 cost time: 19.665545225143433
Epoch: 22, Steps: 208 | Train Loss: 0.358 Vali Loss: 7.456 Vali Acc: 0.103 Test Loss: 7.456 Test Acc: 0.103
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.2711815
	speed: 0.2443s/iter; left time: 3939.1809s
	iters: 200, epoch: 23 | loss: 0.9680278
	speed: 0.0941s/iter; left time: 1508.0749s
Epoch: 23 cost time: 20.033896684646606
Epoch: 23, Steps: 208 | Train Loss: 0.365 Vali Loss: 8.130 Vali Acc: 0.104 Test Loss: 8.130 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.6967132
	speed: 0.2486s/iter; left time: 3957.6742s
	iters: 200, epoch: 24 | loss: 0.1052894
	speed: 0.0839s/iter; left time: 1326.9038s
Epoch: 24 cost time: 18.00702929496765
Epoch: 24, Steps: 208 | Train Loss: 0.344 Vali Loss: 8.049 Vali Acc: 0.112 Test Loss: 8.049 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.4812836
	speed: 0.2533s/iter; left time: 3979.0367s
	iters: 200, epoch: 25 | loss: 0.2439280
	speed: 0.0919s/iter; left time: 1434.1860s
Epoch: 25 cost time: 19.58907175064087
Epoch: 25, Steps: 208 | Train Loss: 0.328 Vali Loss: 8.276 Vali Acc: 0.103 Test Loss: 8.276 Test Acc: 0.103
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.2110671
	speed: 0.2431s/iter; left time: 3767.5279s
	iters: 200, epoch: 26 | loss: 0.5075315
	speed: 0.0816s/iter; left time: 1257.0600s
Epoch: 26 cost time: 17.68920397758484
Epoch: 26, Steps: 208 | Train Loss: 0.310 Vali Loss: 8.410 Vali Acc: 0.110 Test Loss: 8.410 Test Acc: 0.110
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.5303006
	speed: 0.2499s/iter; left time: 3822.0664s
	iters: 200, epoch: 27 | loss: 0.2635435
	speed: 0.0919s/iter; left time: 1396.5830s
Epoch: 27 cost time: 18.989227056503296
Epoch: 27, Steps: 208 | Train Loss: 0.317 Vali Loss: 7.764 Vali Acc: 0.110 Test Loss: 7.764 Test Acc: 0.110
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.1182830
	speed: 0.2332s/iter; left time: 3517.9985s
	iters: 200, epoch: 28 | loss: 0.1586355
	speed: 0.0766s/iter; left time: 1148.3476s
Epoch: 28 cost time: 16.56181502342224
Epoch: 28, Steps: 208 | Train Loss: 0.297 Vali Loss: 8.645 Vali Acc: 0.106 Test Loss: 8.645 Test Acc: 0.106
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11601550849985089
model parameter : 714443
model size : 4.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.3978643
	speed: 0.1082s/iter; left time: 2239.5954s
	iters: 200, epoch: 1 | loss: 4.5108228
	speed: 0.0872s/iter; left time: 1796.0393s
Epoch: 1 cost time: 20.36596655845642
Epoch: 1, Steps: 208 | Train Loss: 3.917 Vali Loss: 3.929 Vali Acc: 0.051 Test Loss: 3.929 Test Acc: 0.051
Validation loss decreased (inf --> -0.050662).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7613730
	speed: 0.2318s/iter; left time: 4750.5210s
	iters: 200, epoch: 2 | loss: 4.2118897
	speed: 0.0896s/iter; left time: 1826.8136s
Epoch: 2 cost time: 18.031238317489624
Epoch: 2, Steps: 208 | Train Loss: 3.919 Vali Loss: 3.944 Vali Acc: 0.047 Test Loss: 3.944 Test Acc: 0.047
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.7880132
	speed: 0.2421s/iter; left time: 4910.9185s
	iters: 200, epoch: 3 | loss: 3.5688934
	speed: 0.0733s/iter; left time: 1479.9791s
Epoch: 3 cost time: 17.045743465423584
Epoch: 3, Steps: 208 | Train Loss: 3.662 Vali Loss: 3.741 Vali Acc: 0.059 Test Loss: 3.741 Test Acc: 0.059
Validation loss decreased (-0.050662 --> -0.059312).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.7126966
	speed: 0.2020s/iter; left time: 4055.8862s
	iters: 200, epoch: 4 | loss: 3.5487702
	speed: 0.0651s/iter; left time: 1301.0199s
Epoch: 4 cost time: 13.961898803710938
Epoch: 4, Steps: 208 | Train Loss: 3.501 Vali Loss: 3.685 Vali Acc: 0.071 Test Loss: 3.685 Test Acc: 0.071
Validation loss decreased (-0.059312 --> -0.070944).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.6284459
	speed: 0.2674s/iter; left time: 5312.6426s
	iters: 200, epoch: 5 | loss: 3.4696283
	speed: 0.0893s/iter; left time: 1765.4321s
Epoch: 5 cost time: 20.11726474761963
Epoch: 5, Steps: 208 | Train Loss: 3.313 Vali Loss: 3.464 Vali Acc: 0.079 Test Loss: 3.464 Test Acc: 0.079
Validation loss decreased (-0.070944 --> -0.078701).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2966979
	speed: 0.2633s/iter; left time: 5176.9927s
	iters: 200, epoch: 6 | loss: 2.7780828
	speed: 0.1007s/iter; left time: 1969.7877s
Epoch: 6 cost time: 21.232089042663574
Epoch: 6, Steps: 208 | Train Loss: 3.120 Vali Loss: 3.305 Vali Acc: 0.096 Test Loss: 3.305 Test Acc: 0.096
Validation loss decreased (-0.078701 --> -0.096000).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.5212295
	speed: 0.2607s/iter; left time: 5071.8307s
	iters: 200, epoch: 7 | loss: 3.2287850
	speed: 0.0884s/iter; left time: 1710.3850s
Epoch: 7 cost time: 19.440558671951294
Epoch: 7, Steps: 208 | Train Loss: 2.913 Vali Loss: 3.250 Vali Acc: 0.098 Test Loss: 3.250 Test Acc: 0.098
Validation loss decreased (-0.096000 --> -0.097790).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.7214048
	speed: 0.2567s/iter; left time: 4940.9431s
	iters: 200, epoch: 8 | loss: 2.9273331
	speed: 0.0925s/iter; left time: 1770.6404s
Epoch: 8 cost time: 19.446018934249878
Epoch: 8, Steps: 208 | Train Loss: 2.657 Vali Loss: 3.366 Vali Acc: 0.107 Test Loss: 3.366 Test Acc: 0.107
Validation loss decreased (-0.097790 --> -0.107333).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5838158
	speed: 0.2348s/iter; left time: 4470.5830s
	iters: 200, epoch: 9 | loss: 2.5783975
	speed: 0.0713s/iter; left time: 1350.3803s
Epoch: 9 cost time: 16.229631662368774
Epoch: 9, Steps: 208 | Train Loss: 2.381 Vali Loss: 3.375 Vali Acc: 0.111 Test Loss: 3.375 Test Acc: 0.111
Validation loss decreased (-0.107333 --> -0.110912).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.0424440
	speed: 0.2459s/iter; left time: 4630.3870s
	iters: 200, epoch: 10 | loss: 2.1282139
	speed: 0.0841s/iter; left time: 1575.8441s
Epoch: 10 cost time: 18.60304594039917
Epoch: 10, Steps: 208 | Train Loss: 2.015 Vali Loss: 3.681 Vali Acc: 0.116 Test Loss: 3.681 Test Acc: 0.116
Validation loss decreased (-0.110912 --> -0.116277).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7448760
	speed: 0.2396s/iter; left time: 4462.0805s
	iters: 200, epoch: 11 | loss: 2.0481687
	speed: 0.0794s/iter; left time: 1471.3659s
Epoch: 11 cost time: 17.49720788002014
Epoch: 11, Steps: 208 | Train Loss: 1.611 Vali Loss: 4.094 Vali Acc: 0.115 Test Loss: 4.094 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.3108482
	speed: 0.2405s/iter; left time: 4427.4289s
	iters: 200, epoch: 12 | loss: 0.8498245
	speed: 0.0934s/iter; left time: 1710.8827s
Epoch: 12 cost time: 19.684632778167725
Epoch: 12, Steps: 208 | Train Loss: 1.277 Vali Loss: 4.417 Vali Acc: 0.106 Test Loss: 4.417 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.1366420
	speed: 0.2401s/iter; left time: 4371.0750s
	iters: 200, epoch: 13 | loss: 1.4149215
	speed: 0.0847s/iter; left time: 1532.7492s
Epoch: 13 cost time: 18.03142261505127
Epoch: 13, Steps: 208 | Train Loss: 1.025 Vali Loss: 5.004 Vali Acc: 0.121 Test Loss: 5.004 Test Acc: 0.121
Validation loss decreased (-0.116277 --> -0.120737).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.7089570
	speed: 0.2550s/iter; left time: 4588.9914s
	iters: 200, epoch: 14 | loss: 1.4894326
	speed: 0.0938s/iter; left time: 1679.2145s
Epoch: 14 cost time: 20.135199546813965
Epoch: 14, Steps: 208 | Train Loss: 0.848 Vali Loss: 5.440 Vali Acc: 0.121 Test Loss: 5.440 Test Acc: 0.121
Validation loss decreased (-0.120737 --> -0.121329).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.7602761
	speed: 0.2362s/iter; left time: 4201.0354s
	iters: 200, epoch: 15 | loss: 0.6602687
	speed: 0.0895s/iter; left time: 1583.3947s
Epoch: 15 cost time: 18.429125785827637
Epoch: 15, Steps: 208 | Train Loss: 0.715 Vali Loss: 5.869 Vali Acc: 0.115 Test Loss: 5.869 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.3675632
	speed: 0.2472s/iter; left time: 4346.5151s
	iters: 200, epoch: 16 | loss: 0.7838129
	speed: 0.0906s/iter; left time: 1583.0922s
Epoch: 16 cost time: 19.74155879020691
Epoch: 16, Steps: 208 | Train Loss: 0.638 Vali Loss: 6.229 Vali Acc: 0.110 Test Loss: 6.229 Test Acc: 0.110
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.4398240
	speed: 0.2475s/iter; left time: 4300.4723s
	iters: 200, epoch: 17 | loss: 0.4871829
	speed: 0.0847s/iter; left time: 1462.4122s
Epoch: 17 cost time: 17.982680320739746
Epoch: 17, Steps: 208 | Train Loss: 0.565 Vali Loss: 6.525 Vali Acc: 0.112 Test Loss: 6.525 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.5515973
	speed: 0.2511s/iter; left time: 4310.2597s
	iters: 200, epoch: 18 | loss: 0.7741699
	speed: 0.0851s/iter; left time: 1451.8767s
Epoch: 18 cost time: 18.715410947799683
Epoch: 18, Steps: 208 | Train Loss: 0.514 Vali Loss: 6.467 Vali Acc: 0.114 Test Loss: 6.467 Test Acc: 0.114
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.0066046
	speed: 0.2474s/iter; left time: 4195.0491s
	iters: 200, epoch: 19 | loss: 0.1190518
	speed: 0.0783s/iter; left time: 1320.1132s
Epoch: 19 cost time: 17.943831205368042
Epoch: 19, Steps: 208 | Train Loss: 0.493 Vali Loss: 6.940 Vali Acc: 0.114 Test Loss: 6.940 Test Acc: 0.114
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.1060670
	speed: 0.2547s/iter; left time: 4266.7578s
	iters: 200, epoch: 20 | loss: 0.7145947
	speed: 0.0957s/iter; left time: 1593.6458s
Epoch: 20 cost time: 20.801581621170044
Epoch: 20, Steps: 208 | Train Loss: 0.460 Vali Loss: 6.954 Vali Acc: 0.114 Test Loss: 6.954 Test Acc: 0.114
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.6440713
	speed: 0.2583s/iter; left time: 4273.0506s
	iters: 200, epoch: 21 | loss: 0.4816958
	speed: 0.0907s/iter; left time: 1491.1253s
Epoch: 21 cost time: 19.15072989463806
Epoch: 21, Steps: 208 | Train Loss: 0.442 Vali Loss: 7.198 Vali Acc: 0.109 Test Loss: 7.198 Test Acc: 0.109
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.6323761
	speed: 0.2760s/iter; left time: 4507.4975s
	iters: 200, epoch: 22 | loss: 0.1009046
	speed: 0.1017s/iter; left time: 1650.7609s
Epoch: 22 cost time: 21.344276666641235
Epoch: 22, Steps: 208 | Train Loss: 0.397 Vali Loss: 7.347 Vali Acc: 0.118 Test Loss: 7.347 Test Acc: 0.118
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.8205643
	speed: 0.2706s/iter; left time: 4362.6632s
	iters: 200, epoch: 23 | loss: 0.7422814
	speed: 0.0973s/iter; left time: 1559.9814s
Epoch: 23 cost time: 20.6424777507782
Epoch: 23, Steps: 208 | Train Loss: 0.388 Vali Loss: 6.985 Vali Acc: 0.110 Test Loss: 6.985 Test Acc: 0.110
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.4219493
	speed: 0.2264s/iter; left time: 3603.7588s
	iters: 200, epoch: 24 | loss: 0.4027008
	speed: 0.0718s/iter; left time: 1136.0667s
Epoch: 24 cost time: 14.788307905197144
Epoch: 24, Steps: 208 | Train Loss: 0.405 Vali Loss: 7.463 Vali Acc: 0.119 Test Loss: 7.463 Test Acc: 0.119
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12138383537130927
model parameter : 712587
model size : 4.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.4209013
	speed: 0.0704s/iter; left time: 1457.7681s
	iters: 200, epoch: 1 | loss: 3.9614129
	speed: 0.0528s/iter; left time: 1088.7434s
Epoch: 1 cost time: 12.88128137588501
Epoch: 1, Steps: 208 | Train Loss: 3.741 Vali Loss: 3.662 Vali Acc: 0.055 Test Loss: 3.662 Test Acc: 0.055
Validation loss decreased (inf --> -0.054541).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.2990894
	speed: 0.1932s/iter; left time: 3959.9831s
	iters: 200, epoch: 2 | loss: 3.4862149
	speed: 0.0529s/iter; left time: 1079.1763s
Epoch: 2 cost time: 11.511696577072144
Epoch: 2, Steps: 208 | Train Loss: 3.672 Vali Loss: 3.659 Vali Acc: 0.051 Test Loss: 3.659 Test Acc: 0.051
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.3401814
	speed: 0.2007s/iter; left time: 4070.7243s
	iters: 200, epoch: 3 | loss: 3.7126999
	speed: 0.0508s/iter; left time: 1025.7284s
Epoch: 3 cost time: 11.3201162815094
Epoch: 3, Steps: 208 | Train Loss: 3.501 Vali Loss: 3.640 Vali Acc: 0.055 Test Loss: 3.640 Test Acc: 0.055
Validation loss decreased (-0.054541 --> -0.054542).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.5137951
	speed: 0.2094s/iter; left time: 4203.6229s
	iters: 200, epoch: 4 | loss: 3.7625413
	speed: 0.0542s/iter; left time: 1083.2954s
Epoch: 4 cost time: 11.429256439208984
Epoch: 4, Steps: 208 | Train Loss: 3.388 Vali Loss: 3.563 Vali Acc: 0.063 Test Loss: 3.563 Test Acc: 0.063
Validation loss decreased (-0.054542 --> -0.063191).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2719822
	speed: 0.1972s/iter; left time: 3917.9961s
	iters: 200, epoch: 5 | loss: 3.7174661
	speed: 0.0512s/iter; left time: 1011.3334s
Epoch: 5 cost time: 10.836648225784302
Epoch: 5, Steps: 208 | Train Loss: 3.261 Vali Loss: 3.573 Vali Acc: 0.070 Test Loss: 3.573 Test Acc: 0.070
Validation loss decreased (-0.063191 --> -0.070051).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0363359
	speed: 0.1983s/iter; left time: 3898.7345s
	iters: 200, epoch: 6 | loss: 3.2484081
	speed: 0.0530s/iter; left time: 1036.8033s
Epoch: 6 cost time: 11.195207357406616
Epoch: 6, Steps: 208 | Train Loss: 3.083 Vali Loss: 3.508 Vali Acc: 0.085 Test Loss: 3.508 Test Acc: 0.085
Validation loss decreased (-0.070051 --> -0.084665).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.6564848
	speed: 0.2062s/iter; left time: 4012.0471s
	iters: 200, epoch: 7 | loss: 3.3203890
	speed: 0.0535s/iter; left time: 1035.6255s
Epoch: 7 cost time: 11.461791515350342
Epoch: 7, Steps: 208 | Train Loss: 2.866 Vali Loss: 3.533 Vali Acc: 0.091 Test Loss: 3.533 Test Acc: 0.091
Validation loss decreased (-0.084665 --> -0.090630).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.7741139
	speed: 0.1972s/iter; left time: 3794.7599s
	iters: 200, epoch: 8 | loss: 2.8366146
	speed: 0.0505s/iter; left time: 966.4174s
Epoch: 8 cost time: 11.32228398323059
Epoch: 8, Steps: 208 | Train Loss: 2.692 Vali Loss: 3.584 Vali Acc: 0.102 Test Loss: 3.584 Test Acc: 0.102
Validation loss decreased (-0.090630 --> -0.101962).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.5276823
	speed: 0.2069s/iter; left time: 3939.3235s
	iters: 200, epoch: 9 | loss: 2.3070526
	speed: 0.0526s/iter; left time: 996.6198s
Epoch: 9 cost time: 11.636661291122437
Epoch: 9, Steps: 208 | Train Loss: 2.457 Vali Loss: 3.643 Vali Acc: 0.101 Test Loss: 3.643 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.3352947
	speed: 0.2008s/iter; left time: 3781.5615s
	iters: 200, epoch: 10 | loss: 2.3926275
	speed: 0.0521s/iter; left time: 975.3557s
Epoch: 10 cost time: 11.434873104095459
Epoch: 10, Steps: 208 | Train Loss: 2.202 Vali Loss: 3.948 Vali Acc: 0.093 Test Loss: 3.948 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.8208495
	speed: 0.2067s/iter; left time: 3848.9055s
	iters: 200, epoch: 11 | loss: 1.3337923
	speed: 0.0530s/iter; left time: 980.7387s
Epoch: 11 cost time: 11.38485598564148
Epoch: 11, Steps: 208 | Train Loss: 1.920 Vali Loss: 4.071 Vali Acc: 0.098 Test Loss: 4.071 Test Acc: 0.098
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 2.3363118
	speed: 0.1935s/iter; left time: 3562.2597s
	iters: 200, epoch: 12 | loss: 1.8074472
	speed: 0.0527s/iter; left time: 965.4841s
Epoch: 12 cost time: 11.232542276382446
Epoch: 12, Steps: 208 | Train Loss: 1.660 Vali Loss: 4.188 Vali Acc: 0.095 Test Loss: 4.188 Test Acc: 0.095
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.2823632
	speed: 0.1944s/iter; left time: 3538.4743s
	iters: 200, epoch: 13 | loss: 1.3525521
	speed: 0.0524s/iter; left time: 949.3039s
Epoch: 13 cost time: 11.43522572517395
Epoch: 13, Steps: 208 | Train Loss: 1.396 Vali Loss: 4.418 Vali Acc: 0.094 Test Loss: 4.418 Test Acc: 0.094
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.5253305
	speed: 0.1973s/iter; left time: 3549.9890s
	iters: 200, epoch: 14 | loss: 0.9107250
	speed: 0.0519s/iter; left time: 929.4343s
Epoch: 14 cost time: 11.315422296524048
Epoch: 14, Steps: 208 | Train Loss: 1.158 Vali Loss: 4.754 Vali Acc: 0.101 Test Loss: 4.754 Test Acc: 0.101
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.1575639
	speed: 0.2162s/iter; left time: 3846.0285s
	iters: 200, epoch: 15 | loss: 1.2765844
	speed: 0.0561s/iter; left time: 992.2756s
Epoch: 15 cost time: 12.268076658248901
Epoch: 15, Steps: 208 | Train Loss: 0.969 Vali Loss: 4.992 Vali Acc: 0.101 Test Loss: 4.992 Test Acc: 0.101
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.8449820
	speed: 0.2176s/iter; left time: 3825.0902s
	iters: 200, epoch: 16 | loss: 0.8045753
	speed: 0.0561s/iter; left time: 979.9047s
Epoch: 16 cost time: 12.127620935440063
Epoch: 16, Steps: 208 | Train Loss: 0.840 Vali Loss: 5.415 Vali Acc: 0.105 Test Loss: 5.415 Test Acc: 0.105
Validation loss decreased (-0.101962 --> -0.104926).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.4525734
	speed: 0.2171s/iter; left time: 3771.5894s
	iters: 200, epoch: 17 | loss: 0.7443479
	speed: 0.0540s/iter; left time: 932.0163s
Epoch: 17 cost time: 11.882089853286743
Epoch: 17, Steps: 208 | Train Loss: 0.712 Vali Loss: 5.616 Vali Acc: 0.100 Test Loss: 5.616 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.0895510
	speed: 0.2081s/iter; left time: 3571.8570s
	iters: 200, epoch: 18 | loss: 0.6370963
	speed: 0.0561s/iter; left time: 957.2540s
Epoch: 18 cost time: 12.147093057632446
Epoch: 18, Steps: 208 | Train Loss: 0.627 Vali Loss: 5.923 Vali Acc: 0.100 Test Loss: 5.923 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.5904201
	speed: 0.2098s/iter; left time: 3557.4096s
	iters: 200, epoch: 19 | loss: 0.8610694
	speed: 0.0537s/iter; left time: 905.6172s
Epoch: 19 cost time: 11.676120042800903
Epoch: 19, Steps: 208 | Train Loss: 0.574 Vali Loss: 6.146 Vali Acc: 0.102 Test Loss: 6.146 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.9312907
	speed: 0.2052s/iter; left time: 3436.7909s
	iters: 200, epoch: 20 | loss: 0.6909396
	speed: 0.0513s/iter; left time: 853.9728s
Epoch: 20 cost time: 11.03955626487732
Epoch: 20, Steps: 208 | Train Loss: 0.541 Vali Loss: 6.438 Vali Acc: 0.100 Test Loss: 6.438 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.7081184
	speed: 0.1877s/iter; left time: 3104.6804s
	iters: 200, epoch: 21 | loss: 0.2311948
	speed: 0.0424s/iter; left time: 696.3002s
Epoch: 21 cost time: 10.071088075637817
Epoch: 21, Steps: 208 | Train Loss: 0.474 Vali Loss: 6.671 Vali Acc: 0.102 Test Loss: 6.671 Test Acc: 0.102
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.4721979
	speed: 0.1661s/iter; left time: 2712.7135s
	iters: 200, epoch: 22 | loss: 0.4905489
	speed: 0.0508s/iter; left time: 824.0615s
Epoch: 22 cost time: 10.896715879440308
Epoch: 22, Steps: 208 | Train Loss: 0.455 Vali Loss: 6.771 Vali Acc: 0.098 Test Loss: 6.771 Test Acc: 0.098
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.4467401
	speed: 0.1996s/iter; left time: 3218.4663s
	iters: 200, epoch: 23 | loss: 0.2622486
	speed: 0.0501s/iter; left time: 803.1855s
Epoch: 23 cost time: 10.98868703842163
Epoch: 23, Steps: 208 | Train Loss: 0.445 Vali Loss: 7.262 Vali Acc: 0.101 Test Loss: 7.262 Test Acc: 0.101
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.3712055
	speed: 0.1977s/iter; left time: 3146.7491s
	iters: 200, epoch: 24 | loss: 0.6020958
	speed: 0.0515s/iter; left time: 814.2366s
Epoch: 24 cost time: 11.375940561294556
Epoch: 24, Steps: 208 | Train Loss: 0.416 Vali Loss: 7.120 Vali Acc: 0.098 Test Loss: 7.120 Test Acc: 0.098
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.6280698
	speed: 0.1900s/iter; left time: 2984.5745s
	iters: 200, epoch: 25 | loss: 0.9413831
	speed: 0.0513s/iter; left time: 800.1594s
Epoch: 25 cost time: 10.722290515899658
Epoch: 25, Steps: 208 | Train Loss: 0.403 Vali Loss: 7.482 Vali Acc: 0.100 Test Loss: 7.482 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.4385901
	speed: 0.1871s/iter; left time: 2899.6387s
	iters: 200, epoch: 26 | loss: 1.0547543
	speed: 0.0521s/iter; left time: 801.8418s
Epoch: 26 cost time: 11.09229826927185
Epoch: 26, Steps: 208 | Train Loss: 0.366 Vali Loss: 7.461 Vali Acc: 0.098 Test Loss: 7.461 Test Acc: 0.098
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1049806143751864
model parameter : 568715
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5593584
	speed: 0.0691s/iter; left time: 1431.0894s
	iters: 200, epoch: 1 | loss: 4.3319173
	speed: 0.0525s/iter; left time: 1082.3421s
Epoch: 1 cost time: 12.686155319213867
Epoch: 1, Steps: 208 | Train Loss: 3.775 Vali Loss: 3.654 Vali Acc: 0.052 Test Loss: 3.654 Test Acc: 0.052
Validation loss decreased (inf --> -0.052156).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4441199
	speed: 0.1979s/iter; left time: 4055.8106s
	iters: 200, epoch: 2 | loss: 3.3614812
	speed: 0.0525s/iter; left time: 1070.8374s
Epoch: 2 cost time: 11.368541717529297
Epoch: 2, Steps: 208 | Train Loss: 3.619 Vali Loss: 3.711 Vali Acc: 0.055 Test Loss: 3.711 Test Acc: 0.055
Validation loss decreased (-0.052156 --> -0.055436).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.6800613
	speed: 0.1906s/iter; left time: 3867.0504s
	iters: 200, epoch: 3 | loss: 3.3846328
	speed: 0.0544s/iter; left time: 1098.7377s
Epoch: 3 cost time: 11.347237825393677
Epoch: 3, Steps: 208 | Train Loss: 3.524 Vali Loss: 3.596 Vali Acc: 0.065 Test Loss: 3.596 Test Acc: 0.065
Validation loss decreased (-0.055436 --> -0.064980).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.6212251
	speed: 0.1999s/iter; left time: 4012.9209s
	iters: 200, epoch: 4 | loss: 3.3696055
	speed: 0.0540s/iter; left time: 1079.6533s
Epoch: 4 cost time: 11.471687316894531
Epoch: 4, Steps: 208 | Train Loss: 3.420 Vali Loss: 3.580 Vali Acc: 0.065 Test Loss: 3.580 Test Acc: 0.065
Validation loss decreased (-0.064980 --> -0.065279).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.8780160
	speed: 0.1898s/iter; left time: 3771.6383s
	iters: 200, epoch: 5 | loss: 3.7077987
	speed: 0.0516s/iter; left time: 1020.4275s
Epoch: 5 cost time: 11.223924398422241
Epoch: 5, Steps: 208 | Train Loss: 3.318 Vali Loss: 3.511 Vali Acc: 0.067 Test Loss: 3.511 Test Acc: 0.067
Validation loss decreased (-0.065279 --> -0.067069).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.3952050
	speed: 0.1929s/iter; left time: 3793.0004s
	iters: 200, epoch: 6 | loss: 3.4301925
	speed: 0.0498s/iter; left time: 974.0689s
Epoch: 6 cost time: 11.055610179901123
Epoch: 6, Steps: 208 | Train Loss: 3.179 Vali Loss: 3.459 Vali Acc: 0.088 Test Loss: 3.459 Test Acc: 0.088
Validation loss decreased (-0.067069 --> -0.087648).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.8504801
	speed: 0.1942s/iter; left time: 3777.8779s
	iters: 200, epoch: 7 | loss: 3.2172928
	speed: 0.0532s/iter; left time: 1030.0073s
Epoch: 7 cost time: 11.440028429031372
Epoch: 7, Steps: 208 | Train Loss: 3.024 Vali Loss: 3.427 Vali Acc: 0.091 Test Loss: 3.427 Test Acc: 0.091
Validation loss decreased (-0.087648 --> -0.090631).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.2231421
	speed: 0.1951s/iter; left time: 3753.7617s
	iters: 200, epoch: 8 | loss: 3.1314228
	speed: 0.0533s/iter; left time: 1019.8501s
Epoch: 8 cost time: 11.580771923065186
Epoch: 8, Steps: 208 | Train Loss: 2.821 Vali Loss: 3.425 Vali Acc: 0.094 Test Loss: 3.425 Test Acc: 0.094
Validation loss decreased (-0.090631 --> -0.093613).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.5969729
	speed: 0.1892s/iter; left time: 3601.4394s
	iters: 200, epoch: 9 | loss: 3.2980716
	speed: 0.0555s/iter; left time: 1051.2084s
Epoch: 9 cost time: 11.621740102767944
Epoch: 9, Steps: 208 | Train Loss: 2.603 Vali Loss: 3.517 Vali Acc: 0.100 Test Loss: 3.517 Test Acc: 0.100
Validation loss decreased (-0.093613 --> -0.100174).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.1837292
	speed: 0.2142s/iter; left time: 4032.6497s
	iters: 200, epoch: 10 | loss: 2.1706157
	speed: 0.0564s/iter; left time: 1057.1301s
Epoch: 10 cost time: 12.270928382873535
Epoch: 10, Steps: 208 | Train Loss: 2.355 Vali Loss: 3.638 Vali Acc: 0.095 Test Loss: 3.638 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.9700245
	speed: 0.2102s/iter; left time: 3914.5665s
	iters: 200, epoch: 11 | loss: 2.4806597
	speed: 0.0562s/iter; left time: 1041.0717s
Epoch: 11 cost time: 11.965320587158203
Epoch: 11, Steps: 208 | Train Loss: 2.101 Vali Loss: 3.815 Vali Acc: 0.107 Test Loss: 3.815 Test Acc: 0.107
Validation loss decreased (-0.100174 --> -0.106732).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.2044098
	speed: 0.2067s/iter; left time: 3805.7257s
	iters: 200, epoch: 12 | loss: 1.8442620
	speed: 0.0592s/iter; left time: 1083.8687s
Epoch: 12 cost time: 12.404621839523315
Epoch: 12, Steps: 208 | Train Loss: 1.847 Vali Loss: 4.023 Vali Acc: 0.098 Test Loss: 4.023 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.6553324
	speed: 0.2137s/iter; left time: 3889.9625s
	iters: 200, epoch: 13 | loss: 1.6965314
	speed: 0.0562s/iter; left time: 1017.8756s
Epoch: 13 cost time: 12.376224517822266
Epoch: 13, Steps: 208 | Train Loss: 1.567 Vali Loss: 4.244 Vali Acc: 0.095 Test Loss: 4.244 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.6391956
	speed: 0.2132s/iter; left time: 3836.1670s
	iters: 200, epoch: 14 | loss: 1.4251550
	speed: 0.0559s/iter; left time: 1000.4735s
Epoch: 14 cost time: 12.28255033493042
Epoch: 14, Steps: 208 | Train Loss: 1.330 Vali Loss: 4.620 Vali Acc: 0.095 Test Loss: 4.620 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.8740524
	speed: 0.1959s/iter; left time: 3485.1555s
	iters: 200, epoch: 15 | loss: 0.8322625
	speed: 0.0535s/iter; left time: 945.7087s
Epoch: 15 cost time: 11.577309131622314
Epoch: 15, Steps: 208 | Train Loss: 1.102 Vali Loss: 4.780 Vali Acc: 0.101 Test Loss: 4.780 Test Acc: 0.101
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.5759217
	speed: 0.1911s/iter; left time: 3360.2583s
	iters: 200, epoch: 16 | loss: 1.5357610
	speed: 0.0531s/iter; left time: 928.2807s
Epoch: 16 cost time: 11.562665939331055
Epoch: 16, Steps: 208 | Train Loss: 0.940 Vali Loss: 5.149 Vali Acc: 0.105 Test Loss: 5.149 Test Acc: 0.105
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.8508128
	speed: 0.1973s/iter; left time: 3427.3071s
	iters: 200, epoch: 17 | loss: 0.9017556
	speed: 0.0534s/iter; left time: 922.6262s
Epoch: 17 cost time: 11.357514381408691
Epoch: 17, Steps: 208 | Train Loss: 0.805 Vali Loss: 5.333 Vali Acc: 0.101 Test Loss: 5.333 Test Acc: 0.101
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.5491957
	speed: 0.1871s/iter; left time: 3211.7222s
	iters: 200, epoch: 18 | loss: 0.8655987
	speed: 0.0501s/iter; left time: 855.3951s
Epoch: 18 cost time: 10.924732446670532
Epoch: 18, Steps: 208 | Train Loss: 0.722 Vali Loss: 5.514 Vali Acc: 0.095 Test Loss: 5.514 Test Acc: 0.095
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.0286523
	speed: 0.1859s/iter; left time: 3152.8097s
	iters: 200, epoch: 19 | loss: 0.8965222
	speed: 0.0516s/iter; left time: 870.0296s
Epoch: 19 cost time: 11.102298021316528
Epoch: 19, Steps: 208 | Train Loss: 0.645 Vali Loss: 5.782 Vali Acc: 0.098 Test Loss: 5.782 Test Acc: 0.098
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.7614417
	speed: 0.2018s/iter; left time: 3379.7208s
	iters: 200, epoch: 20 | loss: 0.7150214
	speed: 0.0562s/iter; left time: 935.5050s
Epoch: 20 cost time: 11.681210279464722
Epoch: 20, Steps: 208 | Train Loss: 0.575 Vali Loss: 6.214 Vali Acc: 0.101 Test Loss: 6.214 Test Acc: 0.101
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.4866228
	speed: 0.1937s/iter; left time: 3203.9354s
	iters: 200, epoch: 21 | loss: 0.4477186
	speed: 0.0519s/iter; left time: 852.5675s
Epoch: 21 cost time: 11.352175235748291
Epoch: 21, Steps: 208 | Train Loss: 0.522 Vali Loss: 6.295 Vali Acc: 0.094 Test Loss: 6.295 Test Acc: 0.094
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10677005666567253
model parameter : 567787
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7858670
	speed: 0.0582s/iter; left time: 1204.8402s
	iters: 200, epoch: 1 | loss: 3.9222069
	speed: 0.0424s/iter; left time: 874.4995s
Epoch: 1 cost time: 10.47572374343872
Epoch: 1, Steps: 208 | Train Loss: 3.739 Vali Loss: 3.809 Vali Acc: 0.049 Test Loss: 3.809 Test Acc: 0.049
Validation loss decreased (inf --> -0.048873).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.0979335
	speed: 0.1761s/iter; left time: 3609.5018s
	iters: 200, epoch: 2 | loss: 3.6339922
	speed: 0.0520s/iter; left time: 1060.9194s
Epoch: 2 cost time: 11.144527912139893
Epoch: 2, Steps: 208 | Train Loss: 3.626 Vali Loss: 3.616 Vali Acc: 0.065 Test Loss: 3.616 Test Acc: 0.065
Validation loss decreased (-0.048873 --> -0.064682).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.1046643
	speed: 0.1830s/iter; left time: 3711.7986s
	iters: 200, epoch: 3 | loss: 3.4934969
	speed: 0.0502s/iter; left time: 1013.7775s
Epoch: 3 cost time: 11.065348863601685
Epoch: 3, Steps: 208 | Train Loss: 3.515 Vali Loss: 3.611 Vali Acc: 0.059 Test Loss: 3.611 Test Acc: 0.059
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.9841809
	speed: 0.1898s/iter; left time: 3809.7777s
	iters: 200, epoch: 4 | loss: 3.3973341
	speed: 0.0500s/iter; left time: 998.1031s
Epoch: 4 cost time: 10.964833974838257
Epoch: 4, Steps: 208 | Train Loss: 3.374 Vali Loss: 3.613 Vali Acc: 0.058 Test Loss: 3.613 Test Acc: 0.058
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 3.2531743
	speed: 0.1875s/iter; left time: 3724.4791s
	iters: 200, epoch: 5 | loss: 3.3923635
	speed: 0.0514s/iter; left time: 1016.9085s
Epoch: 5 cost time: 11.18180251121521
Epoch: 5, Steps: 208 | Train Loss: 3.252 Vali Loss: 3.535 Vali Acc: 0.070 Test Loss: 3.535 Test Acc: 0.070
Validation loss decreased (-0.064682 --> -0.069753).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.8813696
	speed: 0.1948s/iter; left time: 3829.8691s
	iters: 200, epoch: 6 | loss: 2.9687459
	speed: 0.0536s/iter; left time: 1048.4166s
Epoch: 6 cost time: 11.41284465789795
Epoch: 6, Steps: 208 | Train Loss: 3.074 Vali Loss: 3.508 Vali Acc: 0.089 Test Loss: 3.508 Test Acc: 0.089
Validation loss decreased (-0.069753 --> -0.089139).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9488630
	speed: 0.1973s/iter; left time: 3838.1293s
	iters: 200, epoch: 7 | loss: 2.9475682
	speed: 0.0514s/iter; left time: 993.9200s
Epoch: 7 cost time: 11.133004188537598
Epoch: 7, Steps: 208 | Train Loss: 2.894 Vali Loss: 3.510 Vali Acc: 0.086 Test Loss: 3.510 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.6666541
	speed: 0.1929s/iter; left time: 3712.2815s
	iters: 200, epoch: 8 | loss: 3.0477946
	speed: 0.0506s/iter; left time: 969.5565s
Epoch: 8 cost time: 10.992970943450928
Epoch: 8, Steps: 208 | Train Loss: 2.697 Vali Loss: 3.526 Vali Acc: 0.092 Test Loss: 3.526 Test Acc: 0.092
Validation loss decreased (-0.089139 --> -0.092121).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.0397377
	speed: 0.1828s/iter; left time: 3480.1669s
	iters: 200, epoch: 9 | loss: 2.9651091
	speed: 0.0533s/iter; left time: 1008.7608s
Epoch: 9 cost time: 11.424078702926636
Epoch: 9, Steps: 208 | Train Loss: 2.497 Vali Loss: 3.637 Vali Acc: 0.090 Test Loss: 3.637 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.8306482
	speed: 0.2030s/iter; left time: 3822.9969s
	iters: 200, epoch: 10 | loss: 2.2141047
	speed: 0.0563s/iter; left time: 1055.2291s
Epoch: 10 cost time: 12.084019422531128
Epoch: 10, Steps: 208 | Train Loss: 2.244 Vali Loss: 3.795 Vali Acc: 0.095 Test Loss: 3.795 Test Acc: 0.095
Validation loss decreased (-0.092121 --> -0.094504).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.0280931
	speed: 0.2073s/iter; left time: 3861.0295s
	iters: 200, epoch: 11 | loss: 2.1629753
	speed: 0.0567s/iter; left time: 1050.9354s
Epoch: 11 cost time: 11.923313856124878
Epoch: 11, Steps: 208 | Train Loss: 1.951 Vali Loss: 3.957 Vali Acc: 0.097 Test Loss: 3.957 Test Acc: 0.097
Validation loss decreased (-0.094504 --> -0.096889).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.3426610
	speed: 0.2077s/iter; left time: 3824.5668s
	iters: 200, epoch: 12 | loss: 2.0734518
	speed: 0.0555s/iter; left time: 1016.5370s
Epoch: 12 cost time: 11.731602668762207
Epoch: 12, Steps: 208 | Train Loss: 1.708 Vali Loss: 4.086 Vali Acc: 0.100 Test Loss: 4.086 Test Acc: 0.100
Validation loss decreased (-0.096889 --> -0.099870).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.1217728
	speed: 0.1953s/iter; left time: 3555.7132s
	iters: 200, epoch: 13 | loss: 1.3990012
	speed: 0.0458s/iter; left time: 828.9062s
Epoch: 13 cost time: 10.024478435516357
Epoch: 13, Steps: 208 | Train Loss: 1.418 Vali Loss: 4.331 Vali Acc: 0.096 Test Loss: 4.331 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.2606610
	speed: 0.1872s/iter; left time: 3369.3794s
	iters: 200, epoch: 14 | loss: 1.5077906
	speed: 0.0542s/iter; left time: 970.4245s
Epoch: 14 cost time: 11.90073561668396
Epoch: 14, Steps: 208 | Train Loss: 1.205 Vali Loss: 4.891 Vali Acc: 0.093 Test Loss: 4.891 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.0979065
	speed: 0.1937s/iter; left time: 3445.6821s
	iters: 200, epoch: 15 | loss: 0.9412677
	speed: 0.0508s/iter; left time: 897.9203s
Epoch: 15 cost time: 11.192837238311768
Epoch: 15, Steps: 208 | Train Loss: 1.002 Vali Loss: 5.185 Vali Acc: 0.094 Test Loss: 5.185 Test Acc: 0.094
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.9284564
	speed: 0.1876s/iter; left time: 3298.9951s
	iters: 200, epoch: 16 | loss: 1.4673173
	speed: 0.0521s/iter; left time: 910.4015s
Epoch: 16 cost time: 11.13169813156128
Epoch: 16, Steps: 208 | Train Loss: 0.853 Vali Loss: 5.233 Vali Acc: 0.094 Test Loss: 5.233 Test Acc: 0.094
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.5610294
	speed: 0.1936s/iter; left time: 3363.7207s
	iters: 200, epoch: 17 | loss: 1.4060731
	speed: 0.0492s/iter; left time: 849.0139s
Epoch: 17 cost time: 10.896681308746338
Epoch: 17, Steps: 208 | Train Loss: 0.739 Vali Loss: 5.564 Vali Acc: 0.089 Test Loss: 5.564 Test Acc: 0.089
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.8902444
	speed: 0.1875s/iter; left time: 3217.7980s
	iters: 200, epoch: 18 | loss: 0.8781012
	speed: 0.0519s/iter; left time: 885.2460s
Epoch: 18 cost time: 11.099822521209717
Epoch: 18, Steps: 208 | Train Loss: 0.646 Vali Loss: 5.972 Vali Acc: 0.085 Test Loss: 5.972 Test Acc: 0.085
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.9962403
	speed: 0.1843s/iter; left time: 3125.6538s
	iters: 200, epoch: 19 | loss: 0.1821137
	speed: 0.0509s/iter; left time: 858.1865s
Epoch: 19 cost time: 11.036195039749146
Epoch: 19, Steps: 208 | Train Loss: 0.597 Vali Loss: 6.011 Vali Acc: 0.098 Test Loss: 6.011 Test Acc: 0.098
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.3821587
	speed: 0.1925s/iter; left time: 3224.0681s
	iters: 200, epoch: 20 | loss: 0.4360653
	speed: 0.0535s/iter; left time: 890.8100s
Epoch: 20 cost time: 11.523418426513672
Epoch: 20, Steps: 208 | Train Loss: 0.560 Vali Loss: 6.367 Vali Acc: 0.098 Test Loss: 6.367 Test Acc: 0.098
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.2144298
	speed: 0.1978s/iter; left time: 3272.5657s
	iters: 200, epoch: 21 | loss: 0.7376295
	speed: 0.0530s/iter; left time: 870.8684s
Epoch: 21 cost time: 11.321444988250732
Epoch: 21, Steps: 208 | Train Loss: 0.477 Vali Loss: 6.330 Vali Acc: 0.098 Test Loss: 6.330 Test Acc: 0.098
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.4337677
	speed: 0.1927s/iter; left time: 3147.7122s
	iters: 200, epoch: 22 | loss: 0.2766812
	speed: 0.0538s/iter; left time: 873.0700s
Epoch: 22 cost time: 11.348474264144897
Epoch: 22, Steps: 208 | Train Loss: 0.475 Vali Loss: 6.830 Vali Acc: 0.097 Test Loss: 6.830 Test Acc: 0.097
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09991052788547569
model parameter : 566859
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9171314
	speed: 0.0678s/iter; left time: 1402.8895s
	iters: 200, epoch: 1 | loss: 3.6615984
	speed: 0.0524s/iter; left time: 1079.9375s
Epoch: 1 cost time: 12.445308685302734
Epoch: 1, Steps: 208 | Train Loss: 3.759 Vali Loss: 3.710 Vali Acc: 0.064 Test Loss: 3.710 Test Acc: 0.064
Validation loss decreased (inf --> -0.063786).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3689003
	speed: 0.1926s/iter; left time: 3947.3854s
	iters: 200, epoch: 2 | loss: 3.7465553
	speed: 0.0510s/iter; left time: 1040.5637s
Epoch: 2 cost time: 10.79657530784607
Epoch: 2, Steps: 208 | Train Loss: 3.694 Vali Loss: 3.750 Vali Acc: 0.060 Test Loss: 3.750 Test Acc: 0.060
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.6459477
	speed: 0.1902s/iter; left time: 3858.2166s
	iters: 200, epoch: 3 | loss: 3.5747855
	speed: 0.0508s/iter; left time: 1025.5077s
Epoch: 3 cost time: 11.151756048202515
Epoch: 3, Steps: 208 | Train Loss: 3.543 Vali Loss: 3.664 Vali Acc: 0.061 Test Loss: 3.664 Test Acc: 0.061
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 3.9052184
	speed: 0.1885s/iter; left time: 3785.2434s
	iters: 200, epoch: 4 | loss: 3.2072074
	speed: 0.0516s/iter; left time: 1031.5620s
Epoch: 4 cost time: 11.217336893081665
Epoch: 4, Steps: 208 | Train Loss: 3.398 Vali Loss: 3.521 Vali Acc: 0.072 Test Loss: 3.521 Test Acc: 0.072
Validation loss decreased (-0.063786 --> -0.071841).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.0088530
	speed: 0.1887s/iter; left time: 3749.4787s
	iters: 200, epoch: 5 | loss: 3.2498436
	speed: 0.0501s/iter; left time: 989.9102s
Epoch: 5 cost time: 11.081369161605835
Epoch: 5, Steps: 208 | Train Loss: 3.209 Vali Loss: 3.439 Vali Acc: 0.085 Test Loss: 3.439 Test Acc: 0.085
Validation loss decreased (-0.071841 --> -0.084964).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.8177595
	speed: 0.1914s/iter; left time: 3762.5122s
	iters: 200, epoch: 6 | loss: 3.1054435
	speed: 0.0505s/iter; left time: 987.9466s
Epoch: 6 cost time: 11.209045648574829
Epoch: 6, Steps: 208 | Train Loss: 3.014 Vali Loss: 3.451 Vali Acc: 0.085 Test Loss: 3.451 Test Acc: 0.085
Validation loss decreased (-0.084964 --> -0.085262).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9883046
	speed: 0.2050s/iter; left time: 3988.0974s
	iters: 200, epoch: 7 | loss: 3.1444359
	speed: 0.0500s/iter; left time: 967.7716s
Epoch: 7 cost time: 11.268226623535156
Epoch: 7, Steps: 208 | Train Loss: 2.844 Vali Loss: 3.452 Vali Acc: 0.094 Test Loss: 3.452 Test Acc: 0.094
Validation loss decreased (-0.085262 --> -0.093613).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.5253611
	speed: 0.2137s/iter; left time: 4112.0367s
	iters: 200, epoch: 8 | loss: 2.7207785
	speed: 0.0560s/iter; left time: 1072.6442s
Epoch: 8 cost time: 12.191310167312622
Epoch: 8, Steps: 208 | Train Loss: 2.662 Vali Loss: 3.497 Vali Acc: 0.097 Test Loss: 3.497 Test Acc: 0.097
Validation loss decreased (-0.093613 --> -0.096893).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.2233703
	speed: 0.2127s/iter; left time: 4049.4563s
	iters: 200, epoch: 9 | loss: 2.4099612
	speed: 0.0554s/iter; left time: 1048.6555s
Epoch: 9 cost time: 12.342472314834595
Epoch: 9, Steps: 208 | Train Loss: 2.447 Vali Loss: 3.641 Vali Acc: 0.106 Test Loss: 3.641 Test Acc: 0.106
Validation loss decreased (-0.096893 --> -0.105839).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.7093904
	speed: 0.2076s/iter; left time: 3908.6946s
	iters: 200, epoch: 10 | loss: 2.7774467
	speed: 0.0553s/iter; left time: 1036.3227s
Epoch: 10 cost time: 11.821846008300781
Epoch: 10, Steps: 208 | Train Loss: 2.212 Vali Loss: 3.762 Vali Acc: 0.103 Test Loss: 3.762 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.9237623
	speed: 0.2114s/iter; left time: 3935.7423s
	iters: 200, epoch: 11 | loss: 2.0947957
	speed: 0.0544s/iter; left time: 1008.1568s
Epoch: 11 cost time: 12.194807767868042
Epoch: 11, Steps: 208 | Train Loss: 1.987 Vali Loss: 3.983 Vali Acc: 0.094 Test Loss: 3.983 Test Acc: 0.094
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.7572093
	speed: 0.2100s/iter; left time: 3866.9164s
	iters: 200, epoch: 12 | loss: 1.8336227
	speed: 0.0568s/iter; left time: 1039.4354s
Epoch: 12 cost time: 12.51459550857544
Epoch: 12, Steps: 208 | Train Loss: 1.746 Vali Loss: 4.097 Vali Acc: 0.105 Test Loss: 4.097 Test Acc: 0.105
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.1953340
	speed: 0.2058s/iter; left time: 3746.8371s
	iters: 200, epoch: 13 | loss: 1.3962133
	speed: 0.0517s/iter; left time: 936.3789s
Epoch: 13 cost time: 11.210515260696411
Epoch: 13, Steps: 208 | Train Loss: 1.476 Vali Loss: 4.359 Vali Acc: 0.109 Test Loss: 4.359 Test Acc: 0.109
Validation loss decreased (-0.105839 --> -0.109112).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.8721615
	speed: 0.1955s/iter; left time: 3518.5237s
	iters: 200, epoch: 14 | loss: 1.8279216
	speed: 0.0521s/iter; left time: 933.1508s
Epoch: 14 cost time: 11.289912223815918
Epoch: 14, Steps: 208 | Train Loss: 1.244 Vali Loss: 4.652 Vali Acc: 0.090 Test Loss: 4.652 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.0479404
	speed: 0.1965s/iter; left time: 3495.1208s
	iters: 200, epoch: 15 | loss: 1.2514355
	speed: 0.0491s/iter; left time: 868.9856s
Epoch: 15 cost time: 10.830299615859985
Epoch: 15, Steps: 208 | Train Loss: 1.033 Vali Loss: 4.896 Vali Acc: 0.108 Test Loss: 4.896 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.0068606
	speed: 0.1801s/iter; left time: 3165.5569s
	iters: 200, epoch: 16 | loss: 1.0434707
	speed: 0.0435s/iter; left time: 760.2008s
Epoch: 16 cost time: 9.466574907302856
Epoch: 16, Steps: 208 | Train Loss: 0.885 Vali Loss: 5.345 Vali Acc: 0.107 Test Loss: 5.345 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.0375167
	speed: 0.1811s/iter; left time: 3146.9464s
	iters: 200, epoch: 17 | loss: 1.2078663
	speed: 0.0504s/iter; left time: 871.2433s
Epoch: 17 cost time: 11.060741901397705
Epoch: 17, Steps: 208 | Train Loss: 0.800 Vali Loss: 5.364 Vali Acc: 0.097 Test Loss: 5.364 Test Acc: 0.097
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.2961150
	speed: 0.1859s/iter; left time: 3191.0645s
	iters: 200, epoch: 18 | loss: 0.9186510
	speed: 0.0508s/iter; left time: 866.8503s
Epoch: 18 cost time: 10.989574193954468
Epoch: 18, Steps: 208 | Train Loss: 0.679 Vali Loss: 5.716 Vali Acc: 0.100 Test Loss: 5.716 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.9937112
	speed: 0.1945s/iter; left time: 3298.8601s
	iters: 200, epoch: 19 | loss: 1.0999194
	speed: 0.0498s/iter; left time: 838.8507s
Epoch: 19 cost time: 10.856450319290161
Epoch: 19, Steps: 208 | Train Loss: 0.614 Vali Loss: 6.054 Vali Acc: 0.107 Test Loss: 6.054 Test Acc: 0.107
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.2785597
	speed: 0.1873s/iter; left time: 3137.7667s
	iters: 200, epoch: 20 | loss: 0.2451253
	speed: 0.0447s/iter; left time: 744.3584s
Epoch: 20 cost time: 9.871337890625
Epoch: 20, Steps: 208 | Train Loss: 0.547 Vali Loss: 6.359 Vali Acc: 0.100 Test Loss: 6.359 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.1114798
	speed: 0.1921s/iter; left time: 3177.4658s
	iters: 200, epoch: 21 | loss: 0.5953344
	speed: 0.0514s/iter; left time: 845.5640s
Epoch: 21 cost time: 11.400871276855469
Epoch: 21, Steps: 208 | Train Loss: 0.509 Vali Loss: 6.416 Vali Acc: 0.106 Test Loss: 6.416 Test Acc: 0.106
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.7172697
	speed: 0.1893s/iter; left time: 3092.0648s
	iters: 200, epoch: 22 | loss: 0.4121947
	speed: 0.0516s/iter; left time: 837.6860s
Epoch: 22 cost time: 11.128947019577026
Epoch: 22, Steps: 208 | Train Loss: 0.470 Vali Loss: 6.694 Vali Acc: 0.091 Test Loss: 6.694 Test Acc: 0.091
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.4614605
	speed: 0.1870s/iter; left time: 3015.7939s
	iters: 200, epoch: 23 | loss: 0.2492253
	speed: 0.0501s/iter; left time: 803.3814s
Epoch: 23 cost time: 11.061139106750488
Epoch: 23, Steps: 208 | Train Loss: 0.429 Vali Loss: 6.870 Vali Acc: 0.097 Test Loss: 6.870 Test Acc: 0.097
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10915597971965404
model parameter : 565931
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7725866
	speed: 0.0667s/iter; left time: 1379.8141s
	iters: 200, epoch: 1 | loss: 4.0195251
	speed: 0.0512s/iter; left time: 1054.9149s
Epoch: 1 cost time: 12.293798685073853
Epoch: 1, Steps: 208 | Train Loss: 3.748 Vali Loss: 3.684 Vali Acc: 0.055 Test Loss: 3.684 Test Acc: 0.055
Validation loss decreased (inf --> -0.054839).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6686063
	speed: 0.1933s/iter; left time: 3961.9522s
	iters: 200, epoch: 2 | loss: 3.8278906
	speed: 0.0504s/iter; left time: 1027.2866s
Epoch: 2 cost time: 10.84193205833435
Epoch: 2, Steps: 208 | Train Loss: 3.655 Vali Loss: 3.630 Vali Acc: 0.053 Test Loss: 3.630 Test Acc: 0.053
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.4640779
	speed: 0.1956s/iter; left time: 3967.5097s
	iters: 200, epoch: 3 | loss: 3.2014923
	speed: 0.0512s/iter; left time: 1034.2145s
Epoch: 3 cost time: 11.027135372161865
Epoch: 3, Steps: 208 | Train Loss: 3.532 Vali Loss: 3.631 Vali Acc: 0.059 Test Loss: 3.631 Test Acc: 0.059
Validation loss decreased (-0.054839 --> -0.058717).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.7917039
	speed: 0.1837s/iter; left time: 3687.5012s
	iters: 200, epoch: 4 | loss: 3.3046999
	speed: 0.0509s/iter; left time: 1017.2950s
Epoch: 4 cost time: 10.880563974380493
Epoch: 4, Steps: 208 | Train Loss: 3.479 Vali Loss: 3.496 Vali Acc: 0.069 Test Loss: 3.496 Test Acc: 0.069
Validation loss decreased (-0.058717 --> -0.068859).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.5621002
	speed: 0.2054s/iter; left time: 4081.0765s
	iters: 200, epoch: 5 | loss: 3.2477534
	speed: 0.0547s/iter; left time: 1081.1844s
Epoch: 5 cost time: 11.876255989074707
Epoch: 5, Steps: 208 | Train Loss: 3.372 Vali Loss: 3.591 Vali Acc: 0.069 Test Loss: 3.591 Test Acc: 0.069
Validation loss decreased (-0.068859 --> -0.069156).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0907707
	speed: 0.2051s/iter; left time: 4032.1400s
	iters: 200, epoch: 6 | loss: 3.0594106
	speed: 0.0533s/iter; left time: 1043.3551s
Epoch: 6 cost time: 11.736224889755249
Epoch: 6, Steps: 208 | Train Loss: 3.192 Vali Loss: 3.314 Vali Acc: 0.096 Test Loss: 3.314 Test Acc: 0.096
Validation loss decreased (-0.069156 --> -0.096299).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.0355554
	speed: 0.2061s/iter; left time: 4008.7369s
	iters: 200, epoch: 7 | loss: 2.8722610
	speed: 0.0547s/iter; left time: 1059.3810s
Epoch: 7 cost time: 11.722315549850464
Epoch: 7, Steps: 208 | Train Loss: 3.000 Vali Loss: 3.282 Vali Acc: 0.098 Test Loss: 3.282 Test Acc: 0.098
Validation loss decreased (-0.096299 --> -0.097790).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.3804915
	speed: 0.2078s/iter; left time: 3998.2404s
	iters: 200, epoch: 8 | loss: 2.9102199
	speed: 0.0547s/iter; left time: 1046.9204s
Epoch: 8 cost time: 11.783895254135132
Epoch: 8, Steps: 208 | Train Loss: 2.792 Vali Loss: 3.306 Vali Acc: 0.107 Test Loss: 3.306 Test Acc: 0.107
Validation loss decreased (-0.097790 --> -0.107333).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.4369385
	speed: 0.2067s/iter; left time: 3935.2049s
	iters: 200, epoch: 9 | loss: 2.1942539
	speed: 0.0544s/iter; left time: 1030.5680s
Epoch: 9 cost time: 11.853596448898315
Epoch: 9, Steps: 208 | Train Loss: 2.560 Vali Loss: 3.345 Vali Acc: 0.114 Test Loss: 3.345 Test Acc: 0.114
Validation loss decreased (-0.107333 --> -0.113894).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.3652549
	speed: 0.2054s/iter; left time: 3866.9489s
	iters: 200, epoch: 10 | loss: 2.9626470
	speed: 0.0480s/iter; left time: 899.5939s
Epoch: 10 cost time: 10.656458139419556
Epoch: 10, Steps: 208 | Train Loss: 2.333 Vali Loss: 3.363 Vali Acc: 0.109 Test Loss: 3.363 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.4722791
	speed: 0.1876s/iter; left time: 3493.8335s
	iters: 200, epoch: 11 | loss: 2.9833453
	speed: 0.0496s/iter; left time: 918.5608s
Epoch: 11 cost time: 10.972520112991333
Epoch: 11, Steps: 208 | Train Loss: 2.119 Vali Loss: 3.672 Vali Acc: 0.118 Test Loss: 3.672 Test Acc: 0.118
Validation loss decreased (-0.113894 --> -0.117470).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.8033915
	speed: 0.1852s/iter; left time: 3409.9531s
	iters: 200, epoch: 12 | loss: 1.7126341
	speed: 0.0489s/iter; left time: 894.9242s
Epoch: 12 cost time: 10.612778186798096
Epoch: 12, Steps: 208 | Train Loss: 1.864 Vali Loss: 3.768 Vali Acc: 0.120 Test Loss: 3.768 Test Acc: 0.120
Validation loss decreased (-0.117470 --> -0.119557).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.4887414
	speed: 0.1810s/iter; left time: 3295.7592s
	iters: 200, epoch: 13 | loss: 1.7341340
	speed: 0.0515s/iter; left time: 932.2612s
Epoch: 13 cost time: 10.496275901794434
Epoch: 13, Steps: 208 | Train Loss: 1.609 Vali Loss: 4.103 Vali Acc: 0.120 Test Loss: 4.103 Test Acc: 0.120
Validation loss decreased (-0.119557 --> -0.120150).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.4378831
	speed: 0.1887s/iter; left time: 3395.7842s
	iters: 200, epoch: 14 | loss: 1.4042642
	speed: 0.0511s/iter; left time: 915.0852s
Epoch: 14 cost time: 11.029347896575928
Epoch: 14, Steps: 208 | Train Loss: 1.367 Vali Loss: 4.336 Vali Acc: 0.112 Test Loss: 4.336 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.1515821
	speed: 0.1898s/iter; left time: 3375.9083s
	iters: 200, epoch: 15 | loss: 1.0271587
	speed: 0.0501s/iter; left time: 886.2683s
Epoch: 15 cost time: 10.807858943939209
Epoch: 15, Steps: 208 | Train Loss: 1.136 Vali Loss: 4.596 Vali Acc: 0.115 Test Loss: 4.596 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.7995344
	speed: 0.1905s/iter; left time: 3349.6681s
	iters: 200, epoch: 16 | loss: 1.4139984
	speed: 0.0515s/iter; left time: 899.9149s
Epoch: 16 cost time: 11.087167739868164
Epoch: 16, Steps: 208 | Train Loss: 0.961 Vali Loss: 4.805 Vali Acc: 0.114 Test Loss: 4.805 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.4844313
	speed: 0.1940s/iter; left time: 3370.8470s
	iters: 200, epoch: 17 | loss: 0.6747479
	speed: 0.0481s/iter; left time: 830.2999s
Epoch: 17 cost time: 10.565126895904541
Epoch: 17, Steps: 208 | Train Loss: 0.833 Vali Loss: 5.207 Vali Acc: 0.121 Test Loss: 5.207 Test Acc: 0.121
Validation loss decreased (-0.120150 --> -0.121332).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.5502920
	speed: 0.1836s/iter; left time: 3150.7279s
	iters: 200, epoch: 18 | loss: 0.9697695
	speed: 0.0495s/iter; left time: 844.9853s
Epoch: 18 cost time: 10.368089437484741
Epoch: 18, Steps: 208 | Train Loss: 0.709 Vali Loss: 5.326 Vali Acc: 0.117 Test Loss: 5.326 Test Acc: 0.117
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.2720598
	speed: 0.1920s/iter; left time: 3255.9148s
	iters: 200, epoch: 19 | loss: 0.3880639
	speed: 0.0517s/iter; left time: 871.1886s
Epoch: 19 cost time: 11.022108793258667
Epoch: 19, Steps: 208 | Train Loss: 0.616 Vali Loss: 5.506 Vali Acc: 0.115 Test Loss: 5.506 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0486474
	speed: 0.1903s/iter; left time: 3186.8692s
	iters: 200, epoch: 20 | loss: 0.6112437
	speed: 0.0520s/iter; left time: 865.0236s
Epoch: 20 cost time: 10.984861612319946
Epoch: 20, Steps: 208 | Train Loss: 0.556 Vali Loss: 6.025 Vali Acc: 0.118 Test Loss: 6.025 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.5934361
	speed: 0.1850s/iter; left time: 3059.5187s
	iters: 200, epoch: 21 | loss: 0.3299814
	speed: 0.0485s/iter; left time: 797.3283s
Epoch: 21 cost time: 10.643341064453125
Epoch: 21, Steps: 208 | Train Loss: 0.510 Vali Loss: 6.083 Vali Acc: 0.116 Test Loss: 6.083 Test Acc: 0.116
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.2833185
	speed: 0.1967s/iter; left time: 3213.2917s
	iters: 200, epoch: 22 | loss: 0.1804835
	speed: 0.0490s/iter; left time: 794.7607s
Epoch: 22 cost time: 10.591568231582642
Epoch: 22, Steps: 208 | Train Loss: 0.473 Vali Loss: 6.247 Vali Acc: 0.115 Test Loss: 6.247 Test Acc: 0.115
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.5157073
	speed: 0.1858s/iter; left time: 2995.4219s
	iters: 200, epoch: 23 | loss: 1.2405856
	speed: 0.0485s/iter; left time: 777.1378s
Epoch: 23 cost time: 10.758149147033691
Epoch: 23, Steps: 208 | Train Loss: 0.426 Vali Loss: 6.769 Vali Acc: 0.117 Test Loss: 6.769 Test Acc: 0.117
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.2657374
	speed: 0.1751s/iter; left time: 2787.1652s
	iters: 200, epoch: 24 | loss: 0.0573911
	speed: 0.0492s/iter; left time: 778.0294s
Epoch: 24 cost time: 10.646726608276367
Epoch: 24, Steps: 208 | Train Loss: 0.418 Vali Loss: 6.769 Vali Acc: 0.112 Test Loss: 6.769 Test Acc: 0.112
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.2650702
	speed: 0.1827s/iter; left time: 2869.5997s
	iters: 200, epoch: 25 | loss: 0.3467150
	speed: 0.0500s/iter; left time: 781.0281s
Epoch: 25 cost time: 10.83562445640564
Epoch: 25, Steps: 208 | Train Loss: 0.371 Vali Loss: 7.019 Vali Acc: 0.111 Test Loss: 7.019 Test Acc: 0.111
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.5080966
	speed: 0.1880s/iter; left time: 2914.4046s
	iters: 200, epoch: 26 | loss: 0.6699107
	speed: 0.0502s/iter; left time: 773.0945s
Epoch: 26 cost time: 10.927469253540039
Epoch: 26, Steps: 208 | Train Loss: 0.367 Vali Loss: 7.205 Vali Acc: 0.112 Test Loss: 7.205 Test Acc: 0.112
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.4315233
	speed: 0.1994s/iter; left time: 3048.9565s
	iters: 200, epoch: 27 | loss: 0.1107185
	speed: 0.0549s/iter; left time: 834.2500s
Epoch: 27 cost time: 11.863154649734497
Epoch: 27, Steps: 208 | Train Loss: 0.340 Vali Loss: 7.615 Vali Acc: 0.115 Test Loss: 7.615 Test Acc: 0.115
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12138383537130927
model parameter : 402315
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6174352
	speed: 0.0703s/iter; left time: 1456.1717s
	iters: 200, epoch: 1 | loss: 4.0825691
	speed: 0.0532s/iter; left time: 1095.4770s
Epoch: 1 cost time: 12.859306573867798
Epoch: 1, Steps: 208 | Train Loss: 3.761 Vali Loss: 3.667 Vali Acc: 0.056 Test Loss: 3.667 Test Acc: 0.056
Validation loss decreased (inf --> -0.056331).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2605739
	speed: 0.1976s/iter; left time: 4048.6279s
	iters: 200, epoch: 2 | loss: 3.3467953
	speed: 0.0546s/iter; left time: 1113.0588s
Epoch: 2 cost time: 11.811605453491211
Epoch: 2, Steps: 208 | Train Loss: 3.680 Vali Loss: 3.676 Vali Acc: 0.058 Test Loss: 3.676 Test Acc: 0.058
Validation loss decreased (-0.056331 --> -0.057524).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.2921703
	speed: 0.1992s/iter; left time: 4040.8044s
	iters: 200, epoch: 3 | loss: 3.6945562
	speed: 0.0535s/iter; left time: 1079.8910s
Epoch: 3 cost time: 11.16797137260437
Epoch: 3, Steps: 208 | Train Loss: 3.542 Vali Loss: 3.589 Vali Acc: 0.063 Test Loss: 3.589 Test Acc: 0.063
Validation loss decreased (-0.057524 --> -0.062595).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3570621
	speed: 0.1731s/iter; left time: 3475.1773s
	iters: 200, epoch: 4 | loss: 3.7468152
	speed: 0.0483s/iter; left time: 964.7529s
Epoch: 4 cost time: 9.878014326095581
Epoch: 4, Steps: 208 | Train Loss: 3.422 Vali Loss: 3.552 Vali Acc: 0.071 Test Loss: 3.552 Test Acc: 0.071
Validation loss decreased (-0.062595 --> -0.070647).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2108898
	speed: 0.1917s/iter; left time: 3809.0275s
	iters: 200, epoch: 5 | loss: 3.0998442
	speed: 0.0499s/iter; left time: 987.4414s
Epoch: 5 cost time: 11.146319150924683
Epoch: 5, Steps: 208 | Train Loss: 3.278 Vali Loss: 3.469 Vali Acc: 0.075 Test Loss: 3.469 Test Acc: 0.075
Validation loss decreased (-0.070647 --> -0.074824).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2986829
	speed: 0.1841s/iter; left time: 3619.8762s
	iters: 200, epoch: 6 | loss: 3.0702078
	speed: 0.0499s/iter; left time: 976.1558s
Epoch: 6 cost time: 11.056199550628662
Epoch: 6, Steps: 208 | Train Loss: 3.095 Vali Loss: 3.375 Vali Acc: 0.092 Test Loss: 3.375 Test Acc: 0.092
Validation loss decreased (-0.074824 --> -0.092421).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.8531573
	speed: 0.1843s/iter; left time: 3584.8632s
	iters: 200, epoch: 7 | loss: 2.8729341
	speed: 0.0479s/iter; left time: 926.6626s
Epoch: 7 cost time: 10.820358991622925
Epoch: 7, Steps: 208 | Train Loss: 2.907 Vali Loss: 3.457 Vali Acc: 0.090 Test Loss: 3.457 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.5736277
	speed: 0.1931s/iter; left time: 3715.4377s
	iters: 200, epoch: 8 | loss: 2.3677263
	speed: 0.0505s/iter; left time: 966.3835s
Epoch: 8 cost time: 11.382240533828735
Epoch: 8, Steps: 208 | Train Loss: 2.686 Vali Loss: 3.410 Vali Acc: 0.107 Test Loss: 3.410 Test Acc: 0.107
Validation loss decreased (-0.092421 --> -0.107034).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.3796332
	speed: 0.1871s/iter; left time: 3562.3665s
	iters: 200, epoch: 9 | loss: 2.7884710
	speed: 0.0514s/iter; left time: 974.2604s
Epoch: 9 cost time: 11.18204665184021
Epoch: 9, Steps: 208 | Train Loss: 2.469 Vali Loss: 3.468 Vali Acc: 0.098 Test Loss: 3.468 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.3299201
	speed: 0.1997s/iter; left time: 3760.5046s
	iters: 200, epoch: 10 | loss: 2.3963139
	speed: 0.0514s/iter; left time: 961.8154s
Epoch: 10 cost time: 11.339277982711792
Epoch: 10, Steps: 208 | Train Loss: 2.243 Vali Loss: 3.620 Vali Acc: 0.103 Test Loss: 3.620 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.8452977
	speed: 0.1827s/iter; left time: 3401.1607s
	iters: 200, epoch: 11 | loss: 1.7831755
	speed: 0.0514s/iter; left time: 952.8733s
Epoch: 11 cost time: 11.12917423248291
Epoch: 11, Steps: 208 | Train Loss: 2.006 Vali Loss: 3.677 Vali Acc: 0.107 Test Loss: 3.677 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 2.4462614
	speed: 0.1901s/iter; left time: 3500.4081s
	iters: 200, epoch: 12 | loss: 2.2321267
	speed: 0.0487s/iter; left time: 892.2613s
Epoch: 12 cost time: 10.992338180541992
Epoch: 12, Steps: 208 | Train Loss: 1.779 Vali Loss: 3.901 Vali Acc: 0.104 Test Loss: 3.901 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.9720488
	speed: 0.1811s/iter; left time: 3297.2156s
	iters: 200, epoch: 13 | loss: 1.5316591
	speed: 0.0510s/iter; left time: 923.3780s
Epoch: 13 cost time: 10.831720352172852
Epoch: 13, Steps: 208 | Train Loss: 1.572 Vali Loss: 4.101 Vali Acc: 0.109 Test Loss: 4.101 Test Acc: 0.109
Validation loss decreased (-0.107034 --> -0.108817).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.3067331
	speed: 0.1810s/iter; left time: 3257.0529s
	iters: 200, epoch: 14 | loss: 1.5072316
	speed: 0.0535s/iter; left time: 957.9505s
Epoch: 14 cost time: 11.39706540107727
Epoch: 14, Steps: 208 | Train Loss: 1.366 Vali Loss: 4.339 Vali Acc: 0.109 Test Loss: 4.339 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.1261032
	speed: 0.1934s/iter; left time: 3440.5253s
	iters: 200, epoch: 15 | loss: 1.1776992
	speed: 0.0481s/iter; left time: 849.9629s
Epoch: 15 cost time: 10.843891382217407
Epoch: 15, Steps: 208 | Train Loss: 1.162 Vali Loss: 4.579 Vali Acc: 0.102 Test Loss: 4.579 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.0360928
	speed: 0.1897s/iter; left time: 3334.3390s
	iters: 200, epoch: 16 | loss: 0.8801835
	speed: 0.0469s/iter; left time: 820.2478s
Epoch: 16 cost time: 10.59964656829834
Epoch: 16, Steps: 208 | Train Loss: 0.991 Vali Loss: 4.915 Vali Acc: 0.106 Test Loss: 4.915 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.0618660
	speed: 0.1856s/iter; left time: 3224.3617s
	iters: 200, epoch: 17 | loss: 0.9391611
	speed: 0.0510s/iter; left time: 880.4740s
Epoch: 17 cost time: 11.02529239654541
Epoch: 17, Steps: 208 | Train Loss: 0.870 Vali Loss: 5.062 Vali Acc: 0.107 Test Loss: 5.062 Test Acc: 0.107
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.7033103
	speed: 0.1958s/iter; left time: 3360.3506s
	iters: 200, epoch: 18 | loss: 0.9997997
	speed: 0.0490s/iter; left time: 836.7872s
Epoch: 18 cost time: 10.836772918701172
Epoch: 18, Steps: 208 | Train Loss: 0.771 Vali Loss: 5.423 Vali Acc: 0.109 Test Loss: 5.423 Test Acc: 0.109
Validation loss decreased (-0.108817 --> -0.109102).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.4857081
	speed: 0.1730s/iter; left time: 2932.9626s
	iters: 200, epoch: 19 | loss: 0.9432141
	speed: 0.0493s/iter; left time: 831.2493s
Epoch: 19 cost time: 10.759823322296143
Epoch: 19, Steps: 208 | Train Loss: 0.696 Vali Loss: 5.479 Vali Acc: 0.108 Test Loss: 5.479 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.8347923
	speed: 0.1818s/iter; left time: 3045.6703s
	iters: 200, epoch: 20 | loss: 0.1735904
	speed: 0.0489s/iter; left time: 814.0337s
Epoch: 20 cost time: 10.659359216690063
Epoch: 20, Steps: 208 | Train Loss: 0.623 Vali Loss: 5.827 Vali Acc: 0.114 Test Loss: 5.827 Test Acc: 0.114
Validation loss decreased (-0.109102 --> -0.114168).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.3923838
	speed: 0.1850s/iter; left time: 3060.4774s
	iters: 200, epoch: 21 | loss: 0.6311705
	speed: 0.0528s/iter; left time: 868.2605s
Epoch: 21 cost time: 11.436593532562256
Epoch: 21, Steps: 208 | Train Loss: 0.580 Vali Loss: 6.087 Vali Acc: 0.109 Test Loss: 6.087 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.6513932
	speed: 0.1944s/iter; left time: 3174.6834s
	iters: 200, epoch: 22 | loss: 0.7257689
	speed: 0.0544s/iter; left time: 882.7069s
Epoch: 22 cost time: 11.739628791809082
Epoch: 22, Steps: 208 | Train Loss: 0.543 Vali Loss: 6.549 Vali Acc: 0.113 Test Loss: 6.549 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.3935381
	speed: 0.2029s/iter; left time: 3271.7410s
	iters: 200, epoch: 23 | loss: 0.4987951
	speed: 0.0554s/iter; left time: 886.9857s
Epoch: 23 cost time: 11.815163373947144
Epoch: 23, Steps: 208 | Train Loss: 0.515 Vali Loss: 6.555 Vali Acc: 0.117 Test Loss: 6.555 Test Acc: 0.117
Validation loss decreased (-0.114168 --> -0.117143).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.6891823
	speed: 0.1938s/iter; left time: 3085.1329s
	iters: 200, epoch: 24 | loss: 0.8914622
	speed: 0.0508s/iter; left time: 804.2379s
Epoch: 24 cost time: 11.354820251464844
Epoch: 24, Steps: 208 | Train Loss: 0.468 Vali Loss: 6.664 Vali Acc: 0.107 Test Loss: 6.664 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.6253085
	speed: 0.1862s/iter; left time: 2924.9479s
	iters: 200, epoch: 25 | loss: 0.0533268
	speed: 0.0461s/iter; left time: 719.9320s
Epoch: 25 cost time: 10.028821468353271
Epoch: 25, Steps: 208 | Train Loss: 0.436 Vali Loss: 6.851 Vali Acc: 0.106 Test Loss: 6.851 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.2055911
	speed: 0.1941s/iter; left time: 3009.4663s
	iters: 200, epoch: 26 | loss: 0.3750487
	speed: 0.0476s/iter; left time: 732.8703s
Epoch: 26 cost time: 10.956086874008179
Epoch: 26, Steps: 208 | Train Loss: 0.411 Vali Loss: 6.973 Vali Acc: 0.111 Test Loss: 6.973 Test Acc: 0.111
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.5342778
	speed: 0.1923s/iter; left time: 2940.7698s
	iters: 200, epoch: 27 | loss: 0.9291520
	speed: 0.0539s/iter; left time: 818.2659s
Epoch: 27 cost time: 11.50188684463501
Epoch: 27, Steps: 208 | Train Loss: 0.394 Vali Loss: 7.129 Vali Acc: 0.108 Test Loss: 7.129 Test Acc: 0.108
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.1136314
	speed: 0.2056s/iter; left time: 3102.1411s
	iters: 200, epoch: 28 | loss: 0.6811120
	speed: 0.0549s/iter; left time: 822.9369s
Epoch: 28 cost time: 12.160611629486084
Epoch: 28, Steps: 208 | Train Loss: 0.377 Vali Loss: 7.119 Vali Acc: 0.110 Test Loss: 7.119 Test Acc: 0.110
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.5144053
	speed: 0.1729s/iter; left time: 2572.6995s
	iters: 200, epoch: 29 | loss: 0.5080845
	speed: 0.0466s/iter; left time: 688.7196s
Epoch: 29 cost time: 10.21596384048462
Epoch: 29, Steps: 208 | Train Loss: 0.366 Vali Loss: 7.860 Vali Acc: 0.105 Test Loss: 7.860 Test Acc: 0.105
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0999901
	speed: 0.1842s/iter; left time: 2701.3690s
	iters: 200, epoch: 30 | loss: 0.4525715
	speed: 0.0508s/iter; left time: 740.3229s
Epoch: 30 cost time: 10.903952836990356
Epoch: 30, Steps: 208 | Train Loss: 0.376 Vali Loss: 7.520 Vali Acc: 0.107 Test Loss: 7.520 Test Acc: 0.107
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.4377279
	speed: 0.1902s/iter; left time: 2749.9409s
	iters: 200, epoch: 31 | loss: 0.3814319
	speed: 0.0496s/iter; left time: 711.6708s
Epoch: 31 cost time: 11.04653811454773
Epoch: 31, Steps: 208 | Train Loss: 0.360 Vali Loss: 7.481 Vali Acc: 0.105 Test Loss: 7.481 Test Acc: 0.105
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.1634421
	speed: 0.1816s/iter; left time: 2588.5740s
	iters: 200, epoch: 32 | loss: 0.5619492
	speed: 0.0507s/iter; left time: 717.9850s
Epoch: 32 cost time: 10.82500433921814
Epoch: 32, Steps: 208 | Train Loss: 0.335 Vali Loss: 7.906 Vali Acc: 0.118 Test Loss: 7.906 Test Acc: 0.118
Validation loss decreased (-0.117143 --> -0.118024).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.1100923
	speed: 0.1850s/iter; left time: 2597.9446s
	iters: 200, epoch: 33 | loss: 0.4728620
	speed: 0.0514s/iter; left time: 716.0884s
Epoch: 33 cost time: 11.175191402435303
Epoch: 33, Steps: 208 | Train Loss: 0.319 Vali Loss: 7.714 Vali Acc: 0.102 Test Loss: 7.714 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 0.2485364
	speed: 0.1802s/iter; left time: 2493.1785s
	iters: 200, epoch: 34 | loss: 0.2573529
	speed: 0.0509s/iter; left time: 699.8640s
Epoch: 34 cost time: 11.06312108039856
Epoch: 34, Steps: 208 | Train Loss: 0.323 Vali Loss: 8.072 Vali Acc: 0.107 Test Loss: 8.072 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 0.1915739
	speed: 0.1848s/iter; left time: 2518.0945s
	iters: 200, epoch: 35 | loss: 0.0987595
	speed: 0.0503s/iter; left time: 681.0926s
Epoch: 35 cost time: 10.689681768417358
Epoch: 35, Steps: 208 | Train Loss: 0.324 Vali Loss: 8.121 Vali Acc: 0.114 Test Loss: 8.121 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 36 | loss: 0.4167164
	speed: 0.1908s/iter; left time: 2560.8857s
	iters: 200, epoch: 36 | loss: 0.3043514
	speed: 0.0494s/iter; left time: 657.8601s
Epoch: 36 cost time: 10.435488939285278
Epoch: 36, Steps: 208 | Train Loss: 0.317 Vali Loss: 8.002 Vali Acc: 0.102 Test Loss: 8.002 Test Acc: 0.102
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 37 | loss: 0.0163474
	speed: 0.1815s/iter; left time: 2397.9671s
	iters: 200, epoch: 37 | loss: 0.3340621
	speed: 0.0511s/iter; left time: 669.9057s
Epoch: 37 cost time: 11.024045944213867
Epoch: 37, Steps: 208 | Train Loss: 0.272 Vali Loss: 8.801 Vali Acc: 0.108 Test Loss: 8.801 Test Acc: 0.108
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 38 | loss: 0.1920149
	speed: 0.1808s/iter; left time: 2351.8368s
	iters: 200, epoch: 38 | loss: 0.0236009
	speed: 0.0494s/iter; left time: 637.1324s
Epoch: 38 cost time: 10.763744592666626
Epoch: 38, Steps: 208 | Train Loss: 0.273 Vali Loss: 8.620 Vali Acc: 0.106 Test Loss: 8.620 Test Acc: 0.106
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 39 | loss: 0.1567759
	speed: 0.1878s/iter; left time: 2403.7428s
	iters: 200, epoch: 39 | loss: 0.1497884
	speed: 0.0508s/iter; left time: 644.8565s
Epoch: 39 cost time: 11.063124895095825
Epoch: 39, Steps: 208 | Train Loss: 0.271 Vali Loss: 8.716 Vali Acc: 0.114 Test Loss: 8.716 Test Acc: 0.114
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 40 | loss: 0.0638363
	speed: 0.1938s/iter; left time: 2439.4724s
	iters: 200, epoch: 40 | loss: 0.2892549
	speed: 0.0511s/iter; left time: 638.0351s
Epoch: 40 cost time: 11.11643362045288
Epoch: 40, Steps: 208 | Train Loss: 0.265 Vali Loss: 8.774 Vali Acc: 0.114 Test Loss: 8.774 Test Acc: 0.114
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 41 | loss: 0.1849022
	speed: 0.2041s/iter; left time: 2526.4767s
	iters: 200, epoch: 41 | loss: 0.6500924
	speed: 0.0486s/iter; left time: 596.5851s
Epoch: 41 cost time: 10.75189757347107
Epoch: 41, Steps: 208 | Train Loss: 0.285 Vali Loss: 9.067 Vali Acc: 0.108 Test Loss: 9.067 Test Acc: 0.108
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 42 | loss: 0.5696754
	speed: 0.1886s/iter; left time: 2295.9068s
	iters: 200, epoch: 42 | loss: 0.5318515
	speed: 0.0493s/iter; left time: 594.9658s
Epoch: 42 cost time: 10.807188034057617
Epoch: 42, Steps: 208 | Train Loss: 0.245 Vali Loss: 9.018 Vali Acc: 0.108 Test Loss: 9.018 Test Acc: 0.108
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1181031911720847
model parameter : 401387
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7082577
	speed: 0.0644s/iter; left time: 1333.1827s
	iters: 200, epoch: 1 | loss: 3.9777255
	speed: 0.0494s/iter; left time: 1017.0395s
Epoch: 1 cost time: 11.847408533096313
Epoch: 1, Steps: 208 | Train Loss: 3.763 Vali Loss: 3.739 Vali Acc: 0.056 Test Loss: 3.739 Test Acc: 0.056
Validation loss decreased (inf --> -0.055734).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6604781
	speed: 0.1860s/iter; left time: 3810.9056s
	iters: 200, epoch: 2 | loss: 3.3831127
	speed: 0.0488s/iter; left time: 995.3578s
Epoch: 2 cost time: 10.660481691360474
Epoch: 2, Steps: 208 | Train Loss: 3.713 Vali Loss: 3.760 Vali Acc: 0.056 Test Loss: 3.760 Test Acc: 0.056
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.6086321
	speed: 0.1796s/iter; left time: 3643.6682s
	iters: 200, epoch: 3 | loss: 3.2858999
	speed: 0.0536s/iter; left time: 1082.6950s
Epoch: 3 cost time: 10.977106094360352
Epoch: 3, Steps: 208 | Train Loss: 3.574 Vali Loss: 3.645 Vali Acc: 0.063 Test Loss: 3.645 Test Acc: 0.063
Validation loss decreased (-0.055734 --> -0.062594).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.7244816
	speed: 0.2010s/iter; left time: 4034.7802s
	iters: 200, epoch: 4 | loss: 3.4714096
	speed: 0.0523s/iter; left time: 1045.1044s
Epoch: 4 cost time: 11.624164342880249
Epoch: 4, Steps: 208 | Train Loss: 3.422 Vali Loss: 3.668 Vali Acc: 0.054 Test Loss: 3.668 Test Acc: 0.054
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.4201334
	speed: 0.2052s/iter; left time: 4076.2972s
	iters: 200, epoch: 5 | loss: 3.3418863
	speed: 0.0519s/iter; left time: 1025.2539s
Epoch: 5 cost time: 11.394795417785645
Epoch: 5, Steps: 208 | Train Loss: 3.249 Vali Loss: 3.586 Vali Acc: 0.070 Test Loss: 3.586 Test Acc: 0.070
Validation loss decreased (-0.062594 --> -0.070349).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.8176892
	speed: 0.1889s/iter; left time: 3714.4446s
	iters: 200, epoch: 6 | loss: 3.2705288
	speed: 0.0521s/iter; left time: 1018.8839s
Epoch: 6 cost time: 11.388344764709473
Epoch: 6, Steps: 208 | Train Loss: 3.057 Vali Loss: 3.431 Vali Acc: 0.096 Test Loss: 3.431 Test Acc: 0.096
Validation loss decreased (-0.070349 --> -0.095701).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.2055876
	speed: 0.1992s/iter; left time: 3876.0082s
	iters: 200, epoch: 7 | loss: 2.8306577
	speed: 0.0537s/iter; left time: 1039.8573s
Epoch: 7 cost time: 11.66677212715149
Epoch: 7, Steps: 208 | Train Loss: 2.809 Vali Loss: 3.471 Vali Acc: 0.102 Test Loss: 3.471 Test Acc: 0.102
Validation loss decreased (-0.095701 --> -0.101665).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.3549542
	speed: 0.1965s/iter; left time: 3780.8788s
	iters: 200, epoch: 8 | loss: 2.2087376
	speed: 0.0537s/iter; left time: 1027.2837s
Epoch: 8 cost time: 11.505208969116211
Epoch: 8, Steps: 208 | Train Loss: 2.587 Vali Loss: 3.557 Vali Acc: 0.095 Test Loss: 3.557 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.4546883
	speed: 0.1972s/iter; left time: 3753.1663s
	iters: 200, epoch: 9 | loss: 1.9983552
	speed: 0.0513s/iter; left time: 971.9107s
Epoch: 9 cost time: 10.816809892654419
Epoch: 9, Steps: 208 | Train Loss: 2.342 Vali Loss: 3.603 Vali Acc: 0.108 Test Loss: 3.603 Test Acc: 0.108
Validation loss decreased (-0.101665 --> -0.107629).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.3629675
	speed: 0.1852s/iter; left time: 3486.5078s
	iters: 200, epoch: 10 | loss: 1.6943532
	speed: 0.0482s/iter; left time: 902.1796s
Epoch: 10 cost time: 10.306100130081177
Epoch: 10, Steps: 208 | Train Loss: 2.062 Vali Loss: 3.785 Vali Acc: 0.098 Test Loss: 3.785 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.9774697
	speed: 0.1446s/iter; left time: 2693.0988s
	iters: 200, epoch: 11 | loss: 1.8187320
	speed: 0.0458s/iter; left time: 848.3701s
Epoch: 11 cost time: 9.243610382080078
Epoch: 11, Steps: 208 | Train Loss: 1.804 Vali Loss: 3.887 Vali Acc: 0.105 Test Loss: 3.887 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.5913544
	speed: 0.1823s/iter; left time: 3357.4908s
	iters: 200, epoch: 12 | loss: 1.7728130
	speed: 0.0523s/iter; left time: 957.0441s
Epoch: 12 cost time: 11.249661207199097
Epoch: 12, Steps: 208 | Train Loss: 1.533 Vali Loss: 4.201 Vali Acc: 0.106 Test Loss: 4.201 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.2335395
	speed: 0.1973s/iter; left time: 3592.2260s
	iters: 200, epoch: 13 | loss: 1.3723991
	speed: 0.0501s/iter; left time: 906.5760s
Epoch: 13 cost time: 11.014694929122925
Epoch: 13, Steps: 208 | Train Loss: 1.276 Vali Loss: 4.471 Vali Acc: 0.107 Test Loss: 4.471 Test Acc: 0.107
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.7525169
	speed: 0.1836s/iter; left time: 3304.9712s
	iters: 200, epoch: 14 | loss: 1.1394116
	speed: 0.0514s/iter; left time: 920.1398s
Epoch: 14 cost time: 10.942697525024414
Epoch: 14, Steps: 208 | Train Loss: 1.053 Vali Loss: 4.813 Vali Acc: 0.108 Test Loss: 4.813 Test Acc: 0.108
Validation loss decreased (-0.107629 --> -0.108213).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.7400419
	speed: 0.1605s/iter; left time: 2855.0612s
	iters: 200, epoch: 15 | loss: 0.9187976
	speed: 0.0430s/iter; left time: 760.9260s
Epoch: 15 cost time: 9.208141088485718
Epoch: 15, Steps: 208 | Train Loss: 0.914 Vali Loss: 5.157 Vali Acc: 0.105 Test Loss: 5.157 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.4128795
	speed: 0.1796s/iter; left time: 3158.0506s
	iters: 200, epoch: 16 | loss: 0.6857764
	speed: 0.0489s/iter; left time: 854.9467s
Epoch: 16 cost time: 10.63644528388977
Epoch: 16, Steps: 208 | Train Loss: 0.774 Vali Loss: 5.494 Vali Acc: 0.099 Test Loss: 5.494 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.8247113
	speed: 0.1861s/iter; left time: 3233.3814s
	iters: 200, epoch: 17 | loss: 0.5887279
	speed: 0.0498s/iter; left time: 860.7300s
Epoch: 17 cost time: 10.843226671218872
Epoch: 17, Steps: 208 | Train Loss: 0.670 Vali Loss: 5.550 Vali Acc: 0.109 Test Loss: 5.550 Test Acc: 0.109
Validation loss decreased (-0.108213 --> -0.108802).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.2524773
	speed: 0.1884s/iter; left time: 3233.9520s
	iters: 200, epoch: 18 | loss: 0.6954758
	speed: 0.0490s/iter; left time: 836.9031s
Epoch: 18 cost time: 10.666974306106567
Epoch: 18, Steps: 208 | Train Loss: 0.589 Vali Loss: 5.934 Vali Acc: 0.106 Test Loss: 5.934 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.2721391
	speed: 0.1860s/iter; left time: 3153.6181s
	iters: 200, epoch: 19 | loss: 0.4549451
	speed: 0.0499s/iter; left time: 841.6493s
Epoch: 19 cost time: 10.818995237350464
Epoch: 19, Steps: 208 | Train Loss: 0.551 Vali Loss: 6.213 Vali Acc: 0.105 Test Loss: 6.213 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.2574861
	speed: 0.1947s/iter; left time: 3261.6006s
	iters: 200, epoch: 20 | loss: 0.6816572
	speed: 0.0510s/iter; left time: 848.9284s
Epoch: 20 cost time: 11.402868270874023
Epoch: 20, Steps: 208 | Train Loss: 0.480 Vali Loss: 6.470 Vali Acc: 0.107 Test Loss: 6.470 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.4537191
	speed: 0.1800s/iter; left time: 2977.1429s
	iters: 200, epoch: 21 | loss: 0.8991134
	speed: 0.0494s/iter; left time: 811.9051s
Epoch: 21 cost time: 10.724501132965088
Epoch: 21, Steps: 208 | Train Loss: 0.460 Vali Loss: 6.998 Vali Acc: 0.111 Test Loss: 6.998 Test Acc: 0.111
Validation loss decreased (-0.108802 --> -0.110875).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.6704853
	speed: 0.1793s/iter; left time: 2928.7055s
	iters: 200, epoch: 22 | loss: 0.4383987
	speed: 0.0501s/iter; left time: 813.4632s
Epoch: 22 cost time: 10.84659218788147
Epoch: 22, Steps: 208 | Train Loss: 0.430 Vali Loss: 6.983 Vali Acc: 0.104 Test Loss: 6.983 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.2900048
	speed: 0.1922s/iter; left time: 3099.8086s
	iters: 200, epoch: 23 | loss: 0.8737414
	speed: 0.0495s/iter; left time: 793.1544s
Epoch: 23 cost time: 10.97220253944397
Epoch: 23, Steps: 208 | Train Loss: 0.405 Vali Loss: 7.015 Vali Acc: 0.101 Test Loss: 7.015 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.1664609
	speed: 0.1915s/iter; left time: 3047.6442s
	iters: 200, epoch: 24 | loss: 0.2033894
	speed: 0.0500s/iter; left time: 790.5821s
Epoch: 24 cost time: 10.919285535812378
Epoch: 24, Steps: 208 | Train Loss: 0.370 Vali Loss: 7.232 Vali Acc: 0.102 Test Loss: 7.232 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.3869938
	speed: 0.1808s/iter; left time: 2840.2219s
	iters: 200, epoch: 25 | loss: 0.6452881
	speed: 0.0556s/iter; left time: 868.3833s
Epoch: 25 cost time: 12.091824293136597
Epoch: 25, Steps: 208 | Train Loss: 0.389 Vali Loss: 7.371 Vali Acc: 0.101 Test Loss: 7.371 Test Acc: 0.101
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.1702464
	speed: 0.1997s/iter; left time: 3095.3228s
	iters: 200, epoch: 26 | loss: 0.3648891
	speed: 0.0542s/iter; left time: 835.1801s
Epoch: 26 cost time: 11.87962794303894
Epoch: 26, Steps: 208 | Train Loss: 0.359 Vali Loss: 7.923 Vali Acc: 0.103 Test Loss: 7.923 Test Acc: 0.103
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0136499
	speed: 0.2084s/iter; left time: 3186.4813s
	iters: 200, epoch: 27 | loss: 0.4999914
	speed: 0.0544s/iter; left time: 827.2497s
Epoch: 27 cost time: 12.04509687423706
Epoch: 27, Steps: 208 | Train Loss: 0.329 Vali Loss: 7.687 Vali Acc: 0.104 Test Loss: 7.687 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.3976936
	speed: 0.2063s/iter; left time: 3112.3514s
	iters: 200, epoch: 28 | loss: 0.1517790
	speed: 0.0537s/iter; left time: 804.4664s
Epoch: 28 cost time: 11.64591360092163
Epoch: 28, Steps: 208 | Train Loss: 0.326 Vali Loss: 7.876 Vali Acc: 0.102 Test Loss: 7.876 Test Acc: 0.102
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.4460934
	speed: 0.2201s/iter; left time: 3274.1409s
	iters: 200, epoch: 29 | loss: 0.0902178
	speed: 0.0549s/iter; left time: 811.1105s
Epoch: 29 cost time: 11.954121828079224
Epoch: 29, Steps: 208 | Train Loss: 0.312 Vali Loss: 8.725 Vali Acc: 0.111 Test Loss: 8.725 Test Acc: 0.111
Validation loss decreased (-0.110875 --> -0.111156).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0295703
	speed: 0.2033s/iter; left time: 2982.1776s
	iters: 200, epoch: 30 | loss: 0.3118995
	speed: 0.0528s/iter; left time: 769.8102s
Epoch: 30 cost time: 11.516246795654297
Epoch: 30, Steps: 208 | Train Loss: 0.316 Vali Loss: 8.561 Vali Acc: 0.111 Test Loss: 8.561 Test Acc: 0.111
Validation loss decreased (-0.111156 --> -0.111158).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.4029538
	speed: 0.1792s/iter; left time: 2591.7045s
	iters: 200, epoch: 31 | loss: 0.3615923
	speed: 0.0483s/iter; left time: 693.8407s
Epoch: 31 cost time: 10.429466247558594
Epoch: 31, Steps: 208 | Train Loss: 0.296 Vali Loss: 8.436 Vali Acc: 0.106 Test Loss: 8.436 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.2023294
	speed: 0.1808s/iter; left time: 2576.9537s
	iters: 200, epoch: 32 | loss: 0.7703497
	speed: 0.0527s/iter; left time: 746.1677s
Epoch: 32 cost time: 11.11817717552185
Epoch: 32, Steps: 208 | Train Loss: 0.299 Vali Loss: 8.490 Vali Acc: 0.101 Test Loss: 8.490 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.4647676
	speed: 0.1857s/iter; left time: 2607.7324s
	iters: 200, epoch: 33 | loss: 0.2658104
	speed: 0.0495s/iter; left time: 690.2659s
Epoch: 33 cost time: 10.727107286453247
Epoch: 33, Steps: 208 | Train Loss: 0.294 Vali Loss: 8.359 Vali Acc: 0.101 Test Loss: 8.359 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.2706472
	speed: 0.1891s/iter; left time: 2616.8221s
	iters: 200, epoch: 34 | loss: 0.2203044
	speed: 0.0495s/iter; left time: 679.3252s
Epoch: 34 cost time: 10.58991265296936
Epoch: 34, Steps: 208 | Train Loss: 0.283 Vali Loss: 9.140 Vali Acc: 0.110 Test Loss: 9.140 Test Acc: 0.110
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.2123515
	speed: 0.1800s/iter; left time: 2452.8006s
	iters: 200, epoch: 35 | loss: 0.2962193
	speed: 0.0503s/iter; left time: 680.2303s
Epoch: 35 cost time: 10.923330307006836
Epoch: 35, Steps: 208 | Train Loss: 0.275 Vali Loss: 8.979 Vali Acc: 0.104 Test Loss: 8.979 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 0.2019617
	speed: 0.1887s/iter; left time: 2532.9326s
	iters: 200, epoch: 36 | loss: 0.0354791
	speed: 0.0480s/iter; left time: 639.7055s
Epoch: 36 cost time: 10.410213232040405
Epoch: 36, Steps: 208 | Train Loss: 0.265 Vali Loss: 8.606 Vali Acc: 0.109 Test Loss: 8.606 Test Acc: 0.109
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 0.0249503
	speed: 0.1786s/iter; left time: 2359.5474s
	iters: 200, epoch: 37 | loss: 0.1447673
	speed: 0.0523s/iter; left time: 686.3228s
Epoch: 37 cost time: 11.061586380004883
Epoch: 37, Steps: 208 | Train Loss: 0.238 Vali Loss: 9.571 Vali Acc: 0.105 Test Loss: 9.571 Test Acc: 0.105
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 0.2590322
	speed: 0.1909s/iter; left time: 2482.0604s
	iters: 200, epoch: 38 | loss: 0.2082030
	speed: 0.0511s/iter; left time: 659.0065s
Epoch: 38 cost time: 11.390536069869995
Epoch: 38, Steps: 208 | Train Loss: 0.268 Vali Loss: 9.328 Vali Acc: 0.104 Test Loss: 9.328 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 39 | loss: 0.1977160
	speed: 0.1914s/iter; left time: 2448.7276s
	iters: 200, epoch: 39 | loss: 0.0187023
	speed: 0.0481s/iter; left time: 610.1709s
Epoch: 39 cost time: 10.647666931152344
Epoch: 39, Steps: 208 | Train Loss: 0.223 Vali Loss: 9.174 Vali Acc: 0.104 Test Loss: 9.174 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 40 | loss: 0.4393285
	speed: 0.1794s/iter; left time: 2258.1962s
	iters: 200, epoch: 40 | loss: 0.2691512
	speed: 0.0512s/iter; left time: 639.2039s
Epoch: 40 cost time: 10.694487810134888
Epoch: 40, Steps: 208 | Train Loss: 0.240 Vali Loss: 9.644 Vali Acc: 0.104 Test Loss: 9.644 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11124366239188786
model parameter : 400459
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.4962757
	speed: 0.0678s/iter; left time: 1403.4053s
	iters: 200, epoch: 1 | loss: 3.4324679
	speed: 0.0496s/iter; left time: 1021.7927s
Epoch: 1 cost time: 12.192278861999512
Epoch: 1, Steps: 208 | Train Loss: 3.747 Vali Loss: 3.676 Vali Acc: 0.046 Test Loss: 3.676 Test Acc: 0.046
Validation loss decreased (inf --> -0.045594).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6338110
	speed: 0.1819s/iter; left time: 3728.0792s
	iters: 200, epoch: 2 | loss: 3.9909189
	speed: 0.0487s/iter; left time: 992.7288s
Epoch: 2 cost time: 10.65270447731018
Epoch: 2, Steps: 208 | Train Loss: 3.663 Vali Loss: 3.715 Vali Acc: 0.052 Test Loss: 3.715 Test Acc: 0.052
Validation loss decreased (-0.045594 --> -0.051857).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7718112
	speed: 0.1926s/iter; left time: 3907.4648s
	iters: 200, epoch: 3 | loss: 3.3708408
	speed: 0.0491s/iter; left time: 990.0755s
Epoch: 3 cost time: 10.547523498535156
Epoch: 3, Steps: 208 | Train Loss: 3.538 Vali Loss: 3.636 Vali Acc: 0.058 Test Loss: 3.636 Test Acc: 0.058
Validation loss decreased (-0.051857 --> -0.058419).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3479891
	speed: 0.1883s/iter; left time: 3779.9720s
	iters: 200, epoch: 4 | loss: 3.1463418
	speed: 0.0495s/iter; left time: 989.4424s
Epoch: 4 cost time: 10.902838468551636
Epoch: 4, Steps: 208 | Train Loss: 3.405 Vali Loss: 3.577 Vali Acc: 0.075 Test Loss: 3.577 Test Acc: 0.075
Validation loss decreased (-0.058419 --> -0.074823).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3417621
	speed: 0.1811s/iter; left time: 3599.2520s
	iters: 200, epoch: 5 | loss: 3.0804157
	speed: 0.0479s/iter; left time: 947.3796s
Epoch: 5 cost time: 10.495131254196167
Epoch: 5, Steps: 208 | Train Loss: 3.291 Vali Loss: 3.583 Vali Acc: 0.072 Test Loss: 3.583 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.8314199
	speed: 0.1849s/iter; left time: 3634.9687s
	iters: 200, epoch: 6 | loss: 3.3117676
	speed: 0.0500s/iter; left time: 977.7703s
Epoch: 6 cost time: 10.855779647827148
Epoch: 6, Steps: 208 | Train Loss: 3.130 Vali Loss: 3.493 Vali Acc: 0.093 Test Loss: 3.493 Test Acc: 0.093
Validation loss decreased (-0.074823 --> -0.093016).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.2192481
	speed: 0.2020s/iter; left time: 3930.1074s
	iters: 200, epoch: 7 | loss: 2.6343277
	speed: 0.0541s/iter; left time: 1046.8370s
Epoch: 7 cost time: 11.684376955032349
Epoch: 7, Steps: 208 | Train Loss: 2.926 Vali Loss: 3.529 Vali Acc: 0.088 Test Loss: 3.529 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 3.0058577
	speed: 0.2097s/iter; left time: 4035.1630s
	iters: 200, epoch: 8 | loss: 2.7232924
	speed: 0.0505s/iter; left time: 967.2901s
Epoch: 8 cost time: 11.646045446395874
Epoch: 8, Steps: 208 | Train Loss: 2.724 Vali Loss: 3.479 Vali Acc: 0.104 Test Loss: 3.479 Test Acc: 0.104
Validation loss decreased (-0.093016 --> -0.104349).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.6819131
	speed: 0.1923s/iter; left time: 3661.7001s
	iters: 200, epoch: 9 | loss: 2.6673546
	speed: 0.0536s/iter; left time: 1015.5177s
Epoch: 9 cost time: 11.229809999465942
Epoch: 9, Steps: 208 | Train Loss: 2.516 Vali Loss: 3.513 Vali Acc: 0.100 Test Loss: 3.513 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 3.0497127
	speed: 0.1962s/iter; left time: 3694.9000s
	iters: 200, epoch: 10 | loss: 2.4204390
	speed: 0.0541s/iter; left time: 1012.7607s
Epoch: 10 cost time: 11.500059604644775
Epoch: 10, Steps: 208 | Train Loss: 2.313 Vali Loss: 3.626 Vali Acc: 0.104 Test Loss: 3.626 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.9615368
	speed: 0.1821s/iter; left time: 3391.5700s
	iters: 200, epoch: 11 | loss: 2.0525923
	speed: 0.0435s/iter; left time: 806.5241s
Epoch: 11 cost time: 10.078637838363647
Epoch: 11, Steps: 208 | Train Loss: 2.064 Vali Loss: 3.836 Vali Acc: 0.103 Test Loss: 3.836 Test Acc: 0.103
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.8541141
	speed: 0.1613s/iter; left time: 2970.0851s
	iters: 200, epoch: 12 | loss: 2.1392238
	speed: 0.0452s/iter; left time: 827.6141s
Epoch: 12 cost time: 9.537445306777954
Epoch: 12, Steps: 208 | Train Loss: 1.812 Vali Loss: 3.975 Vali Acc: 0.109 Test Loss: 3.975 Test Acc: 0.109
Validation loss decreased (-0.104349 --> -0.109414).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.0177131
	speed: 0.1910s/iter; left time: 3477.3563s
	iters: 200, epoch: 13 | loss: 1.4500477
	speed: 0.0499s/iter; left time: 903.6351s
Epoch: 13 cost time: 10.780436277389526
Epoch: 13, Steps: 208 | Train Loss: 1.560 Vali Loss: 4.150 Vali Acc: 0.105 Test Loss: 4.150 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.4596353
	speed: 0.1755s/iter; left time: 3158.1162s
	iters: 200, epoch: 14 | loss: 1.7019069
	speed: 0.0505s/iter; left time: 903.3288s
Epoch: 14 cost time: 10.73186206817627
Epoch: 14, Steps: 208 | Train Loss: 1.325 Vali Loss: 4.392 Vali Acc: 0.104 Test Loss: 4.392 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.5360760
	speed: 0.1903s/iter; left time: 3385.8749s
	iters: 200, epoch: 15 | loss: 0.5703943
	speed: 0.0486s/iter; left time: 860.0744s
Epoch: 15 cost time: 10.59806513786316
Epoch: 15, Steps: 208 | Train Loss: 1.128 Vali Loss: 4.689 Vali Acc: 0.101 Test Loss: 4.689 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.1466736
	speed: 0.1907s/iter; left time: 3352.8311s
	iters: 200, epoch: 16 | loss: 1.0717536
	speed: 0.0482s/iter; left time: 842.1404s
Epoch: 16 cost time: 10.739772081375122
Epoch: 16, Steps: 208 | Train Loss: 0.954 Vali Loss: 4.828 Vali Acc: 0.105 Test Loss: 4.828 Test Acc: 0.105
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.6016198
	speed: 0.1804s/iter; left time: 3134.9383s
	iters: 200, epoch: 17 | loss: 1.2014405
	speed: 0.0497s/iter; left time: 857.9212s
Epoch: 17 cost time: 10.490585565567017
Epoch: 17, Steps: 208 | Train Loss: 0.820 Vali Loss: 5.134 Vali Acc: 0.110 Test Loss: 5.134 Test Acc: 0.110
Validation loss decreased (-0.109414 --> -0.110298).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.5693625
	speed: 0.1787s/iter; left time: 3067.5842s
	iters: 200, epoch: 18 | loss: 0.3787186
	speed: 0.0482s/iter; left time: 822.0896s
Epoch: 18 cost time: 10.627084493637085
Epoch: 18, Steps: 208 | Train Loss: 0.711 Vali Loss: 5.413 Vali Acc: 0.106 Test Loss: 5.413 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.5909011
	speed: 0.1795s/iter; left time: 3043.3797s
	iters: 200, epoch: 19 | loss: 0.3773815
	speed: 0.0482s/iter; left time: 812.3610s
Epoch: 19 cost time: 10.624087810516357
Epoch: 19, Steps: 208 | Train Loss: 0.618 Vali Loss: 5.641 Vali Acc: 0.101 Test Loss: 5.641 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.5485035
	speed: 0.1790s/iter; left time: 2997.2569s
	iters: 200, epoch: 20 | loss: 0.4277442
	speed: 0.0482s/iter; left time: 802.6021s
Epoch: 20 cost time: 10.494595766067505
Epoch: 20, Steps: 208 | Train Loss: 0.569 Vali Loss: 5.848 Vali Acc: 0.101 Test Loss: 5.848 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.7584679
	speed: 0.1850s/iter; left time: 3060.1446s
	iters: 200, epoch: 21 | loss: 0.5750729
	speed: 0.0494s/iter; left time: 811.4221s
Epoch: 21 cost time: 10.575496435165405
Epoch: 21, Steps: 208 | Train Loss: 0.514 Vali Loss: 6.233 Vali Acc: 0.103 Test Loss: 6.233 Test Acc: 0.103
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.6012553
	speed: 0.1838s/iter; left time: 3002.0657s
	iters: 200, epoch: 22 | loss: 0.5345863
	speed: 0.0486s/iter; left time: 789.2946s
Epoch: 22 cost time: 10.656735181808472
Epoch: 22, Steps: 208 | Train Loss: 0.502 Vali Loss: 6.455 Vali Acc: 0.099 Test Loss: 6.455 Test Acc: 0.099
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.5139711
	speed: 0.1788s/iter; left time: 2882.7911s
	iters: 200, epoch: 23 | loss: 0.2270926
	speed: 0.0484s/iter; left time: 775.1353s
Epoch: 23 cost time: 10.491222858428955
Epoch: 23, Steps: 208 | Train Loss: 0.458 Vali Loss: 6.795 Vali Acc: 0.111 Test Loss: 6.795 Test Acc: 0.111
Validation loss decreased (-0.110298 --> -0.110579).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.4617534
	speed: 0.1833s/iter; left time: 2917.1695s
	iters: 200, epoch: 24 | loss: 0.3462362
	speed: 0.0481s/iter; left time: 760.9306s
Epoch: 24 cost time: 10.435882806777954
Epoch: 24, Steps: 208 | Train Loss: 0.405 Vali Loss: 6.821 Vali Acc: 0.108 Test Loss: 6.821 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.6998152
	speed: 0.1737s/iter; left time: 2728.5723s
	iters: 200, epoch: 25 | loss: 0.5002900
	speed: 0.0488s/iter; left time: 761.3388s
Epoch: 25 cost time: 10.530959606170654
Epoch: 25, Steps: 208 | Train Loss: 0.399 Vali Loss: 7.140 Vali Acc: 0.103 Test Loss: 7.140 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.3473528
	speed: 0.1796s/iter; left time: 2783.3178s
	iters: 200, epoch: 26 | loss: 0.3095188
	speed: 0.0472s/iter; left time: 726.5546s
Epoch: 26 cost time: 10.321110486984253
Epoch: 26, Steps: 208 | Train Loss: 0.378 Vali Loss: 7.176 Vali Acc: 0.106 Test Loss: 7.176 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.1166707
	speed: 0.1781s/iter; left time: 2724.2156s
	iters: 200, epoch: 27 | loss: 0.1709113
	speed: 0.0502s/iter; left time: 763.0507s
Epoch: 27 cost time: 10.559717655181885
Epoch: 27, Steps: 208 | Train Loss: 0.359 Vali Loss: 7.508 Vali Acc: 0.102 Test Loss: 7.508 Test Acc: 0.102
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0735421
	speed: 0.1705s/iter; left time: 2572.0882s
	iters: 200, epoch: 28 | loss: 0.3898984
	speed: 0.0517s/iter; left time: 775.1958s
Epoch: 28 cost time: 10.790720462799072
Epoch: 28, Steps: 208 | Train Loss: 0.367 Vali Loss: 7.461 Vali Acc: 0.094 Test Loss: 7.461 Test Acc: 0.094
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.3363747
	speed: 0.2007s/iter; left time: 2985.5754s
	iters: 200, epoch: 29 | loss: 0.8944699
	speed: 0.0539s/iter; left time: 796.3627s
Epoch: 29 cost time: 11.444940328598022
Epoch: 29, Steps: 208 | Train Loss: 0.339 Vali Loss: 7.676 Vali Acc: 0.101 Test Loss: 7.676 Test Acc: 0.101
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.4332387
	speed: 0.1976s/iter; left time: 2899.0342s
	iters: 200, epoch: 30 | loss: 0.2678851
	speed: 0.0523s/iter; left time: 761.2480s
Epoch: 30 cost time: 10.96872615814209
Epoch: 30, Steps: 208 | Train Loss: 0.341 Vali Loss: 8.068 Vali Acc: 0.108 Test Loss: 8.068 Test Acc: 0.108
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.2249807
	speed: 0.1946s/iter; left time: 2814.6058s
	iters: 200, epoch: 31 | loss: 0.8690388
	speed: 0.0529s/iter; left time: 760.3351s
Epoch: 31 cost time: 11.617894411087036
Epoch: 31, Steps: 208 | Train Loss: 0.330 Vali Loss: 8.134 Vali Acc: 0.101 Test Loss: 8.134 Test Acc: 0.101
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.3045360
	speed: 0.2009s/iter; left time: 2863.0543s
	iters: 200, epoch: 32 | loss: 0.1952534
	speed: 0.0557s/iter; left time: 788.1417s
Epoch: 32 cost time: 11.943907499313354
Epoch: 32, Steps: 208 | Train Loss: 0.308 Vali Loss: 8.081 Vali Acc: 0.103 Test Loss: 8.081 Test Acc: 0.103
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.2679729
	speed: 0.2089s/iter; left time: 2933.4301s
	iters: 200, epoch: 33 | loss: 0.1417405
	speed: 0.0536s/iter; left time: 747.6699s
Epoch: 33 cost time: 12.014500617980957
Epoch: 33, Steps: 208 | Train Loss: 0.300 Vali Loss: 8.248 Vali Acc: 0.106 Test Loss: 8.248 Test Acc: 0.106
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11064718162839249
model parameter : 399531
model size : 2.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5954466
	speed: 0.0652s/iter; left time: 1349.1232s
	iters: 200, epoch: 1 | loss: 3.7404773
	speed: 0.0483s/iter; left time: 995.5595s
Epoch: 1 cost time: 11.861189842224121
Epoch: 1, Steps: 208 | Train Loss: 3.739 Vali Loss: 3.661 Vali Acc: 0.050 Test Loss: 3.661 Test Acc: 0.050
Validation loss decreased (inf --> -0.050366).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7667162
	speed: 0.1847s/iter; left time: 3785.2215s
	iters: 200, epoch: 2 | loss: 3.7857289
	speed: 0.0493s/iter; left time: 1005.2375s
Epoch: 2 cost time: 10.755443572998047
Epoch: 2, Steps: 208 | Train Loss: 3.740 Vali Loss: 3.746 Vali Acc: 0.067 Test Loss: 3.746 Test Acc: 0.067
Validation loss decreased (-0.050366 --> -0.066768).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.2459388
	speed: 0.1780s/iter; left time: 3610.1544s
	iters: 200, epoch: 3 | loss: 3.9667530
	speed: 0.0499s/iter; left time: 1006.9240s
Epoch: 3 cost time: 10.825911283493042
Epoch: 3, Steps: 208 | Train Loss: 3.636 Vali Loss: 3.687 Vali Acc: 0.068 Test Loss: 3.687 Test Acc: 0.068
Validation loss decreased (-0.066768 --> -0.067962).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.5392208
	speed: 0.1876s/iter; left time: 3767.1047s
	iters: 200, epoch: 4 | loss: 3.2295833
	speed: 0.0494s/iter; left time: 986.6760s
Epoch: 4 cost time: 10.74203634262085
Epoch: 4, Steps: 208 | Train Loss: 3.457 Vali Loss: 3.634 Vali Acc: 0.067 Test Loss: 3.634 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.1626415
	speed: 0.1881s/iter; left time: 3737.7858s
	iters: 200, epoch: 5 | loss: 3.7451684
	speed: 0.0477s/iter; left time: 943.9485s
Epoch: 5 cost time: 10.690518617630005
Epoch: 5, Steps: 208 | Train Loss: 3.289 Vali Loss: 3.612 Vali Acc: 0.074 Test Loss: 3.612 Test Acc: 0.074
Validation loss decreased (-0.067962 --> -0.074226).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.4533195
	speed: 0.1859s/iter; left time: 3654.1155s
	iters: 200, epoch: 6 | loss: 3.3084214
	speed: 0.0493s/iter; left time: 964.9543s
Epoch: 6 cost time: 10.617642879486084
Epoch: 6, Steps: 208 | Train Loss: 3.065 Vali Loss: 3.486 Vali Acc: 0.083 Test Loss: 3.486 Test Acc: 0.083
Validation loss decreased (-0.074226 --> -0.082876).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.7402201
	speed: 0.1958s/iter; left time: 3809.0647s
	iters: 200, epoch: 7 | loss: 2.8806891
	speed: 0.0497s/iter; left time: 961.0751s
Epoch: 7 cost time: 10.81811261177063
Epoch: 7, Steps: 208 | Train Loss: 2.848 Vali Loss: 3.488 Vali Acc: 0.095 Test Loss: 3.488 Test Acc: 0.095
Validation loss decreased (-0.082876 --> -0.095104).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.2975478
	speed: 0.1736s/iter; left time: 3341.8382s
	iters: 200, epoch: 8 | loss: 2.4612055
	speed: 0.0489s/iter; left time: 935.5395s
Epoch: 8 cost time: 10.574443340301514
Epoch: 8, Steps: 208 | Train Loss: 2.619 Vali Loss: 3.555 Vali Acc: 0.099 Test Loss: 3.555 Test Acc: 0.099
Validation loss decreased (-0.095104 --> -0.098980).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.7469499
	speed: 0.1797s/iter; left time: 3421.2623s
	iters: 200, epoch: 9 | loss: 2.3811431
	speed: 0.0428s/iter; left time: 809.6979s
Epoch: 9 cost time: 9.779030084609985
Epoch: 9, Steps: 208 | Train Loss: 2.409 Vali Loss: 3.536 Vali Acc: 0.098 Test Loss: 3.536 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.6030662
	speed: 0.1571s/iter; left time: 2958.9233s
	iters: 200, epoch: 10 | loss: 2.2558036
	speed: 0.0471s/iter; left time: 882.5778s
Epoch: 10 cost time: 9.70598840713501
Epoch: 10, Steps: 208 | Train Loss: 2.168 Vali Loss: 3.748 Vali Acc: 0.101 Test Loss: 3.748 Test Acc: 0.101
Validation loss decreased (-0.098980 --> -0.100470).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5148919
	speed: 0.1835s/iter; left time: 3416.0725s
	iters: 200, epoch: 11 | loss: 2.1275754
	speed: 0.0484s/iter; left time: 895.7137s
Epoch: 11 cost time: 10.79806137084961
Epoch: 11, Steps: 208 | Train Loss: 1.924 Vali Loss: 3.842 Vali Acc: 0.102 Test Loss: 3.842 Test Acc: 0.102
Validation loss decreased (-0.100470 --> -0.101960).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.8456959
	speed: 0.1847s/iter; left time: 3401.5510s
	iters: 200, epoch: 12 | loss: 1.9014539
	speed: 0.0499s/iter; left time: 913.3396s
Epoch: 12 cost time: 10.913328886032104
Epoch: 12, Steps: 208 | Train Loss: 1.694 Vali Loss: 3.976 Vali Acc: 0.106 Test Loss: 3.976 Test Acc: 0.106
Validation loss decreased (-0.101960 --> -0.106134).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.4738935
	speed: 0.1965s/iter; left time: 3576.4761s
	iters: 200, epoch: 13 | loss: 1.8580903
	speed: 0.0451s/iter; left time: 817.1150s
Epoch: 13 cost time: 10.253547668457031
Epoch: 13, Steps: 208 | Train Loss: 1.453 Vali Loss: 4.180 Vali Acc: 0.109 Test Loss: 4.180 Test Acc: 0.109
Validation loss decreased (-0.106134 --> -0.108816).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.8079658
	speed: 0.1859s/iter; left time: 3345.9837s
	iters: 200, epoch: 14 | loss: 1.5846870
	speed: 0.0475s/iter; left time: 849.2937s
Epoch: 14 cost time: 10.757696866989136
Epoch: 14, Steps: 208 | Train Loss: 1.233 Vali Loss: 4.386 Vali Acc: 0.109 Test Loss: 4.386 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.9106311
	speed: 0.1877s/iter; left time: 3338.8668s
	iters: 200, epoch: 15 | loss: 0.8444576
	speed: 0.0529s/iter; left time: 935.9028s
Epoch: 15 cost time: 11.114435911178589
Epoch: 15, Steps: 208 | Train Loss: 1.027 Vali Loss: 4.589 Vali Acc: 0.110 Test Loss: 4.589 Test Acc: 0.110
Validation loss decreased (-0.108816 --> -0.110005).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.6091450
	speed: 0.1982s/iter; left time: 3484.4092s
	iters: 200, epoch: 16 | loss: 0.7941454
	speed: 0.0535s/iter; left time: 935.6097s
Epoch: 16 cost time: 11.674598693847656
Epoch: 16, Steps: 208 | Train Loss: 0.872 Vali Loss: 4.957 Vali Acc: 0.109 Test Loss: 4.957 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.8234940
	speed: 0.2088s/iter; left time: 3628.0575s
	iters: 200, epoch: 17 | loss: 0.5853266
	speed: 0.0541s/iter; left time: 934.1578s
Epoch: 17 cost time: 11.821290969848633
Epoch: 17, Steps: 208 | Train Loss: 0.767 Vali Loss: 5.233 Vali Acc: 0.113 Test Loss: 5.233 Test Acc: 0.113
Validation loss decreased (-0.110005 --> -0.113279).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.6559904
	speed: 0.2031s/iter; left time: 3486.4168s
	iters: 200, epoch: 18 | loss: 0.8083290
	speed: 0.0552s/iter; left time: 941.7538s
Epoch: 18 cost time: 12.095948934555054
Epoch: 18, Steps: 208 | Train Loss: 0.675 Vali Loss: 5.432 Vali Acc: 0.107 Test Loss: 5.432 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.4742721
	speed: 0.2066s/iter; left time: 3502.9265s
	iters: 200, epoch: 19 | loss: 0.5004966
	speed: 0.0548s/iter; left time: 923.0029s
Epoch: 19 cost time: 12.028184175491333
Epoch: 19, Steps: 208 | Train Loss: 0.602 Vali Loss: 5.726 Vali Acc: 0.120 Test Loss: 5.726 Test Acc: 0.120
Validation loss decreased (-0.113279 --> -0.119537).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.3854022
	speed: 0.1867s/iter; left time: 3126.7828s
	iters: 200, epoch: 20 | loss: 0.5802084
	speed: 0.0446s/iter; left time: 742.3865s
Epoch: 20 cost time: 9.83380913734436
Epoch: 20, Steps: 208 | Train Loss: 0.545 Vali Loss: 5.890 Vali Acc: 0.119 Test Loss: 5.890 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.4986673
	speed: 0.1716s/iter; left time: 2838.7358s
	iters: 200, epoch: 21 | loss: 0.7282804
	speed: 0.0505s/iter; left time: 830.0951s
Epoch: 21 cost time: 11.037453651428223
Epoch: 21, Steps: 208 | Train Loss: 0.486 Vali Loss: 6.185 Vali Acc: 0.114 Test Loss: 6.185 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.4030924
	speed: 0.1818s/iter; left time: 2968.7909s
	iters: 200, epoch: 22 | loss: 0.7664818
	speed: 0.0480s/iter; left time: 779.8453s
Epoch: 22 cost time: 10.649327754974365
Epoch: 22, Steps: 208 | Train Loss: 0.451 Vali Loss: 6.419 Vali Acc: 0.109 Test Loss: 6.419 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.5827500
	speed: 0.1834s/iter; left time: 2956.7863s
	iters: 200, epoch: 23 | loss: 0.3008245
	speed: 0.0490s/iter; left time: 784.5277s
Epoch: 23 cost time: 10.785945415496826
Epoch: 23, Steps: 208 | Train Loss: 0.408 Vali Loss: 6.730 Vali Acc: 0.109 Test Loss: 6.730 Test Acc: 0.109
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.2969574
	speed: 0.1892s/iter; left time: 3012.2472s
	iters: 200, epoch: 24 | loss: 0.1652617
	speed: 0.0500s/iter; left time: 790.9018s
Epoch: 24 cost time: 10.833221673965454
Epoch: 24, Steps: 208 | Train Loss: 0.393 Vali Loss: 6.743 Vali Acc: 0.109 Test Loss: 6.743 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.1145360
	speed: 0.1842s/iter; left time: 2893.4796s
	iters: 200, epoch: 25 | loss: 0.3071418
	speed: 0.0506s/iter; left time: 789.2197s
Epoch: 25 cost time: 11.019704103469849
Epoch: 25, Steps: 208 | Train Loss: 0.356 Vali Loss: 7.138 Vali Acc: 0.115 Test Loss: 7.138 Test Acc: 0.115
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.3639723
	speed: 0.1837s/iter; left time: 2847.6352s
	iters: 200, epoch: 26 | loss: 0.1426686
	speed: 0.0491s/iter; left time: 755.8966s
Epoch: 26 cost time: 10.858322620391846
Epoch: 26, Steps: 208 | Train Loss: 0.343 Vali Loss: 7.308 Vali Acc: 0.106 Test Loss: 7.308 Test Acc: 0.106
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.1768677
	speed: 0.1878s/iter; left time: 2872.1800s
	iters: 200, epoch: 27 | loss: 0.5451217
	speed: 0.0483s/iter; left time: 734.1870s
Epoch: 27 cost time: 10.729304313659668
Epoch: 27, Steps: 208 | Train Loss: 0.356 Vali Loss: 7.363 Vali Acc: 0.112 Test Loss: 7.363 Test Acc: 0.112
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.2074993
	speed: 0.1871s/iter; left time: 2822.8505s
	iters: 200, epoch: 28 | loss: 0.3499125
	speed: 0.0495s/iter; left time: 741.5116s
Epoch: 28 cost time: 10.619497299194336
Epoch: 28, Steps: 208 | Train Loss: 0.336 Vali Loss: 7.551 Vali Acc: 0.105 Test Loss: 7.551 Test Acc: 0.105
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.2726252
	speed: 0.1796s/iter; left time: 2671.2993s
	iters: 200, epoch: 29 | loss: 0.4801139
	speed: 0.0503s/iter; left time: 743.8747s
Epoch: 29 cost time: 10.914581298828125
Epoch: 29, Steps: 208 | Train Loss: 0.330 Vali Loss: 7.602 Vali Acc: 0.098 Test Loss: 7.602 Test Acc: 0.098
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11959439308082315
model parameter : 319115
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5007608
	speed: 0.0646s/iter; left time: 1336.2732s
	iters: 200, epoch: 1 | loss: 3.8660860
	speed: 0.0491s/iter; left time: 1010.5712s
Epoch: 1 cost time: 11.821985483169556
Epoch: 1, Steps: 208 | Train Loss: 3.753 Vali Loss: 3.716 Vali Acc: 0.050 Test Loss: 3.716 Test Acc: 0.050
Validation loss decreased (inf --> -0.049769).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6112418
	speed: 0.1878s/iter; left time: 3848.3837s
	iters: 200, epoch: 2 | loss: 3.9428561
	speed: 0.0495s/iter; left time: 1008.9310s
Epoch: 2 cost time: 10.700931072235107
Epoch: 2, Steps: 208 | Train Loss: 3.685 Vali Loss: 3.721 Vali Acc: 0.065 Test Loss: 3.721 Test Acc: 0.065
Validation loss decreased (-0.049769 --> -0.065277).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4800847
	speed: 0.1909s/iter; left time: 3873.3790s
	iters: 200, epoch: 3 | loss: 4.1139531
	speed: 0.0492s/iter; left time: 993.4376s
Epoch: 3 cost time: 10.622846126556396
Epoch: 3, Steps: 208 | Train Loss: 3.566 Vali Loss: 3.600 Vali Acc: 0.058 Test Loss: 3.600 Test Acc: 0.058
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.4946938
	speed: 0.1837s/iter; left time: 3687.3930s
	iters: 200, epoch: 4 | loss: 3.6592760
	speed: 0.0487s/iter; left time: 972.7112s
Epoch: 4 cost time: 10.504153490066528
Epoch: 4, Steps: 208 | Train Loss: 3.447 Vali Loss: 3.608 Vali Acc: 0.054 Test Loss: 3.608 Test Acc: 0.054
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 3.3039546
	speed: 0.1679s/iter; left time: 3335.1903s
	iters: 200, epoch: 5 | loss: 3.6196301
	speed: 0.0500s/iter; left time: 987.9784s
Epoch: 5 cost time: 10.712969541549683
Epoch: 5, Steps: 208 | Train Loss: 3.346 Vali Loss: 3.508 Vali Acc: 0.072 Test Loss: 3.508 Test Acc: 0.072
Validation loss decreased (-0.065277 --> -0.072139).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.9136572
	speed: 0.1833s/iter; left time: 3603.5646s
	iters: 200, epoch: 6 | loss: 3.4590864
	speed: 0.0490s/iter; left time: 958.3887s
Epoch: 6 cost time: 10.737190008163452
Epoch: 6, Steps: 208 | Train Loss: 3.174 Vali Loss: 3.383 Vali Acc: 0.086 Test Loss: 3.383 Test Acc: 0.086
Validation loss decreased (-0.072139 --> -0.085859).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.2337680
	speed: 0.1810s/iter; left time: 3521.5423s
	iters: 200, epoch: 7 | loss: 3.2555594
	speed: 0.0549s/iter; left time: 1063.1250s
Epoch: 7 cost time: 11.568815469741821
Epoch: 7, Steps: 208 | Train Loss: 2.979 Vali Loss: 3.352 Vali Acc: 0.102 Test Loss: 3.352 Test Acc: 0.102
Validation loss decreased (-0.085859 --> -0.101666).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.6916575
	speed: 0.2078s/iter; left time: 3998.2427s
	iters: 200, epoch: 8 | loss: 2.1580966
	speed: 0.0533s/iter; left time: 1020.5415s
Epoch: 8 cost time: 11.654611825942993
Epoch: 8, Steps: 208 | Train Loss: 2.756 Vali Loss: 3.393 Vali Acc: 0.093 Test Loss: 3.393 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.9675407
	speed: 0.2072s/iter; left time: 3943.6801s
	iters: 200, epoch: 9 | loss: 2.6369815
	speed: 0.0539s/iter; left time: 1020.0646s
Epoch: 9 cost time: 11.91909146308899
Epoch: 9, Steps: 208 | Train Loss: 2.572 Vali Loss: 3.373 Vali Acc: 0.109 Test Loss: 3.373 Test Acc: 0.109
Validation loss decreased (-0.101666 --> -0.108526).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.2686713
	speed: 0.2024s/iter; left time: 3810.9776s
	iters: 200, epoch: 10 | loss: 2.9951432
	speed: 0.0543s/iter; left time: 1017.5210s
Epoch: 10 cost time: 11.745147228240967
Epoch: 10, Steps: 208 | Train Loss: 2.358 Vali Loss: 3.545 Vali Acc: 0.105 Test Loss: 3.545 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.9667983
	speed: 0.1970s/iter; left time: 3668.4604s
	iters: 200, epoch: 11 | loss: 2.1089754
	speed: 0.0547s/iter; left time: 1012.5578s
Epoch: 11 cost time: 11.81304407119751
Epoch: 11, Steps: 208 | Train Loss: 2.134 Vali Loss: 3.603 Vali Acc: 0.102 Test Loss: 3.603 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.5555252
	speed: 0.1971s/iter; left time: 3629.1527s
	iters: 200, epoch: 12 | loss: 1.9034473
	speed: 0.0544s/iter; left time: 996.8654s
Epoch: 12 cost time: 11.727323055267334
Epoch: 12, Steps: 208 | Train Loss: 1.918 Vali Loss: 3.771 Vali Acc: 0.105 Test Loss: 3.771 Test Acc: 0.105
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.6265391
	speed: 0.1872s/iter; left time: 3407.7134s
	iters: 200, epoch: 13 | loss: 1.3089336
	speed: 0.0515s/iter; left time: 932.9022s
Epoch: 13 cost time: 10.879256248474121
Epoch: 13, Steps: 208 | Train Loss: 1.666 Vali Loss: 4.060 Vali Acc: 0.114 Test Loss: 4.060 Test Acc: 0.114
Validation loss decreased (-0.108526 --> -0.113589).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.2573885
	speed: 0.1856s/iter; left time: 3339.5302s
	iters: 200, epoch: 14 | loss: 0.9532732
	speed: 0.0482s/iter; left time: 863.4262s
Epoch: 14 cost time: 10.520604610443115
Epoch: 14, Steps: 208 | Train Loss: 1.435 Vali Loss: 4.445 Vali Acc: 0.112 Test Loss: 4.445 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.6837643
	speed: 0.1820s/iter; left time: 3237.1774s
	iters: 200, epoch: 15 | loss: 1.0553535
	speed: 0.0480s/iter; left time: 848.8595s
Epoch: 15 cost time: 10.625199794769287
Epoch: 15, Steps: 208 | Train Loss: 1.220 Vali Loss: 4.442 Vali Acc: 0.115 Test Loss: 4.442 Test Acc: 0.115
Validation loss decreased (-0.113589 --> -0.114480).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.0539950
	speed: 0.1762s/iter; left time: 3097.3519s
	iters: 200, epoch: 16 | loss: 0.7408613
	speed: 0.0486s/iter; left time: 850.1650s
Epoch: 16 cost time: 10.236212015151978
Epoch: 16, Steps: 208 | Train Loss: 1.052 Vali Loss: 4.822 Vali Acc: 0.118 Test Loss: 4.822 Test Acc: 0.118
Validation loss decreased (-0.114480 --> -0.117458).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.0687629
	speed: 0.1782s/iter; left time: 3096.0553s
	iters: 200, epoch: 17 | loss: 1.3189833
	speed: 0.0501s/iter; left time: 864.7578s
Epoch: 17 cost time: 10.76436471939087
Epoch: 17, Steps: 208 | Train Loss: 0.903 Vali Loss: 5.057 Vali Acc: 0.109 Test Loss: 5.057 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.8563981
	speed: 0.1834s/iter; left time: 3147.8796s
	iters: 200, epoch: 18 | loss: 0.8239747
	speed: 0.0475s/iter; left time: 810.2796s
Epoch: 18 cost time: 10.329423904418945
Epoch: 18, Steps: 208 | Train Loss: 0.764 Vali Loss: 5.388 Vali Acc: 0.117 Test Loss: 5.388 Test Acc: 0.117
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.5076050
	speed: 0.1724s/iter; left time: 2922.8471s
	iters: 200, epoch: 19 | loss: 0.5057397
	speed: 0.0400s/iter; left time: 675.0339s
Epoch: 19 cost time: 9.274933338165283
Epoch: 19, Steps: 208 | Train Loss: 0.680 Vali Loss: 5.653 Vali Acc: 0.121 Test Loss: 5.653 Test Acc: 0.121
Validation loss decreased (-0.117458 --> -0.121029).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.1757642
	speed: 0.1661s/iter; left time: 2782.7790s
	iters: 200, epoch: 20 | loss: 0.2699569
	speed: 0.0469s/iter; left time: 780.1548s
Epoch: 20 cost time: 10.29570460319519
Epoch: 20, Steps: 208 | Train Loss: 0.601 Vali Loss: 6.043 Vali Acc: 0.115 Test Loss: 6.043 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.1568733
	speed: 0.1813s/iter; left time: 2998.7079s
	iters: 200, epoch: 21 | loss: 0.6648906
	speed: 0.0474s/iter; left time: 778.6708s
Epoch: 21 cost time: 10.580665826797485
Epoch: 21, Steps: 208 | Train Loss: 0.571 Vali Loss: 6.195 Vali Acc: 0.119 Test Loss: 6.195 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.4238727
	speed: 0.1648s/iter; left time: 2692.0613s
	iters: 200, epoch: 22 | loss: 0.2288788
	speed: 0.0403s/iter; left time: 654.6215s
Epoch: 22 cost time: 9.01327395439148
Epoch: 22, Steps: 208 | Train Loss: 0.507 Vali Loss: 6.155 Vali Acc: 0.112 Test Loss: 6.155 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.3882395
	speed: 0.1721s/iter; left time: 2775.0028s
	iters: 200, epoch: 23 | loss: 0.3398967
	speed: 0.0484s/iter; left time: 774.9194s
Epoch: 23 cost time: 10.489712953567505
Epoch: 23, Steps: 208 | Train Loss: 0.502 Vali Loss: 6.372 Vali Acc: 0.108 Test Loss: 6.372 Test Acc: 0.108
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.4902811
	speed: 0.1859s/iter; left time: 2958.3085s
	iters: 200, epoch: 24 | loss: 0.7041323
	speed: 0.0512s/iter; left time: 809.4954s
Epoch: 24 cost time: 10.951212167739868
Epoch: 24, Steps: 208 | Train Loss: 0.450 Vali Loss: 6.808 Vali Acc: 0.115 Test Loss: 6.808 Test Acc: 0.115
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.3078148
	speed: 0.1793s/iter; left time: 2817.2415s
	iters: 200, epoch: 25 | loss: 0.4474818
	speed: 0.0477s/iter; left time: 744.5340s
Epoch: 25 cost time: 10.615816116333008
Epoch: 25, Steps: 208 | Train Loss: 0.432 Vali Loss: 6.908 Vali Acc: 0.112 Test Loss: 6.908 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.8436177
	speed: 0.1724s/iter; left time: 2673.0659s
	iters: 200, epoch: 26 | loss: 0.2810997
	speed: 0.0495s/iter; left time: 761.6670s
Epoch: 26 cost time: 10.718981742858887
Epoch: 26, Steps: 208 | Train Loss: 0.373 Vali Loss: 7.304 Vali Acc: 0.110 Test Loss: 7.304 Test Acc: 0.110
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.4142325
	speed: 0.1825s/iter; left time: 2791.4153s
	iters: 200, epoch: 27 | loss: 0.2771676
	speed: 0.0496s/iter; left time: 754.0681s
Epoch: 27 cost time: 10.584082841873169
Epoch: 27, Steps: 208 | Train Loss: 0.367 Vali Loss: 7.156 Vali Acc: 0.115 Test Loss: 7.156 Test Acc: 0.115
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.1272398
	speed: 0.1872s/iter; left time: 2823.9844s
	iters: 200, epoch: 28 | loss: 0.1412030
	speed: 0.0535s/iter; left time: 802.2118s
Epoch: 28 cost time: 11.525047302246094
Epoch: 28, Steps: 208 | Train Loss: 0.352 Vali Loss: 7.597 Vali Acc: 0.118 Test Loss: 7.597 Test Acc: 0.118
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.6045859
	speed: 0.1999s/iter; left time: 2974.4397s
	iters: 200, epoch: 29 | loss: 0.4426263
	speed: 0.0537s/iter; left time: 794.0479s
Epoch: 29 cost time: 11.701958417892456
Epoch: 29, Steps: 208 | Train Loss: 0.340 Vali Loss: 7.271 Vali Acc: 0.114 Test Loss: 7.271 Test Acc: 0.114
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12108559498956159
model parameter : 318187
model size : 1.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7159071
	speed: 0.0668s/iter; left time: 1383.8397s
	iters: 200, epoch: 1 | loss: 3.1051271
	speed: 0.0543s/iter; left time: 1118.7197s
Epoch: 1 cost time: 12.61348032951355
Epoch: 1, Steps: 208 | Train Loss: 3.741 Vali Loss: 3.806 Vali Acc: 0.048 Test Loss: 3.806 Test Acc: 0.048
Validation loss decreased (inf --> -0.047979).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.1251194
	speed: 0.1963s/iter; left time: 4023.4751s
	iters: 200, epoch: 2 | loss: 3.8013909
	speed: 0.0515s/iter; left time: 1049.4914s
Epoch: 2 cost time: 11.457450151443481
Epoch: 2, Steps: 208 | Train Loss: 3.716 Vali Loss: 3.889 Vali Acc: 0.063 Test Loss: 3.889 Test Acc: 0.063
Validation loss decreased (-0.047979 --> -0.062592).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.2545605
	speed: 0.2022s/iter; left time: 4100.7093s
	iters: 200, epoch: 3 | loss: 3.3934343
	speed: 0.0528s/iter; left time: 1065.3153s
Epoch: 3 cost time: 11.55699372291565
Epoch: 3, Steps: 208 | Train Loss: 3.649 Vali Loss: 3.708 Vali Acc: 0.064 Test Loss: 3.708 Test Acc: 0.064
Validation loss decreased (-0.062592 --> -0.063786).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.6825788
	speed: 0.1788s/iter; left time: 3590.5666s
	iters: 200, epoch: 4 | loss: 3.5424416
	speed: 0.0488s/iter; left time: 974.1810s
Epoch: 4 cost time: 10.522926568984985
Epoch: 4, Steps: 208 | Train Loss: 3.533 Vali Loss: 3.669 Vali Acc: 0.066 Test Loss: 3.669 Test Acc: 0.066
Validation loss decreased (-0.063786 --> -0.065874).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.0862515
	speed: 0.1707s/iter; left time: 3390.9261s
	iters: 200, epoch: 5 | loss: 3.0857999
	speed: 0.0506s/iter; left time: 1001.2789s
Epoch: 5 cost time: 10.649930000305176
Epoch: 5, Steps: 208 | Train Loss: 3.347 Vali Loss: 3.645 Vali Acc: 0.064 Test Loss: 3.645 Test Acc: 0.064
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.9065030
	speed: 0.1871s/iter; left time: 3677.6180s
	iters: 200, epoch: 6 | loss: 3.6118989
	speed: 0.0479s/iter; left time: 937.0464s
Epoch: 6 cost time: 10.63205361366272
Epoch: 6, Steps: 208 | Train Loss: 3.130 Vali Loss: 3.481 Vali Acc: 0.078 Test Loss: 3.481 Test Acc: 0.078
Validation loss decreased (-0.065874 --> -0.078104).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.7523136
	speed: 0.1771s/iter; left time: 3444.7959s
	iters: 200, epoch: 7 | loss: 3.2620041
	speed: 0.0481s/iter; left time: 931.5009s
Epoch: 7 cost time: 10.34827208518982
Epoch: 7, Steps: 208 | Train Loss: 2.916 Vali Loss: 3.416 Vali Acc: 0.089 Test Loss: 3.416 Test Acc: 0.089
Validation loss decreased (-0.078104 --> -0.088543).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.6382027
	speed: 0.1842s/iter; left time: 3544.5892s
	iters: 200, epoch: 8 | loss: 2.6076438
	speed: 0.0486s/iter; left time: 930.3062s
Epoch: 8 cost time: 10.639953136444092
Epoch: 8, Steps: 208 | Train Loss: 2.703 Vali Loss: 3.450 Vali Acc: 0.098 Test Loss: 3.450 Test Acc: 0.098
Validation loss decreased (-0.088543 --> -0.097788).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.0072997
	speed: 0.1828s/iter; left time: 3480.3711s
	iters: 200, epoch: 9 | loss: 2.8003170
	speed: 0.0513s/iter; left time: 971.8704s
Epoch: 9 cost time: 10.855324506759644
Epoch: 9, Steps: 208 | Train Loss: 2.479 Vali Loss: 3.512 Vali Acc: 0.112 Test Loss: 3.512 Test Acc: 0.112
Validation loss decreased (-0.097788 --> -0.112103).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.3625128
	speed: 0.1662s/iter; left time: 3128.7152s
	iters: 200, epoch: 10 | loss: 2.5957451
	speed: 0.0502s/iter; left time: 940.9424s
Epoch: 10 cost time: 10.443802118301392
Epoch: 10, Steps: 208 | Train Loss: 2.239 Vali Loss: 3.649 Vali Acc: 0.101 Test Loss: 3.649 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.5615802
	speed: 0.1818s/iter; left time: 3386.2203s
	iters: 200, epoch: 11 | loss: 2.4349794
	speed: 0.0490s/iter; left time: 907.7532s
Epoch: 11 cost time: 10.713738441467285
Epoch: 11, Steps: 208 | Train Loss: 2.033 Vali Loss: 3.723 Vali Acc: 0.108 Test Loss: 3.723 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 2.2442789
	speed: 0.1882s/iter; left time: 3465.3367s
	iters: 200, epoch: 12 | loss: 1.9080466
	speed: 0.0515s/iter; left time: 943.7313s
Epoch: 12 cost time: 11.158393621444702
Epoch: 12, Steps: 208 | Train Loss: 1.779 Vali Loss: 3.996 Vali Acc: 0.115 Test Loss: 3.996 Test Acc: 0.115
Validation loss decreased (-0.112103 --> -0.115081).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.5432214
	speed: 0.1875s/iter; left time: 3413.8777s
	iters: 200, epoch: 13 | loss: 1.3892040
	speed: 0.0494s/iter; left time: 894.7770s
Epoch: 13 cost time: 10.795941591262817
Epoch: 13, Steps: 208 | Train Loss: 1.549 Vali Loss: 4.171 Vali Acc: 0.119 Test Loss: 4.171 Test Acc: 0.119
Validation loss decreased (-0.115081 --> -0.118658).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.0534812
	speed: 0.1858s/iter; left time: 3343.3883s
	iters: 200, epoch: 14 | loss: 1.6913855
	speed: 0.0488s/iter; left time: 872.9002s
Epoch: 14 cost time: 10.734472274780273
Epoch: 14, Steps: 208 | Train Loss: 1.336 Vali Loss: 4.296 Vali Acc: 0.112 Test Loss: 4.296 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.4061918
	speed: 0.1866s/iter; left time: 3318.6324s
	iters: 200, epoch: 15 | loss: 1.1211057
	speed: 0.0495s/iter; left time: 875.0176s
Epoch: 15 cost time: 10.87923002243042
Epoch: 15, Steps: 208 | Train Loss: 1.139 Vali Loss: 4.700 Vali Acc: 0.126 Test Loss: 4.700 Test Acc: 0.126
Validation loss decreased (-0.118658 --> -0.126407).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.5977357
	speed: 0.1850s/iter; left time: 3253.2076s
	iters: 200, epoch: 16 | loss: 1.2421842
	speed: 0.0484s/iter; left time: 846.7852s
Epoch: 16 cost time: 10.5762460231781
Epoch: 16, Steps: 208 | Train Loss: 0.979 Vali Loss: 5.036 Vali Acc: 0.114 Test Loss: 5.036 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.1134650
	speed: 0.1858s/iter; left time: 3227.5276s
	iters: 200, epoch: 17 | loss: 0.8760909
	speed: 0.0503s/iter; left time: 869.6564s
Epoch: 17 cost time: 11.148836374282837
Epoch: 17, Steps: 208 | Train Loss: 0.837 Vali Loss: 5.244 Vali Acc: 0.122 Test Loss: 5.244 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.7565846
	speed: 0.1890s/iter; left time: 3243.7346s
	iters: 200, epoch: 18 | loss: 1.0171927
	speed: 0.0494s/iter; left time: 843.3392s
Epoch: 18 cost time: 10.832872152328491
Epoch: 18, Steps: 208 | Train Loss: 0.749 Vali Loss: 5.444 Vali Acc: 0.113 Test Loss: 5.444 Test Acc: 0.113
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.4389018
	speed: 0.1868s/iter; left time: 3167.5966s
	iters: 200, epoch: 19 | loss: 0.8777162
	speed: 0.0507s/iter; left time: 854.3109s
Epoch: 19 cost time: 11.143588781356812
Epoch: 19, Steps: 208 | Train Loss: 0.685 Vali Loss: 5.768 Vali Acc: 0.113 Test Loss: 5.768 Test Acc: 0.113
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.4023268
	speed: 0.1862s/iter; left time: 3118.4938s
	iters: 200, epoch: 20 | loss: 0.8371398
	speed: 0.0562s/iter; left time: 935.4031s
Epoch: 20 cost time: 11.611202478408813
Epoch: 20, Steps: 208 | Train Loss: 0.609 Vali Loss: 6.096 Vali Acc: 0.106 Test Loss: 6.096 Test Acc: 0.106
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.2541488
	speed: 0.2022s/iter; left time: 3344.6801s
	iters: 200, epoch: 21 | loss: 0.7006563
	speed: 0.0554s/iter; left time: 911.6060s
Epoch: 21 cost time: 12.019524335861206
Epoch: 21, Steps: 208 | Train Loss: 0.544 Vali Loss: 6.309 Vali Acc: 0.109 Test Loss: 6.309 Test Acc: 0.109
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.1945735
	speed: 0.2143s/iter; left time: 3500.0527s
	iters: 200, epoch: 22 | loss: 0.8977536
	speed: 0.0556s/iter; left time: 902.6518s
Epoch: 22 cost time: 12.170308589935303
Epoch: 22, Steps: 208 | Train Loss: 0.539 Vali Loss: 6.554 Vali Acc: 0.114 Test Loss: 6.554 Test Acc: 0.114
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.1828942
	speed: 0.2095s/iter; left time: 3378.3827s
	iters: 200, epoch: 23 | loss: 0.3211960
	speed: 0.0557s/iter; left time: 892.8025s
Epoch: 23 cost time: 12.092488050460815
Epoch: 23, Steps: 208 | Train Loss: 0.467 Vali Loss: 6.509 Vali Acc: 0.108 Test Loss: 6.509 Test Acc: 0.108
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.6336952
	speed: 0.1968s/iter; left time: 3131.9848s
	iters: 200, epoch: 24 | loss: 0.4102395
	speed: 0.0545s/iter; left time: 861.2740s
Epoch: 24 cost time: 11.64924931526184
Epoch: 24, Steps: 208 | Train Loss: 0.462 Vali Loss: 6.778 Vali Acc: 0.114 Test Loss: 6.778 Test Acc: 0.114
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.3148375
	speed: 0.1999s/iter; left time: 3139.7944s
	iters: 200, epoch: 25 | loss: 0.5017129
	speed: 0.0490s/iter; left time: 765.2381s
Epoch: 25 cost time: 11.133376836776733
Epoch: 25, Steps: 208 | Train Loss: 0.420 Vali Loss: 7.013 Vali Acc: 0.109 Test Loss: 7.013 Test Acc: 0.109
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12645392186101997
model parameter : 317259
model size : 1.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9441180
	speed: 0.0625s/iter; left time: 1294.3701s
	iters: 200, epoch: 1 | loss: 4.1639338
	speed: 0.0480s/iter; left time: 989.1590s
Epoch: 1 cost time: 11.513633251190186
Epoch: 1, Steps: 208 | Train Loss: 3.757 Vali Loss: 3.693 Vali Acc: 0.061 Test Loss: 3.693 Test Acc: 0.061
Validation loss decreased (inf --> -0.060804).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.0460014
	speed: 0.1764s/iter; left time: 3614.4802s
	iters: 200, epoch: 2 | loss: 3.5490060
	speed: 0.0468s/iter; left time: 953.8225s
Epoch: 2 cost time: 10.576251983642578
Epoch: 2, Steps: 208 | Train Loss: 3.662 Vali Loss: 3.635 Vali Acc: 0.060 Test Loss: 3.635 Test Acc: 0.060
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.3187864
	speed: 0.1812s/iter; left time: 3676.6228s
	iters: 200, epoch: 3 | loss: 3.9884033
	speed: 0.0482s/iter; left time: 972.2839s
Epoch: 3 cost time: 10.471341609954834
Epoch: 3, Steps: 208 | Train Loss: 3.563 Vali Loss: 3.682 Vali Acc: 0.056 Test Loss: 3.682 Test Acc: 0.056
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 3.4241242
	speed: 0.1808s/iter; left time: 3629.7879s
	iters: 200, epoch: 4 | loss: 3.1602960
	speed: 0.0478s/iter; left time: 955.4997s
Epoch: 4 cost time: 10.332643985748291
Epoch: 4, Steps: 208 | Train Loss: 3.464 Vali Loss: 3.593 Vali Acc: 0.065 Test Loss: 3.593 Test Acc: 0.065
Validation loss decreased (-0.060804 --> -0.064682).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3476450
	speed: 0.1839s/iter; left time: 3653.6744s
	iters: 200, epoch: 5 | loss: 3.2166619
	speed: 0.0490s/iter; left time: 968.0323s
Epoch: 5 cost time: 10.729511976242065
Epoch: 5, Steps: 208 | Train Loss: 3.351 Vali Loss: 3.496 Vali Acc: 0.075 Test Loss: 3.496 Test Acc: 0.075
Validation loss decreased (-0.064682 --> -0.074823).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.1309538
	speed: 0.1816s/iter; left time: 3570.9055s
	iters: 200, epoch: 6 | loss: 2.9137745
	speed: 0.0476s/iter; left time: 930.2448s
Epoch: 6 cost time: 10.180155992507935
Epoch: 6, Steps: 208 | Train Loss: 3.163 Vali Loss: 3.636 Vali Acc: 0.070 Test Loss: 3.636 Test Acc: 0.070
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.1469393
	speed: 0.1833s/iter; left time: 3565.3591s
	iters: 200, epoch: 7 | loss: 2.8756046
	speed: 0.0456s/iter; left time: 883.3860s
Epoch: 7 cost time: 10.26038384437561
Epoch: 7, Steps: 208 | Train Loss: 2.992 Vali Loss: 3.473 Vali Acc: 0.082 Test Loss: 3.473 Test Acc: 0.082
Validation loss decreased (-0.074823 --> -0.082280).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.6768036
	speed: 0.1754s/iter; left time: 3376.3019s
	iters: 200, epoch: 8 | loss: 2.8644171
	speed: 0.0469s/iter; left time: 898.7040s
Epoch: 8 cost time: 10.297060489654541
Epoch: 8, Steps: 208 | Train Loss: 2.812 Vali Loss: 3.341 Vali Acc: 0.108 Test Loss: 3.341 Test Acc: 0.108
Validation loss decreased (-0.082280 --> -0.107631).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.4710240
	speed: 0.1845s/iter; left time: 3512.3794s
	iters: 200, epoch: 9 | loss: 2.5206897
	speed: 0.0447s/iter; left time: 847.0046s
Epoch: 9 cost time: 10.012356281280518
Epoch: 9, Steps: 208 | Train Loss: 2.641 Vali Loss: 3.437 Vali Acc: 0.105 Test Loss: 3.437 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.7260880
	speed: 0.1820s/iter; left time: 3427.3070s
	iters: 200, epoch: 10 | loss: 3.1869762
	speed: 0.0440s/iter; left time: 824.8963s
Epoch: 10 cost time: 10.228636264801025
Epoch: 10, Steps: 208 | Train Loss: 2.387 Vali Loss: 3.475 Vali Acc: 0.104 Test Loss: 3.475 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.8065653
	speed: 0.1726s/iter; left time: 3213.4521s
	iters: 200, epoch: 11 | loss: 2.1997528
	speed: 0.0406s/iter; left time: 751.2893s
Epoch: 11 cost time: 9.066254615783691
Epoch: 11, Steps: 208 | Train Loss: 2.135 Vali Loss: 3.537 Vali Acc: 0.110 Test Loss: 3.537 Test Acc: 0.110
Validation loss decreased (-0.107631 --> -0.110314).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.0829663
	speed: 0.1782s/iter; left time: 3280.5552s
	iters: 200, epoch: 12 | loss: 2.9660354
	speed: 0.0493s/iter; left time: 902.3211s
Epoch: 12 cost time: 10.336658239364624
Epoch: 12, Steps: 208 | Train Loss: 1.879 Vali Loss: 3.789 Vali Acc: 0.103 Test Loss: 3.789 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.8435287
	speed: 0.1696s/iter; left time: 3088.3779s
	iters: 200, epoch: 13 | loss: 1.9957458
	speed: 0.0426s/iter; left time: 771.4425s
Epoch: 13 cost time: 9.210971355438232
Epoch: 13, Steps: 208 | Train Loss: 1.611 Vali Loss: 3.964 Vali Acc: 0.118 Test Loss: 3.964 Test Acc: 0.118
Validation loss decreased (-0.110314 --> -0.117467).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.9126453
	speed: 0.1806s/iter; left time: 3249.5262s
	iters: 200, epoch: 14 | loss: 1.4427301
	speed: 0.0485s/iter; left time: 868.2472s
Epoch: 14 cost time: 11.036909103393555
Epoch: 14, Steps: 208 | Train Loss: 1.351 Vali Loss: 4.434 Vali Acc: 0.115 Test Loss: 4.434 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.7343946
	speed: 0.2071s/iter; left time: 3683.7379s
	iters: 200, epoch: 15 | loss: 1.4220451
	speed: 0.0552s/iter; left time: 975.7715s
Epoch: 15 cost time: 11.973288774490356
Epoch: 15, Steps: 208 | Train Loss: 1.140 Vali Loss: 4.562 Vali Acc: 0.112 Test Loss: 4.562 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.5997325
	speed: 0.2068s/iter; left time: 3636.0389s
	iters: 200, epoch: 16 | loss: 0.9768935
	speed: 0.0542s/iter; left time: 947.5166s
Epoch: 16 cost time: 12.026169776916504
Epoch: 16, Steps: 208 | Train Loss: 0.942 Vali Loss: 4.920 Vali Acc: 0.114 Test Loss: 4.920 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.0149622
	speed: 0.2098s/iter; left time: 3644.8146s
	iters: 200, epoch: 17 | loss: 0.6053200
	speed: 0.0541s/iter; left time: 934.0904s
Epoch: 17 cost time: 11.793473482131958
Epoch: 17, Steps: 208 | Train Loss: 0.775 Vali Loss: 5.353 Vali Acc: 0.112 Test Loss: 5.353 Test Acc: 0.112
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.3648383
	speed: 0.1989s/iter; left time: 3413.3334s
	iters: 200, epoch: 18 | loss: 0.5485585
	speed: 0.0522s/iter; left time: 890.6849s
Epoch: 18 cost time: 11.352964401245117
Epoch: 18, Steps: 208 | Train Loss: 0.696 Vali Loss: 5.400 Vali Acc: 0.109 Test Loss: 5.400 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.4029079
	speed: 0.1932s/iter; left time: 3275.8082s
	iters: 200, epoch: 19 | loss: 0.5517314
	speed: 0.0533s/iter; left time: 898.9056s
Epoch: 19 cost time: 11.553298711776733
Epoch: 19, Steps: 208 | Train Loss: 0.612 Vali Loss: 5.775 Vali Acc: 0.109 Test Loss: 5.775 Test Acc: 0.109
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.3882157
	speed: 0.1880s/iter; left time: 3148.4733s
	iters: 200, epoch: 20 | loss: 0.4200465
	speed: 0.0481s/iter; left time: 801.1628s
Epoch: 20 cost time: 10.58023452758789
Epoch: 20, Steps: 208 | Train Loss: 0.554 Vali Loss: 6.021 Vali Acc: 0.111 Test Loss: 6.021 Test Acc: 0.111
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.2616572
	speed: 0.1788s/iter; left time: 2956.9043s
	iters: 200, epoch: 21 | loss: 0.7411255
	speed: 0.0487s/iter; left time: 801.3424s
Epoch: 21 cost time: 10.414769172668457
Epoch: 21, Steps: 208 | Train Loss: 0.486 Vali Loss: 5.944 Vali Acc: 0.110 Test Loss: 5.944 Test Acc: 0.110
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.9770591
	speed: 0.1840s/iter; left time: 3004.8061s
	iters: 200, epoch: 22 | loss: 0.3827435
	speed: 0.0464s/iter; left time: 753.5793s
Epoch: 22 cost time: 10.319308757781982
Epoch: 22, Steps: 208 | Train Loss: 0.424 Vali Loss: 6.210 Vali Acc: 0.114 Test Loss: 6.210 Test Acc: 0.114
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.2634311
	speed: 0.1795s/iter; left time: 2894.5232s
	iters: 200, epoch: 23 | loss: 0.4771583
	speed: 0.0477s/iter; left time: 764.1114s
Epoch: 23 cost time: 10.21560263633728
Epoch: 23, Steps: 208 | Train Loss: 0.415 Vali Loss: 6.757 Vali Acc: 0.109 Test Loss: 6.757 Test Acc: 0.109
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11750671040858933
model parameter : 316331
model size : 1.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6112373
	speed: 0.0654s/iter; left time: 1353.7865s
	iters: 200, epoch: 1 | loss: 3.6287246
	speed: 0.0489s/iter; left time: 1008.3881s
Epoch: 1 cost time: 11.860190391540527
Epoch: 1, Steps: 208 | Train Loss: 3.734 Vali Loss: 3.673 Vali Acc: 0.044 Test Loss: 3.673 Test Acc: 0.044
Validation loss decreased (inf --> -0.044401).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.1289611
	speed: 0.1788s/iter; left time: 3664.8985s
	iters: 200, epoch: 2 | loss: 3.2558973
	speed: 0.0468s/iter; left time: 955.2873s
Epoch: 2 cost time: 10.393208980560303
Epoch: 2, Steps: 208 | Train Loss: 3.691 Vali Loss: 3.890 Vali Acc: 0.057 Test Loss: 3.890 Test Acc: 0.057
Validation loss decreased (-0.044401 --> -0.057223).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7406487
	speed: 0.1862s/iter; left time: 3778.0381s
	iters: 200, epoch: 3 | loss: 3.4950514
	speed: 0.0469s/iter; left time: 946.6689s
Epoch: 3 cost time: 10.233905553817749
Epoch: 3, Steps: 208 | Train Loss: 3.640 Vali Loss: 3.788 Vali Acc: 0.058 Test Loss: 3.788 Test Acc: 0.058
Validation loss decreased (-0.057223 --> -0.058119).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.8652992
	speed: 0.1804s/iter; left time: 3622.7655s
	iters: 200, epoch: 4 | loss: 4.2131329
	speed: 0.0463s/iter; left time: 925.4876s
Epoch: 4 cost time: 10.31664514541626
Epoch: 4, Steps: 208 | Train Loss: 3.493 Vali Loss: 3.691 Vali Acc: 0.065 Test Loss: 3.691 Test Acc: 0.065
Validation loss decreased (-0.058119 --> -0.065278).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.1698134
	speed: 0.1896s/iter; left time: 3767.3373s
	iters: 200, epoch: 5 | loss: 3.0515828
	speed: 0.0478s/iter; left time: 945.4619s
Epoch: 5 cost time: 10.644768714904785
Epoch: 5, Steps: 208 | Train Loss: 3.341 Vali Loss: 3.572 Vali Acc: 0.080 Test Loss: 3.572 Test Acc: 0.080
Validation loss decreased (-0.065278 --> -0.079594).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.7456663
	speed: 0.1804s/iter; left time: 3547.4002s
	iters: 200, epoch: 6 | loss: 3.0297763
	speed: 0.0462s/iter; left time: 902.9770s
Epoch: 6 cost time: 10.144572257995605
Epoch: 6, Steps: 208 | Train Loss: 3.118 Vali Loss: 3.444 Vali Acc: 0.089 Test Loss: 3.444 Test Acc: 0.089
Validation loss decreased (-0.079594 --> -0.088543).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.6386831
	speed: 0.1863s/iter; left time: 3624.5659s
	iters: 200, epoch: 7 | loss: 2.7467971
	speed: 0.0505s/iter; left time: 977.2987s
Epoch: 7 cost time: 10.683915853500366
Epoch: 7, Steps: 208 | Train Loss: 2.878 Vali Loss: 3.409 Vali Acc: 0.090 Test Loss: 3.409 Test Acc: 0.090
Validation loss decreased (-0.088543 --> -0.089736).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.7617428
	speed: 0.1911s/iter; left time: 3677.2517s
	iters: 200, epoch: 8 | loss: 3.1517437
	speed: 0.0462s/iter; left time: 884.9963s
Epoch: 8 cost time: 10.247350454330444
Epoch: 8, Steps: 208 | Train Loss: 2.671 Vali Loss: 3.402 Vali Acc: 0.103 Test Loss: 3.402 Test Acc: 0.103
Validation loss decreased (-0.089736 --> -0.103455).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.8988465
	speed: 0.1791s/iter; left time: 3409.4423s
	iters: 200, epoch: 9 | loss: 2.4254749
	speed: 0.0468s/iter; left time: 886.5421s
Epoch: 9 cost time: 10.203233242034912
Epoch: 9, Steps: 208 | Train Loss: 2.467 Vali Loss: 3.523 Vali Acc: 0.106 Test Loss: 3.523 Test Acc: 0.106
Validation loss decreased (-0.103455 --> -0.105542).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.0375028
	speed: 0.1904s/iter; left time: 3584.1610s
	iters: 200, epoch: 10 | loss: 2.1502378
	speed: 0.0492s/iter; left time: 922.2127s
Epoch: 10 cost time: 10.64884328842163
Epoch: 10, Steps: 208 | Train Loss: 2.244 Vali Loss: 3.522 Vali Acc: 0.118 Test Loss: 3.522 Test Acc: 0.118
Validation loss decreased (-0.105542 --> -0.117471).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.4366329
	speed: 0.1814s/iter; left time: 3377.0262s
	iters: 200, epoch: 11 | loss: 1.7465518
	speed: 0.0502s/iter; left time: 929.5134s
Epoch: 11 cost time: 10.747674703598022
Epoch: 11, Steps: 208 | Train Loss: 2.001 Vali Loss: 3.784 Vali Acc: 0.115 Test Loss: 3.784 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.2160418
	speed: 0.1891s/iter; left time: 3481.9881s
	iters: 200, epoch: 12 | loss: 2.3621964
	speed: 0.0519s/iter; left time: 951.2263s
Epoch: 12 cost time: 11.234649658203125
Epoch: 12, Steps: 208 | Train Loss: 1.781 Vali Loss: 3.876 Vali Acc: 0.109 Test Loss: 3.876 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.9596030
	speed: 0.2027s/iter; left time: 3689.5710s
	iters: 200, epoch: 13 | loss: 1.7311218
	speed: 0.0526s/iter; left time: 951.5881s
Epoch: 13 cost time: 11.084864139556885
Epoch: 13, Steps: 208 | Train Loss: 1.563 Vali Loss: 4.102 Vali Acc: 0.119 Test Loss: 4.102 Test Acc: 0.119
Validation loss decreased (-0.117471 --> -0.118957).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.2299759
	speed: 0.1913s/iter; left time: 3442.4861s
	iters: 200, epoch: 14 | loss: 1.3978393
	speed: 0.0489s/iter; left time: 875.5173s
Epoch: 14 cost time: 10.694872856140137
Epoch: 14, Steps: 208 | Train Loss: 1.324 Vali Loss: 4.350 Vali Acc: 0.115 Test Loss: 4.350 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.2883795
	speed: 0.2090s/iter; left time: 3717.3920s
	iters: 200, epoch: 15 | loss: 1.0209901
	speed: 0.0503s/iter; left time: 890.5991s
Epoch: 15 cost time: 11.254603385925293
Epoch: 15, Steps: 208 | Train Loss: 1.166 Vali Loss: 4.579 Vali Acc: 0.109 Test Loss: 4.579 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.9902725
	speed: 0.1964s/iter; left time: 3453.7726s
	iters: 200, epoch: 16 | loss: 1.0105358
	speed: 0.0491s/iter; left time: 857.6461s
Epoch: 16 cost time: 10.939950942993164
Epoch: 16, Steps: 208 | Train Loss: 0.973 Vali Loss: 4.862 Vali Acc: 0.113 Test Loss: 4.862 Test Acc: 0.113
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.9671434
	speed: 0.1930s/iter; left time: 3352.9890s
	iters: 200, epoch: 17 | loss: 0.7003199
	speed: 0.0468s/iter; left time: 809.1137s
Epoch: 17 cost time: 10.404941082000732
Epoch: 17, Steps: 208 | Train Loss: 0.853 Vali Loss: 5.197 Vali Acc: 0.113 Test Loss: 5.197 Test Acc: 0.113
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.7349124
	speed: 0.1851s/iter; left time: 3177.9209s
	iters: 200, epoch: 18 | loss: 0.7031807
	speed: 0.0496s/iter; left time: 846.8650s
Epoch: 18 cost time: 10.730823040008545
Epoch: 18, Steps: 208 | Train Loss: 0.743 Vali Loss: 5.348 Vali Acc: 0.120 Test Loss: 5.348 Test Acc: 0.120
Validation loss decreased (-0.118957 --> -0.119541).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.7260759
	speed: 0.1849s/iter; left time: 3135.6228s
	iters: 200, epoch: 19 | loss: 0.7448936
	speed: 0.0486s/iter; left time: 819.6156s
Epoch: 19 cost time: 10.716864109039307
Epoch: 19, Steps: 208 | Train Loss: 0.650 Vali Loss: 5.643 Vali Acc: 0.117 Test Loss: 5.643 Test Acc: 0.117
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.9840617
	speed: 0.1802s/iter; left time: 3018.4704s
	iters: 200, epoch: 20 | loss: 0.3721097
	speed: 0.0473s/iter; left time: 788.0412s
Epoch: 20 cost time: 10.326239585876465
Epoch: 20, Steps: 208 | Train Loss: 0.614 Vali Loss: 5.846 Vali Acc: 0.109 Test Loss: 5.846 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.3608974
	speed: 0.1778s/iter; left time: 2940.5163s
	iters: 200, epoch: 21 | loss: 0.2219757
	speed: 0.0460s/iter; left time: 756.4980s
Epoch: 21 cost time: 10.063347339630127
Epoch: 21, Steps: 208 | Train Loss: 0.564 Vali Loss: 6.312 Vali Acc: 0.118 Test Loss: 6.312 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.5344872
	speed: 0.1663s/iter; left time: 2716.8190s
	iters: 200, epoch: 22 | loss: 0.8654376
	speed: 0.0473s/iter; left time: 767.5150s
Epoch: 22 cost time: 9.972007989883423
Epoch: 22, Steps: 208 | Train Loss: 0.500 Vali Loss: 6.289 Vali Acc: 0.118 Test Loss: 6.289 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.6478040
	speed: 0.1794s/iter; left time: 2892.8596s
	iters: 200, epoch: 23 | loss: 0.7522538
	speed: 0.0476s/iter; left time: 762.6447s
Epoch: 23 cost time: 10.28282117843628
Epoch: 23, Steps: 208 | Train Loss: 0.474 Vali Loss: 6.554 Vali Acc: 0.112 Test Loss: 6.554 Test Acc: 0.112
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.3377561
	speed: 0.1909s/iter; left time: 3038.2234s
	iters: 200, epoch: 24 | loss: 0.2580594
	speed: 0.0482s/iter; left time: 762.9730s
Epoch: 24 cost time: 10.716486930847168
Epoch: 24, Steps: 208 | Train Loss: 0.440 Vali Loss: 6.882 Vali Acc: 0.115 Test Loss: 6.882 Test Acc: 0.115
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0337491
	speed: 0.1795s/iter; left time: 2819.2595s
	iters: 200, epoch: 25 | loss: 0.3337506
	speed: 0.0466s/iter; left time: 727.8500s
Epoch: 25 cost time: 10.02197003364563
Epoch: 25, Steps: 208 | Train Loss: 0.424 Vali Loss: 6.908 Vali Acc: 0.113 Test Loss: 6.908 Test Acc: 0.113
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.4636383
	speed: 0.1749s/iter; left time: 2711.4838s
	iters: 200, epoch: 26 | loss: 0.1211863
	speed: 0.0482s/iter; left time: 741.6653s
Epoch: 26 cost time: 10.374935626983643
Epoch: 26, Steps: 208 | Train Loss: 0.408 Vali Loss: 7.006 Vali Acc: 0.123 Test Loss: 7.006 Test Acc: 0.123
Validation loss decreased (-0.119541 --> -0.123103).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.3207612
	speed: 0.1922s/iter; left time: 2939.4989s
	iters: 200, epoch: 27 | loss: 0.6719974
	speed: 0.0459s/iter; left time: 697.5207s
Epoch: 27 cost time: 10.613234281539917
Epoch: 27, Steps: 208 | Train Loss: 0.366 Vali Loss: 7.350 Vali Acc: 0.110 Test Loss: 7.350 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.3732094
	speed: 0.1886s/iter; left time: 2845.2482s
	iters: 200, epoch: 28 | loss: 0.1398987
	speed: 0.0462s/iter; left time: 692.2152s
Epoch: 28 cost time: 10.248223066329956
Epoch: 28, Steps: 208 | Train Loss: 0.365 Vali Loss: 7.075 Vali Acc: 0.118 Test Loss: 7.075 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.4711409
	speed: 0.1800s/iter; left time: 2677.5603s
	iters: 200, epoch: 29 | loss: 0.0871209
	speed: 0.0502s/iter; left time: 742.1283s
Epoch: 29 cost time: 10.8584303855896
Epoch: 29, Steps: 208 | Train Loss: 0.338 Vali Loss: 7.290 Vali Acc: 0.120 Test Loss: 7.290 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.1165164
	speed: 0.1786s/iter; left time: 2619.9250s
	iters: 200, epoch: 30 | loss: 0.2814510
	speed: 0.0482s/iter; left time: 702.4335s
Epoch: 30 cost time: 10.170348167419434
Epoch: 30, Steps: 208 | Train Loss: 0.314 Vali Loss: 7.671 Vali Acc: 0.125 Test Loss: 7.671 Test Acc: 0.125
Validation loss decreased (-0.123103 --> -0.124886).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.4906210
	speed: 0.1707s/iter; left time: 2467.8632s
	iters: 200, epoch: 31 | loss: 0.6822968
	speed: 0.0492s/iter; left time: 705.8620s
Epoch: 31 cost time: 10.432922601699829
Epoch: 31, Steps: 208 | Train Loss: 0.319 Vali Loss: 7.612 Vali Acc: 0.124 Test Loss: 7.612 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0707978
	speed: 0.1878s/iter; left time: 2676.4272s
	iters: 200, epoch: 32 | loss: 0.5320883
	speed: 0.0485s/iter; left time: 686.7135s
Epoch: 32 cost time: 10.662701845169067
Epoch: 32, Steps: 208 | Train Loss: 0.294 Vali Loss: 7.992 Vali Acc: 0.119 Test Loss: 7.992 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.0683787
	speed: 0.1983s/iter; left time: 2785.3708s
	iters: 200, epoch: 33 | loss: 0.5826485
	speed: 0.0528s/iter; left time: 735.9237s
Epoch: 33 cost time: 11.364533185958862
Epoch: 33, Steps: 208 | Train Loss: 0.294 Vali Loss: 7.972 Vali Acc: 0.125 Test Loss: 7.972 Test Acc: 0.125
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.4569260
	speed: 0.1752s/iter; left time: 2424.2466s
	iters: 200, epoch: 34 | loss: 0.3187518
	speed: 0.0452s/iter; left time: 620.9307s
Epoch: 34 cost time: 9.802961587905884
Epoch: 34, Steps: 208 | Train Loss: 0.298 Vali Loss: 8.207 Vali Acc: 0.119 Test Loss: 8.207 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.1137322
	speed: 0.1842s/iter; left time: 2510.7123s
	iters: 200, epoch: 35 | loss: 0.2901920
	speed: 0.0503s/iter; left time: 680.1228s
Epoch: 35 cost time: 10.92175555229187
Epoch: 35, Steps: 208 | Train Loss: 0.260 Vali Loss: 8.451 Vali Acc: 0.117 Test Loss: 8.451 Test Acc: 0.117
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 0.0375552
	speed: 0.1951s/iter; left time: 2618.0936s
	iters: 200, epoch: 36 | loss: 0.2926236
	speed: 0.0502s/iter; left time: 668.1380s
Epoch: 36 cost time: 10.9081392288208
Epoch: 36, Steps: 208 | Train Loss: 0.275 Vali Loss: 8.720 Vali Acc: 0.112 Test Loss: 8.720 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 0.3699304
	speed: 0.2017s/iter; left time: 2664.5746s
	iters: 200, epoch: 37 | loss: 0.1229583
	speed: 0.0498s/iter; left time: 652.6661s
Epoch: 37 cost time: 11.440472602844238
Epoch: 37, Steps: 208 | Train Loss: 0.260 Vali Loss: 8.808 Vali Acc: 0.116 Test Loss: 8.808 Test Acc: 0.116
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 0.3577484
	speed: 0.1937s/iter; left time: 2519.1753s
	iters: 200, epoch: 38 | loss: 0.3129805
	speed: 0.0482s/iter; left time: 621.7640s
Epoch: 38 cost time: 10.309832096099854
Epoch: 38, Steps: 208 | Train Loss: 0.245 Vali Loss: 8.168 Vali Acc: 0.116 Test Loss: 8.168 Test Acc: 0.116
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 39 | loss: 0.2065447
	speed: 0.2072s/iter; left time: 2651.2384s
	iters: 200, epoch: 39 | loss: 0.7057807
	speed: 0.0498s/iter; left time: 632.5821s
Epoch: 39 cost time: 11.34965705871582
Epoch: 39, Steps: 208 | Train Loss: 0.244 Vali Loss: 8.942 Vali Acc: 0.120 Test Loss: 8.942 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 40 | loss: 0.2068276
	speed: 0.2000s/iter; left time: 2517.2441s
	iters: 200, epoch: 40 | loss: 0.3176550
	speed: 0.0516s/iter; left time: 644.0815s
Epoch: 40 cost time: 11.421885251998901
Epoch: 40, Steps: 208 | Train Loss: 0.244 Vali Loss: 8.853 Vali Acc: 0.120 Test Loss: 8.853 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12496271995228155
model parameter : 277515
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0654068
	speed: 0.0674s/iter; left time: 1394.2130s
	iters: 200, epoch: 1 | loss: 3.9052043
	speed: 0.0501s/iter; left time: 1031.6599s
Epoch: 1 cost time: 12.186899185180664
Epoch: 1, Steps: 208 | Train Loss: 3.753 Vali Loss: 3.765 Vali Acc: 0.059 Test Loss: 3.765 Test Acc: 0.059
Validation loss decreased (inf --> -0.059312).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6513925
	speed: 0.1794s/iter; left time: 3677.0641s
	iters: 200, epoch: 2 | loss: 3.7904112
	speed: 0.0450s/iter; left time: 916.9467s
Epoch: 2 cost time: 9.991000890731812
Epoch: 2, Steps: 208 | Train Loss: 3.733 Vali Loss: 3.779 Vali Acc: 0.052 Test Loss: 3.779 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.8277223
	speed: 0.1796s/iter; left time: 3643.1611s
	iters: 200, epoch: 3 | loss: 3.8376963
	speed: 0.0467s/iter; left time: 943.1764s
Epoch: 3 cost time: 10.133863687515259
Epoch: 3, Steps: 208 | Train Loss: 3.622 Vali Loss: 3.734 Vali Acc: 0.059 Test Loss: 3.734 Test Acc: 0.059
Validation loss decreased (-0.059312 --> -0.059312).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.8961232
	speed: 0.1803s/iter; left time: 3619.5571s
	iters: 200, epoch: 4 | loss: 3.5448980
	speed: 0.0481s/iter; left time: 960.5277s
Epoch: 4 cost time: 10.284233570098877
Epoch: 4, Steps: 208 | Train Loss: 3.480 Vali Loss: 3.633 Vali Acc: 0.069 Test Loss: 3.633 Test Acc: 0.069
Validation loss decreased (-0.059312 --> -0.068559).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.4532788
	speed: 0.1782s/iter; left time: 3540.1351s
	iters: 200, epoch: 5 | loss: 3.5573530
	speed: 0.0454s/iter; left time: 896.7037s
Epoch: 5 cost time: 9.898130655288696
Epoch: 5, Steps: 208 | Train Loss: 3.317 Vali Loss: 3.633 Vali Acc: 0.067 Test Loss: 3.633 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.5578535
	speed: 0.1756s/iter; left time: 3452.7477s
	iters: 200, epoch: 6 | loss: 3.3856592
	speed: 0.0458s/iter; left time: 895.2653s
Epoch: 6 cost time: 10.226090669631958
Epoch: 6, Steps: 208 | Train Loss: 3.162 Vali Loss: 3.588 Vali Acc: 0.075 Test Loss: 3.588 Test Acc: 0.075
Validation loss decreased (-0.068559 --> -0.074822).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.5480566
	speed: 0.1787s/iter; left time: 3475.8132s
	iters: 200, epoch: 7 | loss: 3.2785177
	speed: 0.0490s/iter; left time: 948.1808s
Epoch: 7 cost time: 10.314533233642578
Epoch: 7, Steps: 208 | Train Loss: 2.953 Vali Loss: 3.532 Vali Acc: 0.084 Test Loss: 3.532 Test Acc: 0.084
Validation loss decreased (-0.074822 --> -0.084367).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.1935778
	speed: 0.1974s/iter; left time: 3798.4337s
	iters: 200, epoch: 8 | loss: 3.0618818
	speed: 0.0505s/iter; left time: 966.8734s
Epoch: 8 cost time: 11.34922194480896
Epoch: 8, Steps: 208 | Train Loss: 2.711 Vali Loss: 3.520 Vali Acc: 0.095 Test Loss: 3.520 Test Acc: 0.095
Validation loss decreased (-0.084367 --> -0.094507).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.4702756
	speed: 0.1899s/iter; left time: 3616.0524s
	iters: 200, epoch: 9 | loss: 2.4440920
	speed: 0.0466s/iter; left time: 882.2301s
Epoch: 9 cost time: 10.32655382156372
Epoch: 9, Steps: 208 | Train Loss: 2.468 Vali Loss: 3.571 Vali Acc: 0.097 Test Loss: 3.571 Test Acc: 0.097
Validation loss decreased (-0.094507 --> -0.096594).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.2523322
	speed: 0.1794s/iter; left time: 3377.1463s
	iters: 200, epoch: 10 | loss: 2.6363223
	speed: 0.0451s/iter; left time: 845.1379s
Epoch: 10 cost time: 9.940736532211304
Epoch: 10, Steps: 208 | Train Loss: 2.238 Vali Loss: 3.688 Vali Acc: 0.098 Test Loss: 3.688 Test Acc: 0.098
Validation loss decreased (-0.096594 --> -0.098382).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.9177542
	speed: 0.1821s/iter; left time: 3390.0752s
	iters: 200, epoch: 11 | loss: 2.0599430
	speed: 0.0449s/iter; left time: 831.3856s
Epoch: 11 cost time: 10.075570344924927
Epoch: 11, Steps: 208 | Train Loss: 1.992 Vali Loss: 3.768 Vali Acc: 0.107 Test Loss: 3.768 Test Acc: 0.107
Validation loss decreased (-0.098382 --> -0.106732).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4713511
	speed: 0.1748s/iter; left time: 3217.7052s
	iters: 200, epoch: 12 | loss: 1.9264690
	speed: 0.0461s/iter; left time: 844.4345s
Epoch: 12 cost time: 9.90574312210083
Epoch: 12, Steps: 208 | Train Loss: 1.755 Vali Loss: 3.978 Vali Acc: 0.106 Test Loss: 3.978 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.5064096
	speed: 0.1921s/iter; left time: 3497.0659s
	iters: 200, epoch: 13 | loss: 1.5317104
	speed: 0.0463s/iter; left time: 838.1160s
Epoch: 13 cost time: 10.705005168914795
Epoch: 13, Steps: 208 | Train Loss: 1.547 Vali Loss: 4.146 Vali Acc: 0.104 Test Loss: 4.146 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.7393777
	speed: 0.1839s/iter; left time: 3310.0980s
	iters: 200, epoch: 14 | loss: 1.1044664
	speed: 0.0447s/iter; left time: 799.8445s
Epoch: 14 cost time: 9.796448230743408
Epoch: 14, Steps: 208 | Train Loss: 1.334 Vali Loss: 4.338 Vali Acc: 0.102 Test Loss: 4.338 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.9640876
	speed: 0.1819s/iter; left time: 3235.0197s
	iters: 200, epoch: 15 | loss: 1.4918509
	speed: 0.0436s/iter; left time: 771.9602s
Epoch: 15 cost time: 9.919129133224487
Epoch: 15, Steps: 208 | Train Loss: 1.118 Vali Loss: 4.658 Vali Acc: 0.108 Test Loss: 4.658 Test Acc: 0.108
Validation loss decreased (-0.106732 --> -0.107618).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.9980075
	speed: 0.1838s/iter; left time: 3231.2429s
	iters: 200, epoch: 16 | loss: 1.3793620
	speed: 0.0459s/iter; left time: 802.2569s
Epoch: 16 cost time: 10.26759123802185
Epoch: 16, Steps: 208 | Train Loss: 0.989 Vali Loss: 4.837 Vali Acc: 0.104 Test Loss: 4.837 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.7823087
	speed: 0.1983s/iter; left time: 3445.6650s
	iters: 200, epoch: 17 | loss: 1.0211262
	speed: 0.0489s/iter; left time: 843.9619s
Epoch: 17 cost time: 10.625317811965942
Epoch: 17, Steps: 208 | Train Loss: 0.840 Vali Loss: 5.279 Vali Acc: 0.108 Test Loss: 5.279 Test Acc: 0.108
Validation loss decreased (-0.107618 --> -0.107910).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.6629335
	speed: 0.1993s/iter; left time: 3421.4434s
	iters: 200, epoch: 18 | loss: 0.6333250
	speed: 0.0492s/iter; left time: 839.8179s
Epoch: 18 cost time: 11.09060001373291
Epoch: 18, Steps: 208 | Train Loss: 0.767 Vali Loss: 5.495 Vali Acc: 0.106 Test Loss: 5.495 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.7706245
	speed: 0.1934s/iter; left time: 3278.6558s
	iters: 200, epoch: 19 | loss: 0.9814799
	speed: 0.0487s/iter; left time: 820.4346s
Epoch: 19 cost time: 10.545214414596558
Epoch: 19, Steps: 208 | Train Loss: 0.702 Vali Loss: 5.614 Vali Acc: 0.113 Test Loss: 5.614 Test Acc: 0.113
Validation loss decreased (-0.107910 --> -0.112977).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.1163305
	speed: 0.1878s/iter; left time: 3144.9496s
	iters: 200, epoch: 20 | loss: 1.0410088
	speed: 0.0480s/iter; left time: 799.8589s
Epoch: 20 cost time: 10.53351354598999
Epoch: 20, Steps: 208 | Train Loss: 0.635 Vali Loss: 5.851 Vali Acc: 0.113 Test Loss: 5.851 Test Acc: 0.113
Validation loss decreased (-0.112977 --> -0.113273).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.8813789
	speed: 0.2039s/iter; left time: 3372.1352s
	iters: 200, epoch: 21 | loss: 0.6170718
	speed: 0.0501s/iter; left time: 824.0693s
Epoch: 21 cost time: 11.14504599571228
Epoch: 21, Steps: 208 | Train Loss: 0.578 Vali Loss: 6.107 Vali Acc: 0.109 Test Loss: 6.107 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.2693327
	speed: 0.1955s/iter; left time: 3192.5912s
	iters: 200, epoch: 22 | loss: 0.4030446
	speed: 0.0483s/iter; left time: 784.5856s
Epoch: 22 cost time: 10.5534029006958
Epoch: 22, Steps: 208 | Train Loss: 0.540 Vali Loss: 6.248 Vali Acc: 0.109 Test Loss: 6.248 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.2558962
	speed: 0.1808s/iter; left time: 2915.6750s
	iters: 200, epoch: 23 | loss: 0.6139823
	speed: 0.0491s/iter; left time: 787.5577s
Epoch: 23 cost time: 10.40696907043457
Epoch: 23, Steps: 208 | Train Loss: 0.506 Vali Loss: 6.384 Vali Acc: 0.107 Test Loss: 6.384 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.1772158
	speed: 0.1843s/iter; left time: 2932.8609s
	iters: 200, epoch: 24 | loss: 0.8682407
	speed: 0.0461s/iter; left time: 728.6698s
Epoch: 24 cost time: 10.09906005859375
Epoch: 24, Steps: 208 | Train Loss: 0.456 Vali Loss: 6.895 Vali Acc: 0.121 Test Loss: 6.895 Test Acc: 0.121
Validation loss decreased (-0.113273 --> -0.121315).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.9975553
	speed: 0.1680s/iter; left time: 2639.8099s
	iters: 200, epoch: 25 | loss: 0.7615243
	speed: 0.0427s/iter; left time: 666.9332s
Epoch: 25 cost time: 9.449986457824707
Epoch: 25, Steps: 208 | Train Loss: 0.455 Vali Loss: 6.744 Vali Acc: 0.106 Test Loss: 6.744 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.4296353
	speed: 0.1753s/iter; left time: 2717.9163s
	iters: 200, epoch: 26 | loss: 0.5300668
	speed: 0.0461s/iter; left time: 710.7539s
Epoch: 26 cost time: 10.231517553329468
Epoch: 26, Steps: 208 | Train Loss: 0.429 Vali Loss: 7.026 Vali Acc: 0.105 Test Loss: 7.026 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.3453724
	speed: 0.1821s/iter; left time: 2785.4819s
	iters: 200, epoch: 27 | loss: 0.3037350
	speed: 0.0467s/iter; left time: 709.4064s
Epoch: 27 cost time: 10.415198564529419
Epoch: 27, Steps: 208 | Train Loss: 0.420 Vali Loss: 7.091 Vali Acc: 0.105 Test Loss: 7.091 Test Acc: 0.105
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.4651262
	speed: 0.1850s/iter; left time: 2790.6170s
	iters: 200, epoch: 28 | loss: 0.3433484
	speed: 0.0452s/iter; left time: 676.6669s
Epoch: 28 cost time: 9.847609281539917
Epoch: 28, Steps: 208 | Train Loss: 0.399 Vali Loss: 7.606 Vali Acc: 0.103 Test Loss: 7.606 Test Acc: 0.103
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.1833793
	speed: 0.1859s/iter; left time: 2765.0188s
	iters: 200, epoch: 29 | loss: 0.1482906
	speed: 0.0459s/iter; left time: 678.8277s
Epoch: 29 cost time: 10.127699613571167
Epoch: 29, Steps: 208 | Train Loss: 0.379 Vali Loss: 7.547 Vali Acc: 0.118 Test Loss: 7.547 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.5668650
	speed: 0.1757s/iter; left time: 2578.0428s
	iters: 200, epoch: 30 | loss: 1.2114376
	speed: 0.0457s/iter; left time: 666.1945s
Epoch: 30 cost time: 10.101292610168457
Epoch: 30, Steps: 208 | Train Loss: 0.366 Vali Loss: 7.728 Vali Acc: 0.107 Test Loss: 7.728 Test Acc: 0.107
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.5556132
	speed: 0.1792s/iter; left time: 2591.1648s
	iters: 200, epoch: 31 | loss: 0.2436941
	speed: 0.0443s/iter; left time: 636.7600s
Epoch: 31 cost time: 9.951328039169312
Epoch: 31, Steps: 208 | Train Loss: 0.359 Vali Loss: 8.014 Vali Acc: 0.111 Test Loss: 8.014 Test Acc: 0.111
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.0464863
	speed: 0.1774s/iter; left time: 2528.7772s
	iters: 200, epoch: 32 | loss: 0.5082682
	speed: 0.0487s/iter; left time: 689.2129s
Epoch: 32 cost time: 10.484938621520996
Epoch: 32, Steps: 208 | Train Loss: 0.322 Vali Loss: 8.103 Vali Acc: 0.106 Test Loss: 8.103 Test Acc: 0.106
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.5031959
	speed: 0.1861s/iter; left time: 2613.5835s
	iters: 200, epoch: 33 | loss: 0.5353196
	speed: 0.0459s/iter; left time: 640.3975s
Epoch: 33 cost time: 9.918592691421509
Epoch: 33, Steps: 208 | Train Loss: 0.333 Vali Loss: 8.545 Vali Acc: 0.118 Test Loss: 8.545 Test Acc: 0.118
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.8727729
	speed: 0.1516s/iter; left time: 2097.4908s
	iters: 200, epoch: 34 | loss: 0.1447617
	speed: 0.0444s/iter; left time: 610.3305s
Epoch: 34 cost time: 9.141784191131592
Epoch: 34, Steps: 208 | Train Loss: 0.336 Vali Loss: 8.417 Vali Acc: 0.105 Test Loss: 8.417 Test Acc: 0.105
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12138383537130927
model parameter : 276587
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6618392
	speed: 0.0638s/iter; left time: 1320.9223s
	iters: 200, epoch: 1 | loss: 3.7956383
	speed: 0.0484s/iter; left time: 996.2943s
Epoch: 1 cost time: 11.676236391067505
Epoch: 1, Steps: 208 | Train Loss: 3.759 Vali Loss: 3.720 Vali Acc: 0.052 Test Loss: 3.720 Test Acc: 0.052
Validation loss decreased (inf --> -0.051558).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7675138
	speed: 0.1828s/iter; left time: 3745.8235s
	iters: 200, epoch: 2 | loss: 4.1776204
	speed: 0.0500s/iter; left time: 1019.6483s
Epoch: 2 cost time: 10.63300108909607
Epoch: 2, Steps: 208 | Train Loss: 3.700 Vali Loss: 3.827 Vali Acc: 0.054 Test Loss: 3.827 Test Acc: 0.054
Validation loss decreased (-0.051558 --> -0.054241).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.8422432
	speed: 0.1875s/iter; left time: 3804.0863s
	iters: 200, epoch: 3 | loss: 3.4189715
	speed: 0.0499s/iter; left time: 1007.9993s
Epoch: 3 cost time: 10.759496450424194
Epoch: 3, Steps: 208 | Train Loss: 3.608 Vali Loss: 3.863 Vali Acc: 0.057 Test Loss: 3.863 Test Acc: 0.057
Validation loss decreased (-0.054241 --> -0.057224).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.1690133
	speed: 0.2008s/iter; left time: 4031.4849s
	iters: 200, epoch: 4 | loss: 3.4770107
	speed: 0.0482s/iter; left time: 962.3761s
Epoch: 4 cost time: 10.43345022201538
Epoch: 4, Steps: 208 | Train Loss: 3.488 Vali Loss: 3.613 Vali Acc: 0.064 Test Loss: 3.613 Test Acc: 0.064
Validation loss decreased (-0.057224 --> -0.064384).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2987831
	speed: 0.1977s/iter; left time: 3927.5689s
	iters: 200, epoch: 5 | loss: 3.3549218
	speed: 0.0503s/iter; left time: 995.0579s
Epoch: 5 cost time: 11.103197574615479
Epoch: 5, Steps: 208 | Train Loss: 3.279 Vali Loss: 3.568 Vali Acc: 0.070 Test Loss: 3.568 Test Acc: 0.070
Validation loss decreased (-0.064384 --> -0.070349).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0241458
	speed: 0.1955s/iter; left time: 3844.2108s
	iters: 200, epoch: 6 | loss: 2.3683329
	speed: 0.0507s/iter; left time: 992.6081s
Epoch: 6 cost time: 10.846147298812866
Epoch: 6, Steps: 208 | Train Loss: 3.021 Vali Loss: 3.491 Vali Acc: 0.095 Test Loss: 3.491 Test Acc: 0.095
Validation loss decreased (-0.070349 --> -0.095402).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.4075773
	speed: 0.1989s/iter; left time: 3869.8921s
	iters: 200, epoch: 7 | loss: 2.7355599
	speed: 0.0503s/iter; left time: 973.2959s
Epoch: 7 cost time: 10.827552556991577
Epoch: 7, Steps: 208 | Train Loss: 2.808 Vali Loss: 3.450 Vali Acc: 0.089 Test Loss: 3.450 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.6421587
	speed: 0.1777s/iter; left time: 3420.1309s
	iters: 200, epoch: 8 | loss: 2.5942776
	speed: 0.0453s/iter; left time: 867.0600s
Epoch: 8 cost time: 10.059493064880371
Epoch: 8, Steps: 208 | Train Loss: 2.586 Vali Loss: 3.555 Vali Acc: 0.092 Test Loss: 3.555 Test Acc: 0.092
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.4544756
	speed: 0.1688s/iter; left time: 3214.0918s
	iters: 200, epoch: 9 | loss: 2.7605615
	speed: 0.0475s/iter; left time: 898.7102s
Epoch: 9 cost time: 10.12785792350769
Epoch: 9, Steps: 208 | Train Loss: 2.391 Vali Loss: 3.615 Vali Acc: 0.093 Test Loss: 3.615 Test Acc: 0.093
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 2.3515482
	speed: 0.1845s/iter; left time: 3473.4751s
	iters: 200, epoch: 10 | loss: 2.3514879
	speed: 0.0488s/iter; left time: 914.6856s
Epoch: 10 cost time: 10.452192306518555
Epoch: 10, Steps: 208 | Train Loss: 2.159 Vali Loss: 3.749 Vali Acc: 0.093 Test Loss: 3.749 Test Acc: 0.093
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.6141319
	speed: 0.1741s/iter; left time: 3241.8481s
	iters: 200, epoch: 11 | loss: 1.7424834
	speed: 0.0447s/iter; left time: 827.7645s
Epoch: 11 cost time: 9.737704992294312
Epoch: 11, Steps: 208 | Train Loss: 1.912 Vali Loss: 3.844 Vali Acc: 0.110 Test Loss: 3.844 Test Acc: 0.110
Validation loss decreased (-0.095402 --> -0.110012).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.0166748
	speed: 0.1782s/iter; left time: 3281.7197s
	iters: 200, epoch: 12 | loss: 1.9990597
	speed: 0.0449s/iter; left time: 822.1412s
Epoch: 12 cost time: 9.712321519851685
Epoch: 12, Steps: 208 | Train Loss: 1.695 Vali Loss: 3.986 Vali Acc: 0.108 Test Loss: 3.986 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.0029142
	speed: 0.1792s/iter; left time: 3261.5840s
	iters: 200, epoch: 13 | loss: 1.0632064
	speed: 0.0450s/iter; left time: 815.4618s
Epoch: 13 cost time: 10.212018489837646
Epoch: 13, Steps: 208 | Train Loss: 1.488 Vali Loss: 4.227 Vali Acc: 0.107 Test Loss: 4.227 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.0097831
	speed: 0.1774s/iter; left time: 3192.6570s
	iters: 200, epoch: 14 | loss: 1.1962240
	speed: 0.0456s/iter; left time: 816.1597s
Epoch: 14 cost time: 9.874273777008057
Epoch: 14, Steps: 208 | Train Loss: 1.290 Vali Loss: 4.441 Vali Acc: 0.112 Test Loss: 4.441 Test Acc: 0.112
Validation loss decreased (-0.110012 --> -0.111796).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.9955167
	speed: 0.1757s/iter; left time: 3125.2144s
	iters: 200, epoch: 15 | loss: 1.3709821
	speed: 0.0496s/iter; left time: 878.1857s
Epoch: 15 cost time: 10.600069999694824
Epoch: 15, Steps: 208 | Train Loss: 1.126 Vali Loss: 4.727 Vali Acc: 0.103 Test Loss: 4.727 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.3746198
	speed: 0.1854s/iter; left time: 3258.9462s
	iters: 200, epoch: 16 | loss: 0.7898892
	speed: 0.0473s/iter; left time: 827.5015s
Epoch: 16 cost time: 10.308905363082886
Epoch: 16, Steps: 208 | Train Loss: 0.988 Vali Loss: 4.937 Vali Acc: 0.110 Test Loss: 4.937 Test Acc: 0.110
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.1749889
	speed: 0.1824s/iter; left time: 3169.1543s
	iters: 200, epoch: 17 | loss: 0.9139546
	speed: 0.0490s/iter; left time: 846.9909s
Epoch: 17 cost time: 10.569910526275635
Epoch: 17, Steps: 208 | Train Loss: 0.892 Vali Loss: 5.123 Vali Acc: 0.107 Test Loss: 5.123 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.2791977
	speed: 0.1886s/iter; left time: 3237.3548s
	iters: 200, epoch: 18 | loss: 1.1135668
	speed: 0.0470s/iter; left time: 801.6505s
Epoch: 18 cost time: 10.526457786560059
Epoch: 18, Steps: 208 | Train Loss: 0.803 Vali Loss: 5.629 Vali Acc: 0.112 Test Loss: 5.629 Test Acc: 0.112
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.0491509
	speed: 0.1768s/iter; left time: 2997.9991s
	iters: 200, epoch: 19 | loss: 1.4036663
	speed: 0.0459s/iter; left time: 774.0676s
Epoch: 19 cost time: 9.89082646369934
Epoch: 19, Steps: 208 | Train Loss: 0.719 Vali Loss: 5.714 Vali Acc: 0.111 Test Loss: 5.714 Test Acc: 0.111
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.6312783
	speed: 0.1806s/iter; left time: 3024.3299s
	iters: 200, epoch: 20 | loss: 0.4948836
	speed: 0.0466s/iter; left time: 776.4727s
Epoch: 20 cost time: 10.302262783050537
Epoch: 20, Steps: 208 | Train Loss: 0.671 Vali Loss: 5.944 Vali Acc: 0.100 Test Loss: 5.944 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.7260669
	speed: 0.1773s/iter; left time: 2932.6221s
	iters: 200, epoch: 21 | loss: 0.5678186
	speed: 0.0442s/iter; left time: 727.2628s
Epoch: 21 cost time: 9.842908382415771
Epoch: 21, Steps: 208 | Train Loss: 0.598 Vali Loss: 6.123 Vali Acc: 0.109 Test Loss: 6.123 Test Acc: 0.109
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.5031271
	speed: 0.1292s/iter; left time: 2109.7170s
	iters: 200, epoch: 22 | loss: 0.8598485
	speed: 0.0437s/iter; left time: 710.0815s
Epoch: 22 cost time: 9.331616163253784
Epoch: 22, Steps: 208 | Train Loss: 0.564 Vali Loss: 6.390 Vali Acc: 0.109 Test Loss: 6.390 Test Acc: 0.109
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.5819538
	speed: 0.1869s/iter; left time: 3014.0990s
	iters: 200, epoch: 23 | loss: 0.6161700
	speed: 0.0505s/iter; left time: 808.7681s
Epoch: 23 cost time: 10.8603036403656
Epoch: 23, Steps: 208 | Train Loss: 0.529 Vali Loss: 6.520 Vali Acc: 0.113 Test Loss: 6.520 Test Acc: 0.113
Validation loss decreased (-0.111796 --> -0.113266).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.3169407
	speed: 0.2016s/iter; left time: 3208.5571s
	iters: 200, epoch: 24 | loss: 0.6018406
	speed: 0.0499s/iter; left time: 788.5131s
Epoch: 24 cost time: 10.877078771591187
Epoch: 24, Steps: 208 | Train Loss: 0.495 Vali Loss: 6.993 Vali Acc: 0.112 Test Loss: 6.993 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.5182162
	speed: 0.1934s/iter; left time: 3038.5379s
	iters: 200, epoch: 25 | loss: 0.3332039
	speed: 0.0476s/iter; left time: 742.7912s
Epoch: 25 cost time: 10.40329122543335
Epoch: 25, Steps: 208 | Train Loss: 0.472 Vali Loss: 7.181 Vali Acc: 0.106 Test Loss: 7.181 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.4346205
	speed: 0.1927s/iter; left time: 2986.8100s
	iters: 200, epoch: 26 | loss: 0.9601883
	speed: 0.0481s/iter; left time: 740.8206s
Epoch: 26 cost time: 10.635838985443115
Epoch: 26, Steps: 208 | Train Loss: 0.467 Vali Loss: 7.133 Vali Acc: 0.111 Test Loss: 7.133 Test Acc: 0.111
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.8072711
	speed: 0.1976s/iter; left time: 3022.4073s
	iters: 200, epoch: 27 | loss: 0.1177377
	speed: 0.0466s/iter; left time: 708.6659s
Epoch: 27 cost time: 10.553664445877075
Epoch: 27, Steps: 208 | Train Loss: 0.451 Vali Loss: 7.293 Vali Acc: 0.117 Test Loss: 7.293 Test Acc: 0.117
Validation loss decreased (-0.113266 --> -0.116837).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.3775460
	speed: 0.1958s/iter; left time: 2953.4559s
	iters: 200, epoch: 28 | loss: 0.7202783
	speed: 0.0466s/iter; left time: 697.7927s
Epoch: 28 cost time: 10.575345516204834
Epoch: 28, Steps: 208 | Train Loss: 0.404 Vali Loss: 7.311 Vali Acc: 0.108 Test Loss: 7.311 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.5662765
	speed: 0.1786s/iter; left time: 2656.3986s
	iters: 200, epoch: 29 | loss: 0.1533775
	speed: 0.0456s/iter; left time: 673.1383s
Epoch: 29 cost time: 10.08513879776001
Epoch: 29, Steps: 208 | Train Loss: 0.407 Vali Loss: 7.609 Vali Acc: 0.106 Test Loss: 7.609 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.4537026
	speed: 0.1942s/iter; left time: 2848.7419s
	iters: 200, epoch: 30 | loss: 0.1834769
	speed: 0.0444s/iter; left time: 647.2287s
Epoch: 30 cost time: 10.116894245147705
Epoch: 30, Steps: 208 | Train Loss: 0.388 Vali Loss: 7.725 Vali Acc: 0.109 Test Loss: 7.725 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.6767637
	speed: 0.1770s/iter; left time: 2558.9442s
	iters: 200, epoch: 31 | loss: 0.3227587
	speed: 0.0452s/iter; left time: 649.6097s
Epoch: 31 cost time: 10.174575090408325
Epoch: 31, Steps: 208 | Train Loss: 0.399 Vali Loss: 7.879 Vali Acc: 0.097 Test Loss: 7.879 Test Acc: 0.097
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.1970977
	speed: 0.1732s/iter; left time: 2468.7421s
	iters: 200, epoch: 32 | loss: 0.7135509
	speed: 0.0457s/iter; left time: 647.0966s
Epoch: 32 cost time: 9.8549964427948
Epoch: 32, Steps: 208 | Train Loss: 0.382 Vali Loss: 8.130 Vali Acc: 0.111 Test Loss: 8.130 Test Acc: 0.111
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.6558993
	speed: 0.1792s/iter; left time: 2516.8016s
	iters: 200, epoch: 33 | loss: 0.4098648
	speed: 0.0470s/iter; left time: 655.6257s
Epoch: 33 cost time: 10.17868971824646
Epoch: 33, Steps: 208 | Train Loss: 0.381 Vali Loss: 8.109 Vali Acc: 0.109 Test Loss: 8.109 Test Acc: 0.109
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.1724489
	speed: 0.1818s/iter; left time: 2515.0466s
	iters: 200, epoch: 34 | loss: 0.1052884
	speed: 0.0464s/iter; left time: 637.1918s
Epoch: 34 cost time: 10.04837155342102
Epoch: 34, Steps: 208 | Train Loss: 0.355 Vali Loss: 8.619 Vali Acc: 0.109 Test Loss: 8.619 Test Acc: 0.109
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.3591020
	speed: 0.1855s/iter; left time: 2528.0142s
	iters: 200, epoch: 35 | loss: 0.6483777
	speed: 0.0485s/iter; left time: 655.7257s
Epoch: 35 cost time: 10.461111783981323
Epoch: 35, Steps: 208 | Train Loss: 0.344 Vali Loss: 8.949 Vali Acc: 0.115 Test Loss: 8.949 Test Acc: 0.115
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 0.3830578
	speed: 0.1857s/iter; left time: 2492.4395s
	iters: 200, epoch: 36 | loss: 0.6038602
	speed: 0.0457s/iter; left time: 609.0404s
Epoch: 36 cost time: 10.240244626998901
Epoch: 36, Steps: 208 | Train Loss: 0.335 Vali Loss: 8.647 Vali Acc: 0.114 Test Loss: 8.647 Test Acc: 0.114
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 0.0548627
	speed: 0.1743s/iter; left time: 2303.5935s
	iters: 200, epoch: 37 | loss: 0.0665292
	speed: 0.0477s/iter; left time: 625.1389s
Epoch: 37 cost time: 10.09260082244873
Epoch: 37, Steps: 208 | Train Loss: 0.317 Vali Loss: 8.941 Vali Acc: 0.115 Test Loss: 8.941 Test Acc: 0.115
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11691022964509394
model parameter : 275659
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.6394105
	speed: 0.0599s/iter; left time: 1239.4130s
	iters: 200, epoch: 1 | loss: 3.9847753
	speed: 0.0461s/iter; left time: 950.1762s
Epoch: 1 cost time: 10.973783731460571
Epoch: 1, Steps: 208 | Train Loss: 3.735 Vali Loss: 3.696 Vali Acc: 0.048 Test Loss: 3.696 Test Acc: 0.048
Validation loss decreased (inf --> -0.047980).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8197098
	speed: 0.1832s/iter; left time: 3755.2594s
	iters: 200, epoch: 2 | loss: 3.5244610
	speed: 0.0476s/iter; left time: 970.6304s
Epoch: 2 cost time: 10.20319128036499
Epoch: 2, Steps: 208 | Train Loss: 3.687 Vali Loss: 3.929 Vali Acc: 0.052 Test Loss: 3.929 Test Acc: 0.052
Validation loss decreased (-0.047980 --> -0.051556).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.8865714
	speed: 0.1747s/iter; left time: 3543.0215s
	iters: 200, epoch: 3 | loss: 3.2586868
	speed: 0.0449s/iter; left time: 906.3056s
Epoch: 3 cost time: 9.759456396102905
Epoch: 3, Steps: 208 | Train Loss: 3.659 Vali Loss: 3.760 Vali Acc: 0.062 Test Loss: 3.760 Test Acc: 0.062
Validation loss decreased (-0.051556 --> -0.061698).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.5911129
	speed: 0.1747s/iter; left time: 3506.9182s
	iters: 200, epoch: 4 | loss: 3.3989403
	speed: 0.0452s/iter; left time: 903.3013s
Epoch: 4 cost time: 9.822208642959595
Epoch: 4, Steps: 208 | Train Loss: 3.479 Vali Loss: 3.663 Vali Acc: 0.067 Test Loss: 3.663 Test Acc: 0.067
Validation loss decreased (-0.061698 --> -0.066769).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.9053011
	speed: 0.1824s/iter; left time: 3625.0981s
	iters: 200, epoch: 5 | loss: 2.9456217
	speed: 0.0451s/iter; left time: 892.2475s
Epoch: 5 cost time: 10.01469612121582
Epoch: 5, Steps: 208 | Train Loss: 3.288 Vali Loss: 3.484 Vali Acc: 0.084 Test Loss: 3.484 Test Acc: 0.084
Validation loss decreased (-0.066769 --> -0.083771).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0641572
	speed: 0.1759s/iter; left time: 3457.5063s
	iters: 200, epoch: 6 | loss: 3.2073362
	speed: 0.0454s/iter; left time: 887.3562s
Epoch: 6 cost time: 9.841831922531128
Epoch: 6, Steps: 208 | Train Loss: 3.042 Vali Loss: 3.439 Vali Acc: 0.090 Test Loss: 3.439 Test Acc: 0.090
Validation loss decreased (-0.083771 --> -0.090034).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.5376995
	speed: 0.1810s/iter; left time: 3520.6417s
	iters: 200, epoch: 7 | loss: 2.8404841
	speed: 0.0492s/iter; left time: 951.9615s
Epoch: 7 cost time: 10.579846143722534
Epoch: 7, Steps: 208 | Train Loss: 2.814 Vali Loss: 3.373 Vali Acc: 0.098 Test Loss: 3.373 Test Acc: 0.098
Validation loss decreased (-0.090034 --> -0.097491).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.8123515
	speed: 0.1889s/iter; left time: 3635.7395s
	iters: 200, epoch: 8 | loss: 2.1202092
	speed: 0.0466s/iter; left time: 891.3978s
Epoch: 8 cost time: 10.296640634536743
Epoch: 8, Steps: 208 | Train Loss: 2.599 Vali Loss: 3.502 Vali Acc: 0.103 Test Loss: 3.502 Test Acc: 0.103
Validation loss decreased (-0.097491 --> -0.102858).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.7427304
	speed: 0.1970s/iter; left time: 3749.6473s
	iters: 200, epoch: 9 | loss: 2.4856834
	speed: 0.0465s/iter; left time: 880.8180s
Epoch: 9 cost time: 10.423808336257935
Epoch: 9, Steps: 208 | Train Loss: 2.370 Vali Loss: 3.525 Vali Acc: 0.106 Test Loss: 3.525 Test Acc: 0.106
Validation loss decreased (-0.102858 --> -0.105542).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.9489627
	speed: 0.1942s/iter; left time: 3656.2594s
	iters: 200, epoch: 10 | loss: 2.0441480
	speed: 0.0512s/iter; left time: 958.1594s
Epoch: 10 cost time: 10.963125944137573
Epoch: 10, Steps: 208 | Train Loss: 2.144 Vali Loss: 3.615 Vali Acc: 0.100 Test Loss: 3.615 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.7446916
	speed: 0.1983s/iter; left time: 3691.6338s
	iters: 200, epoch: 11 | loss: 2.8912964
	speed: 0.0484s/iter; left time: 896.2965s
Epoch: 11 cost time: 10.456948518753052
Epoch: 11, Steps: 208 | Train Loss: 1.909 Vali Loss: 3.780 Vali Acc: 0.100 Test Loss: 3.780 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.4030205
	speed: 0.1867s/iter; left time: 3437.1157s
	iters: 200, epoch: 12 | loss: 1.8417096
	speed: 0.0452s/iter; left time: 827.0547s
Epoch: 12 cost time: 9.518249034881592
Epoch: 12, Steps: 208 | Train Loss: 1.684 Vali Loss: 3.939 Vali Acc: 0.111 Test Loss: 3.939 Test Acc: 0.111
Validation loss decreased (-0.105542 --> -0.110608).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.5159597
	speed: 0.1729s/iter; left time: 3147.5316s
	iters: 200, epoch: 13 | loss: 1.6186785
	speed: 0.0453s/iter; left time: 819.3908s
Epoch: 13 cost time: 9.658377408981323
Epoch: 13, Steps: 208 | Train Loss: 1.473 Vali Loss: 4.160 Vali Acc: 0.103 Test Loss: 4.160 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.2728012
	speed: 0.1704s/iter; left time: 3066.0958s
	iters: 200, epoch: 14 | loss: 0.9878230
	speed: 0.0457s/iter; left time: 817.0740s
Epoch: 14 cost time: 9.751089572906494
Epoch: 14, Steps: 208 | Train Loss: 1.261 Vali Loss: 4.456 Vali Acc: 0.112 Test Loss: 4.456 Test Acc: 0.112
Validation loss decreased (-0.110608 --> -0.111497).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.0546443
	speed: 0.1768s/iter; left time: 3145.0984s
	iters: 200, epoch: 15 | loss: 1.4343537
	speed: 0.0477s/iter; left time: 843.7776s
Epoch: 15 cost time: 10.328853845596313
Epoch: 15, Steps: 208 | Train Loss: 1.061 Vali Loss: 4.783 Vali Acc: 0.100 Test Loss: 4.783 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.8392024
	speed: 0.1808s/iter; left time: 3178.1442s
	iters: 200, epoch: 16 | loss: 1.6082559
	speed: 0.0461s/iter; left time: 805.3276s
Epoch: 16 cost time: 9.974296808242798
Epoch: 16, Steps: 208 | Train Loss: 0.939 Vali Loss: 4.891 Vali Acc: 0.109 Test Loss: 4.891 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.8724029
	speed: 0.1754s/iter; left time: 3048.0772s
	iters: 200, epoch: 17 | loss: 1.1739463
	speed: 0.0460s/iter; left time: 794.5832s
Epoch: 17 cost time: 10.094048023223877
Epoch: 17, Steps: 208 | Train Loss: 0.822 Vali Loss: 5.132 Vali Acc: 0.108 Test Loss: 5.132 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.6057414
	speed: 0.1730s/iter; left time: 2968.9479s
	iters: 200, epoch: 18 | loss: 0.3009334
	speed: 0.0453s/iter; left time: 772.3223s
Epoch: 18 cost time: 9.846566915512085
Epoch: 18, Steps: 208 | Train Loss: 0.738 Vali Loss: 5.288 Vali Acc: 0.118 Test Loss: 5.288 Test Acc: 0.118
Validation loss decreased (-0.111497 --> -0.117454).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.8282403
	speed: 0.1749s/iter; left time: 2966.1275s
	iters: 200, epoch: 19 | loss: 0.7942072
	speed: 0.0459s/iter; left time: 773.4631s
Epoch: 19 cost time: 9.901859998703003
Epoch: 19, Steps: 208 | Train Loss: 0.659 Vali Loss: 5.665 Vali Acc: 0.106 Test Loss: 5.665 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.4644393
	speed: 0.1752s/iter; left time: 2934.9602s
	iters: 200, epoch: 20 | loss: 0.8213196
	speed: 0.0501s/iter; left time: 833.5920s
Epoch: 20 cost time: 10.299028158187866
Epoch: 20, Steps: 208 | Train Loss: 0.605 Vali Loss: 5.766 Vali Acc: 0.106 Test Loss: 5.766 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.4835944
	speed: 0.1707s/iter; left time: 2822.8813s
	iters: 200, epoch: 21 | loss: 1.0429262
	speed: 0.0445s/iter; left time: 732.0888s
Epoch: 21 cost time: 9.49617052078247
Epoch: 21, Steps: 208 | Train Loss: 0.575 Vali Loss: 6.126 Vali Acc: 0.115 Test Loss: 6.126 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.6462202
	speed: 0.1790s/iter; left time: 2924.2163s
	iters: 200, epoch: 22 | loss: 0.2455100
	speed: 0.0444s/iter; left time: 721.0193s
Epoch: 22 cost time: 9.557392835617065
Epoch: 22, Steps: 208 | Train Loss: 0.535 Vali Loss: 6.042 Vali Acc: 0.117 Test Loss: 6.042 Test Acc: 0.117
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.3905962
	speed: 0.1468s/iter; left time: 2366.5470s
	iters: 200, epoch: 23 | loss: 0.5286418
	speed: 0.0401s/iter; left time: 642.2829s
Epoch: 23 cost time: 8.687468528747559
Epoch: 23, Steps: 208 | Train Loss: 0.480 Vali Loss: 6.408 Vali Acc: 0.123 Test Loss: 6.408 Test Acc: 0.123
Validation loss decreased (-0.117454 --> -0.123109).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.7168032
	speed: 0.1771s/iter; left time: 2819.1928s
	iters: 200, epoch: 24 | loss: 0.5621043
	speed: 0.0466s/iter; left time: 736.7387s
Epoch: 24 cost time: 9.962452173233032
Epoch: 24, Steps: 208 | Train Loss: 0.467 Vali Loss: 6.702 Vali Acc: 0.114 Test Loss: 6.702 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.3377290
	speed: 0.1757s/iter; left time: 2759.3667s
	iters: 200, epoch: 25 | loss: 1.3585491
	speed: 0.0472s/iter; left time: 736.3712s
Epoch: 25 cost time: 10.050070524215698
Epoch: 25, Steps: 208 | Train Loss: 0.437 Vali Loss: 6.713 Vali Acc: 0.116 Test Loss: 6.713 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.1026548
	speed: 0.1870s/iter; left time: 2899.3107s
	iters: 200, epoch: 26 | loss: 0.3694152
	speed: 0.0472s/iter; left time: 726.6461s
Epoch: 26 cost time: 10.337620735168457
Epoch: 26, Steps: 208 | Train Loss: 0.405 Vali Loss: 7.015 Vali Acc: 0.116 Test Loss: 7.015 Test Acc: 0.116
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0797467
	speed: 0.1771s/iter; left time: 2707.6952s
	iters: 200, epoch: 27 | loss: 0.4570416
	speed: 0.0461s/iter; left time: 699.7891s
Epoch: 27 cost time: 9.71625566482544
Epoch: 27, Steps: 208 | Train Loss: 0.381 Vali Loss: 7.223 Vali Acc: 0.117 Test Loss: 7.223 Test Acc: 0.117
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.4417729
	speed: 0.1901s/iter; left time: 2867.6655s
	iters: 200, epoch: 28 | loss: 0.3010641
	speed: 0.0491s/iter; left time: 735.4402s
Epoch: 28 cost time: 10.677380561828613
Epoch: 28, Steps: 208 | Train Loss: 0.391 Vali Loss: 7.223 Vali Acc: 0.110 Test Loss: 7.223 Test Acc: 0.110
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.2626380
	speed: 0.1857s/iter; left time: 2762.2008s
	iters: 200, epoch: 29 | loss: 0.0664097
	speed: 0.0487s/iter; left time: 718.9817s
Epoch: 29 cost time: 10.490627765655518
Epoch: 29, Steps: 208 | Train Loss: 0.364 Vali Loss: 7.512 Vali Acc: 0.113 Test Loss: 7.512 Test Acc: 0.113
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0465973
	speed: 0.1918s/iter; left time: 2812.9187s
	iters: 200, epoch: 30 | loss: 0.1399572
	speed: 0.0490s/iter; left time: 713.4692s
Epoch: 30 cost time: 10.392091989517212
Epoch: 30, Steps: 208 | Train Loss: 0.357 Vali Loss: 7.655 Vali Acc: 0.115 Test Loss: 7.655 Test Acc: 0.115
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.3663401
	speed: 0.1998s/iter; left time: 2888.7939s
	iters: 200, epoch: 31 | loss: 0.2131441
	speed: 0.0488s/iter; left time: 700.8751s
Epoch: 31 cost time: 11.067576885223389
Epoch: 31, Steps: 208 | Train Loss: 0.354 Vali Loss: 7.307 Vali Acc: 0.109 Test Loss: 7.307 Test Acc: 0.109
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.2095012
	speed: 0.1929s/iter; left time: 2749.9151s
	iters: 200, epoch: 32 | loss: 0.1862250
	speed: 0.0474s/iter; left time: 671.3578s
Epoch: 32 cost time: 10.49294638633728
Epoch: 32, Steps: 208 | Train Loss: 0.341 Vali Loss: 8.040 Vali Acc: 0.120 Test Loss: 8.040 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.2676276
	speed: 0.1866s/iter; left time: 2621.4428s
	iters: 200, epoch: 33 | loss: 0.2806037
	speed: 0.0473s/iter; left time: 659.9055s
Epoch: 33 cost time: 10.3691725730896
Epoch: 33, Steps: 208 | Train Loss: 0.307 Vali Loss: 8.345 Vali Acc: 0.107 Test Loss: 8.345 Test Acc: 0.107
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12317327766179541
model parameter : 274731
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 6.0173583
	speed: 0.1137s/iter; left time: 2353.0725s
	iters: 200, epoch: 1 | loss: 5.1665907
	speed: 0.0856s/iter; left time: 1763.7010s
Epoch: 1 cost time: 20.74510955810547
Epoch: 1, Steps: 208 | Train Loss: 6.513 Vali Loss: 5.554 Vali Acc: 0.048 Test Loss: 5.554 Test Acc: 0.048
Validation loss decreased (inf --> -0.048259).  Saving model ...
	iters: 100, epoch: 2 | loss: 5.0266213
	speed: 0.2382s/iter; left time: 4882.1386s
	iters: 200, epoch: 2 | loss: 5.0937324
	speed: 0.1027s/iter; left time: 2093.9183s
Epoch: 2 cost time: 20.3624849319458
Epoch: 2, Steps: 208 | Train Loss: 4.840 Vali Loss: 4.564 Vali Acc: 0.026 Test Loss: 4.564 Test Acc: 0.026
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.4824491
	speed: 0.2408s/iter; left time: 4884.8351s
	iters: 200, epoch: 3 | loss: 4.7047572
	speed: 0.0956s/iter; left time: 1928.7173s
Epoch: 3 cost time: 19.81827712059021
Epoch: 3, Steps: 208 | Train Loss: 4.507 Vali Loss: 4.340 Vali Acc: 0.026 Test Loss: 4.340 Test Acc: 0.026
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 4.2635880
	speed: 0.2436s/iter; left time: 4890.7454s
	iters: 200, epoch: 4 | loss: 4.1885791
	speed: 0.0974s/iter; left time: 1946.0618s
Epoch: 4 cost time: 21.271480798721313
Epoch: 4, Steps: 208 | Train Loss: 4.313 Vali Loss: 4.170 Vali Acc: 0.026 Test Loss: 4.170 Test Acc: 0.026
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 3.8035786
	speed: 0.2355s/iter; left time: 4679.8458s
	iters: 200, epoch: 5 | loss: 4.8035355
	speed: 0.0879s/iter; left time: 1738.4920s
Epoch: 5 cost time: 19.309712886810303
Epoch: 5, Steps: 208 | Train Loss: 4.176 Vali Loss: 3.948 Vali Acc: 0.029 Test Loss: 3.948 Test Acc: 0.029
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 4.1702847
	speed: 0.2401s/iter; left time: 4721.1212s
	iters: 200, epoch: 6 | loss: 3.7498593
	speed: 0.0997s/iter; left time: 1949.5058s
Epoch: 6 cost time: 21.2315673828125
Epoch: 6, Steps: 208 | Train Loss: 3.914 Vali Loss: 3.795 Vali Acc: 0.041 Test Loss: 3.795 Test Acc: 0.041
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 3.7882369
	speed: 0.2320s/iter; left time: 4513.4961s
	iters: 200, epoch: 7 | loss: 3.3326802
	speed: 0.0847s/iter; left time: 1638.6686s
Epoch: 7 cost time: 18.012357234954834
Epoch: 7, Steps: 208 | Train Loss: 3.740 Vali Loss: 3.484 Vali Acc: 0.067 Test Loss: 3.484 Test Acc: 0.067
Validation loss decreased (-0.048259 --> -0.067367).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.5191174
	speed: 0.2379s/iter; left time: 4578.2601s
	iters: 200, epoch: 8 | loss: 3.0220768
	speed: 0.1022s/iter; left time: 1957.5546s
Epoch: 8 cost time: 20.866217851638794
Epoch: 8, Steps: 208 | Train Loss: 3.561 Vali Loss: 3.423 Vali Acc: 0.069 Test Loss: 3.423 Test Acc: 0.069
Validation loss decreased (-0.067367 --> -0.069456).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.4006193
	speed: 0.2429s/iter; left time: 4623.9558s
	iters: 200, epoch: 9 | loss: 3.5125945
	speed: 0.0974s/iter; left time: 1843.9539s
Epoch: 9 cost time: 20.04272222518921
Epoch: 9, Steps: 208 | Train Loss: 3.475 Vali Loss: 3.458 Vali Acc: 0.067 Test Loss: 3.458 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 3.5923305
	speed: 0.1883s/iter; left time: 3544.6382s
	iters: 200, epoch: 10 | loss: 3.5411925
	speed: 0.0671s/iter; left time: 1257.2574s
Epoch: 10 cost time: 14.983245134353638
Epoch: 10, Steps: 208 | Train Loss: 3.444 Vali Loss: 3.435 Vali Acc: 0.064 Test Loss: 3.435 Test Acc: 0.064
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 3.2199316
	speed: 0.2463s/iter; left time: 4587.2107s
	iters: 200, epoch: 11 | loss: 3.2278156
	speed: 0.0963s/iter; left time: 1783.4380s
Epoch: 11 cost time: 20.73659634590149
Epoch: 11, Steps: 208 | Train Loss: 3.405 Vali Loss: 3.460 Vali Acc: 0.072 Test Loss: 3.460 Test Acc: 0.072
Validation loss decreased (-0.069456 --> -0.072438).  Saving model ...
	iters: 100, epoch: 12 | loss: 3.3087711
	speed: 0.2414s/iter; left time: 4445.1617s
	iters: 200, epoch: 12 | loss: 3.1979964
	speed: 0.1040s/iter; left time: 1904.5944s
Epoch: 12 cost time: 20.5027859210968
Epoch: 12, Steps: 208 | Train Loss: 3.377 Vali Loss: 3.396 Vali Acc: 0.072 Test Loss: 3.396 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 3.1190917
	speed: 0.2717s/iter; left time: 4947.1315s
	iters: 200, epoch: 13 | loss: 3.4584780
	speed: 0.1104s/iter; left time: 1998.4018s
Epoch: 13 cost time: 23.137654781341553
Epoch: 13, Steps: 208 | Train Loss: 3.365 Vali Loss: 3.520 Vali Acc: 0.059 Test Loss: 3.520 Test Acc: 0.059
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 3.2937469
	speed: 0.2293s/iter; left time: 4127.0601s
	iters: 200, epoch: 14 | loss: 3.4958980
	speed: 0.0757s/iter; left time: 1355.3733s
Epoch: 14 cost time: 15.098302364349365
Epoch: 14, Steps: 208 | Train Loss: 3.345 Vali Loss: 3.345 Vali Acc: 0.081 Test Loss: 3.345 Test Acc: 0.081
Validation loss decreased (-0.072438 --> -0.081088).  Saving model ...
	iters: 100, epoch: 15 | loss: 3.2708254
	speed: 0.2352s/iter; left time: 4183.5924s
	iters: 200, epoch: 15 | loss: 3.0686049
	speed: 0.1015s/iter; left time: 1794.6662s
Epoch: 15 cost time: 21.664414882659912
Epoch: 15, Steps: 208 | Train Loss: 3.313 Vali Loss: 3.378 Vali Acc: 0.072 Test Loss: 3.378 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 3.4527040
	speed: 0.2477s/iter; left time: 4354.3683s
	iters: 200, epoch: 16 | loss: 3.4982133
	speed: 0.0989s/iter; left time: 1728.5908s
Epoch: 16 cost time: 21.46290373802185
Epoch: 16, Steps: 208 | Train Loss: 3.317 Vali Loss: 3.372 Vali Acc: 0.073 Test Loss: 3.372 Test Acc: 0.073
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 3.3708475
	speed: 0.2290s/iter; left time: 3978.5651s
	iters: 200, epoch: 17 | loss: 2.6573267
	speed: 0.0832s/iter; left time: 1437.1472s
Epoch: 17 cost time: 17.46466851234436
Epoch: 17, Steps: 208 | Train Loss: 3.317 Vali Loss: 3.315 Vali Acc: 0.080 Test Loss: 3.315 Test Acc: 0.080
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 3.0792782
	speed: 0.2385s/iter; left time: 4093.7316s
	iters: 200, epoch: 18 | loss: 3.6309152
	speed: 0.0892s/iter; left time: 1523.0438s
Epoch: 18 cost time: 19.83833360671997
Epoch: 18, Steps: 208 | Train Loss: 3.265 Vali Loss: 3.381 Vali Acc: 0.072 Test Loss: 3.381 Test Acc: 0.072
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 2.8973122
	speed: 0.2352s/iter; left time: 3987.9206s
	iters: 200, epoch: 19 | loss: 3.1586955
	speed: 0.0881s/iter; left time: 1484.5096s
Epoch: 19 cost time: 18.351275205612183
Epoch: 19, Steps: 208 | Train Loss: 3.234 Vali Loss: 3.338 Vali Acc: 0.078 Test Loss: 3.338 Test Acc: 0.078
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 2.7172251
	speed: 0.2282s/iter; left time: 3822.3833s
	iters: 200, epoch: 20 | loss: 3.2521117
	speed: 0.0970s/iter; left time: 1614.6501s
Epoch: 20 cost time: 20.059035539627075
Epoch: 20, Steps: 208 | Train Loss: 3.205 Vali Loss: 3.323 Vali Acc: 0.074 Test Loss: 3.323 Test Acc: 0.074
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 3.0866075
	speed: 0.2356s/iter; left time: 3896.9368s
	iters: 200, epoch: 21 | loss: 3.3911283
	speed: 0.0974s/iter; left time: 1602.0165s
Epoch: 21 cost time: 20.124694108963013
Epoch: 21, Steps: 208 | Train Loss: 3.199 Vali Loss: 3.458 Vali Acc: 0.067 Test Loss: 3.458 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 3.0168781
	speed: 0.2410s/iter; left time: 3935.6045s
	iters: 200, epoch: 22 | loss: 3.3296778
	speed: 0.0980s/iter; left time: 1590.2631s
Epoch: 22 cost time: 21.120768547058105
Epoch: 22, Steps: 208 | Train Loss: 3.245 Vali Loss: 3.326 Vali Acc: 0.088 Test Loss: 3.326 Test Acc: 0.088
Validation loss decreased (-0.081088 --> -0.088246).  Saving model ...
	iters: 100, epoch: 23 | loss: 3.4572647
	speed: 0.2368s/iter; left time: 3819.1661s
	iters: 200, epoch: 23 | loss: 3.1335194
	speed: 0.0913s/iter; left time: 1463.2558s
Epoch: 23 cost time: 18.98171305656433
Epoch: 23, Steps: 208 | Train Loss: 3.224 Vali Loss: 3.349 Vali Acc: 0.075 Test Loss: 3.349 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 3.1330378
	speed: 0.2428s/iter; left time: 3865.3251s
	iters: 200, epoch: 24 | loss: 3.4338727
	speed: 0.0817s/iter; left time: 1292.8568s
Epoch: 24 cost time: 19.32692313194275
Epoch: 24, Steps: 208 | Train Loss: 3.246 Vali Loss: 3.328 Vali Acc: 0.079 Test Loss: 3.328 Test Acc: 0.079
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 2.9332459
	speed: 0.2357s/iter; left time: 3702.7596s
	iters: 200, epoch: 25 | loss: 3.0106308
	speed: 0.0988s/iter; left time: 1542.4369s
Epoch: 25 cost time: 20.434977293014526
Epoch: 25, Steps: 208 | Train Loss: 3.230 Vali Loss: 3.460 Vali Acc: 0.077 Test Loss: 3.460 Test Acc: 0.077
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 3.0636714
	speed: 0.2438s/iter; left time: 3779.6793s
	iters: 200, epoch: 26 | loss: 3.4180713
	speed: 0.0951s/iter; left time: 1464.4835s
Epoch: 26 cost time: 19.490293979644775
Epoch: 26, Steps: 208 | Train Loss: 3.250 Vali Loss: 3.388 Vali Acc: 0.075 Test Loss: 3.388 Test Acc: 0.075
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 2.9404531
	speed: 0.2457s/iter; left time: 3758.1515s
	iters: 200, epoch: 27 | loss: 3.3795135
	speed: 0.0994s/iter; left time: 1509.6521s
Epoch: 27 cost time: 21.323156118392944
Epoch: 27, Steps: 208 | Train Loss: 3.248 Vali Loss: 3.345 Vali Acc: 0.081 Test Loss: 3.345 Test Acc: 0.081
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 2.7982061
	speed: 0.2684s/iter; left time: 4049.5323s
	iters: 200, epoch: 28 | loss: 3.0097492
	speed: 0.0939s/iter; left time: 1407.1014s
Epoch: 28 cost time: 21.746257781982422
Epoch: 28, Steps: 208 | Train Loss: 3.203 Vali Loss: 3.357 Vali Acc: 0.090 Test Loss: 3.357 Test Acc: 0.090
Validation loss decreased (-0.088246 --> -0.090333).  Saving model ...
	iters: 100, epoch: 29 | loss: 3.5813408
	speed: 0.2689s/iter; left time: 4000.8012s
	iters: 200, epoch: 29 | loss: 3.2421780
	speed: 0.0983s/iter; left time: 1453.1711s
Epoch: 29 cost time: 21.81242537498474
Epoch: 29, Steps: 208 | Train Loss: 3.254 Vali Loss: 3.339 Vali Acc: 0.084 Test Loss: 3.339 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 3.5034192
	speed: 0.2412s/iter; left time: 3538.4169s
	iters: 200, epoch: 30 | loss: 3.0413122
	speed: 0.0780s/iter; left time: 1135.9877s
Epoch: 30 cost time: 17.00218176841736
Epoch: 30, Steps: 208 | Train Loss: 3.242 Vali Loss: 3.368 Vali Acc: 0.085 Test Loss: 3.368 Test Acc: 0.085
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 3.2178974
	speed: 0.2709s/iter; left time: 3917.5268s
	iters: 200, epoch: 31 | loss: 3.2390654
	speed: 0.1085s/iter; left time: 1558.6230s
Epoch: 31 cost time: 22.92799711227417
Epoch: 31, Steps: 208 | Train Loss: 3.235 Vali Loss: 3.452 Vali Acc: 0.083 Test Loss: 3.452 Test Acc: 0.083
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 3.1694446
	speed: 0.2171s/iter; left time: 3094.8273s
	iters: 200, epoch: 32 | loss: 3.1231570
	speed: 0.0861s/iter; left time: 1218.0636s
Epoch: 32 cost time: 17.639265537261963
Epoch: 32, Steps: 208 | Train Loss: 3.192 Vali Loss: 3.356 Vali Acc: 0.087 Test Loss: 3.356 Test Acc: 0.087
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 3.0489895
	speed: 0.2352s/iter; left time: 3303.5167s
	iters: 200, epoch: 33 | loss: 3.1034880
	speed: 0.0934s/iter; left time: 1302.7764s
Epoch: 33 cost time: 20.47403860092163
Epoch: 33, Steps: 208 | Train Loss: 3.179 Vali Loss: 3.303 Vali Acc: 0.087 Test Loss: 3.303 Test Acc: 0.087
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 3.0202818
	speed: 0.2377s/iter; left time: 3288.8414s
	iters: 200, epoch: 34 | loss: 3.0080755
	speed: 0.0856s/iter; left time: 1175.7831s
Epoch: 34 cost time: 18.878560304641724
Epoch: 34, Steps: 208 | Train Loss: 3.186 Vali Loss: 3.333 Vali Acc: 0.084 Test Loss: 3.333 Test Acc: 0.084
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 2.9212458
	speed: 0.2408s/iter; left time: 3281.4374s
	iters: 200, epoch: 35 | loss: 3.0632980
	speed: 0.0952s/iter; left time: 1288.2236s
Epoch: 35 cost time: 20.615177154541016
Epoch: 35, Steps: 208 | Train Loss: 3.158 Vali Loss: 3.440 Vali Acc: 0.080 Test Loss: 3.440 Test Acc: 0.080
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 3.3664336
	speed: 0.2135s/iter; left time: 2864.9656s
	iters: 200, epoch: 36 | loss: 3.0071676
	speed: 0.0816s/iter; left time: 1086.7228s
Epoch: 36 cost time: 16.555765867233276
Epoch: 36, Steps: 208 | Train Loss: 3.143 Vali Loss: 3.391 Vali Acc: 0.092 Test Loss: 3.391 Test Acc: 0.092
Validation loss decreased (-0.090333 --> -0.091526).  Saving model ...
	iters: 100, epoch: 37 | loss: 3.3308201
	speed: 0.2403s/iter; left time: 3174.6068s
	iters: 200, epoch: 37 | loss: 2.8845062
	speed: 0.0760s/iter; left time: 995.9461s
Epoch: 37 cost time: 17.5185067653656
Epoch: 37, Steps: 208 | Train Loss: 3.137 Vali Loss: 3.390 Vali Acc: 0.081 Test Loss: 3.390 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 38 | loss: 3.0779493
	speed: 0.1637s/iter; left time: 2128.4868s
	iters: 200, epoch: 38 | loss: 3.4911447
	speed: 0.0541s/iter; left time: 698.3697s
Epoch: 38 cost time: 12.113916873931885
Epoch: 38, Steps: 208 | Train Loss: 3.122 Vali Loss: 3.338 Vali Acc: 0.084 Test Loss: 3.338 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 39 | loss: 3.2465777
	speed: 0.1873s/iter; left time: 2396.7543s
	iters: 200, epoch: 39 | loss: 3.1705208
	speed: 0.0588s/iter; left time: 746.8716s
Epoch: 39 cost time: 12.461243867874146
Epoch: 39, Steps: 208 | Train Loss: 3.140 Vali Loss: 3.341 Vali Acc: 0.073 Test Loss: 3.341 Test Acc: 0.073
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 40 | loss: 3.3005185
	speed: 0.2316s/iter; left time: 2915.0212s
	iters: 200, epoch: 40 | loss: 2.9317176
	speed: 0.1013s/iter; left time: 1265.5029s
Epoch: 40 cost time: 20.50553822517395
Epoch: 40, Steps: 208 | Train Loss: 3.135 Vali Loss: 3.370 Vali Acc: 0.083 Test Loss: 3.370 Test Acc: 0.083
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 41 | loss: 2.4375777
	speed: 0.2284s/iter; left time: 2827.3910s
	iters: 200, epoch: 41 | loss: 3.4618189
	speed: 0.0999s/iter; left time: 1226.6500s
Epoch: 41 cost time: 19.208624839782715
Epoch: 41, Steps: 208 | Train Loss: 3.157 Vali Loss: 3.407 Vali Acc: 0.081 Test Loss: 3.407 Test Acc: 0.081
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 42 | loss: 2.9449830
	speed: 0.2473s/iter; left time: 3010.7368s
	iters: 200, epoch: 42 | loss: 3.0348139
	speed: 0.0944s/iter; left time: 1139.5525s
Epoch: 42 cost time: 20.67368745803833
Epoch: 42, Steps: 208 | Train Loss: 3.123 Vali Loss: 3.385 Vali Acc: 0.072 Test Loss: 3.385 Test Acc: 0.072
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 43 | loss: 3.1767972
	speed: 0.2460s/iter; left time: 2943.0886s
	iters: 200, epoch: 43 | loss: 3.3897448
	speed: 0.1043s/iter; left time: 1237.7438s
Epoch: 43 cost time: 21.92028784751892
Epoch: 43, Steps: 208 | Train Loss: 3.122 Vali Loss: 3.382 Vali Acc: 0.079 Test Loss: 3.382 Test Acc: 0.079
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 44 | loss: 3.6103010
	speed: 0.2682s/iter; left time: 3153.7618s
	iters: 200, epoch: 44 | loss: 3.1780953
	speed: 0.0813s/iter; left time: 947.4976s
Epoch: 44 cost time: 20.445155143737793
Epoch: 44, Steps: 208 | Train Loss: 3.116 Vali Loss: 3.402 Vali Acc: 0.086 Test Loss: 3.402 Test Acc: 0.086
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 45 | loss: 3.0971410
	speed: 0.2580s/iter; left time: 2979.3181s
	iters: 200, epoch: 45 | loss: 3.3544083
	speed: 0.1124s/iter; left time: 1286.7553s
Epoch: 45 cost time: 22.42247748374939
Epoch: 45, Steps: 208 | Train Loss: 3.103 Vali Loss: 3.401 Vali Acc: 0.083 Test Loss: 3.401 Test Acc: 0.083
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 46 | loss: 2.5630724
	speed: 0.2606s/iter; left time: 2956.0143s
	iters: 200, epoch: 46 | loss: 3.2110660
	speed: 0.1029s/iter; left time: 1156.5512s
Epoch: 46 cost time: 21.505818605422974
Epoch: 46, Steps: 208 | Train Loss: 3.099 Vali Loss: 3.367 Vali Acc: 0.081 Test Loss: 3.367 Test Acc: 0.081
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09155979719654041
model parameter : 6913087
model size : 31.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.1971869
	speed: 0.0875s/iter; left time: 1810.4841s
	iters: 200, epoch: 1 | loss: 5.2708549
	speed: 0.0831s/iter; left time: 1711.7701s
Epoch: 1 cost time: 17.807384729385376
Epoch: 1, Steps: 208 | Train Loss: 6.464 Vali Loss: 5.203 Vali Acc: 0.050 Test Loss: 5.203 Test Acc: 0.050
Validation loss decreased (inf --> -0.049456).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9066226
	speed: 0.2127s/iter; left time: 4358.8613s
	iters: 200, epoch: 2 | loss: 4.6368675
	speed: 0.0838s/iter; left time: 1708.6576s
Epoch: 2 cost time: 16.502840757369995
Epoch: 2, Steps: 208 | Train Loss: 4.911 Vali Loss: 4.677 Vali Acc: 0.026 Test Loss: 4.677 Test Acc: 0.026
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.9412465
	speed: 0.2217s/iter; left time: 4496.6540s
	iters: 200, epoch: 3 | loss: 5.0023117
	speed: 0.0810s/iter; left time: 1635.4086s
Epoch: 3 cost time: 17.190840482711792
Epoch: 3, Steps: 208 | Train Loss: 4.614 Vali Loss: 4.486 Vali Acc: 0.026 Test Loss: 4.486 Test Acc: 0.026
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 4.1667948
	speed: 0.2137s/iter; left time: 4290.0798s
	iters: 200, epoch: 4 | loss: 4.4995661
	speed: 0.0789s/iter; left time: 1576.8510s
Epoch: 4 cost time: 16.041584968566895
Epoch: 4, Steps: 208 | Train Loss: 4.443 Vali Loss: 5.070 Vali Acc: 0.026 Test Loss: 5.070 Test Acc: 0.026
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 4.1094666
	speed: 0.2234s/iter; left time: 4439.3850s
	iters: 200, epoch: 5 | loss: 3.5627747
	speed: 0.0860s/iter; left time: 1700.1910s
Epoch: 5 cost time: 17.979864597320557
Epoch: 5, Steps: 208 | Train Loss: 4.320 Vali Loss: 3.952 Vali Acc: 0.026 Test Loss: 3.952 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 3.4783487
	speed: 0.2241s/iter; left time: 4405.8228s
	iters: 200, epoch: 6 | loss: 3.4854069
	speed: 0.0817s/iter; left time: 1597.1861s
Epoch: 6 cost time: 17.388367652893066
Epoch: 6, Steps: 208 | Train Loss: 4.006 Vali Loss: 3.934 Vali Acc: 0.035 Test Loss: 3.934 Test Acc: 0.035
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 3.7969835
	speed: 0.2176s/iter; left time: 4233.5857s
	iters: 200, epoch: 7 | loss: 3.4694614
	speed: 0.0817s/iter; left time: 1581.9229s
Epoch: 7 cost time: 17.111542463302612
Epoch: 7, Steps: 208 | Train Loss: 3.822 Vali Loss: 3.602 Vali Acc: 0.041 Test Loss: 3.602 Test Acc: 0.041
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 3.7568738
	speed: 0.2219s/iter; left time: 4270.0201s
	iters: 200, epoch: 8 | loss: 3.3291895
	speed: 0.0777s/iter; left time: 1487.7200s
Epoch: 8 cost time: 16.906373262405396
Epoch: 8, Steps: 208 | Train Loss: 3.567 Vali Loss: 3.431 Vali Acc: 0.069 Test Loss: 3.431 Test Acc: 0.069
Validation loss decreased (-0.049456 --> -0.069157).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.1545460
	speed: 0.2325s/iter; left time: 4426.3315s
	iters: 200, epoch: 9 | loss: 3.0467033
	speed: 0.0840s/iter; left time: 1590.7988s
Epoch: 9 cost time: 18.065481185913086
Epoch: 9, Steps: 208 | Train Loss: 3.481 Vali Loss: 3.440 Vali Acc: 0.076 Test Loss: 3.440 Test Acc: 0.076
Validation loss decreased (-0.069157 --> -0.076315).  Saving model ...
	iters: 100, epoch: 10 | loss: 3.7016082
	speed: 0.2230s/iter; left time: 4198.0214s
	iters: 200, epoch: 10 | loss: 3.1674776
	speed: 0.0747s/iter; left time: 1398.7469s
Epoch: 10 cost time: 16.242284536361694
Epoch: 10, Steps: 208 | Train Loss: 3.429 Vali Loss: 3.343 Vali Acc: 0.067 Test Loss: 3.343 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 3.6720490
	speed: 0.2214s/iter; left time: 4121.8973s
	iters: 200, epoch: 11 | loss: 3.3311152
	speed: 0.0792s/iter; left time: 1466.5641s
Epoch: 11 cost time: 17.117250680923462
Epoch: 11, Steps: 208 | Train Loss: 3.402 Vali Loss: 3.349 Vali Acc: 0.056 Test Loss: 3.349 Test Acc: 0.056
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 3.4808285
	speed: 0.2237s/iter; left time: 4118.7024s
	iters: 200, epoch: 12 | loss: 3.6005902
	speed: 0.0754s/iter; left time: 1381.4024s
Epoch: 12 cost time: 16.47130250930786
Epoch: 12, Steps: 208 | Train Loss: 3.367 Vali Loss: 3.403 Vali Acc: 0.069 Test Loss: 3.403 Test Acc: 0.069
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 3.0210662
	speed: 0.2288s/iter; left time: 4165.0229s
	iters: 200, epoch: 13 | loss: 3.3029628
	speed: 0.0842s/iter; left time: 1524.5023s
Epoch: 13 cost time: 18.325315952301025
Epoch: 13, Steps: 208 | Train Loss: 3.327 Vali Loss: 3.342 Vali Acc: 0.079 Test Loss: 3.342 Test Acc: 0.079
Validation loss decreased (-0.076315 --> -0.078702).  Saving model ...
	iters: 100, epoch: 14 | loss: 3.2530768
	speed: 0.2474s/iter; left time: 4451.6088s
	iters: 200, epoch: 14 | loss: 3.5007036
	speed: 0.0751s/iter; left time: 1344.6797s
Epoch: 14 cost time: 16.682146310806274
Epoch: 14, Steps: 208 | Train Loss: 3.279 Vali Loss: 3.391 Vali Acc: 0.072 Test Loss: 3.391 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 3.3804624
	speed: 0.2526s/iter; left time: 4493.9552s
	iters: 200, epoch: 15 | loss: 3.3799257
	speed: 0.0899s/iter; left time: 1590.9372s
Epoch: 15 cost time: 18.96337342262268
Epoch: 15, Steps: 208 | Train Loss: 3.295 Vali Loss: 3.331 Vali Acc: 0.069 Test Loss: 3.331 Test Acc: 0.069
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 3.1138852
	speed: 0.2324s/iter; left time: 4085.0373s
	iters: 200, epoch: 16 | loss: 3.4877758
	speed: 0.0917s/iter; left time: 1602.2889s
Epoch: 16 cost time: 17.92380976676941
Epoch: 16, Steps: 208 | Train Loss: 3.237 Vali Loss: 3.317 Vali Acc: 0.091 Test Loss: 3.317 Test Acc: 0.091
Validation loss decreased (-0.078702 --> -0.090930).  Saving model ...
	iters: 100, epoch: 17 | loss: 3.0383370
	speed: 0.2444s/iter; left time: 4246.6489s
	iters: 200, epoch: 17 | loss: 3.3477666
	speed: 0.0804s/iter; left time: 1388.8053s
Epoch: 17 cost time: 17.488234758377075
Epoch: 17, Steps: 208 | Train Loss: 3.230 Vali Loss: 3.306 Vali Acc: 0.088 Test Loss: 3.306 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 3.1415367
	speed: 0.2113s/iter; left time: 3627.3071s
	iters: 200, epoch: 18 | loss: 3.3300059
	speed: 0.0796s/iter; left time: 1359.0709s
Epoch: 18 cost time: 15.840811729431152
Epoch: 18, Steps: 208 | Train Loss: 3.203 Vali Loss: 3.334 Vali Acc: 0.085 Test Loss: 3.334 Test Acc: 0.085
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 2.9635925
	speed: 0.2221s/iter; left time: 3765.4085s
	iters: 200, epoch: 19 | loss: 3.2501047
	speed: 0.0835s/iter; left time: 1407.6874s
Epoch: 19 cost time: 17.31602716445923
Epoch: 19, Steps: 208 | Train Loss: 3.174 Vali Loss: 3.299 Vali Acc: 0.086 Test Loss: 3.299 Test Acc: 0.086
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 3.3293917
	speed: 0.2194s/iter; left time: 3674.1688s
	iters: 200, epoch: 20 | loss: 3.3230484
	speed: 0.0818s/iter; left time: 1362.4679s
Epoch: 20 cost time: 16.59739351272583
Epoch: 20, Steps: 208 | Train Loss: 3.161 Vali Loss: 3.294 Vali Acc: 0.087 Test Loss: 3.294 Test Acc: 0.087
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 3.1402490
	speed: 0.2284s/iter; left time: 3778.4222s
	iters: 200, epoch: 21 | loss: 3.2874653
	speed: 0.0842s/iter; left time: 1383.5908s
Epoch: 21 cost time: 17.78792929649353
Epoch: 21, Steps: 208 | Train Loss: 3.149 Vali Loss: 3.280 Vali Acc: 0.090 Test Loss: 3.280 Test Acc: 0.090
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 3.1425734
	speed: 0.2236s/iter; left time: 3651.4235s
	iters: 200, epoch: 22 | loss: 3.0623231
	speed: 0.0755s/iter; left time: 1225.9327s
Epoch: 22 cost time: 16.03296422958374
Epoch: 22, Steps: 208 | Train Loss: 3.129 Vali Loss: 3.303 Vali Acc: 0.083 Test Loss: 3.303 Test Acc: 0.083
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 3.2145030
	speed: 0.1915s/iter; left time: 3087.1655s
	iters: 200, epoch: 23 | loss: 3.2221038
	speed: 0.0546s/iter; left time: 874.3310s
Epoch: 23 cost time: 12.50940489768982
Epoch: 23, Steps: 208 | Train Loss: 3.179 Vali Loss: 3.307 Vali Acc: 0.087 Test Loss: 3.307 Test Acc: 0.087
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 2.8271186
	speed: 0.2108s/iter; left time: 3354.5453s
	iters: 200, epoch: 24 | loss: 3.3978298
	speed: 0.0786s/iter; left time: 1242.8797s
Epoch: 24 cost time: 17.119444131851196
Epoch: 24, Steps: 208 | Train Loss: 3.184 Vali Loss: 3.340 Vali Acc: 0.084 Test Loss: 3.340 Test Acc: 0.084
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 3.2476008
	speed: 0.2139s/iter; left time: 3360.6421s
	iters: 200, epoch: 25 | loss: 3.1240306
	speed: 0.0660s/iter; left time: 1030.5008s
Epoch: 25 cost time: 15.106913805007935
Epoch: 25, Steps: 208 | Train Loss: 3.196 Vali Loss: 3.294 Vali Acc: 0.083 Test Loss: 3.294 Test Acc: 0.083
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 3.3068514
	speed: 0.2124s/iter; left time: 3292.2267s
	iters: 200, epoch: 26 | loss: 3.9134402
	speed: 0.0703s/iter; left time: 1083.3042s
Epoch: 26 cost time: 16.025316953659058
Epoch: 26, Steps: 208 | Train Loss: 3.240 Vali Loss: 3.323 Vali Acc: 0.083 Test Loss: 3.323 Test Acc: 0.083
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09096331643304503
model parameter : 6908223
model size : 31.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 8.4220829
	speed: 0.0975s/iter; left time: 2019.0760s
	iters: 200, epoch: 1 | loss: 5.7208605
	speed: 0.0782s/iter; left time: 1611.2691s
Epoch: 1 cost time: 18.11891484260559
Epoch: 1, Steps: 208 | Train Loss: 6.103 Vali Loss: 5.577 Vali Acc: 0.030 Test Loss: 5.577 Test Acc: 0.030
Validation loss decreased (inf --> -0.030365).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.7712455
	speed: 0.2076s/iter; left time: 4255.2017s
	iters: 200, epoch: 2 | loss: 4.0182791
	speed: 0.0689s/iter; left time: 1404.6309s
Epoch: 2 cost time: 15.33946180343628
Epoch: 2, Steps: 208 | Train Loss: 4.509 Vali Loss: 4.086 Vali Acc: 0.046 Test Loss: 4.086 Test Acc: 0.046
Validation loss decreased (-0.030365 --> -0.045590).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.8147054
	speed: 0.2195s/iter; left time: 4451.6389s
	iters: 200, epoch: 3 | loss: 3.7934239
	speed: 0.0727s/iter; left time: 1467.2956s
Epoch: 3 cost time: 16.09058141708374
Epoch: 3, Steps: 208 | Train Loss: 4.309 Vali Loss: 4.143 Vali Acc: 0.046 Test Loss: 4.143 Test Acc: 0.046
Validation loss decreased (-0.045590 --> -0.046186).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.2162352
	speed: 0.2375s/iter; left time: 4767.9625s
	iters: 200, epoch: 4 | loss: 3.8040318
	speed: 0.0794s/iter; left time: 1585.4284s
Epoch: 4 cost time: 16.997259855270386
Epoch: 4, Steps: 208 | Train Loss: 4.089 Vali Loss: 3.949 Vali Acc: 0.047 Test Loss: 3.949 Test Acc: 0.047
Validation loss decreased (-0.046186 --> -0.046486).  Saving model ...
	iters: 100, epoch: 5 | loss: 4.1781054
	speed: 0.2451s/iter; left time: 4870.7495s
	iters: 200, epoch: 5 | loss: 4.2265348
	speed: 0.0817s/iter; left time: 1615.2309s
Epoch: 5 cost time: 18.172280073165894
Epoch: 5, Steps: 208 | Train Loss: 3.789 Vali Loss: 3.752 Vali Acc: 0.065 Test Loss: 3.752 Test Acc: 0.065
Validation loss decreased (-0.046486 --> -0.064681).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.5296171
	speed: 0.2203s/iter; left time: 4330.8542s
	iters: 200, epoch: 6 | loss: 4.0915747
	speed: 0.0807s/iter; left time: 1577.6685s
Epoch: 6 cost time: 15.853123188018799
Epoch: 6, Steps: 208 | Train Loss: 3.541 Vali Loss: 3.572 Vali Acc: 0.061 Test Loss: 3.572 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.7757485
	speed: 0.2357s/iter; left time: 4585.6119s
	iters: 200, epoch: 7 | loss: 3.9334872
	speed: 0.0818s/iter; left time: 1583.3181s
Epoch: 7 cost time: 17.291338205337524
Epoch: 7, Steps: 208 | Train Loss: 3.792 Vali Loss: 3.894 Vali Acc: 0.024 Test Loss: 3.894 Test Acc: 0.024
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.6805634
	speed: 0.2171s/iter; left time: 4178.9792s
	iters: 200, epoch: 8 | loss: 3.6615515
	speed: 0.0666s/iter; left time: 1275.6424s
Epoch: 8 cost time: 14.523582696914673
Epoch: 8, Steps: 208 | Train Loss: 3.855 Vali Loss: 3.642 Vali Acc: 0.050 Test Loss: 3.642 Test Acc: 0.050
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 3.3159459
	speed: 0.1510s/iter; left time: 2874.1760s
	iters: 200, epoch: 9 | loss: 3.0740569
	speed: 0.0454s/iter; left time: 859.3371s
Epoch: 9 cost time: 10.294069766998291
Epoch: 9, Steps: 208 | Train Loss: 3.588 Vali Loss: 3.556 Vali Acc: 0.057 Test Loss: 3.556 Test Acc: 0.057
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 3.3940766
	speed: 0.2278s/iter; left time: 4289.4307s
	iters: 200, epoch: 10 | loss: 3.1993208
	speed: 0.0753s/iter; left time: 1410.8953s
Epoch: 10 cost time: 16.03521227836609
Epoch: 10, Steps: 208 | Train Loss: 3.444 Vali Loss: 3.426 Vali Acc: 0.069 Test Loss: 3.426 Test Acc: 0.069
Validation loss decreased (-0.064681 --> -0.069456).  Saving model ...
	iters: 100, epoch: 11 | loss: 3.5441101
	speed: 0.2179s/iter; left time: 4056.8642s
	iters: 200, epoch: 11 | loss: 3.0158174
	speed: 0.0697s/iter; left time: 1290.2103s
Epoch: 11 cost time: 15.43864130973816
Epoch: 11, Steps: 208 | Train Loss: 3.399 Vali Loss: 3.387 Vali Acc: 0.071 Test Loss: 3.387 Test Acc: 0.071
Validation loss decreased (-0.069456 --> -0.070947).  Saving model ...
	iters: 100, epoch: 12 | loss: 3.1115043
	speed: 0.2176s/iter; left time: 4006.3829s
	iters: 200, epoch: 12 | loss: 3.2825809
	speed: 0.0824s/iter; left time: 1509.4393s
Epoch: 12 cost time: 16.78060483932495
Epoch: 12, Steps: 208 | Train Loss: 3.343 Vali Loss: 3.508 Vali Acc: 0.071 Test Loss: 3.508 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 3.1782198
	speed: 0.1994s/iter; left time: 3630.1943s
	iters: 200, epoch: 13 | loss: 3.3988385
	speed: 0.0765s/iter; left time: 1384.3833s
Epoch: 13 cost time: 14.814913988113403
Epoch: 13, Steps: 208 | Train Loss: 3.369 Vali Loss: 3.400 Vali Acc: 0.064 Test Loss: 3.400 Test Acc: 0.064
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 3.2761898
	speed: 0.2117s/iter; left time: 3809.2047s
	iters: 200, epoch: 14 | loss: 3.0731716
	speed: 0.0806s/iter; left time: 1442.8155s
Epoch: 14 cost time: 16.229562759399414
Epoch: 14, Steps: 208 | Train Loss: 3.324 Vali Loss: 3.485 Vali Acc: 0.077 Test Loss: 3.485 Test Acc: 0.077
Validation loss decreased (-0.070947 --> -0.077209).  Saving model ...
	iters: 100, epoch: 15 | loss: 3.0916667
	speed: 0.2142s/iter; left time: 3810.5669s
	iters: 200, epoch: 15 | loss: 3.1476028
	speed: 0.0750s/iter; left time: 1327.3338s
Epoch: 15 cost time: 15.616771936416626
Epoch: 15, Steps: 208 | Train Loss: 3.295 Vali Loss: 3.349 Vali Acc: 0.078 Test Loss: 3.349 Test Acc: 0.078
Validation loss decreased (-0.077209 --> -0.077509).  Saving model ...
	iters: 100, epoch: 16 | loss: 3.3921211
	speed: 0.2264s/iter; left time: 3981.0298s
	iters: 200, epoch: 16 | loss: 3.1512134
	speed: 0.0847s/iter; left time: 1479.9679s
Epoch: 16 cost time: 17.78387689590454
Epoch: 16, Steps: 208 | Train Loss: 3.244 Vali Loss: 3.300 Vali Acc: 0.092 Test Loss: 3.300 Test Acc: 0.092
Validation loss decreased (-0.077509 --> -0.092422).  Saving model ...
	iters: 100, epoch: 17 | loss: 3.0754633
	speed: 0.2155s/iter; left time: 3743.1369s
	iters: 200, epoch: 17 | loss: 3.7287903
	speed: 0.0757s/iter; left time: 1307.8133s
Epoch: 17 cost time: 15.734954357147217
Epoch: 17, Steps: 208 | Train Loss: 3.212 Vali Loss: 3.299 Vali Acc: 0.085 Test Loss: 3.299 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 3.1986380
	speed: 0.2170s/iter; left time: 3723.9561s
	iters: 200, epoch: 18 | loss: 3.3060665
	speed: 0.0793s/iter; left time: 1352.5763s
Epoch: 18 cost time: 17.038517475128174
Epoch: 18, Steps: 208 | Train Loss: 3.205 Vali Loss: 3.307 Vali Acc: 0.097 Test Loss: 3.307 Test Acc: 0.097
Validation loss decreased (-0.092422 --> -0.096597).  Saving model ...
	iters: 100, epoch: 19 | loss: 3.1371279
	speed: 0.2199s/iter; left time: 3728.6709s
	iters: 200, epoch: 19 | loss: 3.2526133
	speed: 0.0789s/iter; left time: 1329.7506s
Epoch: 19 cost time: 16.28561806678772
Epoch: 19, Steps: 208 | Train Loss: 3.176 Vali Loss: 3.290 Vali Acc: 0.088 Test Loss: 3.290 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 3.0576108
	speed: 0.2144s/iter; left time: 3590.1582s
	iters: 200, epoch: 20 | loss: 2.9618034
	speed: 0.0811s/iter; left time: 1350.3431s
Epoch: 20 cost time: 17.239619493484497
Epoch: 20, Steps: 208 | Train Loss: 3.163 Vali Loss: 3.252 Vali Acc: 0.097 Test Loss: 3.252 Test Acc: 0.097
Validation loss decreased (-0.096597 --> -0.096896).  Saving model ...
	iters: 100, epoch: 21 | loss: 3.5974357
	speed: 0.2257s/iter; left time: 3733.5360s
	iters: 200, epoch: 21 | loss: 3.0582066
	speed: 0.0694s/iter; left time: 1140.4747s
Epoch: 21 cost time: 16.495187520980835
Epoch: 21, Steps: 208 | Train Loss: 3.132 Vali Loss: 3.300 Vali Acc: 0.093 Test Loss: 3.300 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 3.4025173
	speed: 0.2440s/iter; left time: 3985.3925s
	iters: 200, epoch: 22 | loss: 2.8614535
	speed: 0.0866s/iter; left time: 1405.5054s
Epoch: 22 cost time: 18.768289804458618
Epoch: 22, Steps: 208 | Train Loss: 3.141 Vali Loss: 3.289 Vali Acc: 0.088 Test Loss: 3.289 Test Acc: 0.088
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 3.2832069
	speed: 0.2424s/iter; left time: 3908.6202s
	iters: 200, epoch: 23 | loss: 3.0030391
	speed: 0.0747s/iter; left time: 1197.7016s
Epoch: 23 cost time: 17.162980794906616
Epoch: 23, Steps: 208 | Train Loss: 3.150 Vali Loss: 3.305 Vali Acc: 0.089 Test Loss: 3.305 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 3.2652640
	speed: 0.2454s/iter; left time: 3905.6881s
	iters: 200, epoch: 24 | loss: 3.0900271
	speed: 0.0863s/iter; left time: 1364.5828s
Epoch: 24 cost time: 18.884372234344482
Epoch: 24, Steps: 208 | Train Loss: 3.136 Vali Loss: 3.215 Vali Acc: 0.092 Test Loss: 3.215 Test Acc: 0.092
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 3.0648143
	speed: 0.2262s/iter; left time: 3553.1727s
	iters: 200, epoch: 25 | loss: 2.8683865
	speed: 0.0608s/iter; left time: 948.7739s
Epoch: 25 cost time: 14.847850322723389
Epoch: 25, Steps: 208 | Train Loss: 3.091 Vali Loss: 3.324 Vali Acc: 0.092 Test Loss: 3.324 Test Acc: 0.092
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 3.0734110
	speed: 0.1785s/iter; left time: 2766.6970s
	iters: 200, epoch: 26 | loss: 3.1989682
	speed: 0.0521s/iter; left time: 802.1470s
Epoch: 26 cost time: 11.490764141082764
Epoch: 26, Steps: 208 | Train Loss: 3.106 Vali Loss: 3.270 Vali Acc: 0.101 Test Loss: 3.270 Test Acc: 0.101
Validation loss decreased (-0.096896 --> -0.101071).  Saving model ...
	iters: 100, epoch: 27 | loss: 2.5960038
	speed: 0.2121s/iter; left time: 3243.6002s
	iters: 200, epoch: 27 | loss: 3.0152287
	speed: 0.0808s/iter; left time: 1227.7000s
Epoch: 27 cost time: 16.959209442138672
Epoch: 27, Steps: 208 | Train Loss: 3.093 Vali Loss: 3.251 Vali Acc: 0.099 Test Loss: 3.251 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 2.8155835
	speed: 0.2123s/iter; left time: 3202.1263s
	iters: 200, epoch: 28 | loss: 3.4611535
	speed: 0.0681s/iter; left time: 1020.1186s
Epoch: 28 cost time: 14.81316089630127
Epoch: 28, Steps: 208 | Train Loss: 3.063 Vali Loss: 3.207 Vali Acc: 0.092 Test Loss: 3.207 Test Acc: 0.092
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 3.0938003
	speed: 0.2110s/iter; left time: 3139.4838s
	iters: 200, epoch: 29 | loss: 3.1728456
	speed: 0.0779s/iter; left time: 1151.1418s
Epoch: 29 cost time: 16.35991883277893
Epoch: 29, Steps: 208 | Train Loss: 3.062 Vali Loss: 3.221 Vali Acc: 0.102 Test Loss: 3.221 Test Acc: 0.102
Validation loss decreased (-0.101071 --> -0.102264).  Saving model ...
	iters: 100, epoch: 30 | loss: 3.0783310
	speed: 0.2079s/iter; left time: 3050.3597s
	iters: 200, epoch: 30 | loss: 3.1703537
	speed: 0.0662s/iter; left time: 964.9709s
Epoch: 30 cost time: 14.254005908966064
Epoch: 30, Steps: 208 | Train Loss: 3.080 Vali Loss: 3.286 Vali Acc: 0.101 Test Loss: 3.286 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 3.0452664
	speed: 0.2160s/iter; left time: 3123.5861s
	iters: 200, epoch: 31 | loss: 2.8074563
	speed: 0.0792s/iter; left time: 1137.2426s
Epoch: 31 cost time: 16.813445568084717
Epoch: 31, Steps: 208 | Train Loss: 3.032 Vali Loss: 3.252 Vali Acc: 0.093 Test Loss: 3.252 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 3.1071193
	speed: 0.2058s/iter; left time: 2932.8241s
	iters: 200, epoch: 32 | loss: 3.0010381
	speed: 0.0675s/iter; left time: 955.8221s
Epoch: 32 cost time: 14.453457355499268
Epoch: 32, Steps: 208 | Train Loss: 3.065 Vali Loss: 3.236 Vali Acc: 0.092 Test Loss: 3.236 Test Acc: 0.092
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 3.2229650
	speed: 0.2134s/iter; left time: 2996.5203s
	iters: 200, epoch: 33 | loss: 3.1932256
	speed: 0.0706s/iter; left time: 984.1452s
Epoch: 33 cost time: 15.986553430557251
Epoch: 33, Steps: 208 | Train Loss: 3.063 Vali Loss: 3.260 Vali Acc: 0.089 Test Loss: 3.260 Test Acc: 0.089
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 2.7092743
	speed: 0.2124s/iter; left time: 2938.5387s
	iters: 200, epoch: 34 | loss: 2.7770038
	speed: 0.0671s/iter; left time: 921.6675s
Epoch: 34 cost time: 15.003046989440918
Epoch: 34, Steps: 208 | Train Loss: 3.035 Vali Loss: 3.214 Vali Acc: 0.103 Test Loss: 3.214 Test Acc: 0.103
Validation loss decreased (-0.102264 --> -0.103159).  Saving model ...
	iters: 100, epoch: 35 | loss: 3.3783901
	speed: 0.2125s/iter; left time: 2895.5112s
	iters: 200, epoch: 35 | loss: 2.8954554
	speed: 0.0710s/iter; left time: 961.2220s
Epoch: 35 cost time: 15.760175704956055
Epoch: 35, Steps: 208 | Train Loss: 3.020 Vali Loss: 3.263 Vali Acc: 0.098 Test Loss: 3.263 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 3.3343756
	speed: 0.2114s/iter; left time: 2837.3985s
	iters: 200, epoch: 36 | loss: 3.3652456
	speed: 0.0697s/iter; left time: 928.7312s
Epoch: 36 cost time: 15.732087850570679
Epoch: 36, Steps: 208 | Train Loss: 3.012 Vali Loss: 3.215 Vali Acc: 0.100 Test Loss: 3.215 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 3.2134221
	speed: 0.2216s/iter; left time: 2927.8339s
	iters: 200, epoch: 37 | loss: 3.1547871
	speed: 0.0740s/iter; left time: 970.5670s
Epoch: 37 cost time: 16.405019760131836
Epoch: 37, Steps: 208 | Train Loss: 3.021 Vali Loss: 3.367 Vali Acc: 0.091 Test Loss: 3.367 Test Acc: 0.091
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 2.8244648
	speed: 0.2031s/iter; left time: 2640.9350s
	iters: 200, epoch: 38 | loss: 3.1924670
	speed: 0.0677s/iter; left time: 874.1367s
Epoch: 38 cost time: 14.298978090286255
Epoch: 38, Steps: 208 | Train Loss: 3.022 Vali Loss: 3.409 Vali Acc: 0.097 Test Loss: 3.409 Test Acc: 0.097
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 3.2764313
	speed: 0.2324s/iter; left time: 2974.1258s
	iters: 200, epoch: 39 | loss: 2.7030888
	speed: 0.0842s/iter; left time: 1068.7478s
Epoch: 39 cost time: 18.02040123939514
Epoch: 39, Steps: 208 | Train Loss: 3.016 Vali Loss: 3.370 Vali Acc: 0.092 Test Loss: 3.370 Test Acc: 0.092
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 40 | loss: 2.7823024
	speed: 0.2383s/iter; left time: 2999.7539s
	iters: 200, epoch: 40 | loss: 2.7652817
	speed: 0.0838s/iter; left time: 1046.4110s
Epoch: 40 cost time: 17.506229877471924
Epoch: 40, Steps: 208 | Train Loss: 3.008 Vali Loss: 3.242 Vali Acc: 0.116 Test Loss: 3.242 Test Acc: 0.116
Validation loss decreased (-0.103159 --> -0.115685).  Saving model ...
	iters: 100, epoch: 41 | loss: 2.5077562
	speed: 0.2320s/iter; left time: 2872.9989s
	iters: 200, epoch: 41 | loss: 2.7991023
	speed: 0.0799s/iter; left time: 980.7624s
Epoch: 41 cost time: 16.44917607307434
Epoch: 41, Steps: 208 | Train Loss: 2.987 Vali Loss: 3.313 Vali Acc: 0.094 Test Loss: 3.313 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 42 | loss: 2.8794899
	speed: 0.2363s/iter; left time: 2876.1448s
	iters: 200, epoch: 42 | loss: 3.0760937
	speed: 0.0791s/iter; left time: 955.1713s
Epoch: 42 cost time: 16.697139263153076
Epoch: 42, Steps: 208 | Train Loss: 2.995 Vali Loss: 3.279 Vali Acc: 0.102 Test Loss: 3.279 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 43 | loss: 2.8743212
	speed: 0.2342s/iter; left time: 2802.1256s
	iters: 200, epoch: 43 | loss: 3.2057147
	speed: 0.0767s/iter; left time: 910.3739s
Epoch: 43 cost time: 16.592960119247437
Epoch: 43, Steps: 208 | Train Loss: 2.981 Vali Loss: 3.257 Vali Acc: 0.099 Test Loss: 3.257 Test Acc: 0.099
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 44 | loss: 3.0795472
	speed: 0.2127s/iter; left time: 2501.1017s
	iters: 200, epoch: 44 | loss: 3.2392573
	speed: 0.0786s/iter; left time: 915.7074s
Epoch: 44 cost time: 15.927460670471191
Epoch: 44, Steps: 208 | Train Loss: 2.984 Vali Loss: 3.254 Vali Acc: 0.102 Test Loss: 3.254 Test Acc: 0.102
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 45 | loss: 3.0745354
	speed: 0.2103s/iter; left time: 2428.6330s
	iters: 200, epoch: 45 | loss: 2.9304891
	speed: 0.0799s/iter; left time: 915.1699s
Epoch: 45 cost time: 16.4058358669281
Epoch: 45, Steps: 208 | Train Loss: 2.970 Vali Loss: 3.248 Vali Acc: 0.101 Test Loss: 3.248 Test Acc: 0.101
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 46 | loss: 2.9186242
	speed: 0.2123s/iter; left time: 2407.6471s
	iters: 200, epoch: 46 | loss: 3.0086408
	speed: 0.0801s/iter; left time: 900.1955s
Epoch: 46 cost time: 15.902638912200928
Epoch: 46, Steps: 208 | Train Loss: 2.954 Vali Loss: 3.294 Vali Acc: 0.103 Test Loss: 3.294 Test Acc: 0.103
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 47 | loss: 2.8751941
	speed: 0.2147s/iter; left time: 2390.7445s
	iters: 200, epoch: 47 | loss: 3.2737985
	speed: 0.0782s/iter; left time: 862.7101s
Epoch: 47 cost time: 16.71955394744873
Epoch: 47, Steps: 208 | Train Loss: 2.957 Vali Loss: 3.259 Vali Acc: 0.108 Test Loss: 3.259 Test Acc: 0.108
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 48 | loss: 3.1059813
	speed: 0.2201s/iter; left time: 2404.2413s
	iters: 200, epoch: 48 | loss: 2.3650882
	speed: 0.0841s/iter; left time: 909.8958s
Epoch: 48 cost time: 17.03628134727478
Epoch: 48, Steps: 208 | Train Loss: 2.928 Vali Loss: 3.332 Vali Acc: 0.105 Test Loss: 3.332 Test Acc: 0.105
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 49 | loss: 3.0024095
	speed: 0.2154s/iter; left time: 2308.5432s
	iters: 200, epoch: 49 | loss: 3.0624385
	speed: 0.0767s/iter; left time: 814.7563s
Epoch: 49 cost time: 16.1987464427948
Epoch: 49, Steps: 208 | Train Loss: 2.922 Vali Loss: 3.251 Vali Acc: 0.103 Test Loss: 3.251 Test Acc: 0.103
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 50 | loss: 2.6455650
	speed: 0.2150s/iter; left time: 2259.4813s
	iters: 200, epoch: 50 | loss: 2.8341353
	speed: 0.0793s/iter; left time: 825.6544s
Epoch: 50 cost time: 16.775147199630737
Epoch: 50, Steps: 208 | Train Loss: 2.918 Vali Loss: 3.331 Vali Acc: 0.107 Test Loss: 3.331 Test Acc: 0.107
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11571726811810319
model parameter : 6903359
model size : 31.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.7696223
	speed: 0.0771s/iter; left time: 1596.2011s
	iters: 200, epoch: 1 | loss: 4.3178053
	speed: 0.0650s/iter; left time: 1339.0449s
Epoch: 1 cost time: 14.672028064727783
Epoch: 1, Steps: 208 | Train Loss: 5.832 Vali Loss: 4.813 Vali Acc: 0.030 Test Loss: 4.813 Test Acc: 0.030
Validation loss decreased (inf --> -0.030074).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.1469111
	speed: 0.1612s/iter; left time: 3303.6249s
	iters: 200, epoch: 2 | loss: 4.4797235
	speed: 0.0442s/iter; left time: 901.6539s
Epoch: 2 cost time: 9.741918802261353
Epoch: 2, Steps: 208 | Train Loss: 4.514 Vali Loss: 4.526 Vali Acc: 0.025 Test Loss: 4.526 Test Acc: 0.025
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.6763668
	speed: 0.2179s/iter; left time: 4419.4921s
	iters: 200, epoch: 3 | loss: 4.6314397
	speed: 0.0714s/iter; left time: 1440.8680s
Epoch: 3 cost time: 15.43771767616272
Epoch: 3, Steps: 208 | Train Loss: 4.362 Vali Loss: 4.335 Vali Acc: 0.047 Test Loss: 4.335 Test Acc: 0.047
Validation loss decreased (-0.030074 --> -0.046780).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.9195509
	speed: 0.2149s/iter; left time: 4314.8643s
	iters: 200, epoch: 4 | loss: 3.8333669
	speed: 0.0716s/iter; left time: 1429.9656s
Epoch: 4 cost time: 14.857533931732178
Epoch: 4, Steps: 208 | Train Loss: 4.179 Vali Loss: 3.935 Vali Acc: 0.035 Test Loss: 3.935 Test Acc: 0.035
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 4.0565181
	speed: 0.2217s/iter; left time: 4404.6053s
	iters: 200, epoch: 5 | loss: 4.0520782
	speed: 0.0904s/iter; left time: 1787.9224s
Epoch: 5 cost time: 18.121845483779907
Epoch: 5, Steps: 208 | Train Loss: 3.982 Vali Loss: 4.093 Vali Acc: 0.051 Test Loss: 4.093 Test Acc: 0.051
Validation loss decreased (-0.046780 --> -0.050660).  Saving model ...
	iters: 100, epoch: 6 | loss: 4.1195884
	speed: 0.2300s/iter; left time: 4521.8294s
	iters: 200, epoch: 6 | loss: 3.6202784
	speed: 0.0731s/iter; left time: 1430.4459s
Epoch: 6 cost time: 15.831296443939209
Epoch: 6, Steps: 208 | Train Loss: 3.752 Vali Loss: 3.591 Vali Acc: 0.052 Test Loss: 3.591 Test Acc: 0.052
Validation loss decreased (-0.050660 --> -0.052156).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.9514306
	speed: 0.2233s/iter; left time: 4343.5486s
	iters: 200, epoch: 7 | loss: 3.4140823
	speed: 0.0644s/iter; left time: 1246.2965s
Epoch: 7 cost time: 14.259353876113892
Epoch: 7, Steps: 208 | Train Loss: 3.648 Vali Loss: 3.543 Vali Acc: 0.073 Test Loss: 3.543 Test Acc: 0.073
Validation loss decreased (-0.052156 --> -0.072735).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.7684186
	speed: 0.2136s/iter; left time: 4110.6346s
	iters: 200, epoch: 8 | loss: 3.6851313
	speed: 0.0900s/iter; left time: 1723.1225s
Epoch: 8 cost time: 18.244709014892578
Epoch: 8, Steps: 208 | Train Loss: 3.466 Vali Loss: 3.328 Vali Acc: 0.078 Test Loss: 3.328 Test Acc: 0.078
Validation loss decreased (-0.072735 --> -0.077807).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.2140965
	speed: 0.2400s/iter; left time: 4569.2287s
	iters: 200, epoch: 9 | loss: 3.3101983
	speed: 0.0890s/iter; left time: 1685.8594s
Epoch: 9 cost time: 18.450304746627808
Epoch: 9, Steps: 208 | Train Loss: 3.385 Vali Loss: 3.310 Vali Acc: 0.079 Test Loss: 3.310 Test Acc: 0.079
Validation loss decreased (-0.077807 --> -0.079001).  Saving model ...
	iters: 100, epoch: 10 | loss: 3.3443465
	speed: 0.2146s/iter; left time: 4041.2942s
	iters: 200, epoch: 10 | loss: 3.3633468
	speed: 0.0786s/iter; left time: 1472.3423s
Epoch: 10 cost time: 16.309412479400635
Epoch: 10, Steps: 208 | Train Loss: 3.326 Vali Loss: 3.308 Vali Acc: 0.092 Test Loss: 3.308 Test Acc: 0.092
Validation loss decreased (-0.079001 --> -0.092421).  Saving model ...
	iters: 100, epoch: 11 | loss: 3.7051990
	speed: 0.2085s/iter; left time: 3883.0441s
	iters: 200, epoch: 11 | loss: 3.9364200
	speed: 0.0711s/iter; left time: 1316.3627s
Epoch: 11 cost time: 15.216368675231934
Epoch: 11, Steps: 208 | Train Loss: 3.289 Vali Loss: 3.327 Vali Acc: 0.083 Test Loss: 3.327 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 3.0579314
	speed: 0.2160s/iter; left time: 3976.4256s
	iters: 200, epoch: 12 | loss: 3.2812335
	speed: 0.0809s/iter; left time: 1482.1348s
Epoch: 12 cost time: 17.48219656944275
Epoch: 12, Steps: 208 | Train Loss: 3.224 Vali Loss: 3.241 Vali Acc: 0.088 Test Loss: 3.241 Test Acc: 0.088
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 3.1688676
	speed: 0.2151s/iter; left time: 3916.1052s
	iters: 200, epoch: 13 | loss: 3.4707515
	speed: 0.0700s/iter; left time: 1267.8025s
Epoch: 13 cost time: 15.829682350158691
Epoch: 13, Steps: 208 | Train Loss: 3.158 Vali Loss: 3.213 Vali Acc: 0.097 Test Loss: 3.213 Test Acc: 0.097
Validation loss decreased (-0.092421 --> -0.096598).  Saving model ...
	iters: 100, epoch: 14 | loss: 3.2322292
	speed: 0.2146s/iter; left time: 3862.2509s
	iters: 200, epoch: 14 | loss: 2.5967462
	speed: 0.0752s/iter; left time: 1345.6430s
Epoch: 14 cost time: 16.210224151611328
Epoch: 14, Steps: 208 | Train Loss: 3.124 Vali Loss: 3.229 Vali Acc: 0.095 Test Loss: 3.229 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.8064492
	speed: 0.2050s/iter; left time: 3646.8389s
	iters: 200, epoch: 15 | loss: 3.0603728
	speed: 0.0682s/iter; left time: 1205.8231s
Epoch: 15 cost time: 15.067504644393921
Epoch: 15, Steps: 208 | Train Loss: 3.116 Vali Loss: 3.193 Vali Acc: 0.091 Test Loss: 3.193 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 2.9647317
	speed: 0.2115s/iter; left time: 3718.8041s
	iters: 200, epoch: 16 | loss: 2.9299407
	speed: 0.0766s/iter; left time: 1338.7284s
Epoch: 16 cost time: 16.92619037628174
Epoch: 16, Steps: 208 | Train Loss: 3.107 Vali Loss: 3.230 Vali Acc: 0.106 Test Loss: 3.230 Test Acc: 0.106
Validation loss decreased (-0.096598 --> -0.106141).  Saving model ...
	iters: 100, epoch: 17 | loss: 3.1012506
	speed: 0.2199s/iter; left time: 3819.8442s
	iters: 200, epoch: 17 | loss: 3.2937951
	speed: 0.0670s/iter; left time: 1157.0286s
Epoch: 17 cost time: 15.055198431015015
Epoch: 17, Steps: 208 | Train Loss: 3.109 Vali Loss: 3.216 Vali Acc: 0.090 Test Loss: 3.216 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 2.9585211
	speed: 0.2149s/iter; left time: 3687.9527s
	iters: 200, epoch: 18 | loss: 3.1931338
	speed: 0.0735s/iter; left time: 1254.4268s
Epoch: 18 cost time: 15.926437854766846
Epoch: 18, Steps: 208 | Train Loss: 3.094 Vali Loss: 3.216 Vali Acc: 0.091 Test Loss: 3.216 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 3.1456394
	speed: 0.2009s/iter; left time: 3406.0914s
	iters: 200, epoch: 19 | loss: 3.0382197
	speed: 0.0693s/iter; left time: 1167.9658s
Epoch: 19 cost time: 14.698611497879028
Epoch: 19, Steps: 208 | Train Loss: 3.087 Vali Loss: 3.155 Vali Acc: 0.098 Test Loss: 3.155 Test Acc: 0.098
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 3.1032124
	speed: 0.2148s/iter; left time: 3597.7017s
	iters: 200, epoch: 20 | loss: 3.0220613
	speed: 0.0796s/iter; left time: 1324.7974s
Epoch: 20 cost time: 16.747340440750122
Epoch: 20, Steps: 208 | Train Loss: 3.076 Vali Loss: 3.306 Vali Acc: 0.091 Test Loss: 3.306 Test Acc: 0.091
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 3.5098081
	speed: 0.2080s/iter; left time: 3439.9372s
	iters: 200, epoch: 21 | loss: 3.3487365
	speed: 0.0675s/iter; left time: 1109.2890s
Epoch: 21 cost time: 14.560281753540039
Epoch: 21, Steps: 208 | Train Loss: 3.048 Vali Loss: 3.217 Vali Acc: 0.105 Test Loss: 3.217 Test Acc: 0.105
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 3.2882154
	speed: 0.2184s/iter; left time: 3567.6566s
	iters: 200, epoch: 22 | loss: 3.0823269
	speed: 0.0734s/iter; left time: 1191.5142s
Epoch: 22 cost time: 16.23948574066162
Epoch: 22, Steps: 208 | Train Loss: 3.052 Vali Loss: 3.188 Vali Acc: 0.107 Test Loss: 3.188 Test Acc: 0.107
Validation loss decreased (-0.106141 --> -0.107335).  Saving model ...
	iters: 100, epoch: 23 | loss: 3.0577366
	speed: 0.2106s/iter; left time: 3395.2104s
	iters: 200, epoch: 23 | loss: 2.8191831
	speed: 0.0703s/iter; left time: 1126.5485s
Epoch: 23 cost time: 14.65514612197876
Epoch: 23, Steps: 208 | Train Loss: 3.054 Vali Loss: 3.169 Vali Acc: 0.105 Test Loss: 3.169 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 3.5769796
	speed: 0.2418s/iter; left time: 3848.1108s
	iters: 200, epoch: 24 | loss: 3.0656660
	speed: 0.0912s/iter; left time: 1441.7837s
Epoch: 24 cost time: 19.23386240005493
Epoch: 24, Steps: 208 | Train Loss: 3.038 Vali Loss: 3.111 Vali Acc: 0.117 Test Loss: 3.111 Test Acc: 0.117
Validation loss decreased (-0.107335 --> -0.116581).  Saving model ...
	iters: 100, epoch: 25 | loss: 2.9500854
	speed: 0.2321s/iter; left time: 3646.2704s
	iters: 200, epoch: 25 | loss: 3.2678337
	speed: 0.0792s/iter; left time: 1235.8571s
Epoch: 25 cost time: 15.951444864273071
Epoch: 25, Steps: 208 | Train Loss: 3.010 Vali Loss: 3.211 Vali Acc: 0.096 Test Loss: 3.211 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 3.0208464
	speed: 0.2411s/iter; left time: 3737.7749s
	iters: 200, epoch: 26 | loss: 2.7420769
	speed: 0.0832s/iter; left time: 1281.3601s
Epoch: 26 cost time: 17.939338445663452
Epoch: 26, Steps: 208 | Train Loss: 3.008 Vali Loss: 3.231 Vali Acc: 0.095 Test Loss: 3.231 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 2.9685676
	speed: 0.2177s/iter; left time: 3328.7899s
	iters: 200, epoch: 27 | loss: 3.0728683
	speed: 0.0706s/iter; left time: 1072.4998s
Epoch: 27 cost time: 14.470461130142212
Epoch: 27, Steps: 208 | Train Loss: 2.997 Vali Loss: 3.228 Vali Acc: 0.114 Test Loss: 3.228 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 3.2259192
	speed: 0.2152s/iter; left time: 3246.0850s
	iters: 200, epoch: 28 | loss: 2.9868770
	speed: 0.0710s/iter; left time: 1064.3422s
Epoch: 28 cost time: 15.823928833007812
Epoch: 28, Steps: 208 | Train Loss: 2.993 Vali Loss: 3.295 Vali Acc: 0.097 Test Loss: 3.295 Test Acc: 0.097
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 3.1350265
	speed: 0.1403s/iter; left time: 2086.8091s
	iters: 200, epoch: 29 | loss: 3.2031457
	speed: 0.0416s/iter; left time: 615.1618s
Epoch: 29 cost time: 8.594348669052124
Epoch: 29, Steps: 208 | Train Loss: 2.992 Vali Loss: 3.203 Vali Acc: 0.107 Test Loss: 3.203 Test Acc: 0.107
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 3.2528841
	speed: 0.2144s/iter; left time: 3144.6642s
	iters: 200, epoch: 30 | loss: 2.6931832
	speed: 0.0735s/iter; left time: 1070.6633s
Epoch: 30 cost time: 16.00539255142212
Epoch: 30, Steps: 208 | Train Loss: 2.992 Vali Loss: 3.325 Vali Acc: 0.098 Test Loss: 3.325 Test Acc: 0.098
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 3.0608459
	speed: 0.2069s/iter; left time: 2992.4583s
	iters: 200, epoch: 31 | loss: 3.2657588
	speed: 0.0654s/iter; left time: 938.5295s
Epoch: 31 cost time: 13.829956531524658
Epoch: 31, Steps: 208 | Train Loss: 2.981 Vali Loss: 3.225 Vali Acc: 0.099 Test Loss: 3.225 Test Acc: 0.099
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 3.0685256
	speed: 0.2152s/iter; left time: 3066.7611s
	iters: 200, epoch: 32 | loss: 3.1329300
	speed: 0.0798s/iter; left time: 1129.0435s
Epoch: 32 cost time: 16.992554426193237
Epoch: 32, Steps: 208 | Train Loss: 2.971 Vali Loss: 3.169 Vali Acc: 0.108 Test Loss: 3.169 Test Acc: 0.108
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 2.5711260
	speed: 0.2049s/iter; left time: 2878.3427s
	iters: 200, epoch: 33 | loss: 3.0102673
	speed: 0.0712s/iter; left time: 992.5087s
Epoch: 33 cost time: 14.401179075241089
Epoch: 33, Steps: 208 | Train Loss: 2.959 Vali Loss: 3.230 Vali Acc: 0.103 Test Loss: 3.230 Test Acc: 0.103
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 2.8491416
	speed: 0.2075s/iter; left time: 2870.7871s
	iters: 200, epoch: 34 | loss: 2.9880085
	speed: 0.0788s/iter; left time: 1081.8961s
Epoch: 34 cost time: 16.06390905380249
Epoch: 34, Steps: 208 | Train Loss: 2.942 Vali Loss: 3.222 Vali Acc: 0.098 Test Loss: 3.222 Test Acc: 0.098
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11661198926334626
model parameter : 6898495
model size : 31.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 8.3122244
	speed: 0.1089s/iter; left time: 2254.9717s
	iters: 200, epoch: 1 | loss: 4.9193625
	speed: 0.0946s/iter; left time: 1948.7235s
Epoch: 1 cost time: 21.217378854751587
Epoch: 1, Steps: 208 | Train Loss: 6.497 Vali Loss: 6.553 Vali Acc: 0.027 Test Loss: 6.553 Test Acc: 0.027
Validation loss decreased (inf --> -0.027074).  Saving model ...
	iters: 100, epoch: 2 | loss: 5.5493617
	speed: 0.2246s/iter; left time: 4602.7624s
	iters: 200, epoch: 2 | loss: 4.5702987
	speed: 0.0888s/iter; left time: 1810.0741s
Epoch: 2 cost time: 18.2634539604187
Epoch: 2, Steps: 208 | Train Loss: 4.773 Vali Loss: 4.974 Vali Acc: 0.032 Test Loss: 4.974 Test Acc: 0.032
Validation loss decreased (-0.027074 --> -0.031862).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.2961760
	speed: 0.2344s/iter; left time: 4755.7691s
	iters: 200, epoch: 3 | loss: 4.7315826
	speed: 0.0917s/iter; left time: 1850.2523s
Epoch: 3 cost time: 19.306212186813354
Epoch: 3, Steps: 208 | Train Loss: 4.476 Vali Loss: 4.563 Vali Acc: 0.026 Test Loss: 4.563 Test Acc: 0.026
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 4.4054961
	speed: 0.2249s/iter; left time: 4514.8128s
	iters: 200, epoch: 4 | loss: 4.2192311
	speed: 0.0831s/iter; left time: 1659.3426s
Epoch: 4 cost time: 17.339373350143433
Epoch: 4, Steps: 208 | Train Loss: 4.304 Vali Loss: 4.104 Vali Acc: 0.026 Test Loss: 4.104 Test Acc: 0.026
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 4.0345545
	speed: 0.1856s/iter; left time: 3687.2582s
	iters: 200, epoch: 5 | loss: 3.8615682
	speed: 0.0965s/iter; left time: 1906.9271s
Epoch: 5 cost time: 17.357624292373657
Epoch: 5, Steps: 208 | Train Loss: 4.152 Vali Loss: 3.969 Vali Acc: 0.026 Test Loss: 3.969 Test Acc: 0.026
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 3.7298203
	speed: 0.2506s/iter; left time: 4927.4384s
	iters: 200, epoch: 6 | loss: 3.7464633
	speed: 0.1016s/iter; left time: 1987.4676s
Epoch: 6 cost time: 20.961031913757324
Epoch: 6, Steps: 208 | Train Loss: 4.068 Vali Loss: 3.800 Vali Acc: 0.026 Test Loss: 3.800 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 4.1011248
	speed: 0.2534s/iter; left time: 4929.8882s
	iters: 200, epoch: 7 | loss: 3.9294815
	speed: 0.0967s/iter; left time: 1870.8716s
Epoch: 7 cost time: 21.19250178337097
Epoch: 7, Steps: 208 | Train Loss: 3.899 Vali Loss: 4.004 Vali Acc: 0.026 Test Loss: 4.004 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 3.7996087
	speed: 0.2572s/iter; left time: 4949.1879s
	iters: 200, epoch: 8 | loss: 3.8421793
	speed: 0.0906s/iter; left time: 1734.3747s
Epoch: 8 cost time: 20.951090097427368
Epoch: 8, Steps: 208 | Train Loss: 3.834 Vali Loss: 3.719 Vali Acc: 0.026 Test Loss: 3.719 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 3.9014387
	speed: 0.2379s/iter; left time: 4529.0096s
	iters: 200, epoch: 9 | loss: 3.7726336
	speed: 0.0874s/iter; left time: 1654.7374s
Epoch: 9 cost time: 18.989542722702026
Epoch: 9, Steps: 208 | Train Loss: 3.786 Vali Loss: 3.730 Vali Acc: 0.026 Test Loss: 3.730 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 3.6606202
	speed: 0.2266s/iter; left time: 4265.9803s
	iters: 200, epoch: 10 | loss: 3.5227501
	speed: 0.0849s/iter; left time: 1590.4641s
Epoch: 10 cost time: 17.80964422225952
Epoch: 10, Steps: 208 | Train Loss: 3.775 Vali Loss: 3.766 Vali Acc: 0.026 Test Loss: 3.766 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 3.6899915
	speed: 0.2304s/iter; left time: 4290.3999s
	iters: 200, epoch: 11 | loss: 3.7187860
	speed: 0.0928s/iter; left time: 1719.4108s
Epoch: 11 cost time: 19.823039770126343
Epoch: 11, Steps: 208 | Train Loss: 3.765 Vali Loss: 3.717 Vali Acc: 0.026 Test Loss: 3.717 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 3.6525061
	speed: 0.2318s/iter; left time: 4267.2146s
	iters: 200, epoch: 12 | loss: 3.7277074
	speed: 0.0931s/iter; left time: 1704.3606s
Epoch: 12 cost time: 19.71761655807495
Epoch: 12, Steps: 208 | Train Loss: 3.761 Vali Loss: 3.718 Vali Acc: 0.026 Test Loss: 3.718 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.03191172084700268
model parameter : 6125119
model size : 28.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.3478665
	speed: 0.0923s/iter; left time: 1909.7635s
	iters: 200, epoch: 1 | loss: 5.3496318
	speed: 0.0767s/iter; left time: 1579.9575s
Epoch: 1 cost time: 17.578782081604004
Epoch: 1, Steps: 208 | Train Loss: 6.223 Vali Loss: 5.547 Vali Acc: 0.038 Test Loss: 5.547 Test Acc: 0.038
Validation loss decreased (inf --> -0.037821).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.3235040
	speed: 0.2150s/iter; left time: 4406.5702s
	iters: 200, epoch: 2 | loss: 4.2006207
	speed: 0.0763s/iter; left time: 1556.9158s
Epoch: 2 cost time: 16.327340364456177
Epoch: 2, Steps: 208 | Train Loss: 4.575 Vali Loss: 4.657 Vali Acc: 0.052 Test Loss: 4.657 Test Acc: 0.052
Validation loss decreased (-0.037821 --> -0.051549).  Saving model ...
	iters: 100, epoch: 3 | loss: 5.2116570
	speed: 0.2107s/iter; left time: 4273.7998s
	iters: 200, epoch: 3 | loss: 4.2549753
	speed: 0.0718s/iter; left time: 1450.1966s
Epoch: 3 cost time: 15.920647144317627
Epoch: 3, Steps: 208 | Train Loss: 4.392 Vali Loss: 4.304 Vali Acc: 0.049 Test Loss: 4.304 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 4.5018940
	speed: 0.1579s/iter; left time: 3169.3450s
	iters: 200, epoch: 4 | loss: 4.4398856
	speed: 0.0380s/iter; left time: 758.8684s
Epoch: 4 cost time: 8.23998236656189
Epoch: 4, Steps: 208 | Train Loss: 4.358 Vali Loss: 4.172 Vali Acc: 0.041 Test Loss: 4.172 Test Acc: 0.041
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 4.4303222
	speed: 0.1913s/iter; left time: 3800.5067s
	iters: 200, epoch: 5 | loss: 3.9569333
	speed: 0.0729s/iter; left time: 1441.5072s
Epoch: 5 cost time: 16.06932234764099
Epoch: 5, Steps: 208 | Train Loss: 4.281 Vali Loss: 4.237 Vali Acc: 0.029 Test Loss: 4.237 Test Acc: 0.029
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 4.1155171
	speed: 0.2148s/iter; left time: 4224.0280s
	iters: 200, epoch: 6 | loss: 4.2576990
	speed: 0.0728s/iter; left time: 1423.2340s
Epoch: 6 cost time: 15.822869062423706
Epoch: 6, Steps: 208 | Train Loss: 4.116 Vali Loss: 3.916 Vali Acc: 0.026 Test Loss: 3.916 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 4.1521745
	speed: 0.2135s/iter; left time: 4153.3907s
	iters: 200, epoch: 7 | loss: 3.7235584
	speed: 0.0758s/iter; left time: 1467.4750s
Epoch: 7 cost time: 16.259430646896362
Epoch: 7, Steps: 208 | Train Loss: 3.991 Vali Loss: 3.871 Vali Acc: 0.026 Test Loss: 3.871 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 3.9745190
	speed: 0.2011s/iter; left time: 3869.4550s
	iters: 200, epoch: 8 | loss: 3.5787377
	speed: 0.0614s/iter; left time: 1176.0605s
Epoch: 8 cost time: 13.876418352127075
Epoch: 8, Steps: 208 | Train Loss: 3.887 Vali Loss: 3.772 Vali Acc: 0.026 Test Loss: 3.772 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 3.6605535
	speed: 0.2370s/iter; left time: 4511.0141s
	iters: 200, epoch: 9 | loss: 3.9506998
	speed: 0.0783s/iter; left time: 1482.7496s
Epoch: 9 cost time: 17.287339687347412
Epoch: 9, Steps: 208 | Train Loss: 3.861 Vali Loss: 3.718 Vali Acc: 0.034 Test Loss: 3.718 Test Acc: 0.034
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 3.9548335
	speed: 0.2277s/iter; left time: 4286.7892s
	iters: 200, epoch: 10 | loss: 3.9065914
	speed: 0.0788s/iter; left time: 1475.3756s
Epoch: 10 cost time: 16.010036945343018
Epoch: 10, Steps: 208 | Train Loss: 3.767 Vali Loss: 3.630 Vali Acc: 0.041 Test Loss: 3.630 Test Acc: 0.041
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 3.4771285
	speed: 0.2402s/iter; left time: 4473.2172s
	iters: 200, epoch: 11 | loss: 3.6701801
	speed: 0.0825s/iter; left time: 1527.5934s
Epoch: 11 cost time: 17.970812797546387
Epoch: 11, Steps: 208 | Train Loss: 3.656 Vali Loss: 3.614 Vali Acc: 0.041 Test Loss: 3.614 Test Acc: 0.041
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 3.8469114
	speed: 0.2225s/iter; left time: 4097.0667s
	iters: 200, epoch: 12 | loss: 3.7909048
	speed: 0.0760s/iter; left time: 1391.7941s
Epoch: 12 cost time: 15.925784587860107
Epoch: 12, Steps: 208 | Train Loss: 3.696 Vali Loss: 3.732 Vali Acc: 0.037 Test Loss: 3.732 Test Acc: 0.037
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.051595586042350136
model parameter : 6120255
model size : 28.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.0886345
	speed: 0.0850s/iter; left time: 1759.6628s
	iters: 200, epoch: 1 | loss: 6.5954180
	speed: 0.0706s/iter; left time: 1453.8161s
Epoch: 1 cost time: 16.244128942489624
Epoch: 1, Steps: 208 | Train Loss: 6.521 Vali Loss: 7.664 Vali Acc: 0.038 Test Loss: 7.664 Test Acc: 0.038
Validation loss decreased (inf --> -0.038396).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.9080029
	speed: 0.2130s/iter; left time: 4364.2753s
	iters: 200, epoch: 2 | loss: 4.6227512
	speed: 0.0713s/iter; left time: 1454.6505s
Epoch: 2 cost time: 15.251798868179321
Epoch: 2, Steps: 208 | Train Loss: 5.079 Vali Loss: 4.638 Vali Acc: 0.037 Test Loss: 4.638 Test Acc: 0.037
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.9774947
	speed: 0.2047s/iter; left time: 4152.0701s
	iters: 200, epoch: 3 | loss: 4.2841597
	speed: 0.0629s/iter; left time: 1268.9598s
Epoch: 3 cost time: 14.392543315887451
Epoch: 3, Steps: 208 | Train Loss: 4.460 Vali Loss: 4.646 Vali Acc: 0.028 Test Loss: 4.646 Test Acc: 0.028
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 4.3764806
	speed: 0.2054s/iter; left time: 4124.7969s
	iters: 200, epoch: 4 | loss: 4.4874959
	speed: 0.0788s/iter; left time: 1573.2029s
Epoch: 4 cost time: 15.814683198928833
Epoch: 4, Steps: 208 | Train Loss: 4.313 Vali Loss: 4.107 Vali Acc: 0.026 Test Loss: 4.107 Test Acc: 0.026
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 4.5227137
	speed: 0.2083s/iter; left time: 4139.6369s
	iters: 200, epoch: 5 | loss: 4.0054369
	speed: 0.0771s/iter; left time: 1524.7233s
Epoch: 5 cost time: 15.75538158416748
Epoch: 5, Steps: 208 | Train Loss: 4.205 Vali Loss: 3.871 Vali Acc: 0.026 Test Loss: 3.871 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 3.9577165
	speed: 0.2081s/iter; left time: 4090.8449s
	iters: 200, epoch: 6 | loss: 3.9273834
	speed: 0.0791s/iter; left time: 1546.6518s
Epoch: 6 cost time: 16.409329891204834
Epoch: 6, Steps: 208 | Train Loss: 4.001 Vali Loss: 3.922 Vali Acc: 0.026 Test Loss: 3.922 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 3.6256776
	speed: 0.2102s/iter; left time: 4089.1928s
	iters: 200, epoch: 7 | loss: 3.8609166
	speed: 0.0727s/iter; left time: 1406.8545s
Epoch: 7 cost time: 15.433283567428589
Epoch: 7, Steps: 208 | Train Loss: 3.882 Vali Loss: 3.796 Vali Acc: 0.026 Test Loss: 3.796 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 3.7226338
	speed: 0.2142s/iter; left time: 4122.4264s
	iters: 200, epoch: 8 | loss: 3.8301580
	speed: 0.0736s/iter; left time: 1409.0999s
Epoch: 8 cost time: 16.228888034820557
Epoch: 8, Steps: 208 | Train Loss: 3.827 Vali Loss: 3.789 Vali Acc: 0.026 Test Loss: 3.789 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 3.6854842
	speed: 0.2123s/iter; left time: 4042.1649s
	iters: 200, epoch: 9 | loss: 3.9529428
	speed: 0.0698s/iter; left time: 1320.9908s
Epoch: 9 cost time: 15.85008692741394
Epoch: 9, Steps: 208 | Train Loss: 3.793 Vali Loss: 3.719 Vali Acc: 0.026 Test Loss: 3.719 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 5.1449842
	speed: 0.1797s/iter; left time: 3383.0730s
	iters: 200, epoch: 10 | loss: 4.3345270
	speed: 0.0463s/iter; left time: 867.1043s
Epoch: 10 cost time: 11.024982452392578
Epoch: 10, Steps: 208 | Train Loss: 4.494 Vali Loss: 4.488 Vali Acc: 0.026 Test Loss: 4.488 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 4.0160718
	speed: 0.1986s/iter; left time: 3698.9250s
	iters: 200, epoch: 11 | loss: 3.9757791
	speed: 0.0753s/iter; left time: 1393.9291s
Epoch: 11 cost time: 15.547033548355103
Epoch: 11, Steps: 208 | Train Loss: 3.934 Vali Loss: 3.783 Vali Acc: 0.026 Test Loss: 3.783 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.038473009245451835
model parameter : 6115391
model size : 28.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 6.0605016
	speed: 0.0616s/iter; left time: 1274.2526s
	iters: 200, epoch: 1 | loss: 5.9980402
	speed: 0.0550s/iter; left time: 1133.2606s
Epoch: 1 cost time: 12.171304702758789
Epoch: 1, Steps: 208 | Train Loss: 6.630 Vali Loss: 6.653 Vali Acc: 0.043 Test Loss: 6.653 Test Acc: 0.043
Validation loss decreased (inf --> -0.042582).  Saving model ...
	iters: 100, epoch: 2 | loss: 5.5946064
	speed: 0.2204s/iter; left time: 4516.1163s
	iters: 200, epoch: 2 | loss: 4.6686101
	speed: 0.0720s/iter; left time: 1468.2228s
Epoch: 2 cost time: 16.61401081085205
Epoch: 2, Steps: 208 | Train Loss: 5.016 Vali Loss: 4.452 Vali Acc: 0.039 Test Loss: 4.452 Test Acc: 0.039
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.4695315
	speed: 0.2359s/iter; left time: 4784.9250s
	iters: 200, epoch: 3 | loss: 3.6970255
	speed: 0.0853s/iter; left time: 1721.3764s
Epoch: 3 cost time: 18.096680164337158
Epoch: 3, Steps: 208 | Train Loss: 4.429 Vali Loss: 4.285 Vali Acc: 0.026 Test Loss: 4.285 Test Acc: 0.026
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 4.4344473
	speed: 0.2258s/iter; left time: 4532.4885s
	iters: 200, epoch: 4 | loss: 4.3310122
	speed: 0.0807s/iter; left time: 1611.9741s
Epoch: 4 cost time: 16.10702633857727
Epoch: 4, Steps: 208 | Train Loss: 4.299 Vali Loss: 4.183 Vali Acc: 0.032 Test Loss: 4.183 Test Acc: 0.032
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 4.2196107
	speed: 0.2330s/iter; left time: 4628.4905s
	iters: 200, epoch: 5 | loss: 4.1639953
	speed: 0.0767s/iter; left time: 1516.5800s
Epoch: 5 cost time: 16.855193853378296
Epoch: 5, Steps: 208 | Train Loss: 4.245 Vali Loss: 4.101 Vali Acc: 0.035 Test Loss: 4.101 Test Acc: 0.035
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 3.6639035
	speed: 0.2042s/iter; left time: 4014.3608s
	iters: 200, epoch: 6 | loss: 3.8594587
	speed: 0.0718s/iter; left time: 1405.4420s
Epoch: 6 cost time: 14.832324981689453
Epoch: 6, Steps: 208 | Train Loss: 4.070 Vali Loss: 3.973 Vali Acc: 0.050 Test Loss: 3.973 Test Acc: 0.050
Validation loss decreased (-0.042582 --> -0.050065).  Saving model ...
	iters: 100, epoch: 7 | loss: 4.2019348
	speed: 0.2052s/iter; left time: 3991.9689s
	iters: 200, epoch: 7 | loss: 3.4998994
	speed: 0.0710s/iter; left time: 1374.9908s
Epoch: 7 cost time: 15.12956953048706
Epoch: 7, Steps: 208 | Train Loss: 3.946 Vali Loss: 3.692 Vali Acc: 0.043 Test Loss: 3.692 Test Acc: 0.043
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 3.7365677
	speed: 0.2094s/iter; left time: 4029.2567s
	iters: 200, epoch: 8 | loss: 4.2942672
	speed: 0.0764s/iter; left time: 1462.5140s
Epoch: 8 cost time: 15.776677131652832
Epoch: 8, Steps: 208 | Train Loss: 3.845 Vali Loss: 3.814 Vali Acc: 0.043 Test Loss: 3.814 Test Acc: 0.043
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 3.7659664
	speed: 0.2140s/iter; left time: 4074.8590s
	iters: 200, epoch: 9 | loss: 3.6578820
	speed: 0.0770s/iter; left time: 1459.0428s
Epoch: 9 cost time: 16.215429067611694
Epoch: 9, Steps: 208 | Train Loss: 3.722 Vali Loss: 3.678 Vali Acc: 0.035 Test Loss: 3.678 Test Acc: 0.035
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 3.8315859
	speed: 0.2103s/iter; left time: 3960.4325s
	iters: 200, epoch: 10 | loss: 3.7072928
	speed: 0.0752s/iter; left time: 1407.6405s
Epoch: 10 cost time: 16.01730465888977
Epoch: 10, Steps: 208 | Train Loss: 3.714 Vali Loss: 3.813 Vali Acc: 0.026 Test Loss: 3.813 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 3.7286880
	speed: 0.2072s/iter; left time: 3857.6728s
	iters: 200, epoch: 11 | loss: 3.7034333
	speed: 0.0667s/iter; left time: 1234.9833s
Epoch: 11 cost time: 14.934542179107666
Epoch: 11, Steps: 208 | Train Loss: 3.745 Vali Loss: 3.730 Vali Acc: 0.026 Test Loss: 3.730 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 3.6268642
	speed: 0.2123s/iter; left time: 3909.1508s
	iters: 200, epoch: 12 | loss: 3.5623660
	speed: 0.0783s/iter; left time: 1434.3737s
Epoch: 12 cost time: 16.67838454246521
Epoch: 12, Steps: 208 | Train Loss: 3.738 Vali Loss: 3.744 Vali Acc: 0.026 Test Loss: 3.744 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 3.7438908
	speed: 0.2088s/iter; left time: 3800.6588s
	iters: 200, epoch: 13 | loss: 3.6735761
	speed: 0.0658s/iter; left time: 1192.0107s
Epoch: 13 cost time: 14.866091012954712
Epoch: 13, Steps: 208 | Train Loss: 3.731 Vali Loss: 3.708 Vali Acc: 0.026 Test Loss: 3.708 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 3.7789447
	speed: 0.2092s/iter; left time: 3764.1279s
	iters: 200, epoch: 14 | loss: 3.6915548
	speed: 0.0710s/iter; left time: 1271.1465s
Epoch: 14 cost time: 15.880627393722534
Epoch: 14, Steps: 208 | Train Loss: 3.712 Vali Loss: 3.723 Vali Acc: 0.026 Test Loss: 3.723 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 3.7167249
	speed: 0.2041s/iter; left time: 3631.5617s
	iters: 200, epoch: 15 | loss: 3.6737640
	speed: 0.0636s/iter; left time: 1125.8489s
Epoch: 15 cost time: 14.185788631439209
Epoch: 15, Steps: 208 | Train Loss: 3.713 Vali Loss: 3.688 Vali Acc: 0.026 Test Loss: 3.688 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 3.5910203
	speed: 0.2142s/iter; left time: 3765.3943s
	iters: 200, epoch: 16 | loss: 3.7231951
	speed: 0.0717s/iter; left time: 1253.1824s
Epoch: 16 cost time: 15.682275772094727
Epoch: 16, Steps: 208 | Train Loss: 3.709 Vali Loss: 3.690 Vali Acc: 0.026 Test Loss: 3.690 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.05010438413361169
model parameter : 6110527
model size : 28.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 7.9591227
	speed: 0.1062s/iter; left time: 2198.2252s
	iters: 200, epoch: 1 | loss: 5.4533367
	speed: 0.0871s/iter; left time: 1794.4971s
Epoch: 1 cost time: 20.138300895690918
Epoch: 1, Steps: 208 | Train Loss: 6.475 Vali Loss: 6.796 Vali Acc: 0.041 Test Loss: 6.796 Test Acc: 0.041
Validation loss decreased (inf --> -0.041089).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.9952612
	speed: 0.2372s/iter; left time: 4859.9509s
	iters: 200, epoch: 2 | loss: 5.4643164
	speed: 0.0883s/iter; left time: 1800.0480s
Epoch: 2 cost time: 18.22000002861023
Epoch: 2, Steps: 208 | Train Loss: 4.955 Vali Loss: 4.553 Vali Acc: 0.045 Test Loss: 4.553 Test Acc: 0.045
Validation loss decreased (-0.041089 --> -0.044989).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.3765550
	speed: 0.2505s/iter; left time: 5081.1187s
	iters: 200, epoch: 3 | loss: 4.2428389
	speed: 0.1022s/iter; left time: 2062.1176s
Epoch: 3 cost time: 20.732586145401
Epoch: 3, Steps: 208 | Train Loss: 4.452 Vali Loss: 4.469 Vali Acc: 0.038 Test Loss: 4.469 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 4.8564920
	speed: 0.2469s/iter; left time: 4957.1208s
	iters: 200, epoch: 4 | loss: 5.0348153
	speed: 0.1036s/iter; left time: 2068.8899s
Epoch: 4 cost time: 21.457576751708984
Epoch: 4, Steps: 208 | Train Loss: 4.320 Vali Loss: 4.383 Vali Acc: 0.027 Test Loss: 4.383 Test Acc: 0.027
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 4.3586431
	speed: 0.2578s/iter; left time: 5121.7532s
	iters: 200, epoch: 5 | loss: 4.1390429
	speed: 0.0797s/iter; left time: 1575.9439s
Epoch: 5 cost time: 19.363928079605103
Epoch: 5, Steps: 208 | Train Loss: 4.206 Vali Loss: 4.175 Vali Acc: 0.026 Test Loss: 4.175 Test Acc: 0.026
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 3.6640208
	speed: 0.2294s/iter; left time: 4510.8407s
	iters: 200, epoch: 6 | loss: 4.3659096
	speed: 0.0861s/iter; left time: 1684.0615s
Epoch: 6 cost time: 18.766639471054077
Epoch: 6, Steps: 208 | Train Loss: 4.057 Vali Loss: 3.837 Vali Acc: 0.024 Test Loss: 3.837 Test Acc: 0.024
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 4.0540504
	speed: 0.2044s/iter; left time: 3977.0299s
	iters: 200, epoch: 7 | loss: 4.3430448
	speed: 0.0811s/iter; left time: 1569.0806s
Epoch: 7 cost time: 16.05763864517212
Epoch: 7, Steps: 208 | Train Loss: 4.081 Vali Loss: 4.186 Vali Acc: 0.038 Test Loss: 4.186 Test Acc: 0.038
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 4.1254940
	speed: 0.2272s/iter; left time: 4373.4202s
	iters: 200, epoch: 8 | loss: 3.8585958
	speed: 0.0958s/iter; left time: 1833.3827s
Epoch: 8 cost time: 19.938337802886963
Epoch: 8, Steps: 208 | Train Loss: 3.874 Vali Loss: 3.682 Vali Acc: 0.039 Test Loss: 3.682 Test Acc: 0.039
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 3.5238724
	speed: 0.2181s/iter; left time: 4152.1130s
	iters: 200, epoch: 9 | loss: 4.0617151
	speed: 0.0908s/iter; left time: 1719.1597s
Epoch: 9 cost time: 18.608635187149048
Epoch: 9, Steps: 208 | Train Loss: 3.722 Vali Loss: 3.788 Vali Acc: 0.036 Test Loss: 3.788 Test Acc: 0.036
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 3.7566628
	speed: 0.1892s/iter; left time: 3563.2626s
	iters: 200, epoch: 10 | loss: 3.5009520
	speed: 0.0377s/iter; left time: 705.4466s
Epoch: 10 cost time: 10.342426061630249
Epoch: 10, Steps: 208 | Train Loss: 3.682 Vali Loss: 3.600 Vali Acc: 0.039 Test Loss: 3.600 Test Acc: 0.039
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 3.5934014
	speed: 0.1474s/iter; left time: 2745.6074s
	iters: 200, epoch: 11 | loss: 3.6724336
	speed: 0.0792s/iter; left time: 1466.4514s
Epoch: 11 cost time: 13.452857255935669
Epoch: 11, Steps: 208 | Train Loss: 3.634 Vali Loss: 3.658 Vali Acc: 0.035 Test Loss: 3.658 Test Acc: 0.035
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 3.6114841
	speed: 0.1887s/iter; left time: 3474.6099s
	iters: 200, epoch: 12 | loss: 3.5551164
	speed: 0.0942s/iter; left time: 1725.1735s
Epoch: 12 cost time: 18.484735012054443
Epoch: 12, Steps: 208 | Train Loss: 3.668 Vali Loss: 3.614 Vali Acc: 0.041 Test Loss: 3.614 Test Acc: 0.041
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.04503429764390098
model parameter : 5731135
model size : 26.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 6.9293394
	speed: 0.0890s/iter; left time: 1842.3626s
	iters: 200, epoch: 1 | loss: 6.5945234
	speed: 0.0749s/iter; left time: 1542.4358s
Epoch: 1 cost time: 17.11591863632202
Epoch: 1, Steps: 208 | Train Loss: 6.487 Vali Loss: 6.424 Vali Acc: 0.047 Test Loss: 6.424 Test Acc: 0.047
Validation loss decreased (inf --> -0.046759).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.0329866
	speed: 0.2051s/iter; left time: 4202.9517s
	iters: 200, epoch: 2 | loss: 5.5685978
	speed: 0.0639s/iter; left time: 1302.4522s
Epoch: 2 cost time: 14.659541606903076
Epoch: 2, Steps: 208 | Train Loss: 4.877 Vali Loss: 4.616 Vali Acc: 0.046 Test Loss: 4.616 Test Acc: 0.046
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.6127048
	speed: 0.2093s/iter; left time: 4246.6558s
	iters: 200, epoch: 3 | loss: 4.5580025
	speed: 0.0762s/iter; left time: 1538.4443s
Epoch: 3 cost time: 16.430060386657715
Epoch: 3, Steps: 208 | Train Loss: 4.600 Vali Loss: 4.928 Vali Acc: 0.026 Test Loss: 4.928 Test Acc: 0.026
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 4.2659645
	speed: 0.2050s/iter; left time: 4116.3647s
	iters: 200, epoch: 4 | loss: 4.6899323
	speed: 0.0648s/iter; left time: 1295.3705s
Epoch: 4 cost time: 14.266349792480469
Epoch: 4, Steps: 208 | Train Loss: 4.417 Vali Loss: 4.333 Vali Acc: 0.026 Test Loss: 4.333 Test Acc: 0.026
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 4.3003755
	speed: 0.2282s/iter; left time: 4533.6441s
	iters: 200, epoch: 5 | loss: 3.7764878
	speed: 0.0811s/iter; left time: 1603.6253s
Epoch: 5 cost time: 17.296939611434937
Epoch: 5, Steps: 208 | Train Loss: 4.205 Vali Loss: 4.002 Vali Acc: 0.026 Test Loss: 4.002 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 4.3744240
	speed: 0.2229s/iter; left time: 4383.1449s
	iters: 200, epoch: 6 | loss: 3.7487135
	speed: 0.0802s/iter; left time: 1567.9018s
Epoch: 6 cost time: 16.195096492767334
Epoch: 6, Steps: 208 | Train Loss: 4.009 Vali Loss: 3.910 Vali Acc: 0.026 Test Loss: 3.910 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 3.8616161
	speed: 0.2365s/iter; left time: 4601.1174s
	iters: 200, epoch: 7 | loss: 4.0491247
	speed: 0.0883s/iter; left time: 1708.1677s
Epoch: 7 cost time: 18.158847332000732
Epoch: 7, Steps: 208 | Train Loss: 3.881 Vali Loss: 3.759 Vali Acc: 0.026 Test Loss: 3.759 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 3.8695145
	speed: 0.2280s/iter; left time: 4388.0434s
	iters: 200, epoch: 8 | loss: 3.5250618
	speed: 0.0806s/iter; left time: 1543.4559s
Epoch: 8 cost time: 17.203381299972534
Epoch: 8, Steps: 208 | Train Loss: 3.812 Vali Loss: 3.805 Vali Acc: 0.026 Test Loss: 3.805 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 4.0734677
	speed: 0.2153s/iter; left time: 4098.7900s
	iters: 200, epoch: 9 | loss: 3.7332001
	speed: 0.0773s/iter; left time: 1462.9588s
Epoch: 9 cost time: 16.24635410308838
Epoch: 9, Steps: 208 | Train Loss: 3.789 Vali Loss: 3.812 Vali Acc: 0.026 Test Loss: 3.812 Test Acc: 0.026
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 3.7262783
	speed: 0.2109s/iter; left time: 3971.5903s
	iters: 200, epoch: 10 | loss: 3.7096441
	speed: 0.0721s/iter; left time: 1350.5639s
Epoch: 10 cost time: 15.42257022857666
Epoch: 10, Steps: 208 | Train Loss: 3.770 Vali Loss: 3.697 Vali Acc: 0.026 Test Loss: 3.697 Test Acc: 0.026
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 3.5948408
	speed: 0.2130s/iter; left time: 3965.9853s
	iters: 200, epoch: 11 | loss: 3.8726125
	speed: 0.0699s/iter; left time: 1295.2792s
Epoch: 11 cost time: 15.941065311431885
Epoch: 11, Steps: 208 | Train Loss: 3.745 Vali Loss: 3.762 Vali Acc: 0.026 Test Loss: 3.762 Test Acc: 0.026
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.04682373993438712
model parameter : 5726271
model size : 26.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 10.4702702
	speed: 0.0923s/iter; left time: 1910.0246s
	iters: 200, epoch: 1 | loss: 7.0535483
	speed: 0.0710s/iter; left time: 1463.2094s
Epoch: 1 cost time: 17.04624915122986
Epoch: 1, Steps: 208 | Train Loss: 6.543 Vali Loss: 6.355 Vali Acc: 0.043 Test Loss: 6.355 Test Acc: 0.043
Validation loss decreased (inf --> -0.043181).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.3728132
	speed: 0.2112s/iter; left time: 4328.7603s
	iters: 200, epoch: 2 | loss: 4.2934170
	speed: 0.0726s/iter; left time: 1480.6318s
Epoch: 2 cost time: 15.553484678268433
Epoch: 2, Steps: 208 | Train Loss: 5.014 Vali Loss: 4.613 Vali Acc: 0.037 Test Loss: 4.613 Test Acc: 0.037
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.1594243
	speed: 0.2088s/iter; left time: 4236.1606s
	iters: 200, epoch: 3 | loss: 5.1081820
	speed: 0.0714s/iter; left time: 1441.4890s
Epoch: 3 cost time: 15.470077991485596
Epoch: 3, Steps: 208 | Train Loss: 4.603 Vali Loss: 4.396 Vali Acc: 0.026 Test Loss: 4.396 Test Acc: 0.026
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 3.8655429
	speed: 0.2056s/iter; left time: 4128.1315s
	iters: 200, epoch: 4 | loss: 4.8088284
	speed: 0.0690s/iter; left time: 1378.7654s
Epoch: 4 cost time: 15.14150094985962
Epoch: 4, Steps: 208 | Train Loss: 4.409 Vali Loss: 4.166 Vali Acc: 0.026 Test Loss: 4.166 Test Acc: 0.026
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 4.0243769
	speed: 0.2076s/iter; left time: 4125.5089s
	iters: 200, epoch: 5 | loss: 4.1158228
	speed: 0.0746s/iter; left time: 1475.6046s
Epoch: 5 cost time: 15.449709415435791
Epoch: 5, Steps: 208 | Train Loss: 4.154 Vali Loss: 4.005 Vali Acc: 0.026 Test Loss: 4.005 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 3.6948535
	speed: 0.2130s/iter; left time: 4187.6795s
	iters: 200, epoch: 6 | loss: 3.7099175
	speed: 0.0782s/iter; left time: 1530.1818s
Epoch: 6 cost time: 15.972613096237183
Epoch: 6, Steps: 208 | Train Loss: 3.972 Vali Loss: 3.758 Vali Acc: 0.042 Test Loss: 3.758 Test Acc: 0.042
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 5.5583048
	speed: 0.2101s/iter; left time: 4087.3252s
	iters: 200, epoch: 7 | loss: 3.6810250
	speed: 0.0730s/iter; left time: 1412.0835s
Epoch: 7 cost time: 15.810368537902832
Epoch: 7, Steps: 208 | Train Loss: 4.510 Vali Loss: 3.903 Vali Acc: 0.043 Test Loss: 3.903 Test Acc: 0.043
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 4.2397752
	speed: 0.2088s/iter; left time: 4017.9657s
	iters: 200, epoch: 8 | loss: 3.6243484
	speed: 0.0741s/iter; left time: 1417.8265s
Epoch: 8 cost time: 15.843035221099854
Epoch: 8, Steps: 208 | Train Loss: 3.913 Vali Loss: 3.768 Vali Acc: 0.026 Test Loss: 3.768 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 4.0611200
	speed: 0.2097s/iter; left time: 3992.4208s
	iters: 200, epoch: 9 | loss: 3.7365434
	speed: 0.0620s/iter; left time: 1174.4054s
Epoch: 9 cost time: 14.59394121170044
Epoch: 9, Steps: 208 | Train Loss: 3.748 Vali Loss: 3.780 Vali Acc: 0.033 Test Loss: 3.780 Test Acc: 0.033
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 3.6388130
	speed: 0.2119s/iter; left time: 3989.0662s
	iters: 200, epoch: 10 | loss: 3.4175520
	speed: 0.0863s/iter; left time: 1617.1266s
Epoch: 10 cost time: 17.579644203186035
Epoch: 10, Steps: 208 | Train Loss: 3.620 Vali Loss: 3.597 Vali Acc: 0.055 Test Loss: 3.597 Test Acc: 0.055
Validation loss decreased (-0.043181 --> -0.055139).  Saving model ...
	iters: 100, epoch: 11 | loss: 3.6515436
	speed: 0.2234s/iter; left time: 4160.6198s
	iters: 200, epoch: 11 | loss: 3.5813985
	speed: 0.0682s/iter; left time: 1263.6399s
Epoch: 11 cost time: 14.785891056060791
Epoch: 11, Steps: 208 | Train Loss: 3.582 Vali Loss: 3.551 Vali Acc: 0.049 Test Loss: 3.551 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 3.4669974
	speed: 0.2358s/iter; left time: 4342.3137s
	iters: 200, epoch: 12 | loss: 3.6102030
	speed: 0.0786s/iter; left time: 1439.9766s
Epoch: 12 cost time: 17.230384349822998
Epoch: 12, Steps: 208 | Train Loss: 3.536 Vali Loss: 3.532 Vali Acc: 0.065 Test Loss: 3.532 Test Acc: 0.065
Validation loss decreased (-0.055139 --> -0.065279).  Saving model ...
	iters: 100, epoch: 13 | loss: 3.6123683
	speed: 0.2327s/iter; left time: 4236.2252s
	iters: 200, epoch: 13 | loss: 3.7599635
	speed: 0.0852s/iter; left time: 1541.7309s
Epoch: 13 cost time: 17.495836973190308
Epoch: 13, Steps: 208 | Train Loss: 3.510 Vali Loss: 3.584 Vali Acc: 0.053 Test Loss: 3.584 Test Acc: 0.053
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 3.1571727
	speed: 0.2293s/iter; left time: 4125.8427s
	iters: 200, epoch: 14 | loss: 3.3890209
	speed: 0.0574s/iter; left time: 1026.8582s
Epoch: 14 cost time: 14.04049301147461
Epoch: 14, Steps: 208 | Train Loss: 3.512 Vali Loss: 3.566 Vali Acc: 0.057 Test Loss: 3.566 Test Acc: 0.057
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 3.4950745
	speed: 0.1373s/iter; left time: 2442.4854s
	iters: 200, epoch: 15 | loss: 3.2567105
	speed: 0.0727s/iter; left time: 1285.4326s
Epoch: 15 cost time: 11.889359951019287
Epoch: 15, Steps: 208 | Train Loss: 3.499 Vali Loss: 3.587 Vali Acc: 0.055 Test Loss: 3.587 Test Acc: 0.055
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 3.2668288
	speed: 0.2105s/iter; left time: 3700.6584s
	iters: 200, epoch: 16 | loss: 3.4176092
	speed: 0.0770s/iter; left time: 1346.3604s
Epoch: 16 cost time: 15.9867262840271
Epoch: 16, Steps: 208 | Train Loss: 3.474 Vali Loss: 3.609 Vali Acc: 0.059 Test Loss: 3.609 Test Acc: 0.059
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 3.4296720
	speed: 0.2081s/iter; left time: 3615.8421s
	iters: 200, epoch: 17 | loss: 3.6252298
	speed: 0.0690s/iter; left time: 1191.3882s
Epoch: 17 cost time: 15.446950912475586
Epoch: 17, Steps: 208 | Train Loss: 3.461 Vali Loss: 3.528 Vali Acc: 0.057 Test Loss: 3.528 Test Acc: 0.057
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 3.4872253
	speed: 0.1763s/iter; left time: 3026.5019s
	iters: 200, epoch: 18 | loss: 3.4692078
	speed: 0.0604s/iter; left time: 1030.9963s
Epoch: 18 cost time: 13.090383768081665
Epoch: 18, Steps: 208 | Train Loss: 3.445 Vali Loss: 3.525 Vali Acc: 0.056 Test Loss: 3.525 Test Acc: 0.056
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 3.1653347
	speed: 0.2043s/iter; left time: 3463.5303s
	iters: 200, epoch: 19 | loss: 3.2886446
	speed: 0.0726s/iter; left time: 1223.7896s
Epoch: 19 cost time: 15.577230453491211
Epoch: 19, Steps: 208 | Train Loss: 3.431 Vali Loss: 3.575 Vali Acc: 0.055 Test Loss: 3.575 Test Acc: 0.055
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 3.4945350
	speed: 0.2057s/iter; left time: 3445.8155s
	iters: 200, epoch: 20 | loss: 3.2792876
	speed: 0.0706s/iter; left time: 1174.6149s
Epoch: 20 cost time: 14.400068521499634
Epoch: 20, Steps: 208 | Train Loss: 3.402 Vali Loss: 3.526 Vali Acc: 0.061 Test Loss: 3.526 Test Acc: 0.061
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 3.4810672
	speed: 0.2090s/iter; left time: 3457.6155s
	iters: 200, epoch: 21 | loss: 3.5371010
	speed: 0.0751s/iter; left time: 1235.2986s
Epoch: 21 cost time: 15.747008562088013
Epoch: 21, Steps: 208 | Train Loss: 3.401 Vali Loss: 3.598 Vali Acc: 0.061 Test Loss: 3.598 Test Acc: 0.061
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 3.3247869
	speed: 0.2148s/iter; left time: 3508.2509s
	iters: 200, epoch: 22 | loss: 3.9082444
	speed: 0.0777s/iter; left time: 1261.4820s
Epoch: 22 cost time: 16.125767469406128
Epoch: 22, Steps: 208 | Train Loss: 3.382 Vali Loss: 3.508 Vali Acc: 0.063 Test Loss: 3.508 Test Acc: 0.063
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.0653146436027438
model parameter : 5721407
model size : 26.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 8.1072245
	speed: 0.0821s/iter; left time: 1699.7148s
	iters: 200, epoch: 1 | loss: 7.1004572
	speed: 0.0745s/iter; left time: 1534.9289s
Epoch: 1 cost time: 16.33249831199646
Epoch: 1, Steps: 208 | Train Loss: 7.031 Vali Loss: 8.193 Vali Acc: 0.034 Test Loss: 8.193 Test Acc: 0.034
Validation loss decreased (inf --> -0.033917).  Saving model ...
	iters: 100, epoch: 2 | loss: 6.8424911
	speed: 0.2139s/iter; left time: 4382.4343s
	iters: 200, epoch: 2 | loss: 4.5440493
	speed: 0.0732s/iter; left time: 1491.8086s
Epoch: 2 cost time: 15.907570838928223
Epoch: 2, Steps: 208 | Train Loss: 5.583 Vali Loss: 5.077 Vali Acc: 0.028 Test Loss: 5.077 Test Acc: 0.028
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.1534324
	speed: 0.2201s/iter; left time: 4465.0091s
	iters: 200, epoch: 3 | loss: 3.9994869
	speed: 0.0726s/iter; left time: 1464.8911s
Epoch: 3 cost time: 16.290627479553223
Epoch: 3, Steps: 208 | Train Loss: 4.484 Vali Loss: 4.244 Vali Acc: 0.048 Test Loss: 4.244 Test Acc: 0.048
Validation loss decreased (-0.033917 --> -0.048273).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.6347065
	speed: 0.2037s/iter; left time: 4090.0345s
	iters: 200, epoch: 4 | loss: 4.3117881
	speed: 0.0621s/iter; left time: 1240.6063s
Epoch: 4 cost time: 13.676366806030273
Epoch: 4, Steps: 208 | Train Loss: 4.292 Vali Loss: 4.401 Vali Acc: 0.027 Test Loss: 4.401 Test Acc: 0.027
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.8815277
	speed: 0.2300s/iter; left time: 4570.0114s
	iters: 200, epoch: 5 | loss: 3.9796424
	speed: 0.0796s/iter; left time: 1573.0990s
Epoch: 5 cost time: 17.07300591468811
Epoch: 5, Steps: 208 | Train Loss: 4.130 Vali Loss: 3.929 Vali Acc: 0.049 Test Loss: 3.929 Test Acc: 0.049
Validation loss decreased (-0.048273 --> -0.048574).  Saving model ...
	iters: 100, epoch: 6 | loss: 4.3133397
	speed: 0.2227s/iter; left time: 4377.9344s
	iters: 200, epoch: 6 | loss: 3.6323783
	speed: 0.0886s/iter; left time: 1733.8704s
Epoch: 6 cost time: 17.403284788131714
Epoch: 6, Steps: 208 | Train Loss: 3.889 Vali Loss: 3.824 Vali Acc: 0.044 Test Loss: 3.824 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 4.1583662
	speed: 0.2304s/iter; left time: 4482.5015s
	iters: 200, epoch: 7 | loss: 3.9385114
	speed: 0.0841s/iter; left time: 1627.4933s
Epoch: 7 cost time: 17.966365337371826
Epoch: 7, Steps: 208 | Train Loss: 3.786 Vali Loss: 3.833 Vali Acc: 0.033 Test Loss: 3.833 Test Acc: 0.033
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.7295802
	speed: 0.2275s/iter; left time: 4378.0713s
	iters: 200, epoch: 8 | loss: 3.7274492
	speed: 0.0779s/iter; left time: 1491.5512s
Epoch: 8 cost time: 16.637811183929443
Epoch: 8, Steps: 208 | Train Loss: 3.829 Vali Loss: 3.897 Vali Acc: 0.026 Test Loss: 3.897 Test Acc: 0.026
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 3.6904047
	speed: 0.2092s/iter; left time: 3981.9111s
	iters: 200, epoch: 9 | loss: 3.7679770
	speed: 0.0690s/iter; left time: 1307.1604s
Epoch: 9 cost time: 15.269754409790039
Epoch: 9, Steps: 208 | Train Loss: 3.811 Vali Loss: 3.734 Vali Acc: 0.026 Test Loss: 3.734 Test Acc: 0.026
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 3.7820389
	speed: 0.2101s/iter; left time: 3955.6269s
	iters: 200, epoch: 10 | loss: 3.7572894
	speed: 0.0716s/iter; left time: 1341.4017s
Epoch: 10 cost time: 15.356748104095459
Epoch: 10, Steps: 208 | Train Loss: 3.774 Vali Loss: 3.756 Vali Acc: 0.026 Test Loss: 3.756 Test Acc: 0.026
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 3.9107988
	speed: 0.2002s/iter; left time: 3728.6832s
	iters: 200, epoch: 11 | loss: 3.6852598
	speed: 0.0625s/iter; left time: 1156.9416s
Epoch: 11 cost time: 14.274378538131714
Epoch: 11, Steps: 208 | Train Loss: 3.747 Vali Loss: 3.749 Vali Acc: 0.026 Test Loss: 3.749 Test Acc: 0.026
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 3.8243439
	speed: 0.2033s/iter; left time: 3742.6893s
	iters: 200, epoch: 12 | loss: 3.6936176
	speed: 0.0671s/iter; left time: 1228.1000s
Epoch: 12 cost time: 14.392770528793335
Epoch: 12, Steps: 208 | Train Loss: 3.743 Vali Loss: 3.716 Vali Acc: 0.026 Test Loss: 3.716 Test Acc: 0.026
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 3.7908370
	speed: 0.2055s/iter; left time: 3740.5329s
	iters: 200, epoch: 13 | loss: 3.7934084
	speed: 0.0728s/iter; left time: 1317.5639s
Epoch: 13 cost time: 15.073873281478882
Epoch: 13, Steps: 208 | Train Loss: 3.719 Vali Loss: 3.706 Vali Acc: 0.042 Test Loss: 3.706 Test Acc: 0.042
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 3.6529288
	speed: 0.2140s/iter; left time: 3851.6814s
	iters: 200, epoch: 14 | loss: 3.7445333
	speed: 0.0746s/iter; left time: 1335.4348s
Epoch: 14 cost time: 16.39470362663269
Epoch: 14, Steps: 208 | Train Loss: 3.685 Vali Loss: 3.604 Vali Acc: 0.033 Test Loss: 3.604 Test Acc: 0.033
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 3.5733650
	speed: 0.2012s/iter; left time: 3578.7803s
	iters: 200, epoch: 15 | loss: 3.3213420
	speed: 0.0631s/iter; left time: 1115.5330s
Epoch: 15 cost time: 14.347963571548462
Epoch: 15, Steps: 208 | Train Loss: 3.564 Vali Loss: 3.539 Vali Acc: 0.055 Test Loss: 3.539 Test Acc: 0.055
Validation loss decreased (-0.048574 --> -0.054543).  Saving model ...
	iters: 100, epoch: 16 | loss: 3.4500680
	speed: 0.2079s/iter; left time: 3655.0499s
	iters: 200, epoch: 16 | loss: 3.5270851
	speed: 0.0697s/iter; left time: 1219.2143s
Epoch: 16 cost time: 15.070945501327515
Epoch: 16, Steps: 208 | Train Loss: 3.500 Vali Loss: 3.511 Vali Acc: 0.065 Test Loss: 3.511 Test Acc: 0.065
Validation loss decreased (-0.054543 --> -0.064683).  Saving model ...
	iters: 100, epoch: 17 | loss: 3.3305640
	speed: 0.1983s/iter; left time: 3445.6729s
	iters: 200, epoch: 17 | loss: 3.5636082
	speed: 0.0658s/iter; left time: 1136.9459s
Epoch: 17 cost time: 14.498126983642578
Epoch: 17, Steps: 208 | Train Loss: 3.467 Vali Loss: 3.531 Vali Acc: 0.057 Test Loss: 3.531 Test Acc: 0.057
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 3.6155932
	speed: 0.2114s/iter; left time: 3629.3475s
	iters: 200, epoch: 18 | loss: 3.4211416
	speed: 0.0756s/iter; left time: 1290.2839s
Epoch: 18 cost time: 15.9755220413208
Epoch: 18, Steps: 208 | Train Loss: 3.416 Vali Loss: 3.538 Vali Acc: 0.055 Test Loss: 3.538 Test Acc: 0.055
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 3.8431537
	speed: 0.2011s/iter; left time: 3409.8428s
	iters: 200, epoch: 19 | loss: 3.4051056
	speed: 0.0712s/iter; left time: 1199.5672s
Epoch: 19 cost time: 14.673114538192749
Epoch: 19, Steps: 208 | Train Loss: 3.375 Vali Loss: 3.496 Vali Acc: 0.065 Test Loss: 3.496 Test Acc: 0.065
Validation loss decreased (-0.064683 --> -0.065280).  Saving model ...
	iters: 100, epoch: 20 | loss: 3.1883111
	speed: 0.2150s/iter; left time: 3601.2989s
	iters: 200, epoch: 20 | loss: 3.3468447
	speed: 0.0732s/iter; left time: 1218.4554s
Epoch: 20 cost time: 15.608393430709839
Epoch: 20, Steps: 208 | Train Loss: 3.351 Vali Loss: 3.498 Vali Acc: 0.067 Test Loss: 3.498 Test Acc: 0.067
Validation loss decreased (-0.065280 --> -0.067069).  Saving model ...
	iters: 100, epoch: 21 | loss: 3.2720351
	speed: 0.2081s/iter; left time: 3442.5153s
	iters: 200, epoch: 21 | loss: 3.0762434
	speed: 0.0707s/iter; left time: 1162.1008s
Epoch: 21 cost time: 15.328965663909912
Epoch: 21, Steps: 208 | Train Loss: 3.324 Vali Loss: 3.427 Vali Acc: 0.077 Test Loss: 3.427 Test Acc: 0.077
Validation loss decreased (-0.067069 --> -0.077210).  Saving model ...
	iters: 100, epoch: 22 | loss: 3.4272163
	speed: 0.2275s/iter; left time: 3716.1529s
	iters: 200, epoch: 22 | loss: 3.4896197
	speed: 0.0808s/iter; left time: 1311.2328s
Epoch: 22 cost time: 17.5878643989563
Epoch: 22, Steps: 208 | Train Loss: 3.292 Vali Loss: 3.446 Vali Acc: 0.080 Test Loss: 3.446 Test Acc: 0.080
Validation loss decreased (-0.077210 --> -0.080192).  Saving model ...
	iters: 100, epoch: 23 | loss: 3.2851038
	speed: 0.2377s/iter; left time: 3832.7340s
	iters: 200, epoch: 23 | loss: 3.0384898
	speed: 0.0816s/iter; left time: 1307.9572s
Epoch: 23 cost time: 17.395564079284668
Epoch: 23, Steps: 208 | Train Loss: 3.257 Vali Loss: 3.495 Vali Acc: 0.073 Test Loss: 3.495 Test Acc: 0.073
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 3.1541822
	speed: 0.2025s/iter; left time: 3223.1964s
	iters: 200, epoch: 24 | loss: 3.1747842
	speed: 0.0558s/iter; left time: 882.8742s
Epoch: 24 cost time: 11.795652389526367
Epoch: 24, Steps: 208 | Train Loss: 3.254 Vali Loss: 3.477 Vali Acc: 0.076 Test Loss: 3.477 Test Acc: 0.076
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 3.3250344
	speed: 0.1477s/iter; left time: 2320.0900s
	iters: 200, epoch: 25 | loss: 3.1404552
	speed: 0.0286s/iter; left time: 445.8689s
Epoch: 25 cost time: 6.5946574211120605
Epoch: 25, Steps: 208 | Train Loss: 3.226 Vali Loss: 3.446 Vali Acc: 0.077 Test Loss: 3.446 Test Acc: 0.077
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 3.2167468
	speed: 0.1989s/iter; left time: 3082.3954s
	iters: 200, epoch: 26 | loss: 3.2199392
	speed: 0.0744s/iter; left time: 1145.9122s
Epoch: 26 cost time: 15.431204557418823
Epoch: 26, Steps: 208 | Train Loss: 3.213 Vali Loss: 3.409 Vali Acc: 0.083 Test Loss: 3.409 Test Acc: 0.083
Validation loss decreased (-0.080192 --> -0.082578).  Saving model ...
	iters: 100, epoch: 27 | loss: 3.3681016
	speed: 0.2038s/iter; left time: 3116.1304s
	iters: 200, epoch: 27 | loss: 2.9905629
	speed: 0.0730s/iter; left time: 1108.7724s
Epoch: 27 cost time: 15.286705493927002
Epoch: 27, Steps: 208 | Train Loss: 3.182 Vali Loss: 3.386 Vali Acc: 0.089 Test Loss: 3.386 Test Acc: 0.089
Validation loss decreased (-0.082578 --> -0.089438).  Saving model ...
	iters: 100, epoch: 28 | loss: 3.4458764
	speed: 0.2055s/iter; left time: 3099.5294s
	iters: 200, epoch: 28 | loss: 3.1165628
	speed: 0.0711s/iter; left time: 1065.9956s
Epoch: 28 cost time: 15.462730646133423
Epoch: 28, Steps: 208 | Train Loss: 3.157 Vali Loss: 3.430 Vali Acc: 0.074 Test Loss: 3.430 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 2.6804109
	speed: 0.2049s/iter; left time: 3048.3333s
	iters: 200, epoch: 29 | loss: 3.1170883
	speed: 0.0618s/iter; left time: 913.5347s
Epoch: 29 cost time: 14.413602590560913
Epoch: 29, Steps: 208 | Train Loss: 3.149 Vali Loss: 3.445 Vali Acc: 0.071 Test Loss: 3.445 Test Acc: 0.071
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 2.9870181
	speed: 0.2083s/iter; left time: 3056.2197s
	iters: 200, epoch: 30 | loss: 2.9342010
	speed: 0.0689s/iter; left time: 1003.9262s
Epoch: 30 cost time: 15.320554494857788
Epoch: 30, Steps: 208 | Train Loss: 3.132 Vali Loss: 3.429 Vali Acc: 0.077 Test Loss: 3.429 Test Acc: 0.077
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 4.0614676
	speed: 0.1883s/iter; left time: 2723.2233s
	iters: 200, epoch: 31 | loss: 2.9803791
	speed: 0.0634s/iter; left time: 910.5327s
Epoch: 31 cost time: 12.664281129837036
Epoch: 31, Steps: 208 | Train Loss: 3.128 Vali Loss: 3.427 Vali Acc: 0.084 Test Loss: 3.427 Test Acc: 0.084
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 3.2117856
	speed: 0.2012s/iter; left time: 2867.6814s
	iters: 200, epoch: 32 | loss: 3.2603452
	speed: 0.0720s/iter; left time: 1019.5614s
Epoch: 32 cost time: 15.285187005996704
Epoch: 32, Steps: 208 | Train Loss: 3.105 Vali Loss: 3.437 Vali Acc: 0.075 Test Loss: 3.437 Test Acc: 0.075
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 2.8319848
	speed: 0.1877s/iter; left time: 2636.8675s
	iters: 200, epoch: 33 | loss: 2.9116962
	speed: 0.0745s/iter; left time: 1039.2466s
Epoch: 33 cost time: 14.36930537223816
Epoch: 33, Steps: 208 | Train Loss: 3.092 Vali Loss: 3.409 Vali Acc: 0.096 Test Loss: 3.409 Test Acc: 0.096
Validation loss decreased (-0.089438 --> -0.095701).  Saving model ...
	iters: 100, epoch: 34 | loss: 3.2573395
	speed: 0.2036s/iter; left time: 2817.3516s
	iters: 200, epoch: 34 | loss: 3.1294363
	speed: 0.0752s/iter; left time: 1033.5947s
Epoch: 34 cost time: 15.81292986869812
Epoch: 34, Steps: 208 | Train Loss: 3.061 Vali Loss: 3.360 Vali Acc: 0.099 Test Loss: 3.360 Test Acc: 0.099
Validation loss decreased (-0.095701 --> -0.098684).  Saving model ...
	iters: 100, epoch: 35 | loss: 3.3066955
	speed: 0.2069s/iter; left time: 2820.2010s
	iters: 200, epoch: 35 | loss: 3.3650761
	speed: 0.0712s/iter; left time: 963.8938s
Epoch: 35 cost time: 15.271999597549438
Epoch: 35, Steps: 208 | Train Loss: 3.028 Vali Loss: 3.409 Vali Acc: 0.088 Test Loss: 3.409 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 3.5593212
	speed: 0.2027s/iter; left time: 2719.9332s
	iters: 200, epoch: 36 | loss: 2.8271646
	speed: 0.0566s/iter; left time: 754.5855s
Epoch: 36 cost time: 13.933757543563843
Epoch: 36, Steps: 208 | Train Loss: 3.038 Vali Loss: 3.470 Vali Acc: 0.089 Test Loss: 3.470 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 2.6358311
	speed: 0.2089s/iter; left time: 2759.5555s
	iters: 200, epoch: 37 | loss: 3.0348685
	speed: 0.0715s/iter; left time: 936.9363s
Epoch: 37 cost time: 15.062329530715942
Epoch: 37, Steps: 208 | Train Loss: 3.021 Vali Loss: 3.377 Vali Acc: 0.098 Test Loss: 3.377 Test Acc: 0.098
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 2.7784278
	speed: 0.2027s/iter; left time: 2636.6251s
	iters: 200, epoch: 38 | loss: 3.2143874
	speed: 0.0675s/iter; left time: 871.3111s
Epoch: 38 cost time: 14.794543027877808
Epoch: 38, Steps: 208 | Train Loss: 2.990 Vali Loss: 3.409 Vali Acc: 0.090 Test Loss: 3.409 Test Acc: 0.090
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 2.7959459
	speed: 0.2072s/iter; left time: 2652.1280s
	iters: 200, epoch: 39 | loss: 3.0700450
	speed: 0.0777s/iter; left time: 986.6252s
Epoch: 39 cost time: 15.935439586639404
Epoch: 39, Steps: 208 | Train Loss: 2.988 Vali Loss: 3.410 Vali Acc: 0.092 Test Loss: 3.410 Test Acc: 0.092
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 40 | loss: 3.0806904
	speed: 0.2275s/iter; left time: 2863.9344s
	iters: 200, epoch: 40 | loss: 2.6024401
	speed: 0.0754s/iter; left time: 941.0618s
Epoch: 40 cost time: 16.432351112365723
Epoch: 40, Steps: 208 | Train Loss: 3.016 Vali Loss: 3.420 Vali Acc: 0.093 Test Loss: 3.420 Test Acc: 0.093
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 41 | loss: 2.7526498
	speed: 0.2288s/iter; left time: 2832.9731s
	iters: 200, epoch: 41 | loss: 2.7251196
	speed: 0.0745s/iter; left time: 915.5059s
Epoch: 41 cost time: 17.003668308258057
Epoch: 41, Steps: 208 | Train Loss: 2.999 Vali Loss: 3.396 Vali Acc: 0.090 Test Loss: 3.396 Test Acc: 0.090
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 42 | loss: 3.2719486
	speed: 0.2220s/iter; left time: 2702.8413s
	iters: 200, epoch: 42 | loss: 3.3873916
	speed: 0.0773s/iter; left time: 933.5303s
Epoch: 42 cost time: 16.301812887191772
Epoch: 42, Steps: 208 | Train Loss: 2.976 Vali Loss: 3.526 Vali Acc: 0.087 Test Loss: 3.526 Test Acc: 0.087
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 43 | loss: 2.7795796
	speed: 0.2213s/iter; left time: 2648.1588s
	iters: 200, epoch: 43 | loss: 2.8531961
	speed: 0.0739s/iter; left time: 877.2735s
Epoch: 43 cost time: 16.145947694778442
Epoch: 43, Steps: 208 | Train Loss: 2.975 Vali Loss: 3.545 Vali Acc: 0.085 Test Loss: 3.545 Test Acc: 0.085
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 44 | loss: 2.7459648
	speed: 0.1995s/iter; left time: 2345.7354s
	iters: 200, epoch: 44 | loss: 2.9024253
	speed: 0.0725s/iter; left time: 845.3226s
Epoch: 44 cost time: 14.533062934875488
Epoch: 44, Steps: 208 | Train Loss: 2.944 Vali Loss: 3.405 Vali Acc: 0.091 Test Loss: 3.405 Test Acc: 0.091
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09871756635848494
model parameter : 5716543
model size : 26.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 6.8412967
	speed: 0.0902s/iter; left time: 1868.0767s
	iters: 200, epoch: 1 | loss: 6.3914056
	speed: 0.0854s/iter; left time: 1759.6963s
Epoch: 1 cost time: 18.284067392349243
Epoch: 1, Steps: 208 | Train Loss: 6.790 Vali Loss: 7.046 Vali Acc: 0.044 Test Loss: 7.046 Test Acc: 0.044
Validation loss decreased (inf --> -0.044367).  Saving model ...
	iters: 100, epoch: 2 | loss: 5.0283031
	speed: 0.2134s/iter; left time: 4373.7344s
	iters: 200, epoch: 2 | loss: 3.9989870
	speed: 0.0807s/iter; left time: 1646.6748s
Epoch: 2 cost time: 17.80203151702881
Epoch: 2, Steps: 208 | Train Loss: 5.348 Vali Loss: 4.367 Vali Acc: 0.026 Test Loss: 4.367 Test Acc: 0.026
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.8320212
	speed: 0.2175s/iter; left time: 4411.6326s
	iters: 200, epoch: 3 | loss: 3.8115036
	speed: 0.0810s/iter; left time: 1634.1060s
Epoch: 3 cost time: 17.8943874835968
Epoch: 3, Steps: 208 | Train Loss: 4.446 Vali Loss: 4.275 Vali Acc: 0.054 Test Loss: 4.275 Test Acc: 0.054
Validation loss decreased (-0.044367 --> -0.053939).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.3767781
	speed: 0.2088s/iter; left time: 4192.6436s
	iters: 200, epoch: 4 | loss: 4.0402336
	speed: 0.0899s/iter; left time: 1795.7853s
Epoch: 4 cost time: 17.175491094589233
Epoch: 4, Steps: 208 | Train Loss: 4.181 Vali Loss: 4.205 Vali Acc: 0.048 Test Loss: 4.205 Test Acc: 0.048
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.8810315
	speed: 0.2255s/iter; left time: 4480.3082s
	iters: 200, epoch: 5 | loss: 3.3743007
	speed: 0.0846s/iter; left time: 1672.8705s
Epoch: 5 cost time: 18.349141120910645
Epoch: 5, Steps: 208 | Train Loss: 4.256 Vali Loss: 4.284 Vali Acc: 0.025 Test Loss: 4.284 Test Acc: 0.025
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 3.8275418
	speed: 0.2263s/iter; left time: 4450.0087s
	iters: 200, epoch: 6 | loss: 3.7288852
	speed: 0.0779s/iter; left time: 1524.7654s
Epoch: 6 cost time: 17.6866352558136
Epoch: 6, Steps: 208 | Train Loss: 4.157 Vali Loss: 4.113 Vali Acc: 0.027 Test Loss: 4.113 Test Acc: 0.027
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 3.4921117
	speed: 0.2137s/iter; left time: 4156.1973s
	iters: 200, epoch: 7 | loss: 3.8061020
	speed: 0.0840s/iter; left time: 1625.1566s
Epoch: 7 cost time: 17.0063693523407
Epoch: 7, Steps: 208 | Train Loss: 3.913 Vali Loss: 3.706 Vali Acc: 0.047 Test Loss: 3.706 Test Acc: 0.047
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 3.8455083
	speed: 0.2279s/iter; left time: 4385.5355s
	iters: 200, epoch: 8 | loss: 3.7690220
	speed: 0.0830s/iter; left time: 1588.2727s
Epoch: 8 cost time: 18.29805898666382
Epoch: 8, Steps: 208 | Train Loss: 3.746 Vali Loss: 3.704 Vali Acc: 0.033 Test Loss: 3.704 Test Acc: 0.033
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 3.8969653
	speed: 0.2246s/iter; left time: 4276.5265s
	iters: 200, epoch: 9 | loss: 3.6481667
	speed: 0.0856s/iter; left time: 1621.5620s
Epoch: 9 cost time: 18.68386936187744
Epoch: 9, Steps: 208 | Train Loss: 3.757 Vali Loss: 3.621 Vali Acc: 0.037 Test Loss: 3.621 Test Acc: 0.037
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 3.6423059
	speed: 0.2141s/iter; left time: 4030.8729s
	iters: 200, epoch: 10 | loss: 3.7883968
	speed: 0.0840s/iter; left time: 1572.4618s
Epoch: 10 cost time: 17.119148015975952
Epoch: 10, Steps: 208 | Train Loss: 3.652 Vali Loss: 3.589 Vali Acc: 0.049 Test Loss: 3.589 Test Acc: 0.049
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 3.7339327
	speed: 0.2154s/iter; left time: 4010.4392s
	iters: 200, epoch: 11 | loss: 3.8016629
	speed: 0.0668s/iter; left time: 1236.5128s
Epoch: 11 cost time: 15.224647998809814
Epoch: 11, Steps: 208 | Train Loss: 3.675 Vali Loss: 3.688 Vali Acc: 0.032 Test Loss: 3.688 Test Acc: 0.032
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 3.7930174
	speed: 0.2462s/iter; left time: 4533.3097s
	iters: 200, epoch: 12 | loss: 3.6558013
	speed: 0.0844s/iter; left time: 1545.2409s
Epoch: 12 cost time: 19.449265480041504
Epoch: 12, Steps: 208 | Train Loss: 3.709 Vali Loss: 3.530 Vali Acc: 0.044 Test Loss: 3.530 Test Acc: 0.044
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 3.5875823
	speed: 0.1599s/iter; left time: 2911.2159s
	iters: 200, epoch: 13 | loss: 3.5256062
	speed: 0.0334s/iter; left time: 604.7949s
Epoch: 13 cost time: 8.13896656036377
Epoch: 13, Steps: 208 | Train Loss: 3.590 Vali Loss: 3.572 Vali Acc: 0.057 Test Loss: 3.572 Test Acc: 0.057
Validation loss decreased (-0.053939 --> -0.057226).  Saving model ...
	iters: 100, epoch: 14 | loss: 3.3709531
	speed: 0.2434s/iter; left time: 4380.3303s
	iters: 200, epoch: 14 | loss: 3.4814479
	speed: 0.0861s/iter; left time: 1541.5552s
Epoch: 14 cost time: 19.248717546463013
Epoch: 14, Steps: 208 | Train Loss: 3.507 Vali Loss: 3.552 Vali Acc: 0.056 Test Loss: 3.552 Test Acc: 0.056
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 3.3395269
	speed: 0.2282s/iter; left time: 4058.5937s
	iters: 200, epoch: 15 | loss: 3.4366608
	speed: 0.0911s/iter; left time: 1612.0968s
Epoch: 15 cost time: 18.036250591278076
Epoch: 15, Steps: 208 | Train Loss: 3.476 Vali Loss: 3.525 Vali Acc: 0.057 Test Loss: 3.525 Test Acc: 0.057
Validation loss decreased (-0.057226 --> -0.057227).  Saving model ...
	iters: 100, epoch: 16 | loss: 3.6617935
	speed: 0.2318s/iter; left time: 4075.6115s
	iters: 200, epoch: 16 | loss: 3.4614806
	speed: 0.0807s/iter; left time: 1411.5004s
Epoch: 16 cost time: 18.346698760986328
Epoch: 16, Steps: 208 | Train Loss: 3.444 Vali Loss: 3.477 Vali Acc: 0.056 Test Loss: 3.477 Test Acc: 0.056
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 3.2308860
	speed: 0.2243s/iter; left time: 3896.7535s
	iters: 200, epoch: 17 | loss: 3.3186405
	speed: 0.0822s/iter; left time: 1419.0283s
Epoch: 17 cost time: 18.234959602355957
Epoch: 17, Steps: 208 | Train Loss: 3.441 Vali Loss: 3.482 Vali Acc: 0.058 Test Loss: 3.482 Test Acc: 0.058
Validation loss decreased (-0.057227 --> -0.058420).  Saving model ...
	iters: 100, epoch: 18 | loss: 3.3948157
	speed: 0.2036s/iter; left time: 3494.7364s
	iters: 200, epoch: 18 | loss: 3.2472465
	speed: 0.0905s/iter; left time: 1544.6656s
Epoch: 18 cost time: 16.516570329666138
Epoch: 18, Steps: 208 | Train Loss: 3.424 Vali Loss: 3.493 Vali Acc: 0.057 Test Loss: 3.493 Test Acc: 0.057
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 3.2613642
	speed: 0.2316s/iter; left time: 3926.9483s
	iters: 200, epoch: 19 | loss: 3.3337455
	speed: 0.0837s/iter; left time: 1411.1088s
Epoch: 19 cost time: 18.46738290786743
Epoch: 19, Steps: 208 | Train Loss: 3.407 Vali Loss: 3.477 Vali Acc: 0.061 Test Loss: 3.477 Test Acc: 0.061
Validation loss decreased (-0.058420 --> -0.060806).  Saving model ...
	iters: 100, epoch: 20 | loss: 3.2344787
	speed: 0.2278s/iter; left time: 3814.9703s
	iters: 200, epoch: 20 | loss: 3.3756301
	speed: 0.0810s/iter; left time: 1348.0134s
Epoch: 20 cost time: 17.962746143341064
Epoch: 20, Steps: 208 | Train Loss: 3.366 Vali Loss: 3.715 Vali Acc: 0.046 Test Loss: 3.715 Test Acc: 0.046
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 3.6131961
	speed: 0.2107s/iter; left time: 3485.3715s
	iters: 200, epoch: 21 | loss: 3.2480829
	speed: 0.0822s/iter; left time: 1352.1880s
Epoch: 21 cost time: 16.93307900428772
Epoch: 21, Steps: 208 | Train Loss: 3.356 Vali Loss: 3.631 Vali Acc: 0.051 Test Loss: 3.631 Test Acc: 0.051
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 3.1686997
	speed: 0.2201s/iter; left time: 3595.5581s
	iters: 200, epoch: 22 | loss: 3.4617307
	speed: 0.0832s/iter; left time: 1351.2878s
Epoch: 22 cost time: 18.24078130722046
Epoch: 22, Steps: 208 | Train Loss: 3.365 Vali Loss: 3.527 Vali Acc: 0.056 Test Loss: 3.527 Test Acc: 0.056
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 3.6591337
	speed: 0.2322s/iter; left time: 3744.8246s
	iters: 200, epoch: 23 | loss: 3.1786423
	speed: 0.0884s/iter; left time: 1417.2453s
Epoch: 23 cost time: 19.127522945404053
Epoch: 23, Steps: 208 | Train Loss: 3.349 Vali Loss: 3.532 Vali Acc: 0.065 Test Loss: 3.532 Test Acc: 0.065
Validation loss decreased (-0.060806 --> -0.065279).  Saving model ...
	iters: 100, epoch: 24 | loss: 3.6102040
	speed: 0.2189s/iter; left time: 3484.7943s
	iters: 200, epoch: 24 | loss: 3.1582670
	speed: 0.0768s/iter; left time: 1214.5495s
Epoch: 24 cost time: 16.508816480636597
Epoch: 24, Steps: 208 | Train Loss: 3.336 Vali Loss: 3.499 Vali Acc: 0.065 Test Loss: 3.499 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 3.3755939
	speed: 0.2217s/iter; left time: 3483.2848s
	iters: 200, epoch: 25 | loss: 3.5018897
	speed: 0.0880s/iter; left time: 1373.4502s
Epoch: 25 cost time: 18.74760365486145
Epoch: 25, Steps: 208 | Train Loss: 3.359 Vali Loss: 3.483 Vali Acc: 0.072 Test Loss: 3.483 Test Acc: 0.072
Validation loss decreased (-0.065279 --> -0.071841).  Saving model ...
	iters: 100, epoch: 26 | loss: 3.2894542
	speed: 0.2329s/iter; left time: 3610.4318s
	iters: 200, epoch: 26 | loss: 3.5547450
	speed: 0.0905s/iter; left time: 1394.1988s
Epoch: 26 cost time: 18.96218752861023
Epoch: 26, Steps: 208 | Train Loss: 3.360 Vali Loss: 3.497 Vali Acc: 0.061 Test Loss: 3.497 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 3.3670888
	speed: 0.2312s/iter; left time: 3535.8800s
	iters: 200, epoch: 27 | loss: 3.0069406
	speed: 0.0857s/iter; left time: 1302.5254s
Epoch: 27 cost time: 18.232760667800903
Epoch: 27, Steps: 208 | Train Loss: 3.336 Vali Loss: 3.529 Vali Acc: 0.066 Test Loss: 3.529 Test Acc: 0.066
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 3.2296271
	speed: 0.2459s/iter; left time: 3708.6537s
	iters: 200, epoch: 28 | loss: 3.0223398
	speed: 0.0935s/iter; left time: 1400.6847s
Epoch: 28 cost time: 20.19183897972107
Epoch: 28, Steps: 208 | Train Loss: 3.319 Vali Loss: 3.480 Vali Acc: 0.071 Test Loss: 3.480 Test Acc: 0.071
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 3.2568471
	speed: 0.2384s/iter; left time: 3546.4566s
	iters: 200, epoch: 29 | loss: 2.9735420
	speed: 0.0945s/iter; left time: 1396.4107s
Epoch: 29 cost time: 19.616973638534546
Epoch: 29, Steps: 208 | Train Loss: 3.316 Vali Loss: 3.497 Vali Acc: 0.063 Test Loss: 3.497 Test Acc: 0.063
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 3.1865451
	speed: 0.2467s/iter; left time: 3619.4617s
	iters: 200, epoch: 30 | loss: 3.1892309
	speed: 0.0874s/iter; left time: 1273.7303s
Epoch: 30 cost time: 19.323700666427612
Epoch: 30, Steps: 208 | Train Loss: 3.309 Vali Loss: 3.492 Vali Acc: 0.072 Test Loss: 3.492 Test Acc: 0.072
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 3.1386914
	speed: 0.2568s/iter; left time: 3713.7473s
	iters: 200, epoch: 31 | loss: 3.2284994
	speed: 0.1060s/iter; left time: 1522.3291s
Epoch: 31 cost time: 22.55404829978943
Epoch: 31, Steps: 208 | Train Loss: 3.262 Vali Loss: 3.525 Vali Acc: 0.062 Test Loss: 3.525 Test Acc: 0.062
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 3.3578725
	speed: 0.2158s/iter; left time: 3075.7659s
	iters: 200, epoch: 32 | loss: 3.4074123
	speed: 0.0529s/iter; left time: 748.1570s
Epoch: 32 cost time: 13.404829263687134
Epoch: 32, Steps: 208 | Train Loss: 3.311 Vali Loss: 3.517 Vali Acc: 0.064 Test Loss: 3.517 Test Acc: 0.064
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 3.5687752
	speed: 0.2144s/iter; left time: 3011.3088s
	iters: 200, epoch: 33 | loss: 3.1196260
	speed: 0.0922s/iter; left time: 1285.4813s
Epoch: 33 cost time: 19.135027170181274
Epoch: 33, Steps: 208 | Train Loss: 3.290 Vali Loss: 3.527 Vali Acc: 0.067 Test Loss: 3.527 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 3.1569664
	speed: 0.2155s/iter; left time: 2981.5447s
	iters: 200, epoch: 34 | loss: 2.8604982
	speed: 0.0862s/iter; left time: 1183.9606s
Epoch: 34 cost time: 17.742957830429077
Epoch: 34, Steps: 208 | Train Loss: 3.272 Vali Loss: 3.568 Vali Acc: 0.068 Test Loss: 3.568 Test Acc: 0.068
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 3.1689956
	speed: 0.2272s/iter; left time: 3096.6276s
	iters: 200, epoch: 35 | loss: 3.7825499
	speed: 0.0715s/iter; left time: 967.0384s
Epoch: 35 cost time: 17.284163236618042
Epoch: 35, Steps: 208 | Train Loss: 3.253 Vali Loss: 3.526 Vali Acc: 0.074 Test Loss: 3.526 Test Acc: 0.074
Validation loss decreased (-0.071841 --> -0.073928).  Saving model ...
	iters: 100, epoch: 36 | loss: 3.4134672
	speed: 0.2131s/iter; left time: 2860.5938s
	iters: 200, epoch: 36 | loss: 2.8397329
	speed: 0.0809s/iter; left time: 1077.7910s
Epoch: 36 cost time: 16.914794206619263
Epoch: 36, Steps: 208 | Train Loss: 3.234 Vali Loss: 3.575 Vali Acc: 0.060 Test Loss: 3.575 Test Acc: 0.060
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 3.3210089
	speed: 0.1381s/iter; left time: 1824.2055s
	iters: 200, epoch: 37 | loss: 3.2959373
	speed: 0.0438s/iter; left time: 573.7859s
Epoch: 37 cost time: 9.46403980255127
Epoch: 37, Steps: 208 | Train Loss: 3.232 Vali Loss: 3.594 Vali Acc: 0.066 Test Loss: 3.594 Test Acc: 0.066
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 2.8973405
	speed: 0.2114s/iter; left time: 2749.5154s
	iters: 200, epoch: 38 | loss: 3.1937294
	speed: 0.0848s/iter; left time: 1093.7232s
Epoch: 38 cost time: 17.993063926696777
Epoch: 38, Steps: 208 | Train Loss: 3.208 Vali Loss: 3.526 Vali Acc: 0.063 Test Loss: 3.526 Test Acc: 0.063
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 39 | loss: 3.3261359
	speed: 0.2097s/iter; left time: 2683.0129s
	iters: 200, epoch: 39 | loss: 3.1899166
	speed: 0.0831s/iter; left time: 1054.5710s
Epoch: 39 cost time: 17.29668164253235
Epoch: 39, Steps: 208 | Train Loss: 3.302 Vali Loss: 3.506 Vali Acc: 0.069 Test Loss: 3.506 Test Acc: 0.069
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 40 | loss: 3.2905846
	speed: 0.2198s/iter; left time: 2767.6125s
	iters: 200, epoch: 40 | loss: 2.8291821
	speed: 0.0789s/iter; left time: 984.9008s
Epoch: 40 cost time: 18.55913019180298
Epoch: 40, Steps: 208 | Train Loss: 3.238 Vali Loss: 3.535 Vali Acc: 0.062 Test Loss: 3.535 Test Acc: 0.062
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 41 | loss: 3.3091617
	speed: 0.2220s/iter; left time: 2749.0883s
	iters: 200, epoch: 41 | loss: 2.8148561
	speed: 0.0845s/iter; left time: 1037.7941s
Epoch: 41 cost time: 17.869038343429565
Epoch: 41, Steps: 208 | Train Loss: 3.228 Vali Loss: 3.585 Vali Acc: 0.066 Test Loss: 3.585 Test Acc: 0.066
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 42 | loss: 3.2751322
	speed: 0.2097s/iter; left time: 2552.2070s
	iters: 200, epoch: 42 | loss: 3.2201488
	speed: 0.0789s/iter; left time: 952.6640s
Epoch: 42 cost time: 16.365089178085327
Epoch: 42, Steps: 208 | Train Loss: 3.250 Vali Loss: 3.485 Vali Acc: 0.069 Test Loss: 3.485 Test Acc: 0.069
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 43 | loss: 3.2796414
	speed: 0.2245s/iter; left time: 2685.8748s
	iters: 200, epoch: 43 | loss: 3.1007617
	speed: 0.0834s/iter; left time: 989.8325s
Epoch: 43 cost time: 18.19551372528076
Epoch: 43, Steps: 208 | Train Loss: 3.238 Vali Loss: 3.540 Vali Acc: 0.070 Test Loss: 3.540 Test Acc: 0.070
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 44 | loss: 2.8651385
	speed: 0.2101s/iter; left time: 2470.0960s
	iters: 200, epoch: 44 | loss: 3.4585581
	speed: 0.0959s/iter; left time: 1117.9496s
Epoch: 44 cost time: 18.71871066093445
Epoch: 44, Steps: 208 | Train Loss: 3.224 Vali Loss: 3.496 Vali Acc: 0.062 Test Loss: 3.496 Test Acc: 0.062
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 45 | loss: 3.4045179
	speed: 0.2447s/iter; left time: 2826.2614s
	iters: 200, epoch: 45 | loss: 3.4700551
	speed: 0.0804s/iter; left time: 920.8831s
Epoch: 45 cost time: 18.93738079071045
Epoch: 45, Steps: 208 | Train Loss: 3.198 Vali Loss: 3.539 Vali Acc: 0.075 Test Loss: 3.539 Test Acc: 0.075
Validation loss decreased (-0.073928 --> -0.074525).  Saving model ...
	iters: 100, epoch: 46 | loss: 3.2602694
	speed: 0.2545s/iter; left time: 2885.7721s
	iters: 200, epoch: 46 | loss: 3.0545487
	speed: 0.0849s/iter; left time: 954.3468s
Epoch: 46 cost time: 19.765804052352905
Epoch: 46, Steps: 208 | Train Loss: 3.197 Vali Loss: 3.545 Vali Acc: 0.071 Test Loss: 3.545 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 47 | loss: 3.1438816
	speed: 0.2471s/iter; left time: 2751.3148s
	iters: 200, epoch: 47 | loss: 3.0897827
	speed: 0.1055s/iter; left time: 1163.8047s
Epoch: 47 cost time: 20.999964237213135
Epoch: 47, Steps: 208 | Train Loss: 3.186 Vali Loss: 3.638 Vali Acc: 0.074 Test Loss: 3.638 Test Acc: 0.074
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 48 | loss: 3.3686018
	speed: 0.2576s/iter; left time: 2814.8189s
	iters: 200, epoch: 48 | loss: 3.1092019
	speed: 0.0717s/iter; left time: 775.9062s
Epoch: 48 cost time: 18.413116931915283
Epoch: 48, Steps: 208 | Train Loss: 3.175 Vali Loss: 3.546 Vali Acc: 0.067 Test Loss: 3.546 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 49 | loss: 3.2286601
	speed: 0.2186s/iter; left time: 2343.0833s
	iters: 200, epoch: 49 | loss: 3.5123661
	speed: 0.0847s/iter; left time: 899.0756s
Epoch: 49 cost time: 17.98258662223816
Epoch: 49, Steps: 208 | Train Loss: 3.236 Vali Loss: 3.501 Vali Acc: 0.070 Test Loss: 3.501 Test Acc: 0.070
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 50 | loss: 3.4901152
	speed: 0.2124s/iter; left time: 2232.5040s
	iters: 200, epoch: 50 | loss: 3.3288901
	speed: 0.0823s/iter; left time: 857.1659s
Epoch: 50 cost time: 17.1317298412323
Epoch: 50, Steps: 208 | Train Loss: 3.296 Vali Loss: 3.508 Vali Acc: 0.066 Test Loss: 3.508 Test Acc: 0.066
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 51 | loss: 3.7957945
	speed: 0.2226s/iter; left time: 2293.3966s
	iters: 200, epoch: 51 | loss: 2.7067580
	speed: 0.0844s/iter; left time: 860.9789s
Epoch: 51 cost time: 18.137911081314087
Epoch: 51, Steps: 208 | Train Loss: 3.220 Vali Loss: 3.520 Vali Acc: 0.069 Test Loss: 3.520 Test Acc: 0.069
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 52 | loss: 3.3159876
	speed: 0.2074s/iter; left time: 2093.6353s
	iters: 200, epoch: 52 | loss: 2.4790089
	speed: 0.0876s/iter; left time: 875.5607s
Epoch: 52 cost time: 16.97413682937622
Epoch: 52, Steps: 208 | Train Loss: 3.211 Vali Loss: 3.557 Vali Acc: 0.075 Test Loss: 3.557 Test Acc: 0.075
Validation loss decreased (-0.074525 --> -0.074823).  Saving model ...
	iters: 100, epoch: 53 | loss: 3.1047976
	speed: 0.2206s/iter; left time: 2180.7419s
	iters: 200, epoch: 53 | loss: 2.8454933
	speed: 0.0769s/iter; left time: 752.3924s
Epoch: 53 cost time: 17.60656476020813
Epoch: 53, Steps: 208 | Train Loss: 3.173 Vali Loss: 3.531 Vali Acc: 0.081 Test Loss: 3.531 Test Acc: 0.081
Validation loss decreased (-0.074823 --> -0.080490).  Saving model ...
	iters: 100, epoch: 54 | loss: 3.1780970
	speed: 0.2267s/iter; left time: 2193.6265s
	iters: 200, epoch: 54 | loss: 3.0543938
	speed: 0.0877s/iter; left time: 840.2325s
Epoch: 54 cost time: 18.850181341171265
Epoch: 54, Steps: 208 | Train Loss: 3.176 Vali Loss: 3.524 Vali Acc: 0.063 Test Loss: 3.524 Test Acc: 0.063
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 55 | loss: 3.4151516
	speed: 0.1941s/iter; left time: 1837.8279s
	iters: 200, epoch: 55 | loss: 2.9693460
	speed: 0.0833s/iter; left time: 780.8013s
Epoch: 55 cost time: 16.118229389190674
Epoch: 55, Steps: 208 | Train Loss: 3.195 Vali Loss: 3.536 Vali Acc: 0.071 Test Loss: 3.536 Test Acc: 0.071
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 56 | loss: 3.4306037
	speed: 0.2270s/iter; left time: 2102.0794s
	iters: 200, epoch: 56 | loss: 2.5021334
	speed: 0.0798s/iter; left time: 731.3441s
Epoch: 56 cost time: 17.878256797790527
Epoch: 56, Steps: 208 | Train Loss: 3.161 Vali Loss: 3.589 Vali Acc: 0.071 Test Loss: 3.589 Test Acc: 0.071
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 57 | loss: 3.1664469
	speed: 0.2085s/iter; left time: 1887.1175s
	iters: 200, epoch: 57 | loss: 3.1318247
	speed: 0.0886s/iter; left time: 792.8771s
Epoch: 57 cost time: 16.698304891586304
Epoch: 57, Steps: 208 | Train Loss: 3.157 Vali Loss: 3.587 Vali Acc: 0.069 Test Loss: 3.587 Test Acc: 0.069
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 58 | loss: 2.8919249
	speed: 0.2064s/iter; left time: 1825.9888s
	iters: 200, epoch: 58 | loss: 3.1415646
	speed: 0.0873s/iter; left time: 763.1338s
Epoch: 58 cost time: 17.70839214324951
Epoch: 58, Steps: 208 | Train Loss: 3.144 Vali Loss: 3.510 Vali Acc: 0.077 Test Loss: 3.510 Test Acc: 0.077
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 59 | loss: 3.2923408
	speed: 0.2174s/iter; left time: 1877.7069s
	iters: 200, epoch: 59 | loss: 2.7406089
	speed: 0.0817s/iter; left time: 697.2307s
Epoch: 59 cost time: 18.39431071281433
Epoch: 59, Steps: 208 | Train Loss: 3.138 Vali Loss: 3.576 Vali Acc: 0.071 Test Loss: 3.576 Test Acc: 0.071
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 60 | loss: 3.1541109
	speed: 0.2073s/iter; left time: 1747.3343s
	iters: 200, epoch: 60 | loss: 3.1875753
	speed: 0.0726s/iter; left time: 604.7707s
Epoch: 60 cost time: 15.69498610496521
Epoch: 60, Steps: 208 | Train Loss: 3.158 Vali Loss: 3.537 Vali Acc: 0.074 Test Loss: 3.537 Test Acc: 0.074
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 61 | loss: 2.9987440
	speed: 0.1955s/iter; left time: 1607.0658s
	iters: 200, epoch: 61 | loss: 3.4623210
	speed: 0.0480s/iter; left time: 389.5774s
Epoch: 61 cost time: 11.053982019424438
Epoch: 61, Steps: 208 | Train Loss: 3.152 Vali Loss: 3.569 Vali Acc: 0.076 Test Loss: 3.569 Test Acc: 0.076
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 62 | loss: 3.5404699
	speed: 0.1680s/iter; left time: 1346.1775s
	iters: 200, epoch: 62 | loss: 2.9309974
	speed: 0.0976s/iter; left time: 771.9260s
Epoch: 62 cost time: 17.12920379638672
Epoch: 62, Steps: 208 | Train Loss: 3.156 Vali Loss: 3.562 Vali Acc: 0.063 Test Loss: 3.562 Test Acc: 0.063
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 63 | loss: 3.4864340
	speed: 0.2462s/iter; left time: 1921.8543s
	iters: 200, epoch: 63 | loss: 3.2725792
	speed: 0.0960s/iter; left time: 739.8874s
Epoch: 63 cost time: 20.645753860473633
Epoch: 63, Steps: 208 | Train Loss: 3.188 Vali Loss: 3.545 Vali Acc: 0.068 Test Loss: 3.545 Test Acc: 0.068
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.08052490307187593
model parameter : 5534143
model size : 26.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.9448290
	speed: 0.0868s/iter; left time: 1795.8345s
	iters: 200, epoch: 1 | loss: 6.6197381
	speed: 0.0733s/iter; left time: 1510.2361s
Epoch: 1 cost time: 16.682877779006958
Epoch: 1, Steps: 208 | Train Loss: 6.639 Vali Loss: 8.475 Vali Acc: 0.042 Test Loss: 8.475 Test Acc: 0.042
Validation loss decreased (inf --> -0.042265).  Saving model ...
	iters: 100, epoch: 2 | loss: 5.8195190
	speed: 0.2012s/iter; left time: 4123.5935s
	iters: 200, epoch: 2 | loss: 5.1403875
	speed: 0.0728s/iter; left time: 1484.0162s
Epoch: 2 cost time: 14.740587711334229
Epoch: 2, Steps: 208 | Train Loss: 5.289 Vali Loss: 4.948 Vali Acc: 0.026 Test Loss: 4.948 Test Acc: 0.026
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.8203850
	speed: 0.2117s/iter; left time: 4293.9962s
	iters: 200, epoch: 3 | loss: 4.6541553
	speed: 0.0693s/iter; left time: 1399.6671s
Epoch: 3 cost time: 15.440993785858154
Epoch: 3, Steps: 208 | Train Loss: 4.518 Vali Loss: 4.585 Vali Acc: 0.035 Test Loss: 4.585 Test Acc: 0.035
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 3.9131777
	speed: 0.2043s/iter; left time: 4101.8551s
	iters: 200, epoch: 4 | loss: 4.2542324
	speed: 0.0598s/iter; left time: 1193.8609s
Epoch: 4 cost time: 13.968369722366333
Epoch: 4, Steps: 208 | Train Loss: 4.231 Vali Loss: 4.199 Vali Acc: 0.036 Test Loss: 4.199 Test Acc: 0.036
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 3.7762828
	speed: 0.2005s/iter; left time: 3983.1553s
	iters: 200, epoch: 5 | loss: 3.3250046
	speed: 0.0725s/iter; left time: 1432.8199s
Epoch: 5 cost time: 15.452061891555786
Epoch: 5, Steps: 208 | Train Loss: 3.958 Vali Loss: 3.861 Vali Acc: 0.065 Test Loss: 3.861 Test Acc: 0.065
Validation loss decreased (-0.042265 --> -0.064680).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.4803627
	speed: 0.1943s/iter; left time: 3820.6161s
	iters: 200, epoch: 6 | loss: 3.2924833
	speed: 0.0691s/iter; left time: 1352.0131s
Epoch: 6 cost time: 14.080436706542969
Epoch: 6, Steps: 208 | Train Loss: 3.645 Vali Loss: 3.529 Vali Acc: 0.071 Test Loss: 3.529 Test Acc: 0.071
Validation loss decreased (-0.064680 --> -0.070648).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.7037621
	speed: 0.2131s/iter; left time: 4146.3243s
	iters: 200, epoch: 7 | loss: 3.2939839
	speed: 0.0743s/iter; left time: 1437.4328s
Epoch: 7 cost time: 15.22104811668396
Epoch: 7, Steps: 208 | Train Loss: 3.517 Vali Loss: 3.541 Vali Acc: 0.070 Test Loss: 3.541 Test Acc: 0.070
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 3.2830641
	speed: 0.2014s/iter; left time: 3875.2019s
	iters: 200, epoch: 8 | loss: 3.5239401
	speed: 0.0641s/iter; left time: 1226.9041s
Epoch: 8 cost time: 14.284020900726318
Epoch: 8, Steps: 208 | Train Loss: 3.441 Vali Loss: 3.424 Vali Acc: 0.081 Test Loss: 3.424 Test Acc: 0.081
Validation loss decreased (-0.070648 --> -0.080789).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.3392682
	speed: 0.2064s/iter; left time: 3928.3987s
	iters: 200, epoch: 9 | loss: 3.6874974
	speed: 0.0707s/iter; left time: 1338.6179s
Epoch: 9 cost time: 15.640941381454468
Epoch: 9, Steps: 208 | Train Loss: 3.363 Vali Loss: 3.416 Vali Acc: 0.069 Test Loss: 3.416 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 3.1943636
	speed: 0.1974s/iter; left time: 3717.7687s
	iters: 200, epoch: 10 | loss: 3.2743213
	speed: 0.0751s/iter; left time: 1407.0903s
Epoch: 10 cost time: 15.164925813674927
Epoch: 10, Steps: 208 | Train Loss: 3.349 Vali Loss: 3.321 Vali Acc: 0.080 Test Loss: 3.321 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 3.1644809
	speed: 0.1903s/iter; left time: 3544.0589s
	iters: 200, epoch: 11 | loss: 3.0179834
	speed: 0.0672s/iter; left time: 1245.1081s
Epoch: 11 cost time: 14.188491821289062
Epoch: 11, Steps: 208 | Train Loss: 3.317 Vali Loss: 3.310 Vali Acc: 0.093 Test Loss: 3.310 Test Acc: 0.093
Validation loss decreased (-0.080789 --> -0.093316).  Saving model ...
	iters: 100, epoch: 12 | loss: 3.3804772
	speed: 0.2051s/iter; left time: 3776.7070s
	iters: 200, epoch: 12 | loss: 3.0057125
	speed: 0.0711s/iter; left time: 1301.3901s
Epoch: 12 cost time: 15.450226068496704
Epoch: 12, Steps: 208 | Train Loss: 3.275 Vali Loss: 3.330 Vali Acc: 0.075 Test Loss: 3.330 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 3.4491141
	speed: 0.1998s/iter; left time: 3637.2998s
	iters: 200, epoch: 13 | loss: 3.4064066
	speed: 0.0650s/iter; left time: 1176.1534s
Epoch: 13 cost time: 13.7953782081604
Epoch: 13, Steps: 208 | Train Loss: 3.308 Vali Loss: 3.292 Vali Acc: 0.086 Test Loss: 3.292 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 3.3539648
	speed: 0.2374s/iter; left time: 4272.7311s
	iters: 200, epoch: 14 | loss: 3.3279581
	speed: 0.0787s/iter; left time: 1409.0920s
Epoch: 14 cost time: 17.464722394943237
Epoch: 14, Steps: 208 | Train Loss: 3.292 Vali Loss: 3.312 Vali Acc: 0.085 Test Loss: 3.312 Test Acc: 0.085
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 2.9278014
	speed: 0.2283s/iter; left time: 4061.2862s
	iters: 200, epoch: 15 | loss: 3.2755497
	speed: 0.0846s/iter; left time: 1495.7267s
Epoch: 15 cost time: 17.170292615890503
Epoch: 15, Steps: 208 | Train Loss: 3.301 Vali Loss: 3.359 Vali Acc: 0.083 Test Loss: 3.359 Test Acc: 0.083
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 3.6380775
	speed: 0.2281s/iter; left time: 4010.4957s
	iters: 200, epoch: 16 | loss: 2.9627876
	speed: 0.0721s/iter; left time: 1260.2176s
Epoch: 16 cost time: 16.65270161628723
Epoch: 16, Steps: 208 | Train Loss: 3.272 Vali Loss: 3.377 Vali Acc: 0.074 Test Loss: 3.377 Test Acc: 0.074
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 2.8060021
	speed: 0.2396s/iter; left time: 4163.1391s
	iters: 200, epoch: 17 | loss: 2.9554858
	speed: 0.0823s/iter; left time: 1421.1220s
Epoch: 17 cost time: 17.97871208190918
Epoch: 17, Steps: 208 | Train Loss: 3.243 Vali Loss: 3.372 Vali Acc: 0.082 Test Loss: 3.372 Test Acc: 0.082
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 3.4621873
	speed: 0.2094s/iter; left time: 3594.3216s
	iters: 200, epoch: 18 | loss: 4.1466489
	speed: 0.0706s/iter; left time: 1203.9496s
Epoch: 18 cost time: 14.502748727798462
Epoch: 18, Steps: 208 | Train Loss: 3.252 Vali Loss: 3.328 Vali Acc: 0.077 Test Loss: 3.328 Test Acc: 0.077
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 2.9426932
	speed: 0.2106s/iter; left time: 3571.8800s
	iters: 200, epoch: 19 | loss: 3.0538380
	speed: 0.0697s/iter; left time: 1174.4923s
Epoch: 19 cost time: 15.426460266113281
Epoch: 19, Steps: 208 | Train Loss: 3.209 Vali Loss: 3.332 Vali Acc: 0.089 Test Loss: 3.332 Test Acc: 0.089
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 3.4651525
	speed: 0.2043s/iter; left time: 3421.7820s
	iters: 200, epoch: 20 | loss: 2.8092430
	speed: 0.0702s/iter; left time: 1169.0626s
Epoch: 20 cost time: 14.638411045074463
Epoch: 20, Steps: 208 | Train Loss: 3.209 Vali Loss: 3.353 Vali Acc: 0.090 Test Loss: 3.353 Test Acc: 0.090
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 3.3587689
	speed: 0.2060s/iter; left time: 3407.1321s
	iters: 200, epoch: 21 | loss: 3.2197189
	speed: 0.0744s/iter; left time: 1223.2351s
Epoch: 21 cost time: 15.858305215835571
Epoch: 21, Steps: 208 | Train Loss: 3.197 Vali Loss: 3.318 Vali Acc: 0.088 Test Loss: 3.318 Test Acc: 0.088
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09334923948702654
model parameter : 5529279
model size : 26.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.9290199
	speed: 0.0858s/iter; left time: 1776.5783s
	iters: 200, epoch: 1 | loss: 10.7125587
	speed: 0.0747s/iter; left time: 1538.4314s
Epoch: 1 cost time: 16.711936473846436
Epoch: 1, Steps: 208 | Train Loss: 7.049 Vali Loss: 8.260 Vali Acc: 0.035 Test Loss: 8.260 Test Acc: 0.035
Validation loss decreased (inf --> -0.034812).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.8504481
	speed: 0.1970s/iter; left time: 4037.0873s
	iters: 200, epoch: 2 | loss: 4.4940577
	speed: 0.0644s/iter; left time: 1313.5037s
Epoch: 2 cost time: 14.122562885284424
Epoch: 2, Steps: 208 | Train Loss: 5.372 Vali Loss: 4.860 Vali Acc: 0.037 Test Loss: 4.860 Test Acc: 0.037
Validation loss decreased (-0.034812 --> -0.037231).  Saving model ...
	iters: 100, epoch: 3 | loss: 5.0707603
	speed: 0.1626s/iter; left time: 3297.3456s
	iters: 200, epoch: 3 | loss: 6.0156951
	speed: 0.0410s/iter; left time: 828.5212s
Epoch: 3 cost time: 9.752914428710938
Epoch: 3, Steps: 208 | Train Loss: 4.590 Vali Loss: 4.585 Vali Acc: 0.026 Test Loss: 4.585 Test Acc: 0.026
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 4.6788993
	speed: 0.1917s/iter; left time: 3849.0035s
	iters: 200, epoch: 4 | loss: 3.7625318
	speed: 0.0729s/iter; left time: 1456.2192s
Epoch: 4 cost time: 15.350218772888184
Epoch: 4, Steps: 208 | Train Loss: 4.417 Vali Loss: 4.208 Vali Acc: 0.026 Test Loss: 4.208 Test Acc: 0.026
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 4.0750079
	speed: 0.2022s/iter; left time: 4017.8227s
	iters: 200, epoch: 5 | loss: 4.5369682
	speed: 0.0713s/iter; left time: 1409.8370s
Epoch: 5 cost time: 15.046270370483398
Epoch: 5, Steps: 208 | Train Loss: 4.216 Vali Loss: 3.912 Vali Acc: 0.041 Test Loss: 3.912 Test Acc: 0.041
Validation loss decreased (-0.037231 --> -0.041118).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.9532199
	speed: 0.2072s/iter; left time: 4072.8831s
	iters: 200, epoch: 6 | loss: 3.7426403
	speed: 0.0593s/iter; left time: 1159.4197s
Epoch: 6 cost time: 14.042373657226562
Epoch: 6, Steps: 208 | Train Loss: 4.217 Vali Loss: 3.874 Vali Acc: 0.026 Test Loss: 3.874 Test Acc: 0.026
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.8717325
	speed: 0.2016s/iter; left time: 3921.9146s
	iters: 200, epoch: 7 | loss: 3.8367491
	speed: 0.0676s/iter; left time: 1309.1935s
Epoch: 7 cost time: 14.74320673942566
Epoch: 7, Steps: 208 | Train Loss: 3.904 Vali Loss: 4.034 Vali Acc: 0.026 Test Loss: 4.034 Test Acc: 0.026
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.7487898
	speed: 0.2010s/iter; left time: 3868.2733s
	iters: 200, epoch: 8 | loss: 3.5346351
	speed: 0.0633s/iter; left time: 1211.6953s
Epoch: 8 cost time: 14.110172748565674
Epoch: 8, Steps: 208 | Train Loss: 3.804 Vali Loss: 3.769 Vali Acc: 0.025 Test Loss: 3.769 Test Acc: 0.025
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 3.5712430
	speed: 0.2204s/iter; left time: 4194.8968s
	iters: 200, epoch: 9 | loss: 3.3087571
	speed: 0.0586s/iter; left time: 1109.8779s
Epoch: 9 cost time: 13.927299976348877
Epoch: 9, Steps: 208 | Train Loss: 3.662 Vali Loss: 3.601 Vali Acc: 0.049 Test Loss: 3.601 Test Acc: 0.049
Validation loss decreased (-0.041118 --> -0.049174).  Saving model ...
	iters: 100, epoch: 10 | loss: 3.4226108
	speed: 0.1551s/iter; left time: 2921.1272s
	iters: 200, epoch: 10 | loss: 3.5208068
	speed: 0.0724s/iter; left time: 1356.0492s
Epoch: 10 cost time: 12.219157695770264
Epoch: 10, Steps: 208 | Train Loss: 3.605 Vali Loss: 3.583 Vali Acc: 0.049 Test Loss: 3.583 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 3.3328314
	speed: 0.2362s/iter; left time: 4398.4596s
	iters: 200, epoch: 11 | loss: 3.5591063
	speed: 0.0821s/iter; left time: 1519.7273s
Epoch: 11 cost time: 17.73950171470642
Epoch: 11, Steps: 208 | Train Loss: 3.551 Vali Loss: 3.644 Vali Acc: 0.048 Test Loss: 3.644 Test Acc: 0.048
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 3.3795433
	speed: 0.2300s/iter; left time: 4235.8306s
	iters: 200, epoch: 12 | loss: 3.5360847
	speed: 0.0755s/iter; left time: 1383.0267s
Epoch: 12 cost time: 16.361533641815186
Epoch: 12, Steps: 208 | Train Loss: 3.536 Vali Loss: 3.558 Vali Acc: 0.044 Test Loss: 3.558 Test Acc: 0.044
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 3.7966688
	speed: 0.2084s/iter; left time: 3793.8907s
	iters: 200, epoch: 13 | loss: 3.4847412
	speed: 0.0664s/iter; left time: 1203.0655s
Epoch: 13 cost time: 13.947821140289307
Epoch: 13, Steps: 208 | Train Loss: 3.520 Vali Loss: 3.567 Vali Acc: 0.055 Test Loss: 3.567 Test Acc: 0.055
Validation loss decreased (-0.049174 --> -0.055139).  Saving model ...
	iters: 100, epoch: 14 | loss: 3.4246714
	speed: 0.1996s/iter; left time: 3592.2859s
	iters: 200, epoch: 14 | loss: 3.5420902
	speed: 0.0736s/iter; left time: 1316.8658s
Epoch: 14 cost time: 14.903128147125244
Epoch: 14, Steps: 208 | Train Loss: 3.511 Vali Loss: 3.540 Vali Acc: 0.056 Test Loss: 3.540 Test Acc: 0.056
Validation loss decreased (-0.055139 --> -0.056034).  Saving model ...
	iters: 100, epoch: 15 | loss: 3.3731771
	speed: 0.2054s/iter; left time: 3653.8515s
	iters: 200, epoch: 15 | loss: 3.4034576
	speed: 0.0620s/iter; left time: 1096.8843s
Epoch: 15 cost time: 14.295543193817139
Epoch: 15, Steps: 208 | Train Loss: 3.508 Vali Loss: 3.546 Vali Acc: 0.055 Test Loss: 3.546 Test Acc: 0.055
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 3.5569139
	speed: 0.2049s/iter; left time: 3602.8372s
	iters: 200, epoch: 16 | loss: 3.6173527
	speed: 0.0703s/iter; left time: 1229.3969s
Epoch: 16 cost time: 15.332189798355103
Epoch: 16, Steps: 208 | Train Loss: 3.493 Vali Loss: 3.525 Vali Acc: 0.048 Test Loss: 3.525 Test Acc: 0.048
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 3.6015847
	speed: 0.2057s/iter; left time: 3572.9662s
	iters: 200, epoch: 17 | loss: 3.6743734
	speed: 0.0663s/iter; left time: 1145.2869s
Epoch: 17 cost time: 13.602164506912231
Epoch: 17, Steps: 208 | Train Loss: 3.459 Vali Loss: 3.499 Vali Acc: 0.052 Test Loss: 3.499 Test Acc: 0.052
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 3.5561981
	speed: 0.2012s/iter; left time: 3453.7513s
	iters: 200, epoch: 18 | loss: 3.6896410
	speed: 0.0716s/iter; left time: 1221.6885s
Epoch: 18 cost time: 14.975902318954468
Epoch: 18, Steps: 208 | Train Loss: 3.455 Vali Loss: 3.523 Vali Acc: 0.055 Test Loss: 3.523 Test Acc: 0.055
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 3.6190622
	speed: 0.2065s/iter; left time: 3502.2777s
	iters: 200, epoch: 19 | loss: 3.6382971
	speed: 0.0543s/iter; left time: 915.8023s
Epoch: 19 cost time: 13.488509178161621
Epoch: 19, Steps: 208 | Train Loss: 3.471 Vali Loss: 3.528 Vali Acc: 0.060 Test Loss: 3.528 Test Acc: 0.060
Validation loss decreased (-0.056034 --> -0.059911).  Saving model ...
	iters: 100, epoch: 20 | loss: 3.6436143
	speed: 0.2019s/iter; left time: 3382.2903s
	iters: 200, epoch: 20 | loss: 3.5056126
	speed: 0.0691s/iter; left time: 1149.9799s
Epoch: 20 cost time: 15.084085702896118
Epoch: 20, Steps: 208 | Train Loss: 3.445 Vali Loss: 3.501 Vali Acc: 0.058 Test Loss: 3.501 Test Acc: 0.058
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 3.2663612
	speed: 0.1968s/iter; left time: 3254.5832s
	iters: 200, epoch: 21 | loss: 3.1204996
	speed: 0.0717s/iter; left time: 1179.2923s
Epoch: 21 cost time: 14.177138805389404
Epoch: 21, Steps: 208 | Train Loss: 3.443 Vali Loss: 3.503 Vali Acc: 0.050 Test Loss: 3.503 Test Acc: 0.050
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 3.6373396
	speed: 0.2145s/iter; left time: 3503.8390s
	iters: 200, epoch: 22 | loss: 3.3617446
	speed: 0.0641s/iter; left time: 1040.5360s
Epoch: 22 cost time: 14.67445182800293
Epoch: 22, Steps: 208 | Train Loss: 3.440 Vali Loss: 3.520 Vali Acc: 0.059 Test Loss: 3.520 Test Acc: 0.059
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 3.3159699
	speed: 0.2080s/iter; left time: 3354.1054s
	iters: 200, epoch: 23 | loss: 3.4294996
	speed: 0.0688s/iter; left time: 1103.1251s
Epoch: 23 cost time: 14.58802843093872
Epoch: 23, Steps: 208 | Train Loss: 3.424 Vali Loss: 3.508 Vali Acc: 0.054 Test Loss: 3.508 Test Acc: 0.054
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 3.2259119
	speed: 0.1915s/iter; left time: 3047.6211s
	iters: 200, epoch: 24 | loss: 3.4133306
	speed: 0.0664s/iter; left time: 1050.0161s
Epoch: 24 cost time: 14.226937770843506
Epoch: 24, Steps: 208 | Train Loss: 3.426 Vali Loss: 3.484 Vali Acc: 0.062 Test Loss: 3.484 Test Acc: 0.062
Validation loss decreased (-0.059911 --> -0.061999).  Saving model ...
	iters: 100, epoch: 25 | loss: 3.4562829
	speed: 0.2085s/iter; left time: 3274.9999s
	iters: 200, epoch: 25 | loss: 3.5175664
	speed: 0.0725s/iter; left time: 1131.3053s
Epoch: 25 cost time: 15.133009195327759
Epoch: 25, Steps: 208 | Train Loss: 3.419 Vali Loss: 3.542 Vali Acc: 0.055 Test Loss: 3.542 Test Acc: 0.055
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 3.5233564
	speed: 0.2345s/iter; left time: 3634.5901s
	iters: 200, epoch: 26 | loss: 3.6753454
	speed: 0.0766s/iter; left time: 1180.0385s
Epoch: 26 cost time: 16.59618830680847
Epoch: 26, Steps: 208 | Train Loss: 3.409 Vali Loss: 3.491 Vali Acc: 0.054 Test Loss: 3.491 Test Acc: 0.054
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 3.1661723
	speed: 0.2292s/iter; left time: 3505.6706s
	iters: 200, epoch: 27 | loss: 3.7398667
	speed: 0.0784s/iter; left time: 1191.8279s
Epoch: 27 cost time: 16.569300889968872
Epoch: 27, Steps: 208 | Train Loss: 3.421 Vali Loss: 3.500 Vali Acc: 0.054 Test Loss: 3.500 Test Acc: 0.054
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 3.2714086
	speed: 0.2207s/iter; left time: 3329.2663s
	iters: 200, epoch: 28 | loss: 3.2237148
	speed: 0.0814s/iter; left time: 1219.4394s
Epoch: 28 cost time: 17.122018098831177
Epoch: 28, Steps: 208 | Train Loss: 3.421 Vali Loss: 3.560 Vali Acc: 0.063 Test Loss: 3.560 Test Acc: 0.063
Validation loss decreased (-0.061999 --> -0.062595).  Saving model ...
	iters: 100, epoch: 29 | loss: 3.5181277
	speed: 0.2324s/iter; left time: 3458.0238s
	iters: 200, epoch: 29 | loss: 3.4354913
	speed: 0.0796s/iter; left time: 1176.2295s
Epoch: 29 cost time: 16.956143140792847
Epoch: 29, Steps: 208 | Train Loss: 3.415 Vali Loss: 3.521 Vali Acc: 0.061 Test Loss: 3.521 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 3.3712893
	speed: 0.2141s/iter; left time: 3140.3329s
	iters: 200, epoch: 30 | loss: 3.5598106
	speed: 0.0705s/iter; left time: 1027.5497s
Epoch: 30 cost time: 15.34939980506897
Epoch: 30, Steps: 208 | Train Loss: 3.418 Vali Loss: 3.545 Vali Acc: 0.054 Test Loss: 3.545 Test Acc: 0.054
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 3.6045532
	speed: 0.1959s/iter; left time: 2832.9749s
	iters: 200, epoch: 31 | loss: 3.7602305
	speed: 0.0637s/iter; left time: 914.1365s
Epoch: 31 cost time: 13.62628722190857
Epoch: 31, Steps: 208 | Train Loss: 3.421 Vali Loss: 3.496 Vali Acc: 0.061 Test Loss: 3.496 Test Acc: 0.061
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 3.2749758
	speed: 0.2079s/iter; left time: 2962.7300s
	iters: 200, epoch: 32 | loss: 3.6854329
	speed: 0.0746s/iter; left time: 1055.6027s
Epoch: 32 cost time: 15.73552417755127
Epoch: 32, Steps: 208 | Train Loss: 3.409 Vali Loss: 3.473 Vali Acc: 0.061 Test Loss: 3.473 Test Acc: 0.061
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 3.4524870
	speed: 0.1912s/iter; left time: 2685.5229s
	iters: 200, epoch: 33 | loss: 3.3029332
	speed: 0.0599s/iter; left time: 835.2263s
Epoch: 33 cost time: 13.502660751342773
Epoch: 33, Steps: 208 | Train Loss: 3.394 Vali Loss: 3.468 Vali Acc: 0.058 Test Loss: 3.468 Test Acc: 0.058
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 3.3509302
	speed: 0.2030s/iter; left time: 2808.5295s
	iters: 200, epoch: 34 | loss: 3.6244311
	speed: 0.0675s/iter; left time: 927.0521s
Epoch: 34 cost time: 15.218515872955322
Epoch: 34, Steps: 208 | Train Loss: 3.382 Vali Loss: 3.482 Vali Acc: 0.055 Test Loss: 3.482 Test Acc: 0.055
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 3.5295591
	speed: 0.2052s/iter; left time: 2796.7770s
	iters: 200, epoch: 35 | loss: 3.2947736
	speed: 0.0719s/iter; left time: 972.7233s
Epoch: 35 cost time: 15.112111568450928
Epoch: 35, Steps: 208 | Train Loss: 3.372 Vali Loss: 3.477 Vali Acc: 0.061 Test Loss: 3.477 Test Acc: 0.061
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 3.4938049
	speed: 0.2011s/iter; left time: 2698.4601s
	iters: 200, epoch: 36 | loss: 3.3810656
	speed: 0.0696s/iter; left time: 926.6606s
Epoch: 36 cost time: 15.064900398254395
Epoch: 36, Steps: 208 | Train Loss: 3.379 Vali Loss: 3.484 Vali Acc: 0.069 Test Loss: 3.484 Test Acc: 0.069
Validation loss decreased (-0.062595 --> -0.069157).  Saving model ...
	iters: 100, epoch: 37 | loss: 3.5991163
	speed: 0.2034s/iter; left time: 2687.7586s
	iters: 200, epoch: 37 | loss: 3.3729815
	speed: 0.0683s/iter; left time: 896.0437s
Epoch: 37 cost time: 14.766158819198608
Epoch: 37, Steps: 208 | Train Loss: 3.383 Vali Loss: 3.517 Vali Acc: 0.062 Test Loss: 3.517 Test Acc: 0.062
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 38 | loss: 3.3528502
	speed: 0.1880s/iter; left time: 2444.6149s
	iters: 200, epoch: 38 | loss: 3.3532302
	speed: 0.0626s/iter; left time: 807.8541s
Epoch: 38 cost time: 13.206048727035522
Epoch: 38, Steps: 208 | Train Loss: 3.377 Vali Loss: 3.446 Vali Acc: 0.064 Test Loss: 3.446 Test Acc: 0.064
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 39 | loss: 3.4519017
	speed: 0.1552s/iter; left time: 1986.0474s
	iters: 200, epoch: 39 | loss: 3.7173645
	speed: 0.0473s/iter; left time: 601.0430s
Epoch: 39 cost time: 10.319372653961182
Epoch: 39, Steps: 208 | Train Loss: 3.375 Vali Loss: 3.523 Vali Acc: 0.065 Test Loss: 3.523 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 40 | loss: 3.3665562
	speed: 0.1881s/iter; left time: 2367.3800s
	iters: 200, epoch: 40 | loss: 3.2710128
	speed: 0.0566s/iter; left time: 706.2769s
Epoch: 40 cost time: 12.972386121749878
Epoch: 40, Steps: 208 | Train Loss: 3.373 Vali Loss: 3.498 Vali Acc: 0.059 Test Loss: 3.498 Test Acc: 0.059
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 41 | loss: 3.3721235
	speed: 0.1848s/iter; left time: 2287.6664s
	iters: 200, epoch: 41 | loss: 3.4203019
	speed: 0.0499s/iter; left time: 613.1067s
Epoch: 41 cost time: 10.482317209243774
Epoch: 41, Steps: 208 | Train Loss: 3.363 Vali Loss: 3.447 Vali Acc: 0.065 Test Loss: 3.447 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 42 | loss: 3.6930974
	speed: 0.1958s/iter; left time: 2383.8469s
	iters: 200, epoch: 42 | loss: 3.3081923
	speed: 0.0803s/iter; left time: 969.5219s
Epoch: 42 cost time: 16.8507719039917
Epoch: 42, Steps: 208 | Train Loss: 3.354 Vali Loss: 3.459 Vali Acc: 0.067 Test Loss: 3.459 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 43 | loss: 3.2704463
	speed: 0.2354s/iter; left time: 2816.3339s
	iters: 200, epoch: 43 | loss: 3.5397067
	speed: 0.0765s/iter; left time: 908.1817s
Epoch: 43 cost time: 17.206546545028687
Epoch: 43, Steps: 208 | Train Loss: 3.343 Vali Loss: 3.455 Vali Acc: 0.067 Test Loss: 3.455 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 44 | loss: 3.4433141
	speed: 0.2263s/iter; left time: 2660.4725s
	iters: 200, epoch: 44 | loss: 3.4592657
	speed: 0.0816s/iter; left time: 951.2888s
Epoch: 44 cost time: 17.038438320159912
Epoch: 44, Steps: 208 | Train Loss: 3.385 Vali Loss: 3.459 Vali Acc: 0.067 Test Loss: 3.459 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 45 | loss: 3.1218350
	speed: 0.2202s/iter; left time: 2542.6550s
	iters: 200, epoch: 45 | loss: 3.2665632
	speed: 0.0820s/iter; left time: 939.3435s
Epoch: 45 cost time: 16.177060842514038
Epoch: 45, Steps: 208 | Train Loss: 3.350 Vali Loss: 3.472 Vali Acc: 0.059 Test Loss: 3.472 Test Acc: 0.059
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 46 | loss: 3.4418244
	speed: 0.2326s/iter; left time: 2637.7004s
	iters: 200, epoch: 46 | loss: 3.3308740
	speed: 0.0701s/iter; left time: 787.9905s
Epoch: 46 cost time: 15.773779392242432
Epoch: 46, Steps: 208 | Train Loss: 3.348 Vali Loss: 3.446 Vali Acc: 0.061 Test Loss: 3.446 Test Acc: 0.061
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.06919176856546376
model parameter : 5524415
model size : 26.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.7627912
	speed: 0.0843s/iter; left time: 1744.7892s
	iters: 200, epoch: 1 | loss: 8.7262735
	speed: 0.0675s/iter; left time: 1391.2200s
Epoch: 1 cost time: 15.60823106765747
Epoch: 1, Steps: 208 | Train Loss: 6.795 Vali Loss: 7.953 Vali Acc: 0.043 Test Loss: 7.953 Test Acc: 0.043
Validation loss decreased (inf --> -0.043165).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.6849122
	speed: 0.1964s/iter; left time: 4025.1104s
	iters: 200, epoch: 2 | loss: 4.0604901
	speed: 0.0720s/iter; left time: 1468.1341s
Epoch: 2 cost time: 14.795889139175415
Epoch: 2, Steps: 208 | Train Loss: 5.756 Vali Loss: 4.640 Vali Acc: 0.026 Test Loss: 4.640 Test Acc: 0.026
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.1703978
	speed: 0.2009s/iter; left time: 4075.6658s
	iters: 200, epoch: 3 | loss: 3.9766266
	speed: 0.0685s/iter; left time: 1381.7019s
Epoch: 3 cost time: 14.660176992416382
Epoch: 3, Steps: 208 | Train Loss: 4.387 Vali Loss: 4.232 Vali Acc: 0.041 Test Loss: 4.232 Test Acc: 0.041
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 3.3414109
	speed: 0.2006s/iter; left time: 4027.5274s
	iters: 200, epoch: 4 | loss: 3.8612971
	speed: 0.0697s/iter; left time: 1392.1833s
Epoch: 4 cost time: 15.42211127281189
Epoch: 4, Steps: 208 | Train Loss: 4.123 Vali Loss: 4.011 Vali Acc: 0.049 Test Loss: 4.011 Test Acc: 0.049
Validation loss decreased (-0.043165 --> -0.048573).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.4164431
	speed: 0.1934s/iter; left time: 3842.7522s
	iters: 200, epoch: 5 | loss: 4.0291905
	speed: 0.0587s/iter; left time: 1161.2003s
Epoch: 5 cost time: 13.159273862838745
Epoch: 5, Steps: 208 | Train Loss: 3.791 Vali Loss: 3.849 Vali Acc: 0.055 Test Loss: 3.849 Test Acc: 0.055
Validation loss decreased (-0.048573 --> -0.055136).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.7184615
	speed: 0.2040s/iter; left time: 4010.3300s
	iters: 200, epoch: 6 | loss: 3.7181420
	speed: 0.0666s/iter; left time: 1303.5083s
Epoch: 6 cost time: 14.66797161102295
Epoch: 6, Steps: 208 | Train Loss: 3.548 Vali Loss: 3.488 Vali Acc: 0.065 Test Loss: 3.488 Test Acc: 0.065
Validation loss decreased (-0.055136 --> -0.064982).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.0377603
	speed: 0.1965s/iter; left time: 3822.3998s
	iters: 200, epoch: 7 | loss: 2.9751754
	speed: 0.0712s/iter; left time: 1377.9176s
Epoch: 7 cost time: 14.65616774559021
Epoch: 7, Steps: 208 | Train Loss: 3.303 Vali Loss: 3.381 Vali Acc: 0.079 Test Loss: 3.381 Test Acc: 0.079
Validation loss decreased (-0.064982 --> -0.079000).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.9885068
	speed: 0.1987s/iter; left time: 3824.4523s
	iters: 200, epoch: 8 | loss: 3.4145045
	speed: 0.0719s/iter; left time: 1377.4484s
Epoch: 8 cost time: 15.51114010810852
Epoch: 8, Steps: 208 | Train Loss: 3.102 Vali Loss: 3.368 Vali Acc: 0.089 Test Loss: 3.368 Test Acc: 0.089
Validation loss decreased (-0.079000 --> -0.089140).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.2407744
	speed: 0.1926s/iter; left time: 3666.6142s
	iters: 200, epoch: 9 | loss: 2.4609015
	speed: 0.0612s/iter; left time: 1158.7985s
Epoch: 9 cost time: 13.629825115203857
Epoch: 9, Steps: 208 | Train Loss: 2.973 Vali Loss: 3.115 Vali Acc: 0.127 Test Loss: 3.115 Test Acc: 0.127
Validation loss decreased (-0.089140 --> -0.127019).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.5159311
	speed: 0.1950s/iter; left time: 3670.9812s
	iters: 200, epoch: 10 | loss: 2.5970449
	speed: 0.0669s/iter; left time: 1253.8425s
Epoch: 10 cost time: 14.342683792114258
Epoch: 10, Steps: 208 | Train Loss: 2.681 Vali Loss: 3.270 Vali Acc: 0.111 Test Loss: 3.270 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.2916970
	speed: 0.1929s/iter; left time: 3591.3384s
	iters: 200, epoch: 11 | loss: 2.5371099
	speed: 0.0760s/iter; left time: 1407.1523s
Epoch: 11 cost time: 14.820959091186523
Epoch: 11, Steps: 208 | Train Loss: 2.357 Vali Loss: 3.336 Vali Acc: 0.119 Test Loss: 3.336 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 2.0778639
	speed: 0.2009s/iter; left time: 3699.6642s
	iters: 200, epoch: 12 | loss: 2.1643753
	speed: 0.0641s/iter; left time: 1173.0378s
Epoch: 12 cost time: 14.496360063552856
Epoch: 12, Steps: 208 | Train Loss: 1.940 Vali Loss: 3.544 Vali Acc: 0.121 Test Loss: 3.544 Test Acc: 0.121
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.9644933
	speed: 0.2147s/iter; left time: 3908.3611s
	iters: 200, epoch: 13 | loss: 1.7049402
	speed: 0.0756s/iter; left time: 1368.0640s
Epoch: 13 cost time: 16.78342843055725
Epoch: 13, Steps: 208 | Train Loss: 1.509 Vali Loss: 3.886 Vali Acc: 0.126 Test Loss: 3.886 Test Acc: 0.126
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.8010183
	speed: 0.2194s/iter; left time: 3949.4009s
	iters: 200, epoch: 14 | loss: 1.1945046
	speed: 0.0759s/iter; left time: 1357.6713s
Epoch: 14 cost time: 15.898584365844727
Epoch: 14, Steps: 208 | Train Loss: 1.248 Vali Loss: 4.509 Vali Acc: 0.126 Test Loss: 4.509 Test Acc: 0.126
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.5415030
	speed: 0.2264s/iter; left time: 4027.2346s
	iters: 200, epoch: 15 | loss: 0.9153233
	speed: 0.0864s/iter; left time: 1527.5608s
Epoch: 15 cost time: 17.905897855758667
Epoch: 15, Steps: 208 | Train Loss: 0.992 Vali Loss: 5.469 Vali Acc: 0.118 Test Loss: 5.469 Test Acc: 0.118
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.2398254
	speed: 0.2248s/iter; left time: 3951.9202s
	iters: 200, epoch: 16 | loss: 1.3371209
	speed: 0.0695s/iter; left time: 1214.0724s
Epoch: 16 cost time: 15.762070655822754
Epoch: 16, Steps: 208 | Train Loss: 0.822 Vali Loss: 6.946 Vali Acc: 0.110 Test Loss: 6.946 Test Acc: 0.110
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.5331457
	speed: 0.2063s/iter; left time: 3584.2154s
	iters: 200, epoch: 17 | loss: 0.9199122
	speed: 0.0628s/iter; left time: 1084.2804s
Epoch: 17 cost time: 13.844895601272583
Epoch: 17, Steps: 208 | Train Loss: 0.748 Vali Loss: 5.411 Vali Acc: 0.118 Test Loss: 5.411 Test Acc: 0.118
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.5164143
	speed: 0.1410s/iter; left time: 2419.7062s
	iters: 200, epoch: 18 | loss: 0.2874730
	speed: 0.0325s/iter; left time: 555.3534s
Epoch: 18 cost time: 7.4935853481292725
Epoch: 18, Steps: 208 | Train Loss: 0.676 Vali Loss: 6.348 Vali Acc: 0.118 Test Loss: 6.348 Test Acc: 0.118
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.3814585
	speed: 0.1892s/iter; left time: 3208.6091s
	iters: 200, epoch: 19 | loss: 0.1522884
	speed: 0.0684s/iter; left time: 1152.3345s
Epoch: 19 cost time: 14.722105026245117
Epoch: 19, Steps: 208 | Train Loss: 0.565 Vali Loss: 6.505 Vali Acc: 0.120 Test Loss: 6.505 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12705040262451536
model parameter : 5519551
model size : 26.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.4814787
	speed: 0.0922s/iter; left time: 1908.8462s
	iters: 200, epoch: 1 | loss: 5.9000211
	speed: 0.0787s/iter; left time: 1620.9296s
Epoch: 1 cost time: 17.815961599349976
Epoch: 1, Steps: 208 | Train Loss: 5.056 Vali Loss: 5.583 Vali Acc: 0.042 Test Loss: 5.583 Test Acc: 0.042
Validation loss decreased (inf --> -0.041996).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6041293
	speed: 0.2046s/iter; left time: 4193.5730s
	iters: 200, epoch: 2 | loss: 4.4825668
	speed: 0.0730s/iter; left time: 1489.0382s
Epoch: 2 cost time: 16.81891393661499
Epoch: 2, Steps: 208 | Train Loss: 4.577 Vali Loss: 4.140 Vali Acc: 0.045 Test Loss: 4.140 Test Acc: 0.045
Validation loss decreased (-0.041996 --> -0.044695).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.0303192
	speed: 0.1972s/iter; left time: 3999.7965s
	iters: 200, epoch: 3 | loss: 4.3863373
	speed: 0.0749s/iter; left time: 1510.9497s
Epoch: 3 cost time: 16.443753480911255
Epoch: 3, Steps: 208 | Train Loss: 3.892 Vali Loss: 3.952 Vali Acc: 0.052 Test Loss: 3.952 Test Acc: 0.052
Validation loss decreased (-0.044695 --> -0.051854).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3208799
	speed: 0.1640s/iter; left time: 3293.2622s
	iters: 200, epoch: 4 | loss: 3.6515770
	speed: 0.0628s/iter; left time: 1254.6487s
Epoch: 4 cost time: 12.162497520446777
Epoch: 4, Steps: 208 | Train Loss: 3.705 Vali Loss: 3.889 Vali Acc: 0.055 Test Loss: 3.889 Test Acc: 0.055
Validation loss decreased (-0.051854 --> -0.055434).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.0885756
	speed: 0.1981s/iter; left time: 3936.1550s
	iters: 200, epoch: 5 | loss: 3.5643682
	speed: 0.0754s/iter; left time: 1489.8039s
Epoch: 5 cost time: 17.026659965515137
Epoch: 5, Steps: 208 | Train Loss: 3.480 Vali Loss: 3.439 Vali Acc: 0.083 Test Loss: 3.439 Test Acc: 0.083
Validation loss decreased (-0.055434 --> -0.082578).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.8331628
	speed: 0.1994s/iter; left time: 3920.1768s
	iters: 200, epoch: 6 | loss: 4.3232546
	speed: 0.0862s/iter; left time: 1686.1259s
Epoch: 6 cost time: 16.527666568756104
Epoch: 6, Steps: 208 | Train Loss: 3.216 Vali Loss: 3.268 Vali Acc: 0.097 Test Loss: 3.268 Test Acc: 0.097
Validation loss decreased (-0.082578 --> -0.096597).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.1488614
	speed: 0.2102s/iter; left time: 4089.1688s
	iters: 200, epoch: 7 | loss: 2.7960811
	speed: 0.0744s/iter; left time: 1439.6611s
Epoch: 7 cost time: 16.82372760772705
Epoch: 7, Steps: 208 | Train Loss: 2.967 Vali Loss: 3.277 Vali Acc: 0.101 Test Loss: 3.277 Test Acc: 0.101
Validation loss decreased (-0.096597 --> -0.100474).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.8936648
	speed: 0.2016s/iter; left time: 3879.7846s
	iters: 200, epoch: 8 | loss: 2.4357800
	speed: 0.0797s/iter; left time: 1526.8005s
Epoch: 8 cost time: 16.875803232192993
Epoch: 8, Steps: 208 | Train Loss: 2.650 Vali Loss: 3.393 Vali Acc: 0.108 Test Loss: 3.393 Test Acc: 0.108
Validation loss decreased (-0.100474 --> -0.108227).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.5062878
	speed: 0.2045s/iter; left time: 3892.7082s
	iters: 200, epoch: 9 | loss: 2.2449841
	speed: 0.0956s/iter; left time: 1811.0553s
Epoch: 9 cost time: 18.29103398323059
Epoch: 9, Steps: 208 | Train Loss: 2.236 Vali Loss: 3.708 Vali Acc: 0.115 Test Loss: 3.708 Test Acc: 0.115
Validation loss decreased (-0.108227 --> -0.115382).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.1067916
	speed: 0.2354s/iter; left time: 4431.5828s
	iters: 200, epoch: 10 | loss: 1.7516538
	speed: 0.0872s/iter; left time: 1633.3276s
Epoch: 10 cost time: 19.25294303894043
Epoch: 10, Steps: 208 | Train Loss: 1.751 Vali Loss: 4.075 Vali Acc: 0.114 Test Loss: 4.075 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.3237385
	speed: 0.2140s/iter; left time: 3985.2653s
	iters: 200, epoch: 11 | loss: 1.8906989
	speed: 0.0921s/iter; left time: 1706.6143s
Epoch: 11 cost time: 17.681336879730225
Epoch: 11, Steps: 208 | Train Loss: 1.241 Vali Loss: 4.545 Vali Acc: 0.114 Test Loss: 4.545 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.6264964
	speed: 0.2328s/iter; left time: 4286.2217s
	iters: 200, epoch: 12 | loss: 0.7326354
	speed: 0.0815s/iter; left time: 1491.8404s
Epoch: 12 cost time: 18.066067695617676
Epoch: 12, Steps: 208 | Train Loss: 0.929 Vali Loss: 5.597 Vali Acc: 0.119 Test Loss: 5.597 Test Acc: 0.119
Validation loss decreased (-0.115382 --> -0.118644).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.3790610
	speed: 0.2045s/iter; left time: 3722.6179s
	iters: 200, epoch: 13 | loss: 0.3755260
	speed: 0.0788s/iter; left time: 1426.5458s
Epoch: 13 cost time: 16.7324960231781
Epoch: 13, Steps: 208 | Train Loss: 0.748 Vali Loss: 6.682 Vali Acc: 0.127 Test Loss: 6.682 Test Acc: 0.127
Validation loss decreased (-0.118644 --> -0.126984).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.5127911
	speed: 0.1936s/iter; left time: 3483.9486s
	iters: 200, epoch: 14 | loss: 0.6894940
	speed: 0.0782s/iter; left time: 1399.0341s
Epoch: 14 cost time: 16.255542039871216
Epoch: 14, Steps: 208 | Train Loss: 0.623 Vali Loss: 6.407 Vali Acc: 0.121 Test Loss: 6.407 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.9993485
	speed: 0.2064s/iter; left time: 3672.4889s
	iters: 200, epoch: 15 | loss: 0.9845634
	speed: 0.0649s/iter; left time: 1148.3913s
Epoch: 15 cost time: 16.047203302383423
Epoch: 15, Steps: 208 | Train Loss: 0.546 Vali Loss: 7.238 Vali Acc: 0.123 Test Loss: 7.238 Test Acc: 0.123
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.1958531
	speed: 0.1979s/iter; left time: 3479.8633s
	iters: 200, epoch: 16 | loss: 1.0304623
	speed: 0.0788s/iter; left time: 1377.6683s
Epoch: 16 cost time: 16.121267080307007
Epoch: 16, Steps: 208 | Train Loss: 0.495 Vali Loss: 6.212 Vali Acc: 0.118 Test Loss: 6.212 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.9270352
	speed: 0.1997s/iter; left time: 3468.5494s
	iters: 200, epoch: 17 | loss: 0.3244854
	speed: 0.0801s/iter; left time: 1383.2283s
Epoch: 17 cost time: 16.819876670837402
Epoch: 17, Steps: 208 | Train Loss: 0.452 Vali Loss: 7.772 Vali Acc: 0.113 Test Loss: 7.772 Test Acc: 0.113
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.2085252
	speed: 0.2025s/iter; left time: 3475.5728s
	iters: 200, epoch: 18 | loss: 0.8399440
	speed: 0.0801s/iter; left time: 1366.1271s
Epoch: 18 cost time: 17.24996256828308
Epoch: 18, Steps: 208 | Train Loss: 0.431 Vali Loss: 8.170 Vali Acc: 0.119 Test Loss: 8.170 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.7148650
	speed: 0.1891s/iter; left time: 3206.5741s
	iters: 200, epoch: 19 | loss: 0.2168905
	speed: 0.0822s/iter; left time: 1385.6970s
Epoch: 19 cost time: 15.495421648025513
Epoch: 19, Steps: 208 | Train Loss: 0.392 Vali Loss: 8.871 Vali Acc: 0.119 Test Loss: 8.871 Test Acc: 0.119
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.3682426
	speed: 0.2081s/iter; left time: 3484.6563s
	iters: 200, epoch: 20 | loss: 0.0285352
	speed: 0.0719s/iter; left time: 1197.6490s
Epoch: 20 cost time: 17.172206163406372
Epoch: 20, Steps: 208 | Train Loss: 0.362 Vali Loss: 8.121 Vali Acc: 0.106 Test Loss: 8.121 Test Acc: 0.106
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.6030906
	speed: 0.2047s/iter; left time: 3385.7083s
	iters: 200, epoch: 21 | loss: 0.4468822
	speed: 0.0822s/iter; left time: 1352.2219s
Epoch: 21 cost time: 17.215885162353516
Epoch: 21, Steps: 208 | Train Loss: 0.321 Vali Loss: 7.986 Vali Acc: 0.117 Test Loss: 7.986 Test Acc: 0.117
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.3804439
	speed: 0.1907s/iter; left time: 3115.0800s
	iters: 200, epoch: 22 | loss: 0.1928992
	speed: 0.0741s/iter; left time: 1202.9934s
Epoch: 22 cost time: 15.616393089294434
Epoch: 22, Steps: 208 | Train Loss: 0.302 Vali Loss: 8.720 Vali Acc: 0.120 Test Loss: 8.720 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.8025870
	speed: 0.1991s/iter; left time: 3210.2933s
	iters: 200, epoch: 23 | loss: 0.1617006
	speed: 0.0754s/iter; left time: 1207.5601s
Epoch: 23 cost time: 16.571073293685913
Epoch: 23, Steps: 208 | Train Loss: 0.316 Vali Loss: 8.210 Vali Acc: 0.106 Test Loss: 8.210 Test Acc: 0.106
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12705040262451536
model parameter : 2671679
model size : 12.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.2437625
	speed: 0.0856s/iter; left time: 1772.2733s
	iters: 200, epoch: 1 | loss: 4.6529551
	speed: 0.0746s/iter; left time: 1536.5318s
Epoch: 1 cost time: 16.708945512771606
Epoch: 1, Steps: 208 | Train Loss: 4.947 Vali Loss: 5.761 Vali Acc: 0.040 Test Loss: 5.761 Test Acc: 0.040
Validation loss decreased (inf --> -0.039907).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.3685689
	speed: 0.2106s/iter; left time: 4314.8279s
	iters: 200, epoch: 2 | loss: 3.6640182
	speed: 0.0782s/iter; left time: 1595.6849s
Epoch: 2 cost time: 15.728373289108276
Epoch: 2, Steps: 208 | Train Loss: 5.118 Vali Loss: 4.149 Vali Acc: 0.047 Test Loss: 4.149 Test Acc: 0.047
Validation loss decreased (-0.039907 --> -0.047379).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.9275947
	speed: 0.2156s/iter; left time: 4373.0833s
	iters: 200, epoch: 3 | loss: 3.4423585
	speed: 0.0594s/iter; left time: 1199.6281s
Epoch: 3 cost time: 14.457015037536621
Epoch: 3, Steps: 208 | Train Loss: 3.933 Vali Loss: 3.795 Vali Acc: 0.035 Test Loss: 3.795 Test Acc: 0.035
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.6223164
	speed: 0.2060s/iter; left time: 4135.0195s
	iters: 200, epoch: 4 | loss: 3.7843106
	speed: 0.0701s/iter; left time: 1400.3721s
Epoch: 4 cost time: 15.10458493232727
Epoch: 4, Steps: 208 | Train Loss: 3.691 Vali Loss: 3.719 Vali Acc: 0.050 Test Loss: 3.719 Test Acc: 0.050
Validation loss decreased (-0.047379 --> -0.050365).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.0022464
	speed: 0.1433s/iter; left time: 2846.7659s
	iters: 200, epoch: 5 | loss: 3.9551415
	speed: 0.0401s/iter; left time: 793.4154s
Epoch: 5 cost time: 8.579414367675781
Epoch: 5, Steps: 208 | Train Loss: 3.436 Vali Loss: 3.498 Vali Acc: 0.079 Test Loss: 3.498 Test Acc: 0.079
Validation loss decreased (-0.050365 --> -0.078700).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.4007826
	speed: 0.1871s/iter; left time: 3678.9775s
	iters: 200, epoch: 6 | loss: 3.8548515
	speed: 0.0713s/iter; left time: 1395.5007s
Epoch: 6 cost time: 14.783008575439453
Epoch: 6, Steps: 208 | Train Loss: 3.253 Vali Loss: 3.363 Vali Acc: 0.074 Test Loss: 3.363 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.7091234
	speed: 0.1843s/iter; left time: 3585.9098s
	iters: 200, epoch: 7 | loss: 3.2757287
	speed: 0.0633s/iter; left time: 1224.3128s
Epoch: 7 cost time: 13.630409240722656
Epoch: 7, Steps: 208 | Train Loss: 2.975 Vali Loss: 3.299 Vali Acc: 0.102 Test Loss: 3.299 Test Acc: 0.102
Validation loss decreased (-0.078700 --> -0.101667).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.8820734
	speed: 0.1795s/iter; left time: 3454.0633s
	iters: 200, epoch: 8 | loss: 2.8357506
	speed: 0.0465s/iter; left time: 889.6647s
Epoch: 8 cost time: 11.170338153839111
Epoch: 8, Steps: 208 | Train Loss: 2.616 Vali Loss: 3.305 Vali Acc: 0.107 Test Loss: 3.305 Test Acc: 0.107
Validation loss decreased (-0.101667 --> -0.107333).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.4440808
	speed: 0.1695s/iter; left time: 3225.9526s
	iters: 200, epoch: 9 | loss: 1.9843341
	speed: 0.0663s/iter; left time: 1255.7303s
Epoch: 9 cost time: 14.377743482589722
Epoch: 9, Steps: 208 | Train Loss: 2.237 Vali Loss: 3.449 Vali Acc: 0.129 Test Loss: 3.449 Test Acc: 0.129
Validation loss decreased (-0.107333 --> -0.128507).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.6124448
	speed: 0.1852s/iter; left time: 3486.7527s
	iters: 200, epoch: 10 | loss: 1.6760504
	speed: 0.0684s/iter; left time: 1281.2159s
Epoch: 10 cost time: 14.072695016860962
Epoch: 10, Steps: 208 | Train Loss: 1.780 Vali Loss: 4.038 Vali Acc: 0.126 Test Loss: 4.038 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.4796875
	speed: 0.1900s/iter; left time: 3538.1827s
	iters: 200, epoch: 11 | loss: 2.2711291
	speed: 0.0704s/iter; left time: 1303.8263s
Epoch: 11 cost time: 14.755595922470093
Epoch: 11, Steps: 208 | Train Loss: 1.316 Vali Loss: 4.596 Vali Acc: 0.120 Test Loss: 4.596 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.9404511
	speed: 0.1869s/iter; left time: 3441.3648s
	iters: 200, epoch: 12 | loss: 1.2449031
	speed: 0.0645s/iter; left time: 1180.2969s
Epoch: 12 cost time: 14.20365309715271
Epoch: 12, Steps: 208 | Train Loss: 0.986 Vali Loss: 6.518 Vali Acc: 0.114 Test Loss: 6.518 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.3809324
	speed: 0.1924s/iter; left time: 3501.8802s
	iters: 200, epoch: 13 | loss: 1.0839980
	speed: 0.0669s/iter; left time: 1211.1992s
Epoch: 13 cost time: 14.698075771331787
Epoch: 13, Steps: 208 | Train Loss: 0.792 Vali Loss: 6.759 Vali Acc: 0.127 Test Loss: 6.759 Test Acc: 0.127
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.5408995
	speed: 0.1930s/iter; left time: 3473.8866s
	iters: 200, epoch: 14 | loss: 0.5994716
	speed: 0.0605s/iter; left time: 1082.0891s
Epoch: 14 cost time: 13.721189022064209
Epoch: 14, Steps: 208 | Train Loss: 0.680 Vali Loss: 7.056 Vali Acc: 0.119 Test Loss: 7.056 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.6166053
	speed: 0.1866s/iter; left time: 3318.7601s
	iters: 200, epoch: 15 | loss: 0.8267388
	speed: 0.0710s/iter; left time: 1255.2712s
Epoch: 15 cost time: 14.911604166030884
Epoch: 15, Steps: 208 | Train Loss: 0.583 Vali Loss: 6.871 Vali Acc: 0.123 Test Loss: 6.871 Test Acc: 0.123
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0897565
	speed: 0.1869s/iter; left time: 3285.8165s
	iters: 200, epoch: 16 | loss: 0.7966049
	speed: 0.0675s/iter; left time: 1179.2175s
Epoch: 16 cost time: 14.028679847717285
Epoch: 16, Steps: 208 | Train Loss: 0.490 Vali Loss: 8.790 Vali Acc: 0.111 Test Loss: 8.790 Test Acc: 0.111
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.2234407
	speed: 0.1902s/iter; left time: 3304.5210s
	iters: 200, epoch: 17 | loss: 0.2515551
	speed: 0.0653s/iter; left time: 1127.2714s
Epoch: 17 cost time: 14.631989479064941
Epoch: 17, Steps: 208 | Train Loss: 0.421 Vali Loss: 7.978 Vali Acc: 0.113 Test Loss: 7.978 Test Acc: 0.113
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.1396798
	speed: 0.1900s/iter; left time: 3261.0832s
	iters: 200, epoch: 18 | loss: 0.3298191
	speed: 0.0680s/iter; left time: 1161.0600s
Epoch: 18 cost time: 14.46331262588501
Epoch: 18, Steps: 208 | Train Loss: 0.446 Vali Loss: 7.775 Vali Acc: 0.125 Test Loss: 7.775 Test Acc: 0.125
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0319074
	speed: 0.2015s/iter; left time: 3417.3510s
	iters: 200, epoch: 19 | loss: 0.2180391
	speed: 0.0745s/iter; left time: 1255.5733s
Epoch: 19 cost time: 15.788624286651611
Epoch: 19, Steps: 208 | Train Loss: 0.385 Vali Loss: 8.708 Vali Acc: 0.126 Test Loss: 8.708 Test Acc: 0.126
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1285416045332538
model parameter : 2669247
model size : 12.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.6885004
	speed: 0.0947s/iter; left time: 1961.1837s
	iters: 200, epoch: 1 | loss: 6.5360317
	speed: 0.0762s/iter; left time: 1569.3255s
Epoch: 1 cost time: 17.848103284835815
Epoch: 1, Steps: 208 | Train Loss: 4.895 Vali Loss: 5.377 Vali Acc: 0.044 Test Loss: 5.377 Test Acc: 0.044
Validation loss decreased (inf --> -0.043489).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9600832
	speed: 0.2188s/iter; left time: 4483.0850s
	iters: 200, epoch: 2 | loss: 4.0295038
	speed: 0.0757s/iter; left time: 1543.4657s
Epoch: 2 cost time: 16.690202713012695
Epoch: 2, Steps: 208 | Train Loss: 4.325 Vali Loss: 3.967 Vali Acc: 0.049 Test Loss: 3.967 Test Acc: 0.049
Validation loss decreased (-0.043489 --> -0.049170).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3501091
	speed: 0.2085s/iter; left time: 4229.2937s
	iters: 200, epoch: 3 | loss: 4.3926225
	speed: 0.0619s/iter; left time: 1249.2256s
Epoch: 3 cost time: 13.925168752670288
Epoch: 3, Steps: 208 | Train Loss: 3.878 Vali Loss: 4.212 Vali Acc: 0.036 Test Loss: 4.212 Test Acc: 0.036
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.6299310
	speed: 0.1864s/iter; left time: 3741.9383s
	iters: 200, epoch: 4 | loss: 2.8604281
	speed: 0.0684s/iter; left time: 1366.8424s
Epoch: 4 cost time: 14.526641607284546
Epoch: 4, Steps: 208 | Train Loss: 3.710 Vali Loss: 3.542 Vali Acc: 0.061 Test Loss: 3.542 Test Acc: 0.061
Validation loss decreased (-0.049170 --> -0.061402).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3233407
	speed: 0.1925s/iter; left time: 3823.9113s
	iters: 200, epoch: 5 | loss: 2.8764486
	speed: 0.0692s/iter; left time: 1368.5505s
Epoch: 5 cost time: 14.581102132797241
Epoch: 5, Steps: 208 | Train Loss: 3.444 Vali Loss: 3.647 Vali Acc: 0.081 Test Loss: 3.647 Test Acc: 0.081
Validation loss decreased (-0.061402 --> -0.080787).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.4555109
	speed: 0.1803s/iter; left time: 3545.6654s
	iters: 200, epoch: 6 | loss: 3.3179555
	speed: 0.0667s/iter; left time: 1305.4239s
Epoch: 6 cost time: 14.10793948173523
Epoch: 6, Steps: 208 | Train Loss: 3.266 Vali Loss: 3.468 Vali Acc: 0.074 Test Loss: 3.468 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.0537968
	speed: 0.1886s/iter; left time: 3669.4136s
	iters: 200, epoch: 7 | loss: 3.3715084
	speed: 0.0622s/iter; left time: 1202.8280s
Epoch: 7 cost time: 13.84645390510559
Epoch: 7, Steps: 208 | Train Loss: 3.018 Vali Loss: 3.205 Vali Acc: 0.101 Test Loss: 3.205 Test Acc: 0.101
Validation loss decreased (-0.080787 --> -0.100773).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.1148391
	speed: 0.1875s/iter; left time: 3607.8299s
	iters: 200, epoch: 8 | loss: 2.1213977
	speed: 0.0714s/iter; left time: 1367.0225s
Epoch: 8 cost time: 14.510059356689453
Epoch: 8, Steps: 208 | Train Loss: 2.692 Vali Loss: 3.233 Vali Acc: 0.121 Test Loss: 3.233 Test Acc: 0.121
Validation loss decreased (-0.100773 --> -0.120755).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.3486073
	speed: 0.1889s/iter; left time: 3595.4318s
	iters: 200, epoch: 9 | loss: 2.0715499
	speed: 0.0675s/iter; left time: 1277.9490s
Epoch: 9 cost time: 14.439678192138672
Epoch: 9, Steps: 208 | Train Loss: 2.321 Vali Loss: 3.431 Vali Acc: 0.118 Test Loss: 3.431 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.6704922
	speed: 0.1874s/iter; left time: 3529.4561s
	iters: 200, epoch: 10 | loss: 2.3296125
	speed: 0.0566s/iter; left time: 1060.3778s
Epoch: 10 cost time: 13.276508331298828
Epoch: 10, Steps: 208 | Train Loss: 1.843 Vali Loss: 3.668 Vali Acc: 0.132 Test Loss: 3.668 Test Acc: 0.132
Validation loss decreased (-0.120755 --> -0.131487).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.7331243
	speed: 0.1401s/iter; left time: 2609.2106s
	iters: 200, epoch: 11 | loss: 1.3570151
	speed: 0.0404s/iter; left time: 747.7561s
Epoch: 11 cost time: 8.403743982315063
Epoch: 11, Steps: 208 | Train Loss: 1.409 Vali Loss: 4.145 Vali Acc: 0.128 Test Loss: 4.145 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.2932959
	speed: 0.1714s/iter; left time: 3155.3594s
	iters: 200, epoch: 12 | loss: 1.4597331
	speed: 0.0538s/iter; left time: 984.8530s
Epoch: 12 cost time: 12.946798086166382
Epoch: 12, Steps: 208 | Train Loss: 1.059 Vali Loss: 5.130 Vali Acc: 0.122 Test Loss: 5.130 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.4681392
	speed: 0.1866s/iter; left time: 3396.1431s
	iters: 200, epoch: 13 | loss: 1.5561134
	speed: 0.0630s/iter; left time: 1140.9888s
Epoch: 13 cost time: 13.987744569778442
Epoch: 13, Steps: 208 | Train Loss: 0.844 Vali Loss: 5.676 Vali Acc: 0.125 Test Loss: 5.676 Test Acc: 0.125
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.7388310
	speed: 0.1793s/iter; left time: 3226.6536s
	iters: 200, epoch: 14 | loss: 0.5255998
	speed: 0.0614s/iter; left time: 1099.0566s
Epoch: 14 cost time: 13.351550102233887
Epoch: 14, Steps: 208 | Train Loss: 0.702 Vali Loss: 6.676 Vali Acc: 0.126 Test Loss: 6.676 Test Acc: 0.126
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.8528311
	speed: 0.1933s/iter; left time: 3437.8164s
	iters: 200, epoch: 15 | loss: 0.7256362
	speed: 0.0677s/iter; left time: 1198.4280s
Epoch: 15 cost time: 14.077309370040894
Epoch: 15, Steps: 208 | Train Loss: 0.605 Vali Loss: 6.886 Vali Acc: 0.117 Test Loss: 6.886 Test Acc: 0.117
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.4983752
	speed: 0.1856s/iter; left time: 3263.9013s
	iters: 200, epoch: 16 | loss: 0.5959869
	speed: 0.0610s/iter; left time: 1065.7566s
Epoch: 16 cost time: 13.69259262084961
Epoch: 16, Steps: 208 | Train Loss: 0.520 Vali Loss: 7.530 Vali Acc: 0.114 Test Loss: 7.530 Test Acc: 0.114
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.2646490
	speed: 0.1805s/iter; left time: 3135.3714s
	iters: 200, epoch: 17 | loss: 0.3423045
	speed: 0.0425s/iter; left time: 734.7572s
Epoch: 17 cost time: 10.140163898468018
Epoch: 17, Steps: 208 | Train Loss: 0.484 Vali Loss: 7.680 Vali Acc: 0.123 Test Loss: 7.680 Test Acc: 0.123
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.7915399
	speed: 0.2067s/iter; left time: 3548.4973s
	iters: 200, epoch: 18 | loss: 0.9637161
	speed: 0.0742s/iter; left time: 1266.4703s
Epoch: 18 cost time: 16.14816188812256
Epoch: 18, Steps: 208 | Train Loss: 0.435 Vali Loss: 8.357 Vali Acc: 0.122 Test Loss: 8.357 Test Acc: 0.122
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.4685392
	speed: 0.2152s/iter; left time: 3648.8824s
	iters: 200, epoch: 19 | loss: 0.5755218
	speed: 0.0742s/iter; left time: 1250.6984s
Epoch: 19 cost time: 15.491231203079224
Epoch: 19, Steps: 208 | Train Loss: 0.440 Vali Loss: 7.586 Vali Acc: 0.124 Test Loss: 7.586 Test Acc: 0.124
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.1924369
	speed: 0.2206s/iter; left time: 3695.2624s
	iters: 200, epoch: 20 | loss: 0.0530358
	speed: 0.0730s/iter; left time: 1215.5943s
Epoch: 20 cost time: 16.319072723388672
Epoch: 20, Steps: 208 | Train Loss: 0.379 Vali Loss: 9.739 Vali Acc: 0.122 Test Loss: 9.739 Test Acc: 0.122
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1315240083507307
model parameter : 2666815
model size : 12.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.0194740
	speed: 0.0998s/iter; left time: 2065.9793s
	iters: 200, epoch: 1 | loss: 7.2766647
	speed: 0.0777s/iter; left time: 1599.8452s
Epoch: 1 cost time: 18.499591827392578
Epoch: 1, Steps: 208 | Train Loss: 5.116 Vali Loss: 6.425 Vali Acc: 0.033 Test Loss: 6.425 Test Acc: 0.033
Validation loss decreased (inf --> -0.033339).  Saving model ...
	iters: 100, epoch: 2 | loss: 5.7560282
	speed: 0.1705s/iter; left time: 3493.2090s
	iters: 200, epoch: 2 | loss: 4.8752060
	speed: 0.0520s/iter; left time: 1060.0865s
Epoch: 2 cost time: 10.675852298736572
Epoch: 2, Steps: 208 | Train Loss: 5.214 Vali Loss: 4.460 Vali Acc: 0.049 Test Loss: 4.460 Test Acc: 0.049
Validation loss decreased (-0.033339 --> -0.048569).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.1693830
	speed: 0.1873s/iter; left time: 3798.8517s
	iters: 200, epoch: 3 | loss: 3.5455794
	speed: 0.0693s/iter; left time: 1398.7782s
Epoch: 3 cost time: 13.744629621505737
Epoch: 3, Steps: 208 | Train Loss: 4.190 Vali Loss: 4.387 Vali Acc: 0.031 Test Loss: 4.387 Test Acc: 0.031
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 4.2818151
	speed: 0.1874s/iter; left time: 3761.9435s
	iters: 200, epoch: 4 | loss: 3.5920997
	speed: 0.0662s/iter; left time: 1322.7892s
Epoch: 4 cost time: 14.534643411636353
Epoch: 4, Steps: 208 | Train Loss: 4.043 Vali Loss: 3.873 Vali Acc: 0.044 Test Loss: 3.873 Test Acc: 0.044
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 4.8351016
	speed: 0.1854s/iter; left time: 3684.6318s
	iters: 200, epoch: 5 | loss: 3.3521755
	speed: 0.0607s/iter; left time: 1199.5808s
Epoch: 5 cost time: 13.16176962852478
Epoch: 5, Steps: 208 | Train Loss: 3.926 Vali Loss: 3.916 Vali Acc: 0.042 Test Loss: 3.916 Test Acc: 0.042
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 4.1755176
	speed: 0.1855s/iter; left time: 3646.9781s
	iters: 200, epoch: 6 | loss: 3.5287769
	speed: 0.0675s/iter; left time: 1320.7250s
Epoch: 6 cost time: 13.876845836639404
Epoch: 6, Steps: 208 | Train Loss: 3.735 Vali Loss: 3.663 Vali Acc: 0.049 Test Loss: 3.663 Test Acc: 0.049
Validation loss decreased (-0.048569 --> -0.048875).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.3163874
	speed: 0.1769s/iter; left time: 3441.4618s
	iters: 200, epoch: 7 | loss: 4.0231137
	speed: 0.0507s/iter; left time: 981.6948s
Epoch: 7 cost time: 12.26356315612793
Epoch: 7, Steps: 208 | Train Loss: 3.576 Vali Loss: 3.531 Vali Acc: 0.073 Test Loss: 3.531 Test Acc: 0.073
Validation loss decreased (-0.048875 --> -0.072735).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.5888951
	speed: 0.1940s/iter; left time: 3733.3572s
	iters: 200, epoch: 8 | loss: 3.6953597
	speed: 0.0696s/iter; left time: 1332.7055s
Epoch: 8 cost time: 14.783632516860962
Epoch: 8, Steps: 208 | Train Loss: 3.484 Vali Loss: 3.457 Vali Acc: 0.069 Test Loss: 3.457 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 3.4786496
	speed: 0.1847s/iter; left time: 3515.3181s
	iters: 200, epoch: 9 | loss: 3.6607435
	speed: 0.0559s/iter; left time: 1059.0823s
Epoch: 9 cost time: 12.754000186920166
Epoch: 9, Steps: 208 | Train Loss: 3.321 Vali Loss: 3.367 Vali Acc: 0.078 Test Loss: 3.367 Test Acc: 0.078
Validation loss decreased (-0.072735 --> -0.078105).  Saving model ...
	iters: 100, epoch: 10 | loss: 3.4459465
	speed: 0.1893s/iter; left time: 3565.0450s
	iters: 200, epoch: 10 | loss: 2.8074813
	speed: 0.0678s/iter; left time: 1270.5877s
Epoch: 10 cost time: 14.353694677352905
Epoch: 10, Steps: 208 | Train Loss: 3.099 Vali Loss: 3.317 Vali Acc: 0.096 Test Loss: 3.317 Test Acc: 0.096
Validation loss decreased (-0.078105 --> -0.096298).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.5253468
	speed: 0.1583s/iter; left time: 2947.7549s
	iters: 200, epoch: 11 | loss: 3.0144825
	speed: 0.0352s/iter; left time: 652.4372s
Epoch: 11 cost time: 7.227484464645386
Epoch: 11, Steps: 208 | Train Loss: 2.904 Vali Loss: 3.190 Vali Acc: 0.107 Test Loss: 3.190 Test Acc: 0.107
Validation loss decreased (-0.096298 --> -0.107335).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.3339944
	speed: 0.1279s/iter; left time: 2355.8032s
	iters: 200, epoch: 12 | loss: 2.2383301
	speed: 0.0714s/iter; left time: 1308.2955s
Epoch: 12 cost time: 12.766092300415039
Epoch: 12, Steps: 208 | Train Loss: 2.653 Vali Loss: 3.330 Vali Acc: 0.104 Test Loss: 3.330 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.3807428
	speed: 0.1848s/iter; left time: 3364.9965s
	iters: 200, epoch: 13 | loss: 2.1878607
	speed: 0.0620s/iter; left time: 1123.3131s
Epoch: 13 cost time: 13.70502758026123
Epoch: 13, Steps: 208 | Train Loss: 2.315 Vali Loss: 3.569 Vali Acc: 0.115 Test Loss: 3.569 Test Acc: 0.115
Validation loss decreased (-0.107335 --> -0.115085).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.4063818
	speed: 0.1872s/iter; left time: 3368.1931s
	iters: 200, epoch: 14 | loss: 2.0576305
	speed: 0.0610s/iter; left time: 1091.7097s
Epoch: 14 cost time: 13.63440203666687
Epoch: 14, Steps: 208 | Train Loss: 1.899 Vali Loss: 4.114 Vali Acc: 0.115 Test Loss: 4.114 Test Acc: 0.115
Validation loss decreased (-0.115085 --> -0.115378).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.4058304
	speed: 0.1881s/iter; left time: 3346.2177s
	iters: 200, epoch: 15 | loss: 1.4063441
	speed: 0.0741s/iter; left time: 1311.1183s
Epoch: 15 cost time: 14.641622304916382
Epoch: 15, Steps: 208 | Train Loss: 1.430 Vali Loss: 4.639 Vali Acc: 0.112 Test Loss: 4.639 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.0764627
	speed: 0.2090s/iter; left time: 3674.9641s
	iters: 200, epoch: 16 | loss: 1.5831296
	speed: 0.0783s/iter; left time: 1368.4879s
Epoch: 16 cost time: 16.399983167648315
Epoch: 16, Steps: 208 | Train Loss: 1.038 Vali Loss: 4.951 Vali Acc: 0.100 Test Loss: 4.951 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.6021526
	speed: 0.2144s/iter; left time: 3724.1166s
	iters: 200, epoch: 17 | loss: 0.9772536
	speed: 0.0665s/iter; left time: 1148.1302s
Epoch: 17 cost time: 15.46047043800354
Epoch: 17, Steps: 208 | Train Loss: 0.832 Vali Loss: 5.913 Vali Acc: 0.111 Test Loss: 5.913 Test Acc: 0.111
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.3337820
	speed: 0.1959s/iter; left time: 3362.3061s
	iters: 200, epoch: 18 | loss: 0.6359685
	speed: 0.0639s/iter; left time: 1090.0570s
Epoch: 18 cost time: 13.354800462722778
Epoch: 18, Steps: 208 | Train Loss: 0.653 Vali Loss: 6.441 Vali Acc: 0.111 Test Loss: 6.441 Test Acc: 0.111
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.7385201
	speed: 0.2059s/iter; left time: 3492.1429s
	iters: 200, epoch: 19 | loss: 1.1209911
	speed: 0.0727s/iter; left time: 1225.6171s
Epoch: 19 cost time: 15.140575647354126
Epoch: 19, Steps: 208 | Train Loss: 0.598 Vali Loss: 6.827 Vali Acc: 0.109 Test Loss: 6.827 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 1.0309459
	speed: 0.1877s/iter; left time: 3143.7272s
	iters: 200, epoch: 20 | loss: 0.7283340
	speed: 0.0682s/iter; left time: 1134.9298s
Epoch: 20 cost time: 14.615149974822998
Epoch: 20, Steps: 208 | Train Loss: 0.527 Vali Loss: 7.025 Vali Acc: 0.108 Test Loss: 7.025 Test Acc: 0.108
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.3444625
	speed: 0.1866s/iter; left time: 3086.3814s
	iters: 200, epoch: 21 | loss: 0.7752235
	speed: 0.0657s/iter; left time: 1080.1252s
Epoch: 21 cost time: 14.063636541366577
Epoch: 21, Steps: 208 | Train Loss: 0.468 Vali Loss: 7.272 Vali Acc: 0.109 Test Loss: 7.272 Test Acc: 0.109
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.4504327
	speed: 0.1904s/iter; left time: 3109.3341s
	iters: 200, epoch: 22 | loss: 0.7443797
	speed: 0.0628s/iter; left time: 1019.9934s
Epoch: 22 cost time: 13.816285371780396
Epoch: 22, Steps: 208 | Train Loss: 0.445 Vali Loss: 7.829 Vali Acc: 0.109 Test Loss: 7.829 Test Acc: 0.109
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.2096208
	speed: 0.1910s/iter; left time: 3079.9816s
	iters: 200, epoch: 23 | loss: 0.0608958
	speed: 0.0633s/iter; left time: 1014.6651s
Epoch: 23 cost time: 13.409345865249634
Epoch: 23, Steps: 208 | Train Loss: 0.422 Vali Loss: 7.506 Vali Acc: 0.105 Test Loss: 7.506 Test Acc: 0.105
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.2528156
	speed: 0.1891s/iter; left time: 3010.2115s
	iters: 200, epoch: 24 | loss: 0.8085359
	speed: 0.0525s/iter; left time: 831.1624s
Epoch: 24 cost time: 13.033791780471802
Epoch: 24, Steps: 208 | Train Loss: 0.370 Vali Loss: 7.629 Vali Acc: 0.103 Test Loss: 7.629 Test Acc: 0.103
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1154190277363555
model parameter : 2664383
model size : 12.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.9402556
	speed: 0.0892s/iter; left time: 1847.1470s
	iters: 200, epoch: 1 | loss: 5.5553155
	speed: 0.0778s/iter; left time: 1603.0981s
Epoch: 1 cost time: 17.329635858535767
Epoch: 1, Steps: 208 | Train Loss: 4.974 Vali Loss: 5.721 Vali Acc: 0.047 Test Loss: 5.721 Test Acc: 0.047
Validation loss decreased (inf --> -0.047065).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.2132940
	speed: 0.2088s/iter; left time: 4279.8919s
	iters: 200, epoch: 2 | loss: 4.4669662
	speed: 0.0844s/iter; left time: 1722.1198s
Epoch: 2 cost time: 17.577322721481323
Epoch: 2, Steps: 208 | Train Loss: 4.720 Vali Loss: 4.314 Vali Acc: 0.026 Test Loss: 4.314 Test Acc: 0.026
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.7884145
	speed: 0.2013s/iter; left time: 4084.3605s
	iters: 200, epoch: 3 | loss: 4.4909120
	speed: 0.0674s/iter; left time: 1359.8845s
Epoch: 3 cost time: 15.400694131851196
Epoch: 3, Steps: 208 | Train Loss: 4.088 Vali Loss: 4.081 Vali Acc: 0.026 Test Loss: 4.081 Test Acc: 0.026
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 4.6501055
	speed: 0.1953s/iter; left time: 3921.1043s
	iters: 200, epoch: 4 | loss: 3.3691435
	speed: 0.0879s/iter; left time: 1755.0175s
Epoch: 4 cost time: 17.19552969932556
Epoch: 4, Steps: 208 | Train Loss: 4.020 Vali Loss: 3.961 Vali Acc: 0.035 Test Loss: 3.961 Test Acc: 0.035
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 3.6203198
	speed: 0.2080s/iter; left time: 4133.0289s
	iters: 200, epoch: 5 | loss: 3.6296003
	speed: 0.0595s/iter; left time: 1176.1940s
Epoch: 5 cost time: 15.425143718719482
Epoch: 5, Steps: 208 | Train Loss: 3.930 Vali Loss: 3.743 Vali Acc: 0.048 Test Loss: 3.743 Test Acc: 0.048
Validation loss decreased (-0.047065 --> -0.047979).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.7209005
	speed: 0.1955s/iter; left time: 3843.5758s
	iters: 200, epoch: 6 | loss: 4.1641192
	speed: 0.0809s/iter; left time: 1582.8423s
Epoch: 6 cost time: 16.667593717575073
Epoch: 6, Steps: 208 | Train Loss: 3.774 Vali Loss: 3.690 Vali Acc: 0.033 Test Loss: 3.690 Test Acc: 0.033
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.0993304
	speed: 0.2077s/iter; left time: 4040.4846s
	iters: 200, epoch: 7 | loss: 3.4152949
	speed: 0.0944s/iter; left time: 1827.0919s
Epoch: 7 cost time: 17.935157537460327
Epoch: 7, Steps: 208 | Train Loss: 3.772 Vali Loss: 3.808 Vali Acc: 0.046 Test Loss: 3.808 Test Acc: 0.046
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.7996652
	speed: 0.2234s/iter; left time: 4299.0295s
	iters: 200, epoch: 8 | loss: 3.6470773
	speed: 0.0693s/iter; left time: 1326.5946s
Epoch: 8 cost time: 15.740787267684937
Epoch: 8, Steps: 208 | Train Loss: 3.765 Vali Loss: 3.708 Vali Acc: 0.052 Test Loss: 3.708 Test Acc: 0.052
Validation loss decreased (-0.047979 --> -0.051559).  Saving model ...
	iters: 100, epoch: 9 | loss: 4.0273528
	speed: 0.2183s/iter; left time: 4155.7047s
	iters: 200, epoch: 9 | loss: 3.6887352
	speed: 0.0938s/iter; left time: 1775.8379s
Epoch: 9 cost time: 18.698908805847168
Epoch: 9, Steps: 208 | Train Loss: 3.688 Vali Loss: 3.579 Vali Acc: 0.059 Test Loss: 3.579 Test Acc: 0.059
Validation loss decreased (-0.051559 --> -0.058718).  Saving model ...
	iters: 100, epoch: 10 | loss: 3.4496098
	speed: 0.2359s/iter; left time: 4442.6127s
	iters: 200, epoch: 10 | loss: 3.9923279
	speed: 0.0838s/iter; left time: 1569.7532s
Epoch: 10 cost time: 19.332894563674927
Epoch: 10, Steps: 208 | Train Loss: 3.564 Vali Loss: 3.529 Vali Acc: 0.057 Test Loss: 3.529 Test Acc: 0.057
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 3.3915040
	speed: 0.2047s/iter; left time: 3810.9405s
	iters: 200, epoch: 11 | loss: 3.6183212
	speed: 0.0711s/iter; left time: 1317.6629s
Epoch: 11 cost time: 15.163250923156738
Epoch: 11, Steps: 208 | Train Loss: 3.475 Vali Loss: 3.551 Vali Acc: 0.049 Test Loss: 3.551 Test Acc: 0.049
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 3.4111583
	speed: 0.2073s/iter; left time: 3817.9304s
	iters: 200, epoch: 12 | loss: 3.3697019
	speed: 0.0817s/iter; left time: 1496.6919s
Epoch: 12 cost time: 17.22602367401123
Epoch: 12, Steps: 208 | Train Loss: 3.422 Vali Loss: 3.491 Vali Acc: 0.066 Test Loss: 3.491 Test Acc: 0.066
Validation loss decreased (-0.058718 --> -0.065578).  Saving model ...
	iters: 100, epoch: 13 | loss: 3.8460641
	speed: 0.2021s/iter; left time: 3678.8884s
	iters: 200, epoch: 13 | loss: 3.3248897
	speed: 0.0750s/iter; left time: 1357.2435s
Epoch: 13 cost time: 16.536620140075684
Epoch: 13, Steps: 208 | Train Loss: 3.375 Vali Loss: 3.460 Vali Acc: 0.062 Test Loss: 3.460 Test Acc: 0.062
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 3.2799096
	speed: 0.1922s/iter; left time: 3458.3768s
	iters: 200, epoch: 14 | loss: 3.2859004
	speed: 0.0714s/iter; left time: 1277.9175s
Epoch: 14 cost time: 15.47294545173645
Epoch: 14, Steps: 208 | Train Loss: 3.328 Vali Loss: 3.446 Vali Acc: 0.062 Test Loss: 3.446 Test Acc: 0.062
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 3.0314322
	speed: 0.1317s/iter; left time: 2343.1290s
	iters: 200, epoch: 15 | loss: 3.1394699
	speed: 0.0452s/iter; left time: 799.3793s
Epoch: 15 cost time: 8.860010147094727
Epoch: 15, Steps: 208 | Train Loss: 3.263 Vali Loss: 3.365 Vali Acc: 0.073 Test Loss: 3.365 Test Acc: 0.073
Validation loss decreased (-0.065578 --> -0.072737).  Saving model ...
	iters: 100, epoch: 16 | loss: 3.4209266
	speed: 0.1873s/iter; left time: 3292.4874s
	iters: 200, epoch: 16 | loss: 3.6258340
	speed: 0.0664s/iter; left time: 1160.5582s
Epoch: 16 cost time: 14.408459901809692
Epoch: 16, Steps: 208 | Train Loss: 3.207 Vali Loss: 3.393 Vali Acc: 0.074 Test Loss: 3.393 Test Acc: 0.074
Validation loss decreased (-0.072737 --> -0.074228).  Saving model ...
	iters: 100, epoch: 17 | loss: 2.7664077
	speed: 0.2067s/iter; left time: 3590.8752s
	iters: 200, epoch: 17 | loss: 3.6892431
	speed: 0.0862s/iter; left time: 1488.6186s
Epoch: 17 cost time: 18.146929264068604
Epoch: 17, Steps: 208 | Train Loss: 3.134 Vali Loss: 3.349 Vali Acc: 0.079 Test Loss: 3.349 Test Acc: 0.079
Validation loss decreased (-0.074228 --> -0.079000).  Saving model ...
	iters: 100, epoch: 18 | loss: 3.4138007
	speed: 0.1995s/iter; left time: 3424.9824s
	iters: 200, epoch: 18 | loss: 3.1288404
	speed: 0.0601s/iter; left time: 1025.4494s
Epoch: 18 cost time: 14.167138576507568
Epoch: 18, Steps: 208 | Train Loss: 3.088 Vali Loss: 3.284 Vali Acc: 0.094 Test Loss: 3.284 Test Acc: 0.094
Validation loss decreased (-0.079000 --> -0.093615).  Saving model ...
	iters: 100, epoch: 19 | loss: 2.8423648
	speed: 0.1971s/iter; left time: 3342.2586s
	iters: 200, epoch: 19 | loss: 3.3011539
	speed: 0.0819s/iter; left time: 1379.8246s
Epoch: 19 cost time: 16.132532358169556
Epoch: 19, Steps: 208 | Train Loss: 3.024 Vali Loss: 3.306 Vali Acc: 0.091 Test Loss: 3.306 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 2.6924348
	speed: 0.2076s/iter; left time: 3477.6679s
	iters: 200, epoch: 20 | loss: 3.0275483
	speed: 0.0808s/iter; left time: 1345.2792s
Epoch: 20 cost time: 17.32962918281555
Epoch: 20, Steps: 208 | Train Loss: 3.026 Vali Loss: 3.317 Vali Acc: 0.093 Test Loss: 3.317 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 3.3124416
	speed: 0.1852s/iter; left time: 3063.4777s
	iters: 200, epoch: 21 | loss: 3.0167599
	speed: 0.0725s/iter; left time: 1191.4031s
Epoch: 21 cost time: 14.82743501663208
Epoch: 21, Steps: 208 | Train Loss: 2.972 Vali Loss: 3.217 Vali Acc: 0.110 Test Loss: 3.217 Test Acc: 0.110
Validation loss decreased (-0.093615 --> -0.110317).  Saving model ...
	iters: 100, epoch: 22 | loss: 3.2093444
	speed: 0.2102s/iter; left time: 3433.1455s
	iters: 200, epoch: 22 | loss: 2.8554592
	speed: 0.0799s/iter; left time: 1296.3365s
Epoch: 22 cost time: 17.37513566017151
Epoch: 22, Steps: 208 | Train Loss: 2.951 Vali Loss: 3.283 Vali Acc: 0.098 Test Loss: 3.283 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 2.1977010
	speed: 0.2089s/iter; left time: 3369.0016s
	iters: 200, epoch: 23 | loss: 3.6115279
	speed: 0.0594s/iter; left time: 951.1135s
Epoch: 23 cost time: 14.258419513702393
Epoch: 23, Steps: 208 | Train Loss: 2.910 Vali Loss: 3.458 Vali Acc: 0.095 Test Loss: 3.458 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 2.7183354
	speed: 0.1814s/iter; left time: 2887.5906s
	iters: 200, epoch: 24 | loss: 2.9564931
	speed: 0.0739s/iter; left time: 1169.4744s
Epoch: 24 cost time: 13.370916366577148
Epoch: 24, Steps: 208 | Train Loss: 2.862 Vali Loss: 3.257 Vali Acc: 0.103 Test Loss: 3.257 Test Acc: 0.103
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 3.0411923
	speed: 0.2310s/iter; left time: 3629.5180s
	iters: 200, epoch: 25 | loss: 2.6181264
	speed: 0.0777s/iter; left time: 1212.9950s
Epoch: 25 cost time: 18.071130752563477
Epoch: 25, Steps: 208 | Train Loss: 2.840 Vali Loss: 3.348 Vali Acc: 0.099 Test Loss: 3.348 Test Acc: 0.099
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 2.2724054
	speed: 0.2082s/iter; left time: 3227.9119s
	iters: 200, epoch: 26 | loss: 2.8931272
	speed: 0.0852s/iter; left time: 1312.2169s
Epoch: 26 cost time: 16.769402503967285
Epoch: 26, Steps: 208 | Train Loss: 2.855 Vali Loss: 3.266 Vali Acc: 0.106 Test Loss: 3.266 Test Acc: 0.106
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 2.4820797
	speed: 0.2033s/iter; left time: 3109.4029s
	iters: 200, epoch: 27 | loss: 2.5583842
	speed: 0.0614s/iter; left time: 933.3503s
Epoch: 27 cost time: 15.068681955337524
Epoch: 27, Steps: 208 | Train Loss: 2.836 Vali Loss: 3.486 Vali Acc: 0.106 Test Loss: 3.486 Test Acc: 0.106
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 2.8867610
	speed: 0.2043s/iter; left time: 3081.3407s
	iters: 200, epoch: 28 | loss: 2.7157676
	speed: 0.0795s/iter; left time: 1191.6291s
Epoch: 28 cost time: 17.38736081123352
Epoch: 28, Steps: 208 | Train Loss: 2.781 Vali Loss: 3.366 Vali Acc: 0.108 Test Loss: 3.366 Test Acc: 0.108
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 3.0626941
	speed: 0.1997s/iter; left time: 2971.5322s
	iters: 200, epoch: 29 | loss: 2.7176168
	speed: 0.0722s/iter; left time: 1066.9421s
Epoch: 29 cost time: 16.001575708389282
Epoch: 29, Steps: 208 | Train Loss: 2.754 Vali Loss: 3.319 Vali Acc: 0.107 Test Loss: 3.319 Test Acc: 0.107
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 2.9514780
	speed: 0.2028s/iter; left time: 2975.3518s
	iters: 200, epoch: 30 | loss: 2.4110045
	speed: 0.0741s/iter; left time: 1079.1788s
Epoch: 30 cost time: 16.061792373657227
Epoch: 30, Steps: 208 | Train Loss: 2.753 Vali Loss: 3.400 Vali Acc: 0.109 Test Loss: 3.400 Test Acc: 0.109
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 2.9219849
	speed: 0.2116s/iter; left time: 3060.2413s
	iters: 200, epoch: 31 | loss: 2.6231470
	speed: 0.0762s/iter; left time: 1094.5936s
Epoch: 31 cost time: 16.859248161315918
Epoch: 31, Steps: 208 | Train Loss: 2.692 Vali Loss: 3.279 Vali Acc: 0.109 Test Loss: 3.279 Test Acc: 0.109
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1103489412466448
model parameter : 2276927
model size : 11.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.3641248
	speed: 0.0830s/iter; left time: 1717.6018s
	iters: 200, epoch: 1 | loss: 6.1174369
	speed: 0.0721s/iter; left time: 1484.3096s
Epoch: 1 cost time: 16.08545994758606
Epoch: 1, Steps: 208 | Train Loss: 5.083 Vali Loss: 6.346 Vali Acc: 0.051 Test Loss: 6.346 Test Acc: 0.051
Validation loss decreased (inf --> -0.051234).  Saving model ...
	iters: 100, epoch: 2 | loss: 5.6852856
	speed: 0.1788s/iter; left time: 3663.3012s
	iters: 200, epoch: 2 | loss: 4.3541203
	speed: 0.0595s/iter; left time: 1213.2102s
Epoch: 2 cost time: 12.980942010879517
Epoch: 2, Steps: 208 | Train Loss: 5.081 Vali Loss: 3.980 Vali Acc: 0.049 Test Loss: 3.980 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.4725718
	speed: 0.1862s/iter; left time: 3777.9904s
	iters: 200, epoch: 3 | loss: 4.0401263
	speed: 0.0600s/iter; left time: 1210.1383s
Epoch: 3 cost time: 13.509629964828491
Epoch: 3, Steps: 208 | Train Loss: 3.927 Vali Loss: 4.087 Vali Acc: 0.053 Test Loss: 4.087 Test Acc: 0.053
Validation loss decreased (-0.051234 --> -0.052748).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4662087
	speed: 0.1759s/iter; left time: 3530.9845s
	iters: 200, epoch: 4 | loss: 4.1286316
	speed: 0.0650s/iter; left time: 1297.7249s
Epoch: 4 cost time: 12.479870080947876
Epoch: 4, Steps: 208 | Train Loss: 3.676 Vali Loss: 3.742 Vali Acc: 0.049 Test Loss: 3.742 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.2695215
	speed: 0.1875s/iter; left time: 3724.7707s
	iters: 200, epoch: 5 | loss: 3.2220926
	speed: 0.0718s/iter; left time: 1419.3005s
Epoch: 5 cost time: 15.113110065460205
Epoch: 5, Steps: 208 | Train Loss: 3.445 Vali Loss: 3.457 Vali Acc: 0.061 Test Loss: 3.457 Test Acc: 0.061
Validation loss decreased (-0.052748 --> -0.060508).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0198879
	speed: 0.1895s/iter; left time: 3725.0538s
	iters: 200, epoch: 6 | loss: 2.8838308
	speed: 0.0579s/iter; left time: 1133.2888s
Epoch: 6 cost time: 13.236367225646973
Epoch: 6, Steps: 208 | Train Loss: 3.204 Vali Loss: 3.387 Vali Acc: 0.080 Test Loss: 3.387 Test Acc: 0.080
Validation loss decreased (-0.060508 --> -0.079895).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.1152556
	speed: 0.2004s/iter; left time: 3898.8177s
	iters: 200, epoch: 7 | loss: 2.8231096
	speed: 0.0673s/iter; left time: 1302.8006s
Epoch: 7 cost time: 14.4351224899292
Epoch: 7, Steps: 208 | Train Loss: 2.932 Vali Loss: 3.331 Vali Acc: 0.098 Test Loss: 3.331 Test Acc: 0.098
Validation loss decreased (-0.079895 --> -0.097790).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.8750019
	speed: 0.2118s/iter; left time: 4076.4579s
	iters: 200, epoch: 8 | loss: 2.4235148
	speed: 0.0772s/iter; left time: 1477.0976s
Epoch: 8 cost time: 15.829562425613403
Epoch: 8, Steps: 208 | Train Loss: 2.638 Vali Loss: 3.251 Vali Acc: 0.106 Test Loss: 3.251 Test Acc: 0.106
Validation loss decreased (-0.097790 --> -0.106141).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6317379
	speed: 0.2073s/iter; left time: 3946.8703s
	iters: 200, epoch: 9 | loss: 2.8146539
	speed: 0.0625s/iter; left time: 1183.4071s
Epoch: 9 cost time: 14.432849407196045
Epoch: 9, Steps: 208 | Train Loss: 2.198 Vali Loss: 3.440 Vali Acc: 0.119 Test Loss: 3.440 Test Acc: 0.119
Validation loss decreased (-0.106141 --> -0.118665).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5444540
	speed: 0.2058s/iter; left time: 3875.8801s
	iters: 200, epoch: 10 | loss: 1.8544308
	speed: 0.0653s/iter; left time: 1222.2103s
Epoch: 10 cost time: 14.471374988555908
Epoch: 10, Steps: 208 | Train Loss: 1.709 Vali Loss: 3.768 Vali Acc: 0.120 Test Loss: 3.768 Test Acc: 0.120
Validation loss decreased (-0.118665 --> -0.120451).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.0405316
	speed: 0.1900s/iter; left time: 3538.7892s
	iters: 200, epoch: 11 | loss: 1.8704884
	speed: 0.0490s/iter; left time: 907.5747s
Epoch: 11 cost time: 10.483656406402588
Epoch: 11, Steps: 208 | Train Loss: 1.192 Vali Loss: 4.806 Vali Acc: 0.118 Test Loss: 4.806 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.1579366
	speed: 0.1328s/iter; left time: 2444.4281s
	iters: 200, epoch: 12 | loss: 1.6820030
	speed: 0.0402s/iter; left time: 735.8510s
Epoch: 12 cost time: 8.756005764007568
Epoch: 12, Steps: 208 | Train Loss: 0.898 Vali Loss: 5.454 Vali Acc: 0.126 Test Loss: 5.454 Test Acc: 0.126
Validation loss decreased (-0.120451 --> -0.126399).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.5923111
	speed: 0.1830s/iter; left time: 3331.9375s
	iters: 200, epoch: 13 | loss: 1.0144324
	speed: 0.0720s/iter; left time: 1303.1232s
Epoch: 13 cost time: 14.530376195907593
Epoch: 13, Steps: 208 | Train Loss: 0.709 Vali Loss: 5.995 Vali Acc: 0.119 Test Loss: 5.995 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.3877474
	speed: 0.1812s/iter; left time: 3260.7304s
	iters: 200, epoch: 14 | loss: 0.5544907
	speed: 0.0588s/iter; left time: 1053.2032s
Epoch: 14 cost time: 13.319124698638916
Epoch: 14, Steps: 208 | Train Loss: 0.599 Vali Loss: 6.245 Vali Acc: 0.122 Test Loss: 6.245 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.8047833
	speed: 0.1869s/iter; left time: 3324.5394s
	iters: 200, epoch: 15 | loss: 0.6084752
	speed: 0.0641s/iter; left time: 1133.9143s
Epoch: 15 cost time: 13.612817764282227
Epoch: 15, Steps: 208 | Train Loss: 0.511 Vali Loss: 6.800 Vali Acc: 0.122 Test Loss: 6.800 Test Acc: 0.122
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.4960706
	speed: 0.1787s/iter; left time: 3142.2044s
	iters: 200, epoch: 16 | loss: 0.4943864
	speed: 0.0670s/iter; left time: 1172.0008s
Epoch: 16 cost time: 13.152787446975708
Epoch: 16, Steps: 208 | Train Loss: 0.428 Vali Loss: 8.039 Vali Acc: 0.109 Test Loss: 8.039 Test Acc: 0.109
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.6489534
	speed: 0.1986s/iter; left time: 3450.8955s
	iters: 200, epoch: 17 | loss: 0.3639981
	speed: 0.0629s/iter; left time: 1086.7502s
Epoch: 17 cost time: 14.660070180892944
Epoch: 17, Steps: 208 | Train Loss: 0.392 Vali Loss: 8.153 Vali Acc: 0.119 Test Loss: 8.153 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.3906600
	speed: 0.1839s/iter; left time: 3155.9789s
	iters: 200, epoch: 18 | loss: 0.3981250
	speed: 0.0536s/iter; left time: 914.5266s
Epoch: 18 cost time: 12.1340970993042
Epoch: 18, Steps: 208 | Train Loss: 0.379 Vali Loss: 7.731 Vali Acc: 0.123 Test Loss: 7.731 Test Acc: 0.123
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0840222
	speed: 0.1682s/iter; left time: 2852.4806s
	iters: 200, epoch: 19 | loss: 0.0270277
	speed: 0.0558s/iter; left time: 940.5135s
Epoch: 19 cost time: 11.047837734222412
Epoch: 19, Steps: 208 | Train Loss: 0.381 Vali Loss: 8.467 Vali Acc: 0.116 Test Loss: 8.467 Test Acc: 0.116
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.5324876
	speed: 0.1875s/iter; left time: 3140.4342s
	iters: 200, epoch: 20 | loss: 0.4694293
	speed: 0.0611s/iter; left time: 1017.3632s
Epoch: 20 cost time: 14.144632577896118
Epoch: 20, Steps: 208 | Train Loss: 0.310 Vali Loss: 9.279 Vali Acc: 0.118 Test Loss: 9.279 Test Acc: 0.118
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0921077
	speed: 0.1824s/iter; left time: 3017.8468s
	iters: 200, epoch: 21 | loss: 0.2734570
	speed: 0.0557s/iter; left time: 915.7967s
Epoch: 21 cost time: 12.269667148590088
Epoch: 21, Steps: 208 | Train Loss: 0.324 Vali Loss: 8.380 Vali Acc: 0.121 Test Loss: 8.380 Test Acc: 0.121
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0782589
	speed: 0.1943s/iter; left time: 3173.6982s
	iters: 200, epoch: 22 | loss: 0.9605593
	speed: 0.0707s/iter; left time: 1147.8584s
Epoch: 22 cost time: 14.663865089416504
Epoch: 22, Steps: 208 | Train Loss: 0.291 Vali Loss: 9.578 Vali Acc: 0.118 Test Loss: 9.578 Test Acc: 0.118
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12645392186101997
model parameter : 2274495
model size : 11.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 6.0383024
	speed: 0.0888s/iter; left time: 1838.9914s
	iters: 200, epoch: 1 | loss: 4.6434045
	speed: 0.0703s/iter; left time: 1449.1991s
Epoch: 1 cost time: 16.60347270965576
Epoch: 1, Steps: 208 | Train Loss: 4.885 Vali Loss: 6.530 Vali Acc: 0.036 Test Loss: 6.530 Test Acc: 0.036
Validation loss decreased (inf --> -0.036022).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.6898561
	speed: 0.1963s/iter; left time: 4023.0981s
	iters: 200, epoch: 2 | loss: 4.1236353
	speed: 0.0827s/iter; left time: 1686.5978s
Epoch: 2 cost time: 15.083744287490845
Epoch: 2, Steps: 208 | Train Loss: 4.784 Vali Loss: 4.236 Vali Acc: 0.047 Test Loss: 4.236 Test Acc: 0.047
Validation loss decreased (-0.036022 --> -0.046483).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.9220555
	speed: 0.2161s/iter; left time: 4383.6230s
	iters: 200, epoch: 3 | loss: 3.4090214
	speed: 0.0704s/iter; left time: 1421.7191s
Epoch: 3 cost time: 16.173237085342407
Epoch: 3, Steps: 208 | Train Loss: 4.102 Vali Loss: 3.931 Vali Acc: 0.044 Test Loss: 3.931 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 4.1377597
	speed: 0.2034s/iter; left time: 4083.7000s
	iters: 200, epoch: 4 | loss: 4.4913921
	speed: 0.0684s/iter; left time: 1366.2863s
Epoch: 4 cost time: 13.27389645576477
Epoch: 4, Steps: 208 | Train Loss: 3.998 Vali Loss: 3.923 Vali Acc: 0.030 Test Loss: 3.923 Test Acc: 0.030
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 4.1862769
	speed: 0.2004s/iter; left time: 3981.9742s
	iters: 200, epoch: 5 | loss: 4.0651550
	speed: 0.0670s/iter; left time: 1324.4895s
Epoch: 5 cost time: 14.26964545249939
Epoch: 5, Steps: 208 | Train Loss: 3.909 Vali Loss: 3.677 Vali Acc: 0.033 Test Loss: 3.677 Test Acc: 0.033
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 4.0297699
	speed: 0.1900s/iter; left time: 3735.7245s
	iters: 200, epoch: 6 | loss: 3.5912352
	speed: 0.0619s/iter; left time: 1210.8721s
Epoch: 6 cost time: 14.277278661727905
Epoch: 6, Steps: 208 | Train Loss: 3.739 Vali Loss: 3.826 Vali Acc: 0.030 Test Loss: 3.826 Test Acc: 0.030
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 3.4296861
	speed: 0.1767s/iter; left time: 3437.3426s
	iters: 200, epoch: 7 | loss: 3.7490191
	speed: 0.0567s/iter; left time: 1097.4691s
Epoch: 7 cost time: 12.325934410095215
Epoch: 7, Steps: 208 | Train Loss: 3.583 Vali Loss: 3.555 Vali Acc: 0.054 Test Loss: 3.555 Test Acc: 0.054
Validation loss decreased (-0.046483 --> -0.053648).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.0214276
	speed: 0.1843s/iter; left time: 3546.0723s
	iters: 200, epoch: 8 | loss: 3.6506941
	speed: 0.0684s/iter; left time: 1308.6313s
Epoch: 8 cost time: 14.385210037231445
Epoch: 8, Steps: 208 | Train Loss: 3.395 Vali Loss: 3.354 Vali Acc: 0.084 Test Loss: 3.354 Test Acc: 0.084
Validation loss decreased (-0.053648 --> -0.084368).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.2284079
	speed: 0.1926s/iter; left time: 3666.8940s
	iters: 200, epoch: 9 | loss: 3.1114602
	speed: 0.0471s/iter; left time: 891.7913s
Epoch: 9 cost time: 12.403169631958008
Epoch: 9, Steps: 208 | Train Loss: 3.187 Vali Loss: 3.236 Vali Acc: 0.090 Test Loss: 3.236 Test Acc: 0.090
Validation loss decreased (-0.084368 --> -0.089738).  Saving model ...
	iters: 100, epoch: 10 | loss: 3.4502902
	speed: 0.1801s/iter; left time: 3391.6403s
	iters: 200, epoch: 10 | loss: 2.8756287
	speed: 0.0673s/iter; left time: 1260.7074s
Epoch: 10 cost time: 13.364879608154297
Epoch: 10, Steps: 208 | Train Loss: 2.985 Vali Loss: 3.128 Vali Acc: 0.092 Test Loss: 3.128 Test Acc: 0.092
Validation loss decreased (-0.089738 --> -0.092423).  Saving model ...
	iters: 100, epoch: 11 | loss: 3.0076721
	speed: 0.1669s/iter; left time: 3108.3269s
	iters: 200, epoch: 11 | loss: 2.2269409
	speed: 0.0517s/iter; left time: 958.3893s
Epoch: 11 cost time: 10.80257797241211
Epoch: 11, Steps: 208 | Train Loss: 2.783 Vali Loss: 3.176 Vali Acc: 0.108 Test Loss: 3.176 Test Acc: 0.108
Validation loss decreased (-0.092423 --> -0.108229).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.3916073
	speed: 0.1261s/iter; left time: 2321.4491s
	iters: 200, epoch: 12 | loss: 2.6327908
	speed: 0.0481s/iter; left time: 881.3970s
Epoch: 12 cost time: 9.542253732681274
Epoch: 12, Steps: 208 | Train Loss: 2.567 Vali Loss: 3.221 Vali Acc: 0.115 Test Loss: 3.221 Test Acc: 0.115
Validation loss decreased (-0.108229 --> -0.115089).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.1111038
	speed: 0.1892s/iter; left time: 3443.8167s
	iters: 200, epoch: 13 | loss: 2.0892224
	speed: 0.0682s/iter; left time: 1234.2192s
Epoch: 13 cost time: 13.77314305305481
Epoch: 13, Steps: 208 | Train Loss: 2.241 Vali Loss: 3.424 Vali Acc: 0.118 Test Loss: 3.424 Test Acc: 0.118
Validation loss decreased (-0.115089 --> -0.117771).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.7362517
	speed: 0.1870s/iter; left time: 3364.9344s
	iters: 200, epoch: 14 | loss: 1.8851357
	speed: 0.0508s/iter; left time: 908.7726s
Epoch: 14 cost time: 12.506124019622803
Epoch: 14, Steps: 208 | Train Loss: 1.843 Vali Loss: 3.840 Vali Acc: 0.119 Test Loss: 3.840 Test Acc: 0.119
Validation loss decreased (-0.117771 --> -0.119258).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.0960121
	speed: 0.1888s/iter; left time: 3358.5030s
	iters: 200, epoch: 15 | loss: 1.7511785
	speed: 0.0704s/iter; left time: 1245.2674s
Epoch: 15 cost time: 14.272979736328125
Epoch: 15, Steps: 208 | Train Loss: 1.382 Vali Loss: 4.526 Vali Acc: 0.120 Test Loss: 4.526 Test Acc: 0.120
Validation loss decreased (-0.119258 --> -0.120444).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.7564577
	speed: 0.1915s/iter; left time: 3367.4793s
	iters: 200, epoch: 16 | loss: 1.1009187
	speed: 0.0609s/iter; left time: 1063.9611s
Epoch: 16 cost time: 13.674302339553833
Epoch: 16, Steps: 208 | Train Loss: 1.021 Vali Loss: 4.972 Vali Acc: 0.116 Test Loss: 4.972 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.9248893
	speed: 0.1859s/iter; left time: 3229.0876s
	iters: 200, epoch: 17 | loss: 0.8937391
	speed: 0.0561s/iter; left time: 968.3512s
Epoch: 17 cost time: 13.303634881973267
Epoch: 17, Steps: 208 | Train Loss: 0.805 Vali Loss: 5.870 Vali Acc: 0.116 Test Loss: 5.870 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.4270312
	speed: 0.1869s/iter; left time: 3208.7099s
	iters: 200, epoch: 18 | loss: 1.8311671
	speed: 0.0746s/iter; left time: 1273.5805s
Epoch: 18 cost time: 13.48026728630066
Epoch: 18, Steps: 208 | Train Loss: 0.676 Vali Loss: 6.349 Vali Acc: 0.128 Test Loss: 6.349 Test Acc: 0.128
Validation loss decreased (-0.120444 --> -0.127882).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.0086824
	speed: 0.2121s/iter; left time: 3595.7334s
	iters: 200, epoch: 19 | loss: 0.8823524
	speed: 0.0761s/iter; left time: 1282.3513s
Epoch: 19 cost time: 16.668055534362793
Epoch: 19, Steps: 208 | Train Loss: 0.597 Vali Loss: 6.834 Vali Acc: 0.125 Test Loss: 6.834 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.0506458
	speed: 0.2005s/iter; left time: 3357.7941s
	iters: 200, epoch: 20 | loss: 0.6080745
	speed: 0.0633s/iter; left time: 1054.6466s
Epoch: 20 cost time: 13.936285495758057
Epoch: 20, Steps: 208 | Train Loss: 0.503 Vali Loss: 7.533 Vali Acc: 0.122 Test Loss: 7.533 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.1441100
	speed: 0.2037s/iter; left time: 3368.6809s
	iters: 200, epoch: 21 | loss: 0.4257197
	speed: 0.0666s/iter; left time: 1094.6953s
Epoch: 21 cost time: 14.423007249832153
Epoch: 21, Steps: 208 | Train Loss: 0.474 Vali Loss: 8.408 Vali Acc: 0.116 Test Loss: 8.408 Test Acc: 0.116
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.8214884
	speed: 0.1942s/iter; left time: 3171.9764s
	iters: 200, epoch: 22 | loss: 1.0645720
	speed: 0.0611s/iter; left time: 992.4697s
Epoch: 22 cost time: 13.322856903076172
Epoch: 22, Steps: 208 | Train Loss: 0.442 Vali Loss: 7.258 Vali Acc: 0.117 Test Loss: 7.258 Test Acc: 0.117
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.1894451
	speed: 0.1814s/iter; left time: 2924.7758s
	iters: 200, epoch: 23 | loss: 0.6145070
	speed: 0.0666s/iter; left time: 1067.8573s
Epoch: 23 cost time: 13.655907154083252
Epoch: 23, Steps: 208 | Train Loss: 0.428 Vali Loss: 7.433 Vali Acc: 0.118 Test Loss: 7.433 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0248048
	speed: 0.1975s/iter; left time: 3143.8016s
	iters: 200, epoch: 24 | loss: 0.3587639
	speed: 0.0630s/iter; left time: 995.7180s
Epoch: 24 cost time: 14.328738927841187
Epoch: 24, Steps: 208 | Train Loss: 0.375 Vali Loss: 9.262 Vali Acc: 0.117 Test Loss: 9.262 Test Acc: 0.117
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.1041032
	speed: 0.1823s/iter; left time: 2863.0616s
	iters: 200, epoch: 25 | loss: 0.4819840
	speed: 0.0472s/iter; left time: 737.3367s
Epoch: 25 cost time: 11.729305744171143
Epoch: 25, Steps: 208 | Train Loss: 0.360 Vali Loss: 9.000 Vali Acc: 0.111 Test Loss: 9.000 Test Acc: 0.111
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.1966921
	speed: 0.1776s/iter; left time: 2753.3286s
	iters: 200, epoch: 26 | loss: 0.1973739
	speed: 0.0663s/iter; left time: 1021.0394s
Epoch: 26 cost time: 13.36060643196106
Epoch: 26, Steps: 208 | Train Loss: 0.329 Vali Loss: 9.328 Vali Acc: 0.114 Test Loss: 9.328 Test Acc: 0.114
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.2847278
	speed: 0.1908s/iter; left time: 2918.2212s
	iters: 200, epoch: 27 | loss: 0.2351936
	speed: 0.0662s/iter; left time: 1006.2983s
Epoch: 27 cost time: 14.460571050643921
Epoch: 27, Steps: 208 | Train Loss: 0.312 Vali Loss: 9.395 Vali Acc: 0.107 Test Loss: 9.395 Test Acc: 0.107
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.3531349
	speed: 0.1600s/iter; left time: 2413.9896s
	iters: 200, epoch: 28 | loss: 0.0142085
	speed: 0.0344s/iter; left time: 515.7715s
Epoch: 28 cost time: 8.72240161895752
Epoch: 28, Steps: 208 | Train Loss: 0.295 Vali Loss: 8.970 Vali Acc: 0.111 Test Loss: 8.970 Test Acc: 0.111
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12794512376975842
model parameter : 2272063
model size : 11.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.9667716
	speed: 0.0733s/iter; left time: 1518.3946s
	iters: 200, epoch: 1 | loss: 5.9418988
	speed: 0.0616s/iter; left time: 1268.7890s
Epoch: 1 cost time: 14.073689460754395
Epoch: 1, Steps: 208 | Train Loss: 4.990 Vali Loss: 5.584 Vali Acc: 0.053 Test Loss: 5.584 Test Acc: 0.053
Validation loss decreased (inf --> -0.052733).  Saving model ...
	iters: 100, epoch: 2 | loss: 5.6180305
	speed: 0.1925s/iter; left time: 3944.1558s
	iters: 200, epoch: 2 | loss: 4.4581513
	speed: 0.0568s/iter; left time: 1159.3418s
Epoch: 2 cost time: 13.449427127838135
Epoch: 2, Steps: 208 | Train Loss: 5.157 Vali Loss: 4.301 Vali Acc: 0.047 Test Loss: 4.301 Test Acc: 0.047
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.0470386
	speed: 0.1663s/iter; left time: 3374.3831s
	iters: 200, epoch: 3 | loss: 4.1888738
	speed: 0.0557s/iter; left time: 1124.2430s
Epoch: 3 cost time: 11.89456820487976
Epoch: 3, Steps: 208 | Train Loss: 3.937 Vali Loss: 3.795 Vali Acc: 0.051 Test Loss: 3.795 Test Acc: 0.051
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 3.8333871
	speed: 0.1679s/iter; left time: 3370.9486s
	iters: 200, epoch: 4 | loss: 3.1993876
	speed: 0.0688s/iter; left time: 1374.3059s
Epoch: 4 cost time: 13.240627527236938
Epoch: 4, Steps: 208 | Train Loss: 3.687 Vali Loss: 3.533 Vali Acc: 0.064 Test Loss: 3.533 Test Acc: 0.064
Validation loss decreased (-0.052733 --> -0.064086).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2638428
	speed: 0.1862s/iter; left time: 3699.6359s
	iters: 200, epoch: 5 | loss: 3.4013829
	speed: 0.0567s/iter; left time: 1120.0336s
Epoch: 5 cost time: 13.45830488204956
Epoch: 5, Steps: 208 | Train Loss: 3.354 Vali Loss: 3.535 Vali Acc: 0.069 Test Loss: 3.535 Test Acc: 0.069
Validation loss decreased (-0.064086 --> -0.068858).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.4487040
	speed: 0.1971s/iter; left time: 3875.4418s
	iters: 200, epoch: 6 | loss: 3.3220434
	speed: 0.0697s/iter; left time: 1363.1347s
Epoch: 6 cost time: 14.425165891647339
Epoch: 6, Steps: 208 | Train Loss: 3.157 Vali Loss: 3.332 Vali Acc: 0.083 Test Loss: 3.332 Test Acc: 0.083
Validation loss decreased (-0.068858 --> -0.082878).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.6605661
	speed: 0.1811s/iter; left time: 3522.9902s
	iters: 200, epoch: 7 | loss: 3.3450232
	speed: 0.0434s/iter; left time: 839.8383s
Epoch: 7 cost time: 10.722420930862427
Epoch: 7, Steps: 208 | Train Loss: 2.886 Vali Loss: 3.189 Vali Acc: 0.103 Test Loss: 3.189 Test Acc: 0.103
Validation loss decreased (-0.082878 --> -0.102861).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.5130074
	speed: 0.1370s/iter; left time: 2636.5924s
	iters: 200, epoch: 8 | loss: 2.7700169
	speed: 0.0581s/iter; left time: 1112.2209s
Epoch: 8 cost time: 10.035506010055542
Epoch: 8, Steps: 208 | Train Loss: 2.550 Vali Loss: 3.355 Vali Acc: 0.112 Test Loss: 3.355 Test Acc: 0.112
Validation loss decreased (-0.102861 --> -0.112403).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6909506
	speed: 0.2036s/iter; left time: 3876.5341s
	iters: 200, epoch: 9 | loss: 1.8082025
	speed: 0.0719s/iter; left time: 1361.3266s
Epoch: 9 cost time: 15.00150465965271
Epoch: 9, Steps: 208 | Train Loss: 2.109 Vali Loss: 3.614 Vali Acc: 0.114 Test Loss: 3.614 Test Acc: 0.114
Validation loss decreased (-0.112403 --> -0.114190).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5973797
	speed: 0.1937s/iter; left time: 3647.1705s
	iters: 200, epoch: 10 | loss: 2.0778639
	speed: 0.0624s/iter; left time: 1169.4685s
Epoch: 10 cost time: 13.334628820419312
Epoch: 10, Steps: 208 | Train Loss: 1.533 Vali Loss: 4.212 Vali Acc: 0.126 Test Loss: 4.212 Test Acc: 0.126
Validation loss decreased (-0.114190 --> -0.126114).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5069770
	speed: 0.1820s/iter; left time: 3389.3916s
	iters: 200, epoch: 11 | loss: 0.8337822
	speed: 0.0642s/iter; left time: 1189.7145s
Epoch: 11 cost time: 14.116845607757568
Epoch: 11, Steps: 208 | Train Loss: 1.084 Vali Loss: 5.394 Vali Acc: 0.120 Test Loss: 5.394 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.6497408
	speed: 0.1680s/iter; left time: 3092.9157s
	iters: 200, epoch: 12 | loss: 0.6640636
	speed: 0.0648s/iter; left time: 1186.3691s
Epoch: 12 cost time: 13.191013097763062
Epoch: 12, Steps: 208 | Train Loss: 0.842 Vali Loss: 6.252 Vali Acc: 0.118 Test Loss: 6.252 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.3814866
	speed: 0.1771s/iter; left time: 3223.3992s
	iters: 200, epoch: 13 | loss: 0.3837838
	speed: 0.0600s/iter; left time: 1085.9809s
Epoch: 13 cost time: 13.531677722930908
Epoch: 13, Steps: 208 | Train Loss: 0.659 Vali Loss: 6.583 Vali Acc: 0.114 Test Loss: 6.583 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.2070985
	speed: 0.1775s/iter; left time: 3195.1151s
	iters: 200, epoch: 14 | loss: 0.8953999
	speed: 0.0555s/iter; left time: 993.8960s
Epoch: 14 cost time: 12.3978431224823
Epoch: 14, Steps: 208 | Train Loss: 0.589 Vali Loss: 7.544 Vali Acc: 0.116 Test Loss: 7.544 Test Acc: 0.116
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.3855235
	speed: 0.1742s/iter; left time: 3098.0732s
	iters: 200, epoch: 15 | loss: 0.3386708
	speed: 0.0685s/iter; left time: 1212.2587s
Epoch: 15 cost time: 14.277385711669922
Epoch: 15, Steps: 208 | Train Loss: 0.513 Vali Loss: 7.785 Vali Acc: 0.120 Test Loss: 7.785 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.2285950
	speed: 0.1769s/iter; left time: 3110.1705s
	iters: 200, epoch: 16 | loss: 0.0599899
	speed: 0.0614s/iter; left time: 1072.4853s
Epoch: 16 cost time: 13.855385065078735
Epoch: 16, Steps: 208 | Train Loss: 0.449 Vali Loss: 8.660 Vali Acc: 0.117 Test Loss: 8.660 Test Acc: 0.117
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.2469780
	speed: 0.1735s/iter; left time: 3013.9334s
	iters: 200, epoch: 17 | loss: 0.2446385
	speed: 0.0546s/iter; left time: 942.4644s
Epoch: 17 cost time: 12.340749740600586
Epoch: 17, Steps: 208 | Train Loss: 0.401 Vali Loss: 8.092 Vali Acc: 0.122 Test Loss: 8.092 Test Acc: 0.122
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.3396713
	speed: 0.1726s/iter; left time: 2962.5356s
	iters: 200, epoch: 18 | loss: 0.1875550
	speed: 0.0657s/iter; left time: 1121.0440s
Epoch: 18 cost time: 13.272143840789795
Epoch: 18, Steps: 208 | Train Loss: 0.391 Vali Loss: 8.233 Vali Acc: 0.114 Test Loss: 8.233 Test Acc: 0.114
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.3053150
	speed: 0.1818s/iter; left time: 3082.7725s
	iters: 200, epoch: 19 | loss: 0.4490699
	speed: 0.0670s/iter; left time: 1129.9805s
Epoch: 19 cost time: 14.310735940933228
Epoch: 19, Steps: 208 | Train Loss: 0.341 Vali Loss: 8.346 Vali Acc: 0.115 Test Loss: 8.346 Test Acc: 0.115
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.1909922
	speed: 0.1758s/iter; left time: 2943.8903s
	iters: 200, epoch: 20 | loss: 0.3184884
	speed: 0.0577s/iter; left time: 960.4513s
Epoch: 20 cost time: 13.223294496536255
Epoch: 20, Steps: 208 | Train Loss: 0.339 Vali Loss: 8.327 Vali Acc: 0.104 Test Loss: 8.327 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12615568147927228
model parameter : 2269631
model size : 11.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.4901772
	speed: 0.0741s/iter; left time: 1533.6084s
	iters: 200, epoch: 1 | loss: 7.1245666
	speed: 0.0786s/iter; left time: 1618.4943s
Epoch: 1 cost time: 16.012582778930664
Epoch: 1, Steps: 208 | Train Loss: 4.987 Vali Loss: 5.487 Vali Acc: 0.039 Test Loss: 5.487 Test Acc: 0.039
Validation loss decreased (inf --> -0.039313).  Saving model ...
	iters: 100, epoch: 2 | loss: 6.4949727
	speed: 0.2039s/iter; left time: 4178.1299s
	iters: 200, epoch: 2 | loss: 4.7536244
	speed: 0.0748s/iter; left time: 1525.9398s
Epoch: 2 cost time: 16.518564701080322
Epoch: 2, Steps: 208 | Train Loss: 5.513 Vali Loss: 5.394 Vali Acc: 0.038 Test Loss: 5.394 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.0530515
	speed: 0.1983s/iter; left time: 4021.6034s
	iters: 200, epoch: 3 | loss: 3.9063108
	speed: 0.0880s/iter; left time: 1775.8083s
Epoch: 3 cost time: 17.78238272666931
Epoch: 3, Steps: 208 | Train Loss: 4.198 Vali Loss: 3.802 Vali Acc: 0.050 Test Loss: 3.802 Test Acc: 0.050
Validation loss decreased (-0.039313 --> -0.049470).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.1045942
	speed: 0.2119s/iter; left time: 4254.3845s
	iters: 200, epoch: 4 | loss: 3.2072918
	speed: 0.0784s/iter; left time: 1566.7937s
Epoch: 4 cost time: 16.60121464729309
Epoch: 4, Steps: 208 | Train Loss: 3.691 Vali Loss: 3.793 Vali Acc: 0.070 Test Loss: 3.793 Test Acc: 0.070
Validation loss decreased (-0.049470 --> -0.069750).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3188722
	speed: 0.2243s/iter; left time: 4456.5257s
	iters: 200, epoch: 5 | loss: 3.1671999
	speed: 0.0711s/iter; left time: 1405.1309s
Epoch: 5 cost time: 16.243624925613403
Epoch: 5, Steps: 208 | Train Loss: 3.357 Vali Loss: 3.537 Vali Acc: 0.086 Test Loss: 3.537 Test Acc: 0.086
Validation loss decreased (-0.069750 --> -0.085858).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.9351075
	speed: 0.2099s/iter; left time: 4125.9356s
	iters: 200, epoch: 6 | loss: 3.2917826
	speed: 0.0753s/iter; left time: 1473.0368s
Epoch: 6 cost time: 15.915114879608154
Epoch: 6, Steps: 208 | Train Loss: 3.120 Vali Loss: 3.303 Vali Acc: 0.086 Test Loss: 3.303 Test Acc: 0.086
Validation loss decreased (-0.085858 --> -0.086457).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.8170543
	speed: 0.1770s/iter; left time: 3442.9680s
	iters: 200, epoch: 7 | loss: 2.8648977
	speed: 0.0729s/iter; left time: 1410.4467s
Epoch: 7 cost time: 15.802687406539917
Epoch: 7, Steps: 208 | Train Loss: 2.841 Vali Loss: 3.265 Vali Acc: 0.115 Test Loss: 3.265 Test Acc: 0.115
Validation loss decreased (-0.086457 --> -0.114492).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.0448053
	speed: 0.1786s/iter; left time: 3436.4048s
	iters: 200, epoch: 8 | loss: 2.2728181
	speed: 0.0758s/iter; left time: 1450.8540s
Epoch: 8 cost time: 14.29797101020813
Epoch: 8, Steps: 208 | Train Loss: 2.465 Vali Loss: 3.506 Vali Acc: 0.113 Test Loss: 3.506 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.2582495
	speed: 0.1917s/iter; left time: 3650.0768s
	iters: 200, epoch: 9 | loss: 2.1794035
	speed: 0.0777s/iter; left time: 1472.0946s
Epoch: 9 cost time: 16.706817388534546
Epoch: 9, Steps: 208 | Train Loss: 2.026 Vali Loss: 3.713 Vali Acc: 0.120 Test Loss: 3.713 Test Acc: 0.120
Validation loss decreased (-0.114492 --> -0.120154).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.0700520
	speed: 0.1913s/iter; left time: 3602.4091s
	iters: 200, epoch: 10 | loss: 1.2608881
	speed: 0.0824s/iter; left time: 1543.6858s
Epoch: 10 cost time: 16.7456316947937
Epoch: 10, Steps: 208 | Train Loss: 1.518 Vali Loss: 4.701 Vali Acc: 0.114 Test Loss: 4.701 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.9484670
	speed: 0.2002s/iter; left time: 3727.0322s
	iters: 200, epoch: 11 | loss: 1.3215947
	speed: 0.0685s/iter; left time: 1269.3348s
Epoch: 11 cost time: 14.972925424575806
Epoch: 11, Steps: 208 | Train Loss: 1.116 Vali Loss: 5.110 Vali Acc: 0.107 Test Loss: 5.110 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.3145714
	speed: 0.1914s/iter; left time: 3524.3823s
	iters: 200, epoch: 12 | loss: 0.9275895
	speed: 0.0770s/iter; left time: 1409.9449s
Epoch: 12 cost time: 15.97532057762146
Epoch: 12, Steps: 208 | Train Loss: 0.846 Vali Loss: 6.203 Vali Acc: 0.114 Test Loss: 6.203 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.4586382
	speed: 0.1954s/iter; left time: 3557.7343s
	iters: 200, epoch: 13 | loss: 1.3610773
	speed: 0.0704s/iter; left time: 1275.4197s
Epoch: 13 cost time: 15.672841787338257
Epoch: 13, Steps: 208 | Train Loss: 0.697 Vali Loss: 6.493 Vali Acc: 0.113 Test Loss: 6.493 Test Acc: 0.113
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.8020606
	speed: 0.1391s/iter; left time: 2502.9720s
	iters: 200, epoch: 14 | loss: 0.3423246
	speed: 0.0341s/iter; left time: 610.1088s
Epoch: 14 cost time: 8.681107997894287
Epoch: 14, Steps: 208 | Train Loss: 0.572 Vali Loss: 6.831 Vali Acc: 0.119 Test Loss: 6.831 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.5707110
	speed: 0.1863s/iter; left time: 3314.2816s
	iters: 200, epoch: 15 | loss: 1.0123302
	speed: 0.0715s/iter; left time: 1264.4732s
Epoch: 15 cost time: 15.719802379608154
Epoch: 15, Steps: 208 | Train Loss: 0.492 Vali Loss: 8.094 Vali Acc: 0.115 Test Loss: 8.094 Test Acc: 0.115
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.4885053
	speed: 0.1805s/iter; left time: 3172.8083s
	iters: 200, epoch: 16 | loss: 0.1872364
	speed: 0.0725s/iter; left time: 1267.1143s
Epoch: 16 cost time: 14.182278871536255
Epoch: 16, Steps: 208 | Train Loss: 0.405 Vali Loss: 8.351 Vali Acc: 0.119 Test Loss: 8.351 Test Acc: 0.119
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.2731177
	speed: 0.1942s/iter; left time: 3373.7016s
	iters: 200, epoch: 17 | loss: 0.2052336
	speed: 0.0772s/iter; left time: 1333.1199s
Epoch: 17 cost time: 16.95343565940857
Epoch: 17, Steps: 208 | Train Loss: 0.368 Vali Loss: 8.610 Vali Acc: 0.116 Test Loss: 8.610 Test Acc: 0.116
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.4570396
	speed: 0.1951s/iter; left time: 3349.4978s
	iters: 200, epoch: 18 | loss: 0.1479463
	speed: 0.0710s/iter; left time: 1211.4646s
Epoch: 18 cost time: 15.204780101776123
Epoch: 18, Steps: 208 | Train Loss: 0.342 Vali Loss: 8.996 Vali Acc: 0.114 Test Loss: 8.996 Test Acc: 0.114
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.3666593
	speed: 0.2063s/iter; left time: 3497.4605s
	iters: 200, epoch: 19 | loss: 0.2241659
	speed: 0.0854s/iter; left time: 1439.6585s
Epoch: 19 cost time: 16.930532932281494
Epoch: 19, Steps: 208 | Train Loss: 0.321 Vali Loss: 8.920 Vali Acc: 0.124 Test Loss: 8.920 Test Acc: 0.124
Validation loss decreased (-0.120154 --> -0.123681).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.3753945
	speed: 0.2273s/iter; left time: 3806.3386s
	iters: 200, epoch: 20 | loss: 0.6491665
	speed: 0.0717s/iter; left time: 1194.1561s
Epoch: 20 cost time: 17.443437814712524
Epoch: 20, Steps: 208 | Train Loss: 0.288 Vali Loss: 7.731 Vali Acc: 0.107 Test Loss: 7.731 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0682459
	speed: 0.1929s/iter; left time: 3191.2691s
	iters: 200, epoch: 21 | loss: 0.2994501
	speed: 0.0799s/iter; left time: 1313.7027s
Epoch: 21 cost time: 15.128962993621826
Epoch: 21, Steps: 208 | Train Loss: 0.272 Vali Loss: 8.863 Vali Acc: 0.116 Test Loss: 8.863 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.1514681
	speed: 0.2305s/iter; left time: 3764.2123s
	iters: 200, epoch: 22 | loss: 0.1128016
	speed: 0.0764s/iter; left time: 1240.9050s
Epoch: 22 cost time: 18.64737319946289
Epoch: 22, Steps: 208 | Train Loss: 0.269 Vali Loss: 8.603 Vali Acc: 0.109 Test Loss: 8.603 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.1891496
	speed: 0.1754s/iter; left time: 2827.7083s
	iters: 200, epoch: 23 | loss: 0.0227471
	speed: 0.0792s/iter; left time: 1269.2189s
Epoch: 23 cost time: 14.693391799926758
Epoch: 23, Steps: 208 | Train Loss: 0.231 Vali Loss: 9.535 Vali Acc: 0.116 Test Loss: 9.535 Test Acc: 0.116
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.4673453
	speed: 0.1996s/iter; left time: 3176.7228s
	iters: 200, epoch: 24 | loss: 0.0023974
	speed: 0.0593s/iter; left time: 938.3856s
Epoch: 24 cost time: 14.690730094909668
Epoch: 24, Steps: 208 | Train Loss: 0.252 Vali Loss: 9.313 Vali Acc: 0.112 Test Loss: 9.313 Test Acc: 0.112
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.5711706
	speed: 0.1972s/iter; left time: 3098.1106s
	iters: 200, epoch: 25 | loss: 0.7576334
	speed: 0.0810s/iter; left time: 1264.2226s
Epoch: 25 cost time: 16.551034212112427
Epoch: 25, Steps: 208 | Train Loss: 0.232 Vali Loss: 8.797 Vali Acc: 0.113 Test Loss: 8.797 Test Acc: 0.113
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.3013446
	speed: 0.1959s/iter; left time: 3036.4840s
	iters: 200, epoch: 26 | loss: 0.7757357
	speed: 0.0629s/iter; left time: 968.9810s
Epoch: 26 cost time: 15.042412281036377
Epoch: 26, Steps: 208 | Train Loss: 0.221 Vali Loss: 9.453 Vali Acc: 0.112 Test Loss: 9.453 Test Acc: 0.112
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.1395489
	speed: 0.2006s/iter; left time: 3068.5288s
	iters: 200, epoch: 27 | loss: 0.0707368
	speed: 0.0720s/iter; left time: 1093.2850s
Epoch: 27 cost time: 16.045761585235596
Epoch: 27, Steps: 208 | Train Loss: 0.219 Vali Loss: 9.475 Vali Acc: 0.112 Test Loss: 9.475 Test Acc: 0.112
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.3929564
	speed: 0.1837s/iter; left time: 2770.6059s
	iters: 200, epoch: 28 | loss: 0.2219829
	speed: 0.0761s/iter; left time: 1139.9859s
Epoch: 28 cost time: 14.176088094711304
Epoch: 28, Steps: 208 | Train Loss: 0.202 Vali Loss: 10.110 Vali Acc: 0.110 Test Loss: 10.110 Test Acc: 0.110
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0245445
	speed: 0.1991s/iter; left time: 2962.2013s
	iters: 200, epoch: 29 | loss: 0.0149929
	speed: 0.0719s/iter; left time: 1061.9869s
Epoch: 29 cost time: 15.887531042098999
Epoch: 29, Steps: 208 | Train Loss: 0.194 Vali Loss: 9.705 Vali Acc: 0.117 Test Loss: 9.705 Test Acc: 0.117
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12376975842529078
model parameter : 2079551
model size : 10.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1955709
	speed: 0.0702s/iter; left time: 1453.3001s
	iters: 200, epoch: 1 | loss: 6.9577227
	speed: 0.0555s/iter; left time: 1143.5018s
Epoch: 1 cost time: 13.080156564712524
Epoch: 1, Steps: 208 | Train Loss: 4.892 Vali Loss: 5.868 Vali Acc: 0.041 Test Loss: 5.868 Test Acc: 0.041
Validation loss decreased (inf --> -0.041098).  Saving model ...
	iters: 100, epoch: 2 | loss: 6.7626805
	speed: 0.1726s/iter; left time: 3536.3945s
	iters: 200, epoch: 2 | loss: 6.9274759
	speed: 0.0655s/iter; left time: 1334.9908s
Epoch: 2 cost time: 13.414703369140625
Epoch: 2, Steps: 208 | Train Loss: 5.981 Vali Loss: 7.089 Vali Acc: 0.036 Test Loss: 7.089 Test Acc: 0.036
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 5.5366483
	speed: 0.1721s/iter; left time: 3490.8030s
	iters: 200, epoch: 3 | loss: 4.2910509
	speed: 0.0592s/iter; left time: 1194.2319s
Epoch: 3 cost time: 12.998496055603027
Epoch: 3, Steps: 208 | Train Loss: 4.793 Vali Loss: 4.353 Vali Acc: 0.037 Test Loss: 4.353 Test Acc: 0.037
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 4.1021023
	speed: 0.1572s/iter; left time: 3155.8101s
	iters: 200, epoch: 4 | loss: 3.2328780
	speed: 0.0439s/iter; left time: 877.3959s
Epoch: 4 cost time: 9.819575071334839
Epoch: 4, Steps: 208 | Train Loss: 3.838 Vali Loss: 4.024 Vali Acc: 0.056 Test Loss: 4.024 Test Acc: 0.056
Validation loss decreased (-0.041098 --> -0.056327).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.7578137
	speed: 0.1673s/iter; left time: 3324.3878s
	iters: 200, epoch: 5 | loss: 2.9194586
	speed: 0.0633s/iter; left time: 1250.8357s
Epoch: 5 cost time: 13.95083498954773
Epoch: 5, Steps: 208 | Train Loss: 3.401 Vali Loss: 3.553 Vali Acc: 0.076 Test Loss: 3.553 Test Acc: 0.076
Validation loss decreased (-0.056327 --> -0.075718).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.8643541
	speed: 0.1911s/iter; left time: 3757.5884s
	iters: 200, epoch: 6 | loss: 2.9702649
	speed: 0.0558s/iter; left time: 1092.1656s
Epoch: 6 cost time: 12.83540940284729
Epoch: 6, Steps: 208 | Train Loss: 3.159 Vali Loss: 3.379 Vali Acc: 0.100 Test Loss: 3.379 Test Acc: 0.100
Validation loss decreased (-0.075718 --> -0.100175).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.0284624
	speed: 0.2089s/iter; left time: 4063.0223s
	iters: 200, epoch: 7 | loss: 3.1025531
	speed: 0.0809s/iter; left time: 1566.1878s
Epoch: 7 cost time: 16.075628519058228
Epoch: 7, Steps: 208 | Train Loss: 2.924 Vali Loss: 3.289 Vali Acc: 0.102 Test Loss: 3.289 Test Acc: 0.102
Validation loss decreased (-0.100175 --> -0.102264).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.4800875
	speed: 0.1964s/iter; left time: 3779.9927s
	iters: 200, epoch: 8 | loss: 2.8621252
	speed: 0.0469s/iter; left time: 898.7771s
Epoch: 8 cost time: 13.446340322494507
Epoch: 8, Steps: 208 | Train Loss: 2.531 Vali Loss: 3.510 Vali Acc: 0.103 Test Loss: 3.510 Test Acc: 0.103
Validation loss decreased (-0.102264 --> -0.102560).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.0349503
	speed: 0.1910s/iter; left time: 3636.7862s
	iters: 200, epoch: 9 | loss: 2.5577629
	speed: 0.0493s/iter; left time: 933.5728s
Epoch: 9 cost time: 11.882606506347656
Epoch: 9, Steps: 208 | Train Loss: 2.074 Vali Loss: 3.648 Vali Acc: 0.104 Test Loss: 3.648 Test Acc: 0.104
Validation loss decreased (-0.102560 --> -0.104049).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.3726352
	speed: 0.1203s/iter; left time: 2265.9291s
	iters: 200, epoch: 10 | loss: 1.4972147
	speed: 0.0282s/iter; left time: 528.1309s
Epoch: 10 cost time: 6.624637603759766
Epoch: 10, Steps: 208 | Train Loss: 1.544 Vali Loss: 4.314 Vali Acc: 0.117 Test Loss: 4.314 Test Acc: 0.117
Validation loss decreased (-0.104049 --> -0.117165).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.0083714
	speed: 0.1665s/iter; left time: 3099.5787s
	iters: 200, epoch: 11 | loss: 1.6404451
	speed: 0.0589s/iter; left time: 1090.8310s
Epoch: 11 cost time: 12.639481782913208
Epoch: 11, Steps: 208 | Train Loss: 1.096 Vali Loss: 5.366 Vali Acc: 0.117 Test Loss: 5.366 Test Acc: 0.117
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.6573715
	speed: 0.1673s/iter; left time: 3080.7603s
	iters: 200, epoch: 12 | loss: 1.1063958
	speed: 0.0682s/iter; left time: 1249.4180s
Epoch: 12 cost time: 13.547425508499146
Epoch: 12, Steps: 208 | Train Loss: 0.784 Vali Loss: 5.659 Vali Acc: 0.123 Test Loss: 5.659 Test Acc: 0.123
Validation loss decreased (-0.117165 --> -0.122520).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.6482574
	speed: 0.1764s/iter; left time: 3212.2566s
	iters: 200, epoch: 13 | loss: 0.2188629
	speed: 0.0547s/iter; left time: 990.0768s
Epoch: 13 cost time: 12.093538045883179
Epoch: 13, Steps: 208 | Train Loss: 0.691 Vali Loss: 6.202 Vali Acc: 0.112 Test Loss: 6.202 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.7487030
	speed: 0.1723s/iter; left time: 3101.6663s
	iters: 200, epoch: 14 | loss: 0.7266775
	speed: 0.0636s/iter; left time: 1137.6245s
Epoch: 14 cost time: 12.99755072593689
Epoch: 14, Steps: 208 | Train Loss: 0.536 Vali Loss: 7.211 Vali Acc: 0.121 Test Loss: 7.211 Test Acc: 0.121
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.8999624
	speed: 0.1776s/iter; left time: 3159.3167s
	iters: 200, epoch: 15 | loss: 0.9057723
	speed: 0.0481s/iter; left time: 850.1265s
Epoch: 15 cost time: 12.386982440948486
Epoch: 15, Steps: 208 | Train Loss: 0.488 Vali Loss: 6.749 Vali Acc: 0.118 Test Loss: 6.749 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.4806735
	speed: 0.1644s/iter; left time: 2890.2262s
	iters: 200, epoch: 16 | loss: 0.0636432
	speed: 0.0619s/iter; left time: 1081.9155s
Epoch: 16 cost time: 12.764510869979858
Epoch: 16, Steps: 208 | Train Loss: 0.407 Vali Loss: 8.238 Vali Acc: 0.116 Test Loss: 8.238 Test Acc: 0.116
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.2949710
	speed: 0.1690s/iter; left time: 2935.7419s
	iters: 200, epoch: 17 | loss: 0.2850682
	speed: 0.0605s/iter; left time: 1045.6513s
Epoch: 17 cost time: 12.237905263900757
Epoch: 17, Steps: 208 | Train Loss: 0.393 Vali Loss: 7.373 Vali Acc: 0.112 Test Loss: 7.373 Test Acc: 0.112
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.3387464
	speed: 0.1745s/iter; left time: 2994.9053s
	iters: 200, epoch: 18 | loss: 0.1018783
	speed: 0.0553s/iter; left time: 943.2936s
Epoch: 18 cost time: 12.614486455917358
Epoch: 18, Steps: 208 | Train Loss: 0.375 Vali Loss: 7.482 Vali Acc: 0.116 Test Loss: 7.482 Test Acc: 0.116
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.1270070
	speed: 0.1787s/iter; left time: 3030.4966s
	iters: 200, epoch: 19 | loss: 0.3136992
	speed: 0.0645s/iter; left time: 1087.7667s
Epoch: 19 cost time: 13.112181663513184
Epoch: 19, Steps: 208 | Train Loss: 0.311 Vali Loss: 8.503 Vali Acc: 0.102 Test Loss: 8.503 Test Acc: 0.102
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0680445
	speed: 0.1705s/iter; left time: 2855.4691s
	iters: 200, epoch: 20 | loss: 0.6562577
	speed: 0.0571s/iter; left time: 950.6087s
Epoch: 20 cost time: 12.976437330245972
Epoch: 20, Steps: 208 | Train Loss: 0.333 Vali Loss: 8.109 Vali Acc: 0.108 Test Loss: 8.109 Test Acc: 0.108
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.1644331
	speed: 0.1704s/iter; left time: 2818.2524s
	iters: 200, epoch: 21 | loss: 0.0512648
	speed: 0.0667s/iter; left time: 1095.8467s
Epoch: 21 cost time: 12.960055589675903
Epoch: 21, Steps: 208 | Train Loss: 0.285 Vali Loss: 8.447 Vali Acc: 0.104 Test Loss: 8.447 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.9034261
	speed: 0.2020s/iter; left time: 3299.0060s
	iters: 200, epoch: 22 | loss: 0.2272022
	speed: 0.0522s/iter; left time: 847.5165s
Epoch: 22 cost time: 13.423250675201416
Epoch: 22, Steps: 208 | Train Loss: 0.254 Vali Loss: 9.319 Vali Acc: 0.111 Test Loss: 9.319 Test Acc: 0.111
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12257679689830003
model parameter : 2077119
model size : 10.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.8406000
	speed: 0.0763s/iter; left time: 1579.4938s
	iters: 200, epoch: 1 | loss: 5.3419676
	speed: 0.0707s/iter; left time: 1456.0628s
Epoch: 1 cost time: 15.318082332611084
Epoch: 1, Steps: 208 | Train Loss: 5.054 Vali Loss: 6.944 Vali Acc: 0.044 Test Loss: 6.944 Test Acc: 0.044
Validation loss decreased (inf --> -0.043772).  Saving model ...
	iters: 100, epoch: 2 | loss: 7.6280413
	speed: 0.1889s/iter; left time: 3871.2842s
	iters: 200, epoch: 2 | loss: 4.7350664
	speed: 0.0510s/iter; left time: 1039.4215s
Epoch: 2 cost time: 13.159256219863892
Epoch: 2, Steps: 208 | Train Loss: 5.585 Vali Loss: 4.623 Vali Acc: 0.047 Test Loss: 4.623 Test Acc: 0.047
Validation loss decreased (-0.043772 --> -0.046778).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.5436316
	speed: 0.1768s/iter; left time: 3587.0672s
	iters: 200, epoch: 3 | loss: 4.1573110
	speed: 0.0594s/iter; left time: 1198.5985s
Epoch: 3 cost time: 11.775299787521362
Epoch: 3, Steps: 208 | Train Loss: 4.349 Vali Loss: 4.684 Vali Acc: 0.027 Test Loss: 4.684 Test Acc: 0.027
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 4.2416887
	speed: 0.1670s/iter; left time: 3351.9152s
	iters: 200, epoch: 4 | loss: 4.4943705
	speed: 0.0650s/iter; left time: 1298.1896s
Epoch: 4 cost time: 13.091672420501709
Epoch: 4, Steps: 208 | Train Loss: 4.128 Vali Loss: 4.011 Vali Acc: 0.050 Test Loss: 4.011 Test Acc: 0.050
Validation loss decreased (-0.046778 --> -0.050064).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.7428992
	speed: 0.1806s/iter; left time: 3588.9663s
	iters: 200, epoch: 5 | loss: 3.9855657
	speed: 0.0612s/iter; left time: 1209.6913s
Epoch: 5 cost time: 13.386977195739746
Epoch: 5, Steps: 208 | Train Loss: 3.936 Vali Loss: 3.914 Vali Acc: 0.044 Test Loss: 3.914 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.4031560
	speed: 0.1711s/iter; left time: 3364.3477s
	iters: 200, epoch: 6 | loss: 3.9705412
	speed: 0.0607s/iter; left time: 1187.6742s
Epoch: 6 cost time: 13.108065843582153
Epoch: 6, Steps: 208 | Train Loss: 3.780 Vali Loss: 3.816 Vali Acc: 0.046 Test Loss: 3.816 Test Acc: 0.046
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 3.7387838
	speed: 0.1738s/iter; left time: 3381.3747s
	iters: 200, epoch: 7 | loss: 3.7035971
	speed: 0.0527s/iter; left time: 1019.9210s
Epoch: 7 cost time: 12.458767652511597
Epoch: 7, Steps: 208 | Train Loss: 3.725 Vali Loss: 3.702 Vali Acc: 0.043 Test Loss: 3.702 Test Acc: 0.043
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 3.6373713
	speed: 0.1664s/iter; left time: 3203.0372s
	iters: 200, epoch: 8 | loss: 3.9117210
	speed: 0.0547s/iter; left time: 1047.8442s
Epoch: 8 cost time: 11.764644622802734
Epoch: 8, Steps: 208 | Train Loss: 3.662 Vali Loss: 3.647 Vali Acc: 0.051 Test Loss: 3.647 Test Acc: 0.051
Validation loss decreased (-0.050064 --> -0.051261).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.9716442
	speed: 0.1758s/iter; left time: 3346.2037s
	iters: 200, epoch: 9 | loss: 3.6730239
	speed: 0.0666s/iter; left time: 1261.2379s
Epoch: 9 cost time: 13.915498733520508
Epoch: 9, Steps: 208 | Train Loss: 3.589 Vali Loss: 3.620 Vali Acc: 0.051 Test Loss: 3.620 Test Acc: 0.051
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 3.7133479
	speed: 0.1634s/iter; left time: 3076.4040s
	iters: 200, epoch: 10 | loss: 3.6267605
	speed: 0.0553s/iter; left time: 1036.5805s
Epoch: 10 cost time: 12.129726648330688
Epoch: 10, Steps: 208 | Train Loss: 3.543 Vali Loss: 3.685 Vali Acc: 0.053 Test Loss: 3.685 Test Acc: 0.053
Validation loss decreased (-0.051261 --> -0.053050).  Saving model ...
	iters: 100, epoch: 11 | loss: 3.4128416
	speed: 0.1753s/iter; left time: 3264.9519s
	iters: 200, epoch: 11 | loss: 3.7779458
	speed: 0.0623s/iter; left time: 1153.5590s
Epoch: 11 cost time: 13.13618016242981
Epoch: 11, Steps: 208 | Train Loss: 3.510 Vali Loss: 3.564 Vali Acc: 0.056 Test Loss: 3.564 Test Acc: 0.056
Validation loss decreased (-0.053050 --> -0.056332).  Saving model ...
	iters: 100, epoch: 12 | loss: 3.6283731
	speed: 0.1398s/iter; left time: 2573.2603s
	iters: 200, epoch: 12 | loss: 3.6900334
	speed: 0.0296s/iter; left time: 541.3698s
Epoch: 12 cost time: 6.521483421325684
Epoch: 12, Steps: 208 | Train Loss: 3.430 Vali Loss: 3.576 Vali Acc: 0.059 Test Loss: 3.576 Test Acc: 0.059
Validation loss decreased (-0.056332 --> -0.059016).  Saving model ...
	iters: 100, epoch: 13 | loss: 3.3761897
	speed: 0.1455s/iter; left time: 2648.1841s
	iters: 200, epoch: 13 | loss: 3.7227306
	speed: 0.0625s/iter; left time: 1131.5798s
Epoch: 13 cost time: 11.868393421173096
Epoch: 13, Steps: 208 | Train Loss: 3.409 Vali Loss: 3.533 Vali Acc: 0.067 Test Loss: 3.533 Test Acc: 0.067
Validation loss decreased (-0.059016 --> -0.067069).  Saving model ...
	iters: 100, epoch: 14 | loss: 3.1818075
	speed: 0.1751s/iter; left time: 3151.3524s
	iters: 200, epoch: 14 | loss: 3.4948320
	speed: 0.0574s/iter; left time: 1027.8255s
Epoch: 14 cost time: 12.469383478164673
Epoch: 14, Steps: 208 | Train Loss: 3.401 Vali Loss: 3.471 Vali Acc: 0.071 Test Loss: 3.471 Test Acc: 0.071
Validation loss decreased (-0.067069 --> -0.071245).  Saving model ...
	iters: 100, epoch: 15 | loss: 3.4922833
	speed: 0.1600s/iter; left time: 2847.0845s
	iters: 200, epoch: 15 | loss: 2.8831246
	speed: 0.0650s/iter; left time: 1149.9495s
Epoch: 15 cost time: 12.29832673072815
Epoch: 15, Steps: 208 | Train Loss: 3.318 Vali Loss: 3.499 Vali Acc: 0.059 Test Loss: 3.499 Test Acc: 0.059
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 3.1114638
	speed: 0.1909s/iter; left time: 3356.4893s
	iters: 200, epoch: 16 | loss: 3.3054407
	speed: 0.0633s/iter; left time: 1105.8663s
Epoch: 16 cost time: 14.261417150497437
Epoch: 16, Steps: 208 | Train Loss: 3.279 Vali Loss: 3.466 Vali Acc: 0.070 Test Loss: 3.466 Test Acc: 0.070
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 3.0159388
	speed: 0.1790s/iter; left time: 3110.4776s
	iters: 200, epoch: 17 | loss: 2.9718971
	speed: 0.0693s/iter; left time: 1196.8379s
Epoch: 17 cost time: 13.550878763198853
Epoch: 17, Steps: 208 | Train Loss: 3.227 Vali Loss: 3.466 Vali Acc: 0.076 Test Loss: 3.466 Test Acc: 0.076
Validation loss decreased (-0.071245 --> -0.076315).  Saving model ...
	iters: 100, epoch: 18 | loss: 3.2493601
	speed: 0.1959s/iter; left time: 3362.1190s
	iters: 200, epoch: 18 | loss: 3.2303360
	speed: 0.0630s/iter; left time: 1074.5037s
Epoch: 18 cost time: 14.76029109954834
Epoch: 18, Steps: 208 | Train Loss: 3.176 Vali Loss: 3.433 Vali Acc: 0.083 Test Loss: 3.433 Test Acc: 0.083
Validation loss decreased (-0.076315 --> -0.083175).  Saving model ...
	iters: 100, epoch: 19 | loss: 2.7986517
	speed: 0.1777s/iter; left time: 3012.5512s
	iters: 200, epoch: 19 | loss: 3.1393585
	speed: 0.0591s/iter; left time: 996.9209s
Epoch: 19 cost time: 12.094350576400757
Epoch: 19, Steps: 208 | Train Loss: 3.141 Vali Loss: 3.451 Vali Acc: 0.092 Test Loss: 3.451 Test Acc: 0.092
Validation loss decreased (-0.083175 --> -0.092122).  Saving model ...
	iters: 100, epoch: 20 | loss: 3.1282825
	speed: 0.1878s/iter; left time: 3145.3277s
	iters: 200, epoch: 20 | loss: 3.3199391
	speed: 0.0575s/iter; left time: 957.1336s
Epoch: 20 cost time: 13.23953628540039
Epoch: 20, Steps: 208 | Train Loss: 3.087 Vali Loss: 3.463 Vali Acc: 0.086 Test Loss: 3.463 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 2.9431660
	speed: 0.1596s/iter; left time: 2640.2089s
	iters: 200, epoch: 21 | loss: 3.3729346
	speed: 0.0483s/iter; left time: 794.9166s
Epoch: 21 cost time: 10.517991304397583
Epoch: 21, Steps: 208 | Train Loss: 3.097 Vali Loss: 3.464 Vali Acc: 0.081 Test Loss: 3.464 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 2.6581223
	speed: 0.1334s/iter; left time: 2178.9342s
	iters: 200, epoch: 22 | loss: 3.2358732
	speed: 0.0525s/iter; left time: 851.8214s
Epoch: 22 cost time: 10.114348411560059
Epoch: 22, Steps: 208 | Train Loss: 3.068 Vali Loss: 3.375 Vali Acc: 0.094 Test Loss: 3.375 Test Acc: 0.094
Validation loss decreased (-0.092122 --> -0.094210).  Saving model ...
	iters: 100, epoch: 23 | loss: 3.3181453
	speed: 0.1686s/iter; left time: 2718.7672s
	iters: 200, epoch: 23 | loss: 3.5183988
	speed: 0.0567s/iter; left time: 909.1855s
Epoch: 23 cost time: 12.848680019378662
Epoch: 23, Steps: 208 | Train Loss: 3.065 Vali Loss: 3.433 Vali Acc: 0.084 Test Loss: 3.433 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 3.0951431
	speed: 0.1563s/iter; left time: 2487.3098s
	iters: 200, epoch: 24 | loss: 2.9910202
	speed: 0.0561s/iter; left time: 887.3510s
Epoch: 24 cost time: 11.793580293655396
Epoch: 24, Steps: 208 | Train Loss: 3.055 Vali Loss: 3.463 Vali Acc: 0.092 Test Loss: 3.463 Test Acc: 0.092
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 3.6252615
	speed: 0.1735s/iter; left time: 2725.4119s
	iters: 200, epoch: 25 | loss: 2.9430449
	speed: 0.0568s/iter; left time: 886.6527s
Epoch: 25 cost time: 13.119445323944092
Epoch: 25, Steps: 208 | Train Loss: 2.986 Vali Loss: 3.441 Vali Acc: 0.099 Test Loss: 3.441 Test Acc: 0.099
Validation loss decreased (-0.094210 --> -0.098683).  Saving model ...
	iters: 100, epoch: 26 | loss: 2.9080169
	speed: 0.1605s/iter; left time: 2488.4490s
	iters: 200, epoch: 26 | loss: 2.8934460
	speed: 0.0528s/iter; left time: 813.5754s
Epoch: 26 cost time: 12.010095119476318
Epoch: 26, Steps: 208 | Train Loss: 2.998 Vali Loss: 3.366 Vali Acc: 0.094 Test Loss: 3.366 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 3.1545651
	speed: 0.1542s/iter; left time: 2357.5203s
	iters: 200, epoch: 27 | loss: 3.2779195
	speed: 0.0625s/iter; left time: 949.7251s
Epoch: 27 cost time: 12.331007719039917
Epoch: 27, Steps: 208 | Train Loss: 2.949 Vali Loss: 3.397 Vali Acc: 0.095 Test Loss: 3.397 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 2.9765596
	speed: 0.1682s/iter; left time: 2537.6161s
	iters: 200, epoch: 28 | loss: 2.7433491
	speed: 0.0580s/iter; left time: 868.6683s
Epoch: 28 cost time: 12.596741437911987
Epoch: 28, Steps: 208 | Train Loss: 2.942 Vali Loss: 3.369 Vali Acc: 0.089 Test Loss: 3.369 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 2.9537423
	speed: 0.1614s/iter; left time: 2400.7481s
	iters: 200, epoch: 29 | loss: 3.3096015
	speed: 0.0504s/iter; left time: 745.2986s
Epoch: 29 cost time: 11.505793809890747
Epoch: 29, Steps: 208 | Train Loss: 2.893 Vali Loss: 3.434 Vali Acc: 0.102 Test Loss: 3.434 Test Acc: 0.102
Validation loss decreased (-0.098683 --> -0.101964).  Saving model ...
	iters: 100, epoch: 30 | loss: 2.7426939
	speed: 0.1576s/iter; left time: 2312.2005s
	iters: 200, epoch: 30 | loss: 2.9310656
	speed: 0.0635s/iter; left time: 925.7020s
Epoch: 30 cost time: 12.998201370239258
Epoch: 30, Steps: 208 | Train Loss: 2.850 Vali Loss: 3.481 Vali Acc: 0.098 Test Loss: 3.481 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 2.9771552
	speed: 0.1597s/iter; left time: 2309.6972s
	iters: 200, epoch: 31 | loss: 2.8835690
	speed: 0.0493s/iter; left time: 707.6578s
Epoch: 31 cost time: 11.88264775276184
Epoch: 31, Steps: 208 | Train Loss: 2.839 Vali Loss: 3.373 Vali Acc: 0.094 Test Loss: 3.373 Test Acc: 0.094
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 3.1291766
	speed: 0.1562s/iter; left time: 2226.8594s
	iters: 200, epoch: 32 | loss: 3.2190006
	speed: 0.0561s/iter; left time: 794.0163s
Epoch: 32 cost time: 11.819559574127197
Epoch: 32, Steps: 208 | Train Loss: 2.891 Vali Loss: 3.441 Vali Acc: 0.093 Test Loss: 3.441 Test Acc: 0.093
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 2.9300187
	speed: 0.1595s/iter; left time: 2240.5251s
	iters: 200, epoch: 33 | loss: 3.1467328
	speed: 0.0688s/iter; left time: 959.7027s
Epoch: 33 cost time: 13.112956047058105
Epoch: 33, Steps: 208 | Train Loss: 2.897 Vali Loss: 3.455 Vali Acc: 0.089 Test Loss: 3.455 Test Acc: 0.089
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 2.8335791
	speed: 0.1887s/iter; left time: 2611.1073s
	iters: 200, epoch: 34 | loss: 2.9611757
	speed: 0.0619s/iter; left time: 850.9519s
Epoch: 34 cost time: 14.8044753074646
Epoch: 34, Steps: 208 | Train Loss: 2.883 Vali Loss: 3.500 Vali Acc: 0.089 Test Loss: 3.500 Test Acc: 0.089
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 2.7445846
	speed: 0.1701s/iter; left time: 2318.1776s
	iters: 200, epoch: 35 | loss: 2.9040060
	speed: 0.0551s/iter; left time: 745.5869s
Epoch: 35 cost time: 12.085789442062378
Epoch: 35, Steps: 208 | Train Loss: 2.883 Vali Loss: 3.521 Vali Acc: 0.092 Test Loss: 3.521 Test Acc: 0.092
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 2.9634457
	speed: 0.1843s/iter; left time: 2473.8809s
	iters: 200, epoch: 36 | loss: 2.6325350
	speed: 0.0668s/iter; left time: 890.0989s
Epoch: 36 cost time: 13.91831111907959
Epoch: 36, Steps: 208 | Train Loss: 2.856 Vali Loss: 3.446 Vali Acc: 0.088 Test Loss: 3.446 Test Acc: 0.088
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 3.1662028
	speed: 0.1792s/iter; left time: 2367.9106s
	iters: 200, epoch: 37 | loss: 2.6297994
	speed: 0.0619s/iter; left time: 811.3964s
Epoch: 37 cost time: 13.101029634475708
Epoch: 37, Steps: 208 | Train Loss: 2.830 Vali Loss: 3.482 Vali Acc: 0.096 Test Loss: 3.482 Test Acc: 0.096
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 2.9262795
	speed: 0.1736s/iter; left time: 2257.8164s
	iters: 200, epoch: 38 | loss: 2.8267858
	speed: 0.0674s/iter; left time: 869.8769s
Epoch: 38 cost time: 12.948890686035156
Epoch: 38, Steps: 208 | Train Loss: 2.800 Vali Loss: 3.471 Vali Acc: 0.082 Test Loss: 3.471 Test Acc: 0.082
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 2.9020548
	speed: 0.1476s/iter; left time: 1888.4327s
	iters: 200, epoch: 39 | loss: 3.0349715
	speed: 0.0375s/iter; left time: 475.7305s
Epoch: 39 cost time: 9.408257722854614
Epoch: 39, Steps: 208 | Train Loss: 2.803 Vali Loss: 3.518 Vali Acc: 0.091 Test Loss: 3.518 Test Acc: 0.091
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10199821055770951
model parameter : 2074687
model size : 10.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8287487
	speed: 0.0773s/iter; left time: 1600.7650s
	iters: 200, epoch: 1 | loss: 4.5930653
	speed: 0.0594s/iter; left time: 1223.2830s
Epoch: 1 cost time: 14.243494510650635
Epoch: 1, Steps: 208 | Train Loss: 5.011 Vali Loss: 5.598 Vali Acc: 0.041 Test Loss: 5.598 Test Acc: 0.041
Validation loss decreased (inf --> -0.041101).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.7700410
	speed: 0.1645s/iter; left time: 3371.0934s
	iters: 200, epoch: 2 | loss: 4.1489239
	speed: 0.0427s/iter; left time: 871.3390s
Epoch: 2 cost time: 11.07863450050354
Epoch: 2, Steps: 208 | Train Loss: 4.683 Vali Loss: 4.135 Vali Acc: 0.047 Test Loss: 4.135 Test Acc: 0.047
Validation loss decreased (-0.041101 --> -0.046782).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.1159739
	speed: 0.1603s/iter; left time: 3252.4076s
	iters: 200, epoch: 3 | loss: 4.3195267
	speed: 0.0586s/iter; left time: 1183.2622s
Epoch: 3 cost time: 12.770379066467285
Epoch: 3, Steps: 208 | Train Loss: 3.922 Vali Loss: 3.760 Vali Acc: 0.052 Test Loss: 3.760 Test Acc: 0.052
Validation loss decreased (-0.046782 --> -0.051856).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.2013063
	speed: 0.1560s/iter; left time: 3131.9356s
	iters: 200, epoch: 4 | loss: 3.5112069
	speed: 0.0548s/iter; left time: 1093.8727s
Epoch: 4 cost time: 11.187955141067505
Epoch: 4, Steps: 208 | Train Loss: 3.710 Vali Loss: 3.777 Vali Acc: 0.062 Test Loss: 3.777 Test Acc: 0.062
Validation loss decreased (-0.051856 --> -0.061996).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.9286108
	speed: 0.1582s/iter; left time: 3144.2291s
	iters: 200, epoch: 5 | loss: 3.9402227
	speed: 0.0576s/iter; left time: 1138.7943s
Epoch: 5 cost time: 12.546578645706177
Epoch: 5, Steps: 208 | Train Loss: 3.435 Vali Loss: 3.562 Vali Acc: 0.066 Test Loss: 3.562 Test Acc: 0.066
Validation loss decreased (-0.061996 --> -0.066174).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.1699145
	speed: 0.1545s/iter; left time: 3036.9716s
	iters: 200, epoch: 6 | loss: 2.9408865
	speed: 0.0649s/iter; left time: 1269.2243s
Epoch: 6 cost time: 11.766549110412598
Epoch: 6, Steps: 208 | Train Loss: 3.188 Vali Loss: 3.364 Vali Acc: 0.084 Test Loss: 3.364 Test Acc: 0.084
Validation loss decreased (-0.066174 --> -0.084368).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.0196428
	speed: 0.1659s/iter; left time: 3227.3516s
	iters: 200, epoch: 7 | loss: 2.8061376
	speed: 0.0610s/iter; left time: 1179.7291s
Epoch: 7 cost time: 13.633742809295654
Epoch: 7, Steps: 208 | Train Loss: 2.952 Vali Loss: 3.271 Vali Acc: 0.091 Test Loss: 3.271 Test Acc: 0.091
Validation loss decreased (-0.084368 --> -0.091229).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.3824537
	speed: 0.1651s/iter; left time: 3176.5058s
	iters: 200, epoch: 8 | loss: 2.4178529
	speed: 0.0514s/iter; left time: 983.5282s
Epoch: 8 cost time: 11.475496768951416
Epoch: 8, Steps: 208 | Train Loss: 2.558 Vali Loss: 3.451 Vali Acc: 0.096 Test Loss: 3.451 Test Acc: 0.096
Validation loss decreased (-0.091229 --> -0.095999).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.0102215
	speed: 0.1311s/iter; left time: 2496.5687s
	iters: 200, epoch: 9 | loss: 1.8581604
	speed: 0.0456s/iter; left time: 862.5907s
Epoch: 9 cost time: 9.255025386810303
Epoch: 9, Steps: 208 | Train Loss: 2.027 Vali Loss: 3.660 Vali Acc: 0.115 Test Loss: 3.660 Test Acc: 0.115
Validation loss decreased (-0.095999 --> -0.115084).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.8526235
	speed: 0.1632s/iter; left time: 3072.9225s
	iters: 200, epoch: 10 | loss: 1.2414761
	speed: 0.0585s/iter; left time: 1095.4368s
Epoch: 10 cost time: 12.854142665863037
Epoch: 10, Steps: 208 | Train Loss: 1.453 Vali Loss: 4.675 Vali Acc: 0.118 Test Loss: 4.675 Test Acc: 0.118
Validation loss decreased (-0.115084 --> -0.118355).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.7061907
	speed: 0.1486s/iter; left time: 2766.4946s
	iters: 200, epoch: 11 | loss: 0.8215249
	speed: 0.0690s/iter; left time: 1277.7785s
Epoch: 11 cost time: 12.398271083831787
Epoch: 11, Steps: 208 | Train Loss: 1.020 Vali Loss: 5.599 Vali Acc: 0.110 Test Loss: 5.599 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.5027110
	speed: 0.1777s/iter; left time: 3271.2917s
	iters: 200, epoch: 12 | loss: 1.3141392
	speed: 0.0718s/iter; left time: 1315.7629s
Epoch: 12 cost time: 14.348822355270386
Epoch: 12, Steps: 208 | Train Loss: 0.796 Vali Loss: 6.204 Vali Acc: 0.116 Test Loss: 6.204 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.5493474
	speed: 0.1936s/iter; left time: 3523.8081s
	iters: 200, epoch: 13 | loss: 0.5684012
	speed: 0.0561s/iter; left time: 1015.8571s
Epoch: 13 cost time: 12.997821807861328
Epoch: 13, Steps: 208 | Train Loss: 0.642 Vali Loss: 6.783 Vali Acc: 0.109 Test Loss: 6.783 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.4704705
	speed: 0.1704s/iter; left time: 3067.4499s
	iters: 200, epoch: 14 | loss: 0.4219984
	speed: 0.0630s/iter; left time: 1127.7085s
Epoch: 14 cost time: 12.977705001831055
Epoch: 14, Steps: 208 | Train Loss: 0.534 Vali Loss: 6.966 Vali Acc: 0.118 Test Loss: 6.966 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.3515050
	speed: 0.1824s/iter; left time: 3244.6697s
	iters: 200, epoch: 15 | loss: 0.3535175
	speed: 0.0665s/iter; left time: 1176.5721s
Epoch: 15 cost time: 14.44176697731018
Epoch: 15, Steps: 208 | Train Loss: 0.454 Vali Loss: 7.487 Vali Acc: 0.106 Test Loss: 7.487 Test Acc: 0.106
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.3131396
	speed: 0.1634s/iter; left time: 2873.1447s
	iters: 200, epoch: 16 | loss: 0.4057407
	speed: 0.0564s/iter; left time: 985.7858s
Epoch: 16 cost time: 12.155785083770752
Epoch: 16, Steps: 208 | Train Loss: 0.409 Vali Loss: 7.087 Vali Acc: 0.114 Test Loss: 7.087 Test Acc: 0.114
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.4806781
	speed: 0.1631s/iter; left time: 2834.0587s
	iters: 200, epoch: 17 | loss: 0.4890669
	speed: 0.0617s/iter; left time: 1064.9158s
Epoch: 17 cost time: 12.91370415687561
Epoch: 17, Steps: 208 | Train Loss: 0.350 Vali Loss: 8.067 Vali Acc: 0.111 Test Loss: 8.067 Test Acc: 0.111
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.3781967
	speed: 0.1658s/iter; left time: 2845.2228s
	iters: 200, epoch: 18 | loss: 0.2764789
	speed: 0.0437s/iter; left time: 745.0011s
Epoch: 18 cost time: 11.3546142578125
Epoch: 18, Steps: 208 | Train Loss: 0.297 Vali Loss: 9.140 Vali Acc: 0.112 Test Loss: 9.140 Test Acc: 0.112
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.1450967
	speed: 0.1622s/iter; left time: 2749.6917s
	iters: 200, epoch: 19 | loss: 0.3312579
	speed: 0.0557s/iter; left time: 939.7667s
Epoch: 19 cost time: 12.341607332229614
Epoch: 19, Steps: 208 | Train Loss: 0.334 Vali Loss: 8.000 Vali Acc: 0.112 Test Loss: 8.000 Test Acc: 0.112
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0651183
	speed: 0.1531s/iter; left time: 2563.9811s
	iters: 200, epoch: 20 | loss: 0.3447587
	speed: 0.0602s/iter; left time: 1002.6024s
Epoch: 20 cost time: 12.212158679962158
Epoch: 20, Steps: 208 | Train Loss: 0.291 Vali Loss: 9.010 Vali Acc: 0.105 Test Loss: 9.010 Test Acc: 0.105
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11840143155383238
model parameter : 2072255
model size : 10.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0377603
	speed: 0.0761s/iter; left time: 1575.9290s
	iters: 200, epoch: 1 | loss: 8.9690714
	speed: 0.0696s/iter; left time: 1433.2447s
Epoch: 1 cost time: 15.261378288269043
Epoch: 1, Steps: 208 | Train Loss: 4.986 Vali Loss: 5.184 Vali Acc: 0.041 Test Loss: 5.184 Test Acc: 0.041
Validation loss decreased (inf --> -0.041105).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.9502816
	speed: 0.1873s/iter; left time: 3838.4429s
	iters: 200, epoch: 2 | loss: 4.8957939
	speed: 0.0694s/iter; left time: 1415.9954s
Epoch: 2 cost time: 15.737553596496582
Epoch: 2, Steps: 208 | Train Loss: 5.457 Vali Loss: 4.607 Vali Acc: 0.042 Test Loss: 4.607 Test Acc: 0.042
Validation loss decreased (-0.041105 --> -0.041708).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.3274903
	speed: 0.1669s/iter; left time: 3386.4342s
	iters: 200, epoch: 3 | loss: 3.9897921
	speed: 0.0627s/iter; left time: 1264.7190s
Epoch: 3 cost time: 13.06583046913147
Epoch: 3, Steps: 208 | Train Loss: 4.036 Vali Loss: 3.927 Vali Acc: 0.063 Test Loss: 3.927 Test Acc: 0.063
Validation loss decreased (-0.041708 --> -0.062591).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.5954380
	speed: 0.1907s/iter; left time: 3827.8629s
	iters: 200, epoch: 4 | loss: 3.4816279
	speed: 0.0644s/iter; left time: 1287.0982s
Epoch: 4 cost time: 14.87927770614624
Epoch: 4, Steps: 208 | Train Loss: 3.726 Vali Loss: 4.092 Vali Acc: 0.057 Test Loss: 4.092 Test Acc: 0.057
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.0814054
	speed: 0.1415s/iter; left time: 2811.5067s
	iters: 200, epoch: 5 | loss: 3.1643507
	speed: 0.0405s/iter; left time: 800.7089s
Epoch: 5 cost time: 9.129669904708862
Epoch: 5, Steps: 208 | Train Loss: 3.439 Vali Loss: 3.473 Vali Acc: 0.076 Test Loss: 3.473 Test Acc: 0.076
Validation loss decreased (-0.062591 --> -0.076017).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.7824070
	speed: 0.1499s/iter; left time: 2947.7625s
	iters: 200, epoch: 6 | loss: 2.7336037
	speed: 0.0623s/iter; left time: 1218.3228s
Epoch: 6 cost time: 13.02046275138855
Epoch: 6, Steps: 208 | Train Loss: 3.212 Vali Loss: 3.434 Vali Acc: 0.092 Test Loss: 3.434 Test Acc: 0.092
Validation loss decreased (-0.076017 --> -0.091824).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.0422187
	speed: 0.1907s/iter; left time: 3709.7301s
	iters: 200, epoch: 7 | loss: 2.7692297
	speed: 0.0761s/iter; left time: 1472.2639s
Epoch: 7 cost time: 16.305347681045532
Epoch: 7, Steps: 208 | Train Loss: 2.923 Vali Loss: 3.259 Vali Acc: 0.109 Test Loss: 3.259 Test Acc: 0.109
Validation loss decreased (-0.091824 --> -0.109422).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.8995705
	speed: 0.1922s/iter; left time: 3699.7658s
	iters: 200, epoch: 8 | loss: 2.9896495
	speed: 0.0801s/iter; left time: 1533.0675s
Epoch: 8 cost time: 16.098552703857422
Epoch: 8, Steps: 208 | Train Loss: 2.519 Vali Loss: 3.245 Vali Acc: 0.117 Test Loss: 3.245 Test Acc: 0.117
Validation loss decreased (-0.109422 --> -0.117176).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.3164957
	speed: 0.1876s/iter; left time: 3571.4397s
	iters: 200, epoch: 9 | loss: 2.3979657
	speed: 0.0608s/iter; left time: 1150.6403s
Epoch: 9 cost time: 13.308401584625244
Epoch: 9, Steps: 208 | Train Loss: 2.025 Vali Loss: 3.649 Vali Acc: 0.109 Test Loss: 3.649 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.7141621
	speed: 0.2058s/iter; left time: 3875.8958s
	iters: 200, epoch: 10 | loss: 1.2985641
	speed: 0.0813s/iter; left time: 1522.2595s
Epoch: 10 cost time: 17.061883687973022
Epoch: 10, Steps: 208 | Train Loss: 1.511 Vali Loss: 3.948 Vali Acc: 0.121 Test Loss: 3.948 Test Acc: 0.121
Validation loss decreased (-0.117176 --> -0.120748).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.6993866
	speed: 0.2038s/iter; left time: 3795.8190s
	iters: 200, epoch: 11 | loss: 2.1502745
	speed: 0.0753s/iter; left time: 1394.5058s
Epoch: 11 cost time: 16.221884965896606
Epoch: 11, Steps: 208 | Train Loss: 1.077 Vali Loss: 5.237 Vali Acc: 0.127 Test Loss: 5.237 Test Acc: 0.127
Validation loss decreased (-0.120748 --> -0.126700).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.7404711
	speed: 0.1749s/iter; left time: 3220.2355s
	iters: 200, epoch: 12 | loss: 0.3308926
	speed: 0.0677s/iter; left time: 1240.3094s
Epoch: 12 cost time: 14.390361070632935
Epoch: 12, Steps: 208 | Train Loss: 0.812 Vali Loss: 5.812 Vali Acc: 0.127 Test Loss: 5.812 Test Acc: 0.127
Validation loss decreased (-0.126700 --> -0.126992).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.4929882
	speed: 0.1951s/iter; left time: 3551.1556s
	iters: 200, epoch: 13 | loss: 0.8548593
	speed: 0.0664s/iter; left time: 1202.9917s
Epoch: 13 cost time: 15.037551879882812
Epoch: 13, Steps: 208 | Train Loss: 0.654 Vali Loss: 6.420 Vali Acc: 0.124 Test Loss: 6.420 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.6567882
	speed: 0.1719s/iter; left time: 3094.3328s
	iters: 200, epoch: 14 | loss: 0.3204015
	speed: 0.0643s/iter; left time: 1151.6440s
Epoch: 14 cost time: 13.193851709365845
Epoch: 14, Steps: 208 | Train Loss: 0.573 Vali Loss: 6.701 Vali Acc: 0.117 Test Loss: 6.701 Test Acc: 0.117
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.9060079
	speed: 0.1754s/iter; left time: 3119.6455s
	iters: 200, epoch: 15 | loss: 0.1388234
	speed: 0.0783s/iter; left time: 1384.8305s
Epoch: 15 cost time: 15.897926092147827
Epoch: 15, Steps: 208 | Train Loss: 0.451 Vali Loss: 7.685 Vali Acc: 0.123 Test Loss: 7.685 Test Acc: 0.123
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.2131325
	speed: 0.1838s/iter; left time: 3231.9279s
	iters: 200, epoch: 16 | loss: 0.2120756
	speed: 0.0666s/iter; left time: 1164.6003s
Epoch: 16 cost time: 14.685732126235962
Epoch: 16, Steps: 208 | Train Loss: 0.396 Vali Loss: 7.574 Vali Acc: 0.126 Test Loss: 7.574 Test Acc: 0.126
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.3372426
	speed: 0.1810s/iter; left time: 3144.7862s
	iters: 200, epoch: 17 | loss: 0.3010755
	speed: 0.0551s/iter; left time: 951.8956s
Epoch: 17 cost time: 13.685392141342163
Epoch: 17, Steps: 208 | Train Loss: 0.366 Vali Loss: 7.654 Vali Acc: 0.121 Test Loss: 7.654 Test Acc: 0.121
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.3740421
	speed: 0.1712s/iter; left time: 2939.3387s
	iters: 200, epoch: 18 | loss: 0.3572491
	speed: 0.0824s/iter; left time: 1406.5854s
Epoch: 18 cost time: 15.026867151260376
Epoch: 18, Steps: 208 | Train Loss: 0.336 Vali Loss: 8.576 Vali Acc: 0.117 Test Loss: 8.576 Test Acc: 0.117
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0231457
	speed: 0.1367s/iter; left time: 2317.6051s
	iters: 200, epoch: 19 | loss: 0.4962321
	speed: 0.0379s/iter; left time: 638.2516s
Epoch: 19 cost time: 7.890886068344116
Epoch: 19, Steps: 208 | Train Loss: 0.318 Vali Loss: 7.676 Vali Acc: 0.122 Test Loss: 7.676 Test Acc: 0.122
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0650342
	speed: 0.1527s/iter; left time: 2558.1745s
	iters: 200, epoch: 20 | loss: 0.5181230
	speed: 0.0723s/iter; left time: 1203.8496s
Epoch: 20 cost time: 14.518965482711792
Epoch: 20, Steps: 208 | Train Loss: 0.276 Vali Loss: 7.568 Vali Acc: 0.118 Test Loss: 7.568 Test Acc: 0.118
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.4315754
	speed: 0.1656s/iter; left time: 2738.3925s
	iters: 200, epoch: 21 | loss: 0.3212792
	speed: 0.0582s/iter; left time: 956.7329s
Epoch: 21 cost time: 12.308570623397827
Epoch: 21, Steps: 208 | Train Loss: 0.247 Vali Loss: 9.084 Vali Acc: 0.125 Test Loss: 9.084 Test Acc: 0.125
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.6140671
	speed: 0.1566s/iter; left time: 2556.9384s
	iters: 200, epoch: 22 | loss: 0.0120546
	speed: 0.0440s/iter; left time: 713.6971s
Epoch: 22 cost time: 10.371830463409424
Epoch: 22, Steps: 208 | Train Loss: 0.260 Vali Loss: 9.356 Vali Acc: 0.125 Test Loss: 9.356 Test Acc: 0.125
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12705040262451536
model parameter : 1980863
model size : 10.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 5.8059225
	speed: 0.0723s/iter; left time: 1497.2345s
	iters: 200, epoch: 1 | loss: 7.8598027
	speed: 0.0599s/iter; left time: 1234.0841s
Epoch: 1 cost time: 13.564565658569336
Epoch: 1, Steps: 208 | Train Loss: 5.110 Vali Loss: 6.908 Vali Acc: 0.028 Test Loss: 6.908 Test Acc: 0.028
Validation loss decreased (inf --> -0.027667).  Saving model ...
	iters: 100, epoch: 2 | loss: 5.3707352
	speed: 0.1801s/iter; left time: 3691.0768s
	iters: 200, epoch: 2 | loss: 4.7867765
	speed: 0.0648s/iter; left time: 1321.4489s
Epoch: 2 cost time: 13.654881954193115
Epoch: 2, Steps: 208 | Train Loss: 5.718 Vali Loss: 4.931 Vali Acc: 0.049 Test Loss: 4.931 Test Acc: 0.049
Validation loss decreased (-0.027667 --> -0.048564).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.1564555
	speed: 0.1741s/iter; left time: 3531.0547s
	iters: 200, epoch: 3 | loss: 3.7736568
	speed: 0.0668s/iter; left time: 1349.0519s
Epoch: 3 cost time: 12.942758798599243
Epoch: 3, Steps: 208 | Train Loss: 4.381 Vali Loss: 4.025 Vali Acc: 0.038 Test Loss: 4.025 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 4.5855594
	speed: 0.1908s/iter; left time: 3830.5778s
	iters: 200, epoch: 4 | loss: 3.9937072
	speed: 0.0614s/iter; left time: 1226.1486s
Epoch: 4 cost time: 14.442564249038696
Epoch: 4, Steps: 208 | Train Loss: 4.049 Vali Loss: 3.977 Vali Acc: 0.049 Test Loss: 3.977 Test Acc: 0.049
Validation loss decreased (-0.048564 --> -0.048872).  Saving model ...
	iters: 100, epoch: 5 | loss: 4.2639055
	speed: 0.1637s/iter; left time: 3252.5174s
	iters: 200, epoch: 5 | loss: 3.7288373
	speed: 0.0604s/iter; left time: 1194.3944s
Epoch: 5 cost time: 12.018338203430176
Epoch: 5, Steps: 208 | Train Loss: 3.883 Vali Loss: 3.969 Vali Acc: 0.055 Test Loss: 3.969 Test Acc: 0.055
Validation loss decreased (-0.048872 --> -0.054538).  Saving model ...
	iters: 100, epoch: 6 | loss: 4.1160855
	speed: 0.1596s/iter; left time: 3138.3061s
	iters: 200, epoch: 6 | loss: 3.7998393
	speed: 0.0476s/iter; left time: 931.8972s
Epoch: 6 cost time: 11.48905086517334
Epoch: 6, Steps: 208 | Train Loss: 3.877 Vali Loss: 3.688 Vali Acc: 0.042 Test Loss: 3.688 Test Acc: 0.042
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.2422919
	speed: 0.1644s/iter; left time: 3197.1600s
	iters: 200, epoch: 7 | loss: 3.6550884
	speed: 0.0629s/iter; left time: 1217.6632s
Epoch: 7 cost time: 12.084156036376953
Epoch: 7, Steps: 208 | Train Loss: 3.697 Vali Loss: 3.670 Vali Acc: 0.043 Test Loss: 3.670 Test Acc: 0.043
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 3.5539527
	speed: 0.1556s/iter; left time: 2993.6275s
	iters: 200, epoch: 8 | loss: 3.7378356
	speed: 0.0589s/iter; left time: 1127.0197s
Epoch: 8 cost time: 12.868127584457397
Epoch: 8, Steps: 208 | Train Loss: 3.616 Vali Loss: 3.643 Vali Acc: 0.057 Test Loss: 3.643 Test Acc: 0.057
Validation loss decreased (-0.054538 --> -0.057226).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.3751752
	speed: 0.1606s/iter; left time: 3058.2697s
	iters: 200, epoch: 9 | loss: 3.6272025
	speed: 0.0611s/iter; left time: 1156.4025s
Epoch: 9 cost time: 12.523488998413086
Epoch: 9, Steps: 208 | Train Loss: 3.546 Vali Loss: 3.597 Vali Acc: 0.058 Test Loss: 3.597 Test Acc: 0.058
Validation loss decreased (-0.057226 --> -0.057823).  Saving model ...
	iters: 100, epoch: 10 | loss: 3.2945390
	speed: 0.1523s/iter; left time: 2867.1809s
	iters: 200, epoch: 10 | loss: 3.8208861
	speed: 0.0524s/iter; left time: 981.4001s
Epoch: 10 cost time: 10.624185800552368
Epoch: 10, Steps: 208 | Train Loss: 3.516 Vali Loss: 3.618 Vali Acc: 0.052 Test Loss: 3.618 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 3.7361398
	speed: 0.1672s/iter; left time: 3112.9341s
	iters: 200, epoch: 11 | loss: 3.4177463
	speed: 0.0512s/iter; left time: 948.5942s
Epoch: 11 cost time: 11.64373254776001
Epoch: 11, Steps: 208 | Train Loss: 3.498 Vali Loss: 3.584 Vali Acc: 0.057 Test Loss: 3.584 Test Acc: 0.057
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 3.7499404
	speed: 0.1596s/iter; left time: 2938.1988s
	iters: 200, epoch: 12 | loss: 3.2581770
	speed: 0.0638s/iter; left time: 1168.1377s
Epoch: 12 cost time: 12.247851848602295
Epoch: 12, Steps: 208 | Train Loss: 3.491 Vali Loss: 3.555 Vali Acc: 0.056 Test Loss: 3.555 Test Acc: 0.056
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 3.5752614
	speed: 0.1632s/iter; left time: 2970.5041s
	iters: 200, epoch: 13 | loss: 3.4012833
	speed: 0.0514s/iter; left time: 929.9147s
Epoch: 13 cost time: 12.626130819320679
Epoch: 13, Steps: 208 | Train Loss: 3.445 Vali Loss: 3.554 Vali Acc: 0.055 Test Loss: 3.554 Test Acc: 0.055
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 3.1983118
	speed: 0.1666s/iter; left time: 2998.3142s
	iters: 200, epoch: 14 | loss: 3.8932593
	speed: 0.0613s/iter; left time: 1096.2602s
Epoch: 14 cost time: 12.169368982315063
Epoch: 14, Steps: 208 | Train Loss: 3.415 Vali Loss: 3.531 Vali Acc: 0.061 Test Loss: 3.531 Test Acc: 0.061
Validation loss decreased (-0.057823 --> -0.060507).  Saving model ...
	iters: 100, epoch: 15 | loss: 3.2389133
	speed: 0.1670s/iter; left time: 2970.3990s
	iters: 200, epoch: 15 | loss: 3.1002698
	speed: 0.0465s/iter; left time: 822.6870s
Epoch: 15 cost time: 11.567323207855225
Epoch: 15, Steps: 208 | Train Loss: 3.397 Vali Loss: 3.551 Vali Acc: 0.061 Test Loss: 3.551 Test Acc: 0.061
Validation loss decreased (-0.060507 --> -0.061104).  Saving model ...
	iters: 100, epoch: 16 | loss: 3.7356267
	speed: 0.1633s/iter; left time: 2870.2672s
	iters: 200, epoch: 16 | loss: 3.3909562
	speed: 0.0580s/iter; left time: 1014.4430s
Epoch: 16 cost time: 12.154493808746338
Epoch: 16, Steps: 208 | Train Loss: 3.381 Vali Loss: 3.514 Vali Acc: 0.066 Test Loss: 3.514 Test Acc: 0.066
Validation loss decreased (-0.061104 --> -0.066174).  Saving model ...
	iters: 100, epoch: 17 | loss: 3.3698182
	speed: 0.1647s/iter; left time: 2861.4674s
	iters: 200, epoch: 17 | loss: 3.5692525
	speed: 0.0698s/iter; left time: 1205.3554s
Epoch: 17 cost time: 13.932851076126099
Epoch: 17, Steps: 208 | Train Loss: 3.337 Vali Loss: 3.522 Vali Acc: 0.065 Test Loss: 3.522 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 3.2711985
	speed: 0.1749s/iter; left time: 3001.8333s
	iters: 200, epoch: 18 | loss: 3.6065741
	speed: 0.0566s/iter; left time: 965.8908s
Epoch: 18 cost time: 12.958312511444092
Epoch: 18, Steps: 208 | Train Loss: 3.297 Vali Loss: 3.502 Vali Acc: 0.065 Test Loss: 3.502 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 3.4416642
	speed: 0.1762s/iter; left time: 2986.9977s
	iters: 200, epoch: 19 | loss: 3.3644395
	speed: 0.0677s/iter; left time: 1141.0827s
Epoch: 19 cost time: 13.279053926467896
Epoch: 19, Steps: 208 | Train Loss: 3.278 Vali Loss: 3.520 Vali Acc: 0.067 Test Loss: 3.520 Test Acc: 0.067
Validation loss decreased (-0.066174 --> -0.066771).  Saving model ...
	iters: 100, epoch: 20 | loss: 3.1211219
	speed: 0.1889s/iter; left time: 3163.4279s
	iters: 200, epoch: 20 | loss: 2.7826076
	speed: 0.0521s/iter; left time: 867.7008s
Epoch: 20 cost time: 13.265559434890747
Epoch: 20, Steps: 208 | Train Loss: 3.215 Vali Loss: 3.471 Vali Acc: 0.070 Test Loss: 3.471 Test Acc: 0.070
Validation loss decreased (-0.066771 --> -0.070052).  Saving model ...
	iters: 100, epoch: 21 | loss: 3.4290104
	speed: 0.1921s/iter; left time: 3177.1464s
	iters: 200, epoch: 21 | loss: 2.8588119
	speed: 0.0715s/iter; left time: 1176.1844s
Epoch: 21 cost time: 14.56473994255066
Epoch: 21, Steps: 208 | Train Loss: 3.191 Vali Loss: 3.467 Vali Acc: 0.071 Test Loss: 3.467 Test Acc: 0.071
Validation loss decreased (-0.070052 --> -0.071245).  Saving model ...
	iters: 100, epoch: 22 | loss: 3.1110680
	speed: 0.1448s/iter; left time: 2364.5476s
	iters: 200, epoch: 22 | loss: 3.1817048
	speed: 0.0293s/iter; left time: 475.8154s
Epoch: 22 cost time: 7.399612903594971
Epoch: 22, Steps: 208 | Train Loss: 3.160 Vali Loss: 3.466 Vali Acc: 0.073 Test Loss: 3.466 Test Acc: 0.073
Validation loss decreased (-0.071245 --> -0.073332).  Saving model ...
	iters: 100, epoch: 23 | loss: 2.8510785
	speed: 0.1175s/iter; left time: 1894.3715s
	iters: 200, epoch: 23 | loss: 3.2622254
	speed: 0.0507s/iter; left time: 813.0239s
Epoch: 23 cost time: 9.480654954910278
Epoch: 23, Steps: 208 | Train Loss: 3.116 Vali Loss: 3.469 Vali Acc: 0.066 Test Loss: 3.469 Test Acc: 0.066
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 3.2153461
	speed: 0.1551s/iter; left time: 2468.0570s
	iters: 200, epoch: 24 | loss: 3.0652316
	speed: 0.0534s/iter; left time: 844.3634s
Epoch: 24 cost time: 10.951247692108154
Epoch: 24, Steps: 208 | Train Loss: 3.037 Vali Loss: 3.459 Vali Acc: 0.083 Test Loss: 3.459 Test Acc: 0.083
Validation loss decreased (-0.073332 --> -0.082578).  Saving model ...
	iters: 100, epoch: 25 | loss: 3.5202570
	speed: 0.1466s/iter; left time: 2303.2439s
	iters: 200, epoch: 25 | loss: 2.9134414
	speed: 0.0424s/iter; left time: 661.3112s
Epoch: 25 cost time: 9.433803796768188
Epoch: 25, Steps: 208 | Train Loss: 2.983 Vali Loss: 3.523 Vali Acc: 0.088 Test Loss: 3.523 Test Acc: 0.088
Validation loss decreased (-0.082578 --> -0.087647).  Saving model ...
	iters: 100, epoch: 26 | loss: 2.6402299
	speed: 0.1629s/iter; left time: 2525.8783s
	iters: 200, epoch: 26 | loss: 3.1577363
	speed: 0.0567s/iter; left time: 873.4729s
Epoch: 26 cost time: 12.672522783279419
Epoch: 26, Steps: 208 | Train Loss: 2.961 Vali Loss: 3.491 Vali Acc: 0.084 Test Loss: 3.491 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 3.1781118
	speed: 0.1588s/iter; left time: 2428.9623s
	iters: 200, epoch: 27 | loss: 3.0532303
	speed: 0.0502s/iter; left time: 762.7242s
Epoch: 27 cost time: 10.735571384429932
Epoch: 27, Steps: 208 | Train Loss: 2.949 Vali Loss: 3.481 Vali Acc: 0.080 Test Loss: 3.481 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 3.1286142
	speed: 0.1708s/iter; left time: 2576.1423s
	iters: 200, epoch: 28 | loss: 2.9057541
	speed: 0.0557s/iter; left time: 835.3931s
Epoch: 28 cost time: 12.208167552947998
Epoch: 28, Steps: 208 | Train Loss: 2.907 Vali Loss: 3.532 Vali Acc: 0.079 Test Loss: 3.532 Test Acc: 0.079
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 3.4419975
	speed: 0.1600s/iter; left time: 2380.4082s
	iters: 200, epoch: 29 | loss: 3.3642123
	speed: 0.0629s/iter; left time: 929.0784s
Epoch: 29 cost time: 12.321823358535767
Epoch: 29, Steps: 208 | Train Loss: 2.916 Vali Loss: 3.558 Vali Acc: 0.083 Test Loss: 3.558 Test Acc: 0.083
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 2.5663848
	speed: 0.1745s/iter; left time: 2559.9153s
	iters: 200, epoch: 30 | loss: 2.9528308
	speed: 0.0510s/iter; left time: 743.0473s
Epoch: 30 cost time: 11.780481100082397
Epoch: 30, Steps: 208 | Train Loss: 2.853 Vali Loss: 3.540 Vali Acc: 0.091 Test Loss: 3.540 Test Acc: 0.091
Validation loss decreased (-0.087647 --> -0.091226).  Saving model ...
	iters: 100, epoch: 31 | loss: 2.9824290
	speed: 0.1640s/iter; left time: 2372.0917s
	iters: 200, epoch: 31 | loss: 2.2854271
	speed: 0.0603s/iter; left time: 866.6110s
Epoch: 31 cost time: 12.424760580062866
Epoch: 31, Steps: 208 | Train Loss: 2.790 Vali Loss: 3.568 Vali Acc: 0.091 Test Loss: 3.568 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 2.5030184
	speed: 0.1725s/iter; left time: 2458.4030s
	iters: 200, epoch: 32 | loss: 3.0147378
	speed: 0.0466s/iter; left time: 660.1688s
Epoch: 32 cost time: 11.631259441375732
Epoch: 32, Steps: 208 | Train Loss: 2.848 Vali Loss: 3.609 Vali Acc: 0.087 Test Loss: 3.609 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 2.8178613
	speed: 0.1666s/iter; left time: 2340.1976s
	iters: 200, epoch: 33 | loss: 3.1230927
	speed: 0.0627s/iter; left time: 873.9007s
Epoch: 33 cost time: 13.101366996765137
Epoch: 33, Steps: 208 | Train Loss: 2.878 Vali Loss: 3.604 Vali Acc: 0.078 Test Loss: 3.604 Test Acc: 0.078
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 2.9527690
	speed: 0.1801s/iter; left time: 2491.9807s
	iters: 200, epoch: 34 | loss: 2.8858585
	speed: 0.0531s/iter; left time: 729.8654s
Epoch: 34 cost time: 12.62963056564331
Epoch: 34, Steps: 208 | Train Loss: 2.738 Vali Loss: 3.654 Vali Acc: 0.078 Test Loss: 3.654 Test Acc: 0.078
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 2.8793957
	speed: 0.1857s/iter; left time: 2531.3872s
	iters: 200, epoch: 35 | loss: 2.9891887
	speed: 0.0634s/iter; left time: 858.1153s
Epoch: 35 cost time: 13.444228649139404
Epoch: 35, Steps: 208 | Train Loss: 2.732 Vali Loss: 3.643 Vali Acc: 0.076 Test Loss: 3.643 Test Acc: 0.076
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 2.7925589
	speed: 0.1782s/iter; left time: 2392.1463s
	iters: 200, epoch: 36 | loss: 3.0577848
	speed: 0.0563s/iter; left time: 750.4685s
Epoch: 36 cost time: 12.481856346130371
Epoch: 36, Steps: 208 | Train Loss: 2.839 Vali Loss: 3.698 Vali Acc: 0.086 Test Loss: 3.698 Test Acc: 0.086
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 2.4995170
	speed: 0.1810s/iter; left time: 2391.0425s
	iters: 200, epoch: 37 | loss: 2.7973998
	speed: 0.0708s/iter; left time: 928.9886s
Epoch: 37 cost time: 14.395266771316528
Epoch: 37, Steps: 208 | Train Loss: 2.731 Vali Loss: 3.707 Vali Acc: 0.075 Test Loss: 3.707 Test Acc: 0.075
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 2.0770841
	speed: 0.1827s/iter; left time: 2376.5534s
	iters: 200, epoch: 38 | loss: 2.5983624
	speed: 0.0629s/iter; left time: 812.2302s
Epoch: 38 cost time: 13.246078968048096
Epoch: 38, Steps: 208 | Train Loss: 2.748 Vali Loss: 3.669 Vali Acc: 0.090 Test Loss: 3.669 Test Acc: 0.090
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 39 | loss: 2.6753726
	speed: 0.1680s/iter; left time: 2150.4382s
	iters: 200, epoch: 39 | loss: 2.9564519
	speed: 0.0501s/iter; left time: 635.9417s
Epoch: 39 cost time: 12.477511167526245
Epoch: 39, Steps: 208 | Train Loss: 2.706 Vali Loss: 3.692 Vali Acc: 0.086 Test Loss: 3.692 Test Acc: 0.086
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 40 | loss: 2.9839876
	speed: 0.1759s/iter; left time: 2214.6861s
	iters: 200, epoch: 40 | loss: 3.1802509
	speed: 0.0577s/iter; left time: 720.9302s
Epoch: 40 cost time: 12.560359477996826
Epoch: 40, Steps: 208 | Train Loss: 2.644 Vali Loss: 3.731 Vali Acc: 0.077 Test Loss: 3.731 Test Acc: 0.077
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09126155681479273
model parameter : 1978431
model size : 10.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.5528531
	speed: 0.0654s/iter; left time: 1353.6690s
	iters: 200, epoch: 1 | loss: 5.9869690
	speed: 0.0649s/iter; left time: 1337.4885s
Epoch: 1 cost time: 13.635442018508911
Epoch: 1, Steps: 208 | Train Loss: 4.956 Vali Loss: 5.590 Vali Acc: 0.044 Test Loss: 5.590 Test Acc: 0.044
Validation loss decreased (inf --> -0.044382).  Saving model ...
	iters: 100, epoch: 2 | loss: 6.8484459
	speed: 0.1635s/iter; left time: 3349.6915s
	iters: 200, epoch: 2 | loss: 4.3995056
	speed: 0.0532s/iter; left time: 1085.2449s
Epoch: 2 cost time: 12.508678436279297
Epoch: 2, Steps: 208 | Train Loss: 5.588 Vali Loss: 4.347 Vali Acc: 0.038 Test Loss: 4.347 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.8149505
	speed: 0.1583s/iter; left time: 3211.1043s
	iters: 200, epoch: 3 | loss: 4.3352365
	speed: 0.0403s/iter; left time: 813.8507s
Epoch: 3 cost time: 9.798261880874634
Epoch: 3, Steps: 208 | Train Loss: 4.130 Vali Loss: 4.174 Vali Acc: 0.033 Test Loss: 4.174 Test Acc: 0.033
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 4.2767735
	speed: 0.1325s/iter; left time: 2660.6003s
	iters: 200, epoch: 4 | loss: 4.0169406
	speed: 0.0346s/iter; left time: 690.6198s
Epoch: 4 cost time: 7.908301115036011
Epoch: 4, Steps: 208 | Train Loss: 3.807 Vali Loss: 3.891 Vali Acc: 0.049 Test Loss: 3.891 Test Acc: 0.049
Validation loss decreased (-0.044382 --> -0.048574).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2971838
	speed: 0.1693s/iter; left time: 3364.1732s
	iters: 200, epoch: 5 | loss: 3.6460965
	speed: 0.0634s/iter; left time: 1253.5694s
Epoch: 5 cost time: 13.108841180801392
Epoch: 5, Steps: 208 | Train Loss: 3.517 Vali Loss: 3.510 Vali Acc: 0.070 Test Loss: 3.510 Test Acc: 0.070
Validation loss decreased (-0.048574 --> -0.070350).  Saving model ...
	iters: 100, epoch: 6 | loss: 4.1355786
	speed: 0.1582s/iter; left time: 3110.0710s
	iters: 200, epoch: 6 | loss: 3.1550112
	speed: 0.0462s/iter; left time: 904.3759s
Epoch: 6 cost time: 11.56902813911438
Epoch: 6, Steps: 208 | Train Loss: 3.218 Vali Loss: 3.267 Vali Acc: 0.095 Test Loss: 3.267 Test Acc: 0.095
Validation loss decreased (-0.070350 --> -0.095404).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9427252
	speed: 0.1695s/iter; left time: 3297.7021s
	iters: 200, epoch: 7 | loss: 3.3135912
	speed: 0.0645s/iter; left time: 1248.6985s
Epoch: 7 cost time: 12.963575839996338
Epoch: 7, Steps: 208 | Train Loss: 2.988 Vali Loss: 3.259 Vali Acc: 0.115 Test Loss: 3.259 Test Acc: 0.115
Validation loss decreased (-0.095404 --> -0.114492).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.8933759
	speed: 0.1676s/iter; left time: 3224.8506s
	iters: 200, epoch: 8 | loss: 3.0152445
	speed: 0.0466s/iter; left time: 891.8665s
Epoch: 8 cost time: 11.686134338378906
Epoch: 8, Steps: 208 | Train Loss: 2.653 Vali Loss: 3.323 Vali Acc: 0.113 Test Loss: 3.323 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.0681548
	speed: 0.1664s/iter; left time: 3167.1959s
	iters: 200, epoch: 9 | loss: 2.0872281
	speed: 0.0627s/iter; left time: 1187.8121s
Epoch: 9 cost time: 13.228769063949585
Epoch: 9, Steps: 208 | Train Loss: 2.275 Vali Loss: 3.556 Vali Acc: 0.118 Test Loss: 3.556 Test Acc: 0.118
Validation loss decreased (-0.114492 --> -0.118366).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.3954598
	speed: 0.1778s/iter; left time: 3348.7194s
	iters: 200, epoch: 10 | loss: 1.8778375
	speed: 0.0498s/iter; left time: 933.6128s
Epoch: 10 cost time: 12.543849468231201
Epoch: 10, Steps: 208 | Train Loss: 1.781 Vali Loss: 4.415 Vali Acc: 0.114 Test Loss: 4.415 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.5738581
	speed: 0.1590s/iter; left time: 2961.6021s
	iters: 200, epoch: 11 | loss: 1.3168471
	speed: 0.0435s/iter; left time: 806.2282s
Epoch: 11 cost time: 9.298501968383789
Epoch: 11, Steps: 208 | Train Loss: 1.258 Vali Loss: 4.807 Vali Acc: 0.106 Test Loss: 4.807 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.8024075
	speed: 0.1755s/iter; left time: 3231.7661s
	iters: 200, epoch: 12 | loss: 0.4610075
	speed: 0.0651s/iter; left time: 1191.7485s
Epoch: 12 cost time: 13.791288375854492
Epoch: 12, Steps: 208 | Train Loss: 0.923 Vali Loss: 5.769 Vali Acc: 0.106 Test Loss: 5.769 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.6278014
	speed: 0.1746s/iter; left time: 3178.8756s
	iters: 200, epoch: 13 | loss: 0.2348855
	speed: 0.0695s/iter; left time: 1258.0819s
Epoch: 13 cost time: 13.752963542938232
Epoch: 13, Steps: 208 | Train Loss: 0.712 Vali Loss: 6.255 Vali Acc: 0.122 Test Loss: 6.255 Test Acc: 0.122
Validation loss decreased (-0.118366 --> -0.122216).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.2661383
	speed: 0.1915s/iter; left time: 3445.9585s
	iters: 200, epoch: 14 | loss: 0.2876395
	speed: 0.0581s/iter; left time: 1040.2670s
Epoch: 14 cost time: 14.062053680419922
Epoch: 14, Steps: 208 | Train Loss: 0.591 Vali Loss: 6.569 Vali Acc: 0.123 Test Loss: 6.569 Test Acc: 0.123
Validation loss decreased (-0.122216 --> -0.122511).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.3968358
	speed: 0.1586s/iter; left time: 2820.5692s
	iters: 200, epoch: 15 | loss: 0.2291640
	speed: 0.0539s/iter; left time: 952.6828s
Epoch: 15 cost time: 11.255558252334595
Epoch: 15, Steps: 208 | Train Loss: 0.512 Vali Loss: 6.771 Vali Acc: 0.111 Test Loss: 6.771 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.6038394
	speed: 0.1587s/iter; left time: 2790.0340s
	iters: 200, epoch: 16 | loss: 0.6198770
	speed: 0.0627s/iter; left time: 1095.3946s
Epoch: 16 cost time: 12.40481185913086
Epoch: 16, Steps: 208 | Train Loss: 0.429 Vali Loss: 6.882 Vali Acc: 0.112 Test Loss: 6.882 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.4916584
	speed: 0.1710s/iter; left time: 2970.4349s
	iters: 200, epoch: 17 | loss: 0.3049859
	speed: 0.0594s/iter; left time: 1025.1994s
Epoch: 17 cost time: 13.040318489074707
Epoch: 17, Steps: 208 | Train Loss: 0.361 Vali Loss: 7.853 Vali Acc: 0.114 Test Loss: 7.853 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.4908485
	speed: 0.1681s/iter; left time: 2886.1816s
	iters: 200, epoch: 18 | loss: 0.0511203
	speed: 0.0585s/iter; left time: 998.4290s
Epoch: 18 cost time: 13.006548404693604
Epoch: 18, Steps: 208 | Train Loss: 0.333 Vali Loss: 8.554 Vali Acc: 0.114 Test Loss: 8.554 Test Acc: 0.114
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.1390278
	speed: 0.1541s/iter; left time: 2612.4588s
	iters: 200, epoch: 19 | loss: 0.5324662
	speed: 0.0515s/iter; left time: 867.8782s
Epoch: 19 cost time: 11.778441190719604
Epoch: 19, Steps: 208 | Train Loss: 0.324 Vali Loss: 8.440 Vali Acc: 0.112 Test Loss: 8.440 Test Acc: 0.112
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0252574
	speed: 0.1503s/iter; left time: 2517.7895s
	iters: 200, epoch: 20 | loss: 0.6368085
	speed: 0.0618s/iter; left time: 1028.3570s
Epoch: 20 cost time: 11.700972080230713
Epoch: 20, Steps: 208 | Train Loss: 0.292 Vali Loss: 8.500 Vali Acc: 0.112 Test Loss: 8.500 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0636217
	speed: 0.1595s/iter; left time: 2638.7550s
	iters: 200, epoch: 21 | loss: 0.5768015
	speed: 0.0560s/iter; left time: 920.6498s
Epoch: 21 cost time: 12.563407897949219
Epoch: 21, Steps: 208 | Train Loss: 0.261 Vali Loss: 8.946 Vali Acc: 0.109 Test Loss: 8.946 Test Acc: 0.109
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0240090
	speed: 0.1696s/iter; left time: 2769.3121s
	iters: 200, epoch: 22 | loss: 0.0441241
	speed: 0.0647s/iter; left time: 1049.7431s
Epoch: 22 cost time: 13.224347591400146
Epoch: 22, Steps: 208 | Train Loss: 0.228 Vali Loss: 8.759 Vali Acc: 0.109 Test Loss: 8.759 Test Acc: 0.109
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.3442518
	speed: 0.1677s/iter; left time: 2703.4678s
	iters: 200, epoch: 23 | loss: 0.1145382
	speed: 0.0445s/iter; left time: 712.4608s
Epoch: 23 cost time: 11.572887897491455
Epoch: 23, Steps: 208 | Train Loss: 0.238 Vali Loss: 8.656 Vali Acc: 0.109 Test Loss: 8.656 Test Acc: 0.109
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0886567
	speed: 0.1632s/iter; left time: 2596.9664s
	iters: 200, epoch: 24 | loss: 0.7179424
	speed: 0.0580s/iter; left time: 917.8510s
Epoch: 24 cost time: 12.345874309539795
Epoch: 24, Steps: 208 | Train Loss: 0.215 Vali Loss: 7.973 Vali Acc: 0.112 Test Loss: 7.973 Test Acc: 0.112
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12257679689830003
model parameter : 1975999
model size : 10.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.2139664
	speed: 0.0769s/iter; left time: 1590.9998s
	iters: 200, epoch: 1 | loss: 6.4073801
	speed: 0.0616s/iter; left time: 1268.8555s
Epoch: 1 cost time: 14.445785522460938
Epoch: 1, Steps: 208 | Train Loss: 5.072 Vali Loss: 5.193 Vali Acc: 0.045 Test Loss: 5.193 Test Acc: 0.045
Validation loss decreased (inf --> -0.045281).  Saving model ...
	iters: 100, epoch: 2 | loss: 6.6397376
	speed: 0.1456s/iter; left time: 2983.9721s
	iters: 200, epoch: 2 | loss: 4.6521988
	speed: 0.0543s/iter; left time: 1106.9274s
Epoch: 2 cost time: 10.874449968338013
Epoch: 2, Steps: 208 | Train Loss: 5.565 Vali Loss: 5.032 Vali Acc: 0.031 Test Loss: 5.032 Test Acc: 0.031
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.3814726
	speed: 0.1735s/iter; left time: 3520.2875s
	iters: 200, epoch: 3 | loss: 4.0923634
	speed: 0.0554s/iter; left time: 1118.8225s
Epoch: 3 cost time: 13.419251680374146
Epoch: 3, Steps: 208 | Train Loss: 4.019 Vali Loss: 3.749 Vali Acc: 0.058 Test Loss: 3.749 Test Acc: 0.058
Validation loss decreased (-0.045281 --> -0.058119).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.7015357
	speed: 0.1652s/iter; left time: 3315.8067s
	iters: 200, epoch: 4 | loss: 3.2536511
	speed: 0.0621s/iter; left time: 1241.4062s
Epoch: 4 cost time: 11.627610445022583
Epoch: 4, Steps: 208 | Train Loss: 3.688 Vali Loss: 3.970 Vali Acc: 0.052 Test Loss: 3.970 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.3747807
	speed: 0.1807s/iter; left time: 3589.3982s
	iters: 200, epoch: 5 | loss: 3.4005246
	speed: 0.0664s/iter; left time: 1312.4091s
Epoch: 5 cost time: 14.237071514129639
Epoch: 5, Steps: 208 | Train Loss: 3.393 Vali Loss: 3.462 Vali Acc: 0.083 Test Loss: 3.462 Test Acc: 0.083
Validation loss decreased (-0.058119 --> -0.082876).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.4690733
	speed: 0.1874s/iter; left time: 3685.3142s
	iters: 200, epoch: 6 | loss: 3.2678471
	speed: 0.0717s/iter; left time: 1403.1334s
Epoch: 6 cost time: 14.716047286987305
Epoch: 6, Steps: 208 | Train Loss: 3.169 Vali Loss: 3.297 Vali Acc: 0.085 Test Loss: 3.297 Test Acc: 0.085
Validation loss decreased (-0.082876 --> -0.084966).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.5814662
	speed: 0.1527s/iter; left time: 2970.2970s
	iters: 200, epoch: 7 | loss: 2.3187363
	speed: 0.0300s/iter; left time: 581.3521s
Epoch: 7 cost time: 8.075928211212158
Epoch: 7, Steps: 208 | Train Loss: 2.880 Vali Loss: 3.211 Vali Acc: 0.110 Test Loss: 3.211 Test Acc: 0.110
Validation loss decreased (-0.084966 --> -0.109720).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.8128555
	speed: 0.1258s/iter; left time: 2421.3521s
	iters: 200, epoch: 8 | loss: 2.8748808
	speed: 0.0602s/iter; left time: 1153.2954s
Epoch: 8 cost time: 10.804174900054932
Epoch: 8, Steps: 208 | Train Loss: 2.508 Vali Loss: 3.312 Vali Acc: 0.124 Test Loss: 3.312 Test Acc: 0.124
Validation loss decreased (-0.109720 --> -0.124333).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.6095591
	speed: 0.1629s/iter; left time: 3101.4814s
	iters: 200, epoch: 9 | loss: 2.2311201
	speed: 0.0433s/iter; left time: 820.8730s
Epoch: 9 cost time: 11.368078708648682
Epoch: 9, Steps: 208 | Train Loss: 2.045 Vali Loss: 3.797 Vali Acc: 0.122 Test Loss: 3.797 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.4681214
	speed: 0.1590s/iter; left time: 2993.3949s
	iters: 200, epoch: 10 | loss: 2.2435458
	speed: 0.0633s/iter; left time: 1186.0045s
Epoch: 10 cost time: 12.739520788192749
Epoch: 10, Steps: 208 | Train Loss: 1.498 Vali Loss: 4.077 Vali Acc: 0.108 Test Loss: 4.077 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.0232017
	speed: 0.1564s/iter; left time: 2912.2771s
	iters: 200, epoch: 11 | loss: 1.3618541
	speed: 0.0499s/iter; left time: 923.3204s
Epoch: 11 cost time: 10.937483787536621
Epoch: 11, Steps: 208 | Train Loss: 1.065 Vali Loss: 5.230 Vali Acc: 0.126 Test Loss: 5.230 Test Acc: 0.126
Validation loss decreased (-0.124333 --> -0.125507).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.9054741
	speed: 0.1579s/iter; left time: 2906.9099s
	iters: 200, epoch: 12 | loss: 0.4867387
	speed: 0.0624s/iter; left time: 1143.3364s
Epoch: 12 cost time: 12.665761470794678
Epoch: 12, Steps: 208 | Train Loss: 0.849 Vali Loss: 6.217 Vali Acc: 0.106 Test Loss: 6.217 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.9986709
	speed: 0.1610s/iter; left time: 2930.6877s
	iters: 200, epoch: 13 | loss: 0.5196311
	speed: 0.0454s/iter; left time: 822.8225s
Epoch: 13 cost time: 11.05521035194397
Epoch: 13, Steps: 208 | Train Loss: 0.642 Vali Loss: 6.295 Vali Acc: 0.110 Test Loss: 6.295 Test Acc: 0.110
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.1928230
	speed: 0.1520s/iter; left time: 2734.7767s
	iters: 200, epoch: 14 | loss: 0.5856569
	speed: 0.0624s/iter; left time: 1116.4145s
Epoch: 14 cost time: 12.976226806640625
Epoch: 14, Steps: 208 | Train Loss: 0.509 Vali Loss: 7.859 Vali Acc: 0.115 Test Loss: 7.859 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.7454730
	speed: 0.1548s/iter; left time: 2754.4659s
	iters: 200, epoch: 15 | loss: 0.5093749
	speed: 0.0470s/iter; left time: 830.6046s
Epoch: 15 cost time: 11.30766749382019
Epoch: 15, Steps: 208 | Train Loss: 0.445 Vali Loss: 7.979 Vali Acc: 0.108 Test Loss: 7.979 Test Acc: 0.108
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.6748549
	speed: 0.1212s/iter; left time: 2130.4453s
	iters: 200, epoch: 16 | loss: 0.5862009
	speed: 0.0440s/iter; left time: 768.9318s
Epoch: 16 cost time: 8.481861114501953
Epoch: 16, Steps: 208 | Train Loss: 0.388 Vali Loss: 7.438 Vali Acc: 0.122 Test Loss: 7.438 Test Acc: 0.122
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.2430863
	speed: 0.1603s/iter; left time: 2785.2210s
	iters: 200, epoch: 17 | loss: 0.1082083
	speed: 0.0513s/iter; left time: 885.2619s
Epoch: 17 cost time: 11.63065767288208
Epoch: 17, Steps: 208 | Train Loss: 0.362 Vali Loss: 7.581 Vali Acc: 0.116 Test Loss: 7.581 Test Acc: 0.116
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.4805668
	speed: 0.1459s/iter; left time: 2504.6890s
	iters: 200, epoch: 18 | loss: 0.0863233
	speed: 0.0633s/iter; left time: 1080.1471s
Epoch: 18 cost time: 11.659555196762085
Epoch: 18, Steps: 208 | Train Loss: 0.316 Vali Loss: 8.763 Vali Acc: 0.114 Test Loss: 8.763 Test Acc: 0.114
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0116753
	speed: 0.1575s/iter; left time: 2670.3540s
	iters: 200, epoch: 19 | loss: 0.2625634
	speed: 0.0544s/iter; left time: 917.1831s
Epoch: 19 cost time: 12.122569561004639
Epoch: 19, Steps: 208 | Train Loss: 0.296 Vali Loss: 8.324 Vali Acc: 0.114 Test Loss: 8.324 Test Acc: 0.114
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.2413467
	speed: 0.1623s/iter; left time: 2718.9341s
	iters: 200, epoch: 20 | loss: 0.3738460
	speed: 0.0718s/iter; left time: 1195.5971s
Epoch: 20 cost time: 13.559211015701294
Epoch: 20, Steps: 208 | Train Loss: 0.282 Vali Loss: 8.711 Vali Acc: 0.106 Test Loss: 8.711 Test Acc: 0.106
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.4401055
	speed: 0.1750s/iter; left time: 2895.1134s
	iters: 200, epoch: 21 | loss: 0.3436232
	speed: 0.0472s/iter; left time: 776.1012s
Epoch: 21 cost time: 11.440272569656372
Epoch: 21, Steps: 208 | Train Loss: 0.249 Vali Loss: 10.108 Vali Acc: 0.108 Test Loss: 10.108 Test Acc: 0.108
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12555920071577692
model parameter : 1973567
model size : 10.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1207948
	speed: 0.0834s/iter; left time: 1725.4464s
	iters: 200, epoch: 1 | loss: 5.4834342
	speed: 0.0509s/iter; left time: 1048.4693s
Epoch: 1 cost time: 13.922934532165527
Epoch: 1, Steps: 208 | Train Loss: 4.232 Vali Loss: 4.296 Vali Acc: 0.054 Test Loss: 4.296 Test Acc: 0.054
Validation loss decreased (inf --> -0.053939).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.6738019
	speed: 0.1690s/iter; left time: 3463.3616s
	iters: 200, epoch: 2 | loss: 3.9344893
	speed: 0.0631s/iter; left time: 1287.6669s
Epoch: 2 cost time: 12.506436586380005
Epoch: 2, Steps: 208 | Train Loss: 4.481 Vali Loss: 4.328 Vali Acc: 0.055 Test Loss: 4.328 Test Acc: 0.055
Validation loss decreased (-0.053939 --> -0.055131).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.4734139
	speed: 0.1796s/iter; left time: 3643.4769s
	iters: 200, epoch: 3 | loss: 3.9960976
	speed: 0.0569s/iter; left time: 1148.9335s
Epoch: 3 cost time: 12.91816258430481
Epoch: 3, Steps: 208 | Train Loss: 3.813 Vali Loss: 3.865 Vali Acc: 0.044 Test Loss: 3.865 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.1272771
	speed: 0.1576s/iter; left time: 3164.9723s
	iters: 200, epoch: 4 | loss: 3.5757837
	speed: 0.0587s/iter; left time: 1171.7454s
Epoch: 4 cost time: 12.115590810775757
Epoch: 4, Steps: 208 | Train Loss: 3.561 Vali Loss: 3.981 Vali Acc: 0.060 Test Loss: 3.981 Test Acc: 0.060
Validation loss decreased (-0.055131 --> -0.059907).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2599525
	speed: 0.1675s/iter; left time: 3327.9483s
	iters: 200, epoch: 5 | loss: 3.4532514
	speed: 0.0498s/iter; left time: 985.0544s
Epoch: 5 cost time: 11.8834547996521
Epoch: 5, Steps: 208 | Train Loss: 3.389 Vali Loss: 3.678 Vali Acc: 0.070 Test Loss: 3.678 Test Acc: 0.070
Validation loss decreased (-0.059907 --> -0.070050).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.7414007
	speed: 0.1594s/iter; left time: 3134.3506s
	iters: 200, epoch: 6 | loss: 3.0424073
	speed: 0.0410s/iter; left time: 802.2365s
Epoch: 6 cost time: 10.140449285507202
Epoch: 6, Steps: 208 | Train Loss: 3.166 Vali Loss: 3.363 Vali Acc: 0.089 Test Loss: 3.363 Test Acc: 0.089
Validation loss decreased (-0.070050 --> -0.089438).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.8452761
	speed: 0.1209s/iter; left time: 2352.3219s
	iters: 200, epoch: 7 | loss: 3.1827836
	speed: 0.0336s/iter; left time: 650.4855s
Epoch: 7 cost time: 7.218250751495361
Epoch: 7, Steps: 208 | Train Loss: 2.914 Vali Loss: 3.349 Vali Acc: 0.106 Test Loss: 3.349 Test Acc: 0.106
Validation loss decreased (-0.089438 --> -0.105544).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.6675208
	speed: 0.1525s/iter; left time: 2934.5803s
	iters: 200, epoch: 8 | loss: 2.5754087
	speed: 0.0514s/iter; left time: 984.5600s
Epoch: 8 cost time: 11.635209321975708
Epoch: 8, Steps: 208 | Train Loss: 2.613 Vali Loss: 3.438 Vali Acc: 0.114 Test Loss: 3.438 Test Acc: 0.114
Validation loss decreased (-0.105544 --> -0.114192).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.7616363
	speed: 0.1699s/iter; left time: 3234.8134s
	iters: 200, epoch: 9 | loss: 2.4205515
	speed: 0.0525s/iter; left time: 993.5523s
Epoch: 9 cost time: 11.821203470230103
Epoch: 9, Steps: 208 | Train Loss: 2.277 Vali Loss: 3.563 Vali Acc: 0.110 Test Loss: 3.563 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.7635039
	speed: 0.1445s/iter; left time: 2721.0445s
	iters: 200, epoch: 10 | loss: 1.8889859
	speed: 0.0577s/iter; left time: 1081.2194s
Epoch: 10 cost time: 11.64804220199585
Epoch: 10, Steps: 208 | Train Loss: 1.894 Vali Loss: 3.769 Vali Acc: 0.112 Test Loss: 3.769 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.1153711
	speed: 0.1755s/iter; left time: 3267.3391s
	iters: 200, epoch: 11 | loss: 1.9432969
	speed: 0.0587s/iter; left time: 1087.6331s
Epoch: 11 cost time: 13.233105659484863
Epoch: 11, Steps: 208 | Train Loss: 1.518 Vali Loss: 4.074 Vali Acc: 0.123 Test Loss: 4.074 Test Acc: 0.123
Validation loss decreased (-0.114192 --> -0.123133).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4439799
	speed: 0.1509s/iter; left time: 2778.5898s
	iters: 200, epoch: 12 | loss: 1.9220142
	speed: 0.0527s/iter; left time: 964.8474s
Epoch: 12 cost time: 11.732144832611084
Epoch: 12, Steps: 208 | Train Loss: 1.140 Vali Loss: 4.531 Vali Acc: 0.109 Test Loss: 4.531 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.1506517
	speed: 0.1738s/iter; left time: 3164.6497s
	iters: 200, epoch: 13 | loss: 0.7281142
	speed: 0.0541s/iter; left time: 980.2629s
Epoch: 13 cost time: 12.406213998794556
Epoch: 13, Steps: 208 | Train Loss: 0.882 Vali Loss: 5.395 Vali Acc: 0.115 Test Loss: 5.395 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.3880813
	speed: 0.1451s/iter; left time: 2612.1327s
	iters: 200, epoch: 14 | loss: 1.0019090
	speed: 0.0535s/iter; left time: 957.4685s
Epoch: 14 cost time: 10.557249069213867
Epoch: 14, Steps: 208 | Train Loss: 0.704 Vali Loss: 5.693 Vali Acc: 0.106 Test Loss: 5.693 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.0243348
	speed: 0.1697s/iter; left time: 3018.0117s
	iters: 200, epoch: 15 | loss: 0.7849367
	speed: 0.0629s/iter; left time: 1112.3367s
Epoch: 15 cost time: 12.932174921035767
Epoch: 15, Steps: 208 | Train Loss: 0.586 Vali Loss: 6.179 Vali Acc: 0.111 Test Loss: 6.179 Test Acc: 0.111
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.1766075
	speed: 0.1646s/iter; left time: 2893.8509s
	iters: 200, epoch: 16 | loss: 0.5220730
	speed: 0.0635s/iter; left time: 1109.3534s
Epoch: 16 cost time: 13.373186588287354
Epoch: 16, Steps: 208 | Train Loss: 0.483 Vali Loss: 6.487 Vali Acc: 0.115 Test Loss: 6.487 Test Acc: 0.115
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.0006437
	speed: 0.1825s/iter; left time: 3170.7005s
	iters: 200, epoch: 17 | loss: 0.4749289
	speed: 0.0588s/iter; left time: 1015.2139s
Epoch: 17 cost time: 13.493754625320435
Epoch: 17, Steps: 208 | Train Loss: 0.446 Vali Loss: 7.343 Vali Acc: 0.121 Test Loss: 7.343 Test Acc: 0.121
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0778660
	speed: 0.1746s/iter; left time: 2997.4665s
	iters: 200, epoch: 18 | loss: 0.2812868
	speed: 0.0527s/iter; left time: 899.7124s
Epoch: 18 cost time: 11.40623140335083
Epoch: 18, Steps: 208 | Train Loss: 0.417 Vali Loss: 7.689 Vali Acc: 0.111 Test Loss: 7.689 Test Acc: 0.111
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0475839
	speed: 0.1815s/iter; left time: 3077.1447s
	iters: 200, epoch: 19 | loss: 0.9970613
	speed: 0.0626s/iter; left time: 1055.8362s
Epoch: 19 cost time: 13.107675552368164
Epoch: 19, Steps: 208 | Train Loss: 0.369 Vali Loss: 6.734 Vali Acc: 0.116 Test Loss: 6.734 Test Acc: 0.116
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.4969765
	speed: 0.1779s/iter; left time: 2979.3776s
	iters: 200, epoch: 20 | loss: 0.4152213
	speed: 0.0593s/iter; left time: 987.8429s
Epoch: 20 cost time: 13.40212631225586
Epoch: 20, Steps: 208 | Train Loss: 0.351 Vali Loss: 7.597 Vali Acc: 0.115 Test Loss: 7.597 Test Acc: 0.115
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.3146770
	speed: 0.1537s/iter; left time: 2542.4845s
	iters: 200, epoch: 21 | loss: 0.1281675
	speed: 0.0630s/iter; left time: 1036.4125s
Epoch: 21 cost time: 12.44620680809021
Epoch: 21, Steps: 208 | Train Loss: 0.311 Vali Loss: 8.154 Vali Acc: 0.116 Test Loss: 8.154 Test Acc: 0.116
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12317327766179541
model parameter : 1140799
model size : 5.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0142541
	speed: 0.0705s/iter; left time: 1459.9409s
	iters: 200, epoch: 1 | loss: 4.5758767
	speed: 0.0621s/iter; left time: 1279.7473s
Epoch: 1 cost time: 13.68559217453003
Epoch: 1, Steps: 208 | Train Loss: 4.264 Vali Loss: 4.506 Vali Acc: 0.059 Test Loss: 4.506 Test Acc: 0.059
Validation loss decreased (inf --> -0.058708).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.7138991
	speed: 0.1548s/iter; left time: 3172.2541s
	iters: 200, epoch: 2 | loss: 3.8976083
	speed: 0.0496s/iter; left time: 1011.1258s
Epoch: 2 cost time: 10.918452739715576
Epoch: 2, Steps: 208 | Train Loss: 4.449 Vali Loss: 4.168 Vali Acc: 0.054 Test Loss: 4.168 Test Acc: 0.054
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.6513791
	speed: 0.1612s/iter; left time: 3270.9537s
	iters: 200, epoch: 3 | loss: 3.7772806
	speed: 0.0607s/iter; left time: 1224.4182s
Epoch: 3 cost time: 12.613995790481567
Epoch: 3, Steps: 208 | Train Loss: 3.846 Vali Loss: 3.904 Vali Acc: 0.049 Test Loss: 3.904 Test Acc: 0.049
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 3.6614146
	speed: 0.1703s/iter; left time: 3418.4343s
	iters: 200, epoch: 4 | loss: 3.9138467
	speed: 0.0526s/iter; left time: 1050.7515s
Epoch: 4 cost time: 11.711921453475952
Epoch: 4, Steps: 208 | Train Loss: 3.682 Vali Loss: 3.859 Vali Acc: 0.052 Test Loss: 3.859 Test Acc: 0.052
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 3.1425264
	speed: 0.1403s/iter; left time: 2787.0271s
	iters: 200, epoch: 5 | loss: 3.3591561
	speed: 0.0511s/iter; left time: 1009.2150s
Epoch: 5 cost time: 10.775429487228394
Epoch: 5, Steps: 208 | Train Loss: 3.509 Vali Loss: 3.732 Vali Acc: 0.071 Test Loss: 3.732 Test Acc: 0.071
Validation loss decreased (-0.058708 --> -0.071242).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2587636
	speed: 0.1662s/iter; left time: 3267.2754s
	iters: 200, epoch: 6 | loss: 3.6174417
	speed: 0.0595s/iter; left time: 1164.5305s
Epoch: 6 cost time: 13.03901219367981
Epoch: 6, Steps: 208 | Train Loss: 3.262 Vali Loss: 3.623 Vali Acc: 0.081 Test Loss: 3.623 Test Acc: 0.081
Validation loss decreased (-0.071242 --> -0.081085).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9550292
	speed: 0.1614s/iter; left time: 3139.1685s
	iters: 200, epoch: 7 | loss: 2.5759819
	speed: 0.0575s/iter; left time: 1112.3488s
Epoch: 7 cost time: 12.300206899642944
Epoch: 7, Steps: 208 | Train Loss: 2.944 Vali Loss: 3.616 Vali Acc: 0.081 Test Loss: 3.616 Test Acc: 0.081
Validation loss decreased (-0.081085 --> -0.081085).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.8195910
	speed: 0.1639s/iter; left time: 3154.7907s
	iters: 200, epoch: 8 | loss: 2.5472310
	speed: 0.0527s/iter; left time: 1009.7840s
Epoch: 8 cost time: 11.741906642913818
Epoch: 8, Steps: 208 | Train Loss: 2.587 Vali Loss: 3.664 Vali Acc: 0.086 Test Loss: 3.664 Test Acc: 0.086
Validation loss decreased (-0.081085 --> -0.086453).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7144027
	speed: 0.1547s/iter; left time: 2944.0924s
	iters: 200, epoch: 9 | loss: 1.9877144
	speed: 0.0434s/iter; left time: 822.6995s
Epoch: 9 cost time: 9.641806602478027
Epoch: 9, Steps: 208 | Train Loss: 2.157 Vali Loss: 4.026 Vali Acc: 0.088 Test Loss: 4.026 Test Acc: 0.088
Validation loss decreased (-0.086453 --> -0.088239).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5076098
	speed: 0.1305s/iter; left time: 2457.6650s
	iters: 200, epoch: 10 | loss: 2.4431717
	speed: 0.0364s/iter; left time: 681.2235s
Epoch: 10 cost time: 7.86460018157959
Epoch: 10, Steps: 208 | Train Loss: 1.740 Vali Loss: 4.328 Vali Acc: 0.087 Test Loss: 4.328 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.2229662
	speed: 0.1623s/iter; left time: 3022.9634s
	iters: 200, epoch: 11 | loss: 1.7230591
	speed: 0.0632s/iter; left time: 1169.8025s
Epoch: 11 cost time: 13.206915616989136
Epoch: 11, Steps: 208 | Train Loss: 1.367 Vali Loss: 4.719 Vali Acc: 0.086 Test Loss: 4.719 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.3746140
	speed: 0.1857s/iter; left time: 3420.0701s
	iters: 200, epoch: 12 | loss: 0.8380384
	speed: 0.0599s/iter; left time: 1096.2151s
Epoch: 12 cost time: 14.049896478652954
Epoch: 12, Steps: 208 | Train Loss: 1.008 Vali Loss: 5.261 Vali Acc: 0.091 Test Loss: 5.261 Test Acc: 0.091
Validation loss decreased (-0.088239 --> -0.090911).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.8362462
	speed: 0.1699s/iter; left time: 3093.4395s
	iters: 200, epoch: 13 | loss: 1.2593384
	speed: 0.0632s/iter; left time: 1145.0159s
Epoch: 13 cost time: 12.18781042098999
Epoch: 13, Steps: 208 | Train Loss: 0.791 Vali Loss: 5.896 Vali Acc: 0.085 Test Loss: 5.896 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.6295719
	speed: 0.1829s/iter; left time: 3291.7745s
	iters: 200, epoch: 14 | loss: 0.8662039
	speed: 0.0432s/iter; left time: 772.8547s
Epoch: 14 cost time: 12.081497192382812
Epoch: 14, Steps: 208 | Train Loss: 0.640 Vali Loss: 5.864 Vali Acc: 0.093 Test Loss: 5.864 Test Acc: 0.093
Validation loss decreased (-0.090911 --> -0.093291).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.4189130
	speed: 0.1867s/iter; left time: 3321.3530s
	iters: 200, epoch: 15 | loss: 0.3479857
	speed: 0.0729s/iter; left time: 1289.0656s
Epoch: 15 cost time: 14.414475202560425
Epoch: 15, Steps: 208 | Train Loss: 0.539 Vali Loss: 6.525 Vali Acc: 0.092 Test Loss: 6.525 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.5504261
	speed: 0.1822s/iter; left time: 3203.2730s
	iters: 200, epoch: 16 | loss: 0.5517755
	speed: 0.0690s/iter; left time: 1205.9930s
Epoch: 16 cost time: 14.829878091812134
Epoch: 16, Steps: 208 | Train Loss: 0.471 Vali Loss: 6.706 Vali Acc: 0.098 Test Loss: 6.706 Test Acc: 0.098
Validation loss decreased (-0.093291 --> -0.098054).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.4598882
	speed: 0.1896s/iter; left time: 3293.7211s
	iters: 200, epoch: 17 | loss: 0.3222109
	speed: 0.0559s/iter; left time: 965.0154s
Epoch: 17 cost time: 13.606196880340576
Epoch: 17, Steps: 208 | Train Loss: 0.408 Vali Loss: 7.153 Vali Acc: 0.095 Test Loss: 7.153 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.8671448
	speed: 0.1468s/iter; left time: 2519.2282s
	iters: 200, epoch: 18 | loss: 0.4907899
	speed: 0.0467s/iter; left time: 796.5175s
Epoch: 18 cost time: 9.749114513397217
Epoch: 18, Steps: 208 | Train Loss: 0.372 Vali Loss: 7.489 Vali Acc: 0.088 Test Loss: 7.489 Test Acc: 0.088
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0345141
	speed: 0.1716s/iter; left time: 2909.5389s
	iters: 200, epoch: 19 | loss: 1.1069822
	speed: 0.0520s/iter; left time: 875.8936s
Epoch: 19 cost time: 11.865298509597778
Epoch: 19, Steps: 208 | Train Loss: 0.347 Vali Loss: 7.464 Vali Acc: 0.094 Test Loss: 7.464 Test Acc: 0.094
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.4835906
	speed: 0.1497s/iter; left time: 2508.0256s
	iters: 200, epoch: 20 | loss: 0.2943271
	speed: 0.0618s/iter; left time: 1028.1767s
Epoch: 20 cost time: 11.406985759735107
Epoch: 20, Steps: 208 | Train Loss: 0.328 Vali Loss: 7.959 Vali Acc: 0.091 Test Loss: 7.959 Test Acc: 0.091
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.3831303
	speed: 0.1498s/iter; left time: 2478.1851s
	iters: 200, epoch: 21 | loss: 0.3415505
	speed: 0.0545s/iter; left time: 895.3348s
Epoch: 21 cost time: 11.668893098831177
Epoch: 21, Steps: 208 | Train Loss: 0.325 Vali Loss: 8.041 Vali Acc: 0.090 Test Loss: 8.041 Test Acc: 0.090
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.1096782
	speed: 0.1713s/iter; left time: 2798.2428s
	iters: 200, epoch: 22 | loss: 0.3830443
	speed: 0.0593s/iter; left time: 962.0484s
Epoch: 22 cost time: 12.484100818634033
Epoch: 22, Steps: 208 | Train Loss: 0.313 Vali Loss: 8.121 Vali Acc: 0.089 Test Loss: 8.121 Test Acc: 0.089
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.2413738
	speed: 0.1705s/iter; left time: 2749.3186s
	iters: 200, epoch: 23 | loss: 0.7238957
	speed: 0.0506s/iter; left time: 811.5736s
Epoch: 23 cost time: 11.594159603118896
Epoch: 23, Steps: 208 | Train Loss: 0.296 Vali Loss: 8.560 Vali Acc: 0.089 Test Loss: 8.560 Test Acc: 0.089
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.2739332
	speed: 0.1498s/iter; left time: 2384.9612s
	iters: 200, epoch: 24 | loss: 0.0962193
	speed: 0.0587s/iter; left time: 927.9286s
Epoch: 24 cost time: 12.371388912200928
Epoch: 24, Steps: 208 | Train Loss: 0.257 Vali Loss: 8.859 Vali Acc: 0.092 Test Loss: 8.859 Test Acc: 0.092
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.5153071
	speed: 0.1652s/iter; left time: 2594.7925s
	iters: 200, epoch: 25 | loss: 0.3260458
	speed: 0.0491s/iter; left time: 765.9579s
Epoch: 25 cost time: 11.944932699203491
Epoch: 25, Steps: 208 | Train Loss: 0.253 Vali Loss: 8.938 Vali Acc: 0.098 Test Loss: 8.938 Test Acc: 0.098
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.2046671
	speed: 0.1542s/iter; left time: 2389.6358s
	iters: 200, epoch: 26 | loss: 0.1820174
	speed: 0.0581s/iter; left time: 894.6003s
Epoch: 26 cost time: 11.511445045471191
Epoch: 26, Steps: 208 | Train Loss: 0.250 Vali Loss: 8.766 Vali Acc: 0.092 Test Loss: 8.766 Test Acc: 0.092
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09812108559498957
model parameter : 1139583
model size : 5.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.3684130
	speed: 0.0492s/iter; left time: 1018.5627s
	iters: 200, epoch: 1 | loss: 4.9182458
	speed: 0.0516s/iter; left time: 1062.5690s
Epoch: 1 cost time: 10.573536157608032
Epoch: 1, Steps: 208 | Train Loss: 4.231 Vali Loss: 4.789 Vali Acc: 0.043 Test Loss: 4.789 Test Acc: 0.043
Validation loss decreased (inf --> -0.042899).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.9679196
	speed: 0.1630s/iter; left time: 3340.7389s
	iters: 200, epoch: 2 | loss: 4.0827594
	speed: 0.0562s/iter; left time: 1146.4672s
Epoch: 2 cost time: 12.497176170349121
Epoch: 2, Steps: 208 | Train Loss: 4.364 Vali Loss: 4.293 Vali Acc: 0.054 Test Loss: 4.293 Test Acc: 0.054
Validation loss decreased (-0.042899 --> -0.054237).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7872314
	speed: 0.1548s/iter; left time: 3139.9564s
	iters: 200, epoch: 3 | loss: 3.6432719
	speed: 0.0580s/iter; left time: 1170.9353s
Epoch: 3 cost time: 11.80643606185913
Epoch: 3, Steps: 208 | Train Loss: 3.938 Vali Loss: 3.954 Vali Acc: 0.053 Test Loss: 3.954 Test Acc: 0.053
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.3075430
	speed: 0.1645s/iter; left time: 3303.1043s
	iters: 200, epoch: 4 | loss: 3.8744586
	speed: 0.0492s/iter; left time: 982.7557s
Epoch: 4 cost time: 11.35264253616333
Epoch: 4, Steps: 208 | Train Loss: 3.732 Vali Loss: 3.871 Vali Acc: 0.055 Test Loss: 3.871 Test Acc: 0.055
Validation loss decreased (-0.054237 --> -0.055136).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.9481084
	speed: 0.1682s/iter; left time: 3342.7219s
	iters: 200, epoch: 5 | loss: 2.9901395
	speed: 0.0639s/iter; left time: 1264.0479s
Epoch: 5 cost time: 12.51886796951294
Epoch: 5, Steps: 208 | Train Loss: 3.577 Vali Loss: 3.785 Vali Acc: 0.057 Test Loss: 3.785 Test Acc: 0.057
Validation loss decreased (-0.055136 --> -0.056926).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.6201513
	speed: 0.1475s/iter; left time: 2900.1093s
	iters: 200, epoch: 6 | loss: 3.4296761
	speed: 0.0334s/iter; left time: 653.6092s
Epoch: 6 cost time: 8.030652523040771
Epoch: 6, Steps: 208 | Train Loss: 3.356 Vali Loss: 3.603 Vali Acc: 0.072 Test Loss: 3.603 Test Acc: 0.072
Validation loss decreased (-0.056926 --> -0.072138).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.0633242
	speed: 0.1400s/iter; left time: 2723.5339s
	iters: 200, epoch: 7 | loss: 2.7823060
	speed: 0.0655s/iter; left time: 1267.6754s
Epoch: 7 cost time: 12.316630840301514
Epoch: 7, Steps: 208 | Train Loss: 3.100 Vali Loss: 3.633 Vali Acc: 0.069 Test Loss: 3.633 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.9459920
	speed: 0.1815s/iter; left time: 3493.5934s
	iters: 200, epoch: 8 | loss: 2.9361529
	speed: 0.0400s/iter; left time: 765.5859s
Epoch: 8 cost time: 10.760327577590942
Epoch: 8, Steps: 208 | Train Loss: 2.779 Vali Loss: 3.606 Vali Acc: 0.081 Test Loss: 3.606 Test Acc: 0.081
Validation loss decreased (-0.072138 --> -0.081384).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.1297395
	speed: 0.1840s/iter; left time: 3502.1206s
	iters: 200, epoch: 9 | loss: 2.1527104
	speed: 0.0627s/iter; left time: 1187.0827s
Epoch: 9 cost time: 13.88763952255249
Epoch: 9, Steps: 208 | Train Loss: 2.398 Vali Loss: 3.839 Vali Acc: 0.094 Test Loss: 3.839 Test Acc: 0.094
Validation loss decreased (-0.081384 --> -0.094206).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.5178449
	speed: 0.1737s/iter; left time: 3270.4647s
	iters: 200, epoch: 10 | loss: 1.5322707
	speed: 0.0502s/iter; left time: 940.2278s
Epoch: 10 cost time: 11.810786008834839
Epoch: 10, Steps: 208 | Train Loss: 1.976 Vali Loss: 4.051 Vali Acc: 0.088 Test Loss: 4.051 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.5153614
	speed: 0.1576s/iter; left time: 2935.1387s
	iters: 200, epoch: 11 | loss: 2.4923182
	speed: 0.0579s/iter; left time: 1072.2445s
Epoch: 11 cost time: 12.30575180053711
Epoch: 11, Steps: 208 | Train Loss: 1.542 Vali Loss: 4.295 Vali Acc: 0.097 Test Loss: 4.295 Test Acc: 0.097
Validation loss decreased (-0.094206 --> -0.096587).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.7872275
	speed: 0.1584s/iter; left time: 2917.4685s
	iters: 200, epoch: 12 | loss: 1.2589474
	speed: 0.0489s/iter; left time: 896.0407s
Epoch: 12 cost time: 10.668086528778076
Epoch: 12, Steps: 208 | Train Loss: 1.138 Vali Loss: 4.799 Vali Acc: 0.092 Test Loss: 4.799 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.0572004
	speed: 0.1602s/iter; left time: 2917.1884s
	iters: 200, epoch: 13 | loss: 0.9130976
	speed: 0.0620s/iter; left time: 1122.5598s
Epoch: 13 cost time: 11.921485185623169
Epoch: 13, Steps: 208 | Train Loss: 0.828 Vali Loss: 5.318 Vali Acc: 0.096 Test Loss: 5.318 Test Acc: 0.096
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.5968176
	speed: 0.1664s/iter; left time: 2995.2412s
	iters: 200, epoch: 14 | loss: 0.7655737
	speed: 0.0562s/iter; left time: 1005.0857s
Epoch: 14 cost time: 12.452900409698486
Epoch: 14, Steps: 208 | Train Loss: 0.640 Vali Loss: 5.907 Vali Acc: 0.091 Test Loss: 5.907 Test Acc: 0.091
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.4258400
	speed: 0.1552s/iter; left time: 2761.1012s
	iters: 200, epoch: 15 | loss: 0.4826494
	speed: 0.0607s/iter; left time: 1073.6244s
Epoch: 15 cost time: 12.20413088798523
Epoch: 15, Steps: 208 | Train Loss: 0.501 Vali Loss: 6.064 Vali Acc: 0.094 Test Loss: 6.064 Test Acc: 0.094
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.3662063
	speed: 0.1723s/iter; left time: 3028.9567s
	iters: 200, epoch: 16 | loss: 0.2305494
	speed: 0.0497s/iter; left time: 868.6747s
Epoch: 16 cost time: 12.224622249603271
Epoch: 16, Steps: 208 | Train Loss: 0.419 Vali Loss: 6.561 Vali Acc: 0.098 Test Loss: 6.561 Test Acc: 0.098
Validation loss decreased (-0.096587 --> -0.098055).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.1460366
	speed: 0.1559s/iter; left time: 2709.2560s
	iters: 200, epoch: 17 | loss: 0.5405976
	speed: 0.0528s/iter; left time: 911.4606s
Epoch: 17 cost time: 10.85149359703064
Epoch: 17, Steps: 208 | Train Loss: 0.355 Vali Loss: 6.852 Vali Acc: 0.088 Test Loss: 6.852 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.2947552
	speed: 0.1687s/iter; left time: 2895.8248s
	iters: 200, epoch: 18 | loss: 0.6915426
	speed: 0.0492s/iter; left time: 839.0302s
Epoch: 18 cost time: 11.703240394592285
Epoch: 18, Steps: 208 | Train Loss: 0.303 Vali Loss: 7.284 Vali Acc: 0.093 Test Loss: 7.284 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.1473987
	speed: 0.1759s/iter; left time: 2983.1618s
	iters: 200, epoch: 19 | loss: 0.4794278
	speed: 0.0621s/iter; left time: 1046.0800s
Epoch: 19 cost time: 12.9229154586792
Epoch: 19, Steps: 208 | Train Loss: 0.278 Vali Loss: 7.724 Vali Acc: 0.092 Test Loss: 7.724 Test Acc: 0.092
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.5558772
	speed: 0.1640s/iter; left time: 2746.9233s
	iters: 200, epoch: 20 | loss: 0.4811338
	speed: 0.0457s/iter; left time: 760.2010s
Epoch: 20 cost time: 11.27471137046814
Epoch: 20, Steps: 208 | Train Loss: 0.258 Vali Loss: 7.492 Vali Acc: 0.089 Test Loss: 7.492 Test Acc: 0.089
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.2565769
	speed: 0.1645s/iter; left time: 2720.9804s
	iters: 200, epoch: 21 | loss: 0.4269233
	speed: 0.0495s/iter; left time: 813.5890s
Epoch: 21 cost time: 11.796269655227661
Epoch: 21, Steps: 208 | Train Loss: 0.248 Vali Loss: 8.094 Vali Acc: 0.095 Test Loss: 8.094 Test Acc: 0.095
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0291026
	speed: 0.1625s/iter; left time: 2653.5678s
	iters: 200, epoch: 22 | loss: 0.2719727
	speed: 0.0662s/iter; left time: 1074.7973s
Epoch: 22 cost time: 12.724360704421997
Epoch: 22, Steps: 208 | Train Loss: 0.216 Vali Loss: 7.805 Vali Acc: 0.090 Test Loss: 7.805 Test Acc: 0.090
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0320004
	speed: 0.1801s/iter; left time: 2904.5891s
	iters: 200, epoch: 23 | loss: 0.3651491
	speed: 0.0541s/iter; left time: 866.4563s
Epoch: 23 cost time: 12.119785070419312
Epoch: 23, Steps: 208 | Train Loss: 0.222 Vali Loss: 8.388 Vali Acc: 0.093 Test Loss: 8.388 Test Acc: 0.093
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.1226526
	speed: 0.1904s/iter; left time: 3030.1767s
	iters: 200, epoch: 24 | loss: 0.2222086
	speed: 0.0700s/iter; left time: 1107.6004s
Epoch: 24 cost time: 14.179198503494263
Epoch: 24, Steps: 208 | Train Loss: 0.200 Vali Loss: 8.414 Vali Acc: 0.097 Test Loss: 8.414 Test Acc: 0.097
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.2609003
	speed: 0.1785s/iter; left time: 2803.7446s
	iters: 200, epoch: 25 | loss: 0.0089974
	speed: 0.0516s/iter; left time: 805.4854s
Epoch: 25 cost time: 11.495630741119385
Epoch: 25, Steps: 208 | Train Loss: 0.209 Vali Loss: 9.285 Vali Acc: 0.091 Test Loss: 9.285 Test Acc: 0.091
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.3256314
	speed: 0.1794s/iter; left time: 2781.3231s
	iters: 200, epoch: 26 | loss: 0.0756332
	speed: 0.0485s/iter; left time: 747.1625s
Epoch: 26 cost time: 11.569327592849731
Epoch: 26, Steps: 208 | Train Loss: 0.188 Vali Loss: 9.235 Vali Acc: 0.097 Test Loss: 9.235 Test Acc: 0.097
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.09812108559498957
model parameter : 1138367
model size : 5.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0005603
	speed: 0.0661s/iter; left time: 1369.0924s
	iters: 200, epoch: 1 | loss: 4.2607603
	speed: 0.0513s/iter; left time: 1056.3730s
Epoch: 1 cost time: 12.292471647262573
Epoch: 1, Steps: 208 | Train Loss: 4.257 Vali Loss: 5.442 Vali Acc: 0.038 Test Loss: 5.442 Test Acc: 0.038
Validation loss decreased (inf --> -0.037822).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.0663800
	speed: 0.1652s/iter; left time: 3386.2522s
	iters: 200, epoch: 2 | loss: 4.4953218
	speed: 0.0570s/iter; left time: 1161.6677s
Epoch: 2 cost time: 12.182627201080322
Epoch: 2, Steps: 208 | Train Loss: 4.378 Vali Loss: 4.150 Vali Acc: 0.049 Test Loss: 4.150 Test Acc: 0.049
Validation loss decreased (-0.037822 --> -0.049168).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.0950398
	speed: 0.1357s/iter; left time: 2751.9633s
	iters: 200, epoch: 3 | loss: 3.9487641
	speed: 0.0278s/iter; left time: 560.9886s
Epoch: 3 cost time: 6.812724828720093
Epoch: 3, Steps: 208 | Train Loss: 3.855 Vali Loss: 3.929 Vali Acc: 0.059 Test Loss: 3.929 Test Acc: 0.059
Validation loss decreased (-0.049168 --> -0.059012).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.5983007
	speed: 0.1578s/iter; left time: 3168.8896s
	iters: 200, epoch: 4 | loss: 3.8075109
	speed: 0.0524s/iter; left time: 1046.8431s
Epoch: 4 cost time: 12.166864156723022
Epoch: 4, Steps: 208 | Train Loss: 3.713 Vali Loss: 3.885 Vali Acc: 0.058 Test Loss: 3.885 Test Acc: 0.058
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.6132743
	speed: 0.1602s/iter; left time: 3183.0330s
	iters: 200, epoch: 5 | loss: 3.8915730
	speed: 0.0617s/iter; left time: 1219.4555s
Epoch: 5 cost time: 12.678820371627808
Epoch: 5, Steps: 208 | Train Loss: 3.578 Vali Loss: 3.802 Vali Acc: 0.059 Test Loss: 3.802 Test Acc: 0.059
Validation loss decreased (-0.059012 --> -0.059312).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.4491980
	speed: 0.1522s/iter; left time: 2992.5243s
	iters: 200, epoch: 6 | loss: 3.1393623
	speed: 0.0429s/iter; left time: 839.9685s
Epoch: 6 cost time: 10.941566467285156
Epoch: 6, Steps: 208 | Train Loss: 3.331 Vali Loss: 3.626 Vali Acc: 0.072 Test Loss: 3.626 Test Acc: 0.072
Validation loss decreased (-0.059312 --> -0.072436).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.6805274
	speed: 0.1511s/iter; left time: 2939.3230s
	iters: 200, epoch: 7 | loss: 2.7768276
	speed: 0.0519s/iter; left time: 1005.2613s
Epoch: 7 cost time: 10.485532283782959
Epoch: 7, Steps: 208 | Train Loss: 3.024 Vali Loss: 3.637 Vali Acc: 0.084 Test Loss: 3.637 Test Acc: 0.084
Validation loss decreased (-0.072436 --> -0.084067).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.4438047
	speed: 0.1592s/iter; left time: 3063.3104s
	iters: 200, epoch: 8 | loss: 3.5619025
	speed: 0.0380s/iter; left time: 727.1410s
Epoch: 8 cost time: 10.202567100524902
Epoch: 8, Steps: 208 | Train Loss: 2.676 Vali Loss: 3.709 Vali Acc: 0.076 Test Loss: 3.709 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.8484206
	speed: 0.1588s/iter; left time: 3023.9973s
	iters: 200, epoch: 9 | loss: 2.4956815
	speed: 0.0602s/iter; left time: 1139.9158s
Epoch: 9 cost time: 12.461487293243408
Epoch: 9, Steps: 208 | Train Loss: 2.297 Vali Loss: 3.879 Vali Acc: 0.087 Test Loss: 3.879 Test Acc: 0.087
Validation loss decreased (-0.084067 --> -0.087047).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.1367867
	speed: 0.1482s/iter; left time: 2791.3818s
	iters: 200, epoch: 10 | loss: 2.1486678
	speed: 0.0395s/iter; left time: 739.4904s
Epoch: 10 cost time: 10.443569421768188
Epoch: 10, Steps: 208 | Train Loss: 1.887 Vali Loss: 4.158 Vali Acc: 0.091 Test Loss: 4.158 Test Acc: 0.091
Validation loss decreased (-0.087047 --> -0.090922).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5762980
	speed: 0.1522s/iter; left time: 2834.3381s
	iters: 200, epoch: 11 | loss: 1.5156031
	speed: 0.0568s/iter; left time: 1052.4155s
Epoch: 11 cost time: 11.41497015953064
Epoch: 11, Steps: 208 | Train Loss: 1.520 Vali Loss: 4.514 Vali Acc: 0.093 Test Loss: 4.514 Test Acc: 0.093
Validation loss decreased (-0.090922 --> -0.093006).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.9730943
	speed: 0.1532s/iter; left time: 2820.4321s
	iters: 200, epoch: 12 | loss: 1.2808424
	speed: 0.0490s/iter; left time: 897.8297s
Epoch: 12 cost time: 11.366760969161987
Epoch: 12, Steps: 208 | Train Loss: 1.198 Vali Loss: 4.894 Vali Acc: 0.081 Test Loss: 4.894 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.6432710
	speed: 0.1619s/iter; left time: 2948.2951s
	iters: 200, epoch: 13 | loss: 1.6701763
	speed: 0.0638s/iter; left time: 1154.2980s
Epoch: 13 cost time: 12.444080591201782
Epoch: 13, Steps: 208 | Train Loss: 0.922 Vali Loss: 5.475 Vali Acc: 0.093 Test Loss: 5.475 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.8245310
	speed: 0.1807s/iter; left time: 3251.6450s
	iters: 200, epoch: 14 | loss: 1.1152583
	speed: 0.0620s/iter; left time: 1108.8690s
Epoch: 14 cost time: 13.975274562835693
Epoch: 14, Steps: 208 | Train Loss: 0.767 Vali Loss: 6.006 Vali Acc: 0.092 Test Loss: 6.006 Test Acc: 0.092
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.5998272
	speed: 0.1640s/iter; left time: 2918.1248s
	iters: 200, epoch: 15 | loss: 0.8223546
	speed: 0.0644s/iter; left time: 1139.1552s
Epoch: 15 cost time: 12.53698468208313
Epoch: 15, Steps: 208 | Train Loss: 0.617 Vali Loss: 6.217 Vali Acc: 0.087 Test Loss: 6.217 Test Acc: 0.087
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.4020314
	speed: 0.1826s/iter; left time: 3211.0025s
	iters: 200, epoch: 16 | loss: 0.4583691
	speed: 0.0518s/iter; left time: 904.6648s
Epoch: 16 cost time: 12.469876289367676
Epoch: 16, Steps: 208 | Train Loss: 0.528 Vali Loss: 6.879 Vali Acc: 0.098 Test Loss: 6.879 Test Acc: 0.098
Validation loss decreased (-0.093006 --> -0.097456).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.8130391
	speed: 0.1784s/iter; left time: 3098.7971s
	iters: 200, epoch: 17 | loss: 0.5932110
	speed: 0.0497s/iter; left time: 858.0737s
Epoch: 17 cost time: 11.888394117355347
Epoch: 17, Steps: 208 | Train Loss: 0.476 Vali Loss: 7.111 Vali Acc: 0.103 Test Loss: 7.111 Test Acc: 0.103
Validation loss decreased (-0.097456 --> -0.103418).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.4372542
	speed: 0.1557s/iter; left time: 2672.6019s
	iters: 200, epoch: 18 | loss: 0.5371243
	speed: 0.0551s/iter; left time: 939.8762s
Epoch: 18 cost time: 11.685235261917114
Epoch: 18, Steps: 208 | Train Loss: 0.415 Vali Loss: 7.427 Vali Acc: 0.092 Test Loss: 7.427 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.4173484
	speed: 0.1566s/iter; left time: 2655.2003s
	iters: 200, epoch: 19 | loss: 0.5708334
	speed: 0.0501s/iter; left time: 845.2496s
Epoch: 19 cost time: 11.292634010314941
Epoch: 19, Steps: 208 | Train Loss: 0.438 Vali Loss: 7.205 Vali Acc: 0.089 Test Loss: 7.205 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.2923579
	speed: 0.1582s/iter; left time: 2650.2035s
	iters: 200, epoch: 20 | loss: 0.4077523
	speed: 0.0547s/iter; left time: 911.2932s
Epoch: 20 cost time: 11.294372797012329
Epoch: 20, Steps: 208 | Train Loss: 0.382 Vali Loss: 7.366 Vali Acc: 0.107 Test Loss: 7.366 Test Acc: 0.107
Validation loss decreased (-0.103418 --> -0.106995).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.7384118
	speed: 0.1519s/iter; left time: 2511.9382s
	iters: 200, epoch: 21 | loss: 0.5665044
	speed: 0.0440s/iter; left time: 724.1381s
Epoch: 21 cost time: 10.15120530128479
Epoch: 21, Steps: 208 | Train Loss: 0.343 Vali Loss: 7.932 Vali Acc: 0.095 Test Loss: 7.932 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.1012964
	speed: 0.1480s/iter; left time: 2418.0966s
	iters: 200, epoch: 22 | loss: 0.5623965
	speed: 0.0425s/iter; left time: 689.5308s
Epoch: 22 cost time: 9.886596918106079
Epoch: 22, Steps: 208 | Train Loss: 0.300 Vali Loss: 8.121 Vali Acc: 0.098 Test Loss: 8.121 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0497900
	speed: 0.1007s/iter; left time: 1623.7389s
	iters: 200, epoch: 23 | loss: 0.2947147
	speed: 0.0226s/iter; left time: 362.7861s
Epoch: 23 cost time: 5.414721965789795
Epoch: 23, Steps: 208 | Train Loss: 0.307 Vali Loss: 8.779 Vali Acc: 0.092 Test Loss: 8.779 Test Acc: 0.092
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.1860712
	speed: 0.1462s/iter; left time: 2326.4777s
	iters: 200, epoch: 24 | loss: 0.3686884
	speed: 0.0783s/iter; left time: 1237.7579s
Epoch: 24 cost time: 15.53820252418518
Epoch: 24, Steps: 208 | Train Loss: 0.284 Vali Loss: 8.407 Vali Acc: 0.091 Test Loss: 8.407 Test Acc: 0.091
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.3971409
	speed: 0.1725s/iter; left time: 2709.2246s
	iters: 200, epoch: 25 | loss: 0.2779708
	speed: 0.0686s/iter; left time: 1070.1688s
Epoch: 25 cost time: 13.72378396987915
Epoch: 25, Steps: 208 | Train Loss: 0.265 Vali Loss: 9.123 Vali Acc: 0.094 Test Loss: 9.123 Test Acc: 0.094
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0187334
	speed: 0.1737s/iter; left time: 2693.2729s
	iters: 200, epoch: 26 | loss: 0.0525075
	speed: 0.0595s/iter; left time: 916.9250s
Epoch: 26 cost time: 12.885379076004028
Epoch: 26, Steps: 208 | Train Loss: 0.247 Vali Loss: 8.809 Vali Acc: 0.095 Test Loss: 8.809 Test Acc: 0.095
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.5375003
	speed: 0.1807s/iter; left time: 2763.3322s
	iters: 200, epoch: 27 | loss: 0.0407035
	speed: 0.0652s/iter; left time: 990.2741s
Epoch: 27 cost time: 14.437617778778076
Epoch: 27, Steps: 208 | Train Loss: 0.249 Vali Loss: 8.501 Vali Acc: 0.092 Test Loss: 8.501 Test Acc: 0.092
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0207290
	speed: 0.1682s/iter; left time: 2537.2189s
	iters: 200, epoch: 28 | loss: 0.0266793
	speed: 0.0710s/iter; left time: 1063.9066s
Epoch: 28 cost time: 14.238187789916992
Epoch: 28, Steps: 208 | Train Loss: 0.253 Vali Loss: 8.902 Vali Acc: 0.090 Test Loss: 8.902 Test Acc: 0.090
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.3038459
	speed: 0.1722s/iter; left time: 2561.4908s
	iters: 200, epoch: 29 | loss: 0.4113044
	speed: 0.0638s/iter; left time: 942.3362s
Epoch: 29 cost time: 13.120841026306152
Epoch: 29, Steps: 208 | Train Loss: 0.242 Vali Loss: 9.937 Vali Acc: 0.097 Test Loss: 9.937 Test Acc: 0.097
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.2049067
	speed: 0.1682s/iter; left time: 2467.4180s
	iters: 200, epoch: 30 | loss: 0.0208820
	speed: 0.0614s/iter; left time: 895.1320s
Epoch: 30 cost time: 13.831181049346924
Epoch: 30, Steps: 208 | Train Loss: 0.236 Vali Loss: 9.883 Vali Acc: 0.095 Test Loss: 9.883 Test Acc: 0.095
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10706829704742023
model parameter : 1137151
model size : 5.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.5673633
	speed: 0.0840s/iter; left time: 1738.3745s
	iters: 200, epoch: 1 | loss: 4.5293303
	speed: 0.0626s/iter; left time: 1289.0555s
Epoch: 1 cost time: 15.344480991363525
Epoch: 1, Steps: 208 | Train Loss: 4.261 Vali Loss: 4.753 Vali Acc: 0.042 Test Loss: 4.753 Test Acc: 0.042
Validation loss decreased (inf --> -0.042303).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.9087706
	speed: 0.2025s/iter; left time: 4150.6014s
	iters: 200, epoch: 2 | loss: 4.4071326
	speed: 0.0644s/iter; left time: 1312.3240s
Epoch: 2 cost time: 15.418251991271973
Epoch: 2, Steps: 208 | Train Loss: 4.537 Vali Loss: 4.873 Vali Acc: 0.046 Test Loss: 4.873 Test Acc: 0.046
Validation loss decreased (-0.042303 --> -0.045880).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.2525835
	speed: 0.1904s/iter; left time: 3862.4623s
	iters: 200, epoch: 3 | loss: 4.3320947
	speed: 0.0755s/iter; left time: 1524.8772s
Epoch: 3 cost time: 16.274210929870605
Epoch: 3, Steps: 208 | Train Loss: 3.996 Vali Loss: 4.042 Vali Acc: 0.055 Test Loss: 4.042 Test Acc: 0.055
Validation loss decreased (-0.045880 --> -0.055432).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.6672158
	speed: 0.1821s/iter; left time: 3655.5691s
	iters: 200, epoch: 4 | loss: 3.3998184
	speed: 0.0612s/iter; left time: 1221.9131s
Epoch: 4 cost time: 13.047304153442383
Epoch: 4, Steps: 208 | Train Loss: 3.657 Vali Loss: 3.808 Vali Acc: 0.056 Test Loss: 3.808 Test Acc: 0.056
Validation loss decreased (-0.055432 --> -0.056329).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.5336754
	speed: 0.1806s/iter; left time: 3588.7602s
	iters: 200, epoch: 5 | loss: 3.7504036
	speed: 0.0669s/iter; left time: 1323.2293s
Epoch: 5 cost time: 14.360143661499023
Epoch: 5, Steps: 208 | Train Loss: 3.469 Vali Loss: 3.707 Vali Acc: 0.073 Test Loss: 3.707 Test Acc: 0.073
Validation loss decreased (-0.056329 --> -0.073032).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.4428198
	speed: 0.1836s/iter; left time: 3609.4577s
	iters: 200, epoch: 6 | loss: 3.1836696
	speed: 0.0745s/iter; left time: 1458.2046s
Epoch: 6 cost time: 16.044611930847168
Epoch: 6, Steps: 208 | Train Loss: 3.212 Vali Loss: 3.686 Vali Acc: 0.069 Test Loss: 3.686 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 3.3379660
	speed: 0.1708s/iter; left time: 3321.9836s
	iters: 200, epoch: 7 | loss: 3.0890954
	speed: 0.0713s/iter; left time: 1380.5612s
Epoch: 7 cost time: 14.54324984550476
Epoch: 7, Steps: 208 | Train Loss: 2.964 Vali Loss: 3.524 Vali Acc: 0.095 Test Loss: 3.524 Test Acc: 0.095
Validation loss decreased (-0.073032 --> -0.094805).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.0355363
	speed: 0.1814s/iter; left time: 3490.7108s
	iters: 200, epoch: 8 | loss: 2.4482636
	speed: 0.0585s/iter; left time: 1120.2269s
Epoch: 8 cost time: 12.716866970062256
Epoch: 8, Steps: 208 | Train Loss: 2.740 Vali Loss: 3.454 Vali Acc: 0.087 Test Loss: 3.454 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.7146451
	speed: 0.1657s/iter; left time: 3155.0324s
	iters: 200, epoch: 9 | loss: 2.5425870
	speed: 0.0645s/iter; left time: 1221.6725s
Epoch: 9 cost time: 14.219433546066284
Epoch: 9, Steps: 208 | Train Loss: 2.457 Vali Loss: 3.668 Vali Acc: 0.106 Test Loss: 3.668 Test Acc: 0.106
Validation loss decreased (-0.094805 --> -0.105540).  Saving model ...
	iters: 100, epoch: 10 | loss: 3.1676834
	speed: 0.1901s/iter; left time: 3580.1394s
	iters: 200, epoch: 10 | loss: 2.3557990
	speed: 0.0746s/iter; left time: 1397.9701s
Epoch: 10 cost time: 15.649731159210205
Epoch: 10, Steps: 208 | Train Loss: 2.119 Vali Loss: 3.770 Vali Acc: 0.103 Test Loss: 3.770 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.5041103
	speed: 0.1617s/iter; left time: 3010.6077s
	iters: 200, epoch: 11 | loss: 2.1132462
	speed: 0.0537s/iter; left time: 995.3009s
Epoch: 11 cost time: 11.95028567314148
Epoch: 11, Steps: 208 | Train Loss: 1.725 Vali Loss: 4.153 Vali Acc: 0.102 Test Loss: 4.153 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.7154186
	speed: 0.1836s/iter; left time: 3380.1367s
	iters: 200, epoch: 12 | loss: 1.3276023
	speed: 0.0602s/iter; left time: 1101.5463s
Epoch: 12 cost time: 13.98563814163208
Epoch: 12, Steps: 208 | Train Loss: 1.347 Vali Loss: 4.805 Vali Acc: 0.099 Test Loss: 4.805 Test Acc: 0.099
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.9687356
	speed: 0.1773s/iter; left time: 3227.0958s
	iters: 200, epoch: 13 | loss: 0.6448632
	speed: 0.0715s/iter; left time: 1293.6215s
Epoch: 13 cost time: 14.919911861419678
Epoch: 13, Steps: 208 | Train Loss: 1.020 Vali Loss: 5.172 Vali Acc: 0.110 Test Loss: 5.172 Test Acc: 0.110
Validation loss decreased (-0.105540 --> -0.110297).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.6441622
	speed: 0.1700s/iter; left time: 3059.5483s
	iters: 200, epoch: 14 | loss: 1.2217306
	speed: 0.0741s/iter; left time: 1325.3932s
Epoch: 14 cost time: 14.509236097335815
Epoch: 14, Steps: 208 | Train Loss: 0.772 Vali Loss: 5.916 Vali Acc: 0.112 Test Loss: 5.916 Test Acc: 0.112
Validation loss decreased (-0.110297 --> -0.111781).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.5229712
	speed: 0.1862s/iter; left time: 3312.3550s
	iters: 200, epoch: 15 | loss: 0.8486922
	speed: 0.0620s/iter; left time: 1096.6041s
Epoch: 15 cost time: 14.39798092842102
Epoch: 15, Steps: 208 | Train Loss: 0.653 Vali Loss: 6.424 Vali Acc: 0.106 Test Loss: 6.424 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.7490789
	speed: 0.1814s/iter; left time: 3188.7736s
	iters: 200, epoch: 16 | loss: 0.5659740
	speed: 0.0596s/iter; left time: 1041.5529s
Epoch: 16 cost time: 14.168834686279297
Epoch: 16, Steps: 208 | Train Loss: 0.546 Vali Loss: 6.602 Vali Acc: 0.103 Test Loss: 6.602 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.2769672
	speed: 0.1830s/iter; left time: 3178.9039s
	iters: 200, epoch: 17 | loss: 0.4185906
	speed: 0.0702s/iter; left time: 1211.8536s
Epoch: 17 cost time: 14.723104000091553
Epoch: 17, Steps: 208 | Train Loss: 0.487 Vali Loss: 7.031 Vali Acc: 0.109 Test Loss: 7.031 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.1899026
	speed: 0.1774s/iter; left time: 3045.9015s
	iters: 200, epoch: 18 | loss: 0.7027484
	speed: 0.0631s/iter; left time: 1076.8320s
Epoch: 18 cost time: 13.5942223072052
Epoch: 18, Steps: 208 | Train Loss: 0.419 Vali Loss: 7.264 Vali Acc: 0.114 Test Loss: 7.264 Test Acc: 0.114
Validation loss decreased (-0.111781 --> -0.113557).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.5408999
	speed: 0.1932s/iter; left time: 3275.4526s
	iters: 200, epoch: 19 | loss: 0.4332042
	speed: 0.0655s/iter; left time: 1104.1294s
Epoch: 19 cost time: 14.90024209022522
Epoch: 19, Steps: 208 | Train Loss: 0.367 Vali Loss: 7.352 Vali Acc: 0.106 Test Loss: 7.352 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.3256307
	speed: 0.2064s/iter; left time: 3456.7666s
	iters: 200, epoch: 20 | loss: 0.5798857
	speed: 0.0767s/iter; left time: 1276.1641s
Epoch: 20 cost time: 16.9853355884552
Epoch: 20, Steps: 208 | Train Loss: 0.350 Vali Loss: 7.957 Vali Acc: 0.108 Test Loss: 7.957 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.6906610
	speed: 0.1889s/iter; left time: 3123.9485s
	iters: 200, epoch: 21 | loss: 0.9316040
	speed: 0.0779s/iter; left time: 1281.0315s
Epoch: 21 cost time: 15.22361135482788
Epoch: 21, Steps: 208 | Train Loss: 0.329 Vali Loss: 8.051 Vali Acc: 0.115 Test Loss: 8.051 Test Acc: 0.115
Validation loss decreased (-0.113557 --> -0.114742).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.3680134
	speed: 0.1972s/iter; left time: 3221.0286s
	iters: 200, epoch: 22 | loss: 0.4067492
	speed: 0.0687s/iter; left time: 1115.8945s
Epoch: 22 cost time: 14.405802249908447
Epoch: 22, Steps: 208 | Train Loss: 0.313 Vali Loss: 8.434 Vali Acc: 0.111 Test Loss: 8.434 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0851441
	speed: 0.2134s/iter; left time: 3441.2004s
	iters: 200, epoch: 23 | loss: 0.0442443
	speed: 0.0746s/iter; left time: 1194.7777s
Epoch: 23 cost time: 16.884997129440308
Epoch: 23, Steps: 208 | Train Loss: 0.287 Vali Loss: 8.555 Vali Acc: 0.114 Test Loss: 8.555 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.3293253
	speed: 0.1945s/iter; left time: 3095.2699s
	iters: 200, epoch: 24 | loss: 0.3570893
	speed: 0.0719s/iter; left time: 1137.5413s
Epoch: 24 cost time: 15.21514892578125
Epoch: 24, Steps: 208 | Train Loss: 0.261 Vali Loss: 8.598 Vali Acc: 0.116 Test Loss: 8.598 Test Acc: 0.116
Validation loss decreased (-0.114742 --> -0.115631).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0405872
	speed: 0.1646s/iter; left time: 2586.1110s
	iters: 200, epoch: 25 | loss: 0.2099449
	speed: 0.0696s/iter; left time: 1086.0274s
Epoch: 25 cost time: 13.742658615112305
Epoch: 25, Steps: 208 | Train Loss: 0.266 Vali Loss: 9.131 Vali Acc: 0.111 Test Loss: 9.131 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.3216960
	speed: 0.1867s/iter; left time: 2894.7219s
	iters: 200, epoch: 26 | loss: 0.1879877
	speed: 0.0610s/iter; left time: 939.3909s
Epoch: 26 cost time: 13.025362014770508
Epoch: 26, Steps: 208 | Train Loss: 0.262 Vali Loss: 9.185 Vali Acc: 0.110 Test Loss: 9.185 Test Acc: 0.110
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0094588
	speed: 0.1389s/iter; left time: 2124.2555s
	iters: 200, epoch: 27 | loss: 0.1489722
	speed: 0.0330s/iter; left time: 500.9207s
Epoch: 27 cost time: 7.4175004959106445
Epoch: 27, Steps: 208 | Train Loss: 0.260 Vali Loss: 8.976 Vali Acc: 0.105 Test Loss: 8.976 Test Acc: 0.105
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.1843751
	speed: 0.1612s/iter; left time: 2431.5079s
	iters: 200, epoch: 28 | loss: 0.3155118
	speed: 0.0652s/iter; left time: 977.4127s
Epoch: 28 cost time: 14.267863512039185
Epoch: 28, Steps: 208 | Train Loss: 0.223 Vali Loss: 9.461 Vali Acc: 0.097 Test Loss: 9.461 Test Acc: 0.097
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.2219954
	speed: 0.1695s/iter; left time: 2521.3165s
	iters: 200, epoch: 29 | loss: 0.0180546
	speed: 0.0697s/iter; left time: 1030.5573s
Epoch: 29 cost time: 13.346345901489258
Epoch: 29, Steps: 208 | Train Loss: 0.218 Vali Loss: 9.415 Vali Acc: 0.108 Test Loss: 9.415 Test Acc: 0.108
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0609506
	speed: 0.1522s/iter; left time: 2232.4529s
	iters: 200, epoch: 30 | loss: 0.2495216
	speed: 0.0526s/iter; left time: 765.6849s
Epoch: 30 cost time: 10.99716305732727
Epoch: 30, Steps: 208 | Train Loss: 0.203 Vali Loss: 9.782 Vali Acc: 0.111 Test Loss: 9.782 Test Acc: 0.111
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.6577673
	speed: 0.1675s/iter; left time: 2422.8569s
	iters: 200, epoch: 31 | loss: 0.0086537
	speed: 0.0724s/iter; left time: 1039.9814s
Epoch: 31 cost time: 15.005992889404297
Epoch: 31, Steps: 208 | Train Loss: 0.241 Vali Loss: 9.878 Vali Acc: 0.111 Test Loss: 9.878 Test Acc: 0.111
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.1100203
	speed: 0.1788s/iter; left time: 2547.8975s
	iters: 200, epoch: 32 | loss: 0.6558132
	speed: 0.0669s/iter; left time: 946.6350s
Epoch: 32 cost time: 14.020272493362427
Epoch: 32, Steps: 208 | Train Loss: 0.224 Vali Loss: 9.666 Vali Acc: 0.111 Test Loss: 9.666 Test Acc: 0.111
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0379161
	speed: 0.1727s/iter; left time: 2425.6335s
	iters: 200, epoch: 33 | loss: 0.3275471
	speed: 0.0527s/iter; left time: 735.0079s
Epoch: 33 cost time: 12.550914287567139
Epoch: 33, Steps: 208 | Train Loss: 0.221 Vali Loss: 9.880 Vali Acc: 0.112 Test Loss: 9.880 Test Acc: 0.112
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.1101320
	speed: 0.1748s/iter; left time: 2418.1760s
	iters: 200, epoch: 34 | loss: 0.0053380
	speed: 0.0640s/iter; left time: 879.2794s
Epoch: 34 cost time: 14.097103118896484
Epoch: 34, Steps: 208 | Train Loss: 0.196 Vali Loss: 10.597 Vali Acc: 0.113 Test Loss: 10.597 Test Acc: 0.113
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11571726811810319
model parameter : 942655
model size : 4.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.4708037
	speed: 0.0826s/iter; left time: 1709.2118s
	iters: 200, epoch: 1 | loss: 5.0980172
	speed: 0.0620s/iter; left time: 1277.9963s
Epoch: 1 cost time: 14.78728699684143
Epoch: 1, Steps: 208 | Train Loss: 4.263 Vali Loss: 4.602 Vali Acc: 0.043 Test Loss: 4.602 Test Acc: 0.043
Validation loss decreased (inf --> -0.043199).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7965217
	speed: 0.1724s/iter; left time: 3533.3195s
	iters: 200, epoch: 2 | loss: 3.6368098
	speed: 0.0610s/iter; left time: 1244.1681s
Epoch: 2 cost time: 13.746003150939941
Epoch: 2, Steps: 208 | Train Loss: 4.536 Vali Loss: 4.869 Vali Acc: 0.058 Test Loss: 4.869 Test Acc: 0.058
Validation loss decreased (-0.043199 --> -0.057512).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.3336544
	speed: 0.1925s/iter; left time: 3904.4070s
	iters: 200, epoch: 3 | loss: 4.6607819
	speed: 0.0736s/iter; left time: 1484.9754s
Epoch: 3 cost time: 15.642107725143433
Epoch: 3, Steps: 208 | Train Loss: 3.977 Vali Loss: 4.066 Vali Acc: 0.052 Test Loss: 4.066 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.7231925
	speed: 0.1823s/iter; left time: 3660.6703s
	iters: 200, epoch: 4 | loss: 3.7835019
	speed: 0.0690s/iter; left time: 1379.3593s
Epoch: 4 cost time: 14.561862230300903
Epoch: 4, Steps: 208 | Train Loss: 3.758 Vali Loss: 3.996 Vali Acc: 0.054 Test Loss: 3.996 Test Acc: 0.054
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 3.8247354
	speed: 0.1955s/iter; left time: 3883.7461s
	iters: 200, epoch: 5 | loss: 3.7002645
	speed: 0.0766s/iter; left time: 1514.0167s
Epoch: 5 cost time: 16.05552864074707
Epoch: 5, Steps: 208 | Train Loss: 3.600 Vali Loss: 3.803 Vali Acc: 0.056 Test Loss: 3.803 Test Acc: 0.056
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 3.1451347
	speed: 0.1890s/iter; left time: 3715.4594s
	iters: 200, epoch: 6 | loss: 3.1628661
	speed: 0.0760s/iter; left time: 1486.9916s
Epoch: 6 cost time: 16.278181552886963
Epoch: 6, Steps: 208 | Train Loss: 3.454 Vali Loss: 3.691 Vali Acc: 0.068 Test Loss: 3.691 Test Acc: 0.068
Validation loss decreased (-0.057512 --> -0.067664).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.3111186
	speed: 0.1896s/iter; left time: 3687.8765s
	iters: 200, epoch: 7 | loss: 3.0334413
	speed: 0.0484s/iter; left time: 937.2701s
Epoch: 7 cost time: 12.791738986968994
Epoch: 7, Steps: 208 | Train Loss: 3.231 Vali Loss: 3.648 Vali Acc: 0.074 Test Loss: 3.648 Test Acc: 0.074
Validation loss decreased (-0.067664 --> -0.074225).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.7759943
	speed: 0.1848s/iter; left time: 3555.5301s
	iters: 200, epoch: 8 | loss: 2.8533492
	speed: 0.0618s/iter; left time: 1183.4371s
Epoch: 8 cost time: 13.994308233261108
Epoch: 8, Steps: 208 | Train Loss: 2.879 Vali Loss: 3.574 Vali Acc: 0.088 Test Loss: 3.574 Test Acc: 0.088
Validation loss decreased (-0.074225 --> -0.088243).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9135580
	speed: 0.1685s/iter; left time: 3207.6988s
	iters: 200, epoch: 9 | loss: 2.3159204
	speed: 0.0717s/iter; left time: 1358.0133s
Epoch: 9 cost time: 14.931362628936768
Epoch: 9, Steps: 208 | Train Loss: 2.511 Vali Loss: 3.685 Vali Acc: 0.086 Test Loss: 3.685 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.2574797
	speed: 0.1693s/iter; left time: 3187.3938s
	iters: 200, epoch: 10 | loss: 2.0112786
	speed: 0.0582s/iter; left time: 1090.4411s
Epoch: 10 cost time: 12.377874374389648
Epoch: 10, Steps: 208 | Train Loss: 2.154 Vali Loss: 3.871 Vali Acc: 0.092 Test Loss: 3.871 Test Acc: 0.092
Validation loss decreased (-0.088243 --> -0.092416).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.8005706
	speed: 0.1769s/iter; left time: 3293.1488s
	iters: 200, epoch: 11 | loss: 2.0472970
	speed: 0.0616s/iter; left time: 1141.0400s
Epoch: 11 cost time: 14.101709604263306
Epoch: 11, Steps: 208 | Train Loss: 1.777 Vali Loss: 4.119 Vali Acc: 0.093 Test Loss: 4.119 Test Acc: 0.093
Validation loss decreased (-0.092416 --> -0.092712).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.9573982
	speed: 0.1784s/iter; left time: 3285.7407s
	iters: 200, epoch: 12 | loss: 1.2219195
	speed: 0.0672s/iter; left time: 1230.1776s
Epoch: 12 cost time: 14.092170000076294
Epoch: 12, Steps: 208 | Train Loss: 1.392 Vali Loss: 4.585 Vali Acc: 0.094 Test Loss: 4.585 Test Acc: 0.094
Validation loss decreased (-0.092712 --> -0.094198).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.1745439
	speed: 0.1703s/iter; left time: 3099.6439s
	iters: 200, epoch: 13 | loss: 1.3393784
	speed: 0.0705s/iter; left time: 1276.0189s
Epoch: 13 cost time: 14.384859800338745
Epoch: 13, Steps: 208 | Train Loss: 1.074 Vali Loss: 4.959 Vali Acc: 0.098 Test Loss: 4.959 Test Acc: 0.098
Validation loss decreased (-0.094198 --> -0.098370).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.8465598
	speed: 0.1697s/iter; left time: 3053.6378s
	iters: 200, epoch: 14 | loss: 0.9152138
	speed: 0.0583s/iter; left time: 1042.8736s
Epoch: 14 cost time: 12.884629487991333
Epoch: 14, Steps: 208 | Train Loss: 0.812 Vali Loss: 5.628 Vali Acc: 0.096 Test Loss: 5.628 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.3858930
	speed: 0.1832s/iter; left time: 3259.3783s
	iters: 200, epoch: 15 | loss: 0.4487604
	speed: 0.0608s/iter; left time: 1074.6583s
Epoch: 15 cost time: 14.015644788742065
Epoch: 15, Steps: 208 | Train Loss: 0.632 Vali Loss: 5.887 Vali Acc: 0.103 Test Loss: 5.887 Test Acc: 0.103
Validation loss decreased (-0.098370 --> -0.103431).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.4970774
	speed: 0.1726s/iter; left time: 3034.9698s
	iters: 200, epoch: 16 | loss: 0.5921025
	speed: 0.0664s/iter; left time: 1160.9916s
Epoch: 16 cost time: 14.390895366668701
Epoch: 16, Steps: 208 | Train Loss: 0.518 Vali Loss: 6.390 Vali Acc: 0.095 Test Loss: 6.390 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.5277157
	speed: 0.1588s/iter; left time: 2759.1236s
	iters: 200, epoch: 17 | loss: 0.2418054
	speed: 0.0586s/iter; left time: 1012.2490s
Epoch: 17 cost time: 12.346107244491577
Epoch: 17, Steps: 208 | Train Loss: 0.442 Vali Loss: 6.317 Vali Acc: 0.092 Test Loss: 6.317 Test Acc: 0.092
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.2830774
	speed: 0.1667s/iter; left time: 2861.1417s
	iters: 200, epoch: 18 | loss: 0.1832289
	speed: 0.0608s/iter; left time: 1036.8419s
Epoch: 18 cost time: 13.216645956039429
Epoch: 18, Steps: 208 | Train Loss: 0.373 Vali Loss: 6.821 Vali Acc: 0.097 Test Loss: 6.821 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.3778530
	speed: 0.1760s/iter; left time: 2984.7631s
	iters: 200, epoch: 19 | loss: 0.6596857
	speed: 0.0626s/iter; left time: 1054.8384s
Epoch: 19 cost time: 13.961038827896118
Epoch: 19, Steps: 208 | Train Loss: 0.345 Vali Loss: 7.285 Vali Acc: 0.092 Test Loss: 7.285 Test Acc: 0.092
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.1785151
	speed: 0.1642s/iter; left time: 2749.9233s
	iters: 200, epoch: 20 | loss: 0.2516361
	speed: 0.0663s/iter; left time: 1103.4388s
Epoch: 20 cost time: 13.737254619598389
Epoch: 20, Steps: 208 | Train Loss: 0.309 Vali Loss: 7.383 Vali Acc: 0.095 Test Loss: 7.383 Test Acc: 0.095
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.4052456
	speed: 0.1782s/iter; left time: 2946.8302s
	iters: 200, epoch: 21 | loss: 0.1919516
	speed: 0.0591s/iter; left time: 971.0381s
Epoch: 21 cost time: 13.403321981430054
Epoch: 21, Steps: 208 | Train Loss: 0.278 Vali Loss: 7.508 Vali Acc: 0.099 Test Loss: 7.508 Test Acc: 0.099
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.6115852
	speed: 0.1761s/iter; left time: 2876.3372s
	iters: 200, epoch: 22 | loss: 0.1396851
	speed: 0.0728s/iter; left time: 1181.4668s
Epoch: 22 cost time: 15.078343868255615
Epoch: 22, Steps: 208 | Train Loss: 0.266 Vali Loss: 7.993 Vali Acc: 0.094 Test Loss: 7.993 Test Acc: 0.094
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 1.0195558
	speed: 0.1984s/iter; left time: 3199.0582s
	iters: 200, epoch: 23 | loss: 0.5204038
	speed: 0.0811s/iter; left time: 1298.9771s
Epoch: 23 cost time: 16.686986684799194
Epoch: 23, Steps: 208 | Train Loss: 0.263 Vali Loss: 8.022 Vali Acc: 0.095 Test Loss: 8.022 Test Acc: 0.095
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0931413
	speed: 0.1829s/iter; left time: 2910.5080s
	iters: 200, epoch: 24 | loss: 0.4736468
	speed: 0.0629s/iter; left time: 994.6993s
Epoch: 24 cost time: 13.34842848777771
Epoch: 24, Steps: 208 | Train Loss: 0.251 Vali Loss: 8.312 Vali Acc: 0.098 Test Loss: 8.312 Test Acc: 0.098
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0607547
	speed: 0.1967s/iter; left time: 3090.0492s
	iters: 200, epoch: 25 | loss: 0.4260186
	speed: 0.0535s/iter; left time: 835.3536s
Epoch: 25 cost time: 12.935849666595459
Epoch: 25, Steps: 208 | Train Loss: 0.228 Vali Loss: 8.631 Vali Acc: 0.095 Test Loss: 8.631 Test Acc: 0.095
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10348941246644795
model parameter : 941439
model size : 4.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.2294626
	speed: 0.0760s/iter; left time: 1572.7494s
	iters: 200, epoch: 1 | loss: 4.6822643
	speed: 0.0501s/iter; left time: 1031.8101s
Epoch: 1 cost time: 13.190710306167603
Epoch: 1, Steps: 208 | Train Loss: 4.217 Vali Loss: 4.417 Vali Acc: 0.044 Test Loss: 4.417 Test Acc: 0.044
Validation loss decreased (inf --> -0.043499).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.1497302
	speed: 0.1822s/iter; left time: 3732.9839s
	iters: 200, epoch: 2 | loss: 3.6618235
	speed: 0.0627s/iter; left time: 1278.8831s
Epoch: 2 cost time: 14.100049018859863
Epoch: 2, Steps: 208 | Train Loss: 4.437 Vali Loss: 4.143 Vali Acc: 0.048 Test Loss: 4.143 Test Acc: 0.048
Validation loss decreased (-0.043499 --> -0.047975).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.3133721
	speed: 0.1703s/iter; left time: 3453.7349s
	iters: 200, epoch: 3 | loss: 3.8570108
	speed: 0.0707s/iter; left time: 1426.4931s
Epoch: 3 cost time: 14.173622369766235
Epoch: 3, Steps: 208 | Train Loss: 3.827 Vali Loss: 3.785 Vali Acc: 0.053 Test Loss: 3.785 Test Acc: 0.053
Validation loss decreased (-0.047975 --> -0.053049).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.1739187
	speed: 0.1644s/iter; left time: 3299.8047s
	iters: 200, epoch: 4 | loss: 3.7134056
	speed: 0.0654s/iter; left time: 1306.3899s
Epoch: 4 cost time: 13.57857346534729
Epoch: 4, Steps: 208 | Train Loss: 3.608 Vali Loss: 3.781 Vali Acc: 0.060 Test Loss: 3.781 Test Acc: 0.060
Validation loss decreased (-0.053049 --> -0.059909).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3147106
	speed: 0.1730s/iter; left time: 3436.3914s
	iters: 200, epoch: 5 | loss: 3.4009917
	speed: 0.0607s/iter; left time: 1200.9246s
Epoch: 5 cost time: 13.239536046981812
Epoch: 5, Steps: 208 | Train Loss: 3.425 Vali Loss: 3.585 Vali Acc: 0.076 Test Loss: 3.585 Test Acc: 0.076
Validation loss decreased (-0.059909 --> -0.075717).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2429204
	speed: 0.1354s/iter; left time: 2661.4817s
	iters: 200, epoch: 6 | loss: 3.2981367
	speed: 0.0288s/iter; left time: 563.1271s
Epoch: 6 cost time: 6.712137222290039
Epoch: 6, Steps: 208 | Train Loss: 3.202 Vali Loss: 3.503 Vali Acc: 0.087 Test Loss: 3.503 Test Acc: 0.087
Validation loss decreased (-0.075717 --> -0.086753).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.2076254
	speed: 0.1315s/iter; left time: 2558.4581s
	iters: 200, epoch: 7 | loss: 3.0459943
	speed: 0.0664s/iter; left time: 1285.6244s
Epoch: 7 cost time: 11.687463760375977
Epoch: 7, Steps: 208 | Train Loss: 2.968 Vali Loss: 3.270 Vali Acc: 0.101 Test Loss: 3.270 Test Acc: 0.101
Validation loss decreased (-0.086753 --> -0.101369).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.6452131
	speed: 0.1730s/iter; left time: 3329.0957s
	iters: 200, epoch: 8 | loss: 2.6500783
	speed: 0.0622s/iter; left time: 1190.5123s
Epoch: 8 cost time: 13.61323881149292
Epoch: 8, Steps: 208 | Train Loss: 2.644 Vali Loss: 3.296 Vali Acc: 0.110 Test Loss: 3.296 Test Acc: 0.110
Validation loss decreased (-0.101369 --> -0.109720).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.4475396
	speed: 0.1714s/iter; left time: 3263.8542s
	iters: 200, epoch: 9 | loss: 2.3907619
	speed: 0.0676s/iter; left time: 1280.2467s
Epoch: 9 cost time: 14.020963430404663
Epoch: 9, Steps: 208 | Train Loss: 2.323 Vali Loss: 3.642 Vali Acc: 0.113 Test Loss: 3.642 Test Acc: 0.113
Validation loss decreased (-0.109720 --> -0.112997).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.9879426
	speed: 0.1674s/iter; left time: 3152.7144s
	iters: 200, epoch: 10 | loss: 2.1369665
	speed: 0.0679s/iter; left time: 1271.1294s
Epoch: 10 cost time: 13.31842589378357
Epoch: 10, Steps: 208 | Train Loss: 1.901 Vali Loss: 3.846 Vali Acc: 0.111 Test Loss: 3.846 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.0794090
	speed: 0.1695s/iter; left time: 3156.9842s
	iters: 200, epoch: 11 | loss: 1.4138900
	speed: 0.0613s/iter; left time: 1136.2244s
Epoch: 11 cost time: 13.347699403762817
Epoch: 11, Steps: 208 | Train Loss: 1.467 Vali Loss: 4.455 Vali Acc: 0.110 Test Loss: 4.455 Test Acc: 0.110
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.8657236
	speed: 0.1797s/iter; left time: 3308.6852s
	iters: 200, epoch: 12 | loss: 1.6826197
	speed: 0.0649s/iter; left time: 1188.9361s
Epoch: 12 cost time: 14.61185097694397
Epoch: 12, Steps: 208 | Train Loss: 1.105 Vali Loss: 4.626 Vali Acc: 0.114 Test Loss: 4.626 Test Acc: 0.114
Validation loss decreased (-0.112997 --> -0.114180).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.9263057
	speed: 0.1547s/iter; left time: 2816.2079s
	iters: 200, epoch: 13 | loss: 1.0458353
	speed: 0.0655s/iter; left time: 1185.7351s
Epoch: 13 cost time: 14.100497722625732
Epoch: 13, Steps: 208 | Train Loss: 0.838 Vali Loss: 5.221 Vali Acc: 0.106 Test Loss: 5.221 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.3983872
	speed: 0.1652s/iter; left time: 2973.3842s
	iters: 200, epoch: 14 | loss: 1.1625377
	speed: 0.0470s/iter; left time: 840.9665s
Epoch: 14 cost time: 11.476161479949951
Epoch: 14, Steps: 208 | Train Loss: 0.654 Vali Loss: 6.114 Vali Acc: 0.116 Test Loss: 6.114 Test Acc: 0.116
Validation loss decreased (-0.114180 --> -0.115954).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.6456797
	speed: 0.1769s/iter; left time: 3146.2948s
	iters: 200, epoch: 15 | loss: 0.7849692
	speed: 0.0674s/iter; left time: 1192.1677s
Epoch: 15 cost time: 13.917508840560913
Epoch: 15, Steps: 208 | Train Loss: 0.578 Vali Loss: 6.357 Vali Acc: 0.110 Test Loss: 6.357 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.5129713
	speed: 0.1944s/iter; left time: 3417.9059s
	iters: 200, epoch: 16 | loss: 0.3356464
	speed: 0.0783s/iter; left time: 1369.3690s
Epoch: 16 cost time: 16.851601362228394
Epoch: 16, Steps: 208 | Train Loss: 0.458 Vali Loss: 6.339 Vali Acc: 0.124 Test Loss: 6.339 Test Acc: 0.124
Validation loss decreased (-0.115954 --> -0.124005).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.3933736
	speed: 0.1865s/iter; left time: 3240.6591s
	iters: 200, epoch: 17 | loss: 0.3747894
	speed: 0.0730s/iter; left time: 1260.6904s
Epoch: 17 cost time: 14.740798711776733
Epoch: 17, Steps: 208 | Train Loss: 0.398 Vali Loss: 7.105 Vali Acc: 0.113 Test Loss: 7.105 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.3242716
	speed: 0.1775s/iter; left time: 3047.6235s
	iters: 200, epoch: 18 | loss: 0.1340114
	speed: 0.0574s/iter; left time: 978.8987s
Epoch: 18 cost time: 12.820184230804443
Epoch: 18, Steps: 208 | Train Loss: 0.357 Vali Loss: 7.117 Vali Acc: 0.104 Test Loss: 7.117 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.5933095
	speed: 0.1880s/iter; left time: 3188.4103s
	iters: 200, epoch: 19 | loss: 0.0430726
	speed: 0.0784s/iter; left time: 1321.0817s
Epoch: 19 cost time: 16.269054651260376
Epoch: 19, Steps: 208 | Train Loss: 0.309 Vali Loss: 7.806 Vali Acc: 0.110 Test Loss: 7.806 Test Acc: 0.110
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0748495
	speed: 0.1620s/iter; left time: 2713.6354s
	iters: 200, epoch: 20 | loss: 0.4717848
	speed: 0.0720s/iter; left time: 1198.3033s
Epoch: 20 cost time: 12.22712254524231
Epoch: 20, Steps: 208 | Train Loss: 0.303 Vali Loss: 7.043 Vali Acc: 0.115 Test Loss: 7.043 Test Acc: 0.115
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.3118379
	speed: 0.1688s/iter; left time: 2792.0106s
	iters: 200, epoch: 21 | loss: 0.5210071
	speed: 0.0568s/iter; left time: 934.1315s
Epoch: 21 cost time: 13.009467601776123
Epoch: 21, Steps: 208 | Train Loss: 0.284 Vali Loss: 7.767 Vali Acc: 0.123 Test Loss: 7.767 Test Acc: 0.123
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.6103320
	speed: 0.1829s/iter; left time: 2986.6875s
	iters: 200, epoch: 22 | loss: 0.3016812
	speed: 0.0647s/iter; left time: 1050.7312s
Epoch: 22 cost time: 13.980259895324707
Epoch: 22, Steps: 208 | Train Loss: 0.267 Vali Loss: 7.593 Vali Acc: 0.107 Test Loss: 7.593 Test Acc: 0.107
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.1316496
	speed: 0.1592s/iter; left time: 2567.6693s
	iters: 200, epoch: 23 | loss: 0.0606774
	speed: 0.0666s/iter; left time: 1067.4560s
Epoch: 23 cost time: 13.071069240570068
Epoch: 23, Steps: 208 | Train Loss: 0.241 Vali Loss: 8.266 Vali Acc: 0.108 Test Loss: 8.266 Test Acc: 0.108
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.4060870
	speed: 0.1663s/iter; left time: 2647.2667s
	iters: 200, epoch: 24 | loss: 0.2081446
	speed: 0.0609s/iter; left time: 963.7803s
Epoch: 24 cost time: 12.701393842697144
Epoch: 24, Steps: 208 | Train Loss: 0.248 Vali Loss: 8.598 Vali Acc: 0.112 Test Loss: 8.598 Test Acc: 0.112
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.2075221
	speed: 0.1839s/iter; left time: 2889.5931s
	iters: 200, epoch: 25 | loss: 0.1960425
	speed: 0.0658s/iter; left time: 1027.2740s
Epoch: 25 cost time: 14.764091730117798
Epoch: 25, Steps: 208 | Train Loss: 0.234 Vali Loss: 8.592 Vali Acc: 0.116 Test Loss: 8.592 Test Acc: 0.116
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.1568260
	speed: 0.1777s/iter; left time: 2753.8527s
	iters: 200, epoch: 26 | loss: 0.1528926
	speed: 0.0655s/iter; left time: 1008.9729s
Epoch: 26 cost time: 14.68489146232605
Epoch: 26, Steps: 208 | Train Loss: 0.243 Vali Loss: 8.761 Vali Acc: 0.120 Test Loss: 8.761 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12406799880703848
model parameter : 940223
model size : 4.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7937741
	speed: 0.0825s/iter; left time: 1707.1135s
	iters: 200, epoch: 1 | loss: 4.4911256
	speed: 0.0516s/iter; left time: 1062.3561s
Epoch: 1 cost time: 13.787745714187622
Epoch: 1, Steps: 208 | Train Loss: 4.228 Vali Loss: 4.499 Vali Acc: 0.051 Test Loss: 4.499 Test Acc: 0.051
Validation loss decreased (inf --> -0.051252).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.5169840
	speed: 0.1590s/iter; left time: 3259.3383s
	iters: 200, epoch: 2 | loss: 3.9196630
	speed: 0.0582s/iter; left time: 1186.9670s
Epoch: 2 cost time: 12.546100378036499
Epoch: 2, Steps: 208 | Train Loss: 4.501 Vali Loss: 4.460 Vali Acc: 0.055 Test Loss: 4.460 Test Acc: 0.055
Validation loss decreased (-0.051252 --> -0.054832).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7081492
	speed: 0.1529s/iter; left time: 3101.4213s
	iters: 200, epoch: 3 | loss: 3.4158669
	speed: 0.0637s/iter; left time: 1285.9229s
Epoch: 3 cost time: 13.07115626335144
Epoch: 3, Steps: 208 | Train Loss: 3.857 Vali Loss: 3.932 Vali Acc: 0.050 Test Loss: 3.932 Test Acc: 0.050
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.1755338
	speed: 0.1603s/iter; left time: 3218.5814s
	iters: 200, epoch: 4 | loss: 3.4480882
	speed: 0.0558s/iter; left time: 1115.5638s
Epoch: 4 cost time: 12.073053121566772
Epoch: 4, Steps: 208 | Train Loss: 3.624 Vali Loss: 3.773 Vali Acc: 0.058 Test Loss: 3.773 Test Acc: 0.058
Validation loss decreased (-0.054832 --> -0.057821).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.8428960
	speed: 0.1726s/iter; left time: 3429.3436s
	iters: 200, epoch: 5 | loss: 3.4282594
	speed: 0.0664s/iter; left time: 1312.7499s
Epoch: 5 cost time: 14.175668716430664
Epoch: 5, Steps: 208 | Train Loss: 3.368 Vali Loss: 3.525 Vali Acc: 0.069 Test Loss: 3.525 Test Acc: 0.069
Validation loss decreased (-0.057821 --> -0.068560).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.6664357
	speed: 0.1740s/iter; left time: 3420.5730s
	iters: 200, epoch: 6 | loss: 2.7138362
	speed: 0.0680s/iter; left time: 1329.8987s
Epoch: 6 cost time: 13.84495735168457
Epoch: 6, Steps: 208 | Train Loss: 3.148 Vali Loss: 3.316 Vali Acc: 0.094 Test Loss: 3.316 Test Acc: 0.094
Validation loss decreased (-0.068560 --> -0.093913).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.4247904
	speed: 0.1549s/iter; left time: 3013.2813s
	iters: 200, epoch: 7 | loss: 3.0064270
	speed: 0.0502s/iter; left time: 970.9314s
Epoch: 7 cost time: 11.069240093231201
Epoch: 7, Steps: 208 | Train Loss: 2.897 Vali Loss: 3.293 Vali Acc: 0.097 Test Loss: 3.293 Test Acc: 0.097
Validation loss decreased (-0.093913 --> -0.096895).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.2320614
	speed: 0.1438s/iter; left time: 2768.3648s
	iters: 200, epoch: 8 | loss: 2.6674559
	speed: 0.0317s/iter; left time: 607.2591s
Epoch: 8 cost time: 7.13201117515564
Epoch: 8, Steps: 208 | Train Loss: 2.628 Vali Loss: 3.320 Vali Acc: 0.107 Test Loss: 3.320 Test Acc: 0.107
Validation loss decreased (-0.096895 --> -0.106737).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9539205
	speed: 0.1760s/iter; left time: 3351.0215s
	iters: 200, epoch: 9 | loss: 2.2132726
	speed: 0.0773s/iter; left time: 1464.7102s
Epoch: 9 cost time: 15.831873178482056
Epoch: 9, Steps: 208 | Train Loss: 2.264 Vali Loss: 3.603 Vali Acc: 0.110 Test Loss: 3.603 Test Acc: 0.110
Validation loss decreased (-0.106737 --> -0.110313).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.9200408
	speed: 0.1845s/iter; left time: 3474.8667s
	iters: 200, epoch: 10 | loss: 1.9289122
	speed: 0.0739s/iter; left time: 1383.4780s
Epoch: 10 cost time: 14.520475149154663
Epoch: 10, Steps: 208 | Train Loss: 1.891 Vali Loss: 3.767 Vali Acc: 0.114 Test Loss: 3.767 Test Acc: 0.114
Validation loss decreased (-0.110313 --> -0.113592).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7682407
	speed: 0.1977s/iter; left time: 3681.5396s
	iters: 200, epoch: 11 | loss: 1.7143106
	speed: 0.0691s/iter; left time: 1279.5083s
Epoch: 11 cost time: 15.514827489852905
Epoch: 11, Steps: 208 | Train Loss: 1.473 Vali Loss: 4.125 Vali Acc: 0.115 Test Loss: 4.125 Test Acc: 0.115
Validation loss decreased (-0.113592 --> -0.115080).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.2047918
	speed: 0.1945s/iter; left time: 3580.9830s
	iters: 200, epoch: 12 | loss: 0.8597826
	speed: 0.0634s/iter; left time: 1161.4222s
Epoch: 12 cost time: 14.626246452331543
Epoch: 12, Steps: 208 | Train Loss: 1.116 Vali Loss: 4.865 Vali Acc: 0.116 Test Loss: 4.865 Test Acc: 0.116
Validation loss decreased (-0.115080 --> -0.116265).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.5470618
	speed: 0.1564s/iter; left time: 2846.5916s
	iters: 200, epoch: 13 | loss: 0.6089141
	speed: 0.0672s/iter; left time: 1216.4201s
Epoch: 13 cost time: 12.734718799591064
Epoch: 13, Steps: 208 | Train Loss: 0.846 Vali Loss: 5.290 Vali Acc: 0.102 Test Loss: 5.290 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.6875392
	speed: 0.1671s/iter; left time: 3006.6405s
	iters: 200, epoch: 14 | loss: 0.9151435
	speed: 0.0614s/iter; left time: 1099.5599s
Epoch: 14 cost time: 12.320085287094116
Epoch: 14, Steps: 208 | Train Loss: 0.676 Vali Loss: 5.625 Vali Acc: 0.110 Test Loss: 5.625 Test Acc: 0.110
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.3946598
	speed: 0.1821s/iter; left time: 3239.5880s
	iters: 200, epoch: 15 | loss: 0.9749088
	speed: 0.0647s/iter; left time: 1144.9917s
Epoch: 15 cost time: 14.599772930145264
Epoch: 15, Steps: 208 | Train Loss: 0.563 Vali Loss: 6.222 Vali Acc: 0.109 Test Loss: 6.222 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.4595049
	speed: 0.1663s/iter; left time: 2924.0048s
	iters: 200, epoch: 16 | loss: 0.6308087
	speed: 0.0685s/iter; left time: 1197.5574s
Epoch: 16 cost time: 14.021929264068604
Epoch: 16, Steps: 208 | Train Loss: 0.474 Vali Loss: 6.755 Vali Acc: 0.110 Test Loss: 6.755 Test Acc: 0.110
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.2481951
	speed: 0.1612s/iter; left time: 2800.3778s
	iters: 200, epoch: 17 | loss: 0.8595815
	speed: 0.0517s/iter; left time: 893.8207s
Epoch: 17 cost time: 11.782511711120605
Epoch: 17, Steps: 208 | Train Loss: 0.422 Vali Loss: 7.152 Vali Acc: 0.115 Test Loss: 7.152 Test Acc: 0.115
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.8024098
	speed: 0.1708s/iter; left time: 2931.4146s
	iters: 200, epoch: 18 | loss: 0.1971184
	speed: 0.0639s/iter; left time: 1090.4158s
Epoch: 18 cost time: 13.94445252418518
Epoch: 18, Steps: 208 | Train Loss: 0.366 Vali Loss: 6.990 Vali Acc: 0.112 Test Loss: 6.990 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.3992700
	speed: 0.1643s/iter; left time: 2785.6473s
	iters: 200, epoch: 19 | loss: 0.3863013
	speed: 0.0664s/iter; left time: 1119.5140s
Epoch: 19 cost time: 13.711269855499268
Epoch: 19, Steps: 208 | Train Loss: 0.319 Vali Loss: 7.387 Vali Acc: 0.112 Test Loss: 7.387 Test Acc: 0.112
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.4011449
	speed: 0.1679s/iter; left time: 2811.5430s
	iters: 200, epoch: 20 | loss: 0.3977522
	speed: 0.0438s/iter; left time: 729.0650s
Epoch: 20 cost time: 11.144129037857056
Epoch: 20, Steps: 208 | Train Loss: 0.298 Vali Loss: 7.318 Vali Acc: 0.112 Test Loss: 7.318 Test Acc: 0.112
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0450258
	speed: 0.1777s/iter; left time: 2938.6590s
	iters: 200, epoch: 21 | loss: 0.2379992
	speed: 0.0596s/iter; left time: 980.6717s
Epoch: 21 cost time: 13.715864181518555
Epoch: 21, Steps: 208 | Train Loss: 0.292 Vali Loss: 7.847 Vali Acc: 0.105 Test Loss: 7.847 Test Acc: 0.105
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.2092384
	speed: 0.1660s/iter; left time: 2711.1765s
	iters: 200, epoch: 22 | loss: 0.1103604
	speed: 0.0630s/iter; left time: 1021.8762s
Epoch: 22 cost time: 13.686391592025757
Epoch: 22, Steps: 208 | Train Loss: 0.272 Vali Loss: 8.654 Vali Acc: 0.109 Test Loss: 8.654 Test Acc: 0.109
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11631374888159857
model parameter : 939007
model size : 4.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9910121
	speed: 0.0795s/iter; left time: 1645.9851s
	iters: 200, epoch: 1 | loss: 4.4399581
	speed: 0.0589s/iter; left time: 1212.9798s
Epoch: 1 cost time: 14.404681921005249
Epoch: 1, Steps: 208 | Train Loss: 4.210 Vali Loss: 4.485 Vali Acc: 0.051 Test Loss: 4.485 Test Acc: 0.051
Validation loss decreased (inf --> -0.050656).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.3504262
	speed: 0.1614s/iter; left time: 3306.6577s
	iters: 200, epoch: 2 | loss: 4.6512265
	speed: 0.0677s/iter; left time: 1381.0291s
Epoch: 2 cost time: 14.425330400466919
Epoch: 2, Steps: 208 | Train Loss: 4.544 Vali Loss: 4.532 Vali Acc: 0.052 Test Loss: 4.532 Test Acc: 0.052
Validation loss decreased (-0.050656 --> -0.052445).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.7511506
	speed: 0.1595s/iter; left time: 3234.7690s
	iters: 200, epoch: 3 | loss: 3.7841234
	speed: 0.0696s/iter; left time: 1403.9223s
Epoch: 3 cost time: 13.537381172180176
Epoch: 3, Steps: 208 | Train Loss: 3.996 Vali Loss: 3.924 Vali Acc: 0.061 Test Loss: 3.924 Test Acc: 0.061
Validation loss decreased (-0.052445 --> -0.061398).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.8876340
	speed: 0.1706s/iter; left time: 3424.8635s
	iters: 200, epoch: 4 | loss: 3.4580579
	speed: 0.0538s/iter; left time: 1073.8270s
Epoch: 4 cost time: 12.730872869491577
Epoch: 4, Steps: 208 | Train Loss: 3.732 Vali Loss: 3.980 Vali Acc: 0.055 Test Loss: 3.980 Test Acc: 0.055
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.6911130
	speed: 0.1979s/iter; left time: 3932.1752s
	iters: 200, epoch: 5 | loss: 3.8058701
	speed: 0.0749s/iter; left time: 1480.3741s
Epoch: 5 cost time: 16.246045112609863
Epoch: 5, Steps: 208 | Train Loss: 3.629 Vali Loss: 3.785 Vali Acc: 0.047 Test Loss: 3.785 Test Acc: 0.047
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 3.5993891
	speed: 0.1792s/iter; left time: 3524.1045s
	iters: 200, epoch: 6 | loss: 3.1882081
	speed: 0.0780s/iter; left time: 1526.5239s
Epoch: 6 cost time: 15.325395822525024
Epoch: 6, Steps: 208 | Train Loss: 3.394 Vali Loss: 3.677 Vali Acc: 0.069 Test Loss: 3.677 Test Acc: 0.069
Validation loss decreased (-0.061398 --> -0.068857).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.3775997
	speed: 0.1632s/iter; left time: 3174.5515s
	iters: 200, epoch: 7 | loss: 2.8347077
	speed: 0.0512s/iter; left time: 989.9819s
Epoch: 7 cost time: 10.360023498535156
Epoch: 7, Steps: 208 | Train Loss: 3.196 Vali Loss: 3.603 Vali Acc: 0.081 Test Loss: 3.603 Test Acc: 0.081
Validation loss decreased (-0.068857 --> -0.080787).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.0764501
	speed: 0.1856s/iter; left time: 3571.8783s
	iters: 200, epoch: 8 | loss: 2.7885261
	speed: 0.0702s/iter; left time: 1344.5877s
Epoch: 8 cost time: 15.638261795043945
Epoch: 8, Steps: 208 | Train Loss: 2.840 Vali Loss: 3.602 Vali Acc: 0.091 Test Loss: 3.602 Test Acc: 0.091
Validation loss decreased (-0.080787 --> -0.090629).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.3735955
	speed: 0.1837s/iter; left time: 3496.3409s
	iters: 200, epoch: 9 | loss: 2.7528756
	speed: 0.0689s/iter; left time: 1305.1207s
Epoch: 9 cost time: 14.82480001449585
Epoch: 9, Steps: 208 | Train Loss: 2.490 Vali Loss: 3.636 Vali Acc: 0.094 Test Loss: 3.636 Test Acc: 0.094
Validation loss decreased (-0.090629 --> -0.093909).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.7360398
	speed: 0.1690s/iter; left time: 3182.1420s
	iters: 200, epoch: 10 | loss: 2.1388648
	speed: 0.0587s/iter; left time: 1098.5958s
Epoch: 10 cost time: 12.964279413223267
Epoch: 10, Steps: 208 | Train Loss: 2.145 Vali Loss: 3.866 Vali Acc: 0.093 Test Loss: 3.866 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.8707904
	speed: 0.1677s/iter; left time: 3122.5848s
	iters: 200, epoch: 11 | loss: 2.1274035
	speed: 0.0547s/iter; left time: 1012.2783s
Epoch: 11 cost time: 12.268449544906616
Epoch: 11, Steps: 208 | Train Loss: 1.783 Vali Loss: 4.163 Vali Acc: 0.099 Test Loss: 4.163 Test Acc: 0.099
Validation loss decreased (-0.093909 --> -0.098676).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.0639951
	speed: 0.1658s/iter; left time: 3052.9429s
	iters: 200, epoch: 12 | loss: 0.9957039
	speed: 0.0692s/iter; left time: 1266.6182s
Epoch: 12 cost time: 14.471530675888062
Epoch: 12, Steps: 208 | Train Loss: 1.429 Vali Loss: 4.392 Vali Acc: 0.103 Test Loss: 4.392 Test Acc: 0.103
Validation loss decreased (-0.098676 --> -0.102551).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.4475866
	speed: 0.1614s/iter; left time: 2937.5168s
	iters: 200, epoch: 13 | loss: 1.3980660
	speed: 0.0714s/iter; left time: 1292.1185s
Epoch: 13 cost time: 14.171380996704102
Epoch: 13, Steps: 208 | Train Loss: 1.115 Vali Loss: 4.858 Vali Acc: 0.099 Test Loss: 4.858 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.9155762
	speed: 0.1698s/iter; left time: 3055.3424s
	iters: 200, epoch: 14 | loss: 0.4266019
	speed: 0.0581s/iter; left time: 1039.3600s
Epoch: 14 cost time: 12.853516578674316
Epoch: 14, Steps: 208 | Train Loss: 0.854 Vali Loss: 5.145 Vali Acc: 0.100 Test Loss: 5.145 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.9562155
	speed: 0.1653s/iter; left time: 2940.3962s
	iters: 200, epoch: 15 | loss: 1.1767566
	speed: 0.0682s/iter; left time: 1205.9942s
Epoch: 15 cost time: 14.486309289932251
Epoch: 15, Steps: 208 | Train Loss: 0.683 Vali Loss: 5.794 Vali Acc: 0.101 Test Loss: 5.794 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.1107234
	speed: 0.1649s/iter; left time: 2898.5417s
	iters: 200, epoch: 16 | loss: 0.3342137
	speed: 0.0715s/iter; left time: 1249.9560s
Epoch: 16 cost time: 13.975313186645508
Epoch: 16, Steps: 208 | Train Loss: 0.579 Vali Loss: 6.043 Vali Acc: 0.106 Test Loss: 6.043 Test Acc: 0.106
Validation loss decreased (-0.102551 --> -0.106113).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.2304931
	speed: 0.1644s/iter; left time: 2856.2135s
	iters: 200, epoch: 17 | loss: 0.2452898
	speed: 0.0573s/iter; left time: 990.4680s
Epoch: 17 cost time: 12.232342720031738
Epoch: 17, Steps: 208 | Train Loss: 0.496 Vali Loss: 6.403 Vali Acc: 0.102 Test Loss: 6.403 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.2881686
	speed: 0.1844s/iter; left time: 3164.3948s
	iters: 200, epoch: 18 | loss: 0.1533110
	speed: 0.0619s/iter; left time: 1056.9522s
Epoch: 18 cost time: 14.412046432495117
Epoch: 18, Steps: 208 | Train Loss: 0.455 Vali Loss: 6.545 Vali Acc: 0.108 Test Loss: 6.545 Test Acc: 0.108
Validation loss decreased (-0.106113 --> -0.107898).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.4272116
	speed: 0.1700s/iter; left time: 2883.2210s
	iters: 200, epoch: 19 | loss: 0.2555224
	speed: 0.0692s/iter; left time: 1166.4719s
Epoch: 19 cost time: 14.8104088306427
Epoch: 19, Steps: 208 | Train Loss: 0.406 Vali Loss: 6.907 Vali Acc: 0.102 Test Loss: 6.907 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.3199595
	speed: 0.1585s/iter; left time: 2654.4102s
	iters: 200, epoch: 20 | loss: 0.5068347
	speed: 0.0611s/iter; left time: 1016.9002s
Epoch: 20 cost time: 12.626353740692139
Epoch: 20, Steps: 208 | Train Loss: 0.359 Vali Loss: 7.259 Vali Acc: 0.106 Test Loss: 7.259 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0301838
	speed: 0.1762s/iter; left time: 2914.4039s
	iters: 200, epoch: 21 | loss: 0.4560117
	speed: 0.0594s/iter; left time: 976.6312s
Epoch: 21 cost time: 12.939860343933105
Epoch: 21, Steps: 208 | Train Loss: 0.334 Vali Loss: 7.460 Vali Acc: 0.111 Test Loss: 7.460 Test Acc: 0.111
Validation loss decreased (-0.107898 --> -0.110871).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.4158584
	speed: 0.1830s/iter; left time: 2989.4212s
	iters: 200, epoch: 22 | loss: 0.2708221
	speed: 0.0685s/iter; left time: 1111.8662s
Epoch: 22 cost time: 15.099745988845825
Epoch: 22, Steps: 208 | Train Loss: 0.316 Vali Loss: 7.961 Vali Acc: 0.102 Test Loss: 7.961 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.3754493
	speed: 0.1736s/iter; left time: 2799.2329s
	iters: 200, epoch: 23 | loss: 0.1347949
	speed: 0.0718s/iter; left time: 1151.3482s
Epoch: 23 cost time: 14.576423645019531
Epoch: 23, Steps: 208 | Train Loss: 0.307 Vali Loss: 7.888 Vali Acc: 0.104 Test Loss: 7.888 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0627220
	speed: 0.1797s/iter; left time: 2860.9154s
	iters: 200, epoch: 24 | loss: 0.2121547
	speed: 0.0615s/iter; left time: 972.1145s
Epoch: 24 cost time: 12.796085596084595
Epoch: 24, Steps: 208 | Train Loss: 0.293 Vali Loss: 8.429 Vali Acc: 0.101 Test Loss: 8.429 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.5622378
	speed: 0.1930s/iter; left time: 3032.2937s
	iters: 200, epoch: 25 | loss: 0.8774358
	speed: 0.0701s/iter; left time: 1094.1692s
Epoch: 25 cost time: 15.041968584060669
Epoch: 25, Steps: 208 | Train Loss: 0.288 Vali Loss: 8.714 Vali Acc: 0.094 Test Loss: 8.714 Test Acc: 0.094
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.1545474
	speed: 0.1979s/iter; left time: 3067.0112s
	iters: 200, epoch: 26 | loss: 0.2567424
	speed: 0.0831s/iter; left time: 1279.5930s
Epoch: 26 cost time: 16.926311254501343
Epoch: 26, Steps: 208 | Train Loss: 0.242 Vali Loss: 8.643 Vali Acc: 0.095 Test Loss: 8.643 Test Acc: 0.095
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.1934158
	speed: 0.1761s/iter; left time: 2692.9972s
	iters: 200, epoch: 27 | loss: 0.2682041
	speed: 0.0561s/iter; left time: 852.6622s
Epoch: 27 cost time: 12.382927894592285
Epoch: 27, Steps: 208 | Train Loss: 0.244 Vali Loss: 9.148 Vali Acc: 0.103 Test Loss: 9.148 Test Acc: 0.103
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.1806346
	speed: 0.1876s/iter; left time: 2830.1360s
	iters: 200, epoch: 28 | loss: 0.1181404
	speed: 0.0568s/iter; left time: 851.8483s
Epoch: 28 cost time: 13.709375381469727
Epoch: 28, Steps: 208 | Train Loss: 0.214 Vali Loss: 9.042 Vali Acc: 0.102 Test Loss: 9.042 Test Acc: 0.102
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0466887
	speed: 0.1722s/iter; left time: 2561.6191s
	iters: 200, epoch: 29 | loss: 0.4166559
	speed: 0.0699s/iter; left time: 1032.8874s
Epoch: 29 cost time: 14.573553800582886
Epoch: 29, Steps: 208 | Train Loss: 0.220 Vali Loss: 9.315 Vali Acc: 0.098 Test Loss: 9.315 Test Acc: 0.098
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0286610
	speed: 0.1630s/iter; left time: 2390.5474s
	iters: 200, epoch: 30 | loss: 0.2537794
	speed: 0.0566s/iter; left time: 824.5293s
Epoch: 30 cost time: 12.858680009841919
Epoch: 30, Steps: 208 | Train Loss: 0.222 Vali Loss: 9.442 Vali Acc: 0.100 Test Loss: 9.442 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.2568126
	speed: 0.1771s/iter; left time: 2560.7103s
	iters: 200, epoch: 31 | loss: 0.1912281
	speed: 0.0624s/iter; left time: 895.9259s
Epoch: 31 cost time: 13.763689279556274
Epoch: 31, Steps: 208 | Train Loss: 0.205 Vali Loss: 9.623 Vali Acc: 0.100 Test Loss: 9.623 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11094542201014017
model parameter : 843583
model size : 4.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.4299507
	speed: 0.0736s/iter; left time: 1522.8791s
	iters: 200, epoch: 1 | loss: 5.0183535
	speed: 0.0463s/iter; left time: 953.6077s
Epoch: 1 cost time: 12.601813554763794
Epoch: 1, Steps: 208 | Train Loss: 4.247 Vali Loss: 4.668 Vali Acc: 0.047 Test Loss: 4.668 Test Acc: 0.047
Validation loss decreased (inf --> -0.046479).  Saving model ...
	iters: 100, epoch: 2 | loss: 5.8439846
	speed: 0.1200s/iter; left time: 2458.2979s
	iters: 200, epoch: 2 | loss: 4.5039864
	speed: 0.0235s/iter; left time: 479.2621s
Epoch: 2 cost time: 5.59997034072876
Epoch: 2, Steps: 208 | Train Loss: 4.553 Vali Loss: 5.717 Vali Acc: 0.045 Test Loss: 5.717 Test Acc: 0.045
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.7440062
	speed: 0.1021s/iter; left time: 2071.3412s
	iters: 200, epoch: 3 | loss: 4.0709538
	speed: 0.0555s/iter; left time: 1120.9948s
Epoch: 3 cost time: 10.631413459777832
Epoch: 3, Steps: 208 | Train Loss: 4.279 Vali Loss: 4.096 Vali Acc: 0.053 Test Loss: 4.096 Test Acc: 0.053
Validation loss decreased (-0.046479 --> -0.053344).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.8095591
	speed: 0.1590s/iter; left time: 3191.6272s
	iters: 200, epoch: 4 | loss: 3.4582338
	speed: 0.0632s/iter; left time: 1262.9298s
Epoch: 4 cost time: 13.057775974273682
Epoch: 4, Steps: 208 | Train Loss: 3.762 Vali Loss: 3.829 Vali Acc: 0.058 Test Loss: 3.829 Test Acc: 0.058
Validation loss decreased (-0.053344 --> -0.058417).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.8109145
	speed: 0.1554s/iter; left time: 3088.2937s
	iters: 200, epoch: 5 | loss: 3.5154543
	speed: 0.0587s/iter; left time: 1159.5751s
Epoch: 5 cost time: 12.070348501205444
Epoch: 5, Steps: 208 | Train Loss: 3.463 Vali Loss: 3.576 Vali Acc: 0.075 Test Loss: 3.576 Test Acc: 0.075
Validation loss decreased (-0.058417 --> -0.074823).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.6970186
	speed: 0.1661s/iter; left time: 3266.5964s
	iters: 200, epoch: 6 | loss: 3.2555130
	speed: 0.0683s/iter; left time: 1336.6388s
Epoch: 6 cost time: 14.622954368591309
Epoch: 6, Steps: 208 | Train Loss: 3.173 Vali Loss: 3.537 Vali Acc: 0.083 Test Loss: 3.537 Test Acc: 0.083
Validation loss decreased (-0.074823 --> -0.083174).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.1622734
	speed: 0.1609s/iter; left time: 3130.0798s
	iters: 200, epoch: 7 | loss: 3.0389230
	speed: 0.0679s/iter; left time: 1314.9012s
Epoch: 7 cost time: 13.53496789932251
Epoch: 7, Steps: 208 | Train Loss: 2.927 Vali Loss: 3.460 Vali Acc: 0.083 Test Loss: 3.460 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.2191687
	speed: 0.1579s/iter; left time: 3039.1564s
	iters: 200, epoch: 8 | loss: 2.8867249
	speed: 0.0509s/iter; left time: 974.5498s
Epoch: 8 cost time: 11.11451005935669
Epoch: 8, Steps: 208 | Train Loss: 2.684 Vali Loss: 3.483 Vali Acc: 0.101 Test Loss: 3.483 Test Acc: 0.101
Validation loss decreased (-0.083174 --> -0.101069).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.0369799
	speed: 0.1613s/iter; left time: 3070.8163s
	iters: 200, epoch: 9 | loss: 2.7256684
	speed: 0.0638s/iter; left time: 1208.3748s
Epoch: 9 cost time: 13.762884616851807
Epoch: 9, Steps: 208 | Train Loss: 2.402 Vali Loss: 3.682 Vali Acc: 0.103 Test Loss: 3.682 Test Acc: 0.103
Validation loss decreased (-0.101069 --> -0.103154).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.8712378
	speed: 0.1721s/iter; left time: 3239.9980s
	iters: 200, epoch: 10 | loss: 2.8544929
	speed: 0.0791s/iter; left time: 1480.6897s
Epoch: 10 cost time: 15.972371101379395
Epoch: 10, Steps: 208 | Train Loss: 2.074 Vali Loss: 3.869 Vali Acc: 0.103 Test Loss: 3.869 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.6688137
	speed: 0.1799s/iter; left time: 3350.8463s
	iters: 200, epoch: 11 | loss: 1.8577448
	speed: 0.0716s/iter; left time: 1326.4759s
Epoch: 11 cost time: 15.310663223266602
Epoch: 11, Steps: 208 | Train Loss: 1.698 Vali Loss: 4.288 Vali Acc: 0.103 Test Loss: 4.288 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.3475062
	speed: 0.1809s/iter; left time: 3331.3387s
	iters: 200, epoch: 12 | loss: 1.7078609
	speed: 0.0587s/iter; left time: 1074.3328s
Epoch: 12 cost time: 12.99977421760559
Epoch: 12, Steps: 208 | Train Loss: 1.343 Vali Loss: 4.404 Vali Acc: 0.106 Test Loss: 4.404 Test Acc: 0.106
Validation loss decreased (-0.103154 --> -0.105831).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.3729362
	speed: 0.1903s/iter; left time: 3464.2555s
	iters: 200, epoch: 13 | loss: 1.1179714
	speed: 0.0780s/iter; left time: 1412.2101s
Epoch: 13 cost time: 15.829309701919556
Epoch: 13, Steps: 208 | Train Loss: 1.022 Vali Loss: 5.210 Vali Acc: 0.111 Test Loss: 5.210 Test Acc: 0.111
Validation loss decreased (-0.105831 --> -0.110595).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.3067232
	speed: 0.1960s/iter; left time: 3528.2583s
	iters: 200, epoch: 14 | loss: 1.0941355
	speed: 0.0773s/iter; left time: 1383.1165s
Epoch: 14 cost time: 16.27993941307068
Epoch: 14, Steps: 208 | Train Loss: 0.805 Vali Loss: 5.710 Vali Acc: 0.109 Test Loss: 5.710 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.9804261
	speed: 0.1604s/iter; left time: 2853.6736s
	iters: 200, epoch: 15 | loss: 1.0663449
	speed: 0.0469s/iter; left time: 829.9828s
Epoch: 15 cost time: 11.614646911621094
Epoch: 15, Steps: 208 | Train Loss: 0.646 Vali Loss: 6.132 Vali Acc: 0.108 Test Loss: 6.132 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.3600523
	speed: 0.1674s/iter; left time: 2942.2068s
	iters: 200, epoch: 16 | loss: 0.5978556
	speed: 0.0568s/iter; left time: 993.5363s
Epoch: 16 cost time: 13.588711977005005
Epoch: 16, Steps: 208 | Train Loss: 0.536 Vali Loss: 6.512 Vali Acc: 0.110 Test Loss: 6.512 Test Acc: 0.110
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0809507
	speed: 0.1646s/iter; left time: 2858.8121s
	iters: 200, epoch: 17 | loss: 0.3903799
	speed: 0.0671s/iter; left time: 1158.4322s
Epoch: 17 cost time: 14.094024181365967
Epoch: 17, Steps: 208 | Train Loss: 0.462 Vali Loss: 6.662 Vali Acc: 0.108 Test Loss: 6.662 Test Acc: 0.108
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.6515306
	speed: 0.1505s/iter; left time: 2582.5671s
	iters: 200, epoch: 18 | loss: 0.5186064
	speed: 0.0663s/iter; left time: 1130.8577s
Epoch: 18 cost time: 12.440685272216797
Epoch: 18, Steps: 208 | Train Loss: 0.394 Vali Loss: 7.418 Vali Acc: 0.110 Test Loss: 7.418 Test Acc: 0.110
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.3566900
	speed: 0.1576s/iter; left time: 2672.0175s
	iters: 200, epoch: 19 | loss: 0.3450420
	speed: 0.0646s/iter; left time: 1089.5867s
Epoch: 19 cost time: 13.143290042877197
Epoch: 19, Steps: 208 | Train Loss: 0.344 Vali Loss: 7.453 Vali Acc: 0.102 Test Loss: 7.453 Test Acc: 0.102
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.5856400
	speed: 0.1690s/iter; left time: 2830.6407s
	iters: 200, epoch: 20 | loss: 0.8004562
	speed: 0.0517s/iter; left time: 860.5117s
Epoch: 20 cost time: 12.986740112304688
Epoch: 20, Steps: 208 | Train Loss: 0.348 Vali Loss: 7.717 Vali Acc: 0.105 Test Loss: 7.717 Test Acc: 0.105
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.2692825
	speed: 0.1648s/iter; left time: 2726.3204s
	iters: 200, epoch: 21 | loss: 0.2798817
	speed: 0.0656s/iter; left time: 1077.7397s
Epoch: 21 cost time: 13.434120893478394
Epoch: 21, Steps: 208 | Train Loss: 0.297 Vali Loss: 8.265 Vali Acc: 0.101 Test Loss: 8.265 Test Acc: 0.101
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.6796381
	speed: 0.1571s/iter; left time: 2565.7448s
	iters: 200, epoch: 22 | loss: 0.5817432
	speed: 0.0546s/iter; left time: 885.8148s
Epoch: 22 cost time: 11.40394926071167
Epoch: 22, Steps: 208 | Train Loss: 0.276 Vali Loss: 8.351 Vali Acc: 0.106 Test Loss: 8.351 Test Acc: 0.106
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0086947
	speed: 0.1704s/iter; left time: 2748.4625s
	iters: 200, epoch: 23 | loss: 0.1973497
	speed: 0.0594s/iter; left time: 952.1272s
Epoch: 23 cost time: 13.674072742462158
Epoch: 23, Steps: 208 | Train Loss: 0.283 Vali Loss: 8.388 Vali Acc: 0.106 Test Loss: 8.388 Test Acc: 0.106
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11064718162839249
model parameter : 842367
model size : 4.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.5842795
	speed: 0.0640s/iter; left time: 1324.4119s
	iters: 200, epoch: 1 | loss: 4.9654813
	speed: 0.0506s/iter; left time: 1043.1356s
Epoch: 1 cost time: 12.06785273551941
Epoch: 1, Steps: 208 | Train Loss: 4.240 Vali Loss: 4.969 Vali Acc: 0.053 Test Loss: 4.969 Test Acc: 0.053
Validation loss decreased (inf --> -0.053335).  Saving model ...
	iters: 100, epoch: 2 | loss: 5.2434659
	speed: 0.1689s/iter; left time: 3461.1120s
	iters: 200, epoch: 2 | loss: 4.4354506
	speed: 0.0528s/iter; left time: 1075.8134s
Epoch: 2 cost time: 12.495782375335693
Epoch: 2, Steps: 208 | Train Loss: 4.497 Vali Loss: 5.143 Vali Acc: 0.043 Test Loss: 5.143 Test Acc: 0.043
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.8591576
	speed: 0.1666s/iter; left time: 3378.6346s
	iters: 200, epoch: 3 | loss: 3.5854692
	speed: 0.0708s/iter; left time: 1428.0967s
Epoch: 3 cost time: 14.411738157272339
Epoch: 3, Steps: 208 | Train Loss: 4.063 Vali Loss: 4.017 Vali Acc: 0.050 Test Loss: 4.017 Test Acc: 0.050
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 3.3048632
	speed: 0.1547s/iter; left time: 3105.2088s
	iters: 200, epoch: 4 | loss: 3.7250910
	speed: 0.0674s/iter; left time: 1346.9128s
Epoch: 4 cost time: 13.438629388809204
Epoch: 4, Steps: 208 | Train Loss: 3.729 Vali Loss: 3.924 Vali Acc: 0.061 Test Loss: 3.924 Test Acc: 0.061
Validation loss decreased (-0.053335 --> -0.061398).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.8066840
	speed: 0.1612s/iter; left time: 3202.9121s
	iters: 200, epoch: 5 | loss: 3.5849392
	speed: 0.0608s/iter; left time: 1201.3322s
Epoch: 5 cost time: 12.661987543106079
Epoch: 5, Steps: 208 | Train Loss: 3.577 Vali Loss: 3.776 Vali Acc: 0.054 Test Loss: 3.776 Test Acc: 0.054
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 3.9103270
	speed: 0.1919s/iter; left time: 3772.6813s
	iters: 200, epoch: 6 | loss: 3.4772918
	speed: 0.0573s/iter; left time: 1121.2774s
Epoch: 6 cost time: 13.70360517501831
Epoch: 6, Steps: 208 | Train Loss: 3.448 Vali Loss: 3.629 Vali Acc: 0.072 Test Loss: 3.629 Test Acc: 0.072
Validation loss decreased (-0.061398 --> -0.071840).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.8906119
	speed: 0.1704s/iter; left time: 3315.2627s
	iters: 200, epoch: 7 | loss: 3.5265379
	speed: 0.0604s/iter; left time: 1169.8356s
Epoch: 7 cost time: 13.22007131576538
Epoch: 7, Steps: 208 | Train Loss: 3.181 Vali Loss: 3.508 Vali Acc: 0.091 Test Loss: 3.508 Test Acc: 0.091
Validation loss decreased (-0.071840 --> -0.091226).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.3241959
	speed: 0.1773s/iter; left time: 3412.6239s
	iters: 200, epoch: 8 | loss: 2.5742338
	speed: 0.0769s/iter; left time: 1472.2564s
Epoch: 8 cost time: 15.738111972808838
Epoch: 8, Steps: 208 | Train Loss: 2.848 Vali Loss: 3.560 Vali Acc: 0.092 Test Loss: 3.560 Test Acc: 0.092
Validation loss decreased (-0.091226 --> -0.092419).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.0662456
	speed: 0.1687s/iter; left time: 3211.2039s
	iters: 200, epoch: 9 | loss: 2.4795787
	speed: 0.0570s/iter; left time: 1079.5841s
Epoch: 9 cost time: 11.744393348693848
Epoch: 9, Steps: 208 | Train Loss: 2.520 Vali Loss: 3.674 Vali Acc: 0.090 Test Loss: 3.674 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.9020807
	speed: 0.1807s/iter; left time: 3402.3743s
	iters: 200, epoch: 10 | loss: 2.7359836
	speed: 0.0570s/iter; left time: 1067.1116s
Epoch: 10 cost time: 13.017271280288696
Epoch: 10, Steps: 208 | Train Loss: 2.142 Vali Loss: 3.812 Vali Acc: 0.090 Test Loss: 3.812 Test Acc: 0.090
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.8613124
	speed: 0.1665s/iter; left time: 3101.1345s
	iters: 200, epoch: 11 | loss: 2.4386013
	speed: 0.0681s/iter; left time: 1261.9083s
Epoch: 11 cost time: 14.345701217651367
Epoch: 11, Steps: 208 | Train Loss: 1.756 Vali Loss: 4.160 Vali Acc: 0.095 Test Loss: 4.160 Test Acc: 0.095
Validation loss decreased (-0.092419 --> -0.095097).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.6347642
	speed: 0.1626s/iter; left time: 2994.7524s
	iters: 200, epoch: 12 | loss: 1.3734238
	speed: 0.0609s/iter; left time: 1114.5421s
Epoch: 12 cost time: 13.21799373626709
Epoch: 12, Steps: 208 | Train Loss: 1.379 Vali Loss: 4.574 Vali Acc: 0.103 Test Loss: 4.574 Test Acc: 0.103
Validation loss decreased (-0.095097 --> -0.102549).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.2982817
	speed: 0.1620s/iter; left time: 2948.5201s
	iters: 200, epoch: 13 | loss: 1.2077175
	speed: 0.0542s/iter; left time: 981.1178s
Epoch: 13 cost time: 12.23005485534668
Epoch: 13, Steps: 208 | Train Loss: 1.045 Vali Loss: 5.138 Vali Acc: 0.101 Test Loss: 5.138 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.7564749
	speed: 0.1653s/iter; left time: 2974.8456s
	iters: 200, epoch: 14 | loss: 0.8667314
	speed: 0.0603s/iter; left time: 1078.9681s
Epoch: 14 cost time: 13.414023876190186
Epoch: 14, Steps: 208 | Train Loss: 0.832 Vali Loss: 5.364 Vali Acc: 0.110 Test Loss: 5.364 Test Acc: 0.110
Validation loss decreased (-0.102549 --> -0.109997).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.9747409
	speed: 0.1603s/iter; left time: 2851.3918s
	iters: 200, epoch: 15 | loss: 1.3703245
	speed: 0.0622s/iter; left time: 1100.0237s
Epoch: 15 cost time: 12.815662145614624
Epoch: 15, Steps: 208 | Train Loss: 0.678 Vali Loss: 5.726 Vali Acc: 0.113 Test Loss: 5.726 Test Acc: 0.113
Validation loss decreased (-0.109997 --> -0.112678).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.8531568
	speed: 0.1616s/iter; left time: 2841.5030s
	iters: 200, epoch: 16 | loss: 0.7210701
	speed: 0.0579s/iter; left time: 1012.3968s
Epoch: 16 cost time: 12.79660677909851
Epoch: 16, Steps: 208 | Train Loss: 0.555 Vali Loss: 6.270 Vali Acc: 0.109 Test Loss: 6.270 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.3913606
	speed: 0.1614s/iter; left time: 2803.2156s
	iters: 200, epoch: 17 | loss: 0.4989044
	speed: 0.0496s/iter; left time: 856.1151s
Epoch: 17 cost time: 11.59823989868164
Epoch: 17, Steps: 208 | Train Loss: 0.515 Vali Loss: 6.439 Vali Acc: 0.111 Test Loss: 6.439 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0944404
	speed: 0.1644s/iter; left time: 2822.7438s
	iters: 200, epoch: 18 | loss: 0.4754110
	speed: 0.0677s/iter; left time: 1155.7403s
Epoch: 18 cost time: 14.054404973983765
Epoch: 18, Steps: 208 | Train Loss: 0.453 Vali Loss: 6.764 Vali Acc: 0.106 Test Loss: 6.764 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.5186977
	speed: 0.1477s/iter; left time: 2504.8992s
	iters: 200, epoch: 19 | loss: 0.1108419
	speed: 0.0658s/iter; left time: 1109.2415s
Epoch: 19 cost time: 12.593970537185669
Epoch: 19, Steps: 208 | Train Loss: 0.389 Vali Loss: 7.021 Vali Acc: 0.108 Test Loss: 7.021 Test Acc: 0.108
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.3577304
	speed: 0.1610s/iter; left time: 2695.7585s
	iters: 200, epoch: 20 | loss: 0.4332835
	speed: 0.0578s/iter; left time: 961.9586s
Epoch: 20 cost time: 13.0003182888031
Epoch: 20, Steps: 208 | Train Loss: 0.355 Vali Loss: 7.359 Vali Acc: 0.107 Test Loss: 7.359 Test Acc: 0.107
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.1386408
	speed: 0.1712s/iter; left time: 2831.8692s
	iters: 200, epoch: 21 | loss: 0.2669121
	speed: 0.0611s/iter; left time: 1004.7171s
Epoch: 21 cost time: 13.609540224075317
Epoch: 21, Steps: 208 | Train Loss: 0.348 Vali Loss: 7.160 Vali Acc: 0.108 Test Loss: 7.160 Test Acc: 0.108
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.4734601
	speed: 0.1664s/iter; left time: 2717.3159s
	iters: 200, epoch: 22 | loss: 0.5582558
	speed: 0.0600s/iter; left time: 974.6442s
Epoch: 22 cost time: 13.245878458023071
Epoch: 22, Steps: 208 | Train Loss: 0.329 Vali Loss: 7.750 Vali Acc: 0.111 Test Loss: 7.750 Test Acc: 0.111
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0061364
	speed: 0.1505s/iter; left time: 2426.2447s
	iters: 200, epoch: 23 | loss: 0.6570784
	speed: 0.0675s/iter; left time: 1081.6767s
Epoch: 23 cost time: 13.293522834777832
Epoch: 23, Steps: 208 | Train Loss: 0.295 Vali Loss: 7.918 Vali Acc: 0.105 Test Loss: 7.918 Test Acc: 0.105
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.5264073
	speed: 0.1620s/iter; left time: 2577.7742s
	iters: 200, epoch: 24 | loss: 0.2966377
	speed: 0.0576s/iter; left time: 911.4244s
Epoch: 24 cost time: 11.91588282585144
Epoch: 24, Steps: 208 | Train Loss: 0.272 Vali Loss: 8.386 Vali Acc: 0.113 Test Loss: 8.386 Test Acc: 0.113
Validation loss decreased (-0.112678 --> -0.113247).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.6003001
	speed: 0.1305s/iter; left time: 2050.3404s
	iters: 200, epoch: 25 | loss: 0.2048895
	speed: 0.0256s/iter; left time: 399.4143s
Epoch: 25 cost time: 6.500986337661743
Epoch: 25, Steps: 208 | Train Loss: 0.256 Vali Loss: 8.556 Vali Acc: 0.107 Test Loss: 8.556 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.2386079
	speed: 0.1534s/iter; left time: 2377.6859s
	iters: 200, epoch: 26 | loss: 0.3173904
	speed: 0.0725s/iter; left time: 1117.2971s
Epoch: 26 cost time: 14.852736711502075
Epoch: 26, Steps: 208 | Train Loss: 0.247 Vali Loss: 8.817 Vali Acc: 0.106 Test Loss: 8.817 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.6594983
	speed: 0.1796s/iter; left time: 2746.5601s
	iters: 200, epoch: 27 | loss: 0.0074632
	speed: 0.0612s/iter; left time: 929.5794s
Epoch: 27 cost time: 13.25169825553894
Epoch: 27, Steps: 208 | Train Loss: 0.259 Vali Loss: 8.746 Vali Acc: 0.109 Test Loss: 8.746 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.3830836
	speed: 0.1900s/iter; left time: 2865.6787s
	iters: 200, epoch: 28 | loss: 0.0878382
	speed: 0.0702s/iter; left time: 1051.9589s
Epoch: 28 cost time: 15.04517674446106
Epoch: 28, Steps: 208 | Train Loss: 0.242 Vali Loss: 9.108 Vali Acc: 0.109 Test Loss: 9.108 Test Acc: 0.109
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.1391053
	speed: 0.1914s/iter; left time: 2847.8251s
	iters: 200, epoch: 29 | loss: 0.6603643
	speed: 0.0654s/iter; left time: 965.8199s
Epoch: 29 cost time: 14.847672462463379
Epoch: 29, Steps: 208 | Train Loss: 0.222 Vali Loss: 9.354 Vali Acc: 0.108 Test Loss: 9.354 Test Acc: 0.108
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0285252
	speed: 0.1519s/iter; left time: 2228.5265s
	iters: 200, epoch: 30 | loss: 0.1529073
	speed: 0.0647s/iter; left time: 942.5360s
Epoch: 30 cost time: 12.814748287200928
Epoch: 30, Steps: 208 | Train Loss: 0.218 Vali Loss: 9.221 Vali Acc: 0.104 Test Loss: 9.221 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.1282954
	speed: 0.1701s/iter; left time: 2459.6757s
	iters: 200, epoch: 31 | loss: 0.1752003
	speed: 0.0605s/iter; left time: 869.2122s
Epoch: 31 cost time: 12.86891508102417
Epoch: 31, Steps: 208 | Train Loss: 0.170 Vali Loss: 9.663 Vali Acc: 0.108 Test Loss: 9.663 Test Acc: 0.108
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.1426666
	speed: 0.1581s/iter; left time: 2252.9461s
	iters: 200, epoch: 32 | loss: 0.2029523
	speed: 0.0548s/iter; left time: 775.9445s
Epoch: 32 cost time: 11.557894945144653
Epoch: 32, Steps: 208 | Train Loss: 0.175 Vali Loss: 9.978 Vali Acc: 0.105 Test Loss: 9.978 Test Acc: 0.105
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0792396
	speed: 0.1705s/iter; left time: 2394.2461s
	iters: 200, epoch: 33 | loss: 0.2084859
	speed: 0.0602s/iter; left time: 839.1336s
Epoch: 33 cost time: 14.002317190170288
Epoch: 33, Steps: 208 | Train Loss: 0.185 Vali Loss: 10.008 Vali Acc: 0.103 Test Loss: 10.008 Test Acc: 0.103
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0044615
	speed: 0.1682s/iter; left time: 2327.7192s
	iters: 200, epoch: 34 | loss: 0.1860359
	speed: 0.0572s/iter; left time: 785.8226s
Epoch: 34 cost time: 12.837667226791382
Epoch: 34, Steps: 208 | Train Loss: 0.181 Vali Loss: 10.014 Vali Acc: 0.096 Test Loss: 10.014 Test Acc: 0.096
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11333134506412168
model parameter : 841151
model size : 4.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.3581438
	speed: 0.0771s/iter; left time: 1596.2796s
	iters: 200, epoch: 1 | loss: 4.7024283
	speed: 0.0622s/iter; left time: 1281.3693s
Epoch: 1 cost time: 14.556160688400269
Epoch: 1, Steps: 208 | Train Loss: 4.271 Vali Loss: 5.218 Vali Acc: 0.040 Test Loss: 5.218 Test Acc: 0.040
Validation loss decreased (inf --> -0.040210).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.1331487
	speed: 0.1751s/iter; left time: 3587.5648s
	iters: 200, epoch: 2 | loss: 4.5543270
	speed: 0.0656s/iter; left time: 1338.0174s
Epoch: 2 cost time: 14.394062280654907
Epoch: 2, Steps: 208 | Train Loss: 4.638 Vali Loss: 4.889 Vali Acc: 0.044 Test Loss: 4.889 Test Acc: 0.044
Validation loss decreased (-0.040210 --> -0.043792).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.3407021
	speed: 0.1586s/iter; left time: 3217.2350s
	iters: 200, epoch: 3 | loss: 4.4738488
	speed: 0.0584s/iter; left time: 1178.8507s
Epoch: 3 cost time: 12.560326099395752
Epoch: 3, Steps: 208 | Train Loss: 4.307 Vali Loss: 4.327 Vali Acc: 0.043 Test Loss: 4.327 Test Acc: 0.043
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.7085881
	speed: 0.1598s/iter; left time: 3207.3441s
	iters: 200, epoch: 4 | loss: 4.1672359
	speed: 0.0564s/iter; left time: 1125.8895s
Epoch: 4 cost time: 12.076571464538574
Epoch: 4, Steps: 208 | Train Loss: 3.749 Vali Loss: 3.883 Vali Acc: 0.052 Test Loss: 3.883 Test Acc: 0.052
Validation loss decreased (-0.043792 --> -0.051855).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.1536973
	speed: 0.1599s/iter; left time: 3176.3237s
	iters: 200, epoch: 5 | loss: 3.8134904
	speed: 0.0583s/iter; left time: 1152.0320s
Epoch: 5 cost time: 12.260745525360107
Epoch: 5, Steps: 208 | Train Loss: 3.489 Vali Loss: 3.712 Vali Acc: 0.063 Test Loss: 3.712 Test Acc: 0.063
Validation loss decreased (-0.051855 --> -0.063190).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2566302
	speed: 0.1751s/iter; left time: 3443.1967s
	iters: 200, epoch: 6 | loss: 3.1154587
	speed: 0.0563s/iter; left time: 1100.6345s
Epoch: 6 cost time: 13.252636671066284
Epoch: 6, Steps: 208 | Train Loss: 3.273 Vali Loss: 3.637 Vali Acc: 0.090 Test Loss: 3.637 Test Acc: 0.090
Validation loss decreased (-0.063190 --> -0.090330).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.6121764
	speed: 0.1669s/iter; left time: 3247.0707s
	iters: 200, epoch: 7 | loss: 3.3720016
	speed: 0.0675s/iter; left time: 1305.7507s
Epoch: 7 cost time: 14.245672464370728
Epoch: 7, Steps: 208 | Train Loss: 3.037 Vali Loss: 3.565 Vali Acc: 0.083 Test Loss: 3.565 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.9479890
	speed: 0.1560s/iter; left time: 3001.9653s
	iters: 200, epoch: 8 | loss: 3.1107669
	speed: 0.0585s/iter; left time: 1120.2556s
Epoch: 8 cost time: 12.229522466659546
Epoch: 8, Steps: 208 | Train Loss: 2.752 Vali Loss: 3.587 Vali Acc: 0.089 Test Loss: 3.587 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.2651265
	speed: 0.1700s/iter; left time: 3236.2374s
	iters: 200, epoch: 9 | loss: 2.6395049
	speed: 0.0654s/iter; left time: 1238.1884s
Epoch: 9 cost time: 14.230460166931152
Epoch: 9, Steps: 208 | Train Loss: 2.409 Vali Loss: 3.706 Vali Acc: 0.094 Test Loss: 3.706 Test Acc: 0.094
Validation loss decreased (-0.090330 --> -0.093610).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.2874758
	speed: 0.1880s/iter; left time: 3540.1134s
	iters: 200, epoch: 10 | loss: 1.7674707
	speed: 0.0702s/iter; left time: 1314.4399s
Epoch: 10 cost time: 15.141464710235596
Epoch: 10, Steps: 208 | Train Loss: 2.062 Vali Loss: 3.974 Vali Acc: 0.097 Test Loss: 3.974 Test Acc: 0.097
Validation loss decreased (-0.093610 --> -0.096888).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.0154016
	speed: 0.1914s/iter; left time: 3563.7975s
	iters: 200, epoch: 11 | loss: 2.1964679
	speed: 0.0705s/iter; left time: 1306.0316s
Epoch: 11 cost time: 15.399060010910034
Epoch: 11, Steps: 208 | Train Loss: 1.696 Vali Loss: 4.222 Vali Acc: 0.104 Test Loss: 4.222 Test Acc: 0.104
Validation loss decreased (-0.096888 --> -0.104342).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.7716066
	speed: 0.1794s/iter; left time: 3302.8332s
	iters: 200, epoch: 12 | loss: 1.8725412
	speed: 0.0746s/iter; left time: 1365.2872s
Epoch: 12 cost time: 15.04396677017212
Epoch: 12, Steps: 208 | Train Loss: 1.303 Vali Loss: 4.662 Vali Acc: 0.105 Test Loss: 4.662 Test Acc: 0.105
Validation loss decreased (-0.104342 --> -0.105232).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.7831475
	speed: 0.1770s/iter; left time: 3222.4691s
	iters: 200, epoch: 13 | loss: 1.2754694
	speed: 0.0593s/iter; left time: 1073.3376s
Epoch: 13 cost time: 12.531846046447754
Epoch: 13, Steps: 208 | Train Loss: 0.974 Vali Loss: 5.225 Vali Acc: 0.105 Test Loss: 5.225 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.0140617
	speed: 0.1677s/iter; left time: 3017.4734s
	iters: 200, epoch: 14 | loss: 0.3726130
	speed: 0.0620s/iter; left time: 1109.6448s
Epoch: 14 cost time: 13.86000657081604
Epoch: 14, Steps: 208 | Train Loss: 0.783 Vali Loss: 5.721 Vali Acc: 0.110 Test Loss: 5.721 Test Acc: 0.110
Validation loss decreased (-0.105232 --> -0.110292).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.4395419
	speed: 0.1609s/iter; left time: 2861.5302s
	iters: 200, epoch: 15 | loss: 1.0454062
	speed: 0.0642s/iter; left time: 1135.8675s
Epoch: 15 cost time: 13.57758116722107
Epoch: 15, Steps: 208 | Train Loss: 0.626 Vali Loss: 6.099 Vali Acc: 0.101 Test Loss: 6.099 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.8033919
	speed: 0.1471s/iter; left time: 2586.9979s
	iters: 200, epoch: 16 | loss: 0.4694678
	speed: 0.0613s/iter; left time: 1072.0349s
Epoch: 16 cost time: 12.238139867782593
Epoch: 16, Steps: 208 | Train Loss: 0.534 Vali Loss: 6.697 Vali Acc: 0.107 Test Loss: 6.697 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.4308315
	speed: 0.1694s/iter; left time: 2942.5428s
	iters: 200, epoch: 17 | loss: 0.6970378
	speed: 0.0621s/iter; left time: 1073.2521s
Epoch: 17 cost time: 12.756149053573608
Epoch: 17, Steps: 208 | Train Loss: 0.469 Vali Loss: 6.831 Vali Acc: 0.114 Test Loss: 6.831 Test Acc: 0.114
Validation loss decreased (-0.110292 --> -0.113561).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.1936035
	speed: 0.1603s/iter; left time: 2751.8308s
	iters: 200, epoch: 18 | loss: 0.3400542
	speed: 0.0506s/iter; left time: 863.7940s
Epoch: 18 cost time: 12.189284324645996
Epoch: 18, Steps: 208 | Train Loss: 0.408 Vali Loss: 7.216 Vali Acc: 0.115 Test Loss: 7.216 Test Acc: 0.115
Validation loss decreased (-0.113561 --> -0.115049).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.5495529
	speed: 0.1655s/iter; left time: 2805.9372s
	iters: 200, epoch: 19 | loss: 0.4870258
	speed: 0.0660s/iter; left time: 1112.9183s
Epoch: 19 cost time: 14.127411842346191
Epoch: 19, Steps: 208 | Train Loss: 0.380 Vali Loss: 7.215 Vali Acc: 0.111 Test Loss: 7.215 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.1014922
	speed: 0.1460s/iter; left time: 2445.9838s
	iters: 200, epoch: 20 | loss: 0.3340614
	speed: 0.0649s/iter; left time: 1080.5408s
Epoch: 20 cost time: 12.790976285934448
Epoch: 20, Steps: 208 | Train Loss: 0.345 Vali Loss: 7.656 Vali Acc: 0.105 Test Loss: 7.656 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0598389
	speed: 0.1564s/iter; left time: 2586.8855s
	iters: 200, epoch: 21 | loss: 0.3428137
	speed: 0.0514s/iter; left time: 844.6492s
Epoch: 21 cost time: 11.60922884941101
Epoch: 21, Steps: 208 | Train Loss: 0.314 Vali Loss: 7.763 Vali Acc: 0.113 Test Loss: 7.763 Test Acc: 0.113
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.2225119
	speed: 0.1725s/iter; left time: 2817.4628s
	iters: 200, epoch: 22 | loss: 0.4121501
	speed: 0.0614s/iter; left time: 997.0856s
Epoch: 22 cost time: 13.290205955505371
Epoch: 22, Steps: 208 | Train Loss: 0.284 Vali Loss: 8.006 Vali Acc: 0.110 Test Loss: 8.006 Test Acc: 0.110
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0497140
	speed: 0.1687s/iter; left time: 2719.6967s
	iters: 200, epoch: 23 | loss: 0.0600373
	speed: 0.0620s/iter; left time: 993.3146s
Epoch: 23 cost time: 13.178329706192017
Epoch: 23, Steps: 208 | Train Loss: 0.304 Vali Loss: 8.523 Vali Acc: 0.109 Test Loss: 8.523 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0092706
	speed: 0.1580s/iter; left time: 2514.9228s
	iters: 200, epoch: 24 | loss: 0.3055751
	speed: 0.0642s/iter; left time: 1015.3853s
Epoch: 24 cost time: 13.563303232192993
Epoch: 24, Steps: 208 | Train Loss: 0.259 Vali Loss: 8.501 Vali Acc: 0.112 Test Loss: 8.501 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.3566904
	speed: 0.1508s/iter; left time: 2369.6991s
	iters: 200, epoch: 25 | loss: 0.4154942
	speed: 0.0560s/iter; left time: 874.6905s
Epoch: 25 cost time: 11.522322416305542
Epoch: 25, Steps: 208 | Train Loss: 0.228 Vali Loss: 8.785 Vali Acc: 0.113 Test Loss: 8.785 Test Acc: 0.113
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.1922288
	speed: 0.1610s/iter; left time: 2494.9668s
	iters: 200, epoch: 26 | loss: 0.2405799
	speed: 0.0520s/iter; left time: 801.0306s
Epoch: 26 cost time: 11.569003582000732
Epoch: 26, Steps: 208 | Train Loss: 0.223 Vali Loss: 8.937 Vali Acc: 0.107 Test Loss: 8.937 Test Acc: 0.107
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0353108
	speed: 0.1731s/iter; left time: 2647.7195s
	iters: 200, epoch: 27 | loss: 0.1216726
	speed: 0.0513s/iter; left time: 779.5607s
Epoch: 27 cost time: 12.018454313278198
Epoch: 27, Steps: 208 | Train Loss: 0.218 Vali Loss: 9.057 Vali Acc: 0.106 Test Loss: 9.057 Test Acc: 0.106
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.5586160
	speed: 0.1424s/iter; left time: 2148.6723s
	iters: 200, epoch: 28 | loss: 0.0073434
	speed: 0.0766s/iter; left time: 1148.5413s
Epoch: 28 cost time: 14.297890186309814
Epoch: 28, Steps: 208 | Train Loss: 0.201 Vali Loss: 9.194 Vali Acc: 0.108 Test Loss: 9.194 Test Acc: 0.108
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11512078735460782
model parameter : 839935
model size : 4.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.5623932
	speed: 0.0483s/iter; left time: 999.8304s
	iters: 200, epoch: 1 | loss: 4.0893531
	speed: 0.0311s/iter; left time: 639.7440s
Epoch: 1 cost time: 8.24700403213501
Epoch: 1, Steps: 208 | Train Loss: 4.220 Vali Loss: 5.173 Vali Acc: 0.041 Test Loss: 5.173 Test Acc: 0.041
Validation loss decreased (inf --> -0.041404).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.1466923
	speed: 0.1673s/iter; left time: 3427.8581s
	iters: 200, epoch: 2 | loss: 4.8569832
	speed: 0.0711s/iter; left time: 1449.1020s
Epoch: 2 cost time: 15.253130674362183
Epoch: 2, Steps: 208 | Train Loss: 4.582 Vali Loss: 5.250 Vali Acc: 0.044 Test Loss: 5.250 Test Acc: 0.044
Validation loss decreased (-0.041404 --> -0.044087).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.7201705
	speed: 0.1705s/iter; left time: 3458.2365s
	iters: 200, epoch: 3 | loss: 4.1555209
	speed: 0.0750s/iter; left time: 1513.2579s
Epoch: 3 cost time: 14.400590419769287
Epoch: 3, Steps: 208 | Train Loss: 4.503 Vali Loss: 4.280 Vali Acc: 0.053 Test Loss: 4.280 Test Acc: 0.053
Validation loss decreased (-0.044087 --> -0.052746).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.5124021
	speed: 0.1853s/iter; left time: 3720.1381s
	iters: 200, epoch: 4 | loss: 3.6071918
	speed: 0.0538s/iter; left time: 1074.7837s
Epoch: 4 cost time: 12.172070980072021
Epoch: 4, Steps: 208 | Train Loss: 3.863 Vali Loss: 4.061 Vali Acc: 0.049 Test Loss: 4.061 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.8762789
	speed: 0.1714s/iter; left time: 3405.3049s
	iters: 200, epoch: 5 | loss: 3.1635776
	speed: 0.0538s/iter; left time: 1063.4526s
Epoch: 5 cost time: 12.94865345954895
Epoch: 5, Steps: 208 | Train Loss: 3.533 Vali Loss: 3.717 Vali Acc: 0.064 Test Loss: 3.717 Test Acc: 0.064
Validation loss decreased (-0.052746 --> -0.064383).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2272959
	speed: 0.1675s/iter; left time: 3292.9335s
	iters: 200, epoch: 6 | loss: 3.6325929
	speed: 0.0619s/iter; left time: 1211.0749s
Epoch: 6 cost time: 13.676674365997314
Epoch: 6, Steps: 208 | Train Loss: 3.302 Vali Loss: 3.641 Vali Acc: 0.075 Test Loss: 3.641 Test Acc: 0.075
Validation loss decreased (-0.064383 --> -0.075418).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.3510823
	speed: 0.1602s/iter; left time: 3117.1222s
	iters: 200, epoch: 7 | loss: 3.1669812
	speed: 0.0695s/iter; left time: 1344.7447s
Epoch: 7 cost time: 13.626996517181396
Epoch: 7, Steps: 208 | Train Loss: 3.040 Vali Loss: 3.532 Vali Acc: 0.082 Test Loss: 3.532 Test Acc: 0.082
Validation loss decreased (-0.075418 --> -0.081683).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.3764663
	speed: 0.1590s/iter; left time: 3059.0631s
	iters: 200, epoch: 8 | loss: 2.8658237
	speed: 0.0547s/iter; left time: 1046.7510s
Epoch: 8 cost time: 11.708151817321777
Epoch: 8, Steps: 208 | Train Loss: 2.717 Vali Loss: 3.649 Vali Acc: 0.089 Test Loss: 3.649 Test Acc: 0.089
Validation loss decreased (-0.081683 --> -0.089137).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.0572939
	speed: 0.1695s/iter; left time: 3227.3807s
	iters: 200, epoch: 9 | loss: 2.5788839
	speed: 0.0607s/iter; left time: 1150.1096s
Epoch: 9 cost time: 13.538819551467896
Epoch: 9, Steps: 208 | Train Loss: 2.379 Vali Loss: 3.773 Vali Acc: 0.092 Test Loss: 3.773 Test Acc: 0.092
Validation loss decreased (-0.089137 --> -0.091522).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5730610
	speed: 0.1680s/iter; left time: 3162.6112s
	iters: 200, epoch: 10 | loss: 2.5535347
	speed: 0.0604s/iter; left time: 1131.5962s
Epoch: 10 cost time: 13.827796220779419
Epoch: 10, Steps: 208 | Train Loss: 1.966 Vali Loss: 4.035 Vali Acc: 0.103 Test Loss: 4.035 Test Acc: 0.103
Validation loss decreased (-0.091522 --> -0.102853).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.2571354
	speed: 0.1552s/iter; left time: 2890.4240s
	iters: 200, epoch: 11 | loss: 2.1528823
	speed: 0.0695s/iter; left time: 1286.5093s
Epoch: 11 cost time: 13.018470287322998
Epoch: 11, Steps: 208 | Train Loss: 1.583 Vali Loss: 4.367 Vali Acc: 0.101 Test Loss: 4.367 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.4821174
	speed: 0.1614s/iter; left time: 2971.4398s
	iters: 200, epoch: 12 | loss: 1.3784329
	speed: 0.0541s/iter; left time: 990.0446s
Epoch: 12 cost time: 11.641244411468506
Epoch: 12, Steps: 208 | Train Loss: 1.210 Vali Loss: 4.751 Vali Acc: 0.101 Test Loss: 4.751 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.5166535
	speed: 0.1732s/iter; left time: 3153.3785s
	iters: 200, epoch: 13 | loss: 0.7172934
	speed: 0.0571s/iter; left time: 1033.0658s
Epoch: 13 cost time: 13.391966581344604
Epoch: 13, Steps: 208 | Train Loss: 0.930 Vali Loss: 5.119 Vali Acc: 0.103 Test Loss: 5.119 Test Acc: 0.103
Validation loss decreased (-0.102853 --> -0.103140).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.9732940
	speed: 0.1712s/iter; left time: 3081.3555s
	iters: 200, epoch: 14 | loss: 0.9093273
	speed: 0.0631s/iter; left time: 1129.5296s
Epoch: 14 cost time: 13.91536545753479
Epoch: 14, Steps: 208 | Train Loss: 0.721 Vali Loss: 5.622 Vali Acc: 0.098 Test Loss: 5.622 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.6234753
	speed: 0.1461s/iter; left time: 2598.3386s
	iters: 200, epoch: 15 | loss: 0.7616330
	speed: 0.0631s/iter; left time: 1116.3876s
Epoch: 15 cost time: 11.134145975112915
Epoch: 15, Steps: 208 | Train Loss: 0.607 Vali Loss: 5.983 Vali Acc: 0.100 Test Loss: 5.983 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.8343350
	speed: 0.1590s/iter; left time: 2796.0569s
	iters: 200, epoch: 16 | loss: 0.6456032
	speed: 0.0626s/iter; left time: 1094.1970s
Epoch: 16 cost time: 12.75476622581482
Epoch: 16, Steps: 208 | Train Loss: 0.498 Vali Loss: 6.258 Vali Acc: 0.109 Test Loss: 6.258 Test Acc: 0.109
Validation loss decreased (-0.103140 --> -0.108795).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.5894803
	speed: 0.1736s/iter; left time: 3015.2339s
	iters: 200, epoch: 17 | loss: 0.1037575
	speed: 0.0616s/iter; left time: 1064.1694s
Epoch: 17 cost time: 13.610209465026855
Epoch: 17, Steps: 208 | Train Loss: 0.432 Vali Loss: 6.573 Vali Acc: 0.098 Test Loss: 6.573 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.0133916
	speed: 0.1602s/iter; left time: 2749.8057s
	iters: 200, epoch: 18 | loss: 0.3378942
	speed: 0.0662s/iter; left time: 1129.1579s
Epoch: 18 cost time: 13.912377119064331
Epoch: 18, Steps: 208 | Train Loss: 0.365 Vali Loss: 7.203 Vali Acc: 0.105 Test Loss: 7.203 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0894493
	speed: 0.1736s/iter; left time: 2943.6295s
	iters: 200, epoch: 19 | loss: 0.3271043
	speed: 0.0761s/iter; left time: 1282.6453s
Epoch: 19 cost time: 15.095605611801147
Epoch: 19, Steps: 208 | Train Loss: 0.358 Vali Loss: 7.535 Vali Acc: 0.104 Test Loss: 7.535 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.2368646
	speed: 0.1784s/iter; left time: 2987.8046s
	iters: 200, epoch: 20 | loss: 0.3600245
	speed: 0.0659s/iter; left time: 1096.7128s
Epoch: 20 cost time: 13.728431701660156
Epoch: 20, Steps: 208 | Train Loss: 0.312 Vali Loss: 7.323 Vali Acc: 0.102 Test Loss: 7.323 Test Acc: 0.102
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.3206674
	speed: 0.1860s/iter; left time: 3076.4617s
	iters: 200, epoch: 21 | loss: 0.2131933
	speed: 0.0645s/iter; left time: 1060.8860s
Epoch: 21 cost time: 13.913981914520264
Epoch: 21, Steps: 208 | Train Loss: 0.272 Vali Loss: 7.801 Vali Acc: 0.107 Test Loss: 7.801 Test Acc: 0.107
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0206161
	speed: 0.1942s/iter; left time: 3171.3520s
	iters: 200, epoch: 22 | loss: 0.1601713
	speed: 0.0633s/iter; left time: 1028.1589s
Epoch: 22 cost time: 14.623290777206421
Epoch: 22, Steps: 208 | Train Loss: 0.276 Vali Loss: 7.963 Vali Acc: 0.112 Test Loss: 7.963 Test Acc: 0.112
Validation loss decreased (-0.108795 --> -0.111761).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.1019680
	speed: 0.1822s/iter; left time: 2938.6664s
	iters: 200, epoch: 23 | loss: 0.1380323
	speed: 0.0695s/iter; left time: 1113.8282s
Epoch: 23 cost time: 14.25513768196106
Epoch: 23, Steps: 208 | Train Loss: 0.250 Vali Loss: 8.081 Vali Acc: 0.108 Test Loss: 8.081 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.1623847
	speed: 0.1444s/iter; left time: 2298.1046s
	iters: 200, epoch: 24 | loss: 0.1691614
	speed: 0.0342s/iter; left time: 541.0317s
Epoch: 24 cost time: 8.66103458404541
Epoch: 24, Steps: 208 | Train Loss: 0.216 Vali Loss: 7.970 Vali Acc: 0.106 Test Loss: 7.970 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.6695256
	speed: 0.1591s/iter; left time: 2499.2913s
	iters: 200, epoch: 25 | loss: 0.0435540
	speed: 0.0586s/iter; left time: 914.1067s
Epoch: 25 cost time: 12.986872434616089
Epoch: 25, Steps: 208 | Train Loss: 0.193 Vali Loss: 8.759 Vali Acc: 0.104 Test Loss: 8.759 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.3316929
	speed: 0.1730s/iter; left time: 2681.5533s
	iters: 200, epoch: 26 | loss: 0.3963335
	speed: 0.0527s/iter; left time: 811.1921s
Epoch: 26 cost time: 12.788413524627686
Epoch: 26, Steps: 208 | Train Loss: 0.201 Vali Loss: 8.930 Vali Acc: 0.109 Test Loss: 8.930 Test Acc: 0.109
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0523637
	speed: 0.1638s/iter; left time: 2504.2924s
	iters: 200, epoch: 27 | loss: 0.1951118
	speed: 0.0625s/iter; left time: 950.0307s
Epoch: 27 cost time: 13.479509830474854
Epoch: 27, Steps: 208 | Train Loss: 0.190 Vali Loss: 9.437 Vali Acc: 0.106 Test Loss: 9.437 Test Acc: 0.106
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.1064382
	speed: 0.1657s/iter; left time: 2500.1750s
	iters: 200, epoch: 28 | loss: 0.0170759
	speed: 0.0694s/iter; left time: 1040.3645s
Epoch: 28 cost time: 13.868278980255127
Epoch: 28, Steps: 208 | Train Loss: 0.204 Vali Loss: 9.582 Vali Acc: 0.110 Test Loss: 9.582 Test Acc: 0.110
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.1951025
	speed: 0.1668s/iter; left time: 2482.0063s
	iters: 200, epoch: 29 | loss: 0.0648997
	speed: 0.0556s/iter; left time: 821.8632s
Epoch: 29 cost time: 12.041379690170288
Epoch: 29, Steps: 208 | Train Loss: 0.178 Vali Loss: 9.445 Vali Acc: 0.108 Test Loss: 9.445 Test Acc: 0.108
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.1533065
	speed: 0.1703s/iter; left time: 2497.7654s
	iters: 200, epoch: 30 | loss: 0.1643240
	speed: 0.0535s/iter; left time: 779.9308s
Epoch: 30 cost time: 12.418179988861084
Epoch: 30, Steps: 208 | Train Loss: 0.178 Vali Loss: 9.238 Vali Acc: 0.109 Test Loss: 9.238 Test Acc: 0.109
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0038216
	speed: 0.1677s/iter; left time: 2425.2805s
	iters: 200, epoch: 31 | loss: 0.0293378
	speed: 0.0634s/iter; left time: 910.6989s
Epoch: 31 cost time: 13.80696177482605
Epoch: 31, Steps: 208 | Train Loss: 0.152 Vali Loss: 9.677 Vali Acc: 0.108 Test Loss: 9.677 Test Acc: 0.108
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0913520
	speed: 0.1667s/iter; left time: 2376.5370s
	iters: 200, epoch: 32 | loss: 0.2495083
	speed: 0.0688s/iter; left time: 973.9395s
Epoch: 32 cost time: 13.736706256866455
Epoch: 32, Steps: 208 | Train Loss: 0.159 Vali Loss: 9.646 Vali Acc: 0.112 Test Loss: 9.646 Test Acc: 0.112
Validation loss decreased (-0.111761 --> -0.112042).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.0070675
	speed: 0.1665s/iter; left time: 2338.0401s
	iters: 200, epoch: 33 | loss: 0.0802359
	speed: 0.0575s/iter; left time: 801.9663s
Epoch: 33 cost time: 12.191689729690552
Epoch: 33, Steps: 208 | Train Loss: 0.130 Vali Loss: 9.856 Vali Acc: 0.110 Test Loss: 9.856 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 0.0473476
	speed: 0.1601s/iter; left time: 2214.8129s
	iters: 200, epoch: 34 | loss: 0.8641306
	speed: 0.0512s/iter; left time: 702.7486s
Epoch: 34 cost time: 11.72655463218689
Epoch: 34, Steps: 208 | Train Loss: 0.149 Vali Loss: 10.039 Vali Acc: 0.103 Test Loss: 10.039 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 0.1221774
	speed: 0.1650s/iter; left time: 2248.1770s
	iters: 200, epoch: 35 | loss: 0.3915036
	speed: 0.0500s/iter; left time: 676.0990s
Epoch: 35 cost time: 12.206206560134888
Epoch: 35, Steps: 208 | Train Loss: 0.139 Vali Loss: 10.062 Vali Acc: 0.109 Test Loss: 10.062 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 36 | loss: 0.0947193
	speed: 0.1728s/iter; left time: 2319.3507s
	iters: 200, epoch: 36 | loss: 0.0044123
	speed: 0.0693s/iter; left time: 923.2430s
Epoch: 36 cost time: 14.356743574142456
Epoch: 36, Steps: 208 | Train Loss: 0.113 Vali Loss: 10.241 Vali Acc: 0.101 Test Loss: 10.241 Test Acc: 0.101
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 37 | loss: 0.0349337
	speed: 0.1631s/iter; left time: 2154.4901s
	iters: 200, epoch: 37 | loss: 0.0254369
	speed: 0.0733s/iter; left time: 961.6830s
Epoch: 37 cost time: 14.090064764022827
Epoch: 37, Steps: 208 | Train Loss: 0.121 Vali Loss: 11.002 Vali Acc: 0.109 Test Loss: 11.002 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 38 | loss: 0.0476202
	speed: 0.1716s/iter; left time: 2232.0491s
	iters: 200, epoch: 38 | loss: 0.0495762
	speed: 0.0529s/iter; left time: 682.1768s
Epoch: 38 cost time: 11.74882984161377
Epoch: 38, Steps: 208 | Train Loss: 0.132 Vali Loss: 10.754 Vali Acc: 0.104 Test Loss: 10.754 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 39 | loss: 0.5217915
	speed: 0.1848s/iter; left time: 2365.5050s
	iters: 200, epoch: 39 | loss: 0.2677198
	speed: 0.0660s/iter; left time: 838.3577s
Epoch: 39 cost time: 14.204977035522461
Epoch: 39, Steps: 208 | Train Loss: 0.134 Vali Loss: 10.515 Vali Acc: 0.103 Test Loss: 10.515 Test Acc: 0.103
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 40 | loss: 0.0185608
	speed: 0.1933s/iter; left time: 2433.4520s
	iters: 200, epoch: 40 | loss: 0.1886047
	speed: 0.0753s/iter; left time: 940.2290s
Epoch: 40 cost time: 15.478617429733276
Epoch: 40, Steps: 208 | Train Loss: 0.132 Vali Loss: 10.618 Vali Acc: 0.107 Test Loss: 10.618 Test Acc: 0.107
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 41 | loss: 0.0155977
	speed: 0.1813s/iter; left time: 2245.1172s
	iters: 200, epoch: 41 | loss: 0.3086453
	speed: 0.0667s/iter; left time: 818.6174s
Epoch: 41 cost time: 14.532831192016602
Epoch: 41, Steps: 208 | Train Loss: 0.131 Vali Loss: 10.758 Vali Acc: 0.098 Test Loss: 10.758 Test Acc: 0.098
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 42 | loss: 0.0722305
	speed: 0.1585s/iter; left time: 1929.6416s
	iters: 200, epoch: 42 | loss: 0.0195395
	speed: 0.0518s/iter; left time: 624.8681s
Epoch: 42 cost time: 11.50276494026184
Epoch: 42, Steps: 208 | Train Loss: 0.146 Vali Loss: 10.800 Vali Acc: 0.099 Test Loss: 10.800 Test Acc: 0.099
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11213838353713093
model parameter : 794047
model size : 4.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8897953
	speed: 0.0761s/iter; left time: 1574.9908s
	iters: 200, epoch: 1 | loss: 4.4517212
	speed: 0.0643s/iter; left time: 1324.8063s
Epoch: 1 cost time: 14.609715461730957
Epoch: 1, Steps: 208 | Train Loss: 4.252 Vali Loss: 4.759 Vali Acc: 0.051 Test Loss: 4.759 Test Acc: 0.051
Validation loss decreased (inf --> -0.050653).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.4380975
	speed: 0.1571s/iter; left time: 3220.2439s
	iters: 200, epoch: 2 | loss: 4.5440431
	speed: 0.0674s/iter; left time: 1374.0212s
Epoch: 2 cost time: 13.722885847091675
Epoch: 2, Steps: 208 | Train Loss: 4.535 Vali Loss: 4.514 Vali Acc: 0.052 Test Loss: 4.514 Test Acc: 0.052
Validation loss decreased (-0.050653 --> -0.052147).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.7129169
	speed: 0.1565s/iter; left time: 3173.5964s
	iters: 200, epoch: 3 | loss: 3.5570140
	speed: 0.0457s/iter; left time: 923.0007s
Epoch: 3 cost time: 10.283092260360718
Epoch: 3, Steps: 208 | Train Loss: 3.986 Vali Loss: 4.061 Vali Acc: 0.053 Test Loss: 4.061 Test Acc: 0.053
Validation loss decreased (-0.052147 --> -0.053344).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.9197736
	speed: 0.1551s/iter; left time: 3114.2825s
	iters: 200, epoch: 4 | loss: 4.2823362
	speed: 0.0536s/iter; left time: 1071.5748s
Epoch: 4 cost time: 12.072447061538696
Epoch: 4, Steps: 208 | Train Loss: 3.738 Vali Loss: 3.815 Vali Acc: 0.058 Test Loss: 3.815 Test Acc: 0.058
Validation loss decreased (-0.053344 --> -0.058417).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.8113077
	speed: 0.1264s/iter; left time: 2511.3801s
	iters: 200, epoch: 5 | loss: 3.2987275
	speed: 0.0258s/iter; left time: 510.5642s
Epoch: 5 cost time: 5.766299486160278
Epoch: 5, Steps: 208 | Train Loss: 3.619 Vali Loss: 3.740 Vali Acc: 0.061 Test Loss: 3.740 Test Acc: 0.061
Validation loss decreased (-0.058417 --> -0.060505).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2876396
	speed: 0.1046s/iter; left time: 2057.2136s
	iters: 200, epoch: 6 | loss: 3.2034380
	speed: 0.0354s/iter; left time: 693.3543s
Epoch: 6 cost time: 7.443298816680908
Epoch: 6, Steps: 208 | Train Loss: 3.387 Vali Loss: 3.662 Vali Acc: 0.072 Test Loss: 3.662 Test Acc: 0.072
Validation loss decreased (-0.060505 --> -0.071541).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.1555350
	speed: 0.1694s/iter; left time: 3296.0795s
	iters: 200, epoch: 7 | loss: 3.0844908
	speed: 0.0526s/iter; left time: 1018.3846s
Epoch: 7 cost time: 12.537856817245483
Epoch: 7, Steps: 208 | Train Loss: 3.161 Vali Loss: 3.603 Vali Acc: 0.077 Test Loss: 3.603 Test Acc: 0.077
Validation loss decreased (-0.071541 --> -0.076612).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.2098124
	speed: 0.1668s/iter; left time: 3210.6294s
	iters: 200, epoch: 8 | loss: 2.8520889
	speed: 0.0690s/iter; left time: 1321.3909s
Epoch: 8 cost time: 13.982731580734253
Epoch: 8, Steps: 208 | Train Loss: 2.889 Vali Loss: 3.629 Vali Acc: 0.078 Test Loss: 3.629 Test Acc: 0.078
Validation loss decreased (-0.076612 --> -0.078401).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.3758328
	speed: 0.1654s/iter; left time: 3149.6092s
	iters: 200, epoch: 9 | loss: 2.8171806
	speed: 0.0628s/iter; left time: 1189.2924s
Epoch: 9 cost time: 12.727749586105347
Epoch: 9, Steps: 208 | Train Loss: 2.575 Vali Loss: 3.758 Vali Acc: 0.088 Test Loss: 3.758 Test Acc: 0.088
Validation loss decreased (-0.078401 --> -0.088242).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.9228373
	speed: 0.1588s/iter; left time: 2990.1044s
	iters: 200, epoch: 10 | loss: 2.5870049
	speed: 0.0401s/iter; left time: 751.1755s
Epoch: 10 cost time: 10.985100269317627
Epoch: 10, Steps: 208 | Train Loss: 2.223 Vali Loss: 3.935 Vali Acc: 0.088 Test Loss: 3.935 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.3373508
	speed: 0.1685s/iter; left time: 3138.0012s
	iters: 200, epoch: 11 | loss: 1.9246210
	speed: 0.0526s/iter; left time: 974.7120s
Epoch: 11 cost time: 12.551506280899048
Epoch: 11, Steps: 208 | Train Loss: 1.844 Vali Loss: 4.196 Vali Acc: 0.095 Test Loss: 4.196 Test Acc: 0.095
Validation loss decreased (-0.088242 --> -0.095097).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.7320678
	speed: 0.1753s/iter; left time: 3227.0458s
	iters: 200, epoch: 12 | loss: 1.5376772
	speed: 0.0708s/iter; left time: 1295.8209s
Epoch: 12 cost time: 14.09987735748291
Epoch: 12, Steps: 208 | Train Loss: 1.510 Vali Loss: 4.538 Vali Acc: 0.094 Test Loss: 4.538 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.6403896
	speed: 0.1848s/iter; left time: 3363.8064s
	iters: 200, epoch: 13 | loss: 1.0593903
	speed: 0.0681s/iter; left time: 1232.2202s
Epoch: 13 cost time: 15.099818706512451
Epoch: 13, Steps: 208 | Train Loss: 1.163 Vali Loss: 4.974 Vali Acc: 0.094 Test Loss: 4.974 Test Acc: 0.094
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.1243646
	speed: 0.1891s/iter; left time: 3403.0308s
	iters: 200, epoch: 14 | loss: 1.5247113
	speed: 0.0751s/iter; left time: 1344.5150s
Epoch: 14 cost time: 15.755743265151978
Epoch: 14, Steps: 208 | Train Loss: 0.900 Vali Loss: 5.615 Vali Acc: 0.086 Test Loss: 5.615 Test Acc: 0.086
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.5022305
	speed: 0.1780s/iter; left time: 3165.7200s
	iters: 200, epoch: 15 | loss: 1.5126576
	speed: 0.0600s/iter; left time: 1061.4889s
Epoch: 15 cost time: 12.543327331542969
Epoch: 15, Steps: 208 | Train Loss: 0.731 Vali Loss: 6.017 Vali Acc: 0.093 Test Loss: 6.017 Test Acc: 0.093
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.6487156
	speed: 0.1848s/iter; left time: 3249.5125s
	iters: 200, epoch: 16 | loss: 0.4654472
	speed: 0.0582s/iter; left time: 1016.7088s
Epoch: 16 cost time: 13.923099756240845
Epoch: 16, Steps: 208 | Train Loss: 0.610 Vali Loss: 6.220 Vali Acc: 0.101 Test Loss: 6.220 Test Acc: 0.101
Validation loss decreased (-0.095097 --> -0.100743).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.2322079
	speed: 0.1747s/iter; left time: 3035.6565s
	iters: 200, epoch: 17 | loss: 0.6503119
	speed: 0.0656s/iter; left time: 1133.6341s
Epoch: 17 cost time: 14.273975610733032
Epoch: 17, Steps: 208 | Train Loss: 0.503 Vali Loss: 6.663 Vali Acc: 0.098 Test Loss: 6.663 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.8344436
	speed: 0.1446s/iter; left time: 2482.6983s
	iters: 200, epoch: 18 | loss: 0.8166877
	speed: 0.0638s/iter; left time: 1087.9504s
Epoch: 18 cost time: 11.841065645217896
Epoch: 18, Steps: 208 | Train Loss: 0.467 Vali Loss: 7.207 Vali Acc: 0.093 Test Loss: 7.207 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.5110918
	speed: 0.1606s/iter; left time: 2723.8898s
	iters: 200, epoch: 19 | loss: 0.6056115
	speed: 0.0572s/iter; left time: 963.8971s
Epoch: 19 cost time: 12.067661762237549
Epoch: 19, Steps: 208 | Train Loss: 0.399 Vali Loss: 7.182 Vali Acc: 0.096 Test Loss: 7.182 Test Acc: 0.096
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.3163761
	speed: 0.1672s/iter; left time: 2801.2412s
	iters: 200, epoch: 20 | loss: 0.7560236
	speed: 0.0606s/iter; left time: 1009.6181s
Epoch: 20 cost time: 12.889815092086792
Epoch: 20, Steps: 208 | Train Loss: 0.372 Vali Loss: 7.287 Vali Acc: 0.094 Test Loss: 7.287 Test Acc: 0.094
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.3900298
	speed: 0.1697s/iter; left time: 2807.0046s
	iters: 200, epoch: 21 | loss: 0.7713012
	speed: 0.0600s/iter; left time: 987.1766s
Epoch: 21 cost time: 12.732755661010742
Epoch: 21, Steps: 208 | Train Loss: 0.337 Vali Loss: 7.691 Vali Acc: 0.096 Test Loss: 7.691 Test Acc: 0.096
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0575608
	speed: 0.1441s/iter; left time: 2353.8665s
	iters: 200, epoch: 22 | loss: 0.2891142
	speed: 0.0625s/iter; left time: 1013.8606s
Epoch: 22 cost time: 12.37534499168396
Epoch: 22, Steps: 208 | Train Loss: 0.322 Vali Loss: 8.087 Vali Acc: 0.092 Test Loss: 8.087 Test Acc: 0.092
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.9367492
	speed: 0.1487s/iter; left time: 2397.7629s
	iters: 200, epoch: 23 | loss: 0.4985674
	speed: 0.0462s/iter; left time: 741.0446s
Epoch: 23 cost time: 10.583776235580444
Epoch: 23, Steps: 208 | Train Loss: 0.295 Vali Loss: 8.192 Vali Acc: 0.094 Test Loss: 8.192 Test Acc: 0.094
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.3211238
	speed: 0.1611s/iter; left time: 2564.5010s
	iters: 200, epoch: 24 | loss: 0.0560483
	speed: 0.0515s/iter; left time: 814.8095s
Epoch: 24 cost time: 12.310089349746704
Epoch: 24, Steps: 208 | Train Loss: 0.285 Vali Loss: 8.492 Vali Acc: 0.102 Test Loss: 8.492 Test Acc: 0.102
Validation loss decreased (-0.100743 --> -0.101913).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.6068934
	speed: 0.1539s/iter; left time: 2417.9706s
	iters: 200, epoch: 25 | loss: 0.1749808
	speed: 0.0603s/iter; left time: 941.1217s
Epoch: 25 cost time: 12.867874145507812
Epoch: 25, Steps: 208 | Train Loss: 0.265 Vali Loss: 8.655 Vali Acc: 0.100 Test Loss: 8.655 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.1420673
	speed: 0.1402s/iter; left time: 2173.8339s
	iters: 200, epoch: 26 | loss: 0.1096393
	speed: 0.0609s/iter; left time: 937.4912s
Epoch: 26 cost time: 11.995134830474854
Epoch: 26, Steps: 208 | Train Loss: 0.249 Vali Loss: 9.052 Vali Acc: 0.090 Test Loss: 9.052 Test Acc: 0.090
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.1360276
	speed: 0.1507s/iter; left time: 2304.5362s
	iters: 200, epoch: 27 | loss: 0.1064777
	speed: 0.0531s/iter; left time: 807.0276s
Epoch: 27 cost time: 11.619372844696045
Epoch: 27, Steps: 208 | Train Loss: 0.240 Vali Loss: 9.107 Vali Acc: 0.092 Test Loss: 9.107 Test Acc: 0.092
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.1691466
	speed: 0.1567s/iter; left time: 2364.3835s
	iters: 200, epoch: 28 | loss: 0.1500272
	speed: 0.0517s/iter; left time: 774.9192s
Epoch: 28 cost time: 12.00424838066101
Epoch: 28, Steps: 208 | Train Loss: 0.246 Vali Loss: 9.412 Vali Acc: 0.099 Test Loss: 9.412 Test Acc: 0.099
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.5943351
	speed: 0.1489s/iter; left time: 2214.5419s
	iters: 200, epoch: 29 | loss: 0.1387486
	speed: 0.0595s/iter; left time: 879.5358s
Epoch: 29 cost time: 13.020110130310059
Epoch: 29, Steps: 208 | Train Loss: 0.208 Vali Loss: 9.448 Vali Acc: 0.101 Test Loss: 9.448 Test Acc: 0.101
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.3537648
	speed: 0.1475s/iter; left time: 2164.3914s
	iters: 200, epoch: 30 | loss: 0.1064355
	speed: 0.0586s/iter; left time: 853.9116s
Epoch: 30 cost time: 12.021874189376831
Epoch: 30, Steps: 208 | Train Loss: 0.203 Vali Loss: 9.558 Vali Acc: 0.102 Test Loss: 9.558 Test Acc: 0.102
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.3000770
	speed: 0.1594s/iter; left time: 2304.5913s
	iters: 200, epoch: 31 | loss: 0.7072275
	speed: 0.0574s/iter; left time: 824.7716s
Epoch: 31 cost time: 12.699648141860962
Epoch: 31, Steps: 208 | Train Loss: 0.200 Vali Loss: 9.864 Vali Acc: 0.094 Test Loss: 9.864 Test Acc: 0.094
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.0332513
	speed: 0.1747s/iter; left time: 2490.0293s
	iters: 200, epoch: 32 | loss: 0.3676641
	speed: 0.0533s/iter; left time: 753.9467s
Epoch: 32 cost time: 13.023797273635864
Epoch: 32, Steps: 208 | Train Loss: 0.191 Vali Loss: 10.068 Vali Acc: 0.094 Test Loss: 10.068 Test Acc: 0.094
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.1860364
	speed: 0.1748s/iter; left time: 2454.4264s
	iters: 200, epoch: 33 | loss: 0.0515229
	speed: 0.0564s/iter; left time: 786.2580s
Epoch: 33 cost time: 12.965147972106934
Epoch: 33, Steps: 208 | Train Loss: 0.176 Vali Loss: 9.893 Vali Acc: 0.098 Test Loss: 9.893 Test Acc: 0.098
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.1745663
	speed: 0.1467s/iter; left time: 2029.3492s
	iters: 200, epoch: 34 | loss: 0.3323277
	speed: 0.0696s/iter; left time: 956.3152s
Epoch: 34 cost time: 12.80306077003479
Epoch: 34, Steps: 208 | Train Loss: 0.191 Vali Loss: 10.616 Vali Acc: 0.098 Test Loss: 10.616 Test Acc: 0.098
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10199821055770951
model parameter : 792831
model size : 4.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0255494
	speed: 0.0769s/iter; left time: 1592.1839s
	iters: 200, epoch: 1 | loss: 3.3872342
	speed: 0.0561s/iter; left time: 1155.4674s
Epoch: 1 cost time: 13.863638877868652
Epoch: 1, Steps: 208 | Train Loss: 4.218 Vali Loss: 4.701 Vali Acc: 0.049 Test Loss: 4.701 Test Acc: 0.049
Validation loss decreased (inf --> -0.048864).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.5086961
	speed: 0.1536s/iter; left time: 3147.2140s
	iters: 200, epoch: 2 | loss: 4.6153798
	speed: 0.0634s/iter; left time: 1293.6251s
Epoch: 2 cost time: 13.457996845245361
Epoch: 2, Steps: 208 | Train Loss: 4.578 Vali Loss: 5.019 Vali Acc: 0.038 Test Loss: 5.019 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.9302678
	speed: 0.1392s/iter; left time: 2823.8364s
	iters: 200, epoch: 3 | loss: 3.9910731
	speed: 0.0495s/iter; left time: 999.2521s
Epoch: 3 cost time: 10.865473985671997
Epoch: 3, Steps: 208 | Train Loss: 4.070 Vali Loss: 3.876 Vali Acc: 0.048 Test Loss: 3.876 Test Acc: 0.048
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 3.8714626
	speed: 0.1574s/iter; left time: 3159.5437s
	iters: 200, epoch: 4 | loss: 4.0051651
	speed: 0.0529s/iter; left time: 1055.8383s
Epoch: 4 cost time: 11.726818799972534
Epoch: 4, Steps: 208 | Train Loss: 3.653 Vali Loss: 3.677 Vali Acc: 0.065 Test Loss: 3.677 Test Acc: 0.065
Validation loss decreased (-0.048864 --> -0.065278).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.1332655
	speed: 0.1618s/iter; left time: 3214.1990s
	iters: 200, epoch: 5 | loss: 3.1573610
	speed: 0.0553s/iter; left time: 1092.3956s
Epoch: 5 cost time: 12.410856008529663
Epoch: 5, Steps: 208 | Train Loss: 3.417 Vali Loss: 3.486 Vali Acc: 0.068 Test Loss: 3.486 Test Acc: 0.068
Validation loss decreased (-0.065278 --> -0.068262).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.4090967
	speed: 0.1571s/iter; left time: 3089.3264s
	iters: 200, epoch: 6 | loss: 3.0061083
	speed: 0.0625s/iter; left time: 1222.2021s
Epoch: 6 cost time: 13.50795578956604
Epoch: 6, Steps: 208 | Train Loss: 3.129 Vali Loss: 3.313 Vali Acc: 0.095 Test Loss: 3.313 Test Acc: 0.095
Validation loss decreased (-0.068262 --> -0.094509).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9793143
	speed: 0.1510s/iter; left time: 2936.4433s
	iters: 200, epoch: 7 | loss: 3.3061166
	speed: 0.0627s/iter; left time: 1212.5832s
Epoch: 7 cost time: 12.181451797485352
Epoch: 7, Steps: 208 | Train Loss: 2.851 Vali Loss: 3.286 Vali Acc: 0.102 Test Loss: 3.286 Test Acc: 0.102
Validation loss decreased (-0.094509 --> -0.101667).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.2755566
	speed: 0.1484s/iter; left time: 2855.3153s
	iters: 200, epoch: 8 | loss: 2.3678215
	speed: 0.0519s/iter; left time: 993.2462s
Epoch: 8 cost time: 11.314282655715942
Epoch: 8, Steps: 208 | Train Loss: 2.597 Vali Loss: 3.352 Vali Acc: 0.099 Test Loss: 3.352 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.3922050
	speed: 0.1592s/iter; left time: 3031.2552s
	iters: 200, epoch: 9 | loss: 3.0101390
	speed: 0.0527s/iter; left time: 997.5260s
Epoch: 9 cost time: 12.461033582687378
Epoch: 9, Steps: 208 | Train Loss: 2.308 Vali Loss: 3.622 Vali Acc: 0.109 Test Loss: 3.622 Test Acc: 0.109
Validation loss decreased (-0.101667 --> -0.108822).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.7756276
	speed: 0.1480s/iter; left time: 2787.1495s
	iters: 200, epoch: 10 | loss: 2.4522116
	speed: 0.0263s/iter; left time: 492.2230s
Epoch: 10 cost time: 8.538687944412231
Epoch: 10, Steps: 208 | Train Loss: 1.878 Vali Loss: 3.680 Vali Acc: 0.103 Test Loss: 3.680 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.1311493
	speed: 0.0939s/iter; left time: 1749.3583s
	iters: 200, epoch: 11 | loss: 1.7201341
	speed: 0.0238s/iter; left time: 441.5364s
Epoch: 11 cost time: 5.6944310665130615
Epoch: 11, Steps: 208 | Train Loss: 1.464 Vali Loss: 4.368 Vali Acc: 0.108 Test Loss: 4.368 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.0180470
	speed: 0.1583s/iter; left time: 2914.6152s
	iters: 200, epoch: 12 | loss: 1.0724781
	speed: 0.0576s/iter; left time: 1055.0192s
Epoch: 12 cost time: 12.789596796035767
Epoch: 12, Steps: 208 | Train Loss: 1.072 Vali Loss: 4.915 Vali Acc: 0.114 Test Loss: 4.915 Test Acc: 0.114
Validation loss decreased (-0.108822 --> -0.113879).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.0102855
	speed: 0.1518s/iter; left time: 2763.0792s
	iters: 200, epoch: 13 | loss: 1.1755942
	speed: 0.0631s/iter; left time: 1142.1074s
Epoch: 13 cost time: 13.336127042770386
Epoch: 13, Steps: 208 | Train Loss: 0.793 Vali Loss: 5.567 Vali Acc: 0.110 Test Loss: 5.567 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.6764122
	speed: 0.1479s/iter; left time: 2662.1784s
	iters: 200, epoch: 14 | loss: 1.0564113
	speed: 0.0683s/iter; left time: 1222.5398s
Epoch: 14 cost time: 13.480196952819824
Epoch: 14, Steps: 208 | Train Loss: 0.668 Vali Loss: 5.590 Vali Acc: 0.101 Test Loss: 5.590 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.9693145
	speed: 0.1783s/iter; left time: 3172.1899s
	iters: 200, epoch: 15 | loss: 0.5252486
	speed: 0.0520s/iter; left time: 920.5384s
Epoch: 15 cost time: 12.051297903060913
Epoch: 15, Steps: 208 | Train Loss: 0.514 Vali Loss: 6.201 Vali Acc: 0.115 Test Loss: 6.201 Test Acc: 0.115
Validation loss decreased (-0.113879 --> -0.115357).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.7741639
	speed: 0.1687s/iter; left time: 2965.6851s
	iters: 200, epoch: 16 | loss: 0.1567084
	speed: 0.0537s/iter; left time: 938.6321s
Epoch: 16 cost time: 11.874834060668945
Epoch: 16, Steps: 208 | Train Loss: 0.443 Vali Loss: 6.683 Vali Acc: 0.118 Test Loss: 6.683 Test Acc: 0.118
Validation loss decreased (-0.115357 --> -0.118036).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.2148730
	speed: 0.1686s/iter; left time: 2928.4804s
	iters: 200, epoch: 17 | loss: 0.2936374
	speed: 0.0737s/iter; left time: 1273.1036s
Epoch: 17 cost time: 15.426408052444458
Epoch: 17, Steps: 208 | Train Loss: 0.383 Vali Loss: 7.138 Vali Acc: 0.106 Test Loss: 7.138 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.3814425
	speed: 0.1555s/iter; left time: 2668.6655s
	iters: 200, epoch: 18 | loss: 0.4976961
	speed: 0.0642s/iter; left time: 1095.8864s
Epoch: 18 cost time: 12.82453465461731
Epoch: 18, Steps: 208 | Train Loss: 0.378 Vali Loss: 7.187 Vali Acc: 0.116 Test Loss: 7.187 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.1537700
	speed: 0.1617s/iter; left time: 2742.3543s
	iters: 200, epoch: 19 | loss: 0.0627152
	speed: 0.0438s/iter; left time: 737.5317s
Epoch: 19 cost time: 10.282230377197266
Epoch: 19, Steps: 208 | Train Loss: 0.296 Vali Loss: 7.346 Vali Acc: 0.115 Test Loss: 7.346 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.1524762
	speed: 0.1573s/iter; left time: 2633.8932s
	iters: 200, epoch: 20 | loss: 0.5117674
	speed: 0.0546s/iter; left time: 909.3790s
Epoch: 20 cost time: 11.754809856414795
Epoch: 20, Steps: 208 | Train Loss: 0.289 Vali Loss: 7.614 Vali Acc: 0.115 Test Loss: 7.614 Test Acc: 0.115
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.4795302
	speed: 0.1501s/iter; left time: 2483.0537s
	iters: 200, epoch: 21 | loss: 0.5104188
	speed: 0.0598s/iter; left time: 983.1332s
Epoch: 21 cost time: 13.099342823028564
Epoch: 21, Steps: 208 | Train Loss: 0.274 Vali Loss: 8.061 Vali Acc: 0.109 Test Loss: 8.061 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.2482230
	speed: 0.1368s/iter; left time: 2235.0078s
	iters: 200, epoch: 22 | loss: 0.0071776
	speed: 0.0639s/iter; left time: 1036.8460s
Epoch: 22 cost time: 12.225015640258789
Epoch: 22, Steps: 208 | Train Loss: 0.246 Vali Loss: 8.391 Vali Acc: 0.112 Test Loss: 8.391 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.2813171
	speed: 0.1539s/iter; left time: 2481.2285s
	iters: 200, epoch: 23 | loss: 0.1357919
	speed: 0.0534s/iter; left time: 855.6564s
Epoch: 23 cost time: 10.914789199829102
Epoch: 23, Steps: 208 | Train Loss: 0.236 Vali Loss: 8.241 Vali Acc: 0.108 Test Loss: 8.241 Test Acc: 0.108
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.4685751
	speed: 0.1332s/iter; left time: 2119.5970s
	iters: 200, epoch: 24 | loss: 0.1526621
	speed: 0.0405s/iter; left time: 639.8762s
Epoch: 24 cost time: 9.045552492141724
Epoch: 24, Steps: 208 | Train Loss: 0.217 Vali Loss: 7.992 Vali Acc: 0.105 Test Loss: 7.992 Test Acc: 0.105
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.2561490
	speed: 0.1545s/iter; left time: 2427.2767s
	iters: 200, epoch: 25 | loss: 0.5094954
	speed: 0.0629s/iter; left time: 981.1622s
Epoch: 25 cost time: 13.632686853408813
Epoch: 25, Steps: 208 | Train Loss: 0.218 Vali Loss: 8.658 Vali Acc: 0.107 Test Loss: 8.658 Test Acc: 0.107
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.1792135
	speed: 0.1473s/iter; left time: 2282.9730s
	iters: 200, epoch: 26 | loss: 0.2145568
	speed: 0.0614s/iter; left time: 945.5764s
Epoch: 26 cost time: 12.15583348274231
Epoch: 26, Steps: 208 | Train Loss: 0.191 Vali Loss: 8.340 Vali Acc: 0.115 Test Loss: 8.340 Test Acc: 0.115
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1181031911720847
model parameter : 791615
model size : 4.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5256588
	speed: 0.0721s/iter; left time: 1492.5895s
	iters: 200, epoch: 1 | loss: 4.2463412
	speed: 0.0512s/iter; left time: 1055.5227s
Epoch: 1 cost time: 12.612818956375122
Epoch: 1, Steps: 208 | Train Loss: 4.234 Vali Loss: 4.806 Vali Acc: 0.041 Test Loss: 4.806 Test Acc: 0.041
Validation loss decreased (inf --> -0.040513).  Saving model ...
	iters: 100, epoch: 2 | loss: 5.3694167
	speed: 0.1575s/iter; left time: 3227.1992s
	iters: 200, epoch: 2 | loss: 3.8171930
	speed: 0.0602s/iter; left time: 1226.7988s
Epoch: 2 cost time: 12.608528137207031
Epoch: 2, Steps: 208 | Train Loss: 4.581 Vali Loss: 4.956 Vali Acc: 0.049 Test Loss: 4.956 Test Acc: 0.049
Validation loss decreased (-0.040513 --> -0.049160).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.8491659
	speed: 0.1423s/iter; left time: 2887.1554s
	iters: 200, epoch: 3 | loss: 3.7905226
	speed: 0.0599s/iter; left time: 1208.2576s
Epoch: 3 cost time: 12.192551374435425
Epoch: 3, Steps: 208 | Train Loss: 4.034 Vali Loss: 3.925 Vali Acc: 0.051 Test Loss: 3.925 Test Acc: 0.051
Validation loss decreased (-0.049160 --> -0.051258).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.7553353
	speed: 0.1442s/iter; left time: 2894.7480s
	iters: 200, epoch: 4 | loss: 3.9309311
	speed: 0.0496s/iter; left time: 990.3043s
Epoch: 4 cost time: 10.69032907485962
Epoch: 4, Steps: 208 | Train Loss: 3.776 Vali Loss: 3.855 Vali Acc: 0.053 Test Loss: 3.855 Test Acc: 0.053
Validation loss decreased (-0.051258 --> -0.052750).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.6643903
	speed: 0.1514s/iter; left time: 3008.2084s
	iters: 200, epoch: 5 | loss: 3.7752578
	speed: 0.0453s/iter; left time: 895.9689s
Epoch: 5 cost time: 10.291123390197754
Epoch: 5, Steps: 208 | Train Loss: 3.636 Vali Loss: 3.820 Vali Acc: 0.058 Test Loss: 3.820 Test Acc: 0.058
Validation loss decreased (-0.052750 --> -0.058417).  Saving model ...
	iters: 100, epoch: 6 | loss: 4.4265823
	speed: 0.1764s/iter; left time: 3467.3304s
	iters: 200, epoch: 6 | loss: 3.6978402
	speed: 0.0571s/iter; left time: 1117.7641s
Epoch: 6 cost time: 13.61509895324707
Epoch: 6, Steps: 208 | Train Loss: 3.532 Vali Loss: 3.727 Vali Acc: 0.059 Test Loss: 3.727 Test Acc: 0.059
Validation loss decreased (-0.058417 --> -0.059014).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.1195691
	speed: 0.1685s/iter; left time: 3277.4191s
	iters: 200, epoch: 7 | loss: 3.1744809
	speed: 0.0710s/iter; left time: 1374.2343s
Epoch: 7 cost time: 14.851178169250488
Epoch: 7, Steps: 208 | Train Loss: 3.387 Vali Loss: 3.579 Vali Acc: 0.078 Test Loss: 3.579 Test Acc: 0.078
Validation loss decreased (-0.059014 --> -0.078401).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.9510162
	speed: 0.1523s/iter; left time: 2931.3317s
	iters: 200, epoch: 8 | loss: 3.0195827
	speed: 0.0575s/iter; left time: 1100.5606s
Epoch: 8 cost time: 11.455267429351807
Epoch: 8, Steps: 208 | Train Loss: 3.081 Vali Loss: 3.597 Vali Acc: 0.081 Test Loss: 3.597 Test Acc: 0.081
Validation loss decreased (-0.078401 --> -0.080787).  Saving model ...
	iters: 100, epoch: 9 | loss: 3.0517526
	speed: 0.1722s/iter; left time: 3278.6990s
	iters: 200, epoch: 9 | loss: 2.4262240
	speed: 0.0515s/iter; left time: 975.3125s
Epoch: 9 cost time: 11.390264987945557
Epoch: 9, Steps: 208 | Train Loss: 2.776 Vali Loss: 3.648 Vali Acc: 0.094 Test Loss: 3.648 Test Acc: 0.094
Validation loss decreased (-0.080787 --> -0.094207).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.0542533
	speed: 0.1724s/iter; left time: 3246.0301s
	iters: 200, epoch: 10 | loss: 3.3567677
	speed: 0.0566s/iter; left time: 1060.5309s
Epoch: 10 cost time: 13.14211106300354
Epoch: 10, Steps: 208 | Train Loss: 2.464 Vali Loss: 3.692 Vali Acc: 0.099 Test Loss: 3.692 Test Acc: 0.099
Validation loss decreased (-0.094207 --> -0.099277).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.3355880
	speed: 0.1409s/iter; left time: 2624.4508s
	iters: 200, epoch: 11 | loss: 2.1397641
	speed: 0.0304s/iter; left time: 562.1250s
Epoch: 11 cost time: 8.594637870788574
Epoch: 11, Steps: 208 | Train Loss: 2.143 Vali Loss: 3.831 Vali Acc: 0.096 Test Loss: 3.831 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.7409009
	speed: 0.0897s/iter; left time: 1651.1599s
	iters: 200, epoch: 12 | loss: 2.1036296
	speed: 0.0235s/iter; left time: 429.6346s
Epoch: 12 cost time: 5.287572145462036
Epoch: 12, Steps: 208 | Train Loss: 1.795 Vali Loss: 4.073 Vali Acc: 0.098 Test Loss: 4.073 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.2547495
	speed: 0.1442s/iter; left time: 2625.2406s
	iters: 200, epoch: 13 | loss: 1.9767611
	speed: 0.0538s/iter; left time: 973.6910s
Epoch: 13 cost time: 11.863300085067749
Epoch: 13, Steps: 208 | Train Loss: 1.463 Vali Loss: 4.348 Vali Acc: 0.109 Test Loss: 4.348 Test Acc: 0.109
Validation loss decreased (-0.099277 --> -0.109411).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.0310272
	speed: 0.1479s/iter; left time: 2660.9031s
	iters: 200, epoch: 14 | loss: 2.0645626
	speed: 0.0633s/iter; left time: 1133.2837s
Epoch: 14 cost time: 13.031370401382446
Epoch: 14, Steps: 208 | Train Loss: 1.144 Vali Loss: 4.706 Vali Acc: 0.100 Test Loss: 4.706 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.8768533
	speed: 0.1474s/iter; left time: 2621.7526s
	iters: 200, epoch: 15 | loss: 1.0712667
	speed: 0.0348s/iter; left time: 615.4321s
Epoch: 15 cost time: 9.542430400848389
Epoch: 15, Steps: 208 | Train Loss: 0.905 Vali Loss: 5.220 Vali Acc: 0.109 Test Loss: 5.220 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.4284549
	speed: 0.1567s/iter; left time: 2754.8046s
	iters: 200, epoch: 16 | loss: 1.1628388
	speed: 0.0537s/iter; left time: 938.7682s
Epoch: 16 cost time: 12.156111240386963
Epoch: 16, Steps: 208 | Train Loss: 0.697 Vali Loss: 5.604 Vali Acc: 0.105 Test Loss: 5.604 Test Acc: 0.105
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.4774275
	speed: 0.1611s/iter; left time: 2798.7208s
	iters: 200, epoch: 17 | loss: 0.6112508
	speed: 0.0564s/iter; left time: 974.3044s
Epoch: 17 cost time: 12.233799457550049
Epoch: 17, Steps: 208 | Train Loss: 0.588 Vali Loss: 6.076 Vali Acc: 0.109 Test Loss: 6.076 Test Acc: 0.109
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.4172824
	speed: 0.1432s/iter; left time: 2458.2238s
	iters: 200, epoch: 18 | loss: 0.1925485
	speed: 0.0570s/iter; left time: 972.1459s
Epoch: 18 cost time: 11.56527829170227
Epoch: 18, Steps: 208 | Train Loss: 0.494 Vali Loss: 6.353 Vali Acc: 0.106 Test Loss: 6.353 Test Acc: 0.106
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0790995
	speed: 0.1543s/iter; left time: 2615.6237s
	iters: 200, epoch: 19 | loss: 0.8035138
	speed: 0.0451s/iter; left time: 759.6085s
Epoch: 19 cost time: 10.9923677444458
Epoch: 19, Steps: 208 | Train Loss: 0.442 Vali Loss: 6.560 Vali Acc: 0.101 Test Loss: 6.560 Test Acc: 0.101
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.7847627
	speed: 0.1441s/iter; left time: 2413.0662s
	iters: 200, epoch: 20 | loss: 0.3407512
	speed: 0.0463s/iter; left time: 770.7543s
Epoch: 20 cost time: 11.002974510192871
Epoch: 20, Steps: 208 | Train Loss: 0.396 Vali Loss: 7.022 Vali Acc: 0.104 Test Loss: 7.022 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.7995167
	speed: 0.1519s/iter; left time: 2512.5570s
	iters: 200, epoch: 21 | loss: 0.3391515
	speed: 0.0608s/iter; left time: 999.2623s
Epoch: 21 cost time: 13.108361959457397
Epoch: 21, Steps: 208 | Train Loss: 0.383 Vali Loss: 7.157 Vali Acc: 0.103 Test Loss: 7.157 Test Acc: 0.103
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.3564277
	speed: 0.1522s/iter; left time: 2486.0009s
	iters: 200, epoch: 22 | loss: 0.3374964
	speed: 0.0550s/iter; left time: 893.5608s
Epoch: 22 cost time: 11.312039613723755
Epoch: 22, Steps: 208 | Train Loss: 0.353 Vali Loss: 7.511 Vali Acc: 0.108 Test Loss: 7.511 Test Acc: 0.108
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.4991385
	speed: 0.1304s/iter; left time: 2102.8640s
	iters: 200, epoch: 23 | loss: 0.3287596
	speed: 0.0293s/iter; left time: 469.3930s
Epoch: 23 cost time: 8.033332347869873
Epoch: 23, Steps: 208 | Train Loss: 0.314 Vali Loss: 7.473 Vali Acc: 0.106 Test Loss: 7.473 Test Acc: 0.106
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10945422010140173
model parameter : 790399
model size : 4.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0137911
	speed: 0.0439s/iter; left time: 908.2499s
	iters: 200, epoch: 1 | loss: 3.8503730
	speed: 0.0311s/iter; left time: 639.9391s
Epoch: 1 cost time: 7.829139471054077
Epoch: 1, Steps: 208 | Train Loss: 3.886 Vali Loss: 3.794 Vali Acc: 0.060 Test Loss: 3.794 Test Acc: 0.060
Validation loss decreased (inf --> -0.059610).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5590403
	speed: 0.1478s/iter; left time: 3027.8532s
	iters: 200, epoch: 2 | loss: 3.7696712
	speed: 0.0314s/iter; left time: 640.2698s
Epoch: 2 cost time: 6.884039402008057
Epoch: 2, Steps: 208 | Train Loss: 3.913 Vali Loss: 3.839 Vali Acc: 0.061 Test Loss: 3.839 Test Acc: 0.061
Validation loss decreased (-0.059610 --> -0.060803).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.7127192
	speed: 0.1339s/iter; left time: 2715.2699s
	iters: 200, epoch: 3 | loss: 4.0043397
	speed: 0.0328s/iter; left time: 661.8758s
Epoch: 3 cost time: 7.135184049606323
Epoch: 3, Steps: 208 | Train Loss: 3.684 Vali Loss: 3.811 Vali Acc: 0.067 Test Loss: 3.811 Test Acc: 0.067
Validation loss decreased (-0.060803 --> -0.067066).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.3092637
	speed: 0.1431s/iter; left time: 2872.2450s
	iters: 200, epoch: 4 | loss: 3.6680577
	speed: 0.0324s/iter; left time: 647.1730s
Epoch: 4 cost time: 6.881629943847656
Epoch: 4, Steps: 208 | Train Loss: 3.475 Vali Loss: 3.818 Vali Acc: 0.067 Test Loss: 3.818 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.2217088
	speed: 0.1325s/iter; left time: 2633.5404s
	iters: 200, epoch: 5 | loss: 2.9732351
	speed: 0.0328s/iter; left time: 648.9954s
Epoch: 5 cost time: 7.294132947921753
Epoch: 5, Steps: 208 | Train Loss: 3.253 Vali Loss: 3.693 Vali Acc: 0.072 Test Loss: 3.693 Test Acc: 0.072
Validation loss decreased (-0.067066 --> -0.071839).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.2073085
	speed: 0.1407s/iter; left time: 2766.7895s
	iters: 200, epoch: 6 | loss: 2.9807785
	speed: 0.0314s/iter; left time: 613.5453s
Epoch: 6 cost time: 6.878319025039673
Epoch: 6, Steps: 208 | Train Loss: 2.973 Vali Loss: 3.657 Vali Acc: 0.078 Test Loss: 3.657 Test Acc: 0.078
Validation loss decreased (-0.071839 --> -0.077506).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.7798069
	speed: 0.1294s/iter; left time: 2518.0886s
	iters: 200, epoch: 7 | loss: 2.9923272
	speed: 0.0288s/iter; left time: 557.6939s
Epoch: 7 cost time: 6.497365236282349
Epoch: 7, Steps: 208 | Train Loss: 2.692 Vali Loss: 3.632 Vali Acc: 0.091 Test Loss: 3.632 Test Acc: 0.091
Validation loss decreased (-0.077506 --> -0.090629).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.1279950
	speed: 0.1216s/iter; left time: 2340.0850s
	iters: 200, epoch: 8 | loss: 2.4981420
	speed: 0.0274s/iter; left time: 524.4656s
Epoch: 8 cost time: 5.936422824859619
Epoch: 8, Steps: 208 | Train Loss: 2.380 Vali Loss: 3.729 Vali Acc: 0.094 Test Loss: 3.729 Test Acc: 0.094
Validation loss decreased (-0.090629 --> -0.093908).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9266902
	speed: 0.1268s/iter; left time: 2414.7475s
	iters: 200, epoch: 9 | loss: 1.9672024
	speed: 0.0291s/iter; left time: 550.5718s
Epoch: 9 cost time: 6.39145302772522
Epoch: 9, Steps: 208 | Train Loss: 2.079 Vali Loss: 3.925 Vali Acc: 0.089 Test Loss: 3.925 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.6472007
	speed: 0.1219s/iter; left time: 2295.2861s
	iters: 200, epoch: 10 | loss: 2.9093108
	speed: 0.0273s/iter; left time: 510.7953s
Epoch: 10 cost time: 6.303297519683838
Epoch: 10, Steps: 208 | Train Loss: 1.767 Vali Loss: 4.126 Vali Acc: 0.088 Test Loss: 4.126 Test Acc: 0.088
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.8966630
	speed: 0.1230s/iter; left time: 2290.4300s
	iters: 200, epoch: 11 | loss: 2.2326567
	speed: 0.0287s/iter; left time: 531.5476s
Epoch: 11 cost time: 6.38429069519043
Epoch: 11, Steps: 208 | Train Loss: 1.471 Vali Loss: 4.385 Vali Acc: 0.095 Test Loss: 4.385 Test Acc: 0.095
Validation loss decreased (-0.093908 --> -0.094797).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.2236780
	speed: 0.1197s/iter; left time: 2204.9224s
	iters: 200, epoch: 12 | loss: 1.7499975
	speed: 0.0280s/iter; left time: 512.8623s
Epoch: 12 cost time: 6.3653175830841064
Epoch: 12, Steps: 208 | Train Loss: 1.201 Vali Loss: 4.701 Vali Acc: 0.109 Test Loss: 4.701 Test Acc: 0.109
Validation loss decreased (-0.094797 --> -0.109407).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.7769558
	speed: 0.1267s/iter; left time: 2307.0219s
	iters: 200, epoch: 13 | loss: 0.9368504
	speed: 0.0268s/iter; left time: 485.8312s
Epoch: 13 cost time: 6.2028844356536865
Epoch: 13, Steps: 208 | Train Loss: 0.973 Vali Loss: 5.100 Vali Acc: 0.095 Test Loss: 5.100 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.9734737
	speed: 0.1229s/iter; left time: 2212.3761s
	iters: 200, epoch: 14 | loss: 0.9362109
	speed: 0.0289s/iter; left time: 517.1949s
Epoch: 14 cost time: 6.328465938568115
Epoch: 14, Steps: 208 | Train Loss: 0.774 Vali Loss: 5.394 Vali Acc: 0.095 Test Loss: 5.394 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.6324580
	speed: 0.1357s/iter; left time: 2414.0156s
	iters: 200, epoch: 15 | loss: 0.8138070
	speed: 0.0280s/iter; left time: 495.7797s
Epoch: 15 cost time: 6.593300104141235
Epoch: 15, Steps: 208 | Train Loss: 0.664 Vali Loss: 6.162 Vali Acc: 0.098 Test Loss: 6.162 Test Acc: 0.098
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.5924509
	speed: 0.1180s/iter; left time: 2074.3612s
	iters: 200, epoch: 16 | loss: 0.5628622
	speed: 0.0281s/iter; left time: 490.4986s
Epoch: 16 cost time: 6.30063009262085
Epoch: 16, Steps: 208 | Train Loss: 0.575 Vali Loss: 6.230 Vali Acc: 0.094 Test Loss: 6.230 Test Acc: 0.094
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.9147599
	speed: 0.1216s/iter; left time: 2112.2644s
	iters: 200, epoch: 17 | loss: 0.4214068
	speed: 0.0294s/iter; left time: 507.3469s
Epoch: 17 cost time: 6.484179496765137
Epoch: 17, Steps: 208 | Train Loss: 0.503 Vali Loss: 6.544 Vali Acc: 0.102 Test Loss: 6.544 Test Acc: 0.102
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.6169472
	speed: 0.1237s/iter; left time: 2123.8443s
	iters: 200, epoch: 18 | loss: 0.5423183
	speed: 0.0279s/iter; left time: 475.8133s
Epoch: 18 cost time: 6.38122296333313
Epoch: 18, Steps: 208 | Train Loss: 0.442 Vali Loss: 6.683 Vali Acc: 0.097 Test Loss: 6.683 Test Acc: 0.097
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.9042976
	speed: 0.1200s/iter; left time: 2034.9281s
	iters: 200, epoch: 19 | loss: 0.1541485
	speed: 0.0277s/iter; left time: 466.1079s
Epoch: 19 cost time: 6.372257947921753
Epoch: 19, Steps: 208 | Train Loss: 0.381 Vali Loss: 7.041 Vali Acc: 0.101 Test Loss: 7.041 Test Acc: 0.101
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.2723015
	speed: 0.1319s/iter; left time: 2209.8039s
	iters: 200, epoch: 20 | loss: 0.3202609
	speed: 0.0279s/iter; left time: 465.0789s
Epoch: 20 cost time: 6.527806520462036
Epoch: 20, Steps: 208 | Train Loss: 0.355 Vali Loss: 7.337 Vali Acc: 0.096 Test Loss: 7.337 Test Acc: 0.096
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.2936758
	speed: 0.1228s/iter; left time: 2031.7554s
	iters: 200, epoch: 21 | loss: 0.2301790
	speed: 0.0291s/iter; left time: 477.7673s
Epoch: 21 cost time: 6.355498790740967
Epoch: 21, Steps: 208 | Train Loss: 0.334 Vali Loss: 7.679 Vali Acc: 0.100 Test Loss: 7.679 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.3059070
	speed: 0.1223s/iter; left time: 1996.7526s
	iters: 200, epoch: 22 | loss: 0.0895625
	speed: 0.0295s/iter; left time: 479.5039s
Epoch: 22 cost time: 6.416510820388794
Epoch: 22, Steps: 208 | Train Loss: 0.314 Vali Loss: 7.464 Vali Acc: 0.098 Test Loss: 7.464 Test Acc: 0.098
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10945422010140173
model parameter : 522815
model size : 2.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1032443
	speed: 0.0420s/iter; left time: 868.8580s
	iters: 200, epoch: 1 | loss: 4.0655737
	speed: 0.0276s/iter; left time: 569.0069s
Epoch: 1 cost time: 7.246065378189087
Epoch: 1, Steps: 208 | Train Loss: 3.903 Vali Loss: 3.985 Vali Acc: 0.060 Test Loss: 3.985 Test Acc: 0.060
Validation loss decreased (inf --> -0.059906).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.4253025
	speed: 0.1206s/iter; left time: 2470.7857s
	iters: 200, epoch: 2 | loss: 3.7068207
	speed: 0.0285s/iter; left time: 581.6974s
Epoch: 2 cost time: 6.143968820571899
Epoch: 2, Steps: 208 | Train Loss: 3.977 Vali Loss: 3.971 Vali Acc: 0.057 Test Loss: 3.971 Test Acc: 0.057
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.8828616
	speed: 0.1155s/iter; left time: 2343.0616s
	iters: 200, epoch: 3 | loss: 4.3077345
	speed: 0.0220s/iter; left time: 444.3579s
Epoch: 3 cost time: 5.616176605224609
Epoch: 3, Steps: 208 | Train Loss: 3.816 Vali Loss: 3.844 Vali Acc: 0.058 Test Loss: 3.844 Test Acc: 0.058
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 2.9357073
	speed: 0.1037s/iter; left time: 2081.7409s
	iters: 200, epoch: 4 | loss: 3.5906804
	speed: 0.0210s/iter; left time: 420.1832s
Epoch: 4 cost time: 4.753502368927002
Epoch: 4, Steps: 208 | Train Loss: 3.543 Vali Loss: 3.673 Vali Acc: 0.075 Test Loss: 3.673 Test Acc: 0.075
Validation loss decreased (-0.059906 --> -0.075418).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.7966952
	speed: 0.1200s/iter; left time: 2384.9440s
	iters: 200, epoch: 5 | loss: 3.4157853
	speed: 0.0319s/iter; left time: 630.1425s
Epoch: 5 cost time: 7.022456407546997
Epoch: 5, Steps: 208 | Train Loss: 3.298 Vali Loss: 3.578 Vali Acc: 0.081 Test Loss: 3.578 Test Acc: 0.081
Validation loss decreased (-0.075418 --> -0.080489).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.8093662
	speed: 0.1337s/iter; left time: 2628.6146s
	iters: 200, epoch: 6 | loss: 2.8226995
	speed: 0.0297s/iter; left time: 580.2945s
Epoch: 6 cost time: 6.583280563354492
Epoch: 6, Steps: 208 | Train Loss: 3.022 Vali Loss: 3.576 Vali Acc: 0.087 Test Loss: 3.576 Test Acc: 0.087
Validation loss decreased (-0.080489 --> -0.087349).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.1920526
	speed: 0.1319s/iter; left time: 2565.2802s
	iters: 200, epoch: 7 | loss: 3.8273842
	speed: 0.0325s/iter; left time: 628.7574s
Epoch: 7 cost time: 7.057437181472778
Epoch: 7, Steps: 208 | Train Loss: 2.740 Vali Loss: 3.497 Vali Acc: 0.098 Test Loss: 3.497 Test Acc: 0.098
Validation loss decreased (-0.087349 --> -0.098384).  Saving model ...
	iters: 100, epoch: 8 | loss: 3.1394029
	speed: 0.1297s/iter; left time: 2495.9194s
	iters: 200, epoch: 8 | loss: 2.3309326
	speed: 0.0276s/iter; left time: 528.4346s
Epoch: 8 cost time: 6.431548595428467
Epoch: 8, Steps: 208 | Train Loss: 2.452 Vali Loss: 3.637 Vali Acc: 0.101 Test Loss: 3.637 Test Acc: 0.101
Validation loss decreased (-0.098384 --> -0.101365).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.3093777
	speed: 0.1389s/iter; left time: 2643.5648s
	iters: 200, epoch: 9 | loss: 2.6515322
	speed: 0.0319s/iter; left time: 604.3789s
Epoch: 9 cost time: 7.019103050231934
Epoch: 9, Steps: 208 | Train Loss: 2.130 Vali Loss: 3.753 Vali Acc: 0.105 Test Loss: 3.753 Test Acc: 0.105
Validation loss decreased (-0.101365 --> -0.105241).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.0111210
	speed: 0.1178s/iter; left time: 2217.7585s
	iters: 200, epoch: 10 | loss: 2.0376177
	speed: 0.0272s/iter; left time: 509.5661s
Epoch: 10 cost time: 5.619335889816284
Epoch: 10, Steps: 208 | Train Loss: 1.795 Vali Loss: 4.066 Vali Acc: 0.098 Test Loss: 4.066 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.8021238
	speed: 0.1154s/iter; left time: 2149.1289s
	iters: 200, epoch: 11 | loss: 2.1789837
	speed: 0.0294s/iter; left time: 545.1648s
Epoch: 11 cost time: 6.451080083847046
Epoch: 11, Steps: 208 | Train Loss: 1.494 Vali Loss: 4.293 Vali Acc: 0.098 Test Loss: 4.293 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.2493063
	speed: 0.1108s/iter; left time: 2040.0388s
	iters: 200, epoch: 12 | loss: 2.1757593
	speed: 0.0254s/iter; left time: 465.9810s
Epoch: 12 cost time: 5.507250070571899
Epoch: 12, Steps: 208 | Train Loss: 1.188 Vali Loss: 4.882 Vali Acc: 0.097 Test Loss: 4.882 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.8006837
	speed: 0.1186s/iter; left time: 2158.7978s
	iters: 200, epoch: 13 | loss: 0.6781977
	speed: 0.0294s/iter; left time: 532.6709s
Epoch: 13 cost time: 6.528012990951538
Epoch: 13, Steps: 208 | Train Loss: 0.946 Vali Loss: 5.223 Vali Acc: 0.101 Test Loss: 5.223 Test Acc: 0.101
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.8809843
	speed: 0.1134s/iter; left time: 2040.2661s
	iters: 200, epoch: 14 | loss: 1.0174061
	speed: 0.0269s/iter; left time: 481.1977s
Epoch: 14 cost time: 5.5665364265441895
Epoch: 14, Steps: 208 | Train Loss: 0.734 Vali Loss: 5.574 Vali Acc: 0.108 Test Loss: 5.574 Test Acc: 0.108
Validation loss decreased (-0.105241 --> -0.107609).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.7790432
	speed: 0.1256s/iter; left time: 2234.4230s
	iters: 200, epoch: 15 | loss: 0.9851080
	speed: 0.0297s/iter; left time: 525.2759s
Epoch: 15 cost time: 6.5527663230896
Epoch: 15, Steps: 208 | Train Loss: 0.630 Vali Loss: 6.034 Vali Acc: 0.103 Test Loss: 6.034 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.6292781
	speed: 0.1153s/iter; left time: 2027.4232s
	iters: 200, epoch: 16 | loss: 0.5847179
	speed: 0.0282s/iter; left time: 492.7864s
Epoch: 16 cost time: 6.178955316543579
Epoch: 16, Steps: 208 | Train Loss: 0.534 Vali Loss: 6.297 Vali Acc: 0.101 Test Loss: 6.297 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.5083919
	speed: 0.1131s/iter; left time: 1964.8150s
	iters: 200, epoch: 17 | loss: 0.7716476
	speed: 0.0263s/iter; left time: 454.4054s
Epoch: 17 cost time: 5.8199851512908936
Epoch: 17, Steps: 208 | Train Loss: 0.470 Vali Loss: 6.637 Vali Acc: 0.097 Test Loss: 6.637 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.8400951
	speed: 0.1051s/iter; left time: 1804.8322s
	iters: 200, epoch: 18 | loss: 0.4107073
	speed: 0.0272s/iter; left time: 463.3920s
Epoch: 18 cost time: 5.95126485824585
Epoch: 18, Steps: 208 | Train Loss: 0.401 Vali Loss: 6.811 Vali Acc: 0.106 Test Loss: 6.811 Test Acc: 0.106
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.1217865
	speed: 0.1167s/iter; left time: 1979.2841s
	iters: 200, epoch: 19 | loss: 0.3055270
	speed: 0.0271s/iter; left time: 456.0381s
Epoch: 19 cost time: 5.877887010574341
Epoch: 19, Steps: 208 | Train Loss: 0.367 Vali Loss: 7.427 Vali Acc: 0.103 Test Loss: 7.427 Test Acc: 0.103
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.6690701
	speed: 0.1250s/iter; left time: 2093.1798s
	iters: 200, epoch: 20 | loss: 0.9000478
	speed: 0.0306s/iter; left time: 509.3161s
Epoch: 20 cost time: 6.751773357391357
Epoch: 20, Steps: 208 | Train Loss: 0.349 Vali Loss: 7.637 Vali Acc: 0.103 Test Loss: 7.637 Test Acc: 0.103
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 1.0173470
	speed: 0.1278s/iter; left time: 2113.5162s
	iters: 200, epoch: 21 | loss: 0.7187620
	speed: 0.0295s/iter; left time: 485.6459s
Epoch: 21 cost time: 6.394516706466675
Epoch: 21, Steps: 208 | Train Loss: 0.318 Vali Loss: 7.850 Vali Acc: 0.108 Test Loss: 7.850 Test Acc: 0.108
Validation loss decreased (-0.107609 --> -0.108183).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.2211758
	speed: 0.1163s/iter; left time: 1899.0739s
	iters: 200, epoch: 22 | loss: 0.2005016
	speed: 0.0293s/iter; left time: 476.2751s
Epoch: 22 cost time: 6.569715261459351
Epoch: 22, Steps: 208 | Train Loss: 0.278 Vali Loss: 8.209 Vali Acc: 0.109 Test Loss: 8.209 Test Acc: 0.109
Validation loss decreased (-0.108183 --> -0.109372).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.1316501
	speed: 0.1212s/iter; left time: 1954.1049s
	iters: 200, epoch: 23 | loss: 0.5766885
	speed: 0.0280s/iter; left time: 448.6899s
Epoch: 23 cost time: 6.116150140762329
Epoch: 23, Steps: 208 | Train Loss: 0.269 Vali Loss: 8.272 Vali Acc: 0.109 Test Loss: 8.272 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0811743
	speed: 0.1200s/iter; left time: 1910.8330s
	iters: 200, epoch: 24 | loss: 0.0636425
	speed: 0.0290s/iter; left time: 458.3986s
Epoch: 24 cost time: 6.438949823379517
Epoch: 24, Steps: 208 | Train Loss: 0.243 Vali Loss: 8.598 Vali Acc: 0.109 Test Loss: 8.598 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.1866152
	speed: 0.1270s/iter; left time: 1994.2589s
	iters: 200, epoch: 25 | loss: 0.4126927
	speed: 0.0256s/iter; left time: 400.2010s
Epoch: 25 cost time: 6.033050298690796
Epoch: 25, Steps: 208 | Train Loss: 0.239 Vali Loss: 9.041 Vali Acc: 0.103 Test Loss: 9.041 Test Acc: 0.103
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.1178059
	speed: 0.1247s/iter; left time: 1932.2031s
	iters: 200, epoch: 26 | loss: 0.2493945
	speed: 0.0288s/iter; left time: 442.9706s
Epoch: 26 cost time: 6.403252601623535
Epoch: 26, Steps: 208 | Train Loss: 0.244 Vali Loss: 8.841 Vali Acc: 0.111 Test Loss: 8.841 Test Acc: 0.111
Validation loss decreased (-0.109372 --> -0.110559).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0326351
	speed: 0.1179s/iter; left time: 1803.5160s
	iters: 200, epoch: 27 | loss: 0.1936736
	speed: 0.0291s/iter; left time: 441.8509s
Epoch: 27 cost time: 6.1173765659332275
Epoch: 27, Steps: 208 | Train Loss: 0.252 Vali Loss: 9.173 Vali Acc: 0.099 Test Loss: 9.173 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0391475
	speed: 0.1249s/iter; left time: 1883.4035s
	iters: 200, epoch: 28 | loss: 0.5697541
	speed: 0.0263s/iter; left time: 393.3626s
Epoch: 28 cost time: 6.110819339752197
Epoch: 28, Steps: 208 | Train Loss: 0.205 Vali Loss: 9.397 Vali Acc: 0.101 Test Loss: 9.397 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0888695
	speed: 0.1128s/iter; left time: 1677.4563s
	iters: 200, epoch: 29 | loss: 0.1898268
	speed: 0.0318s/iter; left time: 469.7488s
Epoch: 29 cost time: 6.0495476722717285
Epoch: 29, Steps: 208 | Train Loss: 0.198 Vali Loss: 9.549 Vali Acc: 0.108 Test Loss: 9.549 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.2363347
	speed: 0.1391s/iter; left time: 2040.4680s
	iters: 200, epoch: 30 | loss: 0.0733758
	speed: 0.0308s/iter; left time: 449.0576s
Epoch: 30 cost time: 6.919357061386108
Epoch: 30, Steps: 208 | Train Loss: 0.199 Vali Loss: 9.313 Vali Acc: 0.098 Test Loss: 9.313 Test Acc: 0.098
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.3300811
	speed: 0.1370s/iter; left time: 1981.3906s
	iters: 200, epoch: 31 | loss: 0.3699734
	speed: 0.0323s/iter; left time: 464.4500s
Epoch: 31 cost time: 7.241840600967407
Epoch: 31, Steps: 208 | Train Loss: 0.213 Vali Loss: 9.769 Vali Acc: 0.105 Test Loss: 9.769 Test Acc: 0.105
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.1909891
	speed: 0.1376s/iter; left time: 1960.9451s
	iters: 200, epoch: 32 | loss: 0.0237184
	speed: 0.0317s/iter; left time: 448.5352s
Epoch: 32 cost time: 6.743127107620239
Epoch: 32, Steps: 208 | Train Loss: 0.217 Vali Loss: 9.988 Vali Acc: 0.098 Test Loss: 9.988 Test Acc: 0.098
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.4682194
	speed: 0.1330s/iter; left time: 1868.0127s
	iters: 200, epoch: 33 | loss: 0.1338887
	speed: 0.0320s/iter; left time: 445.7676s
Epoch: 33 cost time: 7.104718446731567
Epoch: 33, Steps: 208 | Train Loss: 0.187 Vali Loss: 10.010 Vali Acc: 0.095 Test Loss: 10.010 Test Acc: 0.095
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.6292099
	speed: 0.1393s/iter; left time: 1927.9635s
	iters: 200, epoch: 34 | loss: 0.2247338
	speed: 0.0291s/iter; left time: 399.5489s
Epoch: 34 cost time: 6.642277002334595
Epoch: 34, Steps: 208 | Train Loss: 0.179 Vali Loss: 10.053 Vali Acc: 0.106 Test Loss: 10.053 Test Acc: 0.106
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0150785
	speed: 0.1313s/iter; left time: 1789.5167s
	iters: 200, epoch: 35 | loss: 0.1225235
	speed: 0.0308s/iter; left time: 416.9321s
Epoch: 35 cost time: 6.9850358963012695
Epoch: 35, Steps: 208 | Train Loss: 0.186 Vali Loss: 10.129 Vali Acc: 0.101 Test Loss: 10.129 Test Acc: 0.101
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.0925461
	speed: 0.1280s/iter; left time: 1717.9749s
	iters: 200, epoch: 36 | loss: 0.2745304
	speed: 0.0264s/iter; left time: 351.9959s
Epoch: 36 cost time: 5.994271755218506
Epoch: 36, Steps: 208 | Train Loss: 0.188 Vali Loss: 10.474 Vali Acc: 0.098 Test Loss: 10.474 Test Acc: 0.098
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11064718162839249
model parameter : 522207
model size : 2.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.9793949
	speed: 0.0477s/iter; left time: 986.6566s
	iters: 200, epoch: 1 | loss: 3.9374318
	speed: 0.0291s/iter; left time: 599.2597s
Epoch: 1 cost time: 7.958537578582764
Epoch: 1, Steps: 208 | Train Loss: 3.866 Vali Loss: 4.172 Vali Acc: 0.055 Test Loss: 4.172 Test Acc: 0.055
Validation loss decreased (inf --> -0.055431).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.3498392
	speed: 0.1201s/iter; left time: 2460.3947s
	iters: 200, epoch: 2 | loss: 4.7715020
	speed: 0.0297s/iter; left time: 606.0585s
Epoch: 2 cost time: 6.573758363723755
Epoch: 2, Steps: 208 | Train Loss: 3.973 Vali Loss: 4.264 Vali Acc: 0.046 Test Loss: 4.264 Test Acc: 0.046
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.0438485
	speed: 0.1128s/iter; left time: 2287.3521s
	iters: 200, epoch: 3 | loss: 3.6133738
	speed: 0.0279s/iter; left time: 564.0292s
Epoch: 3 cost time: 6.119292736053467
Epoch: 3, Steps: 208 | Train Loss: 3.795 Vali Loss: 3.980 Vali Acc: 0.066 Test Loss: 3.980 Test Acc: 0.066
Validation loss decreased (-0.055431 --> -0.065871).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.8960142
	speed: 0.1256s/iter; left time: 2520.8124s
	iters: 200, epoch: 4 | loss: 3.2711835
	speed: 0.0303s/iter; left time: 604.8544s
Epoch: 4 cost time: 6.389335632324219
Epoch: 4, Steps: 208 | Train Loss: 3.545 Vali Loss: 3.793 Vali Acc: 0.057 Test Loss: 3.793 Test Acc: 0.057
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.8851523
	speed: 0.1226s/iter; left time: 2436.1767s
	iters: 200, epoch: 5 | loss: 3.4448442
	speed: 0.0270s/iter; left time: 533.7142s
Epoch: 5 cost time: 6.200595140457153
Epoch: 5, Steps: 208 | Train Loss: 3.266 Vali Loss: 3.702 Vali Acc: 0.069 Test Loss: 3.702 Test Acc: 0.069
Validation loss decreased (-0.065871 --> -0.068558).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.3555994
	speed: 0.1238s/iter; left time: 2434.3067s
	iters: 200, epoch: 6 | loss: 3.2886045
	speed: 0.0275s/iter; left time: 537.9045s
Epoch: 6 cost time: 6.283631324768066
Epoch: 6, Steps: 208 | Train Loss: 2.964 Vali Loss: 3.485 Vali Acc: 0.094 Test Loss: 3.485 Test Acc: 0.094
Validation loss decreased (-0.068558 --> -0.093613).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9101963
	speed: 0.1139s/iter; left time: 2215.7371s
	iters: 200, epoch: 7 | loss: 2.9366715
	speed: 0.0271s/iter; left time: 524.3121s
Epoch: 7 cost time: 6.134633541107178
Epoch: 7, Steps: 208 | Train Loss: 2.666 Vali Loss: 3.644 Vali Acc: 0.087 Test Loss: 3.644 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.1334345
	speed: 0.1178s/iter; left time: 2267.8888s
	iters: 200, epoch: 8 | loss: 2.7314110
	speed: 0.0290s/iter; left time: 555.9281s
Epoch: 8 cost time: 6.407731056213379
Epoch: 8, Steps: 208 | Train Loss: 2.355 Vali Loss: 3.707 Vali Acc: 0.098 Test Loss: 3.707 Test Acc: 0.098
Validation loss decreased (-0.093613 --> -0.097786).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.2020350
	speed: 0.1250s/iter; left time: 2380.2341s
	iters: 200, epoch: 9 | loss: 2.0389318
	speed: 0.0291s/iter; left time: 551.8774s
Epoch: 9 cost time: 6.397635459899902
Epoch: 9, Steps: 208 | Train Loss: 2.005 Vali Loss: 3.887 Vali Acc: 0.104 Test Loss: 3.887 Test Acc: 0.104
Validation loss decreased (-0.097786 --> -0.104345).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.7525760
	speed: 0.1230s/iter; left time: 2315.2759s
	iters: 200, epoch: 10 | loss: 1.4287304
	speed: 0.0269s/iter; left time: 503.3316s
Epoch: 10 cost time: 6.270545721054077
Epoch: 10, Steps: 208 | Train Loss: 1.690 Vali Loss: 4.150 Vali Acc: 0.097 Test Loss: 4.150 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.3760769
	speed: 0.1326s/iter; left time: 2468.5053s
	iters: 200, epoch: 11 | loss: 1.6820494
	speed: 0.0270s/iter; left time: 500.7082s
Epoch: 11 cost time: 6.370605945587158
Epoch: 11, Steps: 208 | Train Loss: 1.361 Vali Loss: 4.522 Vali Acc: 0.097 Test Loss: 4.522 Test Acc: 0.097
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.5120137
	speed: 0.1282s/iter; left time: 2361.1975s
	iters: 200, epoch: 12 | loss: 0.8460104
	speed: 0.0288s/iter; left time: 528.0192s
Epoch: 12 cost time: 6.512975454330444
Epoch: 12, Steps: 208 | Train Loss: 1.049 Vali Loss: 4.967 Vali Acc: 0.100 Test Loss: 4.967 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.2848629
	speed: 0.1362s/iter; left time: 2478.9678s
	iters: 200, epoch: 13 | loss: 1.3178699
	speed: 0.0301s/iter; left time: 545.6875s
Epoch: 13 cost time: 6.560929298400879
Epoch: 13, Steps: 208 | Train Loss: 0.866 Vali Loss: 5.320 Vali Acc: 0.106 Test Loss: 5.320 Test Acc: 0.106
Validation loss decreased (-0.104345 --> -0.105822).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.5629411
	speed: 0.1190s/iter; left time: 2140.8736s
	iters: 200, epoch: 14 | loss: 0.4881242
	speed: 0.0296s/iter; left time: 529.1728s
Epoch: 14 cost time: 6.3555967807769775
Epoch: 14, Steps: 208 | Train Loss: 0.684 Vali Loss: 5.643 Vali Acc: 0.104 Test Loss: 5.643 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.1945814
	speed: 0.1208s/iter; left time: 2148.6889s
	iters: 200, epoch: 15 | loss: 0.4282480
	speed: 0.0279s/iter; left time: 493.1416s
Epoch: 15 cost time: 6.319591522216797
Epoch: 15, Steps: 208 | Train Loss: 0.582 Vali Loss: 6.251 Vali Acc: 0.099 Test Loss: 6.251 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.4150753
	speed: 0.1236s/iter; left time: 2173.5441s
	iters: 200, epoch: 16 | loss: 0.5839750
	speed: 0.0254s/iter; left time: 444.2904s
Epoch: 16 cost time: 5.832625865936279
Epoch: 16, Steps: 208 | Train Loss: 0.500 Vali Loss: 6.485 Vali Acc: 0.102 Test Loss: 6.485 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.7044976
	speed: 0.1068s/iter; left time: 1855.9211s
	iters: 200, epoch: 17 | loss: 0.6628429
	speed: 0.0273s/iter; left time: 471.2304s
Epoch: 17 cost time: 6.0562732219696045
Epoch: 17, Steps: 208 | Train Loss: 0.444 Vali Loss: 7.020 Vali Acc: 0.103 Test Loss: 7.020 Test Acc: 0.103
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.5986543
	speed: 0.1358s/iter; left time: 2331.0517s
	iters: 200, epoch: 18 | loss: 0.2329507
	speed: 0.0304s/iter; left time: 518.5825s
Epoch: 18 cost time: 6.977554082870483
Epoch: 18, Steps: 208 | Train Loss: 0.419 Vali Loss: 7.175 Vali Acc: 0.100 Test Loss: 7.175 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.3372682
	speed: 0.1369s/iter; left time: 2321.6571s
	iters: 200, epoch: 19 | loss: 0.5522739
	speed: 0.0350s/iter; left time: 589.7619s
Epoch: 19 cost time: 7.553485155105591
Epoch: 19, Steps: 208 | Train Loss: 0.363 Vali Loss: 7.445 Vali Acc: 0.106 Test Loss: 7.445 Test Acc: 0.106
Validation loss decreased (-0.105822 --> -0.106397).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.3552333
	speed: 0.1421s/iter; left time: 2380.5946s
	iters: 200, epoch: 20 | loss: 0.5097453
	speed: 0.0336s/iter; left time: 560.1772s
Epoch: 20 cost time: 7.208232879638672
Epoch: 20, Steps: 208 | Train Loss: 0.339 Vali Loss: 7.293 Vali Acc: 0.109 Test Loss: 7.293 Test Acc: 0.109
Validation loss decreased (-0.106397 --> -0.108785).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.4088298
	speed: 0.1332s/iter; left time: 2202.5787s
	iters: 200, epoch: 21 | loss: 0.5983267
	speed: 0.0317s/iter; left time: 521.6367s
Epoch: 21 cost time: 7.2058680057525635
Epoch: 21, Steps: 208 | Train Loss: 0.310 Vali Loss: 7.668 Vali Acc: 0.109 Test Loss: 7.668 Test Acc: 0.109
Validation loss decreased (-0.108785 --> -0.109079).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.1454533
	speed: 0.1484s/iter; left time: 2423.3319s
	iters: 200, epoch: 22 | loss: 0.4663692
	speed: 0.0319s/iter; left time: 518.1214s
Epoch: 22 cost time: 7.014983892440796
Epoch: 22, Steps: 208 | Train Loss: 0.292 Vali Loss: 7.943 Vali Acc: 0.113 Test Loss: 7.943 Test Acc: 0.113
Validation loss decreased (-0.109079 --> -0.112655).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.3979482
	speed: 0.1413s/iter; left time: 2278.4149s
	iters: 200, epoch: 23 | loss: 0.3681312
	speed: 0.0336s/iter; left time: 538.7386s
Epoch: 23 cost time: 7.283518552780151
Epoch: 23, Steps: 208 | Train Loss: 0.271 Vali Loss: 8.609 Vali Acc: 0.107 Test Loss: 8.609 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.1096351
	speed: 0.1407s/iter; left time: 2240.0810s
	iters: 200, epoch: 24 | loss: 0.0849704
	speed: 0.0317s/iter; left time: 501.6364s
Epoch: 24 cost time: 7.014965534210205
Epoch: 24, Steps: 208 | Train Loss: 0.244 Vali Loss: 8.400 Vali Acc: 0.107 Test Loss: 8.400 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.2724764
	speed: 0.1212s/iter; left time: 1903.5465s
	iters: 200, epoch: 25 | loss: 0.0200026
	speed: 0.0262s/iter; left time: 408.5215s
Epoch: 25 cost time: 6.060067176818848
Epoch: 25, Steps: 208 | Train Loss: 0.247 Vali Loss: 8.810 Vali Acc: 0.105 Test Loss: 8.810 Test Acc: 0.105
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.2533630
	speed: 0.1201s/iter; left time: 1861.3377s
	iters: 200, epoch: 26 | loss: 0.0465877
	speed: 0.0286s/iter; left time: 440.8318s
Epoch: 26 cost time: 6.377409219741821
Epoch: 26, Steps: 208 | Train Loss: 0.246 Vali Loss: 8.802 Vali Acc: 0.102 Test Loss: 8.802 Test Acc: 0.102
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.2104104
	speed: 0.1196s/iter; left time: 1828.3148s
	iters: 200, epoch: 27 | loss: 0.3027857
	speed: 0.0266s/iter; left time: 404.4136s
Epoch: 27 cost time: 6.104632377624512
Epoch: 27, Steps: 208 | Train Loss: 0.231 Vali Loss: 8.925 Vali Acc: 0.099 Test Loss: 8.925 Test Acc: 0.099
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.1071167
	speed: 0.1295s/iter; left time: 1954.2267s
	iters: 200, epoch: 28 | loss: 0.2102304
	speed: 0.0288s/iter; left time: 431.0846s
Epoch: 28 cost time: 6.374208688735962
Epoch: 28, Steps: 208 | Train Loss: 0.240 Vali Loss: 8.850 Vali Acc: 0.106 Test Loss: 8.850 Test Acc: 0.106
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.1633631
	speed: 0.1163s/iter; left time: 1730.8644s
	iters: 200, epoch: 29 | loss: 0.4496461
	speed: 0.0270s/iter; left time: 398.8379s
Epoch: 29 cost time: 6.089281797409058
Epoch: 29, Steps: 208 | Train Loss: 0.208 Vali Loss: 9.502 Vali Acc: 0.105 Test Loss: 9.502 Test Acc: 0.105
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.2181771
	speed: 0.1111s/iter; left time: 1629.4866s
	iters: 200, epoch: 30 | loss: 0.3263453
	speed: 0.0221s/iter; left time: 322.5397s
Epoch: 30 cost time: 5.275680780410767
Epoch: 30, Steps: 208 | Train Loss: 0.213 Vali Loss: 9.572 Vali Acc: 0.105 Test Loss: 9.572 Test Acc: 0.105
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0990730
	speed: 0.0915s/iter; left time: 1323.3799s
	iters: 200, epoch: 31 | loss: 0.4514404
	speed: 0.0235s/iter; left time: 337.9216s
Epoch: 31 cost time: 5.2161781787872314
Epoch: 31, Steps: 208 | Train Loss: 0.205 Vali Loss: 9.325 Vali Acc: 0.104 Test Loss: 9.325 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.1752008
	speed: 0.1278s/iter; left time: 1821.9026s
	iters: 200, epoch: 32 | loss: 0.0434294
	speed: 0.0290s/iter; left time: 410.6486s
Epoch: 32 cost time: 6.511209011077881
Epoch: 32, Steps: 208 | Train Loss: 0.203 Vali Loss: 10.021 Vali Acc: 0.101 Test Loss: 10.021 Test Acc: 0.101
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.1127348643006263
model parameter : 521599
model size : 2.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1707048
	speed: 0.0433s/iter; left time: 896.4340s
	iters: 200, epoch: 1 | loss: 3.9398527
	speed: 0.0268s/iter; left time: 552.5065s
Epoch: 1 cost time: 7.30828332901001
Epoch: 1, Steps: 208 | Train Loss: 3.881 Vali Loss: 3.982 Vali Acc: 0.048 Test Loss: 3.982 Test Acc: 0.048
Validation loss decreased (inf --> -0.047977).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.8675182
	speed: 0.1189s/iter; left time: 2437.6117s
	iters: 200, epoch: 2 | loss: 3.9887981
	speed: 0.0286s/iter; left time: 583.3165s
Epoch: 2 cost time: 6.377803564071655
Epoch: 2, Steps: 208 | Train Loss: 3.861 Vali Loss: 4.311 Vali Acc: 0.054 Test Loss: 4.311 Test Acc: 0.054
Validation loss decreased (-0.047977 --> -0.053640).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.8664103
	speed: 0.1262s/iter; left time: 2560.8136s
	iters: 200, epoch: 3 | loss: 3.2245145
	speed: 0.0277s/iter; left time: 559.2653s
Epoch: 3 cost time: 6.300856590270996
Epoch: 3, Steps: 208 | Train Loss: 3.720 Vali Loss: 3.746 Vali Acc: 0.041 Test Loss: 3.746 Test Acc: 0.041
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.6602545
	speed: 0.1263s/iter; left time: 2536.4300s
	iters: 200, epoch: 4 | loss: 3.5910814
	speed: 0.0282s/iter; left time: 563.4832s
Epoch: 4 cost time: 6.465924263000488
Epoch: 4, Steps: 208 | Train Loss: 3.533 Vali Loss: 3.781 Vali Acc: 0.064 Test Loss: 3.781 Test Acc: 0.064
Validation loss decreased (-0.053640 --> -0.064382).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.9593906
	speed: 0.1324s/iter; left time: 2630.1895s
	iters: 200, epoch: 5 | loss: 3.5403559
	speed: 0.0271s/iter; left time: 535.7271s
Epoch: 5 cost time: 6.371091604232788
Epoch: 5, Steps: 208 | Train Loss: 3.288 Vali Loss: 3.527 Vali Acc: 0.074 Test Loss: 3.527 Test Acc: 0.074
Validation loss decreased (-0.064382 --> -0.073928).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0504625
	speed: 0.1295s/iter; left time: 2545.9562s
	iters: 200, epoch: 6 | loss: 2.9488385
	speed: 0.0296s/iter; left time: 578.6611s
Epoch: 6 cost time: 6.5597288608551025
Epoch: 6, Steps: 208 | Train Loss: 3.030 Vali Loss: 3.447 Vali Acc: 0.089 Test Loss: 3.447 Test Acc: 0.089
Validation loss decreased (-0.073928 --> -0.089438).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.7895210
	speed: 0.1206s/iter; left time: 2346.4172s
	iters: 200, epoch: 7 | loss: 2.6502342
	speed: 0.0281s/iter; left time: 543.2829s
Epoch: 7 cost time: 5.812088489532471
Epoch: 7, Steps: 208 | Train Loss: 2.799 Vali Loss: 3.493 Vali Acc: 0.088 Test Loss: 3.493 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.7960548
	speed: 0.1294s/iter; left time: 2490.8253s
	iters: 200, epoch: 8 | loss: 2.7253392
	speed: 0.0280s/iter; left time: 536.2512s
Epoch: 8 cost time: 6.426948547363281
Epoch: 8, Steps: 208 | Train Loss: 2.522 Vali Loss: 3.556 Vali Acc: 0.096 Test Loss: 3.556 Test Acc: 0.096
Validation loss decreased (-0.089438 --> -0.096296).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.0235031
	speed: 0.1403s/iter; left time: 2669.9956s
	iters: 200, epoch: 9 | loss: 2.4463384
	speed: 0.0316s/iter; left time: 598.1900s
Epoch: 9 cost time: 7.194305896759033
Epoch: 9, Steps: 208 | Train Loss: 2.267 Vali Loss: 3.708 Vali Acc: 0.092 Test Loss: 3.708 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.8004845
	speed: 0.1381s/iter; left time: 2600.9234s
	iters: 200, epoch: 10 | loss: 1.9244584
	speed: 0.0298s/iter; left time: 558.8360s
Epoch: 10 cost time: 6.823737859725952
Epoch: 10, Steps: 208 | Train Loss: 2.004 Vali Loss: 3.866 Vali Acc: 0.103 Test Loss: 3.866 Test Acc: 0.103
Validation loss decreased (-0.096296 --> -0.103153).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.8648899
	speed: 0.1491s/iter; left time: 2776.6806s
	iters: 200, epoch: 11 | loss: 1.9765630
	speed: 0.0329s/iter; left time: 610.0775s
Epoch: 11 cost time: 7.338962078094482
Epoch: 11, Steps: 208 | Train Loss: 1.716 Vali Loss: 4.185 Vali Acc: 0.102 Test Loss: 4.185 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.7728847
	speed: 0.1392s/iter; left time: 2563.5683s
	iters: 200, epoch: 12 | loss: 1.1422831
	speed: 0.0321s/iter; left time: 588.0981s
Epoch: 12 cost time: 6.868194341659546
Epoch: 12, Steps: 208 | Train Loss: 1.469 Vali Loss: 4.456 Vali Acc: 0.111 Test Loss: 4.456 Test Acc: 0.111
Validation loss decreased (-0.103153 --> -0.110603).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.4105132
	speed: 0.1521s/iter; left time: 2769.0376s
	iters: 200, epoch: 13 | loss: 1.9113802
	speed: 0.0309s/iter; left time: 560.3299s
Epoch: 13 cost time: 7.106130123138428
Epoch: 13, Steps: 208 | Train Loss: 1.240 Vali Loss: 4.690 Vali Acc: 0.109 Test Loss: 4.690 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.9604398
	speed: 0.1429s/iter; left time: 2572.0640s
	iters: 200, epoch: 14 | loss: 0.9324504
	speed: 0.0312s/iter; left time: 558.2260s
Epoch: 14 cost time: 6.89115047454834
Epoch: 14, Steps: 208 | Train Loss: 1.048 Vali Loss: 4.988 Vali Acc: 0.105 Test Loss: 4.988 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.4968264
	speed: 0.1435s/iter; left time: 2551.8342s
	iters: 200, epoch: 15 | loss: 1.0879493
	speed: 0.0312s/iter; left time: 551.7224s
Epoch: 15 cost time: 7.099021673202515
Epoch: 15, Steps: 208 | Train Loss: 0.892 Vali Loss: 5.309 Vali Acc: 0.113 Test Loss: 5.309 Test Acc: 0.113
Validation loss decreased (-0.110603 --> -0.112980).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.4719966
	speed: 0.1525s/iter; left time: 2681.2264s
	iters: 200, epoch: 16 | loss: 1.1499689
	speed: 0.0293s/iter; left time: 512.6564s
Epoch: 16 cost time: 6.809205532073975
Epoch: 16, Steps: 208 | Train Loss: 0.774 Vali Loss: 5.468 Vali Acc: 0.112 Test Loss: 5.468 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.3129319
	speed: 0.1304s/iter; left time: 2265.9146s
	iters: 200, epoch: 17 | loss: 0.4391466
	speed: 0.0265s/iter; left time: 457.6664s
Epoch: 17 cost time: 6.349859952926636
Epoch: 17, Steps: 208 | Train Loss: 0.666 Vali Loss: 5.806 Vali Acc: 0.106 Test Loss: 5.806 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.5742440
	speed: 0.1291s/iter; left time: 2216.4813s
	iters: 200, epoch: 18 | loss: 0.5645863
	speed: 0.0257s/iter; left time: 438.2388s
Epoch: 18 cost time: 5.950328350067139
Epoch: 18, Steps: 208 | Train Loss: 0.589 Vali Loss: 6.140 Vali Acc: 0.109 Test Loss: 6.140 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.4028908
	speed: 0.1138s/iter; left time: 1930.4310s
	iters: 200, epoch: 19 | loss: 1.0679126
	speed: 0.0286s/iter; left time: 482.6923s
Epoch: 19 cost time: 6.355832815170288
Epoch: 19, Steps: 208 | Train Loss: 0.549 Vali Loss: 6.395 Vali Acc: 0.109 Test Loss: 6.395 Test Acc: 0.109
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0854001
	speed: 0.1268s/iter; left time: 2123.8657s
	iters: 200, epoch: 20 | loss: 0.9462172
	speed: 0.0283s/iter; left time: 470.5872s
Epoch: 20 cost time: 6.219857692718506
Epoch: 20, Steps: 208 | Train Loss: 0.459 Vali Loss: 6.909 Vali Acc: 0.106 Test Loss: 6.909 Test Acc: 0.106
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.5786175
	speed: 0.1187s/iter; left time: 1963.1381s
	iters: 200, epoch: 21 | loss: 0.5829274
	speed: 0.0288s/iter; left time: 474.2159s
Epoch: 21 cost time: 6.334615230560303
Epoch: 21, Steps: 208 | Train Loss: 0.427 Vali Loss: 6.999 Vali Acc: 0.117 Test Loss: 6.999 Test Acc: 0.117
Validation loss decreased (-0.112980 --> -0.116840).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.1782535
	speed: 0.1265s/iter; left time: 2066.6725s
	iters: 200, epoch: 22 | loss: 0.8491285
	speed: 0.0280s/iter; left time: 455.2850s
Epoch: 22 cost time: 6.4858481884002686
Epoch: 22, Steps: 208 | Train Loss: 0.403 Vali Loss: 7.377 Vali Acc: 0.106 Test Loss: 7.377 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.2335462
	speed: 0.1241s/iter; left time: 2001.0371s
	iters: 200, epoch: 23 | loss: 0.3999215
	speed: 0.0280s/iter; left time: 448.9347s
Epoch: 23 cost time: 6.349313735961914
Epoch: 23, Steps: 208 | Train Loss: 0.361 Vali Loss: 7.307 Vali Acc: 0.107 Test Loss: 7.307 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.4922725
	speed: 0.1212s/iter; left time: 1928.7149s
	iters: 200, epoch: 24 | loss: 0.5470550
	speed: 0.0280s/iter; left time: 443.3566s
Epoch: 24 cost time: 5.983438491821289
Epoch: 24, Steps: 208 | Train Loss: 0.352 Vali Loss: 7.363 Vali Acc: 0.114 Test Loss: 7.363 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0660286
	speed: 0.1244s/iter; left time: 1954.9222s
	iters: 200, epoch: 25 | loss: 0.3224744
	speed: 0.0275s/iter; left time: 428.9691s
Epoch: 25 cost time: 6.146174192428589
Epoch: 25, Steps: 208 | Train Loss: 0.326 Vali Loss: 7.758 Vali Acc: 0.110 Test Loss: 7.758 Test Acc: 0.110
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.1616717
	speed: 0.1178s/iter; left time: 1826.0542s
	iters: 200, epoch: 26 | loss: 0.2790658
	speed: 0.0244s/iter; left time: 375.0908s
Epoch: 26 cost time: 5.9580078125
Epoch: 26, Steps: 208 | Train Loss: 0.322 Vali Loss: 7.967 Vali Acc: 0.113 Test Loss: 7.967 Test Acc: 0.113
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.2238564
	speed: 0.1277s/iter; left time: 1952.2723s
	iters: 200, epoch: 27 | loss: 0.3779204
	speed: 0.0270s/iter; left time: 410.8240s
Epoch: 27 cost time: 6.113445520401001
Epoch: 27, Steps: 208 | Train Loss: 0.311 Vali Loss: 8.207 Vali Acc: 0.109 Test Loss: 8.207 Test Acc: 0.109
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.4711161
	speed: 0.1155s/iter; left time: 1742.1687s
	iters: 200, epoch: 28 | loss: 0.2920950
	speed: 0.0297s/iter; left time: 444.9961s
Epoch: 28 cost time: 6.28391695022583
Epoch: 28, Steps: 208 | Train Loss: 0.289 Vali Loss: 8.397 Vali Acc: 0.112 Test Loss: 8.397 Test Acc: 0.112
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.2065443
	speed: 0.1165s/iter; left time: 1732.9200s
	iters: 200, epoch: 29 | loss: 0.1384615
	speed: 0.0286s/iter; left time: 422.5183s
Epoch: 29 cost time: 6.21501350402832
Epoch: 29, Steps: 208 | Train Loss: 0.295 Vali Loss: 8.155 Vali Acc: 0.111 Test Loss: 8.155 Test Acc: 0.111
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0236791
	speed: 0.1174s/iter; left time: 1721.5281s
	iters: 200, epoch: 30 | loss: 0.5063124
	speed: 0.0278s/iter; left time: 404.4892s
Epoch: 30 cost time: 6.305294513702393
Epoch: 30, Steps: 208 | Train Loss: 0.255 Vali Loss: 8.432 Vali Acc: 0.104 Test Loss: 8.432 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.7510399
	speed: 0.1260s/iter; left time: 1822.4052s
	iters: 200, epoch: 31 | loss: 0.2626927
	speed: 0.0259s/iter; left time: 371.6275s
Epoch: 31 cost time: 6.209167003631592
Epoch: 31, Steps: 208 | Train Loss: 0.260 Vali Loss: 8.541 Vali Acc: 0.110 Test Loss: 8.541 Test Acc: 0.110
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11691022964509394
model parameter : 520991
model size : 2.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8985991
	speed: 0.0412s/iter; left time: 851.8605s
	iters: 200, epoch: 1 | loss: 3.5285466
	speed: 0.0292s/iter; left time: 601.3768s
Epoch: 1 cost time: 7.342192649841309
Epoch: 1, Steps: 208 | Train Loss: 3.862 Vali Loss: 3.955 Vali Acc: 0.054 Test Loss: 3.955 Test Acc: 0.054
Validation loss decreased (inf --> -0.053644).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5681877
	speed: 0.1233s/iter; left time: 2526.7098s
	iters: 200, epoch: 2 | loss: 4.0335860
	speed: 0.0276s/iter; left time: 563.1725s
Epoch: 2 cost time: 6.178747653961182
Epoch: 2, Steps: 208 | Train Loss: 3.916 Vali Loss: 4.036 Vali Acc: 0.044 Test Loss: 4.036 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.8149559
	speed: 0.1130s/iter; left time: 2291.5862s
	iters: 200, epoch: 3 | loss: 3.8668365
	speed: 0.0290s/iter; left time: 585.6835s
Epoch: 3 cost time: 6.432728290557861
Epoch: 3, Steps: 208 | Train Loss: 3.767 Vali Loss: 4.039 Vali Acc: 0.048 Test Loss: 4.039 Test Acc: 0.048
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 3.3347955
	speed: 0.1274s/iter; left time: 2557.8985s
	iters: 200, epoch: 4 | loss: 3.4837334
	speed: 0.0276s/iter; left time: 551.3663s
Epoch: 4 cost time: 6.272125244140625
Epoch: 4, Steps: 208 | Train Loss: 3.525 Vali Loss: 3.750 Vali Acc: 0.063 Test Loss: 3.750 Test Acc: 0.063
Validation loss decreased (-0.053644 --> -0.062593).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.7261803
	speed: 0.1300s/iter; left time: 2583.6988s
	iters: 200, epoch: 5 | loss: 3.4463327
	speed: 0.0296s/iter; left time: 585.5232s
Epoch: 5 cost time: 6.673050403594971
Epoch: 5, Steps: 208 | Train Loss: 3.303 Vali Loss: 3.588 Vali Acc: 0.083 Test Loss: 3.588 Test Acc: 0.083
Validation loss decreased (-0.062593 --> -0.082875).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0770655
	speed: 0.1411s/iter; left time: 2773.6535s
	iters: 200, epoch: 6 | loss: 3.1382961
	speed: 0.0286s/iter; left time: 559.2760s
Epoch: 6 cost time: 6.797823190689087
Epoch: 6, Steps: 208 | Train Loss: 3.055 Vali Loss: 3.540 Vali Acc: 0.087 Test Loss: 3.540 Test Acc: 0.087
Validation loss decreased (-0.082875 --> -0.086753).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.8916271
	speed: 0.1451s/iter; left time: 2822.6939s
	iters: 200, epoch: 7 | loss: 2.7759461
	speed: 0.0332s/iter; left time: 641.8254s
Epoch: 7 cost time: 7.179885149002075
Epoch: 7, Steps: 208 | Train Loss: 2.783 Vali Loss: 3.462 Vali Acc: 0.096 Test Loss: 3.462 Test Acc: 0.096
Validation loss decreased (-0.086753 --> -0.095999).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.3857358
	speed: 0.1412s/iter; left time: 2716.4880s
	iters: 200, epoch: 8 | loss: 2.8754895
	speed: 0.0331s/iter; left time: 634.3195s
Epoch: 8 cost time: 7.2179787158966064
Epoch: 8, Steps: 208 | Train Loss: 2.542 Vali Loss: 3.553 Vali Acc: 0.095 Test Loss: 3.553 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.3818538
	speed: 0.1449s/iter; left time: 2758.5120s
	iters: 200, epoch: 9 | loss: 2.4374051
	speed: 0.0311s/iter; left time: 588.9960s
Epoch: 9 cost time: 6.91974401473999
Epoch: 9, Steps: 208 | Train Loss: 2.265 Vali Loss: 3.661 Vali Acc: 0.101 Test Loss: 3.661 Test Acc: 0.101
Validation loss decreased (-0.095999 --> -0.100470).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.0488322
	speed: 0.1444s/iter; left time: 2718.5568s
	iters: 200, epoch: 10 | loss: 2.3680115
	speed: 0.0315s/iter; left time: 590.0594s
Epoch: 10 cost time: 7.0580620765686035
Epoch: 10, Steps: 208 | Train Loss: 2.012 Vali Loss: 3.790 Vali Acc: 0.103 Test Loss: 3.790 Test Acc: 0.103
Validation loss decreased (-0.100470 --> -0.102855).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7885852
	speed: 0.1434s/iter; left time: 2670.5873s
	iters: 200, epoch: 11 | loss: 1.9060754
	speed: 0.0298s/iter; left time: 552.5360s
Epoch: 11 cost time: 6.910055160522461
Epoch: 11, Steps: 208 | Train Loss: 1.742 Vali Loss: 4.026 Vali Acc: 0.108 Test Loss: 4.026 Test Acc: 0.108
Validation loss decreased (-0.102855 --> -0.108221).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.5969861
	speed: 0.1277s/iter; left time: 2350.9661s
	iters: 200, epoch: 12 | loss: 1.3211470
	speed: 0.0286s/iter; left time: 523.7296s
Epoch: 12 cost time: 6.33274507522583
Epoch: 12, Steps: 208 | Train Loss: 1.464 Vali Loss: 4.442 Vali Acc: 0.109 Test Loss: 4.442 Test Acc: 0.109
Validation loss decreased (-0.108221 --> -0.109410).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.3529785
	speed: 0.1226s/iter; left time: 2231.8128s
	iters: 200, epoch: 13 | loss: 1.4059255
	speed: 0.0292s/iter; left time: 528.8427s
Epoch: 13 cost time: 6.401972532272339
Epoch: 13, Steps: 208 | Train Loss: 1.219 Vali Loss: 4.689 Vali Acc: 0.102 Test Loss: 4.689 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.4861574
	speed: 0.1276s/iter; left time: 2296.9859s
	iters: 200, epoch: 14 | loss: 1.4566600
	speed: 0.0292s/iter; left time: 522.6281s
Epoch: 14 cost time: 6.3044538497924805
Epoch: 14, Steps: 208 | Train Loss: 1.035 Vali Loss: 4.867 Vali Acc: 0.104 Test Loss: 4.867 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.7236212
	speed: 0.1104s/iter; left time: 1963.7937s
	iters: 200, epoch: 15 | loss: 0.8127434
	speed: 0.0287s/iter; left time: 507.4432s
Epoch: 15 cost time: 6.332305431365967
Epoch: 15, Steps: 208 | Train Loss: 0.889 Vali Loss: 5.289 Vali Acc: 0.117 Test Loss: 5.289 Test Acc: 0.117
Validation loss decreased (-0.109410 --> -0.116857).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.5561271
	speed: 0.1288s/iter; left time: 2264.3707s
	iters: 200, epoch: 16 | loss: 0.7253232
	speed: 0.0272s/iter; left time: 476.2647s
Epoch: 16 cost time: 6.332119941711426
Epoch: 16, Steps: 208 | Train Loss: 0.756 Vali Loss: 5.692 Vali Acc: 0.113 Test Loss: 5.692 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.1842211
	speed: 0.1124s/iter; left time: 1952.7660s
	iters: 200, epoch: 17 | loss: 0.7054067
	speed: 0.0215s/iter; left time: 371.8176s
Epoch: 17 cost time: 5.129927396774292
Epoch: 17, Steps: 208 | Train Loss: 0.657 Vali Loss: 5.933 Vali Acc: 0.110 Test Loss: 5.933 Test Acc: 0.110
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.4237109
	speed: 0.0974s/iter; left time: 1671.2342s
	iters: 200, epoch: 18 | loss: 0.8015309
	speed: 0.0217s/iter; left time: 370.1190s
Epoch: 18 cost time: 4.959660291671753
Epoch: 18, Steps: 208 | Train Loss: 0.574 Vali Loss: 6.256 Vali Acc: 0.109 Test Loss: 6.256 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.8335461
	speed: 0.1011s/iter; left time: 1714.3456s
	iters: 200, epoch: 19 | loss: 0.3049058
	speed: 0.0270s/iter; left time: 455.9357s
Epoch: 19 cost time: 6.2931976318359375
Epoch: 19, Steps: 208 | Train Loss: 0.500 Vali Loss: 6.797 Vali Acc: 0.116 Test Loss: 6.797 Test Acc: 0.116
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.3840967
	speed: 0.1167s/iter; left time: 1953.8367s
	iters: 200, epoch: 20 | loss: 0.5490125
	speed: 0.0241s/iter; left time: 401.2477s
Epoch: 20 cost time: 5.700810432434082
Epoch: 20, Steps: 208 | Train Loss: 0.465 Vali Loss: 6.625 Vali Acc: 0.112 Test Loss: 6.625 Test Acc: 0.112
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.4167392
	speed: 0.1037s/iter; left time: 1714.7341s
	iters: 200, epoch: 21 | loss: 0.2007712
	speed: 0.0262s/iter; left time: 430.1301s
Epoch: 21 cost time: 5.800064563751221
Epoch: 21, Steps: 208 | Train Loss: 0.439 Vali Loss: 7.291 Vali Acc: 0.115 Test Loss: 7.291 Test Acc: 0.115
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.2804234
	speed: 0.1203s/iter; left time: 1964.5528s
	iters: 200, epoch: 22 | loss: 0.1486009
	speed: 0.0280s/iter; left time: 454.3686s
Epoch: 22 cost time: 6.314156770706177
Epoch: 22, Steps: 208 | Train Loss: 0.402 Vali Loss: 7.199 Vali Acc: 0.108 Test Loss: 7.199 Test Acc: 0.108
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.4124813
	speed: 0.1210s/iter; left time: 1950.9958s
	iters: 200, epoch: 23 | loss: 0.5456758
	speed: 0.0281s/iter; left time: 450.7997s
Epoch: 23 cost time: 6.259727954864502
Epoch: 23, Steps: 208 | Train Loss: 0.363 Vali Loss: 7.291 Vali Acc: 0.112 Test Loss: 7.291 Test Acc: 0.112
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.1537746
	speed: 0.1165s/iter; left time: 1853.8861s
	iters: 200, epoch: 24 | loss: 0.3777584
	speed: 0.0237s/iter; left time: 374.5899s
Epoch: 24 cost time: 5.811624050140381
Epoch: 24, Steps: 208 | Train Loss: 0.338 Vali Loss: 7.965 Vali Acc: 0.109 Test Loss: 7.965 Test Acc: 0.109
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.6723822
	speed: 0.1190s/iter; left time: 1869.4526s
	iters: 200, epoch: 25 | loss: 0.1562491
	speed: 0.0282s/iter; left time: 440.3356s
Epoch: 25 cost time: 6.323850393295288
Epoch: 25, Steps: 208 | Train Loss: 0.329 Vali Loss: 7.905 Vali Acc: 0.105 Test Loss: 7.905 Test Acc: 0.105
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11691022964509394
model parameter : 422975
model size : 2.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7606912
	speed: 0.0416s/iter; left time: 861.6672s
	iters: 200, epoch: 1 | loss: 4.2181907
	speed: 0.0266s/iter; left time: 548.9635s
Epoch: 1 cost time: 7.027574300765991
Epoch: 1, Steps: 208 | Train Loss: 3.866 Vali Loss: 4.298 Vali Acc: 0.041 Test Loss: 4.298 Test Acc: 0.041
Validation loss decreased (inf --> -0.040816).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.3953505
	speed: 0.1156s/iter; left time: 2369.3802s
	iters: 200, epoch: 2 | loss: 4.4211764
	speed: 0.0320s/iter; left time: 652.2683s
Epoch: 2 cost time: 6.967047452926636
Epoch: 2, Steps: 208 | Train Loss: 3.985 Vali Loss: 4.108 Vali Acc: 0.051 Test Loss: 4.108 Test Acc: 0.051
Validation loss decreased (-0.040816 --> -0.050958).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.9809077
	speed: 0.1352s/iter; left time: 2743.4612s
	iters: 200, epoch: 3 | loss: 3.3621502
	speed: 0.0287s/iter; left time: 580.2914s
Epoch: 3 cost time: 6.7979559898376465
Epoch: 3, Steps: 208 | Train Loss: 3.863 Vali Loss: 4.159 Vali Acc: 0.053 Test Loss: 4.159 Test Acc: 0.053
Validation loss decreased (-0.050958 --> -0.053343).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.7363012
	speed: 0.1402s/iter; left time: 2815.5447s
	iters: 200, epoch: 4 | loss: 2.8148303
	speed: 0.0321s/iter; left time: 640.7107s
Epoch: 4 cost time: 7.166548252105713
Epoch: 4, Steps: 208 | Train Loss: 3.565 Vali Loss: 3.766 Vali Acc: 0.067 Test Loss: 3.766 Test Acc: 0.067
Validation loss decreased (-0.053343 --> -0.066470).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.3719225
	speed: 0.1346s/iter; left time: 2674.3096s
	iters: 200, epoch: 5 | loss: 3.2419868
	speed: 0.0270s/iter; left time: 534.1085s
Epoch: 5 cost time: 6.370518445968628
Epoch: 5, Steps: 208 | Train Loss: 3.315 Vali Loss: 3.723 Vali Acc: 0.068 Test Loss: 3.723 Test Acc: 0.068
Validation loss decreased (-0.066470 --> -0.067663).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.1065152
	speed: 0.1364s/iter; left time: 2682.5657s
	iters: 200, epoch: 6 | loss: 2.9723592
	speed: 0.0311s/iter; left time: 608.6052s
Epoch: 6 cost time: 6.960090637207031
Epoch: 6, Steps: 208 | Train Loss: 3.032 Vali Loss: 3.654 Vali Acc: 0.081 Test Loss: 3.654 Test Acc: 0.081
Validation loss decreased (-0.067663 --> -0.081085).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9751799
	speed: 0.1262s/iter; left time: 2454.9489s
	iters: 200, epoch: 7 | loss: 2.7256474
	speed: 0.0309s/iter; left time: 598.2580s
Epoch: 7 cost time: 6.705303907394409
Epoch: 7, Steps: 208 | Train Loss: 2.755 Vali Loss: 3.560 Vali Acc: 0.083 Test Loss: 3.560 Test Acc: 0.083
Validation loss decreased (-0.081085 --> -0.082577).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8070325
	speed: 0.1340s/iter; left time: 2579.2832s
	iters: 200, epoch: 8 | loss: 3.0558045
	speed: 0.0271s/iter; left time: 519.2773s
Epoch: 8 cost time: 6.197693347930908
Epoch: 8, Steps: 208 | Train Loss: 2.483 Vali Loss: 3.693 Vali Acc: 0.096 Test Loss: 3.693 Test Acc: 0.096
Validation loss decreased (-0.082577 --> -0.096295).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.4014347
	speed: 0.1119s/iter; left time: 2129.4197s
	iters: 200, epoch: 9 | loss: 2.5998008
	speed: 0.0285s/iter; left time: 539.4051s
Epoch: 9 cost time: 6.2671637535095215
Epoch: 9, Steps: 208 | Train Loss: 2.176 Vali Loss: 3.817 Vali Acc: 0.100 Test Loss: 3.817 Test Acc: 0.100
Validation loss decreased (-0.096295 --> -0.099872).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.2532250
	speed: 0.1192s/iter; left time: 2245.3516s
	iters: 200, epoch: 10 | loss: 2.1700437
	speed: 0.0301s/iter; left time: 563.1991s
Epoch: 10 cost time: 6.284435510635376
Epoch: 10, Steps: 208 | Train Loss: 1.852 Vali Loss: 4.019 Vali Acc: 0.094 Test Loss: 4.019 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.5194553
	speed: 0.1211s/iter; left time: 2254.5874s
	iters: 200, epoch: 11 | loss: 1.6649766
	speed: 0.0278s/iter; left time: 515.2681s
Epoch: 11 cost time: 6.31717586517334
Epoch: 11, Steps: 208 | Train Loss: 1.545 Vali Loss: 4.286 Vali Acc: 0.102 Test Loss: 4.286 Test Acc: 0.102
Validation loss decreased (-0.099872 --> -0.101657).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.6874182
	speed: 0.1194s/iter; left time: 2199.1510s
	iters: 200, epoch: 12 | loss: 1.8420465
	speed: 0.0271s/iter; left time: 496.6422s
Epoch: 12 cost time: 6.213790655136108
Epoch: 12, Steps: 208 | Train Loss: 1.252 Vali Loss: 4.669 Vali Acc: 0.101 Test Loss: 4.669 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.5953878
	speed: 0.1270s/iter; left time: 2311.1468s
	iters: 200, epoch: 13 | loss: 0.8680258
	speed: 0.0284s/iter; left time: 514.6943s
Epoch: 13 cost time: 6.287053108215332
Epoch: 13, Steps: 208 | Train Loss: 1.009 Vali Loss: 5.003 Vali Acc: 0.102 Test Loss: 5.003 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.9660914
	speed: 0.1114s/iter; left time: 2004.6856s
	iters: 200, epoch: 14 | loss: 1.0149188
	speed: 0.0297s/iter; left time: 530.9298s
Epoch: 14 cost time: 6.194982290267944
Epoch: 14, Steps: 208 | Train Loss: 0.803 Vali Loss: 5.454 Vali Acc: 0.103 Test Loss: 5.454 Test Acc: 0.103
Validation loss decreased (-0.101657 --> -0.103435).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.3198901
	speed: 0.1254s/iter; left time: 2230.8977s
	iters: 200, epoch: 15 | loss: 0.8543234
	speed: 0.0283s/iter; left time: 500.4518s
Epoch: 15 cost time: 6.476146221160889
Epoch: 15, Steps: 208 | Train Loss: 0.650 Vali Loss: 5.650 Vali Acc: 0.099 Test Loss: 5.650 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.2205382
	speed: 0.1127s/iter; left time: 1981.7056s
	iters: 200, epoch: 16 | loss: 1.0622923
	speed: 0.0257s/iter; left time: 448.7642s
Epoch: 16 cost time: 6.011467218399048
Epoch: 16, Steps: 208 | Train Loss: 0.547 Vali Loss: 6.194 Vali Acc: 0.087 Test Loss: 6.194 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.7752639
	speed: 0.1270s/iter; left time: 2205.6103s
	iters: 200, epoch: 17 | loss: 0.3365479
	speed: 0.0299s/iter; left time: 517.0047s
Epoch: 17 cost time: 6.539659261703491
Epoch: 17, Steps: 208 | Train Loss: 0.483 Vali Loss: 6.524 Vali Acc: 0.097 Test Loss: 6.524 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.6729890
	speed: 0.1210s/iter; left time: 2077.3307s
	iters: 200, epoch: 18 | loss: 0.4846357
	speed: 0.0282s/iter; left time: 481.5618s
Epoch: 18 cost time: 6.270014047622681
Epoch: 18, Steps: 208 | Train Loss: 0.437 Vali Loss: 6.778 Vali Acc: 0.100 Test Loss: 6.778 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.7164107
	speed: 0.1184s/iter; left time: 2008.1867s
	iters: 200, epoch: 19 | loss: 0.3391380
	speed: 0.0283s/iter; left time: 477.2438s
Epoch: 19 cost time: 6.227862119674683
Epoch: 19, Steps: 208 | Train Loss: 0.392 Vali Loss: 7.036 Vali Acc: 0.102 Test Loss: 7.036 Test Acc: 0.102
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0591880
	speed: 0.1136s/iter; left time: 1901.8492s
	iters: 200, epoch: 20 | loss: 1.0134044
	speed: 0.0302s/iter; left time: 502.0654s
Epoch: 20 cost time: 6.481822967529297
Epoch: 20, Steps: 208 | Train Loss: 0.332 Vali Loss: 7.577 Vali Acc: 0.099 Test Loss: 7.577 Test Acc: 0.099
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.3539403
	speed: 0.1107s/iter; left time: 1830.8939s
	iters: 200, epoch: 21 | loss: 0.2591127
	speed: 0.0282s/iter; left time: 463.8351s
Epoch: 21 cost time: 5.979604244232178
Epoch: 21, Steps: 208 | Train Loss: 0.343 Vali Loss: 7.606 Vali Acc: 0.105 Test Loss: 7.606 Test Acc: 0.105
Validation loss decreased (-0.103435 --> -0.104905).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0740222
	speed: 0.1091s/iter; left time: 1781.7587s
	iters: 200, epoch: 22 | loss: 0.1944329
	speed: 0.0278s/iter; left time: 452.0876s
Epoch: 22 cost time: 6.249216556549072
Epoch: 22, Steps: 208 | Train Loss: 0.294 Vali Loss: 8.096 Vali Acc: 0.101 Test Loss: 8.096 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.1781752
	speed: 0.1095s/iter; left time: 1765.0804s
	iters: 200, epoch: 23 | loss: 0.2451915
	speed: 0.0280s/iter; left time: 448.1330s
Epoch: 23 cost time: 5.909618854522705
Epoch: 23, Steps: 208 | Train Loss: 0.306 Vali Loss: 8.055 Vali Acc: 0.108 Test Loss: 8.055 Test Acc: 0.108
Validation loss decreased (-0.104905 --> -0.107584).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.5981335
	speed: 0.1195s/iter; left time: 1902.3867s
	iters: 200, epoch: 24 | loss: 0.9756658
	speed: 0.0294s/iter; left time: 464.2888s
Epoch: 24 cost time: 6.494307279586792
Epoch: 24, Steps: 208 | Train Loss: 0.274 Vali Loss: 8.601 Vali Acc: 0.103 Test Loss: 8.601 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0465729
	speed: 0.1223s/iter; left time: 1921.7223s
	iters: 200, epoch: 25 | loss: 0.0637534
	speed: 0.0274s/iter; left time: 427.7502s
Epoch: 25 cost time: 6.379190444946289
Epoch: 25, Steps: 208 | Train Loss: 0.269 Vali Loss: 8.655 Vali Acc: 0.101 Test Loss: 8.655 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.1328117
	speed: 0.1232s/iter; left time: 1910.0701s
	iters: 200, epoch: 26 | loss: 0.1228242
	speed: 0.0300s/iter; left time: 461.6522s
Epoch: 26 cost time: 6.4910972118377686
Epoch: 26, Steps: 208 | Train Loss: 0.232 Vali Loss: 8.475 Vali Acc: 0.100 Test Loss: 8.475 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0930889
	speed: 0.1203s/iter; left time: 1840.4959s
	iters: 200, epoch: 27 | loss: 0.2700708
	speed: 0.0321s/iter; left time: 487.7591s
Epoch: 27 cost time: 6.796792984008789
Epoch: 27, Steps: 208 | Train Loss: 0.241 Vali Loss: 9.363 Vali Acc: 0.099 Test Loss: 9.363 Test Acc: 0.099
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.5569767
	speed: 0.1346s/iter; left time: 2031.0175s
	iters: 200, epoch: 28 | loss: 0.2890017
	speed: 0.0308s/iter; left time: 461.6752s
Epoch: 28 cost time: 6.922937870025635
Epoch: 28, Steps: 208 | Train Loss: 0.231 Vali Loss: 9.193 Vali Acc: 0.102 Test Loss: 9.193 Test Acc: 0.102
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.2533696
	speed: 0.1311s/iter; left time: 1949.7817s
	iters: 200, epoch: 29 | loss: 0.3798689
	speed: 0.0222s/iter; left time: 327.7834s
Epoch: 29 cost time: 5.897874593734741
Epoch: 29, Steps: 208 | Train Loss: 0.229 Vali Loss: 9.557 Vali Acc: 0.105 Test Loss: 9.557 Test Acc: 0.105
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 1.1319761
	speed: 0.1414s/iter; left time: 2073.7895s
	iters: 200, epoch: 30 | loss: 0.7839637
	speed: 0.0301s/iter; left time: 438.5172s
Epoch: 30 cost time: 6.803796052932739
Epoch: 30, Steps: 208 | Train Loss: 0.211 Vali Loss: 9.551 Vali Acc: 0.102 Test Loss: 9.551 Test Acc: 0.102
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.2665690
	speed: 0.1380s/iter; left time: 1995.5422s
	iters: 200, epoch: 31 | loss: 0.1236878
	speed: 0.0316s/iter; left time: 454.4109s
Epoch: 31 cost time: 6.887582778930664
Epoch: 31, Steps: 208 | Train Loss: 0.199 Vali Loss: 9.534 Vali Acc: 0.103 Test Loss: 9.534 Test Acc: 0.103
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.3803565
	speed: 0.1307s/iter; left time: 1862.1585s
	iters: 200, epoch: 32 | loss: 0.1377776
	speed: 0.0314s/iter; left time: 444.1441s
Epoch: 32 cost time: 6.656985759735107
Epoch: 32, Steps: 208 | Train Loss: 0.185 Vali Loss: 9.840 Vali Acc: 0.101 Test Loss: 9.840 Test Acc: 0.101
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.1622354
	speed: 0.1188s/iter; left time: 1669.1216s
	iters: 200, epoch: 33 | loss: 0.1764868
	speed: 0.0283s/iter; left time: 394.1299s
Epoch: 33 cost time: 6.2114174365997314
Epoch: 33, Steps: 208 | Train Loss: 0.193 Vali Loss: 9.610 Vali Acc: 0.108 Test Loss: 9.610 Test Acc: 0.108
Validation loss decreased (-0.107584 --> -0.107867).  Saving model ...
	iters: 100, epoch: 34 | loss: 0.9159291
	speed: 0.1161s/iter; left time: 1606.7608s
	iters: 200, epoch: 34 | loss: 0.1245484
	speed: 0.0267s/iter; left time: 366.4238s
Epoch: 34 cost time: 6.015520334243774
Epoch: 34, Steps: 208 | Train Loss: 0.197 Vali Loss: 10.157 Vali Acc: 0.106 Test Loss: 10.157 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 0.4591191
	speed: 0.1182s/iter; left time: 1611.1905s
	iters: 200, epoch: 35 | loss: 0.0624467
	speed: 0.0281s/iter; left time: 379.6813s
Epoch: 35 cost time: 6.221514940261841
Epoch: 35, Steps: 208 | Train Loss: 0.170 Vali Loss: 10.053 Vali Acc: 0.109 Test Loss: 10.053 Test Acc: 0.109
Validation loss decreased (-0.107867 --> -0.109055).  Saving model ...
	iters: 100, epoch: 36 | loss: 0.0187729
	speed: 0.1161s/iter; left time: 1558.3944s
	iters: 200, epoch: 36 | loss: 0.6960115
	speed: 0.0250s/iter; left time: 333.3935s
Epoch: 36 cost time: 5.47611927986145
Epoch: 36, Steps: 208 | Train Loss: 0.193 Vali Loss: 9.976 Vali Acc: 0.100 Test Loss: 9.976 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 0.3359163
	speed: 0.1060s/iter; left time: 1401.0058s
	iters: 200, epoch: 37 | loss: 0.0688870
	speed: 0.0254s/iter; left time: 332.7582s
Epoch: 37 cost time: 5.684608221054077
Epoch: 37, Steps: 208 | Train Loss: 0.174 Vali Loss: 10.312 Vali Acc: 0.105 Test Loss: 10.312 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 0.0031447
	speed: 0.1037s/iter; left time: 1349.0534s
	iters: 200, epoch: 38 | loss: 0.3320225
	speed: 0.0248s/iter; left time: 319.8560s
Epoch: 38 cost time: 5.383352994918823
Epoch: 38, Steps: 208 | Train Loss: 0.176 Vali Loss: 10.294 Vali Acc: 0.111 Test Loss: 10.294 Test Acc: 0.111
Validation loss decreased (-0.109055 --> -0.111141).  Saving model ...
	iters: 100, epoch: 39 | loss: 0.2274753
	speed: 0.1059s/iter; left time: 1355.6172s
	iters: 200, epoch: 39 | loss: 0.1500939
	speed: 0.0247s/iter; left time: 313.1941s
Epoch: 39 cost time: 5.533440351486206
Epoch: 39, Steps: 208 | Train Loss: 0.181 Vali Loss: 10.302 Vali Acc: 0.104 Test Loss: 10.302 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 40 | loss: 0.1400951
	speed: 0.1037s/iter; left time: 1305.0188s
	iters: 200, epoch: 40 | loss: 0.0972140
	speed: 0.0252s/iter; left time: 314.8511s
Epoch: 40 cost time: 5.604907035827637
Epoch: 40, Steps: 208 | Train Loss: 0.176 Vali Loss: 10.294 Vali Acc: 0.100 Test Loss: 10.294 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 41 | loss: 0.2623457
	speed: 0.1053s/iter; left time: 1303.2202s
	iters: 200, epoch: 41 | loss: 0.2586242
	speed: 0.0240s/iter; left time: 295.1958s
Epoch: 41 cost time: 5.581514120101929
Epoch: 41, Steps: 208 | Train Loss: 0.161 Vali Loss: 11.536 Vali Acc: 0.101 Test Loss: 11.536 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 42 | loss: 0.0624819
	speed: 0.1100s/iter; left time: 1339.5187s
	iters: 200, epoch: 42 | loss: 0.3665464
	speed: 0.0258s/iter; left time: 311.9710s
Epoch: 42 cost time: 5.9086854457855225
Epoch: 42, Steps: 208 | Train Loss: 0.151 Vali Loss: 11.605 Vali Acc: 0.096 Test Loss: 11.605 Test Acc: 0.096
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 43 | loss: 0.0040552
	speed: 0.0944s/iter; left time: 1129.9935s
	iters: 200, epoch: 43 | loss: 0.0236875
	speed: 0.0249s/iter; left time: 295.5204s
Epoch: 43 cost time: 5.6934123039245605
Epoch: 43, Steps: 208 | Train Loss: 0.148 Vali Loss: 11.337 Vali Acc: 0.109 Test Loss: 11.337 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 44 | loss: 0.8137619
	speed: 0.1061s/iter; left time: 1247.9322s
	iters: 200, epoch: 44 | loss: 0.0415837
	speed: 0.0245s/iter; left time: 285.2930s
Epoch: 44 cost time: 5.570098400115967
Epoch: 44, Steps: 208 | Train Loss: 0.159 Vali Loss: 11.701 Vali Acc: 0.111 Test Loss: 11.701 Test Acc: 0.111
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 45 | loss: 0.0330811
	speed: 0.1085s/iter; left time: 1252.7261s
	iters: 200, epoch: 45 | loss: 0.3577862
	speed: 0.0253s/iter; left time: 289.9225s
Epoch: 45 cost time: 5.77724552154541
Epoch: 45, Steps: 208 | Train Loss: 0.145 Vali Loss: 12.088 Vali Acc: 0.100 Test Loss: 12.088 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 46 | loss: 0.0223997
	speed: 0.1143s/iter; left time: 1296.2275s
	iters: 200, epoch: 46 | loss: 0.0065413
	speed: 0.0248s/iter; left time: 279.1405s
Epoch: 46 cost time: 5.768136024475098
Epoch: 46, Steps: 208 | Train Loss: 0.149 Vali Loss: 11.196 Vali Acc: 0.101 Test Loss: 11.196 Test Acc: 0.101
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 47 | loss: 0.0373565
	speed: 0.1050s/iter; left time: 1169.4591s
	iters: 200, epoch: 47 | loss: 0.0120231
	speed: 0.0248s/iter; left time: 274.0742s
Epoch: 47 cost time: 5.621729612350464
Epoch: 47, Steps: 208 | Train Loss: 0.148 Vali Loss: 11.106 Vali Acc: 0.099 Test Loss: 11.106 Test Acc: 0.099
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 48 | loss: 0.0118773
	speed: 0.0973s/iter; left time: 1063.0007s
	iters: 200, epoch: 48 | loss: 0.0611688
	speed: 0.0266s/iter; left time: 288.3007s
Epoch: 48 cost time: 5.8424577713012695
Epoch: 48, Steps: 208 | Train Loss: 0.149 Vali Loss: 11.623 Vali Acc: 0.103 Test Loss: 11.623 Test Acc: 0.103
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11124366239188786
model parameter : 422367
model size : 2.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.3718071
	speed: 0.0373s/iter; left time: 772.0726s
	iters: 200, epoch: 1 | loss: 4.0342650
	speed: 0.0241s/iter; left time: 496.8449s
Epoch: 1 cost time: 6.436999320983887
Epoch: 1, Steps: 208 | Train Loss: 3.872 Vali Loss: 4.002 Vali Acc: 0.052 Test Loss: 4.002 Test Acc: 0.052
Validation loss decreased (inf --> -0.052450).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5129721
	speed: 0.1207s/iter; left time: 2473.2126s
	iters: 200, epoch: 2 | loss: 3.8861225
	speed: 0.0287s/iter; left time: 584.9115s
Epoch: 2 cost time: 6.226900577545166
Epoch: 2, Steps: 208 | Train Loss: 4.019 Vali Loss: 4.063 Vali Acc: 0.053 Test Loss: 4.063 Test Acc: 0.053
Validation loss decreased (-0.052450 --> -0.053344).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.9651296
	speed: 0.1219s/iter; left time: 2472.6987s
	iters: 200, epoch: 3 | loss: 3.5628459
	speed: 0.0290s/iter; left time: 584.6659s
Epoch: 3 cost time: 6.4213950634002686
Epoch: 3, Steps: 208 | Train Loss: 3.873 Vali Loss: 4.073 Vali Acc: 0.059 Test Loss: 4.073 Test Acc: 0.059
Validation loss decreased (-0.053344 --> -0.059011).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.6082785
	speed: 0.1235s/iter; left time: 2480.0001s
	iters: 200, epoch: 4 | loss: 3.4600682
	speed: 0.0261s/iter; left time: 521.0902s
Epoch: 4 cost time: 6.139191150665283
Epoch: 4, Steps: 208 | Train Loss: 3.630 Vali Loss: 4.066 Vali Acc: 0.060 Test Loss: 4.066 Test Acc: 0.060
Validation loss decreased (-0.059011 --> -0.060204).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2822313
	speed: 0.1245s/iter; left time: 2474.4088s
	iters: 200, epoch: 5 | loss: 3.1279442
	speed: 0.0284s/iter; left time: 561.4412s
Epoch: 5 cost time: 6.388721942901611
Epoch: 5, Steps: 208 | Train Loss: 3.360 Vali Loss: 3.699 Vali Acc: 0.075 Test Loss: 3.699 Test Acc: 0.075
Validation loss decreased (-0.060204 --> -0.075120).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.0237277
	speed: 0.1215s/iter; left time: 2388.3081s
	iters: 200, epoch: 6 | loss: 3.2110238
	speed: 0.0298s/iter; left time: 582.8322s
Epoch: 6 cost time: 6.603192567825317
Epoch: 6, Steps: 208 | Train Loss: 3.049 Vali Loss: 3.529 Vali Acc: 0.078 Test Loss: 3.529 Test Acc: 0.078
Validation loss decreased (-0.075120 --> -0.077805).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.6503356
	speed: 0.1219s/iter; left time: 2370.6019s
	iters: 200, epoch: 7 | loss: 3.8133106
	speed: 0.0276s/iter; left time: 534.8262s
Epoch: 7 cost time: 6.0060648918151855
Epoch: 7, Steps: 208 | Train Loss: 2.753 Vali Loss: 3.519 Vali Acc: 0.085 Test Loss: 3.519 Test Acc: 0.085
Validation loss decreased (-0.077805 --> -0.084665).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.6579235
	speed: 0.1106s/iter; left time: 2128.1137s
	iters: 200, epoch: 8 | loss: 2.9652143
	speed: 0.0268s/iter; left time: 512.1844s
Epoch: 8 cost time: 5.828113794326782
Epoch: 8, Steps: 208 | Train Loss: 2.478 Vali Loss: 3.560 Vali Acc: 0.106 Test Loss: 3.560 Test Acc: 0.106
Validation loss decreased (-0.084665 --> -0.106436).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.6810889
	speed: 0.1061s/iter; left time: 2020.5853s
	iters: 200, epoch: 9 | loss: 2.9112372
	speed: 0.0256s/iter; left time: 485.4239s
Epoch: 9 cost time: 5.721560716629028
Epoch: 9, Steps: 208 | Train Loss: 2.204 Vali Loss: 3.727 Vali Acc: 0.099 Test Loss: 3.727 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.2016478
	speed: 0.1120s/iter; left time: 2109.2208s
	iters: 200, epoch: 10 | loss: 2.6431508
	speed: 0.0255s/iter; left time: 477.6519s
Epoch: 10 cost time: 5.679809331893921
Epoch: 10, Steps: 208 | Train Loss: 1.880 Vali Loss: 3.840 Vali Acc: 0.111 Test Loss: 3.840 Test Acc: 0.111
Validation loss decreased (-0.106436 --> -0.111205).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4014142
	speed: 0.1062s/iter; left time: 1977.1450s
	iters: 200, epoch: 11 | loss: 1.9383681
	speed: 0.0265s/iter; left time: 490.4303s
Epoch: 11 cost time: 6.0189995765686035
Epoch: 11, Steps: 208 | Train Loss: 1.593 Vali Loss: 4.118 Vali Acc: 0.117 Test Loss: 4.118 Test Acc: 0.117
Validation loss decreased (-0.111205 --> -0.116571).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.8074886
	speed: 0.1124s/iter; left time: 2069.4368s
	iters: 200, epoch: 12 | loss: 1.1688893
	speed: 0.0234s/iter; left time: 428.2420s
Epoch: 12 cost time: 5.513190984725952
Epoch: 12, Steps: 208 | Train Loss: 1.354 Vali Loss: 4.556 Vali Acc: 0.106 Test Loss: 4.556 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.2679431
	speed: 0.0999s/iter; left time: 1818.7503s
	iters: 200, epoch: 13 | loss: 1.4675840
	speed: 0.0249s/iter; left time: 450.8173s
Epoch: 13 cost time: 5.567246913909912
Epoch: 13, Steps: 208 | Train Loss: 1.090 Vali Loss: 5.051 Vali Acc: 0.114 Test Loss: 5.051 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.0638062
	speed: 0.1070s/iter; left time: 1925.7511s
	iters: 200, epoch: 14 | loss: 1.0227267
	speed: 0.0221s/iter; left time: 395.6470s
Epoch: 14 cost time: 5.388160228729248
Epoch: 14, Steps: 208 | Train Loss: 0.888 Vali Loss: 5.421 Vali Acc: 0.114 Test Loss: 5.421 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.6152819
	speed: 0.1037s/iter; left time: 1844.3805s
	iters: 200, epoch: 15 | loss: 0.6887048
	speed: 0.0259s/iter; left time: 457.2677s
Epoch: 15 cost time: 5.694849491119385
Epoch: 15, Steps: 208 | Train Loss: 0.745 Vali Loss: 5.608 Vali Acc: 0.104 Test Loss: 5.608 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.8646644
	speed: 0.0956s/iter; left time: 1681.1751s
	iters: 200, epoch: 16 | loss: 0.7889012
	speed: 0.0217s/iter; left time: 378.8082s
Epoch: 16 cost time: 5.263226747512817
Epoch: 16, Steps: 208 | Train Loss: 0.608 Vali Loss: 5.982 Vali Acc: 0.115 Test Loss: 5.982 Test Acc: 0.115
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.0997306
	speed: 0.0925s/iter; left time: 1607.1123s
	iters: 200, epoch: 17 | loss: 0.7021254
	speed: 0.0199s/iter; left time: 342.9593s
Epoch: 17 cost time: 4.729320526123047
Epoch: 17, Steps: 208 | Train Loss: 0.558 Vali Loss: 6.562 Vali Acc: 0.115 Test Loss: 6.562 Test Acc: 0.115
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.3922662
	speed: 0.0731s/iter; left time: 1255.0503s
	iters: 200, epoch: 18 | loss: 0.9793618
	speed: 0.0202s/iter; left time: 344.6026s
Epoch: 18 cost time: 4.572477340698242
Epoch: 18, Steps: 208 | Train Loss: 0.487 Vali Loss: 6.749 Vali Acc: 0.112 Test Loss: 6.749 Test Acc: 0.112
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.1911794
	speed: 0.1086s/iter; left time: 1842.1750s
	iters: 200, epoch: 19 | loss: 0.9991950
	speed: 0.0258s/iter; left time: 434.8991s
Epoch: 19 cost time: 5.696943044662476
Epoch: 19, Steps: 208 | Train Loss: 0.437 Vali Loss: 7.049 Vali Acc: 0.114 Test Loss: 7.049 Test Acc: 0.114
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.4344096
	speed: 0.0943s/iter; left time: 1579.6915s
	iters: 200, epoch: 20 | loss: 0.5312249
	speed: 0.0254s/iter; left time: 422.8048s
Epoch: 20 cost time: 5.261319637298584
Epoch: 20, Steps: 208 | Train Loss: 0.371 Vali Loss: 7.252 Vali Acc: 0.113 Test Loss: 7.252 Test Acc: 0.113
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.7058070
	speed: 0.1067s/iter; left time: 1765.3945s
	iters: 200, epoch: 21 | loss: 0.5989565
	speed: 0.0237s/iter; left time: 390.3990s
Epoch: 21 cost time: 5.4433324337005615
Epoch: 21, Steps: 208 | Train Loss: 0.355 Vali Loss: 7.720 Vali Acc: 0.115 Test Loss: 7.720 Test Acc: 0.115
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11661198926334626
model parameter : 421759
model size : 2.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0523753
	speed: 0.0426s/iter; left time: 881.2373s
	iters: 200, epoch: 1 | loss: 3.8385091
	speed: 0.0209s/iter; left time: 431.3575s
Epoch: 1 cost time: 6.586076736450195
Epoch: 1, Steps: 208 | Train Loss: 3.875 Vali Loss: 4.204 Vali Acc: 0.046 Test Loss: 4.204 Test Acc: 0.046
Validation loss decreased (inf --> -0.045887).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.0889184
	speed: 0.1070s/iter; left time: 2192.4137s
	iters: 200, epoch: 2 | loss: 4.2215466
	speed: 0.0229s/iter; left time: 467.5900s
Epoch: 2 cost time: 5.50212025642395
Epoch: 2, Steps: 208 | Train Loss: 3.989 Vali Loss: 4.244 Vali Acc: 0.047 Test Loss: 4.244 Test Acc: 0.047
Validation loss decreased (-0.045887 --> -0.046483).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.2327404
	speed: 0.1268s/iter; left time: 2571.1558s
	iters: 200, epoch: 3 | loss: 4.0792131
	speed: 0.0287s/iter; left time: 578.3715s
Epoch: 3 cost time: 6.16511869430542
Epoch: 3, Steps: 208 | Train Loss: 3.817 Vali Loss: 4.031 Vali Acc: 0.048 Test Loss: 4.031 Test Acc: 0.048
Validation loss decreased (-0.046483 --> -0.047678).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4538546
	speed: 0.1146s/iter; left time: 2300.8819s
	iters: 200, epoch: 4 | loss: 3.9223914
	speed: 0.0290s/iter; left time: 579.3492s
Epoch: 4 cost time: 5.995054006576538
Epoch: 4, Steps: 208 | Train Loss: 3.593 Vali Loss: 3.831 Vali Acc: 0.058 Test Loss: 3.831 Test Acc: 0.058
Validation loss decreased (-0.047678 --> -0.058417).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.7347810
	speed: 0.1199s/iter; left time: 2382.1981s
	iters: 200, epoch: 5 | loss: 3.1486576
	speed: 0.0260s/iter; left time: 513.0911s
Epoch: 5 cost time: 6.177165508270264
Epoch: 5, Steps: 208 | Train Loss: 3.309 Vali Loss: 3.648 Vali Acc: 0.064 Test Loss: 3.648 Test Acc: 0.064
Validation loss decreased (-0.058417 --> -0.064085).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.4637544
	speed: 0.1147s/iter; left time: 2254.9481s
	iters: 200, epoch: 6 | loss: 3.0934494
	speed: 0.0260s/iter; left time: 507.6689s
Epoch: 6 cost time: 6.0974345207214355
Epoch: 6, Steps: 208 | Train Loss: 2.993 Vali Loss: 3.577 Vali Acc: 0.077 Test Loss: 3.577 Test Acc: 0.077
Validation loss decreased (-0.064085 --> -0.076612).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.5461881
	speed: 0.1137s/iter; left time: 2211.4385s
	iters: 200, epoch: 7 | loss: 2.7310448
	speed: 0.0275s/iter; left time: 532.2709s
Epoch: 7 cost time: 6.15841007232666
Epoch: 7, Steps: 208 | Train Loss: 2.728 Vali Loss: 3.580 Vali Acc: 0.094 Test Loss: 3.580 Test Acc: 0.094
Validation loss decreased (-0.076612 --> -0.094208).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.1810436
	speed: 0.1209s/iter; left time: 2327.4667s
	iters: 200, epoch: 8 | loss: 2.3120971
	speed: 0.0272s/iter; left time: 519.8744s
Epoch: 8 cost time: 6.3562071323394775
Epoch: 8, Steps: 208 | Train Loss: 2.427 Vali Loss: 3.660 Vali Acc: 0.103 Test Loss: 3.660 Test Acc: 0.103
Validation loss decreased (-0.094208 --> -0.103453).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.5629745
	speed: 0.1111s/iter; left time: 2114.4599s
	iters: 200, epoch: 9 | loss: 2.6988933
	speed: 0.0245s/iter; left time: 464.5771s
Epoch: 9 cost time: 5.6459105014801025
Epoch: 9, Steps: 208 | Train Loss: 2.075 Vali Loss: 3.797 Vali Acc: 0.089 Test Loss: 3.797 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.7220705
	speed: 0.0974s/iter; left time: 1834.7283s
	iters: 200, epoch: 10 | loss: 1.9537976
	speed: 0.0256s/iter; left time: 479.8731s
Epoch: 10 cost time: 5.77125883102417
Epoch: 10, Steps: 208 | Train Loss: 1.757 Vali Loss: 4.033 Vali Acc: 0.104 Test Loss: 4.033 Test Acc: 0.104
Validation loss decreased (-0.103453 --> -0.104344).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.0992053
	speed: 0.1032s/iter; left time: 1921.1605s
	iters: 200, epoch: 11 | loss: 1.9934411
	speed: 0.0260s/iter; left time: 482.1476s
Epoch: 11 cost time: 5.630557537078857
Epoch: 11, Steps: 208 | Train Loss: 1.445 Vali Loss: 4.232 Vali Acc: 0.103 Test Loss: 4.232 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.3277937
	speed: 0.1069s/iter; left time: 1967.6362s
	iters: 200, epoch: 12 | loss: 1.2933121
	speed: 0.0261s/iter; left time: 477.2990s
Epoch: 12 cost time: 5.728850364685059
Epoch: 12, Steps: 208 | Train Loss: 1.171 Vali Loss: 4.781 Vali Acc: 0.098 Test Loss: 4.781 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.1723793
	speed: 0.1162s/iter; left time: 2115.0826s
	iters: 200, epoch: 13 | loss: 1.1047828
	speed: 0.0228s/iter; left time: 412.0430s
Epoch: 13 cost time: 5.545327186584473
Epoch: 13, Steps: 208 | Train Loss: 0.954 Vali Loss: 5.223 Vali Acc: 0.102 Test Loss: 5.223 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.6502895
	speed: 0.1077s/iter; left time: 1937.8835s
	iters: 200, epoch: 14 | loss: 0.7262644
	speed: 0.0248s/iter; left time: 443.1797s
Epoch: 14 cost time: 5.627578496932983
Epoch: 14, Steps: 208 | Train Loss: 0.786 Vali Loss: 5.316 Vali Acc: 0.100 Test Loss: 5.316 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.4480033
	speed: 0.1038s/iter; left time: 1845.6304s
	iters: 200, epoch: 15 | loss: 0.7149236
	speed: 0.0270s/iter; left time: 477.9466s
Epoch: 15 cost time: 5.83447527885437
Epoch: 15, Steps: 208 | Train Loss: 0.638 Vali Loss: 5.804 Vali Acc: 0.101 Test Loss: 5.804 Test Acc: 0.101
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.4514427
	speed: 0.1058s/iter; left time: 1860.7058s
	iters: 200, epoch: 16 | loss: 0.4982296
	speed: 0.0228s/iter; left time: 398.7860s
Epoch: 16 cost time: 5.271440744400024
Epoch: 16, Steps: 208 | Train Loss: 0.551 Vali Loss: 6.375 Vali Acc: 0.097 Test Loss: 6.375 Test Acc: 0.097
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.6739133
	speed: 0.0981s/iter; left time: 1704.8906s
	iters: 200, epoch: 17 | loss: 0.8075179
	speed: 0.0260s/iter; left time: 449.6061s
Epoch: 17 cost time: 5.7621073722839355
Epoch: 17, Steps: 208 | Train Loss: 0.495 Vali Loss: 6.719 Vali Acc: 0.092 Test Loss: 6.719 Test Acc: 0.092
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0934984
	speed: 0.1119s/iter; left time: 1920.5139s
	iters: 200, epoch: 18 | loss: 0.7289241
	speed: 0.0256s/iter; left time: 436.5293s
Epoch: 18 cost time: 5.410329580307007
Epoch: 18, Steps: 208 | Train Loss: 0.418 Vali Loss: 6.867 Vali Acc: 0.103 Test Loss: 6.867 Test Acc: 0.103
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.2238493
	speed: 0.1058s/iter; left time: 1793.5073s
	iters: 200, epoch: 19 | loss: 0.4125710
	speed: 0.0253s/iter; left time: 426.3821s
Epoch: 19 cost time: 5.645792245864868
Epoch: 19, Steps: 208 | Train Loss: 0.384 Vali Loss: 7.151 Vali Acc: 0.097 Test Loss: 7.151 Test Acc: 0.097
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.1275039
	speed: 0.1081s/iter; left time: 1809.9222s
	iters: 200, epoch: 20 | loss: 0.3398539
	speed: 0.0274s/iter; left time: 455.7988s
Epoch: 20 cost time: 5.804984092712402
Epoch: 20, Steps: 208 | Train Loss: 0.361 Vali Loss: 7.461 Vali Acc: 0.098 Test Loss: 7.461 Test Acc: 0.098
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.10438413361169102
model parameter : 421151
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.5725389
	speed: 0.0386s/iter; left time: 799.1106s
	iters: 200, epoch: 1 | loss: 4.5278897
	speed: 0.0243s/iter; left time: 500.3847s
Epoch: 1 cost time: 6.552803039550781
Epoch: 1, Steps: 208 | Train Loss: 3.910 Vali Loss: 3.842 Vali Acc: 0.053 Test Loss: 3.842 Test Acc: 0.053
Validation loss decreased (inf --> -0.053048).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.4680917
	speed: 0.1068s/iter; left time: 2187.9989s
	iters: 200, epoch: 2 | loss: 3.4833550
	speed: 0.0245s/iter; left time: 499.0342s
Epoch: 2 cost time: 5.674744606018066
Epoch: 2, Steps: 208 | Train Loss: 3.977 Vali Loss: 4.008 Vali Acc: 0.060 Test Loss: 4.008 Test Acc: 0.060
Validation loss decreased (-0.053048 --> -0.059906).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.2944593
	speed: 0.1086s/iter; left time: 2203.5471s
	iters: 200, epoch: 3 | loss: 3.5914073
	speed: 0.0233s/iter; left time: 469.5346s
Epoch: 3 cost time: 5.404324054718018
Epoch: 3, Steps: 208 | Train Loss: 3.826 Vali Loss: 3.939 Vali Acc: 0.065 Test Loss: 3.939 Test Acc: 0.065
Validation loss decreased (-0.059906 --> -0.064977).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.9060647
	speed: 0.1072s/iter; left time: 2152.1558s
	iters: 200, epoch: 4 | loss: 3.8534184
	speed: 0.0256s/iter; left time: 511.8639s
Epoch: 4 cost time: 5.9404847621917725
Epoch: 4, Steps: 208 | Train Loss: 3.647 Vali Loss: 3.873 Vali Acc: 0.054 Test Loss: 3.873 Test Acc: 0.054
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.4221790
	speed: 0.1048s/iter; left time: 2082.6901s
	iters: 200, epoch: 5 | loss: 3.4204996
	speed: 0.0284s/iter; left time: 561.3616s
Epoch: 5 cost time: 6.111406564712524
Epoch: 5, Steps: 208 | Train Loss: 3.354 Vali Loss: 3.617 Vali Acc: 0.069 Test Loss: 3.617 Test Acc: 0.069
Validation loss decreased (-0.064977 --> -0.068559).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.1997120
	speed: 0.1167s/iter; left time: 2293.7925s
	iters: 200, epoch: 6 | loss: 3.1407721
	speed: 0.0285s/iter; left time: 557.6106s
Epoch: 6 cost time: 6.3695104122161865
Epoch: 6, Steps: 208 | Train Loss: 3.119 Vali Loss: 3.489 Vali Acc: 0.080 Test Loss: 3.489 Test Acc: 0.080
Validation loss decreased (-0.068559 --> -0.079894).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.0088823
	speed: 0.1175s/iter; left time: 2285.9666s
	iters: 200, epoch: 7 | loss: 2.9241412
	speed: 0.0279s/iter; left time: 539.0316s
Epoch: 7 cost time: 5.977118730545044
Epoch: 7, Steps: 208 | Train Loss: 2.852 Vali Loss: 3.548 Vali Acc: 0.089 Test Loss: 3.548 Test Acc: 0.089
Validation loss decreased (-0.079894 --> -0.088840).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.5464633
	speed: 0.1208s/iter; left time: 2324.4652s
	iters: 200, epoch: 8 | loss: 2.8075376
	speed: 0.0286s/iter; left time: 547.9995s
Epoch: 8 cost time: 6.362084150314331
Epoch: 8, Steps: 208 | Train Loss: 2.603 Vali Loss: 3.599 Vali Acc: 0.091 Test Loss: 3.599 Test Acc: 0.091
Validation loss decreased (-0.088840 --> -0.091226).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7841251
	speed: 0.1118s/iter; left time: 2128.1210s
	iters: 200, epoch: 9 | loss: 2.3702097
	speed: 0.0252s/iter; left time: 477.9837s
Epoch: 9 cost time: 5.9816107749938965
Epoch: 9, Steps: 208 | Train Loss: 2.366 Vali Loss: 3.622 Vali Acc: 0.106 Test Loss: 3.622 Test Acc: 0.106
Validation loss decreased (-0.091226 --> -0.105541).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.8969731
	speed: 0.1242s/iter; left time: 2338.6302s
	iters: 200, epoch: 10 | loss: 1.9108915
	speed: 0.0281s/iter; left time: 526.2902s
Epoch: 10 cost time: 6.385724306106567
Epoch: 10, Steps: 208 | Train Loss: 2.116 Vali Loss: 3.802 Vali Acc: 0.109 Test Loss: 3.802 Test Acc: 0.109
Validation loss decreased (-0.105541 --> -0.109118).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.6651262
	speed: 0.1119s/iter; left time: 2084.2606s
	iters: 200, epoch: 11 | loss: 2.3518116
	speed: 0.0249s/iter; left time: 460.6694s
Epoch: 11 cost time: 5.7718305587768555
Epoch: 11, Steps: 208 | Train Loss: 1.874 Vali Loss: 3.951 Vali Acc: 0.105 Test Loss: 3.951 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.2365959
	speed: 0.1121s/iter; left time: 2064.1164s
	iters: 200, epoch: 12 | loss: 1.9425553
	speed: 0.0258s/iter; left time: 471.8685s
Epoch: 12 cost time: 5.910619020462036
Epoch: 12, Steps: 208 | Train Loss: 1.663 Vali Loss: 4.267 Vali Acc: 0.099 Test Loss: 4.267 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 2.0616708
	speed: 0.1029s/iter; left time: 1873.0357s
	iters: 200, epoch: 13 | loss: 1.7637924
	speed: 0.0267s/iter; left time: 483.9869s
Epoch: 13 cost time: 5.807810544967651
Epoch: 13, Steps: 208 | Train Loss: 1.444 Vali Loss: 4.428 Vali Acc: 0.112 Test Loss: 4.428 Test Acc: 0.112
Validation loss decreased (-0.109118 --> -0.111498).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.3225716
	speed: 0.1110s/iter; left time: 1997.1910s
	iters: 200, epoch: 14 | loss: 1.1950746
	speed: 0.0236s/iter; left time: 422.5870s
Epoch: 14 cost time: 5.511098384857178
Epoch: 14, Steps: 208 | Train Loss: 1.272 Vali Loss: 4.790 Vali Acc: 0.107 Test Loss: 4.790 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.5195389
	speed: 0.1072s/iter; left time: 1906.3346s
	iters: 200, epoch: 15 | loss: 1.5092366
	speed: 0.0259s/iter; left time: 457.6535s
Epoch: 15 cost time: 5.877509117126465
Epoch: 15, Steps: 208 | Train Loss: 1.109 Vali Loss: 4.771 Vali Acc: 0.110 Test Loss: 4.771 Test Acc: 0.110
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.5916854
	speed: 0.1011s/iter; left time: 1777.3947s
	iters: 200, epoch: 16 | loss: 0.9609649
	speed: 0.0252s/iter; left time: 440.1451s
Epoch: 16 cost time: 5.66227388381958
Epoch: 16, Steps: 208 | Train Loss: 0.954 Vali Loss: 5.258 Vali Acc: 0.109 Test Loss: 5.258 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.1051354
	speed: 0.1062s/iter; left time: 1844.3134s
	iters: 200, epoch: 17 | loss: 0.8534746
	speed: 0.0249s/iter; left time: 429.4862s
Epoch: 17 cost time: 5.537170171737671
Epoch: 17, Steps: 208 | Train Loss: 0.842 Vali Loss: 5.521 Vali Acc: 0.120 Test Loss: 5.521 Test Acc: 0.120
Validation loss decreased (-0.111498 --> -0.119539).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.5848964
	speed: 0.1005s/iter; left time: 1724.5079s
	iters: 200, epoch: 18 | loss: 0.6537381
	speed: 0.0206s/iter; left time: 350.8813s
Epoch: 18 cost time: 4.630072116851807
Epoch: 18, Steps: 208 | Train Loss: 0.758 Vali Loss: 5.904 Vali Acc: 0.114 Test Loss: 5.904 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.6616579
	speed: 0.0702s/iter; left time: 1190.7732s
	iters: 200, epoch: 19 | loss: 0.7252170
	speed: 0.0183s/iter; left time: 309.3083s
Epoch: 19 cost time: 4.2035791873931885
Epoch: 19, Steps: 208 | Train Loss: 0.670 Vali Loss: 6.290 Vali Acc: 0.116 Test Loss: 6.290 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.2761384
	speed: 0.0756s/iter; left time: 1265.6378s
	iters: 200, epoch: 20 | loss: 0.9453821
	speed: 0.0257s/iter; left time: 428.2060s
Epoch: 20 cost time: 5.696654796600342
Epoch: 20, Steps: 208 | Train Loss: 0.619 Vali Loss: 6.513 Vali Acc: 0.117 Test Loss: 6.513 Test Acc: 0.117
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.4106566
	speed: 0.1129s/iter; left time: 1866.7844s
	iters: 200, epoch: 21 | loss: 0.4010720
	speed: 0.0248s/iter; left time: 407.9582s
Epoch: 21 cost time: 5.929052829742432
Epoch: 21, Steps: 208 | Train Loss: 0.573 Vali Loss: 6.630 Vali Acc: 0.119 Test Loss: 6.630 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.8502370
	speed: 0.1101s/iter; left time: 1797.4531s
	iters: 200, epoch: 22 | loss: 0.4700253
	speed: 0.0271s/iter; left time: 439.4692s
Epoch: 22 cost time: 5.974101543426514
Epoch: 22, Steps: 208 | Train Loss: 0.514 Vali Loss: 7.050 Vali Acc: 0.118 Test Loss: 7.050 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.4907020
	speed: 0.1059s/iter; left time: 1708.1288s
	iters: 200, epoch: 23 | loss: 0.1305813
	speed: 0.0246s/iter; left time: 393.7066s
Epoch: 23 cost time: 5.679612159729004
Epoch: 23, Steps: 208 | Train Loss: 0.477 Vali Loss: 7.269 Vali Acc: 0.118 Test Loss: 7.269 Test Acc: 0.118
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.4141278
	speed: 0.1143s/iter; left time: 1819.8047s
	iters: 200, epoch: 24 | loss: 0.5232342
	speed: 0.0260s/iter; left time: 411.6378s
Epoch: 24 cost time: 6.091862678527832
Epoch: 24, Steps: 208 | Train Loss: 0.436 Vali Loss: 7.707 Vali Acc: 0.114 Test Loss: 7.707 Test Acc: 0.114
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.5591683
	speed: 0.0981s/iter; left time: 1541.6331s
	iters: 200, epoch: 25 | loss: 0.8920988
	speed: 0.0253s/iter; left time: 394.1980s
Epoch: 25 cost time: 5.6904284954071045
Epoch: 25, Steps: 208 | Train Loss: 0.422 Vali Loss: 7.596 Vali Acc: 0.125 Test Loss: 7.596 Test Acc: 0.125
Validation loss decreased (-0.119539 --> -0.124589).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.1679389
	speed: 0.1212s/iter; left time: 1878.7152s
	iters: 200, epoch: 26 | loss: 0.0621746
	speed: 0.0244s/iter; left time: 375.3766s
Epoch: 26 cost time: 5.834148168563843
Epoch: 26, Steps: 208 | Train Loss: 0.399 Vali Loss: 7.885 Vali Acc: 0.125 Test Loss: 7.885 Test Acc: 0.125
Validation loss decreased (-0.124589 --> -0.125182).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.4378816
	speed: 0.1030s/iter; left time: 1575.2428s
	iters: 200, epoch: 27 | loss: 0.3784521
	speed: 0.0267s/iter; left time: 404.9439s
Epoch: 27 cost time: 5.893221378326416
Epoch: 27, Steps: 208 | Train Loss: 0.371 Vali Loss: 7.968 Vali Acc: 0.113 Test Loss: 7.968 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.6521394
	speed: 0.1222s/iter; left time: 1842.6748s
	iters: 200, epoch: 28 | loss: 0.6652128
	speed: 0.0223s/iter; left time: 333.5975s
Epoch: 28 cost time: 5.693541049957275
Epoch: 28, Steps: 208 | Train Loss: 0.356 Vali Loss: 8.035 Vali Acc: 0.120 Test Loss: 8.035 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.5102577
	speed: 0.1170s/iter; left time: 1741.2215s
	iters: 200, epoch: 29 | loss: 0.4816690
	speed: 0.0302s/iter; left time: 446.4345s
Epoch: 29 cost time: 6.580499887466431
Epoch: 29, Steps: 208 | Train Loss: 0.333 Vali Loss: 8.346 Vali Acc: 0.121 Test Loss: 8.346 Test Acc: 0.121
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.2857014
	speed: 0.1171s/iter; left time: 1717.7457s
	iters: 200, epoch: 30 | loss: 0.2473447
	speed: 0.0292s/iter; left time: 425.2351s
Epoch: 30 cost time: 6.254246234893799
Epoch: 30, Steps: 208 | Train Loss: 0.326 Vali Loss: 8.422 Vali Acc: 0.118 Test Loss: 8.422 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.1902436
	speed: 0.1227s/iter; left time: 1774.0287s
	iters: 200, epoch: 31 | loss: 0.0409796
	speed: 0.0293s/iter; left time: 420.9599s
Epoch: 31 cost time: 6.351462364196777
Epoch: 31, Steps: 208 | Train Loss: 0.295 Vali Loss: 8.669 Vali Acc: 0.118 Test Loss: 8.669 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.3217188
	speed: 0.1178s/iter; left time: 1679.4802s
	iters: 200, epoch: 32 | loss: 0.4601125
	speed: 0.0279s/iter; left time: 395.0197s
Epoch: 32 cost time: 6.39031982421875
Epoch: 32, Steps: 208 | Train Loss: 0.281 Vali Loss: 9.019 Vali Acc: 0.120 Test Loss: 9.019 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.1776992
	speed: 0.1208s/iter; left time: 1696.8047s
	iters: 200, epoch: 33 | loss: 0.2649761
	speed: 0.0261s/iter; left time: 363.7951s
Epoch: 33 cost time: 6.166828632354736
Epoch: 33, Steps: 208 | Train Loss: 0.291 Vali Loss: 9.346 Vali Acc: 0.118 Test Loss: 9.346 Test Acc: 0.118
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.2187713
	speed: 0.1180s/iter; left time: 1633.3048s
	iters: 200, epoch: 34 | loss: 0.7399292
	speed: 0.0252s/iter; left time: 346.3553s
Epoch: 34 cost time: 5.759608507156372
Epoch: 34, Steps: 208 | Train Loss: 0.282 Vali Loss: 9.114 Vali Acc: 0.116 Test Loss: 9.114 Test Acc: 0.116
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.1075988
	speed: 0.0986s/iter; left time: 1344.0440s
	iters: 200, epoch: 35 | loss: 0.1075918
	speed: 0.0227s/iter; left time: 306.6477s
Epoch: 35 cost time: 5.601667642593384
Epoch: 35, Steps: 208 | Train Loss: 0.265 Vali Loss: 9.578 Vali Acc: 0.118 Test Loss: 9.578 Test Acc: 0.118
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.4049540
	speed: 0.1049s/iter; left time: 1407.9994s
	iters: 200, epoch: 36 | loss: 0.0673728
	speed: 0.0244s/iter; left time: 324.8033s
Epoch: 36 cost time: 5.573258638381958
Epoch: 36, Steps: 208 | Train Loss: 0.264 Vali Loss: 9.912 Vali Acc: 0.114 Test Loss: 9.912 Test Acc: 0.114
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12526096033402923
model parameter : 373055
model size : 2.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1884861
	speed: 0.0395s/iter; left time: 818.7056s
	iters: 200, epoch: 1 | loss: 3.9369214
	speed: 0.0230s/iter; left time: 473.7685s
Epoch: 1 cost time: 6.5064613819122314
Epoch: 1, Steps: 208 | Train Loss: 3.866 Vali Loss: 4.316 Vali Acc: 0.048 Test Loss: 4.316 Test Acc: 0.048
Validation loss decreased (inf --> -0.048272).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.5645452
	speed: 0.1030s/iter; left time: 2110.1221s
	iters: 200, epoch: 2 | loss: 3.7402401
	speed: 0.0258s/iter; left time: 525.7682s
Epoch: 2 cost time: 5.699901580810547
Epoch: 2, Steps: 208 | Train Loss: 3.978 Vali Loss: 4.370 Vali Acc: 0.056 Test Loss: 4.370 Test Acc: 0.056
Validation loss decreased (-0.048272 --> -0.056324).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.4264107
	speed: 0.0940s/iter; left time: 1906.6385s
	iters: 200, epoch: 3 | loss: 3.8272238
	speed: 0.0253s/iter; left time: 511.2809s
Epoch: 3 cost time: 5.277840614318848
Epoch: 3, Steps: 208 | Train Loss: 3.886 Vali Loss: 4.079 Vali Acc: 0.055 Test Loss: 4.079 Test Acc: 0.055
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.3431678
	speed: 0.1082s/iter; left time: 2172.7692s
	iters: 200, epoch: 4 | loss: 3.3425150
	speed: 0.0243s/iter; left time: 486.1183s
Epoch: 4 cost time: 5.600162029266357
Epoch: 4, Steps: 208 | Train Loss: 3.720 Vali Loss: 3.857 Vali Acc: 0.052 Test Loss: 3.857 Test Acc: 0.052
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 3.5226312
	speed: 0.1003s/iter; left time: 1993.7018s
	iters: 200, epoch: 5 | loss: 3.3419609
	speed: 0.0246s/iter; left time: 485.5270s
Epoch: 5 cost time: 5.442479848861694
Epoch: 5, Steps: 208 | Train Loss: 3.427 Vali Loss: 3.648 Vali Acc: 0.072 Test Loss: 3.648 Test Acc: 0.072
Validation loss decreased (-0.056324 --> -0.071541).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.8271844
	speed: 0.1066s/iter; left time: 2094.9847s
	iters: 200, epoch: 6 | loss: 2.7972825
	speed: 0.0249s/iter; left time: 486.2733s
Epoch: 6 cost time: 5.447618007659912
Epoch: 6, Steps: 208 | Train Loss: 3.134 Vali Loss: 3.475 Vali Acc: 0.086 Test Loss: 3.475 Test Acc: 0.086
Validation loss decreased (-0.071541 --> -0.085560).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.4900391
	speed: 0.0949s/iter; left time: 1846.8318s
	iters: 200, epoch: 7 | loss: 2.8991892
	speed: 0.0248s/iter; left time: 479.6630s
Epoch: 7 cost time: 5.547864198684692
Epoch: 7, Steps: 208 | Train Loss: 2.850 Vali Loss: 3.342 Vali Acc: 0.098 Test Loss: 3.342 Test Acc: 0.098
Validation loss decreased (-0.085560 --> -0.098386).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.2989211
	speed: 0.1005s/iter; left time: 1933.8411s
	iters: 200, epoch: 8 | loss: 2.3692386
	speed: 0.0244s/iter; left time: 467.5117s
Epoch: 8 cost time: 5.727164030075073
Epoch: 8, Steps: 208 | Train Loss: 2.613 Vali Loss: 3.436 Vali Acc: 0.108 Test Loss: 3.436 Test Acc: 0.108
Validation loss decreased (-0.098386 --> -0.107929).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.3449261
	speed: 0.0971s/iter; left time: 1847.7975s
	iters: 200, epoch: 9 | loss: 3.1034636
	speed: 0.0249s/iter; left time: 471.2809s
Epoch: 9 cost time: 5.55437159538269
Epoch: 9, Steps: 208 | Train Loss: 2.359 Vali Loss: 3.523 Vali Acc: 0.110 Test Loss: 3.523 Test Acc: 0.110
Validation loss decreased (-0.107929 --> -0.109717).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.8058304
	speed: 0.1055s/iter; left time: 1986.3237s
	iters: 200, epoch: 10 | loss: 2.2278380
	speed: 0.0246s/iter; left time: 460.3300s
Epoch: 10 cost time: 5.324185132980347
Epoch: 10, Steps: 208 | Train Loss: 2.126 Vali Loss: 3.767 Vali Acc: 0.115 Test Loss: 3.767 Test Acc: 0.115
Validation loss decreased (-0.109717 --> -0.115083).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.2486997
	speed: 0.1088s/iter; left time: 2025.1380s
	iters: 200, epoch: 11 | loss: 2.0998039
	speed: 0.0264s/iter; left time: 488.5094s
Epoch: 11 cost time: 5.9127357006073
Epoch: 11, Steps: 208 | Train Loss: 1.857 Vali Loss: 3.993 Vali Acc: 0.117 Test Loss: 3.993 Test Acc: 0.117
Validation loss decreased (-0.115083 --> -0.116572).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4892768
	speed: 0.1089s/iter; left time: 2006.0399s
	iters: 200, epoch: 12 | loss: 1.8742394
	speed: 0.0252s/iter; left time: 462.3586s
Epoch: 12 cost time: 5.633620500564575
Epoch: 12, Steps: 208 | Train Loss: 1.627 Vali Loss: 4.076 Vali Acc: 0.112 Test Loss: 4.076 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.6958888
	speed: 0.1055s/iter; left time: 1920.7953s
	iters: 200, epoch: 13 | loss: 1.4601269
	speed: 0.0278s/iter; left time: 503.3944s
Epoch: 13 cost time: 5.720957040786743
Epoch: 13, Steps: 208 | Train Loss: 1.405 Vali Loss: 4.508 Vali Acc: 0.118 Test Loss: 4.508 Test Acc: 0.118
Validation loss decreased (-0.116572 --> -0.117760).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.2123348
	speed: 0.0976s/iter; left time: 1756.2678s
	iters: 200, epoch: 14 | loss: 2.0463099
	speed: 0.0263s/iter; left time: 470.0294s
Epoch: 14 cost time: 5.7409703731536865
Epoch: 14, Steps: 208 | Train Loss: 1.181 Vali Loss: 4.781 Vali Acc: 0.118 Test Loss: 4.781 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.5312703
	speed: 0.1169s/iter; left time: 2078.9401s
	iters: 200, epoch: 15 | loss: 1.3478826
	speed: 0.0270s/iter; left time: 477.3129s
Epoch: 15 cost time: 6.063922882080078
Epoch: 15, Steps: 208 | Train Loss: 1.000 Vali Loss: 5.031 Vali Acc: 0.124 Test Loss: 5.031 Test Acc: 0.124
Validation loss decreased (-0.117760 --> -0.123719).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.2409806
	speed: 0.1179s/iter; left time: 2073.3515s
	iters: 200, epoch: 16 | loss: 0.7919089
	speed: 0.0281s/iter; left time: 491.1293s
Epoch: 16 cost time: 6.1897852420806885
Epoch: 16, Steps: 208 | Train Loss: 0.827 Vali Loss: 5.454 Vali Acc: 0.121 Test Loss: 5.454 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.0166688
	speed: 0.1208s/iter; left time: 2098.4961s
	iters: 200, epoch: 17 | loss: 1.2948823
	speed: 0.0282s/iter; left time: 487.8923s
Epoch: 17 cost time: 6.310842990875244
Epoch: 17, Steps: 208 | Train Loss: 0.720 Vali Loss: 6.072 Vali Acc: 0.122 Test Loss: 6.072 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.7153571
	speed: 0.1187s/iter; left time: 2037.2926s
	iters: 200, epoch: 18 | loss: 0.7413347
	speed: 0.0253s/iter; left time: 432.1992s
Epoch: 18 cost time: 5.9149463176727295
Epoch: 18, Steps: 208 | Train Loss: 0.606 Vali Loss: 6.128 Vali Acc: 0.122 Test Loss: 6.128 Test Acc: 0.122
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.3460838
	speed: 0.1147s/iter; left time: 1944.4381s
	iters: 200, epoch: 19 | loss: 1.0609684
	speed: 0.0301s/iter; left time: 507.5331s
Epoch: 19 cost time: 6.5295069217681885
Epoch: 19, Steps: 208 | Train Loss: 0.523 Vali Loss: 6.222 Vali Acc: 0.124 Test Loss: 6.222 Test Acc: 0.124
Validation loss decreased (-0.123719 --> -0.124006).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.7212804
	speed: 0.1205s/iter; left time: 2017.6568s
	iters: 200, epoch: 20 | loss: 0.5333924
	speed: 0.0277s/iter; left time: 460.8065s
Epoch: 20 cost time: 6.0243823528289795
Epoch: 20, Steps: 208 | Train Loss: 0.461 Vali Loss: 6.883 Vali Acc: 0.119 Test Loss: 6.883 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.1802128
	speed: 0.1128s/iter; left time: 1866.1706s
	iters: 200, epoch: 21 | loss: 0.7846216
	speed: 0.0250s/iter; left time: 411.2629s
Epoch: 21 cost time: 5.5617616176605225
Epoch: 21, Steps: 208 | Train Loss: 0.442 Vali Loss: 6.842 Vali Acc: 0.114 Test Loss: 6.842 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.5271063
	speed: 0.0994s/iter; left time: 1623.2464s
	iters: 200, epoch: 22 | loss: 0.7282212
	speed: 0.0248s/iter; left time: 402.5577s
Epoch: 22 cost time: 5.353336811065674
Epoch: 22, Steps: 208 | Train Loss: 0.396 Vali Loss: 7.215 Vali Acc: 0.120 Test Loss: 7.215 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.3566137
	speed: 0.1127s/iter; left time: 1817.8661s
	iters: 200, epoch: 23 | loss: 0.6987724
	speed: 0.0244s/iter; left time: 391.0784s
Epoch: 23 cost time: 5.538191795349121
Epoch: 23, Steps: 208 | Train Loss: 0.363 Vali Loss: 7.592 Vali Acc: 0.113 Test Loss: 7.592 Test Acc: 0.113
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.6307594
	speed: 0.1003s/iter; left time: 1595.7158s
	iters: 200, epoch: 24 | loss: 0.3187091
	speed: 0.0250s/iter; left time: 394.7726s
Epoch: 24 cost time: 5.147103786468506
Epoch: 24, Steps: 208 | Train Loss: 0.356 Vali Loss: 7.870 Vali Acc: 0.113 Test Loss: 7.870 Test Acc: 0.113
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.3810126
	speed: 0.0672s/iter; left time: 1056.0679s
	iters: 200, epoch: 25 | loss: 0.1124457
	speed: 0.0178s/iter; left time: 277.2584s
Epoch: 25 cost time: 4.14154839515686
Epoch: 25, Steps: 208 | Train Loss: 0.328 Vali Loss: 8.068 Vali Acc: 0.117 Test Loss: 8.068 Test Acc: 0.117
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.2226362
	speed: 0.0784s/iter; left time: 1214.8217s
	iters: 200, epoch: 26 | loss: 0.2774315
	speed: 0.0242s/iter; left time: 373.0145s
Epoch: 26 cost time: 5.063832759857178
Epoch: 26, Steps: 208 | Train Loss: 0.319 Vali Loss: 8.106 Vali Acc: 0.119 Test Loss: 8.106 Test Acc: 0.119
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.9478780
	speed: 0.1048s/iter; left time: 1602.7651s
	iters: 200, epoch: 27 | loss: 0.4753348
	speed: 0.0243s/iter; left time: 368.8904s
Epoch: 27 cost time: 5.513651609420776
Epoch: 27, Steps: 208 | Train Loss: 0.315 Vali Loss: 8.276 Vali Acc: 0.118 Test Loss: 8.276 Test Acc: 0.118
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.1341225
	speed: 0.0998s/iter; left time: 1506.1219s
	iters: 200, epoch: 28 | loss: 0.5413097
	speed: 0.0247s/iter; left time: 370.5279s
Epoch: 28 cost time: 5.499505281448364
Epoch: 28, Steps: 208 | Train Loss: 0.285 Vali Loss: 8.138 Vali Acc: 0.116 Test Loss: 8.138 Test Acc: 0.116
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.5317236
	speed: 0.1049s/iter; left time: 1560.7769s
	iters: 200, epoch: 29 | loss: 0.2280703
	speed: 0.0241s/iter; left time: 356.2398s
Epoch: 29 cost time: 5.608317613601685
Epoch: 29, Steps: 208 | Train Loss: 0.266 Vali Loss: 8.709 Vali Acc: 0.126 Test Loss: 8.709 Test Acc: 0.126
Validation loss decreased (-0.124006 --> -0.126069).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.3091389
	speed: 0.0931s/iter; left time: 1365.5070s
	iters: 200, epoch: 30 | loss: 0.1071127
	speed: 0.0252s/iter; left time: 367.2584s
Epoch: 30 cost time: 5.689776182174683
Epoch: 30, Steps: 208 | Train Loss: 0.258 Vali Loss: 9.145 Vali Acc: 0.113 Test Loss: 9.145 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.2090847
	speed: 0.1072s/iter; left time: 1549.8712s
	iters: 200, epoch: 31 | loss: 0.2118460
	speed: 0.0259s/iter; left time: 371.9461s
Epoch: 31 cost time: 5.792109251022339
Epoch: 31, Steps: 208 | Train Loss: 0.237 Vali Loss: 9.067 Vali Acc: 0.113 Test Loss: 9.067 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0944830
	speed: 0.1085s/iter; left time: 1546.9126s
	iters: 200, epoch: 32 | loss: 0.2614056
	speed: 0.0261s/iter; left time: 369.7979s
Epoch: 32 cost time: 5.77435827255249
Epoch: 32, Steps: 208 | Train Loss: 0.228 Vali Loss: 9.193 Vali Acc: 0.110 Test Loss: 9.193 Test Acc: 0.110
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.1334343
	speed: 0.1055s/iter; left time: 1482.3509s
	iters: 200, epoch: 33 | loss: 0.1336642
	speed: 0.0264s/iter; left time: 367.5461s
Epoch: 33 cost time: 5.530656337738037
Epoch: 33, Steps: 208 | Train Loss: 0.235 Vali Loss: 9.629 Vali Acc: 0.114 Test Loss: 9.629 Test Acc: 0.114
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.0992534
	speed: 0.1044s/iter; left time: 1445.1495s
	iters: 200, epoch: 34 | loss: 0.1414659
	speed: 0.0280s/iter; left time: 384.4214s
Epoch: 34 cost time: 6.068912744522095
Epoch: 34, Steps: 208 | Train Loss: 0.216 Vali Loss: 9.825 Vali Acc: 0.118 Test Loss: 9.825 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.0435759
	speed: 0.1015s/iter; left time: 1383.5143s
	iters: 200, epoch: 35 | loss: 0.0806890
	speed: 0.0254s/iter; left time: 343.7375s
Epoch: 35 cost time: 5.7959980964660645
Epoch: 35, Steps: 208 | Train Loss: 0.204 Vali Loss: 10.216 Vali Acc: 0.118 Test Loss: 10.216 Test Acc: 0.118
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.6073255
	speed: 0.1083s/iter; left time: 1452.9035s
	iters: 200, epoch: 36 | loss: 0.0237174
	speed: 0.0250s/iter; left time: 332.5745s
Epoch: 36 cost time: 5.7344770431518555
Epoch: 36, Steps: 208 | Train Loss: 0.207 Vali Loss: 9.968 Vali Acc: 0.124 Test Loss: 9.968 Test Acc: 0.124
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 0.0564170
	speed: 0.1063s/iter; left time: 1404.3778s
	iters: 200, epoch: 37 | loss: 0.1939000
	speed: 0.0255s/iter; left time: 334.9841s
Epoch: 37 cost time: 5.79006552696228
Epoch: 37, Steps: 208 | Train Loss: 0.213 Vali Loss: 10.260 Vali Acc: 0.123 Test Loss: 10.260 Test Acc: 0.123
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 0.0156888
	speed: 0.1132s/iter; left time: 1472.1618s
	iters: 200, epoch: 38 | loss: 0.2916906
	speed: 0.0278s/iter; left time: 358.3446s
Epoch: 38 cost time: 5.760223150253296
Epoch: 38, Steps: 208 | Train Loss: 0.224 Vali Loss: 10.459 Vali Acc: 0.115 Test Loss: 10.459 Test Acc: 0.115
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 0.1621758
	speed: 0.1252s/iter; left time: 1601.9672s
	iters: 200, epoch: 39 | loss: 0.0619324
	speed: 0.0280s/iter; left time: 355.3957s
Epoch: 39 cost time: 6.399906635284424
Epoch: 39, Steps: 208 | Train Loss: 0.217 Vali Loss: 10.002 Vali Acc: 0.121 Test Loss: 10.002 Test Acc: 0.121
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12615568147927228
model parameter : 372447
model size : 2.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7955692
	speed: 0.0438s/iter; left time: 906.2196s
	iters: 200, epoch: 1 | loss: 4.1274443
	speed: 0.0268s/iter; left time: 551.3434s
Epoch: 1 cost time: 7.342753648757935
Epoch: 1, Steps: 208 | Train Loss: 3.875 Vali Loss: 3.985 Vali Acc: 0.040 Test Loss: 3.985 Test Acc: 0.040
Validation loss decreased (inf --> -0.039626).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.5465765
	speed: 0.1214s/iter; left time: 2488.2199s
	iters: 200, epoch: 2 | loss: 4.2520070
	speed: 0.0267s/iter; left time: 545.2190s
Epoch: 2 cost time: 6.067071437835693
Epoch: 2, Steps: 208 | Train Loss: 3.947 Vali Loss: 4.132 Vali Acc: 0.058 Test Loss: 4.132 Test Acc: 0.058
Validation loss decreased (-0.039626 --> -0.058414).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.5389457
	speed: 0.1154s/iter; left time: 2341.1621s
	iters: 200, epoch: 3 | loss: 3.4929664
	speed: 0.0275s/iter; left time: 555.9870s
Epoch: 3 cost time: 6.223681449890137
Epoch: 3, Steps: 208 | Train Loss: 3.921 Vali Loss: 4.565 Vali Acc: 0.040 Test Loss: 4.565 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 3.3122950
	speed: 0.1103s/iter; left time: 2215.1942s
	iters: 200, epoch: 4 | loss: 3.6148384
	speed: 0.0244s/iter; left time: 487.0583s
Epoch: 4 cost time: 5.666989803314209
Epoch: 4, Steps: 208 | Train Loss: 3.691 Vali Loss: 4.021 Vali Acc: 0.051 Test Loss: 4.021 Test Acc: 0.051
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 3.2084818
	speed: 0.0960s/iter; left time: 1907.5935s
	iters: 200, epoch: 5 | loss: 3.2887061
	speed: 0.0269s/iter; left time: 531.1330s
Epoch: 5 cost time: 5.910529375076294
Epoch: 5, Steps: 208 | Train Loss: 3.384 Vali Loss: 3.777 Vali Acc: 0.058 Test Loss: 3.777 Test Acc: 0.058
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 3.3313866
	speed: 0.1108s/iter; left time: 2178.9921s
	iters: 200, epoch: 6 | loss: 3.3228271
	speed: 0.0236s/iter; left time: 460.8826s
Epoch: 6 cost time: 5.551185369491577
Epoch: 6, Steps: 208 | Train Loss: 3.078 Vali Loss: 3.525 Vali Acc: 0.086 Test Loss: 3.525 Test Acc: 0.086
Validation loss decreased (-0.058414 --> -0.086454).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.3151848
	speed: 0.1082s/iter; left time: 2105.4435s
	iters: 200, epoch: 7 | loss: 3.1580307
	speed: 0.0251s/iter; left time: 484.9887s
Epoch: 7 cost time: 5.5714123249053955
Epoch: 7, Steps: 208 | Train Loss: 2.764 Vali Loss: 3.551 Vali Acc: 0.083 Test Loss: 3.551 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.4489849
	speed: 0.1087s/iter; left time: 2092.6452s
	iters: 200, epoch: 8 | loss: 2.2893021
	speed: 0.0259s/iter; left time: 496.5403s
Epoch: 8 cost time: 5.833701133728027
Epoch: 8, Steps: 208 | Train Loss: 2.497 Vali Loss: 3.623 Vali Acc: 0.103 Test Loss: 3.623 Test Acc: 0.103
Validation loss decreased (-0.086454 --> -0.103453).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.5902023
	speed: 0.1054s/iter; left time: 2007.1072s
	iters: 200, epoch: 9 | loss: 1.6410891
	speed: 0.0257s/iter; left time: 487.3814s
Epoch: 9 cost time: 5.673597574234009
Epoch: 9, Steps: 208 | Train Loss: 2.233 Vali Loss: 3.772 Vali Acc: 0.105 Test Loss: 3.772 Test Acc: 0.105
Validation loss decreased (-0.103453 --> -0.105241).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5464678
	speed: 0.1055s/iter; left time: 1986.8511s
	iters: 200, epoch: 10 | loss: 2.7200334
	speed: 0.0262s/iter; left time: 490.2095s
Epoch: 10 cost time: 5.788778066635132
Epoch: 10, Steps: 208 | Train Loss: 1.958 Vali Loss: 3.858 Vali Acc: 0.111 Test Loss: 3.858 Test Acc: 0.111
Validation loss decreased (-0.105241 --> -0.111205).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.2726468
	speed: 0.1020s/iter; left time: 1899.3976s
	iters: 200, epoch: 11 | loss: 1.1953936
	speed: 0.0240s/iter; left time: 444.3606s
Epoch: 11 cost time: 5.457197427749634
Epoch: 11, Steps: 208 | Train Loss: 1.676 Vali Loss: 4.240 Vali Acc: 0.102 Test Loss: 4.240 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.9379348
	speed: 0.1078s/iter; left time: 1984.6680s
	iters: 200, epoch: 12 | loss: 1.3928118
	speed: 0.0258s/iter; left time: 472.4931s
Epoch: 12 cost time: 5.6733245849609375
Epoch: 12, Steps: 208 | Train Loss: 1.454 Vali Loss: 4.382 Vali Acc: 0.105 Test Loss: 4.382 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.0752764
	speed: 0.1119s/iter; left time: 2037.4098s
	iters: 200, epoch: 13 | loss: 0.9118979
	speed: 0.0262s/iter; left time: 474.3074s
Epoch: 13 cost time: 5.811235666275024
Epoch: 13, Steps: 208 | Train Loss: 1.197 Vali Loss: 4.782 Vali Acc: 0.109 Test Loss: 4.782 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.9427484
	speed: 0.1062s/iter; left time: 1911.8343s
	iters: 200, epoch: 14 | loss: 1.4016042
	speed: 0.0251s/iter; left time: 449.7401s
Epoch: 14 cost time: 5.565009117126465
Epoch: 14, Steps: 208 | Train Loss: 1.029 Vali Loss: 5.159 Vali Acc: 0.107 Test Loss: 5.159 Test Acc: 0.107
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.0856329
	speed: 0.1005s/iter; left time: 1788.4493s
	iters: 200, epoch: 15 | loss: 0.9132327
	speed: 0.0263s/iter; left time: 465.6499s
Epoch: 15 cost time: 5.802675485610962
Epoch: 15, Steps: 208 | Train Loss: 0.858 Vali Loss: 5.374 Vali Acc: 0.108 Test Loss: 5.374 Test Acc: 0.108
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.3215362
	speed: 0.1012s/iter; left time: 1779.1882s
	iters: 200, epoch: 16 | loss: 0.6216992
	speed: 0.0261s/iter; left time: 456.5563s
Epoch: 16 cost time: 5.611125230789185
Epoch: 16, Steps: 208 | Train Loss: 0.733 Vali Loss: 5.788 Vali Acc: 0.112 Test Loss: 5.788 Test Acc: 0.112
Validation loss decreased (-0.111205 --> -0.111484).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.2830477
	speed: 0.1210s/iter; left time: 2101.3755s
	iters: 200, epoch: 17 | loss: 1.1600291
	speed: 0.0237s/iter; left time: 409.0801s
Epoch: 17 cost time: 5.592865228652954
Epoch: 17, Steps: 208 | Train Loss: 0.621 Vali Loss: 6.077 Vali Acc: 0.104 Test Loss: 6.077 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.5485195
	speed: 0.1079s/iter; left time: 1852.1443s
	iters: 200, epoch: 18 | loss: 1.0462581
	speed: 0.0255s/iter; left time: 435.1055s
Epoch: 18 cost time: 5.6862335205078125
Epoch: 18, Steps: 208 | Train Loss: 0.565 Vali Loss: 6.281 Vali Acc: 0.105 Test Loss: 6.281 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.3396084
	speed: 0.1081s/iter; left time: 1833.2742s
	iters: 200, epoch: 19 | loss: 0.3878306
	speed: 0.0244s/iter; left time: 410.6426s
Epoch: 19 cost time: 5.600705862045288
Epoch: 19, Steps: 208 | Train Loss: 0.496 Vali Loss: 6.516 Vali Acc: 0.106 Test Loss: 6.516 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.7858366
	speed: 0.1002s/iter; left time: 1678.9683s
	iters: 200, epoch: 20 | loss: 0.3738500
	speed: 0.0269s/iter; left time: 447.0695s
Epoch: 20 cost time: 5.95224928855896
Epoch: 20, Steps: 208 | Train Loss: 0.471 Vali Loss: 6.864 Vali Acc: 0.112 Test Loss: 6.864 Test Acc: 0.112
Validation loss decreased (-0.111484 --> -0.111772).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.3134332
	speed: 0.1100s/iter; left time: 1819.1472s
	iters: 200, epoch: 21 | loss: 0.4428755
	speed: 0.0260s/iter; left time: 427.0974s
Epoch: 21 cost time: 5.846874237060547
Epoch: 21, Steps: 208 | Train Loss: 0.392 Vali Loss: 7.217 Vali Acc: 0.100 Test Loss: 7.217 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0853409
	speed: 0.1212s/iter; left time: 1979.0013s
	iters: 200, epoch: 22 | loss: 0.5462811
	speed: 0.0273s/iter; left time: 443.0652s
Epoch: 22 cost time: 6.25766134262085
Epoch: 22, Steps: 208 | Train Loss: 0.380 Vali Loss: 7.310 Vali Acc: 0.105 Test Loss: 7.310 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.4213398
	speed: 0.1150s/iter; left time: 1854.4953s
	iters: 200, epoch: 23 | loss: 0.8060935
	speed: 0.0289s/iter; left time: 463.9229s
Epoch: 23 cost time: 6.360905885696411
Epoch: 23, Steps: 208 | Train Loss: 0.363 Vali Loss: 7.663 Vali Acc: 0.108 Test Loss: 7.663 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.4235426
	speed: 0.1246s/iter; left time: 1983.0258s
	iters: 200, epoch: 24 | loss: 0.1738654
	speed: 0.0276s/iter; left time: 436.5399s
Epoch: 24 cost time: 6.358302354812622
Epoch: 24, Steps: 208 | Train Loss: 0.334 Vali Loss: 7.825 Vali Acc: 0.098 Test Loss: 7.825 Test Acc: 0.098
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.3460265
	speed: 0.1155s/iter; left time: 1813.9336s
	iters: 200, epoch: 25 | loss: 0.0221428
	speed: 0.0279s/iter; left time: 435.3657s
Epoch: 25 cost time: 6.268744468688965
Epoch: 25, Steps: 208 | Train Loss: 0.303 Vali Loss: 8.361 Vali Acc: 0.101 Test Loss: 8.361 Test Acc: 0.101
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.3723943
	speed: 0.1208s/iter; left time: 1872.8749s
	iters: 200, epoch: 26 | loss: 0.0987554
	speed: 0.0261s/iter; left time: 401.5961s
Epoch: 26 cost time: 6.044140338897705
Epoch: 26, Steps: 208 | Train Loss: 0.277 Vali Loss: 8.407 Vali Acc: 0.103 Test Loss: 8.407 Test Acc: 0.103
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.1963534
	speed: 0.1288s/iter; left time: 1969.4063s
	iters: 200, epoch: 27 | loss: 0.0594498
	speed: 0.0250s/iter; left time: 379.7287s
Epoch: 27 cost time: 5.952669620513916
Epoch: 27, Steps: 208 | Train Loss: 0.282 Vali Loss: 8.528 Vali Acc: 0.107 Test Loss: 8.528 Test Acc: 0.107
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.4066613
	speed: 0.1076s/iter; left time: 1623.2801s
	iters: 200, epoch: 28 | loss: 0.5571029
	speed: 0.0266s/iter; left time: 399.3032s
Epoch: 28 cost time: 5.988083124160767
Epoch: 28, Steps: 208 | Train Loss: 0.268 Vali Loss: 8.641 Vali Acc: 0.097 Test Loss: 8.641 Test Acc: 0.097
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0774023
	speed: 0.1016s/iter; left time: 1511.9480s
	iters: 200, epoch: 29 | loss: 0.3193891
	speed: 0.0257s/iter; left time: 380.1424s
Epoch: 29 cost time: 5.762694358825684
Epoch: 29, Steps: 208 | Train Loss: 0.236 Vali Loss: 8.884 Vali Acc: 0.096 Test Loss: 8.884 Test Acc: 0.096
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.2290461
	speed: 0.1024s/iter; left time: 1502.1555s
	iters: 200, epoch: 30 | loss: 0.1478170
	speed: 0.0252s/iter; left time: 367.0980s
Epoch: 30 cost time: 5.62064790725708
Epoch: 30, Steps: 208 | Train Loss: 0.229 Vali Loss: 9.300 Vali Acc: 0.106 Test Loss: 9.300 Test Acc: 0.106
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11184014315538324
model parameter : 371839
model size : 2.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.7381353
	speed: 0.0407s/iter; left time: 842.6332s
	iters: 200, epoch: 1 | loss: 3.8268652
	speed: 0.0240s/iter; left time: 493.9447s
Epoch: 1 cost time: 6.758730173110962
Epoch: 1, Steps: 208 | Train Loss: 3.876 Vali Loss: 3.992 Vali Acc: 0.052 Test Loss: 3.992 Test Acc: 0.052
Validation loss decreased (inf --> -0.052152).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.7401936
	speed: 0.0980s/iter; left time: 2008.1907s
	iters: 200, epoch: 2 | loss: 3.6474700
	speed: 0.0262s/iter; left time: 534.2012s
Epoch: 2 cost time: 5.965149641036987
Epoch: 2, Steps: 208 | Train Loss: 3.947 Vali Loss: 4.367 Vali Acc: 0.046 Test Loss: 4.367 Test Acc: 0.046
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.3869014
	speed: 0.1050s/iter; left time: 2129.2831s
	iters: 200, epoch: 3 | loss: 4.2672906
	speed: 0.0256s/iter; left time: 516.7697s
Epoch: 3 cost time: 5.657559394836426
Epoch: 3, Steps: 208 | Train Loss: 3.917 Vali Loss: 4.139 Vali Acc: 0.053 Test Loss: 4.139 Test Acc: 0.053
Validation loss decreased (-0.052152 --> -0.053045).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.8389006
	speed: 0.1084s/iter; left time: 2175.8983s
	iters: 200, epoch: 4 | loss: 3.4731286
	speed: 0.0252s/iter; left time: 502.4370s
Epoch: 4 cost time: 5.7136070728302
Epoch: 4, Steps: 208 | Train Loss: 3.700 Vali Loss: 3.775 Vali Acc: 0.064 Test Loss: 3.775 Test Acc: 0.064
Validation loss decreased (-0.053045 --> -0.064382).  Saving model ...
	iters: 100, epoch: 5 | loss: 4.0255089
	speed: 0.1060s/iter; left time: 2106.0650s
	iters: 200, epoch: 5 | loss: 2.8116851
	speed: 0.0256s/iter; left time: 505.1306s
Epoch: 5 cost time: 5.5181944370269775
Epoch: 5, Steps: 208 | Train Loss: 3.357 Vali Loss: 3.626 Vali Acc: 0.074 Test Loss: 3.626 Test Acc: 0.074
Validation loss decreased (-0.064382 --> -0.073629).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.8793323
	speed: 0.1009s/iter; left time: 1984.6664s
	iters: 200, epoch: 6 | loss: 2.8562527
	speed: 0.0255s/iter; left time: 499.0411s
Epoch: 6 cost time: 5.357357740402222
Epoch: 6, Steps: 208 | Train Loss: 3.057 Vali Loss: 3.496 Vali Acc: 0.083 Test Loss: 3.496 Test Acc: 0.083
Validation loss decreased (-0.073629 --> -0.083174).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.8436315
	speed: 0.1044s/iter; left time: 2030.7905s
	iters: 200, epoch: 7 | loss: 3.1822405
	speed: 0.0247s/iter; left time: 477.4411s
Epoch: 7 cost time: 5.538228273391724
Epoch: 7, Steps: 208 | Train Loss: 2.789 Vali Loss: 3.503 Vali Acc: 0.091 Test Loss: 3.503 Test Acc: 0.091
Validation loss decreased (-0.083174 --> -0.090928).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.2498722
	speed: 0.0983s/iter; left time: 1892.5656s
	iters: 200, epoch: 8 | loss: 2.8282201
	speed: 0.0257s/iter; left time: 491.0915s
Epoch: 8 cost time: 5.4945361614227295
Epoch: 8, Steps: 208 | Train Loss: 2.531 Vali Loss: 3.599 Vali Acc: 0.096 Test Loss: 3.599 Test Acc: 0.096
Validation loss decreased (-0.090928 --> -0.095699).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.8440249
	speed: 0.1080s/iter; left time: 2056.1297s
	iters: 200, epoch: 9 | loss: 2.5372450
	speed: 0.0258s/iter; left time: 488.9332s
Epoch: 9 cost time: 5.883087158203125
Epoch: 9, Steps: 208 | Train Loss: 2.271 Vali Loss: 3.671 Vali Acc: 0.103 Test Loss: 3.671 Test Acc: 0.103
Validation loss decreased (-0.095699 --> -0.103154).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.1880352
	speed: 0.1100s/iter; left time: 2070.7317s
	iters: 200, epoch: 10 | loss: 2.6042528
	speed: 0.0274s/iter; left time: 512.4351s
Epoch: 10 cost time: 6.03437352180481
Epoch: 10, Steps: 208 | Train Loss: 2.008 Vali Loss: 3.813 Vali Acc: 0.097 Test Loss: 3.813 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.6877159
	speed: 0.1151s/iter; left time: 2144.0645s
	iters: 200, epoch: 11 | loss: 1.8648245
	speed: 0.0238s/iter; left time: 440.7255s
Epoch: 11 cost time: 5.605904817581177
Epoch: 11, Steps: 208 | Train Loss: 1.746 Vali Loss: 4.070 Vali Acc: 0.101 Test Loss: 4.070 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 2.0632806
	speed: 0.1113s/iter; left time: 2048.5724s
	iters: 200, epoch: 12 | loss: 1.4492929
	speed: 0.0259s/iter; left time: 474.4815s
Epoch: 12 cost time: 5.757053852081299
Epoch: 12, Steps: 208 | Train Loss: 1.510 Vali Loss: 4.333 Vali Acc: 0.104 Test Loss: 4.333 Test Acc: 0.104
Validation loss decreased (-0.103154 --> -0.104341).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.2473308
	speed: 0.0975s/iter; left time: 1774.9649s
	iters: 200, epoch: 13 | loss: 1.3461906
	speed: 0.0232s/iter; left time: 420.8707s
Epoch: 13 cost time: 5.450559139251709
Epoch: 13, Steps: 208 | Train Loss: 1.261 Vali Loss: 4.758 Vali Acc: 0.106 Test Loss: 4.758 Test Acc: 0.106
Validation loss decreased (-0.104341 --> -0.106126).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.0931268
	speed: 0.1220s/iter; left time: 2196.0479s
	iters: 200, epoch: 14 | loss: 1.5432169
	speed: 0.0257s/iter; left time: 459.3099s
Epoch: 14 cost time: 6.226567029953003
Epoch: 14, Steps: 208 | Train Loss: 1.066 Vali Loss: 5.033 Vali Acc: 0.117 Test Loss: 5.033 Test Acc: 0.117
Validation loss decreased (-0.106126 --> -0.116860).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.8510529
	speed: 0.1232s/iter; left time: 2190.8796s
	iters: 200, epoch: 15 | loss: 0.9705731
	speed: 0.0300s/iter; left time: 531.5491s
Epoch: 15 cost time: 6.524351119995117
Epoch: 15, Steps: 208 | Train Loss: 0.878 Vali Loss: 5.566 Vali Acc: 0.112 Test Loss: 5.566 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.5808517
	speed: 0.1336s/iter; left time: 2348.9801s
	iters: 200, epoch: 16 | loss: 0.6839694
	speed: 0.0275s/iter; left time: 480.0687s
Epoch: 16 cost time: 6.354218244552612
Epoch: 16, Steps: 208 | Train Loss: 0.761 Vali Loss: 5.563 Vali Acc: 0.115 Test Loss: 5.563 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.6282851
	speed: 0.1249s/iter; left time: 2170.1687s
	iters: 200, epoch: 17 | loss: 0.7224814
	speed: 0.0268s/iter; left time: 462.1020s
Epoch: 17 cost time: 6.197805404663086
Epoch: 17, Steps: 208 | Train Loss: 0.647 Vali Loss: 6.044 Vali Acc: 0.120 Test Loss: 6.044 Test Acc: 0.120
Validation loss decreased (-0.116860 --> -0.120130).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.3346418
	speed: 0.1122s/iter; left time: 1925.6966s
	iters: 200, epoch: 18 | loss: 1.0026536
	speed: 0.0263s/iter; left time: 448.0939s
Epoch: 18 cost time: 5.532171010971069
Epoch: 18, Steps: 208 | Train Loss: 0.561 Vali Loss: 6.642 Vali Acc: 0.113 Test Loss: 6.642 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.5336026
	speed: 0.0967s/iter; left time: 1639.3659s
	iters: 200, epoch: 19 | loss: 0.5290149
	speed: 0.0189s/iter; left time: 318.7187s
Epoch: 19 cost time: 4.601467847824097
Epoch: 19, Steps: 208 | Train Loss: 0.487 Vali Loss: 6.766 Vali Acc: 0.111 Test Loss: 6.766 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.3818219
	speed: 0.0827s/iter; left time: 1385.8063s
	iters: 200, epoch: 20 | loss: 0.6141004
	speed: 0.0240s/iter; left time: 398.7504s
Epoch: 20 cost time: 5.343411684036255
Epoch: 20, Steps: 208 | Train Loss: 0.438 Vali Loss: 7.103 Vali Acc: 0.110 Test Loss: 7.103 Test Acc: 0.110
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.2135268
	speed: 0.1020s/iter; left time: 1687.9024s
	iters: 200, epoch: 21 | loss: 0.5632635
	speed: 0.0255s/iter; left time: 419.3215s
Epoch: 21 cost time: 5.327766418457031
Epoch: 21, Steps: 208 | Train Loss: 0.412 Vali Loss: 7.425 Vali Acc: 0.102 Test Loss: 7.425 Test Acc: 0.102
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.2284374
	speed: 0.1108s/iter; left time: 1810.2201s
	iters: 200, epoch: 22 | loss: 0.1057000
	speed: 0.0241s/iter; left time: 390.8817s
Epoch: 22 cost time: 5.4774298667907715
Epoch: 22, Steps: 208 | Train Loss: 0.389 Vali Loss: 7.571 Vali Acc: 0.112 Test Loss: 7.571 Test Acc: 0.112
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.2427111
	speed: 0.0911s/iter; left time: 1468.8395s
	iters: 200, epoch: 23 | loss: 0.5578450
	speed: 0.0252s/iter; left time: 403.2394s
Epoch: 23 cost time: 5.534292697906494
Epoch: 23, Steps: 208 | Train Loss: 0.358 Vali Loss: 7.910 Vali Acc: 0.106 Test Loss: 7.910 Test Acc: 0.106
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.1604137
	speed: 0.1093s/iter; left time: 1739.2311s
	iters: 200, epoch: 24 | loss: 0.1112613
	speed: 0.0233s/iter; left time: 368.1784s
Epoch: 24 cost time: 5.598403453826904
Epoch: 24, Steps: 208 | Train Loss: 0.327 Vali Loss: 8.249 Vali Acc: 0.111 Test Loss: 8.249 Test Acc: 0.111
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.2318730
	speed: 0.1093s/iter; left time: 1717.6131s
	iters: 200, epoch: 25 | loss: 0.6604110
	speed: 0.0244s/iter; left time: 380.5831s
Epoch: 25 cost time: 5.457647085189819
Epoch: 25, Steps: 208 | Train Loss: 0.310 Vali Loss: 8.363 Vali Acc: 0.114 Test Loss: 8.363 Test Acc: 0.114
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.7033197
	speed: 0.1092s/iter; left time: 1692.6857s
	iters: 200, epoch: 26 | loss: 0.3673782
	speed: 0.0257s/iter; left time: 396.0130s
Epoch: 26 cost time: 5.555425643920898
Epoch: 26, Steps: 208 | Train Loss: 0.289 Vali Loss: 8.626 Vali Acc: 0.120 Test Loss: 8.626 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.1005018
	speed: 0.0891s/iter; left time: 1362.5319s
	iters: 200, epoch: 27 | loss: 0.6471347
	speed: 0.0265s/iter; left time: 402.5094s
Epoch: 27 cost time: 5.665553569793701
Epoch: 27, Steps: 208 | Train Loss: 0.284 Vali Loss: 8.836 Vali Acc: 0.116 Test Loss: 8.836 Test Acc: 0.116
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12019087384431852
model parameter : 371231
model size : 2.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8346715
	speed: 0.0405s/iter; left time: 837.6476s
	iters: 200, epoch: 1 | loss: 4.2685852
	speed: 0.0241s/iter; left time: 496.1001s
Epoch: 1 cost time: 6.707146644592285
Epoch: 1, Steps: 208 | Train Loss: 3.884 Vali Loss: 3.816 Vali Acc: 0.052 Test Loss: 3.816 Test Acc: 0.052
Validation loss decreased (inf --> -0.051557).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.6865346
	speed: 0.1101s/iter; left time: 2256.0796s
	iters: 200, epoch: 2 | loss: 4.3501630
	speed: 0.0255s/iter; left time: 519.2391s
Epoch: 2 cost time: 5.715078115463257
Epoch: 2, Steps: 208 | Train Loss: 3.923 Vali Loss: 4.056 Vali Acc: 0.052 Test Loss: 4.056 Test Acc: 0.052
Validation loss decreased (-0.051557 --> -0.052152).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.2618108
	speed: 0.0994s/iter; left time: 2016.2071s
	iters: 200, epoch: 3 | loss: 3.7065899
	speed: 0.0270s/iter; left time: 544.5881s
Epoch: 3 cost time: 5.883824348449707
Epoch: 3, Steps: 208 | Train Loss: 3.935 Vali Loss: 4.083 Vali Acc: 0.061 Test Loss: 4.083 Test Acc: 0.061
Validation loss decreased (-0.052152 --> -0.060800).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.4751182
	speed: 0.1075s/iter; left time: 2158.6591s
	iters: 200, epoch: 4 | loss: 3.7854512
	speed: 0.0249s/iter; left time: 496.4706s
Epoch: 4 cost time: 5.4722371101379395
Epoch: 4, Steps: 208 | Train Loss: 3.683 Vali Loss: 3.885 Vali Acc: 0.049 Test Loss: 3.885 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.4765961
	speed: 0.1038s/iter; left time: 2062.5922s
	iters: 200, epoch: 5 | loss: 4.2660279
	speed: 0.0240s/iter; left time: 473.5014s
Epoch: 5 cost time: 5.5152952671051025
Epoch: 5, Steps: 208 | Train Loss: 3.387 Vali Loss: 3.663 Vali Acc: 0.067 Test Loss: 3.663 Test Acc: 0.067
Validation loss decreased (-0.060800 --> -0.066471).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.6056716
	speed: 0.1046s/iter; left time: 2056.7904s
	iters: 200, epoch: 6 | loss: 3.5239723
	speed: 0.0258s/iter; left time: 504.3674s
Epoch: 6 cost time: 5.8196961879730225
Epoch: 6, Steps: 208 | Train Loss: 3.128 Vali Loss: 3.616 Vali Acc: 0.074 Test Loss: 3.616 Test Acc: 0.074
Validation loss decreased (-0.066471 --> -0.073629).  Saving model ...
	iters: 100, epoch: 7 | loss: 3.1440630
	speed: 0.1060s/iter; left time: 2062.4248s
	iters: 200, epoch: 7 | loss: 3.2689478
	speed: 0.0241s/iter; left time: 467.3586s
Epoch: 7 cost time: 5.656142950057983
Epoch: 7, Steps: 208 | Train Loss: 2.823 Vali Loss: 3.633 Vali Acc: 0.081 Test Loss: 3.633 Test Acc: 0.081
Validation loss decreased (-0.073629 --> -0.081085).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.5638802
	speed: 0.1098s/iter; left time: 2113.0446s
	iters: 200, epoch: 8 | loss: 2.6657796
	speed: 0.0243s/iter; left time: 465.4643s
Epoch: 8 cost time: 5.435781240463257
Epoch: 8, Steps: 208 | Train Loss: 2.570 Vali Loss: 3.669 Vali Acc: 0.089 Test Loss: 3.669 Test Acc: 0.089
Validation loss decreased (-0.081085 --> -0.089435).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.8637325
	speed: 0.1183s/iter; left time: 2251.1890s
	iters: 200, epoch: 9 | loss: 2.7461460
	speed: 0.0298s/iter; left time: 563.4280s
Epoch: 9 cost time: 6.448595285415649
Epoch: 9, Steps: 208 | Train Loss: 2.302 Vali Loss: 3.790 Vali Acc: 0.094 Test Loss: 3.790 Test Acc: 0.094
Validation loss decreased (-0.089435 --> -0.094206).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.3718905
	speed: 0.1051s/iter; left time: 1978.7906s
	iters: 200, epoch: 10 | loss: 2.4655895
	speed: 0.0289s/iter; left time: 540.4300s
Epoch: 10 cost time: 6.295046091079712
Epoch: 10, Steps: 208 | Train Loss: 2.034 Vali Loss: 3.966 Vali Acc: 0.102 Test Loss: 3.966 Test Acc: 0.102
Validation loss decreased (-0.094206 --> -0.101660).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.0203485
	speed: 0.1183s/iter; left time: 2202.9272s
	iters: 200, epoch: 11 | loss: 2.0999258
	speed: 0.0276s/iter; left time: 511.7769s
Epoch: 11 cost time: 6.19171404838562
Epoch: 11, Steps: 208 | Train Loss: 1.792 Vali Loss: 4.059 Vali Acc: 0.102 Test Loss: 4.059 Test Acc: 0.102
Validation loss decreased (-0.101660 --> -0.101958).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.6401894
	speed: 0.1178s/iter; left time: 2169.4365s
	iters: 200, epoch: 12 | loss: 1.4137942
	speed: 0.0276s/iter; left time: 504.5383s
Epoch: 12 cost time: 6.333536863327026
Epoch: 12, Steps: 208 | Train Loss: 1.508 Vali Loss: 4.529 Vali Acc: 0.103 Test Loss: 4.529 Test Acc: 0.103
Validation loss decreased (-0.101958 --> -0.103444).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.4097221
	speed: 0.1275s/iter; left time: 2321.5415s
	iters: 200, epoch: 13 | loss: 1.5371304
	speed: 0.0290s/iter; left time: 524.3320s
Epoch: 13 cost time: 6.424467325210571
Epoch: 13, Steps: 208 | Train Loss: 1.290 Vali Loss: 4.741 Vali Acc: 0.102 Test Loss: 4.741 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.4796966
	speed: 0.1152s/iter; left time: 2072.8501s
	iters: 200, epoch: 14 | loss: 1.1126078
	speed: 0.0288s/iter; left time: 515.0931s
Epoch: 14 cost time: 6.236661911010742
Epoch: 14, Steps: 208 | Train Loss: 1.067 Vali Loss: 5.042 Vali Acc: 0.111 Test Loss: 5.042 Test Acc: 0.111
Validation loss decreased (-0.103444 --> -0.110597).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.2402843
	speed: 0.1180s/iter; left time: 2098.6714s
	iters: 200, epoch: 15 | loss: 1.1444190
	speed: 0.0255s/iter; left time: 451.5667s
Epoch: 15 cost time: 5.914393663406372
Epoch: 15, Steps: 208 | Train Loss: 0.907 Vali Loss: 5.327 Vali Acc: 0.098 Test Loss: 5.327 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.5937487
	speed: 0.1089s/iter; left time: 1914.9102s
	iters: 200, epoch: 16 | loss: 0.8277795
	speed: 0.0241s/iter; left time: 420.4968s
Epoch: 16 cost time: 5.613894462585449
Epoch: 16, Steps: 208 | Train Loss: 0.768 Vali Loss: 5.754 Vali Acc: 0.112 Test Loss: 5.754 Test Acc: 0.112
Validation loss decreased (-0.110597 --> -0.111484).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.0436844
	speed: 0.1109s/iter; left time: 1926.4101s
	iters: 200, epoch: 17 | loss: 0.5150517
	speed: 0.0259s/iter; left time: 447.7648s
Epoch: 17 cost time: 5.70457911491394
Epoch: 17, Steps: 208 | Train Loss: 0.662 Vali Loss: 6.071 Vali Acc: 0.104 Test Loss: 6.071 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.7414233
	speed: 0.1045s/iter; left time: 1792.9146s
	iters: 200, epoch: 18 | loss: 0.8012678
	speed: 0.0244s/iter; left time: 416.3592s
Epoch: 18 cost time: 5.711052894592285
Epoch: 18, Steps: 208 | Train Loss: 0.588 Vali Loss: 6.183 Vali Acc: 0.109 Test Loss: 6.183 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.5676395
	speed: 0.1137s/iter; left time: 1928.5284s
	iters: 200, epoch: 19 | loss: 1.0433882
	speed: 0.0243s/iter; left time: 409.2357s
Epoch: 19 cost time: 5.6710004806518555
Epoch: 19, Steps: 208 | Train Loss: 0.519 Vali Loss: 6.659 Vali Acc: 0.119 Test Loss: 6.659 Test Acc: 0.119
Validation loss decreased (-0.111484 --> -0.118633).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.7416196
	speed: 0.0872s/iter; left time: 1461.0552s
	iters: 200, epoch: 20 | loss: 0.3975937
	speed: 0.0191s/iter; left time: 318.6165s
Epoch: 20 cost time: 4.413905143737793
Epoch: 20, Steps: 208 | Train Loss: 0.472 Vali Loss: 6.892 Vali Acc: 0.099 Test Loss: 6.892 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.2960166
	speed: 0.0782s/iter; left time: 1294.2282s
	iters: 200, epoch: 21 | loss: 0.8097228
	speed: 0.0204s/iter; left time: 335.3817s
Epoch: 21 cost time: 4.768735408782959
Epoch: 21, Steps: 208 | Train Loss: 0.454 Vali Loss: 7.245 Vali Acc: 0.106 Test Loss: 7.245 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.7144402
	speed: 0.1011s/iter; left time: 1650.5242s
	iters: 200, epoch: 22 | loss: 0.4657470
	speed: 0.0248s/iter; left time: 401.8545s
Epoch: 22 cost time: 5.621539831161499
Epoch: 22, Steps: 208 | Train Loss: 0.408 Vali Loss: 7.357 Vali Acc: 0.106 Test Loss: 7.357 Test Acc: 0.106
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.7591230
	speed: 0.1081s/iter; left time: 1743.3008s
	iters: 200, epoch: 23 | loss: 0.4569602
	speed: 0.0248s/iter; left time: 397.4466s
Epoch: 23 cost time: 5.6801598072052
Epoch: 23, Steps: 208 | Train Loss: 0.380 Vali Loss: 7.565 Vali Acc: 0.108 Test Loss: 7.565 Test Acc: 0.108
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0122334
	speed: 0.1077s/iter; left time: 1714.5476s
	iters: 200, epoch: 24 | loss: 0.5092541
	speed: 0.0247s/iter; left time: 391.4194s
Epoch: 24 cost time: 5.6294238567352295
Epoch: 24, Steps: 208 | Train Loss: 0.361 Vali Loss: 7.646 Vali Acc: 0.112 Test Loss: 7.646 Test Acc: 0.112
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.1477405
	speed: 0.1084s/iter; left time: 1702.5176s
	iters: 200, epoch: 25 | loss: 0.2434591
	speed: 0.0242s/iter; left time: 377.9462s
Epoch: 25 cost time: 5.633946657180786
Epoch: 25, Steps: 208 | Train Loss: 0.328 Vali Loss: 7.943 Vali Acc: 0.107 Test Loss: 7.943 Test Acc: 0.107
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.2335519
	speed: 0.1132s/iter; left time: 1754.9680s
	iters: 200, epoch: 26 | loss: 0.7813762
	speed: 0.0250s/iter; left time: 385.0761s
Epoch: 26 cost time: 5.785614490509033
Epoch: 26, Steps: 208 | Train Loss: 0.313 Vali Loss: 8.230 Vali Acc: 0.109 Test Loss: 8.230 Test Acc: 0.109
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.2057809
	speed: 0.1062s/iter; left time: 1624.6351s
	iters: 200, epoch: 27 | loss: 0.4208356
	speed: 0.0259s/iter; left time: 393.9068s
Epoch: 27 cost time: 5.535192251205444
Epoch: 27, Steps: 208 | Train Loss: 0.309 Vali Loss: 8.422 Vali Acc: 0.104 Test Loss: 8.422 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0952968
	speed: 0.1227s/iter; left time: 1850.3405s
	iters: 200, epoch: 28 | loss: 0.3217299
	speed: 0.0231s/iter; left time: 346.3951s
Epoch: 28 cost time: 5.485399007797241
Epoch: 28, Steps: 208 | Train Loss: 0.282 Vali Loss: 8.618 Vali Acc: 0.112 Test Loss: 8.618 Test Acc: 0.112
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.1361892
	speed: 0.1089s/iter; left time: 1620.0556s
	iters: 200, epoch: 29 | loss: 0.0718666
	speed: 0.0254s/iter; left time: 374.6870s
Epoch: 29 cost time: 5.760990619659424
Epoch: 29, Steps: 208 | Train Loss: 0.265 Vali Loss: 8.719 Vali Acc: 0.106 Test Loss: 8.719 Test Acc: 0.106
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11869967193558008
model parameter : 348095
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.0468235
	speed: 0.0445s/iter; left time: 920.2713s
	iters: 200, epoch: 1 | loss: 4.3011732
	speed: 0.0288s/iter; left time: 593.6298s
Epoch: 1 cost time: 7.615253210067749
Epoch: 1, Steps: 208 | Train Loss: 3.875 Vali Loss: 3.911 Vali Acc: 0.042 Test Loss: 3.911 Test Acc: 0.042
Validation loss decreased (inf --> -0.042013).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.0159540
	speed: 0.1179s/iter; left time: 2416.6777s
	iters: 200, epoch: 2 | loss: 4.3117142
	speed: 0.0255s/iter; left time: 519.8548s
Epoch: 2 cost time: 5.967215061187744
Epoch: 2, Steps: 208 | Train Loss: 3.909 Vali Loss: 4.212 Vali Acc: 0.055 Test Loss: 4.212 Test Acc: 0.055
Validation loss decreased (-0.042013 --> -0.055431).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.0874157
	speed: 0.1194s/iter; left time: 2422.7325s
	iters: 200, epoch: 3 | loss: 3.7656910
	speed: 0.0267s/iter; left time: 538.0284s
Epoch: 3 cost time: 5.770606517791748
Epoch: 3, Steps: 208 | Train Loss: 3.864 Vali Loss: 3.818 Vali Acc: 0.057 Test Loss: 3.818 Test Acc: 0.057
Validation loss decreased (-0.055431 --> -0.056627).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.7828918
	speed: 0.1276s/iter; left time: 2561.8296s
	iters: 200, epoch: 4 | loss: 3.9272988
	speed: 0.0284s/iter; left time: 566.4213s
Epoch: 4 cost time: 6.27767276763916
Epoch: 4, Steps: 208 | Train Loss: 3.602 Vali Loss: 3.654 Vali Acc: 0.068 Test Loss: 3.654 Test Acc: 0.068
Validation loss decreased (-0.056627 --> -0.067962).  Saving model ...
	iters: 100, epoch: 5 | loss: 3.2800252
	speed: 0.1003s/iter; left time: 1993.6774s
	iters: 200, epoch: 5 | loss: 3.5456700
	speed: 0.0301s/iter; left time: 594.1973s
Epoch: 5 cost time: 6.031058311462402
Epoch: 5, Steps: 208 | Train Loss: 3.338 Vali Loss: 3.560 Vali Acc: 0.073 Test Loss: 3.560 Test Acc: 0.073
Validation loss decreased (-0.067962 --> -0.073332).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.1432598
	speed: 0.1169s/iter; left time: 2299.1136s
	iters: 200, epoch: 6 | loss: 3.6541066
	speed: 0.0230s/iter; left time: 449.5240s
Epoch: 6 cost time: 5.3871519565582275
Epoch: 6, Steps: 208 | Train Loss: 3.146 Vali Loss: 3.463 Vali Acc: 0.089 Test Loss: 3.463 Test Acc: 0.089
Validation loss decreased (-0.073332 --> -0.089139).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.9416873
	speed: 0.1113s/iter; left time: 2165.5327s
	iters: 200, epoch: 7 | loss: 3.0479517
	speed: 0.0239s/iter; left time: 463.3824s
Epoch: 7 cost time: 5.674099445343018
Epoch: 7, Steps: 208 | Train Loss: 2.915 Vali Loss: 3.496 Vali Acc: 0.084 Test Loss: 3.496 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.0708652
	speed: 0.0974s/iter; left time: 1875.4138s
	iters: 200, epoch: 8 | loss: 2.9730108
	speed: 0.0260s/iter; left time: 498.4824s
Epoch: 8 cost time: 5.736240386962891
Epoch: 8, Steps: 208 | Train Loss: 2.665 Vali Loss: 3.552 Vali Acc: 0.089 Test Loss: 3.552 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.2563825
	speed: 0.1074s/iter; left time: 2045.2330s
	iters: 200, epoch: 9 | loss: 2.3495069
	speed: 0.0233s/iter; left time: 440.8680s
Epoch: 9 cost time: 5.4852330684661865
Epoch: 9, Steps: 208 | Train Loss: 2.440 Vali Loss: 3.630 Vali Acc: 0.102 Test Loss: 3.630 Test Acc: 0.102
Validation loss decreased (-0.089139 --> -0.101664).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.1727095
	speed: 0.1102s/iter; left time: 2075.6109s
	iters: 200, epoch: 10 | loss: 2.3161426
	speed: 0.0243s/iter; left time: 455.7897s
Epoch: 10 cost time: 5.713880777359009
Epoch: 10, Steps: 208 | Train Loss: 2.201 Vali Loss: 3.732 Vali Acc: 0.099 Test Loss: 3.732 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.1814480
	speed: 0.0914s/iter; left time: 1702.0140s
	iters: 200, epoch: 11 | loss: 2.2220793
	speed: 0.0259s/iter; left time: 480.2942s
Epoch: 11 cost time: 5.7317891120910645
Epoch: 11, Steps: 208 | Train Loss: 1.969 Vali Loss: 3.879 Vali Acc: 0.106 Test Loss: 3.879 Test Acc: 0.106
Validation loss decreased (-0.101664 --> -0.105538).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.1578116
	speed: 0.1000s/iter; left time: 1840.7601s
	iters: 200, epoch: 12 | loss: 2.3514309
	speed: 0.0247s/iter; left time: 452.0616s
Epoch: 12 cost time: 5.405811786651611
Epoch: 12, Steps: 208 | Train Loss: 1.750 Vali Loss: 4.072 Vali Acc: 0.110 Test Loss: 4.072 Test Acc: 0.110
Validation loss decreased (-0.105538 --> -0.109712).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.0128307
	speed: 0.1140s/iter; left time: 2075.8831s
	iters: 200, epoch: 13 | loss: 1.5272417
	speed: 0.0258s/iter; left time: 466.5106s
Epoch: 13 cost time: 5.830123424530029
Epoch: 13, Steps: 208 | Train Loss: 1.530 Vali Loss: 4.331 Vali Acc: 0.111 Test Loss: 4.331 Test Acc: 0.111
Validation loss decreased (-0.109712 --> -0.110902).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.6876463
	speed: 0.1060s/iter; left time: 1907.5228s
	iters: 200, epoch: 14 | loss: 1.4997164
	speed: 0.0255s/iter; left time: 456.5676s
Epoch: 14 cost time: 5.784256458282471
Epoch: 14, Steps: 208 | Train Loss: 1.344 Vali Loss: 4.586 Vali Acc: 0.112 Test Loss: 4.586 Test Acc: 0.112
Validation loss decreased (-0.110902 --> -0.111794).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.0594963
	speed: 0.0943s/iter; left time: 1677.7023s
	iters: 200, epoch: 15 | loss: 0.8492932
	speed: 0.0248s/iter; left time: 437.9812s
Epoch: 15 cost time: 5.682509422302246
Epoch: 15, Steps: 208 | Train Loss: 1.143 Vali Loss: 4.870 Vali Acc: 0.113 Test Loss: 4.870 Test Acc: 0.113
Validation loss decreased (-0.111794 --> -0.112686).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.4445419
	speed: 0.1057s/iter; left time: 1858.8239s
	iters: 200, epoch: 16 | loss: 0.8283785
	speed: 0.0253s/iter; left time: 442.1255s
Epoch: 16 cost time: 5.553905725479126
Epoch: 16, Steps: 208 | Train Loss: 0.990 Vali Loss: 5.144 Vali Acc: 0.111 Test Loss: 5.144 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.9299792
	speed: 0.1085s/iter; left time: 1885.1914s
	iters: 200, epoch: 17 | loss: 0.9663379
	speed: 0.0270s/iter; left time: 465.5729s
Epoch: 17 cost time: 5.911924362182617
Epoch: 17, Steps: 208 | Train Loss: 0.880 Vali Loss: 5.514 Vali Acc: 0.109 Test Loss: 5.514 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.7514120
	speed: 0.0936s/iter; left time: 1607.3774s
	iters: 200, epoch: 18 | loss: 0.7765949
	speed: 0.0256s/iter; left time: 436.0181s
Epoch: 18 cost time: 5.446830749511719
Epoch: 18, Steps: 208 | Train Loss: 0.785 Vali Loss: 5.550 Vali Acc: 0.112 Test Loss: 5.550 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.7974784
	speed: 0.1116s/iter; left time: 1892.7641s
	iters: 200, epoch: 19 | loss: 1.0588108
	speed: 0.0243s/iter; left time: 410.1693s
Epoch: 19 cost time: 5.653046607971191
Epoch: 19, Steps: 208 | Train Loss: 0.715 Vali Loss: 6.033 Vali Acc: 0.110 Test Loss: 6.033 Test Acc: 0.110
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.6972058
	speed: 0.0998s/iter; left time: 1672.2426s
	iters: 200, epoch: 20 | loss: 0.5255713
	speed: 0.0257s/iter; left time: 428.0768s
Epoch: 20 cost time: 5.664141893386841
Epoch: 20, Steps: 208 | Train Loss: 0.638 Vali Loss: 6.366 Vali Acc: 0.110 Test Loss: 6.366 Test Acc: 0.110
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.5041769
	speed: 0.0927s/iter; left time: 1533.8603s
	iters: 200, epoch: 21 | loss: 0.9237612
	speed: 0.0250s/iter; left time: 410.6243s
Epoch: 21 cost time: 5.292612075805664
Epoch: 21, Steps: 208 | Train Loss: 0.578 Vali Loss: 6.577 Vali Acc: 0.115 Test Loss: 6.577 Test Acc: 0.115
Validation loss decreased (-0.112686 --> -0.114459).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.1634168
	speed: 0.1048s/iter; left time: 1710.8972s
	iters: 200, epoch: 22 | loss: 0.4701476
	speed: 0.0235s/iter; left time: 381.6707s
Epoch: 22 cost time: 5.374759197235107
Epoch: 22, Steps: 208 | Train Loss: 0.541 Vali Loss: 6.763 Vali Acc: 0.114 Test Loss: 6.763 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.4726859
	speed: 0.1116s/iter; left time: 1798.9707s
	iters: 200, epoch: 23 | loss: 0.6131201
	speed: 0.0276s/iter; left time: 442.0258s
Epoch: 23 cost time: 6.119930028915405
Epoch: 23, Steps: 208 | Train Loss: 0.490 Vali Loss: 6.889 Vali Acc: 0.105 Test Loss: 6.889 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.4813535
	speed: 0.1174s/iter; left time: 1868.5996s
	iters: 200, epoch: 24 | loss: 0.5142087
	speed: 0.0286s/iter; left time: 453.1334s
Epoch: 24 cost time: 6.37118673324585
Epoch: 24, Steps: 208 | Train Loss: 0.461 Vali Loss: 7.224 Vali Acc: 0.104 Test Loss: 7.224 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.5234005
	speed: 0.1121s/iter; left time: 1761.1370s
	iters: 200, epoch: 25 | loss: 1.0168413
	speed: 0.0246s/iter; left time: 384.7602s
Epoch: 25 cost time: 5.956194877624512
Epoch: 25, Steps: 208 | Train Loss: 0.431 Vali Loss: 7.406 Vali Acc: 0.102 Test Loss: 7.406 Test Acc: 0.102
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.3920625
	speed: 0.1180s/iter; left time: 1828.8915s
	iters: 200, epoch: 26 | loss: 0.6705890
	speed: 0.0293s/iter; left time: 451.4908s
Epoch: 26 cost time: 6.468602895736694
Epoch: 26, Steps: 208 | Train Loss: 0.399 Vali Loss: 7.421 Vali Acc: 0.112 Test Loss: 7.421 Test Acc: 0.112
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.3481721
	speed: 0.1020s/iter; left time: 1560.1591s
	iters: 200, epoch: 27 | loss: 0.5653749
	speed: 0.0283s/iter; left time: 430.2962s
Epoch: 27 cost time: 5.9932334423065186
Epoch: 27, Steps: 208 | Train Loss: 0.396 Vali Loss: 7.834 Vali Acc: 0.112 Test Loss: 7.834 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.4709582
	speed: 0.1166s/iter; left time: 1759.2366s
	iters: 200, epoch: 28 | loss: 0.5241532
	speed: 0.0256s/iter; left time: 382.9512s
Epoch: 28 cost time: 5.860797882080078
Epoch: 28, Steps: 208 | Train Loss: 0.364 Vali Loss: 7.996 Vali Acc: 0.114 Test Loss: 7.996 Test Acc: 0.114
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.1907330
	speed: 0.1114s/iter; left time: 1656.6410s
	iters: 200, epoch: 29 | loss: 1.2104399
	speed: 0.0255s/iter; left time: 376.8950s
Epoch: 29 cost time: 5.544682741165161
Epoch: 29, Steps: 208 | Train Loss: 0.357 Vali Loss: 8.066 Vali Acc: 0.108 Test Loss: 8.066 Test Acc: 0.108
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.4093207
	speed: 0.1054s/iter; left time: 1545.9107s
	iters: 200, epoch: 30 | loss: 0.1191673
	speed: 0.0267s/iter; left time: 389.4727s
Epoch: 30 cost time: 5.936801910400391
Epoch: 30, Steps: 208 | Train Loss: 0.325 Vali Loss: 8.483 Vali Acc: 0.108 Test Loss: 8.483 Test Acc: 0.108
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.1829555
	speed: 0.0989s/iter; left time: 1430.6656s
	iters: 200, epoch: 31 | loss: 0.5839268
	speed: 0.0264s/iter; left time: 379.4496s
Epoch: 31 cost time: 5.62499737739563
Epoch: 31, Steps: 208 | Train Loss: 0.318 Vali Loss: 8.573 Vali Acc: 0.111 Test Loss: 8.573 Test Acc: 0.111
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.11452430659111244
model parameter : 347487
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 4.1842666
	speed: 0.0385s/iter; left time: 797.0821s
	iters: 200, epoch: 1 | loss: 3.5576763
	speed: 0.0252s/iter; left time: 518.3561s
Epoch: 1 cost time: 6.61077618598938
Epoch: 1, Steps: 208 | Train Loss: 3.882 Vali Loss: 3.982 Vali Acc: 0.052 Test Loss: 3.982 Test Acc: 0.052
Validation loss decreased (inf --> -0.051854).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.1338558
	speed: 0.0952s/iter; left time: 1950.2924s
	iters: 200, epoch: 2 | loss: 4.2806363
	speed: 0.0247s/iter; left time: 503.2574s
Epoch: 2 cost time: 5.201097726821899
Epoch: 2, Steps: 208 | Train Loss: 3.987 Vali Loss: 4.082 Vali Acc: 0.052 Test Loss: 4.082 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 3.7509739
	speed: 0.0996s/iter; left time: 2020.5488s
	iters: 200, epoch: 3 | loss: 4.5839005
	speed: 0.0244s/iter; left time: 492.5743s
Epoch: 3 cost time: 5.575119733810425
Epoch: 3, Steps: 208 | Train Loss: 3.919 Vali Loss: 4.093 Vali Acc: 0.058 Test Loss: 4.093 Test Acc: 0.058
Validation loss decreased (-0.051854 --> -0.057519).  Saving model ...
	iters: 100, epoch: 4 | loss: 4.6648188
	speed: 0.0935s/iter; left time: 1877.9628s
	iters: 200, epoch: 4 | loss: 3.1978230
	speed: 0.0250s/iter; left time: 500.0134s
Epoch: 4 cost time: 5.675717353820801
Epoch: 4, Steps: 208 | Train Loss: 3.814 Vali Loss: 4.313 Vali Acc: 0.049 Test Loss: 4.313 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.4981301
	speed: 0.0922s/iter; left time: 1832.1123s
	iters: 200, epoch: 5 | loss: 3.2554028
	speed: 0.0232s/iter; left time: 458.7712s
Epoch: 5 cost time: 5.463160037994385
Epoch: 5, Steps: 208 | Train Loss: 3.461 Vali Loss: 3.625 Vali Acc: 0.084 Test Loss: 3.625 Test Acc: 0.084
Validation loss decreased (-0.057519 --> -0.083471).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.3797629
	speed: 0.1032s/iter; left time: 2028.6074s
	iters: 200, epoch: 6 | loss: 2.8680675
	speed: 0.0265s/iter; left time: 518.8580s
Epoch: 6 cost time: 5.581162929534912
Epoch: 6, Steps: 208 | Train Loss: 3.163 Vali Loss: 3.505 Vali Acc: 0.084 Test Loss: 3.505 Test Acc: 0.084
Validation loss decreased (-0.083471 --> -0.084367).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.7154961
	speed: 0.1128s/iter; left time: 2194.7671s
	iters: 200, epoch: 7 | loss: 3.0981891
	speed: 0.0270s/iter; left time: 523.0474s
Epoch: 7 cost time: 5.961857795715332
Epoch: 7, Steps: 208 | Train Loss: 2.912 Vali Loss: 3.466 Vali Acc: 0.086 Test Loss: 3.466 Test Acc: 0.086
Validation loss decreased (-0.084367 --> -0.086455).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.4632108
	speed: 0.1018s/iter; left time: 1958.8943s
	iters: 200, epoch: 8 | loss: 3.2164381
	speed: 0.0274s/iter; left time: 524.1192s
Epoch: 8 cost time: 5.8665032386779785
Epoch: 8, Steps: 208 | Train Loss: 2.674 Vali Loss: 3.479 Vali Acc: 0.106 Test Loss: 3.479 Test Acc: 0.106
Validation loss decreased (-0.086455 --> -0.105542).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.5814836
	speed: 0.1051s/iter; left time: 2000.4607s
	iters: 200, epoch: 9 | loss: 2.4850283
	speed: 0.0251s/iter; left time: 475.1758s
Epoch: 9 cost time: 5.724287748336792
Epoch: 9, Steps: 208 | Train Loss: 2.459 Vali Loss: 3.490 Vali Acc: 0.097 Test Loss: 3.490 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.7958838
	speed: 0.0965s/iter; left time: 1817.6978s
	iters: 200, epoch: 10 | loss: 2.5693145
	speed: 0.0252s/iter; left time: 471.9371s
Epoch: 10 cost time: 5.611570358276367
Epoch: 10, Steps: 208 | Train Loss: 2.216 Vali Loss: 3.826 Vali Acc: 0.103 Test Loss: 3.826 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.4875784
	speed: 0.0970s/iter; left time: 1806.4294s
	iters: 200, epoch: 11 | loss: 2.4339383
	speed: 0.0250s/iter; left time: 463.4307s
Epoch: 11 cost time: 5.338667392730713
Epoch: 11, Steps: 208 | Train Loss: 1.991 Vali Loss: 3.900 Vali Acc: 0.117 Test Loss: 3.900 Test Acc: 0.117
Validation loss decreased (-0.105542 --> -0.116573).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.9408216
	speed: 0.1045s/iter; left time: 1924.4392s
	iters: 200, epoch: 12 | loss: 2.2760828
	speed: 0.0227s/iter; left time: 415.6520s
Epoch: 12 cost time: 5.40655779838562
Epoch: 12, Steps: 208 | Train Loss: 1.727 Vali Loss: 4.166 Vali Acc: 0.112 Test Loss: 4.166 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.4434239
	speed: 0.0995s/iter; left time: 1812.0503s
	iters: 200, epoch: 13 | loss: 1.8603953
	speed: 0.0252s/iter; left time: 456.0705s
Epoch: 13 cost time: 5.5921642780303955
Epoch: 13, Steps: 208 | Train Loss: 1.507 Vali Loss: 4.404 Vali Acc: 0.116 Test Loss: 4.404 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.4822388
	speed: 0.0930s/iter; left time: 1674.5814s
	iters: 200, epoch: 14 | loss: 1.3365790
	speed: 0.0293s/iter; left time: 523.6697s
Epoch: 14 cost time: 6.028184652328491
Epoch: 14, Steps: 208 | Train Loss: 1.268 Vali Loss: 4.750 Vali Acc: 0.115 Test Loss: 4.750 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.9965739
	speed: 0.1166s/iter; left time: 2074.1535s
	iters: 200, epoch: 15 | loss: 1.3376155
	speed: 0.0256s/iter; left time: 453.2430s
Epoch: 15 cost time: 5.778603553771973
Epoch: 15, Steps: 208 | Train Loss: 1.065 Vali Loss: 5.014 Vali Acc: 0.117 Test Loss: 5.014 Test Acc: 0.117
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.0374206
	speed: 0.1238s/iter; left time: 2175.7406s
	iters: 200, epoch: 16 | loss: 1.0514915
	speed: 0.0288s/iter; left time: 502.7747s
Epoch: 16 cost time: 6.4902074337005615
Epoch: 16, Steps: 208 | Train Loss: 0.901 Vali Loss: 5.307 Vali Acc: 0.115 Test Loss: 5.307 Test Acc: 0.115
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.8892578
	speed: 0.1152s/iter; left time: 2000.9105s
	iters: 200, epoch: 17 | loss: 1.4778492
	speed: 0.0287s/iter; left time: 495.1169s
Epoch: 17 cost time: 6.2626917362213135
Epoch: 17, Steps: 208 | Train Loss: 0.755 Vali Loss: 5.725 Vali Acc: 0.116 Test Loss: 5.725 Test Acc: 0.116
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.8102971
	speed: 0.1155s/iter; left time: 1982.3346s
	iters: 200, epoch: 18 | loss: 1.3908106
	speed: 0.0275s/iter; left time: 468.7645s
Epoch: 18 cost time: 5.796213865280151
Epoch: 18, Steps: 208 | Train Loss: 0.675 Vali Loss: 6.159 Vali Acc: 0.117 Test Loss: 6.159 Test Acc: 0.117
Validation loss decreased (-0.116573 --> -0.117147).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.9289967
	speed: 0.0859s/iter; left time: 1456.0029s
	iters: 200, epoch: 19 | loss: 0.2468072
	speed: 0.0184s/iter; left time: 310.3339s
Epoch: 19 cost time: 4.204313278198242
Epoch: 19, Steps: 208 | Train Loss: 0.582 Vali Loss: 6.270 Vali Acc: 0.127 Test Loss: 6.270 Test Acc: 0.127
Validation loss decreased (-0.117147 --> -0.127286).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.6336055
	speed: 0.0721s/iter; left time: 1207.1401s
	iters: 200, epoch: 20 | loss: 0.2914578
	speed: 0.0170s/iter; left time: 282.3231s
Epoch: 20 cost time: 4.081255674362183
Epoch: 20, Steps: 208 | Train Loss: 0.512 Vali Loss: 6.556 Vali Acc: 0.120 Test Loss: 6.556 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.3769575
	speed: 0.0903s/iter; left time: 1492.9556s
	iters: 200, epoch: 21 | loss: 0.3853173
	speed: 0.0259s/iter; left time: 425.4332s
Epoch: 21 cost time: 5.639145612716675
Epoch: 21, Steps: 208 | Train Loss: 0.466 Vali Loss: 6.999 Vali Acc: 0.123 Test Loss: 6.999 Test Acc: 0.123
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.1485733
	speed: 0.1012s/iter; left time: 1652.2899s
	iters: 200, epoch: 22 | loss: 0.7786040
	speed: 0.0260s/iter; left time: 421.5954s
Epoch: 22 cost time: 5.6423821449279785
Epoch: 22, Steps: 208 | Train Loss: 0.423 Vali Loss: 7.268 Vali Acc: 0.121 Test Loss: 7.268 Test Acc: 0.121
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.5539964
	speed: 0.1108s/iter; left time: 1787.0518s
	iters: 200, epoch: 23 | loss: 1.0117415
	speed: 0.0239s/iter; left time: 382.3770s
Epoch: 23 cost time: 5.326818943023682
Epoch: 23, Steps: 208 | Train Loss: 0.397 Vali Loss: 7.292 Vali Acc: 0.123 Test Loss: 7.292 Test Acc: 0.123
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.1933456
	speed: 0.1104s/iter; left time: 1757.8184s
	iters: 200, epoch: 24 | loss: 0.4030889
	speed: 0.0247s/iter; left time: 391.4479s
Epoch: 24 cost time: 5.501310348510742
Epoch: 24, Steps: 208 | Train Loss: 0.379 Vali Loss: 7.641 Vali Acc: 0.115 Test Loss: 7.641 Test Acc: 0.115
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.5978637
	speed: 0.1071s/iter; left time: 1681.9150s
	iters: 200, epoch: 25 | loss: 0.6416276
	speed: 0.0263s/iter; left time: 409.7960s
Epoch: 25 cost time: 5.75572943687439
Epoch: 25, Steps: 208 | Train Loss: 0.352 Vali Loss: 7.874 Vali Acc: 0.111 Test Loss: 7.874 Test Acc: 0.111
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.2048865
	speed: 0.0990s/iter; left time: 1534.8284s
	iters: 200, epoch: 26 | loss: 0.2715138
	speed: 0.0227s/iter; left time: 349.5615s
Epoch: 26 cost time: 5.442675828933716
Epoch: 26, Steps: 208 | Train Loss: 0.342 Vali Loss: 7.863 Vali Acc: 0.121 Test Loss: 7.863 Test Acc: 0.121
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.4414833
	speed: 0.1108s/iter; left time: 1694.7119s
	iters: 200, epoch: 27 | loss: 0.1856823
	speed: 0.0234s/iter; left time: 355.7461s
Epoch: 27 cost time: 5.343168020248413
Epoch: 27, Steps: 208 | Train Loss: 0.315 Vali Loss: 8.391 Vali Acc: 0.116 Test Loss: 8.391 Test Acc: 0.116
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.7383523
	speed: 0.0991s/iter; left time: 1494.4164s
	iters: 200, epoch: 28 | loss: 0.3952179
	speed: 0.0251s/iter; left time: 375.9502s
Epoch: 28 cost time: 5.704793214797974
Epoch: 28, Steps: 208 | Train Loss: 0.292 Vali Loss: 8.201 Vali Acc: 0.115 Test Loss: 8.201 Test Acc: 0.115
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0607073
	speed: 0.1057s/iter; left time: 1573.0955s
	iters: 200, epoch: 29 | loss: 0.2426625
	speed: 0.0249s/iter; left time: 368.5556s
Epoch: 29 cost time: 5.410186767578125
Epoch: 29, Steps: 208 | Train Loss: 0.280 Vali Loss: 8.501 Vali Acc: 0.121 Test Loss: 8.501 Test Acc: 0.121
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12734864300626306
model parameter : 346879
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PhonemeSpectra  Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PhonemeSpectra
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             11                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

3315
3353
>>>>>>>start training : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
3315
3353
3353
	iters: 100, epoch: 1 | loss: 3.8667889
	speed: 0.0384s/iter; left time: 795.2471s
	iters: 200, epoch: 1 | loss: 4.0778422
	speed: 0.0237s/iter; left time: 488.7506s
Epoch: 1 cost time: 6.492768287658691
Epoch: 1, Steps: 208 | Train Loss: 3.905 Vali Loss: 3.950 Vali Acc: 0.057 Test Loss: 3.950 Test Acc: 0.057
Validation loss decreased (inf --> -0.056924).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.0773129
	speed: 0.1049s/iter; left time: 2150.3522s
	iters: 200, epoch: 2 | loss: 3.9983981
	speed: 0.0249s/iter; left time: 508.1599s
Epoch: 2 cost time: 5.593485116958618
Epoch: 2, Steps: 208 | Train Loss: 3.961 Vali Loss: 4.183 Vali Acc: 0.049 Test Loss: 4.183 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.6980987
	speed: 0.1047s/iter; left time: 2123.1720s
	iters: 200, epoch: 3 | loss: 3.3510294
	speed: 0.0249s/iter; left time: 501.8353s
Epoch: 3 cost time: 5.412877082824707
Epoch: 3, Steps: 208 | Train Loss: 3.882 Vali Loss: 4.071 Vali Acc: 0.066 Test Loss: 4.071 Test Acc: 0.066
Validation loss decreased (-0.056924 --> -0.066169).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.7638373
	speed: 0.1029s/iter; left time: 2066.4163s
	iters: 200, epoch: 4 | loss: 3.9911547
	speed: 0.0239s/iter; left time: 477.9219s
Epoch: 4 cost time: 5.350555181503296
Epoch: 4, Steps: 208 | Train Loss: 3.690 Vali Loss: 3.995 Vali Acc: 0.061 Test Loss: 3.995 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 3.7932274
	speed: 0.0954s/iter; left time: 1895.3322s
	iters: 200, epoch: 5 | loss: 3.3226490
	speed: 0.0249s/iter; left time: 493.2148s
Epoch: 5 cost time: 5.519902944564819
Epoch: 5, Steps: 208 | Train Loss: 3.392 Vali Loss: 3.513 Vali Acc: 0.081 Test Loss: 3.513 Test Acc: 0.081
Validation loss decreased (-0.066169 --> -0.080788).  Saving model ...
	iters: 100, epoch: 6 | loss: 3.5237348
	speed: 0.0934s/iter; left time: 1836.5687s
	iters: 200, epoch: 6 | loss: 2.9915292
	speed: 0.0239s/iter; left time: 466.8809s
Epoch: 6 cost time: 5.3223278522491455
Epoch: 6, Steps: 208 | Train Loss: 3.108 Vali Loss: 3.493 Vali Acc: 0.075 Test Loss: 3.493 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.5319684
	speed: 0.1131s/iter; left time: 2200.8515s
	iters: 200, epoch: 7 | loss: 2.7724051
	speed: 0.0269s/iter; left time: 520.3923s
Epoch: 7 cost time: 5.9597532749176025
Epoch: 7, Steps: 208 | Train Loss: 2.914 Vali Loss: 3.466 Vali Acc: 0.086 Test Loss: 3.466 Test Acc: 0.086
Validation loss decreased (-0.080788 --> -0.086157).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.6216733
	speed: 0.1278s/iter; left time: 2459.4052s
	iters: 200, epoch: 8 | loss: 2.9268651
	speed: 0.0283s/iter; left time: 541.5306s
Epoch: 8 cost time: 6.29181981086731
Epoch: 8, Steps: 208 | Train Loss: 2.701 Vali Loss: 3.500 Vali Acc: 0.095 Test Loss: 3.500 Test Acc: 0.095
Validation loss decreased (-0.086157 --> -0.095104).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.5391934
	speed: 0.1191s/iter; left time: 2266.4229s
	iters: 200, epoch: 9 | loss: 2.3295836
	speed: 0.0271s/iter; left time: 512.7219s
Epoch: 9 cost time: 6.08594536781311
Epoch: 9, Steps: 208 | Train Loss: 2.476 Vali Loss: 3.615 Vali Acc: 0.101 Test Loss: 3.615 Test Acc: 0.101
Validation loss decreased (-0.095104 --> -0.100769).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.6163116
	speed: 0.1006s/iter; left time: 1893.3243s
	iters: 200, epoch: 10 | loss: 2.2528470
	speed: 0.0276s/iter; left time: 517.7384s
Epoch: 10 cost time: 5.583983659744263
Epoch: 10, Steps: 208 | Train Loss: 2.259 Vali Loss: 3.759 Vali Acc: 0.101 Test Loss: 3.759 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.4031763
	speed: 0.1190s/iter; left time: 2215.3603s
	iters: 200, epoch: 11 | loss: 1.6911191
	speed: 0.0254s/iter; left time: 470.2368s
Epoch: 11 cost time: 5.802849054336548
Epoch: 11, Steps: 208 | Train Loss: 2.006 Vali Loss: 3.818 Vali Acc: 0.106 Test Loss: 3.818 Test Acc: 0.106
Validation loss decreased (-0.100769 --> -0.105539).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.9385285
	speed: 0.1189s/iter; left time: 2188.8381s
	iters: 200, epoch: 12 | loss: 1.8751237
	speed: 0.0280s/iter; left time: 512.7436s
Epoch: 12 cost time: 6.120545387268066
Epoch: 12, Steps: 208 | Train Loss: 1.758 Vali Loss: 4.045 Vali Acc: 0.107 Test Loss: 4.045 Test Acc: 0.107
Validation loss decreased (-0.105539 --> -0.107028).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.4475263
	speed: 0.1029s/iter; left time: 1872.6690s
	iters: 200, epoch: 13 | loss: 2.2675273
	speed: 0.0251s/iter; left time: 454.4423s
Epoch: 13 cost time: 5.551485776901245
Epoch: 13, Steps: 208 | Train Loss: 1.474 Vali Loss: 4.578 Vali Acc: 0.094 Test Loss: 4.578 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.1300083
	speed: 0.0978s/iter; left time: 1760.0480s
	iters: 200, epoch: 14 | loss: 1.9612099
	speed: 0.0250s/iter; left time: 447.6280s
Epoch: 14 cost time: 5.442187547683716
Epoch: 14, Steps: 208 | Train Loss: 1.238 Vali Loss: 4.826 Vali Acc: 0.114 Test Loss: 4.826 Test Acc: 0.114
Validation loss decreased (-0.107028 --> -0.113581).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.6259049
	speed: 0.1012s/iter; left time: 1800.1807s
	iters: 200, epoch: 15 | loss: 1.3254910
	speed: 0.0238s/iter; left time: 420.6634s
Epoch: 15 cost time: 5.374662399291992
Epoch: 15, Steps: 208 | Train Loss: 0.977 Vali Loss: 5.327 Vali Acc: 0.102 Test Loss: 5.327 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.5585064
	speed: 0.0980s/iter; left time: 1722.7350s
	iters: 200, epoch: 16 | loss: 1.0854083
	speed: 0.0244s/iter; left time: 425.7423s
Epoch: 16 cost time: 5.507247686386108
Epoch: 16, Steps: 208 | Train Loss: 0.836 Vali Loss: 5.719 Vali Acc: 0.104 Test Loss: 5.719 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.7519137
	speed: 0.1016s/iter; left time: 1764.9205s
	iters: 200, epoch: 17 | loss: 1.1189370
	speed: 0.0242s/iter; left time: 418.2233s
Epoch: 17 cost time: 5.2888970375061035
Epoch: 17, Steps: 208 | Train Loss: 0.708 Vali Loss: 5.891 Vali Acc: 0.107 Test Loss: 5.891 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.7409659
	speed: 0.1136s/iter; left time: 1949.4779s
	iters: 200, epoch: 18 | loss: 0.9670013
	speed: 0.0264s/iter; left time: 450.4673s
Epoch: 18 cost time: 5.865445137023926
Epoch: 18, Steps: 208 | Train Loss: 0.603 Vali Loss: 6.195 Vali Acc: 0.106 Test Loss: 6.195 Test Acc: 0.106
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.0612882
	speed: 0.0992s/iter; left time: 1682.6711s
	iters: 200, epoch: 19 | loss: 0.3559396
	speed: 0.0255s/iter; left time: 430.1326s
Epoch: 19 cost time: 5.618042945861816
Epoch: 19, Steps: 208 | Train Loss: 0.525 Vali Loss: 6.681 Vali Acc: 0.109 Test Loss: 6.681 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.2402054
	speed: 0.1033s/iter; left time: 1730.5439s
	iters: 200, epoch: 20 | loss: 0.3348313
	speed: 0.0251s/iter; left time: 418.2532s
Epoch: 20 cost time: 5.5935585498809814
Epoch: 20, Steps: 208 | Train Loss: 0.496 Vali Loss: 6.917 Vali Acc: 0.116 Test Loss: 6.917 Test Acc: 0.116
Validation loss decreased (-0.113581 --> -0.116245).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.3634833
	speed: 0.1085s/iter; left time: 1794.9843s
	iters: 200, epoch: 21 | loss: 0.3106369
	speed: 0.0245s/iter; left time: 403.2261s
Epoch: 21 cost time: 5.776950836181641
Epoch: 21, Steps: 208 | Train Loss: 0.441 Vali Loss: 6.798 Vali Acc: 0.112 Test Loss: 6.798 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.1615775
	speed: 0.1025s/iter; left time: 1674.2670s
	iters: 200, epoch: 22 | loss: 0.4608727
	speed: 0.0241s/iter; left time: 391.3719s
Epoch: 22 cost time: 5.4460344314575195
Epoch: 22, Steps: 208 | Train Loss: 0.400 Vali Loss: 7.445 Vali Acc: 0.115 Test Loss: 7.445 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.5578358
	speed: 0.1006s/iter; left time: 1622.8869s
	iters: 200, epoch: 23 | loss: 0.1391598
	speed: 0.0248s/iter; left time: 396.8288s
Epoch: 23 cost time: 5.776801824569702
Epoch: 23, Steps: 208 | Train Loss: 0.363 Vali Loss: 7.349 Vali Acc: 0.112 Test Loss: 7.349 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.6868750
	speed: 0.1060s/iter; left time: 1687.2400s
	iters: 200, epoch: 24 | loss: 0.1338086
	speed: 0.0251s/iter; left time: 397.7007s
Epoch: 24 cost time: 5.555937051773071
Epoch: 24, Steps: 208 | Train Loss: 0.352 Vali Loss: 7.726 Vali Acc: 0.116 Test Loss: 7.726 Test Acc: 0.116
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.6836496
	speed: 0.1089s/iter; left time: 1710.4557s
	iters: 200, epoch: 25 | loss: 0.3285282
	speed: 0.0258s/iter; left time: 402.3986s
Epoch: 25 cost time: 5.869954824447632
Epoch: 25, Steps: 208 | Train Loss: 0.340 Vali Loss: 7.978 Vali Acc: 0.120 Test Loss: 7.978 Test Acc: 0.120
Validation loss decreased (-0.116245 --> -0.120409).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.1816472
	speed: 0.1081s/iter; left time: 1675.7553s
	iters: 200, epoch: 26 | loss: 0.5387103
	speed: 0.0243s/iter; left time: 374.5914s
Epoch: 26 cost time: 5.654780149459839
Epoch: 26, Steps: 208 | Train Loss: 0.307 Vali Loss: 8.024 Vali Acc: 0.110 Test Loss: 8.024 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0753269
	speed: 0.1101s/iter; left time: 1683.5675s
	iters: 200, epoch: 27 | loss: 0.0123193
	speed: 0.0259s/iter; left time: 392.8488s
Epoch: 27 cost time: 5.830912828445435
Epoch: 27, Steps: 208 | Train Loss: 0.291 Vali Loss: 8.410 Vali Acc: 0.118 Test Loss: 8.410 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.1278510
	speed: 0.1003s/iter; left time: 1513.5632s
	iters: 200, epoch: 28 | loss: 0.0482877
	speed: 0.0259s/iter; left time: 387.4394s
Epoch: 28 cost time: 5.824061870574951
Epoch: 28, Steps: 208 | Train Loss: 0.290 Vali Loss: 8.618 Vali Acc: 0.112 Test Loss: 8.618 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.3801906
	speed: 0.0883s/iter; left time: 1313.7391s
	iters: 200, epoch: 29 | loss: 0.2725131
	speed: 0.0184s/iter; left time: 272.5986s
Epoch: 29 cost time: 4.4738476276397705
Epoch: 29, Steps: 208 | Train Loss: 0.290 Vali Loss: 8.631 Vali Acc: 0.111 Test Loss: 8.631 Test Acc: 0.111
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.0176753
	speed: 0.0882s/iter; left time: 1293.4857s
	iters: 200, epoch: 30 | loss: 0.3092194
	speed: 0.0213s/iter; left time: 311.0016s
Epoch: 30 cost time: 4.963972330093384
Epoch: 30, Steps: 208 | Train Loss: 0.231 Vali Loss: 9.383 Vali Acc: 0.109 Test Loss: 9.383 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.4232125
	speed: 0.1237s/iter; left time: 1789.2900s
	iters: 200, epoch: 31 | loss: 0.2429517
	speed: 0.0282s/iter; left time: 404.9305s
Epoch: 31 cost time: 6.164661407470703
Epoch: 31, Steps: 208 | Train Loss: 0.257 Vali Loss: 9.072 Vali Acc: 0.112 Test Loss: 9.072 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.1567469
	speed: 0.1196s/iter; left time: 1704.3075s
	iters: 200, epoch: 32 | loss: 0.1802437
	speed: 0.0286s/iter; left time: 404.6777s
Epoch: 32 cost time: 6.3061442375183105
Epoch: 32, Steps: 208 | Train Loss: 0.243 Vali Loss: 9.505 Vali Acc: 0.100 Test Loss: 9.505 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.2268603
	speed: 0.1094s/iter; left time: 1537.1788s
	iters: 200, epoch: 33 | loss: 0.0093705
	speed: 0.0287s/iter; left time: 400.6231s
Epoch: 33 cost time: 5.9955902099609375
Epoch: 33, Steps: 208 | Train Loss: 0.230 Vali Loss: 9.247 Vali Acc: 0.105 Test Loss: 9.247 Test Acc: 0.105
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.0193646
	speed: 0.1200s/iter; left time: 1660.3067s
	iters: 200, epoch: 34 | loss: 0.2512757
	speed: 0.0255s/iter; left time: 350.7908s
Epoch: 34 cost time: 5.985314607620239
Epoch: 34, Steps: 208 | Train Loss: 0.221 Vali Loss: 9.833 Vali Acc: 0.102 Test Loss: 9.833 Test Acc: 0.102
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.5307204
	speed: 0.1223s/iter; left time: 1666.5852s
	iters: 200, epoch: 35 | loss: 0.0166989
	speed: 0.0259s/iter; left time: 350.5158s
Epoch: 35 cost time: 5.941991090774536
Epoch: 35, Steps: 208 | Train Loss: 0.217 Vali Loss: 9.733 Vali Acc: 0.113 Test Loss: 9.733 Test Acc: 0.113
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PhonemeSpectra_Crossformer_UEA_ftM_sl217_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3353
test shape: torch.Size([3353, 39]) torch.Size([3353, 1])
accuracy:0.12048911422606622
model parameter : 346271
model size : 2.00MB
